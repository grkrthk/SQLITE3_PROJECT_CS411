cscope 15 $HOME/Downloads/sqlite-src-3080100 -q 0000010474 0002906667
	@config.h

5 
	#HAVE_DLFCN_H
 1

	)

8 
	#HAVE_FDATASYNC
 1

	)

11 
	#HAVE_GMTIME_R
 1

	)

14 
	#HAVE_INT16_T
 1

	)

17 
	#HAVE_INT32_T
 1

	)

20 
	#HAVE_INT64_T
 1

	)

23 
	#HAVE_INT8_T
 1

	)

26 
	#HAVE_INTPTR_T
 1

	)

29 
	#HAVE_INTTYPES_H
 1

	)

32 
	#HAVE_LOCALTIME_R
 1

	)

38 
	#HAVE_MALLOC_H
 1

	)

41 
	#HAVE_MALLOC_USABLE_SIZE
 1

	)

44 
	#HAVE_MEMORY_H
 1

	)

47 
	#HAVE_STDINT_H
 1

	)

50 
	#HAVE_STDLIB_H
 1

	)

53 
	#HAVE_STRINGS_H
 1

	)

56 
	#HAVE_STRING_H
 1

	)

59 
	#HAVE_SYS_STAT_H
 1

	)

62 
	#HAVE_SYS_TYPES_H
 1

	)

65 
	#HAVE_UINT16_T
 1

	)

68 
	#HAVE_UINT32_T
 1

	)

71 
	#HAVE_UINT64_T
 1

	)

74 
	#HAVE_UINT8_T
 1

	)

77 
	#HAVE_UINTPTR_T
 1

	)

80 
	#HAVE_UNISTD_H
 1

	)

83 
	#HAVE_USLEEP
 1

	)

86 
	#HAVE_UTIME
 1

	)

90 
	#LT_OBJDIR
 ".libs/"

	)

93 
	#PACKAGE_BUGREPORT
 ""

	)

96 
	#PACKAGE_NAME
 "sqlôe"

	)

99 
	#PACKAGE_STRING
 "sqlôê3.8.1"

	)

102 
	#PACKAGE_TARNAME
 "sqlôe"

	)

105 
	#PACKAGE_VERSION
 "3.8.1"

	)

108 
	#STDC_HEADERS
 1

	)

111 
	#_FILE_OFFSET_BITS
 64

	)

	@keywordhash.h

15 
	$keyw‹dCode
(c⁄° *
z
, 
n
){

27 c⁄° 
zText
[540] = {

59 c⁄° 
aHash
[127] = {

71 c⁄° 
aNext
[121] = {

83 c⁄° 
aLí
[121] = {

95 c⁄° 
aOff£t
[121] = {

107 c⁄° 
aCode
[121] = {

108 
TK_REINDEX
, 
TK_INDEXED
, 
TK_INDEX
, 
TK_DESC
, 
TK_ESCAPE
,

109 
TK_EACH
, 
TK_CHECK
, 
TK_KEY
, 
TK_BEFORE
, 
TK_FOREIGN
,

110 
TK_FOR
, 
TK_IGNORE
, 
TK_LIKE_KW
, 
TK_EXPLAIN
, 
TK_INSTEAD
,

111 
TK_ADD
, 
TK_DATABASE
, 
TK_AS
, 
TK_SELECT
, 
TK_TABLE
,

112 
TK_JOIN_KW
, 
TK_THEN
, 
TK_END
, 
TK_DEFERRABLE
, 
TK_ELSE
,

113 
TK_EXCEPT
, 
TK_TRANSACTION
,
TK_ACTION
, 
TK_ON
, 
TK_JOIN_KW
,

114 
TK_ALTER
, 
TK_RAISE
, 
TK_EXCLUSIVE
, 
TK_EXISTS
, 
TK_SAVEPOINT
,

115 
TK_INTERSECT
, 
TK_TRIGGER
, 
TK_REFERENCES
, 
TK_CONSTRAINT
, 
TK_INTO
,

116 
TK_OFFSET
, 
TK_OF
, 
TK_SET
, 
TK_TEMP
, TK_TEMP,

117 
TK_OR
, 
TK_UNIQUE
, 
TK_QUERY
, 
TK_ATTACH
, 
TK_HAVING
,

118 
TK_GROUP
, 
TK_UPDATE
, 
TK_BEGIN
, 
TK_JOIN_KW
, 
TK_RELEASE
,

119 
TK_BETWEEN
, 
TK_NOTNULL
, 
TK_NOT
, 
TK_NO
, 
TK_NULL
,

120 
TK_LIKE_KW
, 
TK_CASCADE
, 
TK_ASC
, 
TK_DELETE
, 
TK_CASE
,

121 
TK_COLLATE
, 
TK_CREATE
, 
TK_CTIME_KW
, 
TK_DETACH
, 
TK_IMMEDIATE
,

122 
TK_JOIN
, 
TK_INSERT
, 
TK_MATCH
, 
TK_PLAN
, 
TK_ANALYZE
,

123 
TK_PRAGMA
, 
TK_ABORT
, 
TK_VALUES
, 
TK_VIRTUAL
, 
TK_LIMIT
,

124 
TK_WHEN
, 
TK_WHERE
, 
TK_RENAME
, 
TK_AFTER
, 
TK_REPLACE
,

125 
TK_AND
, 
TK_DEFAULT
, 
TK_AUTOINCR
, 
TK_TO
, 
TK_IN
,

126 
TK_CAST
, 
TK_COLUMNKW
, 
TK_COMMIT
, 
TK_CONFLICT
, 
TK_JOIN_KW
,

127 
TK_CTIME_KW
, TK_CTIME_KW, 
TK_PRIMARY
, 
TK_DEFERRED
, 
TK_DISTINCT
,

128 
TK_IS
, 
TK_DROP
, 
TK_FAIL
, 
TK_FROM
, 
TK_JOIN_KW
,

129 
TK_LIKE_KW
, 
TK_BY
, 
TK_IF
, 
TK_ISNULL
, 
TK_ORDER
,

130 
TK_RESTRICT
, 
TK_JOIN_KW
, TK_JOIN_KW, 
TK_ROLLBACK
, 
TK_ROW
,

131 
TK_UNION
, 
TK_USING
, 
TK_VACUUM
, 
TK_VIEW
, 
TK_INITIALLY
,

132 
TK_ALL
,

134 
h
, 
i
;

135 if–
n
<2 )  
TK_ID
;

136 
h
 = ((
	`ch¨M≠
(
z
[0])*4) ^

137 (
	`ch¨M≠
(
z
[
n
-1])*3) ^

138 
n
) % 127;

139 
i
=(()
aHash
[
h
])-1; i>=0; i=(()
aNext
[i])-1){

140 if–
aLí
[
i
]==
n
 && 
	`sqlôe3SåNICmp
(&
zText
[
aOff£t
[i]],
z
,n)==0 ){

141 
	`ã°ˇ£
–
i
==0 );

142 
	`ã°ˇ£
–
i
==1 );

143 
	`ã°ˇ£
–
i
==2 );

144 
	`ã°ˇ£
–
i
==3 );

145 
	`ã°ˇ£
–
i
==4 );

146 
	`ã°ˇ£
–
i
==5 );

147 
	`ã°ˇ£
–
i
==6 );

148 
	`ã°ˇ£
–
i
==7 );

149 
	`ã°ˇ£
–
i
==8 );

150 
	`ã°ˇ£
–
i
==9 );

151 
	`ã°ˇ£
–
i
==10 );

152 
	`ã°ˇ£
–
i
==11 );

153 
	`ã°ˇ£
–
i
==12 );

154 
	`ã°ˇ£
–
i
==13 );

155 
	`ã°ˇ£
–
i
==14 );

156 
	`ã°ˇ£
–
i
==15 );

157 
	`ã°ˇ£
–
i
==16 );

158 
	`ã°ˇ£
–
i
==17 );

159 
	`ã°ˇ£
–
i
==18 );

160 
	`ã°ˇ£
–
i
==19 );

161 
	`ã°ˇ£
–
i
==20 );

162 
	`ã°ˇ£
–
i
==21 );

163 
	`ã°ˇ£
–
i
==22 );

164 
	`ã°ˇ£
–
i
==23 );

165 
	`ã°ˇ£
–
i
==24 );

166 
	`ã°ˇ£
–
i
==25 );

167 
	`ã°ˇ£
–
i
==26 );

168 
	`ã°ˇ£
–
i
==27 );

169 
	`ã°ˇ£
–
i
==28 );

170 
	`ã°ˇ£
–
i
==29 );

171 
	`ã°ˇ£
–
i
==30 );

172 
	`ã°ˇ£
–
i
==31 );

173 
	`ã°ˇ£
–
i
==32 );

174 
	`ã°ˇ£
–
i
==33 );

175 
	`ã°ˇ£
–
i
==34 );

176 
	`ã°ˇ£
–
i
==35 );

177 
	`ã°ˇ£
–
i
==36 );

178 
	`ã°ˇ£
–
i
==37 );

179 
	`ã°ˇ£
–
i
==38 );

180 
	`ã°ˇ£
–
i
==39 );

181 
	`ã°ˇ£
–
i
==40 );

182 
	`ã°ˇ£
–
i
==41 );

183 
	`ã°ˇ£
–
i
==42 );

184 
	`ã°ˇ£
–
i
==43 );

185 
	`ã°ˇ£
–
i
==44 );

186 
	`ã°ˇ£
–
i
==45 );

187 
	`ã°ˇ£
–
i
==46 );

188 
	`ã°ˇ£
–
i
==47 );

189 
	`ã°ˇ£
–
i
==48 );

190 
	`ã°ˇ£
–
i
==49 );

191 
	`ã°ˇ£
–
i
==50 );

192 
	`ã°ˇ£
–
i
==51 );

193 
	`ã°ˇ£
–
i
==52 );

194 
	`ã°ˇ£
–
i
==53 );

195 
	`ã°ˇ£
–
i
==54 );

196 
	`ã°ˇ£
–
i
==55 );

197 
	`ã°ˇ£
–
i
==56 );

198 
	`ã°ˇ£
–
i
==57 );

199 
	`ã°ˇ£
–
i
==58 );

200 
	`ã°ˇ£
–
i
==59 );

201 
	`ã°ˇ£
–
i
==60 );

202 
	`ã°ˇ£
–
i
==61 );

203 
	`ã°ˇ£
–
i
==62 );

204 
	`ã°ˇ£
–
i
==63 );

205 
	`ã°ˇ£
–
i
==64 );

206 
	`ã°ˇ£
–
i
==65 );

207 
	`ã°ˇ£
–
i
==66 );

208 
	`ã°ˇ£
–
i
==67 );

209 
	`ã°ˇ£
–
i
==68 );

210 
	`ã°ˇ£
–
i
==69 );

211 
	`ã°ˇ£
–
i
==70 );

212 
	`ã°ˇ£
–
i
==71 );

213 
	`ã°ˇ£
–
i
==72 );

214 
	`ã°ˇ£
–
i
==73 );

215 
	`ã°ˇ£
–
i
==74 );

216 
	`ã°ˇ£
–
i
==75 );

217 
	`ã°ˇ£
–
i
==76 );

218 
	`ã°ˇ£
–
i
==77 );

219 
	`ã°ˇ£
–
i
==78 );

220 
	`ã°ˇ£
–
i
==79 );

221 
	`ã°ˇ£
–
i
==80 );

222 
	`ã°ˇ£
–
i
==81 );

223 
	`ã°ˇ£
–
i
==82 );

224 
	`ã°ˇ£
–
i
==83 );

225 
	`ã°ˇ£
–
i
==84 );

226 
	`ã°ˇ£
–
i
==85 );

227 
	`ã°ˇ£
–
i
==86 );

228 
	`ã°ˇ£
–
i
==87 );

229 
	`ã°ˇ£
–
i
==88 );

230 
	`ã°ˇ£
–
i
==89 );

231 
	`ã°ˇ£
–
i
==90 );

232 
	`ã°ˇ£
–
i
==91 );

233 
	`ã°ˇ£
–
i
==92 );

234 
	`ã°ˇ£
–
i
==93 );

235 
	`ã°ˇ£
–
i
==94 );

236 
	`ã°ˇ£
–
i
==95 );

237 
	`ã°ˇ£
–
i
==96 );

238 
	`ã°ˇ£
–
i
==97 );

239 
	`ã°ˇ£
–
i
==98 );

240 
	`ã°ˇ£
–
i
==99 );

241 
	`ã°ˇ£
–
i
==100 );

242 
	`ã°ˇ£
–
i
==101 );

243 
	`ã°ˇ£
–
i
==102 );

244 
	`ã°ˇ£
–
i
==103 );

245 
	`ã°ˇ£
–
i
==104 );

246 
	`ã°ˇ£
–
i
==105 );

247 
	`ã°ˇ£
–
i
==106 );

248 
	`ã°ˇ£
–
i
==107 );

249 
	`ã°ˇ£
–
i
==108 );

250 
	`ã°ˇ£
–
i
==109 );

251 
	`ã°ˇ£
–
i
==110 );

252 
	`ã°ˇ£
–
i
==111 );

253 
	`ã°ˇ£
–
i
==112 );

254 
	`ã°ˇ£
–
i
==113 );

255 
	`ã°ˇ£
–
i
==114 );

256 
	`ã°ˇ£
–
i
==115 );

257 
	`ã°ˇ£
–
i
==116 );

258 
	`ã°ˇ£
–
i
==117 );

259 
	`ã°ˇ£
–
i
==118 );

260 
	`ã°ˇ£
–
i
==119 );

261 
	`ã°ˇ£
–
i
==120 );

262  
aCode
[
i
];

265  
TK_ID
;

266 
	}
}

267 
	$sqlôe3Keyw‹dCode
(c⁄° *
z
, 
n
){

268  
	`keyw‹dCode
((*)
z
, 
n
);

269 
	}
}

270 
	#SQLITE_N_KEYWORD
 121

	)

	@lempar.c

12 
	~<°dio.h
>

13 %% /* 
	$yy∑r£
 */ 
	`yyÀx
()

24 
	}
%%

27 #i‚de‡
INTERFACE


28 
	#INTERFACE
 1

	)

64 %% /* 
	$yy∑r£
 */ 
	`yyÀx
()

65 #
deföe
 
	`YY_NO_ACTION
 (
YYNSTATE
+
YYNRULE
+2)

66 #
deföe
 
	`YY_ACCEPT_ACTION
 (
YYNSTATE
+
YYNRULE
+1)

67 #
deföe
 
	`YY_ERROR_ACTION
 (
YYNSTATE
+
YYNRULE
)

71 c⁄° 
YYMINORTYPE
 
	gyyzîomö‹
 = { 0 };

81 #
i‚def
 
yyã°ˇ£


82 #
deföe
 
	`yyã°ˇ£
(
X
)

83 #
ídif


133 
	}
%%

145 #ifde‡
YYFALLBACK


146 c⁄° 
YYCODETYPE
 
	gyyFÆlback
[] = {

147 %% /* 
	$yy∑r£
 */ 
	`yyÀx
()

149 #
ídif


163 
	syySèckE¡ry
 {

164 
YYACTIONTYPE
 
	m°©ío
;

165 
YYCODETYPE
 
	mmaj‹
;

167 
YYMINORTYPE
 
	mmö‹
;

170 
yySèckE¡ry
 
	tyySèckE¡ry
;

174 
	syyP¨£r
 {

175 
	myyidx
;

176 #
ifdef
 
YYTRACKMAXSTACKDEPTH


177 
	myyidxMax
;

178 #
ídif


179 
	myyîr˙t
;

180 
	mP¨£ARG_SDECL


181 #
YYSTACKDEPTH
<=0

182 
	myy°ksz
;

183 
yySèckE¡ry
 *
	myy°ack
;

185 
yySèckE¡ry
 
	myy°ack
[
YYSTACKDEPTH
];

186 #
ídif


188 
yyP¨£r
 
	tyyP¨£r
;

190 #
i‚def
 
NDEBUG


191 #
ö˛ude
 <
°dio
.
h
>

192 
FILE
 *
	gyyTø˚FILE
 = 0;

193 *
	gyyTø˚Prom±
 = 0;

194 #
ídif


196 #
i‚def
 
NDEBUG


214 
	`P¨£Tø˚
(
FILE
 *
	gTø˚FILE
, *
	gzTø˚Prom±
){

215 
	gyyTø˚FILE
 = 
Tø˚FILE
;

216 
	gyyTø˚Prom±
 = 
zTø˚Prom±
;

217 if–
	gyyTø˚FILE
==0 ) 
yyTø˚Prom±
 = 0;

218 if–
	gyyTø˚Prom±
==0 ) 
yyTø˚FILE
 = 0;

220 #
ídif


222 #
i‚def
 
NDEBUG


225 c⁄° *c⁄° 
	gyyTokíName
[] = {

226 
	}
%%

230 #i‚de‡
NDEBUG


233 c⁄° *c⁄° 
	gyyRuÀName
[] = {

234 %% /* 
	$yy∑r£
 */ 
	`yyÀx
()

236 #
ídif


239 #
YYSTACKDEPTH
<=0

243 
	`yyGrowSèck
(
yyP¨£r
 *
	gp
){

244 
	g√wSize
;

245 
yySèckE¡ry
 *
	gpNew
;

247 
	g√wSize
 = 
p
->
yy°ksz
*2 + 100;

248 
	gpNew
 = 
	`ªÆloc
(
p
->
yy°ack
, 
√wSize
*(pNew[0]));

249 if–
	gpNew
 ){

250 
	gp
->
	gyy°ack
 = 
pNew
;

251 
	gp
->
	gyy°ksz
 = 
√wSize
;

252 #
i‚def
 
NDEBUG


253 if–
	gyyTø˚FILE
 ){

254 
	`Ârötf
(
	gyyTø˚FILE
,"%sStack growsÅo %dÉntries!\n",

255 
	gyyTø˚Prom±
, 
	gp
->
	gyy°ksz
);

257 #
ídif


260 #
ídif


274 *
	`P¨£AŒoc
(*(*
	gmÆlocProc
)(
	gsize_t
)){

275 
yyP¨£r
 *
	gpP¨£r
;

276 
	gpP¨£r
 = (
yyP¨£r
*)(*
mÆlocProc
)–(
size_t
)(yyParser) );

277 if–
	gpP¨£r
 ){

278 
	gpP¨£r
->
	gyyidx
 = -1;

279 #
ifdef
 
YYTRACKMAXSTACKDEPTH


280 
	gpP¨£r
->
	gyyidxMax
 = 0;

281 #
ídif


282 #
YYSTACKDEPTH
<=0

283 
	gpP¨£r
->
	gyy°ack
 = 
NULL
;

284 
	gpP¨£r
->
	gyy°ksz
 = 0;

285 
	`yyGrowSèck
(
	gpP¨£r
);

286 #
ídif


288  
	gpP¨£r
;

296 
	`yy_de°ru˘‹
(

297 
yyP¨£r
 *
	gyypP¨£r
,

298 
YYCODETYPE
 
	gyymaj‹
,

299 
YYMINORTYPE
 *
	gyypmö‹


301 
	gP¨£ARG_FETCH
;

302  
	gyymaj‹
 ){

313 
	}
%%

326 
	$yy_p›_∑r£r_°ack
(
yyP¨£r
 *
pP¨£r
){

327 
YYCODETYPE
 
yymaj‹
;

328 
yySèckE¡ry
 *
yytos
 = &
pP¨£r
->
yy°ack
[pP¨£r->
yyidx
];

332 if–
	`NEVER
(
pP¨£r
->
yyidx
<0) )  0;

333 #i‚de‡
NDEBUG


334 if–
yyTø˚FILE
 && 
pP¨£r
->
yyidx
>=0 ){

335 
	`Ârötf
(
yyTø˚FILE
,"%sPopping %s\n",

336 
yyTø˚Prom±
,

337 
yyTokíName
[
yytos
->
maj‹
]);

340 
yymaj‹
 = 
yytos
->
maj‹
;

341 
	`yy_de°ru˘‹
(
pP¨£r
, 
yymaj‹
, &
yytos
->
mö‹
);

342 
pP¨£r
->
yyidx
--;

343  
yymaj‹
;

344 
	}
}

358 
P¨£Fªe
(

359 *
p
,

360 (*
‰ìProc
)(*)

362 
yyP¨£r
 *
pP¨£r
 = (yyP¨£r*)
p
;

365 if–
	`NEVER
(
pP¨£r
==0) ) ;

366  
pP¨£r
->
yyidx
>=0 ) 
	`yy_p›_∑r£r_°ack
(pParser);

367 #i‡
YYSTACKDEPTH
<=0

368 
	`‰ì
(
pP¨£r
->
yy°ack
);

370 (*
‰ìProc
)((*)
pP¨£r
);

371 
	}
}

376 #ifde‡
YYTRACKMAXSTACKDEPTH


377 
	$P¨£SèckPók
(*
p
){

378 
yyP¨£r
 *
pP¨£r
 = (yyP¨£r*)
p
;

379  
pP¨£r
->
yyidxMax
;

380 
	}
}

391 
	$yy_föd_shi·_a˘i⁄
(

392 
yyP¨£r
 *
pP¨£r
,

393 
YYCODETYPE
 
iLookAhód


395 
i
;

396 
°©ío
 = 
pP¨£r
->
yy°ack
[pP¨£r->
yyidx
].stateno;

398 if–
°©ío
>
YY_SHIFT_COUNT


399 || (
i
 = 
yy_shi·_of°
[
°©ío
])==
YY_SHIFT_USE_DFLT
 ){

400  
yy_deÁu…
[
°©ío
];

402 
	`as£π
–
iLookAhód
!=
YYNOCODE
 );

403 
i
 +
iLookAhód
;

404 if–
i
<0 || i>=
YY_ACTTAB_COUNT
 || 
yy_lookahód
[i]!=
iLookAhód
 ){

405 if–
iLookAhód
>0 ){

406 #ifde‡
YYFALLBACK


407 
YYCODETYPE
 
iFÆlback
;

408 if–
iLookAhód
<(
yyFÆlback
)/(yyFallback[0])

409 && (
iFÆlback
 = 
yyFÆlback
[
iLookAhód
])!=0 ){

410 #i‚de‡
NDEBUG


411 if–
yyTø˚FILE
 ){

412 
	`Ârötf
(
yyTø˚FILE
, "%sFALLBACK %s => %s\n",

413 
yyTø˚Prom±
, 
yyTokíName
[
iLookAhód
], yyTokíName[
iFÆlback
]);

416  
	`yy_föd_shi·_a˘i⁄
(
pP¨£r
, 
iFÆlback
);

419 #ifde‡
YYWILDCARD


421 
j
 = 
i
 - 
iLookAhód
 + 
YYWILDCARD
;

423 #i‡
YY_SHIFT_MIN
+
YYWILDCARD
<0

424 
j
>=0 &&

426 #i‡
YY_SHIFT_MAX
+
YYWILDCARD
>=
YY_ACTTAB_COUNT


427 
j
<
YY_ACTTAB_COUNT
 &&

429 
yy_lookahód
[
j
]==
YYWILDCARD


431 #i‚de‡
NDEBUG


432 if–
yyTø˚FILE
 ){

433 
	`Ârötf
(
yyTø˚FILE
, "%sWILDCARD %s => %s\n",

434 
yyTø˚Prom±
, 
yyTokíName
[
iLookAhód
], yyTokíName[
YYWILDCARD
]);

437  
yy_a˘i⁄
[
j
];

442  
yy_deÁu…
[
°©ío
];

444  
yy_a˘i⁄
[
i
];

446 
	}
}

456 
	$yy_föd_ªdu˚_a˘i⁄
(

457 
°©ío
,

458 
YYCODETYPE
 
iLookAhód


460 
i
;

461 #ifde‡
YYERRORSYMBOL


462 if–
°©ío
>
YY_REDUCE_COUNT
 ){

463  
yy_deÁu…
[
°©ío
];

466 
	`as£π
–
°©ío
<=
YY_REDUCE_COUNT
 );

468 
i
 = 
yy_ªdu˚_of°
[
°©ío
];

469 
	`as£π
–
i
!=
YY_REDUCE_USE_DFLT
 );

470 
	`as£π
–
iLookAhód
!=
YYNOCODE
 );

471 
i
 +
iLookAhód
;

472 #ifde‡
YYERRORSYMBOL


473 if–
i
<0 || i>=
YY_ACTTAB_COUNT
 || 
yy_lookahód
[i]!=
iLookAhód
 ){

474  
yy_deÁu…
[
°©ío
];

477 
	`as£π
–
i
>=0 && i<
YY_ACTTAB_COUNT
 );

478 
	`as£π
–
yy_lookahód
[
i
]==
iLookAhód
 );

480  
yy_a˘i⁄
[
i
];

481 
	}
}

486 
	$yySèckOvîÊow
(
yyP¨£r
 *
yypP¨£r
, 
YYMINORTYPE
 *
yypMö‹
){

487 
P¨£ARG_FETCH
;

488 
yypP¨£r
->
yyidx
--;

489 #i‚de‡
NDEBUG


490 if–
yyTø˚FILE
 ){

491 
	`Ârötf
(
yyTø˚FILE
,"%sSèck OvîÊow!\n",
yyTø˚Prom±
);

494  
yypP¨£r
->
yyidx
>=0 ) 
	`yy_p›_∑r£r_°ack
(yypParser);

497 %% /* 
	$yy∑r£
 */ 
	`yyÀx
()

498 
P¨£ARG_STORE
;

499 
	}
}

504 
	`yy_shi·
(

505 
yyP¨£r
 *
	gyypP¨£r
,

506 
	gyyNewSèã
,

507 
	gyyMaj‹
,

508 
YYMINORTYPE
 *
	gyypMö‹


510 
yySèckE¡ry
 *
	gyytos
;

511 
	gyypP¨£r
->
	gyyidx
++;

512 #
ifdef
 
YYTRACKMAXSTACKDEPTH


513 if–
	gyypP¨£r
->
	gyyidx
>yypP¨£r->
	gyyidxMax
 ){

514 
	gyypP¨£r
->
	gyyidxMax
 = 
yypP¨£r
->
yyidx
;

516 #
ídif


517 #
YYSTACKDEPTH
>0

518 if–
	gyypP¨£r
->
	gyyidx
>=
YYSTACKDEPTH
 ){

519 
	`yySèckOvîÊow
(
yypP¨£r
, 
yypMö‹
);

523 if–
	gyypP¨£r
->
	gyyidx
>=
yypP¨£r
->
yy°ksz
 ){

524 
	`yyGrowSèck
(
yypP¨£r
);

525 if–
	gyypP¨£r
->
	gyyidx
>=
yypP¨£r
->
yy°ksz
 ){

526 
	`yySèckOvîÊow
(
yypP¨£r
, 
yypMö‹
);

530 #
ídif


531 
	gyytos
 = &
yypP¨£r
->
yy°ack
[yypP¨£r->
yyidx
];

532 
	gyytos
->
	g°©ío
 = (
YYACTIONTYPE
)
yyNewSèã
;

533 
	gyytos
->
	gmaj‹
 = (
YYCODETYPE
)
yyMaj‹
;

534 
	gyytos
->
	gmö‹
 = *
yypMö‹
;

535 #
i‚def
 
NDEBUG


536 if–
	gyyTø˚FILE
 && 
	gyypP¨£r
->
	gyyidx
>0 ){

537 
	gi
;

538 
	`Ârötf
(
	gyyTø˚FILE
,"%sShi· %d\n",
	gyyTø˚Prom±
,
	gyyNewSèã
);

539 
	`Ârötf
(
	gyyTø˚FILE
,"%sSèck:",
	gyyTø˚Prom±
);

540 
	gi
=1; i<=
yypP¨£r
->
yyidx
; i++)

541 
	`Ârötf
(
	gyyTø˚FILE
," %s",
	gyyTokíName
[
yypP¨£r
->
yy°ack
[
i
].
	gmaj‹
]);

542 
	`Ârötf
(
	gyyTø˚FILE
,"\n");

544 #
ídif


551 
YYCODETYPE
 
	mlhs
;

552 
	mƒhs
;

553 } 
	gyyRuÀInfo
[] = {

554 
	}
%%

557 
yy_ac˚±
(
yyP¨£r
*);

563 
	$yy_ªdu˚
(

564 
yyP¨£r
 *
yypP¨£r
,

565 
yyruÀno


567 
yygŸo
;

568 
yya˘
;

569 
YYMINORTYPE
 
yygŸomö‹
;

570 
yySèckE¡ry
 *
yym•
;

571 
yysize
;

572 
P¨£ARG_FETCH
;

573 
yym•
 = &
yypP¨£r
->
yy°ack
[yypP¨£r->
yyidx
];

574 #i‚de‡
NDEBUG


575 if–
yyTø˚FILE
 && 
yyruÀno
>=0

576 && 
yyruÀno
<()((
yyRuÀName
)/(yyRuleName[0])) ){

577 
	`Ârötf
(
yyTø˚FILE
, "%sRedu˚ [%s].\n", 
yyTø˚Prom±
,

578 
yyRuÀName
[
yyruÀno
]);

597 
yygŸomö‹
 = 
yyzîomö‹
;

600  
yyruÀno
 ){

609 %% /* 
	$yy∑r£
 */ 
	`yyÀx
()

610 
	}
};

611 
	`as£π
–
	gyyruÀno
>=0 && 
yyruÀno
<(
yyRuÀInfo
)/(yyRuleInfo[0]) );

612 
	gyygŸo
 = 
yyRuÀInfo
[
yyruÀno
].
lhs
;

613 
	gyysize
 = 
yyRuÀInfo
[
yyruÀno
].
ƒhs
;

614 
	gyypP¨£r
->
	gyyidx
 -
yysize
;

615 
	gyya˘
 = 
	`yy_föd_ªdu˚_a˘i⁄
(
yym•
[-
yysize
].
°©ío
,(
	gYYCODETYPE
)
	gyygŸo
);

616 if–
	gyya˘
 < 
	gYYNSTATE
 ){

617 #
ifdef
 
NDEBUG


622 if–
	gyysize
 ){

623 
	gyypP¨£r
->
	gyyidx
++;

624 
	gyym•
 -
yysize
-1;

625 
	gyym•
->
	g°©ío
 = (
YYACTIONTYPE
)
yya˘
;

626 
	gyym•
->
	gmaj‹
 = (
YYCODETYPE
)
yygŸo
;

627 
	gyym•
->
	gmö‹
 = 
yygŸomö‹
;

629 #
ídif


631 
	`yy_shi·
(
	gyypP¨£r
,
	gyya˘
,
	gyygŸo
,&
	gyygŸomö‹
);

634 
	`as£π
–
	gyya˘
 =
YYNSTATE
 + 
YYNRULE
 + 1 );

635 
	`yy_ac˚±
(
	gyypP¨£r
);

642 #
i‚def
 
YYNOERRORRECOVERY


643 
	`yy_∑r£_Áûed
(

644 
yyP¨£r
 *
	gyypP¨£r


646 
	gP¨£ARG_FETCH
;

647 #
i‚def
 
NDEBUG


648 if–
	gyyTø˚FILE
 ){

649 
	`Ârötf
(
	gyyTø˚FILE
,"%sFaû!\n",
	gyyTø˚Prom±
);

651 #
ídif


652  
	gyypP¨£r
->
	gyyidx
>=0 ) 
	`yy_p›_∑r£r_°ack
(
yypP¨£r
);

655 
	}
%%

656 
	gP¨£ARG_STORE
;

663 
	$yy_sy¡ax_îr‹
(

664 
yyP¨£r
 *
yypP¨£r
,

665 
yymaj‹
,

666 
YYMINORTYPE
 
yymö‹


668 
P¨£ARG_FETCH
;

669 
	#TOKEN
 (
yymö‹
.
yy0
)

	)

670 %% /* 
	$yy∑r£
 */ 
	`yyÀx
()

671 
P¨£ARG_STORE
;

672 
	}
}

677 
	`yy_ac˚±
(

678 
yyP¨£r
 *
	gyypP¨£r


680 
	gP¨£ARG_FETCH
;

681 #
i‚def
 
NDEBUG


682 if–
	gyyTø˚FILE
 ){

683 
	`Ârötf
(
	gyyTø˚FILE
,"%sAc˚±!\n",
	gyyTø˚Prom±
);

685 #
ídif


686  
	gyypP¨£r
->
	gyyidx
>=0 ) 
	`yy_p›_∑r£r_°ack
(
yypP¨£r
);

689 
	}
%%

690 
	gP¨£ARG_STORE
;

712 
	$P¨£
(

713 *
yyp
,

714 
yymaj‹
,

715 
P¨£TOKENTYPE
 
yymö‹


716 
P¨£ARG_PDECL


718 
YYMINORTYPE
 
yymö‹uni⁄
;

719 
yya˘
;

720 #i‡!
	`deföed
(
YYERRORSYMBOL
Ë&& !deföed(
YYNOERRORRECOVERY
)

721 
yyídoföput
;

723 #ifde‡
YYERRORSYMBOL


724 
yyîr‹hô
 = 0;

726 
yyP¨£r
 *
yypP¨£r
;

729 
yypP¨£r
 = (
yyP¨£r
*)
yyp
;

730 if–
yypP¨£r
->
yyidx
<0 ){

731 #i‡
YYSTACKDEPTH
<=0

732 if–
yypP¨£r
->
yy°ksz
 <=0 ){

734 
yymö‹uni⁄
 = 
yyzîomö‹
;

735 
	`yySèckOvîÊow
(
yypP¨£r
, &
yymö‹uni⁄
);

739 
yypP¨£r
->
yyidx
 = 0;

740 
yypP¨£r
->
yyîr˙t
 = -1;

741 
yypP¨£r
->
yy°ack
[0].
°©ío
 = 0;

742 
yypP¨£r
->
yy°ack
[0].
maj‹
 = 0;

744 
yymö‹uni⁄
.
yy0
 = 
yymö‹
;

745 #i‡!
	`deföed
(
YYERRORSYMBOL
Ë&& !deföed(
YYNOERRORRECOVERY
)

746 
yyídoföput
 = (
yymaj‹
==0);

748 
P¨£ARG_STORE
;

750 #i‚de‡
NDEBUG


751 if–
yyTø˚FILE
 ){

752 
	`Ârötf
(
yyTø˚FILE
,"%sI≈uà%s\n",
yyTø˚Prom±
,
yyTokíName
[
yymaj‹
]);

757 
yya˘
 = 
	`yy_föd_shi·_a˘i⁄
(
yypP¨£r
,(
YYCODETYPE
)
yymaj‹
);

758 if–
yya˘
<
YYNSTATE
 ){

759 
	`yy_shi·
(
yypP¨£r
,
yya˘
,
yymaj‹
,&
yymö‹uni⁄
);

760 
yypP¨£r
->
yyîr˙t
--;

761 
yymaj‹
 = 
YYNOCODE
;

762 }if–
yya˘
 < 
YYNSTATE
 + 
YYNRULE
 ){

763 
	`yy_ªdu˚
(
yypP¨£r
,
yya˘
-
YYNSTATE
);

765 
	`as£π
–
yya˘
 =
YY_ERROR_ACTION
 );

766 #ifde‡
YYERRORSYMBOL


767 
yymx
;

769 #i‚de‡
NDEBUG


770 if–
yyTø˚FILE
 ){

771 
	`Ârötf
(
yyTø˚FILE
,"%sSy¡ax Eº‹!\n",
yyTø˚Prom±
);

774 #ifde‡
YYERRORSYMBOL


794 if–
yypP¨£r
->
yyîr˙t
<0 ){

795 
	`yy_sy¡ax_îr‹
(
yypP¨£r
,
yymaj‹
,
yymö‹uni⁄
);

797 
yymx
 = 
yypP¨£r
->
yy°ack
[yypP¨£r->
yyidx
].
maj‹
;

798 if–
yymx
==
YYERRORSYMBOL
 || 
yyîr‹hô
 ){

799 #i‚de‡
NDEBUG


800 if–
yyTø˚FILE
 ){

801 
	`Ârötf
(
yyTø˚FILE
,"%sDiscard inputÅoken %s\n",

802 
yyTø˚Prom±
,
yyTokíName
[
yymaj‹
]);

805 
	`yy_de°ru˘‹
(
yypP¨£r
, (
YYCODETYPE
)
yymaj‹
,&
yymö‹uni⁄
);

806 
yymaj‹
 = 
YYNOCODE
;

809 
yypP¨£r
->
yyidx
 >= 0 &&

810 
yymx
 !
YYERRORSYMBOL
 &&

811 (
yya˘
 = 
	`yy_föd_ªdu˚_a˘i⁄
(

812 
yypP¨£r
->
yy°ack
[yypP¨£r->
yyidx
].
°©ío
,

813 
YYERRORSYMBOL
)Ë>
YYNSTATE


815 
	`yy_p›_∑r£r_°ack
(
yypP¨£r
);

817 if–
yypP¨£r
->
yyidx
 < 0 || 
yymaj‹
==0 ){

818 
	`yy_de°ru˘‹
(
yypP¨£r
,(
YYCODETYPE
)
yymaj‹
,&
yymö‹uni⁄
);

819 
	`yy_∑r£_Áûed
(
yypP¨£r
);

820 
yymaj‹
 = 
YYNOCODE
;

821 }if–
yymx
!=
YYERRORSYMBOL
 ){

822 
YYMINORTYPE
 
u2
;

823 
u2
.
YYERRSYMDT
 = 0;

824 
	`yy_shi·
(
yypP¨£r
,
yya˘
,
YYERRORSYMBOL
,&
u2
);

827 
yypP¨£r
->
yyîr˙t
 = 3;

828 
yyîr‹hô
 = 1;

829 #ñi‡
	`deföed
(
YYNOERRORRECOVERY
)

837 
	`yy_sy¡ax_îr‹
(
yypP¨£r
,
yymaj‹
,
yymö‹uni⁄
);

838 
	`yy_de°ru˘‹
(
yypP¨£r
,(
YYCODETYPE
)
yymaj‹
,&
yymö‹uni⁄
);

839 
yymaj‹
 = 
YYNOCODE
;

851 if–
yypP¨£r
->
yyîr˙t
<=0 ){

852 
	`yy_sy¡ax_îr‹
(
yypP¨£r
,
yymaj‹
,
yymö‹uni⁄
);

854 
yypP¨£r
->
yyîr˙t
 = 3;

855 
	`yy_de°ru˘‹
(
yypP¨£r
,(
YYCODETYPE
)
yymaj‹
,&
yymö‹uni⁄
);

856 if–
yyídoföput
 ){

857 
	`yy_∑r£_Áûed
(
yypP¨£r
);

859 
yymaj‹
 = 
YYNOCODE
;

862 } 
yymaj‹
!=
YYNOCODE
 && 
yypP¨£r
->
yyidx
>=0 );

864 
	}
}

	@opcodes.c

3 #i‡!
deföed
(
SQLITE_OMIT_EXPLAIN
Ë|| !deföed(
NDEBUG
Ë|| deföed(
VDBE_PROFILE
Ë|| deföed(
SQLITE_DEBUG
)

4 c⁄° *
	$sqlôe3OpcodeName
(
i
){

5 c⁄° *c⁄° 
azName
[] = { "?",

152  
azName
[
i
];

153 
	}
}

	@opcodes.h

3 
	#OP_Fun˘i⁄
 1

	)

4 
	#OP_Savïoöt
 2

	)

5 
	#OP_AutoCommô
 3

	)

6 
	#OP_Tønß˘i⁄
 4

	)

7 
	#OP_S‹ãrNext
 5

	)

8 
	#OP_Pªv
 6

	)

9 
	#OP_Next
 7

	)

10 
	#OP_AggSãp
 8

	)

11 
	#OP_Checkpoöt
 9

	)

12 
	#OP_Jou∫ÆMode
 10

	)

13 
	#OP_Vacuum
 11

	)

14 
	#OP_VFûãr
 12

	)

15 
	#OP_VUpd©e
 13

	)

16 
	#OP_GŸo
 14

	)

17 
	#OP_Gosub
 15

	)

18 
	#OP_Rëu∫
 16

	)

19 
	#OP_Yõld
 17

	)

20 
	#OP_HÆtIfNuŒ
 18

	)

21 
	#OP_NŸ
 19

	)

22 
	#OP_HÆt
 20

	)

23 
	#OP_I¡egî
 21

	)

24 
	#OP_I¡64
 22

	)

25 
	#OP_Såög
 23

	)

26 
	#OP_NuŒ
 24

	)

27 
	#OP_Blob
 25

	)

28 
	#OP_V¨übÀ
 26

	)

29 
	#OP_Move
 27

	)

30 
	#OP_C›y
 28

	)

31 
	#OP_SC›y
 29

	)

32 
	#OP_Resu…Row
 30

	)

33 
	#OP_CﬁlSeq
 31

	)

34 
	#OP_AddImm
 32

	)

35 
	#OP_Mu°BeI¡
 33

	)

36 
	#OP_RólAfföôy
 34

	)

37 
	#OP_Pîmuèti⁄
 35

	)

38 
	#OP_Com∑ª
 36

	)

39 
	#OP_Jump
 37

	)

40 
	#OP_On˚
 38

	)

41 
	#OP_If
 39

	)

42 
	#OP_IfNŸ
 40

	)

43 
	#OP_Cﬁumn
 41

	)

44 
	#OP_Afföôy
 42

	)

45 
	#OP_MakeRec‹d
 43

	)

46 
	#OP_Cou¡
 44

	)

47 
	#OP_RódCookõ
 45

	)

48 
	#OP_SëCookõ
 46

	)

49 
	#OP_VîifyCookõ
 47

	)

50 
	#OP_O≥nRód
 48

	)

51 
	#OP_O≥nWrôe
 49

	)

52 
	#OP_O≥nAutoödex
 50

	)

53 
	#OP_O≥nEphemîÆ
 51

	)

54 
	#OP_S‹ãrO≥n
 52

	)

55 
	#OP_O≥nP£udo
 53

	)

56 
	#OP_Clo£
 54

	)

57 
	#OP_SìkLt
 55

	)

58 
	#OP_SìkLe
 56

	)

59 
	#OP_SìkGe
 57

	)

60 
	#OP_SìkGt
 58

	)

61 
	#OP_Sìk
 59

	)

62 
	#OP_NŸFound
 60

	)

63 
	#OP_Found
 61

	)

64 
	#OP_IsUnique
 62

	)

65 
	#OP_NŸExi°s
 63

	)

66 
	#OP_Sequí˚
 64

	)

67 
	#OP_NewRowid
 65

	)

68 
	#OP_In£π
 66

	)

69 
	#OP_In£πI¡
 67

	)

70 
	#OP_Or
 68

	)

71 
	#OP_And
 69

	)

72 
	#OP_Dñëe
 70

	)

73 
	#OP_Re£tCou¡
 71

	)

74 
	#OP_S‹ãrCom∑ª
 72

	)

75 
	#OP_IsNuŒ
 73

	)

76 
	#OP_NŸNuŒ
 74

	)

77 
	#OP_Ne
 75

	)

78 
	#OP_Eq
 76

	)

79 
	#OP_Gt
 77

	)

80 
	#OP_Le
 78

	)

81 
	#OP_Lt
 79

	)

82 
	#OP_Ge
 80

	)

83 
	#OP_S‹ãrD©a
 81

	)

84 
	#OP_BôAnd
 82

	)

85 
	#OP_BôOr
 83

	)

86 
	#OP_Shi·Le·
 84

	)

87 
	#OP_Shi·Right
 85

	)

88 
	#OP_Add
 86

	)

89 
	#OP_Subåa˘
 87

	)

90 
	#OP_Mu…ùly
 88

	)

91 
	#OP_Divide
 89

	)

92 
	#OP_Remaödî
 90

	)

93 
	#OP_C⁄ˇt
 91

	)

94 
	#OP_RowKey
 92

	)

95 
	#OP_BôNŸ
 93

	)

96 
	#OP_Såög8
 94

	)

97 
	#OP_RowD©a
 95

	)

98 
	#OP_Rowid
 96

	)

99 
	#OP_NuŒRow
 97

	)

100 
	#OP_La°
 98

	)

101 
	#OP_S‹ãrS‹t
 99

	)

102 
	#OP_S‹t
 100

	)

103 
	#OP_Rewöd
 101

	)

104 
	#OP_S‹ãrIn£π
 102

	)

105 
	#OP_IdxIn£π
 103

	)

106 
	#OP_IdxDñëe
 104

	)

107 
	#OP_IdxRowid
 105

	)

108 
	#OP_IdxLT
 106

	)

109 
	#OP_IdxGE
 107

	)

110 
	#OP_De°roy
 108

	)

111 
	#OP_CÀ¨
 109

	)

112 
	#OP_Cª©eIndex
 110

	)

113 
	#OP_Cª©eTabÀ
 111

	)

114 
	#OP_P¨£Schema
 112

	)

115 
	#OP_LﬂdA«lysis
 113

	)

116 
	#OP_Dr›TabÀ
 114

	)

117 
	#OP_Dr›Index
 115

	)

118 
	#OP_Dr›Triggî
 116

	)

119 
	#OP_I¡egrôyCk
 117

	)

120 
	#OP_RowSëAdd
 118

	)

121 
	#OP_RowSëRód
 119

	)

122 
	#OP_RowSëTe°
 120

	)

123 
	#OP_Progøm
 121

	)

124 
	#OP_P¨am
 122

	)

125 
	#OP_FkCou¡î
 123

	)

126 
	#OP_FkIfZîo
 124

	)

127 
	#OP_MemMax
 125

	)

128 
	#OP_IfPos
 126

	)

129 
	#OP_IfNeg
 127

	)

130 
	#OP_IfZîo
 128

	)

131 
	#OP_AggFöÆ
 129

	)

132 
	#OP_Ról
 130

	)

133 
	#OP_In¸Vacuum
 131

	)

134 
	#OP_Expúe
 132

	)

135 
	#OP_TabÀLock
 133

	)

136 
	#OP_VBegö
 134

	)

137 
	#OP_VCª©e
 135

	)

138 
	#OP_VDe°roy
 136

	)

139 
	#OP_VO≥n
 137

	)

140 
	#OP_VCﬁumn
 138

	)

141 
	#OP_VNext
 139

	)

142 
	#OP_VRíame
 140

	)

143 
	#OP_Pagecou¡
 141

	)

144 
	#OP_MaxPg˙t
 142

	)

145 
	#OP_Tø˚
 143

	)

146 
	#OP_No›
 144

	)

147 
	#OP_Ex∂aö
 145

	)

154 
	#OPFLG_JUMP
 0x0001

	)

155 
	#OPFLG_OUT2_PRERELEASE
 0x0002

	)

156 
	#OPFLG_IN1
 0x0004

	)

157 
	#OPFLG_IN2
 0x0008

	)

158 
	#OPFLG_IN3
 0x0010

	)

159 
	#OPFLG_OUT2
 0x0020

	)

160 
	#OPFLG_OUT3
 0x0040

	)

161 
	#OPFLG_INITIALIZER
 {\

180  0x00, 0x00,}

	)

	@parse.c

12 
	~<°dio.h
>

15 
	~"sqlôeI¡.h
"

21 
	#YYNOERRORRECOVERY
 1

	)

26 
	#yyã°ˇ£
(
X
Ë
	`ã°ˇ£
(X)

	)

32 
	sLimôVÆ
 {

33 
Ex¥
 *
	mpLimô
;

34 
Ex¥
 *
	mpOff£t
;

41 
	sLikeOp
 {

42 
Tokí
 
	meO≥øt‹
;

43 
	mbNŸ
;

55 
	sTrigEvít
 { 
	ma
; 
IdLi°
 * 
	mb
; };

60 
	sAâachKey
 { 
	mty≥
; 
Tokí
 
	mkey
; };

65 
	sVÆueLi°
 {

66 
Ex¥Li°
 *
	mpLi°
;

67 
Sñe˘
 *
	mpSñe˘
;

76 
	$•™Së
(
Ex¥S∑n
 *
pOut
, 
Tokí
 *
pSèπ
, Tokí *
pEnd
){

77 
pOut
->
zSèπ
 = 
pSèπ
->
z
;

78 
pOut
->
zEnd
 = &
pEnd
->
z
[pEnd->
n
];

79 
	}
}

85 
	$•™Ex¥
(
Ex¥S∑n
 *
pOut
, 
P¨£
 *
pP¨£
, 
›
, 
Tokí
 *
pVÆue
){

86 
pOut
->
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
›
, 0, 0, 
pVÆue
);

87 
pOut
->
zSèπ
 = 
pVÆue
->
z
;

88 
pOut
->
zEnd
 = &
pVÆue
->
z
[pVÆue->
n
];

89 
	}
}

95 
	$•™Bö¨yEx¥
(

96 
Ex¥S∑n
 *
pOut
,

97 
P¨£
 *
pP¨£
,

98 
›
,

99 
Ex¥S∑n
 *
pLe·
,

100 
Ex¥S∑n
 *
pRight


102 
pOut
->
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
›
, 
pLe·
->pEx¥, 
pRight
->pExpr, 0);

103 
pOut
->
zSèπ
 = 
pLe·
->zStart;

104 
pOut
->
zEnd
 = 
pRight
->zEnd;

105 
	}
}

110 
	$•™U«ryPo°fix
(

111 
Ex¥S∑n
 *
pOut
,

112 
P¨£
 *
pP¨£
,

113 
›
,

114 
Ex¥S∑n
 *
pO≥ønd
,

115 
Tokí
 *
pPo°Op


117 
pOut
->
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
›
, 
pO≥ønd
->pExpr, 0, 0);

118 
pOut
->
zSèπ
 = 
pO≥ønd
->zStart;

119 
pOut
->
zEnd
 = &
pPo°Op
->
z
[pPo°Op->
n
];

120 
	}
}

125 
	$bö¨yToU«ryIfNuŒ
(
P¨£
 *
pP¨£
, 
Ex¥
 *
pY
, Ex¥ *
pA
, 
›
){

126 
sqlôe3
 *
db
 = 
pP¨£
->db;

127 if–
db
->
mÆlocFaûed
==0 && 
pY
->
›
==
TK_NULL
 ){

128 
pA
->
›
 = (
u8
)op;

129 
	`sqlôe3Ex¥Dñëe
(
db
, 
pA
->
pRight
);

130 
pA
->
pRight
 = 0;

132 
	}
}

137 
	$•™U«ryPªfix
(

138 
Ex¥S∑n
 *
pOut
,

139 
P¨£
 *
pP¨£
,

140 
›
,

141 
Ex¥S∑n
 *
pO≥ønd
,

142 
Tokí
 *
pPªOp


144 
pOut
->
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
›
, 
pO≥ønd
->pExpr, 0, 0);

145 
pOut
->
zSèπ
 = 
pPªOp
->
z
;

146 
pOut
->
zEnd
 = 
pO≥ønd
->zEnd;

147 
	}
}

161 #i‚de‡
INTERFACE


162 
	#INTERFACE
 1

	)

198 
	#YYCODETYPE
 

	)

199 
	#YYNOCODE
 249

	)

200 
	#YYACTIONTYPE
 

	)

201 
	#YYWILDCARD
 67

	)

202 
	#sqlôe3P¨£rTOKENTYPE
 
Tokí


	)

204 
	myyöô
;

205 
sqlôe3P¨£rTOKENTYPE
 
	myy0
;

206 
Sñe˘
* 
	myy43
;

207 
TriggîSãp
* 
	myy75
;

208 
LimôVÆ
 
	myy84
;

209 
Ex¥S∑n
 
	myy86
;

210 
LikeOp
 
	myy87
;

211 °ru˘ {
	mvÆue
; 
	mmask
;} 
	myy207
;

212 
Ex¥Li°
* 
	myy242
;

213 
u8
 
	myy306
;

214 
	myy316
;

215 
VÆueLi°
 
	myy323
;

216 
IdLi°
* 
	myy352
;

217 
TrigEvít
 
	myy354
;

218 
SrcLi°
* 
	myy419
;

219 
Ex¥
* 
	myy450
;

220 
u16
 
	myy473
;

221 } 
	tYYMINORTYPE
;

222 #i‚de‡
YYSTACKDEPTH


223 
	#YYSTACKDEPTH
 100

	)

225 
	#sqlôe3P¨£rARG_SDECL
 
P¨£
 *
pP¨£
;

	)

226 
	#sqlôe3P¨£rARG_PDECL
 ,
P¨£
 *
pP¨£


	)

227 
	#sqlôe3P¨£rARG_FETCH
 
P¨£
 *
pP¨£
 = 
yypP¨£r
->
	)
pParse

228 
	#sqlôe3P¨£rARG_STORE
 
yypP¨£r
->
pP¨£
 = 
	)
pParse

229 
	#YYNSTATE
 627

	)

230 
	#YYNRULE
 324

	)

231 
	#YYFALLBACK
 1

	)

232 
	#YY_NO_ACTION
 (
YYNSTATE
+
YYNRULE
+2)

	)

233 
	#YY_ACCEPT_ACTION
 (
YYNSTATE
+
YYNRULE
+1)

	)

234 
	#YY_ERROR_ACTION
 (
YYNSTATE
+
YYNRULE
)

	)

238 c⁄° 
YYMINORTYPE
 
	gyyzîomö‹
 = { 0 };

248 #i‚de‡
yyã°ˇ£


249 
	#yyã°ˇ£
(
X
)

	)

300 
	#YY_ACTTAB_COUNT
 (1576)

	)

301 c⁄° 
YYACTIONTYPE
 
	gyy_a˘i⁄
[] = {

461 c⁄° 
YYCODETYPE
 
	gyy_lookahód
[] = {

621 
	#YY_SHIFT_USE_DFLT
 (-70)

	)

622 
	#YY_SHIFT_COUNT
 (418)

	)

623 
	#YY_SHIFT_MIN
 (-69)

	)

624 
	#YY_SHIFT_MAX
 (1490)

	)

625 c⁄° 
	gyy_shi·_of°
[] = {

669 
	#YY_REDUCE_USE_DFLT
 (-169)

	)

670 
	#YY_REDUCE_COUNT
 (310)

	)

671 
	#YY_REDUCE_MIN
 (-168)

	)

672 
	#YY_REDUCE_MAX
 (1396)

	)

673 c⁄° 
	gyy_ªdu˚_of°
[] = {

707 c⁄° 
YYACTIONTYPE
 
	gyy_deÁu…
[] = {

783 #ifde‡
YYFALLBACK


784 c⁄° 
YYCODETYPE
 
	gyyFÆlback
[] = {

867 
	syySèckE¡ry
 {

868 
YYACTIONTYPE
 
	m°©ío
;

869 
YYCODETYPE
 
	mmaj‹
;

871 
YYMINORTYPE
 
	mmö‹
;

874 
yySèckE¡ry
 
	tyySèckE¡ry
;

878 
	syyP¨£r
 {

879 
	myyidx
;

880 #ifde‡
YYTRACKMAXSTACKDEPTH


881 
	myyidxMax
;

883 
	myyîr˙t
;

884 
	msqlôe3P¨£rARG_SDECL


885 #i‡
YYSTACKDEPTH
<=0

886 
	myy°ksz
;

887 
yySèckE¡ry
 *
	myy°ack
;

889 
yySèckE¡ry
 
	myy°ack
[
YYSTACKDEPTH
];

892 
yyP¨£r
 
	tyyP¨£r
;

894 #i‚de‡
NDEBUG


895 
	~<°dio.h
>

896 
FILE
 *
	gyyTø˚FILE
 = 0;

897 *
	gyyTø˚Prom±
 = 0;

900 #i‚de‡
NDEBUG


918 
	$sqlôe3P¨£rTø˚
(
FILE
 *
Tø˚FILE
, *
zTø˚Prom±
){

919 
yyTø˚FILE
 = 
Tø˚FILE
;

920 
yyTø˚Prom±
 = 
zTø˚Prom±
;

921 if–
yyTø˚FILE
==0 ) 
yyTø˚Prom±
 = 0;

922 if–
yyTø˚Prom±
==0 ) 
yyTø˚FILE
 = 0;

923 
	}
}

926 #i‚de‡
NDEBUG


929 c⁄° *c⁄° 
	gyyTokíName
[] = {

995 #i‚de‡
NDEBUG


998 c⁄° *c⁄° 
	gyyRuÀName
[] = {

1327 #i‡
YYSTACKDEPTH
<=0

1331 
	$yyGrowSèck
(
yyP¨£r
 *
p
){

1332 
√wSize
;

1333 
yySèckE¡ry
 *
pNew
;

1335 
√wSize
 = 
p
->
yy°ksz
*2 + 100;

1336 
pNew
 = 
	`ªÆloc
(
p
->
yy°ack
, 
√wSize
*(pNew[0]));

1337 if–
pNew
 ){

1338 
p
->
yy°ack
 = 
pNew
;

1339 
p
->
yy°ksz
 = 
√wSize
;

1340 #i‚de‡
NDEBUG


1341 if–
yyTø˚FILE
 ){

1342 
	`Ârötf
(
yyTø˚FILE
,"%sStack growsÅo %dÉntries!\n",

1343 
yyTø˚Prom±
, 
p
->
yy°ksz
);

1347 
	}
}

1362 *
sqlôe3P¨£rAŒoc
(*(*
mÆlocProc
)(
size_t
)){

1363 
yyP¨£r
 *
	gpP¨£r
;

1364 
	gpP¨£r
 = (
yyP¨£r
*)(*
mÆlocProc
)–(
size_t
)(yyParser) );

1365 if–
	gpP¨£r
 ){

1366 
	gpP¨£r
->
	gyyidx
 = -1;

1367 #ifde‡
YYTRACKMAXSTACKDEPTH


1368 
	gpP¨£r
->
	gyyidxMax
 = 0;

1370 #i‡
YYSTACKDEPTH
<=0

1371 
	gpP¨£r
->
	gyy°ack
 = 
NULL
;

1372 
	gpP¨£r
->
	gyy°ksz
 = 0;

1373 
yyGrowSèck
(
pP¨£r
);

1376  
	gpP¨£r
;

1384 
	$yy_de°ru˘‹
(

1385 
yyP¨£r
 *
yypP¨£r
,

1386 
YYCODETYPE
 
yymaj‹
,

1387 
YYMINORTYPE
 *
yypmö‹


1389 
sqlôe3P¨£rARG_FETCH
;

1390  
yymaj‹
 ){

1405 
	`sqlôe3Sñe˘Dñëe
(
pP¨£
->
db
, (
yypmö‹
->
yy43
));

1413 
	`sqlôe3Ex¥Dñëe
(
pP¨£
->
db
, (
yypmö‹
->
yy86
).
pEx¥
);

1430 
	`sqlôe3Ex¥Li°Dñëe
(
pP¨£
->
db
, (
yypmö‹
->
yy242
));

1440 
	`sqlôe3SrcLi°Dñëe
(
pP¨£
->
db
, (
yypmö‹
->
yy419
));

1453 
	`sqlôe3Ex¥Dñëe
(
pP¨£
->
db
, (
yypmö‹
->
yy450
));

1462 
	`sqlôe3IdLi°Dñëe
(
pP¨£
->
db
, (
yypmö‹
->
yy352
));

1470 
	`sqlôe3Ex¥Li°Dñëe
(
pP¨£
->
db
, (
yypmö‹
->
yy323
).
pLi°
);

1471 
	`sqlôe3Sñe˘Dñëe
(
pP¨£
->
db
, (
yypmö‹
->
yy323
).
pSñe˘
);

1480 
	`sqlôe3DñëeTriggîSãp
(
pP¨£
->
db
, (
yypmö‹
->
yy75
));

1487 
	`sqlôe3IdLi°Dñëe
(
pP¨£
->
db
, (
yypmö‹
->
yy354
).
b
);

1493 
	}
}

1503 
	$yy_p›_∑r£r_°ack
(
yyP¨£r
 *
pP¨£r
){

1504 
YYCODETYPE
 
yymaj‹
;

1505 
yySèckE¡ry
 *
yytos
 = &
pP¨£r
->
yy°ack
[pP¨£r->
yyidx
];

1509 if–
	`NEVER
(
pP¨£r
->
yyidx
<0) )  0;

1510 #i‚de‡
NDEBUG


1511 if–
yyTø˚FILE
 && 
pP¨£r
->
yyidx
>=0 ){

1512 
	`Ârötf
(
yyTø˚FILE
,"%sPopping %s\n",

1513 
yyTø˚Prom±
,

1514 
yyTokíName
[
yytos
->
maj‹
]);

1517 
yymaj‹
 = 
yytos
->
maj‹
;

1518 
	`yy_de°ru˘‹
(
pP¨£r
, 
yymaj‹
, &
yytos
->
mö‹
);

1519 
pP¨£r
->
yyidx
--;

1520  
yymaj‹
;

1521 
	}
}

1535 
sqlôe3P¨£rFªe
(

1536 *
p
,

1537 (*
‰ìProc
)(*)

1539 
yyP¨£r
 *
pP¨£r
 = (yyP¨£r*)
p
;

1542 if–
	`NEVER
(
pP¨£r
==0) ) ;

1543  
pP¨£r
->
yyidx
>=0 ) 
	`yy_p›_∑r£r_°ack
(pParser);

1544 #i‡
YYSTACKDEPTH
<=0

1545 
	`‰ì
(
pP¨£r
->
yy°ack
);

1547 (*
‰ìProc
)((*)
pP¨£r
);

1548 
	}
}

1553 #ifde‡
YYTRACKMAXSTACKDEPTH


1554 
	$sqlôe3P¨£rSèckPók
(*
p
){

1555 
yyP¨£r
 *
pP¨£r
 = (yyP¨£r*)
p
;

1556  
pP¨£r
->
yyidxMax
;

1557 
	}
}

1568 
	$yy_föd_shi·_a˘i⁄
(

1569 
yyP¨£r
 *
pP¨£r
,

1570 
YYCODETYPE
 
iLookAhód


1572 
i
;

1573 
°©ío
 = 
pP¨£r
->
yy°ack
[pP¨£r->
yyidx
].stateno;

1575 if–
°©ío
>
YY_SHIFT_COUNT


1576 || (
i
 = 
yy_shi·_of°
[
°©ío
])==
YY_SHIFT_USE_DFLT
 ){

1577  
yy_deÁu…
[
°©ío
];

1579 
	`as£π
–
iLookAhód
!=
YYNOCODE
 );

1580 
i
 +
iLookAhód
;

1581 if–
i
<0 || i>=
YY_ACTTAB_COUNT
 || 
yy_lookahód
[i]!=
iLookAhód
 ){

1582 if–
iLookAhód
>0 ){

1583 #ifde‡
YYFALLBACK


1584 
YYCODETYPE
 
iFÆlback
;

1585 if–
iLookAhód
<(
yyFÆlback
)/(yyFallback[0])

1586 && (
iFÆlback
 = 
yyFÆlback
[
iLookAhód
])!=0 ){

1587 #i‚de‡
NDEBUG


1588 if–
yyTø˚FILE
 ){

1589 
	`Ârötf
(
yyTø˚FILE
, "%sFALLBACK %s => %s\n",

1590 
yyTø˚Prom±
, 
yyTokíName
[
iLookAhód
], yyTokíName[
iFÆlback
]);

1593  
	`yy_föd_shi·_a˘i⁄
(
pP¨£r
, 
iFÆlback
);

1596 #ifde‡
YYWILDCARD


1598 
j
 = 
i
 - 
iLookAhód
 + 
YYWILDCARD
;

1600 #i‡
YY_SHIFT_MIN
+
YYWILDCARD
<0

1601 
j
>=0 &&

1603 #i‡
YY_SHIFT_MAX
+
YYWILDCARD
>=
YY_ACTTAB_COUNT


1604 
j
<
YY_ACTTAB_COUNT
 &&

1606 
yy_lookahód
[
j
]==
YYWILDCARD


1608 #i‚de‡
NDEBUG


1609 if–
yyTø˚FILE
 ){

1610 
	`Ârötf
(
yyTø˚FILE
, "%sWILDCARD %s => %s\n",

1611 
yyTø˚Prom±
, 
yyTokíName
[
iLookAhód
], yyTokíName[
YYWILDCARD
]);

1614  
yy_a˘i⁄
[
j
];

1619  
yy_deÁu…
[
°©ío
];

1621  
yy_a˘i⁄
[
i
];

1623 
	}
}

1633 
	$yy_föd_ªdu˚_a˘i⁄
(

1634 
°©ío
,

1635 
YYCODETYPE
 
iLookAhód


1637 
i
;

1638 #ifde‡
YYERRORSYMBOL


1639 if–
°©ío
>
YY_REDUCE_COUNT
 ){

1640  
yy_deÁu…
[
°©ío
];

1643 
	`as£π
–
°©ío
<=
YY_REDUCE_COUNT
 );

1645 
i
 = 
yy_ªdu˚_of°
[
°©ío
];

1646 
	`as£π
–
i
!=
YY_REDUCE_USE_DFLT
 );

1647 
	`as£π
–
iLookAhód
!=
YYNOCODE
 );

1648 
i
 +
iLookAhód
;

1649 #ifde‡
YYERRORSYMBOL


1650 if–
i
<0 || i>=
YY_ACTTAB_COUNT
 || 
yy_lookahód
[i]!=
iLookAhód
 ){

1651  
yy_deÁu…
[
°©ío
];

1654 
	`as£π
–
i
>=0 && i<
YY_ACTTAB_COUNT
 );

1655 
	`as£π
–
yy_lookahód
[
i
]==
iLookAhód
 );

1657  
yy_a˘i⁄
[
i
];

1658 
	}
}

1663 
	$yySèckOvîÊow
(
yyP¨£r
 *
yypP¨£r
, 
YYMINORTYPE
 *
yypMö‹
){

1664 
sqlôe3P¨£rARG_FETCH
;

1665 
yypP¨£r
->
yyidx
--;

1666 #i‚de‡
NDEBUG


1667 if–
yyTø˚FILE
 ){

1668 
	`Ârötf
(
yyTø˚FILE
,"%sSèck OvîÊow!\n",
yyTø˚Prom±
);

1671  
yypP¨£r
->
yyidx
>=0 ) 
	`yy_p›_∑r£r_°ack
(yypParser);

1676 
	`UNUSED_PARAMETER
(
yypMö‹
);

1677 
	`sqlôe3Eº‹Msg
(
pP¨£
, "parser stack overflow");

1679 
sqlôe3P¨£rARG_STORE
;

1680 
	}
}

1685 
	$yy_shi·
(

1686 
yyP¨£r
 *
yypP¨£r
,

1687 
yyNewSèã
,

1688 
yyMaj‹
,

1689 
YYMINORTYPE
 *
yypMö‹


1691 
yySèckE¡ry
 *
yytos
;

1692 
yypP¨£r
->
yyidx
++;

1693 #ifde‡
YYTRACKMAXSTACKDEPTH


1694 if–
yypP¨£r
->
yyidx
>yypP¨£r->
yyidxMax
 ){

1695 
yypP¨£r
->
yyidxMax
 = yypP¨£r->
yyidx
;

1698 #i‡
YYSTACKDEPTH
>0

1699 if–
yypP¨£r
->
yyidx
>=
YYSTACKDEPTH
 ){

1700 
	`yySèckOvîÊow
(
yypP¨£r
, 
yypMö‹
);

1704 if–
yypP¨£r
->
yyidx
>=yypP¨£r->
yy°ksz
 ){

1705 
	`yyGrowSèck
(
yypP¨£r
);

1706 if–
yypP¨£r
->
yyidx
>=yypP¨£r->
yy°ksz
 ){

1707 
	`yySèckOvîÊow
(
yypP¨£r
, 
yypMö‹
);

1712 
yytos
 = &
yypP¨£r
->
yy°ack
[yypP¨£r->
yyidx
];

1713 
yytos
->
°©ío
 = (
YYACTIONTYPE
)
yyNewSèã
;

1714 
yytos
->
maj‹
 = (
YYCODETYPE
)
yyMaj‹
;

1715 
yytos
->
mö‹
 = *
yypMö‹
;

1716 #i‚de‡
NDEBUG


1717 if–
yyTø˚FILE
 && 
yypP¨£r
->
yyidx
>0 ){

1718 
i
;

1719 
	`Ârötf
(
yyTø˚FILE
,"%sShi· %d\n",
yyTø˚Prom±
,
yyNewSèã
);

1720 
	`Ârötf
(
yyTø˚FILE
,"%sSèck:",
yyTø˚Prom±
);

1721 
i
=1; i<=
yypP¨£r
->
yyidx
; i++)

1722 
	`Ârötf
(
yyTø˚FILE
," %s",
yyTokíName
[
yypP¨£r
->
yy°ack
[
i
].
maj‹
]);

1723 
	`Ârötf
(
yyTø˚FILE
,"\n");

1726 
	}
}

1732 
YYCODETYPE
 
	mlhs
;

1733 
	mƒhs
;

1734 } 
	gyyRuÀInfo
[] = {

2061 
yy_ac˚±
(
yyP¨£r
*);

2067 
	$yy_ªdu˚
(

2068 
yyP¨£r
 *
yypP¨£r
,

2069 
yyruÀno


2071 
yygŸo
;

2072 
yya˘
;

2073 
YYMINORTYPE
 
yygŸomö‹
;

2074 
yySèckE¡ry
 *
yym•
;

2075 
yysize
;

2076 
sqlôe3P¨£rARG_FETCH
;

2077 
yym•
 = &
yypP¨£r
->
yy°ack
[yypP¨£r->
yyidx
];

2078 #i‚de‡
NDEBUG


2079 if–
yyTø˚FILE
 && 
yyruÀno
>=0

2080 && 
yyruÀno
<()((
yyRuÀName
)/(yyRuleName[0])) ){

2081 
	`Ârötf
(
yyTø˚FILE
, "%sRedu˚ [%s].\n", 
yyTø˚Prom±
,

2082 
yyRuÀName
[
yyruÀno
]);

2101 
yygŸomö‹
 = 
yyzîomö‹
;

2104  
yyruÀno
 ){

2115 { 
	`sqlôe3BegöP¨£
(
pP¨£
, 0); }

2120 { 
	`sqlôe3BegöP¨£
(
pP¨£
, 1); }

2125 { 
	`sqlôe3BegöP¨£
(
pP¨£
, 2); }

2130 { 
	`sqlôe3FöishCodög
(
pP¨£
); }

2135 {
	`sqlôe3BegöTønß˘i⁄
(
pP¨£
, 
yym•
[-1].
mö‹
.
yy316
);}

2140 {
yygŸomö‹
.
yy316
 = 
TK_DEFERRED
;}

2144 15: 
	`yyã°ˇ£
(
yyruÀno
==15);

2145 16: 
	`yyã°ˇ£
(
yyruÀno
==16);

2146 115: 
	`yyã°ˇ£
(
yyruÀno
==115);

2147 117: 
	`yyã°ˇ£
(
yyruÀno
==117);

2149 {
yygŸomö‹
.
yy316
 = 
yym•
[0].
maj‹
;}

2153 18: 
	`yyã°ˇ£
(
yyruÀno
==18);

2155 {
	`sqlôe3CommôTønß˘i⁄
(
pP¨£
);}

2160 {
	`sqlôe3RﬁlbackTønß˘i⁄
(
pP¨£
);}

2166 
	`sqlôe3Savïoöt
(
pP¨£
, 
SAVEPOINT_BEGIN
, &
yym•
[0].
mö‹
.
yy0
);

2173 
	`sqlôe3Savïoöt
(
pP¨£
, 
SAVEPOINT_RELEASE
, &
yym•
[0].
mö‹
.
yy0
);

2180 
	`sqlôe3Savïoöt
(
pP¨£
, 
SAVEPOINT_ROLLBACK
, &
yym•
[0].
mö‹
.
yy0
);

2187 
	`sqlôe3SèπTabÀ
(
pP¨£
,&
yym•
[-1].
mö‹
.
yy0
,&yym•[0].mö‹.yy0,yym•[-4].mö‹.
yy316
,0,0,yymsp[-2].minor.yy316);

2194 
pP¨£
->
db
->
lookaside
.
bE«bÀd
 = 0;

2195 
yygŸomö‹
.
yy0
 = 
yym•
[0].
mö‹
.yy0;

2200 31: 
	`yyã°ˇ£
(
yyruÀno
==31);

2201 69: 
	`yyã°ˇ£
(
yyruÀno
==69);

2202 82: 
	`yyã°ˇ£
(
yyruÀno
==82);

2203 84: 
	`yyã°ˇ£
(
yyruÀno
==84);

2204 86: 
	`yyã°ˇ£
(
yyruÀno
==86);

2205 98: 
	`yyã°ˇ£
(
yyruÀno
==98);

2206 109: 
	`yyã°ˇ£
(
yyruÀno
==109);

2207 221: 
	`yyã°ˇ£
(
yyruÀno
==221);

2208 224: 
	`yyã°ˇ£
(
yyruÀno
==224);

2210 {
yygŸomö‹
.
yy316
 = 0;}

2214 30: 
	`yyã°ˇ£
(
yyruÀno
==30);

2215 70: 
	`yyã°ˇ£
(
yyruÀno
==70);

2216 85: 
	`yyã°ˇ£
(
yyruÀno
==85);

2217 108: 
	`yyã°ˇ£
(
yyruÀno
==108);

2218 222: 
	`yyã°ˇ£
(
yyruÀno
==222);

2219 225: 
	`yyã°ˇ£
(
yyruÀno
==225);

2221 {
yygŸomö‹
.
yy316
 = 1;}

2227 
	`sqlôe3EndTabÀ
(
pP¨£
,&
yym•
[-1].
mö‹
.
yy0
,&yymsp[0].minor.yy0,0);

2234 
	`sqlôe3EndTabÀ
(
pP¨£
,0,0,
yym•
[0].
mö‹
.
yy43
);

2235 
	`sqlôe3Sñe˘Dñëe
(
pP¨£
->
db
, 
yym•
[0].
mö‹
.
yy43
);

2242 
yygŸomö‹
.
yy0
.
z
 = 
yym•
[-2].
mö‹
.yy0.z;

2243 
yygŸomö‹
.
yy0
.
n
 = ()(
pP¨£
->
sLa°Tokí
.
z
-
yym•
[-2].
mö‹
.yy0.z) +ÖParse->sLastToken.n;

2250 
	`sqlôe3AddCﬁumn
(
pP¨£
,&
yym•
[0].
mö‹
.
yy0
);

2251 
yygŸomö‹
.
yy0
 = 
yym•
[0].
mö‹
.yy0;

2252 
pP¨£
->
c⁄°øötName
.
n
 = 0;

2257 39: 
	`yyã°ˇ£
(
yyruÀno
==39);

2258 40: 
	`yyã°ˇ£
(
yyruÀno
==40);

2259 41: 
	`yyã°ˇ£
(
yyruÀno
==41);

2260 42: 
	`yyã°ˇ£
(
yyruÀno
==42);

2261 43: 
	`yyã°ˇ£
(
yyruÀno
==43);

2262 46: 
	`yyã°ˇ£
(
yyruÀno
==46);

2263 49: 
	`yyã°ˇ£
(
yyruÀno
==49);

2264 127: 
	`yyã°ˇ£
(
yyruÀno
==127);

2265 128: 
	`yyã°ˇ£
(
yyruÀno
==128);

2266 138: 
	`yyã°ˇ£
(
yyruÀno
==138);

2267 147: 
	`yyã°ˇ£
(
yyruÀno
==147);

2268 250: 
	`yyã°ˇ£
(
yyruÀno
==250);

2269 259: 
	`yyã°ˇ£
(
yyruÀno
==259);

2270 260: 
	`yyã°ˇ£
(
yyruÀno
==260);

2271 261: 
	`yyã°ˇ£
(
yyruÀno
==261);

2272 262: 
	`yyã°ˇ£
(
yyruÀno
==262);

2273 263: 
	`yyã°ˇ£
(
yyruÀno
==263);

2274 264: 
	`yyã°ˇ£
(
yyruÀno
==264);

2275 265: 
	`yyã°ˇ£
(
yyruÀno
==265);

2276 266: 
	`yyã°ˇ£
(
yyruÀno
==266);

2277 267: 
	`yyã°ˇ£
(
yyruÀno
==267);

2278 283: 
	`yyã°ˇ£
(
yyruÀno
==283);

2280 {
yygŸomö‹
.
yy0
 = 
yym•
[0].
mö‹
.yy0;}

2285 {
	`sqlôe3AddCﬁumnTy≥
(
pP¨£
,&
yym•
[0].
mö‹
.
yy0
);}

2291 
yygŸomö‹
.
yy0
.
z
 = 
yym•
[-3].
mö‹
.yy0.z;

2292 
yygŸomö‹
.
yy0
.
n
 = ()(&
yym•
[0].
mö‹
.yy0.
z
[yymsp[0].minor.yy0.n] - yymsp[-3].minor.yy0.z);

2299 
yygŸomö‹
.
yy0
.
z
 = 
yym•
[-5].
mö‹
.yy0.z;

2300 
yygŸomö‹
.
yy0
.
n
 = ()(&
yym•
[0].
mö‹
.yy0.
z
[yymsp[0].minor.yy0.n] - yymsp[-5].minor.yy0.z);

2306 {
yygŸomö‹
.
yy0
.
z
=
yym•
[-1].
mö‹
.yy0.z; yygŸomö‹.yy0.
n
=yymsp[0].minor.yy0.n+()(yymsp[0].minor.yy0.z-yymsp[-1].minor.yy0.z);}

2310 93: 
	`yyã°ˇ£
(
yyruÀno
==93);

2312 {
pP¨£
->
c⁄°øötName
 = 
yym•
[0].
mö‹
.
yy0
;}

2316 58: 
	`yyã°ˇ£
(
yyruÀno
==58);

2318 {
	`sqlôe3AddDeÁu…VÆue
(
pP¨£
,&
yym•
[0].
mö‹
.
yy86
);}

2323 {
	`sqlôe3AddDeÁu…VÆue
(
pP¨£
,&
yym•
[-1].
mö‹
.
yy86
);}

2329 
Ex¥S∑n
 
v
;

2330 
v
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_UMINUS
, 
yym•
[0].
mö‹
.
yy86
.pExpr, 0, 0);

2331 
v
.
zSèπ
 = 
yym•
[-1].
mö‹
.
yy0
.
z
;

2332 
v
.
zEnd
 = 
yym•
[0].
mö‹
.
yy86
.zEnd;

2333 
	`sqlôe3AddDeÁu…VÆue
(
pP¨£
,&
v
);

2340 
Ex¥S∑n
 
v
;

2341 
	`•™Ex¥
(&
v
, 
pP¨£
, 
TK_STRING
, &
yym•
[0].
mö‹
.
yy0
);

2342 
	`sqlôe3AddDeÁu…VÆue
(
pP¨£
,&
v
);

2348 {
	`sqlôe3AddNŸNuŒ
(
pP¨£
, 
yym•
[0].
mö‹
.
yy316
);}

2353 {
	`sqlôe3AddPrim¨yKey
(
pP¨£
,0,
yym•
[-1].
mö‹
.
yy316
,yymsp[0].minor.yy316,yymsp[-2].minor.yy316);}

2358 {
	`sqlôe3Cª©eIndex
(
pP¨£
,0,0,0,0,
yym•
[0].
mö‹
.
yy316
,0,0,0,0);}

2363 {
	`sqlôe3AddCheckC⁄°øöt
(
pP¨£
,
yym•
[-1].
mö‹
.
yy86
.
pEx¥
);}

2368 {
	`sqlôe3Cª©eF‹eignKey
(
pP¨£
,0,&
yym•
[-2].
mö‹
.
yy0
,yym•[-1].mö‹.
yy242
,yym•[0].mö‹.
yy316
);}

2373 {
	`sqlôe3De„rF‹eignKey
(
pP¨£
,
yym•
[0].
mö‹
.
yy316
);}

2378 {
	`sqlôe3AddCﬁœãTy≥
(
pP¨£
, &
yym•
[0].
mö‹
.
yy0
);}

2383 { 
yygŸomö‹
.
yy316
 = 
OE_N⁄e
*0x0101; }

2388 { 
yygŸomö‹
.
yy316
 = (
yym•
[-1].
mö‹
.yy316 & ~yym•[0].mö‹.
yy207
.
mask
Ë| yym•[0].mö‹.yy207.
vÆue
; }

2392 74: 
	`yyã°ˇ£
(
yyruÀno
==74);

2394 { 
yygŸomö‹
.
yy207
.
vÆue
 = 0; yygŸomö‹.yy207.
mask
 = 0x000000; }

2399 { 
yygŸomö‹
.
yy207
.
vÆue
 = 
yym•
[0].
mö‹
.
yy316
; yygŸomö‹.yy207.
mask
 = 0x0000ff; }

2404 { 
yygŸomö‹
.
yy207
.
vÆue
 = 
yym•
[0].
mö‹
.
yy316
<<8; yygŸomö‹.yy207.
mask
 = 0x00ff00; }

2409 { 
yygŸomö‹
.
yy316
 = 
OE_SëNuŒ
; }

2414 { 
yygŸomö‹
.
yy316
 = 
OE_SëDÊt
; }

2419 { 
yygŸomö‹
.
yy316
 = 
OE_Casˇde
; }

2424 { 
yygŸomö‹
.
yy316
 = 
OE_Re°ri˘
; }

2429 { 
yygŸomö‹
.
yy316
 = 
OE_N⁄e
; }

2433 99: 
	`yyã°ˇ£
(
yyruÀno
==99);

2434 101: 
	`yyã°ˇ£
(
yyruÀno
==101);

2435 104: 
	`yyã°ˇ£
(
yyruÀno
==104);

2437 {
yygŸomö‹
.
yy316
 = 
yym•
[0].
mö‹
.yy316;}

2442 {
yygŸomö‹
.
yy0
.
n
 = 0; yygŸomö‹.yy0.
z
 = 0;}

2447 {
yygŸomö‹
.
yy0
 = 
yym•
[-1].
mö‹
.yy0;}

2452 {
pP¨£
->
c⁄°øötName
.
n
 = 0;}

2457 {
	`sqlôe3AddPrim¨yKey
(
pP¨£
,
yym•
[-3].
mö‹
.
yy242
,yym•[0].mö‹.
yy316
,yymsp[-2].minor.yy316,0);}

2462 {
	`sqlôe3Cª©eIndex
(
pP¨£
,0,0,0,
yym•
[-2].
mö‹
.
yy242
,yym•[0].mö‹.
yy316
,0,0,0,0);}

2467 {
	`sqlôe3AddCheckC⁄°øöt
(
pP¨£
,
yym•
[-2].
mö‹
.
yy86
.
pEx¥
);}

2473 
	`sqlôe3Cª©eF‹eignKey
(
pP¨£
, 
yym•
[-6].
mö‹
.
yy242
, &yym•[-3].mö‹.
yy0
, yym•[-2].mö‹.yy242, yym•[-1].mö‹.
yy316
);

2474 
	`sqlôe3De„rF‹eignKey
(
pP¨£
, 
yym•
[0].
mö‹
.
yy316
);

2480 {
yygŸomö‹
.
yy316
 = 
OE_DeÁu…
;}

2485 {
yygŸomö‹
.
yy306
 = 
OE_DeÁu…
;}

2490 {
yygŸomö‹
.
yy306
 = (
u8
)
yym•
[0].
mö‹
.
yy316
;}

2495 {
yygŸomö‹
.
yy316
 = 
OE_Ign‹e
;}

2500 {
yygŸomö‹
.
yy316
 = 
OE_Rïœ˚
;}

2506 
	`sqlôe3Dr›TabÀ
(
pP¨£
, 
yym•
[0].
mö‹
.
yy419
, 0, yym•[-1].mö‹.
yy316
);

2513 
	`sqlôe3Cª©eVõw
(
pP¨£
, &
yym•
[-7].
mö‹
.
yy0
, &yym•[-3].mö‹.yy0, &yym•[-2].mö‹.yy0, yym•[0].mö‹.
yy43
, yym•[-6].mö‹.
yy316
, yymsp[-4].minor.yy316);

2520 
	`sqlôe3Dr›TabÀ
(
pP¨£
, 
yym•
[0].
mö‹
.
yy419
, 1, yym•[-1].mö‹.
yy316
);

2527 
Sñe˘De°
 
de°
 = {
SRT_Ouçut
, 0, 0, 0, 0};

2528 
	`sqlôe3Sñe˘
(
pP¨£
, 
yym•
[0].
mö‹
.
yy43
, &
de°
);

2529 
	`sqlôe3Ex∂aöBegö
(
pP¨£
->
pVdbe
);

2530 
	`sqlôe3Ex∂aöSñe˘
(
pP¨£
->
pVdbe
, 
yym•
[0].
mö‹
.
yy43
);

2531 
	`sqlôe3Ex∂aöFöish
(
pP¨£
->
pVdbe
);

2532 
	`sqlôe3Sñe˘Dñëe
(
pP¨£
->
db
, 
yym•
[0].
mö‹
.
yy43
);

2538 {
yygŸomö‹
.
yy43
 = 
yym•
[0].
mö‹
.yy43;}

2544 if–
yym•
[0].
mö‹
.
yy43
 ){

2545 
yym•
[0].
mö‹
.
yy43
->
›
 = (
u8
)yym•[-1].mö‹.
yy316
;

2546 
yym•
[0].
mö‹
.
yy43
->
pPri‹
 = yymsp[-2].minor.yy43;

2547 if–
yym•
[-1].
mö‹
.
yy316
!=
TK_ALL
 ) 
pP¨£
->
hasCompound
 = 1;

2549 
	`sqlôe3Sñe˘Dñëe
(
pP¨£
->
db
, 
yym•
[-2].
mö‹
.
yy43
);

2551 
yygŸomö‹
.
yy43
 = 
yym•
[0].
mö‹
.yy43;

2557 {
yygŸomö‹
.
yy316
 = 
TK_ALL
;}

2563 
yygŸomö‹
.
yy43
 = 
	`sqlôe3Sñe˘New
(
pP¨£
,
yym•
[-6].
mö‹
.
yy242
,yym•[-5].mö‹.
yy419
,yym•[-4].mö‹.
yy450
,yym•[-3].mö‹.yy242,yym•[-2].mö‹.yy450,yym•[-1].mö‹.yy242,yym•[-7].mö‹.
yy473
,yym•[0].mö‹.
yy84
.
pLimô
,yym•[0].mö‹.yy84.
pOff£t
);

2569 {
yygŸomö‹
.
yy473
 = 
SF_Di°ö˘
;}

2573 121: 
	`yyã°ˇ£
(
yyruÀno
==121);

2575 {
yygŸomö‹
.
yy473
 = 0;}

2579 246: 
	`yyã°ˇ£
(
yyruÀno
==246);

2581 {
yygŸomö‹
.
yy242
 = 
yym•
[-1].
mö‹
.yy242;}

2585 151: 
	`yyã°ˇ£
(
yyruÀno
==151);

2586 158: 
	`yyã°ˇ£
(
yyruÀno
==158);

2587 239: 
	`yyã°ˇ£
(
yyruÀno
==239);

2588 245: 
	`yyã°ˇ£
(
yyruÀno
==245);

2590 {
yygŸomö‹
.
yy242
 = 0;}

2596 
yygŸomö‹
.
yy242
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
, 
yym•
[-2].
mö‹
.yy242, yym•[-1].mö‹.
yy86
.
pEx¥
);

2597 if–
yym•
[0].
mö‹
.
yy0
.
n
>0 ) 
	`sqlôe3Ex¥Li°SëName
(
pP¨£
, 
yygŸomö‹
.
yy242
, &yymsp[0].minor.yy0, 1);

2598 
	`sqlôe3Ex¥Li°SëS∑n
(
pP¨£
,
yygŸomö‹
.
yy242
,&
yym•
[-1].
mö‹
.
yy86
);

2605 
Ex¥
 *
p
 = 
	`sqlôe3Ex¥
(
pP¨£
->
db
, 
TK_ALL
, 0);

2606 
yygŸomö‹
.
yy242
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
, 
yym•
[-1].
mö‹
.yy242, 
p
);

2613 
Ex¥
 *
pRight
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_ALL
, 0, 0, &
yym•
[0].
mö‹
.
yy0
);

2614 
Ex¥
 *
pLe·
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_ID
, 0, 0, &
yym•
[-2].
mö‹
.
yy0
);

2615 
Ex¥
 *
pDŸ
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_DOT
, 
pLe·
, 
pRight
, 0);

2616 
yygŸomö‹
.
yy242
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,
yym•
[-3].
mö‹
.yy242, 
pDŸ
);

2622 {
yygŸomö‹
.
yy0
.
n
 = 0;}

2627 {
yygŸomö‹
.
yy419
 = 
	`sqlôe3DbMÆlocZîo
(
pP¨£
->
db
, (*yygotominor.yy419));}

2633 
yygŸomö‹
.
yy419
 = 
yym•
[0].
mö‹
.yy419;

2634 
	`sqlôe3SrcLi°Shi·JoöTy≥
(
yygŸomö‹
.
yy419
);

2641 
yygŸomö‹
.
yy419
 = 
yym•
[-1].
mö‹
.yy419;

2642 if–
	`ALWAYS
(
yygŸomö‹
.
yy419
 && yygŸomö‹.yy419->
nSrc
>0ËËyygŸomö‹.yy419->
a
[yygŸomö‹.yy419->nSrc-1].
joöty≥
 = (
u8
)
yym•
[0].
mö‹
.
yy316
;

2648 {
yygŸomö‹
.
yy419
 = 0;}

2654 
yygŸomö‹
.
yy419
 = 
	`sqlôe3SrcLi°AµídFromTîm
(
pP¨£
,
yym•
[-6].
mö‹
.yy419,&yym•[-5].mö‹.
yy0
,&yym•[-4].mö‹.yy0,&yym•[-3].mö‹.yy0,0,yym•[-1].mö‹.
yy450
,yym•[0].mö‹.
yy352
);

2655 
	`sqlôe3SrcLi°IndexedBy
(
pP¨£
, 
yygŸomö‹
.
yy419
, &
yym•
[-2].
mö‹
.
yy0
);

2662 
yygŸomö‹
.
yy419
 = 
	`sqlôe3SrcLi°AµídFromTîm
(
pP¨£
,
yym•
[-6].
mö‹
.yy419,0,0,&yym•[-2].mö‹.
yy0
,yym•[-4].mö‹.
yy43
,yym•[-1].mö‹.
yy450
,yym•[0].mö‹.
yy352
);

2669 if–
yym•
[-6].
mö‹
.
yy419
==0 && yym•[-2].mö‹.
yy0
.
n
==0 && yym•[-1].mö‹.
yy450
==0 && yym•[0].mö‹.
yy352
==0 ){

2670 
yygŸomö‹
.
yy419
 = 
yym•
[-4].
mö‹
.yy419;

2671 }if–
yym•
[-4].
mö‹
.
yy419
->
nSrc
==1 ){

2672 
yygŸomö‹
.
yy419
 = 
	`sqlôe3SrcLi°AµídFromTîm
(
pP¨£
,
yym•
[-6].
mö‹
.yy419,0,0,&yym•[-2].mö‹.
yy0
,0,yym•[-1].mö‹.
yy450
,yym•[0].mö‹.
yy352
);

2673 if–
yygŸomö‹
.
yy419
 ){

2674 
SrcLi°_ôem
 *
pNew
 = &
yygŸomö‹
.
yy419
->
a
[yygŸomö‹.yy419->
nSrc
-1];

2675 
SrcLi°_ôem
 *
pOld
 = 
yym•
[-4].
mö‹
.
yy419
->
a
;

2676 
pNew
->
zName
 = 
pOld
->zName;

2677 
pNew
->
zD©aba£
 = 
pOld
->zDatabase;

2678 
pNew
->
pSñe˘
 = 
pOld
->pSelect;

2679 
pOld
->
zName
 =ÖOld->
zD©aba£
 = 0;

2680 
pOld
->
pSñe˘
 = 0;

2682 
	`sqlôe3SrcLi°Dñëe
(
pP¨£
->
db
, 
yym•
[-4].
mö‹
.
yy419
);

2684 
Sñe˘
 *
pSubquîy
;

2685 
	`sqlôe3SrcLi°Shi·JoöTy≥
(
yym•
[-4].
mö‹
.
yy419
);

2686 
pSubquîy
 = 
	`sqlôe3Sñe˘New
(
pP¨£
,0,
yym•
[-4].
mö‹
.
yy419
,0,0,0,0,
SF_Ne°edFrom
,0,0);

2687 
yygŸomö‹
.
yy419
 = 
	`sqlôe3SrcLi°AµídFromTîm
(
pP¨£
,
yym•
[-6].
mö‹
.yy419,0,0,&yym•[-2].mö‹.
yy0
,
pSubquîy
,yym•[-1].mö‹.
yy450
,yym•[0].mö‹.
yy352
);

2693 146: 
	`yyã°ˇ£
(
yyruÀno
==146);

2695 {
yygŸomö‹
.
yy0
.
z
=0; yygŸomö‹.yy0.
n
=0;}

2700 {
yygŸomö‹
.
yy419
 = 
	`sqlôe3SrcLi°Aµíd
(
pP¨£
->
db
,0,&
yym•
[-1].
mö‹
.
yy0
,&yymsp[0].minor.yy0);}

2705 { 
yygŸomö‹
.
yy316
 = 
JT_INNER
; }

2710 { 
yygŸomö‹
.
yy316
 = 
	`sqlôe3JoöTy≥
(
pP¨£
,&
yym•
[-1].
mö‹
.
yy0
,0,0); }

2715 { 
yygŸomö‹
.
yy316
 = 
	`sqlôe3JoöTy≥
(
pP¨£
,&
yym•
[-2].
mö‹
.
yy0
,&yymsp[-1].minor.yy0,0); }

2720 { 
yygŸomö‹
.
yy316
 = 
	`sqlôe3JoöTy≥
(
pP¨£
,&
yym•
[-3].
mö‹
.
yy0
,&yymsp[-2].minor.yy0,&yymsp[-1].minor.yy0); }

2724 161: 
	`yyã°ˇ£
(
yyruÀno
==161);

2725 168: 
	`yyã°ˇ£
(
yyruÀno
==168);

2726 234: 
	`yyã°ˇ£
(
yyruÀno
==234);

2727 236: 
	`yyã°ˇ£
(
yyruÀno
==236);

2729 {
yygŸomö‹
.
yy450
 = 
yym•
[0].
mö‹
.
yy86
.
pEx¥
;}

2733 160: 
	`yyã°ˇ£
(
yyruÀno
==160);

2734 167: 
	`yyã°ˇ£
(
yyruÀno
==167);

2735 235: 
	`yyã°ˇ£
(
yyruÀno
==235);

2736 237: 
	`yyã°ˇ£
(
yyruÀno
==237);

2738 {
yygŸomö‹
.
yy450
 = 0;}

2743 {
yygŸomö‹
.
yy0
.
z
=0; yygŸomö‹.yy0.
n
=1;}

2747 180: 
	`yyã°ˇ£
(
yyruÀno
==180);

2749 {
yygŸomö‹
.
yy352
 = 
yym•
[-1].
mö‹
.yy352;}

2753 179: 
	`yyã°ˇ£
(
yyruÀno
==179);

2755 {
yygŸomö‹
.
yy352
 = 0;}

2759 159: 
	`yyã°ˇ£
(
yyruÀno
==159);

2760 238: 
	`yyã°ˇ£
(
yyruÀno
==238);

2762 {
yygŸomö‹
.
yy242
 = 
yym•
[0].
mö‹
.yy242;}

2768 
yygŸomö‹
.
yy242
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,
yym•
[-3].
mö‹
.yy242,yym•[-1].mö‹.
yy86
.
pEx¥
);

2769 if–
yygŸomö‹
.
yy242
 ) yygŸomö‹.yy242->
a
[yygŸomö‹.yy242->
nEx¥
-1].
s‹tOrdî
 = (
u8
)
yym•
[0].
mö‹
.
yy316
;

2776 
yygŸomö‹
.
yy242
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,0,
yym•
[-1].
mö‹
.
yy86
.
pEx¥
);

2777 if–
yygŸomö‹
.
yy242
 && 
	`ALWAYS
(yygŸomö‹.yy242->
a
ËËyygŸomö‹.yy242->a[0].
s‹tOrdî
 = (
u8
)
yym•
[0].
mö‹
.
yy316
;

2782 157: 
	`yyã°ˇ£
(
yyruÀno
==157);

2784 {
yygŸomö‹
.
yy316
 = 
SQLITE_SO_ASC
;}

2789 {
yygŸomö‹
.
yy316
 = 
SQLITE_SO_DESC
;}

2794 {
yygŸomö‹
.
yy84
.
pLimô
 = 0; yygŸomö‹.yy84.
pOff£t
 = 0;}

2799 {
yygŸomö‹
.
yy84
.
pLimô
 = 
yym•
[0].
mö‹
.
yy86
.
pEx¥
; yygŸomö‹.yy84.
pOff£t
 = 0;}

2804 {
yygŸomö‹
.
yy84
.
pLimô
 = 
yym•
[-2].
mö‹
.
yy86
.
pEx¥
; yygŸomö‹.yy84.
pOff£t
 = yymsp[0].minor.yy86.pExpr;}

2809 {
yygŸomö‹
.
yy84
.
pOff£t
 = 
yym•
[-2].
mö‹
.
yy86
.
pEx¥
; yygŸomö‹.yy84.
pLimô
 = yymsp[0].minor.yy86.pExpr;}

2815 
	`sqlôe3SrcLi°IndexedBy
(
pP¨£
, 
yym•
[-2].
mö‹
.
yy419
, &yym•[-1].mö‹.
yy0
);

2816 
	`sqlôe3DñëeFrom
(
pP¨£
,
yym•
[-2].
mö‹
.
yy419
,yym•[0].mö‹.
yy450
);

2823 
	`sqlôe3SrcLi°IndexedBy
(
pP¨£
, 
yym•
[-4].
mö‹
.
yy419
, &yym•[-3].mö‹.
yy0
);

2824 
	`sqlôe3Ex¥Li°CheckLígth
(
pP¨£
,
yym•
[-1].
mö‹
.
yy242
,"setÜist");

2825 
	`sqlôe3Upd©e
(
pP¨£
,
yym•
[-4].
mö‹
.
yy419
,yym•[-1].mö‹.
yy242
,yym•[0].mö‹.
yy450
,yym•[-5].mö‹.
yy306
);

2832 
yygŸomö‹
.
yy242
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
, 
yym•
[-4].
mö‹
.yy242, yym•[0].mö‹.
yy86
.
pEx¥
);

2833 
	`sqlôe3Ex¥Li°SëName
(
pP¨£
, 
yygŸomö‹
.
yy242
, &
yym•
[-2].
mö‹
.
yy0
, 1);

2840 
yygŸomö‹
.
yy242
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
, 0, 
yym•
[0].
mö‹
.
yy86
.
pEx¥
);

2841 
	`sqlôe3Ex¥Li°SëName
(
pP¨£
, 
yygŸomö‹
.
yy242
, &
yym•
[-2].
mö‹
.
yy0
, 1);

2847 {
	`sqlôe3In£π
(
pP¨£
, 
yym•
[-2].
mö‹
.
yy419
, yym•[0].mö‹.
yy323
.
pLi°
, yym•[0].mö‹.yy323.
pSñe˘
, yym•[-1].mö‹.
yy352
, yym•[-4].mö‹.
yy306
);}

2852 {
	`sqlôe3In£π
(
pP¨£
, 
yym•
[-2].
mö‹
.
yy419
, 0, yym•[0].mö‹.
yy43
, yym•[-1].mö‹.
yy352
, yym•[-4].mö‹.
yy306
);}

2857 {
	`sqlôe3In£π
(
pP¨£
, 
yym•
[-3].
mö‹
.
yy419
, 0, 0, yym•[-2].mö‹.
yy352
, yym•[-5].mö‹.
yy306
);}

2862 {
yygŸomö‹
.
yy306
 = 
yym•
[0].
mö‹
.yy306;}

2867 {
yygŸomö‹
.
yy306
 = 
OE_Rïœ˚
;}

2873 
yygŸomö‹
.
yy323
.
pLi°
 = 
yym•
[-1].
mö‹
.
yy242
;

2874 
yygŸomö‹
.
yy323
.
pSñe˘
 = 0;

2881 
Sñe˘
 *
pRight
 = 
	`sqlôe3Sñe˘New
(
pP¨£
, 
yym•
[-1].
mö‹
.
yy242
, 0, 0, 0, 0, 0, 0, 0, 0);

2882 if–
yym•
[-4].
mö‹
.
yy323
.
pLi°
 ){

2883 
yym•
[-4].
mö‹
.
yy323
.
pSñe˘
 = 
	`sqlôe3Sñe˘New
(
pP¨£
, yym•[-4].mö‹.yy323.
pLi°
, 0, 0, 0, 0, 0, 0, 0, 0);

2884 
yym•
[-4].
mö‹
.
yy323
.
pLi°
 = 0;

2886 
yygŸomö‹
.
yy323
.
pLi°
 = 0;

2887 if–
yym•
[-4].
mö‹
.
yy323
.
pSñe˘
==0 || 
pRight
==0 ){

2888 
	`sqlôe3Sñe˘Dñëe
(
pP¨£
->
db
, 
pRight
);

2889 
	`sqlôe3Sñe˘Dñëe
(
pP¨£
->
db
, 
yym•
[-4].
mö‹
.
yy323
.
pSñe˘
);

2890 
yygŸomö‹
.
yy323
.
pSñe˘
 = 0;

2892 
pRight
->
›
 = 
TK_ALL
;

2893 
pRight
->
pPri‹
 = 
yym•
[-4].
mö‹
.
yy323
.
pSñe˘
;

2894 
pRight
->
£lFœgs
 |
SF_VÆues
;

2895 
pRight
->
pPri‹
->
£lFœgs
 |
SF_VÆues
;

2896 
yygŸomö‹
.
yy323
.
pSñe˘
 = 
pRight
;

2903 {
yygŸomö‹
.
yy352
 = 
	`sqlôe3IdLi°Aµíd
(
pP¨£
->
db
,
yym•
[-2].
mö‹
.yy352,&yym•[0].mö‹.
yy0
);}

2908 {
yygŸomö‹
.
yy352
 = 
	`sqlôe3IdLi°Aµíd
(
pP¨£
->
db
,0,&
yym•
[0].
mö‹
.
yy0
);}

2913 {
yygŸomö‹
.
yy86
 = 
yym•
[0].
mö‹
.yy86;}

2918 {
yygŸomö‹
.
yy86
.
pEx¥
 = 
yym•
[-1].
mö‹
.yy86.pEx¥; 
	`•™Së
(&yygŸomö‹.yy86,&yym•[-2].mö‹.
yy0
,&yymsp[0].minor.yy0);}

2922 190: 
	`yyã°ˇ£
(
yyruÀno
==190);

2923 191: 
	`yyã°ˇ£
(
yyruÀno
==191);

2925 {
	`•™Ex¥
(&
yygŸomö‹
.
yy86
, 
pP¨£
, 
yym•
[0].
maj‹
, &yym•[0].
mö‹
.
yy0
);}

2929 187: 
	`yyã°ˇ£
(
yyruÀno
==187);

2931 {
	`•™Ex¥
(&
yygŸomö‹
.
yy86
, 
pP¨£
, 
TK_ID
, &
yym•
[0].
mö‹
.
yy0
);}

2937 
Ex¥
 *
ãmp1
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_ID
, 0, 0, &
yym•
[-2].
mö‹
.
yy0
);

2938 
Ex¥
 *
ãmp2
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_ID
, 0, 0, &
yym•
[0].
mö‹
.
yy0
);

2939 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_DOT
, 
ãmp1
, 
ãmp2
, 0);

2940 
	`•™Së
(&
yygŸomö‹
.
yy86
,&
yym•
[-2].
mö‹
.
yy0
,&yymsp[0].minor.yy0);

2947 
Ex¥
 *
ãmp1
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_ID
, 0, 0, &
yym•
[-4].
mö‹
.
yy0
);

2948 
Ex¥
 *
ãmp2
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_ID
, 0, 0, &
yym•
[-2].
mö‹
.
yy0
);

2949 
Ex¥
 *
ãmp3
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_ID
, 0, 0, &
yym•
[0].
mö‹
.
yy0
);

2950 
Ex¥
 *
ãmp4
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_DOT
, 
ãmp2
, 
ãmp3
, 0);

2951 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_DOT
, 
ãmp1
, 
ãmp4
, 0);

2952 
	`•™Së
(&
yygŸomö‹
.
yy86
,&
yym•
[-4].
mö‹
.
yy0
,&yymsp[0].minor.yy0);

2962 if–
pP¨£
->
√°ed
==0 ){

2963 
	`sqlôe3Eº‹Msg
(
pP¨£
, "√¨ \"%T\": sy¡axÉº‹", &
yym•
[0].
mö‹
.
yy0
);

2964 
yygŸomö‹
.
yy86
.
pEx¥
 = 0;

2966 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_REGISTER
, 0, 0, &
yym•
[0].
mö‹
.
yy0
);

2967 if–
yygŸomö‹
.
yy86
.
pEx¥
 ) 
	`sqlôe3GëI¡32
(&
yym•
[0].
mö‹
.
yy0
.
z
[1], &yygŸomö‹.yy86.pEx¥->
iTabÀ
);

2969 
	`•™Së
(&
yygŸomö‹
.
yy86
, &
yym•
[0].
mö‹
.
yy0
, &yymsp[0].minor.yy0);

2976 
	`•™Ex¥
(&
yygŸomö‹
.
yy86
, 
pP¨£
, 
TK_VARIABLE
, &
yym•
[0].
mö‹
.
yy0
);

2977 
	`sqlôe3Ex¥AssignV¨Numbî
(
pP¨£
, 
yygŸomö‹
.
yy86
.
pEx¥
);

2978 
	`•™Së
(&
yygŸomö‹
.
yy86
, &
yym•
[0].
mö‹
.
yy0
, &yymsp[0].minor.yy0);

2985 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3Ex¥AddCﬁœãTokí
(
pP¨£
, 
yym•
[-2].
mö‹
.yy86.pEx¥, &yym•[0].mö‹.
yy0
);

2986 
yygŸomö‹
.
yy86
.
zSèπ
 = 
yym•
[-2].
mö‹
.yy86.zStart;

2987 
yygŸomö‹
.
yy86
.
zEnd
 = &
yym•
[0].
mö‹
.
yy0
.
z
[yym•[0].mö‹.yy0.
n
];

2994 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_CAST
, 
yym•
[-3].
mö‹
.yy86.pEx¥, 0, &yym•[-1].mö‹.
yy0
);

2995 
	`•™Së
(&
yygŸomö‹
.
yy86
,&
yym•
[-5].
mö‹
.
yy0
,&yymsp[0].minor.yy0);

3002 if–
yym•
[-1].
mö‹
.
yy242
 && yym•[-1].mö‹.yy242->
nEx¥
>
pP¨£
->
db
->
aLimô
[
SQLITE_LIMIT_FUNCTION_ARG
] ){

3003 
	`sqlôe3Eº‹Msg
(
pP¨£
, "toÿm™yárgumít†⁄ fun˘i⁄ %T", &
yym•
[-4].
mö‹
.
yy0
);

3005 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3Ex¥Fun˘i⁄
(
pP¨£
, 
yym•
[-1].
mö‹
.
yy242
, &yym•[-4].mö‹.
yy0
);

3006 
	`•™Së
(&
yygŸomö‹
.
yy86
,&
yym•
[-4].
mö‹
.
yy0
,&yymsp[0].minor.yy0);

3007 if–
yym•
[-2].
mö‹
.
yy473
 && 
yygŸomö‹
.
yy86
.
pEx¥
 ){

3008 
yygŸomö‹
.
yy86
.
pEx¥
->
Êags
 |
EP_Di°ö˘
;

3016 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3Ex¥Fun˘i⁄
(
pP¨£
, 0, &
yym•
[-3].
mö‹
.
yy0
);

3017 
	`•™Së
(&
yygŸomö‹
.
yy86
,&
yym•
[-3].
mö‹
.
yy0
,&yymsp[0].minor.yy0);

3026 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3Ex¥Fun˘i⁄
(
pP¨£
, 0,&
yym•
[0].
mö‹
.
yy0
);

3027 if–
yygŸomö‹
.
yy86
.
pEx¥
 ){

3028 
yygŸomö‹
.
yy86
.
pEx¥
->
›
 = 
TK_CONST_FUNC
;

3030 
	`•™Së
(&
yygŸomö‹
.
yy86
, &
yym•
[0].
mö‹
.
yy0
, &yymsp[0].minor.yy0);

3035 200: 
	`yyã°ˇ£
(
yyruÀno
==200);

3036 201: 
	`yyã°ˇ£
(
yyruÀno
==201);

3037 202: 
	`yyã°ˇ£
(
yyruÀno
==202);

3038 203: 
	`yyã°ˇ£
(
yyruÀno
==203);

3039 204: 
	`yyã°ˇ£
(
yyruÀno
==204);

3040 205: 
	`yyã°ˇ£
(
yyruÀno
==205);

3041 206: 
	`yyã°ˇ£
(
yyruÀno
==206);

3043 {
	`•™Bö¨yEx¥
(&
yygŸomö‹
.
yy86
,
pP¨£
,
yym•
[-1].
maj‹
,&yym•[-2].
mö‹
.yy86,&yymsp[0].minor.yy86);}

3047 209: 
	`yyã°ˇ£
(
yyruÀno
==209);

3049 {
yygŸomö‹
.
yy87
.
eO≥øt‹
 = 
yym•
[0].
mö‹
.
yy0
; yygŸomö‹.yy87.
bNŸ
 = 0;}

3053 210: 
	`yyã°ˇ£
(
yyruÀno
==210);

3055 {
yygŸomö‹
.
yy87
.
eO≥øt‹
 = 
yym•
[0].
mö‹
.
yy0
; yygŸomö‹.yy87.
bNŸ
 = 1;}

3061 
Ex¥Li°
 *
pLi°
;

3062 
pLi°
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,0, 
yym•
[0].
mö‹
.
yy86
.
pEx¥
);

3063 
pLi°
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,pLi°, 
yym•
[-2].
mö‹
.
yy86
.
pEx¥
);

3064 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3Ex¥Fun˘i⁄
(
pP¨£
, 
pLi°
, &
yym•
[-1].
mö‹
.
yy87
.
eO≥øt‹
);

3065 if–
yym•
[-1].
mö‹
.
yy87
.
bNŸ
 ) 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_NOT
, yygotominor.yy86.pExpr, 0, 0);

3066 
yygŸomö‹
.
yy86
.
zSèπ
 = 
yym•
[-2].
mö‹
.yy86.zStart;

3067 
yygŸomö‹
.
yy86
.
zEnd
 = 
yym•
[0].
mö‹
.yy86.zEnd;

3068 if–
yygŸomö‹
.
yy86
.
pEx¥
 ) yygŸomö‹.yy86.pEx¥->
Êags
 |
EP_InfixFunc
;

3075 
Ex¥Li°
 *
pLi°
;

3076 
pLi°
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,0, 
yym•
[-2].
mö‹
.
yy86
.
pEx¥
);

3077 
pLi°
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,pLi°, 
yym•
[-4].
mö‹
.
yy86
.
pEx¥
);

3078 
pLi°
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,pLi°, 
yym•
[0].
mö‹
.
yy86
.
pEx¥
);

3079 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3Ex¥Fun˘i⁄
(
pP¨£
, 
pLi°
, &
yym•
[-3].
mö‹
.
yy87
.
eO≥øt‹
);

3080 if–
yym•
[-3].
mö‹
.
yy87
.
bNŸ
 ) 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_NOT
, yygotominor.yy86.pExpr, 0, 0);

3081 
yygŸomö‹
.
yy86
.
zSèπ
 = 
yym•
[-4].
mö‹
.yy86.zStart;

3082 
yygŸomö‹
.
yy86
.
zEnd
 = 
yym•
[0].
mö‹
.yy86.zEnd;

3083 if–
yygŸomö‹
.
yy86
.
pEx¥
 ) yygŸomö‹.yy86.pEx¥->
Êags
 |
EP_InfixFunc
;

3089 {
	`•™U«ryPo°fix
(&
yygŸomö‹
.
yy86
,
pP¨£
,
yym•
[0].
maj‹
,&yym•[-1].
mö‹
.yy86,&yym•[0].mö‹.
yy0
);}

3094 {
	`•™U«ryPo°fix
(&
yygŸomö‹
.
yy86
,
pP¨£
,
TK_NOTNULL
,&
yym•
[-2].
mö‹
.yy86,&yym•[0].mö‹.
yy0
);}

3100 
	`•™Bö¨yEx¥
(&
yygŸomö‹
.
yy86
,
pP¨£
,
TK_IS
,&
yym•
[-2].
mö‹
.yy86,&yymsp[0].minor.yy86);

3101 
	`bö¨yToU«ryIfNuŒ
(
pP¨£
, 
yym•
[0].
mö‹
.
yy86
.
pEx¥
, 
yygŸomö‹
.yy86.pEx¥, 
TK_ISNULL
);

3108 
	`•™Bö¨yEx¥
(&
yygŸomö‹
.
yy86
,
pP¨£
,
TK_ISNOT
,&
yym•
[-3].
mö‹
.yy86,&yymsp[0].minor.yy86);

3109 
	`bö¨yToU«ryIfNuŒ
(
pP¨£
, 
yym•
[0].
mö‹
.
yy86
.
pEx¥
, 
yygŸomö‹
.yy86.pEx¥, 
TK_NOTNULL
);

3114 218: 
	`yyã°ˇ£
(
yyruÀno
==218);

3116 {
	`•™U«ryPªfix
(&
yygŸomö‹
.
yy86
,
pP¨£
,
yym•
[-1].
maj‹
,&yym•[0].
mö‹
.yy86,&yym•[-1].mö‹.
yy0
);}

3121 {
	`•™U«ryPªfix
(&
yygŸomö‹
.
yy86
,
pP¨£
,
TK_UMINUS
,&
yym•
[0].
mö‹
.yy86,&yym•[-1].mö‹.
yy0
);}

3126 {
	`•™U«ryPªfix
(&
yygŸomö‹
.
yy86
,
pP¨£
,
TK_UPLUS
,&
yym•
[0].
mö‹
.yy86,&yym•[-1].mö‹.
yy0
);}

3132 
Ex¥Li°
 *
pLi°
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,0, 
yym•
[-2].
mö‹
.
yy86
.
pEx¥
);

3133 
pLi°
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,pLi°, 
yym•
[0].
mö‹
.
yy86
.
pEx¥
);

3134 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_BETWEEN
, 
yym•
[-4].
mö‹
.yy86.pExpr, 0, 0);

3135 if–
yygŸomö‹
.
yy86
.
pEx¥
 ){

3136 
yygŸomö‹
.
yy86
.
pEx¥
->
x
.
pLi°
 =ÖList;

3138 
	`sqlôe3Ex¥Li°Dñëe
(
pP¨£
->
db
, 
pLi°
);

3140 if–
yym•
[-3].
mö‹
.
yy316
 ) 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_NOT
, yygotominor.yy86.pExpr, 0, 0);

3141 
yygŸomö‹
.
yy86
.
zSèπ
 = 
yym•
[-4].
mö‹
.yy86.zStart;

3142 
yygŸomö‹
.
yy86
.
zEnd
 = 
yym•
[0].
mö‹
.yy86.zEnd;

3149 if–
yym•
[-1].
mö‹
.
yy242
==0 ){

3158 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_INTEGER
, 0, 0, &
sqlôe3I¡Tokís
[
yym•
[-3].
mö‹
.
yy316
]);

3159 
	`sqlôe3Ex¥Dñëe
(
pP¨£
->
db
, 
yym•
[-4].
mö‹
.
yy86
.
pEx¥
);

3161 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_IN
, 
yym•
[-4].
mö‹
.yy86.pExpr, 0, 0);

3162 if–
yygŸomö‹
.
yy86
.
pEx¥
 ){

3163 
yygŸomö‹
.
yy86
.
pEx¥
->
x
.
pLi°
 = 
yym•
[-1].
mö‹
.
yy242
;

3164 
	`sqlôe3Ex¥SëHeight
(
pP¨£
, 
yygŸomö‹
.
yy86
.
pEx¥
);

3166 
	`sqlôe3Ex¥Li°Dñëe
(
pP¨£
->
db
, 
yym•
[-1].
mö‹
.
yy242
);

3168 if–
yym•
[-3].
mö‹
.
yy316
 ) 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_NOT
, yygotominor.yy86.pExpr, 0, 0);

3170 
yygŸomö‹
.
yy86
.
zSèπ
 = 
yym•
[-4].
mö‹
.yy86.zStart;

3171 
yygŸomö‹
.
yy86
.
zEnd
 = &
yym•
[0].
mö‹
.
yy0
.
z
[yym•[0].mö‹.yy0.
n
];

3178 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_SELECT
, 0, 0, 0);

3179 if–
yygŸomö‹
.
yy86
.
pEx¥
 ){

3180 
yygŸomö‹
.
yy86
.
pEx¥
->
x
.
pSñe˘
 = 
yym•
[-1].
mö‹
.
yy43
;

3181 
	`Ex¥SëPr›îty
(
yygŸomö‹
.
yy86
.
pEx¥
, 
EP_xIsSñe˘
);

3182 
	`sqlôe3Ex¥SëHeight
(
pP¨£
, 
yygŸomö‹
.
yy86
.
pEx¥
);

3184 
	`sqlôe3Sñe˘Dñëe
(
pP¨£
->
db
, 
yym•
[-1].
mö‹
.
yy43
);

3186 
yygŸomö‹
.
yy86
.
zSèπ
 = 
yym•
[-2].
mö‹
.
yy0
.
z
;

3187 
yygŸomö‹
.
yy86
.
zEnd
 = &
yym•
[0].
mö‹
.
yy0
.
z
[yym•[0].mö‹.yy0.
n
];

3194 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_IN
, 
yym•
[-4].
mö‹
.yy86.pExpr, 0, 0);

3195 if–
yygŸomö‹
.
yy86
.
pEx¥
 ){

3196 
yygŸomö‹
.
yy86
.
pEx¥
->
x
.
pSñe˘
 = 
yym•
[-1].
mö‹
.
yy43
;

3197 
	`Ex¥SëPr›îty
(
yygŸomö‹
.
yy86
.
pEx¥
, 
EP_xIsSñe˘
);

3198 
	`sqlôe3Ex¥SëHeight
(
pP¨£
, 
yygŸomö‹
.
yy86
.
pEx¥
);

3200 
	`sqlôe3Sñe˘Dñëe
(
pP¨£
->
db
, 
yym•
[-1].
mö‹
.
yy43
);

3202 if–
yym•
[-3].
mö‹
.
yy316
 ) 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_NOT
, yygotominor.yy86.pExpr, 0, 0);

3203 
yygŸomö‹
.
yy86
.
zSèπ
 = 
yym•
[-4].
mö‹
.yy86.zStart;

3204 
yygŸomö‹
.
yy86
.
zEnd
 = &
yym•
[0].
mö‹
.
yy0
.
z
[yym•[0].mö‹.yy0.
n
];

3211 
SrcLi°
 *
pSrc
 = 
	`sqlôe3SrcLi°Aµíd
(
pP¨£
->
db
, 0,&
yym•
[-1].
mö‹
.
yy0
,&yymsp[0].minor.yy0);

3212 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_IN
, 
yym•
[-3].
mö‹
.yy86.pExpr, 0, 0);

3213 if–
yygŸomö‹
.
yy86
.
pEx¥
 ){

3214 
yygŸomö‹
.
yy86
.
pEx¥
->
x
.
pSñe˘
 = 
	`sqlôe3Sñe˘New
(
pP¨£
, 0,
pSrc
,0,0,0,0,0,0,0);

3215 
	`Ex¥SëPr›îty
(
yygŸomö‹
.
yy86
.
pEx¥
, 
EP_xIsSñe˘
);

3216 
	`sqlôe3Ex¥SëHeight
(
pP¨£
, 
yygŸomö‹
.
yy86
.
pEx¥
);

3218 
	`sqlôe3SrcLi°Dñëe
(
pP¨£
->
db
, 
pSrc
);

3220 if–
yym•
[-2].
mö‹
.
yy316
 ) 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_NOT
, yygotominor.yy86.pExpr, 0, 0);

3221 
yygŸomö‹
.
yy86
.
zSèπ
 = 
yym•
[-3].
mö‹
.yy86.zStart;

3222 
yygŸomö‹
.
yy86
.
zEnd
 = 
yym•
[0].
mö‹
.
yy0
.
z
 ? &yym•[0].mö‹.yy0.z[yym•[0].mö‹.yy0.
n
] : &yymsp[-1].minor.yy0.z[yymsp[-1].minor.yy0.n];

3229 
Ex¥
 *
p
 = 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_EXISTS
, 0, 0, 0);

3230 if–
p
 ){

3231 
p
->
x
.
pSñe˘
 = 
yym•
[-1].
mö‹
.
yy43
;

3232 
	`Ex¥SëPr›îty
(
p
, 
EP_xIsSñe˘
);

3233 
	`sqlôe3Ex¥SëHeight
(
pP¨£
, 
p
);

3235 
	`sqlôe3Sñe˘Dñëe
(
pP¨£
->
db
, 
yym•
[-1].
mö‹
.
yy43
);

3237 
yygŸomö‹
.
yy86
.
zSèπ
 = 
yym•
[-3].
mö‹
.
yy0
.
z
;

3238 
yygŸomö‹
.
yy86
.
zEnd
 = &
yym•
[0].
mö‹
.
yy0
.
z
[yym•[0].mö‹.yy0.
n
];

3245 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_CASE
, 
yym•
[-3].
mö‹
.
yy450
, 0, 0);

3246 if–
yygŸomö‹
.
yy86
.
pEx¥
 ){

3247 
yygŸomö‹
.
yy86
.
pEx¥
->
x
.
pLi°
 = 
yym•
[-1].
mö‹
.
yy450
 ? 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,yym•[-2].mö‹.
yy242
,yymsp[-1].minor.yy450) : yymsp[-2].minor.yy242;

3248 
	`sqlôe3Ex¥SëHeight
(
pP¨£
, 
yygŸomö‹
.
yy86
.
pEx¥
);

3250 
	`sqlôe3Ex¥Li°Dñëe
(
pP¨£
->
db
, 
yym•
[-2].
mö‹
.
yy242
);

3251 
	`sqlôe3Ex¥Dñëe
(
pP¨£
->
db
, 
yym•
[-1].
mö‹
.
yy450
);

3253 
yygŸomö‹
.
yy86
.
zSèπ
 = 
yym•
[-4].
mö‹
.
yy0
.
z
;

3254 
yygŸomö‹
.
yy86
.
zEnd
 = &
yym•
[0].
mö‹
.
yy0
.
z
[yym•[0].mö‹.yy0.
n
];

3261 
yygŸomö‹
.
yy242
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,
yym•
[-4].
mö‹
.yy242, yym•[-2].mö‹.
yy86
.
pEx¥
);

3262 
yygŸomö‹
.
yy242
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,yygŸomö‹.yy242, 
yym•
[0].
mö‹
.
yy86
.
pEx¥
);

3269 
yygŸomö‹
.
yy242
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,0, 
yym•
[-2].
mö‹
.
yy86
.
pEx¥
);

3270 
yygŸomö‹
.
yy242
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,yygŸomö‹.yy242, 
yym•
[0].
mö‹
.
yy86
.
pEx¥
);

3276 {
yygŸomö‹
.
yy242
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,
yym•
[-2].
mö‹
.yy242,yym•[0].mö‹.
yy86
.
pEx¥
);}

3281 {
yygŸomö‹
.
yy242
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,0,
yym•
[0].
mö‹
.
yy86
.
pEx¥
);}

3287 
	`sqlôe3Cª©eIndex
(
pP¨£
, &
yym•
[-7].
mö‹
.
yy0
, &yymsp[-6].minor.yy0,

3288 
	`sqlôe3SrcLi°Aµíd
(
pP¨£
->
db
,0,&
yym•
[-4].
mö‹
.
yy0
,0), yym•[-2].mö‹.
yy242
, yym•[-10].mö‹.
yy316
,

3289 &
yym•
[-11].
mö‹
.
yy0
, yym•[0].mö‹.
yy450
, 
SQLITE_SO_ASC
, yym•[-8].mö‹.
yy316
);

3294 296: 
	`yyã°ˇ£
(
yyruÀno
==296);

3296 {
yygŸomö‹
.
yy316
 = 
OE_Ab‹t
;}

3301 {
yygŸomö‹
.
yy316
 = 
OE_N⁄e
;}

3307 
Ex¥
 *
p
 = 
	`sqlôe3Ex¥AddCﬁœãTokí
(
pP¨£
, 0, &
yym•
[-1].
mö‹
.
yy0
);

3308 
yygŸomö‹
.
yy242
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,
yym•
[-4].
mö‹
.yy242, 
p
);

3309 
	`sqlôe3Ex¥Li°SëName
(
pP¨£
,
yygŸomö‹
.
yy242
,&
yym•
[-2].
mö‹
.
yy0
,1);

3310 
	`sqlôe3Ex¥Li°CheckLígth
(
pP¨£
, 
yygŸomö‹
.
yy242
, "index");

3311 if–
yygŸomö‹
.
yy242
 ) yygŸomö‹.yy242->
a
[yygŸomö‹.yy242->
nEx¥
-1].
s‹tOrdî
 = (
u8
)
yym•
[0].
mö‹
.
yy316
;

3318 
Ex¥
 *
p
 = 
	`sqlôe3Ex¥AddCﬁœãTokí
(
pP¨£
, 0, &
yym•
[-1].
mö‹
.
yy0
);

3319 
yygŸomö‹
.
yy242
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,0, 
p
);

3320 
	`sqlôe3Ex¥Li°SëName
(
pP¨£
, 
yygŸomö‹
.
yy242
, &
yym•
[-2].
mö‹
.
yy0
, 1);

3321 
	`sqlôe3Ex¥Li°CheckLígth
(
pP¨£
, 
yygŸomö‹
.
yy242
, "index");

3322 if–
yygŸomö‹
.
yy242
 ) yygŸomö‹.yy242->
a
[yygŸomö‹.yy242->
nEx¥
-1].
s‹tOrdî
 = (
u8
)
yym•
[0].
mö‹
.
yy316
;

3328 {
yygŸomö‹
.
yy0
.
z
 = 0; yygŸomö‹.yy0.
n
 = 0;}

3333 {
	`sqlôe3Dr›Index
(
pP¨£
, 
yym•
[0].
mö‹
.
yy419
, yym•[-1].mö‹.
yy316
);}

3337 253: 
	`yyã°ˇ£
(
yyruÀno
==253);

3339 {
	`sqlôe3Vacuum
(
pP¨£
);}

3344 {
	`sqlôe3Pøgma
(
pP¨£
,&
yym•
[-1].
mö‹
.
yy0
,&yymsp[0].minor.yy0,0,0);}

3349 {
	`sqlôe3Pøgma
(
pP¨£
,&
yym•
[-3].
mö‹
.
yy0
,&yymsp[-2].minor.yy0,&yymsp[0].minor.yy0,0);}

3354 {
	`sqlôe3Pøgma
(
pP¨£
,&
yym•
[-4].
mö‹
.
yy0
,&yymsp[-3].minor.yy0,&yymsp[-1].minor.yy0,0);}

3359 {
	`sqlôe3Pøgma
(
pP¨£
,&
yym•
[-3].
mö‹
.
yy0
,&yymsp[-2].minor.yy0,&yymsp[0].minor.yy0,1);}

3364 {
	`sqlôe3Pøgma
(
pP¨£
,&
yym•
[-4].
mö‹
.
yy0
,&yymsp[-3].minor.yy0,&yymsp[-1].minor.yy0,1);}

3370 
Tokí
 
Æl
;

3371 
Æl
.
z
 = 
yym•
[-3].
mö‹
.
yy0
.z;

3372 
Æl
.
n
 = ()(
yym•
[0].
mö‹
.
yy0
.
z
 - yymsp[-3].minor.yy0.z) + yymsp[0].minor.yy0.n;

3373 
	`sqlôe3FöishTriggî
(
pP¨£
, 
yym•
[-1].
mö‹
.
yy75
, &
Æl
);

3380 
	`sqlôe3BegöTriggî
(
pP¨£
, &
yym•
[-7].
mö‹
.
yy0
, &yym•[-6].mö‹.yy0, yym•[-5].mö‹.
yy316
, yym•[-4].mö‹.
yy354
.
a
, yym•[-4].mö‹.yy354.
b
, yym•[-2].mö‹.
yy419
, yym•[0].mö‹.
yy450
, yymsp[-10].minor.yy316, yymsp[-8].minor.yy316);

3381 
yygŸomö‹
.
yy0
 = (
yym•
[-6].
mö‹
.yy0.
n
==0?yymsp[-7].minor.yy0:yymsp[-6].minor.yy0);

3386 273: 
	`yyã°ˇ£
(
yyruÀno
==273);

3388 { 
yygŸomö‹
.
yy316
 = 
TK_BEFORE
; }

3393 { 
yygŸomö‹
.
yy316
 = 
TK_AFTER
; }

3398 { 
yygŸomö‹
.
yy316
 = 
TK_INSTEAD
;}

3402 275: 
	`yyã°ˇ£
(
yyruÀno
==275);

3404 {
yygŸomö‹
.
yy354
.
a
 = 
yym•
[0].
maj‹
; yygŸomö‹.yy354.
b
 = 0;}

3409 {
yygŸomö‹
.
yy354
.
a
 = 
TK_UPDATE
; yygŸomö‹.yy354.
b
 = 
yym•
[0].
mö‹
.
yy352
;}

3413 301: 
	`yyã°ˇ£
(
yyruÀno
==301);

3415 { 
yygŸomö‹
.
yy450
 = 0; }

3419 302: 
	`yyã°ˇ£
(
yyruÀno
==302);

3421 { 
yygŸomö‹
.
yy450
 = 
yym•
[0].
mö‹
.
yy86
.
pEx¥
; }

3427 
	`as£π
–
yym•
[-2].
mö‹
.
yy75
!=0 );

3428 
yym•
[-2].
mö‹
.
yy75
->
pLa°
->
pNext
 = yymsp[-1].minor.yy75;

3429 
yym•
[-2].
mö‹
.
yy75
->
pLa°
 = yymsp[-1].minor.yy75;

3430 
yygŸomö‹
.
yy75
 = 
yym•
[-2].
mö‹
.yy75;

3437 
	`as£π
–
yym•
[-1].
mö‹
.
yy75
!=0 );

3438 
yym•
[-1].
mö‹
.
yy75
->
pLa°
 = yymsp[-1].minor.yy75;

3439 
yygŸomö‹
.
yy75
 = 
yym•
[-1].
mö‹
.yy75;

3446 
yygŸomö‹
.
yy0
 = 
yym•
[0].
mö‹
.yy0;

3447 
	`sqlôe3Eº‹Msg
(
pP¨£
,

3456 
	`sqlôe3Eº‹Msg
(
pP¨£
,

3465 
	`sqlôe3Eº‹Msg
(
pP¨£
,

3473 { 
yygŸomö‹
.
yy75
 = 
	`sqlôe3TriggîUpd©eSãp
(
pP¨£
->
db
, &
yym•
[-4].
mö‹
.
yy0
, yym•[-1].mö‹.
yy242
, yym•[0].mö‹.
yy450
, yym•[-5].mö‹.
yy306
); }

3478 {
yygŸomö‹
.
yy75
 = 
	`sqlôe3TriggîIn£πSãp
(
pP¨£
->
db
, &
yym•
[-2].
mö‹
.
yy0
, yym•[-1].mö‹.
yy352
, yym•[0].mö‹.
yy323
.
pLi°
, yym•[0].mö‹.yy323.
pSñe˘
, yym•[-4].mö‹.
yy306
);}

3483 {
yygŸomö‹
.
yy75
 = 
	`sqlôe3TriggîIn£πSãp
(
pP¨£
->
db
, &
yym•
[-2].
mö‹
.
yy0
, yym•[-1].mö‹.
yy352
, 0, yym•[0].mö‹.
yy43
, yym•[-4].mö‹.
yy306
);}

3488 {
yygŸomö‹
.
yy75
 = 
	`sqlôe3TriggîDñëeSãp
(
pP¨£
->
db
, &
yym•
[-2].
mö‹
.
yy0
, yym•[0].mö‹.
yy450
);}

3493 {
yygŸomö‹
.
yy75
 = 
	`sqlôe3TriggîSñe˘Sãp
(
pP¨£
->
db
, 
yym•
[0].
mö‹
.
yy43
); }

3499 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_RAISE
, 0, 0, 0);

3500 if–
yygŸomö‹
.
yy86
.
pEx¥
 ){

3501 
yygŸomö‹
.
yy86
.
pEx¥
->
afföôy
 = 
OE_Ign‹e
;

3503 
yygŸomö‹
.
yy86
.
zSèπ
 = 
yym•
[-3].
mö‹
.
yy0
.
z
;

3504 
yygŸomö‹
.
yy86
.
zEnd
 = &
yym•
[0].
mö‹
.
yy0
.
z
[yym•[0].mö‹.yy0.
n
];

3511 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_RAISE
, 0, 0, &
yym•
[-1].
mö‹
.
yy0
);

3512 if–
yygŸomö‹
.
yy86
.
pEx¥
 ) {

3513 
yygŸomö‹
.
yy86
.
pEx¥
->
afföôy
 = ()
yym•
[-3].
mö‹
.
yy316
;

3515 
yygŸomö‹
.
yy86
.
zSèπ
 = 
yym•
[-5].
mö‹
.
yy0
.
z
;

3516 
yygŸomö‹
.
yy86
.
zEnd
 = &
yym•
[0].
mö‹
.
yy0
.
z
[yym•[0].mö‹.yy0.
n
];

3522 {
yygŸomö‹
.
yy316
 = 
OE_Rﬁlback
;}

3527 {
yygŸomö‹
.
yy316
 = 
OE_Faû
;}

3533 
	`sqlôe3Dr›Triggî
(
pP¨£
,
yym•
[0].
mö‹
.
yy419
,yym•[-1].mö‹.
yy316
);

3540 
	`sqlôe3Aâach
(
pP¨£
, 
yym•
[-3].
mö‹
.
yy86
.
pEx¥
, yym•[-1].mö‹.yy86.pEx¥, yym•[0].mö‹.
yy450
);

3547 
	`sqlôe3Dëach
(
pP¨£
, 
yym•
[0].
mö‹
.
yy86
.
pEx¥
);

3553 {
	`sqlôe3Reödex
(
pP¨£
, 0, 0);}

3558 {
	`sqlôe3Reödex
(
pP¨£
, &
yym•
[-1].
mö‹
.
yy0
, &yymsp[0].minor.yy0);}

3563 {
	`sqlôe3A«lyze
(
pP¨£
, 0, 0);}

3568 {
	`sqlôe3A«lyze
(
pP¨£
, &
yym•
[-1].
mö‹
.
yy0
, &yymsp[0].minor.yy0);}

3574 
	`sqlôe3A…îRíameTabÀ
(
pP¨£
,
yym•
[-3].
mö‹
.
yy419
,&yym•[0].mö‹.
yy0
);

3581 
pP¨£
->
c⁄°øötName
 = 
yym•
[-1].
mö‹
.
yy0
;

3582 
	`sqlôe3AddC⁄°øötgrk
(
pP¨£
,
yym•
[-4].
mö‹
.
yy419
,yym•[0].mö‹.
yy86
.
pEx¥
);

3588 {
	`sqlôe3VèbFöishP¨£
(
pP¨£
,0);}

3593 {
	`sqlôe3VèbFöishP¨£
(
pP¨£
,&
yym•
[0].
mö‹
.
yy0
);}

3599 
	`sqlôe3VèbBegöP¨£
(
pP¨£
, &
yym•
[-3].
mö‹
.
yy0
, &yym•[-2].mö‹.yy0, &yym•[0].mö‹.yy0, yym•[-4].mö‹.
yy316
);

3605 {
	`sqlôe3VèbArgInô
(
pP¨£
);}

3609 319: 
	`yyã°ˇ£
(
yyruÀno
==319);

3610 320: 
	`yyã°ˇ£
(
yyruÀno
==320);

3612 {
	`sqlôe3VèbArgExãnd
(
pP¨£
,&
yym•
[0].
mö‹
.
yy0
);}

3616  
	`yyã°ˇ£
(
yyruÀno
==0);

3617  
	`yyã°ˇ£
(
yyruÀno
==1);

3618  
	`yyã°ˇ£
(
yyruÀno
==2);

3619  
	`yyã°ˇ£
(
yyruÀno
==3);

3620  
	`yyã°ˇ£
(
yyruÀno
==4);

3621  
	`yyã°ˇ£
(
yyruÀno
==10);

3622  
	`yyã°ˇ£
(
yyruÀno
==11);

3623  
	`yyã°ˇ£
(
yyruÀno
==12);

3624  
	`yyã°ˇ£
(
yyruÀno
==20);

3625  
	`yyã°ˇ£
(
yyruÀno
==21);

3626  
	`yyã°ˇ£
(
yyruÀno
==25);

3627  
	`yyã°ˇ£
(
yyruÀno
==34);

3628  
	`yyã°ˇ£
(
yyruÀno
==35);

3629  
	`yyã°ˇ£
(
yyruÀno
==44);

3630  
	`yyã°ˇ£
(
yyruÀno
==51);

3631  
	`yyã°ˇ£
(
yyruÀno
==52);

3632  
	`yyã°ˇ£
(
yyruÀno
==53);

3633  
	`yyã°ˇ£
(
yyruÀno
==54);

3634  
	`yyã°ˇ£
(
yyruÀno
==61);

3635  
	`yyã°ˇ£
(
yyruÀno
==89);

3636  
	`yyã°ˇ£
(
yyruÀno
==90);

3637  
	`yyã°ˇ£
(
yyruÀno
==92);

3638  
	`yyã°ˇ£
(
yyruÀno
==277);

3639  
	`yyã°ˇ£
(
yyruÀno
==278);

3640  
	`yyã°ˇ£
(
yyruÀno
==285);

3641  
	`yyã°ˇ£
(
yyruÀno
==303);

3642  
	`yyã°ˇ£
(
yyruÀno
==304);

3643  
	`yyã°ˇ£
(
yyruÀno
==314);

3644  
	`yyã°ˇ£
(
yyruÀno
==315);

3645  
	`yyã°ˇ£
(
yyruÀno
==317);

3646  
	`yyã°ˇ£
(
yyruÀno
==321);

3647  
	`yyã°ˇ£
(
yyruÀno
==322);

3648  
	`yyã°ˇ£
(
yyruÀno
==323);

3651 
	`as£π
–
yyruÀno
>=0 && yyruÀno<(
yyRuÀInfo
)/(yyRuleInfo[0]) );

3652 
yygŸo
 = 
yyRuÀInfo
[
yyruÀno
].
lhs
;

3653 
yysize
 = 
yyRuÀInfo
[
yyruÀno
].
ƒhs
;

3654 
yypP¨£r
->
yyidx
 -
yysize
;

3655 
yya˘
 = 
	`yy_föd_ªdu˚_a˘i⁄
(
yym•
[-
yysize
].
°©ío
,(
YYCODETYPE
)
yygŸo
);

3656 if–
yya˘
 < 
YYNSTATE
 ){

3657 #ifde‡
NDEBUG


3662 if–
yysize
 ){

3663 
yypP¨£r
->
yyidx
++;

3664 
yym•
 -
yysize
-1;

3665 
yym•
->
°©ío
 = (
YYACTIONTYPE
)
yya˘
;

3666 
yym•
->
maj‹
 = (
YYCODETYPE
)
yygŸo
;

3667 
yym•
->
mö‹
 = 
yygŸomö‹
;

3671 
	`yy_shi·
(
yypP¨£r
,
yya˘
,
yygŸo
,&
yygŸomö‹
);

3674 
	`as£π
–
yya˘
 =
YYNSTATE
 + 
YYNRULE
 + 1 );

3675 
	`yy_ac˚±
(
yypP¨£r
);

3677 
	}
}

3682 #i‚de‡
YYNOERRORRECOVERY


3683 
	$yy_∑r£_Áûed
(

3684 
yyP¨£r
 *
yypP¨£r


3686 
sqlôe3P¨£rARG_FETCH
;

3687 #i‚de‡
NDEBUG


3688 if–
yyTø˚FILE
 ){

3689 
	`Ârötf
(
yyTø˚FILE
,"%sFaû!\n",
yyTø˚Prom±
);

3692  
yypP¨£r
->
yyidx
>=0 ) 
	`yy_p›_∑r£r_°ack
(yypParser);

3695 
sqlôe3P¨£rARG_STORE
;

3696 
	}
}

3702 
	$yy_sy¡ax_îr‹
(

3703 
yyP¨£r
 *
yypP¨£r
,

3704 
yymaj‹
,

3705 
YYMINORTYPE
 
yymö‹


3707 
sqlôe3P¨£rARG_FETCH
;

3708 
	#TOKEN
 (
yymö‹
.
yy0
)

	)

3711 
	`UNUSED_PARAMETER
(
yymaj‹
);

3712 
	`as£π
–
TOKEN
.
z
[0] );

3713 
	`sqlôe3Eº‹Msg
(
pP¨£
, "√¨ \"%T\": sy¡axÉº‹", &
TOKEN
);

3715 
sqlôe3P¨£rARG_STORE
;

3716 
	}
}

3721 
	$yy_ac˚±
(

3722 
yyP¨£r
 *
yypP¨£r


3724 
sqlôe3P¨£rARG_FETCH
;

3725 #i‚de‡
NDEBUG


3726 if–
yyTø˚FILE
 ){

3727 
	`Ârötf
(
yyTø˚FILE
,"%sAc˚±!\n",
yyTø˚Prom±
);

3730  
yypP¨£r
->
yyidx
>=0 ) 
	`yy_p›_∑r£r_°ack
(yypParser);

3733 
sqlôe3P¨£rARG_STORE
;

3734 
	}
}

3755 
	$sqlôe3P¨£r
(

3756 *
yyp
,

3757 
yymaj‹
,

3758 
sqlôe3P¨£rTOKENTYPE
 
yymö‹


3759 
sqlôe3P¨£rARG_PDECL


3761 
YYMINORTYPE
 
yymö‹uni⁄
;

3762 
yya˘
;

3763 #i‡!
	`deföed
(
YYERRORSYMBOL
Ë&& !deföed(
YYNOERRORRECOVERY
)

3764 
yyídoföput
;

3766 #ifde‡
YYERRORSYMBOL


3767 
yyîr‹hô
 = 0;

3769 
yyP¨£r
 *
yypP¨£r
;

3772 
yypP¨£r
 = (
yyP¨£r
*)
yyp
;

3773 if–
yypP¨£r
->
yyidx
<0 ){

3774 #i‡
YYSTACKDEPTH
<=0

3775 if–
yypP¨£r
->
yy°ksz
 <=0 ){

3777 
yymö‹uni⁄
 = 
yyzîomö‹
;

3778 
	`yySèckOvîÊow
(
yypP¨£r
, &
yymö‹uni⁄
);

3782 
yypP¨£r
->
yyidx
 = 0;

3783 
yypP¨£r
->
yyîr˙t
 = -1;

3784 
yypP¨£r
->
yy°ack
[0].
°©ío
 = 0;

3785 
yypP¨£r
->
yy°ack
[0].
maj‹
 = 0;

3787 
yymö‹uni⁄
.
yy0
 = 
yymö‹
;

3788 #i‡!
	`deföed
(
YYERRORSYMBOL
Ë&& !deföed(
YYNOERRORRECOVERY
)

3789 
yyídoföput
 = (
yymaj‹
==0);

3791 
sqlôe3P¨£rARG_STORE
;

3793 #i‚de‡
NDEBUG


3794 if–
yyTø˚FILE
 ){

3795 
	`Ârötf
(
yyTø˚FILE
,"%sI≈uà%s\n",
yyTø˚Prom±
,
yyTokíName
[
yymaj‹
]);

3800 
yya˘
 = 
	`yy_föd_shi·_a˘i⁄
(
yypP¨£r
,(
YYCODETYPE
)
yymaj‹
);

3801 if–
yya˘
<
YYNSTATE
 ){

3802 
	`yy_shi·
(
yypP¨£r
,
yya˘
,
yymaj‹
,&
yymö‹uni⁄
);

3803 
yypP¨£r
->
yyîr˙t
--;

3804 
yymaj‹
 = 
YYNOCODE
;

3805 }if–
yya˘
 < 
YYNSTATE
 + 
YYNRULE
 ){

3806 
	`yy_ªdu˚
(
yypP¨£r
,
yya˘
-
YYNSTATE
);

3808 
	`as£π
–
yya˘
 =
YY_ERROR_ACTION
 );

3809 #ifde‡
YYERRORSYMBOL


3810 
yymx
;

3812 #i‚de‡
NDEBUG


3813 if–
yyTø˚FILE
 ){

3814 
	`Ârötf
(
yyTø˚FILE
,"%sSy¡ax Eº‹!\n",
yyTø˚Prom±
);

3817 #ifde‡
YYERRORSYMBOL


3837 if–
yypP¨£r
->
yyîr˙t
<0 ){

3838 
	`yy_sy¡ax_îr‹
(
yypP¨£r
,
yymaj‹
,
yymö‹uni⁄
);

3840 
yymx
 = 
yypP¨£r
->
yy°ack
[yypP¨£r->
yyidx
].
maj‹
;

3841 if–
yymx
==
YYERRORSYMBOL
 || 
yyîr‹hô
 ){

3842 #i‚de‡
NDEBUG


3843 if–
yyTø˚FILE
 ){

3844 
	`Ârötf
(
yyTø˚FILE
,"%sDiscard inputÅoken %s\n",

3845 
yyTø˚Prom±
,
yyTokíName
[
yymaj‹
]);

3848 
	`yy_de°ru˘‹
(
yypP¨£r
, (
YYCODETYPE
)
yymaj‹
,&
yymö‹uni⁄
);

3849 
yymaj‹
 = 
YYNOCODE
;

3852 
yypP¨£r
->
yyidx
 >= 0 &&

3853 
yymx
 !
YYERRORSYMBOL
 &&

3854 (
yya˘
 = 
	`yy_föd_ªdu˚_a˘i⁄
(

3855 
yypP¨£r
->
yy°ack
[yypP¨£r->
yyidx
].
°©ío
,

3856 
YYERRORSYMBOL
)Ë>
YYNSTATE


3858 
	`yy_p›_∑r£r_°ack
(
yypP¨£r
);

3860 if–
yypP¨£r
->
yyidx
 < 0 || 
yymaj‹
==0 ){

3861 
	`yy_de°ru˘‹
(
yypP¨£r
,(
YYCODETYPE
)
yymaj‹
,&
yymö‹uni⁄
);

3862 
	`yy_∑r£_Áûed
(
yypP¨£r
);

3863 
yymaj‹
 = 
YYNOCODE
;

3864 }if–
yymx
!=
YYERRORSYMBOL
 ){

3865 
YYMINORTYPE
 
u2
;

3866 
u2
.
YYERRSYMDT
 = 0;

3867 
	`yy_shi·
(
yypP¨£r
,
yya˘
,
YYERRORSYMBOL
,&
u2
);

3870 
yypP¨£r
->
yyîr˙t
 = 3;

3871 
yyîr‹hô
 = 1;

3872 #ñi‡
	`deföed
(
YYNOERRORRECOVERY
)

3880 
	`yy_sy¡ax_îr‹
(
yypP¨£r
,
yymaj‹
,
yymö‹uni⁄
);

3881 
	`yy_de°ru˘‹
(
yypP¨£r
,(
YYCODETYPE
)
yymaj‹
,&
yymö‹uni⁄
);

3882 
yymaj‹
 = 
YYNOCODE
;

3894 if–
yypP¨£r
->
yyîr˙t
<=0 ){

3895 
	`yy_sy¡ax_îr‹
(
yypP¨£r
,
yymaj‹
,
yymö‹uni⁄
);

3897 
yypP¨£r
->
yyîr˙t
 = 3;

3898 
	`yy_de°ru˘‹
(
yypP¨£r
,(
YYCODETYPE
)
yymaj‹
,&
yymö‹uni⁄
);

3899 if–
yyídoföput
 ){

3900 
	`yy_∑r£_Áûed
(
yypP¨£r
);

3902 
yymaj‹
 = 
YYNOCODE
;

3905 } 
yymaj‹
!=
YYNOCODE
 && 
yypP¨£r
->
yyidx
>=0 );

3907 
	}
}

	@parse.h

1 
	#TK_SEMI
 1

	)

2 
	#TK_EXPLAIN
 2

	)

3 
	#TK_QUERY
 3

	)

4 
	#TK_PLAN
 4

	)

5 
	#TK_BEGIN
 5

	)

6 
	#TK_TRANSACTION
 6

	)

7 
	#TK_DEFERRED
 7

	)

8 
	#TK_IMMEDIATE
 8

	)

9 
	#TK_EXCLUSIVE
 9

	)

10 
	#TK_COMMIT
 10

	)

11 
	#TK_END
 11

	)

12 
	#TK_ROLLBACK
 12

	)

13 
	#TK_SAVEPOINT
 13

	)

14 
	#TK_RELEASE
 14

	)

15 
	#TK_TO
 15

	)

16 
	#TK_TABLE
 16

	)

17 
	#TK_CREATE
 17

	)

18 
	#TK_IF
 18

	)

19 
	#TK_NOT
 19

	)

20 
	#TK_EXISTS
 20

	)

21 
	#TK_TEMP
 21

	)

22 
	#TK_LP
 22

	)

23 
	#TK_RP
 23

	)

24 
	#TK_AS
 24

	)

25 
	#TK_COMMA
 25

	)

26 
	#TK_ID
 26

	)

27 
	#TK_INDEXED
 27

	)

28 
	#TK_ABORT
 28

	)

29 
	#TK_ACTION
 29

	)

30 
	#TK_AFTER
 30

	)

31 
	#TK_ANALYZE
 31

	)

32 
	#TK_ASC
 32

	)

33 
	#TK_ATTACH
 33

	)

34 
	#TK_BEFORE
 34

	)

35 
	#TK_BY
 35

	)

36 
	#TK_CASCADE
 36

	)

37 
	#TK_CAST
 37

	)

38 
	#TK_COLUMNKW
 38

	)

39 
	#TK_CONFLICT
 39

	)

40 
	#TK_DATABASE
 40

	)

41 
	#TK_DESC
 41

	)

42 
	#TK_DETACH
 42

	)

43 
	#TK_EACH
 43

	)

44 
	#TK_FAIL
 44

	)

45 
	#TK_FOR
 45

	)

46 
	#TK_IGNORE
 46

	)

47 
	#TK_INITIALLY
 47

	)

48 
	#TK_INSTEAD
 48

	)

49 
	#TK_LIKE_KW
 49

	)

50 
	#TK_MATCH
 50

	)

51 
	#TK_NO
 51

	)

52 
	#TK_KEY
 52

	)

53 
	#TK_OF
 53

	)

54 
	#TK_OFFSET
 54

	)

55 
	#TK_PRAGMA
 55

	)

56 
	#TK_RAISE
 56

	)

57 
	#TK_REPLACE
 57

	)

58 
	#TK_RESTRICT
 58

	)

59 
	#TK_ROW
 59

	)

60 
	#TK_TRIGGER
 60

	)

61 
	#TK_VACUUM
 61

	)

62 
	#TK_VIEW
 62

	)

63 
	#TK_VIRTUAL
 63

	)

64 
	#TK_REINDEX
 64

	)

65 
	#TK_RENAME
 65

	)

66 
	#TK_CTIME_KW
 66

	)

67 
	#TK_ANY
 67

	)

68 
	#TK_OR
 68

	)

69 
	#TK_AND
 69

	)

70 
	#TK_IS
 70

	)

71 
	#TK_BETWEEN
 71

	)

72 
	#TK_IN
 72

	)

73 
	#TK_ISNULL
 73

	)

74 
	#TK_NOTNULL
 74

	)

75 
	#TK_NE
 75

	)

76 
	#TK_EQ
 76

	)

77 
	#TK_GT
 77

	)

78 
	#TK_LE
 78

	)

79 
	#TK_LT
 79

	)

80 
	#TK_GE
 80

	)

81 
	#TK_ESCAPE
 81

	)

82 
	#TK_BITAND
 82

	)

83 
	#TK_BITOR
 83

	)

84 
	#TK_LSHIFT
 84

	)

85 
	#TK_RSHIFT
 85

	)

86 
	#TK_PLUS
 86

	)

87 
	#TK_MINUS
 87

	)

88 
	#TK_STAR
 88

	)

89 
	#TK_SLASH
 89

	)

90 
	#TK_REM
 90

	)

91 
	#TK_CONCAT
 91

	)

92 
	#TK_COLLATE
 92

	)

93 
	#TK_BITNOT
 93

	)

94 
	#TK_STRING
 94

	)

95 
	#TK_JOIN_KW
 95

	)

96 
	#TK_CONSTRAINT
 96

	)

97 
	#TK_DEFAULT
 97

	)

98 
	#TK_NULL
 98

	)

99 
	#TK_PRIMARY
 99

	)

100 
	#TK_UNIQUE
 100

	)

101 
	#TK_CHECK
 101

	)

102 
	#TK_REFERENCES
 102

	)

103 
	#TK_AUTOINCR
 103

	)

104 
	#TK_ON
 104

	)

105 
	#TK_INSERT
 105

	)

106 
	#TK_DELETE
 106

	)

107 
	#TK_UPDATE
 107

	)

108 
	#TK_SET
 108

	)

109 
	#TK_DEFERRABLE
 109

	)

110 
	#TK_FOREIGN
 110

	)

111 
	#TK_DROP
 111

	)

112 
	#TK_UNION
 112

	)

113 
	#TK_ALL
 113

	)

114 
	#TK_EXCEPT
 114

	)

115 
	#TK_INTERSECT
 115

	)

116 
	#TK_SELECT
 116

	)

117 
	#TK_DISTINCT
 117

	)

118 
	#TK_DOT
 118

	)

119 
	#TK_FROM
 119

	)

120 
	#TK_JOIN
 120

	)

121 
	#TK_USING
 121

	)

122 
	#TK_ORDER
 122

	)

123 
	#TK_GROUP
 123

	)

124 
	#TK_HAVING
 124

	)

125 
	#TK_LIMIT
 125

	)

126 
	#TK_WHERE
 126

	)

127 
	#TK_INTO
 127

	)

128 
	#TK_VALUES
 128

	)

129 
	#TK_INTEGER
 129

	)

130 
	#TK_FLOAT
 130

	)

131 
	#TK_BLOB
 131

	)

132 
	#TK_REGISTER
 132

	)

133 
	#TK_VARIABLE
 133

	)

134 
	#TK_CASE
 134

	)

135 
	#TK_WHEN
 135

	)

136 
	#TK_THEN
 136

	)

137 
	#TK_ELSE
 137

	)

138 
	#TK_INDEX
 138

	)

139 
	#TK_ALTER
 139

	)

140 
	#TK_ADD
 140

	)

	@parse.y

19 %
tokí_¥efix
 
TK_


24 %
tokí_ty≥
 {
Tokí
}

25 %
deÁu…_ty≥
 {
Tokí
}

28 %
exåa_¨gumít
 {
P¨£
 *
pP¨£
}

32 %
sy¡ax_îr‹
 {

33 
UNUSED_PARAMETER
(
yymaj‹
);

34 
as£π
–
TOKEN
.
z
[0] );

35 
sqlôe3Eº‹Msg
(
pP¨£
, "√¨ \"%T\": sy¡axÉº‹", &
TOKEN
);

37 %
°ack_ovîÊow
 {

38 
UNUSED_PARAMETER
(
yypMö‹
);

39 
sqlôe3Eº‹Msg
(
pP¨£
, "parser stack overflow");

44 %
«me
 
sqlôe3P¨£r


49 %
ö˛ude
 {

50 
	~"sqlôeI¡.h
"

56 
	#YYNOERRORRECOVERY
 1

	)

61 
	#yyã°ˇ£
(
X
Ë
	`ã°ˇ£
(X)

	)

67 
	sLimôVÆ
 {

68 
Ex¥
 *
pLimô
;

69 
Ex¥
 *
pOff£t
;

76 
	sLikeOp
 {

77 
Tokí
 
eO≥øt‹
;

78 
bNŸ
;

90 
	sTrigEvít
 { 
a
; 
IdLi°
 * 
b
; };

95 
	sAâachKey
 { 
ty≥
; 
Tokí
 
key
; };

100 
	sVÆueLi°
 {

101 
Ex¥Li°
 *
pLi°
;

102 
Sñe˘
 *
pSñe˘
;

108 
öput
 ::
cmdli°
.

109 
cmdli°
 ::cmdli° 
ecmd
.

110 
cmdli°
 ::
ecmd
.

111 
ecmd
 ::
SEMI
.

112 
ecmd
 ::
ex∂aö
 
cmdx
 
SEMI
.

113 
ex∂aö
 ::. { 
sqlôe3BegöP¨£
(
pP¨£
, 0); }

114 %
i‚def
 
SQLITE_OMIT_EXPLAIN


115 
ex∂aö
 ::
EXPLAIN
. { 
sqlôe3BegöP¨£
(
pP¨£
, 1); }

116 
ex∂aö
 ::
EXPLAIN
 
QUERY
 
PLAN
. { 
sqlôe3BegöP¨£
(
pP¨£
, 2); }

117 %
ídif
 
SQLITE_OMIT_EXPLAIN


118 
cmdx
 ::
cmd
. { 
sqlôe3FöishCodög
(
pP¨£
); }

123 
cmd
 ::
BEGIN
 
	$å™°y≥
(
Y
Ë
å™s_›t
. {
	`sqlôe3BegöTønß˘i⁄
(
pP¨£
, Y);
	}
}

124 
å™s_›t
 ::= .

125 
å™s_›t
 ::
TRANSACTION
.

126 
å™s_›t
 ::
TRANSACTION
 
nm
.

127 %
ty≥
 
å™°y≥
 {}

128 
	$å™°y≥
(
A
Ë::. {A = 
TK_DEFERRED
;
	}
}

129 
	$å™°y≥
(
A
Ë::
	`DEFERRED
(
X
). {A = @X;
	}
}

130 
	$å™°y≥
(
A
Ë::
	`IMMEDIATE
(
X
). {A = @X;
	}
}

131 
	$å™°y≥
(
A
Ë::
	`EXCLUSIVE
(
X
). {A = @X;
	}
}

132 
cmd
 ::
COMMIT
 
å™s_›t
. {
sqlôe3CommôTønß˘i⁄
(
pP¨£
);}

133 
cmd
 ::
END
 
å™s_›t
. {
sqlôe3CommôTønß˘i⁄
(
pP¨£
);}

134 
cmd
 ::
ROLLBACK
 
å™s_›t
. {
sqlôe3RﬁlbackTønß˘i⁄
(
pP¨£
);}

136 
ßvïoöt_›t
 ::
SAVEPOINT
.

137 
ßvïoöt_›t
 ::= .

138 
cmd
 ::
SAVEPOINT
 
nm
(
X
). {

139 
sqlôe3Savïoöt
(
pP¨£
, 
SAVEPOINT_BEGIN
, &
X
);

141 
cmd
 ::
RELEASE
 
ßvïoöt_›t
 
nm
(
X
). {

142 
sqlôe3Savïoöt
(
pP¨£
, 
SAVEPOINT_RELEASE
, &
X
);

144 
cmd
 ::
ROLLBACK
 
å™s_›t
 
TO
 
ßvïoöt_›t
 
nm
(
X
). {

145 
sqlôe3Savïoöt
(
pP¨£
, 
SAVEPOINT_ROLLBACK
, &
X
);

150 
cmd
 ::
¸óã_èbÀ
 
¸óã_èbÀ_¨gs
.

151 
¸óã_èbÀ
 ::
¸óãkw
 
	$ãmp
(
T
Ë
TABLE
 
	$i‚Ÿexi°s
(
E
Ë
	$nm
(
Y
Ë
	`dbnm
(
Z
). {

152 
	`sqlôe3SèπTabÀ
(
pP¨£
,&
Y
,&
Z
,
T
,0,0,
E
);

153 
	}
}

154 
	$¸óãkw
(
A
Ë::
	`CREATE
(
X
). {

155 
pP¨£
->
db
->
lookaside
.
bE«bÀd
 = 0;

156 
A
 = 
X
;

157 
	}
}

158 %
ty≥
 
i‚Ÿexi°s
 {}

159 
	$i‚Ÿexi°s
(
A
Ë::. {A = 0;
	}
}

160 
	$i‚Ÿexi°s
(
A
Ë::
IF
 
NOT
 
EXISTS
. {A = 1;
	}
}

161 %
ty≥
 
ãmp
 {}

162 %
i‚def
 
SQLITE_OMIT_TEMPDB


163 
	$ãmp
(
A
Ë::
TEMP
. {A = 1;
	}
}

164 %
ídif
 
SQLITE_OMIT_TEMPDB


165 
	$ãmp
(
A
Ë::. {A = 0;
	}
}

166 
¸óã_èbÀ_¨gs
 ::
LP
 
cﬁum∆i°
 
	$c⁄¶i°_›t
(
X
Ë
	`RP
(
Y
). {

167 
	`sqlôe3EndTabÀ
(
pP¨£
,&
X
,&
Y
,0);

168 
	}
}

169 
¸óã_èbÀ_¨gs
 ::
AS
 
£À˘
(
S
). {

170 
sqlôe3EndTabÀ
(
pP¨£
,0,0,
S
);

171 
sqlôe3Sñe˘Dñëe
(
pP¨£
->
db
, 
S
);

173 
cﬁum∆i°
 ::cﬁum∆i° 
COMMA
 
cﬁumn
.

174 
cﬁum∆i°
 ::
cﬁumn
.

181 
	$cﬁumn
(
A
Ë::
	$cﬁumnid
(
X
Ë
ty≥
 
ˇrgli°
. {

182 
A
.
z
 = 
X
.z;

183 
A
.
n
 = ()(
pP¨£
->
sLa°Tokí
.
z
-
X
.z) +ÖParse->sLastToken.n;

184 
	}
}

185 
	$cﬁumnid
(
A
Ë::
	`nm
(
X
). {

186 
	`sqlôe3AddCﬁumn
(
pP¨£
,&
X
);

187 
A
 = 
X
;

188 
pP¨£
->
c⁄°øötName
.
n
 = 0;

189 
	}
}

195 %
ty≥
 
id
 {
Tokí
}

196 
	$id
(
A
Ë::
	`ID
(
X
). {A = X;
	}
}

197 
	$id
(
A
Ë::
	`INDEXED
(
X
). {A = X;
	}
}

203 %
ÁŒback
 
ID


204 
ABORT
 
ACTION
 
AFTER
 
ANALYZE
 
ASC
 
ATTACH
 
BEFORE
 
BEGIN
 
BY
 
CASCADE
 
CAST
 
COLUMNKW


205 
CONFLICT
 
DATABASE
 
DEFERRED
 
DESC
 
DETACH
 
EACH
 
END
 
EXCLUSIVE
 
EXPLAIN
 
FAIL
 
FOR


206 
IGNORE
 
IMMEDIATE
 
INITIALLY
 
INSTEAD
 
LIKE_KW
 
MATCH
 
NO
 
PLAN


207 
QUERY
 
KEY
 
OF
 
OFFSET
 
PRAGMA
 
RAISE
 
RELEASE
 
REPLACE
 
RESTRICT
 
ROW
 
ROLLBACK


208 
SAVEPOINT
 
TEMP
 
TRIGGER
 
VACUUM
 
VIEW
 
VIRTUAL


209 %
ifdef
 
SQLITE_OMIT_COMPOUND_SELECT


210 
EXCEPT
 
INTERSECT
 
UNION


211 %
ídif
 
SQLITE_OMIT_COMPOUND_SELECT


212 
REINDEX
 
RENAME
 
CTIME_KW
 
IF


214 %
wûdˇrd
 
ANY
.

227 %
À·
 
OR
.

228 %
À·
 
AND
.

229 %
right
 
NOT
.

230 %
À·
 
IS
 
MATCH
 
LIKE_KW
 
BETWEEN
 
IN
 
ISNULL
 
NOTNULL
 
NE
 
EQ
.

231 %
À·
 
GT
 
LE
 
LT
 
GE
.

232 %
right
 
ESCAPE
.

233 %
À·
 
BITAND
 
BITOR
 
LSHIFT
 
RSHIFT
.

234 %
À·
 
PLUS
 
MINUS
.

235 %
À·
 
STAR
 
SLASH
 
REM
.

236 %
À·
 
CONCAT
.

237 %
À·
 
COLLATE
.

238 %
right
 
BITNOT
.

242 %
ty≥
 
ids
 {
Tokí
}

243 
	$ids
(
A
Ë::
ID
|
	`STRING
(
X
). {A = X;
	}
}

247 %
ty≥
 
nm
 {
Tokí
}

248 
	$nm
(
A
Ë::
	`id
(
X
). {A = X;
	}
}

249 
	$nm
(
A
Ë::
	`STRING
(
X
). {A = X;
	}
}

250 
	$nm
(
A
Ë::
	`JOIN_KW
(
X
). {A = X;
	}
}

256 %
ty≥
 
ty≥tokí
 {
Tokí
}

257 
ty≥
 ::= .

258 
ty≥
 ::
ty≥tokí
(
X
). {
sqlôe3AddCﬁumnTy≥
(
pP¨£
,&X);}

259 
	$ty≥tokí
(
A
Ë::
	`ty≥«me
(
X
). {A = X;
	}
}

260 
	$ty≥tokí
(
A
Ë::
	$ty≥«me
(
X
Ë
LP
 sig√d 
	`RP
(
Y
). {

261 
A
.
z
 = 
X
.z;

262 
A
.
n
 = ()(&
Y
.
z
[Y.n] - 
X
.z);

263 
	}
}

264 
	$ty≥tokí
(
A
Ë::
	$ty≥«me
(
X
Ë
LP
 sig√d 
COMMA
 sig√d 
	`RP
(
Y
). {

265 
A
.
z
 = 
X
.z;

266 
A
.
n
 = ()(&
Y
.
z
[Y.n] - 
X
.z);

267 
	}
}

268 %
ty≥
 
ty≥«me
 {
Tokí
}

269 
	$ty≥«me
(
A
Ë::
	`ids
(
X
). {A = X;
	}
}

270 
	$ty≥«me
(
A
Ë::
	$ty≥«me
(
X
Ë
	`ids
(
Y
). {
A
.
z
=X.z; A.
n
=Y.n+()(Y.z-X.z);
	}
}

271 sig√d ::
∂us_num
.

272 sig√d ::
möus_num
.

277 
ˇrgli°
 ::ˇrgli° 
cc⁄s
.

278 
ˇrgli°
 ::= .

279 
cc⁄s
 ::
CONSTRAINT
 
nm
(
X
). {
pP¨£
->
c⁄°øötName
 = X;}

280 
cc⁄s
 ::
DEFAULT
 
ãrm
(
X
). {
sqlôe3AddDeÁu…VÆue
(
pP¨£
,&X);}

281 
cc⁄s
 ::
DEFAULT
 
LP
 
	$ex¥
(
X
Ë
RP
. {
	`sqlôe3AddDeÁu…VÆue
(
pP¨£
,&X);
	}
}

282 
cc⁄s
 ::
DEFAULT
 
PLUS
 
ãrm
(
X
). {
sqlôe3AddDeÁu…VÆue
(
pP¨£
,&X);}

283 
cc⁄s
 ::
DEFAULT
 
	$MINUS
(
A
Ë
	`ãrm
(
X
). {

284 
Ex¥S∑n
 
v
;

285 
v
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_UMINUS
, 
X
.pExpr, 0, 0);

286 
v
.
zSèπ
 = 
A
.
z
;

287 
v
.
zEnd
 = 
X
.zEnd;

288 
	`sqlôe3AddDeÁu…VÆue
(
pP¨£
,&
v
);

289 
	}
}

290 
cc⁄s
 ::
DEFAULT
 
id
(
X
). {

291 
Ex¥S∑n
 
v
;

292 
•™Ex¥
(&
v
, 
pP¨£
, 
TK_STRING
, &
X
);

293 
sqlôe3AddDeÁu…VÆue
(
pP¨£
,&
v
);

299 
cc⁄s
 ::
NULL
 
⁄c⁄f
.

300 
cc⁄s
 ::
NOT
 
NULL
 
⁄c⁄f
(
R
). {
sqlôe3AddNŸNuŒ
(
pP¨£
, R);}

301 
cc⁄s
 ::
PRIMARY
 
KEY
 
	$s‹t‹dî
(
Z
Ë
	$⁄c⁄f
(
R
Ë
	`autoöc
(
I
).

302 {
	`sqlôe3AddPrim¨yKey
(
pP¨£
,0,
R
,
I
,
Z
);
	}
}

303 
cc⁄s
 ::
UNIQUE
 
⁄c⁄f
(
R
). {
sqlôe3Cª©eIndex
(
pP¨£
,0,0,0,0,R,0,0,0,0);}

304 
cc⁄s
 ::
CHECK
 
LP
 
	$ex¥
(
X
Ë
RP
. {
	`sqlôe3AddCheckC⁄°øöt
(
pP¨£
,X.
pEx¥
);
	}
}

305 
cc⁄s
 ::
REFERENCES
 
	$nm
(
T
Ë
	$idxli°_›t
(
TA
Ë
	`ªÁrgs
(
R
).

306 {
	`sqlôe3Cª©eF‹eignKey
(
pP¨£
,0,&
T
,
TA
,
R
);
	}
}

307 
cc⁄s
 ::
de„r_sub˛au£
(
D
). {
sqlôe3De„rF‹eignKey
(
pP¨£
,D);}

308 
cc⁄s
 ::
COLLATE
 
ids
(
C
). {
sqlôe3AddCﬁœãTy≥
(
pP¨£
, &C);}

311 %
ty≥
 
autoöc
 {}

312 
	$autoöc
(
X
Ë::. {X = 0;
	}
}

313 
	$autoöc
(
X
Ë::
AUTOINCR
. {X = 1;
	}
}

320 %
ty≥
 
ªÁrgs
 {}

321 
	$ªÁrgs
(
A
Ë::. { A = 
OE_N⁄e
*0x0101; 
	}
}

322 
	$ªÁrgs
(
A
Ë::
	$ªÁrgs
(
X
Ë
	`ªÁrg
(
Y
). { 
A
 = (X & ~Y.
mask
Ë| Y.
vÆue
; 
	}
}

323 %
ty≥
 
ªÁrg
 {°ru˘ {
vÆue
; 
mask
;}}

324 
	$ªÁrg
(
A
Ë::
MATCH
 
nm
. { A.
vÆue
 = 0; A.
mask
 = 0x000000; 
	}
}

325 
	$ªÁrg
(
A
Ë::
ON
 
INSERT
 
ªÁ˘
. { A.
vÆue
 = 0; A.
mask
 = 0x000000; 
	}
}

326 
	$ªÁrg
(
A
Ë::
ON
 
DELETE
 
	`ªÁ˘
(
X
). { A.
vÆue
 = X; A.
mask
 = 0x0000ff; 
	}
}

327 
	$ªÁrg
(
A
Ë::
ON
 
UPDATE
 
	`ªÁ˘
(
X
). { A.
vÆue
 = X<<8; A.
mask
 = 0x00ff00; 
	}
}

328 %
ty≥
 
ªÁ˘
 {}

329 
	$ªÁ˘
(
A
Ë::
SET
 
NULL
. { A = 
OE_SëNuŒ
; 
	}
}

330 
	$ªÁ˘
(
A
Ë::
SET
 
DEFAULT
. { A = 
OE_SëDÊt
; 
	}
}

331 
	$ªÁ˘
(
A
Ë::
CASCADE
. { A = 
OE_Casˇde
; 
	}
}

332 
	$ªÁ˘
(
A
Ë::
RESTRICT
. { A = 
OE_Re°ri˘
; 
	}
}

333 
	$ªÁ˘
(
A
Ë::
NO
 
ACTION
. { A = 
OE_N⁄e
; 
	}
}

334 %
ty≥
 
de„r_sub˛au£
 {}

335 
	$de„r_sub˛au£
(
A
Ë::
NOT
 
DEFERRABLE
 
öô_de„ºed_¥ed_›t
. {A = 0;
	}
}

336 
	$de„r_sub˛au£
(
A
Ë::
DEFERRABLE
 
	`öô_de„ºed_¥ed_›t
(
X
). {A = X;
	}
}

337 %
ty≥
 
öô_de„ºed_¥ed_›t
 {}

338 
	$öô_de„ºed_¥ed_›t
(
A
Ë::. {A = 0;
	}
}

339 
	$öô_de„ºed_¥ed_›t
(
A
Ë::
INITIALLY
 
DEFERRED
. {A = 1;
	}
}

340 
	$öô_de„ºed_¥ed_›t
(
A
Ë::
INITIALLY
 
IMMEDIATE
. {A = 0;
	}
}

342 
	$c⁄¶i°_›t
(
A
Ë::. {A.
n
 = 0; A.
z
 = 0;
	}
}

343 
	$c⁄¶i°_›t
(
A
Ë::
	$COMMA
(
X
Ë
c⁄¶i°
. {
A
 = X;
	}
}

344 
c⁄¶i°
 ::c⁄¶i° 
tc⁄scomma
 
tc⁄s
.

345 
c⁄¶i°
 ::
tc⁄s
.

346 
tc⁄scomma
 ::
COMMA
. {
pP¨£
->
c⁄°øötName
.
n
 = 0;}

347 
tc⁄scomma
 ::= .

348 
tc⁄s
 ::
CONSTRAINT
 
nm
(
X
). {
pP¨£
->
c⁄°øötName
 = X;}

349 
tc⁄s
 ::
PRIMARY
 
KEY
 
LP
 
	$idxli°
(
X
Ë
	$autoöc
(
I
Ë
RP
 
	`⁄c⁄f
(
R
).

350 {
	`sqlôe3AddPrim¨yKey
(
pP¨£
,
X
,
R
,
I
,0);
	}
}

351 
tc⁄s
 ::
UNIQUE
 
LP
 
	$idxli°
(
X
Ë
RP
 
	`⁄c⁄f
(
R
).

352 {
	`sqlôe3Cª©eIndex
(
pP¨£
,0,0,0,
X
,
R
,0,0,0,0);
	}
}

353 
tc⁄s
 ::
CHECK
 
LP
 
	$ex¥
(
E
Ë
RP
 
⁄c⁄f
.

354 {
	`sqlôe3AddCheckC⁄°øöt
(
pP¨£
,
E
.
pEx¥
);
	}
}

355 
tc⁄s
 ::
FOREIGN
 
KEY
 
LP
 
	$idxli°
(
FA
Ë
RP


356 
REFERENCES
 
	$nm
(
T
Ë
	$idxli°_›t
(
TA
Ë
	$ªÁrgs
(
R
Ë
	`de„r_sub˛au£_›t
(
D
). {

357 
	`sqlôe3Cª©eF‹eignKey
(
pP¨£
, 
FA
, &
T
, 
TA
, 
R
);

358 
	`sqlôe3De„rF‹eignKey
(
pP¨£
, 
D
);

359 
	}
}

360 %
ty≥
 
de„r_sub˛au£_›t
 {}

361 
	$de„r_sub˛au£_›t
(
A
Ë::. {A = 0;
	}
}

362 
	$de„r_sub˛au£_›t
(
A
Ë::
	`de„r_sub˛au£
(
X
). {A = X;
	}
}

367 %
ty≥
 
⁄c⁄f
 {}

368 %
ty≥
 
‹c⁄f
 {
u8
}

369 %
ty≥
 
ªsﬁvëy≥
 {}

370 
	$⁄c⁄f
(
A
Ë::. {A = 
OE_DeÁu…
;
	}
}

371 
	$⁄c⁄f
(
A
Ë::
ON
 
CONFLICT
 
	`ªsﬁvëy≥
(
X
). {A = X;
	}
}

372 
	$‹c⁄f
(
A
Ë::. {A = 
OE_DeÁu…
;
	}
}

373 
	$‹c⁄f
(
A
Ë::
OR
 
	`ªsﬁvëy≥
(
X
). {A = (
u8
)X;
	}
}

374 
	$ªsﬁvëy≥
(
A
Ë::
	`øi£ty≥
(
X
). {A = X;
	}
}

375 
	$ªsﬁvëy≥
(
A
Ë::
IGNORE
. {A = 
OE_Ign‹e
;
	}
}

376 
	$ªsﬁvëy≥
(
A
Ë::
REPLACE
. {A = 
OE_Rïœ˚
;
	}
}

380 
cmd
 ::
DROP
 
TABLE
 
	$i„xi°s
(
E
Ë
	`fuŒ«me
(
X
). {

381 
	`sqlôe3Dr›TabÀ
(
pP¨£
, 
X
, 0, 
E
);

382 
	}
}

383 %
ty≥
 
i„xi°s
 {}

384 
	$i„xi°s
(
A
Ë::
IF
 
EXISTS
. {A = 1;
	}
}

385 
	$i„xi°s
(
A
Ë::. {A = 0;
	}
}

389 %
i‚def
 
SQLITE_OMIT_VIEW


390 
cmd
 ::
	$¸óãkw
(
X
Ë
	$ãmp
(
T
Ë
VIEW
 
	$i‚Ÿexi°s
(
E
Ë
	$nm
(
Y
Ë
	$dbnm
(
Z
Ë
AS
 
	`£À˘
(
S
). {

391 
	`sqlôe3Cª©eVõw
(
pP¨£
, &
X
, &
Y
, &
Z
, 
S
, 
T
, 
E
);

392 
	}
}

393 
cmd
 ::
DROP
 
VIEW
 
	$i„xi°s
(
E
Ë
	`fuŒ«me
(
X
). {

394 
	`sqlôe3Dr›TabÀ
(
pP¨£
, 
X
, 1, 
E
);

395 
	}
}

396 %
ídif
 
SQLITE_OMIT_VIEW


400 
cmd
 ::
£À˘
(
X
). {

401 
Sñe˘De°
 
de°
 = {
SRT_Ouçut
, 0, 0, 0, 0};

402 
sqlôe3Sñe˘
(
pP¨£
, 
X
, &
de°
);

403 
sqlôe3Ex∂aöBegö
(
pP¨£
->
pVdbe
);

404 
sqlôe3Ex∂aöSñe˘
(
pP¨£
->
pVdbe
, 
X
);

405 
sqlôe3Ex∂aöFöish
(
pP¨£
->
pVdbe
);

406 
sqlôe3Sñe˘Dñëe
(
pP¨£
->
db
, 
X
);

409 %
ty≥
 
£À˘
 {
Sñe˘
*}

410 %
de°ru˘‹
 
£À˘
 {
sqlôe3Sñe˘Dñëe
(
pP¨£
->
db
, 
$$
);}

411 %
ty≥
 
⁄e£À˘
 {
Sñe˘
*}

412 %
de°ru˘‹
 
⁄e£À˘
 {
sqlôe3Sñe˘Dñëe
(
pP¨£
->
db
, 
$$
);}

414 
	$£À˘
(
A
Ë::
	`⁄e£À˘
(
X
). {A = X;
	}
}

415 %
i‚def
 
SQLITE_OMIT_COMPOUND_SELECT


416 
	$£À˘
(
A
Ë::
	$£À˘
(
X
Ë
	$mu…i£À˘_›
(
Y
Ë
	`⁄e£À˘
(
Z
). {

417 if–
Z
 ){

418 
Z
->
›
 = (
u8
)
Y
;

419 
Z
->
pPri‹
 = 
X
;

420 if–
Y
!=
TK_ALL
 ) 
pP¨£
->
hasCompound
 = 1;

422 
	`sqlôe3Sñe˘Dñëe
(
pP¨£
->
db
, 
X
);

424 
A
 = 
Z
;

425 
	}
}

426 %
ty≥
 
mu…i£À˘_›
 {}

427 
	$mu…i£À˘_›
(
A
Ë::
	`UNION
(
OP
). {A = @OP;
	}
}

428 
	$mu…i£À˘_›
(
A
Ë::
UNION
 
ALL
. {A = 
TK_ALL
;
	}
}

429 
	$mu…i£À˘_›
(
A
Ë::
EXCEPT
|
	`INTERSECT
(
OP
). {A = @OP;
	}
}

430 %
ídif
 
SQLITE_OMIT_COMPOUND_SELECT


431 
	$⁄e£À˘
(
A
Ë::
SELECT
 
	$di°ö˘
(
D
Ë
	$£lcﬁli°
(
W
Ë
	$‰om
(
X
Ë
	$whîe_›t
(
Y
)

432 
	$groupby_›t
(
P
Ë
	$havög_›t
(
Q
Ë
	$‹dîby_›t
(
Z
Ë
	`limô_›t
(
L
). {

433 
A
 = 
	`sqlôe3Sñe˘New
(
pP¨£
,
W
,
X
,
Y
,
P
,
Q
,
Z
,
D
,
L
.
pLimô
,L.
pOff£t
);

434 
	}
}

439 %
ty≥
 
di°ö˘
 {
u16
}

440 
	$di°ö˘
(
A
Ë::
DISTINCT
. {A = 
SF_Di°ö˘
;
	}
}

441 
	$di°ö˘
(
A
Ë::
ALL
. {A = 0;
	}
}

442 
	$di°ö˘
(
A
Ë::. {A = 0;
	}
}

449 %
ty≥
 
£lcﬁli°
 {
Ex¥Li°
*}

450 %
de°ru˘‹
 
£lcﬁli°
 {
sqlôe3Ex¥Li°Dñëe
(
pP¨£
->
db
, 
$$
);}

451 %
ty≥
 
s˛p
 {
Ex¥Li°
*}

452 %
de°ru˘‹
 
s˛p
 {
sqlôe3Ex¥Li°Dñëe
(
pP¨£
->
db
, 
$$
);}

453 
	$s˛p
(
A
Ë::
	$£lcﬁli°
(
X
Ë
COMMA
. {
A
 = X;
	}
}

454 
	$s˛p
(
A
Ë::. {A = 0;
	}
}

455 
	$£lcﬁli°
(
A
Ë::
	$s˛p
(
P
Ë
	$ex¥
(
X
Ë
	`as
(
Y
). {

456 
A
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
, 
P
, 
X
.
pEx¥
);

457 if–
Y
.
n
>0 ) 
	`sqlôe3Ex¥Li°SëName
(
pP¨£
, 
A
, &Y, 1);

458 
	`sqlôe3Ex¥Li°SëS∑n
(
pP¨£
,
A
,&
X
);

459 
	}
}

460 
	$£lcﬁli°
(
A
Ë::
	$s˛p
(
P
Ë
STAR
. {

461 
Ex¥
 *
p
 = 
	`sqlôe3Ex¥
(
pP¨£
->
db
, 
TK_ALL
, 0);

462 
A
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
, 
P
, 
p
);

463 
	}
}

464 
	$£lcﬁli°
(
A
Ë::
	$s˛p
(
P
Ë
	$nm
(
X
Ë
DOT
 
	`STAR
(
Y
). {

465 
Ex¥
 *
pRight
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_ALL
, 0, 0, &
Y
);

466 
Ex¥
 *
pLe·
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_ID
, 0, 0, &
X
);

467 
Ex¥
 *
pDŸ
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_DOT
, 
pLe·
, 
pRight
, 0);

468 
A
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,
P
, 
pDŸ
);

469 
	}
}

474 %
ty≥
 
as
 {
Tokí
}

475 
	$as
(
X
Ë::
AS
 
	`nm
(
Y
). {X = Y;
	}
}

476 
	$as
(
X
Ë::
	`ids
(
Y
). {X = Y;
	}
}

477 
	$as
(
X
Ë::. {X.
n
 = 0;
	}
}

480 %
ty≥
 
£…abli°
 {
SrcLi°
*}

481 %
de°ru˘‹
 
£…abli°
 {
sqlôe3SrcLi°Dñëe
(
pP¨£
->
db
, 
$$
);}

482 %
ty≥
 
°l_¥efix
 {
SrcLi°
*}

483 %
de°ru˘‹
 
°l_¥efix
 {
sqlôe3SrcLi°Dñëe
(
pP¨£
->
db
, 
$$
);}

484 %
ty≥
 
‰om
 {
SrcLi°
*}

485 %
de°ru˘‹
 
‰om
 {
sqlôe3SrcLi°Dñëe
(
pP¨£
->
db
, 
$$
);}

489 
	$‰om
(
A
Ë::. {A = 
	`sqlôe3DbMÆlocZîo
(
pP¨£
->
db
, (*A));
	}
}

490 
	$‰om
(
A
Ë::
FROM
 
	`£…abli°
(
X
). {

491 
A
 = 
X
;

492 
	`sqlôe3SrcLi°Shi·JoöTy≥
(
A
);

493 
	}
}

498 
	$°l_¥efix
(
A
Ë::
	$£…abli°
(
X
Ë
	`joö›
(
Y
). {

499 
A
 = 
X
;

500 if–
	`ALWAYS
(
A
 && A->
nSrc
>0ËËA->
a
[A->nSrc-1].
joöty≥
 = (
u8
)
Y
;

501 
	}
}

502 
	$°l_¥efix
(
A
Ë::. {A = 0;
	}
}

503 
	$£…abli°
(
A
Ë::
	$°l_¥efix
(
X
Ë
	$nm
(
Y
Ë
	$dbnm
(
D
Ë
	$as
(
Z
Ë
	$ödexed_›t
(
I
)

504 
	$⁄_›t
(
N
Ë
	`usög_›t
(
U
). {

505 
A
 = 
	`sqlôe3SrcLi°AµídFromTîm
(
pP¨£
,
X
,&
Y
,&
D
,&
Z
,0,
N
,
U
);

506 
	`sqlôe3SrcLi°IndexedBy
(
pP¨£
, 
A
, &
I
);

507 
	}
}

508 %
i‚def
 
SQLITE_OMIT_SUBQUERY


509 
	$£…abli°
(
A
Ë::
	$°l_¥efix
(
X
Ë
LP
 
	$£À˘
(
S
Ë
RP


510 
	$as
(
Z
Ë
	$⁄_›t
(
N
Ë
	`usög_›t
(
U
). {

511 
A
 = 
	`sqlôe3SrcLi°AµídFromTîm
(
pP¨£
,
X
,0,0,&
Z
,
S
,
N
,
U
);

512 
	}
}

513 
	$£…abli°
(
A
Ë::
	$°l_¥efix
(
X
Ë
LP
 
	$£…abli°
(
F
Ë
RP


514 
	$as
(
Z
Ë
	$⁄_›t
(
N
Ë
	`usög_›t
(
U
). {

515 if–
X
==0 && 
Z
.
n
==0 && 
N
==0 && 
U
==0 ){

516 
A
 = 
F
;

517 }if–
F
->
nSrc
==1 ){

518 
A
 = 
	`sqlôe3SrcLi°AµídFromTîm
(
pP¨£
,
X
,0,0,&
Z
,0,
N
,
U
);

519 if–
A
 ){

520 
SrcLi°_ôem
 *
pNew
 = &
A
->
a
[A->
nSrc
-1];

521 
SrcLi°_ôem
 *
pOld
 = 
F
->
a
;

522 
pNew
->
zName
 = 
pOld
->zName;

523 
pNew
->
zD©aba£
 = 
pOld
->zDatabase;

524 
pNew
->
pSñe˘
 = 
pOld
->pSelect;

525 
pOld
->
zName
 =ÖOld->
zD©aba£
 = 0;

526 
pOld
->
pSñe˘
 = 0;

528 
	`sqlôe3SrcLi°Dñëe
(
pP¨£
->
db
, 
F
);

530 
Sñe˘
 *
pSubquîy
;

531 
	`sqlôe3SrcLi°Shi·JoöTy≥
(
F
);

532 
pSubquîy
 = 
	`sqlôe3Sñe˘New
(
pP¨£
,0,
F
,0,0,0,0,
SF_Ne°edFrom
,0,0);

533 
A
 = 
	`sqlôe3SrcLi°AµídFromTîm
(
pP¨£
,
X
,0,0,&
Z
,
pSubquîy
,
N
,
U
);

535 
	}
}

536 %
ídif
 
SQLITE_OMIT_SUBQUERY


538 %
ty≥
 
dbnm
 {
Tokí
}

539 
	$dbnm
(
A
Ë::. {A.
z
=0; A.
n
=0;
	}
}

540 
	$dbnm
(
A
Ë::
DOT
 
	`nm
(
X
). {A = X;
	}
}

542 %
ty≥
 
fuŒ«me
 {
SrcLi°
*}

543 %
de°ru˘‹
 
fuŒ«me
 {
sqlôe3SrcLi°Dñëe
(
pP¨£
->
db
, 
$$
);}

544 
	$fuŒ«me
(
A
Ë::
	$nm
(
X
Ë
	`dbnm
(
Y
). {
A
 = 
	`sqlôe3SrcLi°Aµíd
(
pP¨£
->
db
,0,&X,&Y);
	}
}

546 %
ty≥
 
joö›
 {}

547 %
ty≥
 
joö›2
 {}

548 
	$joö›
(
X
Ë::
COMMA
|
JOIN
. { X = 
JT_INNER
; 
	}
}

549 
	$joö›
(
X
Ë::
	$JOIN_KW
(
A
Ë
JOIN
. { 
X
 = 
	`sqlôe3JoöTy≥
(
pP¨£
,&A,0,0); 
	}
}

550 
	$joö›
(
X
Ë::
	$JOIN_KW
(
A
Ë
	$nm
(
B
Ë
JOIN
. { 
X
 = 
	`sqlôe3JoöTy≥
(
pP¨£
,&
A
,&B,0); 
	}
}

551 
	$joö›
(
X
Ë::
	$JOIN_KW
(
A
Ë
	$nm
(
B
Ë
	$nm
(
C
Ë
JOIN
.

552 { 
X
 = 
	`sqlôe3JoöTy≥
(
pP¨£
,&
A
,&
B
,&
C
); 
	}
}

554 %
ty≥
 
⁄_›t
 {
Ex¥
*}

555 %
de°ru˘‹
 
⁄_›t
 {
sqlôe3Ex¥Dñëe
(
pP¨£
->
db
, 
$$
);}

556 
	$⁄_›t
(
N
Ë::
ON
 
	`ex¥
(
E
). {N = E.
pEx¥
;
	}
}

557 
	$⁄_›t
(
N
Ë::. {N = 0;
	}
}

569 %
ty≥
 
ödexed_›t
 {
Tokí
}

570 
	$ödexed_›t
(
A
Ë::. {A.
z
=0; A.
n
=0;
	}
}

571 
	$ödexed_›t
(
A
Ë::
INDEXED
 
BY
 
	`nm
(
X
). {A = X;
	}
}

572 
	$ödexed_›t
(
A
Ë::
NOT
 
INDEXED
. {A.
z
=0; A.
n
=1;
	}
}

574 %
ty≥
 
usög_›t
 {
IdLi°
*}

575 %
de°ru˘‹
 
usög_›t
 {
sqlôe3IdLi°Dñëe
(
pP¨£
->
db
, 
$$
);}

576 
	$usög_›t
(
U
Ë::
USING
 
LP
 
	$öscﬁli°
(
L
Ë
RP
. {
U
 = L;
	}
}

577 
	$usög_›t
(
U
Ë::. {U = 0;
	}
}

580 %
ty≥
 
‹dîby_›t
 {
Ex¥Li°
*}

581 %
de°ru˘‹
 
‹dîby_›t
 {
sqlôe3Ex¥Li°Dñëe
(
pP¨£
->
db
, 
$$
);}

582 %
ty≥
 
s‹éi°
 {
Ex¥Li°
*}

583 %
de°ru˘‹
 
s‹éi°
 {
sqlôe3Ex¥Li°Dñëe
(
pP¨£
->
db
, 
$$
);}

585 
	$‹dîby_›t
(
A
Ë::. {A = 0;
	}
}

586 
	$‹dîby_›t
(
A
Ë::
ORDER
 
BY
 
	`s‹éi°
(
X
). {A = X;
	}
}

587 
	$s‹éi°
(
A
Ë::
	$s‹éi°
(
X
Ë
COMMA
 
	$ex¥
(
Y
Ë
	`s‹t‹dî
(
Z
). {

588 
A
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,
X
,
Y
.
pEx¥
);

589 if–
A
 ) A->
a
[A->
nEx¥
-1].
s‹tOrdî
 = (
u8
)
Z
;

590 
	}
}

591 
	$s‹éi°
(
A
Ë::
	$ex¥
(
Y
Ë
	`s‹t‹dî
(
Z
). {

592 
A
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,0,
Y
.
pEx¥
);

593 if–
A
 && 
	`ALWAYS
(A->
a
ËËA->a[0].
s‹tOrdî
 = (
u8
)
Z
;

594 
	}
}

596 %
ty≥
 
s‹t‹dî
 {}

598 
	$s‹t‹dî
(
A
Ë::
ASC
. {A = 
SQLITE_SO_ASC
;
	}
}

599 
	$s‹t‹dî
(
A
Ë::
DESC
. {A = 
SQLITE_SO_DESC
;
	}
}

600 
	$s‹t‹dî
(
A
Ë::. {A = 
SQLITE_SO_ASC
;
	}
}

602 %
ty≥
 
groupby_›t
 {
Ex¥Li°
*}

603 %
de°ru˘‹
 
groupby_›t
 {
sqlôe3Ex¥Li°Dñëe
(
pP¨£
->
db
, 
$$
);}

604 
	$groupby_›t
(
A
Ë::. {A = 0;
	}
}

605 
	$groupby_›t
(
A
Ë::
GROUP
 
BY
 
	`√x¥li°
(
X
). {A = X;
	}
}

607 %
ty≥
 
havög_›t
 {
Ex¥
*}

608 %
de°ru˘‹
 
havög_›t
 {
sqlôe3Ex¥Dñëe
(
pP¨£
->
db
, 
$$
);}

609 
	$havög_›t
(
A
Ë::. {A = 0;
	}
}

610 
	$havög_›t
(
A
Ë::
HAVING
 
	`ex¥
(
X
). {A = X.
pEx¥
;
	}
}

612 %
ty≥
 
limô_›t
 {
LimôVÆ
}

625 
	$limô_›t
(
A
Ë::. {A.
pLimô
 = 0; A.
pOff£t
 = 0;
	}
}

626 
	$limô_›t
(
A
Ë::
LIMIT
 
	`ex¥
(
X
). {A.
pLimô
 = X.
pEx¥
; A.
pOff£t
 = 0;
	}
}

627 
	$limô_›t
(
A
Ë::
LIMIT
 
	$ex¥
(
X
Ë
OFFSET
 
	`ex¥
(
Y
).

628 {
A
.
pLimô
 = 
X
.
pEx¥
; A.
pOff£t
 = 
Y
.pEx¥;
	}
}

629 
	$limô_›t
(
A
Ë::
LIMIT
 
	$ex¥
(
X
Ë
COMMA
 
	`ex¥
(
Y
).

630 {
A
.
pOff£t
 = 
X
.
pEx¥
; A.
pLimô
 = 
Y
.pEx¥;
	}
}

634 %
ifdef
 
SQLITE_ENABLE_UPDATE_DELETE_LIMIT


635 
cmd
 ::
DELETE
 
FROM
 
	$fuŒ«me
(
X
Ë
	$ödexed_›t
(
I
Ë
	$whîe_›t
(
W
)

636 
	$‹dîby_›t
(
O
Ë
	`limô_›t
(
L
). {

637 
	`sqlôe3SrcLi°IndexedBy
(
pP¨£
, 
X
, &
I
);

638 
W
 = 
	`sqlôe3LimôWhîe
(
pP¨£
, 
X
, W, 
O
, 
L
.
pLimô
, L.
pOff£t
, "DELETE");

639 
	`sqlôe3DñëeFrom
(
pP¨£
,
X
,
W
);

640 
	}
}

641 %
ídif


642 %
i‚def
 
SQLITE_ENABLE_UPDATE_DELETE_LIMIT


643 
cmd
 ::
DELETE
 
FROM
 
	$fuŒ«me
(
X
Ë
	$ödexed_›t
(
I
Ë
	`whîe_›t
(
W
). {

644 
	`sqlôe3SrcLi°IndexedBy
(
pP¨£
, 
X
, &
I
);

645 
	`sqlôe3DñëeFrom
(
pP¨£
,
X
,
W
);

646 
	}
}

647 %
ídif


649 %
ty≥
 
whîe_›t
 {
Ex¥
*}

650 %
de°ru˘‹
 
whîe_›t
 {
sqlôe3Ex¥Dñëe
(
pP¨£
->
db
, 
$$
);}

652 
	$whîe_›t
(
A
Ë::. {A = 0;
	}
}

653 
	$whîe_›t
(
A
Ë::
WHERE
 
	`ex¥
(
X
). {A = X.
pEx¥
;
	}
}

657 %
ifdef
 
SQLITE_ENABLE_UPDATE_DELETE_LIMIT


658 
cmd
 ::
UPDATE
 
	$‹c⁄f
(
R
Ë
	$fuŒ«me
(
X
Ë
	$ödexed_›t
(
I
Ë
SET
 
	$£éi°
(
Y
Ë
	$whîe_›t
(
W
)

659 
	$‹dîby_›t
(
O
Ë
	`limô_›t
(
L
). {

660 
	`sqlôe3SrcLi°IndexedBy
(
pP¨£
, 
X
, &
I
);

661 
	`sqlôe3Ex¥Li°CheckLígth
(
pP¨£
,
Y
,"setÜist");

662 
W
 = 
	`sqlôe3LimôWhîe
(
pP¨£
, 
X
, W, 
O
, 
L
.
pLimô
, L.
pOff£t
, "UPDATE");

663 
	`sqlôe3Upd©e
(
pP¨£
,
X
,
Y
,
W
,
R
);

664 
	}
}

665 %
ídif


666 %
i‚def
 
SQLITE_ENABLE_UPDATE_DELETE_LIMIT


667 
cmd
 ::
UPDATE
 
	$‹c⁄f
(
R
Ë
	$fuŒ«me
(
X
Ë
	$ödexed_›t
(
I
Ë
SET
 
	$£éi°
(
Y
)

668 
	`whîe_›t
(
W
). {

669 
	`sqlôe3SrcLi°IndexedBy
(
pP¨£
, 
X
, &
I
);

670 
	`sqlôe3Ex¥Li°CheckLígth
(
pP¨£
,
Y
,"setÜist");

671 
	`sqlôe3Upd©e
(
pP¨£
,
X
,
Y
,
W
,
R
);

672 
	}
}

673 %
ídif


675 %
ty≥
 
£éi°
 {
Ex¥Li°
*}

676 %
de°ru˘‹
 
£éi°
 {
sqlôe3Ex¥Li°Dñëe
(
pP¨£
->
db
, 
$$
);}

678 
	$£éi°
(
A
Ë::
	$£éi°
(
Z
Ë
COMMA
 
	$nm
(
X
Ë
EQ
 
	`ex¥
(
Y
). {

679 
A
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
, 
Z
, 
Y
.
pEx¥
);

680 
	`sqlôe3Ex¥Li°SëName
(
pP¨£
, 
A
, &
X
, 1);

681 
	}
}

682 
	$£éi°
(
A
Ë::
	$nm
(
X
Ë
EQ
 
	`ex¥
(
Y
). {

683 
A
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
, 0, 
Y
.
pEx¥
);

684 
	`sqlôe3Ex¥Li°SëName
(
pP¨£
, 
A
, &
X
, 1);

685 
	}
}

689 
cmd
 ::
	$ö£π_cmd
(
R
Ë
INTO
 
	$fuŒ«me
(
X
Ë
	$öscﬁli°_›t
(
F
Ë
	`vÆuñi°
(
Y
).

690 {
	`sqlôe3In£π
(
pP¨£
, 
X
, 
Y
.
pLi°
, Y.
pSñe˘
, 
F
, 
R
);
	}
}

691 
cmd
 ::
	$ö£π_cmd
(
R
Ë
INTO
 
	$fuŒ«me
(
X
Ë
	$öscﬁli°_›t
(
F
Ë
	`£À˘
(
S
).

692 {
	`sqlôe3In£π
(
pP¨£
, 
X
, 0, 
S
, 
F
, 
R
);
	}
}

693 
cmd
 ::
	$ö£π_cmd
(
R
Ë
INTO
 
	$fuŒ«me
(
X
Ë
	$öscﬁli°_›t
(
F
Ë
DEFAULT
 
VALUES
.

694 {
	`sqlôe3In£π
(
pP¨£
, 
X
, 0, 0, 
F
, 
R
);
	}
}

696 %
ty≥
 
ö£π_cmd
 {
u8
}

697 
	$ö£π_cmd
(
A
Ë::
INSERT
 
	`‹c⁄f
(
R
). {A = R;
	}
}

698 
	$ö£π_cmd
(
A
Ë::
REPLACE
. {A = 
OE_Rïœ˚
;
	}
}

707 %
ty≥
 
vÆuñi°
 {
VÆueLi°
}

708 %
de°ru˘‹
 
vÆuñi°
 {

709 
sqlôe3Ex¥Li°Dñëe
(
pP¨£
->
db
, 
$$
.
pLi°
);

710 
sqlôe3Sñe˘Dñëe
(
pP¨£
->
db
, 
$$
.
pSñe˘
);

712 
	$vÆuñi°
(
A
Ë::
VALUES
 
LP
 
	$√x¥li°
(
X
Ë
RP
. {

713 
A
.
pLi°
 = 
X
;

714 
A
.
pSñe˘
 = 0;

715 
	}
}

719 %
i‚def
 
SQLITE_OMIT_COMPOUND_SELECT


720 
	$vÆuñi°
(
A
Ë::
	$vÆuñi°
(
X
Ë
COMMA
 
LP
 
	$ex¥li°
(
Y
Ë
RP
. {

721 
Sñe˘
 *
pRight
 = 
	`sqlôe3Sñe˘New
(
pP¨£
, 
Y
, 0, 0, 0, 0, 0, 0, 0, 0);

722 if–
X
.
pLi°
 ){

723 
X
.
pSñe˘
 = 
	`sqlôe3Sñe˘New
(
pP¨£
, X.
pLi°
, 0, 0, 0, 0, 0, 0, 0, 0);

724 
X
.
pLi°
 = 0;

726 
A
.
pLi°
 = 0;

727 if–
X
.
pSñe˘
==0 || 
pRight
==0 ){

728 
	`sqlôe3Sñe˘Dñëe
(
pP¨£
->
db
, 
pRight
);

729 
	`sqlôe3Sñe˘Dñëe
(
pP¨£
->
db
, 
X
.
pSñe˘
);

730 
A
.
pSñe˘
 = 0;

732 
pRight
->
›
 = 
TK_ALL
;

733 
pRight
->
pPri‹
 = 
X
.
pSñe˘
;

734 
pRight
->
£lFœgs
 |
SF_VÆues
;

735 
pRight
->
pPri‹
->
£lFœgs
 |
SF_VÆues
;

736 
A
.
pSñe˘
 = 
pRight
;

738 
	}
}

739 %
ídif
 
SQLITE_OMIT_COMPOUND_SELECT


741 %
ty≥
 
öscﬁli°_›t
 {
IdLi°
*}

742 %
de°ru˘‹
 
öscﬁli°_›t
 {
sqlôe3IdLi°Dñëe
(
pP¨£
->
db
, 
$$
);}

743 %
ty≥
 
öscﬁli°
 {
IdLi°
*}

744 %
de°ru˘‹
 
öscﬁli°
 {
sqlôe3IdLi°Dñëe
(
pP¨£
->
db
, 
$$
);}

746 
	$öscﬁli°_›t
(
A
Ë::. {A = 0;
	}
}

747 
	$öscﬁli°_›t
(
A
Ë::
LP
 
	$öscﬁli°
(
X
Ë
RP
. {
A
 = X;
	}
}

748 
	$öscﬁli°
(
A
Ë::
	$öscﬁli°
(
X
Ë
COMMA
 
	`nm
(
Y
).

749 {
A
 = 
	`sqlôe3IdLi°Aµíd
(
pP¨£
->
db
,
X
,&
Y
);
	}
}

750 
	$öscﬁli°
(
A
Ë::
	`nm
(
Y
).

751 {
A
 = 
	`sqlôe3IdLi°Aµíd
(
pP¨£
->
db
,0,&
Y
);
	}
}

756 %
ty≥
 
ex¥
 {
Ex¥S∑n
}

757 %
de°ru˘‹
 
ex¥
 {
sqlôe3Ex¥Dñëe
(
pP¨£
->
db
, 
$$
.
pEx¥
);}

758 %
ty≥
 
ãrm
 {
Ex¥S∑n
}

759 %
de°ru˘‹
 
ãrm
 {
sqlôe3Ex¥Dñëe
(
pP¨£
->
db
, 
$$
.
pEx¥
);}

761 %
ö˛ude
 {

766 
•™Së
(
Ex¥S∑n
 *
pOut
, 
Tokí
 *
pSèπ
, Tokí *
pEnd
){

767 
pOut
->
zSèπ
 = 
pSèπ
->
z
;

768 
pOut
->
zEnd
 = &
pEnd
->
z
[pEnd->
n
];

775 
•™Ex¥
(
Ex¥S∑n
 *
pOut
, 
P¨£
 *
pP¨£
, 
›
, 
Tokí
 *
pVÆue
){

776 
pOut
->
pEx¥
 = 
sqlôe3PEx¥
(
pP¨£
, 
›
, 0, 0, 
pVÆue
);

777 
pOut
->
zSèπ
 = 
pVÆue
->
z
;

778 
pOut
->
zEnd
 = &
pVÆue
->
z
[pVÆue->
n
];

782 
	$ex¥
(
A
Ë::
	`ãrm
(
X
). {A = X;
	}
}

783 
	$ex¥
(
A
Ë::
	$LP
(
B
Ë
	$ex¥
(
X
Ë
	`RP
(
E
). {
A
.
pEx¥
 = X.pEx¥; 
	`•™Së
(&A,&
B
,&E);
	}
}

784 
	$ãrm
(
A
Ë::
	`NULL
(
X
). {
	`•™Ex¥
(&A, 
pP¨£
, @X, &X);
	}
}

785 
	$ex¥
(
A
Ë::
	`id
(
X
). {
	`•™Ex¥
(&A, 
pP¨£
, 
TK_ID
, &X);
	}
}

786 
	$ex¥
(
A
Ë::
	`JOIN_KW
(
X
). {
	`•™Ex¥
(&A, 
pP¨£
, 
TK_ID
, &X);
	}
}

787 
	$ex¥
(
A
Ë::
	$nm
(
X
Ë
DOT
 
	`nm
(
Y
). {

788 
Ex¥
 *
ãmp1
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_ID
, 0, 0, &
X
);

789 
Ex¥
 *
ãmp2
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_ID
, 0, 0, &
Y
);

790 
A
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_DOT
, 
ãmp1
, 
ãmp2
, 0);

791 
	`•™Së
(&
A
,&
X
,&
Y
);

792 
	}
}

793 
	$ex¥
(
A
Ë::
	$nm
(
X
Ë
DOT
 
	$nm
(
Y
Ë
DOT
 
	`nm
(
Z
). {

794 
Ex¥
 *
ãmp1
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_ID
, 0, 0, &
X
);

795 
Ex¥
 *
ãmp2
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_ID
, 0, 0, &
Y
);

796 
Ex¥
 *
ãmp3
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_ID
, 0, 0, &
Z
);

797 
Ex¥
 *
ãmp4
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_DOT
, 
ãmp2
, 
ãmp3
, 0);

798 
A
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_DOT
, 
ãmp1
, 
ãmp4
, 0);

799 
	`•™Së
(&
A
,&
X
,&
Z
);

800 
	}
}

801 
	$ãrm
(
A
Ë::
INTEGER
|
FLOAT
|
	`BLOB
(
X
). {
	`•™Ex¥
(&A, 
pP¨£
, @X, &X);
	}
}

802 
	$ãrm
(
A
Ë::
	`STRING
(
X
). {
	`•™Ex¥
(&A, 
pP¨£
, @X, &X);
	}
}

803 
	$ex¥
(
A
Ë::
	`REGISTER
(
X
). {

807 if–
pP¨£
->
√°ed
==0 ){

808 
	`sqlôe3Eº‹Msg
(
pP¨£
, "√¨ \"%T\": sy¡axÉº‹", &
X
);

809 
A
.
pEx¥
 = 0;

811 
A
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_REGISTER
, 0, 0, &
X
);

812 if–
A
.
pEx¥
 ) 
	`sqlôe3GëI¡32
(&
X
.
z
[1], &A.pEx¥->
iTabÀ
);

814 
	`•™Së
(&
A
, &
X
, &X);

815 
	}
}

816 
	$ex¥
(
A
Ë::
	`VARIABLE
(
X
). {

817 
	`•™Ex¥
(&
A
, 
pP¨£
, 
TK_VARIABLE
, &
X
);

818 
	`sqlôe3Ex¥AssignV¨Numbî
(
pP¨£
, 
A
.
pEx¥
);

819 
	`•™Së
(&
A
, &
X
, &X);

820 
	}
}

821 
	$ex¥
(
A
Ë::
	$ex¥
(
E
Ë
COLLATE
 
	`ids
(
C
). {

822 
A
.
pEx¥
 = 
	`sqlôe3Ex¥AddCﬁœãTokí
(
pP¨£
, 
E
.pEx¥, &
C
);

823 
A
.
zSèπ
 = 
E
.zStart;

824 
A
.
zEnd
 = &
C
.
z
[C.
n
];

825 
	}
}

826 %
i‚def
 
SQLITE_OMIT_CAST


827 
	$ex¥
(
A
Ë::
	$CAST
(
X
Ë
LP
 
	$ex¥
(
E
Ë
AS
 
	$ty≥tokí
(
T
Ë
	`RP
(
Y
). {

828 
A
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_CAST
, 
E
.pEx¥, 0, &
T
);

829 
	`•™Së
(&
A
,&
X
,&
Y
);

830 
	}
}

831 %
ídif
 
SQLITE_OMIT_CAST


832 
	$ex¥
(
A
Ë::
	$ID
(
X
Ë
LP
 
	$di°ö˘
(
D
Ë
	$ex¥li°
(
Y
Ë
	`RP
(
E
). {

833 if–
Y
 && Y->
nEx¥
>
pP¨£
->
db
->
aLimô
[
SQLITE_LIMIT_FUNCTION_ARG
] ){

834 
	`sqlôe3Eº‹Msg
(
pP¨£
, "toÿm™yárgumít†⁄ fun˘i⁄ %T", &
X
);

836 
A
.
pEx¥
 = 
	`sqlôe3Ex¥Fun˘i⁄
(
pP¨£
, 
Y
, &
X
);

837 
	`•™Së
(&
A
,&
X
,&
E
);

838 if–
D
 && 
A
.
pEx¥
 ){

839 
A
.
pEx¥
->
Êags
 |
EP_Di°ö˘
;

841 
	}
}

842 
	$ex¥
(
A
Ë::
	$ID
(
X
Ë
LP
 
STAR
 
	`RP
(
E
). {

843 
A
.
pEx¥
 = 
	`sqlôe3Ex¥Fun˘i⁄
(
pP¨£
, 0, &
X
);

844 
	`•™Së
(&
A
,&
X
,&
E
);

845 
	}
}

846 
	$ãrm
(
A
Ë::
	`CTIME_KW
(
OP
). {

849 
A
.
pEx¥
 = 
	`sqlôe3Ex¥Fun˘i⁄
(
pP¨£
, 0,&
OP
);

850 if–
A
.
pEx¥
 ){

851 
A
.
pEx¥
->
›
 = 
TK_CONST_FUNC
;

853 
	`•™Së
(&
A
, &
OP
, &OP);

854 
	}
}

856 %
ö˛ude
 {

860 
•™Bö¨yEx¥
(

861 
Ex¥S∑n
 *
pOut
,

862 
P¨£
 *
pP¨£
,

863 
›
,

864 
Ex¥S∑n
 *
pLe·
,

865 
Ex¥S∑n
 *
pRight


867 
pOut
->
pEx¥
 = 
sqlôe3PEx¥
(
pP¨£
, 
›
, 
pLe·
->pEx¥, 
pRight
->pExpr, 0);

868 
pOut
->
zSèπ
 = 
pLe·
->zStart;

869 
pOut
->
zEnd
 = 
pRight
->zEnd;

873 
	$ex¥
(
A
Ë::
	$ex¥
(
X
Ë
	$AND
(
OP
Ë
	`ex¥
(
Y
). {
	`•™Bö¨yEx¥
(&
A
,
pP¨£
,@OP,&
X
,&Y);
	}
}

874 
	$ex¥
(
A
Ë::
	$ex¥
(
X
Ë
	$OR
(
OP
Ë
	`ex¥
(
Y
). {
	`•™Bö¨yEx¥
(&
A
,
pP¨£
,@OP,&
X
,&Y);
	}
}

875 
	$ex¥
(
A
Ë::
	$ex¥
(
X
Ë
LT
|
GT
|
GE
|
	$LE
(
OP
Ë
	`ex¥
(
Y
).

876 {
	`•™Bö¨yEx¥
(&
A
,
pP¨£
,@
OP
,&
X
,&
Y
);
	}
}

877 
	$ex¥
(
A
Ë::
	$ex¥
(
X
Ë
EQ
|
	$NE
(
OP
Ë
	`ex¥
(
Y
). {
	`•™Bö¨yEx¥
(&
A
,
pP¨£
,@OP,&
X
,&Y);
	}
}

878 
	$ex¥
(
A
Ë::
	$ex¥
(
X
Ë
BITAND
|
BITOR
|
LSHIFT
|
	$RSHIFT
(
OP
Ë
	`ex¥
(
Y
).

879 {
	`•™Bö¨yEx¥
(&
A
,
pP¨£
,@
OP
,&
X
,&
Y
);
	}
}

880 
	$ex¥
(
A
Ë::
	$ex¥
(
X
Ë
PLUS
|
	$MINUS
(
OP
Ë
	`ex¥
(
Y
).

881 {
	`•™Bö¨yEx¥
(&
A
,
pP¨£
,@
OP
,&
X
,&
Y
);
	}
}

882 
	$ex¥
(
A
Ë::
	$ex¥
(
X
Ë
STAR
|
SLASH
|
	$REM
(
OP
Ë
	`ex¥
(
Y
).

883 {
	`•™Bö¨yEx¥
(&
A
,
pP¨£
,@
OP
,&
X
,&
Y
);
	}
}

884 
	$ex¥
(
A
Ë::
	$ex¥
(
X
Ë
	$CONCAT
(
OP
Ë
	`ex¥
(
Y
). {
	`•™Bö¨yEx¥
(&
A
,
pP¨£
,@OP,&
X
,&Y);
	}
}

885 %
ty≥
 
like›
 {
LikeOp
}

886 
	$like›
(
A
Ë::
	`LIKE_KW
(
X
). {A.
eO≥øt‹
 = X; A.
bNŸ
 = 0;
	}
}

887 
	$like›
(
A
Ë::
NOT
 
	`LIKE_KW
(
X
). {A.
eO≥øt‹
 = X; A.
bNŸ
 = 1;
	}
}

888 
	$like›
(
A
Ë::
	`MATCH
(
X
). {A.
eO≥øt‹
 = X; A.
bNŸ
 = 0;
	}
}

889 
	$like›
(
A
Ë::
NOT
 
	`MATCH
(
X
). {A.
eO≥øt‹
 = X; A.
bNŸ
 = 1;
	}
}

890 
	$ex¥
(
A
Ë::
	$ex¥
(
X
Ë
	$like›
(
OP
Ë
	`ex¥
(
Y
). [
LIKE_KW
] {

891 
Ex¥Li°
 *
pLi°
;

892 
pLi°
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,0, 
Y
.
pEx¥
);

893 
pLi°
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,pLi°, 
X
.
pEx¥
);

894 
A
.
pEx¥
 = 
	`sqlôe3Ex¥Fun˘i⁄
(
pP¨£
, 
pLi°
, &
OP
.
eO≥øt‹
);

895 if–
OP
.
bNŸ
 ) 
A
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_NOT
, A.pExpr, 0, 0);

896 
A
.
zSèπ
 = 
X
.zStart;

897 
A
.
zEnd
 = 
Y
.zEnd;

898 if–
A
.
pEx¥
 ) A.pEx¥->
Êags
 |
EP_InfixFunc
;

899 
	}
}

900 
	$ex¥
(
A
Ë::
	$ex¥
(
X
Ë
	$like›
(
OP
Ë
	$ex¥
(
Y
Ë
ESCAPE
 
	`ex¥
(
E
). [
LIKE_KW
] {

901 
Ex¥Li°
 *
pLi°
;

902 
pLi°
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,0, 
Y
.
pEx¥
);

903 
pLi°
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,pLi°, 
X
.
pEx¥
);

904 
pLi°
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,pLi°, 
E
.
pEx¥
);

905 
A
.
pEx¥
 = 
	`sqlôe3Ex¥Fun˘i⁄
(
pP¨£
, 
pLi°
, &
OP
.
eO≥øt‹
);

906 if–
OP
.
bNŸ
 ) 
A
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_NOT
, A.pExpr, 0, 0);

907 
A
.
zSèπ
 = 
X
.zStart;

908 
A
.
zEnd
 = 
E
.zEnd;

909 if–
A
.
pEx¥
 ) A.pEx¥->
Êags
 |
EP_InfixFunc
;

910 
	}
}

912 %
ö˛ude
 {

915 
•™U«ryPo°fix
(

916 
Ex¥S∑n
 *
pOut
,

917 
P¨£
 *
pP¨£
,

918 
›
,

919 
Ex¥S∑n
 *
pO≥ønd
,

920 
Tokí
 *
pPo°Op


922 
pOut
->
pEx¥
 = 
sqlôe3PEx¥
(
pP¨£
, 
›
, 
pO≥ønd
->pExpr, 0, 0);

923 
pOut
->
zSèπ
 = 
pO≥ønd
->zStart;

924 
pOut
->
zEnd
 = &
pPo°Op
->
z
[pPo°Op->
n
];

928 
	$ex¥
(
A
Ë::
	$ex¥
(
X
Ë
ISNULL
|
	`NOTNULL
(
E
). {
	`•™U«ryPo°fix
(&
A
,
pP¨£
,@E,&X,&E);
	}
}

929 
	$ex¥
(
A
Ë::
	$ex¥
(
X
Ë
NOT
 
	`NULL
(
E
). {
	`•™U«ryPo°fix
(&
A
,
pP¨£
,
TK_NOTNULL
,&X,&E);
	}
}

931 %
ö˛ude
 {

934 
bö¨yToU«ryIfNuŒ
(
P¨£
 *
pP¨£
, 
Ex¥
 *
pY
, Ex¥ *
pA
, 
›
){

935 
sqlôe3
 *
db
 = 
pP¨£
->db;

936 if–
db
->
mÆlocFaûed
==0 && 
pY
->
›
==
TK_NULL
 ){

937 
pA
->
›
 = (
u8
)op;

938 
sqlôe3Ex¥Dñëe
(
db
, 
pA
->
pRight
);

939 
pA
->
pRight
 = 0;

950 
	$ex¥
(
A
Ë::
	$ex¥
(
X
Ë
IS
 
	`ex¥
(
Y
). {

951 
	`•™Bö¨yEx¥
(&
A
,
pP¨£
,
TK_IS
,&
X
,&
Y
);

952 
	`bö¨yToU«ryIfNuŒ
(
pP¨£
, 
Y
.
pEx¥
, 
A
.pEx¥, 
TK_ISNULL
);

953 
	}
}

954 
	$ex¥
(
A
Ë::
	$ex¥
(
X
Ë
IS
 
NOT
 
	`ex¥
(
Y
). {

955 
	`•™Bö¨yEx¥
(&
A
,
pP¨£
,
TK_ISNOT
,&
X
,&
Y
);

956 
	`bö¨yToU«ryIfNuŒ
(
pP¨£
, 
Y
.
pEx¥
, 
A
.pEx¥, 
TK_NOTNULL
);

957 
	}
}

959 %
ö˛ude
 {

962 
•™U«ryPªfix
(

963 
Ex¥S∑n
 *
pOut
,

964 
P¨£
 *
pP¨£
,

965 
›
,

966 
Ex¥S∑n
 *
pO≥ønd
,

967 
Tokí
 *
pPªOp


969 
pOut
->
pEx¥
 = 
sqlôe3PEx¥
(
pP¨£
, 
›
, 
pO≥ønd
->pExpr, 0, 0);

970 
pOut
->
zSèπ
 = 
pPªOp
->
z
;

971 
pOut
->
zEnd
 = 
pO≥ønd
->zEnd;

977 
	$ex¥
(
A
Ë::
	$NOT
(
B
Ë
	`ex¥
(
X
). {
	`•™U«ryPªfix
(&
A
,
pP¨£
,@B,&X,&B);
	}
}

978 
	$ex¥
(
A
Ë::
	$BITNOT
(
B
Ë
	`ex¥
(
X
). {
	`•™U«ryPªfix
(&
A
,
pP¨£
,@B,&X,&B);
	}
}

979 
	$ex¥
(
A
Ë::
	$MINUS
(
B
Ë
	`ex¥
(
X
). [
BITNOT
]

980 {
	`•™U«ryPªfix
(&
A
,
pP¨£
,
TK_UMINUS
,&
X
,&
B
);
	}
}

981 
	$ex¥
(
A
Ë::
	$PLUS
(
B
Ë
	`ex¥
(
X
). [
BITNOT
]

982 {
	`•™U«ryPªfix
(&
A
,
pP¨£
,
TK_UPLUS
,&
X
,&
B
);
	}
}

984 %
ty≥
 
bëwìn_›
 {}

985 
	$bëwìn_›
(
A
Ë::
BETWEEN
. {A = 0;
	}
}

986 
	$bëwìn_›
(
A
Ë::
NOT
 
BETWEEN
. {A = 1;
	}
}

987 
	$ex¥
(
A
Ë::
	$ex¥
(
W
Ë
	$bëwìn_›
(
N
Ë
	$ex¥
(
X
Ë
AND
 
	`ex¥
(
Y
). [
BETWEEN
] {

988 
Ex¥Li°
 *
pLi°
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,0, 
X
.
pEx¥
);

989 
pLi°
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,pLi°, 
Y
.
pEx¥
);

990 
A
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_BETWEEN
, 
W
.pExpr, 0, 0);

991 if–
A
.
pEx¥
 ){

992 
A
.
pEx¥
->
x
.
pLi°
 =ÖList;

994 
	`sqlôe3Ex¥Li°Dñëe
(
pP¨£
->
db
, 
pLi°
);

996 if–
N
 ) 
A
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_NOT
, A.pExpr, 0, 0);

997 
A
.
zSèπ
 = 
W
.zStart;

998 
A
.
zEnd
 = 
Y
.zEnd;

999 
	}
}

1000 %
i‚def
 
SQLITE_OMIT_SUBQUERY


1001 %
ty≥
 
ö_›
 {}

1002 
	$ö_›
(
A
Ë::
IN
. {A = 0;
	}
}

1003 
	$ö_›
(
A
Ë::
NOT
 
IN
. {A = 1;
	}
}

1004 
	$ex¥
(
A
Ë::
	$ex¥
(
X
Ë
	$ö_›
(
N
Ë
LP
 
	$ex¥li°
(
Y
Ë
	`RP
(
E
). [
IN
] {

1005 if–
Y
==0 ){

1014 
A
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_INTEGER
, 0, 0, &
sqlôe3I¡Tokís
[
N
]);

1015 
	`sqlôe3Ex¥Dñëe
(
pP¨£
->
db
, 
X
.
pEx¥
);

1017 
A
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_IN
, 
X
.pExpr, 0, 0);

1018 if–
A
.
pEx¥
 ){

1019 
A
.
pEx¥
->
x
.
pLi°
 = 
Y
;

1020 
	`sqlôe3Ex¥SëHeight
(
pP¨£
, 
A
.
pEx¥
);

1022 
	`sqlôe3Ex¥Li°Dñëe
(
pP¨£
->
db
, 
Y
);

1024 if–
N
 ) 
A
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_NOT
, A.pExpr, 0, 0);

1026 
A
.
zSèπ
 = 
X
.zStart;

1027 
A
.
zEnd
 = &
E
.
z
[E.
n
];

1028 
	}
}

1029 
	$ex¥
(
A
Ë::
	$LP
(
B
Ë
	$£À˘
(
X
Ë
	`RP
(
E
). {

1030 
A
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_SELECT
, 0, 0, 0);

1031 if–
A
.
pEx¥
 ){

1032 
A
.
pEx¥
->
x
.
pSñe˘
 = 
X
;

1033 
	`Ex¥SëPr›îty
(
A
.
pEx¥
, 
EP_xIsSñe˘
);

1034 
	`sqlôe3Ex¥SëHeight
(
pP¨£
, 
A
.
pEx¥
);

1036 
	`sqlôe3Sñe˘Dñëe
(
pP¨£
->
db
, 
X
);

1038 
A
.
zSèπ
 = 
B
.
z
;

1039 
A
.
zEnd
 = &
E
.
z
[E.
n
];

1040 
	}
}

1041 
	$ex¥
(
A
Ë::
	$ex¥
(
X
Ë
	$ö_›
(
N
Ë
LP
 
	$£À˘
(
Y
Ë
	`RP
(
E
). [
IN
] {

1042 
A
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_IN
, 
X
.pExpr, 0, 0);

1043 if–
A
.
pEx¥
 ){

1044 
A
.
pEx¥
->
x
.
pSñe˘
 = 
Y
;

1045 
	`Ex¥SëPr›îty
(
A
.
pEx¥
, 
EP_xIsSñe˘
);

1046 
	`sqlôe3Ex¥SëHeight
(
pP¨£
, 
A
.
pEx¥
);

1048 
	`sqlôe3Sñe˘Dñëe
(
pP¨£
->
db
, 
Y
);

1050 if–
N
 ) 
A
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_NOT
, A.pExpr, 0, 0);

1051 
A
.
zSèπ
 = 
X
.zStart;

1052 
A
.
zEnd
 = &
E
.
z
[E.
n
];

1053 
	}
}

1054 
	$ex¥
(
A
Ë::
	$ex¥
(
X
Ë
	$ö_›
(
N
Ë
	$nm
(
Y
Ë
	`dbnm
(
Z
). [
IN
] {

1055 
SrcLi°
 *
pSrc
 = 
	`sqlôe3SrcLi°Aµíd
(
pP¨£
->
db
, 0,&
Y
,&
Z
);

1056 
A
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_IN
, 
X
.pExpr, 0, 0);

1057 if–
A
.
pEx¥
 ){

1058 
A
.
pEx¥
->
x
.
pSñe˘
 = 
	`sqlôe3Sñe˘New
(
pP¨£
, 0,
pSrc
,0,0,0,0,0,0,0);

1059 
	`Ex¥SëPr›îty
(
A
.
pEx¥
, 
EP_xIsSñe˘
);

1060 
	`sqlôe3Ex¥SëHeight
(
pP¨£
, 
A
.
pEx¥
);

1062 
	`sqlôe3SrcLi°Dñëe
(
pP¨£
->
db
, 
pSrc
);

1064 if–
N
 ) 
A
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_NOT
, A.pExpr, 0, 0);

1065 
A
.
zSèπ
 = 
X
.zStart;

1066 
A
.
zEnd
 = 
Z
.
z
 ? &Z.z[Z.
n
] : &
Y
.z[Y.n];

1067 
	}
}

1068 
	$ex¥
(
A
Ë::
	$EXISTS
(
B
Ë
LP
 
	$£À˘
(
Y
Ë
	`RP
(
E
). {

1069 
Ex¥
 *
p
 = 
A
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_EXISTS
, 0, 0, 0);

1070 if–
p
 ){

1071 
p
->
x
.
pSñe˘
 = 
Y
;

1072 
	`Ex¥SëPr›îty
(
p
, 
EP_xIsSñe˘
);

1073 
	`sqlôe3Ex¥SëHeight
(
pP¨£
, 
p
);

1075 
	`sqlôe3Sñe˘Dñëe
(
pP¨£
->
db
, 
Y
);

1077 
A
.
zSèπ
 = 
B
.
z
;

1078 
A
.
zEnd
 = &
E
.
z
[E.
n
];

1079 
	}
}

1080 %
ídif
 
SQLITE_OMIT_SUBQUERY


1083 
	$ex¥
(
A
Ë::
	$CASE
(
C
Ë
	$ˇ£_›î™d
(
X
Ë
	$ˇ£_ex¥li°
(
Y
Ë
	$ˇ£_ñ£
(
Z
Ë
	`END
(
E
). {

1084 
A
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_CASE
, 
X
, 0, 0);

1085 if–
A
.
pEx¥
 ){

1086 
A
.
pEx¥
->
x
.
pLi°
 = 
Z
 ? 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,
Y
,Z) : Y;

1087 
	`sqlôe3Ex¥SëHeight
(
pP¨£
, 
A
.
pEx¥
);

1089 
	`sqlôe3Ex¥Li°Dñëe
(
pP¨£
->
db
, 
Y
);

1090 
	`sqlôe3Ex¥Dñëe
(
pP¨£
->
db
, 
Z
);

1092 
A
.
zSèπ
 = 
C
.
z
;

1093 
A
.
zEnd
 = &
E
.
z
[E.
n
];

1094 
	}
}

1095 %
ty≥
 
ˇ£_ex¥li°
 {
Ex¥Li°
*}

1096 %
de°ru˘‹
 
ˇ£_ex¥li°
 {
sqlôe3Ex¥Li°Dñëe
(
pP¨£
->
db
, 
$$
);}

1097 
	$ˇ£_ex¥li°
(
A
Ë::
	$ˇ£_ex¥li°
(
X
Ë
WHEN
 
	$ex¥
(
Y
Ë
THEN
 
	`ex¥
(
Z
). {

1098 
A
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,
X
, 
Y
.
pEx¥
);

1099 
A
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,A, 
Z
.
pEx¥
);

1100 
	}
}

1101 
	$ˇ£_ex¥li°
(
A
Ë::
WHEN
 
	$ex¥
(
Y
Ë
THEN
 
	`ex¥
(
Z
). {

1102 
A
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,0, 
Y
.
pEx¥
);

1103 
A
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,A, 
Z
.
pEx¥
);

1104 
	}
}

1105 %
ty≥
 
ˇ£_ñ£
 {
Ex¥
*}

1106 %
de°ru˘‹
 
ˇ£_ñ£
 {
sqlôe3Ex¥Dñëe
(
pP¨£
->
db
, 
$$
);}

1107 
	$ˇ£_ñ£
(
A
Ë::
ELSE
 
	`ex¥
(
X
). {A = X.
pEx¥
;
	}
}

1108 
	$ˇ£_ñ£
(
A
Ë::. {A = 0;
	}
}

1109 %
ty≥
 
ˇ£_›î™d
 {
Ex¥
*}

1110 %
de°ru˘‹
 
ˇ£_›î™d
 {
sqlôe3Ex¥Dñëe
(
pP¨£
->
db
, 
$$
);}

1111 
	$ˇ£_›î™d
(
A
Ë::
	`ex¥
(
X
). {A = X.
pEx¥
;
	}
}

1112 
	$ˇ£_›î™d
(
A
Ë::. {A = 0;
	}
}

1114 %
ty≥
 
ex¥li°
 {
Ex¥Li°
*}

1115 %
de°ru˘‹
 
ex¥li°
 {
sqlôe3Ex¥Li°Dñëe
(
pP¨£
->
db
, 
$$
);}

1116 %
ty≥
 
√x¥li°
 {
Ex¥Li°
*}

1117 %
de°ru˘‹
 
√x¥li°
 {
sqlôe3Ex¥Li°Dñëe
(
pP¨£
->
db
, 
$$
);}

1119 
	$ex¥li°
(
A
Ë::
	`√x¥li°
(
X
). {A = X;
	}
}

1120 
	$ex¥li°
(
A
Ë::. {A = 0;
	}
}

1121 
	$√x¥li°
(
A
Ë::
	$√x¥li°
(
X
Ë
COMMA
 
	`ex¥
(
Y
).

1122 {
A
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,
X
,
Y
.
pEx¥
);
	}
}

1123 
	$√x¥li°
(
A
Ë::
	`ex¥
(
Y
).

1124 {
A
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,0,
Y
.
pEx¥
);
	}
}

1129 
cmd
 ::
	$¸óãkw
(
S
Ë
	$uniqueÊag
(
U
Ë
INDEX
 
	$i‚Ÿexi°s
(
NE
Ë
	$nm
(
X
Ë
	$dbnm
(
D
)

1130 
ON
 
	$nm
(
Y
Ë
LP
 
	$idxli°
(
Z
Ë
RP
 
	`whîe_›t
(
W
). {

1131 
	`sqlôe3Cª©eIndex
(
pP¨£
, &
X
, &
D
,

1132 
	`sqlôe3SrcLi°Aµíd
(
pP¨£
->
db
,0,&
Y
,0), 
Z
, 
U
,

1133 &
S
, 
W
, 
SQLITE_SO_ASC
, 
NE
);

1134 
	}
}

1136 %
ty≥
 
uniqueÊag
 {}

1137 
	$uniqueÊag
(
A
Ë::
UNIQUE
. {A = 
OE_Ab‹t
;
	}
}

1138 
	$uniqueÊag
(
A
Ë::. {A = 
OE_N⁄e
;
	}
}

1140 %
ty≥
 
idxli°
 {
Ex¥Li°
*}

1141 %
de°ru˘‹
 
idxli°
 {
sqlôe3Ex¥Li°Dñëe
(
pP¨£
->
db
, 
$$
);}

1142 %
ty≥
 
idxli°_›t
 {
Ex¥Li°
*}

1143 %
de°ru˘‹
 
idxli°_›t
 {
sqlôe3Ex¥Li°Dñëe
(
pP¨£
->
db
, 
$$
);}

1145 
	$idxli°_›t
(
A
Ë::. {A = 0;
	}
}

1146 
	$idxli°_›t
(
A
Ë::
LP
 
	$idxli°
(
X
Ë
RP
. {
A
 = X;
	}
}

1147 
	$idxli°
(
A
Ë::
	$idxli°
(
X
Ë
COMMA
 
	$nm
(
Y
Ë
	$cﬁœã
(
C
Ë
	`s‹t‹dî
(
Z
). {

1148 
Ex¥
 *
p
 = 
	`sqlôe3Ex¥AddCﬁœãTokí
(
pP¨£
, 0, &
C
);

1149 
A
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,
X
, 
p
);

1150 
	`sqlôe3Ex¥Li°SëName
(
pP¨£
,
A
,&
Y
,1);

1151 
	`sqlôe3Ex¥Li°CheckLígth
(
pP¨£
, 
A
, "index");

1152 if–
A
 ) A->
a
[A->
nEx¥
-1].
s‹tOrdî
 = (
u8
)
Z
;

1153 
	}
}

1154 
	$idxli°
(
A
Ë::
	$nm
(
Y
Ë
	$cﬁœã
(
C
Ë
	`s‹t‹dî
(
Z
). {

1155 
Ex¥
 *
p
 = 
	`sqlôe3Ex¥AddCﬁœãTokí
(
pP¨£
, 0, &
C
);

1156 
A
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,0, 
p
);

1157 
	`sqlôe3Ex¥Li°SëName
(
pP¨£
, 
A
, &
Y
, 1);

1158 
	`sqlôe3Ex¥Li°CheckLígth
(
pP¨£
, 
A
, "index");

1159 if–
A
 ) A->
a
[A->
nEx¥
-1].
s‹tOrdî
 = (
u8
)
Z
;

1160 
	}
}

1162 %
ty≥
 
cﬁœã
 {
Tokí
}

1163 
	$cﬁœã
(
C
Ë::. {C.
z
 = 0; C.
n
 = 0;
	}
}

1164 
	$cﬁœã
(
C
Ë::
COLLATE
 
	`ids
(
X
). {C = X;
	}
}

1169 
cmd
 ::
DROP
 
INDEX
 
	$i„xi°s
(
E
Ë
	`fuŒ«me
(
X
). {
	`sqlôe3Dr›Index
(
pP¨£
, X, E);
	}
}

1173 %
i‚def
 
SQLITE_OMIT_VACUUM


1174 %
i‚def
 
SQLITE_OMIT_ATTACH


1175 
cmd
 ::
VACUUM
. {
sqlôe3Vacuum
(
pP¨£
);}

1176 
cmd
 ::
VACUUM
 
nm
. {
sqlôe3Vacuum
(
pP¨£
);}

1177 %
ídif
 
SQLITE_OMIT_ATTACH


1178 %
ídif
 
SQLITE_OMIT_VACUUM


1182 %
i‚def
 
SQLITE_OMIT_PRAGMA


1183 
cmd
 ::
PRAGMA
 
	$nm
(
X
Ë
	`dbnm
(
Z
). {
	`sqlôe3Pøgma
(
pP¨£
,&X,&Z,0,0);
	}
}

1184 
cmd
 ::
PRAGMA
 
	$nm
(
X
Ë
	$dbnm
(
Z
Ë
EQ
 
	`nmnum
(
Y
). {
	`sqlôe3Pøgma
(
pP¨£
,&
X
,&Z,&Y,0);
	}
}

1185 
cmd
 ::
PRAGMA
 
	$nm
(
X
Ë
	$dbnm
(
Z
Ë
LP
 
	$nmnum
(
Y
Ë
RP
. {
	`sqlôe3Pøgma
(
pP¨£
,&
X
,&
Z
,&Y,0);
	}
}

1186 
cmd
 ::
PRAGMA
 
	$nm
(
X
Ë
	$dbnm
(
Z
Ë
EQ
 
	`möus_num
(
Y
).

1187 {
	`sqlôe3Pøgma
(
pP¨£
,&
X
,&
Z
,&
Y
,1);
	}
}

1188 
cmd
 ::
PRAGMA
 
	$nm
(
X
Ë
	$dbnm
(
Z
Ë
LP
 
	$möus_num
(
Y
Ë
RP
.

1189 {
	`sqlôe3Pøgma
(
pP¨£
,&
X
,&
Z
,&
Y
,1);
	}
}

1191 
	$nmnum
(
A
Ë::
	`∂us_num
(
X
). {A = X;
	}
}

1192 
	$nmnum
(
A
Ë::
	`nm
(
X
). {A = X;
	}
}

1193 
	$nmnum
(
A
Ë::
	`ON
(
X
). {A = X;
	}
}

1194 
	$nmnum
(
A
Ë::
	`DELETE
(
X
). {A = X;
	}
}

1195 
	$nmnum
(
A
Ë::
	`DEFAULT
(
X
). {A = X;
	}
}

1196 %
ídif
 
SQLITE_OMIT_PRAGMA


1197 
	$∂us_num
(
A
Ë::
PLUS
 
	`numbî
(
X
). {A = X;
	}
}

1198 
	$∂us_num
(
A
Ë::
	`numbî
(
X
). {A = X;
	}
}

1199 
	$möus_num
(
A
Ë::
MINUS
 
	`numbî
(
X
). {A = X;
	}
}

1200 
	$numbî
(
A
Ë::
INTEGER
|
	`FLOAT
(
X
). {A = X;
	}
}

1204 %
i‚def
 
SQLITE_OMIT_TRIGGER


1206 
cmd
 ::
¸óãkw
 
	$åiggî_de˛
(
A
Ë
BEGIN
 
	$åiggî_cmd_li°
(
S
Ë
	`END
(
Z
). {

1207 
Tokí
 
Æl
;

1208 
Æl
.
z
 = 
A
.z;

1209 
Æl
.
n
 = ()(
Z
.
z
 - 
A
.z) + Z.n;

1210 
	`sqlôe3FöishTriggî
(
pP¨£
, 
S
, &
Æl
);

1211 
	}
}

1213 
	$åiggî_de˛
(
A
Ë::
	$ãmp
(
T
Ë
TRIGGER
 
	$i‚Ÿexi°s
(
NOERR
Ë
	$nm
(
B
Ë
	$dbnm
(
Z
)

1214 
	$åiggî_time
(
C
Ë
	$åiggî_evít
(
D
)

1215 
ON
 
	$fuŒ«me
(
E
Ë
f‹óch_˛au£
 
	`whí_˛au£
(
G
). {

1216 
	`sqlôe3BegöTriggî
(
pP¨£
, &
B
, &
Z
, 
C
, 
D
.
a
, D.
b
, 
E
, 
G
, 
T
, 
NOERR
);

1217 
A
 = (
Z
.
n
==0?
B
:Z);

1218 
	}
}

1220 %
ty≥
 
åiggî_time
 {}

1221 
	$åiggî_time
(
A
Ë::
BEFORE
. { A = 
TK_BEFORE
; 
	}
}

1222 
	$åiggî_time
(
A
Ë::
AFTER
. { A = 
TK_AFTER
; 
	}
}

1223 
	$åiggî_time
(
A
Ë::
INSTEAD
 
OF
. { A = 
TK_INSTEAD
;
	}
}

1224 
	$åiggî_time
(
A
Ë::. { A = 
TK_BEFORE
; 
	}
}

1226 %
ty≥
 
åiggî_evít
 {
TrigEvít
}

1227 %
de°ru˘‹
 
åiggî_evít
 {
sqlôe3IdLi°Dñëe
(
pP¨£
->
db
, 
$$
.
b
);}

1228 
	$åiggî_evít
(
A
Ë::
DELETE
|
	`INSERT
(
OP
). {A.
a
 = @OP; A.
b
 = 0;
	}
}

1229 
	$åiggî_evít
(
A
Ë::
	`UPDATE
(
OP
). {A.
a
 = @OP; A.
b
 = 0;
	}
}

1230 
	$åiggî_evít
(
A
Ë::
UPDATE
 
OF
 
	`öscﬁli°
(
X
). {A.
a
 = 
TK_UPDATE
; A.
b
 = X;
	}
}

1232 
f‹óch_˛au£
 ::= .

1233 
f‹óch_˛au£
 ::
FOR
 
EACH
 
ROW
.

1235 %
ty≥
 
whí_˛au£
 {
Ex¥
*}

1236 %
de°ru˘‹
 
whí_˛au£
 {
sqlôe3Ex¥Dñëe
(
pP¨£
->
db
, 
$$
);}

1237 
	$whí_˛au£
(
A
Ë::. { A = 0; 
	}
}

1238 
	$whí_˛au£
(
A
Ë::
WHEN
 
	`ex¥
(
X
). { A = X.
pEx¥
; 
	}
}

1240 %
ty≥
 
åiggî_cmd_li°
 {
TriggîSãp
*}

1241 %
de°ru˘‹
 
åiggî_cmd_li°
 {
sqlôe3DñëeTriggîSãp
(
pP¨£
->
db
, 
$$
);}

1242 
	$åiggî_cmd_li°
(
A
Ë::
	$åiggî_cmd_li°
(
Y
Ë
	$åiggî_cmd
(
X
Ë
SEMI
. {

1243 
	`as£π
–
Y
!=0 );

1244 
Y
->
pLa°
->
pNext
 = 
X
;

1245 
Y
->
pLa°
 = 
X
;

1246 
A
 = 
Y
;

1247 
	}
}

1248 
	$åiggî_cmd_li°
(
A
Ë::
	$åiggî_cmd
(
X
Ë
SEMI
. {

1249 
	`as£π
–
X
!=0 );

1250 
X
->
pLa°
 = X;

1251 
A
 = 
X
;

1252 
	}
}

1258 %
ty≥
 
ånm
 {
Tokí
}

1259 
	$ånm
(
A
Ë::
	`nm
(
X
). {A = X;
	}
}

1260 
	$ånm
(
A
Ë::
nm
 
DOT
 
	`nm
(
X
). {

1261 
A
 = 
X
;

1262 
	`sqlôe3Eº‹Msg
(
pP¨£
,

1265 
	}
}

1271 
åidxby
 ::= .

1272 
åidxby
 ::
INDEXED
 
BY
 
nm
. {

1273 
sqlôe3Eº‹Msg
(
pP¨£
,

1277 
åidxby
 ::
NOT
 
INDEXED
. {

1278 
sqlôe3Eº‹Msg
(
pP¨£
,

1285 %
ty≥
 
åiggî_cmd
 {
TriggîSãp
*}

1286 %
de°ru˘‹
 
åiggî_cmd
 {
sqlôe3DñëeTriggîSãp
(
pP¨£
->
db
, 
$$
);}

1288 
	$åiggî_cmd
(
A
) ::=

1289 
UPDATE
 
	$‹c⁄f
(
R
Ë
	$ånm
(
X
Ë
åidxby
 
SET
 
	$£éi°
(
Y
Ë
	`whîe_›t
(
Z
).

1290 { 
A
 = 
	`sqlôe3TriggîUpd©eSãp
(
pP¨£
->
db
, &
X
, 
Y
, 
Z
, 
R
); 
	}
}

1293 
	$åiggî_cmd
(
A
) ::=

1294 
	$ö£π_cmd
(
R
Ë
INTO
 
	$ånm
(
X
Ë
	$öscﬁli°_›t
(
F
Ë
	`vÆuñi°
(
Y
).

1295 {
A
 = 
	`sqlôe3TriggîIn£πSãp
(
pP¨£
->
db
, &
X
, 
F
, 
Y
.
pLi°
, Y.
pSñe˘
, 
R
);
	}
}

1297 
	$åiggî_cmd
(
A
Ë::
	$ö£π_cmd
(
R
Ë
INTO
 
	$ånm
(
X
Ë
	$öscﬁli°_›t
(
F
Ë
	`£À˘
(
S
).

1298 {
A
 = 
	`sqlôe3TriggîIn£πSãp
(
pP¨£
->
db
, &
X
, 
F
, 0, 
S
, 
R
);
	}
}

1301 
	$åiggî_cmd
(
A
Ë::
DELETE
 
FROM
 
	$ånm
(
X
Ë
åidxby
 
	`whîe_›t
(
Y
).

1302 {
A
 = 
	`sqlôe3TriggîDñëeSãp
(
pP¨£
->
db
, &
X
, 
Y
);
	}
}

1305 
	$åiggî_cmd
(
A
Ë::
	`£À˘
(
X
). {A = 
	`sqlôe3TriggîSñe˘Sãp
(
pP¨£
->
db
, X); 
	}
}

1308 
	$ex¥
(
A
Ë::
	$RAISE
(
X
Ë
LP
 
IGNORE
 
	`RP
(
Y
). {

1309 
A
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_RAISE
, 0, 0, 0);

1310 if–
A
.
pEx¥
 ){

1311 
A
.
pEx¥
->
afföôy
 = 
OE_Ign‹e
;

1313 
A
.
zSèπ
 = 
X
.
z
;

1314 
A
.
zEnd
 = &
Y
.
z
[Y.
n
];

1315 
	}
}

1316 
	$ex¥
(
A
Ë::
	$RAISE
(
X
Ë
LP
 
	$øi£ty≥
(
T
Ë
COMMA
 
	$nm
(
Z
Ë
	`RP
(
Y
). {

1317 
A
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_RAISE
, 0, 0, &
Z
);

1318 if–
A
.
pEx¥
 ) {

1319 
A
.
pEx¥
->
afföôy
 = ()
T
;

1321 
A
.
zSèπ
 = 
X
.
z
;

1322 
A
.
zEnd
 = &
Y
.
z
[Y.
n
];

1323 
	}
}

1324 %
ídif
 !
SQLITE_OMIT_TRIGGER


1326 %
ty≥
 
øi£ty≥
 {}

1327 
	$øi£ty≥
(
A
Ë::
ROLLBACK
. {A = 
OE_Rﬁlback
;
	}
}

1328 
	$øi£ty≥
(
A
Ë::
ABORT
. {A = 
OE_Ab‹t
;
	}
}

1329 
	$øi£ty≥
(
A
Ë::
FAIL
. {A = 
OE_Faû
;
	}
}

1333 %
i‚def
 
SQLITE_OMIT_TRIGGER


1334 
cmd
 ::
DROP
 
TRIGGER
 
	$i„xi°s
(
NOERR
Ë
	`fuŒ«me
(
X
). {

1335 
	`sqlôe3Dr›Triggî
(
pP¨£
,
X
,
NOERR
);

1336 
	}
}

1337 %
ídif
 !
SQLITE_OMIT_TRIGGER


1340 %
i‚def
 
SQLITE_OMIT_ATTACH


1341 
cmd
 ::
ATTACH
 
d©aba£_kw_›t
 
	$ex¥
(
F
Ë
AS
 
	$ex¥
(
D
Ë
	`key_›t
(
K
). {

1342 
	`sqlôe3Aâach
(
pP¨£
, 
F
.
pEx¥
, 
D
.pEx¥, 
K
);

1343 
	}
}

1344 
cmd
 ::
DETACH
 
d©aba£_kw_›t
 
ex¥
(
D
). {

1345 
sqlôe3Dëach
(
pP¨£
, 
D
.
pEx¥
);

1348 %
ty≥
 
key_›t
 {
Ex¥
*}

1349 %
de°ru˘‹
 
key_›t
 {
sqlôe3Ex¥Dñëe
(
pP¨£
->
db
, 
$$
);}

1350 
	$key_›t
(
A
Ë::. { A = 0; 
	}
}

1351 
	$key_›t
(
A
Ë::
KEY
 
	`ex¥
(
X
). { A = X.
pEx¥
; 
	}
}

1353 
d©aba£_kw_›t
 ::
DATABASE
.

1354 
d©aba£_kw_›t
 ::= .

1355 %
ídif
 
SQLITE_OMIT_ATTACH


1358 %
i‚def
 
SQLITE_OMIT_REINDEX


1359 
cmd
 ::
REINDEX
. {
sqlôe3Reödex
(
pP¨£
, 0, 0);}

1360 
cmd
 ::
REINDEX
 
	$nm
(
X
Ë
	`dbnm
(
Y
). {
	`sqlôe3Reödex
(
pP¨£
, &X, &Y);
	}
}

1361 %
ídif
 
SQLITE_OMIT_REINDEX


1364 %
i‚def
 
SQLITE_OMIT_ANALYZE


1365 
cmd
 ::
ANALYZE
. {
sqlôe3A«lyze
(
pP¨£
, 0, 0);}

1366 
cmd
 ::
ANALYZE
 
	$nm
(
X
Ë
	`dbnm
(
Y
). {
	`sqlôe3A«lyze
(
pP¨£
, &X, &Y);
	}
}

1367 %
ídif


1370 %
i‚def
 
SQLITE_OMIT_ALTERTABLE


1372 
cmd
 ::
ALTER
 
TABLE
 
	$fuŒ«me
(
X
Ë
RENAME
 
TO
 
	`nm
(
Z
). {

1373 
	`sqlôe3A…îRíameTabÀ
(
pP¨£
,
X
,&
Z
);

1374 
	}
}

1377 
cmd
 ::
ALTER
 
TABLE
 
	$fuŒ«me
(
X
Ë
ADD
 
CONSTRAINT
 
	$nm
(
Y
Ë
	`ex¥
(
A
). {

1378 
pP¨£
->
c⁄°øötName
 = 
Y
;

1379 
	`sqlôe3AddC⁄°øötgrk
(
pP¨£
,
X
,
A
.
pEx¥
);

1380 
	}
}

1396 
kwcﬁumn_›t
 ::= .

1397 
kwcﬁumn_›t
 ::
COLUMNKW
.

1400 %
ídif
 
SQLITE_OMIT_ALTERTABLE


1403 %
i‚def
 
SQLITE_OMIT_VIRTUALTABLE


1404 
cmd
 ::
¸óã_vèb
. {
sqlôe3VèbFöishP¨£
(
pP¨£
,0);}

1405 
cmd
 ::
¸óã_vèb
 
LP
 
vèb¨gli°
 
RP
(
X
). {
sqlôe3VèbFöishP¨£
(
pP¨£
,&X);}

1406 
¸óã_vèb
 ::
¸óãkw
 
VIRTUAL
 
TABLE
 
	$i‚Ÿexi°s
(
E
)

1407 
	$nm
(
X
Ë
	$dbnm
(
Y
Ë
USING
 
	`nm
(
Z
). {

1408 
	`sqlôe3VèbBegöP¨£
(
pP¨£
, &
X
, &
Y
, &
Z
, 
E
);

1409 
	}
}

1410 
vèb¨gli°
 ::
vèb¨g
.

1411 
vèb¨gli°
 ::vèb¨gli° 
COMMA
 
vèb¨g
.

1412 
vèb¨g
 ::. {
sqlôe3VèbArgInô
(
pP¨£
);}

1413 
vèb¨g
 ::vèb¨g 
vèb¨gtokí
.

1414 
vèb¨gtokí
 ::
ANY
(
X
). {
sqlôe3VèbArgExãnd
(
pP¨£
,&X);}

1415 
vèb¨gtokí
 ::
Õ
 
™yli°
 
RP
(
X
). {
sqlôe3VèbArgExãnd
(
pP¨£
,&X);}

1416 
Õ
 ::
LP
(
X
). {
sqlôe3VèbArgExãnd
(
pP¨£
,&X);}

1417 
™yli°
 ::= .

1418 
™yli°
 ::™yli° 
LP
ányli° 
RP
.

1419 
™yli°
 ::™yli° 
ANY
.

1420 %
ídif
 
SQLITE_OMIT_VIRTUALTABLE


	@shell.c

15 #i‡(
deföed
(
_WIN32
Ë|| deföed(
WIN32
)Ë&& !deföed(
_CRT_SECURE_NO_WARNINGS
)

17 
	#_CRT_SECURE_NO_WARNINGS


	)

23 #i‚de‡
SQLITE_DISABLE_LFS


24 
	#_LARGE_FILE
 1

	)

25 #i‚de‡
_FILE_OFFSET_BITS


26 
	#_FILE_OFFSET_BITS
 64

	)

28 
	#_LARGEFILE_SOURCE
 1

	)

31 
	~<°dlib.h
>

32 
	~<°rög.h
>

33 
	~<°dio.h
>

34 
	~<as£π.h
>

35 
	~"sqlôe3.h
"

36 
	~<˘y≥.h
>

37 
	~<°d¨g.h
>

39 #i‡!
deföed
(
_WIN32
Ë&& !deföed(
WIN32
)

40 
	~<sig«l.h
>

41 #i‡!
deföed
(
__RTP__
Ë&& !deföed(
_WRS_KERNEL
)

42 
	~<pwd.h
>

44 
	~<uni°d.h
>

45 
	~<sys/ty≥s.h
>

48 #ifde‡
HAVE_EDITLINE


49 
	~<edôlöe/edôlöe.h
>

51 #i‡
deföed
(
HAVE_READLINE
) && HAVE_READLINE==1

52 
	~<ªadlöe/ªadlöe.h
>

53 
	~<ªadlöe/hi°‹y.h
>

55 #i‡!
deföed
(
HAVE_EDITLINE
Ë&& (!deföed(
HAVE_READLINE
) || HAVE_READLINE!=1)

56 
	#add_hi°‹y
(
X
)

	)

57 
	#ªad_hi°‹y
(
X
)

	)

58 
	#wrôe_hi°‹y
(
X
)

	)

59 
	#°iÊe_hi°‹y
(
X
)

	)

62 #i‡
deföed
(
_WIN32
Ë|| deföed(
WIN32
)

63 
	~<io.h
>

64 
	#ißây
(
h
Ë
	`_ißây
(h)

	)

65 
	#ac˚ss
(
f
,
m
Ë
	`_ac˚ss
((f),(m))

	)

66 #unde‡
p›í


67 
	#p›í
 
_p›í


	)

68 #unde‡
p˛o£


69 
	#p˛o£
 
_p˛o£


	)

73 
ißây
();

77 
FILE
 *
p›í
(const *,const *);

78 
p˛o£
(
FILE
*);

81 #i‡
deföed
(
_WIN32_WCE
)

86 
	#ißây
(
x
Ë1

	)

90 
	gíabÀTimî
 = 0;

93 
	#IsS∑˚
(
X
Ë
	`is•a˚
(()X)

	)

94 
	#IsDigô
(
X
Ë
	`isdigô
(()X)

	)

95 
	#ToLowî
(
X
Ë()
	`tﬁowî
(()X)

	)

97 #i‡!
deföed
(
_WIN32
Ë&& !deföed(
WIN32
Ë&& !deföed(
_WRS_KERNEL
) \

98 && !
	$deföed
(
__möux
)

99 
	~<sys/time.h
>

100 
	~<sys/ªsour˚.h
>

103 
rußge
 
sBegö
;

108 
	$begöTimî
(){

109 if–
íabÀTimî
 ){

110 
	`gërußge
(
RUSAGE_SELF
, &
sBegö
);

112 
	}
}

115 
	$timeDiff
(
timevÆ
 *
pSèπ
, timevÆ *
pEnd
){

116  (
pEnd
->
tv_u£c
 - 
pSèπ
->tv_usec)*0.000001 +

117 ()(
pEnd
->
tv_£c
 - 
pSèπ
->tv_sec);

118 
	}
}

123 
	$ídTimî
(){

124 if–
íabÀTimî
 ){

125 
rußge
 
sEnd
;

126 
	`gërußge
(
RUSAGE_SELF
, &
sEnd
);

127 
	`¥ötf
("CPU Time: user %f sys %f\n",

128 
	`timeDiff
(&
sBegö
.
ru_utime
, &
sEnd
.ru_utime),

129 
	`timeDiff
(&
sBegö
.
ru_°ime
, &
sEnd
.ru_stime));

131 
	}
}

133 
	#BEGIN_TIMER
 
	`begöTimî
()

	)

134 
	#END_TIMER
 
	`ídTimî
()

	)

135 
	#HAS_TIMER
 1

	)

137 #ñi‡(
deföed
(
_WIN32
Ë|| deföed(
WIN32
))

139 
	~<wödows.h
>

142 
HANDLE
 
	ghPro˚ss
;

143 
FILETIME
 
	g·Kî√lBegö
;

144 
FILETIME
 
	g·U£rBegö
;

145 
	$BOOL
 (
	tWINAPI
 *
	tGETPROCTIMES
)(
	tHANDLE
, 
	tLPFILETIME
, LPFILETIME, LPFILETIME, LPFILETIME);

146 
GETPROCTIMES
 
gëPro˚ssTimesAddr
 = 
NULL
;

152 
	$hasTimî
(){

153 if–
gëPro˚ssTimesAddr
 ){

160 
hPro˚ss
 = 
	`GëCuºítPro˚ss
();

161 if–
hPro˚ss
 ){

162 
HINSTANCE
 
hö°Lib
 = 
	`LﬂdLibøry
(
	`TEXT
("Kernel32.dll"));

163 if–
NULL
 !
hö°Lib
 ){

164 
gëPro˚ssTimesAddr
 = (
GETPROCTIMES
Ë
	`GëProcAddªss
(
hö°Lib
, "GetProcessTimes");

165 if–
NULL
 !
gëPro˚ssTimesAddr
 ){

168 
	`FªeLibøry
(
hö°Lib
);

173 
	}
}

178 
	$begöTimî
(){

179 if–
íabÀTimî
 && 
gëPro˚ssTimesAddr
 ){

180 
FILETIME
 
·Cª©i⁄
, 
·Exô
;

181 
	`gëPro˚ssTimesAddr
(
hPro˚ss
, &
·Cª©i⁄
, &
·Exô
, &
·Kî√lBegö
, &
·U£rBegö
);

183 
	}
}

186 
	$timeDiff
(
FILETIME
 *
pSèπ
, FILETIME *
pEnd
){

187 
sqlôe_öt64
 
i64Sèπ
 = *((sqlôe_öt64 *Ë
pSèπ
);

188 
sqlôe_öt64
 
i64End
 = *((sqlôe_öt64 *Ë
pEnd
);

189  (Ë((
i64End
 - 
i64Sèπ
) / 10000000.0);

190 
	}
}

195 
	$ídTimî
(){

196 if–
íabÀTimî
 && 
gëPro˚ssTimesAddr
){

197 
FILETIME
 
·Cª©i⁄
, 
·Exô
, 
·Kî√lEnd
, 
·U£rEnd
;

198 
	`gëPro˚ssTimesAddr
(
hPro˚ss
, &
·Cª©i⁄
, &
·Exô
, &
·Kî√lEnd
, &
·U£rEnd
);

199 
	`¥ötf
("CPU Time: user %f sys %f\n",

200 
	`timeDiff
(&
·U£rBegö
, &
·U£rEnd
),

201 
	`timeDiff
(&
·Kî√lBegö
, &
·Kî√lEnd
));

203 
	}
}

205 
	#BEGIN_TIMER
 
	`begöTimî
()

	)

206 
	#END_TIMER
 
	`ídTimî
()

	)

207 
	#HAS_TIMER
 
	`hasTimî
()

	)

210 
	#BEGIN_TIMER


	)

211 
	#END_TIMER


	)

212 
	#HAS_TIMER
 0

	)

218 
	#UNUSED_PARAMETER
(
x
Ë()(x)

	)

224 
	gbaû_⁄_îr‹
 = 0;

230 
	g°dö_is_öãø˘ive
 = 1;

237 
sqlôe3
 *
	gdb
 = 0;

242 vﬁ©ûê
	g£íI¡îru±
 = 0;

248 *
	gArgv0
;

254 
	gmaöProm±
[20];

255 
	gc⁄töueProm±
[20];

260 #ifde‡
SQLITE_ENABLE_IOTRACE


261 
FILE
 *
	giŸø˚
 = 0;

270 #ifde‡
SQLITE_ENABLE_IOTRACE


271 
	$iŸø˚Prötf
(c⁄° *
zF‹m©
, ...){

272 
va_li°
 
≠
;

273 *
z
;

274 if–
iŸø˚
==0 ) ;

275 
	`va_°¨t
(
≠
, 
zF‹m©
);

276 
z
 = 
	`sqlôe3_vm¥ötf
(
zF‹m©
, 
≠
);

277 
	`va_íd
(
≠
);

278 
	`Ârötf
(
iŸø˚
, "%s", 
z
);

279 
	`sqlôe3_‰ì
(
z
);

280 
	}
}

287 
	$isNumbî
(c⁄° *
z
, *
ªÆnum
){

288 if–*
z
=='-' || *z=='+' ) z++;

289 if–!
	`IsDigô
(*
z
) ){

292 
z
++;

293 if–
ªÆnum
 ) *realnum = 0;

294  
	`IsDigô
(*
z
) ){ z++; }

295 if–*
z
=='.' ){

296 
z
++;

297 if–!
	`IsDigô
(*
z
) )  0;

298  
	`IsDigô
(*
z
) ){ z++; }

299 if–
ªÆnum
 ) *realnum = 1;

301 if–*
z
=='e' || *z=='E' ){

302 
z
++;

303 if–*
z
=='+' || *z=='-' ) z++;

304 if–!
	`IsDigô
(*
z
) )  0;

305  
	`IsDigô
(*
z
) ){ z++; }

306 if–
ªÆnum
 ) *realnum = 1;

308  *
z
==0;

309 
	}
}

319 c⁄° *
	gzShñlSètic
 = 0;

320 
	$shñl°©icFunc
(

321 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

322 
¨gc
,

323 
sqlôe3_vÆue
 **
¨gv


325 
	`as£π
–0==
¨gc
 );

326 
	`as£π
–
zShñlSètic
 );

327 
	`UNUSED_PARAMETER
(
¨gc
);

328 
	`UNUSED_PARAMETER
(
¨gv
);

329 
	`sqlôe3_ªsu…_ãxt
(
c⁄ãxt
, 
zShñlSètic
, -1, 
SQLITE_STATIC
);

330 
	}
}

342 *
	$loˇl_gëlöe
(*
zLöe
, 
FILE
 *
ö
){

343 
nLöe
 = 
zLöe
==0 ? 0 : 100;

344 
n
 = 0;

347 if–
n
+100>
nLöe
 ){

348 
nLöe
 =ÇLine*2 + 100;

349 
zLöe
 = 
	`ªÆloc
(zLöe, 
nLöe
);

350 if–
zLöe
==0 )  0;

352 if–
	`fgës
(&
zLöe
[
n
], 
nLöe
 -Ç, 
ö
)==0 ){

353 if–
n
==0 ){

354 
	`‰ì
(
zLöe
);

357 
zLöe
[
n
] = 0;

360  
zLöe
[
n
] )Ç++;

361 if–
n
>0 && 
zLöe
[n-1]=='\n' ){

362 
n
--;

363 if–
n
>0 && 
zLöe
[n-1]=='\r' )Ç--;

364 
zLöe
[
n
] = 0;

368  
zLöe
;

369 
	}
}

385 *
	$⁄e_öput_löe
(
FILE
 *
ö
, *
zPri‹
, 
isC⁄töu©i⁄
){

386 *
zProm±
;

387 *
zResu…
;

388 if–
ö
!=0 ){

389 
zResu…
 = 
	`loˇl_gëlöe
(
zPri‹
, 
ö
);

391 
zProm±
 = 
isC⁄töu©i⁄
 ? 
c⁄töueProm±
 : 
maöProm±
;

392 #i‡
	`deföed
(
HAVE_READLINE
) && HAVE_READLINE==1

393 
	`‰ì
(
zPri‹
);

394 
zResu…
 = 
	`ªadlöe
(
zProm±
);

395 if–
zResu…
 && *zResu… ) 
	`add_hi°‹y
(zResult);

397 
	`¥ötf
("%s", 
zProm±
);

398 
	`fÊush
(
°dout
);

399 
zResu…
 = 
	`loˇl_gëlöe
(
zPri‹
, 
°dö
);

402  
zResu…
;

403 
	}
}

405 
	s¥evious_mode_d©a
 {

406 
	mvÆid
;

407 
	mmode
;

408 
	mshowHódî
;

409 
	mcﬁWidth
[100];

417 
	sˇŒback_d©a
 {

418 
sqlôe3
 *
	mdb
;

419 
	mechoOn
;

420 
	m°©sOn
;

421 
	m˙t
;

422 
FILE
 *
	mout
;

423 
FILE
 *
	måa˚Out
;

424 
	mnEº
;

425 
	mmode
;

426 
	mwrôabÀSchema
;

427 
	mshowHódî
;

428 *
	mzDe°TabÀ
;

429 
	m£∑øt‹
[20];

430 
	mcﬁWidth
[100];

431 
	ma˘uÆWidth
[100];

432 
	mnuŒvÆue
[20];

434 
¥evious_mode_d©a
 
	mex∂aöPªv
;

437 
	moutfûe
[
FILENAME_MAX
];

438 c⁄° *
	mzDbFûíame
;

439 c⁄° *
	mzVfs
;

440 
sqlôe3_°mt
 *
	mpStmt
;

441 
FILE
 *
	mpLog
;

447 
	#MODE_Löe
 0

	)

448 
	#MODE_Cﬁumn
 1

	)

449 
	#MODE_Li°
 2

	)

450 
	#MODE_Semi
 3

	)

451 
	#MODE_Html
 4

	)

452 
	#MODE_In£π
 5

	)

453 
	#MODE_T˛
 6

	)

454 
	#MODE_Csv
 7

	)

455 
	#MODE_Ex∂aö
 8

	)

457 c⁄° *
	gmodeDes¸
[] = {

472 
	#AºaySize
(
X
Ë()((X)/(X[0]))

	)

478 
	$°æí30
(c⁄° *
z
){

479 c⁄° *
z2
 = 
z
;

480  *
z2
 ){ z2++; }

481  0x3ffffff‡& ()(
z2
 - 
z
);

482 
	}
}

487 
	$shñlLog
(*
pArg
, 
iEºCode
, c⁄° *
zMsg
){

488 
ˇŒback_d©a
 *
p
 = (ˇŒback_d©a*)
pArg
;

489 if–
p
->
pLog
==0 ) ;

490 
	`Ârötf
(
p
->
pLog
, "(%dË%s\n", 
iEºCode
, 
zMsg
);

491 
	`fÊush
(
p
->
pLog
);

492 
	}
}

497 
	$ouçut_hex_blob
(
FILE
 *
out
, c⁄° *
pBlob
, 
nBlob
){

498 
i
;

499 *
zBlob
 = (*)
pBlob
;

500 
	`Ârötf
(
out
,"X'");

501 
i
=0; i<
nBlob
; i++){ 
	`Ârötf
(
out
,"%02x",
zBlob
[i]&0xff); }

502 
	`Ârötf
(
out
,"'");

503 
	}
}

508 
	$ouçut_quŸed_°rög
(
FILE
 *
out
, c⁄° *
z
){

509 
i
;

510 
nSögÀ
 = 0;

511 
i
=0; 
z
[i]; i++){

512 if–
z
[
i
]=='\'' ) 
nSögÀ
++;

514 if–
nSögÀ
==0 ){

515 
	`Ârötf
(
out
,"'%s'",
z
);

517 
	`Ârötf
(
out
,"'");

518  *
z
 ){

519 
i
=0; 
z
[i] && z[i]!='\''; i++){}

520 if–
i
==0 ){

521 
	`Ârötf
(
out
,"''");

522 
z
++;

523 }if–
z
[
i
]=='\'' ){

524 
	`Ârötf
(
out
,"%.*s''",
i
,
z
);

525 
z
 +
i
+1;

527 
	`Ârötf
(
out
,"%s",
z
);

531 
	`Ârötf
(
out
,"'");

533 
	}
}

538 
	$ouçut_c_°rög
(
FILE
 *
out
, c⁄° *
z
){

539 
c
;

540 
	`Âutc
('"', 
out
);

541  (
c
 = *(
z
++))!=0 ){

542 if–
c
=='\\' ){

543 
	`Âutc
(
c
, 
out
);

544 
	`Âutc
(
c
, 
out
);

545 }if–
c
=='"' ){

546 
	`Âutc
('\\', 
out
);

547 
	`Âutc
('"', 
out
);

548 }if–
c
=='\t' ){

549 
	`Âutc
('\\', 
out
);

550 
	`Âutc
('t', 
out
);

551 }if–
c
=='\n' ){

552 
	`Âutc
('\\', 
out
);

553 
	`Âutc
('n', 
out
);

554 }if–
c
=='\r' ){

555 
	`Âutc
('\\', 
out
);

556 
	`Âutc
('r', 
out
);

557 }if–!
	`i•röt
(
c
&0xff) ){

558 
	`Ârötf
(
out
, "\\%03o", 
c
&0xff);

560 
	`Âutc
(
c
, 
out
);

563 
	`Âutc
('"', 
out
);

564 
	}
}

570 
	$ouçut_html_°rög
(
FILE
 *
out
, c⁄° *
z
){

571 
i
;

572  *
z
 ){

573 
i
=0; 
z
[i]

574 && 
z
[
i
]!='<'

575 && 
z
[
i
]!='&'

576 && 
z
[
i
]!='>'

577 && 
z
[
i
]!='\"'

578 && 
z
[
i
]!='\'';

579 
i
++){}

580 if–
i
>0 ){

581 
	`Ârötf
(
out
,"%.*s",
i
,
z
);

583 if–
z
[
i
]=='<' ){

584 
	`Ârötf
(
out
,"&lt;");

585 }if–
z
[
i
]=='&' ){

586 
	`Ârötf
(
out
,"&amp;");

587 }if–
z
[
i
]=='>' ){

588 
	`Ârötf
(
out
,"&gt;");

589 }if–
z
[
i
]=='\"' ){

590 
	`Ârötf
(
out
,"&quot;");

591 }if–
z
[
i
]=='\'' ){

592 
	`Ârötf
(
out
,"&#39;");

596 
z
 +
i
 + 1;

598 
	}
}

604 c⁄° 
	g√edCsvQuŸe
[] = {

628 
	$ouçut_csv
(
ˇŒback_d©a
 *
p
, c⁄° *
z
, 
bSï
){

629 
FILE
 *
out
 = 
p
->out;

630 if–
z
==0 ){

631 
	`Ârötf
(
out
,"%s",
p
->
nuŒvÆue
);

633 
i
;

634 
nSï
 = 
	`°æí30
(
p
->
£∑øt‹
);

635 
i
=0; 
z
[i]; i++){

636 if–
√edCsvQuŸe
[((*)
z
)[
i
]]

637 || (
z
[
i
]==
p
->
£∑øt‹
[0] &&

638 (
nSï
==1 || 
	`memcmp
(
z
, 
p
->
£∑øt‹
,ÇSep)==0)) ){

639 
i
 = 0;

643 if–
i
==0 ){

644 
	`putc
('"', 
out
);

645 
i
=0; 
z
[i]; i++){

646 if–
z
[
i
]=='"' ) 
	`putc
('"', 
out
);

647 
	`putc
(
z
[
i
], 
out
);

649 
	`putc
('"', 
out
);

651 
	`Ârötf
(
out
, "%s", 
z
);

654 if–
bSï
 ){

655 
	`Ârötf
(
p
->
out
, "%s",Ö->
£∑øt‹
);

657 
	}
}

659 #ifde‡
SIGINT


663 
	$öãºu±_h™dÀr
(
NŸU£d
){

664 
	`UNUSED_PARAMETER
(
NŸU£d
);

665 
£íI¡îru±
 = 1;

666 if–
db
 ) 
	`sqlôe3_öãºu±
(db);

667 
	}
}

674 
	$shñl_ˇŒback
(*
pArg
, 
nArg
, **
azArg
, **
azCﬁ
, *
aiTy≥
){

675 
i
;

676 
ˇŒback_d©a
 *
p
 = (ˇŒback_d©a*)
pArg
;

678  
p
->
mode
 ){

679 
MODE_Löe
: {

680 
w
 = 5;

681 if–
azArg
==0 ) ;

682 
i
=0; i<
nArg
; i++){

683 
Àn
 = 
	`°æí30
(
azCﬁ
[
i
] ?ázCol[i] : "");

684 if–
Àn
>
w
 ) w =Üen;

686 if–
p
->
˙t
++>0 ) 
	`Ârötf
’->
out
,"\n");

687 
i
=0; i<
nArg
; i++){

688 
	`Ârötf
(
p
->
out
,"%*†%s\n", 
w
, 
azCﬁ
[
i
],

689 
azArg
[
i
] ?ázArg[i] : 
p
->
nuŒvÆue
);

693 
MODE_Ex∂aö
:

694 
MODE_Cﬁumn
: {

695 if–
p
->
˙t
++==0 ){

696 
i
=0; i<
nArg
; i++){

697 
w
, 
n
;

698 if–
i
<
	`AºaySize
(
p
->
cﬁWidth
) ){

699 
w
 = 
p
->
cﬁWidth
[
i
];

701 
w
 = 0;

703 if–
w
==0 ){

704 
w
 = 
	`°æí30
(
azCﬁ
[
i
] ?ázCol[i] : "");

705 if–
w
<10 ) w = 10;

706 
n
 = 
	`°æí30
(
azArg
 &&ázArg[
i
] ?ázArg[i] : 
p
->
nuŒvÆue
);

707 if–
w
<
n
 ) w =Ç;

709 if–
i
<
	`AºaySize
(
p
->
a˘uÆWidth
) ){

710 
p
->
a˘uÆWidth
[
i
] = 
w
;

712 if–
p
->
showHódî
 ){

713 if–
w
<0 ){

714 
	`Ârötf
(
p
->
out
,"%*.*s%s",-
w
,-w,
azCﬁ
[
i
], i==
nArg
-1 ? "\n": " ");

716 
	`Ârötf
(
p
->
out
,"%-*.*s%s",
w
,w,
azCﬁ
[
i
], i==
nArg
-1 ? "\n": " ");

720 if–
p
->
showHódî
 ){

721 
i
=0; i<
nArg
; i++){

722 
w
;

723 if–
i
<
	`AºaySize
(
p
->
a˘uÆWidth
) ){

724 
w
 = 
p
->
a˘uÆWidth
[
i
];

725 if–
w
<0 ) w = -w;

727 
w
 = 10;

729 
	`Ârötf
(
p
->
out
,"%-*.*s%s",
w
,w,"-----------------------------------"

731 
i
==
nArg
-1 ? "\n": " ");

735 if–
azArg
==0 ) ;

736 
i
=0; i<
nArg
; i++){

737 
w
;

738 if–
i
<
	`AºaySize
(
p
->
a˘uÆWidth
) ){

739 
w
 = 
p
->
a˘uÆWidth
[
i
];

741 
w
 = 10;

743 if–
p
->
mode
==
MODE_Ex∂aö
 && 
azArg
[
i
] &&

744 
	`°æí30
(
azArg
[
i
])>
w
 ){

745 
w
 = 
	`°æí30
(
azArg
[
i
]);

747 if–
w
<0 ){

748 
	`Ârötf
(
p
->
out
,"%*.*s%s",-
w
,-w,

749 
azArg
[
i
] ?ázArg[i] : 
p
->
nuŒvÆue
, i==
nArg
-1 ? "\n": " ");

751 
	`Ârötf
(
p
->
out
,"%-*.*s%s",
w
,w,

752 
azArg
[
i
] ?ázArg[i] : 
p
->
nuŒvÆue
, i==
nArg
-1 ? "\n": " ");

757 
MODE_Semi
:

758 
MODE_Li°
: {

759 if–
p
->
˙t
++==0 &&Ö->
showHódî
 ){

760 
i
=0; i<
nArg
; i++){

761 
	`Ârötf
(
p
->
out
,"%s%s",
azCﬁ
[
i
], i==
nArg
-1 ? "\n" :Ö->
£∑øt‹
);

764 if–
azArg
==0 ) ;

765 
i
=0; i<
nArg
; i++){

766 *
z
 = 
azArg
[
i
];

767 if–
z
==0 ) z = 
p
->
nuŒvÆue
;

768 
	`Ârötf
(
p
->
out
, "%s", 
z
);

769 if–
i
<
nArg
-1 ){

770 
	`Ârötf
(
p
->
out
, "%s",Ö->
£∑øt‹
);

771 }if–
p
->
mode
==
MODE_Semi
 ){

772 
	`Ârötf
(
p
->
out
, ";\n");

774 
	`Ârötf
(
p
->
out
, "\n");

779 
MODE_Html
: {

780 if–
p
->
˙t
++==0 &&Ö->
showHódî
 ){

781 
	`Ârötf
(
p
->
out
,"<TR>");

782 
i
=0; i<
nArg
; i++){

783 
	`Ârötf
(
p
->
out
,"<TH>");

784 
	`ouçut_html_°rög
(
p
->
out
, 
azCﬁ
[
i
]);

785 
	`Ârötf
(
p
->
out
,"</TH>\n");

787 
	`Ârötf
(
p
->
out
,"</TR>\n");

789 if–
azArg
==0 ) ;

790 
	`Ârötf
(
p
->
out
,"<TR>");

791 
i
=0; i<
nArg
; i++){

792 
	`Ârötf
(
p
->
out
,"<TD>");

793 
	`ouçut_html_°rög
(
p
->
out
, 
azArg
[
i
] ?ázArg[i] :Ö->
nuŒvÆue
);

794 
	`Ârötf
(
p
->
out
,"</TD>\n");

796 
	`Ârötf
(
p
->
out
,"</TR>\n");

799 
MODE_T˛
: {

800 if–
p
->
˙t
++==0 &&Ö->
showHódî
 ){

801 
i
=0; i<
nArg
; i++){

802 
	`ouçut_c_°rög
(
p
->
out
,
azCﬁ
[
i
] ?ázCol[i] : "");

803 if(
i
<
nArg
-1Ë
	`Ârötf
(
p
->
out
, "%s",Ö->
£∑øt‹
);

805 
	`Ârötf
(
p
->
out
,"\n");

807 if–
azArg
==0 ) ;

808 
i
=0; i<
nArg
; i++){

809 
	`ouçut_c_°rög
(
p
->
out
, 
azArg
[
i
] ?ázArg[i] :Ö->
nuŒvÆue
);

810 if(
i
<
nArg
-1Ë
	`Ârötf
(
p
->
out
, "%s",Ö->
£∑øt‹
);

812 
	`Ârötf
(
p
->
out
,"\n");

815 
MODE_Csv
: {

816 if–
p
->
˙t
++==0 &&Ö->
showHódî
 ){

817 
i
=0; i<
nArg
; i++){

818 
	`ouçut_csv
(
p
, 
azCﬁ
[
i
] ?ázCﬁ[i] : "", i<
nArg
-1);

820 
	`Ârötf
(
p
->
out
,"\n");

822 if–
azArg
==0 ) ;

823 
i
=0; i<
nArg
; i++){

824 
	`ouçut_csv
(
p
, 
azArg
[
i
], i<
nArg
-1);

826 
	`Ârötf
(
p
->
out
,"\n");

829 
MODE_In£π
: {

830 
p
->
˙t
++;

831 if–
azArg
==0 ) ;

832 
	`Ârötf
(
p
->
out
,"INSERT INTO %†VALUES(",p->
zDe°TabÀ
);

833 
i
=0; i<
nArg
; i++){

834 *
zSï
 = 
i
>0 ? ",": "";

835 if–(
azArg
[
i
]==0Ë|| (
aiTy≥
 &&áiTy≥[i]==
SQLITE_NULL
) ){

836 
	`Ârötf
(
p
->
out
,"%sNULL",
zSï
);

837 }if–
aiTy≥
 &&áiTy≥[
i
]==
SQLITE_TEXT
 ){

838 if–
zSï
[0] ) 
	`Ârötf
(
p
->
out
,"%s",zSep);

839 
	`ouçut_quŸed_°rög
(
p
->
out
, 
azArg
[
i
]);

840 }if–
aiTy≥
 && (aiTy≥[
i
]==
SQLITE_INTEGER
 ||áiTy≥[i]==
SQLITE_FLOAT
) ){

841 
	`Ârötf
(
p
->
out
,"%s%s",
zSï
, 
azArg
[
i
]);

842 }if–
aiTy≥
 &&áiTy≥[
i
]==
SQLITE_BLOB
 && 
p
->
pStmt
 ){

843 c⁄° *
pBlob
 = 
	`sqlôe3_cﬁumn_blob
(
p
->
pStmt
, 
i
);

844 
nBlob
 = 
	`sqlôe3_cﬁumn_byãs
(
p
->
pStmt
, 
i
);

845 if–
zSï
[0] ) 
	`Ârötf
(
p
->
out
,"%s",zSep);

846 
	`ouçut_hex_blob
(
p
->
out
, 
pBlob
, 
nBlob
);

847 }if–
	`isNumbî
(
azArg
[
i
], 0) ){

848 
	`Ârötf
(
p
->
out
,"%s%s",
zSï
, 
azArg
[
i
]);

850 if–
zSï
[0] ) 
	`Ârötf
(
p
->
out
,"%s",zSep);

851 
	`ouçut_quŸed_°rög
(
p
->
out
, 
azArg
[
i
]);

854 
	`Ârötf
(
p
->
out
,");\n");

859 
	}
}

865 
	$ˇŒback
(*
pArg
, 
nArg
, **
azArg
, **
azCﬁ
){

867  
	`shñl_ˇŒback
(
pArg
, 
nArg
, 
azArg
, 
azCﬁ
, 
NULL
);

868 
	}
}

875 
	$£t_èbÀ_«me
(
ˇŒback_d©a
 *
p
, c⁄° *
zName
){

876 
i
, 
n
;

877 
√edQuŸe
;

878 *
z
;

880 if–
p
->
zDe°TabÀ
 ){

881 
	`‰ì
(
p
->
zDe°TabÀ
);

882 
p
->
zDe°TabÀ
 = 0;

884 if–
zName
==0 ) ;

885 
√edQuŸe
 = !
	`ißÕha
(()*
zName
) && *zName!='_';

886 
i
=
n
=0; 
zName
[i]; i++,Ç++){

887 if–!
	`iß um
(()
zName
[
i
]) && zName[i]!='_' ){

888 
√edQuŸe
 = 1;

889 if–
zName
[
i
]=='\'' ) 
n
++;

892 if–
√edQuŸe
 ) 
n
 += 2;

893 
z
 = 
p
->
zDe°TabÀ
 = 
	`mÆloc
–
n
+1 );

894 if–
z
==0 ){

895 
	`Ârötf
(
°dîr
,"Error: out of memory\n");

896 
	`exô
(1);

898 
n
 = 0;

899 if–
√edQuŸe
 ) 
z
[
n
++] = '\'';

900 
i
=0; 
zName
[i]; i++){

901 
z
[
n
++] = 
zName
[
i
];

902 if–
zName
[
i
]=='\'' ) 
z
[
n
++] = '\'';

904 if–
√edQuŸe
 ) 
z
[
n
++] = '\'';

905 
z
[
n
] = 0;

906 
	}
}

916 *
	$≠≥ndText
(*
zIn
, c⁄° *
zAµíd
, 
quŸe
){

917 
Àn
;

918 
i
;

919 
nAµíd
 = 
	`°æí30
(
zAµíd
);

920 
nIn
 = (
zIn
?
	`°æí30
(zIn):0);

922 
Àn
 = 
nAµíd
+
nIn
+1;

923 if–
quŸe
 ){

924 
Àn
 += 2;

925 
i
=0; i<
nAµíd
; i++){

926 if–
zAµíd
[
i
]==
quŸe
 ) 
Àn
++;

930 
zIn
 = (*)
	`ªÆloc
(zIn, 
Àn
);

931 if–!
zIn
 ){

935 if–
quŸe
 ){

936 *
zC§
 = &
zIn
[
nIn
];

937 *
zC§
++ = 
quŸe
;

938 
i
=0; i<
nAµíd
; i++){

939 *
zC§
++ = 
zAµíd
[
i
];

940 if–
zAµíd
[
i
]==
quŸe
 ) *
zC§
++ = quote;

942 *
zC§
++ = 
quŸe
;

943 *
zC§
++ = '\0';

944 
	`as£π
–(
zC§
-
zIn
)==
Àn
 );

946 
	`mem˝y
(&
zIn
[
nIn
], 
zAµíd
, 
nAµíd
);

947 
zIn
[
Àn
-1] = '\0';

950  
zIn
;

951 
	}
}

964 
	$run_èbÀ_dump_quîy
(

965 
ˇŒback_d©a
 *
p
,

966 c⁄° *
zSñe˘
,

967 c⁄° *
zFú°Row


969 
sqlôe3_°mt
 *
pSñe˘
;

970 
rc
;

971 
nResu…
;

972 
i
;

973 c⁄° *
z
;

974 
rc
 = 
	`sqlôe3_¥ï¨e
(
p
->
db
, 
zSñe˘
, -1, &
pSñe˘
, 0);

975 if–
rc
!=
SQLITE_OK
 || !
pSñe˘
 ){

976 
	`Ârötf
(
p
->
out
, "/**** ERROR: (%dË%†*****/\n", 
rc
, 
	`sqlôe3_îrmsg
’->
db
));

977 if–(
rc
&0xff)!=
SQLITE_CORRUPT
 ) 
p
->
nEº
++;

978  
rc
;

980 
rc
 = 
	`sqlôe3_°ï
(
pSñe˘
);

981 
nResu…
 = 
	`sqlôe3_cﬁumn_cou¡
(
pSñe˘
);

982  
rc
==
SQLITE_ROW
 ){

983 if–
zFú°Row
 ){

984 
	`Ârötf
(
p
->
out
, "%s", 
zFú°Row
);

985 
zFú°Row
 = 0;

987 
z
 = (c⁄° *)
	`sqlôe3_cﬁumn_ãxt
(
pSñe˘
, 0);

988 
	`Ârötf
(
p
->
out
, "%s", 
z
);

989 
i
=1; i<
nResu…
; i++){

990 
	`Ârötf
(
p
->
out
, ",%s", 
	`sqlôe3_cﬁumn_ãxt
(
pSñe˘
, 
i
));

992 if–
z
==0 ) z = "";

993  
z
[0] && (z[0]!='-' || z[1]!='-') ) z++;

994 if–
z
[0] ){

995 
	`Ârötf
(
p
->
out
, "\n;\n");

997 
	`Ârötf
(
p
->
out
, ";\n");

999 
rc
 = 
	`sqlôe3_°ï
(
pSñe˘
);

1001 
rc
 = 
	`sqlôe3_föÆize
(
pSñe˘
);

1002 if–
rc
!=
SQLITE_OK
 ){

1003 
	`Ârötf
(
p
->
out
, "/**** ERROR: (%dË%†*****/\n", 
rc
, 
	`sqlôe3_îrmsg
’->
db
));

1004 if–(
rc
&0xff)!=
SQLITE_CORRUPT
 ) 
p
->
nEº
++;

1006  
rc
;

1007 
	}
}

1012 *
	$ßve_îr_msg
(

1013 
sqlôe3
 *
db


1015 
nEºMsg
 = 1+
	`°æí30
(
	`sqlôe3_îrmsg
(
db
));

1016 *
zEºMsg
 = 
	`sqlôe3_mÆloc
(
nEºMsg
);

1017 if–
zEºMsg
 ){

1018 
	`mem˝y
(
zEºMsg
, 
	`sqlôe3_îrmsg
(
db
), 
nEºMsg
);

1020  
zEºMsg
;

1021 
	}
}

1026 
	$di•œy_°©s
(

1027 
sqlôe3
 *
db
,

1028 
ˇŒback_d©a
 *
pArg
,

1029 
bRe£t


1031 
iCur
;

1032 
iHiwå
;

1034 if–
pArg
 &&ÖArg->
out
 ){

1036 
iHiwå
 = 
iCur
 = -1;

1037 
	`sqlôe3_°©us
(
SQLITE_STATUS_MEMORY_USED
, &
iCur
, &
iHiwå
, 
bRe£t
);

1038 
	`Ârötf
(
pArg
->
out
, "Mem‹y U£d: %d (max %dËbyãs\n", 
iCur
, 
iHiwå
);

1039 
iHiwå
 = 
iCur
 = -1;

1040 
	`sqlôe3_°©us
(
SQLITE_STATUS_MALLOC_COUNT
, &
iCur
, &
iHiwå
, 
bRe£t
);

1041 
	`Ârötf
(
pArg
->
out
, "Numbî o‡Out°™dög AŒoˇti⁄s: %d (max %d)\n", 
iCur
, 
iHiwå
);

1048 
iHiwå
 = 
iCur
 = -1;

1049 
	`sqlôe3_°©us
(
SQLITE_STATUS_PAGECACHE_OVERFLOW
, &
iCur
, &
iHiwå
, 
bRe£t
);

1050 
	`Ârötf
(
pArg
->
out
, "Numbî o‡PˇchêOvîÊow Byãs: %d (max %dËbyãs\n", 
iCur
, 
iHiwå
);

1057 
iHiwå
 = 
iCur
 = -1;

1058 
	`sqlôe3_°©us
(
SQLITE_STATUS_SCRATCH_OVERFLOW
, &
iCur
, &
iHiwå
, 
bRe£t
);

1059 
	`Ârötf
(
pArg
->
out
, "Numbî o‡S¸©ch OvîÊow Byãs: %d (max %dËbyãs\n", 
iCur
, 
iHiwå
);

1060 
iHiwå
 = 
iCur
 = -1;

1061 
	`sqlôe3_°©us
(
SQLITE_STATUS_MALLOC_SIZE
, &
iCur
, &
iHiwå
, 
bRe£t
);

1062 
	`Ârötf
(
pArg
->
out
, "L¨ge° AŒoˇti⁄: %d byãs\n", 
iHiwå
);

1063 
iHiwå
 = 
iCur
 = -1;

1064 
	`sqlôe3_°©us
(
SQLITE_STATUS_PAGECACHE_SIZE
, &
iCur
, &
iHiwå
, 
bRe£t
);

1065 
	`Ârötf
(
pArg
->
out
, "L¨ge° PˇchêAŒoˇti⁄: %d byãs\n", 
iHiwå
);

1066 
iHiwå
 = 
iCur
 = -1;

1067 
	`sqlôe3_°©us
(
SQLITE_STATUS_SCRATCH_SIZE
, &
iCur
, &
iHiwå
, 
bRe£t
);

1068 
	`Ârötf
(
pArg
->
out
, "L¨ge° S¸©ch AŒoˇti⁄: %d byãs\n", 
iHiwå
);

1069 #ifde‡
YYTRACKMAXSTACKDEPTH


1070 
iHiwå
 = 
iCur
 = -1;

1071 
	`sqlôe3_°©us
(
SQLITE_STATUS_PARSER_STACK
, &
iCur
, &
iHiwå
, 
bRe£t
);

1072 
	`Ârötf
(
pArg
->
out
, "Dì≥° P¨£∏Sèck: %d (max %d)\n", 
iCur
, 
iHiwå
);

1076 if–
pArg
 &&ÖArg->
out
 && 
db
 ){

1077 
iHiwå
 = 
iCur
 = -1;

1078 
	`sqlôe3_db_°©us
(
db
, 
SQLITE_DBSTATUS_LOOKASIDE_USED
, &
iCur
, &
iHiwå
, 
bRe£t
);

1079 
	`Ârötf
(
pArg
->
out
, "LookasidêSlŸ†U£d: %d (max %d)\n", 
iCur
, 
iHiwå
);

1080 
	`sqlôe3_db_°©us
(
db
, 
SQLITE_DBSTATUS_LOOKASIDE_HIT
, &
iCur
, &
iHiwå
, 
bRe£t
);

1081 
	`Ârötf
(
pArg
->
out
, "Suc˚ssfu»lookasidê©ãm±s: %d\n", 
iHiwå
);

1082 
	`sqlôe3_db_°©us
(
db
, 
SQLITE_DBSTATUS_LOOKASIDE_MISS_SIZE
, &
iCur
, &
iHiwå
, 
bRe£t
);

1083 
	`Ârötf
(
pArg
->
out
, "LookasidêÁûuª†duêtÿsize: %d\n", 
iHiwå
);

1084 
	`sqlôe3_db_°©us
(
db
, 
SQLITE_DBSTATUS_LOOKASIDE_MISS_FULL
, &
iCur
, &
iHiwå
, 
bRe£t
);

1085 
	`Ârötf
(
pArg
->
out
, "LookasidêÁûuª†duêtÿOOM: %d\n", 
iHiwå
);

1086 
iHiwå
 = 
iCur
 = -1;

1087 
	`sqlôe3_db_°©us
(
db
, 
SQLITE_DBSTATUS_CACHE_USED
, &
iCur
, &
iHiwå
, 
bRe£t
);

1088 
	`Ârötf
(
pArg
->
out
, "Pagî Hó∞Ußge: %d byãs\n", 
iCur
); 
iHiwå
 = iCur = -1;

1089 
	`sqlôe3_db_°©us
(
db
, 
SQLITE_DBSTATUS_CACHE_HIT
, &
iCur
, &
iHiwå
, 1);

1090 
	`Ârötf
(
pArg
->
out
, "Pagêˇchêhôs: %d\n", 
iCur
);

1091 
iHiwå
 = 
iCur
 = -1;

1092 
	`sqlôe3_db_°©us
(
db
, 
SQLITE_DBSTATUS_CACHE_MISS
, &
iCur
, &
iHiwå
, 1);

1093 
	`Ârötf
(
pArg
->
out
, "Pagêˇchêmis£s: %d\n", 
iCur
);

1094 
iHiwå
 = 
iCur
 = -1;

1095 
	`sqlôe3_db_°©us
(
db
, 
SQLITE_DBSTATUS_CACHE_WRITE
, &
iCur
, &
iHiwå
, 1);

1096 
	`Ârötf
(
pArg
->
out
, "Pagêˇchêwrôes: %d\n", 
iCur
);

1097 
iHiwå
 = 
iCur
 = -1;

1098 
	`sqlôe3_db_°©us
(
db
, 
SQLITE_DBSTATUS_SCHEMA_USED
, &
iCur
, &
iHiwå
, 
bRe£t
);

1099 
	`Ârötf
(
pArg
->
out
, "Schem®Hó∞Ußge: %d byãs\n", 
iCur
);

1100 
iHiwå
 = 
iCur
 = -1;

1101 
	`sqlôe3_db_°©us
(
db
, 
SQLITE_DBSTATUS_STMT_USED
, &
iCur
, &
iHiwå
, 
bRe£t
);

1102 
	`Ârötf
(
pArg
->
out
, "SèãmíàHóp/LookasidêUßge: %d byãs\n", 
iCur
);

1105 if–
pArg
 &&ÖArg->
out
 && 
db
 &&ÖArg->
pStmt
 ){

1106 
iCur
 = 
	`sqlôe3_°mt_°©us
(
pArg
->
pStmt
, 
SQLITE_STMTSTATUS_FULLSCAN_STEP
, 
bRe£t
);

1107 
	`Ârötf
(
pArg
->
out
, "FuŒsˇ¿Sãps: %d\n", 
iCur
);

1108 
iCur
 = 
	`sqlôe3_°mt_°©us
(
pArg
->
pStmt
, 
SQLITE_STMTSTATUS_SORT
, 
bRe£t
);

1109 
	`Ârötf
(
pArg
->
out
, "S‹àO≥øti⁄s: %d\n", 
iCur
);

1110 
iCur
 = 
	`sqlôe3_°mt_°©us
(
pArg
->
pStmt
, 
SQLITE_STMTSTATUS_AUTOINDEX
, 
bRe£t
);

1111 
	`Ârötf
(
pArg
->
out
, "Autoödex In£πs: %d\n", 
iCur
);

1112 
iCur
 = 
	`sqlôe3_°mt_°©us
(
pArg
->
pStmt
, 
SQLITE_STMTSTATUS_VM_STEP
, 
bRe£t
);

1113 
	`Ârötf
(
pArg
->
out
, "VútuÆ MachöêSãps: %d\n", 
iCur
);

1117 
	}
}

1128 
shñl_exec
(

1129 
sqlôe3
 *
db
,

1130 c⁄° *
zSql
,

1131 (*
xCÆlback
)(*,,**,**,*),

1133 
ˇŒback_d©a
 *
pArg
,

1134 **
pzEºMsg


1136 
sqlôe3_°mt
 *
pStmt
 = 
NULL
;

1137 
rc
 = 
SQLITE_OK
;

1138 
rc2
;

1139 c⁄° *
zLe·ovî
;

1141 if–
pzEºMsg
 ){

1142 *
pzEºMsg
 = 
NULL
;

1145  
zSql
[0] && (
SQLITE_OK
 =
rc
) ){

1146 
rc
 = 
	`sqlôe3_¥ï¨e_v2
(
db
, 
zSql
, -1, &
pStmt
, &
zLe·ovî
);

1147 if–
SQLITE_OK
 !
rc
 ){

1148 if–
pzEºMsg
 ){

1149 *
pzEºMsg
 = 
	`ßve_îr_msg
(
db
);

1152 if–!
pStmt
 ){

1154 
zSql
 = 
zLe·ovî
;

1155  
	`IsS∑˚
(
zSql
[0]) ) zSql++;

1160 if–
pArg
 ){

1161 
pArg
->
pStmt
 =ÖStmt;

1162 
pArg
->
˙t
 = 0;

1166 if–
pArg
 &&ÖArg->
echoOn
 ){

1167 c⁄° *
zStmtSql
 = 
	`sqlôe3_sql
(
pStmt
);

1168 
	`Ârötf
(
pArg
->
out
, "%s\n", 
zStmtSql
 ? zStmtSq»: 
zSql
);

1172 if–
pArg
 &&ÖArg->
mode
==
MODE_Ex∂aö
 ){

1173 c⁄° *
zEx∂aö
 = 0;

1174 
	`sqlôe3_ã°_c⁄åﬁ
(
SQLITE_TESTCTRL_EXPLAIN_STMT
, 
pStmt
, &
zEx∂aö
);

1175 if–
zEx∂aö
 && zExplain[0] ){

1176 
	`Ârötf
(
pArg
->
out
, "%s", 
zEx∂aö
);

1183 
rc
 = 
	`sqlôe3_°ï
(
pStmt
);

1185 if–
SQLITE_ROW
 =
rc
 ){

1187 if–
xCÆlback
 ){

1189 
nCﬁ
 = 
	`sqlôe3_cﬁumn_cou¡
(
pStmt
);

1190 *
pD©a
 = 
	`sqlôe3_mÆloc
(3*
nCﬁ
*(const *) + 1);

1191 if–!
pD©a
 ){

1192 
rc
 = 
SQLITE_NOMEM
;

1194 **
azCﬁs
 = (**)
pD©a
;

1195 **
azVÆs
 = &
azCﬁs
[
nCﬁ
];

1196 *
aiTy≥s
 = (*)&
azVÆs
[
nCﬁ
];

1197 
i
, 
x
;

1198 
	`as£π
(() <= (*));

1200 
i
=0; i<
nCﬁ
; i++){

1201 
azCﬁs
[
i
] = (*)
	`sqlôe3_cﬁumn_«me
(
pStmt
, i);

1205 
i
=0; i<
nCﬁ
; i++){

1206 
aiTy≥s
[
i
] = 
x
 = 
	`sqlôe3_cﬁumn_ty≥
(
pStmt
, i);

1207 if–
x
==
SQLITE_BLOB
 && 
pArg
 &&ÖArg->
mode
==
MODE_In£π
 ){

1208 
azVÆs
[
i
] = "";

1210 
azVÆs
[
i
] = (*)
	`sqlôe3_cﬁumn_ãxt
(
pStmt
, i);

1212 if–!
azVÆs
[
i
] && (
aiTy≥s
[i]!=
SQLITE_NULL
) ){

1213 
rc
 = 
SQLITE_NOMEM
;

1219 if–
SQLITE_ROW
 =
rc
 ){

1221 if–
	`xCÆlback
(
pArg
, 
nCﬁ
, 
azVÆs
, 
azCﬁs
, 
aiTy≥s
) ){

1222 
rc
 = 
SQLITE_ABORT
;

1224 
rc
 = 
	`sqlôe3_°ï
(
pStmt
);

1227 }  
SQLITE_ROW
 =
rc
 );

1228 
	`sqlôe3_‰ì
(
pD©a
);

1232 
rc
 = 
	`sqlôe3_°ï
(
pStmt
);

1233 }  
rc
 =
SQLITE_ROW
 );

1238 if–
pArg
 &&ÖArg->
°©sOn
 ){

1239 
	`di•œy_°©s
(
db
, 
pArg
, 0);

1245 
rc2
 = 
	`sqlôe3_föÆize
(
pStmt
);

1246 if–
rc
!=
SQLITE_NOMEM
 )Ñ¯
rc2
;

1247 if–
rc
==
SQLITE_OK
 ){

1248 
zSql
 = 
zLe·ovî
;

1249  
	`IsS∑˚
(
zSql
[0]) ) zSql++;

1250 }if–
pzEºMsg
 ){

1251 *
pzEºMsg
 = 
	`ßve_îr_msg
(
db
);

1255 if–
pArg
 ){

1256 
pArg
->
pStmt
 = 
NULL
;

1261  
rc
;

1262 
	}
}

1271 
	$dump_ˇŒback
(*
pArg
, 
nArg
, **
azArg
, **
azCﬁ
){

1272 
rc
;

1273 c⁄° *
zTabÀ
;

1274 c⁄° *
zTy≥
;

1275 c⁄° *
zSql
;

1276 c⁄° *
zPªpStmt
 = 0;

1277 
ˇŒback_d©a
 *
p
 = (ˇŒback_d©®*)
pArg
;

1279 
	`UNUSED_PARAMETER
(
azCﬁ
);

1280 if–
nArg
!=3 )  1;

1281 
zTabÀ
 = 
azArg
[0];

1282 
zTy≥
 = 
azArg
[1];

1283 
zSql
 = 
azArg
[2];

1285 if–
	`°rcmp
(
zTabÀ
, "sqlite_sequence")==0 ){

1286 
zPªpStmt
 = "DELETE FROM sqlite_sequence;\n";

1287 }if–
	`sqlôe3_°rglob
("sqlôe_°©?", 
zTabÀ
)==0 ){

1288 
	`Ârötf
(
p
->
out
, "ANALYZE sqlite_master;\n");

1289 }if–
	`°∫cmp
(
zTabÀ
, "sqlite_", 7)==0 ){

1291 }if–
	`°∫cmp
(
zSql
, "CREATE VIRTUAL TABLE", 20)==0 ){

1292 *
zIns
;

1293 if–!
p
->
wrôabÀSchema
 ){

1294 
	`Ârötf
(
p
->
out
, "PRAGMA writable_schema=ON;\n");

1295 
p
->
wrôabÀSchema
 = 1;

1297 
zIns
 = 
	`sqlôe3_m¥ötf
(

1300 
zTabÀ
, zTabÀ, 
zSql
);

1301 
	`Ârötf
(
p
->
out
, "%s\n", 
zIns
);

1302 
	`sqlôe3_‰ì
(
zIns
);

1305 
	`Ârötf
(
p
->
out
, "%s;\n", 
zSql
);

1308 if–
	`°rcmp
(
zTy≥
, "table")==0 ){

1309 
sqlôe3_°mt
 *
pTabÀInfo
 = 0;

1310 *
zSñe˘
 = 0;

1311 *
zTabÀInfo
 = 0;

1312 *
zTmp
 = 0;

1313 
nRow
 = 0;

1315 
zTabÀInfo
 = 
	`≠≥ndText
(zTableInfo, "PRAGMAÅable_info(", 0);

1316 
zTabÀInfo
 = 
	`≠≥ndText
(zTabÀInfo, 
zTabÀ
, '"');

1317 
zTabÀInfo
 = 
	`≠≥ndText
(zTableInfo, ");", 0);

1319 
rc
 = 
	`sqlôe3_¥ï¨e
(
p
->
db
, 
zTabÀInfo
, -1, &
pTabÀInfo
, 0);

1320 
	`‰ì
(
zTabÀInfo
);

1321 if–
rc
!=
SQLITE_OK
 || !
pTabÀInfo
 ){

1325 
zSñe˘
 = 
	`≠≥ndText
(zSelect, "SELECT 'INSERT INTO ' || ", 0);

1328 
zTmp
 = 
	`≠≥ndText
(zTmp, 
zTabÀ
, '"');

1329 if–
zTmp
 ){

1330 
zSñe˘
 = 
	`≠≥ndText
(zSñe˘, 
zTmp
, '\'');

1331 
	`‰ì
(
zTmp
);

1333 
zSñe˘
 = 
	`≠≥ndText
(zSelect, " || ' VALUES(' || ", 0);

1334 
rc
 = 
	`sqlôe3_°ï
(
pTabÀInfo
);

1335  
rc
==
SQLITE_ROW
 ){

1336 c⁄° *
zText
 = (c⁄° *)
	`sqlôe3_cﬁumn_ãxt
(
pTabÀInfo
, 1);

1337 
zSñe˘
 = 
	`≠≥ndText
(zSelect, "quote(", 0);

1338 
zSñe˘
 = 
	`≠≥ndText
(zSñe˘, 
zText
, '"');

1339 
rc
 = 
	`sqlôe3_°ï
(
pTabÀInfo
);

1340 if–
rc
==
SQLITE_ROW
 ){

1341 
zSñe˘
 = 
	`≠≥ndText
(zSelect, "), ", 0);

1343 
zSñe˘
 = 
	`≠≥ndText
(zSelect, ") ", 0);

1345 
nRow
++;

1347 
rc
 = 
	`sqlôe3_föÆize
(
pTabÀInfo
);

1348 if–
rc
!=
SQLITE_OK
 || 
nRow
==0 ){

1349 
	`‰ì
(
zSñe˘
);

1352 
zSñe˘
 = 
	`≠≥ndText
(zSelect, "|| ')' FROM ", 0);

1353 
zSñe˘
 = 
	`≠≥ndText
(zSñe˘, 
zTabÀ
, '"');

1355 
rc
 = 
	`run_èbÀ_dump_quîy
(
p
, 
zSñe˘
, 
zPªpStmt
);

1356 if–
rc
==
SQLITE_CORRUPT
 ){

1357 
zSñe˘
 = 
	`≠≥ndText
(zSelect, " ORDER BYÑowid DESC", 0);

1358 
	`run_èbÀ_dump_quîy
(
p
, 
zSñe˘
, 0);

1360 
	`‰ì
(
zSñe˘
);

1363 
	}
}

1372 
	$run_schema_dump_quîy
(

1373 
ˇŒback_d©a
 *
p
,

1374 c⁄° *
zQuîy


1376 
rc
;

1377 *
zEº
 = 0;

1378 
rc
 = 
	`sqlôe3_exec
(
p
->
db
, 
zQuîy
, 
dump_ˇŒback
,Ö, &
zEº
);

1379 if–
rc
==
SQLITE_CORRUPT
 ){

1380 *
zQ2
;

1381 
Àn
 = 
	`°æí30
(
zQuîy
);

1382 
	`Ârötf
(
p
->
out
, "/****** CORRUPTION ERROR *******/\n");

1383 if–
zEº
 ){

1384 
	`Ârötf
(
p
->
out
, "/****** %†******/\n", 
zEº
);

1385 
	`sqlôe3_‰ì
(
zEº
);

1386 
zEº
 = 0;

1388 
zQ2
 = 
	`mÆloc
–
Àn
+100 );

1389 if–
zQ2
==0 )  
rc
;

1390 
	`sqlôe3_¢¥ötf
(
Àn
+100, 
zQ2
, "%†ORDER BYÑowid DESC", 
zQuîy
);

1391 
rc
 = 
	`sqlôe3_exec
(
p
->
db
, 
zQ2
, 
dump_ˇŒback
,Ö, &
zEº
);

1392 if–
rc
 ){

1393 
	`Ârötf
(
p
->
out
, "/****** ERROR: %†******/\n", 
zEº
);

1395 
rc
 = 
SQLITE_CORRUPT
;

1397 
	`sqlôe3_‰ì
(
zEº
);

1398 
	`‰ì
(
zQ2
);

1400  
rc
;

1401 
	}
}

1406 
	gzHñp
[] =

1423 #ifde‡
SQLITE_ENABLE_IOTRACE


1426 #i‚de‡
SQLITE_OMIT_LOAD_EXTENSION


1462 
	gzTimîHñp
[] =

1467 
¥o˚ss_öput
(
ˇŒback_d©a
 *
p
, 
FILE
 *
ö
);

1473 
	$›í_db
(
ˇŒback_d©a
 *
p
){

1474 if–
p
->
db
==0 ){

1475 
	`sqlôe3_öôülize
();

1476 
	`sqlôe3_›í
(
p
->
zDbFûíame
, &p->
db
);

1477 
db
 = 
p
->db;

1478 if–
db
 && 
	`sqlôe3_îrcode
(db)==
SQLITE_OK
 ){

1479 
	`sqlôe3_¸óã_fun˘i⁄
(
db
, "shñl°©ic", 0, 
SQLITE_UTF8
, 0,

1480 
shñl°©icFunc
, 0, 0);

1482 if–
db
==0 || 
SQLITE_OK
!=
	`sqlôe3_îrcode
(db) ){

1483 
	`Ârötf
(
°dîr
,"Error: unableÅo open database \"%s\": %s\n",

1484 
p
->
zDbFûíame
, 
	`sqlôe3_îrmsg
(
db
));

1485 
	`exô
(1);

1487 #i‚de‡
SQLITE_OMIT_LOAD_EXTENSION


1488 
	`sqlôe3_íabÀ_lﬂd_exãnsi⁄
(
p
->
db
, 1);

1491 
	}
}

1503 
	$ªsﬁve_back¶ashes
(*
z
){

1504 
i
, 
j
;

1505 
c
;

1506 
i
=
j
=0; (
c
 = 
z
[i])!=0; i++, j++){

1507 if–
c
=='\\' ){

1508 
c
 = 
z
[++
i
];

1509 if–
c
=='n' ){

1510 
c
 = '\n';

1511 }if–
c
=='t' ){

1512 
c
 = '\t';

1513 }if–
c
=='r' ){

1514 
c
 = '\r';

1515 }if–
c
=='\\' ){

1516 
c
 = '\\';

1517 }if–
c
>='0' && c<='7' ){

1518 
c
 -= '0';

1519 if–
z
[
i
+1]>='0' && z[i+1]<='7' ){

1520 
i
++;

1521 
c
 = (c<<3Ë+ 
z
[
i
] - '0';

1522 if–
z
[
i
+1]>='0' && z[i+1]<='7' ){

1523 
i
++;

1524 
c
 = (c<<3Ë+ 
z
[
i
] - '0';

1529 
z
[
j
] = 
c
;

1531 
z
[
j
] = 0;

1532 
	}
}

1538 
	$hexDigôVÆue
(
c
){

1539 if–
c
>='0' && c<='9' )  c - '0';

1540 if–
c
>='a' && c<='f' )  c - 'a' + 10;

1541 if–
c
>='A' && c<='F' )  c - 'A' + 10;

1543 
	}
}

1548 
sqlôe3_öt64
 
	$öãgîVÆue
(c⁄° *
zArg
){

1549 
sqlôe3_öt64
 
v
 = 0;

1550 c⁄° såu˘ { *
zSuffix
; 
iMu…
; } 
aMu…
[] = {

1561 
i
;

1562 
isNeg
 = 0;

1563 if–
zArg
[0]=='-' ){

1564 
isNeg
 = 1;

1565 
zArg
++;

1566 }if–
zArg
[0]=='+' ){

1567 
zArg
++;

1569 if–
zArg
[0]=='0' && zArg[1]=='x' ){

1570 
x
;

1571 
zArg
 += 2;

1572  (
x
 = 
	`hexDigôVÆue
(
zArg
[0]))>=0 ){

1573 
v
 = (v<<4Ë+ 
x
;

1574 
zArg
++;

1577  
	`IsDigô
(
zArg
[0]) ){

1578 
v
 = v*10 + 
zArg
[0] - '0';

1579 
zArg
++;

1582 
i
=0; i<
	`AºaySize
(
aMu…
); i++){

1583 if–
	`sqlôe3_°ricmp
(
aMu…
[
i
].
zSuffix
, 
zArg
)==0 ){

1584 
v
 *
aMu…
[
i
].
iMu…
;

1588  
isNeg
? -
v
 : v;

1589 
	}
}

1595 
	$boﬁónVÆue
(*
zArg
){

1596 
i
;

1597 if–
zArg
[0]=='0' && zArg[1]=='x' ){

1598 
i
=2; 
	`hexDigôVÆue
(
zArg
[i])>=0; i++){}

1600 
i
=0; 
zArg
[i]>='0' && zArg[i]<='9'; i++){}

1602 if–
i
>0 && 
zArg
[i]==0 )  ()(
	`öãgîVÆue
(zArg) & 0xffffffff);

1603 if–
	`sqlôe3_°ricmp
(
zArg
, "on")==0 || sqlite3_stricmp(zArg,"yes")==0 ){

1606 if–
	`sqlôe3_°ricmp
(
zArg
, "off")==0 || sqlite3_stricmp(zArg,"no")==0 ){

1609 
	`Ârötf
(
°dîr
, "ERROR: Notá boolean value: \"%s\". Assuming \"no\".\n",

1610 
zArg
);

1612 
	}
}

1617 
	$ouçut_fûe_˛o£
(
FILE
 *
f
){

1618 if–
f
 && f!=
°dout
 && f!=
°dîr
 ) 
	`f˛o£
(f);

1619 
	}
}

1626 
FILE
 *
	$ouçut_fûe_›í
(c⁄° *
zFûe
){

1627 
FILE
 *
f
;

1628 if–
	`°rcmp
(
zFûe
,"stdout")==0 ){

1629 
f
 = 
°dout
;

1630 }if–
	`°rcmp
(
zFûe
, "stderr")==0 ){

1631 
f
 = 
°dîr
;

1632 }if–
	`°rcmp
(
zFûe
, "off")==0 ){

1633 
f
 = 0;

1635 
f
 = 
	`f›í
(
zFûe
, "wb");

1636 if–
f
==0 ){

1637 
	`Ârötf
(
°dîr
, "Eº‹: c™nŸ o≥¿\"%s\"\n", 
zFûe
);

1640  
f
;

1641 
	}
}

1646 
	$sql_åa˚_ˇŒback
(*
pArg
, c⁄° *
z
){

1647 
FILE
 *
f
 = (FILE*)
pArg
;

1648 if–
f
 ) 
	`Ârötf
(f, "%s\n", 
z
);

1649 
	}
}

1655 
	$ã°_bªakpoöt
(){

1656 
nCÆl
 = 0;

1657 
nCÆl
++;

1658 
	}
}

1663 
CSVRódî
 
	tCSVRódî
;

1664 
	sCSVRódî
 {

1665 c⁄° *
	mzFûe
;

1666 
FILE
 *
	mö
;

1667 *
	mz
;

1668 
	mn
;

1669 
	mnAŒoc
;

1670 
	mnLöe
;

1671 
	mcTîm
;

1672 
	mcSï¨©‹
;

1676 
	$csv_≠≥nd_ch¨
(
CSVRódî
 *
p
, 
c
){

1677 if–
p
->
n
+1>ı->
nAŒoc
 ){

1678 
p
->
nAŒoc
 +=Ö->nAlloc + 100;

1679 
p
->
z
 = 
	`sqlôe3_ªÆloc
’->z,Ö->
nAŒoc
);

1680 if–
p
->
z
==0 ){

1681 
	`Ârötf
(
°dîr
, "out of memory\n");

1682 
	`exô
(1);

1685 
p
->
z
[p->
n
++] = ()
c
;

1686 
	}
}

1700 *
	$csv_ªad_⁄e_fõld
(
CSVRódî
 *
p
){

1701 
c
, 
pc
;

1702 
cSï
 = 
p
->
cSï¨©‹
;

1703 
p
->
n
 = 0;

1704 
c
 = 
	`fgëc
(
p
->
ö
);

1705 if–
c
==
EOF
 || 
£íI¡îru±
 ){

1706 
p
->
cTîm
 = 
EOF
;

1709 if–
c
=='"' ){

1710 
°¨tLöe
 = 
p
->
nLöe
;

1711 
cQuŸe
 = 
c
;

1712 
pc
 = 0;

1714 
c
 = 
	`fgëc
(
p
->
ö
);

1715 if–
c
=='\n' ) 
p
->
nLöe
++;

1716 if–
c
==
cQuŸe
 ){

1717 if–
pc
==
cQuŸe
 ){

1718 
pc
 = 0;

1722 if–(
c
==
cSï
 && 
pc
==
cQuŸe
)

1723 || (
c
=='\n' && 
pc
==
cQuŸe
)

1724 || (
c
=='\n' && 
pc
=='\r' && 
p
->
n
>=2 &&Ö->
z
[p->n-2]==
cQuŸe
)

1725 || (
c
==
EOF
 && 
pc
==
cQuŸe
)

1727 do{ 
p
->
n
--; }Ö->
z
[p->n]!=
cQuŸe
 );

1728 
p
->
cTîm
 = 
c
;

1731 if–
pc
==
cQuŸe
 && 
c
!='\r' ){

1732 
	`Ârötf
(
°dîr
, "%s:%d: unescaped %c character\n",

1733 
p
->
zFûe
,Ö->
nLöe
, 
cQuŸe
);

1735 if–
c
==
EOF
 ){

1736 
	`Ârötf
(
°dîr
, "%s:%d: unterminated %c-quoted field\n",

1737 
p
->
zFûe
, 
°¨tLöe
, 
cQuŸe
);

1738 
p
->
cTîm
 = 
EOF
;

1741 
	`csv_≠≥nd_ch¨
(
p
, 
c
);

1742 
pc
 = 
c
;

1745  
c
!=
EOF
 && c!=
cSï
 && c!='\n' ){

1746 
	`csv_≠≥nd_ch¨
(
p
, 
c
);

1747 
c
 = 
	`fgëc
(
p
->
ö
);

1749 if–
c
=='\n' ){

1750 
p
->
nLöe
++;

1751 if–
p
->
n
>1 &&Ö->
z
[p->n-1]=='\r' )Ö->n--;

1753 
p
->
cTîm
 = 
c
;

1755 if–
p
->
z
 )Ö->z[p->
n
] = 0;

1756  
p
->
z
;

1757 
	}
}

1765 
	$do_mëa_comm™d
(*
zLöe
, 
ˇŒback_d©a
 *
p
){

1766 
i
 = 1;

1767 
nArg
 = 0;

1768 
n
, 
c
;

1769 
rc
 = 0;

1770 *
azArg
[50];

1774  
zLöe
[
i
] && 
nArg
<
	`AºaySize
(
azArg
) ){

1775  
	`IsS∑˚
(
zLöe
[
i
]) ){ i++; }

1776 if–
zLöe
[
i
]==0 ) ;

1777 if–
zLöe
[
i
]=='\'' || zLine[i]=='"' ){

1778 
dñim
 = 
zLöe
[
i
++];

1779 
azArg
[
nArg
++] = &
zLöe
[
i
];

1780  
zLöe
[
i
] && zLöe[i]!=
dñim
 ){

1781 if–
zLöe
[
i
]=='\\' && 
dñim
=='"' && zLine[i+1]!=0 ) i++;

1782 
i
++;

1784 if–
zLöe
[
i
]==
dñim
 ){

1785 
zLöe
[
i
++] = 0;

1787 if–
dñim
=='"' ) 
	`ªsﬁve_back¶ashes
(
azArg
[
nArg
-1]);

1789 
azArg
[
nArg
++] = &
zLöe
[
i
];

1790  
zLöe
[
i
] && !
	`IsS∑˚
(zLine[i]) ){ i++; }

1791 if–
zLöe
[
i
] ) zLine[i++] = 0;

1792 
	`ªsﬁve_back¶ashes
(
azArg
[
nArg
-1]);

1798 if–
nArg
==0 )  0;

1799 
n
 = 
	`°æí30
(
azArg
[0]);

1800 
c
 = 
azArg
[0][0];

1801 if–
c
=='b' && 
n
>=3 && 
	`°∫cmp
(
azArg
[0], "backup",Ç)==0 ){

1802 c⁄° *
zDe°Fûe
 = 0;

1803 c⁄° *
zDb
 = 0;

1804 
sqlôe3
 *
pDe°
;

1805 
sqlôe3_backup
 *
pBackup
;

1806 
j
;

1807 
j
=1; j<
nArg
; j++){

1808 c⁄° *
z
 = 
azArg
[
j
];

1809 if–
z
[0]=='-' ){

1810  
z
[0]=='-' ) z++;

1813 
	`Ârötf
(
°dîr
, "unknow¿›ti⁄: %s\n", 
azArg
[
j
]);

1816 }if–
zDe°Fûe
==0 ){

1817 
zDe°Fûe
 = 
azArg
[
j
];

1818 }if–
zDb
==0 ){

1819 
zDb
 = 
zDe°Fûe
;

1820 
zDe°Fûe
 = 
azArg
[
j
];

1822 
	`Ârötf
(
°dîr
, "too manyárgumentsÅo .backup\n");

1826 if–
zDe°Fûe
==0 ){

1827 
	`Ârötf
(
°dîr
, "missing FILENAMEárgument on .backup\n");

1830 if–
zDb
==0 ) zDb = "main";

1831 
rc
 = 
	`sqlôe3_›í
(
zDe°Fûe
, &
pDe°
);

1832 if–
rc
!=
SQLITE_OK
 ){

1833 
	`Ârötf
(
°dîr
, "Eº‹: c™nŸ o≥¿\"%s\"\n", 
zDe°Fûe
);

1834 
	`sqlôe3_˛o£
(
pDe°
);

1837 
	`›í_db
(
p
);

1838 
pBackup
 = 
	`sqlôe3_backup_öô
(
pDe°
, "maö", 
p
->
db
, 
zDb
);

1839 if–
pBackup
==0 ){

1840 
	`Ârötf
(
°dîr
, "Eº‹: %s\n", 
	`sqlôe3_îrmsg
(
pDe°
));

1841 
	`sqlôe3_˛o£
(
pDe°
);

1844  (
rc
 = 
	`sqlôe3_backup_°ï
(
pBackup
,100))==
SQLITE_OK
 ){}

1845 
	`sqlôe3_backup_föish
(
pBackup
);

1846 if–
rc
==
SQLITE_DONE
 ){

1847 
rc
 = 0;

1849 
	`Ârötf
(
°dîr
, "Eº‹: %s\n", 
	`sqlôe3_îrmsg
(
pDe°
));

1850 
rc
 = 1;

1852 
	`sqlôe3_˛o£
(
pDe°
);

1855 if–
c
=='b' && 
n
>=3 && 
	`°∫cmp
(
azArg
[0], "baû",Ç)==0 && 
nArg
>1 &&ÇArg<3 ){

1856 
baû_⁄_îr‹
 = 
	`boﬁónVÆue
(
azArg
[1]);

1862 if–
c
=='b' && 
n
>=3 && 
	`°∫cmp
(
azArg
[0], "breakpoint",Ç)==0 ){

1863 
	`ã°_bªakpoöt
();

1866 if–
c
=='d' && 
n
>1 && 
	`°∫cmp
(
azArg
[0], "d©aba£s",Ç)==0 && 
nArg
==1 ){

1867 
ˇŒback_d©a
 
d©a
;

1868 *
zEºMsg
 = 0;

1869 
	`›í_db
(
p
);

1870 
	`mem˝y
(&
d©a
, 
p
, (data));

1871 
d©a
.
showHódî
 = 1;

1872 
d©a
.
mode
 = 
MODE_Cﬁumn
;

1873 
d©a
.
cﬁWidth
[0] = 3;

1874 
d©a
.
cﬁWidth
[1] = 15;

1875 
d©a
.
cﬁWidth
[2] = 58;

1876 
d©a
.
˙t
 = 0;

1877 
	`sqlôe3_exec
(
p
->
db
, "PRAGMA d©aba£_li°; ", 
ˇŒback
, &
d©a
, &
zEºMsg
);

1878 if–
zEºMsg
 ){

1879 
	`Ârötf
(
°dîr
,"Eº‹: %s\n", 
zEºMsg
);

1880 
	`sqlôe3_‰ì
(
zEºMsg
);

1881 
rc
 = 1;

1885 if–
c
=='d' && 
	`°∫cmp
(
azArg
[0], "dump", 
n
)==0 && 
nArg
<3 ){

1886 
	`›í_db
(
p
);

1890 
	`Ârötf
(
p
->
out
, "PRAGMA foreign_keys=OFF;\n");

1891 
	`Ârötf
(
p
->
out
, "BEGIN TRANSACTION;\n");

1892 
p
->
wrôabÀSchema
 = 0;

1893 
	`sqlôe3_exec
(
p
->
db
, "SAVEPOINT dump; PRAGMA writable_schema=ON", 0, 0, 0);

1894 
p
->
nEº
 = 0;

1895 if–
nArg
==1 ){

1896 
	`run_schema_dump_quîy
(
p
,

1900 
	`run_schema_dump_quîy
(
p
,

1904 
	`run_èbÀ_dump_quîy
(
p
,

1909 
i
;

1910 
i
=1; i<
nArg
; i++){

1911 
zShñlSètic
 = 
azArg
[
i
];

1912 
	`run_schema_dump_quîy
(
p
,

1916 
	`run_èbÀ_dump_quîy
(
p
,

1922 
zShñlSètic
 = 0;

1925 if–
p
->
wrôabÀSchema
 ){

1926 
	`Ârötf
(
p
->
out
, "PRAGMA writable_schema=OFF;\n");

1927 
p
->
wrôabÀSchema
 = 0;

1929 
	`sqlôe3_exec
(
p
->
db
, "PRAGMA writable_schema=OFF;", 0, 0, 0);

1930 
	`sqlôe3_exec
(
p
->
db
, "RELEASE dump;", 0, 0, 0);

1931 
	`Ârötf
(
p
->
out
,Ö->
nEº
 ? "ROLLBACK; -- dueÅoÉrrors\n" : "COMMIT;\n");

1934 if–
c
=='e' && 
	`°∫cmp
(
azArg
[0], "echo", 
n
)==0 && 
nArg
>1 &&ÇArg<3 ){

1935 
p
->
echoOn
 = 
	`boﬁónVÆue
(
azArg
[1]);

1938 if–
c
=='e' && 
	`°∫cmp
(
azArg
[0], "exô", 
n
)==0 ){

1939 if–
nArg
>1 && (
rc
 = ()
	`öãgîVÆue
(
azArg
[1]))!=0 ) 
	`exô
(rc);

1940 
rc
 = 2;

1943 if–
c
=='e' && 
	`°∫cmp
(
azArg
[0], "ex∂aö", 
n
)==0 && 
nArg
<3 ){

1944 
vÆ
 = 
nArg
>=2 ? 
	`boﬁónVÆue
(
azArg
[1]) : 1;

1945 if(
vÆ
 == 1) {

1946 if(!
p
->
ex∂aöPªv
.
vÆid
) {

1947 
p
->
ex∂aöPªv
.
vÆid
 = 1;

1948 
p
->
ex∂aöPªv
.
mode
 =Ö->mode;

1949 
p
->
ex∂aöPªv
.
showHódî
 =Ö->showHeader;

1950 
	`mem˝y
(
p
->
ex∂aöPªv
.
cﬁWidth
,p->colWidth,(p->colWidth));

1959 
p
->
mode
 = 
MODE_Ex∂aö
;

1960 
p
->
showHódî
 = 1;

1961 
	`mem£t
(
p
->
cﬁWidth
,0,
	`AºaySize
(p->colWidth));

1962 
p
->
cﬁWidth
[0] = 4;

1963 
p
->
cﬁWidth
[1] = 13;

1964 
p
->
cﬁWidth
[2] = 4;

1965 
p
->
cﬁWidth
[3] = 4;

1966 
p
->
cﬁWidth
[4] = 4;

1967 
p
->
cﬁWidth
[5] = 13;

1968 
p
->
cﬁWidth
[6] = 2;

1969 
p
->
cﬁWidth
[7] = 13;

1970 }i‡(
p
->
ex∂aöPªv
.
vÆid
) {

1971 
p
->
ex∂aöPªv
.
vÆid
 = 0;

1972 
p
->
mode
 =Ö->
ex∂aöPªv
.mode;

1973 
p
->
showHódî
 =Ö->
ex∂aöPªv
.showHeader;

1974 
	`mem˝y
(
p
->
cﬁWidth
,p->
ex∂aöPªv
.colWidth,(p->colWidth));

1978 if–
c
=='h' && (
	`°∫cmp
(
azArg
[0], "hódî", 
n
)==0 ||

1979 
	`°∫cmp
(
azArg
[0], "hódîs", 
n
)==0Ë&& 
nArg
>1 &&ÇArg<3 ){

1980 
p
->
showHódî
 = 
	`boﬁónVÆue
(
azArg
[1]);

1983 if–
c
=='h' && 
	`°∫cmp
(
azArg
[0], "hñp", 
n
)==0 ){

1984 
	`Ârötf
(
°dîr
,"%s",
zHñp
);

1985 if–
HAS_TIMER
 ){

1986 
	`Ârötf
(
°dîr
,"%s",
zTimîHñp
);

1990 if–
c
=='i' && 
	`°∫cmp
(
azArg
[0], "imp‹t", 
n
)==0 && 
nArg
==3 ){

1991 *
zTabÀ
 = 
azArg
[2];

1992 *
zFûe
 = 
azArg
[1];

1993 
sqlôe3_°mt
 *
pStmt
 = 
NULL
;

1994 
nCﬁ
;

1995 
nByã
;

1996 
i
, 
j
;

1997 
√edCommô
;

1998 
nSï
;

1999 *
zSql
;

2000 
CSVRódî
 
sCsv
;

2001 (*
xClo£r
)(
FILE
*);

2003 
£íI¡îru±
 = 0;

2004 
	`mem£t
(&
sCsv
, 0, (sCsv));

2005 
	`›í_db
(
p
);

2006 
nSï
 = 
	`°æí30
(
p
->
£∑øt‹
);

2007 if–
nSï
==0 ){

2008 
	`Ârötf
(
°dîr
, "Error:Çon-null separatorÑequired for import\n");

2011 if–
nSï
>1 ){

2012 
	`Ârötf
(
°dîr
, "Error: multi-character separatorsÇotállowed"

2016 
sCsv
.
zFûe
 = zFile;

2017 
sCsv
.
nLöe
 = 1;

2018 if–
sCsv
.
zFûe
[0]=='|' ){

2019 
sCsv
.
ö
 = 
	`p›í
(sCsv.
zFûe
+1, "r");

2020 
sCsv
.
zFûe
 = "<pipe>";

2021 
xClo£r
 = 
p˛o£
;

2023 
sCsv
.
ö
 = 
	`f›í
(sCsv.
zFûe
, "rb");

2024 
xClo£r
 = 
f˛o£
;

2026 if–
sCsv
.
ö
==0 ){

2027 
	`Ârötf
(
°dîr
, "Eº‹: c™nŸ o≥¿\"%s\"\n", 
zFûe
);

2030 
sCsv
.
cSï¨©‹
 = 
p
->
£∑øt‹
[0];

2031 
zSql
 = 
	`sqlôe3_m¥ötf
("SELECT * FROM %s", 
zTabÀ
);

2032 if–
zSql
==0 ){

2033 
	`Ârötf
(
°dîr
, "Error: out of memory\n");

2034 
	`xClo£r
(
sCsv
.
ö
);

2037 
nByã
 = 
	`°æí30
(
zSql
);

2038 
rc
 = 
	`sqlôe3_¥ï¨e
(
p
->
db
, 
zSql
, -1, &
pStmt
, 0);

2039 if–
rc
 && 
	`sqlôe3_°rglob
("nÿsuchÅabÀ: *", 
	`sqlôe3_îrmsg
(
db
))==0 ){

2040 *
zCª©e
 = 
	`sqlôe3_m¥ötf
("CREATE TABLE %s", 
zTabÀ
);

2041 
cSï
 = '(';

2042  
	`csv_ªad_⁄e_fõld
(&
sCsv
) ){

2043 
zCª©e
 = 
	`sqlôe3_m¥ötf
("%z%c\¿ \"%s\" TEXT", zCª©e, 
cSï
, 
sCsv
.
z
);

2044 
cSï
 = ',';

2045 if–
sCsv
.
cTîm
!=sCsv.
cSï¨©‹
 ) ;

2047 if–
cSï
=='(' ){

2048 
	`sqlôe3_‰ì
(
zCª©e
);

2049 
	`sqlôe3_‰ì
(
sCsv
.
z
);

2050 
	`xClo£r
(
sCsv
.
ö
);

2051 
	`Ârötf
(
°dîr
,"%s:Ém±y fûe\n", 
sCsv
.
zFûe
);

2054 
zCª©e
 = 
	`sqlôe3_m¥ötf
("%z\n)", zCreate);

2055 
rc
 = 
	`sqlôe3_exec
(
p
->
db
, 
zCª©e
, 0, 0, 0);

2056 
	`sqlôe3_‰ì
(
zCª©e
);

2057 if–
rc
 ){

2058 
	`Ârötf
(
°dîr
, "CREATE TABLE %s(...ËÁûed: %s\n", 
zTabÀ
,

2059 
	`sqlôe3_îrmsg
(
db
));

2060 
	`sqlôe3_‰ì
(
sCsv
.
z
);

2061 
	`xClo£r
(
sCsv
.
ö
);

2064 
rc
 = 
	`sqlôe3_¥ï¨e
(
p
->
db
, 
zSql
, -1, &
pStmt
, 0);

2066 
	`sqlôe3_‰ì
(
zSql
);

2067 if–
rc
 ){

2068 i‡(
pStmt
Ë
	`sqlôe3_föÆize
(pStmt);

2069 
	`Ârötf
(
°dîr
,"Eº‹: %s\n", 
	`sqlôe3_îrmsg
(
db
));

2070 
	`xClo£r
(
sCsv
.
ö
);

2073 
nCﬁ
 = 
	`sqlôe3_cﬁumn_cou¡
(
pStmt
);

2074 
	`sqlôe3_föÆize
(
pStmt
);

2075 
pStmt
 = 0;

2076 if–
nCﬁ
==0 )  0;

2077 
zSql
 = 
	`sqlôe3_mÆloc
–
nByã
*2 + 20 + 
nCﬁ
*2 );

2078 if–
zSql
==0 ){

2079 
	`Ârötf
(
°dîr
, "Error: out of memory\n");

2080 
	`xClo£r
(
sCsv
.
ö
);

2083 
	`sqlôe3_¢¥ötf
(
nByã
+20, 
zSql
, "INSERT INTO \"%w\" VALUES(?", 
zTabÀ
);

2084 
j
 = 
	`°æí30
(
zSql
);

2085 
i
=1; i<
nCﬁ
; i++){

2086 
zSql
[
j
++] = ',';

2087 
zSql
[
j
++] = '?';

2089 
zSql
[
j
++] = ')';

2090 
zSql
[
j
] = 0;

2091 
rc
 = 
	`sqlôe3_¥ï¨e
(
p
->
db
, 
zSql
, -1, &
pStmt
, 0);

2092 
	`sqlôe3_‰ì
(
zSql
);

2093 if–
rc
 ){

2094 
	`Ârötf
(
°dîr
, "Eº‹: %s\n", 
	`sqlôe3_îrmsg
(
db
));

2095 i‡(
pStmt
Ë
	`sqlôe3_föÆize
(pStmt);

2096 
	`xClo£r
(
sCsv
.
ö
);

2099 
√edCommô
 = 
	`sqlôe3_gë_autocommô
(
db
);

2100 if–
√edCommô
 ) 
	`sqlôe3_exec
(
db
, "BEGIN", 0, 0, 0);

2102 
°¨tLöe
 = 
sCsv
.
nLöe
;

2103 
i
=0; i<
nCﬁ
; i++){

2104 *
z
 = 
	`csv_ªad_⁄e_fõld
(&
sCsv
);

2105 if–
z
==0 && 
i
==0 ) ;

2106 
	`sqlôe3_böd_ãxt
(
pStmt
, 
i
+1, 
z
, -1, 
SQLITE_TRANSIENT
);

2107 if–
i
<
nCﬁ
-1 && 
sCsv
.
cTîm
!=sCsv.
cSï¨©‹
 ){

2108 
	`Ârötf
(
°dîr
, "%s:%d:Éxpected %d columns but found %d - "

2110 
sCsv
.
zFûe
, 
°¨tLöe
, 
nCﬁ
, 
i
+1);

2111 
i
++;

2112  
i
<
nCﬁ
 ){ 
	`sqlôe3_böd_nuŒ
(
pStmt
, i); i++; }

2115 if–
sCsv
.
cTîm
==sCsv.
cSï¨©‹
 ){

2117 
	`csv_ªad_⁄e_fõld
(&
sCsv
);

2118 
i
++;

2119 } 
sCsv
.
cTîm
==sCsv.
cSï¨©‹
 );

2120 
	`Ârötf
(
°dîr
, "%s:%d:Éxpected %d columns but found %d - "

2122 
sCsv
.
zFûe
, 
°¨tLöe
, 
nCﬁ
, 
i
);

2124 if–
i
>=
nCﬁ
 ){

2125 
	`sqlôe3_°ï
(
pStmt
);

2126 
rc
 = 
	`sqlôe3_ª£t
(
pStmt
);

2127 if–
rc
!=
SQLITE_OK
 ){

2128 
	`Ârötf
(
°dîr
, "%s:%d: INSERT faûed: %s\n", 
sCsv
.
zFûe
, 
°¨tLöe
,

2129 
	`sqlôe3_îrmsg
(
db
));

2132 } 
sCsv
.
cTîm
!=
EOF
 );

2134 
	`xClo£r
(
sCsv
.
ö
);

2135 
	`sqlôe3_‰ì
(
sCsv
.
z
);

2136 
	`sqlôe3_föÆize
(
pStmt
);

2137 if–
√edCommô
 ) 
	`sqlôe3_exec
(
db
, "COMMIT", 0, 0, 0);

2140 if–
c
=='i' && 
	`°∫cmp
(
azArg
[0], "ödi˚s", 
n
)==0 && 
nArg
<3 ){

2141 
ˇŒback_d©a
 
d©a
;

2142 *
zEºMsg
 = 0;

2143 
	`›í_db
(
p
);

2144 
	`mem˝y
(&
d©a
, 
p
, (data));

2145 
d©a
.
showHódî
 = 0;

2146 
d©a
.
mode
 = 
MODE_Li°
;

2147 if–
nArg
==1 ){

2148 
rc
 = 
	`sqlôe3_exec
(
p
->
db
,

2155 
ˇŒback
, &
d©a
, &
zEºMsg


2158 
zShñlSètic
 = 
azArg
[1];

2159 
rc
 = 
	`sqlôe3_exec
(
p
->
db
,

2166 
ˇŒback
, &
d©a
, &
zEºMsg


2168 
zShñlSètic
 = 0;

2170 if–
zEºMsg
 ){

2171 
	`Ârötf
(
°dîr
,"Eº‹: %s\n", 
zEºMsg
);

2172 
	`sqlôe3_‰ì
(
zEºMsg
);

2173 
rc
 = 1;

2174 }if–
rc
 !
SQLITE_OK
 ){

2175 
	`Ârötf
(
°dîr
,"Error: querying sqlite_masteránd sqlite_temp_master\n");

2176 
rc
 = 1;

2180 #ifde‡
SQLITE_ENABLE_IOTRACE


2181 if–
c
=='i' && 
	`°∫cmp
(
azArg
[0], "iŸø˚", 
n
)==0 ){

2182 (*
sqlôe3IoTø˚
)(const *, ...);

2183 if–
iŸø˚
 && iŸø˚!=
°dout
 ) 
	`f˛o£
(iotrace);

2184 
iŸø˚
 = 0;

2185 if–
nArg
<2 ){

2186 
sqlôe3IoTø˚
 = 0;

2187 }if–
	`°rcmp
(
azArg
[1], "-")==0 ){

2188 
sqlôe3IoTø˚
 = 
iŸø˚Prötf
;

2189 
iŸø˚
 = 
°dout
;

2191 
iŸø˚
 = 
	`f›í
(
azArg
[1], "w");

2192 if–
iŸø˚
==0 ){

2193 
	`Ârötf
(
°dîr
, "Eº‹: c™nŸ o≥¿\"%s\"\n", 
azArg
[1]);

2194 
sqlôe3IoTø˚
 = 0;

2195 
rc
 = 1;

2197 
sqlôe3IoTø˚
 = 
iŸø˚Prötf
;

2203 #i‚de‡
SQLITE_OMIT_LOAD_EXTENSION


2204 if–
c
=='l' && 
	`°∫cmp
(
azArg
[0], "lﬂd", 
n
)==0 && 
nArg
>=2 ){

2205 c⁄° *
zFûe
, *
zProc
;

2206 *
zEºMsg
 = 0;

2207 
zFûe
 = 
azArg
[1];

2208 
zProc
 = 
nArg
>=3 ? 
azArg
[2] : 0;

2209 
	`›í_db
(
p
);

2210 
rc
 = 
	`sqlôe3_lﬂd_exãnsi⁄
(
p
->
db
, 
zFûe
, 
zProc
, &
zEºMsg
);

2211 if–
rc
!=
SQLITE_OK
 ){

2212 
	`Ârötf
(
°dîr
, "Eº‹: %s\n", 
zEºMsg
);

2213 
	`sqlôe3_‰ì
(
zEºMsg
);

2214 
rc
 = 1;

2219 if–
c
=='l' && 
	`°∫cmp
(
azArg
[0], "log", 
n
)==0 && 
nArg
>=2 ){

2220 c⁄° *
zFûe
 = 
azArg
[1];

2221 
	`ouçut_fûe_˛o£
(
p
->
pLog
);

2222 
p
->
pLog
 = 
	`ouçut_fûe_›í
(
zFûe
);

2225 if–
c
=='m' && 
	`°∫cmp
(
azArg
[0], "mode", 
n
)==0 && 
nArg
==2 ){

2226 
n2
 = 
	`°æí30
(
azArg
[1]);

2227 if–(
n2
==4 && 
	`°∫cmp
(
azArg
[1],"line",n2)==0)

2229 (
n2
==5 && 
	`°∫cmp
(
azArg
[1],"lines",n2)==0) ){

2230 
p
->
mode
 = 
MODE_Löe
;

2231 }if–(
n2
==6 && 
	`°∫cmp
(
azArg
[1],"column",n2)==0)

2233 (
n2
==7 && 
	`°∫cmp
(
azArg
[1],"columns",n2)==0) ){

2234 
p
->
mode
 = 
MODE_Cﬁumn
;

2235 }if–
n2
==4 && 
	`°∫cmp
(
azArg
[1],"list",n2)==0 ){

2236 
p
->
mode
 = 
MODE_Li°
;

2237 }if–
n2
==4 && 
	`°∫cmp
(
azArg
[1],"html",n2)==0 ){

2238 
p
->
mode
 = 
MODE_Html
;

2239 }if–
n2
==3 && 
	`°∫cmp
(
azArg
[1],"tcl",n2)==0 ){

2240 
p
->
mode
 = 
MODE_T˛
;

2241 
	`sqlôe3_¢¥ötf
((
p
->
£∑øt‹
),Ö->separator, " ");

2242 }if–
n2
==3 && 
	`°∫cmp
(
azArg
[1],"csv",n2)==0 ){

2243 
p
->
mode
 = 
MODE_Csv
;

2244 
	`sqlôe3_¢¥ötf
((
p
->
£∑øt‹
),Ö->separator, ",");

2245 }if–
n2
==4 && 
	`°∫cmp
(
azArg
[1],"tabs",n2)==0 ){

2246 
p
->
mode
 = 
MODE_Li°
;

2247 
	`sqlôe3_¢¥ötf
((
p
->
£∑øt‹
),Ö->separator, "\t");

2248 }if–
n2
==6 && 
	`°∫cmp
(
azArg
[1],"insert",n2)==0 ){

2249 
p
->
mode
 = 
MODE_In£π
;

2250 
	`£t_èbÀ_«me
(
p
, "table");

2252 
	`Ârötf
(
°dîr
,"Error: mode should be one of: "

2254 
rc
 = 1;

2258 if–
c
=='m' && 
	`°∫cmp
(
azArg
[0], "mode", 
n
)==0 && 
nArg
==3 ){

2259 
n2
 = 
	`°æí30
(
azArg
[1]);

2260 if–
n2
==6 && 
	`°∫cmp
(
azArg
[1],"insert",n2)==0 ){

2261 
p
->
mode
 = 
MODE_In£π
;

2262 
	`£t_èbÀ_«me
(
p
, 
azArg
[2]);

2264 
	`Ârötf
(
°dîr
, "Error: invalidárguments: "

2265 " \"%s\". E¡î \".hñp\" f‹ hñp\n", 
azArg
[2]);

2266 
rc
 = 1;

2270 if–
c
=='n' && 
	`°∫cmp
(
azArg
[0], "nuŒvÆue", 
n
)==0 && 
nArg
==2 ) {

2271 
	`sqlôe3_¢¥ötf
((
p
->
nuŒvÆue
),Ö->nullvalue,

2272 "%.*s", ()
	`AºaySize
(
p
->
nuŒvÆue
)-1, 
azArg
[1]);

2275 if–
c
=='o' && 
	`°∫cmp
(
azArg
[0], "ouçut", 
n
)==0 && 
nArg
==2 ){

2276 if–
p
->
outfûe
[0]=='|' ){

2277 
	`p˛o£
(
p
->
out
);

2279 
	`ouçut_fûe_˛o£
(
p
->
out
);

2281 
p
->
outfûe
[0] = 0;

2282 if–
azArg
[1][0]=='|' ){

2283 
p
->
out
 = 
	`p›í
(&
azArg
[1][1], "w");

2284 if–
p
->
out
==0 ){

2285 
	`Ârötf
(
°dîr
,"Eº‹: c™nŸ o≥¿pùê\"%s\"\n", &
azArg
[1][1]);

2286 
p
->
out
 = 
°dout
;

2287 
rc
 = 1;

2289 
	`sqlôe3_¢¥ötf
((
p
->
outfûe
),Ö->outfûe, "%s", 
azArg
[1]);

2292 
p
->
out
 = 
	`ouçut_fûe_›í
(
azArg
[1]);

2293 if–
p
->
out
==0 ){

2294 if–
	`°rcmp
(
azArg
[1],"off")!=0 ){

2295 
	`Ârötf
(
°dîr
,"Eº‹: c™nŸ wrôêtÿ\"%s\"\n", 
azArg
[1]);

2297 
p
->
out
 = 
°dout
;

2298 
rc
 = 1;

2300 
	`sqlôe3_¢¥ötf
((
p
->
outfûe
),Ö->outfûe, "%s", 
azArg
[1]);

2305 if–
c
=='p' && 
n
>=3 && 
	`°∫cmp
(
azArg
[0], "print",Ç)==0 ){

2306 
i
;

2307 
i
=1; i<
nArg
; i++){

2308 if–
i
>1 ) 
	`Ârötf
(
p
->
out
, " ");

2309 
	`Ârötf
(
p
->
out
, "%s", 
azArg
[
i
]);

2311 
	`Ârötf
(
p
->
out
, "\n");

2314 if–
c
=='p' && 
	`°∫cmp
(
azArg
[0], "¥om±", 
n
)==0 && (
nArg
==2 ||ÇArg==3)){

2315 if–
nArg
 >= 2) {

2316 
	`°∫˝y
(
maöProm±
,
azArg
[1],()
	`AºaySize
(mainPrompt)-1);

2318 if–
nArg
 >= 3) {

2319 
	`°∫˝y
(
c⁄töueProm±
,
azArg
[2],()
	`AºaySize
(continuePrompt)-1);

2323 if–
c
=='q' && 
	`°∫cmp
(
azArg
[0], "quô", 
n
)==0 && 
nArg
==1 ){

2324 
rc
 = 2;

2327 if–
c
=='r' && 
n
>=3 && 
	`°∫cmp
(
azArg
[0], "ªad",Ç)==0 && 
nArg
==2 ){

2328 
FILE
 *
Æt
 = 
	`f›í
(
azArg
[1], "rb");

2329 if–
Æt
==0 ){

2330 
	`Ârötf
(
°dîr
,"Eº‹: c™nŸ o≥¿\"%s\"\n", 
azArg
[1]);

2331 
rc
 = 1;

2333 
rc
 = 
	`¥o˚ss_öput
(
p
, 
Æt
);

2334 
	`f˛o£
(
Æt
);

2338 if–
c
=='r' && 
n
>=3 && 
	`°∫cmp
(
azArg
[0], "ª°‹e",Ç)==0 && 
nArg
>1 &&ÇArg<4){

2339 c⁄° *
zSrcFûe
;

2340 c⁄° *
zDb
;

2341 
sqlôe3
 *
pSrc
;

2342 
sqlôe3_backup
 *
pBackup
;

2343 
nTimeout
 = 0;

2345 if–
nArg
==2 ){

2346 
zSrcFûe
 = 
azArg
[1];

2347 
zDb
 = "main";

2349 
zSrcFûe
 = 
azArg
[2];

2350 
zDb
 = 
azArg
[1];

2352 
rc
 = 
	`sqlôe3_›í
(
zSrcFûe
, &
pSrc
);

2353 if–
rc
!=
SQLITE_OK
 ){

2354 
	`Ârötf
(
°dîr
, "Eº‹: c™nŸ o≥¿\"%s\"\n", 
zSrcFûe
);

2355 
	`sqlôe3_˛o£
(
pSrc
);

2358 
	`›í_db
(
p
);

2359 
pBackup
 = 
	`sqlôe3_backup_öô
(
p
->
db
, 
zDb
, 
pSrc
, "main");

2360 if–
pBackup
==0 ){

2361 
	`Ârötf
(
°dîr
, "Eº‹: %s\n", 
	`sqlôe3_îrmsg
(
p
->
db
));

2362 
	`sqlôe3_˛o£
(
pSrc
);

2365  (
rc
 = 
	`sqlôe3_backup_°ï
(
pBackup
,100))==
SQLITE_OK


2366 || 
rc
==
SQLITE_BUSY
 ){

2367 if–
rc
==
SQLITE_BUSY
 ){

2368 if–
nTimeout
++ >= 3 ) ;

2369 
	`sqlôe3_¶ìp
(100);

2372 
	`sqlôe3_backup_föish
(
pBackup
);

2373 if–
rc
==
SQLITE_DONE
 ){

2374 
rc
 = 0;

2375 }if–
rc
==
SQLITE_BUSY
 ||Ñc==
SQLITE_LOCKED
 ){

2376 
	`Ârötf
(
°dîr
, "Error: source database is busy\n");

2377 
rc
 = 1;

2379 
	`Ârötf
(
°dîr
, "Eº‹: %s\n", 
	`sqlôe3_îrmsg
(
p
->
db
));

2380 
rc
 = 1;

2382 
	`sqlôe3_˛o£
(
pSrc
);

2385 if–
c
=='s' && 
	`°∫cmp
(
azArg
[0], "schema", 
n
)==0 && 
nArg
<3 ){

2386 
ˇŒback_d©a
 
d©a
;

2387 *
zEºMsg
 = 0;

2388 
	`›í_db
(
p
);

2389 
	`mem˝y
(&
d©a
, 
p
, (data));

2390 
d©a
.
showHódî
 = 0;

2391 
d©a
.
mode
 = 
MODE_Semi
;

2392 if–
nArg
>1 ){

2393 
i
;

2394 
i
=0; 
azArg
[1][i]; i++ËazArg[1][i] = 
	`ToLowî
(azArg[1][i]);

2395 if–
	`°rcmp
(
azArg
[1],"sqlite_master")==0 ){

2396 *
√w_¨gv
[2], *
√w_cﬁv
[2];

2397 
√w_¨gv
[0] = "CREATE TABLE sqlite_master (\n"

2404 
√w_¨gv
[1] = 0;

2405 
√w_cﬁv
[0] = "sql";

2406 
√w_cﬁv
[1] = 0;

2407 
	`ˇŒback
(&
d©a
, 1, 
√w_¨gv
, 
√w_cﬁv
);

2408 
rc
 = 
SQLITE_OK
;

2409 }if–
	`°rcmp
(
azArg
[1],"sqlite_temp_master")==0 ){

2410 *
√w_¨gv
[2], *
√w_cﬁv
[2];

2411 
√w_¨gv
[0] = "CREATE TEMP TABLE sqlite_temp_master (\n"

2418 
√w_¨gv
[1] = 0;

2419 
√w_cﬁv
[0] = "sql";

2420 
√w_cﬁv
[1] = 0;

2421 
	`ˇŒback
(&
d©a
, 1, 
√w_¨gv
, 
√w_cﬁv
);

2422 
rc
 = 
SQLITE_OK
;

2424 
zShñlSètic
 = 
azArg
[1];

2425 
rc
 = 
	`sqlôe3_exec
(
p
->
db
,

2433 
ˇŒback
, &
d©a
, &
zEºMsg
);

2434 
zShñlSètic
 = 0;

2437 
rc
 = 
	`sqlôe3_exec
(
p
->
db
,

2444 
ˇŒback
, &
d©a
, &
zEºMsg


2447 if–
zEºMsg
 ){

2448 
	`Ârötf
(
°dîr
,"Eº‹: %s\n", 
zEºMsg
);

2449 
	`sqlôe3_‰ì
(
zEºMsg
);

2450 
rc
 = 1;

2451 }if–
rc
 !
SQLITE_OK
 ){

2452 
	`Ârötf
(
°dîr
,"Error: querying schema information\n");

2453 
rc
 = 1;

2455 
rc
 = 0;

2459 #ifde‡
SQLITE_DEBUG


2462 if–
c
=='s' && 
n
>=10 && 
	`°∫cmp
(
azArg
[0], "selftest-", 9)==0 ){

2463 if–
	`°∫cmp
(
azArg
[0]+9, "boﬁón", 
n
-9)==0 ){

2464 
i
, 
v
;

2465 
i
=1; i<
nArg
; i++){

2466 
v
 = 
	`boﬁónVÆue
(
azArg
[
i
]);

2467 
	`Ârötf
(
p
->
out
, "%s: %d 0x%x\n", 
azArg
[
i
], 
v
, v);

2470 if–
	`°∫cmp
(
azArg
[0]+9, "öãgî", 
n
-9)==0 ){

2471 
i
; 
sqlôe3_öt64
 
v
;

2472 
i
=1; i<
nArg
; i++){

2473 
zBuf
[200];

2474 
v
 = 
	`öãgîVÆue
(
azArg
[
i
]);

2475 
	`sqlôe3_¢¥ötf
((
zBuf
), zBuf, "%s: %Œd 0x%Œx\n", 
azArg
[
i
], 
v
, v);

2476 
	`Ârötf
(
p
->
out
, "%s", 
zBuf
);

2482 if–
c
=='s' && 
	`°∫cmp
(
azArg
[0], "£∑øt‹", 
n
)==0 && 
nArg
==2 ){

2483 
	`sqlôe3_¢¥ötf
((
p
->
£∑øt‹
),Ö->separator,

2484 "%.*s", ()(
p
->
£∑øt‹
)-1, 
azArg
[1]);

2487 if–
c
=='s' && 
	`°∫cmp
(
azArg
[0], "show", 
n
)==0 && 
nArg
==1 ){

2488 
i
;

2489 
	`Ârötf
(
p
->
out
,"%9.9s: %s\n","echo",Ö->
echoOn
 ? "on" : "off");

2490 
	`Ârötf
(
p
->
out
,"%9.9s: %s\n","ex∂aö",Ö->
ex∂aöPªv
.
vÆid
 ? "on" :"off");

2491 
	`Ârötf
(
p
->
out
,"%9.9s: %s\n","hódîs",Ö->
showHódî
 ? "on" : "off");

2492 
	`Ârötf
(
p
->
out
,"%9.9s: %s\n","mode", 
modeDes¸
[p->
mode
]);

2493 
	`Ârötf
(
p
->
out
,"%9.9s: ", "nullvalue");

2494 
	`ouçut_c_°rög
(
p
->
out
,Ö->
nuŒvÆue
);

2495 
	`Ârötf
(
p
->
out
, "\n");

2496 
	`Ârötf
(
p
->
out
,"%9.9s: %s\n","output",

2497 
	`°æí30
(
p
->
outfûe
) ?Ö->outfile : "stdout");

2498 
	`Ârötf
(
p
->
out
,"%9.9s: ", "separator");

2499 
	`ouçut_c_°rög
(
p
->
out
,Ö->
£∑øt‹
);

2500 
	`Ârötf
(
p
->
out
, "\n");

2501 
	`Ârötf
(
p
->
out
,"%9.9s: %s\n","°©s",Ö->
°©sOn
 ? "on" : "off");

2502 
	`Ârötf
(
p
->
out
,"%9.9s: ","width");

2503 
i
=0;i<()
	`AºaySize
(
p
->
cﬁWidth
) &&Ö->colWidth[i] != 0;i++) {

2504 
	`Ârötf
(
p
->
out
,"%d ",p->
cﬁWidth
[
i
]);

2506 
	`Ârötf
(
p
->
out
,"\n");

2509 if–
c
=='s' && 
	`°∫cmp
(
azArg
[0], "°©s", 
n
)==0 && 
nArg
>1 &&ÇArg<3 ){

2510 
p
->
°©sOn
 = 
	`boﬁónVÆue
(
azArg
[1]);

2513 if–
c
=='t' && 
n
>1 && 
	`°∫cmp
(
azArg
[0], "èbÀs",Ç)==0 && 
nArg
<3 ){

2514 
sqlôe3_°mt
 *
pStmt
;

2515 **
azResu…
;

2516 
nRow
, 
nAŒoc
;

2517 *
zSql
 = 0;

2518 
ii
;

2519 
	`›í_db
(
p
);

2520 
rc
 = 
	`sqlôe3_¥ï¨e_v2
(
p
->
db
, "PRAGMA d©aba£_li°", -1, &
pStmt
, 0);

2521 if–
rc
 ) Ñc;

2522 
zSql
 = 
	`sqlôe3_m¥ötf
(

2527  
	`sqlôe3_°ï
(
pStmt
)==
SQLITE_ROW
 ){

2528 c⁄° *
zDbName
 = (c⁄° *)
	`sqlôe3_cﬁumn_ãxt
(
pStmt
, 1);

2529 if–
zDbName
==0 || 
	`°rcmp
(zDbName,"main")==0 ) ;

2530 if–
	`°rcmp
(
zDbName
,"temp")==0 ){

2531 
zSql
 = 
	`sqlôe3_m¥ötf
(

2536 " ANDÇamêLIKE ?1", 
zSql
);

2538 
zSql
 = 
	`sqlôe3_m¥ötf
(

2543 " ANDÇamêLIKE ?1", 
zSql
, 
zDbName
, zDbName);

2546 
	`sqlôe3_föÆize
(
pStmt
);

2547 
zSql
 = 
	`sqlôe3_m¥ötf
("%z ORDER BY 1", zSql);

2548 
rc
 = 
	`sqlôe3_¥ï¨e_v2
(
p
->
db
, 
zSql
, -1, &
pStmt
, 0);

2549 
	`sqlôe3_‰ì
(
zSql
);

2550 if–
rc
 ) Ñc;

2551 
nRow
 = 
nAŒoc
 = 0;

2552 
azResu…
 = 0;

2553 if–
nArg
>1 ){

2554 
	`sqlôe3_böd_ãxt
(
pStmt
, 1, 
azArg
[1], -1, 
SQLITE_TRANSIENT
);

2556 
	`sqlôe3_böd_ãxt
(
pStmt
, 1, "%", -1, 
SQLITE_STATIC
);

2558  
	`sqlôe3_°ï
(
pStmt
)==
SQLITE_ROW
 ){

2559 if–
nRow
>=
nAŒoc
 ){

2560 **
azNew
;

2561 
n
 = 
nAŒoc
*2 + 10;

2562 
azNew
 = 
	`sqlôe3_ªÆloc
(
azResu…
, ◊zResu…[0])*
n
);

2563 if–
azNew
==0 ){

2564 
	`Ârötf
(
°dîr
, "Error: out of memory\n");

2567 
nAŒoc
 = 
n
;

2568 
azResu…
 = 
azNew
;

2570 
azResu…
[
nRow
] = 
	`sqlôe3_m¥ötf
("%s", 
	`sqlôe3_cﬁumn_ãxt
(
pStmt
, 0));

2571 if–
azResu…
[
nRow
] )ÇRow++;

2573 
	`sqlôe3_föÆize
(
pStmt
);

2574 if–
nRow
>0 ){

2575 
Àn
, 
maxÀn
 = 0;

2576 
i
, 
j
;

2577 
nPrötCﬁ
, 
nPrötRow
;

2578 
i
=0; i<
nRow
; i++){

2579 
Àn
 = 
	`°æí30
(
azResu…
[
i
]);

2580 if–
Àn
>
maxÀn
 ) maxlen =Üen;

2582 
nPrötCﬁ
 = 80/(
maxÀn
+2);

2583 if–
nPrötCﬁ
<1 )ÇPrintCol = 1;

2584 
nPrötRow
 = (
nRow
 + 
nPrötCﬁ
 - 1)/nPrintCol;

2585 
i
=0; i<
nPrötRow
; i++){

2586 
j
=
i
; j<
nRow
; j+=
nPrötRow
){

2587 *
zSp
 = 
j
<
nPrötRow
 ? "" : " ";

2588 
	`Ârötf
(
p
->
out
, "%s%-*s", 
zSp
, 
maxÀn
, 
azResu…
[
j
] ?ázResult[j] : "");

2590 
	`Ârötf
(
p
->
out
, "\n");

2593 
ii
=0; ii<
nRow
; ii++Ë
	`sqlôe3_‰ì
(
azResu…
[ii]);

2594 
	`sqlôe3_‰ì
(
azResu…
);

2597 if–
c
=='t' && 
n
>=8 && 
	`°∫cmp
(
azArg
[0], "ã°˘æ",Ç)==0 && 
nArg
>=2 ){

2599 c⁄° *
zCålName
;

2600 
˘æCode
;

2601 } 
aCål
[] = {

2602 { "¥ng_ßve", 
SQLITE_TESTCTRL_PRNG_SAVE
 },

2603 { "¥ng_ª°‹e", 
SQLITE_TESTCTRL_PRNG_RESTORE
 },

2604 { "¥ng_ª£t", 
SQLITE_TESTCTRL_PRNG_RESET
 },

2605 { "bôvec_ã°", 
SQLITE_TESTCTRL_BITVEC_TEST
 },

2606 { "Áu…_ö°Æl", 
SQLITE_TESTCTRL_FAULT_INSTALL
 },

2607 { "bíign_mÆloc_hooks", 
SQLITE_TESTCTRL_BENIGN_MALLOC_HOOKS
 },

2608 { "≥ndög_byã", 
SQLITE_TESTCTRL_PENDING_BYTE
 },

2609 { "as£π", 
SQLITE_TESTCTRL_ASSERT
 },

2610 { "Æways", 
SQLITE_TESTCTRL_ALWAYS
 },

2611 { "ª£rve", 
SQLITE_TESTCTRL_RESERVE
 },

2612 { "›timiz©i⁄s", 
SQLITE_TESTCTRL_OPTIMIZATIONS
 },

2613 { "iskeyw‹d", 
SQLITE_TESTCTRL_ISKEYWORD
 },

2614 { "s¸©chmÆloc", 
SQLITE_TESTCTRL_SCRATCHMALLOC
 },

2616 
ã°˘æ
 = -1;

2617 
rc
 = 0;

2618 
i
, 
n
;

2619 
	`›í_db
(
p
);

2623 
n
 = 
	`°æí30
(
azArg
[1]);

2624 
i
=0; i<()((
aCål
)/(aCtrl[0])); i++){

2625 if–
	`°∫cmp
(
azArg
[1], 
aCål
[
i
].
zCålName
, 
n
)==0 ){

2626 if–
ã°˘æ
<0 ){

2627 
ã°˘æ
 = 
aCål
[
i
].
˘æCode
;

2629 
	`Ârötf
(
°dîr
, "ambiguou†›ti⁄Çame: \"%s\"\n", 
azArg
[1]);

2630 
ã°˘æ
 = -1;

2635 if–
ã°˘æ
<0 )Åe°˘æ = ()
	`öãgîVÆue
(
azArg
[1]);

2636 if–(
ã°˘æ
<
SQLITE_TESTCTRL_FIRST
Ë|| (ã°˘æ>
SQLITE_TESTCTRL_LAST
) ){

2637 
	`Ârötf
(
°dîr
,"Eº‹: invÆidÅe°˘æ o±i⁄: %s\n", 
azArg
[1]);

2639 
ã°˘æ
){

2642 
SQLITE_TESTCTRL_OPTIMIZATIONS
:

2643 
SQLITE_TESTCTRL_RESERVE
:

2644 if–
nArg
==3 ){

2645 
›t
 = ()
	`°πﬁ
(
azArg
[2], 0, 0);

2646 
rc
 = 
	`sqlôe3_ã°_c⁄åﬁ
(
ã°˘æ
, 
p
->
db
, 
›t
);

2647 
	`Ârötf
(
p
->
out
, "%d (0x%08x)\n", 
rc
,Ñc);

2649 
	`Ârötf
(
°dîr
,"Error:Åestctrl %sÅakesá single int option\n",

2650 
azArg
[1]);

2655 
SQLITE_TESTCTRL_PRNG_SAVE
:

2656 
SQLITE_TESTCTRL_PRNG_RESTORE
:

2657 
SQLITE_TESTCTRL_PRNG_RESET
:

2658 if–
nArg
==2 ){

2659 
rc
 = 
	`sqlôe3_ã°_c⁄åﬁ
(
ã°˘æ
);

2660 
	`Ârötf
(
p
->
out
, "%d (0x%08x)\n", 
rc
,Ñc);

2662 
	`Ârötf
(
°dîr
,"Eº‹:Åe°˘æ %†èke†nÿ›ti⁄s\n", 
azArg
[1]);

2667 
SQLITE_TESTCTRL_PENDING_BYTE
:

2668 if–
nArg
==3 ){

2669 
›t
 = ()
	`öãgîVÆue
(
azArg
[2]);

2670 
rc
 = 
	`sqlôe3_ã°_c⁄åﬁ
(
ã°˘æ
, 
›t
);

2671 
	`Ârötf
(
p
->
out
, "%d (0x%08x)\n", 
rc
,Ñc);

2673 
	`Ârötf
(
°dîr
,"Error:Åestctrl %sÅakesá single unsigned"

2674 " i¡ o±i⁄\n", 
azArg
[1]);

2679 
SQLITE_TESTCTRL_ASSERT
:

2680 
SQLITE_TESTCTRL_ALWAYS
:

2681 if–
nArg
==3 ){

2682 
›t
 = 
	`boﬁónVÆue
(
azArg
[2]);

2683 
rc
 = 
	`sqlôe3_ã°_c⁄åﬁ
(
ã°˘æ
, 
›t
);

2684 
	`Ârötf
(
p
->
out
, "%d (0x%08x)\n", 
rc
,Ñc);

2686 
	`Ârötf
(
°dîr
,"Error:Åestctrl %sÅakesá single int option\n",

2687 
azArg
[1]);

2692 #ifde‡
SQLITE_N_KEYWORD


2693 
SQLITE_TESTCTRL_ISKEYWORD
:

2694 if–
nArg
==3 ){

2695 c⁄° *
›t
 = 
azArg
[2];

2696 
rc
 = 
	`sqlôe3_ã°_c⁄åﬁ
(
ã°˘æ
, 
›t
);

2697 
	`Ârötf
(
p
->
out
, "%d (0x%08x)\n", 
rc
,Ñc);

2699 
	`Ârötf
(
°dîr
,"Error:Åestctrl %sÅakesá single char * option\n",

2700 
azArg
[1]);

2705 
SQLITE_TESTCTRL_BITVEC_TEST
:

2706 
SQLITE_TESTCTRL_FAULT_INSTALL
:

2707 
SQLITE_TESTCTRL_BENIGN_MALLOC_HOOKS
:

2708 
SQLITE_TESTCTRL_SCRATCHMALLOC
:

2710 
	`Ârötf
(
°dîr
,"Error: CLI support forÅestctrl %sÇot implemented\n",

2711 
azArg
[1]);

2717 if–
c
=='t' && 
n
>4 && 
	`°∫cmp
(
azArg
[0], "timeout",Ç)==0 && 
nArg
==2 ){

2718 
	`›í_db
(
p
);

2719 
	`sqlôe3_busy_timeout
(
p
->
db
, ()
	`öãgîVÆue
(
azArg
[1]));

2722 if–
HAS_TIMER
 && 
c
=='t' && 
n
>=5 && 
	`°∫cmp
(
azArg
[0], "timer",Ç)==0

2723 && 
nArg
==2

2725 
íabÀTimî
 = 
	`boﬁónVÆue
(
azArg
[1]);

2728 if–
c
=='t' && 
	`°∫cmp
(
azArg
[0], "åa˚", 
n
)==0 && 
nArg
>1 ){

2729 
	`›í_db
(
p
);

2730 
	`ouçut_fûe_˛o£
(
p
->
åa˚Out
);

2731 
p
->
åa˚Out
 = 
	`ouçut_fûe_›í
(
azArg
[1]);

2732 #i‡!
	`deföed
(
SQLITE_OMIT_TRACE
Ë&& !deföed(
SQLITE_OMIT_FLOATING_POINT
)

2733 if–
p
->
åa˚Out
==0 ){

2734 
	`sqlôe3_åa˚
(
p
->
db
, 0, 0);

2736 
	`sqlôe3_åa˚
(
p
->
db
, 
sql_åa˚_ˇŒback
,Ö->
åa˚Out
);

2741 if–
c
=='v' && 
	`°∫cmp
(
azArg
[0], "vîsi⁄", 
n
)==0 ){

2742 
	`Ârötf
(
p
->
out
, "SQLite %s %s\n" ,

2743 
	`sqlôe3_libvîsi⁄
(), 
	`sqlôe3_sour˚id
());

2746 if–
c
=='v' && 
	`°∫cmp
(
azArg
[0], "vf¢ame", 
n
)==0 ){

2747 c⁄° *
zDbName
 = 
nArg
==2 ? 
azArg
[1] : "main";

2748 *
zVfsName
 = 0;

2749 if–
p
->
db
 ){

2750 
	`sqlôe3_fûe_c⁄åﬁ
(
p
->
db
, 
zDbName
, 
SQLITE_FCNTL_VFSNAME
, &
zVfsName
);

2751 if–
zVfsName
 ){

2752 
	`Ârötf
(
p
->
out
, "%s\n", 
zVfsName
);

2753 
	`sqlôe3_‰ì
(
zVfsName
);

2758 #i‡
	`deföed
(
SQLITE_DEBUG
Ë&& deföed(
SQLITE_ENABLE_WHERETRACE
)

2759 if–
c
=='w' && 
	`°∫cmp
(
azArg
[0], "whîëø˚", 
n
)==0 ){

2760 
sqlôe3WhîeTø˚
;

2761 
sqlôe3WhîeTø˚
 = 
	`boﬁónVÆue
(
azArg
[1]);

2765 if–
c
=='w' && 
	`°∫cmp
(
azArg
[0], "width", 
n
)==0 && 
nArg
>1 ){

2766 
j
;

2767 
	`as£π
–
nArg
<=
	`AºaySize
(
azArg
) );

2768 
j
=1; j<
nArg
 && j<
	`AºaySize
(
p
->
cﬁWidth
); j++){

2769 
p
->
cﬁWidth
[
j
-1] = ()
	`öãgîVÆue
(
azArg
[j]);

2774 
	`Ârötf
(
°dîr
, "Error: unknown command or invalidárguments: "

2775 " \"%s\". E¡î \".hñp\" f‹ hñp\n", 
azArg
[0]);

2776 
rc
 = 1;

2779  
rc
;

2780 
	}
}

2786 
	$löe_c⁄èös_£micﬁ⁄
(c⁄° *
z
, 
N
){

2787 
i
;

2788 
i
=0; i<
N
; i++){ if–
z
[i]==';' )  1; }

2790 
	}
}

2795 
	$_Æl_whôe•a˚
(c⁄° *
z
){

2796 ; *
z
; z++){

2797 if–
	`IsS∑˚
(
z
[0]) ) ;

2798 if–*
z
=='/' && z[1]=='*' ){

2799 
z
 += 2;

2800  *
z
 && (*z!='*' || z[1]!='/') ){ z++; }

2801 if–*
z
==0 )  0;

2802 
z
++;

2805 if–*
z
=='-' && z[1]=='-' ){

2806 
z
 += 2;

2807  *
z
 && *z!='\n' ){ z++; }

2808 if–*
z
==0 )  1;

2814 
	}
}

2821 
	$löe_is_comm™d_ãrmö©‹
(c⁄° *
zLöe
){

2822  
	`IsS∑˚
(
zLöe
[0]) ){ zLine++; };

2823 if–
zLöe
[0]=='/' && 
	`_Æl_whôe•a˚
(&zLine[1]) ){

2826 if–
	`ToLowî
(
zLöe
[0])=='g' && ToLower(zLine[1])=='o'

2827 && 
	`_Æl_whôe•a˚
(&
zLöe
[2]) ){

2831 
	}
}

2837 
	$löe_is_com∂ëe
(*
zSql
, 
nSql
){

2838 
rc
;

2839 if–
zSql
==0 )  1;

2840 
zSql
[
nSql
] = ';';

2841 
zSql
[
nSql
+1] = 0;

2842 
rc
 = 
	`sqlôe3_com∂ëe
(
zSql
);

2843 
zSql
[
nSql
] = 0;

2844  
rc
;

2845 
	}
}

2856 
	$¥o˚ss_öput
(
ˇŒback_d©a
 *
p
, 
FILE
 *
ö
){

2857 *
zLöe
 = 0;

2858 *
zSql
 = 0;

2859 
nLöe
;

2860 
nSql
 = 0;

2861 
nAŒoc
 = 0;

2862 
nSqlPri‹
 = 0;

2863 *
zEºMsg
;

2864 
rc
;

2865 
îrC¡
 = 0;

2866 
löío
 = 0;

2867 
°¨éöe
 = 0;

2869  
îrC¡
==0 || !
baû_⁄_îr‹
 || (
ö
==0 && 
°dö_is_öãø˘ive
) ){

2870 
	`fÊush
(
p
->
out
);

2871 
zLöe
 = 
	`⁄e_öput_löe
(
ö
, zLöe, 
nSql
>0);

2872 if–
zLöe
==0 ){

2874 if–
°dö_is_öãø˘ive
 ) 
	`¥ötf
("\n");

2877 if–
£íI¡îru±
 ){

2878 if–
ö
!=0 ) ;

2879 
£íI¡îru±
 = 0;

2881 
löío
++;

2882 if–
nSql
==0 && 
	`_Æl_whôe•a˚
(
zLöe
) ) ;

2883 if–
zLöe
 && zLöe[0]=='.' && 
nSql
==0 ){

2884 if–
p
->
echoOn
 ) 
	`¥ötf
("%s\n", 
zLöe
);

2885 
rc
 = 
	`do_mëa_comm™d
(
zLöe
, 
p
);

2886 if–
rc
==2 ){

2888 }if–
rc
 ){

2889 
îrC¡
++;

2893 if–
	`löe_is_comm™d_ãrmö©‹
(
zLöe
Ë&& 
	`löe_is_com∂ëe
(
zSql
, 
nSql
) ){

2894 
	`mem˝y
(
zLöe
,";",2);

2896 
nLöe
 = 
	`°æí30
(
zLöe
);

2897 if–
nSql
+
nLöe
+2>=
nAŒoc
 ){

2898 
nAŒoc
 = 
nSql
+
nLöe
+100;

2899 
zSql
 = 
	`ªÆloc
(zSql, 
nAŒoc
);

2900 if–
zSql
==0 ){

2901 
	`Ârötf
(
°dîr
, "Error: out of memory\n");

2902 
	`exô
(1);

2905 
nSqlPri‹
 = 
nSql
;

2906 if–
nSql
==0 ){

2907 
i
;

2908 
i
=0; 
zLöe
[i] && 
	`IsS∑˚
(zLine[i]); i++){}

2909 
	`as£π
–
nAŒoc
>0 && 
zSql
!=0 );

2910 
	`mem˝y
(
zSql
, 
zLöe
+
i
, 
nLöe
+1-i);

2911 
°¨éöe
 = 
löío
;

2912 
nSql
 = 
nLöe
-
i
;

2914 
zSql
[
nSql
++] = '\n';

2915 
	`mem˝y
(
zSql
+
nSql
, 
zLöe
, 
nLöe
+1);

2916 
nSql
 +
nLöe
;

2918 if–
nSql
 && 
	`löe_c⁄èös_£micﬁ⁄
(&
zSql
[
nSqlPri‹
],ÇSql-nSqlPrior)

2919 && 
	`sqlôe3_com∂ëe
(
zSql
) ){

2920 
p
->
˙t
 = 0;

2921 
	`›í_db
(
p
);

2922 
BEGIN_TIMER
;

2923 
rc
 = 
	`shñl_exec
(
p
->
db
, 
zSql
, 
shñl_ˇŒback
,Ö, &
zEºMsg
);

2924 
END_TIMER
;

2925 if–
rc
 || 
zEºMsg
 ){

2926 
zPªfix
[100];

2927 if–
ö
!=0 || !
°dö_is_öãø˘ive
 ){

2928 
	`sqlôe3_¢¥ötf
((
zPªfix
), zPrefix,

2929 "Eº‹:Çó∏löê%d:", 
°¨éöe
);

2931 
	`sqlôe3_¢¥ötf
((
zPªfix
), zPrefix, "Error:");

2933 if–
zEºMsg
!=0 ){

2934 
	`Ârötf
(
°dîr
, "%†%s\n", 
zPªfix
, 
zEºMsg
);

2935 
	`sqlôe3_‰ì
(
zEºMsg
);

2936 
zEºMsg
 = 0;

2938 
	`Ârötf
(
°dîr
, "%†%s\n", 
zPªfix
, 
	`sqlôe3_îrmsg
(
p
->
db
));

2940 
îrC¡
++;

2942 
nSql
 = 0;

2943 }if–
nSql
 && 
	`_Æl_whôe•a˚
(
zSql
) ){

2944 
nSql
 = 0;

2947 if–
nSql
 ){

2948 if–!
	`_Æl_whôe•a˚
(
zSql
) ){

2949 
	`Ârötf
(
°dîr
, "Eº‹: incom∂ëêSQL: %s\n", 
zSql
);

2951 
	`‰ì
(
zSql
);

2953 
	`‰ì
(
zLöe
);

2954  
îrC¡
>0;

2955 
	}
}

2961 *
	$föd_home_dú
(){

2962 *
home_dú
 = 
NULL
;

2963 if–
home_dú
 )  home_dir;

2965 #i‡!
	`deföed
(
_WIN32
Ë&& !deföed(
WIN32
Ë&& !deföed(
_WIN32_WCE
Ë&& !deföed(
__RTP__
Ë&& !deföed(
_WRS_KERNEL
)

2967 
∑sswd
 *
pwít
;

2968 
uid_t
 
uid
 = 
	`gëuid
();

2969 if–(
pwít
=
	`gëpwuid
(
uid
)Ë!
NULL
) {

2970 
home_dú
 = 
pwít
->
pw_dú
;

2975 #i‡
	`deföed
(
_WIN32_WCE
)

2978 
home_dú
 = "/";

2981 #i‡
	`deföed
(
_WIN32
Ë|| deföed(
WIN32
)

2982 i‡(!
home_dú
) {

2983 
home_dú
 = 
	`gëív
("USERPROFILE");

2987 i‡(!
home_dú
) {

2988 
home_dú
 = 
	`gëív
("HOME");

2991 #i‡
	`deföed
(
_WIN32
Ë|| deföed(
WIN32
)

2992 i‡(!
home_dú
) {

2993 *
zDrive
, *
zP©h
;

2994 
n
;

2995 
zDrive
 = 
	`gëív
("HOMEDRIVE");

2996 
zP©h
 = 
	`gëív
("HOMEPATH");

2997 if–
zDrive
 && 
zP©h
 ){

2998 
n
 = 
	`°æí30
(
zDrive
Ë+ såÀn30(
zP©h
) + 1;

2999 
home_dú
 = 
	`mÆloc
–
n
 );

3000 if–
home_dú
==0 )  0;

3001 
	`sqlôe3_¢¥ötf
(
n
, 
home_dú
, "%s%s", 
zDrive
, 
zP©h
);

3002  
home_dú
;

3004 
home_dú
 = "c:\\";

3010 if–
home_dú
 ){

3011 
n
 = 
	`°æí30
(
home_dú
) + 1;

3012 *
z
 = 
	`mÆloc
–
n
 );

3013 if–
z
 ) 
	`mem˝y
(z, 
home_dú
, 
n
);

3014 
home_dú
 = 
z
;

3017  
home_dú
;

3018 
	}
}

3026 
	$¥o˚ss_sqlôîc
(

3027 
ˇŒback_d©a
 *
p
,

3028 c⁄° *
sqlôîc_ovîride


3030 *
home_dú
 = 
NULL
;

3031 c⁄° *
sqlôîc
 = 
sqlôîc_ovîride
;

3032 *
zBuf
 = 0;

3033 
FILE
 *
ö
 = 
NULL
;

3034 
rc
 = 0;

3036 i‡(
sqlôîc
 =
NULL
) {

3037 
home_dú
 = 
	`föd_home_dú
();

3038 if–
home_dú
==0 ){

3039 #i‡!
	`deföed
(
__RTP__
Ë&& !deföed(
_WRS_KERNEL
)

3040 
	`Ârötf
(
°dîr
,"%s: Eº‹: c™nŸÜoˇã you∏homêdúe˘‹y\n", 
Argv0
);

3044 
	`sqlôe3_öôülize
();

3045 
zBuf
 = 
	`sqlôe3_m¥ötf
("%s/.sqlôîc",
home_dú
);

3046 
sqlôîc
 = 
zBuf
;

3048 
ö
 = 
	`f›í
(
sqlôîc
,"rb");

3049 if–
ö
 ){

3050 if–
°dö_is_öãø˘ive
 ){

3051 
	`Ârötf
(
°dîr
,"-- LﬂdögÑesour˚†‰om %s\n",
sqlôîc
);

3053 
rc
 = 
	`¥o˚ss_öput
(
p
,
ö
);

3054 
	`f˛o£
(
ö
);

3056 
	`sqlôe3_‰ì
(
zBuf
);

3057  
rc
;

3058 
	}
}

3063 c⁄° 
	gzO±i⁄s
[] =

3072 #i‡
deföed
(
SQLITE_ENABLE_MEMSYS3
Ë|| deföed(
SQLITE_ENABLE_MEMSYS5
)

3081 #ifde‡
SQLITE_ENABLE_MULTIPLEX


3089 #ifde‡
SQLITE_ENABLE_VFSTRACE


3093 
	$ußge
(
showDëaû
){

3094 
	`Ârötf
(
°dîr
,

3097 "i‡thêfûêd€†nŸÖªviou¶yÉxi°.\n", 
Argv0
);

3098 if–
showDëaû
 ){

3099 
	`Ârötf
(
°dîr
, "OPTIONS in˛ude:\n%s", 
zO±i⁄s
);

3101 
	`Ârötf
(
°dîr
, "UseÅhe -help option forádditional information\n");

3103 
	`exô
(1);

3104 
	}
}

3109 
	$maö_öô
(
ˇŒback_d©a
 *
d©a
) {

3110 
	`mem£t
(
d©a
, 0, (*data));

3111 
d©a
->
mode
 = 
MODE_Li°
;

3112 
	`mem˝y
(
d©a
->
£∑øt‹
,"|", 2);

3113 
d©a
->
showHódî
 = 0;

3114 
	`sqlôe3_c⁄fig
(
SQLITE_CONFIG_URI
, 1);

3115 
	`sqlôe3_c⁄fig
(
SQLITE_CONFIG_LOG
, 
shñlLog
, 
d©a
);

3116 
	`sqlôe3_¢¥ötf
((
maöProm±
), mainPrompt,"sqlite> ");

3117 
	`sqlôe3_¢¥ötf
((
c⁄töueProm±
), continuePrompt," ...> ");

3118 
	`sqlôe3_c⁄fig
(
SQLITE_CONFIG_SINGLETHREAD
);

3119 
	}
}

3125 *
	$cmdlöe_›ti⁄_vÆue
(
¨gc
, **
¨gv
, 
i
){

3126 if–
i
==
¨gc
 ){

3127 
	`Ârötf
(
°dîr
, "%s: Error: missingárgumentÅo %s\n",

3128 
¨gv
[0],árgv[
¨gc
-1]);

3129 
	`exô
(1);

3131  
¨gv
[
i
];

3132 
	}
}

3134 
	$maö
(
¨gc
, **
¨gv
){

3135 *
zEºMsg
 = 0;

3136 
ˇŒback_d©a
 
d©a
;

3137 c⁄° *
zInôFûe
 = 0;

3138 *
zFú°Cmd
 = 0;

3139 
i
;

3140 
rc
 = 0;

3142 if–
	`°rcmp
(
	`sqlôe3_sour˚id
(),
SQLITE_SOURCE_ID
)!=0 ){

3143 
	`Ârötf
(
°dîr
, "SQLite headeránd source version mismatch\n%s\n%s\n",

3144 
	`sqlôe3_sour˚id
(), 
SQLITE_SOURCE_ID
);

3145 
	`exô
(1);

3147 
Argv0
 = 
¨gv
[0];

3148 
	`maö_öô
(&
d©a
);

3149 
°dö_is_öãø˘ive
 = 
	`ißây
(0);

3154 #ifde‡
SIGINT


3155 
	`sig«l
(
SIGINT
, 
öãºu±_h™dÀr
);

3163 
i
=1; i<
¨gc
; i++){

3164 *
z
;

3165 
z
 = 
¨gv
[
i
];

3166 if–
z
[0]!='-' ){

3167 if–
d©a
.
zDbFûíame
==0 ){

3168 
d©a
.
zDbFûíame
 = 
z
;

3171 if–
zFú°Cmd
==0 ){

3172 
zFú°Cmd
 = 
z
;

3175 
	`Ârötf
(
°dîr
,"%s: Eº‹:Åoÿm™y o±i⁄s: \"%s\"\n", 
Argv0
, 
¨gv
[
i
]);

3176 
	`Ârötf
(
°dîr
,"Use -help foráÜist of options.\n");

3179 if–
z
[1]=='-' ) z++;

3180 if–
	`°rcmp
(
z
,"-separator")==0

3181 || 
	`°rcmp
(
z
,"-nullvalue")==0

3182 || 
	`°rcmp
(
z
,"-cmd")==0

3184 ()
	`cmdlöe_›ti⁄_vÆue
(
¨gc
, 
¨gv
, ++
i
);

3185 }if–
	`°rcmp
(
z
,"-init")==0 ){

3186 
zInôFûe
 = 
	`cmdlöe_›ti⁄_vÆue
(
¨gc
, 
¨gv
, ++
i
);

3187 }if–
	`°rcmp
(
z
,"-batch")==0 ){

3192 
°dö_is_öãø˘ive
 = 0;

3193 }if–
	`°rcmp
(
z
,"-heap")==0 ){

3194 #i‡
	`deföed
(
SQLITE_ENABLE_MEMSYS3
Ë|| deföed(
SQLITE_ENABLE_MEMSYS5
)

3195 c⁄° *
zSize
;

3196 
sqlôe3_öt64
 
szHóp
;

3198 
zSize
 = 
	`cmdlöe_›ti⁄_vÆue
(
¨gc
, 
¨gv
, ++
i
);

3199 
szHóp
 = 
	`öãgîVÆue
(
zSize
);

3200 if–
szHóp
>0x7fff0000 ) szHeap = 0x7fff0000;

3201 
	`sqlôe3_c⁄fig
(
SQLITE_CONFIG_HEAP
, 
	`mÆloc
(()
szHóp
), ()szHeap, 64);

3203 #ifde‡
SQLITE_ENABLE_VFSTRACE


3204 }if–
	`°rcmp
(
z
,"-vfstrace")==0 ){

3205 
	`vf°ø˚_ªgi°î
(

3206 c⁄° *
zTø˚Name
,

3207 c⁄° *
zOldVfsName
,

3208 (*
xOut
)(const *,*),

3209 *
pOutArg
,

3210 
makeDeÁu…


3212 
	`vf°ø˚_ªgi°î
("åa˚",0,((*)(c⁄° *,*))
Âuts
,
°dîr
,1);

3214 #ifde‡
SQLITE_ENABLE_MULTIPLEX


3215 }if–
	`°rcmp
(
z
,"-multiplex")==0 ){

3216 
	`sqlôe3_mu…ùÀ_öôülize
(const *,);

3217 
	`sqlôe3_mu…ùÀx_öôülize
(0, 1);

3219 }if–
	`°rcmp
(
z
,"-mmap")==0 ){

3220 
sqlôe3_öt64
 
sz
 = 
	`öãgîVÆue
(
	`cmdlöe_›ti⁄_vÆue
(
¨gc
,
¨gv
,++
i
));

3221 
	`sqlôe3_c⁄fig
(
SQLITE_CONFIG_MMAP_SIZE
, 
sz
, sz);

3222 }if–
	`°rcmp
(
z
,"-vfs")==0 ){

3223 
sqlôe3_vfs
 *
pVfs
 = 
	`sqlôe3_vfs_föd
(
	`cmdlöe_›ti⁄_vÆue
(
¨gc
,
¨gv
,++
i
));

3224 if–
pVfs
 ){

3225 
	`sqlôe3_vfs_ªgi°î
(
pVfs
, 1);

3227 
	`Ârötf
(
°dîr
, "nÿsuch VFS: \"%s\"\n", 
¨gv
[
i
]);

3228 
	`exô
(1);

3232 if–
d©a
.
zDbFûíame
==0 ){

3233 #i‚de‡
SQLITE_OMIT_MEMORYDB


3234 
d©a
.
zDbFûíame
 = ":memory:";

3236 
	`Ârötf
(
°dîr
,"%s: Eº‹:Çÿd©aba£ fûíamê•ecifõd\n", 
Argv0
);

3240 
d©a
.
out
 = 
°dout
;

3247 if–
	`ac˚ss
(
d©a
.
zDbFûíame
, 0)==0 ){

3248 
	`›í_db
(&
d©a
);

3255 
rc
 = 
	`¥o˚ss_sqlôîc
(&
d©a
,
zInôFûe
);

3256 if–
rc
>0 ){

3257  
rc
;

3265 
i
=1; i<
¨gc
; i++){

3266 *
z
 = 
¨gv
[
i
];

3267 if–
z
[0]!='-' ) ;

3268 if–
z
[1]=='-' ){ z++; }

3269 if–
	`°rcmp
(
z
,"-init")==0 ){

3270 
i
++;

3271 }if–
	`°rcmp
(
z
,"-html")==0 ){

3272 
d©a
.
mode
 = 
MODE_Html
;

3273 }if–
	`°rcmp
(
z
,"-list")==0 ){

3274 
d©a
.
mode
 = 
MODE_Li°
;

3275 }if–
	`°rcmp
(
z
,"-line")==0 ){

3276 
d©a
.
mode
 = 
MODE_Löe
;

3277 }if–
	`°rcmp
(
z
,"-column")==0 ){

3278 
d©a
.
mode
 = 
MODE_Cﬁumn
;

3279 }if–
	`°rcmp
(
z
,"-csv")==0 ){

3280 
d©a
.
mode
 = 
MODE_Csv
;

3281 
	`mem˝y
(
d©a
.
£∑øt‹
,",",2);

3282 }if–
	`°rcmp
(
z
,"-separator")==0 ){

3283 
	`sqlôe3_¢¥ötf
((
d©a
.
£∑øt‹
), data.separator,

3284 "%s",
	`cmdlöe_›ti⁄_vÆue
(
¨gc
,
¨gv
,++
i
));

3285 }if–
	`°rcmp
(
z
,"-nullvalue")==0 ){

3286 
	`sqlôe3_¢¥ötf
((
d©a
.
nuŒvÆue
), data.nullvalue,

3287 "%s",
	`cmdlöe_›ti⁄_vÆue
(
¨gc
,
¨gv
,++
i
));

3288 }if–
	`°rcmp
(
z
,"-header")==0 ){

3289 
d©a
.
showHódî
 = 1;

3290 }if–
	`°rcmp
(
z
,"-noheader")==0 ){

3291 
d©a
.
showHódî
 = 0;

3292 }if–
	`°rcmp
(
z
,"-echo")==0 ){

3293 
d©a
.
echoOn
 = 1;

3294 }if–
	`°rcmp
(
z
,"-stats")==0 ){

3295 
d©a
.
°©sOn
 = 1;

3296 }if–
	`°rcmp
(
z
,"-bail")==0 ){

3297 
baû_⁄_îr‹
 = 1;

3298 }if–
	`°rcmp
(
z
,"-version")==0 ){

3299 
	`¥ötf
("%†%s\n", 
	`sqlôe3_libvîsi⁄
(), 
	`sqlôe3_sour˚id
());

3301 }if–
	`°rcmp
(
z
,"-interactive")==0 ){

3302 
°dö_is_öãø˘ive
 = 1;

3303 }if–
	`°rcmp
(
z
,"-batch")==0 ){

3304 
°dö_is_öãø˘ive
 = 0;

3305 }if–
	`°rcmp
(
z
,"-heap")==0 ){

3306 
i
++;

3307 }if–
	`°rcmp
(
z
,"-mmap")==0 ){

3308 
i
++;

3309 }if–
	`°rcmp
(
z
,"-vfs")==0 ){

3310 
i
++;

3311 #ifde‡
SQLITE_ENABLE_VFSTRACE


3312 }if–
	`°rcmp
(
z
,"-vfstrace")==0 ){

3313 
i
++;

3315 #ifde‡
SQLITE_ENABLE_MULTIPLEX


3316 }if–
	`°rcmp
(
z
,"-multiplex")==0 ){

3317 
i
++;

3319 }if–
	`°rcmp
(
z
,"-help")==0 ){

3320 
	`ußge
(1);

3321 }if–
	`°rcmp
(
z
,"-cmd")==0 ){

3322 if–
i
==
¨gc
-1 ) ;

3323 
z
 = 
	`cmdlöe_›ti⁄_vÆue
(
¨gc
,
¨gv
,++
i
);

3324 if–
z
[0]=='.' ){

3325 
rc
 = 
	`do_mëa_comm™d
(
z
, &
d©a
);

3326 if–
rc
 && 
baû_⁄_îr‹
 ) Ñc==2 ? 0 :Ñc;

3328 
	`›í_db
(&
d©a
);

3329 
rc
 = 
	`shñl_exec
(
d©a
.
db
, 
z
, 
shñl_ˇŒback
, &d©a, &
zEºMsg
);

3330 if–
zEºMsg
!=0 ){

3331 
	`Ârötf
(
°dîr
,"Eº‹: %s\n", 
zEºMsg
);

3332 if–
baû_⁄_îr‹
 )  
rc
!=0 ?Ñc : 1;

3333 }if–
rc
!=0 ){

3334 
	`Ârötf
(
°dîr
,"Eº‹: u«bÀÅÿ¥o˚s†SQL \"%s\"\n", 
z
);

3335 if–
baû_⁄_îr‹
 )  
rc
;

3339 
	`Ârötf
(
°dîr
,"%s: Eº‹: unknow¿›ti⁄: %s\n", 
Argv0
, 
z
);

3340 
	`Ârötf
(
°dîr
,"Use -help foráÜist of options.\n");

3345 if–
zFú°Cmd
 ){

3348 if–
zFú°Cmd
[0]=='.' ){

3349 
rc
 = 
	`do_mëa_comm™d
(
zFú°Cmd
, &
d©a
);

3350 if–
rc
==2 )Ñc = 0;

3352 
	`›í_db
(&
d©a
);

3353 
rc
 = 
	`shñl_exec
(
d©a
.
db
, 
zFú°Cmd
, 
shñl_ˇŒback
, &d©a, &
zEºMsg
);

3354 if–
zEºMsg
!=0 ){

3355 
	`Ârötf
(
°dîr
,"Eº‹: %s\n", 
zEºMsg
);

3356  
rc
!=0 ?Ñc : 1;

3357 }if–
rc
!=0 ){

3358 
	`Ârötf
(
°dîr
,"Eº‹: u«bÀÅÿ¥o˚s†SQL \"%s\"\n", 
zFú°Cmd
);

3359  
rc
;

3365 if–
°dö_is_öãø˘ive
 ){

3366 *
zHome
;

3367 *
zHi°‹y
 = 0;

3368 
nHi°‹y
;

3369 
	`¥ötf
(

3373 
	`sqlôe3_libvîsi⁄
(), 
	`sqlôe3_sour˚id
()

3375 
zHome
 = 
	`föd_home_dú
();

3376 if–
zHome
 ){

3377 
nHi°‹y
 = 
	`°æí30
(
zHome
) + 20;

3378 if–(
zHi°‹y
 = 
	`mÆloc
(
nHi°‹y
))!=0 ){

3379 
	`sqlôe3_¢¥ötf
(
nHi°‹y
, 
zHi°‹y
,"%s/.sqlôe_hi°‹y", 
zHome
);

3382 #i‡
	`deföed
(
HAVE_READLINE
) && HAVE_READLINE==1

3383 if–
zHi°‹y
 ) 
	`ªad_hi°‹y
(zHistory);

3385 
rc
 = 
	`¥o˚ss_öput
(&
d©a
, 0);

3386 if–
zHi°‹y
 ){

3387 
	`°iÊe_hi°‹y
(100);

3388 
	`wrôe_hi°‹y
(
zHi°‹y
);

3389 
	`‰ì
(
zHi°‹y
);

3392 
rc
 = 
	`¥o˚ss_öput
(&
d©a
, 
°dö
);

3395 
	`£t_èbÀ_«me
(&
d©a
, 0);

3396 if–
d©a
.
db
 ){

3397 
	`sqlôe3_˛o£
(
d©a
.
db
);

3399  
rc
;

3400 
	}
}

	@sqlite3.c

20 
	#SQLITE_CORE
 1

	)

21 
	#SQLITE_AMALGAMATION
 1

	)

22 #i‚de‡
SQLITE_PRIVATE


23 
	#SQLITE_PRIVATE
 

	)

25 #i‚de‡
SQLITE_API


26 
	#SQLITE_API


	)

61 #i‚de‡
_SQLITE3_H_


62 
	#_SQLITE3_H_


	)

63 
	~<°d¨g.h
>

76 #i‚de‡
SQLITE_EXTERN


77 
	#SQLITE_EXTERN
 

	)

80 #i‚de‡
SQLITE_API


81 
	#SQLITE_API


	)

98 
	#SQLITE_DEPRECATED


	)

99 
	#SQLITE_EXPERIMENTAL


	)

104 #ifde‡
SQLITE_VERSION


105 #unde‡
SQLITE_VERSION


107 #ifde‡
SQLITE_VERSION_NUMBER


108 #unde‡
SQLITE_VERSION_NUMBER


138 
	#SQLITE_VERSION
 "3.8.1"

	)

139 
	#SQLITE_VERSION_NUMBER
 3008001

	)

140 
	#SQLITE_SOURCE_ID
 "2013-10-17 12:57:35 c78be6d786c19073b3a6730d„3fb1be54f5657a"

	)

172 
SQLITE_API
 c⁄° 
sqlôe3_vîsi⁄
[] = 
SQLITE_VERSION
;

173 
SQLITE_API
 c⁄° *
sqlôe3_libvîsi⁄
();

174 
SQLITE_API
 c⁄° *
sqlôe3_sour˚id
();

175 
SQLITE_API
 
sqlôe3_libvîsi⁄_numbî
();

199 #i‚de‡
SQLITE_OMIT_COMPILEOPTION_DIAGS


200 
SQLITE_API
 
sqlôe3_compûe›ti⁄_u£d
(c⁄° *
zO±Name
);

201 
SQLITE_API
 c⁄° *
sqlôe3_compûe›ti⁄_gë
(
N
);

240 
SQLITE_API
 
sqlôe3_thªadß„
();

256 
sqlôe3
 
	tsqlôe3
;

274 #ifde‡
SQLITE_INT64_TYPE


275 
SQLITE_INT64_TYPE
 
	tsqlôe_öt64
;

276 
	tSQLITE_INT64_TYPE
 
	tsqlôe_uöt64
;

277 #ñi‡
deföed
(
_MSC_VER
Ë|| deföed(
__BORLANDC__
)

278 
__öt64
 
	tsqlôe_öt64
;

279 
	t__öt64
 
	tsqlôe_uöt64
;

281 
	tsqlôe_öt64
;

282 
	tsqlôe_uöt64
;

284 
sqlôe_öt64
 
	tsqlôe3_öt64
;

285 
sqlôe_uöt64
 
	tsqlôe3_uöt64
;

291 #ifde‡
SQLITE_OMIT_FLOATING_POINT


292 
sqlôe3_öt64


	)

336 
SQLITE_API
 
sqlôe3_˛o£
(
sqlôe3
*);

337 
SQLITE_API
 
sqlôe3_˛o£_v2
(
sqlôe3
*);

344 (*
sqlôe3_ˇŒback
)(*,,**, **);

407 
SQLITE_API
 
sqlôe3_exec
(

408 
sqlôe3
*,

409 c⁄° *
sql
,

410 (*
ˇŒback
)(*,,**,**),

412 **
îrmsg


428 
	#SQLITE_OK
 0

	)

430 
	#SQLITE_ERROR
 1

	)

431 
	#SQLITE_INTERNAL
 2

	)

432 
	#SQLITE_PERM
 3

	)

433 
	#SQLITE_ABORT
 4

	)

434 
	#SQLITE_BUSY
 5

	)

435 
	#SQLITE_LOCKED
 6

	)

436 
	#SQLITE_NOMEM
 7

	)

437 
	#SQLITE_READONLY
 8

	)

438 
	#SQLITE_INTERRUPT
 9

	)

439 
	#SQLITE_IOERR
 10

	)

440 
	#SQLITE_CORRUPT
 11

	)

441 
	#SQLITE_NOTFOUND
 12

	)

442 
	#SQLITE_FULL
 13

	)

443 
	#SQLITE_CANTOPEN
 14

	)

444 
	#SQLITE_PROTOCOL
 15

	)

445 
	#SQLITE_EMPTY
 16

	)

446 
	#SQLITE_SCHEMA
 17

	)

447 
	#SQLITE_TOOBIG
 18

	)

448 
	#SQLITE_CONSTRAINT
 19

	)

449 
	#SQLITE_MISMATCH
 20

	)

450 
	#SQLITE_MISUSE
 21

	)

451 
	#SQLITE_NOLFS
 22

	)

452 
	#SQLITE_AUTH
 23

	)

453 
	#SQLITE_FORMAT
 24

	)

454 
	#SQLITE_RANGE
 25

	)

455 
	#SQLITE_NOTADB
 26

	)

456 
	#SQLITE_NOTICE
 27

	)

457 
	#SQLITE_WARNING
 28

	)

458 
	#SQLITE_ROW
 100

	)

459 
	#SQLITE_DONE
 101

	)

485 
	#SQLITE_IOERR_READ
 (
SQLITE_IOERR
 | (1<<8))

	)

486 
	#SQLITE_IOERR_SHORT_READ
 (
SQLITE_IOERR
 | (2<<8))

	)

487 
	#SQLITE_IOERR_WRITE
 (
SQLITE_IOERR
 | (3<<8))

	)

488 
	#SQLITE_IOERR_FSYNC
 (
SQLITE_IOERR
 | (4<<8))

	)

489 
	#SQLITE_IOERR_DIR_FSYNC
 (
SQLITE_IOERR
 | (5<<8))

	)

490 
	#SQLITE_IOERR_TRUNCATE
 (
SQLITE_IOERR
 | (6<<8))

	)

491 
	#SQLITE_IOERR_FSTAT
 (
SQLITE_IOERR
 | (7<<8))

	)

492 
	#SQLITE_IOERR_UNLOCK
 (
SQLITE_IOERR
 | (8<<8))

	)

493 
	#SQLITE_IOERR_RDLOCK
 (
SQLITE_IOERR
 | (9<<8))

	)

494 
	#SQLITE_IOERR_DELETE
 (
SQLITE_IOERR
 | (10<<8))

	)

495 
	#SQLITE_IOERR_BLOCKED
 (
SQLITE_IOERR
 | (11<<8))

	)

496 
	#SQLITE_IOERR_NOMEM
 (
SQLITE_IOERR
 | (12<<8))

	)

497 
	#SQLITE_IOERR_ACCESS
 (
SQLITE_IOERR
 | (13<<8))

	)

498 
	#SQLITE_IOERR_CHECKRESERVEDLOCK
 (
SQLITE_IOERR
 | (14<<8))

	)

499 
	#SQLITE_IOERR_LOCK
 (
SQLITE_IOERR
 | (15<<8))

	)

500 
	#SQLITE_IOERR_CLOSE
 (
SQLITE_IOERR
 | (16<<8))

	)

501 
	#SQLITE_IOERR_DIR_CLOSE
 (
SQLITE_IOERR
 | (17<<8))

	)

502 
	#SQLITE_IOERR_SHMOPEN
 (
SQLITE_IOERR
 | (18<<8))

	)

503 
	#SQLITE_IOERR_SHMSIZE
 (
SQLITE_IOERR
 | (19<<8))

	)

504 
	#SQLITE_IOERR_SHMLOCK
 (
SQLITE_IOERR
 | (20<<8))

	)

505 
	#SQLITE_IOERR_SHMMAP
 (
SQLITE_IOERR
 | (21<<8))

	)

506 
	#SQLITE_IOERR_SEEK
 (
SQLITE_IOERR
 | (22<<8))

	)

507 
	#SQLITE_IOERR_DELETE_NOENT
 (
SQLITE_IOERR
 | (23<<8))

	)

508 
	#SQLITE_IOERR_MMAP
 (
SQLITE_IOERR
 | (24<<8))

	)

509 
	#SQLITE_IOERR_GETTEMPPATH
 (
SQLITE_IOERR
 | (25<<8))

	)

510 
	#SQLITE_IOERR_CONVPATH
 (
SQLITE_IOERR
 | (26<<8))

	)

511 
	#SQLITE_LOCKED_SHAREDCACHE
 (
SQLITE_LOCKED
 | (1<<8))

	)

512 
	#SQLITE_BUSY_RECOVERY
 (
SQLITE_BUSY
 | (1<<8))

	)

513 
	#SQLITE_BUSY_SNAPSHOT
 (
SQLITE_BUSY
 | (2<<8))

	)

514 
	#SQLITE_CANTOPEN_NOTEMPDIR
 (
SQLITE_CANTOPEN
 | (1<<8))

	)

515 
	#SQLITE_CANTOPEN_ISDIR
 (
SQLITE_CANTOPEN
 | (2<<8))

	)

516 
	#SQLITE_CANTOPEN_FULLPATH
 (
SQLITE_CANTOPEN
 | (3<<8))

	)

517 
	#SQLITE_CANTOPEN_CONVPATH
 (
SQLITE_CANTOPEN
 | (4<<8))

	)

518 
	#SQLITE_CORRUPT_VTAB
 (
SQLITE_CORRUPT
 | (1<<8))

	)

519 
	#SQLITE_READONLY_RECOVERY
 (
SQLITE_READONLY
 | (1<<8))

	)

520 
	#SQLITE_READONLY_CANTLOCK
 (
SQLITE_READONLY
 | (2<<8))

	)

521 
	#SQLITE_READONLY_ROLLBACK
 (
SQLITE_READONLY
 | (3<<8))

	)

522 
	#SQLITE_ABORT_ROLLBACK
 (
SQLITE_ABORT
 | (2<<8))

	)

523 
	#SQLITE_CONSTRAINT_CHECK
 (
SQLITE_CONSTRAINT
 | (1<<8))

	)

524 
	#SQLITE_CONSTRAINT_COMMITHOOK
 (
SQLITE_CONSTRAINT
 | (2<<8))

	)

525 
	#SQLITE_CONSTRAINT_FOREIGNKEY
 (
SQLITE_CONSTRAINT
 | (3<<8))

	)

526 
	#SQLITE_CONSTRAINT_FUNCTION
 (
SQLITE_CONSTRAINT
 | (4<<8))

	)

527 
	#SQLITE_CONSTRAINT_NOTNULL
 (
SQLITE_CONSTRAINT
 | (5<<8))

	)

528 
	#SQLITE_CONSTRAINT_PRIMARYKEY
 (
SQLITE_CONSTRAINT
 | (6<<8))

	)

529 
	#SQLITE_CONSTRAINT_TRIGGER
 (
SQLITE_CONSTRAINT
 | (7<<8))

	)

530 
	#SQLITE_CONSTRAINT_UNIQUE
 (
SQLITE_CONSTRAINT
 | (8<<8))

	)

531 
	#SQLITE_CONSTRAINT_VTAB
 (
SQLITE_CONSTRAINT
 | (9<<8))

	)

532 
	#SQLITE_NOTICE_RECOVER_WAL
 (
SQLITE_NOTICE
 | (1<<8))

	)

533 
	#SQLITE_NOTICE_RECOVER_ROLLBACK
 (
SQLITE_NOTICE
 | (2<<8))

	)

534 
	#SQLITE_WARNING_AUTOINDEX
 (
SQLITE_WARNING
 | (1<<8))

	)

543 
	#SQLITE_OPEN_READONLY
 0x00000001

	)

544 
	#SQLITE_OPEN_READWRITE
 0x00000002

	)

545 
	#SQLITE_OPEN_CREATE
 0x00000004

	)

546 
	#SQLITE_OPEN_DELETEONCLOSE
 0x00000008

	)

547 
	#SQLITE_OPEN_EXCLUSIVE
 0x00000010

	)

548 
	#SQLITE_OPEN_AUTOPROXY
 0x00000020

	)

549 
	#SQLITE_OPEN_URI
 0x00000040

	)

550 
	#SQLITE_OPEN_MEMORY
 0x00000080

	)

551 
	#SQLITE_OPEN_MAIN_DB
 0x00000100

	)

552 
	#SQLITE_OPEN_TEMP_DB
 0x00000200

	)

553 
	#SQLITE_OPEN_TRANSIENT_DB
 0x00000400

	)

554 
	#SQLITE_OPEN_MAIN_JOURNAL
 0x00000800

	)

555 
	#SQLITE_OPEN_TEMP_JOURNAL
 0x00001000

	)

556 
	#SQLITE_OPEN_SUBJOURNAL
 0x00002000

	)

557 
	#SQLITE_OPEN_MASTER_JOURNAL
 0x00004000

	)

558 
	#SQLITE_OPEN_NOMUTEX
 0x00008000

	)

559 
	#SQLITE_OPEN_FULLMUTEX
 0x00010000

	)

560 
	#SQLITE_OPEN_SHAREDCACHE
 0x00020000

	)

561 
	#SQLITE_OPEN_PRIVATECACHE
 0x00040000

	)

562 
	#SQLITE_OPEN_WAL
 0x00080000

	)

590 
	#SQLITE_IOCAP_ATOMIC
 0x00000001

	)

591 
	#SQLITE_IOCAP_ATOMIC512
 0x00000002

	)

592 
	#SQLITE_IOCAP_ATOMIC1K
 0x00000004

	)

593 
	#SQLITE_IOCAP_ATOMIC2K
 0x00000008

	)

594 
	#SQLITE_IOCAP_ATOMIC4K
 0x00000010

	)

595 
	#SQLITE_IOCAP_ATOMIC8K
 0x00000020

	)

596 
	#SQLITE_IOCAP_ATOMIC16K
 0x00000040

	)

597 
	#SQLITE_IOCAP_ATOMIC32K
 0x00000080

	)

598 
	#SQLITE_IOCAP_ATOMIC64K
 0x00000100

	)

599 
	#SQLITE_IOCAP_SAFE_APPEND
 0x00000200

	)

600 
	#SQLITE_IOCAP_SEQUENTIAL
 0x00000400

	)

601 
	#SQLITE_IOCAP_UNDELETABLE_WHEN_OPEN
 0x00000800

	)

602 
	#SQLITE_IOCAP_POWERSAFE_OVERWRITE
 0x00001000

	)

611 
	#SQLITE_LOCK_NONE
 0

	)

612 
	#SQLITE_LOCK_SHARED
 1

	)

613 
	#SQLITE_LOCK_RESERVED
 2

	)

614 
	#SQLITE_LOCK_PENDING
 3

	)

615 
	#SQLITE_LOCK_EXCLUSIVE
 4

	)

643 
	#SQLITE_SYNC_NORMAL
 0x00002

	)

644 
	#SQLITE_SYNC_FULL
 0x00003

	)

645 
	#SQLITE_SYNC_DATAONLY
 0x00010

	)

658 
sqlôe3_fûe
 
	tsqlôe3_fûe
;

659 
	ssqlôe3_fûe
 {

660 c⁄° 
sqlôe3_io_mëhods
 *
pMëhods
;

753 
sqlôe3_io_mëhods
 
	tsqlôe3_io_mëhods
;

754 
	ssqlôe3_io_mëhods
 {

755 
iVîsi⁄
;

756 (*
xClo£
)(
sqlôe3_fûe
*);

757 (*
xRód
)(
sqlôe3_fûe
*, *, 
iAmt
, 
sqlôe3_öt64
 
iOf°
);

758 (*
xWrôe
)(
sqlôe3_fûe
*, c⁄° *, 
iAmt
, 
sqlôe3_öt64
 
iOf°
);

759 (*
xTrunˇã
)(
sqlôe3_fûe
*, 
sqlôe3_öt64
 
size
);

760 (*
xSync
)(
sqlôe3_fûe
*, 
Êags
);

761 (*
xFûeSize
)(
sqlôe3_fûe
*, 
sqlôe3_öt64
 *
pSize
);

762 (*
xLock
)(
sqlôe3_fûe
*, );

763 (*
xU∆ock
)(
sqlôe3_fûe
*, );

764 (*
xCheckRe£rvedLock
)(
sqlôe3_fûe
*, *
pResOut
);

765 (*
xFûeC⁄åﬁ
)(
sqlôe3_fûe
*, 
›
, *
pArg
);

766 (*
xSe˘‹Size
)(
sqlôe3_fûe
*);

767 (*
xDevi˚Ch¨a˘îi°ics
)(
sqlôe3_fûe
*);

769 (*
xShmM≠
)(
sqlôe3_fûe
*, 
iPg
, 
pgsz
, , volatile**);

770 (*
xShmLock
)(
sqlôe3_fûe
*, 
off£t
, 
n
, 
Êags
);

771 (*
xShmB¨rõr
)(
sqlôe3_fûe
*);

772 (*
xShmUnm≠
)(
sqlôe3_fûe
*, 
dñëeFœg
);

774 (*
xFëch
)(
sqlôe3_fûe
*, 
sqlôe3_öt64
 
iOf°
, 
iAmt
, **
µ
);

775 (*
xUn„tch
)(
sqlôe3_fûe
*, 
sqlôe3_öt64
 
iOf°
, *
p
);

945 
	#SQLITE_FCNTL_LOCKSTATE
 1

	)

946 
	#SQLITE_GET_LOCKPROXYFILE
 2

	)

947 
	#SQLITE_SET_LOCKPROXYFILE
 3

	)

948 
	#SQLITE_LAST_ERRNO
 4

	)

949 
	#SQLITE_FCNTL_SIZE_HINT
 5

	)

950 
	#SQLITE_FCNTL_CHUNK_SIZE
 6

	)

951 
	#SQLITE_FCNTL_FILE_POINTER
 7

	)

952 
	#SQLITE_FCNTL_SYNC_OMITTED
 8

	)

953 
	#SQLITE_FCNTL_WIN32_AV_RETRY
 9

	)

954 
	#SQLITE_FCNTL_PERSIST_WAL
 10

	)

955 
	#SQLITE_FCNTL_OVERWRITE
 11

	)

956 
	#SQLITE_FCNTL_VFSNAME
 12

	)

957 
	#SQLITE_FCNTL_POWERSAFE_OVERWRITE
 13

	)

958 
	#SQLITE_FCNTL_PRAGMA
 14

	)

959 
	#SQLITE_FCNTL_BUSYHANDLER
 15

	)

960 
	#SQLITE_FCNTL_TEMPFILENAME
 16

	)

961 
	#SQLITE_FCNTL_MMAP_SIZE
 18

	)

973 
sqlôe3_muãx
 
	tsqlôe3_muãx
;

1132 
sqlôe3_vfs
 
	tsqlôe3_vfs
;

1133 (*
sqlôe3_sysˇŒ_±r
)();

1134 
	ssqlôe3_vfs
 {

1135 
iVîsi⁄
;

1136 
szOsFûe
;

1137 
mxP©h«me
;

1138 
sqlôe3_vfs
 *
pNext
;

1139 c⁄° *
zName
;

1140 *
pAµD©a
;

1141 (*
xO≥n
)(
sqlôe3_vfs
*, c⁄° *
zName
, 
sqlôe3_fûe
*,

1142 
Êags
, *
pOutFœgs
);

1143 (*
xDñëe
)(
sqlôe3_vfs
*, c⁄° *
zName
, 
syncDú
);

1144 (*
xAc˚ss
)(
sqlôe3_vfs
*, c⁄° *
zName
, 
Êags
, *
pResOut
);

1145 (*
xFuŒP©h«me
)(
sqlôe3_vfs
*, c⁄° *
zName
, 
nOut
, *
zOut
);

1146 *(*
xDlO≥n
)(
sqlôe3_vfs
*, c⁄° *
zFûíame
);

1147 (*
xDlEº‹
)(
sqlôe3_vfs
*, 
nByã
, *
zEºMsg
);

1148 (*(*
xDlSym
)(
sqlôe3_vfs
*,*, c⁄° *
zSymbﬁ
))();

1149 (*
xDlClo£
)(
sqlôe3_vfs
*, *);

1150 (*
xR™dom√ss
)(
sqlôe3_vfs
*, 
nByã
, *
zOut
);

1151 (*
xSÀï
)(
sqlôe3_vfs
*, 
mi¸o£c⁄ds
);

1152 (*
xCuºítTime
)(
sqlôe3_vfs
*, *);

1153 (*
xGëLa°Eº‹
)(
sqlôe3_vfs
*, , *);

1158 (*
xCuºítTimeI¡64
)(
sqlôe3_vfs
*, 
sqlôe3_öt64
*);

1163 (*
xSëSy°emCÆl
)(
sqlôe3_vfs
*, c⁄° *
zName
, 
sqlôe3_sysˇŒ_±r
);

1164 
sqlôe3_sysˇŒ_±r
 (*
xGëSy°emCÆl
)(
sqlôe3_vfs
*, c⁄° *
zName
);

1165 c⁄° *(*
xNextSy°emCÆl
)(
sqlôe3_vfs
*, c⁄° *
zName
);

1193 
	#SQLITE_ACCESS_EXISTS
 0

	)

1194 
	#SQLITE_ACCESS_READWRITE
 1

	)

1195 
	#SQLITE_ACCESS_READ
 2

	)

1219 
	#SQLITE_SHM_UNLOCK
 1

	)

1220 
	#SQLITE_SHM_LOCK
 2

	)

1221 
	#SQLITE_SHM_SHARED
 4

	)

1222 
	#SQLITE_SHM_EXCLUSIVE
 8

	)

1232 
	#SQLITE_SHM_NLOCK
 8

	)

1310 
SQLITE_API
 
sqlôe3_öôülize
();

1311 
SQLITE_API
 
sqlôe3_shutdown
();

1312 
SQLITE_API
 
sqlôe3_os_öô
();

1313 
SQLITE_API
 
sqlôe3_os_íd
();

1344 
SQLITE_API
 
sqlôe3_c⁄fig
(, ...);

1362 
SQLITE_API
 
sqlôe3_db_c⁄fig
(
sqlôe3
*, 
›
, ...);

1427 
sqlôe3_mem_mëhods
 
	tsqlôe3_mem_mëhods
;

1428 
	ssqlôe3_mem_mëhods
 {

1429 *(*
xMÆloc
)();

1430 (*
xFªe
)(*);

1431 *(*
xRóŒoc
)(*,);

1432 (*
xSize
)(*);

1433 (*
xRoundup
)();

1434 (*
xInô
)(*);

1435 (*
xShutdown
)(*);

1436 *
pAµD©a
;

1710 
	#SQLITE_CONFIG_SINGLETHREAD
 1

	)

1711 
	#SQLITE_CONFIG_MULTITHREAD
 2

	)

1712 
	#SQLITE_CONFIG_SERIALIZED
 3

	)

1713 
	#SQLITE_CONFIG_MALLOC
 4

	)

1714 
	#SQLITE_CONFIG_GETMALLOC
 5

	)

1715 
	#SQLITE_CONFIG_SCRATCH
 6

	)

1716 
	#SQLITE_CONFIG_PAGECACHE
 7

	)

1717 
	#SQLITE_CONFIG_HEAP
 8

	)

1718 
	#SQLITE_CONFIG_MEMSTATUS
 9

	)

1719 
	#SQLITE_CONFIG_MUTEX
 10

	)

1720 
	#SQLITE_CONFIG_GETMUTEX
 11

	)

1722 
	#SQLITE_CONFIG_LOOKASIDE
 13

	)

1723 
	#SQLITE_CONFIG_PCACHE
 14

	)

1724 
	#SQLITE_CONFIG_GETPCACHE
 15

	)

1725 
	#SQLITE_CONFIG_LOG
 16

	)

1726 
	#SQLITE_CONFIG_URI
 17

	)

1727 
	#SQLITE_CONFIG_PCACHE2
 18

	)

1728 
	#SQLITE_CONFIG_GETPCACHE2
 19

	)

1729 
	#SQLITE_CONFIG_COVERING_INDEX_SCAN
 20

	)

1730 
	#SQLITE_CONFIG_SQLLOG
 21

	)

1731 
	#SQLITE_CONFIG_MMAP_SIZE
 22

	)

1791 
	#SQLITE_DBCONFIG_LOOKASIDE
 1001

	)

1792 
	#SQLITE_DBCONFIG_ENABLE_FKEY
 1002

	)

1793 
	#SQLITE_DBCONFIG_ENABLE_TRIGGER
 1003

	)

1803 
SQLITE_API
 
sqlôe3_exãnded_ªsu…_codes
(
sqlôe3
*, 
⁄off
);

1852 
SQLITE_API
 
sqlôe3_öt64
 
sqlôe3_œ°_ö£π_rowid
(
sqlôe3
*);

1906 
SQLITE_API
 
sqlôe3_ch™ges
(
sqlôe3
*);

1932 
SQLITE_API
 
sqlôe3_tŸÆ_ch™ges
(
sqlôe3
*);

1971 
SQLITE_API
 
sqlôe3_öãºu±
(
sqlôe3
*);

2006 
SQLITE_API
 
sqlôe3_com∂ëe
(c⁄° *
sql
);

2007 
SQLITE_API
 
sqlôe3_com∂ëe16
(c⁄° *
sql
);

2073 
SQLITE_API
 
sqlôe3_busy_h™dÀr
(
sqlôe3
*, (*)(*,), *);

2093 
SQLITE_API
 
sqlôe3_busy_timeout
(
sqlôe3
*, 
ms
);

2167 
SQLITE_API
 
sqlôe3_gë_èbÀ
(

2168 
sqlôe3
 *
db
,

2169 c⁄° *
zSql
,

2170 ***
∑zResu…
,

2171 *
≤Row
,

2172 *
≤Cﬁumn
,

2173 **
pzEºmsg


2175 
SQLITE_API
 
sqlôe3_‰ì_èbÀ
(**
ªsu…
);

2271 
SQLITE_API
 *
sqlôe3_m¥ötf
(const *,...);

2272 
SQLITE_API
 *
sqlôe3_vm¥ötf
(c⁄° *, 
va_li°
);

2273 
SQLITE_API
 *
sqlôe3_¢¥ötf
(,*,const *, ...);

2274 
SQLITE_API
 *
sqlôe3_v¢¥ötf
(,*,c⁄° *, 
va_li°
);

2346 
SQLITE_API
 *
sqlôe3_mÆloc
();

2347 
SQLITE_API
 *
sqlôe3_ªÆloc
(*, );

2348 
SQLITE_API
 
sqlôe3_‰ì
(*);

2373 
SQLITE_API
 
sqlôe3_öt64
 
sqlôe3_mem‹y_u£d
();

2374 
SQLITE_API
 
sqlôe3_öt64
 
sqlôe3_mem‹y_highw©î
(
ª£tFœg
);

2394 
SQLITE_API
 
sqlôe3_øndom√ss
(
N
, *
P
);

2476 
SQLITE_API
 
sqlôe3_£t_auth‹izî
(

2477 
sqlôe3
*,

2478 (*
xAuth
)(*,,const *,const *,const *,const *),

2479 *
pU£rD©a


2494 
	#SQLITE_DENY
 1

	)

2495 
	#SQLITE_IGNORE
 2

	)

2517 
	#SQLITE_CREATE_INDEX
 1

	)

2518 
	#SQLITE_CREATE_TABLE
 2

	)

2519 
	#SQLITE_CREATE_TEMP_INDEX
 3

	)

2520 
	#SQLITE_CREATE_TEMP_TABLE
 4

	)

2521 
	#SQLITE_CREATE_TEMP_TRIGGER
 5

	)

2522 
	#SQLITE_CREATE_TEMP_VIEW
 6

	)

2523 
	#SQLITE_CREATE_TRIGGER
 7

	)

2524 
	#SQLITE_CREATE_VIEW
 8

	)

2525 
	#SQLITE_DELETE
 9

	)

2526 
	#SQLITE_DROP_INDEX
 10

	)

2527 
	#SQLITE_DROP_TABLE
 11

	)

2528 
	#SQLITE_DROP_TEMP_INDEX
 12

	)

2529 
	#SQLITE_DROP_TEMP_TABLE
 13

	)

2530 
	#SQLITE_DROP_TEMP_TRIGGER
 14

	)

2531 
	#SQLITE_DROP_TEMP_VIEW
 15

	)

2532 
	#SQLITE_DROP_TRIGGER
 16

	)

2533 
	#SQLITE_DROP_VIEW
 17

	)

2534 
	#SQLITE_INSERT
 18

	)

2535 
	#SQLITE_PRAGMA
 19

	)

2536 
	#SQLITE_READ
 20

	)

2537 
	#SQLITE_SELECT
 21

	)

2538 
	#SQLITE_TRANSACTION
 22

	)

2539 
	#SQLITE_UPDATE
 23

	)

2540 
	#SQLITE_ATTACH
 24

	)

2541 
	#SQLITE_DETACH
 25

	)

2542 
	#SQLITE_ALTER_TABLE
 26

	)

2543 
	#SQLITE_REINDEX
 27

	)

2544 
	#SQLITE_ANALYZE
 28

	)

2545 
	#SQLITE_CREATE_VTABLE
 29

	)

2546 
	#SQLITE_DROP_VTABLE
 30

	)

2547 
	#SQLITE_FUNCTION
 31

	)

2548 
	#SQLITE_SAVEPOINT
 32

	)

2549 
	#SQLITE_COPY
 0

	)

2579 
SQLITE_API
 *
sqlôe3_åa˚
(
sqlôe3
*, (*
xTø˚
)(*,const *), *);

2580 
SQLITE_API
 
SQLITE_EXPERIMENTAL
 *
sqlôe3_¥ofûe
(
sqlôe3
*,

2581 (*
xProfûe
)(*,c⁄° *,
sqlôe3_uöt64
), *);

2614 
SQLITE_API
 
sqlôe3_¥ogªss_h™dÀr
(
sqlôe3
*, , (*)(*), *);

2818 
SQLITE_API
 
sqlôe3_›í
(

2819 c⁄° *
fûíame
,

2820 
sqlôe3
 **
µDb


2822 
SQLITE_API
 
sqlôe3_›í16
(

2823 c⁄° *
fûíame
,

2824 
sqlôe3
 **
µDb


2826 
SQLITE_API
 
sqlôe3_›í_v2
(

2827 c⁄° *
fûíame
,

2828 
sqlôe3
 **
µDb
,

2829 
Êags
,

2830 c⁄° *
zVfs


2872 
SQLITE_API
 c⁄° *
sqlôe3_uri_∑ømëî
(c⁄° *
zFûíame
, c⁄° *
zP¨am
);

2873 
SQLITE_API
 
sqlôe3_uri_boﬁón
(c⁄° *
zFûe
, c⁄° *
zP¨am
, 
bDeÁu…
);

2874 
SQLITE_API
 
sqlôe3_öt64
 
sqlôe3_uri_öt64
(const *, const *, sqlite3_int64);

2915 
SQLITE_API
 
sqlôe3_îrcode
(
sqlôe3
 *
db
);

2916 
SQLITE_API
 
sqlôe3_exãnded_îrcode
(
sqlôe3
 *
db
);

2917 
SQLITE_API
 c⁄° *
sqlôe3_îrmsg
(
sqlôe3
*);

2918 
SQLITE_API
 c⁄° *
sqlôe3_îrmsg16
(
sqlôe3
*);

2919 
SQLITE_API
 c⁄° *
sqlôe3_îr°r
();

2945 
sqlôe3_°mt
 
	tsqlôe3_°mt
;

2986 
SQLITE_API
 
sqlôe3_limô
(
sqlôe3
*, 
id
, 
√wVÆ
);

3040 
	#SQLITE_LIMIT_LENGTH
 0

	)

3041 
	#SQLITE_LIMIT_SQL_LENGTH
 1

	)

3042 
	#SQLITE_LIMIT_COLUMN
 2

	)

3043 
	#SQLITE_LIMIT_EXPR_DEPTH
 3

	)

3044 
	#SQLITE_LIMIT_COMPOUND_SELECT
 4

	)

3045 
	#SQLITE_LIMIT_VDBE_OP
 5

	)

3046 
	#SQLITE_LIMIT_FUNCTION_ARG
 6

	)

3047 
	#SQLITE_LIMIT_ATTACHED
 7

	)

3048 
	#SQLITE_LIMIT_LIKE_PATTERN_LENGTH
 8

	)

3049 
	#SQLITE_LIMIT_VARIABLE_NUMBER
 9

	)

3050 
	#SQLITE_LIMIT_TRIGGER_DEPTH
 10

	)

3134 
SQLITE_API
 
sqlôe3_¥ï¨e
(

3135 
sqlôe3
 *
db
,

3136 c⁄° *
zSql
,

3137 
nByã
,

3138 
sqlôe3_°mt
 **
µStmt
,

3139 c⁄° **
pzTaû


3141 
SQLITE_API
 
sqlôe3_¥ï¨e_v2
(

3142 
sqlôe3
 *
db
,

3143 c⁄° *
zSql
,

3144 
nByã
,

3145 
sqlôe3_°mt
 **
µStmt
,

3146 c⁄° **
pzTaû


3148 
SQLITE_API
 
sqlôe3_¥ï¨e16
(

3149 
sqlôe3
 *
db
,

3150 c⁄° *
zSql
,

3151 
nByã
,

3152 
sqlôe3_°mt
 **
µStmt
,

3153 c⁄° **
pzTaû


3155 
SQLITE_API
 
sqlôe3_¥ï¨e16_v2
(

3156 
sqlôe3
 *
db
,

3157 c⁄° *
zSql
,

3158 
nByã
,

3159 
sqlôe3_°mt
 **
µStmt
,

3160 c⁄° **
pzTaû


3170 
SQLITE_API
 c⁄° *
sqlôe3_sql
(
sqlôe3_°mt
 *
pStmt
);

3201 
SQLITE_API
 
sqlôe3_°mt_ªad⁄ly
(
sqlôe3_°mt
 *
pStmt
);

3220 
SQLITE_API
 
sqlôe3_°mt_busy
(
sqlôe3_°mt
*);

3259 
Mem
 
	tsqlôe3_vÆue
;

3273 
sqlôe3_c⁄ãxt
 
	tsqlôe3_c⁄ãxt
;

3370 
SQLITE_API
 
sqlôe3_böd_blob
(
sqlôe3_°mt
*, , c⁄° *, 
n
, (*)(*));

3371 
SQLITE_API
 
sqlôe3_böd_doubÀ
(
sqlôe3_°mt
*, , );

3372 
SQLITE_API
 
sqlôe3_böd_öt
(
sqlôe3_°mt
*, , );

3373 
SQLITE_API
 
sqlôe3_böd_öt64
(
sqlôe3_°mt
*, , 
sqlôe3_öt64
);

3374 
SQLITE_API
 
sqlôe3_böd_nuŒ
(
sqlôe3_°mt
*, );

3375 
SQLITE_API
 
sqlôe3_böd_ãxt
(
sqlôe3_°mt
*, , c⁄° *, 
n
, (*)(*));

3376 
SQLITE_API
 
sqlôe3_böd_ãxt16
(
sqlôe3_°mt
*, , const *, , (*)(*));

3377 
SQLITE_API
 
sqlôe3_böd_vÆue
(
sqlôe3_°mt
*, , c⁄° 
sqlôe3_vÆue
*);

3378 
SQLITE_API
 
sqlôe3_böd_zîoblob
(
sqlôe3_°mt
*, , 
n
);

3398 
SQLITE_API
 
sqlôe3_böd_∑ømëî_cou¡
(
sqlôe3_°mt
*);

3425 
SQLITE_API
 c⁄° *
sqlôe3_böd_∑ømëî_«me
(
sqlôe3_°mt
*, );

3441 
SQLITE_API
 
sqlôe3_böd_∑ømëî_ödex
(
sqlôe3_°mt
*, c⁄° *
zName
);

3450 
SQLITE_API
 
sqlôe3_˛ór_bödögs
(
sqlôe3_°mt
*);

3461 
SQLITE_API
 
sqlôe3_cﬁumn_cou¡
(
sqlôe3_°mt
 *
pStmt
);

3489 
SQLITE_API
 c⁄° *
sqlôe3_cﬁumn_«me
(
sqlôe3_°mt
*, 
N
);

3490 
SQLITE_API
 c⁄° *
sqlôe3_cﬁumn_«me16
(
sqlôe3_°mt
*, 
N
);

3537 
SQLITE_API
 c⁄° *
sqlôe3_cﬁumn_d©aba£_«me
(
sqlôe3_°mt
*,);

3538 
SQLITE_API
 c⁄° *
sqlôe3_cﬁumn_d©aba£_«me16
(
sqlôe3_°mt
*,);

3539 
SQLITE_API
 c⁄° *
sqlôe3_cﬁumn_èbÀ_«me
(
sqlôe3_°mt
*,);

3540 
SQLITE_API
 c⁄° *
sqlôe3_cﬁumn_èbÀ_«me16
(
sqlôe3_°mt
*,);

3541 
SQLITE_API
 c⁄° *
sqlôe3_cﬁumn_‹igö_«me
(
sqlôe3_°mt
*,);

3542 
SQLITE_API
 c⁄° *
sqlôe3_cﬁumn_‹igö_«me16
(
sqlôe3_°mt
*,);

3573 
SQLITE_API
 c⁄° *
sqlôe3_cﬁumn_de˛ty≥
(
sqlôe3_°mt
*,);

3574 
SQLITE_API
 c⁄° *
sqlôe3_cﬁumn_de˛ty≥16
(
sqlôe3_°mt
*,);

3653 
SQLITE_API
 
sqlôe3_°ï
(
sqlôe3_°mt
*);

3673 
SQLITE_API
 
sqlôe3_d©a_cou¡
(
sqlôe3_°mt
 *
pStmt
);

3696 
	#SQLITE_INTEGER
 1

	)

3697 
	#SQLITE_FLOAT
 2

	)

3698 
	#SQLITE_BLOB
 4

	)

3699 
	#SQLITE_NULL
 5

	)

3700 #ifde‡
SQLITE_TEXT


3701 #unde‡
SQLITE_TEXT


3703 
	#SQLITE_TEXT
 3

	)

3705 
	#SQLITE3_TEXT
 3

	)

3869 
SQLITE_API
 c⁄° *
sqlôe3_cﬁumn_blob
(
sqlôe3_°mt
*, 
iCﬁ
);

3870 
SQLITE_API
 
sqlôe3_cﬁumn_byãs
(
sqlôe3_°mt
*, 
iCﬁ
);

3871 
SQLITE_API
 
sqlôe3_cﬁumn_byãs16
(
sqlôe3_°mt
*, 
iCﬁ
);

3872 
SQLITE_API
 
sqlôe3_cﬁumn_doubÀ
(
sqlôe3_°mt
*, 
iCﬁ
);

3873 
SQLITE_API
 
sqlôe3_cﬁumn_öt
(
sqlôe3_°mt
*, 
iCﬁ
);

3874 
SQLITE_API
 
sqlôe3_öt64
 
sqlôe3_cﬁumn_öt64
(
sqlôe3_°mt
*, 
iCﬁ
);

3875 
SQLITE_API
 c⁄° *
sqlôe3_cﬁumn_ãxt
(
sqlôe3_°mt
*, 
iCﬁ
);

3876 
SQLITE_API
 c⁄° *
sqlôe3_cﬁumn_ãxt16
(
sqlôe3_°mt
*, 
iCﬁ
);

3877 
SQLITE_API
 
sqlôe3_cﬁumn_ty≥
(
sqlôe3_°mt
*, 
iCﬁ
);

3878 
SQLITE_API
 
sqlôe3_vÆue
 *
sqlôe3_cﬁumn_vÆue
(
sqlôe3_°mt
*, 
iCﬁ
);

3905 
SQLITE_API
 
sqlôe3_föÆize
(
sqlôe3_°mt
 *
pStmt
);

3931 
SQLITE_API
 
sqlôe3_ª£t
(
sqlôe3_°mt
 *
pStmt
);

4021 
SQLITE_API
 
sqlôe3_¸óã_fun˘i⁄
(

4022 
sqlôe3
 *
db
,

4023 c⁄° *
zFun˘i⁄Name
,

4024 
nArg
,

4025 
eTextRï
,

4026 *
pAµ
,

4027 (*
xFunc
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
**),

4028 (*
xSãp
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
**),

4029 (*
xFöÆ
)(
sqlôe3_c⁄ãxt
*)

4031 
SQLITE_API
 
sqlôe3_¸óã_fun˘i⁄16
(

4032 
sqlôe3
 *
db
,

4033 c⁄° *
zFun˘i⁄Name
,

4034 
nArg
,

4035 
eTextRï
,

4036 *
pAµ
,

4037 (*
xFunc
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
**),

4038 (*
xSãp
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
**),

4039 (*
xFöÆ
)(
sqlôe3_c⁄ãxt
*)

4041 
SQLITE_API
 
sqlôe3_¸óã_fun˘i⁄_v2
(

4042 
sqlôe3
 *
db
,

4043 c⁄° *
zFun˘i⁄Name
,

4044 
nArg
,

4045 
eTextRï
,

4046 *
pAµ
,

4047 (*
xFunc
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
**),

4048 (*
xSãp
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
**),

4049 (*
xFöÆ
)(
sqlôe3_c⁄ãxt
*),

4050 (*
xDe°roy
)(*)

4059 
	#SQLITE_UTF8
 1

	)

4060 
	#SQLITE_UTF16LE
 2

	)

4061 
	#SQLITE_UTF16BE
 3

	)

4062 
	#SQLITE_UTF16
 4

	)

4063 
	#SQLITE_ANY
 5

	)

4064 
	#SQLITE_UTF16_ALIGNED
 8

	)

4076 #i‚de‡
SQLITE_OMIT_DEPRECATED


4077 
SQLITE_API
 
SQLITE_DEPRECATED
 
sqlôe3_aggªg©e_cou¡
(
sqlôe3_c⁄ãxt
*);

4078 
SQLITE_API
 
SQLITE_DEPRECATED
 
sqlôe3_expúed
(
sqlôe3_°mt
*);

4079 
SQLITE_API
 
SQLITE_DEPRECATED
 
sqlôe3_å™s„r_bödögs
(
sqlôe3_°mt
*, sqlite3_stmt*);

4080 
SQLITE_API
 
SQLITE_DEPRECATED
 
sqlôe3_globÆ_ªcovî
();

4081 
SQLITE_API
 
SQLITE_DEPRECATED
 
sqlôe3_thªad_˛ónup
();

4082 
SQLITE_API
 
SQLITE_DEPRECATED
 
sqlôe3_mem‹y_Æ¨m
((*)(*,
sqlôe3_öt64
,),

4083 *,
sqlôe3_öt64
);

4131 
SQLITE_API
 c⁄° *
sqlôe3_vÆue_blob
(
sqlôe3_vÆue
*);

4132 
SQLITE_API
 
sqlôe3_vÆue_byãs
(
sqlôe3_vÆue
*);

4133 
SQLITE_API
 
sqlôe3_vÆue_byãs16
(
sqlôe3_vÆue
*);

4134 
SQLITE_API
 
sqlôe3_vÆue_doubÀ
(
sqlôe3_vÆue
*);

4135 
SQLITE_API
 
sqlôe3_vÆue_öt
(
sqlôe3_vÆue
*);

4136 
SQLITE_API
 
sqlôe3_öt64
 
sqlôe3_vÆue_öt64
(
sqlôe3_vÆue
*);

4137 
SQLITE_API
 c⁄° *
sqlôe3_vÆue_ãxt
(
sqlôe3_vÆue
*);

4138 
SQLITE_API
 c⁄° *
sqlôe3_vÆue_ãxt16
(
sqlôe3_vÆue
*);

4139 
SQLITE_API
 c⁄° *
sqlôe3_vÆue_ãxt16À
(
sqlôe3_vÆue
*);

4140 
SQLITE_API
 c⁄° *
sqlôe3_vÆue_ãxt16be
(
sqlôe3_vÆue
*);

4141 
SQLITE_API
 
sqlôe3_vÆue_ty≥
(
sqlôe3_vÆue
*);

4142 
SQLITE_API
 
sqlôe3_vÆue_numîic_ty≥
(
sqlôe3_vÆue
*);

4186 
SQLITE_API
 *
sqlôe3_aggªg©e_c⁄ãxt
(
sqlôe3_c⁄ãxt
*, 
nByãs
);

4200 
SQLITE_API
 *
sqlôe3_u£r_d©a
(
sqlôe3_c⁄ãxt
*);

4211 
SQLITE_API
 
sqlôe3
 *
sqlôe3_c⁄ãxt_db_h™dÀ
(
sqlôe3_c⁄ãxt
*);

4263 
SQLITE_API
 *
sqlôe3_gë_auxd©a
(
sqlôe3_c⁄ãxt
*, 
N
);

4264 
SQLITE_API
 
sqlôe3_£t_auxd©a
(
sqlôe3_c⁄ãxt
*, 
N
, *, (*)(*));

4281 (*
sqlôe3_de°ru˘‹_ty≥
)(*);

4282 
	#SQLITE_STATIC
 ((
sqlôe3_de°ru˘‹_ty≥
)0)

	)

4283 
	#SQLITE_TRANSIENT
 ((
sqlôe3_de°ru˘‹_ty≥
)-1)

	)

4395 
SQLITE_API
 
sqlôe3_ªsu…_blob
(
sqlôe3_c⁄ãxt
*, const *, , (*)(*));

4396 
SQLITE_API
 
sqlôe3_ªsu…_doubÀ
(
sqlôe3_c⁄ãxt
*, );

4397 
SQLITE_API
 
sqlôe3_ªsu…_îr‹
(
sqlôe3_c⁄ãxt
*, const *, );

4398 
SQLITE_API
 
sqlôe3_ªsu…_îr‹16
(
sqlôe3_c⁄ãxt
*, const *, );

4399 
SQLITE_API
 
sqlôe3_ªsu…_îr‹_toobig
(
sqlôe3_c⁄ãxt
*);

4400 
SQLITE_API
 
sqlôe3_ªsu…_îr‹_nomem
(
sqlôe3_c⁄ãxt
*);

4401 
SQLITE_API
 
sqlôe3_ªsu…_îr‹_code
(
sqlôe3_c⁄ãxt
*, );

4402 
SQLITE_API
 
sqlôe3_ªsu…_öt
(
sqlôe3_c⁄ãxt
*, );

4403 
SQLITE_API
 
sqlôe3_ªsu…_öt64
(
sqlôe3_c⁄ãxt
*, 
sqlôe3_öt64
);

4404 
SQLITE_API
 
sqlôe3_ªsu…_nuŒ
(
sqlôe3_c⁄ãxt
*);

4405 
SQLITE_API
 
sqlôe3_ªsu…_ãxt
(
sqlôe3_c⁄ãxt
*, const *, , (*)(*));

4406 
SQLITE_API
 
sqlôe3_ªsu…_ãxt16
(
sqlôe3_c⁄ãxt
*, const *, , (*)(*));

4407 
SQLITE_API
 
sqlôe3_ªsu…_ãxt16À
(
sqlôe3_c⁄ãxt
*, const *, ,(*)(*));

4408 
SQLITE_API
 
sqlôe3_ªsu…_ãxt16be
(
sqlôe3_c⁄ãxt
*, const *, ,(*)(*));

4409 
SQLITE_API
 
sqlôe3_ªsu…_vÆue
(
sqlôe3_c⁄ãxt
*, 
sqlôe3_vÆue
*);

4410 
SQLITE_API
 
sqlôe3_ªsu…_zîoblob
(
sqlôe3_c⁄ãxt
*, 
n
);

4491 
SQLITE_API
 
sqlôe3_¸óã_cﬁœti⁄
(

4492 
sqlôe3
*,

4493 c⁄° *
zName
,

4494 
eTextRï
,

4495 *
pArg
,

4496 (*
xCom∑ª
)(*,,const *,,const *)

4498 
SQLITE_API
 
sqlôe3_¸óã_cﬁœti⁄_v2
(

4499 
sqlôe3
*,

4500 c⁄° *
zName
,

4501 
eTextRï
,

4502 *
pArg
,

4503 (*
xCom∑ª
)(*,,const *,,const *),

4504 (*
xDe°roy
)(*)

4506 
SQLITE_API
 
sqlôe3_¸óã_cﬁœti⁄16
(

4507 
sqlôe3
*,

4508 c⁄° *
zName
,

4509 
eTextRï
,

4510 *
pArg
,

4511 (*
xCom∑ª
)(*,,const *,,const *)

4540 
SQLITE_API
 
sqlôe3_cﬁœti⁄_√eded
(

4541 
sqlôe3
*,

4543 (*)(*,
sqlôe3
*,
eTextRï
,const *)

4545 
SQLITE_API
 
sqlôe3_cﬁœti⁄_√eded16
(

4546 
sqlôe3
*,

4548 (*)(*,
sqlôe3
*,
eTextRï
,const *)

4551 #ifde‡
SQLITE_HAS_CODEC


4559 
SQLITE_API
 
sqlôe3_key
(

4560 
sqlôe3
 *
db
,

4561 c⁄° *
pKey
, 
nKey


4563 
SQLITE_API
 
sqlôe3_key_v2
(

4564 
sqlôe3
 *
db
,

4565 c⁄° *
zDbName
,

4566 c⁄° *
pKey
, 
nKey


4577 
SQLITE_API
 
sqlôe3_ªkey
(

4578 
sqlôe3
 *
db
,

4579 c⁄° *
pKey
, 
nKey


4581 
SQLITE_API
 
sqlôe3_ªkey_v2
(

4582 
sqlôe3
 *
db
,

4583 c⁄° *
zDbName
,

4584 c⁄° *
pKey
, 
nKey


4591 
SQLITE_API
 
sqlôe3_a˘iv©e_£e
(

4592 c⁄° *
zPassPhø£


4596 #ifde‡
SQLITE_ENABLE_CEROD


4601 
SQLITE_API
 
sqlôe3_a˘iv©e_˚rod
(

4602 c⁄° *
zPassPhø£


4623 
SQLITE_API
 
sqlôe3_¶ìp
();

4669 
SQLITE_API
 *
sqlôe3_ãmp_dúe˘‹y
;

4706 
SQLITE_API
 *
sqlôe3_d©a_dúe˘‹y
;

4729 
SQLITE_API
 
sqlôe3_gë_autocommô
(
sqlôe3
*);

4741 
SQLITE_API
 
sqlôe3
 *
sqlôe3_db_h™dÀ
(
sqlôe3_°mt
*);

4757 
SQLITE_API
 c⁄° *
sqlôe3_db_fûíame
(
sqlôe3
 *
db
, c⁄° *
zDbName
);

4766 
SQLITE_API
 
sqlôe3_db_ªad⁄ly
(
sqlôe3
 *
db
, c⁄° *
zDbName
);

4781 
SQLITE_API
 
sqlôe3_°mt
 *
sqlôe3_√xt_°mt
(
sqlôe3
 *
pDb
, sqlôe3_°mà*
pStmt
);

4829 
SQLITE_API
 *
sqlôe3_commô_hook
(
sqlôe3
*, (*)(*), *);

4830 
SQLITE_API
 *
sqlôe3_rﬁlback_hook
(
sqlôe3
*, (*)(*), *);

4878 
SQLITE_API
 *
sqlôe3_upd©e_hook
(

4879 
sqlôe3
*,

4880 (*)(*,,c⁄° *,c⁄° *,
sqlôe3_öt64
),

4913 
SQLITE_API
 
sqlôe3_íabÀ_sh¨ed_ˇche
();

4929 
SQLITE_API
 
sqlôe3_ªÀa£_mem‹y
();

4942 
SQLITE_API
 
sqlôe3_db_ªÀa£_mem‹y
(
sqlôe3
*);

4994 
SQLITE_API
 
sqlôe3_öt64
 
sqlôe3_so·_hóp_limô64
(sqlôe3_öt64 
N
);

5005 
SQLITE_API
 
SQLITE_DEPRECATED
 
sqlôe3_so·_hóp_limô
(
N
);

5070 
SQLITE_API
 
sqlôe3_èbÀ_cﬁumn_mëad©a
(

5071 
sqlôe3
 *
db
,

5072 c⁄° *
zDbName
,

5073 c⁄° *
zTabÀName
,

5074 c⁄° *
zCﬁumnName
,

5075 c⁄° **
pzD©aTy≥
,

5076 c⁄° **
pzCﬁlSeq
,

5077 *
pNŸNuŒ
,

5078 *
pPrim¨yKey
,

5079 *
pAutoöc


5116 
SQLITE_API
 
sqlôe3_lﬂd_exãnsi⁄
(

5117 
sqlôe3
 *
db
,

5118 c⁄° *
zFûe
,

5119 c⁄° *
zProc
,

5120 **
pzEºMsg


5136 
SQLITE_API
 
sqlôe3_íabÀ_lﬂd_exãnsi⁄
(
sqlôe3
 *
db
, 
⁄off
);

5174 
SQLITE_API
 
sqlôe3_auto_exãnsi⁄
((*
xE¡ryPoöt
)());

5186 
SQLITE_API
 
sqlôe3_ˇn˚l_auto_exãnsi⁄
((*
xE¡ryPoöt
)());

5194 
SQLITE_API
 
sqlôe3_ª£t_auto_exãnsi⁄
();

5208 
sqlôe3_vèb
 
	tsqlôe3_vèb
;

5209 
sqlôe3_ödex_öfo
 
	tsqlôe3_ödex_öfo
;

5210 
sqlôe3_vèb_curs‹
 
	tsqlôe3_vèb_curs‹
;

5211 
sqlôe3_moduÀ
 
	tsqlôe3_moduÀ
;

5229 
	ssqlôe3_moduÀ
 {

5230 
iVîsi⁄
;

5231 (*
xCª©e
)(
sqlôe3
*, *
pAux
,

5232 
¨gc
, c⁄° *c⁄°*
¨gv
,

5233 
sqlôe3_vèb
 **
µVTab
, **);

5234 (*
xC⁄√˘
)(
sqlôe3
*, *
pAux
,

5235 
¨gc
, c⁄° *c⁄°*
¨gv
,

5236 
sqlôe3_vèb
 **
µVTab
, **);

5237 (*
xBe°Index
)(
sqlôe3_vèb
 *
pVTab
, 
sqlôe3_ödex_öfo
*);

5238 (*
xDisc⁄√˘
)(
sqlôe3_vèb
 *
pVTab
);

5239 (*
xDe°roy
)(
sqlôe3_vèb
 *
pVTab
);

5240 (*
xO≥n
)(
sqlôe3_vèb
 *
pVTab
, 
sqlôe3_vèb_curs‹
 **
µCurs‹
);

5241 (*
xClo£
)(
sqlôe3_vèb_curs‹
*);

5242 (*
xFûãr
)(
sqlôe3_vèb_curs‹
*, 
idxNum
, c⁄° *
idxSå
,

5243 
¨gc
, 
sqlôe3_vÆue
 **
¨gv
);

5244 (*
xNext
)(
sqlôe3_vèb_curs‹
*);

5245 (*
xEof
)(
sqlôe3_vèb_curs‹
*);

5246 (*
xCﬁumn
)(
sqlôe3_vèb_curs‹
*, 
sqlôe3_c⁄ãxt
*, );

5247 (*
xRowid
)(
sqlôe3_vèb_curs‹
*, 
sqlôe3_öt64
 *
pRowid
);

5248 (*
xUpd©e
)(
sqlôe3_vèb
 *, , 
sqlôe3_vÆue
 **, 
sqlôe3_öt64
 *);

5249 (*
xBegö
)(
sqlôe3_vèb
 *
pVTab
);

5250 (*
xSync
)(
sqlôe3_vèb
 *
pVTab
);

5251 (*
xCommô
)(
sqlôe3_vèb
 *
pVTab
);

5252 (*
xRﬁlback
)(
sqlôe3_vèb
 *
pVTab
);

5253 (*
xFödFun˘i⁄
)(
sqlôe3_vèb
 *
pVèb
, 
nArg
, c⁄° *
zName
,

5254 (**
pxFunc
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
**),

5255 **
µArg
);

5256 (*
xRíame
)(
sqlôe3_vèb
 *
pVèb
, c⁄° *
zNew
);

5259 (*
xSavïoöt
)(
sqlôe3_vèb
 *
pVTab
, );

5260 (*
xRñó£
)(
sqlôe3_vèb
 *
pVTab
, );

5261 (*
xRﬁlbackTo
)(
sqlôe3_vèb
 *
pVTab
, );

5317 
	ssqlôe3_ödex_öfo
 {

5319 
nC⁄°øöt
;

5320 
	ssqlôe3_ödex_c⁄°øöt
 {

5321 
iCﬁumn
;

5322 
›
;

5323 
ußbÀ
;

5324 
iTîmOff£t
;

5325 } *
aC⁄°øöt
;

5326 
nOrdîBy
;

5327 
	ssqlôe3_ödex_‹dîby
 {

5328 
iCﬁumn
;

5329 
desc
;

5330 } *
aOrdîBy
;

5332 
	ssqlôe3_ödex_c⁄°øöt_ußge
 {

5333 
¨gvIndex
;

5334 
omô
;

5335 } *
aC⁄°øötUßge
;

5336 
idxNum
;

5337 *
idxSå
;

5338 
√edToFªeIdxSå
;

5339 
‹dîByC⁄sumed
;

5340 
e°im©edCo°
;

5351 
	#SQLITE_INDEX_CONSTRAINT_EQ
 2

	)

5352 
	#SQLITE_INDEX_CONSTRAINT_GT
 4

	)

5353 
	#SQLITE_INDEX_CONSTRAINT_LE
 8

	)

5354 
	#SQLITE_INDEX_CONSTRAINT_LT
 16

	)

5355 
	#SQLITE_INDEX_CONSTRAINT_GE
 32

	)

5356 
	#SQLITE_INDEX_CONSTRAINT_MATCH
 64

	)

5383 
SQLITE_API
 
sqlôe3_¸óã_moduÀ
(

5384 
sqlôe3
 *
db
,

5385 c⁄° *
zName
,

5386 c⁄° 
sqlôe3_moduÀ
 *
p
,

5387 *
pClõ¡D©a


5389 
SQLITE_API
 
sqlôe3_¸óã_moduÀ_v2
(

5390 
sqlôe3
 *
db
,

5391 c⁄° *
zName
,

5392 c⁄° 
sqlôe3_moduÀ
 *
p
,

5393 *
pClõ¡D©a
,

5394 (*
xDe°roy
)(*)

5415 
	ssqlôe3_vèb
 {

5416 c⁄° 
sqlôe3_moduÀ
 *
pModuÀ
;

5417 
nRef
;

5418 *
zEºMsg
;

5439 
	ssqlôe3_vèb_curs‹
 {

5440 
sqlôe3_vèb
 *
pVèb
;

5452 
SQLITE_API
 
sqlôe3_de˛¨e_vèb
(
sqlôe3
*, c⁄° *
zSQL
);

5470 
SQLITE_API
 
sqlôe3_ovîlﬂd_fun˘i⁄
(
sqlôe3
*, c⁄° *
zFuncName
, 
nArg
);

5494 
sqlôe3_blob
 
	tsqlôe3_blob
;

5552 
SQLITE_API
 
sqlôe3_blob_›í
(

5553 
sqlôe3
*,

5554 c⁄° *
zDb
,

5555 c⁄° *
zTabÀ
,

5556 c⁄° *
zCﬁumn
,

5557 
sqlôe3_öt64
 
iRow
,

5558 
Êags
,

5559 
sqlôe3_blob
 **
µBlob


5584 
SQLITE_API
 
SQLITE_EXPERIMENTAL
 
sqlôe3_blob_ª›í
(
sqlôe3_blob
 *, 
sqlôe3_öt64
);

5608 
SQLITE_API
 
sqlôe3_blob_˛o£
(
sqlôe3_blob
 *);

5623 
SQLITE_API
 
sqlôe3_blob_byãs
(
sqlôe3_blob
 *);

5651 
SQLITE_API
 
sqlôe3_blob_ªad
(
sqlôe3_blob
 *, *
Z
, 
N
, 
iOff£t
);

5689 
SQLITE_API
 
sqlôe3_blob_wrôe
(
sqlôe3_blob
 *, c⁄° *
z
, 
n
, 
iOff£t
);

5720 
SQLITE_API
 
sqlôe3_vfs
 *
sqlôe3_vfs_föd
(c⁄° *
zVfsName
);

5721 
SQLITE_API
 
sqlôe3_vfs_ªgi°î
(
sqlôe3_vfs
*, 
makeDÊt
);

5722 
SQLITE_API
 
sqlôe3_vfs_uƒegi°î
(
sqlôe3_vfs
*);

5837 
SQLITE_API
 
sqlôe3_muãx
 *
sqlôe3_muãx_Æloc
();

5838 
SQLITE_API
 
sqlôe3_muãx_‰ì
(
sqlôe3_muãx
*);

5839 
SQLITE_API
 
sqlôe3_muãx_íãr
(
sqlôe3_muãx
*);

5840 
SQLITE_API
 
sqlôe3_muãx_åy
(
sqlôe3_muãx
*);

5841 
SQLITE_API
 
sqlôe3_muãx_Àave
(
sqlôe3_muãx
*);

5908 
sqlôe3_muãx_mëhods
 
	tsqlôe3_muãx_mëhods
;

5909 
	ssqlôe3_muãx_mëhods
 {

5910 (*
xMuãxInô
)();

5911 (*
xMuãxEnd
)();

5912 
sqlôe3_muãx
 *(*
xMuãxAŒoc
)();

5913 (*
xMuãxFªe
)(
sqlôe3_muãx
 *);

5914 (*
xMuãxE¡î
)(
sqlôe3_muãx
 *);

5915 (*
xMuãxTry
)(
sqlôe3_muãx
 *);

5916 (*
xMuãxLóve
)(
sqlôe3_muãx
 *);

5917 (*
xMuãxHñd
)(
sqlôe3_muãx
 *);

5918 (*
xMuãxNŸhñd
)(
sqlôe3_muãx
 *);

5950 #i‚de‡
NDEBUG


5951 
SQLITE_API
 
sqlôe3_muãx_hñd
(
sqlôe3_muãx
*);

5952 
SQLITE_API
 
sqlôe3_muãx_nŸhñd
(
sqlôe3_muãx
*);

5965 
	#SQLITE_MUTEX_FAST
 0

	)

5966 
	#SQLITE_MUTEX_RECURSIVE
 1

	)

5967 
	#SQLITE_MUTEX_STATIC_MASTER
 2

	)

5968 
	#SQLITE_MUTEX_STATIC_MEM
 3

	)

5969 
	#SQLITE_MUTEX_STATIC_MEM2
 4

	)

5970 
	#SQLITE_MUTEX_STATIC_OPEN
 4

	)

5971 
	#SQLITE_MUTEX_STATIC_PRNG
 5

	)

5972 
	#SQLITE_MUTEX_STATIC_LRU
 6

	)

5973 
	#SQLITE_MUTEX_STATIC_LRU2
 7

	)

5974 
	#SQLITE_MUTEX_STATIC_PMEM
 7

	)

5985 
SQLITE_API
 
sqlôe3_muãx
 *
sqlôe3_db_muãx
(
sqlôe3
*);

6019 
SQLITE_API
 
sqlôe3_fûe_c⁄åﬁ
(
sqlôe3
*, c⁄° *
zDbName
, 
›
, *);

6038 
SQLITE_API
 
sqlôe3_ã°_c⁄åﬁ
(
›
, ...);

6051 
	#SQLITE_TESTCTRL_FIRST
 5

	)

6052 
	#SQLITE_TESTCTRL_PRNG_SAVE
 5

	)

6053 
	#SQLITE_TESTCTRL_PRNG_RESTORE
 6

	)

6054 
	#SQLITE_TESTCTRL_PRNG_RESET
 7

	)

6055 
	#SQLITE_TESTCTRL_BITVEC_TEST
 8

	)

6056 
	#SQLITE_TESTCTRL_FAULT_INSTALL
 9

	)

6057 
	#SQLITE_TESTCTRL_BENIGN_MALLOC_HOOKS
 10

	)

6058 
	#SQLITE_TESTCTRL_PENDING_BYTE
 11

	)

6059 
	#SQLITE_TESTCTRL_ASSERT
 12

	)

6060 
	#SQLITE_TESTCTRL_ALWAYS
 13

	)

6061 
	#SQLITE_TESTCTRL_RESERVE
 14

	)

6062 
	#SQLITE_TESTCTRL_OPTIMIZATIONS
 15

	)

6063 
	#SQLITE_TESTCTRL_ISKEYWORD
 16

	)

6064 
	#SQLITE_TESTCTRL_SCRATCHMALLOC
 17

	)

6065 
	#SQLITE_TESTCTRL_LOCALTIME_FAULT
 18

	)

6066 
	#SQLITE_TESTCTRL_EXPLAIN_STMT
 19

	)

6067 
	#SQLITE_TESTCTRL_LAST
 19

	)

6098 
SQLITE_API
 
sqlôe3_°©us
(
›
, *
pCuºít
, *
pHighw©î
, 
ª£tFœg
);

6183 
	#SQLITE_STATUS_MEMORY_USED
 0

	)

6184 
	#SQLITE_STATUS_PAGECACHE_USED
 1

	)

6185 
	#SQLITE_STATUS_PAGECACHE_OVERFLOW
 2

	)

6186 
	#SQLITE_STATUS_SCRATCH_USED
 3

	)

6187 
	#SQLITE_STATUS_SCRATCH_OVERFLOW
 4

	)

6188 
	#SQLITE_STATUS_MALLOC_SIZE
 5

	)

6189 
	#SQLITE_STATUS_PARSER_STACK
 6

	)

6190 
	#SQLITE_STATUS_PAGECACHE_SIZE
 7

	)

6191 
	#SQLITE_STATUS_SCRATCH_SIZE
 8

	)

6192 
	#SQLITE_STATUS_MALLOC_COUNT
 9

	)

6216 
SQLITE_API
 
sqlôe3_db_°©us
(
sqlôe3
*, 
›
, *
pCur
, *
pHiwå
, 
ª£tFlg
);

6308 
	#SQLITE_DBSTATUS_LOOKASIDE_USED
 0

	)

6309 
	#SQLITE_DBSTATUS_CACHE_USED
 1

	)

6310 
	#SQLITE_DBSTATUS_SCHEMA_USED
 2

	)

6311 
	#SQLITE_DBSTATUS_STMT_USED
 3

	)

6312 
	#SQLITE_DBSTATUS_LOOKASIDE_HIT
 4

	)

6313 
	#SQLITE_DBSTATUS_LOOKASIDE_MISS_SIZE
 5

	)

6314 
	#SQLITE_DBSTATUS_LOOKASIDE_MISS_FULL
 6

	)

6315 
	#SQLITE_DBSTATUS_CACHE_HIT
 7

	)

6316 
	#SQLITE_DBSTATUS_CACHE_MISS
 8

	)

6317 
	#SQLITE_DBSTATUS_CACHE_WRITE
 9

	)

6318 
	#SQLITE_DBSTATUS_DEFERRED_FKS
 10

	)

6319 
	#SQLITE_DBSTATUS_MAX
 10

	)

6345 
SQLITE_API
 
sqlôe3_°mt_°©us
(
sqlôe3_°mt
*, 
›
,
ª£tFlg
);

6384 
	#SQLITE_STMTSTATUS_FULLSCAN_STEP
 1

	)

6385 
	#SQLITE_STMTSTATUS_SORT
 2

	)

6386 
	#SQLITE_STMTSTATUS_AUTOINDEX
 3

	)

6387 
	#SQLITE_STMTSTATUS_VM_STEP
 4

	)

6400 
sqlôe3_pˇche
 
	tsqlôe3_pˇche
;

6412 
sqlôe3_pˇche_∑ge
 
	tsqlôe3_pˇche_∑ge
;

6413 
	ssqlôe3_pˇche_∑ge
 {

6414 *
pBuf
;

6415 *
pExåa
;

6577 
sqlôe3_pˇche_mëhods2
 
	tsqlôe3_pˇche_mëhods2
;

6578 
	ssqlôe3_pˇche_mëhods2
 {

6579 
iVîsi⁄
;

6580 *
pArg
;

6581 (*
xInô
)(*);

6582 (*
xShutdown
)(*);

6583 
sqlôe3_pˇche
 *(*
xCª©e
)(
szPage
, 
szExåa
, 
bPurgóbÀ
);

6584 (*
xCachesize
)(
sqlôe3_pˇche
*, 
nCachesize
);

6585 (*
xPagecou¡
)(
sqlôe3_pˇche
*);

6586 
sqlôe3_pˇche_∑ge
 *(*
xFëch
)(
sqlôe3_pˇche
*, 
key
, 
¸óãFœg
);

6587 (*
xU≈ö
)(
sqlôe3_pˇche
*, 
sqlôe3_pˇche_∑ge
*, 
disˇrd
);

6588 (*
xRekey
)(
sqlôe3_pˇche
*, 
sqlôe3_pˇche_∑ge
*,

6589 
ﬁdKey
, 
√wKey
);

6590 (*
xTrunˇã
)(
sqlôe3_pˇche
*, 
iLimô
);

6591 (*
xDe°roy
)(
sqlôe3_pˇche
*);

6592 (*
xShrök
)(
sqlôe3_pˇche
*);

6600 
sqlôe3_pˇche_mëhods
 
	tsqlôe3_pˇche_mëhods
;

6601 
	ssqlôe3_pˇche_mëhods
 {

6602 *
pArg
;

6603 (*
xInô
)(*);

6604 (*
xShutdown
)(*);

6605 
sqlôe3_pˇche
 *(*
xCª©e
)(
szPage
, 
bPurgóbÀ
);

6606 (*
xCachesize
)(
sqlôe3_pˇche
*, 
nCachesize
);

6607 (*
xPagecou¡
)(
sqlôe3_pˇche
*);

6608 *(*
xFëch
)(
sqlôe3_pˇche
*, 
key
, 
¸óãFœg
);

6609 (*
xU≈ö
)(
sqlôe3_pˇche
*, *, 
disˇrd
);

6610 (*
xRekey
)(
sqlôe3_pˇche
*, *, 
ﬁdKey
, 
√wKey
);

6611 (*
xTrunˇã
)(
sqlôe3_pˇche
*, 
iLimô
);

6612 (*
xDe°roy
)(
sqlôe3_pˇche
*);

6626 
sqlôe3_backup
 
	tsqlôe3_backup
;

6810 
SQLITE_API
 
sqlôe3_backup
 *
sqlôe3_backup_öô
(

6811 
sqlôe3
 *
pDe°
,

6812 c⁄° *
zDe°Name
,

6813 
sqlôe3
 *
pSour˚
,

6814 c⁄° *
zSour˚Name


6816 
SQLITE_API
 
sqlôe3_backup_°ï
(
sqlôe3_backup
 *
p
, 
nPage
);

6817 
SQLITE_API
 
sqlôe3_backup_föish
(
sqlôe3_backup
 *
p
);

6818 
SQLITE_API
 
sqlôe3_backup_ªmaöög
(
sqlôe3_backup
 *
p
);

6819 
SQLITE_API
 
sqlôe3_backup_∑gecou¡
(
sqlôe3_backup
 *
p
);

6935 
SQLITE_API
 
sqlôe3_u∆ock_nŸify
(

6936 
sqlôe3
 *
pBlocked
,

6937 (*
xNŸify
)(**
≠Arg
, 
nArg
),

6938 *
pNŸifyArg


6950 
SQLITE_API
 
sqlôe3_°ricmp
(const *, const *);

6951 
SQLITE_API
 
sqlôe3_°∫icmp
(const *, const *, );

6966 
SQLITE_API
 
sqlôe3_°rglob
(c⁄° *
zGlob
, c⁄° *
zSå
);

6989 
SQLITE_API
 
sqlôe3_log
(
iEºCode
, c⁄° *
zF‹m©
, ...);

7026 
SQLITE_API
 *
sqlôe3_wÆ_hook
(

7027 
sqlôe3
*,

7028 (*)(*,
sqlôe3
*,const *,),

7057 
SQLITE_API
 
sqlôe3_wÆ_autocheckpoöt
(
sqlôe3
 *
db
, 
N
);

7075 
SQLITE_API
 
sqlôe3_wÆ_checkpoöt
(
sqlôe3
 *
db
, c⁄° *
zDb
);

7147 
SQLITE_API
 
sqlôe3_wÆ_checkpoöt_v2
(

7148 
sqlôe3
 *
db
,

7149 c⁄° *
zDb
,

7150 
eMode
,

7151 *
≤Log
,

7152 *
≤Ck±


7163 
	#SQLITE_CHECKPOINT_PASSIVE
 0

	)

7164 
	#SQLITE_CHECKPOINT_FULL
 1

	)

7165 
	#SQLITE_CHECKPOINT_RESTART
 2

	)

7181 
SQLITE_API
 
sqlôe3_vèb_c⁄fig
(
sqlôe3
*, 
›
, ...);

7222 
	#SQLITE_VTAB_CONSTRAINT_SUPPORT
 1

	)

7234 
SQLITE_API
 
sqlôe3_vèb_⁄_c⁄Êi˘
(
sqlôe3
 *);

7247 
	#SQLITE_ROLLBACK
 1

	)

7249 
	#SQLITE_FAIL
 3

	)

7251 
	#SQLITE_REPLACE
 5

	)

7259 #ifde‡
SQLITE_OMIT_FLOATING_POINT


7281 #i‚de‡
_SQLITE3RTREE_H_


7282 
	#_SQLITE3RTREE_H_


	)

7289 
sqlôe3_πªe_geomëry
 
	tsqlôe3_πªe_geomëry
;

7297 
SQLITE_API
 
sqlôe3_πªe_geomëry_ˇŒback
(

7298 
sqlôe3
 *
db
,

7299 c⁄° *
zGeom
,

7300 #ifde‡
SQLITE_RTREE_INT_ONLY


7301 (*
xGeom
)(
sqlôe3_πªe_geomëry
*, 
n
, 
sqlôe3_öt64
 *
a
, *
pRes
),

7303 (*
xGeom
)(
sqlôe3_πªe_geomëry
*, 
n
, *
a
, *
pRes
),

7305 *
pC⁄ãxt


7313 
	ssqlôe3_πªe_geomëry
 {

7314 *
pC⁄ãxt
;

7315 
nP¨am
;

7316 *
aP¨am
;

7317 *
pU£r
;

7318 (*
xDñU£r
)(*);

7345 #i‚de‡
_SQLITEINT_H_


7346 
	#_SQLITEINT_H_


	)

7367 #i‚de‡
SQLITE_DISABLE_LFS


7368 
	#_LARGE_FILE
 1

	)

7369 #i‚de‡
_FILE_OFFSET_BITS


7370 
	#_FILE_OFFSET_BITS
 64

	)

7372 
	#_LARGEFILE_SOURCE
 1

	)

7379 #ifde‡
_HAVE_SQLITE_CONFIG_H


7380 
	~"c⁄fig.h
"

7407 #i‚de‡
SQLITE_MAX_LENGTH


7408 
	#SQLITE_MAX_LENGTH
 1000000000

	)

7428 #i‚de‡
SQLITE_MAX_COLUMN


7429 
	#SQLITE_MAX_COLUMN
 2000

	)

7439 #i‚de‡
SQLITE_MAX_SQL_LENGTH


7440 
	#SQLITE_MAX_SQL_LENGTH
 1000000000

	)

7453 #i‚de‡
SQLITE_MAX_EXPR_DEPTH


7454 
	#SQLITE_MAX_EXPR_DEPTH
 1000

	)

7465 #i‚de‡
SQLITE_MAX_COMPOUND_SELECT


7466 
	#SQLITE_MAX_COMPOUND_SELECT
 500

	)

7473 #i‚de‡
SQLITE_MAX_VDBE_OP


7474 
	#SQLITE_MAX_VDBE_OP
 25000

	)

7480 #i‚de‡
SQLITE_MAX_FUNCTION_ARG


7481 
	#SQLITE_MAX_FUNCTION_ARG
 127

	)

7488 #i‚de‡
SQLITE_DEFAULT_CACHE_SIZE


7489 
	#SQLITE_DEFAULT_CACHE_SIZE
 2000

	)

7491 #i‚de‡
SQLITE_DEFAULT_TEMP_CACHE_SIZE


7492 
	#SQLITE_DEFAULT_TEMP_CACHE_SIZE
 500

	)

7499 #i‚de‡
SQLITE_DEFAULT_WAL_AUTOCHECKPOINT


7500 
	#SQLITE_DEFAULT_WAL_AUTOCHECKPOINT
 1000

	)

7508 #i‚de‡
SQLITE_MAX_ATTACHED


7509 
	#SQLITE_MAX_ATTACHED
 10

	)

7516 #i‚de‡
SQLITE_MAX_VARIABLE_NUMBER


7517 
	#SQLITE_MAX_VARIABLE_NUMBER
 999

	)

7531 #ifde‡
SQLITE_MAX_PAGE_SIZE


7532 #unde‡
SQLITE_MAX_PAGE_SIZE


7534 
	#SQLITE_MAX_PAGE_SIZE
 65536

	)

7540 #i‚de‡
SQLITE_DEFAULT_PAGE_SIZE


7541 
	#SQLITE_DEFAULT_PAGE_SIZE
 1024

	)

7543 #i‡
SQLITE_DEFAULT_PAGE_SIZE
>
SQLITE_MAX_PAGE_SIZE


7544 #unde‡
SQLITE_DEFAULT_PAGE_SIZE


7545 
	#SQLITE_DEFAULT_PAGE_SIZE
 
SQLITE_MAX_PAGE_SIZE


	)

7555 #i‚de‡
SQLITE_MAX_DEFAULT_PAGE_SIZE


7556 
	#SQLITE_MAX_DEFAULT_PAGE_SIZE
 8192

	)

7558 #i‡
SQLITE_MAX_DEFAULT_PAGE_SIZE
>
SQLITE_MAX_PAGE_SIZE


7559 #unde‡
SQLITE_MAX_DEFAULT_PAGE_SIZE


7560 
	#SQLITE_MAX_DEFAULT_PAGE_SIZE
 
SQLITE_MAX_PAGE_SIZE


	)

7571 #i‚de‡
SQLITE_MAX_PAGE_COUNT


7572 
	#SQLITE_MAX_PAGE_COUNT
 1073741823

	)

7579 #i‚de‡
SQLITE_MAX_LIKE_PATTERN_LENGTH


7580 
	#SQLITE_MAX_LIKE_PATTERN_LENGTH
 50000

	)

7590 #i‚de‡
SQLITE_MAX_TRIGGER_DEPTH


7591 
	#SQLITE_MAX_TRIGGER_DEPTH
 1000

	)

7598 #i‡
deföed
(
__BORLANDC__
)

7599 #¥agm®
w¨n
 -
rch


7600 #¥agm®
w¨n
 -
ccc


7601 #¥agm®
w¨n
 -
aus


7602 #¥agm®
w¨n
 -
csu


7603 #¥agm®
w¨n
 -
•a


7607 #i‚de‡
_GNU_SOURCE


7608 
	#_GNU_SOURCE


	)

7611 #i‡
deföed
(
__O≥nBSD__
Ë&& !deföed(
_BSD_SOURCE
)

7612 
	#_BSD_SOURCE


	)

7618 #ifde‡
HAVE_STDINT_H


7619 
	~<°döt.h
>

7621 #ifde‡
HAVE_INTTYPES_H


7622 
	~<öây≥s.h
>

7641 #i‡
deföed
(
__PTRDIFF_TYPE__
)

7642 
	#SQLITE_INT_TO_PTR
(
X
Ë((*)(
__PTRDIFF_TYPE__
)(X))

	)

7643 
	#SQLITE_PTR_TO_INT
(
X
Ë(()(
__PTRDIFF_TYPE__
)(X))

	)

7644 #ñi‡!
deföed
(
__GNUC__
)

7645 
	#SQLITE_INT_TO_PTR
(
X
Ë((*)&((*)0)[X])

	)

7646 
	#SQLITE_PTR_TO_INT
(
X
Ë(()(((*)X)-(*)0))

	)

7647 #ñi‡
deföed
(
HAVE_STDINT_H
)

7648 
	#SQLITE_INT_TO_PTR
(
X
Ë((*)(
öçå_t
)(X))

	)

7649 
	#SQLITE_PTR_TO_INT
(
X
Ë(()(
öçå_t
)(X))

	)

7651 
	#SQLITE_INT_TO_PTR
(
X
Ë((*)(X))

	)

7652 
	#SQLITE_PTR_TO_INT
(
X
Ë(()(X))

	)

7666 #i‡!
deföed
(
SQLITE_THREADSAFE
)

7667 #i‡
deföed
(
THREADSAFE
)

7668 
	#SQLITE_THREADSAFE
 
THREADSAFE


	)

7670 
	#SQLITE_THREADSAFE
 1

	)

7678 #i‚de‡
SQLITE_POWERSAFE_OVERWRITE


7679 
	#SQLITE_POWERSAFE_OVERWRITE
 1

	)

7688 #i‡!
deföed
(
SQLITE_DEFAULT_MEMSTATUS
)

7689 
	#SQLITE_DEFAULT_MEMSTATUS
 1

	)

7709 #i‡
deföed
(
SQLITE_SYSTEM_MALLOC
) \

7710 + 
deföed
(
SQLITE_WIN32_MALLOC
) \

7711 + 
deföed
(
SQLITE_ZERO_MALLOC
) \

7712 + 
deföed
(
SQLITE_MEMDEBUG
)>1

7718 #i‡
deföed
(
SQLITE_SYSTEM_MALLOC
) \

7719 + 
deföed
(
SQLITE_WIN32_MALLOC
) \

7720 + 
deföed
(
SQLITE_ZERO_MALLOC
) \

7721 + 
deföed
(
SQLITE_MEMDEBUG
)==0

7722 
	#SQLITE_SYSTEM_MALLOC
 1

	)

7729 #i‡!
deföed
(
SQLITE_MALLOC_SOFT_LIMIT
)

7730 
	#SQLITE_MALLOC_SOFT_LIMIT
 1024

	)

7739 #i‡!
deföed
(
_XOPEN_SOURCE
Ë&& !deföed(
__DARWIN__
Ë&& !deföed(
__APPLE__
)

7740 
	#_XOPEN_SOURCE
 600

	)

7754 #i‡!
deföed
(
NDEBUG
Ë&& !deföed(
SQLITE_DEBUG
)

7755 
	#NDEBUG
 1

	)

7757 #i‡
deföed
(
NDEBUG
Ë&& deföed(
SQLITE_DEBUG
)

7758 #unde‡
NDEBUG


7775 #ifde‡
SQLITE_COVERAGE_TEST


7776 
SQLITE_PRIVATE
 
sqlôe3Covîage
();

7777 
	#ã°ˇ£
(
X
Ëif–X ){ 
	`sqlôe3Covîage
(
__LINE__
); }

	)

7779 
	#ã°ˇ£
(
X
)

	)

7787 #i‡!
deföed
(
NDEBUG
Ë|| deföed(
SQLITE_COVERAGE_TEST
)

7788 
	#TESTONLY
(
X
Ë
	)
X

7790 
	#TESTONLY
(
X
)

	)

7801 #i‚de‡
NDEBUG


7802 
	#VVA_ONLY
(
X
Ë
	)
X

7804 
	#VVA_ONLY
(
X
)

	)

7822 #i‡
deföed
(
SQLITE_COVERAGE_TEST
)

7823 
	#ALWAYS
(
X
Ë(1)

	)

7824 
	#NEVER
(
X
Ë(0)

	)

7825 #ñi‡!
deföed
(
NDEBUG
)

7826 
	#ALWAYS
(
X
Ë((X)?1:(
	`as£π
(0),0))

	)

7827 
	#NEVER
(
X
Ë((X)?(
	`as£π
(0),1):0)

	)

7829 
	#ALWAYS
(
X
Ë(X)

	)

7830 
	#NEVER
(
X
Ë(X)

	)

7838 
	#IS_BIG_INT
(
X
Ë(((X)&~(
i64
)0xffffffff)!=0)

	)

7847 
	#likñy
(
X
Ë(X)

	)

7848 
	#u∆ikñy
(
X
Ë(X)

	)

7866 #i‚de‡
_SQLITE_HASH_H_


7867 
	#_SQLITE_HASH_H_


	)

7870 
Hash
 
	tHash
;

7871 
HashEÀm
 
	tHashEÀm
;

7894 
	sHash
 {

7895 
	mhtsize
;

7896 
	mcou¡
;

7897 
HashEÀm
 *
	mfú°
;

7898 
	s_ht
 {

7899 
	mcou¡
;

7900 
HashEÀm
 *
	mchaö
;

7901 } *
	mht
;

7910 
	sHashEÀm
 {

7911 
HashEÀm
 *
	m√xt
, *
	m¥ev
;

7912 *
	md©a
;

7913 c⁄° *
	mpKey
; 
	mnKey
;

7919 
SQLITE_PRIVATE
 
sqlôe3HashInô
(
Hash
*);

7920 
SQLITE_PRIVATE
 *
sqlôe3HashIn£π
(
Hash
*, c⁄° *
pKey
, 
nKey
, *
pD©a
);

7921 
SQLITE_PRIVATE
 *
sqlôe3HashFöd
(c⁄° 
Hash
*, c⁄° *
pKey
, 
nKey
);

7922 
SQLITE_PRIVATE
 
sqlôe3HashCÀ¨
(
Hash
*);

7936 
	#sqlôeHashFú°
(
H
Ë((H)->
fú°
)

	)

7937 
	#sqlôeHashNext
(
E
Ë((E)->
√xt
)

	)

7938 
	#sqlôeHashD©a
(
E
Ë((E)->
d©a
)

	)

7953 
	#TK_SEMI
 1

	)

7954 
	#TK_EXPLAIN
 2

	)

7955 
	#TK_QUERY
 3

	)

7956 
	#TK_PLAN
 4

	)

7957 
	#TK_BEGIN
 5

	)

7958 
	#TK_TRANSACTION
 6

	)

7959 
	#TK_DEFERRED
 7

	)

7960 
	#TK_IMMEDIATE
 8

	)

7961 
	#TK_EXCLUSIVE
 9

	)

7962 
	#TK_COMMIT
 10

	)

7963 
	#TK_END
 11

	)

7964 
	#TK_ROLLBACK
 12

	)

7965 
	#TK_SAVEPOINT
 13

	)

7966 
	#TK_RELEASE
 14

	)

7967 
	#TK_TO
 15

	)

7968 
	#TK_TABLE
 16

	)

7969 
	#TK_CREATE
 17

	)

7970 
	#TK_IF
 18

	)

7971 
	#TK_NOT
 19

	)

7972 
	#TK_EXISTS
 20

	)

7973 
	#TK_TEMP
 21

	)

7974 
	#TK_LP
 22

	)

7975 
	#TK_RP
 23

	)

7976 
	#TK_AS
 24

	)

7977 
	#TK_COMMA
 25

	)

7978 
	#TK_ID
 26

	)

7979 
	#TK_INDEXED
 27

	)

7980 
	#TK_ABORT
 28

	)

7981 
	#TK_ACTION
 29

	)

7982 
	#TK_AFTER
 30

	)

7983 
	#TK_ANALYZE
 31

	)

7984 
	#TK_ASC
 32

	)

7985 
	#TK_ATTACH
 33

	)

7986 
	#TK_BEFORE
 34

	)

7987 
	#TK_BY
 35

	)

7988 
	#TK_CASCADE
 36

	)

7989 
	#TK_CAST
 37

	)

7990 
	#TK_COLUMNKW
 38

	)

7991 
	#TK_CONFLICT
 39

	)

7992 
	#TK_DATABASE
 40

	)

7993 
	#TK_DESC
 41

	)

7994 
	#TK_DETACH
 42

	)

7995 
	#TK_EACH
 43

	)

7996 
	#TK_FAIL
 44

	)

7997 
	#TK_FOR
 45

	)

7998 
	#TK_IGNORE
 46

	)

7999 
	#TK_INITIALLY
 47

	)

8000 
	#TK_INSTEAD
 48

	)

8001 
	#TK_LIKE_KW
 49

	)

8002 
	#TK_MATCH
 50

	)

8003 
	#TK_NO
 51

	)

8004 
	#TK_KEY
 52

	)

8005 
	#TK_OF
 53

	)

8006 
	#TK_OFFSET
 54

	)

8007 
	#TK_PRAGMA
 55

	)

8008 
	#TK_RAISE
 56

	)

8009 
	#TK_REPLACE
 57

	)

8010 
	#TK_RESTRICT
 58

	)

8011 
	#TK_ROW
 59

	)

8012 
	#TK_TRIGGER
 60

	)

8013 
	#TK_VACUUM
 61

	)

8014 
	#TK_VIEW
 62

	)

8015 
	#TK_VIRTUAL
 63

	)

8016 
	#TK_REINDEX
 64

	)

8017 
	#TK_RENAME
 65

	)

8018 
	#TK_CTIME_KW
 66

	)

8019 
	#TK_ANY
 67

	)

8020 
	#TK_OR
 68

	)

8021 
	#TK_AND
 69

	)

8022 
	#TK_IS
 70

	)

8023 
	#TK_BETWEEN
 71

	)

8024 
	#TK_IN
 72

	)

8025 
	#TK_ISNULL
 73

	)

8026 
	#TK_NOTNULL
 74

	)

8027 
	#TK_NE
 75

	)

8028 
	#TK_EQ
 76

	)

8029 
	#TK_GT
 77

	)

8030 
	#TK_LE
 78

	)

8031 
	#TK_LT
 79

	)

8032 
	#TK_GE
 80

	)

8033 
	#TK_ESCAPE
 81

	)

8034 
	#TK_BITAND
 82

	)

8035 
	#TK_BITOR
 83

	)

8036 
	#TK_LSHIFT
 84

	)

8037 
	#TK_RSHIFT
 85

	)

8038 
	#TK_PLUS
 86

	)

8039 
	#TK_MINUS
 87

	)

8040 
	#TK_STAR
 88

	)

8041 
	#TK_SLASH
 89

	)

8042 
	#TK_REM
 90

	)

8043 
	#TK_CONCAT
 91

	)

8044 
	#TK_COLLATE
 92

	)

8045 
	#TK_BITNOT
 93

	)

8046 
	#TK_STRING
 94

	)

8047 
	#TK_JOIN_KW
 95

	)

8048 
	#TK_CONSTRAINT
 96

	)

8049 
	#TK_DEFAULT
 97

	)

8050 
	#TK_NULL
 98

	)

8051 
	#TK_PRIMARY
 99

	)

8052 
	#TK_UNIQUE
 100

	)

8053 
	#TK_CHECK
 101

	)

8054 
	#TK_REFERENCES
 102

	)

8055 
	#TK_AUTOINCR
 103

	)

8056 
	#TK_ON
 104

	)

8057 
	#TK_INSERT
 105

	)

8058 
	#TK_DELETE
 106

	)

8059 
	#TK_UPDATE
 107

	)

8060 
	#TK_SET
 108

	)

8061 
	#TK_DEFERRABLE
 109

	)

8062 
	#TK_FOREIGN
 110

	)

8063 
	#TK_DROP
 111

	)

8064 
	#TK_UNION
 112

	)

8065 
	#TK_ALL
 113

	)

8066 
	#TK_EXCEPT
 114

	)

8067 
	#TK_INTERSECT
 115

	)

8068 
	#TK_SELECT
 116

	)

8069 
	#TK_DISTINCT
 117

	)

8070 
	#TK_DOT
 118

	)

8071 
	#TK_FROM
 119

	)

8072 
	#TK_JOIN
 120

	)

8073 
	#TK_USING
 121

	)

8074 
	#TK_ORDER
 122

	)

8075 
	#TK_GROUP
 123

	)

8076 
	#TK_HAVING
 124

	)

8077 
	#TK_LIMIT
 125

	)

8078 
	#TK_WHERE
 126

	)

8079 
	#TK_INTO
 127

	)

8080 
	#TK_VALUES
 128

	)

8081 
	#TK_INTEGER
 129

	)

8082 
	#TK_FLOAT
 130

	)

8083 
	#TK_BLOB
 131

	)

8084 
	#TK_REGISTER
 132

	)

8085 
	#TK_VARIABLE
 133

	)

8086 
	#TK_CASE
 134

	)

8087 
	#TK_WHEN
 135

	)

8088 
	#TK_THEN
 136

	)

8089 
	#TK_ELSE
 137

	)

8090 
	#TK_INDEX
 138

	)

8091 
	#TK_ALTER
 139

	)

8092 
	#TK_ADD
 140

	)

8096 
	~<°dio.h
>

8097 
	~<°dlib.h
>

8098 
	~<°rög.h
>

8099 
	~<as£π.h
>

8100 
	~<°ddef.h
>

8106 #ifde‡
SQLITE_OMIT_FLOATING_POINT


8107 
sqlôe_öt64


	)

8108 
sqlôe_öt64


	)

8109 
	#LONGDOUBLE_TYPE
 
sqlôe_öt64


	)

8110 #i‚de‡
SQLITE_BIG_DBL


8111 
	#SQLITE_BIG_DBL
 (((
sqlôe3_öt64
)1)<<50)

	)

8113 
	#SQLITE_OMIT_DATETIME_FUNCS
 1

	)

8114 
	#SQLITE_OMIT_TRACE
 1

	)

8115 #unde‡
SQLITE_MIXED_ENDIAN_64BIT_FLOAT


8116 #unde‡
SQLITE_HAVE_ISNAN


8118 #i‚de‡
SQLITE_BIG_DBL


8119 
	#SQLITE_BIG_DBL
 (1e99)

	)

8127 #ifde‡
SQLITE_OMIT_TEMPDB


8128 
	#OMIT_TEMPDB
 1

	)

8130 
	#OMIT_TEMPDB
 0

	)

8139 
	#SQLITE_MAX_FILE_FORMAT
 4

	)

8140 #i‚de‡
SQLITE_DEFAULT_FILE_FORMAT


8141 
	#SQLITE_DEFAULT_FILE_FORMAT
 4

	)

8148 #i‚de‡
SQLITE_DEFAULT_RECURSIVE_TRIGGERS


8149 
	#SQLITE_DEFAULT_RECURSIVE_TRIGGERS
 0

	)

8156 #i‚de‡
SQLITE_TEMP_STORE


8157 
	#SQLITE_TEMP_STORE
 1

	)

8158 
	#SQLITE_TEMP_STORE_xc
 1

	)

8165 #i‚de‡
off£tof


8166 
	#off£tof
(
STRUCTURE
,
FIELD
Ë(()((*)&((STRUCTURE*)0)->FIELD))

	)

8172 
	#MIN
(
A
,
B
Ë((A)<(B)?(A):(B))

	)

8173 
	#MAX
(
A
,
B
Ë((A)>(B)?(A):(B))

	)

8180 
	#SQLITE_EBCDIC
 1

	)

8182 
	#SQLITE_ASCII
 1

	)

8192 #i‚de‡
UINT32_TYPE


8193 #ifde‡
HAVE_UINT32_T


8194 
	#UINT32_TYPE
 
uöt32_t


	)

8196 
	#UINT32_TYPE
 

	)

8199 #i‚de‡
UINT16_TYPE


8200 #ifde‡
HAVE_UINT16_T


8201 
	#UINT16_TYPE
 
uöt16_t


	)

8203 
	#UINT16_TYPE
 

	)

8206 #i‚de‡
INT16_TYPE


8207 #ifde‡
HAVE_INT16_T


8208 
	#INT16_TYPE
 
öt16_t


	)

8210 
	#INT16_TYPE
 

	)

8213 #i‚de‡
UINT8_TYPE


8214 #ifde‡
HAVE_UINT8_T


8215 
	#UINT8_TYPE
 
uöt8_t


	)

8217 
	#UINT8_TYPE
 

	)

8220 #i‚de‡
INT8_TYPE


8221 #ifde‡
HAVE_INT8_T


8222 
	#INT8_TYPE
 
öt8_t


	)

8224 
	#INT8_TYPE
 sig√d 

	)

8227 #i‚de‡
LONGDOUBLE_TYPE


8228 
	#LONGDOUBLE_TYPE
 

	)

8230 
sqlôe_öt64
 
	ti64
;

8231 
sqlôe_uöt64
 
	tu64
;

8232 
UINT32_TYPE
 
	tu32
;

8233 
UINT16_TYPE
 
	tu16
;

8234 
INT16_TYPE
 
	ti16
;

8235 
UINT8_TYPE
 
	tu8
;

8236 
INT8_TYPE
 
	ti8
;

8244 
	#SQLITE_MAX_U32
 ((((
u64
)1)<<32)-1)

	)

8252 #ifde‡
SQLITE_64BIT_STATS


8253 
u64
 
	ttRow˙t
;

8255 
u32
 
	ttRow˙t
;

8281 
INT16_TYPE
 
	tLogE°
;

8287 #ifde‡
SQLITE_AMALGAMATION


8288 
SQLITE_PRIVATE
 c⁄° 
	gsqlôe3⁄e
 = 1;

8290 
SQLITE_PRIVATE
 c⁄° 
	gsqlôe3⁄e
;

8292 #i‡
deföed
(
i386
Ë|| deföed(
__i386__
Ë|| deföed(
_M_IX86
)\

8293 || 
deföed
(
__x86_64
Ë|| 
	$deföed
(
__x86_64__
)

8294 
	#SQLITE_BIGENDIAN
 0

	)

8295 
	#SQLITE_LITTLEENDIAN
 1

	)

8296 
	#SQLITE_UTF16NATIVE
 
SQLITE_UTF16LE


	)

8298 
	#SQLITE_BIGENDIAN
 (*(*)(&
sqlôe3⁄e
)==0)

	)

8299 
	#SQLITE_LITTLEENDIAN
 (*(*)(&
sqlôe3⁄e
)==1)

	)

8300 
	#SQLITE_UTF16NATIVE
 (
SQLITE_BIGENDIAN
?
SQLITE_UTF16BE
:
SQLITE_UTF16LE
)

	)

8308 
	#LARGEST_INT64
 (0xffffffff|(((
i64
)0x7fffffff)<<32))

	)

8309 
	#SMALLEST_INT64
 (((
i64
)-1Ë- 
LARGEST_INT64
)

	)

8315 
	#ROUND8
(
x
Ë(((x)+7)&~7)

	)

8320 
	#ROUNDDOWN8
(
x
Ë((x)&~7)

	)

8331 #ifde‡
SQLITE_4_BYTE_ALIGNED_MALLOC


8332 
	#EIGHT_BYTE_ALIGNMENT
(
X
Ë((((*)(XË- (*)0)&3)==0)

	)

8334 
	#EIGHT_BYTE_ALIGNMENT
(
X
Ë((((*)(XË- (*)0)&7)==0)

	)

8340 #i‡
	`deföed
(
__O≥nBSD__
Ë|| deföed(
__QNXNTO__
)

8341 #unde‡
SQLITE_MAX_MMAP_SIZE


8342 
	#SQLITE_MAX_MMAP_SIZE
 0

	)

8348 #ifde‡
__APPLE__


8349 
	~<T¨gëC⁄dôi⁄Æs.h
>

8350 #i‡
TARGET_OS_IPHONE


8351 #unde‡
SQLITE_MAX_MMAP_SIZE


8352 
	#SQLITE_MAX_MMAP_SIZE
 0

	)

8355 #i‚de‡
SQLITE_MAX_MMAP_SIZE


8356 #i‡
	`deföed
(
__löux__
) \

8357 || 
	`deföed
(
_WIN32
) \

8358 || (
	`deföed
(
__APPLE__
Ë&& deföed(
__MACH__
)) \

8359 || 
	$deföed
(
__sun
)

8360 
	#SQLITE_MAX_MMAP_SIZE
 0x7fff0000

	)

8362 
	#SQLITE_MAX_MMAP_SIZE
 0

	)

8364 
	#SQLITE_MAX_MMAP_SIZE_xc
 1

	)

8372 #i‚de‡
SQLITE_DEFAULT_MMAP_SIZE


8373 
	#SQLITE_DEFAULT_MMAP_SIZE
 0

	)

8374 
	#SQLITE_DEFAULT_MMAP_SIZE_xc
 1

	)

8376 #i‡
SQLITE_DEFAULT_MMAP_SIZE
>
SQLITE_MAX_MMAP_SIZE


8377 #unde‡
SQLITE_DEFAULT_MMAP_SIZE


8378 
	#SQLITE_DEFAULT_MMAP_SIZE
 
SQLITE_MAX_MMAP_SIZE


	)

8386 #ifde‡
SQLITE_ENABLE_STAT4


8387 #unde‡
SQLITE_ENABLE_STAT3


8388 
	#SQLITE_ENABLE_STAT3_OR_STAT4
 1

	)

8389 #ñi‡
SQLITE_ENABLE_STAT3


8390 
	#SQLITE_ENABLE_STAT3_OR_STAT4
 1

	)

8391 #ñi‡
SQLITE_ENABLE_STAT3_OR_STAT4


8392 #unde‡
SQLITE_ENABLE_STAT3_OR_STAT4


8404 
BusyH™dÀr
 
	tBusyH™dÀr
;

8405 
	sBusyH™dÀr
 {

8406 (*
xFunc
)(*,);

8407 *
pArg
;

8408 
nBusy
;

8416 
	#MASTER_NAME
 "sqlôe_ma°î"

	)

8417 
	#TEMP_MASTER_NAME
 "sqlôe_ãmp_ma°î"

	)

8422 
	#MASTER_ROOT
 1

	)

8427 
	#SCHEMA_TABLE
(
x
Ë((!
OMIT_TEMPDB
)&&(x==1)?
TEMP_MASTER_NAME
:
MASTER_NAME
)

	)

8433 
	#AºaySize
(
X
Ë(()((X)/(X[0])))

	)

8438 
	#IsPowîOfTwo
(
X
Ë(((X)&((X)-1))==0)

	)

8448 
	#SQLITE_DYNAMIC
 ((
sqlôe3_de°ru˘‹_ty≥
)
sqlôe3MÆlocSize
)

	)

8464 #ifde‡
SQLITE_OMIT_WSD


8465 
	#SQLITE_WSD
 c⁄°

	)

8466 
	#GLOBAL
(
t
,
v
Ë(*—*)
	`sqlôe3_wsd_föd
((*)&(v), (v)))

	)

8467 
	#sqlôe3GlobÆC⁄fig
 
	`GLOBAL
(
Sqlôe3C⁄fig
, 
sqlôe3C⁄fig
)

	)

8468 
SQLITE_API
 
	`sqlôe3_wsd_öô
(
N
, 
J
);

8469 
SQLITE_API
 *
	`sqlôe3_wsd_föd
(*
K
, 
L
);

8471 
	#SQLITE_WSD


	)

8472 
	#GLOBAL
(
t
,
v
Ë
	)
v

8473 
	#sqlôe3GlobÆC⁄fig
 
sqlôe3C⁄fig


	)

8492 
	#UNUSED_PARAMETER
(
x
Ë()(x)

	)

8493 
	#UNUSED_PARAMETER2
(
x
,
y
Ë
	`UNUSED_PARAMETER
(x),UNUSED_PARAMETER(y)

	)

8498 
AggInfo
 
	tAggInfo
;

8499 
AuthC⁄ãxt
 
	tAuthC⁄ãxt
;

8500 
AutoöcInfo
 
	tAutoöcInfo
;

8501 
Bôvec
 
	tBôvec
;

8502 
CﬁlSeq
 
	tCﬁlSeq
;

8503 
Cﬁumn
 
	tCﬁumn
;

8504 
Db
 
	tDb
;

8505 
Schema
 
	tSchema
;

8506 
Ex¥
 
	tEx¥
;

8507 
Ex¥Li°
 
	tEx¥Li°
;

8508 
Ex¥S∑n
 
	tEx¥S∑n
;

8509 
FKey
 
	tFKey
;

8510 
FuncDe°ru˘‹
 
	tFuncDe°ru˘‹
;

8511 
FuncDef
 
	tFuncDef
;

8512 
FuncDefHash
 
	tFuncDefHash
;

8513 
IdLi°
 
	tIdLi°
;

8514 
Index
 
	tIndex
;

8515 
IndexSam∂e
 
	tIndexSam∂e
;

8516 
KeyCœss
 
	tKeyCœss
;

8517 
KeyInfo
 
	tKeyInfo
;

8518 
Lookaside
 
	tLookaside
;

8519 
LookasideSlŸ
 
	tLookasideSlŸ
;

8520 
ModuÀ
 
	tModuÀ
;

8521 
NameC⁄ãxt
 
	tNameC⁄ãxt
;

8522 
P¨£
 
	tP¨£
;

8523 
RowSë
 
	tRowSë
;

8524 
Savïoöt
 
	tSavïoöt
;

8525 
Sñe˘
 
	tSñe˘
;

8526 
Sñe˘De°
 
	tSñe˘De°
;

8527 
SrcLi°
 
	tSrcLi°
;

8528 
SåAccum
 
	tSåAccum
;

8529 
TabÀ
 
	tTabÀ
;

8530 
TabÀLock
 
	tTabÀLock
;

8531 
Tokí
 
	tTokí
;

8532 
Triggî
 
	tTriggî
;

8533 
TriggîPrg
 
	tTriggîPrg
;

8534 
TriggîSãp
 
	tTriggîSãp
;

8535 
U≈ackedRec‹d
 
	tU≈ackedRec‹d
;

8536 
VTabÀ
 
	tVTabÀ
;

8537 
VèbCtx
 
	tVèbCtx
;

8538 
WÆkî
 
	tWÆkî
;

8539 
WhîeInfo
 
	tWhîeInfo
;

8563 #i‚de‡
_BTREE_H_


8564 
	#_BTREE_H_


	)

8569 
	#SQLITE_N_BTREE_META
 10

	)

8575 #i‚de‡
SQLITE_DEFAULT_AUTOVACUUM


8576 
	#SQLITE_DEFAULT_AUTOVACUUM
 0

	)

8579 
	#BTREE_AUTOVACUUM_NONE
 0

	)

8580 
	#BTREE_AUTOVACUUM_FULL
 1

	)

8581 
	#BTREE_AUTOVACUUM_INCR
 2

	)

8586 
Båì
 
	tBåì
;

8587 
BtCurs‹
 
	tBtCurs‹
;

8588 
BtSh¨ed
 
	tBtSh¨ed
;

8591 
SQLITE_PRIVATE
 
	`sqlôe3BåìO≥n
(

8592 
sqlôe3_vfs
 *
pVfs
,

8593 c⁄° *
zFûíame
,

8594 
sqlôe3
 *
db
,

8595 
Båì
 **
µBåì
,

8596 
Êags
,

8597 
vfsFœgs


8606 
	#BTREE_OMIT_JOURNAL
 1

	)

8607 
	#BTREE_MEMORY
 2

	)

8608 
	#BTREE_SINGLE
 4

	)

8609 
	#BTREE_UNORDERED
 8

	)

8611 
SQLITE_PRIVATE
 
	`sqlôe3BåìClo£
(
Båì
*);

8612 
SQLITE_PRIVATE
 
	`sqlôe3BåìSëCacheSize
(
Båì
*,);

8613 
SQLITE_PRIVATE
 
	`sqlôe3BåìSëMm≠Limô
(
Båì
*,
sqlôe3_öt64
);

8614 
SQLITE_PRIVATE
 
	`sqlôe3BåìSëPagîFœgs
(
Båì
*,);

8615 
SQLITE_PRIVATE
 
	`sqlôe3BåìSyncDißbÀd
(
Båì
*);

8616 
SQLITE_PRIVATE
 
	`sqlôe3BåìSëPageSize
(
Båì
 *
p
, 
nPagesize
, 
nRe£rve
, 
eFix
);

8617 
SQLITE_PRIVATE
 
	`sqlôe3BåìGëPageSize
(
Båì
*);

8618 
SQLITE_PRIVATE
 
	`sqlôe3BåìMaxPageCou¡
(
Båì
*,);

8619 
SQLITE_PRIVATE
 
u32
 
	`sqlôe3BåìLa°Page
(
Båì
*);

8620 
SQLITE_PRIVATE
 
	`sqlôe3BåìSecuªDñëe
(
Båì
*,);

8621 
SQLITE_PRIVATE
 
	`sqlôe3BåìGëRe£rve
(
Båì
*);

8622 #i‡
	`deföed
(
SQLITE_HAS_CODEC
Ë|| deföed(
SQLITE_DEBUG
)

8623 
SQLITE_PRIVATE
 
	`sqlôe3BåìGëRe£rveNoMuãx
(
Båì
 *
p
);

8625 
SQLITE_PRIVATE
 
	`sqlôe3BåìSëAutoVacuum
(
Båì
 *, );

8626 
SQLITE_PRIVATE
 
	`sqlôe3BåìGëAutoVacuum
(
Båì
 *);

8627 
SQLITE_PRIVATE
 
	`sqlôe3BåìBegöTøns
(
Båì
*,);

8628 
SQLITE_PRIVATE
 
	`sqlôe3BåìCommôPha£O√
(
Båì
*, c⁄° *
zMa°î
);

8629 
SQLITE_PRIVATE
 
	`sqlôe3BåìCommôPha£Two
(
Båì
*, );

8630 
SQLITE_PRIVATE
 
	`sqlôe3BåìCommô
(
Båì
*);

8631 
SQLITE_PRIVATE
 
	`sqlôe3BåìRﬁlback
(
Båì
*,);

8632 
SQLITE_PRIVATE
 
	`sqlôe3BåìBegöStmt
(
Båì
*,);

8633 
SQLITE_PRIVATE
 
	`sqlôe3BåìCª©eTabÀ
(
Båì
*, *, 
Êags
);

8634 
SQLITE_PRIVATE
 
	`sqlôe3BåìIsInTøns
(
Båì
*);

8635 
SQLITE_PRIVATE
 
	`sqlôe3BåìIsInRódTøns
(
Båì
*);

8636 
SQLITE_PRIVATE
 
	`sqlôe3BåìIsInBackup
(
Båì
*);

8637 
SQLITE_PRIVATE
 *
	`sqlôe3BåìSchema
(
Båì
 *, , (*)(*));

8638 
SQLITE_PRIVATE
 
	`sqlôe3BåìSchemaLocked
(
Båì
 *
pBåì
);

8639 
SQLITE_PRIVATE
 
	`sqlôe3BåìLockTabÀ
(
Båì
 *
pBåì
, 
iTab
, 
u8
 
isWrôeLock
);

8640 
SQLITE_PRIVATE
 
	`sqlôe3BåìSavïoöt
(
Båì
 *, , );

8642 
SQLITE_PRIVATE
 c⁄° *
	`sqlôe3BåìGëFûíame
(
Båì
 *);

8643 
SQLITE_PRIVATE
 c⁄° *
	`sqlôe3BåìGëJou∫Æ«me
(
Båì
 *);

8644 
SQLITE_PRIVATE
 
	`sqlôe3BåìC›yFûe
(
Båì
 *, Btree *);

8646 
SQLITE_PRIVATE
 
	`sqlôe3BåìIn¸Vacuum
(
Båì
 *);

8658 
	#BTREE_INTKEY
 1

	)

8659 
	#BTREE_BLOBKEY
 2

	)

8661 
SQLITE_PRIVATE
 
	`sqlôe3BåìDr›TabÀ
(
Båì
*, , *);

8662 
SQLITE_PRIVATE
 
	`sqlôe3BåìCÀ¨TabÀ
(
Båì
*, , *);

8663 
SQLITE_PRIVATE
 
	`sqlôe3BåìTrùAŒCurs‹s
(
Båì
*, );

8665 
SQLITE_PRIVATE
 
	`sqlôe3BåìGëMëa
(
Båì
 *
pBåì
, 
idx
, 
u32
 *
pVÆue
);

8666 
SQLITE_PRIVATE
 
	`sqlôe3BåìUpd©eMëa
(
Båì
*, 
idx
, 
u32
 
vÆue
);

8668 
SQLITE_PRIVATE
 
	`sqlôe3BåìNewDb
(
Båì
 *
p
);

8682 
	#BTREE_FREE_PAGE_COUNT
 0

	)

8683 
	#BTREE_SCHEMA_VERSION
 1

	)

8684 
	#BTREE_FILE_FORMAT
 2

	)

8685 
	#BTREE_DEFAULT_CACHE_SIZE
 3

	)

8686 
	#BTREE_LARGEST_ROOT_PAGE
 4

	)

8687 
	#BTREE_TEXT_ENCODING
 5

	)

8688 
	#BTREE_USER_VERSION
 6

	)

8689 
	#BTREE_INCR_VACUUM
 7

	)

8690 
	#BTREE_APPLICATION_ID
 8

	)

8696 
	#BTREE_BULKLOAD
 0x00000001

	)

8698 
SQLITE_PRIVATE
 
	`sqlôe3BåìCurs‹
(

8699 
Båì
*,

8700 
iTabÀ
,

8701 
wrFœg
,

8702 
KeyInfo
*,

8703 
BtCurs‹
 *
pCurs‹


8705 
SQLITE_PRIVATE
 
	`sqlôe3BåìCurs‹Size
();

8706 
SQLITE_PRIVATE
 
	`sqlôe3BåìCurs‹Zîo
(
BtCurs‹
*);

8708 
SQLITE_PRIVATE
 
	`sqlôe3BåìClo£Curs‹
(
BtCurs‹
*);

8709 
SQLITE_PRIVATE
 
	`sqlôe3BåìMovëoU≈acked
(

8710 
BtCurs‹
*,

8711 
U≈ackedRec‹d
 *
pUnKey
,

8712 
i64
 
ötKey
,

8713 
büs
,

8714 *
pRes


8716 
SQLITE_PRIVATE
 
	`sqlôe3BåìCurs‹HasMoved
(
BtCurs‹
*, *);

8717 
SQLITE_PRIVATE
 
	`sqlôe3BåìDñëe
(
BtCurs‹
*);

8718 
SQLITE_PRIVATE
 
	`sqlôe3BåìIn£π
(
BtCurs‹
*, c⁄° *
pKey
, 
i64
 
nKey
,

8719 c⁄° *
pD©a
, 
nD©a
,

8720 
nZîo
, 
büs
, 
£ekResu…
);

8721 
SQLITE_PRIVATE
 
	`sqlôe3BåìFú°
(
BtCurs‹
*, *
pRes
);

8722 
SQLITE_PRIVATE
 
	`sqlôe3BåìLa°
(
BtCurs‹
*, *
pRes
);

8723 
SQLITE_PRIVATE
 
	`sqlôe3BåìNext
(
BtCurs‹
*, *
pRes
);

8724 
SQLITE_PRIVATE
 
	`sqlôe3BåìEof
(
BtCurs‹
*);

8725 
SQLITE_PRIVATE
 
	`sqlôe3BåìPªvious
(
BtCurs‹
*, *
pRes
);

8726 
SQLITE_PRIVATE
 
	`sqlôe3BåìKeySize
(
BtCurs‹
*, 
i64
 *
pSize
);

8727 
SQLITE_PRIVATE
 
	`sqlôe3BåìKey
(
BtCurs‹
*, 
u32
 
off£t
, u32 
amt
, *);

8728 
SQLITE_PRIVATE
 c⁄° *
	`sqlôe3BåìKeyFëch
(
BtCurs‹
*, *
pAmt
);

8729 
SQLITE_PRIVATE
 c⁄° *
	`sqlôe3BåìD©aFëch
(
BtCurs‹
*, *
pAmt
);

8730 
SQLITE_PRIVATE
 
	`sqlôe3BåìD©aSize
(
BtCurs‹
*, 
u32
 *
pSize
);

8731 
SQLITE_PRIVATE
 
	`sqlôe3BåìD©a
(
BtCurs‹
*, 
u32
 
off£t
, u32 
amt
, *);

8732 
SQLITE_PRIVATE
 
	`sqlôe3BåìSëCachedRowid
(
BtCurs‹
*, 
sqlôe3_öt64
);

8733 
SQLITE_PRIVATE
 
sqlôe3_öt64
 
	`sqlôe3BåìGëCachedRowid
(
BtCurs‹
*);

8735 
SQLITE_PRIVATE
 *
	`sqlôe3BåìI¡egrôyCheck
(
Båì
*, *
aRoŸ
, 
nRoŸ
, , *);

8736 
SQLITE_PRIVATE
 
Pagî
 *
	`sqlôe3BåìPagî
(
Båì
*);

8738 
SQLITE_PRIVATE
 
	`sqlôe3BåìPutD©a
(
BtCurs‹
*, 
u32
 
off£t
, u32 
amt
, *);

8739 
SQLITE_PRIVATE
 
	`sqlôe3BåìCacheOvîÊow
(
BtCurs‹
 *);

8740 
SQLITE_PRIVATE
 
	`sqlôe3BåìCÀ¨Curs‹
(
BtCurs‹
 *);

8741 
SQLITE_PRIVATE
 
	`sqlôe3BåìSëVîsi⁄
(
Båì
 *
pBt
, 
iVîsi⁄
);

8742 
SQLITE_PRIVATE
 
	`sqlôe3BåìCurs‹Höts
(
BtCurs‹
 *, 
mask
);

8744 #i‚de‡
NDEBUG


8745 
SQLITE_PRIVATE
 
	`sqlôe3BåìCurs‹IsVÆid
(
BtCurs‹
*);

8748 #i‚de‡
SQLITE_OMIT_BTREECOUNT


8749 
SQLITE_PRIVATE
 
	`sqlôe3BåìCou¡
(
BtCurs‹
 *, 
i64
 *);

8752 #ifde‡
SQLITE_TEST


8753 
SQLITE_PRIVATE
 
	`sqlôe3BåìCurs‹Info
(
BtCurs‹
*, *, );

8754 
SQLITE_PRIVATE
 
	`sqlôe3BåìCurs‹Li°
(
Båì
*);

8757 #i‚de‡
SQLITE_OMIT_WAL


8758 
SQLITE_PRIVATE
 
	`sqlôe3BåìCheckpoöt
(
Båì
*, , *, *);

8766 #i‚de‡
SQLITE_OMIT_SHARED_CACHE


8767 
SQLITE_PRIVATE
 
	`sqlôe3BåìE¡î
(
Båì
*);

8768 
SQLITE_PRIVATE
 
	`sqlôe3BåìE¡îAŒ
(
sqlôe3
*);

8770 
	#sqlôe3BåìE¡î
(
X
)

	)

8771 
	#sqlôe3BåìE¡îAŒ
(
X
)

	)

8774 #i‡!
	`deföed
(
SQLITE_OMIT_SHARED_CACHE
Ë&& 
SQLITE_THREADSAFE


8775 
SQLITE_PRIVATE
 
	`sqlôe3BåìSh¨abÀ
(
Båì
*);

8776 
SQLITE_PRIVATE
 
	`sqlôe3BåìLóve
(
Båì
*);

8777 
SQLITE_PRIVATE
 
	`sqlôe3BåìE¡îCurs‹
(
BtCurs‹
*);

8778 
SQLITE_PRIVATE
 
	`sqlôe3BåìLóveCurs‹
(
BtCurs‹
*);

8779 
SQLITE_PRIVATE
 
	`sqlôe3BåìLóveAŒ
(
sqlôe3
*);

8780 #i‚de‡
NDEBUG


8782 
SQLITE_PRIVATE
 
	`sqlôe3BåìHﬁdsMuãx
(
Båì
*);

8783 
SQLITE_PRIVATE
 
	`sqlôe3BåìHﬁdsAŒMuãxes
(
sqlôe3
*);

8784 
SQLITE_PRIVATE
 
	`sqlôe3SchemaMuãxHñd
(
sqlôe3
*,,
Schema
*);

8788 
	#sqlôe3BåìSh¨abÀ
(
X
Ë0

	)

8789 
	#sqlôe3BåìLóve
(
X
)

	)

8790 
	#sqlôe3BåìE¡îCurs‹
(
X
)

	)

8791 
	#sqlôe3BåìLóveCurs‹
(
X
)

	)

8792 
	#sqlôe3BåìLóveAŒ
(
X
)

	)

8794 
	#sqlôe3BåìHﬁdsMuãx
(
X
Ë1

	)

8795 
	#sqlôe3BåìHﬁdsAŒMuãxes
(
X
Ë1

	)

8796 
	#sqlôe3SchemaMuãxHñd
(
X
,
Y
,
Z
Ë1

	)

8823 #i‚de‡
_SQLITE_VDBE_H_


8824 
	#_SQLITE_VDBE_H_


	)

8832 
Vdbe
 
	tVdbe
;

8838 
Mem
 
	tMem
;

8839 
SubProgøm
 
	tSubProgøm
;

8846 
	sVdbeOp
 {

8847 
u8
 
›code
;

8848 sig√d 
p4ty≥
;

8849 
u8
 
›Êags
;

8850 
u8
 
p5
;

8851 
p1
;

8852 
p2
;

8853 
p3
;

8855 
i
;

8856 *
p
;

8857 *
z
;

8858 
i64
 *
pI64
;

8859 *
pRól
;

8860 
FuncDef
 *
pFunc
;

8861 
CﬁlSeq
 *
pCﬁl
;

8862 
Mem
 *
pMem
;

8863 
VTabÀ
 *
pVèb
;

8864 
KeyInfo
 *
pKeyInfo
;

8865 *
ai
;

8866 
SubProgøm
 *
pProgøm
;

8867 (*
xAdv™˚
)(
BtCurs‹
 *, *);

8868 } 
p4
;

8869 #ifde‡
SQLITE_DEBUG


8870 *
zCommít
;

8872 #ifde‡
VDBE_PROFILE


8873 
˙t
;

8874 
u64
 
cy˛es
;

8877 
VdbeOp
 
	tVdbeOp
;

8883 
	sSubProgøm
 {

8884 
VdbeOp
 *
aOp
;

8885 
nOp
;

8886 
nMem
;

8887 
nC§
;

8888 
nOn˚
;

8889 *
tokí
;

8890 
SubProgøm
 *
pNext
;

8897 
	sVdbeOpLi°
 {

8898 
u8
 
›code
;

8899 sig√d 
p1
;

8900 sig√d 
p2
;

8901 sig√d 
p3
;

8903 
VdbeOpLi°
 
	tVdbeOpLi°
;

8908 
	#P4_NOTUSED
 0

	)

8909 
	#P4_DYNAMIC
 (-1Ë

	)

8910 
	#P4_STATIC
 (-2Ë

	)

8911 
	#P4_COLLSEQ
 (-4Ë

	)

8912 
	#P4_FUNCDEF
 (-5Ë

	)

8913 
	#P4_KEYINFO
 (-6Ë

	)

8914 
	#P4_MEM
 (-8Ë

	)

8915 
	#P4_TRANSIENT
 0

	)

8916 
	#P4_VTAB
 (-10Ë

	)

8917 
	#P4_MPRINTF
 (-11Ë

	)

8918 
	#P4_REAL
 (-12Ë

	)

8919 
	#P4_INT64
 (-13Ë

	)

8920 
	#P4_INT32
 (-14Ë

	)

8921 
	#P4_INTARRAY
 (-15Ë

	)

8922 
	#P4_SUBPROGRAM
 (-18Ë

	)

8923 
	#P4_ADVANCE
 (-19Ë

	)

8932 
	#P4_KEYINFO_HANDOFF
 (-16)

	)

8933 
	#P4_KEYINFO_STATIC
 (-17)

	)

8939 
	#COLNAME_NAME
 0

	)

8940 
	#COLNAME_DECLTYPE
 1

	)

8941 
	#COLNAME_DATABASE
 2

	)

8942 
	#COLNAME_TABLE
 3

	)

8943 
	#COLNAME_COLUMN
 4

	)

8944 #ifde‡
SQLITE_ENABLE_COLUMN_METADATA


8945 
	#COLNAME_N
 5

	)

8947 #ifde‡
SQLITE_OMIT_DECLTYPE


8948 
	#COLNAME_N
 1

	)

8950 
	#COLNAME_N
 2

	)

8960 
	#ADDR
(
X
Ë(-1-(X))

	)

8970 
	#OP_Fun˘i⁄
 1

	)

8971 
	#OP_Savïoöt
 2

	)

8972 
	#OP_AutoCommô
 3

	)

8973 
	#OP_Tønß˘i⁄
 4

	)

8974 
	#OP_S‹ãrNext
 5

	)

8975 
	#OP_Pªv
 6

	)

8976 
	#OP_Next
 7

	)

8977 
	#OP_AggSãp
 8

	)

8978 
	#OP_Checkpoöt
 9

	)

8979 
	#OP_Jou∫ÆMode
 10

	)

8980 
	#OP_Vacuum
 11

	)

8981 
	#OP_VFûãr
 12

	)

8982 
	#OP_VUpd©e
 13

	)

8983 
	#OP_GŸo
 14

	)

8984 
	#OP_Gosub
 15

	)

8985 
	#OP_Rëu∫
 16

	)

8986 
	#OP_Yõld
 17

	)

8987 
	#OP_HÆtIfNuŒ
 18

	)

8988 
	#OP_NŸ
 19

	)

8989 
	#OP_HÆt
 20

	)

8990 
	#OP_I¡egî
 21

	)

8991 
	#OP_I¡64
 22

	)

8992 
	#OP_Såög
 23

	)

8993 
	#OP_NuŒ
 24

	)

8994 
	#OP_Blob
 25

	)

8995 
	#OP_V¨übÀ
 26

	)

8996 
	#OP_Move
 27

	)

8997 
	#OP_C›y
 28

	)

8998 
	#OP_SC›y
 29

	)

8999 
	#OP_Resu…Row
 30

	)

9000 
	#OP_CﬁlSeq
 31

	)

9001 
	#OP_AddImm
 32

	)

9002 
	#OP_Mu°BeI¡
 33

	)

9003 
	#OP_RólAfföôy
 34

	)

9004 
	#OP_Pîmuèti⁄
 35

	)

9005 
	#OP_Com∑ª
 36

	)

9006 
	#OP_Jump
 37

	)

9007 
	#OP_On˚
 38

	)

9008 
	#OP_If
 39

	)

9009 
	#OP_IfNŸ
 40

	)

9010 
	#OP_Cﬁumn
 41

	)

9011 
	#OP_Afföôy
 42

	)

9012 
	#OP_MakeRec‹d
 43

	)

9013 
	#OP_Cou¡
 44

	)

9014 
	#OP_RódCookõ
 45

	)

9015 
	#OP_SëCookõ
 46

	)

9016 
	#OP_VîifyCookõ
 47

	)

9017 
	#OP_O≥nRód
 48

	)

9018 
	#OP_O≥nWrôe
 49

	)

9019 
	#OP_O≥nAutoödex
 50

	)

9020 
	#OP_O≥nEphemîÆ
 51

	)

9021 
	#OP_S‹ãrO≥n
 52

	)

9022 
	#OP_O≥nP£udo
 53

	)

9023 
	#OP_Clo£
 54

	)

9024 
	#OP_SìkLt
 55

	)

9025 
	#OP_SìkLe
 56

	)

9026 
	#OP_SìkGe
 57

	)

9027 
	#OP_SìkGt
 58

	)

9028 
	#OP_Sìk
 59

	)

9029 
	#OP_NŸFound
 60

	)

9030 
	#OP_Found
 61

	)

9031 
	#OP_IsUnique
 62

	)

9032 
	#OP_NŸExi°s
 63

	)

9033 
	#OP_Sequí˚
 64

	)

9034 
	#OP_NewRowid
 65

	)

9035 
	#OP_In£π
 66

	)

9036 
	#OP_In£πI¡
 67

	)

9037 
	#OP_Or
 68

	)

9038 
	#OP_And
 69

	)

9039 
	#OP_Dñëe
 70

	)

9040 
	#OP_Re£tCou¡
 71

	)

9041 
	#OP_S‹ãrCom∑ª
 72

	)

9042 
	#OP_IsNuŒ
 73

	)

9043 
	#OP_NŸNuŒ
 74

	)

9044 
	#OP_Ne
 75

	)

9045 
	#OP_Eq
 76

	)

9046 
	#OP_Gt
 77

	)

9047 
	#OP_Le
 78

	)

9048 
	#OP_Lt
 79

	)

9049 
	#OP_Ge
 80

	)

9050 
	#OP_S‹ãrD©a
 81

	)

9051 
	#OP_BôAnd
 82

	)

9052 
	#OP_BôOr
 83

	)

9053 
	#OP_Shi·Le·
 84

	)

9054 
	#OP_Shi·Right
 85

	)

9055 
	#OP_Add
 86

	)

9056 
	#OP_Subåa˘
 87

	)

9057 
	#OP_Mu…ùly
 88

	)

9058 
	#OP_Divide
 89

	)

9059 
	#OP_Remaödî
 90

	)

9060 
	#OP_C⁄ˇt
 91

	)

9061 
	#OP_RowKey
 92

	)

9062 
	#OP_BôNŸ
 93

	)

9063 
	#OP_Såög8
 94

	)

9064 
	#OP_RowD©a
 95

	)

9065 
	#OP_Rowid
 96

	)

9066 
	#OP_NuŒRow
 97

	)

9067 
	#OP_La°
 98

	)

9068 
	#OP_S‹ãrS‹t
 99

	)

9069 
	#OP_S‹t
 100

	)

9070 
	#OP_Rewöd
 101

	)

9071 
	#OP_S‹ãrIn£π
 102

	)

9072 
	#OP_IdxIn£π
 103

	)

9073 
	#OP_IdxDñëe
 104

	)

9074 
	#OP_IdxRowid
 105

	)

9075 
	#OP_IdxLT
 106

	)

9076 
	#OP_IdxGE
 107

	)

9077 
	#OP_De°roy
 108

	)

9078 
	#OP_CÀ¨
 109

	)

9079 
	#OP_Cª©eIndex
 110

	)

9080 
	#OP_Cª©eTabÀ
 111

	)

9081 
	#OP_P¨£Schema
 112

	)

9082 
	#OP_LﬂdA«lysis
 113

	)

9083 
	#OP_Dr›TabÀ
 114

	)

9084 
	#OP_Dr›Index
 115

	)

9085 
	#OP_Dr›Triggî
 116

	)

9086 
	#OP_I¡egrôyCk
 117

	)

9087 
	#OP_RowSëAdd
 118

	)

9088 
	#OP_RowSëRód
 119

	)

9089 
	#OP_RowSëTe°
 120

	)

9090 
	#OP_Progøm
 121

	)

9091 
	#OP_P¨am
 122

	)

9092 
	#OP_FkCou¡î
 123

	)

9093 
	#OP_FkIfZîo
 124

	)

9094 
	#OP_MemMax
 125

	)

9095 
	#OP_IfPos
 126

	)

9096 
	#OP_IfNeg
 127

	)

9097 
	#OP_IfZîo
 128

	)

9098 
	#OP_AggFöÆ
 129

	)

9099 
	#OP_Ról
 130

	)

9100 
	#OP_In¸Vacuum
 131

	)

9101 
	#OP_Expúe
 132

	)

9102 
	#OP_TabÀLock
 133

	)

9103 
	#OP_VBegö
 134

	)

9104 
	#OP_VCª©e
 135

	)

9105 
	#OP_VDe°roy
 136

	)

9106 
	#OP_VO≥n
 137

	)

9107 
	#OP_VCﬁumn
 138

	)

9108 
	#OP_VNext
 139

	)

9109 
	#OP_VRíame
 140

	)

9110 
	#OP_Pagecou¡
 141

	)

9111 
	#OP_MaxPg˙t
 142

	)

9112 
	#OP_Tø˚
 143

	)

9113 
	#OP_No›
 144

	)

9114 
	#OP_Ex∂aö
 145

	)

9121 
	#OPFLG_JUMP
 0x0001

	)

9122 
	#OPFLG_OUT2_PRERELEASE
 0x0002

	)

9123 
	#OPFLG_IN1
 0x0004

	)

9124 
	#OPFLG_IN2
 0x0008

	)

9125 
	#OPFLG_IN3
 0x0010

	)

9126 
	#OPFLG_OUT2
 0x0020

	)

9127 
	#OPFLG_OUT3
 0x0040

	)

9128 
	#OPFLG_INITIALIZER
 {\

9147  0x00, 0x00,
	}

	)
}

9156 
SQLITE_PRIVATE
 
Vdbe
 *
sqlôe3VdbeCª©e
(
sqlôe3
*);

9157 
SQLITE_PRIVATE
 
sqlôe3VdbeAddOp0
(
Vdbe
*,);

9158 
SQLITE_PRIVATE
 
sqlôe3VdbeAddOp1
(
Vdbe
*,,);

9159 
SQLITE_PRIVATE
 
sqlôe3VdbeAddOp2
(
Vdbe
*,,,);

9160 
SQLITE_PRIVATE
 
sqlôe3VdbeAddOp3
(
Vdbe
*,,,,);

9161 
SQLITE_PRIVATE
 
sqlôe3VdbeAddOp4
(
Vdbe
*,,,,,c⁄° *
zP4
,);

9162 
SQLITE_PRIVATE
 
sqlôe3VdbeAddOp4I¡
(
Vdbe
*,,,,,);

9163 
SQLITE_PRIVATE
 
sqlôe3VdbeAddOpLi°
(
Vdbe
*, 
nOp
, 
VdbeOpLi°
 c⁄° *
aOp
);

9164 
SQLITE_PRIVATE
 
sqlôe3VdbeAddP¨£SchemaOp
(
Vdbe
*,,*);

9165 
SQLITE_PRIVATE
 
sqlôe3VdbeCh™geP1
(
Vdbe
*, 
u32
 
addr
, 
P1
);

9166 
SQLITE_PRIVATE
 
sqlôe3VdbeCh™geP2
(
Vdbe
*, 
u32
 
addr
, 
P2
);

9167 
SQLITE_PRIVATE
 
sqlôe3VdbeCh™geP3
(
Vdbe
*, 
u32
 
addr
, 
P3
);

9168 
SQLITE_PRIVATE
 
sqlôe3VdbeCh™geP5
(
Vdbe
*, 
u8
 
P5
);

9169 
SQLITE_PRIVATE
 
sqlôe3VdbeJumpHîe
(
Vdbe
*, 
addr
);

9170 
SQLITE_PRIVATE
 
sqlôe3VdbeCh™geToNo›
(
Vdbe
*, 
addr
);

9171 
SQLITE_PRIVATE
 
sqlôe3VdbeCh™geP4
(
Vdbe
*, 
addr
, c⁄° *
zP4
, 
N
);

9172 
SQLITE_PRIVATE
 
sqlôe3VdbeU£sBåì
(
Vdbe
*, );

9173 
SQLITE_PRIVATE
 
VdbeOp
 *
sqlôe3VdbeGëOp
(
Vdbe
*, );

9174 
SQLITE_PRIVATE
 
sqlôe3VdbeMakeLabñ
(
Vdbe
*);

9175 
SQLITE_PRIVATE
 
sqlôe3VdbeRunO∆yOn˚
(
Vdbe
*);

9176 
SQLITE_PRIVATE
 
sqlôe3VdbeDñëe
(
Vdbe
*);

9177 
SQLITE_PRIVATE
 
sqlôe3VdbeCÀ¨Obje˘
(
sqlôe3
*,
Vdbe
*);

9178 
SQLITE_PRIVATE
 
sqlôe3VdbeMakeRódy
(
Vdbe
*,
P¨£
*);

9179 
SQLITE_PRIVATE
 
sqlôe3VdbeFöÆize
(
Vdbe
*);

9180 
SQLITE_PRIVATE
 
sqlôe3VdbeResﬁveLabñ
(
Vdbe
*, );

9181 
SQLITE_PRIVATE
 
sqlôe3VdbeCuºítAddr
(
Vdbe
*);

9182 #ifde‡
SQLITE_DEBUG


9183 
SQLITE_PRIVATE
 
sqlôe3VdbeAs£πMayAb‹t
(
Vdbe
 *, );

9184 
SQLITE_PRIVATE
 
sqlôe3VdbeTø˚
(
Vdbe
*,
FILE
*);

9186 
SQLITE_PRIVATE
 
sqlôe3VdbeRe£tSãpResu…
(
Vdbe
*);

9187 
SQLITE_PRIVATE
 
sqlôe3VdbeRewöd
(
Vdbe
*);

9188 
SQLITE_PRIVATE
 
sqlôe3VdbeRe£t
(
Vdbe
*);

9189 
SQLITE_PRIVATE
 
sqlôe3VdbeSëNumCﬁs
(
Vdbe
*,);

9190 
SQLITE_PRIVATE
 
sqlôe3VdbeSëCﬁName
(
Vdbe
*, , , const *, (*)(*));

9191 
SQLITE_PRIVATE
 
	`sqlôe3VdbeCou¡Ch™ges
(
Vdbe
*);

9192 
SQLITE_PRIVATE
 
sqlôe3
 *
	`sqlôe3VdbeDb
(
Vdbe
*);

9193 
SQLITE_PRIVATE
 
	`sqlôe3VdbeSëSql
(
Vdbe
*, c⁄° *
z
, 
n
, );

9194 
SQLITE_PRIVATE
 
	`sqlôe3VdbeSw≠
(
Vdbe
*,Vdbe*);

9195 
SQLITE_PRIVATE
 
VdbeOp
 *
	`sqlôe3VdbeTakeOpAºay
(
Vdbe
*, *, *);

9196 
SQLITE_PRIVATE
 
sqlôe3_vÆue
 *
	`sqlôe3VdbeGëBoundVÆue
(
Vdbe
*, , 
u8
);

9197 
SQLITE_PRIVATE
 
	`sqlôe3VdbeSëV¨mask
(
Vdbe
*, );

9198 #i‚de‡
SQLITE_OMIT_TRACE


9199 
SQLITE_PRIVATE
 *
	`sqlôe3VdbeEx∑ndSql
(
Vdbe
*, const *);

9202 
SQLITE_PRIVATE
 
	`sqlôe3VdbeRec‹dU≈ack
(
KeyInfo
*,,c⁄° *,
U≈ackedRec‹d
*);

9203 
SQLITE_PRIVATE
 
	`sqlôe3VdbeRec‹dCom∑ª
(,c⁄° *,
U≈ackedRec‹d
*);

9204 
SQLITE_PRIVATE
 
U≈ackedRec‹d
 *
	`sqlôe3VdbeAŒocU≈ackedRec‹d
(
KeyInfo
 *, *, , **);

9206 #i‚de‡
SQLITE_OMIT_TRIGGER


9207 
SQLITE_PRIVATE
 
	`sqlôe3VdbeLökSubProgøm
(
Vdbe
 *, 
SubProgøm
 *);

9211 #i‚de‡
NDEBUG


9212 
SQLITE_PRIVATE
 
	`sqlôe3VdbeCommít
(
Vdbe
*, const *, ...);

9213 
	#VdbeCommít
(
X
Ë
sqlôe3VdbeCommít
 
	)
X

9214 
SQLITE_PRIVATE
 
	`sqlôe3VdbeNo›Commít
(
Vdbe
*, const *, ...);

9215 
	#VdbeNo›Commít
(
X
Ë
sqlôe3VdbeNo›Commít
 
	)
X

9217 
	#VdbeCommít
(
X
)

	)

9218 
	#VdbeNo›Commít
(
X
)

	)

9243 #i‚de‡
_PAGER_H_


9244 
	#_PAGER_H_


	)

9251 #i‚de‡
SQLITE_DEFAULT_JOURNAL_SIZE_LIMIT


9252 
	#SQLITE_DEFAULT_JOURNAL_SIZE_LIMIT
 -1

	)

9259 
u32
 
	tPgno
;

9264 
Pagî
 
	tPagî
;

9269 
PgHdr
 
	tDbPage
;

9279 
	#PAGER_MJ_PGNO
(
x
Ë((
Pgno
)((
PENDING_BYTE
/((x)->
∑geSize
))+1))

	)

9286 
	#PAGER_OMIT_JOURNAL
 0x0001

	)

9287 
	#PAGER_MEMORY
 0x0002

	)

9292 
	#PAGER_LOCKINGMODE_QUERY
 -1

	)

9293 
	#PAGER_LOCKINGMODE_NORMAL
 0

	)

9294 
	#PAGER_LOCKINGMODE_EXCLUSIVE
 1

	)

9299 
	#PAGER_JOURNALMODE_QUERY
 (-1Ë

	)

9300 
	#PAGER_JOURNALMODE_DELETE
 0

	)

9301 
	#PAGER_JOURNALMODE_PERSIST
 1

	)

9302 
	#PAGER_JOURNALMODE_OFF
 2

	)

9303 
	#PAGER_JOURNALMODE_TRUNCATE
 3

	)

9304 
	#PAGER_JOURNALMODE_MEMORY
 4

	)

9305 
	#PAGER_JOURNALMODE_WAL
 5

	)

9310 
	#PAGER_GET_NOCONTENT
 0x01

	)

9311 
	#PAGER_GET_READONLY
 0x02

	)

9316 
	#PAGER_SYNCHRONOUS_OFF
 0x01

	)

9317 
	#PAGER_SYNCHRONOUS_NORMAL
 0x02

	)

9318 
	#PAGER_SYNCHRONOUS_FULL
 0x03

	)

9319 
	#PAGER_SYNCHRONOUS_MASK
 0x03

	)

9320 
	#PAGER_FULLFSYNC
 0x04

	)

9321 
	#PAGER_CKPT_FULLFSYNC
 0x08

	)

9322 
	#PAGER_CACHESPILL
 0x10

	)

9323 
	#PAGER_FLAGS_MASK
 0x1¯

	)

9332 
SQLITE_PRIVATE
 
	`sqlôe3PagîO≥n
(

9333 
sqlôe3_vfs
*,

9334 
Pagî
 **
µPagî
,

9339 (*)(
DbPage
*)

9341 
SQLITE_PRIVATE
 
	`sqlôe3PagîClo£
(
Pagî
 *
pPagî
);

9342 
SQLITE_PRIVATE
 
	`sqlôe3PagîRódFûehódî
(
Pagî
*, , *);

9345 
SQLITE_PRIVATE
 
	`sqlôe3PagîSëBusyh™dÀr
(
Pagî
*, (*)(*), *);

9346 
SQLITE_PRIVATE
 
	`sqlôe3PagîSëPagesize
(
Pagî
*, 
u32
*, );

9347 
SQLITE_PRIVATE
 
	`sqlôe3PagîMaxPageCou¡
(
Pagî
*, );

9348 
SQLITE_PRIVATE
 
	`sqlôe3PagîSëCachesize
(
Pagî
*, );

9349 
SQLITE_PRIVATE
 
	`sqlôe3PagîSëMm≠Limô
(
Pagî
 *, 
sqlôe3_öt64
);

9350 
SQLITE_PRIVATE
 
	`sqlôe3PagîShrök
(
Pagî
*);

9351 
SQLITE_PRIVATE
 
	`sqlôe3PagîSëFœgs
(
Pagî
*,);

9352 
SQLITE_PRIVATE
 
	`sqlôe3PagîLockögMode
(
Pagî
 *, );

9353 
SQLITE_PRIVATE
 
	`sqlôe3PagîSëJou∫ÆMode
(
Pagî
 *, );

9354 
SQLITE_PRIVATE
 
	`sqlôe3PagîGëJou∫ÆMode
(
Pagî
*);

9355 
SQLITE_PRIVATE
 
	`sqlôe3PagîOkToCh™geJou∫ÆMode
(
Pagî
*);

9356 
SQLITE_PRIVATE
 
i64
 
	`sqlôe3PagîJou∫ÆSizeLimô
(
Pagî
 *, i64);

9357 
SQLITE_PRIVATE
 
sqlôe3_backup
 **
	`sqlôe3PagîBackupPå
(
Pagî
*);

9360 
SQLITE_PRIVATE
 
	`sqlôe3PagîAcquúe
(
Pagî
 *
pPagî
, 
Pgno
 
pgno
, 
DbPage
 **
µPage
, 
˛rFœg
);

9361 
	#sqlôe3PagîGë
(
A
,
B
,
C
Ë
	`sqlôe3PagîAcquúe
(A,B,C,0)

	)

9362 
SQLITE_PRIVATE
 
DbPage
 *
	`sqlôe3PagîLookup
(
Pagî
 *
pPagî
, 
Pgno
 
pgno
);

9363 
SQLITE_PRIVATE
 
	`sqlôe3PagîRef
(
DbPage
*);

9364 
SQLITE_PRIVATE
 
	`sqlôe3PagîUƒef
(
DbPage
*);

9367 
SQLITE_PRIVATE
 
	`sqlôe3PagîWrôe
(
DbPage
*);

9368 
SQLITE_PRIVATE
 
	`sqlôe3PagîD⁄tWrôe
(
DbPage
*);

9369 
SQLITE_PRIVATE
 
	`sqlôe3PagîMovïage
(
Pagî
*,
DbPage
*,
Pgno
,);

9370 
SQLITE_PRIVATE
 
	`sqlôe3PagîPageRefcou¡
(
DbPage
*);

9371 
SQLITE_PRIVATE
 *
	`sqlôe3PagîGëD©a
(
DbPage
 *);

9372 
SQLITE_PRIVATE
 *
	`sqlôe3PagîGëExåa
(
DbPage
 *);

9375 
SQLITE_PRIVATE
 
	`sqlôe3PagîPagecou¡
(
Pagî
*, *);

9376 
SQLITE_PRIVATE
 
	`sqlôe3PagîBegö
(
Pagî
*, 
exFœg
, );

9377 
SQLITE_PRIVATE
 
	`sqlôe3PagîCommôPha£O√
(
Pagî
*,c⁄° *
zMa°î
, );

9378 
SQLITE_PRIVATE
 
	`sqlôe3PagîEx˛usiveLock
(
Pagî
*);

9379 
SQLITE_PRIVATE
 
	`sqlôe3PagîSync
(
Pagî
 *
pPagî
);

9380 
SQLITE_PRIVATE
 
	`sqlôe3PagîCommôPha£Two
(
Pagî
*);

9381 
SQLITE_PRIVATE
 
	`sqlôe3PagîRﬁlback
(
Pagî
*);

9382 
SQLITE_PRIVATE
 
	`sqlôe3PagîO≥nSavïoöt
(
Pagî
 *
pPagî
, 
n
);

9383 
SQLITE_PRIVATE
 
	`sqlôe3PagîSavïoöt
(
Pagî
 *
pPagî
, 
›
, 
iSavïoöt
);

9384 
SQLITE_PRIVATE
 
	`sqlôe3PagîSh¨edLock
(
Pagî
 *
pPagî
);

9386 #i‚de‡
SQLITE_OMIT_WAL


9387 
SQLITE_PRIVATE
 
	`sqlôe3PagîCheckpoöt
(
Pagî
 *
pPagî
, , *, *);

9388 
SQLITE_PRIVATE
 
	`sqlôe3PagîWÆSuµ‹ãd
(
Pagî
 *
pPagî
);

9389 
SQLITE_PRIVATE
 
	`sqlôe3PagîWÆCÆlback
(
Pagî
 *
pPagî
);

9390 
SQLITE_PRIVATE
 
	`sqlôe3PagîO≥nWÆ
(
Pagî
 *
pPagî
, *
pisO≥n
);

9391 
SQLITE_PRIVATE
 
	`sqlôe3PagîClo£WÆ
(
Pagî
 *
pPagî
);

9394 #ifde‡
SQLITE_ENABLE_ZIPVFS


9395 
SQLITE_PRIVATE
 
	`sqlôe3PagîWÆFømesize
(
Pagî
 *
pPagî
);

9399 
SQLITE_PRIVATE
 
u8
 
	`sqlôe3PagîI§ód⁄ly
(
Pagî
*);

9400 
SQLITE_PRIVATE
 
	`sqlôe3PagîRefcou¡
(
Pagî
*);

9401 
SQLITE_PRIVATE
 
	`sqlôe3PagîMemU£d
(
Pagî
*);

9402 
SQLITE_PRIVATE
 c⁄° *
	`sqlôe3PagîFûíame
(
Pagî
*, );

9403 
SQLITE_PRIVATE
 c⁄° 
sqlôe3_vfs
 *
	`sqlôe3PagîVfs
(
Pagî
*);

9404 
SQLITE_PRIVATE
 
sqlôe3_fûe
 *
	`sqlôe3PagîFûe
(
Pagî
*);

9405 
SQLITE_PRIVATE
 c⁄° *
	`sqlôe3PagîJou∫Æ«me
(
Pagî
*);

9406 
SQLITE_PRIVATE
 
	`sqlôe3PagîNosync
(
Pagî
*);

9407 
SQLITE_PRIVATE
 *
	`sqlôe3PagîTempS∑˚
(
Pagî
*);

9408 
SQLITE_PRIVATE
 
	`sqlôe3PagîIsMemdb
(
Pagî
*);

9409 
SQLITE_PRIVATE
 
	`sqlôe3PagîCacheSèt
(
Pagî
 *, , , *);

9410 
SQLITE_PRIVATE
 
	`sqlôe3PagîCÀ¨Cache
(
Pagî
 *);

9411 
SQLITE_PRIVATE
 
	`sqlôe3Se˘‹Size
(
sqlôe3_fûe
 *);

9414 
SQLITE_PRIVATE
 
	`sqlôe3PagîTrunˇãImage
(
Pagî
*,
Pgno
);

9416 #i‡
	`deföed
(
SQLITE_HAS_CODEC
Ë&& !deföed(
SQLITE_OMIT_WAL
)

9417 
SQLITE_PRIVATE
 *
	`sqlôe3PagîCodec
(
DbPage
 *);

9421 #i‡!
	`deföed
(
NDEBUG
Ë|| deföed(
SQLITE_TEST
)

9422 
SQLITE_PRIVATE
 
Pgno
 
	`sqlôe3PagîPagíumbî
(
DbPage
*);

9423 
SQLITE_PRIVATE
 
	`sqlôe3PagîIswrôóbÀ
(
DbPage
*);

9425 #ifde‡
SQLITE_TEST


9426 
SQLITE_PRIVATE
 *
	`sqlôe3PagîSèts
(
Pagî
*);

9427 
SQLITE_PRIVATE
 
	`sqlôe3PagîRefdump
(
Pagî
*);

9428 
	`dißbÀ_simuœãd_io_îr‹s
();

9429 
	`íabÀ_simuœãd_io_îr‹s
();

9431 
	#dißbÀ_simuœãd_io_îr‹s
()

	)

9432 
	#íabÀ_simuœãd_io_îr‹s
()

	)

9456 #i‚de‡
_PCACHE_H_


9458 
PgHdr
 
	tPgHdr
;

9459 
PCache
 
	tPCache
;

9465 
	sPgHdr
 {

9466 
sqlôe3_pˇche_∑ge
 *
pPage
;

9467 *
pD©a
;

9468 *
pExåa
;

9469 
PgHdr
 *
pDúty
;

9470 
Pagî
 *
pPagî
;

9471 
Pgno
 
pgno
;

9472 #ifde‡
SQLITE_CHECK_PAGES


9473 
u32
 
∑geHash
;

9475 
u16
 
Êags
;

9481 
i16
 
nRef
;

9482 
PCache
 *
pCache
;

9484 
PgHdr
 *
pDútyNext
;

9485 
PgHdr
 *
pDútyPªv
;

9489 
	#PGHDR_DIRTY
 0x002

	)

9490 
	#PGHDR_NEED_SYNC
 0x004

	)

9492 
	#PGHDR_NEED_READ
 0x008

	)

9493 
	#PGHDR_REUSE_UNLIKELY
 0x010

	)

9494 
	#PGHDR_DONT_WRITE
 0x020

	)

9496 
	#PGHDR_MMAP
 0x040

	)

9499 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheInôülize
();

9500 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheShutdown
();

9505 
SQLITE_PRIVATE
 
	`sqlôe3PCacheBuf„rSëup
(*, 
sz
, 
n
);

9511 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheO≥n
(

9512 
szPage
,

9513 
szExåa
,

9514 
bPurgóbÀ
,

9515 (*
xSåess
)(*, 
PgHdr
*),

9516 *
pSåess
,

9517 
PCache
 *
pToInô


9521 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheSëPageSize
(
PCache
 *, );

9526 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheSize
();

9531 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheFëch
(
PCache
*, 
Pgno
, 
¸óãFœg
, 
PgHdr
**);

9532 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheRñó£
(
PgHdr
*);

9534 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheDr›
(
PgHdr
*);

9535 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheMakeDúty
(
PgHdr
*);

9536 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheMakeCÀ™
(
PgHdr
*);

9537 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheCÀ™AŒ
(
PCache
*);

9540 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheMove
(
PgHdr
*, 
Pgno
);

9543 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheTrunˇã
(
PCache
*, 
Pgno
 
x
);

9546 
SQLITE_PRIVATE
 
PgHdr
 *
	`sqlôe3PˇcheDútyLi°
(
PCache
*);

9549 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheClo£
(
PCache
*);

9552 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheCÀ¨SyncFœgs
(
PCache
 *);

9555 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheCÀ¨
(
PCache
*);

9558 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheRefCou¡
(
PCache
*);

9561 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheRef
(
PgHdr
*);

9563 
SQLITE_PRIVATE
 
	`sqlôe3PˇchePageRefcou¡
(
PgHdr
*);

9566 
SQLITE_PRIVATE
 
	`sqlôe3PˇchePagecou¡
(
PCache
*);

9568 #i‡
	`deföed
(
SQLITE_CHECK_PAGES
Ë|| deföed(
SQLITE_DEBUG
)

9573 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheIãøãDúty
(
PCache
 *
pCache
, (*
xIãr
)(
PgHdr
 *));

9582 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheSëCachesize
(
PCache
 *, );

9583 #ifde‡
SQLITE_TEST


9584 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheGëCachesize
(
PCache
 *);

9588 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheShrök
(
PCache
*);

9590 #ifde‡
SQLITE_ENABLE_MEMORY_MANAGEMENT


9592 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheRñó£Mem‹y
();

9595 #ifde‡
SQLITE_TEST


9596 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheSèts
(*,*,*,*);

9599 
SQLITE_PRIVATE
 
	`sqlôe3PCacheSëDeÁu…
();

9627 #i‚de‡
_SQLITE_OS_H_


9628 
	#_SQLITE_OS_H_


	)

9637 #i‡
	`deföed
(
SQLITE_OS_OTHER
)

9638 #i‡
SQLITE_OS_OTHER
==1

9639 #unde‡
SQLITE_OS_UNIX


9640 
	#SQLITE_OS_UNIX
 0

	)

9641 #unde‡
SQLITE_OS_WIN


9642 
	#SQLITE_OS_WIN
 0

	)

9644 #unde‡
SQLITE_OS_OTHER


9647 #i‡!
	`deföed
(
SQLITE_OS_UNIX
Ë&& !deföed(
SQLITE_OS_OTHER
)

9648 
	#SQLITE_OS_OTHER
 0

	)

9649 #i‚de‡
SQLITE_OS_WIN


9650 #i‡
	`deföed
(
_WIN32
Ë|| deföed(
WIN32
Ë|| deföed(
__CYGWIN__
Ë|| deföed(
__MINGW32__
Ë|| deföed(
__BORLANDC__
)

9651 
	#SQLITE_OS_WIN
 1

	)

9652 
	#SQLITE_OS_UNIX
 0

	)

9654 
	#SQLITE_OS_WIN
 0

	)

9655 
	#SQLITE_OS_UNIX
 1

	)

9658 
	#SQLITE_OS_UNIX
 0

	)

9661 #i‚de‡
SQLITE_OS_WIN


9662 
	#SQLITE_OS_WIN
 0

	)

9666 #i‡
SQLITE_OS_WIN


9667 
	~<wödows.h
>

9687 #i‡
SQLITE_OS_WIN
 && !
	`deföed
(
SQLITE_OS_WINNT
)

9688 
	#SQLITE_OS_WINNT
 1

	)

9695 #i‡
	`deföed
(
_WIN32_WCE
)

9696 
	#SQLITE_OS_WINCE
 1

	)

9698 
	#SQLITE_OS_WINCE
 0

	)

9705 #i‡!
	`deföed
(
SQLITE_OS_WINRT
)

9706 
	#SQLITE_OS_WINRT
 0

	)

9712 #i‚de‡
SET_FULLSYNC


9713 
	#SET_FULLSYNC
(
x
,
y
)

	)

9719 #i‚de‡
SQLITE_DEFAULT_SECTOR_SIZE


9720 
	#SQLITE_DEFAULT_SECTOR_SIZE
 4096

	)

9744 #i‚de‡
SQLITE_TEMP_FILE_PREFIX


9745 
	#SQLITE_TEMP_FILE_PREFIX
 "ëûqs_"

	)

9765 
	#NO_LOCK
 0

	)

9766 
	#SHARED_LOCK
 1

	)

9767 
	#RESERVED_LOCK
 2

	)

9768 
	#PENDING_LOCK
 3

	)

9769 
	#EXCLUSIVE_LOCK
 4

	)

9826 #ifde‡
SQLITE_OMIT_WSD


9827 
	#PENDING_BYTE
 (0x40000000)

	)

9829 
	#PENDING_BYTE
 
sqlôe3PídögByã


	)

9831 
	#RESERVED_BYTE
 (
PENDING_BYTE
+1)

	)

9832 
	#SHARED_FIRST
 (
PENDING_BYTE
+2)

	)

9833 
	#SHARED_SIZE
 510

	)

9838 
SQLITE_PRIVATE
 
	`sqlôe3OsInô
();

9843 
SQLITE_PRIVATE
 
	`sqlôe3OsClo£
(
sqlôe3_fûe
*);

9844 
SQLITE_PRIVATE
 
	`sqlôe3OsRód
(
sqlôe3_fûe
*, *, 
amt
, 
i64
 
off£t
);

9845 
SQLITE_PRIVATE
 
	`sqlôe3OsWrôe
(
sqlôe3_fûe
*, c⁄° *, 
amt
, 
i64
 
off£t
);

9846 
SQLITE_PRIVATE
 
	`sqlôe3OsTrunˇã
(
sqlôe3_fûe
*, 
i64
 
size
);

9847 
SQLITE_PRIVATE
 
	`sqlôe3OsSync
(
sqlôe3_fûe
*, );

9848 
SQLITE_PRIVATE
 
	`sqlôe3OsFûeSize
(
sqlôe3_fûe
*, 
i64
 *
pSize
);

9849 
SQLITE_PRIVATE
 
	`sqlôe3OsLock
(
sqlôe3_fûe
*, );

9850 
SQLITE_PRIVATE
 
	`sqlôe3OsU∆ock
(
sqlôe3_fûe
*, );

9851 
SQLITE_PRIVATE
 
	`sqlôe3OsCheckRe£rvedLock
(
sqlôe3_fûe
 *
id
, *
pResOut
);

9852 
SQLITE_PRIVATE
 
	`sqlôe3OsFûeC⁄åﬁ
(
sqlôe3_fûe
*,,*);

9853 
SQLITE_PRIVATE
 
	`sqlôe3OsFûeC⁄åﬁHöt
(
sqlôe3_fûe
*,,*);

9854 
	#SQLITE_FCNTL_DB_UNCHANGED
 0xˇ093Á0

	)

9855 
SQLITE_PRIVATE
 
	`sqlôe3OsSe˘‹Size
(
sqlôe3_fûe
 *
id
);

9856 
SQLITE_PRIVATE
 
	`sqlôe3OsDevi˚Ch¨a˘îi°ics
(
sqlôe3_fûe
 *
id
);

9857 
SQLITE_PRIVATE
 
	`sqlôe3OsShmM≠
(
sqlôe3_fûe
 *,,,,volatile **);

9858 
SQLITE_PRIVATE
 
	`sqlôe3OsShmLock
(
sqlôe3_fûe
 *
id
, , , );

9859 
SQLITE_PRIVATE
 
	`sqlôe3OsShmB¨rõr
(
sqlôe3_fûe
 *
id
);

9860 
SQLITE_PRIVATE
 
	`sqlôe3OsShmUnm≠
(
sqlôe3_fûe
 *
id
, );

9861 
SQLITE_PRIVATE
 
	`sqlôe3OsFëch
(
sqlôe3_fûe
 *
id
, 
i64
, , **);

9862 
SQLITE_PRIVATE
 
	`sqlôe3OsUn„tch
(
sqlôe3_fûe
 *, 
i64
, *);

9868 
SQLITE_PRIVATE
 
	`sqlôe3OsO≥n
(
sqlôe3_vfs
 *, c⁄° *, 
sqlôe3_fûe
*, , *);

9869 
SQLITE_PRIVATE
 
	`sqlôe3OsDñëe
(
sqlôe3_vfs
 *, const *, );

9870 
SQLITE_PRIVATE
 
	`sqlôe3OsAc˚ss
(
sqlôe3_vfs
 *, c⁄° *, , *
pResOut
);

9871 
SQLITE_PRIVATE
 
	`sqlôe3OsFuŒP©h«me
(
sqlôe3_vfs
 *, const *, , *);

9872 #i‚de‡
SQLITE_OMIT_LOAD_EXTENSION


9873 
SQLITE_PRIVATE
 *
	`sqlôe3OsDlO≥n
(
sqlôe3_vfs
 *, const *);

9874 
SQLITE_PRIVATE
 
	`sqlôe3OsDlEº‹
(
sqlôe3_vfs
 *, , *);

9875 
SQLITE_PRIVATE
 (*
	$sqlôe3OsDlSym
(
sqlôe3_vfs
 *, *, const *))();

9876 
SQLITE_PRIVATE
 
	`sqlôe3OsDlClo£
(
sqlôe3_vfs
 *, *);

9878 
SQLITE_PRIVATE
 
	`sqlôe3OsR™dom√ss
(
sqlôe3_vfs
 *, , *);

9879 
SQLITE_PRIVATE
 
	`sqlôe3OsSÀï
(
sqlôe3_vfs
 *, );

9880 
SQLITE_PRIVATE
 
	`sqlôe3OsCuºítTimeI¡64
(
sqlôe3_vfs
 *, 
sqlôe3_öt64
*);

9886 
SQLITE_PRIVATE
 
	`sqlôe3OsO≥nMÆloc
(
sqlôe3_vfs
 *, c⁄° *, 
sqlôe3_fûe
 **, ,*);

9887 
SQLITE_PRIVATE
 
	`sqlôe3OsClo£Fªe
(
sqlôe3_fûe
 *);

9934 #i‡!
SQLITE_THREADSAFE


9935 
	#SQLITE_MUTEX_OMIT


	)

9937 #i‡
SQLITE_THREADSAFE
 && !
	`deföed
(
SQLITE_MUTEX_NOOP
)

9938 #i‡
SQLITE_OS_UNIX


9939 
	#SQLITE_MUTEX_PTHREADS


	)

9940 #ñi‡
SQLITE_OS_WIN


9941 
	#SQLITE_MUTEX_W32


	)

9943 
	#SQLITE_MUTEX_NOOP


	)

9947 #ifde‡
SQLITE_MUTEX_OMIT


9951 
	#sqlôe3_muãx_Æloc
(
X
Ë((
sqlôe3_muãx
*)8)

	)

9952 
	#sqlôe3_muãx_‰ì
(
X
)

	)

9953 
	#sqlôe3_muãx_íãr
(
X
)

	)

9954 
	#sqlôe3_muãx_åy
(
X
Ë
SQLITE_OK


	)

9955 
	#sqlôe3_muãx_Àave
(
X
)

	)

9956 
	#sqlôe3_muãx_hñd
(
X
Ë(()(X),1)

	)

9957 
	#sqlôe3_muãx_nŸhñd
(
X
Ë(()(X),1)

	)

9958 
	#sqlôe3MuãxAŒoc
(
X
Ë((
sqlôe3_muãx
*)8)

	)

9959 
	#sqlôe3MuãxInô
(Ë
SQLITE_OK


	)

9960 
	#sqlôe3MuãxEnd
()

	)

9961 
	#MUTEX_LOGIC
(
X
)

	)

9963 
	#MUTEX_LOGIC
(
X
Ë
	)
X

9977 
	sDb
 {

9978 *
zName
;

9979 
Båì
 *
pBt
;

9980 
u8
 
ß„ty_Àvñ
;

9981 
Schema
 *
pSchema
;

10001 
	sSchema
 {

10002 
schema_cookõ
;

10003 
iGíî©i⁄
;

10004 
Hash
 
tblHash
;

10005 
Hash
 
idxHash
;

10006 
Hash
 
åigHash
;

10007 
Hash
 
fkeyHash
;

10008 
TabÀ
 *
pSeqTab
;

10009 
u8
 
fûe_f‹m©
;

10010 
u8
 
íc
;

10011 
u16
 
Êags
;

10012 
ˇche_size
;

10019 
	#DbHasPr›îty
(
D
,
I
,
P
Ë(((D)->
aDb
[I].
pSchema
->
Êags
&(P))==(P))

	)

10020 
	#DbHasAnyPr›îty
(
D
,
I
,
P
Ë(((D)->
aDb
[I].
pSchema
->
Êags
&(P))!=0)

	)

10021 
	#DbSëPr›îty
(
D
,
I
,
P
Ë(D)->
aDb
[I].
pSchema
->
Êags
|=(P)

	)

10022 
	#DbCÀ¨Pr›îty
(
D
,
I
,
P
Ë(D)->
aDb
[I].
pSchema
->
Êags
&=~(P)

	)

10034 
	#DB_SchemaLﬂded
 0x0001

	)

10035 
	#DB_Uƒe£tVõws
 0x0002

	)

10036 
	#DB_Em±y
 0x0004

	)

10042 
	#SQLITE_N_LIMIT
 (
SQLITE_LIMIT_TRIGGER_DEPTH
+1)

	)

10064 
	sLookaside
 {

10065 
u16
 
sz
;

10066 
u8
 
bE«bÀd
;

10067 
u8
 
bMÆlo˚d
;

10068 
nOut
;

10069 
mxOut
;

10070 
™Sèt
[3];

10071 
LookasideSlŸ
 *
pFªe
;

10072 *
pSèπ
;

10073 *
pEnd
;

10075 
	sLookasideSlŸ
 {

10076 
LookasideSlŸ
 *
pNext
;

10085 
	sFuncDefHash
 {

10086 
FuncDef
 *
a
[23];

10092 
	ssqlôe3
 {

10093 
sqlôe3_vfs
 *
pVfs
;

10094 
Vdbe
 *
pVdbe
;

10095 
CﬁlSeq
 *
pDÊtCﬁl
;

10096 
sqlôe3_muãx
 *
muãx
;

10097 
Db
 *
aDb
;

10098 
nDb
;

10099 
Êags
;

10100 
i64
 
œ°Rowid
;

10101 
i64
 
szMm≠
;

10102 
›íFœgs
;

10103 
îrCode
;

10104 
îrMask
;

10105 
u16
 
dbO±Fœgs
;

10106 
u8
 
autoCommô
;

10107 
u8
 
ãmp_°‹e
;

10108 
u8
 
mÆlocFaûed
;

10109 
u8
 
dÊtLockMode
;

10110 sig√d 
√xtAutovac
;

10111 
u8
 
suµªssEº
;

10112 
u8
 
vèbOnC⁄Êi˘
;

10113 
u8
 
isTønß˘i⁄Savïoöt
;

10114 
√xtPagesize
;

10115 
u32
 
magic
;

10116 
nCh™ge
;

10117 
nTŸÆCh™ge
;

10118 
aLimô
[
SQLITE_N_LIMIT
];

10119 
	ssqlôe3InôInfo
 {

10120 
√wTnum
;

10121 
u8
 
iDb
;

10122 
u8
 
busy
;

10123 
u8
 
‹ph™Triggî
;

10124 } 
öô
;

10125 
nVdbeA˘ive
;

10126 
nVdbeRód
;

10127 
nVdbeWrôe
;

10128 
nVdbeExec
;

10129 
nExãnsi⁄
;

10130 **
aExãnsi⁄
;

10131 (*
xTø˚
)(*,const *);

10132 *
pTø˚Arg
;

10133 (*
xProfûe
)(*,c⁄° *,
u64
);

10134 *
pProfûeArg
;

10135 *
pCommôArg
;

10136 (*
xCommôCÆlback
)(*);

10137 *
pRﬁlbackArg
;

10138 (*
xRﬁlbackCÆlback
)(*);

10139 *
pUpd©eArg
;

10140 (*
xUpd©eCÆlback
)(*,, c⁄° *,c⁄° *,
sqlôe_öt64
);

10141 #i‚de‡
SQLITE_OMIT_WAL


10142 (*
xWÆCÆlback
)(*, 
sqlôe3
 *, const *, );

10143 *
pWÆArg
;

10145 (*
xCﬁlNìded
)(*,
sqlôe3
*,
eTextRï
,const *);

10146 (*
xCﬁlNìded16
)(*,
sqlôe3
*,
eTextRï
,const *);

10147 *
pCﬁlNìdedArg
;

10148 
sqlôe3_vÆue
 *
pEº
;

10150 vﬁ©ûê
isI¡îru±ed
;

10151 
nŸU£d1
;

10152 } 
u1
;

10153 
Lookaside
 
lookaside
;

10154 #i‚de‡
SQLITE_OMIT_AUTHORIZATION


10155 (*
xAuth
)(*,,const *,const *,const *,const *);

10157 *
pAuthArg
;

10159 #i‚de‡
SQLITE_OMIT_PROGRESS_CALLBACK


10160 (*
xProgªss
)(*);

10161 *
pProgªssArg
;

10162 
nProgªssOps
;

10164 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


10165 
nVTøns
;

10166 
Hash
 
aModuÀ
;

10167 
VèbCtx
 *
pVèbCtx
;

10168 
VTabÀ
 **
aVTøns
;

10169 
VTabÀ
 *
pDisc⁄√˘
;

10171 
FuncDefHash
 
aFunc
;

10172 
Hash
 
aCﬁlSeq
;

10173 
BusyH™dÀr
 
busyH™dÀr
;

10174 
Db
 
aDbSètic
[2];

10175 
Savïoöt
 *
pSavïoöt
;

10176 
busyTimeout
;

10177 
nSavïoöt
;

10178 
nSèãmít
;

10179 
i64
 
nDe„ºedC⁄s
;

10180 
i64
 
nDe„ºedImmC⁄s
;

10181 *
≤ByãsFªed
;

10183 #ifde‡
SQLITE_ENABLE_UNLOCK_NOTIFY


10194 
sqlôe3
 *
pBlockögC⁄√˘i⁄
;

10195 
sqlôe3
 *
pU∆ockC⁄√˘i⁄
;

10196 *
pU∆ockArg
;

10197 (*
xU∆ockNŸify
)(**, );

10198 
sqlôe3
 *
pNextBlocked
;

10205 
	#ENC
(
db
Ë((db)->
aDb
[0].
pSchema
->
íc
)

	)

10210 
	#SQLITE_VdbeTø˚
 0x00000001

	)

10211 
	#SQLITE_I¡înCh™ges
 0x00000002

	)

10212 
	#SQLITE_FuŒFSync
 0x00000004

	)

10213 
	#SQLITE_Ck±FuŒFSync
 0x00000008

	)

10214 
	#SQLITE_CacheSpûl
 0x00000010

	)

10215 
	#SQLITE_FuŒCﬁNames
 0x00000020

	)

10216 
	#SQLITE_Sh‹tCﬁNames
 0x00000040

	)

10217 
	#SQLITE_Cou¡Rows
 0x00000080

	)

10220 
	#SQLITE_NuŒCÆlback
 0x00000100

	)

10222 
	#SQLITE_SqlTø˚
 0x00000200

	)

10223 
	#SQLITE_VdbeLi°ög
 0x00000400

	)

10224 
	#SQLITE_WrôeSchema
 0x00000800

	)

10225 
	#SQLITE_VdbeAdd›Tø˚
 0x00001000

	)

10226 
	#SQLITE_Ign‹eChecks
 0x00002000

	)

10227 
	#SQLITE_RódUncommôãd
 0x0004000

	)

10228 
	#SQLITE_LegacyFûeFmt
 0x00008000

	)

10229 
	#SQLITE_RecovîyMode
 0x00010000

	)

10230 
	#SQLITE_Revî£Ordî
 0x00020000

	)

10231 
	#SQLITE_RecTriggîs
 0x00040000

	)

10232 
	#SQLITE_F‹eignKeys
 0x00080000

	)

10233 
	#SQLITE_AutoIndex
 0x00100000

	)

10234 
	#SQLITE_Pª„rBuûtö
 0x00200000

	)

10235 
	#SQLITE_LﬂdExãnsi⁄
 0x00400000

	)

10236 
	#SQLITE_E«bÀTriggî
 0x00800000

	)

10237 
	#SQLITE_De„rFKs
 0x01000000

	)

10238 
	#SQLITE_QuîyO∆y
 0x02000000

	)

10246 
	#SQLITE_QuîyFœâíî
 0x0001

	)

10247 
	#SQLITE_CﬁumnCache
 0x0002

	)

10248 
	#SQLITE_GroupByOrdî
 0x0004

	)

10249 
	#SQLITE_Fa˘‹OutC⁄°
 0x0008

	)

10250 
	#SQLITE_IdxRólAsI¡
 0x0010

	)

10251 
	#SQLITE_Di°ö˘O±
 0x0020

	)

10252 
	#SQLITE_CovîIdxSˇn
 0x0040

	)

10253 
	#SQLITE_OrdîByIdxJoö
 0x0080

	)

10254 
	#SQLITE_SubqC‹outöe
 0x0100

	)

10255 
	#SQLITE_Tønsôive
 0x0200

	)

10256 
	#SQLITE_OmôNo›Joö
 0x0400

	)

10257 
	#SQLITE_Sèt3
 0x0800

	)

10258 
	#SQLITE_Adju°OutE°
 0x1000

	)

10259 
	#SQLITE_AŒO±s
 0xfff‡

	)

10264 #i‚de‡
SQLITE_OMIT_BUILTIN_TEST


10265 
	#O±imiz©i⁄DißbÀd
(
db
, 
mask
Ë(((db)->
dbO±Fœgs
&(mask))!=0)

	)

10266 
	#O±imiz©i⁄E«bÀd
(
db
, 
mask
Ë(((db)->
dbO±Fœgs
&(mask))==0)

	)

10268 
	#O±imiz©i⁄DißbÀd
(
db
, 
mask
Ë0

	)

10269 
	#O±imiz©i⁄E«bÀd
(
db
, 
mask
Ë1

	)

10277 
	#SQLITE_MAGIC_OPEN
 0xa029a697

	)

10278 
	#SQLITE_MAGIC_CLOSED
 0x9f3c2d33

	)

10279 
	#SQLITE_MAGIC_SICK
 0x4b771290

	)

10280 
	#SQLITE_MAGIC_BUSY
 0xf03b7906

	)

10281 
	#SQLITE_MAGIC_ERROR
 0xb5357930

	)

10282 
	#SQLITE_MAGIC_ZOMBIE
 0x64cffc7‡

	)

10290 
	sFuncDef
 {

10291 
i16
 
nArg
;

10292 
u16
 
funcFœgs
;

10293 *
pU£rD©a
;

10294 
FuncDef
 *
pNext
;

10295 (*
xFunc
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
**);

10296 (*
xSãp
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
**);

10297 (*
xFöÆize
)(
sqlôe3_c⁄ãxt
*);

10298 *
zName
;

10299 
FuncDef
 *
pHash
;

10300 
FuncDe°ru˘‹
 *
pDe°ru˘‹
;

10317 
	sFuncDe°ru˘‹
 {

10318 
nRef
;

10319 (*
xDe°roy
)(*);

10320 *
pU£rD©a
;

10328 
	#SQLITE_FUNC_ENCMASK
 0x003

	)

10329 
	#SQLITE_FUNC_LIKE
 0x004

	)

10330 
	#SQLITE_FUNC_CASE
 0x008

	)

10331 
	#SQLITE_FUNC_EPHEM
 0x010

	)

10332 
	#SQLITE_FUNC_NEEDCOLL
 0x020

	)

10333 
	#SQLITE_FUNC_LENGTH
 0x040

	)

10334 
	#SQLITE_FUNC_TYPEOF
 0x080

	)

10335 
	#SQLITE_FUNC_COUNT
 0x100

	)

10336 
	#SQLITE_FUNC_COALESCE
 0x200

	)

10337 
	#SQLITE_FUNC_UNLIKELY
 0x400

	)

10364 
	#FUNCTION
(
zName
, 
nArg
, 
iArg
, 
bNC
, 
xFunc
) \

10365 {
nArg
, 
SQLITE_UTF8
|(
bNC
*
SQLITE_FUNC_NEEDCOLL
), \

10366 
	`SQLITE_INT_TO_PTR
(
iArg
), 0, 
xFunc
, 0, 0, #zName, 0, 0
	}

	)
}

10367 
	#FUNCTION2
(
zName
, 
nArg
, 
iArg
, 
bNC
, 
xFunc
, 
exåaFœgs
) \

10368 {
nArg
, 
SQLITE_UTF8
|(
bNC
*
SQLITE_FUNC_NEEDCOLL
)|
exåaFœgs
, \

10369 
	`SQLITE_INT_TO_PTR
(
iArg
), 0, 
xFunc
, 0, 0, #zName, 0, 0}

	)

10370 
	#STR_FUNCTION
(
zName
, 
nArg
, 
pArg
, 
bNC
, 
xFunc
) \

10371 {
nArg
, 
SQLITE_UTF8
|(
bNC
*
SQLITE_FUNC_NEEDCOLL
), \

10372 
pArg
, 0, 
xFunc
, 0, 0, #zName, 0, 0}

	)

10373 
	#LIKEFUNC
(
zName
, 
nArg
, 
¨g
, 
Êags
) \

10374 {
nArg
, 
SQLITE_UTF8
|
Êags
, (*)
¨g
, 0, 
likeFunc
, 0, 0, #zName, 0, 0}

	)

10375 
	#AGGREGATE
(
zName
, 
nArg
, 
¨g
, 
nc
, 
xSãp
, 
xFöÆ
) \

10376 {
nArg
, 
SQLITE_UTF8
|(
nc
*
SQLITE_FUNC_NEEDCOLL
), \

10377 
	`SQLITE_INT_TO_PTR
(
¨g
), 0, 0, 
xSãp
,
xFöÆ
,#zName,0,0}

	)

10385 
	sSavïoöt
 {

10386 *
	mzName
;

10387 
i64
 
	mnDe„ºedC⁄s
;

10388 
i64
 
	mnDe„ºedImmC⁄s
;

10389 
Savïoöt
 *
	mpNext
;

10396 
	#SAVEPOINT_BEGIN
 0

	)

10397 
	#SAVEPOINT_RELEASE
 1

	)

10398 
	#SAVEPOINT_ROLLBACK
 2

	)

10406 
	sModuÀ
 {

10407 c⁄° 
sqlôe3_moduÀ
 *
	mpModuÀ
;

10408 c⁄° *
	mzName
;

10409 *
	mpAux
;

10410 (*
	mxDe°roy
)(*);

10417 
	sCﬁumn
 {

10418 *
	mzName
;

10419 
Ex¥
 *
	mpDÊt
;

10420 *
	mzDÊt
;

10421 *
	mzTy≥
;

10422 *
	mzCﬁl
;

10423 
u8
 
	mnŸNuŒ
;

10424 
	mafföôy
;

10425 
u8
 
	mszE°
;

10426 
u8
 
	mcﬁFœgs
;

10431 
	#COLFLAG_PRIMKEY
 0x0001

	)

10432 
	#COLFLAG_HIDDEN
 0x0002

	)

10443 
	sCﬁlSeq
 {

10444 *
	mzName
;

10445 
u8
 
	míc
;

10446 *
	mpU£r
;

10447 (*
	mxCmp
)(*,, const *, , const *);

10448 (*
	mxDñ
)(*);

10454 
	#SQLITE_SO_ASC
 0

	)

10455 
	#SQLITE_SO_DESC
 1

	)

10471 
	#SQLITE_AFF_TEXT
 'a'

	)

10472 
	#SQLITE_AFF_NONE
 'b'

	)

10473 
	#SQLITE_AFF_NUMERIC
 'c'

	)

10474 
	#SQLITE_AFF_INTEGER
 'd'

	)

10475 
	#SQLITE_AFF_REAL
 'e'

	)

10477 
	#sqlôe3IsNumîicAfföôy
(
X
Ë((X)>=
SQLITE_AFF_NUMERIC
)

	)

10483 
	#SQLITE_AFF_MASK
 0x67

	)

10489 
	#SQLITE_JUMPIFNULL
 0x08

	)

10490 
	#SQLITE_STOREP2
 0x10

	)

10491 
	#SQLITE_NULLEQ
 0x80

	)

10535 
	sVTabÀ
 {

10536 
sqlôe3
 *
	mdb
;

10537 
ModuÀ
 *
	mpMod
;

10538 
sqlôe3_vèb
 *
	mpVèb
;

10539 
	mnRef
;

10540 
u8
 
	mbC⁄°øöt
;

10541 
	miSavïoöt
;

10542 
VTabÀ
 *
	mpNext
;

10575 
	sTabÀ
 {

10576 *
	mzName
;

10577 
Cﬁumn
 *
	maCﬁ
;

10578 
Index
 *
	mpIndex
;

10579 
Sñe˘
 *
	mpSñe˘
;

10580 
FKey
 *
	mpFKey
;

10581 *
	mzCﬁAff
;

10582 #i‚de‡
SQLITE_OMIT_CHECK


10583 
Ex¥Li°
 *
	mpCheck
;

10585 
tRow˙t
 
	mnRowE°
;

10586 
	mäum
;

10587 
i16
 
	miPKey
;

10588 
i16
 
	mnCﬁ
;

10589 
u16
 
	mnRef
;

10590 
LogE°
 
	mszTabRow
;

10591 
u8
 
	mèbFœgs
;

10592 
u8
 
	mkeyC⁄f
;

10593 #i‚de‡
SQLITE_OMIT_ALTERTABLE


10594 
	maddCﬁOff£t
;

10596 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


10597 
	mnModuÀArg
;

10598 **
	mazModuÀArg
;

10599 
VTabÀ
 *
	mpVTabÀ
;

10601 
Triggî
 *
	mpTriggî
;

10602 
Schema
 *
	mpSchema
;

10603 
TabÀ
 *
	mpNextZombõ
;

10609 
	#TF_Ród⁄ly
 0x01

	)

10610 
	#TF_EphemîÆ
 0x02

	)

10611 
	#TF_HasPrim¨yKey
 0x04

	)

10612 
	#TF_Autoö¸emít
 0x08

	)

10613 
	#TF_VútuÆ
 0x10

	)

10621 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


10622 
	#IsVútuÆ
(
X
Ë(((X)->
èbFœgs
 & 
TF_VútuÆ
)!=0)

	)

10623 
	#IsHiddíCﬁumn
(
X
Ë(((X)->
cﬁFœgs
 & 
COLFLAG_HIDDEN
)!=0)

	)

10625 
	#IsVútuÆ
(
X
Ë0

	)

10626 
	#IsHiddíCﬁumn
(
X
Ë0

	)

10648 
	sFKey
 {

10649 
TabÀ
 *
	mpFrom
;

10650 
FKey
 *
	mpNextFrom
;

10651 *
	mzTo
;

10652 
FKey
 *
	mpNextTo
;

10653 
FKey
 *
	mpPªvTo
;

10654 
	mnCﬁ
;

10656 
u8
 
	misDe„ºed
;

10657 
u8
 
	maA˘i⁄
[2];

10658 
Triggî
 *
	m≠Triggî
[2];

10659 
	ssCﬁM≠
 {

10660 
	miFrom
;

10661 *
	mzCﬁ
;

10662 } 
	maCﬁ
[1];

10690 
	#OE_N⁄e
 0

	)

10691 
	#OE_Rﬁlback
 1

	)

10692 
	#OE_Ab‹t
 2

	)

10693 
	#OE_Faû
 3

	)

10694 
	#OE_Ign‹e
 4

	)

10695 
	#OE_Rïœ˚
 5

	)

10697 
	#OE_Re°ri˘
 6

	)

10698 
	#OE_SëNuŒ
 7

	)

10699 
	#OE_SëDÊt
 8

	)

10700 
	#OE_Casˇde
 9

	)

10702 
	#OE_DeÁu…
 10

	)

10714 
	sKeyInfo
 {

10715 
sqlôe3
 *
	mdb
;

10716 
u8
 
	míc
;

10717 
u16
 
	mnFõld
;

10718 
u8
 *
	maS‹tOrdî
;

10719 
CﬁlSeq
 *
	maCﬁl
[1];

10736 
	sU≈ackedRec‹d
 {

10737 
KeyInfo
 *
	mpKeyInfo
;

10738 
u16
 
	mnFõld
;

10739 
u8
 
	mÊags
;

10740 
i64
 
	mrowid
;

10741 
Mem
 *
	maMem
;

10747 
	#UNPACKED_INCRKEY
 0x01

	)

10748 
	#UNPACKED_PREFIX_MATCH
 0x02

	)

10749 
	#UNPACKED_PREFIX_SEARCH
 0x04

	)

10777 
	sIndex
 {

10778 *
	mzName
;

10779 *
	maiCﬁumn
;

10780 
tRow˙t
 *
	maiRowE°
;

10781 
TabÀ
 *
	mpTabÀ
;

10782 *
	mzCﬁAff
;

10783 
Index
 *
	mpNext
;

10784 
Schema
 *
	mpSchema
;

10785 
u8
 *
	maS‹tOrdî
;

10786 **
	mazCﬁl
;

10787 
Ex¥
 *
	mpP¨tIdxWhîe
;

10788 
	mäum
;

10789 
LogE°
 
	mszIdxRow
;

10790 
u16
 
	mnCﬁumn
;

10791 
u8
 
	m⁄Eº‹
;

10792 
	mautoIndex
:2;

10793 
	mbUn‹dîed
:1;

10794 
	muniqNŸNuŒ
:1;

10795 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


10796 
	mnSam∂e
;

10797 
	mnSam∂eCﬁ
;

10798 
tRow˙t
 *
	maAvgEq
;

10799 
IndexSam∂e
 *
	maSam∂e
;

10808 
	sIndexSam∂e
 {

10809 *
	mp
;

10810 
	mn
;

10811 
tRow˙t
 *
	m™Eq
;

10812 
tRow˙t
 *
	m™Lt
;

10813 
tRow˙t
 *
	m™DLt
;

10824 
	sTokí
 {

10825 c⁄° *
	mz
;

10826 
	mn
;

10842 
	sAggInfo
 {

10843 
u8
 
	mdúe˘Mode
;

10845 
u8
 
	mu£S‹tögIdx
;

10847 
	ms‹tögIdx
;

10848 
	ms‹tögIdxPTab
;

10849 
	mnS‹tögCﬁumn
;

10850 
Ex¥Li°
 *
	mpGroupBy
;

10851 
	sAggInfo_cﬁ
 {

10852 
TabÀ
 *
	mpTab
;

10853 
	miTabÀ
;

10854 
	miCﬁumn
;

10855 
	miS‹ãrCﬁumn
;

10856 
	miMem
;

10857 
Ex¥
 *
	mpEx¥
;

10858 } *
	maCﬁ
;

10859 
	mnCﬁumn
;

10860 
	mnAccumuœt‹
;

10863 
	sAggInfo_func
 {

10864 
Ex¥
 *
	mpEx¥
;

10865 
FuncDef
 *
	mpFunc
;

10866 
	miMem
;

10867 
	miDi°ö˘
;

10868 } *
	maFunc
;

10869 
	mnFunc
;

10882 #i‡
SQLITE_MAX_VARIABLE_NUMBER
<=32767

10883 
i16
 
	tynV¨
;

10885 
	tynV¨
;

10951 
	sEx¥
 {

10952 
u8
 
	m›
;

10953 
	mafföôy
;

10954 
u32
 
	mÊags
;

10956 *
	mzTokí
;

10957 
	miVÆue
;

10958 } 
	mu
;

10965 
Ex¥
 *
	mpLe·
;

10966 
Ex¥
 *
	mpRight
;

10968 
Ex¥Li°
 *
	mpLi°
;

10969 
Sñe˘
 *
	mpSñe˘
;

10970 } 
	mx
;

10977 #i‡
SQLITE_MAX_EXPR_DEPTH
>0

10978 
	mnHeight
;

10980 
	miTabÀ
;

10984 
ynV¨
 
	miCﬁumn
;

10986 
i16
 
	miAgg
;

10987 
i16
 
	miRightJoöTabÀ
;

10988 
u8
 
	m›2
;

10991 
AggInfo
 *
	mpAggInfo
;

10992 
TabÀ
 *
	mpTab
;

10998 
	#EP_FromJoö
 0x000001

	)

10999 
	#EP_Agg
 0x000002

	)

11000 
	#EP_Resﬁved
 0x000004

	)

11001 
	#EP_Eº‹
 0x000008

	)

11002 
	#EP_Di°ö˘
 0x000010

	)

11003 
	#EP_V¨Sñe˘
 0x000020

	)

11004 
	#EP_DblQuŸed
 0x000040

	)

11005 
	#EP_InfixFunc
 0x000080

	)

11006 
	#EP_Cﬁœã
 0x000100

	)

11007 
	#EP_FixedDe°
 0x000200

	)

11008 
	#EP_I¡VÆue
 0x000400

	)

11009 
	#EP_xIsSñe˘
 0x000800

	)

11010 
	#EP_Skù
 0x001000

	)

11011 
	#EP_Redu˚d
 0x002000

	)

11012 
	#EP_TokíO∆y
 0x004000

	)

11013 
	#EP_Sètic
 0x008000

	)

11014 
	#EP_MemTokí
 0x010000

	)

11015 
	#EP_NoRedu˚
 0x020000

	)

11016 
	#EP_U∆ikñy
 0x040000

	)

11022 
	#Ex¥HasPr›îty
(
E
,
P
Ë(((E)->
Êags
&(P))!=0)

	)

11023 
	#Ex¥HasAŒPr›îty
(
E
,
P
Ë(((E)->
Êags
&(P))==(P))

	)

11024 
	#Ex¥SëPr›îty
(
E
,
P
Ë(E)->
Êags
|=(P)

	)

11025 
	#Ex¥CÀ¨Pr›îty
(
E
,
P
Ë(E)->
Êags
&=~(P)

	)

11031 #ifde‡
SQLITE_DEBUG


11032 
	#Ex¥SëVVAPr›îty
(
E
,
P
Ë(E)->
Êags
|=(P)

	)

11034 
	#Ex¥SëVVAPr›îty
(
E
,
P
)

	)

11042 
	#EXPR_FULLSIZE
 (
Ex¥
Ë

	)

11043 
	#EXPR_REDUCEDSIZE
 
	`off£tof
(
Ex¥
,
iTabÀ
Ë

	)

11044 
	#EXPR_TOKENONLYSIZE
 
	`off£tof
(
Ex¥
,
pLe·
Ë

	)

11050 
	#EXPRDUP_REDUCE
 0x0001

	)

11068 
	sEx¥Li°
 {

11069 
	mnEx¥
;

11070 
	miECurs‹
;

11071 
	sEx¥Li°_ôem
 {

11072 
Ex¥
 *
	mpEx¥
;

11073 *
	mzName
;

11074 *
	mzS∑n
;

11075 
u8
 
	ms‹tOrdî
;

11076 
	md⁄e
 :1;

11077 
	mbS∑nIsTab
 :1;

11078 
u16
 
	miOrdîByCﬁ
;

11079 
u16
 
	miAlüs
;

11080 } *
	ma
;

11088 
	sEx¥S∑n
 {

11089 
Ex¥
 *
	mpEx¥
;

11090 c⁄° *
	mzSèπ
;

11091 c⁄° *
	mzEnd
;

11109 
	sIdLi°
 {

11110 
	sIdLi°_ôem
 {

11111 *
	mzName
;

11112 
	midx
;

11113 } *
	ma
;

11114 
	mnId
;

11124 
u64
 
	tBômask
;

11129 
	#BMS
 (()((
Bômask
)*8))

	)

11134 
	#MASKBIT
(
n
Ë(((
Bômask
)1)<<“))

	)

11155 
	sSrcLi°
 {

11156 
u8
 
	mnSrc
;

11157 
u8
 
	mnAŒoc
;

11158 
	sSrcLi°_ôem
 {

11159 
Schema
 *
	mpSchema
;

11160 *
	mzD©aba£
;

11161 *
	mzName
;

11162 *
	mzAlüs
;

11163 
TabÀ
 *
	mpTab
;

11164 
Sñe˘
 *
	mpSñe˘
;

11165 
	maddrFûlSub
;

11166 
	mªgRëu∫
;

11167 
u8
 
	mjoöty≥
;

11168 
	mnŸIndexed
 :1;

11169 
	misC‹ªœãd
 :1;

11170 
	mvüC‹outöe
 :1;

11171 #i‚de‡
SQLITE_OMIT_EXPLAIN


11172 
u8
 
	miSñe˘Id
;

11174 
	miCurs‹
;

11175 
Ex¥
 *
	mpOn
;

11176 
IdLi°
 *
	mpUsög
;

11177 
Bômask
 
	mcﬁU£d
;

11178 *
	mzIndex
;

11179 
Index
 *
	mpIndex
;

11180 } 
	ma
[1];

11186 
	#JT_INNER
 0x0001

	)

11187 
	#JT_CROSS
 0x0002

	)

11188 
	#JT_NATURAL
 0x0004

	)

11189 
	#JT_LEFT
 0x0008

	)

11190 
	#JT_RIGHT
 0x0010

	)

11191 
	#JT_OUTER
 0x0020

	)

11192 
	#JT_ERROR
 0x0040

	)

11199 
	#WHERE_ORDERBY_NORMAL
 0x0000

	)

11200 
	#WHERE_ORDERBY_MIN
 0x0001

	)

11201 
	#WHERE_ORDERBY_MAX
 0x0002

	)

11202 
	#WHERE_ONEPASS_DESIRED
 0x0004

	)

11203 
	#WHERE_DUPLICATES_OK
 0x0008

	)

11204 
	#WHERE_OMIT_OPEN_CLOSE
 0x0010

	)

11205 
	#WHERE_FORCE_TABLE
 0x0020

	)

11206 
	#WHERE_ONETABLE_ONLY
 0x0040

	)

11207 
	#WHERE_AND_ONLY
 0x0080

	)

11208 
	#WHERE_GROUPBY
 0x0100

	)

11209 
	#WHERE_DISTINCTBY
 0x0200

	)

11210 
	#WHERE_WANT_DISTINCT
 0x0400

	)

11214 
	#WHERE_DISTINCT_NOOP
 0

	)

11215 
	#WHERE_DISTINCT_UNIQUE
 1

	)

11216 
	#WHERE_DISTINCT_ORDERED
 2

	)

11217 
	#WHERE_DISTINCT_UNORDERED
 3

	)

11240 
	sNameC⁄ãxt
 {

11241 
P¨£
 *
	mpP¨£
;

11242 
SrcLi°
 *
	mpSrcLi°
;

11243 
Ex¥Li°
 *
	mpELi°
;

11244 
AggInfo
 *
	mpAggInfo
;

11245 
NameC⁄ãxt
 *
	mpNext
;

11246 
	mnRef
;

11247 
	mnEº
;

11248 
u8
 
	mncFœgs
;

11254 
	#NC_AŒowAgg
 0x01

	)

11255 
	#NC_HasAgg
 0x02

	)

11256 
	#NC_IsCheck
 0x04

	)

11257 
	#NC_InAggFunc
 0x08

	)

11258 
	#NC_P¨tIdx
 0x10

	)

11280 
	sSñe˘
 {

11281 
Ex¥Li°
 *
	mpELi°
;

11282 
u8
 
	m›
;

11283 
u16
 
	m£lFœgs
;

11284 
	miLimô
, 
	miOff£t
;

11285 
	maddrO≥nEphm
[3];

11286 
u64
 
	mnSñe˘Row
;

11287 
SrcLi°
 *
	mpSrc
;

11288 
Ex¥
 *
	mpWhîe
;

11289 
Ex¥Li°
 *
	mpGroupBy
;

11290 
Ex¥
 *
	mpHavög
;

11291 
Ex¥Li°
 *
	mpOrdîBy
;

11292 
Sñe˘
 *
	mpPri‹
;

11293 
Sñe˘
 *
	mpNext
;

11294 
Sñe˘
 *
	mpRightmo°
;

11295 
Ex¥
 *
	mpLimô
;

11296 
Ex¥
 *
	mpOff£t
;

11303 
	#SF_Di°ö˘
 0x0001

	)

11304 
	#SF_Resﬁved
 0x0002

	)

11305 
	#SF_Aggªg©e
 0x0004

	)

11306 
	#SF_U£sEphemîÆ
 0x0008

	)

11307 
	#SF_Ex∑nded
 0x0010

	)

11308 
	#SF_HasTy≥Info
 0x0020

	)

11309 
	#SF_U£S‹ãr
 0x0040

	)

11310 
	#SF_VÆues
 0x0080

	)

11311 
	#SF_M©îülize
 0x0100

	)

11312 
	#SF_Ne°edFrom
 0x0200

	)

11313 
	#SF_MaybeC⁄vît
 0x0400

	)

11320 
	#SRT_Uni⁄
 1

	)

11321 
	#SRT_Ex˚±
 2

	)

11322 
	#SRT_Exi°s
 3

	)

11323 
	#SRT_Disˇrd
 4

	)

11326 
	#Ign‹abÀOrdîby
(
X
Ë((X->
eDe°
)<=
SRT_Disˇrd
)

	)

11328 
	#SRT_Ouçut
 5

	)

11329 
	#SRT_Mem
 6

	)

11330 
	#SRT_Së
 7

	)

11331 
	#SRT_TabÀ
 8

	)

11332 
	#SRT_EphemTab
 9

	)

11333 
	#SRT_C‹outöe
 10

	)

11339 
	sSñe˘De°
 {

11340 
u8
 
	meDe°
;

11341 
	maffSd°
;

11342 
	miSDP¨m
;

11343 
	miSd°
;

11344 
	mnSd°
;

11356 
	sAutoöcInfo
 {

11357 
AutoöcInfo
 *
	mpNext
;

11358 
TabÀ
 *
	mpTab
;

11359 
	miDb
;

11360 
	mªgCå
;

11366 #i‚de‡
SQLITE_N_COLCACHE


11367 
	#SQLITE_N_COLCACHE
 10

	)

11388 
	sTriggîPrg
 {

11389 
Triggî
 *
	mpTriggî
;

11390 
TriggîPrg
 *
	mpNext
;

11391 
SubProgøm
 *
	mpProgøm
;

11392 
	m‹c⁄f
;

11393 
u32
 
	maCﬁmask
[2];

11399 #i‡
SQLITE_MAX_ATTACHED
>30

11400 
sqlôe3_uöt64
 
	tyDbMask
;

11402 
	tyDbMask
;

11421 
	sP¨£
 {

11422 
sqlôe3
 *
	mdb
;

11423 *
	mzEºMsg
;

11424 
Vdbe
 *
	mpVdbe
;

11425 
	mrc
;

11426 
u8
 
	mcﬁNamesSë
;

11427 
u8
 
	mcheckSchema
;

11428 
u8
 
	m√°ed
;

11429 
u8
 
	mnTempReg
;

11430 
u8
 
	mnTempInU£
;

11431 
u8
 
	mnCﬁCache
;

11432 
u8
 
	miCﬁCache
;

11433 
u8
 
	misMu…iWrôe
;

11434 
u8
 
	mmayAb‹t
;

11435 
u8
 
	mhasCompound
;

11436 
	maTempReg
[8];

11437 
	mnR™geReg
;

11438 
	miR™geReg
;

11439 
	mnEº
;

11440 
	mnTab
;

11441 
	mnMem
;

11442 
	mnSë
;

11443 
	mnOn˚
;

11444 
	mckBa£
;

11445 
	miP¨tIdxTab
;

11446 
	miCacheLevñ
;

11447 
	miCacheC¡
;

11448 
	syCﬁCache
 {

11449 
	miTabÀ
;

11450 
	miCﬁumn
;

11451 
u8
 
	mãmpReg
;

11452 
	miLevñ
;

11453 
	miReg
;

11454 
	mÃu
;

11455 } 
	maCﬁCache
[
SQLITE_N_COLCACHE
];

11456 
yDbMask
 
	mwrôeMask
;

11457 
yDbMask
 
	mcookõMask
;

11458 
	mcookõGŸo
;

11459 
	mcookõVÆue
[
SQLITE_MAX_ATTACHED
+2];

11460 
	mªgRowid
;

11461 
	mªgRoŸ
;

11462 
	mnMaxArg
;

11463 
Tokí
 
	mc⁄°øötName
;

11464 #i‚de‡
SQLITE_OMIT_SHARED_CACHE


11465 
	mnTabÀLock
;

11466 
TabÀLock
 *
	maTabÀLock
;

11468 
AutoöcInfo
 *
	mpAöc
;

11471 
P¨£
 *
	mpT›Àvñ
;

11472 
TabÀ
 *
	mpTriggîTab
;

11473 
u32
 
	mnQuîyLo›
;

11474 
u32
 
	mﬁdmask
;

11475 
u32
 
	m√wmask
;

11476 
u8
 
	meTriggîOp
;

11477 
u8
 
	meOrc⁄f
;

11478 
u8
 
	mdißbÀTriggîs
;

11483 
	mnV¨
;

11484 
	mnzV¨
;

11485 
u8
 
	mex∂aö
;

11486 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


11487 
u8
 
	mde˛¨eVèb
;

11488 
	mnVèbLock
;

11490 
	mnAlüs
;

11491 
	mnHeight
;

11492 #i‚de‡
SQLITE_OMIT_EXPLAIN


11493 
	miSñe˘Id
;

11494 
	miNextSñe˘Id
;

11496 **
	mazV¨
;

11497 
Vdbe
 *
	mpRïª∑ª
;

11498 *
	maAlüs
;

11499 c⁄° *
	mzTaû
;

11500 
TabÀ
 *
	mpNewTabÀ
;

11501 
Triggî
 *
	mpNewTriggî
;

11502 c⁄° *
	mzAuthC⁄ãxt
;

11503 
Tokí
 
	msNameTokí
;

11504 
Tokí
 
	msLa°Tokí
;

11505 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


11506 
Tokí
 
	msArg
;

11507 
TabÀ
 **
	m≠VèbLock
;

11509 
TabÀ
 *
	mpZombõTab
;

11510 
TriggîPrg
 *
	mpTriggîPrg
;

11516 #ifde‡
SQLITE_OMIT_VIRTUALTABLE


11517 
	#IN_DECLARE_VTAB
 0

	)

11519 
	#IN_DECLARE_VTAB
 (
pP¨£
->
de˛¨eVèb
)

	)

11526 
	sAuthC⁄ãxt
 {

11527 c⁄° *
	mzAuthC⁄ãxt
;

11528 
P¨£
 *
	mpP¨£
;

11534 
	#OPFLAG_NCHANGE
 0x01

	)

11535 
	#OPFLAG_LASTROWID
 0x02

	)

11536 
	#OPFLAG_ISUPDATE
 0x04

	)

11537 
	#OPFLAG_APPEND
 0x08

	)

11538 
	#OPFLAG_USESEEKRESULT
 0x10

	)

11539 
	#OPFLAG_CLEARCACHE
 0x20

	)

11540 
	#OPFLAG_LENGTHARG
 0x40

	)

11541 
	#OPFLAG_TYPEOFARG
 0x80

	)

11542 
	#OPFLAG_BULKCSR
 0x01

	)

11543 
	#OPFLAG_P2ISREG
 0x02

	)

11544 
	#OPFLAG_PERMUTE
 0x01

	)

11561 
	sTriggî
 {

11562 *
	mzName
;

11563 *
	mèbÀ
;

11564 
u8
 
	m›
;

11565 
u8
 
	må_tm
;

11566 
Ex¥
 *
	mpWhí
;

11567 
IdLi°
 *
	mpCﬁumns
;

11569 
Schema
 *
	mpSchema
;

11570 
Schema
 *
	mpTabSchema
;

11571 
TriggîSãp
 *
	m°ï_li°
;

11572 
Triggî
 *
	mpNext
;

11582 
	#TRIGGER_BEFORE
 1

	)

11583 
	#TRIGGER_AFTER
 2

	)

11623 
	sTriggîSãp
 {

11624 
u8
 
	m›
;

11625 
u8
 
	m‹c⁄f
;

11626 
Triggî
 *
	mpTrig
;

11627 
Sñe˘
 *
	mpSñe˘
;

11628 
Tokí
 
	mèrgë
;

11629 
Ex¥
 *
	mpWhîe
;

11630 
Ex¥Li°
 *
	mpEx¥Li°
;

11631 
IdLi°
 *
	mpIdLi°
;

11632 
TriggîSãp
 *
	mpNext
;

11633 
TriggîSãp
 *
	mpLa°
;

11641 
DbFixî
 
	tDbFixî
;

11642 
	sDbFixî
 {

11643 
P¨£
 *
	mpP¨£
;

11644 
Schema
 *
	mpSchema
;

11645 
	mbV¨O∆y
;

11646 c⁄° *
	mzDb
;

11647 c⁄° *
	mzTy≥
;

11648 c⁄° 
Tokí
 *
	mpName
;

11655 
	sSåAccum
 {

11656 
sqlôe3
 *
	mdb
;

11657 *
	mzBa£
;

11658 *
	mzText
;

11659 
	mnCh¨
;

11660 
	mnAŒoc
;

11661 
	mmxAŒoc
;

11662 
u8
 
	mu£MÆloc
;

11663 
u8
 
	maccEº‹
;

11665 
	#STRACCUM_NOMEM
 1

	)

11666 
	#STRACCUM_TOOBIG
 2

	)

11673 
sqlôe3
 *
	mdb
;

11674 **
	mpzEºMsg
;

11675 
	miDb
;

11676 
	mrc
;

11677 } 
	tInôD©a
;

11684 
	sSqlôe3C⁄fig
 {

11685 
	mbMem°©
;

11686 
	mbC‹eMuãx
;

11687 
	mbFuŒMuãx
;

11688 
	mbO≥nUri
;

11689 
	mbU£Cis
;

11690 
	mmxSåÀn
;

11691 
	mszLookaside
;

11692 
	mnLookaside
;

11693 
sqlôe3_mem_mëhods
 
	mm
;

11694 
sqlôe3_muãx_mëhods
 
	mmuãx
;

11695 
sqlôe3_pˇche_mëhods2
 
	mpˇche2
;

11696 *
	mpHóp
;

11697 
	mnHóp
;

11698 
	mmnReq
, 
	mmxReq
;

11699 
sqlôe3_öt64
 
	mszMm≠
;

11700 
sqlôe3_öt64
 
	mmxMm≠
;

11701 *
	mpS¸©ch
;

11702 
	mszS¸©ch
;

11703 
	mnS¸©ch
;

11704 *
	mpPage
;

11705 
	mszPage
;

11706 
	mnPage
;

11707 
	mmxP¨£rSèck
;

11708 
	msh¨edCacheE«bÀd
;

11711 
	misInô
;

11712 
	möProgªss
;

11713 
	misMuãxInô
;

11714 
	misMÆlocInô
;

11715 
	misPCacheInô
;

11716 
sqlôe3_muãx
 *
	mpInôMuãx
;

11717 
	mnRefInôMuãx
;

11718 (*
	mxLog
)(*,,const *);

11719 *
	mpLogArg
;

11720 
	mbLoˇ…imeFau…
;

11721 #ifde‡
SQLITE_ENABLE_SQLLOG


11722 (*
	mxSqŒog
)(*,
	msqlôe3
*,const *, );

11723 *
	mpSqŒogArg
;

11730 
	sWÆkî
 {

11731 (*
	mxEx¥CÆlback
)(
	mWÆkî
*, 
	mEx¥
*);

11732 (*
	mxSñe˘CÆlback
)(
	mWÆkî
*,
	mSñe˘
*);

11733 
P¨£
 *
	mpP¨£
;

11734 
	mwÆkîDïth
;

11735 
u8
 
	mbSñe˘DïthFú°
;

11737 
NameC⁄ãxt
 *
	mpNC
;

11738 
	mi
;

11739 
SrcLi°
 *
	mpSrcLi°
;

11740 
SrcCou¡
 *
	mpSrcCou¡
;

11741 } 
	mu
;

11745 
SQLITE_PRIVATE
 
sqlôe3WÆkEx¥
(
WÆkî
*, 
Ex¥
*);

11746 
SQLITE_PRIVATE
 
sqlôe3WÆkEx¥Li°
(
WÆkî
*, 
Ex¥Li°
*);

11747 
SQLITE_PRIVATE
 
sqlôe3WÆkSñe˘
(
WÆkî
*, 
Sñe˘
*);

11748 
SQLITE_PRIVATE
 
sqlôe3WÆkSñe˘Ex¥
(
WÆkî
*, 
Sñe˘
*);

11749 
SQLITE_PRIVATE
 
sqlôe3WÆkSñe˘From
(
WÆkî
*, 
Sñe˘
*);

11755 
	#WRC_C⁄töue
 0

	)

11756 
	#WRC_Pru√
 1

	)

11757 
	#WRC_Ab‹t
 2

	)

11763 
	#SQLITE_SKIP_UTF8
(
zIn
) { \

11764 if–(*(
zIn
++))>=0xc0 ){ \

11765  (*
zIn
 & 0xc0)==0x80 ){ zIn++; } \

11767 }

	)

11776 
SQLITE_PRIVATE
 
sqlôe3C‹ru±Eº‹
();

11777 
SQLITE_PRIVATE
 
sqlôe3Misu£Eº‹
();

11778 
SQLITE_PRIVATE
 
sqlôe3C™t›íEº‹
();

11779 
	#SQLITE_CORRUPT_BKPT
 
	`sqlôe3C‹ru±Eº‹
(
__LINE__
)

	)

11780 
	#SQLITE_MISUSE_BKPT
 
	`sqlôe3Misu£Eº‹
(
__LINE__
)

	)

11781 
	#SQLITE_CANTOPEN_BKPT
 
	`sqlôe3C™t›íEº‹
(
__LINE__
)

	)

11789 #i‡
deföed
(
SQLITE_ENABLE_FTS4
Ë&& !deföed(
SQLITE_ENABLE_FTS3
)

11790 
	#SQLITE_ENABLE_FTS3


	)

11797 #i‡!
deföed
(
SQLITE_ASCII
) || \

11798 (
deföed
(
SQLITE_ENABLE_FTS3
Ë&& 
	$deföed
(
SQLITE_AMALGAMATION
))

11799 
	~<˘y≥.h
>

11807 #ifde‡
SQLITE_ASCII


11808 
	#sqlôe3Touµî
(
x
Ë((x)&~(
sqlôe3Cty≥M≠
[()(x)]&0x20))

	)

11809 
	#sqlôe3Is•a˚
(
x
Ë(
sqlôe3Cty≥M≠
[()(x)]&0x01)

	)

11810 
	#sqlôe3Iß um
(
x
Ë(
sqlôe3Cty≥M≠
[()(x)]&0x06)

	)

11811 
	#sqlôe3IßÕha
(
x
Ë(
sqlôe3Cty≥M≠
[()(x)]&0x02)

	)

11812 
	#sqlôe3Isdigô
(
x
Ë(
sqlôe3Cty≥M≠
[()(x)]&0x04)

	)

11813 
	#sqlôe3Isxdigô
(
x
Ë(
sqlôe3Cty≥M≠
[()(x)]&0x08)

	)

11814 
	#sqlôe3Tﬁowî
(
x
Ë(
sqlôe3UµîToLowî
[()(x)])

	)

11816 
	#sqlôe3Touµî
(
x
Ë
	`touµî
(()(x))

	)

11817 
	#sqlôe3Is•a˚
(
x
Ë
	`is•a˚
(()(x))

	)

11818 
	#sqlôe3Iß um
(
x
Ë
	`iß um
(()(x))

	)

11819 
	#sqlôe3IßÕha
(
x
Ë
	`ißÕha
(()(x))

	)

11820 
	#sqlôe3Isdigô
(
x
Ë
	`isdigô
(()(x))

	)

11821 
	#sqlôe3Isxdigô
(
x
Ë
	`isxdigô
(()(x))

	)

11822 
	#sqlôe3Tﬁowî
(
x
Ë
	`tﬁowî
(()(x))

	)

11828 
	#sqlôe3SåICmp
 
sqlôe3_°ricmp


	)

11829 
SQLITE_PRIVATE
 
	`sqlôe3SåÀn30
(const *);

11830 
	#sqlôe3SåNICmp
 
sqlôe3_°∫icmp


	)

11832 
SQLITE_PRIVATE
 
	`sqlôe3MÆlocInô
();

11833 
SQLITE_PRIVATE
 
	`sqlôe3MÆlocEnd
();

11834 
SQLITE_PRIVATE
 *
	`sqlôe3MÆloc
();

11835 
SQLITE_PRIVATE
 *
	`sqlôe3MÆlocZîo
();

11836 
SQLITE_PRIVATE
 *
	`sqlôe3DbMÆlocZîo
(
sqlôe3
*, );

11837 
SQLITE_PRIVATE
 *
	`sqlôe3DbMÆlocRaw
(
sqlôe3
*, );

11838 
SQLITE_PRIVATE
 *
	`sqlôe3DbSåDup
(
sqlôe3
*,const *);

11839 
SQLITE_PRIVATE
 *
	`sqlôe3DbSåNDup
(
sqlôe3
*,const *, );

11840 
SQLITE_PRIVATE
 *
	`sqlôe3RóŒoc
(*, );

11841 
SQLITE_PRIVATE
 *
	`sqlôe3DbRóŒocOrFªe
(
sqlôe3
 *, *, );

11842 
SQLITE_PRIVATE
 *
	`sqlôe3DbRóŒoc
(
sqlôe3
 *, *, );

11843 
SQLITE_PRIVATE
 
	`sqlôe3DbFªe
(
sqlôe3
*, *);

11844 
SQLITE_PRIVATE
 
	`sqlôe3MÆlocSize
(*);

11845 
SQLITE_PRIVATE
 
	`sqlôe3DbMÆlocSize
(
sqlôe3
*, *);

11846 
SQLITE_PRIVATE
 *
	`sqlôe3S¸©chMÆloc
();

11847 
SQLITE_PRIVATE
 
	`sqlôe3S¸©chFªe
(*);

11848 
SQLITE_PRIVATE
 *
	`sqlôe3PageMÆloc
();

11849 
SQLITE_PRIVATE
 
	`sqlôe3PageFªe
(*);

11850 
SQLITE_PRIVATE
 
	`sqlôe3MemSëDeÁu…
();

11851 
SQLITE_PRIVATE
 
	`sqlôe3BíignMÆlocHooks
((*)(), (*)());

11852 
SQLITE_PRIVATE
 
	`sqlôe3HópNóæyFuŒ
();

11862 #ifde‡
SQLITE_USE_ALLOCA


11863 
	#sqlôe3SèckAŒocRaw
(
D
,
N
Ë
	`Æloˇ
(N)

	)

11864 
	#sqlôe3SèckAŒocZîo
(
D
,
N
Ë
	`mem£t
(
	`Æloˇ
(N), 0, N)

	)

11865 
	#sqlôe3SèckFªe
(
D
,
P
)

	)

11867 
	#sqlôe3SèckAŒocRaw
(
D
,
N
Ë
	`sqlôe3DbMÆlocRaw
(D,N)

	)

11868 
	#sqlôe3SèckAŒocZîo
(
D
,
N
Ë
	`sqlôe3DbMÆlocZîo
(D,N)

	)

11869 
	#sqlôe3SèckFªe
(
D
,
P
Ë
	`sqlôe3DbFªe
(D,P)

	)

11872 #ifde‡
SQLITE_ENABLE_MEMSYS3


11873 
SQLITE_PRIVATE
 c⁄° 
sqlôe3_mem_mëhods
 *
	`sqlôe3MemGëMemsys3
();

11875 #ifde‡
SQLITE_ENABLE_MEMSYS5


11876 
SQLITE_PRIVATE
 c⁄° 
sqlôe3_mem_mëhods
 *
	`sqlôe3MemGëMemsys5
();

11880 #i‚de‡
SQLITE_MUTEX_OMIT


11881 
SQLITE_PRIVATE
 
sqlôe3_muãx_mëhods
 c⁄° *
	`sqlôe3DeÁu…Muãx
();

11882 
SQLITE_PRIVATE
 
sqlôe3_muãx_mëhods
 c⁄° *
	`sqlôe3No›Muãx
();

11883 
SQLITE_PRIVATE
 
sqlôe3_muãx
 *
	`sqlôe3MuãxAŒoc
();

11884 
SQLITE_PRIVATE
 
	`sqlôe3MuãxInô
();

11885 
SQLITE_PRIVATE
 
	`sqlôe3MuãxEnd
();

11888 
SQLITE_PRIVATE
 
	`sqlôe3SètusVÆue
();

11889 
SQLITE_PRIVATE
 
	`sqlôe3SètusAdd
(, );

11890 
SQLITE_PRIVATE
 
	`sqlôe3SètusSë
(, );

11892 #i‚de‡
SQLITE_OMIT_FLOATING_POINT


11893 
SQLITE_PRIVATE
 
	`sqlôe3IsNaN
();

11895 
	#sqlôe3IsNaN
(
X
Ë0

	)

11898 
SQLITE_PRIVATE
 
	`sqlôe3VXPrötf
(
SåAccum
*, , c⁄° *, 
va_li°
);

11899 #i‚de‡
SQLITE_OMIT_TRACE


11900 
SQLITE_PRIVATE
 
	`sqlôe3XPrötf
(
SåAccum
*, const *, ...);

11902 
SQLITE_PRIVATE
 *
	`sqlôe3MPrötf
(
sqlôe3
*,const *, ...);

11903 
SQLITE_PRIVATE
 *
	`sqlôe3VMPrötf
(
sqlôe3
*,c⁄° *, 
va_li°
);

11904 
SQLITE_PRIVATE
 *
	`sqlôe3MAµídf
(
sqlôe3
*,*,const *,...);

11905 #i‡
	`deföed
(
SQLITE_TEST
Ë|| deföed(
SQLITE_DEBUG
)

11906 
SQLITE_PRIVATE
 
	`sqlôe3DebugPrötf
(const *, ...);

11908 #i‡
	`deföed
(
SQLITE_TEST
)

11909 
SQLITE_PRIVATE
 *
	`sqlôe3Te°TextToPå
(const *);

11913 #i‡
	`deföed
(
SQLITE_ENABLE_TREE_EXPLAIN
)

11914 
SQLITE_PRIVATE
 
	`sqlôe3Ex∂aöBegö
(
Vdbe
*);

11915 
SQLITE_PRIVATE
 
	`sqlôe3Ex∂aöPrötf
(
Vdbe
*, const *, ...);

11916 
SQLITE_PRIVATE
 
	`sqlôe3Ex∂aöNL
(
Vdbe
*);

11917 
SQLITE_PRIVATE
 
	`sqlôe3Ex∂aöPush
(
Vdbe
*);

11918 
SQLITE_PRIVATE
 
	`sqlôe3Ex∂aöP›
(
Vdbe
*);

11919 
SQLITE_PRIVATE
 
	`sqlôe3Ex∂aöFöish
(
Vdbe
*);

11920 
SQLITE_PRIVATE
 
	`sqlôe3Ex∂aöSñe˘
(
Vdbe
*, 
Sñe˘
*);

11921 
SQLITE_PRIVATE
 
	`sqlôe3Ex∂aöEx¥
(
Vdbe
*, 
Ex¥
*);

11922 
SQLITE_PRIVATE
 
	`sqlôe3Ex∂aöEx¥Li°
(
Vdbe
*, 
Ex¥Li°
*);

11923 
SQLITE_PRIVATE
 c⁄° *
	`sqlôe3VdbeEx∂™©i⁄
(
Vdbe
*);

11925 
	#sqlôe3Ex∂aöBegö
(
X
)

	)

11926 
	#sqlôe3Ex∂aöSñe˘
(
A
,
B
)

	)

11927 
	#sqlôe3Ex∂aöEx¥
(
A
,
B
)

	)

11928 
	#sqlôe3Ex∂aöEx¥Li°
(
A
,
B
)

	)

11929 
	#sqlôe3Ex∂aöFöish
(
X
)

	)

11930 
	#sqlôe3VdbeEx∂™©i⁄
(
X
Ë0

	)

11934 
SQLITE_PRIVATE
 
	`sqlôe3SëSåög
(**, 
sqlôe3
*, const *, ...);

11935 
SQLITE_PRIVATE
 
	`sqlôe3Eº‹Msg
(
P¨£
*, const *, ...);

11936 
SQLITE_PRIVATE
 
	`sqlôe3DequŸe
(*);

11937 
SQLITE_PRIVATE
 
	`sqlôe3Keyw‹dCode
(const *, );

11938 
SQLITE_PRIVATE
 
	`sqlôe3RunP¨£r
(
P¨£
*, const *, **);

11939 
SQLITE_PRIVATE
 
	`sqlôe3FöishCodög
(
P¨£
*);

11940 
SQLITE_PRIVATE
 
	`sqlôe3GëTempReg
(
P¨£
*);

11941 
SQLITE_PRIVATE
 
	`sqlôe3Rñó£TempReg
(
P¨£
*,);

11942 
SQLITE_PRIVATE
 
	`sqlôe3GëTempR™ge
(
P¨£
*,);

11943 
SQLITE_PRIVATE
 
	`sqlôe3Rñó£TempR™ge
(
P¨£
*,,);

11944 
SQLITE_PRIVATE
 
	`sqlôe3CÀ¨TempRegCache
(
P¨£
*);

11945 
SQLITE_PRIVATE
 
Ex¥
 *
	`sqlôe3Ex¥AŒoc
(
sqlôe3
*,,c⁄° 
Tokí
*,);

11946 
SQLITE_PRIVATE
 
Ex¥
 *
	`sqlôe3Ex¥
(
sqlôe3
*,,const *);

11947 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥AâachSubåìs
(
sqlôe3
*,
Ex¥
*,Expr*,Expr*);

11948 
SQLITE_PRIVATE
 
Ex¥
 *
	`sqlôe3PEx¥
(
P¨£
*, , Ex¥*, Ex¥*, c⁄° 
Tokí
*);

11949 
SQLITE_PRIVATE
 
Ex¥
 *
	`sqlôe3Ex¥And
(
sqlôe3
*,Expr*, Expr*);

11950 
SQLITE_PRIVATE
 
Ex¥
 *
	`sqlôe3Ex¥Fun˘i⁄
(
P¨£
*,
Ex¥Li°
*, 
Tokí
*);

11951 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥AssignV¨Numbî
(
P¨£
*, 
Ex¥
*);

11952 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥Dñëe
(
sqlôe3
*, 
Ex¥
*);

11953 
SQLITE_PRIVATE
 
Ex¥Li°
 *
	`sqlôe3Ex¥Li°Aµíd
(
P¨£
*,Ex¥Li°*,
Ex¥
*);

11954 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥Li°SëName
(
P¨£
*,
Ex¥Li°
*,
Tokí
*,);

11955 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥Li°SëS∑n
(
P¨£
*,
Ex¥Li°
*,
Ex¥S∑n
*);

11956 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥Li°Dñëe
(
sqlôe3
*, 
Ex¥Li°
*);

11957 
SQLITE_PRIVATE
 
	`sqlôe3Inô
(
sqlôe3
*, **);

11958 
SQLITE_PRIVATE
 
	`sqlôe3InôCÆlback
(*, , **, **);

11959 
SQLITE_PRIVATE
 
	`sqlôe3Pøgma
(
P¨£
*,
Tokí
*,Token*,Token*,);

11960 
SQLITE_PRIVATE
 
	`sqlôe3Re£tAŒSchemasOfC⁄√˘i⁄
(
sqlôe3
*);

11961 
SQLITE_PRIVATE
 
	`sqlôe3Re£tO√Schema
(
sqlôe3
*,);

11962 
SQLITE_PRIVATE
 
	`sqlôe3Cﬁœp£D©aba£Aºay
(
sqlôe3
*);

11963 
SQLITE_PRIVATE
 
	`sqlôe3BegöP¨£
(
P¨£
*,);

11964 
SQLITE_PRIVATE
 
	`sqlôe3CommôI¡î«lCh™ges
(
sqlôe3
*);

11965 
SQLITE_PRIVATE
 
TabÀ
 *
	`sqlôe3Resu…SëOfSñe˘
(
P¨£
*,
Sñe˘
*);

11966 
SQLITE_PRIVATE
 
	`sqlôe3O≥nMa°îTabÀ
(
P¨£
 *, );

11967 
SQLITE_PRIVATE
 
	`sqlôe3SèπTabÀ
(
P¨£
*,
Tokí
*,Token*,,,,);

11968 
SQLITE_PRIVATE
 
	`sqlôe3AddCﬁumn
(
P¨£
*,
Tokí
*);

11969 
SQLITE_PRIVATE
 
	`sqlôe3AddNŸNuŒ
(
P¨£
*, );

11970 
SQLITE_PRIVATE
 
	`sqlôe3AddPrim¨yKey
(
P¨£
*, 
Ex¥Li°
*, , , );

11971 
SQLITE_PRIVATE
 
	`sqlôe3AddCheckC⁄°øöt
(
P¨£
*, 
Ex¥
*);

11972 
SQLITE_PRIVATE
 
	`sqlôe3AddCﬁumnTy≥
(
P¨£
*,
Tokí
*);

11973 
SQLITE_PRIVATE
 
	`sqlôe3AddDeÁu…VÆue
(
P¨£
*,
Ex¥S∑n
*);

11974 
SQLITE_PRIVATE
 
	`sqlôe3AddCﬁœãTy≥
(
P¨£
*, 
Tokí
*);

11975 
SQLITE_PRIVATE
 
	`sqlôe3EndTabÀ
(
P¨£
*,
Tokí
*,Tokí*,
Sñe˘
*);

11976 
SQLITE_PRIVATE
 
	`sqlôe3P¨£Uri
(const *,const *,*,

11977 
sqlôe3_vfs
**,**,**);

11978 
SQLITE_PRIVATE
 
Båì
 *
	`sqlôe3DbNameToBåì
(
sqlôe3
*,const *);

11979 
SQLITE_PRIVATE
 
	`sqlôe3CodeOn˚
(
P¨£
 *);

11981 
SQLITE_PRIVATE
 
Bôvec
 *
	`sqlôe3BôvecCª©e
(
u32
);

11982 
SQLITE_PRIVATE
 
	`sqlôe3BôvecTe°
(
Bôvec
*, 
u32
);

11983 
SQLITE_PRIVATE
 
	`sqlôe3BôvecSë
(
Bôvec
*, 
u32
);

11984 
SQLITE_PRIVATE
 
	`sqlôe3BôvecCÀ¨
(
Bôvec
*, 
u32
, *);

11985 
SQLITE_PRIVATE
 
	`sqlôe3BôvecDe°roy
(
Bôvec
*);

11986 
SQLITE_PRIVATE
 
u32
 
	`sqlôe3BôvecSize
(
Bôvec
*);

11987 
SQLITE_PRIVATE
 
	`sqlôe3BôvecBuûtöTe°
(,*);

11989 
SQLITE_PRIVATE
 
RowSë
 *
	`sqlôe3RowSëInô
(
sqlôe3
*, *, );

11990 
SQLITE_PRIVATE
 
	`sqlôe3RowSëCÀ¨
(
RowSë
*);

11991 
SQLITE_PRIVATE
 
	`sqlôe3RowSëIn£π
(
RowSë
*, 
i64
);

11992 
SQLITE_PRIVATE
 
	`sqlôe3RowSëTe°
(
RowSë
*, 
u8
 
iB©ch
, 
i64
);

11993 
SQLITE_PRIVATE
 
	`sqlôe3RowSëNext
(
RowSë
*, 
i64
*);

11995 
SQLITE_PRIVATE
 
	`sqlôe3Cª©eVõw
(
P¨£
*,
Tokí
*,Tokí*,Tokí*,
Sñe˘
*,,);

11997 #i‡!
	`deföed
(
SQLITE_OMIT_VIEW
Ë|| !deföed(
SQLITE_OMIT_VIRTUALTABLE
)

11998 
SQLITE_PRIVATE
 
	`sqlôe3VõwGëCﬁumnNames
(
P¨£
*,
TabÀ
*);

12000 
	#sqlôe3VõwGëCﬁumnNames
(
A
,
B
Ë0

	)

12003 
SQLITE_PRIVATE
 
	`sqlôe3Dr›TabÀ
(
P¨£
*, 
SrcLi°
*, , );

12004 
SQLITE_PRIVATE
 
	`sqlôe3CodeDr›TabÀ
(
P¨£
*, 
TabÀ
*, , );

12005 
SQLITE_PRIVATE
 
	`sqlôe3DñëeTabÀ
(
sqlôe3
*, 
TabÀ
*);

12006 #i‚de‡
SQLITE_OMIT_AUTOINCREMENT


12007 
SQLITE_PRIVATE
 
	`sqlôe3Autoö¸emítBegö
(
P¨£
 *
pP¨£
);

12008 
SQLITE_PRIVATE
 
	`sqlôe3Autoö¸emítEnd
(
P¨£
 *
pP¨£
);

12010 
	#sqlôe3Autoö¸emítBegö
(
X
)

	)

12011 
	#sqlôe3Autoö¸emítEnd
(
X
)

	)

12013 
SQLITE_PRIVATE
 
	`sqlôe3CodeC‹outöe
(
P¨£
*, 
Sñe˘
*, 
Sñe˘De°
*);

12014 
SQLITE_PRIVATE
 
	`sqlôe3In£π
(
P¨£
*, 
SrcLi°
*, 
Ex¥Li°
*, 
Sñe˘
*, 
IdLi°
*, );

12015 
SQLITE_PRIVATE
 *
	`sqlôe3AºayAŒoˇã
(
sqlôe3
*,*,,*,*);

12016 
SQLITE_PRIVATE
 
IdLi°
 *
	`sqlôe3IdLi°Aµíd
(
sqlôe3
*, IdLi°*, 
Tokí
*);

12017 
SQLITE_PRIVATE
 
	`sqlôe3IdLi°Index
(
IdLi°
*,const *);

12018 
SQLITE_PRIVATE
 
SrcLi°
 *
	`sqlôe3SrcLi°E∆¨ge
(
sqlôe3
*, SrcList*, , );

12019 
SQLITE_PRIVATE
 
SrcLi°
 *
	`sqlôe3SrcLi°Aµíd
(
sqlôe3
*, SrcLi°*, 
Tokí
*, Token*);

12020 
SQLITE_PRIVATE
 
SrcLi°
 *
	`sqlôe3SrcLi°AµídFromTîm
(
P¨£
*, SrcLi°*, 
Tokí
*, Token*,

12021 
Tokí
*, 
Sñe˘
*, 
Ex¥
*, 
IdLi°
*);

12022 
SQLITE_PRIVATE
 
	`sqlôe3SrcLi°IndexedBy
(
P¨£
 *, 
SrcLi°
 *, 
Tokí
 *);

12023 
SQLITE_PRIVATE
 
	`sqlôe3IndexedByLookup
(
P¨£
 *, 
SrcLi°_ôem
 *);

12024 
SQLITE_PRIVATE
 
	`sqlôe3SrcLi°Shi·JoöTy≥
(
SrcLi°
*);

12025 
SQLITE_PRIVATE
 
	`sqlôe3SrcLi°AssignCurs‹s
(
P¨£
*, 
SrcLi°
*);

12026 
SQLITE_PRIVATE
 
	`sqlôe3IdLi°Dñëe
(
sqlôe3
*, 
IdLi°
*);

12027 
SQLITE_PRIVATE
 
	`sqlôe3SrcLi°Dñëe
(
sqlôe3
*, 
SrcLi°
*);

12028 
SQLITE_PRIVATE
 
Index
 *
	`sqlôe3Cª©eIndex
(
P¨£
*,
Tokí
*,Tokí*,
SrcLi°
*,
Ex¥Li°
*,,Token*,

12029 
Ex¥
*, , );

12030 
SQLITE_PRIVATE
 
	`sqlôe3Dr›Index
(
P¨£
*, 
SrcLi°
*, );

12031 
SQLITE_PRIVATE
 
	`sqlôe3Sñe˘
(
P¨£
*, 
Sñe˘
*, 
Sñe˘De°
*);

12032 
SQLITE_PRIVATE
 
Sñe˘
 *
	`sqlôe3Sñe˘New
(
P¨£
*,
Ex¥Li°
*,
SrcLi°
*,
Ex¥
*,ExprList*,

12033 
Ex¥
*,
Ex¥Li°
*,
u16
,Expr*,Expr*);

12034 
SQLITE_PRIVATE
 
	`sqlôe3Sñe˘Dñëe
(
sqlôe3
*, 
Sñe˘
*);

12035 
SQLITE_PRIVATE
 
TabÀ
 *
	`sqlôe3SrcLi°Lookup
(
P¨£
*, 
SrcLi°
*);

12036 
SQLITE_PRIVATE
 
	`sqlôe3IsRódO∆y
(
P¨£
*, 
TabÀ
*, );

12037 
SQLITE_PRIVATE
 
	`sqlôe3O≥nTabÀ
(
P¨£
*, 
iCur
, 
iDb
, 
TabÀ
*, );

12038 #i‡
	`deföed
(
SQLITE_ENABLE_UPDATE_DELETE_LIMIT
Ë&& !deföed(
SQLITE_OMIT_SUBQUERY
)

12039 
SQLITE_PRIVATE
 
Ex¥
 *
	`sqlôe3LimôWhîe
(
P¨£
*,
SrcLi°
*,Ex¥*,
Ex¥Li°
*,Expr*,Expr*,*);

12041 
SQLITE_PRIVATE
 
	`sqlôe3DñëeFrom
(
P¨£
*, 
SrcLi°
*, 
Ex¥
*);

12042 
SQLITE_PRIVATE
 
	`sqlôe3Upd©e
(
P¨£
*, 
SrcLi°
*, 
Ex¥Li°
*, 
Ex¥
*, );

12043 
SQLITE_PRIVATE
 
WhîeInfo
 *
	`sqlôe3WhîeBegö
(
P¨£
*,
SrcLi°
*,
Ex¥
*,
Ex¥Li°
*,Ex¥Li°*,
u16
,);

12044 
SQLITE_PRIVATE
 
	`sqlôe3WhîeEnd
(
WhîeInfo
*);

12045 
SQLITE_PRIVATE
 
u64
 
	`sqlôe3WhîeOuçutRowCou¡
(
WhîeInfo
*);

12046 
SQLITE_PRIVATE
 
	`sqlôe3WhîeIsDi°ö˘
(
WhîeInfo
*);

12047 
SQLITE_PRIVATE
 
	`sqlôe3WhîeIsOrdîed
(
WhîeInfo
*);

12048 
SQLITE_PRIVATE
 
	`sqlôe3WhîeC⁄töueLabñ
(
WhîeInfo
*);

12049 
SQLITE_PRIVATE
 
	`sqlôe3WhîeBªakLabñ
(
WhîeInfo
*);

12050 
SQLITE_PRIVATE
 
	`sqlôe3WhîeOkO√Pass
(
WhîeInfo
*);

12051 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥CodeGëCﬁumn
(
P¨£
*, 
TabÀ
*, , , , 
u8
);

12052 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥CodeGëCﬁumnOfTabÀ
(
Vdbe
*, 
TabÀ
*, , , );

12053 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥CodeMove
(
P¨£
*, , , );

12054 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥CacheSt‹e
(
P¨£
*, , , );

12055 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥CachePush
(
P¨£
*);

12056 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥CacheP›
(
P¨£
*, );

12057 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥CacheRemove
(
P¨£
*, , );

12058 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥CacheCÀ¨
(
P¨£
*);

12059 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥CacheAfföôyCh™ge
(
P¨£
*, , );

12060 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥Code
(
P¨£
*, 
Ex¥
*, );

12061 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥CodeTemp
(
P¨£
*, 
Ex¥
*, *);

12062 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥CodeT¨gë
(
P¨£
*, 
Ex¥
*, );

12063 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥CodeAndCache
(
P¨£
*, 
Ex¥
*, );

12064 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥CodeC⁄°™ts
(
P¨£
*, 
Ex¥
*);

12065 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥CodeEx¥Li°
(
P¨£
*, 
Ex¥Li°
*, , );

12066 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥IfTrue
(
P¨£
*, 
Ex¥
*, , );

12067 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥IfFÆ£
(
P¨£
*, 
Ex¥
*, , );

12068 
SQLITE_PRIVATE
 
TabÀ
 *
	`sqlôe3FödTabÀ
(
sqlôe3
*,const *, const *);

12069 
SQLITE_PRIVATE
 
TabÀ
 *
	`sqlôe3LoˇãTabÀ
(
P¨£
*,
isVõw
,const *, const *);

12070 
SQLITE_PRIVATE
 
TabÀ
 *
	`sqlôe3LoˇãTabÀIãm
(
P¨£
*,
isVõw
,
SrcLi°_ôem
 *);

12071 
SQLITE_PRIVATE
 
Index
 *
	`sqlôe3FödIndex
(
sqlôe3
*,const *, const *);

12072 
SQLITE_PRIVATE
 
	`sqlôe3U∆ökAndDñëeTabÀ
(
sqlôe3
*,,const *);

12073 
SQLITE_PRIVATE
 
	`sqlôe3U∆ökAndDñëeIndex
(
sqlôe3
*,,const *);

12074 
SQLITE_PRIVATE
 
	`sqlôe3Vacuum
(
P¨£
*);

12075 
SQLITE_PRIVATE
 
	`sqlôe3RunVacuum
(**, 
sqlôe3
*);

12076 
SQLITE_PRIVATE
 *
	`sqlôe3NameFromTokí
(
sqlôe3
*, 
Tokí
*);

12077 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥Com∑ª
(
Ex¥
*, Expr*, );

12078 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥Li°Com∑ª
(
Ex¥Li°
*, ExprList*, );

12079 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥Im∂õsEx¥
(
Ex¥
*, Expr*, );

12080 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥A«lyzeAggªg©es
(
NameC⁄ãxt
*, 
Ex¥
*);

12081 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥A«lyzeAggLi°
(
NameC⁄ãxt
*,
Ex¥Li°
*);

12082 
SQLITE_PRIVATE
 
	`sqlôe3Fun˘i⁄U£sThisSrc
(
Ex¥
*, 
SrcLi°
*);

12083 
SQLITE_PRIVATE
 
Vdbe
 *
	`sqlôe3GëVdbe
(
P¨£
*);

12084 
SQLITE_PRIVATE
 
	`sqlôe3P∫gSaveSèã
();

12085 
SQLITE_PRIVATE
 
	`sqlôe3P∫gRe°‹eSèã
();

12086 
SQLITE_PRIVATE
 
	`sqlôe3P∫gRe£tSèã
();

12087 
SQLITE_PRIVATE
 
	`sqlôe3RﬁlbackAŒ
(
sqlôe3
*,);

12088 
SQLITE_PRIVATE
 
	`sqlôe3CodeVîifySchema
(
P¨£
*, );

12089 
SQLITE_PRIVATE
 
	`sqlôe3CodeVîifyNamedSchema
(
P¨£
*, c⁄° *
zDb
);

12090 
SQLITE_PRIVATE
 
	`sqlôe3BegöTønß˘i⁄
(
P¨£
*, );

12091 
SQLITE_PRIVATE
 
	`sqlôe3CommôTønß˘i⁄
(
P¨£
*);

12092 
SQLITE_PRIVATE
 
	`sqlôe3RﬁlbackTønß˘i⁄
(
P¨£
*);

12093 
SQLITE_PRIVATE
 
	`sqlôe3Savïoöt
(
P¨£
*, , 
Tokí
*);

12094 
SQLITE_PRIVATE
 
	`sqlôe3Clo£Savïoöts
(
sqlôe3
 *);

12095 
SQLITE_PRIVATE
 
	`sqlôe3LóveMuãxAndClo£Zombõ
(
sqlôe3
*);

12096 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥IsC⁄°™t
(
Ex¥
*);

12097 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥IsC⁄°™tNŸJoö
(
Ex¥
*);

12098 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥IsC⁄°™tOrFun˘i⁄
(
Ex¥
*);

12099 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥IsI¡egî
(
Ex¥
*, *);

12100 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥C™BeNuŒ
(c⁄° 
Ex¥
*);

12101 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥CodeIsNuŒJump
(
Vdbe
*, c⁄° 
Ex¥
*, , );

12102 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥NìdsNoAfföôyCh™ge
(c⁄° 
Ex¥
*, );

12103 
SQLITE_PRIVATE
 
	`sqlôe3IsRowid
(const *);

12104 
SQLITE_PRIVATE
 
	`sqlôe3Gíî©eRowDñëe
(
P¨£
*, 
TabÀ
*, , , , 
Triggî
 *, );

12105 
SQLITE_PRIVATE
 
	`sqlôe3Gíî©eRowIndexDñëe
(
P¨£
*, 
TabÀ
*, , *);

12106 
SQLITE_PRIVATE
 
	`sqlôe3Gíî©eIndexKey
(
P¨£
*, 
Index
*, , , , *);

12107 
SQLITE_PRIVATE
 
	`sqlôe3Gíî©eC⁄°øötChecks
(
P¨£
*,
TabÀ
*,,,

12109 
SQLITE_PRIVATE
 
	`sqlôe3Com∂ëeIn£πi⁄
(
P¨£
*, 
TabÀ
*, , , *, , , );

12110 
SQLITE_PRIVATE
 
	`sqlôe3O≥nTabÀAndIndi˚s
(
P¨£
*, 
TabÀ
*, , );

12111 
SQLITE_PRIVATE
 
	`sqlôe3BegöWrôeO≥øti⁄
(
P¨£
*, , );

12112 
SQLITE_PRIVATE
 
	`sqlôe3Mu…iWrôe
(
P¨£
*);

12113 
SQLITE_PRIVATE
 
	`sqlôe3MayAb‹t
(
P¨£
*);

12114 
SQLITE_PRIVATE
 
	`sqlôe3HÆtC⁄°øöt
(
P¨£
*, , , *, );

12115 
SQLITE_PRIVATE
 
Ex¥
 *
	`sqlôe3Ex¥Dup
(
sqlôe3
*,Expr*,);

12116 
SQLITE_PRIVATE
 
Ex¥Li°
 *
	`sqlôe3Ex¥Li°Dup
(
sqlôe3
*,ExprList*,);

12117 
SQLITE_PRIVATE
 
SrcLi°
 *
	`sqlôe3SrcLi°Dup
(
sqlôe3
*,SrcList*,);

12118 
SQLITE_PRIVATE
 
IdLi°
 *
	`sqlôe3IdLi°Dup
(
sqlôe3
*,IdList*);

12119 
SQLITE_PRIVATE
 
Sñe˘
 *
	`sqlôe3Sñe˘Dup
(
sqlôe3
*,Select*,);

12120 
SQLITE_PRIVATE
 
	`sqlôe3FuncDefIn£π
(
FuncDefHash
*, 
FuncDef
*);

12121 
SQLITE_PRIVATE
 
FuncDef
 *
	`sqlôe3FödFun˘i⁄
(
sqlôe3
*,c⁄° *,,,
u8
,u8);

12122 
SQLITE_PRIVATE
 
	`sqlôe3Regi°îBuûtöFun˘i⁄s
(
sqlôe3
*);

12123 
SQLITE_PRIVATE
 
	`sqlôe3Regi°îD©eTimeFun˘i⁄s
();

12124 
SQLITE_PRIVATE
 
	`sqlôe3Regi°îGlobÆFun˘i⁄s
();

12125 
SQLITE_PRIVATE
 
	`sqlôe3Sa„tyCheckOk
(
sqlôe3
*);

12126 
SQLITE_PRIVATE
 
	`sqlôe3Sa„tyCheckSickOrOk
(
sqlôe3
*);

12127 
SQLITE_PRIVATE
 
	`sqlôe3Ch™geCookõ
(
P¨£
*, );

12129 #i‡!
	`deföed
(
SQLITE_OMIT_VIEW
Ë&& !deföed(
SQLITE_OMIT_TRIGGER
)

12130 
SQLITE_PRIVATE
 
	`sqlôe3M©îülizeVõw
(
P¨£
*, 
TabÀ
*, 
Ex¥
*, );

12133 #i‚de‡
SQLITE_OMIT_TRIGGER


12134 
SQLITE_PRIVATE
 
	`sqlôe3BegöTriggî
(
P¨£
*, 
Tokí
*,Tokí*,,,
IdLi°
*,
SrcLi°
*,

12135 
Ex¥
*,, );

12136 
SQLITE_PRIVATE
 
	`sqlôe3FöishTriggî
(
P¨£
*, 
TriggîSãp
*, 
Tokí
*);

12137 
SQLITE_PRIVATE
 
	`sqlôe3Dr›Triggî
(
P¨£
*, 
SrcLi°
*, );

12138 
SQLITE_PRIVATE
 
	`sqlôe3Dr›TriggîPå
(
P¨£
*, 
Triggî
*);

12139 
SQLITE_PRIVATE
 
Triggî
 *
	`sqlôe3TriggîsExi°
(
P¨£
 *, 
TabÀ
*, , 
Ex¥Li°
*, *
pMask
);

12140 
SQLITE_PRIVATE
 
Triggî
 *
	`sqlôe3TriggîLi°
(
P¨£
 *, 
TabÀ
 *);

12141 
SQLITE_PRIVATE
 
	`sqlôe3CodeRowTriggî
(
P¨£
*, 
Triggî
 *, , 
Ex¥Li°
*, , 
TabÀ
 *,

12143 
SQLITE_PRIVATE
 
	`sqlôe3CodeRowTriggîDúe˘
(
P¨£
 *, 
Triggî
 *, 
TabÀ
 *, , , );

12144 
	`sqlôeVõwTriggîs
(
P¨£
*, 
TabÀ
*, 
Ex¥
*, , 
Ex¥Li°
*);

12145 
SQLITE_PRIVATE
 
	`sqlôe3DñëeTriggîSãp
(
sqlôe3
*, 
TriggîSãp
*);

12146 
SQLITE_PRIVATE
 
TriggîSãp
 *
	`sqlôe3TriggîSñe˘Sãp
(
sqlôe3
*,
Sñe˘
*);

12147 
SQLITE_PRIVATE
 
TriggîSãp
 *
	`sqlôe3TriggîIn£πSãp
(
sqlôe3
*,
Tokí
*, 
IdLi°
*,

12148 
Ex¥Li°
*,
Sñe˘
*,
u8
);

12149 
SQLITE_PRIVATE
 
TriggîSãp
 *
	`sqlôe3TriggîUpd©eSãp
(
sqlôe3
*,
Tokí
*,
Ex¥Li°
*, 
Ex¥
*, 
u8
);

12150 
SQLITE_PRIVATE
 
TriggîSãp
 *
	`sqlôe3TriggîDñëeSãp
(
sqlôe3
*,
Tokí
*, 
Ex¥
*);

12151 
SQLITE_PRIVATE
 
	`sqlôe3DñëeTriggî
(
sqlôe3
*, 
Triggî
*);

12152 
SQLITE_PRIVATE
 
	`sqlôe3U∆ökAndDñëeTriggî
(
sqlôe3
*,,const *);

12153 
SQLITE_PRIVATE
 
u32
 
	`sqlôe3TriggîCﬁmask
(
P¨£
*,
Triggî
*,
Ex¥Li°
*,,,
TabÀ
*,);

12154 
	#sqlôe3P¨£T›Àvñ
(
p
Ë(’)->
pT›Àvñ
 ? (p)->pT›Àvñ : (p))

	)

12156 
	#sqlôe3TriggîsExi°
(
B
,
C
,
D
,
E
,
F
Ë0

	)

12157 
	#sqlôe3DñëeTriggî
(
A
,
B
)

	)

12158 
	#sqlôe3Dr›TriggîPå
(
A
,
B
)

	)

12159 
	#sqlôe3U∆ökAndDñëeTriggî
(
A
,
B
,
C
)

	)

12160 
	#sqlôe3CodeRowTriggî
(
A
,
B
,
C
,
D
,
E
,
F
,
G
,
H
,
I
)

	)

12161 
	#sqlôe3CodeRowTriggîDúe˘
(
A
,
B
,
C
,
D
,
E
,
F
)

	)

12162 
	#sqlôe3TriggîLi°
(
X
, 
Y
Ë0

	)

12163 
	#sqlôe3P¨£T›Àvñ
(
p
Ë
	)
p

12164 
	#sqlôe3TriggîCﬁmask
(
A
,
B
,
C
,
D
,
E
,
F
,
G
Ë0

	)

12167 
SQLITE_PRIVATE
 
	`sqlôe3JoöTy≥
(
P¨£
*, 
Tokí
*, Token*, Token*);

12168 
SQLITE_PRIVATE
 
	`sqlôe3Cª©eF‹eignKey
(
P¨£
*, 
Ex¥Li°
*, 
Tokí
*, ExprList*, );

12169 
SQLITE_PRIVATE
 
	`sqlôe3De„rF‹eignKey
(
P¨£
*, );

12170 #i‚de‡
SQLITE_OMIT_AUTHORIZATION


12171 
SQLITE_PRIVATE
 
	`sqlôe3AuthRód
(
P¨£
*,
Ex¥
*,
Schema
*,
SrcLi°
*);

12172 
SQLITE_PRIVATE
 
	`sqlôe3AuthCheck
(
P¨£
*,, const *, const *, const *);

12173 
SQLITE_PRIVATE
 
	`sqlôe3AuthC⁄ãxtPush
(
P¨£
*, 
AuthC⁄ãxt
*, const *);

12174 
SQLITE_PRIVATE
 
	`sqlôe3AuthC⁄ãxtP›
(
AuthC⁄ãxt
*);

12175 
SQLITE_PRIVATE
 
	`sqlôe3AuthRódCﬁ
(
P¨£
*, const *, const *, );

12177 
	#sqlôe3AuthRód
(
a
,
b
,
c
,
d
)

	)

12178 
	#sqlôe3AuthCheck
(
a
,
b
,
c
,
d
,
e
Ë
SQLITE_OK


	)

12179 
	#sqlôe3AuthC⁄ãxtPush
(
a
,
b
,
c
)

	)

12180 
	#sqlôe3AuthC⁄ãxtP›
(
a
Ë(()◊))

	)

12182 
SQLITE_PRIVATE
 
	`sqlôe3Aâach
(
P¨£
*, 
Ex¥
*, Expr*, Expr*);

12183 
SQLITE_PRIVATE
 
	`sqlôe3Dëach
(
P¨£
*, 
Ex¥
*);

12184 
SQLITE_PRIVATE
 
	`sqlôe3FixInô
(
DbFixî
*, 
P¨£
*, , c⁄° *, c⁄° 
Tokí
*);

12185 
SQLITE_PRIVATE
 
	`sqlôe3FixSrcLi°
(
DbFixî
*, 
SrcLi°
*);

12186 
SQLITE_PRIVATE
 
	`sqlôe3FixSñe˘
(
DbFixî
*, 
Sñe˘
*);

12187 
SQLITE_PRIVATE
 
	`sqlôe3FixEx¥
(
DbFixî
*, 
Ex¥
*);

12188 
SQLITE_PRIVATE
 
	`sqlôe3FixEx¥Li°
(
DbFixî
*, 
Ex¥Li°
*);

12189 
SQLITE_PRIVATE
 
	`sqlôe3FixTriggîSãp
(
DbFixî
*, 
TriggîSãp
*);

12190 
SQLITE_PRIVATE
 
	`sqlôe3AtoF
(c⁄° *
z
, *, , 
u8
);

12191 
SQLITE_PRIVATE
 
	`sqlôe3GëI¡32
(const *, *);

12192 
SQLITE_PRIVATE
 
	`sqlôe3Atoi
(const *);

12193 
SQLITE_PRIVATE
 
	`sqlôe3Utf16ByãLí
(c⁄° *
pD©a
, 
nCh¨
);

12194 
SQLITE_PRIVATE
 
	`sqlôe3Utf8Ch¨Lí
(c⁄° *
pD©a
, 
nByã
);

12195 
SQLITE_PRIVATE
 
u32
 
	`sqlôe3Utf8Ród
(c⁄° 
u8
**);

12196 
SQLITE_PRIVATE
 
LogE°
 
	`sqlôe3LogE°
(
u64
);

12197 
SQLITE_PRIVATE
 
LogE°
 
	`sqlôe3LogE°Add
(LogEst,LogEst);

12198 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


12199 
SQLITE_PRIVATE
 
LogE°
 
	`sqlôe3LogE°FromDoubÀ
();

12201 
SQLITE_PRIVATE
 
u64
 
	`sqlôe3LogE°ToI¡
(
LogE°
);

12210 
SQLITE_PRIVATE
 
	`sqlôe3PutV¨öt
(*, 
u64
);

12211 
SQLITE_PRIVATE
 
	`sqlôe3PutV¨öt32
(*, 
u32
);

12212 
SQLITE_PRIVATE
 
u8
 
	`sqlôe3GëV¨öt
(c⁄° *, 
u64
 *);

12213 
SQLITE_PRIVATE
 
u8
 
	`sqlôe3GëV¨öt32
(c⁄° *, 
u32
 *);

12214 
SQLITE_PRIVATE
 
	`sqlôe3V¨ötLí
(
u64
 
v
);

12233 
	#gëV¨öt32
(
A
,
B
) \

12234 (
u8
)((*(
A
)<(u8)0x80)?((
B
)=(
u32
)*(A)),1:
	`sqlôe3GëV¨öt32
((A),(u32 *)&(B)))

	)

12235 
	#putV¨öt32
(
A
,
B
) \

12236 (
u8
)(((
u32
)(
B
)<(u32)0x80)?(*(
A
)=()(B)),1:\

12237 
	`sqlôe3PutV¨öt32
((
A
),(
B
)))

	)

12238 
	#gëV¨öt
 
sqlôe3GëV¨öt


	)

12239 
	#putV¨öt
 
sqlôe3PutV¨öt


	)

12242 
SQLITE_PRIVATE
 c⁄° *
	`sqlôe3IndexAfföôySå
(
Vdbe
 *, 
Index
 *);

12243 
SQLITE_PRIVATE
 
	`sqlôe3TabÀAfföôySå
(
Vdbe
 *, 
TabÀ
 *);

12244 
SQLITE_PRIVATE
 
	`sqlôe3Com∑ªAfföôy
(
Ex¥
 *
pEx¥
, 
aff2
);

12245 
SQLITE_PRIVATE
 
	`sqlôe3IndexAfföôyOk
(
Ex¥
 *
pEx¥
, 
idx_afföôy
);

12246 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥Afföôy
(
Ex¥
 *
pEx¥
);

12247 
SQLITE_PRIVATE
 
	`sqlôe3Atoi64
(c⁄° *, 
i64
*, , 
u8
);

12248 
SQLITE_PRIVATE
 
	`sqlôe3Eº‹
(
sqlôe3
*, , const *,...);

12249 
SQLITE_PRIVATE
 *
	`sqlôe3HexToBlob
(
sqlôe3
*, c⁄° *
z
, 
n
);

12250 
SQLITE_PRIVATE
 
u8
 
	`sqlôe3HexToI¡
(
h
);

12251 
SQLITE_PRIVATE
 
	`sqlôe3TwoP¨tName
(
P¨£
 *, 
Tokí
 *, Token *, Token **);

12253 #i‡
	`deföed
(
SQLITE_DEBUG
Ë|| deföed(
SQLITE_TEST
) || \

12254 
	$deföed
(
SQLITE_DEBUG_OS_TRACE
)

12255 
SQLITE_PRIVATE
 c⁄° *
	`sqlôe3EºName
();

12258 
SQLITE_PRIVATE
 c⁄° *
	`sqlôe3EºSå
();

12259 
SQLITE_PRIVATE
 
	`sqlôe3RódSchema
(
P¨£
 *
pP¨£
);

12260 
SQLITE_PRIVATE
 
CﬁlSeq
 *
	`sqlôe3FödCﬁlSeq
(
sqlôe3
*,
u8
 
íc
, const *,);

12261 
SQLITE_PRIVATE
 
CﬁlSeq
 *
	`sqlôe3LoˇãCﬁlSeq
(
P¨£
 *
pP¨£
, c⁄° *
zName
);

12262 
SQLITE_PRIVATE
 
CﬁlSeq
 *
	`sqlôe3Ex¥CﬁlSeq
(
P¨£
 *
pP¨£
, 
Ex¥
 *
pEx¥
);

12263 
SQLITE_PRIVATE
 
Ex¥
 *
	`sqlôe3Ex¥AddCﬁœãTokí
(
P¨£
 *
pP¨£
, Ex¥*, 
Tokí
*);

12264 
SQLITE_PRIVATE
 
Ex¥
 *
	`sqlôe3Ex¥AddCﬁœãSåög
(
P¨£
*,Expr*,const *);

12265 
SQLITE_PRIVATE
 
Ex¥
 *
	`sqlôe3Ex¥SkùCﬁœã
(Expr*);

12266 
SQLITE_PRIVATE
 
	`sqlôe3CheckCﬁlSeq
(
P¨£
 *, 
CﬁlSeq
 *);

12267 
SQLITE_PRIVATE
 
	`sqlôe3CheckObje˘Name
(
P¨£
 *, const *);

12268 
SQLITE_PRIVATE
 
	`sqlôe3VdbeSëCh™ges
(
sqlôe3
 *, );

12269 
SQLITE_PRIVATE
 
	`sqlôe3AddI¡64
(
i64
*,i64);

12270 
SQLITE_PRIVATE
 
	`sqlôe3SubI¡64
(
i64
*,i64);

12271 
SQLITE_PRIVATE
 
	`sqlôe3MulI¡64
(
i64
*,i64);

12272 
SQLITE_PRIVATE
 
	`sqlôe3AbsI¡32
();

12273 #ifde‡
SQLITE_ENABLE_8_3_NAMES


12274 
SQLITE_PRIVATE
 
	`sqlôe3FûeSuffix3
(const *, *);

12276 
	#sqlôe3FûeSuffix3
(
X
,
Y
)

	)

12278 
SQLITE_PRIVATE
 
u8
 
	`sqlôe3GëBoﬁón
(c⁄° *
z
,);

12280 
SQLITE_PRIVATE
 c⁄° *
	`sqlôe3VÆueText
(
sqlôe3_vÆue
*, 
u8
);

12281 
SQLITE_PRIVATE
 
	`sqlôe3VÆueByãs
(
sqlôe3_vÆue
*, 
u8
);

12282 
SQLITE_PRIVATE
 
	`sqlôe3VÆueSëSå
(
sqlôe3_vÆue
*, , c⁄° *,
u8
,

12284 
SQLITE_PRIVATE
 
	`sqlôe3VÆueFªe
(
sqlôe3_vÆue
*);

12285 
SQLITE_PRIVATE
 
sqlôe3_vÆue
 *
	`sqlôe3VÆueNew
(
sqlôe3
 *);

12286 
SQLITE_PRIVATE
 *
	`sqlôe3Utf16to8
(
sqlôe3
 *, c⁄° *, , 
u8
);

12287 
SQLITE_PRIVATE
 
	`sqlôe3VÆueFromEx¥
(
sqlôe3
 *, 
Ex¥
 *, 
u8
, u8, 
sqlôe3_vÆue
 **);

12288 
SQLITE_PRIVATE
 
	`sqlôe3VÆueAµlyAfföôy
(
sqlôe3_vÆue
 *, 
u8
, u8);

12289 #i‚de‡
SQLITE_AMALGAMATION


12290 
SQLITE_PRIVATE
 c⁄° 
sqlôe3OpcodePr›îty
[];

12291 
SQLITE_PRIVATE
 c⁄° 
sqlôe3UµîToLowî
[];

12292 
SQLITE_PRIVATE
 c⁄° 
sqlôe3Cty≥M≠
[];

12293 
SQLITE_PRIVATE
 c⁄° 
Tokí
 
sqlôe3I¡Tokís
[];

12294 
SQLITE_PRIVATE
 
SQLITE_WSD
 
Sqlôe3C⁄fig
 
sqlôe3C⁄fig
;

12295 
SQLITE_PRIVATE
 
SQLITE_WSD
 
FuncDefHash
 
sqlôe3GlobÆFun˘i⁄s
;

12296 #i‚de‡
SQLITE_OMIT_WSD


12297 
SQLITE_PRIVATE
 
sqlôe3PídögByã
;

12300 
SQLITE_PRIVATE
 
	`sqlôe3RoŸPageMoved
(
sqlôe3
*, , , );

12301 
SQLITE_PRIVATE
 
	`sqlôe3Reödex
(
P¨£
*, 
Tokí
*, Token*);

12302 
SQLITE_PRIVATE
 
	`sqlôe3A…îFun˘i⁄s
();

12303 
SQLITE_PRIVATE
 
	`sqlôe3A…îRíameTabÀ
(
P¨£
*, 
SrcLi°
*, 
Tokí
*);

12304 
SQLITE_PRIVATE
 
	`sqlôe3GëTokí
(const *, *);

12305 
SQLITE_PRIVATE
 
	`sqlôe3Ne°edP¨£
(
P¨£
*, const *, ...);

12306 
SQLITE_PRIVATE
 
	`sqlôe3ExpúePª∑ªdSèãmíts
(
sqlôe3
*);

12307 
SQLITE_PRIVATE
 
	`sqlôe3CodeSub£À˘
(
P¨£
 *, 
Ex¥
 *, , );

12308 
SQLITE_PRIVATE
 
	`sqlôe3Sñe˘Pªp
(
P¨£
*, 
Sñe˘
*, 
NameC⁄ãxt
*);

12309 
SQLITE_PRIVATE
 
	`sqlôe3M©chS∑nName
(const *, const *, const *, const *);

12310 
SQLITE_PRIVATE
 
	`sqlôe3ResﬁveEx¥Names
(
NameC⁄ãxt
*, 
Ex¥
*);

12311 
SQLITE_PRIVATE
 
	`sqlôe3ResﬁveSñe˘Names
(
P¨£
*, 
Sñe˘
*, 
NameC⁄ãxt
*);

12312 
SQLITE_PRIVATE
 
	`sqlôe3ResﬁveSñfRe„ªn˚
(
P¨£
*,
TabÀ
*,,
Ex¥
*,
Ex¥Li°
*);

12313 
SQLITE_PRIVATE
 
	`sqlôe3ResﬁveOrdîGroupBy
(
P¨£
*, 
Sñe˘
*, 
Ex¥Li°
*, const *);

12314 
SQLITE_PRIVATE
 
	`sqlôe3CﬁumnDeÁu…
(
Vdbe
 *, 
TabÀ
 *, , );

12315 
SQLITE_PRIVATE
 
	`sqlôe3A…îFöishAddCﬁumn
(
P¨£
 *, 
Tokí
 *);

12316 
SQLITE_PRIVATE
 
	`sqlôe3A…îBegöAddCﬁumn
(
P¨£
 *, 
SrcLi°
 *);

12317 
SQLITE_PRIVATE
 
CﬁlSeq
 *
	`sqlôe3GëCﬁlSeq
(
P¨£
*, 
u8
, CollSeq *, const *);

12318 
SQLITE_PRIVATE
 
	`sqlôe3AfföôyTy≥
(c⁄° *, 
u8
*);

12319 
SQLITE_PRIVATE
 
	`sqlôe3A«lyze
(
P¨£
*, 
Tokí
*, Token*);

12320 
SQLITE_PRIVATE
 
	`sqlôe3InvokeBusyH™dÀr
(
BusyH™dÀr
*);

12321 
SQLITE_PRIVATE
 
	`sqlôe3FödDb
(
sqlôe3
*, 
Tokí
*);

12322 
SQLITE_PRIVATE
 
	`sqlôe3FödDbName
(
sqlôe3
 *, const *);

12323 
SQLITE_PRIVATE
 
	`sqlôe3A«lysisLﬂd
(
sqlôe3
*,
iDB
);

12324 
SQLITE_PRIVATE
 
	`sqlôe3DñëeIndexSam∂es
(
sqlôe3
*,
Index
*);

12325 
SQLITE_PRIVATE
 
	`sqlôe3DeÁu…RowE°
(
Index
*);

12326 
SQLITE_PRIVATE
 
	`sqlôe3Regi°îLikeFun˘i⁄s
(
sqlôe3
*, );

12327 
SQLITE_PRIVATE
 
	`sqlôe3IsLikeFun˘i⁄
(
sqlôe3
*,
Ex¥
*,*,*);

12328 
SQLITE_PRIVATE
 
	`sqlôe3MöimumFûeF‹m©
(
P¨£
*, , );

12329 
SQLITE_PRIVATE
 
	`sqlôe3SchemaCÀ¨
(*);

12330 
SQLITE_PRIVATE
 
Schema
 *
	`sqlôe3SchemaGë
(
sqlôe3
 *, 
Båì
 *);

12331 
SQLITE_PRIVATE
 
	`sqlôe3SchemaToIndex
(
sqlôe3
 *
db
, 
Schema
 *);

12332 
SQLITE_PRIVATE
 
KeyInfo
 *
	`sqlôe3KeyInfoAŒoc
(
sqlôe3
*,);

12333 
SQLITE_PRIVATE
 
KeyInfo
 *
	`sqlôe3IndexKeyöfo
(
P¨£
 *, 
Index
 *);

12334 
SQLITE_PRIVATE
 
	`sqlôe3Cª©eFunc
(
sqlôe3
 *, const *, , , *,

12335 (*)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
 **),

12336 (*)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
 **), (*)(sqlite3_context*),

12337 
FuncDe°ru˘‹
 *
pDe°ru˘‹


12339 
SQLITE_PRIVATE
 
	`sqlôe3ApiExô
(
sqlôe3
 *
db
, );

12340 
SQLITE_PRIVATE
 
	`sqlôe3O≥nTempD©aba£
(
P¨£
 *);

12342 
SQLITE_PRIVATE
 
	`sqlôe3SåAccumInô
(
SåAccum
*, *, , );

12343 
SQLITE_PRIVATE
 
	`sqlôe3SåAccumAµíd
(
SåAccum
*,const *,);

12344 
SQLITE_PRIVATE
 
	`sqlôe3AµídS∑˚
(
SåAccum
*,);

12345 
SQLITE_PRIVATE
 *
	`sqlôe3SåAccumFöish
(
SåAccum
*);

12346 
SQLITE_PRIVATE
 
	`sqlôe3SåAccumRe£t
(
SåAccum
*);

12347 
SQLITE_PRIVATE
 
	`sqlôe3Sñe˘De°Inô
(
Sñe˘De°
*,,);

12348 
SQLITE_PRIVATE
 
Ex¥
 *
	`sqlôe3Cª©eCﬁumnEx¥
(
sqlôe3
 *, 
SrcLi°
 *, , );

12350 
SQLITE_PRIVATE
 
	`sqlôe3BackupRe°¨t
(
sqlôe3_backup
 *);

12351 
SQLITE_PRIVATE
 
	`sqlôe3BackupUpd©e
(
sqlôe3_backup
 *, 
Pgno
, c⁄° 
u8
 *);

12353 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


12354 
SQLITE_PRIVATE
 
	`sqlôe3A«lyzeFun˘i⁄s
();

12355 
SQLITE_PRIVATE
 
	`sqlôe3Sèt4ProbeSëVÆue
(
P¨£
*,
Index
*,
U≈ackedRec‹d
**,
Ex¥
*,
u8
,,*);

12356 
SQLITE_PRIVATE
 
	`sqlôe3Sèt4ProbeFªe
(
U≈ackedRec‹d
*);

12362 
SQLITE_PRIVATE
 *
	`sqlôe3P¨£rAŒoc
(*(*)(
size_t
));

12363 
SQLITE_PRIVATE
 
	`sqlôe3P¨£rFªe
(*, (*)(*));

12364 
SQLITE_PRIVATE
 
	`sqlôe3P¨£r
(*, , 
Tokí
, 
P¨£
*);

12365 #ifde‡
YYTRACKMAXSTACKDEPTH


12366 
SQLITE_PRIVATE
 
	`sqlôe3P¨£rSèckPók
(*);

12369 
SQLITE_PRIVATE
 
	`sqlôe3AutoLﬂdExãnsi⁄s
(
sqlôe3
*);

12370 #i‚de‡
SQLITE_OMIT_LOAD_EXTENSION


12371 
SQLITE_PRIVATE
 
	`sqlôe3Clo£Exãnsi⁄s
(
sqlôe3
*);

12373 
	#sqlôe3Clo£Exãnsi⁄s
(
X
)

	)

12376 #i‚de‡
SQLITE_OMIT_SHARED_CACHE


12377 
SQLITE_PRIVATE
 
	`sqlôe3TabÀLock
(
P¨£
 *, , , 
u8
, const *);

12379 
	#sqlôe3TabÀLock
(
v
,
w
,
x
,
y
,
z
)

	)

12382 #ifde‡
SQLITE_TEST


12383 
SQLITE_PRIVATE
 
	`sqlôe3Utf8To8
(*);

12386 #ifde‡
SQLITE_OMIT_VIRTUALTABLE


12387 
	#sqlôe3VèbCÀ¨
(
Y
)

	)

12388 
	#sqlôe3VèbSync
(
X
,
Y
Ë
SQLITE_OK


	)

12389 
	#sqlôe3VèbRﬁlback
(
X
)

	)

12390 
	#sqlôe3VèbCommô
(
X
)

	)

12391 
	#sqlôe3VèbInSync
(
db
Ë0

	)

12392 
	#sqlôe3VèbLock
(
X
)

	)

12393 
	#sqlôe3VèbU∆ock
(
X
)

	)

12394 
	#sqlôe3VèbU∆ockLi°
(
X
)

	)

12395 
	#sqlôe3VèbSavïoöt
(
X
, 
Y
, 
Z
Ë
SQLITE_OK


	)

12396 
	#sqlôe3GëVTabÀ
(
X
,
Y
Ë((
VTabÀ
*)0)

	)

12398 
SQLITE_PRIVATE
 
	`sqlôe3VèbCÀ¨
(
sqlôe3
 *
db
, 
TabÀ
*);

12399 
SQLITE_PRIVATE
 
	`sqlôe3VèbDisc⁄√˘
(
sqlôe3
 *
db
, 
TabÀ
 *
p
);

12400 
SQLITE_PRIVATE
 
	`sqlôe3VèbSync
(
sqlôe3
 *
db
, 
Vdbe
*);

12401 
SQLITE_PRIVATE
 
	`sqlôe3VèbRﬁlback
(
sqlôe3
 *
db
);

12402 
SQLITE_PRIVATE
 
	`sqlôe3VèbCommô
(
sqlôe3
 *
db
);

12403 
SQLITE_PRIVATE
 
	`sqlôe3VèbLock
(
VTabÀ
 *);

12404 
SQLITE_PRIVATE
 
	`sqlôe3VèbU∆ock
(
VTabÀ
 *);

12405 
SQLITE_PRIVATE
 
	`sqlôe3VèbU∆ockLi°
(
sqlôe3
*);

12406 
SQLITE_PRIVATE
 
	`sqlôe3VèbSavïoöt
(
sqlôe3
 *, , );

12407 
SQLITE_PRIVATE
 
	`sqlôe3VèbImp‹tEºmsg
(
Vdbe
*, 
sqlôe3_vèb
*);

12408 
SQLITE_PRIVATE
 
VTabÀ
 *
	`sqlôe3GëVTabÀ
(
sqlôe3
*, 
TabÀ
*);

12409 
	#sqlôe3VèbInSync
(
db
Ë((db)->
nVTøns
>0 && (db)->
aVTøns
==0)

	)

12411 
SQLITE_PRIVATE
 
	`sqlôe3VèbMakeWrôabÀ
(
P¨£
*,
TabÀ
*);

12412 
SQLITE_PRIVATE
 
	`sqlôe3VèbBegöP¨£
(
P¨£
*, 
Tokí
*, Token*, Token*, );

12413 
SQLITE_PRIVATE
 
	`sqlôe3VèbFöishP¨£
(
P¨£
*, 
Tokí
*);

12414 
SQLITE_PRIVATE
 
	`sqlôe3VèbArgInô
(
P¨£
*);

12415 
SQLITE_PRIVATE
 
	`sqlôe3VèbArgExãnd
(
P¨£
*, 
Tokí
*);

12416 
SQLITE_PRIVATE
 
	`sqlôe3VèbCÆlCª©e
(
sqlôe3
*, , const *, **);

12417 
SQLITE_PRIVATE
 
	`sqlôe3VèbCÆlC⁄√˘
(
P¨£
*, 
TabÀ
*);

12418 
SQLITE_PRIVATE
 
	`sqlôe3VèbCÆlDe°roy
(
sqlôe3
*, , const *);

12419 
SQLITE_PRIVATE
 
	`sqlôe3VèbBegö
(
sqlôe3
 *, 
VTabÀ
 *);

12420 
SQLITE_PRIVATE
 
FuncDef
 *
	`sqlôe3VèbOvîlﬂdFun˘i⁄
(
sqlôe3
 *,FuncDef*, 
nArg
, 
Ex¥
*);

12421 
SQLITE_PRIVATE
 
	`sqlôe3InvÆidFun˘i⁄
(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
**);

12422 
SQLITE_PRIVATE
 
sqlôe3_öt64
 
	`sqlôe3StmtCuºítTime
(
sqlôe3_c⁄ãxt
*);

12423 
SQLITE_PRIVATE
 
	`sqlôe3VdbeP¨amëîIndex
(
Vdbe
*, const *, );

12424 
SQLITE_PRIVATE
 
	`sqlôe3Tøns„rBödögs
(
sqlôe3_°mt
 *, sqlite3_stmt *);

12425 
SQLITE_PRIVATE
 
	`sqlôe3Rïª∑ª
(
Vdbe
*);

12426 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥Li°CheckLígth
(
P¨£
*, 
Ex¥Li°
*, const *);

12427 
SQLITE_PRIVATE
 
CﬁlSeq
 *
	`sqlôe3Bö¨yCom∑ªCﬁlSeq
(
P¨£
 *, 
Ex¥
 *, Expr *);

12428 
SQLITE_PRIVATE
 
	`sqlôe3TempInMem‹y
(c⁄° 
sqlôe3
*);

12429 
SQLITE_PRIVATE
 c⁄° *
	`sqlôe3Jou∫ÆModíame
();

12430 #i‚de‡
SQLITE_OMIT_WAL


12431 
SQLITE_PRIVATE
 
	`sqlôe3Checkpoöt
(
sqlôe3
*, , , *, *);

12432 
SQLITE_PRIVATE
 
	`sqlôe3WÆDeÁu…Hook
(*,
sqlôe3
*,const *,);

12442 #i‡!
	`deföed
(
SQLITE_OMIT_FOREIGN_KEY
Ë&& !deföed(
SQLITE_OMIT_TRIGGER
)

12443 
SQLITE_PRIVATE
 
	`sqlôe3FkCheck
(
P¨£
*, 
TabÀ
*, , , *, );

12444 
SQLITE_PRIVATE
 
	`sqlôe3FkDr›TabÀ
(
P¨£
*, 
SrcLi°
 *, 
TabÀ
*);

12445 
SQLITE_PRIVATE
 
	`sqlôe3FkA˘i⁄s
(
P¨£
*, 
TabÀ
*, 
Ex¥Li°
*, , *, );

12446 
SQLITE_PRIVATE
 
	`sqlôe3FkRequúed
(
P¨£
*, 
TabÀ
*, *, );

12447 
SQLITE_PRIVATE
 
u32
 
	`sqlôe3FkOldmask
(
P¨£
*, 
TabÀ
*);

12448 
SQLITE_PRIVATE
 
FKey
 *
	`sqlôe3FkRe„ªn˚s
(
TabÀ
 *);

12450 
	#sqlôe3FkA˘i⁄s
(
a
,
b
,
c
,
d
,
e
,
f
)

	)

12451 
	#sqlôe3FkCheck
(
a
,
b
,
c
,
d
,
e
,
f
)

	)

12452 
	#sqlôe3FkDr›TabÀ
(
a
,
b
,
c
)

	)

12453 
	#sqlôe3FkOldmask
(
a
,
b
Ë0

	)

12454 
	#sqlôe3FkRequúed
(
a
,
b
,
c
,
d
Ë0

	)

12456 #i‚de‡
SQLITE_OMIT_FOREIGN_KEY


12457 
SQLITE_PRIVATE
 
	`sqlôe3FkDñëe
(
sqlôe3
 *, 
TabÀ
*);

12458 
SQLITE_PRIVATE
 
	`sqlôe3FkLoˇãIndex
(
P¨£
*,
TabÀ
*,
FKey
*,
Index
**,**);

12460 
	#sqlôe3FkDñëe
(
a
,
b
)

	)

12461 
	#sqlôe3FkLoˇãIndex
(
a
,
b
,
c
,
d
,
e
)

	)

12468 
	#SQLITE_FAULTINJECTOR_MALLOC
 0

	)

12469 
	#SQLITE_FAULTINJECTOR_COUNT
 1

	)

12476 #i‚de‡
SQLITE_OMIT_BUILTIN_TEST


12477 
SQLITE_PRIVATE
 
	`sqlôe3BegöBíignMÆloc
();

12478 
SQLITE_PRIVATE
 
	`sqlôe3EndBíignMÆloc
();

12480 
	#sqlôe3BegöBíignMÆloc
()

	)

12481 
	#sqlôe3EndBíignMÆloc
()

	)

12484 
	#IN_INDEX_ROWID
 1

	)

12485 
	#IN_INDEX_EPH
 2

	)

12486 
	#IN_INDEX_INDEX_ASC
 3

	)

12487 
	#IN_INDEX_INDEX_DESC
 4

	)

12488 
SQLITE_PRIVATE
 
	`sqlôe3FödInIndex
(
P¨£
 *, 
Ex¥
 *, *);

12490 #ifde‡
SQLITE_ENABLE_ATOMIC_WRITE


12491 
SQLITE_PRIVATE
 
	`sqlôe3Jou∫ÆO≥n
(
sqlôe3_vfs
 *, c⁄° *, 
sqlôe3_fûe
 *, , );

12492 
SQLITE_PRIVATE
 
	`sqlôe3Jou∫ÆSize
(
sqlôe3_vfs
 *);

12493 
SQLITE_PRIVATE
 
	`sqlôe3Jou∫ÆCª©e
(
sqlôe3_fûe
 *);

12494 
SQLITE_PRIVATE
 
	`sqlôe3Jou∫ÆExi°s
(
sqlôe3_fûe
 *
p
);

12496 
	#sqlôe3Jou∫ÆSize
(
pVfs
Ë(’Vfs)->
szOsFûe
)

	)

12497 
	#sqlôe3Jou∫ÆExi°s
(
p
Ë1

	)

12500 
SQLITE_PRIVATE
 
	`sqlôe3MemJou∫ÆO≥n
(
sqlôe3_fûe
 *);

12501 
SQLITE_PRIVATE
 
	`sqlôe3MemJou∫ÆSize
();

12502 
SQLITE_PRIVATE
 
	`sqlôe3IsMemJou∫Æ
(
sqlôe3_fûe
 *);

12504 #i‡
SQLITE_MAX_EXPR_DEPTH
>0

12505 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥SëHeight
(
P¨£
 *
pP¨£
, 
Ex¥
 *
p
);

12506 
SQLITE_PRIVATE
 
	`sqlôe3Sñe˘Ex¥Height
(
Sñe˘
 *);

12507 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥CheckHeight
(
P¨£
*, );

12509 
	#sqlôe3Ex¥SëHeight
(
x
,
y
)

	)

12510 
	#sqlôe3Sñe˘Ex¥Height
(
x
Ë0

	)

12511 
	#sqlôe3Ex¥CheckHeight
(
x
,
y
)

	)

12514 
SQLITE_PRIVATE
 
u32
 
	`sqlôe3Gë4byã
(c⁄° 
u8
*);

12515 
SQLITE_PRIVATE
 
	`sqlôe3Put4byã
(
u8
*, 
u32
);

12517 #ifde‡
SQLITE_ENABLE_UNLOCK_NOTIFY


12518 
SQLITE_PRIVATE
 
	`sqlôe3C⁄√˘i⁄Blocked
(
sqlôe3
 *, sqlite3 *);

12519 
SQLITE_PRIVATE
 
	`sqlôe3C⁄√˘i⁄U∆ocked
(
sqlôe3
 *
db
);

12520 
SQLITE_PRIVATE
 
	`sqlôe3C⁄√˘i⁄Clo£d
(
sqlôe3
 *
db
);

12522 
	#sqlôe3C⁄√˘i⁄Blocked
(
x
,
y
)

	)

12523 
	#sqlôe3C⁄√˘i⁄U∆ocked
(
x
)

	)

12524 
	#sqlôe3C⁄√˘i⁄Clo£d
(
x
)

	)

12527 #ifde‡
SQLITE_DEBUG


12528 
SQLITE_PRIVATE
 
	`sqlôe3P¨£rTø˚
(
FILE
*, *);

12536 #ifde‡
SQLITE_ENABLE_IOTRACE


12537 
	#IOTRACE
(
A
Ëif–
sqlôe3IoTø˚
 ){ sqlôe3IoTø˚ A; 
	}

	)
}

12538 
SQLITE_PRIVATE
 
sqlôe3VdbeIOTø˚Sql
(
Vdbe
*);

12539 
SQLITE_PRIVATE
 (*
sqlôe3IoTø˚
)(const *,...);

12541 
	#IOTRACE
(
A
)

	)

12542 
	#sqlôe3VdbeIOTø˚Sql
(
X
)

	)

12573 #ifde‡
SQLITE_MEMDEBUG


12574 
SQLITE_PRIVATE
 
	`sqlôe3MemdebugSëTy≥
(*,
u8
);

12575 
SQLITE_PRIVATE
 
	`sqlôe3MemdebugHasTy≥
(*,
u8
);

12576 
SQLITE_PRIVATE
 
	`sqlôe3MemdebugNoTy≥
(*,
u8
);

12578 
	#sqlôe3MemdebugSëTy≥
(
X
,
Y
Ë

	)

12579 
	#sqlôe3MemdebugHasTy≥
(
X
,
Y
Ë1

	)

12580 
	#sqlôe3MemdebugNoTy≥
(
X
,
Y
Ë1

	)

12582 
	#MEMTYPE_HEAP
 0x01

	)

12583 
	#MEMTYPE_LOOKASIDE
 0x02

	)

12584 
	#MEMTYPE_SCRATCH
 0x04

	)

12585 
	#MEMTYPE_PCACHE
 0x08

	)

12586 
	#MEMTYPE_DB
 0x10

	)

12614 
SQLITE_PRIVATE
 c⁄° 
sqlôe3UµîToLowî
[] = {

12615 #ifde‡
SQLITE_ASCII


12632 #ifde‡
SQLITE_EBCDIC


12682 #ifde‡
SQLITE_ASCII


12683 
SQLITE_PRIVATE
 c⁄° 
sqlôe3Cty≥M≠
[256] = {

12722 #i‚de‡
SQLITE_USE_URI


12723 
	#SQLITE_USE_URI
 0

	)

12726 #i‚de‡
SQLITE_ALLOW_COVERING_INDEX_SCAN


12727 
	#SQLITE_ALLOW_COVERING_INDEX_SCAN
 1

	)

12734 
SQLITE_PRIVATE
 
SQLITE_WSD
 
Sqlôe3C⁄fig
 
sqlôe3C⁄fig
 = {

12735 
SQLITE_DEFAULT_MEMSTATUS
,

12737 
SQLITE_THREADSAFE
==1,

12738 
SQLITE_USE_URI
,

12739 
SQLITE_ALLOW_COVERING_INDEX_SCAN
,

12749 
SQLITE_DEFAULT_MMAP_SIZE
,

12750 
SQLITE_MAX_MMAP_SIZE
,

12770 #ifde‡
SQLITE_ENABLE_SQLLOG


12782 
SQLITE_PRIVATE
 
SQLITE_WSD
 
FuncDefHash
 
sqlôe3GlobÆFun˘i⁄s
;

12787 
SQLITE_PRIVATE
 c⁄° 
Tokí
 
sqlôe3I¡Tokís
[] = {

12811 #i‚de‡
SQLITE_OMIT_WSD


12812 
SQLITE_PRIVATE
 
sqlôe3PídögByã
 = 0x40000000;

12821 
SQLITE_PRIVATE
 c⁄° 
sqlôe3OpcodePr›îty
[] = 
OPFLG_INITIALIZER
;

12841 #i‚de‡
SQLITE_OMIT_COMPILEOPTION_DIAGS


12852 c⁄° * c⁄° 
azCompûeO±
[] = {

12856 
	#CTIMEOPT_VAL_
(
›t
Ë#›t

	)

12857 
	#CTIMEOPT_VAL
(
›t
Ë
	`CTIMEOPT_VAL_
(›t)

	)

12859 #ifde‡
SQLITE_32BIT_ROWID


12862 #ifde‡
SQLITE_4_BYTE_ALIGNED_MALLOC


12865 #ifde‡
SQLITE_CASE_SENSITIVE_LIKE


12868 #ifde‡
SQLITE_CHECK_PAGES


12871 #ifde‡
SQLITE_COVERAGE_TEST


12874 #ifde‡
SQLITE_DEBUG


12877 #ifde‡
SQLITE_DEFAULT_LOCKING_MODE


12878 "DEFAULT_LOCKING_MODE=" 
	`CTIMEOPT_VAL
(
SQLITE_DEFAULT_LOCKING_MODE
),

12880 #i‡
	`deföed
(
SQLITE_DEFAULT_MMAP_SIZE
Ë&& !deföed(
SQLITE_DEFAULT_MMAP_SIZE_xc
)

12881 "DEFAULT_MMAP_SIZE=" 
	`CTIMEOPT_VAL
(
SQLITE_DEFAULT_MMAP_SIZE
),

12883 #ifde‡
SQLITE_DISABLE_DIRSYNC


12886 #ifde‡
SQLITE_DISABLE_LFS


12889 #ifde‡
SQLITE_ENABLE_ATOMIC_WRITE


12892 #ifde‡
SQLITE_ENABLE_CEROD


12895 #ifde‡
SQLITE_ENABLE_COLUMN_METADATA


12898 #ifde‡
SQLITE_ENABLE_EXPENSIVE_ASSERT


12901 #ifde‡
SQLITE_ENABLE_FTS1


12904 #ifde‡
SQLITE_ENABLE_FTS2


12907 #ifde‡
SQLITE_ENABLE_FTS3


12910 #ifde‡
SQLITE_ENABLE_FTS3_PARENTHESIS


12913 #ifde‡
SQLITE_ENABLE_FTS4


12916 #ifde‡
SQLITE_ENABLE_ICU


12919 #ifde‡
SQLITE_ENABLE_IOTRACE


12922 #ifde‡
SQLITE_ENABLE_LOAD_EXTENSION


12925 #ifde‡
SQLITE_ENABLE_LOCKING_STYLE


12926 "ENABLE_LOCKING_STYLE=" 
	`CTIMEOPT_VAL
(
SQLITE_ENABLE_LOCKING_STYLE
),

12928 #ifde‡
SQLITE_ENABLE_MEMORY_MANAGEMENT


12931 #ifde‡
SQLITE_ENABLE_MEMSYS3


12934 #ifde‡
SQLITE_ENABLE_MEMSYS5


12937 #ifde‡
SQLITE_ENABLE_OVERSIZE_CELL_CHECK


12940 #ifde‡
SQLITE_ENABLE_RTREE


12943 #i‡
	`deföed
(
SQLITE_ENABLE_STAT4
)

12945 #ñi‡
	`deföed
(
SQLITE_ENABLE_STAT3
)

12948 #ifde‡
SQLITE_ENABLE_UNLOCK_NOTIFY


12951 #ifde‡
SQLITE_ENABLE_UPDATE_DELETE_LIMIT


12954 #ifde‡
SQLITE_HAS_CODEC


12957 #ifde‡
SQLITE_HAVE_ISNAN


12960 #ifde‡
SQLITE_HOMEGROWN_RECURSIVE_MUTEX


12963 #ifde‡
SQLITE_IGNORE_AFP_LOCK_ERRORS


12966 #ifde‡
SQLITE_IGNORE_FLOCK_LOCK_ERRORS


12969 #ifde‡
SQLITE_INT64_TYPE


12972 #ifde‡
SQLITE_LOCK_TRACE


12975 #i‡
	`deföed
(
SQLITE_MAX_MMAP_SIZE
Ë&& !deföed(
SQLITE_MAX_MMAP_SIZE_xc
)

12976 "MAX_MMAP_SIZE=" 
	`CTIMEOPT_VAL
(
SQLITE_MAX_MMAP_SIZE
),

12978 #ifde‡
SQLITE_MAX_SCHEMA_RETRY


12979 "MAX_SCHEMA_RETRY=" 
	`CTIMEOPT_VAL
(
SQLITE_MAX_SCHEMA_RETRY
),

12981 #ifde‡
SQLITE_MEMDEBUG


12984 #ifde‡
SQLITE_MIXED_ENDIAN_64BIT_FLOAT


12987 #ifde‡
SQLITE_NO_SYNC


12990 #ifde‡
SQLITE_OMIT_ALTERTABLE


12993 #ifde‡
SQLITE_OMIT_ANALYZE


12996 #ifde‡
SQLITE_OMIT_ATTACH


12999 #ifde‡
SQLITE_OMIT_AUTHORIZATION


13002 #ifde‡
SQLITE_OMIT_AUTOINCREMENT


13005 #ifde‡
SQLITE_OMIT_AUTOINIT


13008 #ifde‡
SQLITE_OMIT_AUTOMATIC_INDEX


13011 #ifde‡
SQLITE_OMIT_AUTORESET


13014 #ifde‡
SQLITE_OMIT_AUTOVACUUM


13017 #ifde‡
SQLITE_OMIT_BETWEEN_OPTIMIZATION


13020 #ifde‡
SQLITE_OMIT_BLOB_LITERAL


13023 #ifde‡
SQLITE_OMIT_BTREECOUNT


13026 #ifde‡
SQLITE_OMIT_BUILTIN_TEST


13029 #ifde‡
SQLITE_OMIT_CAST


13032 #ifde‡
SQLITE_OMIT_CHECK


13035 #ifde‡
SQLITE_OMIT_COMPLETE


13038 #ifde‡
SQLITE_OMIT_COMPOUND_SELECT


13041 #ifde‡
SQLITE_OMIT_DATETIME_FUNCS


13044 #ifde‡
SQLITE_OMIT_DECLTYPE


13047 #ifde‡
SQLITE_OMIT_DEPRECATED


13050 #ifde‡
SQLITE_OMIT_DISKIO


13053 #ifde‡
SQLITE_OMIT_EXPLAIN


13056 #ifde‡
SQLITE_OMIT_FLAG_PRAGMAS


13059 #ifde‡
SQLITE_OMIT_FLOATING_POINT


13062 #ifde‡
SQLITE_OMIT_FOREIGN_KEY


13065 #ifde‡
SQLITE_OMIT_GET_TABLE


13068 #ifde‡
SQLITE_OMIT_INCRBLOB


13071 #ifde‡
SQLITE_OMIT_INTEGRITY_CHECK


13074 #ifde‡
SQLITE_OMIT_LIKE_OPTIMIZATION


13077 #ifde‡
SQLITE_OMIT_LOAD_EXTENSION


13080 #ifde‡
SQLITE_OMIT_LOCALTIME


13083 #ifde‡
SQLITE_OMIT_LOOKASIDE


13086 #ifde‡
SQLITE_OMIT_MEMORYDB


13089 #ifde‡
SQLITE_OMIT_OR_OPTIMIZATION


13092 #ifde‡
SQLITE_OMIT_PAGER_PRAGMAS


13095 #ifde‡
SQLITE_OMIT_PRAGMA


13098 #ifde‡
SQLITE_OMIT_PROGRESS_CALLBACK


13101 #ifde‡
SQLITE_OMIT_QUICKBALANCE


13104 #ifde‡
SQLITE_OMIT_REINDEX


13107 #ifde‡
SQLITE_OMIT_SCHEMA_PRAGMAS


13110 #ifde‡
SQLITE_OMIT_SCHEMA_VERSION_PRAGMAS


13113 #ifde‡
SQLITE_OMIT_SHARED_CACHE


13116 #ifde‡
SQLITE_OMIT_SUBQUERY


13119 #ifde‡
SQLITE_OMIT_TCL_VARIABLE


13122 #ifde‡
SQLITE_OMIT_TEMPDB


13125 #ifde‡
SQLITE_OMIT_TRACE


13128 #ifde‡
SQLITE_OMIT_TRIGGER


13131 #ifde‡
SQLITE_OMIT_TRUNCATE_OPTIMIZATION


13134 #ifde‡
SQLITE_OMIT_UTF16


13137 #ifde‡
SQLITE_OMIT_VACUUM


13140 #ifde‡
SQLITE_OMIT_VIEW


13143 #ifde‡
SQLITE_OMIT_VIRTUALTABLE


13146 #ifde‡
SQLITE_OMIT_WAL


13149 #ifde‡
SQLITE_OMIT_WSD


13152 #ifde‡
SQLITE_OMIT_XFER_OPT


13155 #ifde‡
SQLITE_PERFORMANCE_TRACE


13158 #ifde‡
SQLITE_PROXY_DEBUG


13161 #ifde‡
SQLITE_RTREE_INT_ONLY


13164 #ifde‡
SQLITE_SECURE_DELETE


13167 #ifde‡
SQLITE_SMALL_STACK


13170 #ifde‡
SQLITE_SOUNDEX


13173 #ifde‡
SQLITE_TCL


13176 #i‡
	`deföed
(
SQLITE_TEMP_STORE
Ë&& !deföed(
SQLITE_TEMP_STORE_xc
)

13177 "TEMP_STORE=" 
	`CTIMEOPT_VAL
(
SQLITE_TEMP_STORE
),

13179 #ifde‡
SQLITE_TEST


13182 #i‡
	`deföed
(
SQLITE_THREADSAFE
)

13183 "THREADSAFE=" 
	`CTIMEOPT_VAL
(
SQLITE_THREADSAFE
),

13185 #ifde‡
SQLITE_USE_ALLOCA


13188 #ifde‡
SQLITE_ZERO_MALLOC


13200 
SQLITE_API
 
	`sqlôe3_compûe›ti⁄_u£d
(c⁄° *
zO±Name
){

13201 
i
, 
n
;

13202 if–
	`sqlôe3SåNICmp
(
zO±Name
, "SQLITE_", 7)==0 ) zOptName += 7;

13203 
n
 = 
	`sqlôe3SåÀn30
(
zO±Name
);

13207 
i
=0; i<
	`AºaySize
(
azCompûeO±
); i++){

13208 if–
	`sqlôe3SåNICmp
(
zO±Name
, 
azCompûeO±
[
i
], 
n
)==0

13209 && 
sqlôe3Cty≥M≠
[()
azCompûeO±
[
i
][
n
]]==0

13221 
SQLITE_API
 c⁄° *
	`sqlôe3_compûe›ti⁄_gë
(
N
){

13222 if–
N
>=0 && N<
	`AºaySize
(
azCompûeO±
) ){

13223  
azCompûeO±
[
N
];

13266 #i‚de‡
_VDBEINT_H_


13267 
	#_VDBEINT_H_


	)

13273 #i‚de‡
SQLITE_MAX_SCHEMA_RETRY


13274 
	#SQLITE_MAX_SCHEMA_RETRY
 50

	)

13282 
VdbeOp
 
	tOp
;

13287 
	tBoﬁ
;

13290 
VdbeS‹ãr
 
	tVdbeS‹ãr
;

13293 
Ex∂aö
 
	tEx∂aö
;

13296 
AuxD©a
 
	tAuxD©a
;

13308 
	sVdbeCurs‹
 {

13309 
BtCurs‹
 *
pCurs‹
;

13310 
Båì
 *
pBt
;

13311 
KeyInfo
 *
pKeyInfo
;

13312 
iDb
;

13313 
p£udoTabÀReg
;

13314 
nFõld
;

13315 
Boﬁ
 
zî€d
;

13316 
Boﬁ
 
rowidIsVÆid
;

13317 
Boﬁ
 
©Fú°
;

13318 
Boﬁ
 
u£R™domRowid
;

13319 
Boﬁ
 
nuŒRow
;

13320 
Boﬁ
 
de„ºedMovëo
;

13321 
Boﬁ
 
isTabÀ
;

13322 
Boﬁ
 
isIndex
;

13323 
Boﬁ
 
isOrdîed
;

13324 
Boﬁ
 
isS‹ãr
;

13325 
Boﬁ
 
mu…iP£udo
;

13326 
sqlôe3_vèb_curs‹
 *
pVèbCurs‹
;

13327 c⁄° 
sqlôe3_moduÀ
 *
pModuÀ
;

13328 
i64
 
£qCou¡
;

13329 
i64
 
movëoT¨gë
;

13330 
i64
 
œ°Rowid
;

13331 
VdbeS‹ãr
 *
pS‹ãr
;

13335 
£ekResu…
;

13346 
u32
 
ˇcheSètus
;

13347 
∑ylﬂdSize
;

13348 
u32
 *
aTy≥
;

13349 
u32
 *
aOff£t
;

13350 
u8
 *
aRow
;

13352 
VdbeCurs‹
 
	tVdbeCurs‹
;

13375 
VdbeFøme
 
	tVdbeFøme
;

13376 
	sVdbeFøme
 {

13377 
Vdbe
 *
v
;

13378 
VdbeFøme
 *
pP¨ít
;

13379 
Op
 *
aOp
;

13380 
Mem
 *
aMem
;

13381 
u8
 *
aOn˚Fœg
;

13382 
VdbeCurs‹
 **
≠C§
;

13383 *
tokí
;

13384 
i64
 
œ°Rowid
;

13385 
nCurs‹
;

13386 
pc
;

13387 
nOp
;

13388 
nMem
;

13389 
nOn˚Fœg
;

13390 
nChûdMem
;

13391 
nChûdC§
;

13392 
nCh™ge
;

13395 
	#VdbeFømeMem
(
p
Ë((
Mem
 *)&((
u8
 *Ì)[
	`ROUND8
((
VdbeFøme
))])

	)

13400 
	#CACHE_STALE
 0

	)

13407 
	sMem
 {

13408 
sqlôe3
 *
db
;

13409 *
z
;

13410 
r
;

13412 
i64
 
i
;

13413 
nZîo
;

13414 
FuncDef
 *
pDef
;

13415 
RowSë
 *
pRowSë
;

13416 
VdbeFøme
 *
pFøme
;

13417 } 
u
;

13418 
n
;

13419 
u16
 
Êags
;

13420 
u8
 
ty≥
;

13421 
u8
 
íc
;

13422 #ifde‡
SQLITE_DEBUG


13423 
Mem
 *
pSc›yFrom
;

13424 *
pFûÀr
;

13426 (*
xDñ
)(*);

13427 *
zMÆloc
;

13442 
	#MEM_NuŒ
 0x0001

	)

13443 
	#MEM_Så
 0x0002

	)

13444 
	#MEM_I¡
 0x0004

	)

13445 
	#MEM_Ról
 0x0008

	)

13446 
	#MEM_Blob
 0x0010

	)

13447 
	#MEM_RowSë
 0x0020

	)

13448 
	#MEM_Føme
 0x0040

	)

13449 
	#MEM_InvÆid
 0x0080

	)

13450 
	#MEM_CÀ¨ed
 0x0100

	)

13451 
	#MEM_Ty≥Mask
 0x01f‡

	)

13459 
	#MEM_Tîm
 0x0200

	)

13460 
	#MEM_Dyn
 0x0400

	)

13461 
	#MEM_Sètic
 0x0800

	)

13462 
	#MEM_Ephem
 0x1000

	)

13463 
	#MEM_Agg
 0x2000

	)

13464 
	#MEM_Zîo
 0x4000

	)

13465 #ifde‡
SQLITE_OMIT_INCRBLOB


13466 #unde‡
MEM_Zîo


13467 
	#MEM_Zîo
 0x0000

	)

13473 
	#MemSëTy≥Fœg
(
p
, 
f
) \

13474 ((
p
)->
Êags
 = (’)->Êags&~(
MEM_Ty≥Mask
|
MEM_Zîo
))|
f
)

	)

13480 #ifde‡
SQLITE_DEBUG


13481 
	#memIsVÆid
(
M
Ë((M)->
Êags
 & 
MEM_InvÆid
)==0

	)

13491 
	sAuxD©a
 {

13492 
iOp
;

13493 
iArg
;

13494 *
pAux
;

13495 (*
xDñëe
)(*);

13496 
AuxD©a
 *
pNext
;

13512 
	ssqlôe3_c⁄ãxt
 {

13513 
FuncDef
 *
pFunc
;

13514 
Mem
 
s
;

13515 
Mem
 *
pMem
;

13516 
CﬁlSeq
 *
pCﬁl
;

13517 
Vdbe
 *
pVdbe
;

13518 
iOp
;

13519 
isEº‹
;

13520 
u8
 
skùFœg
;

13521 
u8
 
fEº‹OrAux
;

13528 
	sEx∂aö
 {

13529 
Vdbe
 *
pVdbe
;

13530 
SåAccum
 
°r
;

13531 
nIndít
;

13532 
u16
 
aIndít
[100];

13533 
zBa£
[100];

13539 
	tb·
;

13556 
	sVdbe
 {

13557 
sqlôe3
 *
db
;

13558 
Op
 *
aOp
;

13559 
Mem
 *
aMem
;

13560 
Mem
 **
≠Arg
;

13561 
Mem
 *
aCﬁName
;

13562 
Mem
 *
pResu…Së
;

13563 
nMem
;

13564 
nOp
;

13565 
nOpAŒoc
;

13566 
nLabñ
;

13567 *
aLabñ
;

13568 
u16
 
nResCﬁumn
;

13569 
nCurs‹
;

13570 
u32
 
magic
;

13571 *
zEºMsg
;

13572 
Vdbe
 *
pPªv
,*
pNext
;

13573 
VdbeCurs‹
 **
≠C§
;

13574 
Mem
 *
aV¨
;

13575 **
azV¨
;

13576 
ynV¨
 
nV¨
;

13577 
ynV¨
 
nzV¨
;

13578 
u32
 
ˇcheCå
;

13579 
pc
;

13580 
rc
;

13581 
u8
 
îr‹A˘i⁄
;

13582 
u8
 
möWrôeFûeF‹m©
;

13583 
b·
 
ex∂aö
:2;

13584 
b·
 
öVèbMëhod
:2;

13585 
b·
 
ch™geC¡On
:1;

13586 
b·
 
expúed
:1;

13587 
b·
 
runO∆yOn˚
:1;

13588 
b·
 
u£sStmtJou∫Æ
:1;

13589 
b·
 
ªadO∆y
:1;

13590 
b·
 
bIsRódî
:1;

13591 
b·
 
isPª∑ªV2
:1;

13592 
b·
 
doögRîun
:1;

13593 
nCh™ge
;

13594 
yDbMask
 
båìMask
;

13595 
yDbMask
 
lockMask
;

13596 
iSèãmít
;

13597 
u32
 
aCou¡î
[5];

13598 #i‚de‡
SQLITE_OMIT_TRACE


13599 
i64
 
°¨tTime
;

13601 
i64
 
iCuºítTime
;

13602 
i64
 
nFkC⁄°øöt
;

13603 
i64
 
nStmtDefC⁄s
;

13604 
i64
 
nStmtDefImmC⁄s
;

13605 *
zSql
;

13606 *
pFªe
;

13607 #ifde‡
SQLITE_DEBUG


13608 
FILE
 *
åa˚
;

13610 #ifde‡
SQLITE_ENABLE_TREE_EXPLAIN


13611 
Ex∂aö
 *
pEx∂aö
;

13612 *
zEx∂aö
;

13614 
VdbeFøme
 *
pFøme
;

13615 
VdbeFøme
 *
pDñFøme
;

13616 
nFøme
;

13617 
u32
 
expmask
;

13618 
SubProgøm
 *
pProgøm
;

13619 
nOn˚Fœg
;

13620 
u8
 *
aOn˚Fœg
;

13621 
AuxD©a
 *
pAuxD©a
;

13627 
	#VDBE_MAGIC_INIT
 0x26b˚Ø5

	)

13628 
	#VDBE_MAGIC_RUN
 0xbdf20da3

	)

13629 
	#VDBE_MAGIC_HALT
 0x519c2973

	)

13630 
	#VDBE_MAGIC_DEAD
 0xb606c3c8

	)

13635 
SQLITE_PRIVATE
 
	`sqlôe3VdbeFªeCurs‹
(
Vdbe
 *, 
VdbeCurs‹
*);

13636 
	`sqlôeVdbeP›Sèck
(
Vdbe
*,);

13637 
SQLITE_PRIVATE
 
	`sqlôe3VdbeCurs‹Movëo
(
VdbeCurs‹
*);

13638 #i‡
	`deföed
(
SQLITE_DEBUG
Ë|| deföed(
VDBE_PROFILE
)

13639 
SQLITE_PRIVATE
 
	`sqlôe3VdbePrötOp
(
FILE
*, , 
Op
*);

13641 
SQLITE_PRIVATE
 
u32
 
	`sqlôe3VdbeSîülTy≥Lí
(u32);

13642 
SQLITE_PRIVATE
 
u32
 
	`sqlôe3VdbeSîülTy≥
(
Mem
*, );

13643 
SQLITE_PRIVATE
 
u32
 
	`sqlôe3VdbeSîülPut
(*, , 
Mem
*, );

13644 
SQLITE_PRIVATE
 
u32
 
	`sqlôe3VdbeSîülGë
(c⁄° *, u32, 
Mem
*);

13645 
SQLITE_PRIVATE
 
	`sqlôe3VdbeDñëeAuxD©a
(
Vdbe
*, , );

13647 
	`sqlôe2BåìKeyCom∑ª
(
BtCurs‹
 *, const *, , , *);

13648 
SQLITE_PRIVATE
 
	`sqlôe3VdbeIdxKeyCom∑ª
(
VdbeCurs‹
*,
U≈ackedRec‹d
*,*);

13649 
SQLITE_PRIVATE
 
	`sqlôe3VdbeIdxRowid
(
sqlôe3
*, 
BtCurs‹
 *, 
i64
 *);

13650 
SQLITE_PRIVATE
 
	`sqlôe3MemCom∑ª
(c⁄° 
Mem
*, c⁄° Mem*, c⁄° 
CﬁlSeq
*);

13651 
SQLITE_PRIVATE
 
	`sqlôe3VdbeExec
(
Vdbe
*);

13652 
SQLITE_PRIVATE
 
	`sqlôe3VdbeLi°
(
Vdbe
*);

13653 
SQLITE_PRIVATE
 
	`sqlôe3VdbeHÆt
(
Vdbe
*);

13654 
SQLITE_PRIVATE
 
	`sqlôe3VdbeCh™geEncodög
(
Mem
 *, );

13655 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemTooBig
(
Mem
*);

13656 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemC›y
(
Mem
*, const Mem*);

13657 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemShÆlowC›y
(
Mem
*, const Mem*, );

13658 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemMove
(
Mem
*, Mem*);

13659 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemNulTîmö©e
(
Mem
*);

13660 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemSëSå
(
Mem
*, c⁄° *, , 
u8
, (*)(*));

13661 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemSëI¡64
(
Mem
*, 
i64
);

13662 #ifde‡
SQLITE_OMIT_FLOATING_POINT


13663 
	#sqlôe3VdbeMemSëDoubÀ
 
sqlôe3VdbeMemSëI¡64


	)

13665 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemSëDoubÀ
(
Mem
*, );

13667 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemSëNuŒ
(
Mem
*);

13668 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemSëZîoBlob
(
Mem
*,);

13669 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemSëRowSë
(
Mem
*);

13670 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemMakeWrôóbÀ
(
Mem
*);

13671 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemSåögify
(
Mem
*, );

13672 
SQLITE_PRIVATE
 
i64
 
	`sqlôe3VdbeI¡VÆue
(
Mem
*);

13673 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemI¡egîify
(
Mem
*);

13674 
SQLITE_PRIVATE
 
	`sqlôe3VdbeRólVÆue
(
Mem
*);

13675 
SQLITE_PRIVATE
 
	`sqlôe3VdbeI¡egîAfföôy
(
Mem
*);

13676 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemRólify
(
Mem
*);

13677 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemNumîify
(
Mem
*);

13678 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemFromBåì
(
BtCurs‹
*,,,,
Mem
*);

13679 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemRñó£
(
Mem
 *
p
);

13680 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemRñó£Exã∫Æ
(
Mem
 *
p
);

13681 
	#VdbeMemRñó£
(
X
) \

13682 if((
X
)->
Êags
&(
MEM_Agg
|
MEM_Dyn
|
MEM_RowSë
|
MEM_Føme
)) \

13683 
	`sqlôe3VdbeMemRñó£Exã∫Æ
(
X
);

	)

13684 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemFöÆize
(
Mem
*, 
FuncDef
*);

13685 
SQLITE_PRIVATE
 c⁄° *
	`sqlôe3OpcodeName
();

13686 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemGrow
(
Mem
 *
pMem
, 
n
, 
¥e£rve
);

13687 
SQLITE_PRIVATE
 
	`sqlôe3VdbeClo£Sèãmít
(
Vdbe
 *, );

13688 
SQLITE_PRIVATE
 
	`sqlôe3VdbeFømeDñëe
(
VdbeFøme
*);

13689 
SQLITE_PRIVATE
 
	`sqlôe3VdbeFømeRe°‹e
(
VdbeFøme
 *);

13690 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemSt‹eTy≥
(
Mem
 *
pMem
);

13691 
SQLITE_PRIVATE
 
	`sqlôe3VdbeTøns„rEº‹
(
Vdbe
 *
p
);

13693 
SQLITE_PRIVATE
 
	`sqlôe3VdbeS‹ãrInô
(
sqlôe3
 *, 
VdbeCurs‹
 *);

13694 
SQLITE_PRIVATE
 
	`sqlôe3VdbeS‹ãrClo£
(
sqlôe3
 *, 
VdbeCurs‹
 *);

13695 
SQLITE_PRIVATE
 
	`sqlôe3VdbeS‹ãrRowkey
(c⁄° 
VdbeCurs‹
 *, 
Mem
 *);

13696 
SQLITE_PRIVATE
 
	`sqlôe3VdbeS‹ãrNext
(
sqlôe3
 *, c⁄° 
VdbeCurs‹
 *, *);

13697 
SQLITE_PRIVATE
 
	`sqlôe3VdbeS‹ãrRewöd
(
sqlôe3
 *, c⁄° 
VdbeCurs‹
 *, *);

13698 
SQLITE_PRIVATE
 
	`sqlôe3VdbeS‹ãrWrôe
(
sqlôe3
 *, c⁄° 
VdbeCurs‹
 *, 
Mem
 *);

13699 
SQLITE_PRIVATE
 
	`sqlôe3VdbeS‹ãrCom∑ª
(c⁄° 
VdbeCurs‹
 *, 
Mem
 *, *);

13701 #i‡!
	`deföed
(
SQLITE_OMIT_SHARED_CACHE
Ë&& 
SQLITE_THREADSAFE
>0

13702 
SQLITE_PRIVATE
 
	`sqlôe3VdbeE¡î
(
Vdbe
*);

13703 
SQLITE_PRIVATE
 
	`sqlôe3VdbeLóve
(
Vdbe
*);

13705 
	#sqlôe3VdbeE¡î
(
X
)

	)

13706 
	#sqlôe3VdbeLóve
(
X
)

	)

13709 #ifde‡
SQLITE_DEBUG


13710 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemAboutToCh™ge
(
Vdbe
*,
Mem
*);

13713 #i‚de‡
SQLITE_OMIT_FOREIGN_KEY


13714 
SQLITE_PRIVATE
 
	`sqlôe3VdbeCheckFk
(
Vdbe
 *, );

13716 
	#sqlôe3VdbeCheckFk
(
p
,
i
Ë0

	)

13719 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemTøn¶©e
(
Mem
*, 
u8
);

13720 #ifde‡
SQLITE_DEBUG


13721 
SQLITE_PRIVATE
 
	`sqlôe3VdbePrötSql
(
Vdbe
*);

13722 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemPªâyPröt
(
Mem
 *
pMem
, *
zBuf
);

13724 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemH™dÀBom
(
Mem
 *
pMem
);

13726 #i‚de‡
SQLITE_OMIT_INCRBLOB


13727 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemEx∑ndBlob
(
Mem
 *);

13728 
	#Ex∑ndBlob
(
P
Ë(((P)->
Êags
&
MEM_Zîo
)?
	`sqlôe3VdbeMemEx∑ndBlob
(P):0)

	)

13730 
	#sqlôe3VdbeMemEx∑ndBlob
(
x
Ë
SQLITE_OK


	)

13731 
	#Ex∑ndBlob
(
P
Ë
SQLITE_OK


	)

13742 
sqlôe3SètTy≥
 
	tsqlôe3SètTy≥
;

13743 
SQLITE_WSD
 
	ssqlôe3SètTy≥
 {

13744 
nowVÆue
[10];

13745 
mxVÆue
[10];

13746 } 
sqlôe3Sèt
 = { {0,}, {0,} };

13755 #ifde‡
SQLITE_OMIT_WSD


13756 
	#wsdSètInô
 
sqlôe3SètTy≥
 *
x
 = &
	`GLOBAL
(sqlôe3SètTy≥,
sqlôe3Sèt
)

	)

13757 
	#wsdSèt
 
x
[0]

	)

13759 
	#wsdSètInô


	)

13760 
	#wsdSèt
 
sqlôe3Sèt


	)

13766 
SQLITE_PRIVATE
 
	`sqlôe3SètusVÆue
(
›
){

13767 
wsdSètInô
;

13768 
	`as£π
–
›
>=0 && op<
	`AºaySize
(
wsdSèt
.
nowVÆue
) );

13769  
wsdSèt
.
nowVÆue
[
›
];

13776 
SQLITE_PRIVATE
 
	`sqlôe3SètusAdd
(
›
, 
N
){

13777 
wsdSètInô
;

13778 
	`as£π
–
›
>=0 && op<
	`AºaySize
(
wsdSèt
.
nowVÆue
) );

13779 
wsdSèt
.
nowVÆue
[
›
] +
N
;

13780 if–
wsdSèt
.
nowVÆue
[
›
]>wsdSèt.
mxVÆue
[op] ){

13781 
wsdSèt
.
mxVÆue
[
›
] = wsdSèt.
nowVÆue
[op];

13788 
SQLITE_PRIVATE
 
	`sqlôe3SètusSë
(
›
, 
X
){

13789 
wsdSètInô
;

13790 
	`as£π
–
›
>=0 && op<
	`AºaySize
(
wsdSèt
.
nowVÆue
) );

13791 
wsdSèt
.
nowVÆue
[
›
] = 
X
;

13792 if–
wsdSèt
.
nowVÆue
[
›
]>wsdSèt.
mxVÆue
[op] ){

13793 
wsdSèt
.
mxVÆue
[
›
] = wsdSèt.
nowVÆue
[op];

13804 
SQLITE_API
 
	`sqlôe3_°©us
(
›
, *
pCuºít
, *
pHighw©î
, 
ª£tFœg
){

13805 
wsdSètInô
;

13806 if–
›
<0 || op>=
	`AºaySize
(
wsdSèt
.
nowVÆue
) ){

13807  
SQLITE_MISUSE_BKPT
;

13809 *
pCuºít
 = 
wsdSèt
.
nowVÆue
[
›
];

13810 *
pHighw©î
 = 
wsdSèt
.
mxVÆue
[
›
];

13811 if–
ª£tFœg
 ){

13812 
wsdSèt
.
mxVÆue
[
›
] = wsdSèt.
nowVÆue
[op];

13814  
SQLITE_OK
;

13820 
SQLITE_API
 
	`sqlôe3_db_°©us
(

13821 
sqlôe3
 *
db
,

13822 
›
,

13823 *
pCuºít
,

13824 *
pHighw©î
,

13825 
ª£tFœg


13827 
rc
 = 
SQLITE_OK
;

13828 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

13829  
›
 ){

13830 
SQLITE_DBSTATUS_LOOKASIDE_USED
: {

13831 *
pCuºít
 = 
db
->
lookaside
.
nOut
;

13832 *
pHighw©î
 = 
db
->
lookaside
.
mxOut
;

13833 if–
ª£tFœg
 ){

13834 
db
->
lookaside
.
mxOut
 = db->lookaside.
nOut
;

13839 
SQLITE_DBSTATUS_LOOKASIDE_HIT
:

13840 
SQLITE_DBSTATUS_LOOKASIDE_MISS_SIZE
:

13841 
SQLITE_DBSTATUS_LOOKASIDE_MISS_FULL
: {

13842 
	`ã°ˇ£
–
›
==
SQLITE_DBSTATUS_LOOKASIDE_HIT
 );

13843 
	`ã°ˇ£
–
›
==
SQLITE_DBSTATUS_LOOKASIDE_MISS_SIZE
 );

13844 
	`ã°ˇ£
–
›
==
SQLITE_DBSTATUS_LOOKASIDE_MISS_FULL
 );

13845 
	`as£π
–(
›
-
SQLITE_DBSTATUS_LOOKASIDE_HIT
)>=0 );

13846 
	`as£π
–(
›
-
SQLITE_DBSTATUS_LOOKASIDE_HIT
)<3 );

13847 *
pCuºít
 = 0;

13848 *
pHighw©î
 = 
db
->
lookaside
.
™Sèt
[
›
 - 
SQLITE_DBSTATUS_LOOKASIDE_HIT
];

13849 if–
ª£tFœg
 ){

13850 
db
->
lookaside
.
™Sèt
[
›
 - 
SQLITE_DBSTATUS_LOOKASIDE_HIT
] = 0;

13860 
SQLITE_DBSTATUS_CACHE_USED
: {

13861 
tŸÆU£d
 = 0;

13862 
i
;

13863 
	`sqlôe3BåìE¡îAŒ
(
db
);

13864 
i
=0; i<
db
->
nDb
; i++){

13865 
Båì
 *
pBt
 = 
db
->
aDb
[
i
].pBt;

13866 if–
pBt
 ){

13867 
Pagî
 *
pPagî
 = 
	`sqlôe3BåìPagî
(
pBt
);

13868 
tŸÆU£d
 +
	`sqlôe3PagîMemU£d
(
pPagî
);

13871 
	`sqlôe3BåìLóveAŒ
(
db
);

13872 *
pCuºít
 = 
tŸÆU£d
;

13873 *
pHighw©î
 = 0;

13882 
SQLITE_DBSTATUS_SCHEMA_USED
: {

13883 
i
;

13884 
nByã
 = 0;

13886 
	`sqlôe3BåìE¡îAŒ
(
db
);

13887 
db
->
≤ByãsFªed
 = &
nByã
;

13888 
i
=0; i<
db
->
nDb
; i++){

13889 
Schema
 *
pSchema
 = 
db
->
aDb
[
i
].pSchema;

13890 if–
	`ALWAYS
(
pSchema
!=0) ){

13891 
HashEÀm
 *
p
;

13893 
nByã
 +
sqlôe3GlobÆC⁄fig
.
m
.
	`xRoundup
((
HashEÀm
)) * (

13894 
pSchema
->
tblHash
.
cou¡


13895 + 
pSchema
->
åigHash
.
cou¡


13896 + 
pSchema
->
idxHash
.
cou¡


13897 + 
pSchema
->
fkeyHash
.
cou¡


13899 
nByã
 +
	`sqlôe3MÆlocSize
(
pSchema
->
tblHash
.
ht
);

13900 
nByã
 +
	`sqlôe3MÆlocSize
(
pSchema
->
åigHash
.
ht
);

13901 
nByã
 +
	`sqlôe3MÆlocSize
(
pSchema
->
idxHash
.
ht
);

13902 
nByã
 +
	`sqlôe3MÆlocSize
(
pSchema
->
fkeyHash
.
ht
);

13904 
p
=
	`sqlôeHashFú°
(&
pSchema
->
åigHash
);Ö;Ö=
	`sqlôeHashNext
(p)){

13905 
	`sqlôe3DñëeTriggî
(
db
, (
Triggî
*)
	`sqlôeHashD©a
(
p
));

13907 
p
=
	`sqlôeHashFú°
(&
pSchema
->
tblHash
);Ö;Ö=
	`sqlôeHashNext
(p)){

13908 
	`sqlôe3DñëeTabÀ
(
db
, (
TabÀ
 *)
	`sqlôeHashD©a
(
p
));

13912 
db
->
≤ByãsFªed
 = 0;

13913 
	`sqlôe3BåìLóveAŒ
(
db
);

13915 *
pHighw©î
 = 0;

13916 *
pCuºít
 = 
nByã
;

13925 
SQLITE_DBSTATUS_STMT_USED
: {

13926 
Vdbe
 *
pVdbe
;

13927 
nByã
 = 0;

13929 
db
->
≤ByãsFªed
 = &
nByã
;

13930 
pVdbe
=
db
->pVdbe;ÖVdbe;ÖVdbeıVdbe->
pNext
){

13931 
	`sqlôe3VdbeCÀ¨Obje˘
(
db
, 
pVdbe
);

13932 
	`sqlôe3DbFªe
(
db
, 
pVdbe
);

13934 
db
->
≤ByãsFªed
 = 0;

13936 *
pHighw©î
 = 0;

13937 *
pCuºít
 = 
nByã
;

13947 
SQLITE_DBSTATUS_CACHE_HIT
:

13948 
SQLITE_DBSTATUS_CACHE_MISS
:

13949 
SQLITE_DBSTATUS_CACHE_WRITE
:{

13950 
i
;

13951 
nRë
 = 0;

13952 
	`as£π
–
SQLITE_DBSTATUS_CACHE_MISS
==
SQLITE_DBSTATUS_CACHE_HIT
+1 );

13953 
	`as£π
–
SQLITE_DBSTATUS_CACHE_WRITE
==
SQLITE_DBSTATUS_CACHE_HIT
+2 );

13955 
i
=0; i<
db
->
nDb
; i++){

13956 if–
db
->
aDb
[
i
].
pBt
 ){

13957 
Pagî
 *
pPagî
 = 
	`sqlôe3BåìPagî
(
db
->
aDb
[
i
].
pBt
);

13958 
	`sqlôe3PagîCacheSèt
(
pPagî
, 
›
, 
ª£tFœg
, &
nRë
);

13961 *
pHighw©î
 = 0;

13962 *
pCuºít
 = 
nRë
;

13970 
SQLITE_DBSTATUS_DEFERRED_FKS
: {

13971 *
pHighw©î
 = 0;

13972 *
pCuºít
 = 
db
->
nDe„ºedImmC⁄s
>0 || db->
nDe„ºedC⁄s
>0;

13977 
rc
 = 
SQLITE_ERROR
;

13980 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

13981  
rc
;

14033 
	~<time.h
>

14035 #i‚de‡
SQLITE_OMIT_DATETIME_FUNCS


14041 
D©eTime
 
	tD©eTime
;

14042 
	sD©eTime
 {

14043 
sqlôe3_öt64
 
iJD
;

14044 
Y
, 
M
, 
D
;

14045 
h
, 
m
;

14046 
tz
;

14047 
s
;

14048 
vÆidYMD
;

14049 
vÆidHMS
;

14050 
vÆidJD
;

14051 
vÆidTZ
;

14068 
	`gëDigôs
(c⁄° *
zD©e
, ...){

14069 
va_li°
 
≠
;

14070 
vÆ
;

14071 
N
;

14072 
mö
;

14073 
max
;

14074 
√xtC
;

14075 *
pVÆ
;

14076 
˙t
 = 0;

14077 
	`va_°¨t
(
≠
, 
zD©e
);

14079 
N
 = 
	`va_¨g
(
≠
, );

14080 
mö
 = 
	`va_¨g
(
≠
, );

14081 
max
 = 
	`va_¨g
(
≠
, );

14082 
√xtC
 = 
	`va_¨g
(
≠
, );

14083 
pVÆ
 = 
	`va_¨g
(
≠
, *);

14084 
vÆ
 = 0;

14085  
N
-- ){

14086 if–!
	`sqlôe3Isdigô
(*
zD©e
) ){

14087 
íd_gëDigôs
;

14089 
vÆ
 = vÆ*10 + *
zD©e
 - '0';

14090 
zD©e
++;

14092 if–
vÆ
<
mö
 || vÆ>
max
 || (
√xtC
!=0 &&ÇextC!=*
zD©e
) ){

14093 
íd_gëDigôs
;

14095 *
pVÆ
 = 
vÆ
;

14096 
zD©e
++;

14097 
˙t
++;

14098 } 
√xtC
 );

14099 
íd_gëDigôs
:

14100 
	`va_íd
(
≠
);

14101  
˙t
;

14120 
	`∑r£Timez⁄e
(c⁄° *
zD©e
, 
D©eTime
 *
p
){

14121 
sgn
 = 0;

14122 
nHr
, 
nMn
;

14123 
c
;

14124  
	`sqlôe3Is•a˚
(*
zD©e
) ){ zDate++; }

14125 
p
->
tz
 = 0;

14126 
c
 = *
zD©e
;

14127 if–
c
=='-' ){

14128 
sgn
 = -1;

14129 }if–
c
=='+' ){

14130 
sgn
 = +1;

14131 }if–
c
=='Z' || c=='z' ){

14132 
zD©e
++;

14133 
zulu_time
;

14135  
c
!=0;

14137 
zD©e
++;

14138 if–
	`gëDigôs
(
zD©e
, 2, 0, 14, ':', &
nHr
, 2, 0, 59, 0, &
nMn
)!=2 ){

14141 
zD©e
 += 5;

14142 
p
->
tz
 = 
sgn
*(
nMn
 + 
nHr
*60);

14143 
zulu_time
:

14144  
	`sqlôe3Is•a˚
(*
zD©e
) ){ zDate++; }

14145  *
zD©e
!=0;

14155 
	`∑r£HhMmSs
(c⁄° *
zD©e
, 
D©eTime
 *
p
){

14156 
h
, 
m
, 
s
;

14157 
ms
 = 0.0;

14158 if–
	`gëDigôs
(
zD©e
, 2, 0, 24, ':', &
h
, 2, 0, 59, 0, &
m
)!=2 ){

14161 
zD©e
 += 5;

14162 if–*
zD©e
==':' ){

14163 
zD©e
++;

14164 if–
	`gëDigôs
(
zD©e
, 2, 0, 59, 0, &
s
)!=1 ){

14167 
zD©e
 += 2;

14168 if–*
zD©e
=='.' && 
	`sqlôe3Isdigô
(zDate[1]) ){

14169 
rSˇÀ
 = 1.0;

14170 
zD©e
++;

14171  
	`sqlôe3Isdigô
(*
zD©e
) ){

14172 
ms
 = ms*10.0 + *
zD©e
 - '0';

14173 
rSˇÀ
 *= 10.0;

14174 
zD©e
++;

14176 
ms
 /
rSˇÀ
;

14179 
s
 = 0;

14181 
p
->
vÆidJD
 = 0;

14182 
p
->
vÆidHMS
 = 1;

14183 
p
->
h
 = h;

14184 
p
->
m
 = m;

14185 
p
->
s
 = s + 
ms
;

14186 if–
	`∑r£Timez⁄e
(
zD©e
, 
p
) )  1;

14187 
p
->
vÆidTZ
 = (p->
tz
!=0)?1:0;

14197 
	`compuãJD
(
D©eTime
 *
p
){

14198 
Y
, 
M
, 
D
, 
A
, 
B
, 
X1
, 
X2
;

14200 if–
p
->
vÆidJD
 ) ;

14201 if–
p
->
vÆidYMD
 ){

14202 
Y
 = 
p
->Y;

14203 
M
 = 
p
->M;

14204 
D
 = 
p
->D;

14206 
Y
 = 2000;

14207 
M
 = 1;

14208 
D
 = 1;

14210 if–
M
<=2 ){

14211 
Y
--;

14212 
M
 += 12;

14214 
A
 = 
Y
/100;

14215 
B
 = 2 - 
A
 + (A/4);

14216 
X1
 = 36525*(
Y
+4716)/100;

14217 
X2
 = 306001*(
M
+1)/10000;

14218 
p
->
iJD
 = (
sqlôe3_öt64
)((
X1
 + 
X2
 + 
D
 + 
B
 - 1524.5 ) * 86400000);

14219 
p
->
vÆidJD
 = 1;

14220 if–
p
->
vÆidHMS
 ){

14221 
p
->
iJD
 +p->
h
*3600000 +Ö->
m
*60000 + (
sqlôe3_öt64
)’->
s
*1000);

14222 if–
p
->
vÆidTZ
 ){

14223 
p
->
iJD
 -p->
tz
*60000;

14224 
p
->
vÆidYMD
 = 0;

14225 
p
->
vÆidHMS
 = 0;

14226 
p
->
vÆidTZ
 = 0;

14243 
	`∑r£YyyyMmDd
(c⁄° *
zD©e
, 
D©eTime
 *
p
){

14244 
Y
, 
M
, 
D
, 
√g
;

14246 if–
zD©e
[0]=='-' ){

14247 
zD©e
++;

14248 
√g
 = 1;

14250 
√g
 = 0;

14252 if–
	`gëDigôs
(
zD©e
,4,0,9999,'-',&
Y
,2,1,12,'-',&
M
,2,1,31,0,&
D
)!=3 ){

14255 
zD©e
 += 10;

14256  
	`sqlôe3Is•a˚
(*
zD©e
Ë|| 'T'==*(
u8
*)zDate ){ zDate++; }

14257 if–
	`∑r£HhMmSs
(
zD©e
, 
p
)==0 ){

14259 }if–*
zD©e
==0 ){

14260 
p
->
vÆidHMS
 = 0;

14264 
p
->
vÆidJD
 = 0;

14265 
p
->
vÆidYMD
 = 1;

14266 
p
->
Y
 = 
√g
 ? -Y : Y;

14267 
p
->
M
 = M;

14268 
p
->
D
 = D;

14269 if–
p
->
vÆidTZ
 ){

14270 
	`compuãJD
(
p
);

14280 
	`£tD©eTimeToCuºít
(
sqlôe3_c⁄ãxt
 *
c⁄ãxt
, 
D©eTime
 *
p
){

14281 
p
->
iJD
 = 
	`sqlôe3StmtCuºítTime
(
c⁄ãxt
);

14282 if–
p
->
iJD
>0 ){

14283 
p
->
vÆidJD
 = 1;

14306 
	`∑r£D©eOrTime
(

14307 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

14308 c⁄° *
zD©e
,

14309 
D©eTime
 *
p


14311 
r
;

14312 if–
	`∑r£YyyyMmDd
(
zD©e
,
p
)==0 ){

14314 }if–
	`∑r£HhMmSs
(
zD©e
, 
p
)==0 ){

14316 }if–
	`sqlôe3SåICmp
(
zD©e
,"now")==0){

14317  
	`£tD©eTimeToCuºít
(
c⁄ãxt
, 
p
);

14318 }if–
	`sqlôe3AtoF
(
zD©e
, &
r
, 
	`sqlôe3SåÀn30
(zD©e), 
SQLITE_UTF8
) ){

14319 
p
->
iJD
 = (
sqlôe3_öt64
)(
r
*86400000.0 + 0.5);

14320 
p
->
vÆidJD
 = 1;

14329 
	`compuãYMD
(
D©eTime
 *
p
){

14330 
Z
, 
A
, 
B
, 
C
, 
D
, 
E
, 
X1
;

14331 if–
p
->
vÆidYMD
 ) ;

14332 if–!
p
->
vÆidJD
 ){

14333 
p
->
Y
 = 2000;

14334 
p
->
M
 = 1;

14335 
p
->
D
 = 1;

14337 
Z
 = ()((
p
->
iJD
 + 43200000)/86400000);

14338 
A
 = ()((
Z
 - 1867216.25)/36524.25);

14339 
A
 = 
Z
 + 1 + A - (A/4);

14340 
B
 = 
A
 + 1524;

14341 
C
 = ()((
B
 - 122.1)/365.25);

14342 
D
 = (36525*
C
)/100;

14343 
E
 = ()((
B
-
D
)/30.6001);

14344 
X1
 = ()(30.6001*
E
);

14345 
p
->
D
 = 
B
 - D - 
X1
;

14346 
p
->
M
 = 
E
<14 ? E-1 : E-13;

14347 
p
->
Y
 =Ö->
M
>2 ? 
C
 - 4716 : C - 4715;

14349 
p
->
vÆidYMD
 = 1;

14355 
	`compuãHMS
(
D©eTime
 *
p
){

14356 
s
;

14357 if–
p
->
vÆidHMS
 ) ;

14358 
	`compuãJD
(
p
);

14359 
s
 = ()((
p
->
iJD
 + 43200000) % 86400000);

14360 
p
->
s
 = s/1000.0;

14361 
s
 = ()
p
->s;

14362 
p
->
s
 -= s;

14363 
p
->
h
 = 
s
/3600;

14364 
s
 -
p
->
h
*3600;

14365 
p
->
m
 = 
s
/60;

14366 
p
->
s
 +†-Ö->
m
*60;

14367 
p
->
vÆidHMS
 = 1;

14373 
	`compuãYMD_HMS
(
D©eTime
 *
p
){

14374 
	`compuãYMD
(
p
);

14375 
	`compuãHMS
(
p
);

14381 
	`˛órYMD_HMS_TZ
(
D©eTime
 *
p
){

14382 
p
->
vÆidYMD
 = 0;

14383 
p
->
vÆidHMS
 = 0;

14384 
p
->
vÆidTZ
 = 0;

14399 #i‡!
	`deföed
(
HAVE_LOCALTIME_R
Ë&& !deföed(
HAVE_LOCALTIME_S
) && \

14400 
	`deföed
(
_MSC_VER
Ë&& deföed(
_CRT_INSECURE_DEPRECATE
)

14401 
	#HAVE_LOCALTIME_S
 1

	)

14404 #i‚de‡
SQLITE_OMIT_LOCALTIME


14418 
	`osLoˇ…ime
(
time_t
 *
t
, 
tm
 *
pTm
){

14419 
rc
;

14420 #i‡(!
	`deföed
(
HAVE_LOCALTIME_R
) || !HAVE_LOCALTIME_R) \

14421 && (!
	`deföed
(
HAVE_LOCALTIME_S
) || !HAVE_LOCALTIME_S)

14422 
tm
 *
pX
;

14423 #i‡
SQLITE_THREADSAFE
>0

14424 
sqlôe3_muãx
 *
muãx
 = 
	`sqlôe3MuãxAŒoc
(
SQLITE_MUTEX_STATIC_MASTER
);

14426 
	`sqlôe3_muãx_íãr
(
muãx
);

14427 
pX
 = 
	`loˇ…ime
(
t
);

14428 #i‚de‡
SQLITE_OMIT_BUILTIN_TEST


14429 if–
sqlôe3GlobÆC⁄fig
.
bLoˇ…imeFau…
 ) 
pX
 = 0;

14431 if–
pX
 ) *
pTm
 = *pX;

14432 
	`sqlôe3_muãx_Àave
(
muãx
);

14433 
rc
 = 
pX
==0;

14435 #i‚de‡
SQLITE_OMIT_BUILTIN_TEST


14436 if–
sqlôe3GlobÆC⁄fig
.
bLoˇ…imeFau…
 )  1;

14438 #i‡
	`deföed
(
HAVE_LOCALTIME_R
) && HAVE_LOCALTIME_R

14439 
rc
 = 
	`loˇ…ime_r
(
t
, 
pTm
)==0;

14441 
rc
 = 
	`loˇ…ime_s
(
pTm
, 
t
);

14444  
rc
;

14449 #i‚de‡
SQLITE_OMIT_LOCALTIME


14458 
sqlôe3_öt64
 
	`loˇ…imeOff£t
(

14459 
D©eTime
 *
p
,

14460 
sqlôe3_c⁄ãxt
 *
pCtx
,

14461 *
pRc


14463 
D©eTime
 
x
, 
y
;

14464 
time_t
 
t
;

14465 
tm
 
sLoˇl
;

14468 
	`mem£t
(&
sLoˇl
, 0, (sLocal));

14470 
x
 = *
p
;

14471 
	`compuãYMD_HMS
(&
x
);

14472 if–
x
.
Y
<1971 || x.Y>=2038 ){

14478 
x
.
Y
 = 2000;

14479 
x
.
M
 = 1;

14480 
x
.
D
 = 1;

14481 
x
.
h
 = 0;

14482 
x
.
m
 = 0;

14483 
x
.
s
 = 0.0;

14485 
s
 = ()(
x
.s + 0.5);

14486 
x
.
s
 = s;

14488 
x
.
tz
 = 0;

14489 
x
.
vÆidJD
 = 0;

14490 
	`compuãJD
(&
x
);

14491 
t
 = (
time_t
)(
x
.
iJD
/1000 - 21086676*(
i64
)10000);

14492 if–
	`osLoˇ…ime
(&
t
, &
sLoˇl
) ){

14493 
	`sqlôe3_ªsu…_îr‹
(
pCtx
, "localÅime unavailable", -1);

14494 *
pRc
 = 
SQLITE_ERROR
;

14497 
y
.
Y
 = 
sLoˇl
.
tm_yór
 + 1900;

14498 
y
.
M
 = 
sLoˇl
.
tm_m⁄
 + 1;

14499 
y
.
D
 = 
sLoˇl
.
tm_mday
;

14500 
y
.
h
 = 
sLoˇl
.
tm_hour
;

14501 
y
.
m
 = 
sLoˇl
.
tm_mö
;

14502 
y
.
s
 = 
sLoˇl
.
tm_£c
;

14503 
y
.
vÆidYMD
 = 1;

14504 
y
.
vÆidHMS
 = 1;

14505 
y
.
vÆidJD
 = 0;

14506 
y
.
vÆidTZ
 = 0;

14507 
	`compuãJD
(&
y
);

14508 *
pRc
 = 
SQLITE_OK
;

14509  
y
.
iJD
 - 
x
.iJD;

14537 
	`∑r£Modifõr
(
sqlôe3_c⁄ãxt
 *
pCtx
, c⁄° *
zMod
, 
D©eTime
 *
p
){

14538 
rc
 = 1;

14539 
n
;

14540 
r
;

14541 *
z
, 
zBuf
[30];

14542 
z
 = 
zBuf
;

14543 
n
=0;Ç<
	`AºaySize
(
zBuf
)-1 && 
zMod
[n];Ç++){

14544 
z
[
n
] = ()
sqlôe3UµîToLowî
[(
u8
)
zMod
[n]];

14546 
z
[
n
] = 0;

14547  
z
[0] ){

14548 #i‚de‡
SQLITE_OMIT_LOCALTIME


14555 if–
	`°rcmp
(
z
, "localtime")==0 ){

14556 
	`compuãJD
(
p
);

14557 
p
->
iJD
 +
	`loˇ…imeOff£t
’, 
pCtx
, &
rc
);

14558 
	`˛órYMD_HMS_TZ
(
p
);

14570 if–
	`°rcmp
(
z
, "unixïoch")==0 && 
p
->
vÆidJD
 ){

14571 
p
->
iJD
 = (p->iJD + 43200)/86400 + 21086676*(
i64
)10000000;

14572 
	`˛órYMD_HMS_TZ
(
p
);

14573 
rc
 = 0;

14575 #i‚de‡
SQLITE_OMIT_LOCALTIME


14576 if–
	`°rcmp
(
z
, "utc")==0 ){

14577 
sqlôe3_öt64
 
c1
;

14578 
	`compuãJD
(
p
);

14579 
c1
 = 
	`loˇ…imeOff£t
(
p
, 
pCtx
, &
rc
);

14580 if–
rc
==
SQLITE_OK
 ){

14581 
p
->
iJD
 -
c1
;

14582 
	`˛órYMD_HMS_TZ
(
p
);

14583 
p
->
iJD
 +
c1
 - 
	`loˇ…imeOff£t
’, 
pCtx
, &
rc
);

14597 if–
	`°∫cmp
(
z
, "weekday ", 8)==0

14598 && 
	`sqlôe3AtoF
(&
z
[8], &
r
, 
	`sqlôe3SåÀn30
(&z[8]), 
SQLITE_UTF8
)

14599 && (
n
=()
r
)==r &&Ç>=0 &&Ñ<7 ){

14600 
sqlôe3_öt64
 
Z
;

14601 
	`compuãYMD_HMS
(
p
);

14602 
p
->
vÆidTZ
 = 0;

14603 
p
->
vÆidJD
 = 0;

14604 
	`compuãJD
(
p
);

14605 
Z
 = ((
p
->
iJD
 + 129600000)/86400000) % 7;

14606 if–
Z
>
n
 ) Z -= 7;

14607 
p
->
iJD
 +(
n
 - 
Z
)*86400000;

14608 
	`˛órYMD_HMS_TZ
(
p
);

14609 
rc
 = 0;

14620 if–
	`°∫cmp
(
z
, "start of ", 9)!=0 ) ;

14621 
z
 += 9;

14622 
	`compuãYMD
(
p
);

14623 
p
->
vÆidHMS
 = 1;

14624 
p
->
h
 =Ö->
m
 = 0;

14625 
p
->
s
 = 0.0;

14626 
p
->
vÆidTZ
 = 0;

14627 
p
->
vÆidJD
 = 0;

14628 if–
	`°rcmp
(
z
,"month")==0 ){

14629 
p
->
D
 = 1;

14630 
rc
 = 0;

14631 }if–
	`°rcmp
(
z
,"year")==0 ){

14632 
	`compuãYMD
(
p
);

14633 
p
->
M
 = 1;

14634 
p
->
D
 = 1;

14635 
rc
 = 0;

14636 }if–
	`°rcmp
(
z
,"day")==0 ){

14637 
rc
 = 0;

14653 
rRoundî
;

14654 
n
=1; 
z
[n] && z[n]!=':' && !
	`sqlôe3Is•a˚
(z[n]);Ç++){}

14655 if–!
	`sqlôe3AtoF
(
z
, &
r
, 
n
, 
SQLITE_UTF8
) ){

14656 
rc
 = 1;

14659 if–
z
[
n
]==':' ){

14665 c⁄° *
z2
 = 
z
;

14666 
D©eTime
 
tx
;

14667 
sqlôe3_öt64
 
day
;

14668 if–!
	`sqlôe3Isdigô
(*
z2
) ) z2++;

14669 
	`mem£t
(&
tx
, 0, (tx));

14670 if–
	`∑r£HhMmSs
(
z2
, &
tx
) ) ;

14671 
	`compuãJD
(&
tx
);

14672 
tx
.
iJD
 -= 43200000;

14673 
day
 = 
tx
.
iJD
/86400000;

14674 
tx
.
iJD
 -
day
*86400000;

14675 if–
z
[0]=='-' ) 
tx
.
iJD
 = -tx.iJD;

14676 
	`compuãJD
(
p
);

14677 
	`˛órYMD_HMS_TZ
(
p
);

14678 
p
->
iJD
 +
tx
.iJD;

14679 
rc
 = 0;

14682 
z
 +
n
;

14683  
	`sqlôe3Is•a˚
(*
z
) ) z++;

14684 
n
 = 
	`sqlôe3SåÀn30
(
z
);

14685 if–
n
>10 ||Ç<3 ) ;

14686 if–
z
[
n
-1]=='s' ){ z[n-1] = 0;Ç--; }

14687 
	`compuãJD
(
p
);

14688 
rc
 = 0;

14689 
rRoundî
 = 
r
<0 ? -0.5 : +0.5;

14690 if–
n
==3 && 
	`°rcmp
(
z
,"day")==0 ){

14691 
p
->
iJD
 +(
sqlôe3_öt64
)(
r
*86400000.0 + 
rRoundî
);

14692 }if–
n
==4 && 
	`°rcmp
(
z
,"hour")==0 ){

14693 
p
->
iJD
 +(
sqlôe3_öt64
)(
r
*(86400000.0/24.0Ë+ 
rRoundî
);

14694 }if–
n
==6 && 
	`°rcmp
(
z
,"minute")==0 ){

14695 
p
->
iJD
 +(
sqlôe3_öt64
)(
r
*(86400000.0/(24.0*60.0)Ë+ 
rRoundî
);

14696 }if–
n
==6 && 
	`°rcmp
(
z
,"second")==0 ){

14697 
p
->
iJD
 +(
sqlôe3_öt64
)(
r
*(86400000.0/(24.0*60.0*60.0)Ë+ 
rRoundî
);

14698 }if–
n
==5 && 
	`°rcmp
(
z
,"month")==0 ){

14699 
x
, 
y
;

14700 
	`compuãYMD_HMS
(
p
);

14701 
p
->
M
 +()
r
;

14702 
x
 = 
p
->
M
>0 ? (p->M-1)/12 : (p->M-12)/12;

14703 
p
->
Y
 +
x
;

14704 
p
->
M
 -
x
*12;

14705 
p
->
vÆidJD
 = 0;

14706 
	`compuãJD
(
p
);

14707 
y
 = ()
r
;

14708 if–
y
!=
r
 ){

14709 
p
->
iJD
 +(
sqlôe3_öt64
)((
r
 - 
y
)*30.0*86400000.0 + 
rRoundî
);

14711 }if–
n
==4 && 
	`°rcmp
(
z
,"year")==0 ){

14712 
y
 = ()
r
;

14713 
	`compuãYMD_HMS
(
p
);

14714 
p
->
Y
 +
y
;

14715 
p
->
vÆidJD
 = 0;

14716 
	`compuãJD
(
p
);

14717 if–
y
!=
r
 ){

14718 
p
->
iJD
 +(
sqlôe3_öt64
)((
r
 - 
y
)*365.0*86400000.0 + 
rRoundî
);

14721 
rc
 = 1;

14723 
	`˛órYMD_HMS_TZ
(
p
);

14730  
rc
;

14742 
	`isD©e
(

14743 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

14744 
¨gc
,

14745 
sqlôe3_vÆue
 **
¨gv
,

14746 
D©eTime
 *
p


14748 
i
;

14749 c⁄° *
z
;

14750 
eTy≥
;

14751 
	`mem£t
(
p
, 0, (*p));

14752 if–
¨gc
==0 ){

14753  
	`£tD©eTimeToCuºít
(
c⁄ãxt
, 
p
);

14755 if–(
eTy≥
 = 
	`sqlôe3_vÆue_ty≥
(
¨gv
[0]))==
SQLITE_FLOAT


14756 || 
eTy≥
==
SQLITE_INTEGER
 ){

14757 
p
->
iJD
 = (
sqlôe3_öt64
)(
	`sqlôe3_vÆue_doubÀ
(
¨gv
[0])*86400000.0 + 0.5);

14758 
p
->
vÆidJD
 = 1;

14760 
z
 = 
	`sqlôe3_vÆue_ãxt
(
¨gv
[0]);

14761 if–!
z
 || 
	`∑r£D©eOrTime
(
c⁄ãxt
, (*)z, 
p
) ){

14765 
i
=1; i<
¨gc
; i++){

14766 
z
 = 
	`sqlôe3_vÆue_ãxt
(
¨gv
[
i
]);

14767 if–
z
==0 || 
	`∑r£Modifõr
(
c⁄ãxt
, (*)z, 
p
) )  1;

14783 
	`julündayFunc
(

14784 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

14785 
¨gc
,

14786 
sqlôe3_vÆue
 **
¨gv


14788 
D©eTime
 
x
;

14789 if–
	`isD©e
(
c⁄ãxt
, 
¨gc
, 
¨gv
, &
x
)==0 ){

14790 
	`compuãJD
(&
x
);

14791 
	`sqlôe3_ªsu…_doubÀ
(
c⁄ãxt
, 
x
.
iJD
/86400000.0);

14800 
	`d©ëimeFunc
(

14801 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

14802 
¨gc
,

14803 
sqlôe3_vÆue
 **
¨gv


14805 
D©eTime
 
x
;

14806 if–
	`isD©e
(
c⁄ãxt
, 
¨gc
, 
¨gv
, &
x
)==0 ){

14807 
zBuf
[100];

14808 
	`compuãYMD_HMS
(&
x
);

14809 
	`sqlôe3_¢¥ötf
((
zBuf
), zBuf, "%04d-%02d-%02d %02d:%02d:%02d",

14810 
x
.
Y
, x.
M
, x.
D
, x.
h
, x.
m
, ()(x.
s
));

14811 
	`sqlôe3_ªsu…_ãxt
(
c⁄ãxt
, 
zBuf
, -1, 
SQLITE_TRANSIENT
);

14820 
	`timeFunc
(

14821 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

14822 
¨gc
,

14823 
sqlôe3_vÆue
 **
¨gv


14825 
D©eTime
 
x
;

14826 if–
	`isD©e
(
c⁄ãxt
, 
¨gc
, 
¨gv
, &
x
)==0 ){

14827 
zBuf
[100];

14828 
	`compuãHMS
(&
x
);

14829 
	`sqlôe3_¢¥ötf
((
zBuf
), zBuf, "%02d:%02d:%02d", 
x
.
h
, x.
m
, ()x.
s
);

14830 
	`sqlôe3_ªsu…_ãxt
(
c⁄ãxt
, 
zBuf
, -1, 
SQLITE_TRANSIENT
);

14839 
	`d©eFunc
(

14840 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

14841 
¨gc
,

14842 
sqlôe3_vÆue
 **
¨gv


14844 
D©eTime
 
x
;

14845 if–
	`isD©e
(
c⁄ãxt
, 
¨gc
, 
¨gv
, &
x
)==0 ){

14846 
zBuf
[100];

14847 
	`compuãYMD
(&
x
);

14848 
	`sqlôe3_¢¥ötf
((
zBuf
), zBuf, "%04d-%02d-%02d", 
x
.
Y
, x.
M
, x.
D
);

14849 
	`sqlôe3_ªsu…_ãxt
(
c⁄ãxt
, 
zBuf
, -1, 
SQLITE_TRANSIENT
);

14872 
	`°r·imeFunc
(

14873 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

14874 
¨gc
,

14875 
sqlôe3_vÆue
 **
¨gv


14877 
D©eTime
 
x
;

14878 
u64
 
n
;

14879 
size_t
 
i
,
j
;

14880 *
z
;

14881 
sqlôe3
 *
db
;

14882 c⁄° *
zFmt
 = (c⁄° *)
	`sqlôe3_vÆue_ãxt
(
¨gv
[0]);

14883 
zBuf
[100];

14884 if–
zFmt
==0 || 
	`isD©e
(
c⁄ãxt
, 
¨gc
-1, 
¨gv
+1, &
x
) ) ;

14885 
db
 = 
	`sqlôe3_c⁄ãxt_db_h™dÀ
(
c⁄ãxt
);

14886 
i
=0, 
n
=1; 
zFmt
[i]; i++,Ç++){

14887 if–
zFmt
[
i
]=='%' ){

14888  
zFmt
[
i
+1] ){

14895 
n
++;

14901 
n
 += 8;

14904 
n
 += 3;

14907 
n
 += 8;

14911 
n
 += 50;

14916 
i
++;

14919 
	`ã°ˇ£
–
n
==(
zBuf
)-1 );

14920 
	`ã°ˇ£
–
n
==(
zBuf
) );

14921 
	`ã°ˇ£
–
n
==(
u64
)
db
->
aLimô
[
SQLITE_LIMIT_LENGTH
]+1 );

14922 
	`ã°ˇ£
–
n
==(
u64
)
db
->
aLimô
[
SQLITE_LIMIT_LENGTH
] );

14923 if–
n
<(
zBuf
) ){

14924 
z
 = 
zBuf
;

14925 }if–
n
>(
u64
)
db
->
aLimô
[
SQLITE_LIMIT_LENGTH
] ){

14926 
	`sqlôe3_ªsu…_îr‹_toobig
(
c⁄ãxt
);

14929 
z
 = 
	`sqlôe3DbMÆlocRaw
(
db
, ()
n
);

14930 if–
z
==0 ){

14931 
	`sqlôe3_ªsu…_îr‹_nomem
(
c⁄ãxt
);

14935 
	`compuãJD
(&
x
);

14936 
	`compuãYMD_HMS
(&
x
);

14937 
i
=
j
=0; 
zFmt
[i]; i++){

14938 if–
zFmt
[
i
]!='%' ){

14939 
z
[
j
++] = 
zFmt
[
i
];

14941 
i
++;

14942  
zFmt
[
i
] ){

14943 'd': 
	`sqlôe3_¢¥ötf
(3, &
z
[
j
],"%02d",
x
.
D
); j+=2; ;

14945 
s
 = 
x
.s;

14946 if–
s
>59.999 ) s = 59.999;

14947 
	`sqlôe3_¢¥ötf
(7, &
z
[
j
],"%06.3f", 
s
);

14948 
j
 +
	`sqlôe3SåÀn30
(&
z
[j]);

14951 'H': 
	`sqlôe3_¢¥ötf
(3, &
z
[
j
],"%02d",
x
.
h
); j+=2; ;

14954 
nDay
;

14955 
D©eTime
 
y
 = 
x
;

14956 
y
.
vÆidJD
 = 0;

14957 
y
.
M
 = 1;

14958 
y
.
D
 = 1;

14959 
	`compuãJD
(&
y
);

14960 
nDay
 = ()((
x
.
iJD
-
y
.iJD+43200000)/86400000);

14961 if–
zFmt
[
i
]=='W' ){

14962 
wd
;

14963 
wd
 = ()(((
x
.
iJD
+43200000)/86400000)%7);

14964 
	`sqlôe3_¢¥ötf
(3, &
z
[
j
],"%02d",(
nDay
+7-
wd
)/7);

14965 
j
 += 2;

14967 
	`sqlôe3_¢¥ötf
(4, &
z
[
j
],"%03d",
nDay
+1);

14968 
j
 += 3;

14973 
	`sqlôe3_¢¥ötf
(20, &
z
[
j
],"%.16g",
x
.
iJD
/86400000.0);

14974 
j
+=
	`sqlôe3SåÀn30
(&
z
[j]);

14977 'm': 
	`sqlôe3_¢¥ötf
(3, &
z
[
j
],"%02d",
x
.
M
); j+=2; ;

14978 'M': 
	`sqlôe3_¢¥ötf
(3, &
z
[
j
],"%02d",
x
.
m
); j+=2; ;

14980 
	`sqlôe3_¢¥ötf
(30,&
z
[
j
],"%lld",

14981 (
i64
)(
x
.
iJD
/1000 - 21086676*(i64)10000));

14982 
j
 +
	`sqlôe3SåÀn30
(&
z
[j]);

14985 'S': 
	`sqlôe3_¢¥ötf
(3,&
z
[
j
],"%02d",()
x
.
s
); j+=2; ;

14987 
z
[
j
++] = ()(((
x
.
iJD
+129600000)/86400000) % 7) + '0';

14991 
	`sqlôe3_¢¥ötf
(5,&
z
[
j
],"%04d",
x
.
Y
); j+=
	`sqlôe3SåÀn30
(&z[j]);

14994 : 
z
[
j
++] = '%'; ;

14998 
z
[
j
] = 0;

14999 
	`sqlôe3_ªsu…_ãxt
(
c⁄ãxt
, 
z
, -1,

15000 
z
==
zBuf
 ? 
SQLITE_TRANSIENT
 : 
SQLITE_DYNAMIC
);

15008 
	`˘imeFunc
(

15009 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

15010 
NŸU£d
,

15011 
sqlôe3_vÆue
 **
NŸU£d2


15013 
	`UNUSED_PARAMETER2
(
NŸU£d
, 
NŸU£d2
);

15014 
	`timeFunc
(
c⁄ãxt
, 0, 0);

15022 
	`cd©eFunc
(

15023 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

15024 
NŸU£d
,

15025 
sqlôe3_vÆue
 **
NŸU£d2


15027 
	`UNUSED_PARAMETER2
(
NŸU£d
, 
NŸU£d2
);

15028 
	`d©eFunc
(
c⁄ãxt
, 0, 0);

15036 
	`˘ime°ampFunc
(

15037 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

15038 
NŸU£d
,

15039 
sqlôe3_vÆue
 **
NŸU£d2


15041 
	`UNUSED_PARAMETER2
(
NŸU£d
, 
NŸU£d2
);

15042 
	`d©ëimeFunc
(
c⁄ãxt
, 0, 0);

15046 #ifde‡
SQLITE_OMIT_DATETIME_FUNCS


15058 
	`cuºítTimeFunc
(

15059 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

15060 
¨gc
,

15061 
sqlôe3_vÆue
 **
¨gv


15063 
time_t
 
t
;

15064 *
zF‹m©
 = (*)
	`sqlôe3_u£r_d©a
(
c⁄ãxt
);

15065 
sqlôe3
 *
db
;

15066 
sqlôe3_öt64
 
iT
;

15067 
tm
 *
pTm
;

15068 
tm
 
sNow
;

15069 
zBuf
[20];

15071 
	`UNUSED_PARAMETER
(
¨gc
);

15072 
	`UNUSED_PARAMETER
(
¨gv
);

15074 
iT
 = 
	`sqlôe3StmtCuºítTime
(
c⁄ãxt
);

15075 if–
iT
<=0 ) ;

15076 
t
 = 
iT
/1000 - 10000*(
sqlôe3_öt64
)21086676;

15077 #ifde‡
HAVE_GMTIME_R


15078 
pTm
 = 
	`gmtime_r
(&
t
, &
sNow
);

15080 
	`sqlôe3_muãx_íãr
(
	`sqlôe3MuãxAŒoc
(
SQLITE_MUTEX_STATIC_MASTER
));

15081 
pTm
 = 
	`gmtime
(&
t
);

15082 if–
pTm
 ) 
	`mem˝y
(&
sNow
,ÖTm, (sNow));

15083 
	`sqlôe3_muãx_Àave
(
	`sqlôe3MuãxAŒoc
(
SQLITE_MUTEX_STATIC_MASTER
));

15085 if–
pTm
 ){

15086 
	`°r·ime
(
zBuf
, 20, 
zF‹m©
, &
sNow
);

15087 
	`sqlôe3_ªsu…_ãxt
(
c⁄ãxt
, 
zBuf
, -1, 
SQLITE_TRANSIENT
);

15097 
SQLITE_PRIVATE
 
	`sqlôe3Regi°îD©eTimeFun˘i⁄s
(){

15098 
SQLITE_WSD
 
FuncDef
 
aD©eTimeFuncs
[] = {

15099 #i‚de‡
SQLITE_OMIT_DATETIME_FUNCS


15100 
	`FUNCTION
(
julünday
, -1, 0, 0, 
julündayFunc
 ),

15101 
	`FUNCTION
(
d©e
, -1, 0, 0, 
d©eFunc
 ),

15102 
	`FUNCTION
(
time
, -1, 0, 0, 
timeFunc
 ),

15103 
	`FUNCTION
(
d©ëime
, -1, 0, 0, 
d©ëimeFunc
 ),

15104 
	`FUNCTION
(
°r·ime
, -1, 0, 0, 
°r·imeFunc
 ),

15105 
	`FUNCTION
(
cuºít_time
, 0, 0, 0, 
˘imeFunc
 ),

15106 
	`FUNCTION
(
cuºít_time°amp
, 0, 0, 0, 
˘ime°ampFunc
),

15107 
	`FUNCTION
(
cuºít_d©e
, 0, 0, 0, 
cd©eFunc
 ),

15109 
	`STR_FUNCTION
(
cuºít_time
, 0, "%H:%M:%S", 0, 
cuºítTimeFunc
),

15110 
	`STR_FUNCTION
(
cuºít_d©e
, 0, "%Y-%m-%d", 0, 
cuºítTimeFunc
),

15111 
	`STR_FUNCTION
(
cuºít_time°amp
, 0, "%Y-%m-%d %H:%M:%S", 0, 
cuºítTimeFunc
),

15114 
i
;

15115 
FuncDefHash
 *
pHash
 = &
	`GLOBAL
(FuncDefHash, 
sqlôe3GlobÆFun˘i⁄s
);

15116 
FuncDef
 *
aFunc
 = (FuncDef*)&
	`GLOBAL
(FuncDef, 
aD©eTimeFuncs
);

15118 
i
=0; i<
	`AºaySize
(
aD©eTimeFuncs
); i++){

15119 
	`sqlôe3FuncDefIn£π
(
pHash
, &
aFunc
[
i
]);

15140 
	#_SQLITE_OS_C_
 1

	)

15141 #unde‡
_SQLITE_OS_C_


15167 #i‡
	`deföed
(
SQLITE_TEST
)

15168 
SQLITE_API
 
sqlôe3_memdebug_vfs_oom_ã°
 = 1;

15169 
	#DO_OS_MALLOC_TEST
(
x
) \

15170 i‡(
sqlôe3_memdebug_vfs_oom_ã°
 && (!
x
 || !
	`sqlôe3IsMemJou∫Æ
(x))) { \

15171 *
pT°AŒoc
 = 
	`sqlôe3MÆloc
(10); \

15172 i‡(!
pT°AŒoc
Ë 
SQLITE_IOERR_NOMEM
; \

15173 
	`sqlôe3_‰ì
(
pT°AŒoc
); \

15174 }

	)

15176 
	#DO_OS_MALLOC_TEST
(
x
)

	)

15185 
SQLITE_PRIVATE
 
	`sqlôe3OsClo£
(
sqlôe3_fûe
 *
pId
){

15186 
rc
 = 
SQLITE_OK
;

15187 if–
pId
->
pMëhods
 ){

15188 
rc
 = 
pId
->
pMëhods
->
	`xClo£
(pId);

15189 
pId
->
pMëhods
 = 0;

15191  
rc
;

15193 
SQLITE_PRIVATE
 
	`sqlôe3OsRód
(
sqlôe3_fûe
 *
id
, *
pBuf
, 
amt
, 
i64
 
off£t
){

15194 
	`DO_OS_MALLOC_TEST
(
id
);

15195  
id
->
pMëhods
->
	`xRód
(id, 
pBuf
, 
amt
, 
off£t
);

15197 
SQLITE_PRIVATE
 
	`sqlôe3OsWrôe
(
sqlôe3_fûe
 *
id
, c⁄° *
pBuf
, 
amt
, 
i64
 
off£t
){

15198 
	`DO_OS_MALLOC_TEST
(
id
);

15199  
id
->
pMëhods
->
	`xWrôe
(id, 
pBuf
, 
amt
, 
off£t
);

15201 
SQLITE_PRIVATE
 
	`sqlôe3OsTrunˇã
(
sqlôe3_fûe
 *
id
, 
i64
 
size
){

15202  
id
->
pMëhods
->
	`xTrunˇã
(id, 
size
);

15204 
SQLITE_PRIVATE
 
	`sqlôe3OsSync
(
sqlôe3_fûe
 *
id
, 
Êags
){

15205 
	`DO_OS_MALLOC_TEST
(
id
);

15206  
id
->
pMëhods
->
	`xSync
(id, 
Êags
);

15208 
SQLITE_PRIVATE
 
	`sqlôe3OsFûeSize
(
sqlôe3_fûe
 *
id
, 
i64
 *
pSize
){

15209 
	`DO_OS_MALLOC_TEST
(
id
);

15210  
id
->
pMëhods
->
	`xFûeSize
(id, 
pSize
);

15212 
SQLITE_PRIVATE
 
	`sqlôe3OsLock
(
sqlôe3_fûe
 *
id
, 
lockTy≥
){

15213 
	`DO_OS_MALLOC_TEST
(
id
);

15214  
id
->
pMëhods
->
	`xLock
(id, 
lockTy≥
);

15216 
SQLITE_PRIVATE
 
	`sqlôe3OsU∆ock
(
sqlôe3_fûe
 *
id
, 
lockTy≥
){

15217  
id
->
pMëhods
->
	`xU∆ock
(id, 
lockTy≥
);

15219 
SQLITE_PRIVATE
 
	`sqlôe3OsCheckRe£rvedLock
(
sqlôe3_fûe
 *
id
, *
pResOut
){

15220 
	`DO_OS_MALLOC_TEST
(
id
);

15221  
id
->
pMëhods
->
	`xCheckRe£rvedLock
(id, 
pResOut
);

15232 
SQLITE_PRIVATE
 
	`sqlôe3OsFûeC⁄åﬁ
(
sqlôe3_fûe
 *
id
, 
›
, *
pArg
){

15233 
	`DO_OS_MALLOC_TEST
(
id
);

15234  
id
->
pMëhods
->
	`xFûeC⁄åﬁ
(id, 
›
, 
pArg
);

15236 
SQLITE_PRIVATE
 
	`sqlôe3OsFûeC⁄åﬁHöt
(
sqlôe3_fûe
 *
id
, 
›
, *
pArg
){

15237 ()
id
->
pMëhods
->
	`xFûeC⁄åﬁ
(id, 
›
, 
pArg
);

15240 
SQLITE_PRIVATE
 
	`sqlôe3OsSe˘‹Size
(
sqlôe3_fûe
 *
id
){

15241 (*
xSe˘‹Size
)(
sqlôe3_fûe
*Ë
id
->
pMëhods
->xSectorSize;

15242  (
xSe˘‹Size
 ? 
	`xSe˘‹Size
(
id
Ë: 
SQLITE_DEFAULT_SECTOR_SIZE
);

15244 
SQLITE_PRIVATE
 
	`sqlôe3OsDevi˚Ch¨a˘îi°ics
(
sqlôe3_fûe
 *
id
){

15245  
id
->
pMëhods
->
	`xDevi˚Ch¨a˘îi°ics
(id);

15247 
SQLITE_PRIVATE
 
	`sqlôe3OsShmLock
(
sqlôe3_fûe
 *
id
, 
off£t
, 
n
, 
Êags
){

15248  
id
->
pMëhods
->
	`xShmLock
(id, 
off£t
, 
n
, 
Êags
);

15250 
SQLITE_PRIVATE
 
	`sqlôe3OsShmB¨rõr
(
sqlôe3_fûe
 *
id
){

15251 
id
->
pMëhods
->
	`xShmB¨rõr
(id);

15253 
SQLITE_PRIVATE
 
	`sqlôe3OsShmUnm≠
(
sqlôe3_fûe
 *
id
, 
dñëeFœg
){

15254  
id
->
pMëhods
->
	`xShmUnm≠
(id, 
dñëeFœg
);

15256 
SQLITE_PRIVATE
 
	`sqlôe3OsShmM≠
(

15257 
sqlôe3_fûe
 *
id
,

15258 
iPage
,

15259 
pgsz
,

15260 
bExãnd
,

15261 vﬁ©ûê**
µ


15263 
	`DO_OS_MALLOC_TEST
(
id
);

15264  
id
->
pMëhods
->
	`xShmM≠
(id, 
iPage
, 
pgsz
, 
bExãnd
, 
µ
);

15267 #i‡
SQLITE_MAX_MMAP_SIZE
>0

15269 
SQLITE_PRIVATE
 
	`sqlôe3OsFëch
(
sqlôe3_fûe
 *
id
, 
i64
 
iOff
, 
iAmt
, **
µ
){

15270 
	`DO_OS_MALLOC_TEST
(
id
);

15271  
id
->
pMëhods
->
	`xFëch
(id, 
iOff
, 
iAmt
, 
µ
);

15273 
SQLITE_PRIVATE
 
	`sqlôe3OsUn„tch
(
sqlôe3_fûe
 *
id
, 
i64
 
iOff
, *
p
){

15274  
id
->
pMëhods
->
	`xUn„tch
(id, 
iOff
, 
p
);

15278 
SQLITE_PRIVATE
 
	`sqlôe3OsFëch
(
sqlôe3_fûe
 *
id
, 
i64
 
iOff
, 
iAmt
, **
µ
){

15279 *
µ
 = 0;

15280  
SQLITE_OK
;

15282 
SQLITE_PRIVATE
 
	`sqlôe3OsUn„tch
(
sqlôe3_fûe
 *
id
, 
i64
 
iOff
, *
p
){

15283  
SQLITE_OK
;

15291 
SQLITE_PRIVATE
 
	`sqlôe3OsO≥n
(

15292 
sqlôe3_vfs
 *
pVfs
,

15293 c⁄° *
zP©h
,

15294 
sqlôe3_fûe
 *
pFûe
,

15295 
Êags
,

15296 *
pFœgsOut


15298 
rc
;

15299 
	`DO_OS_MALLOC_TEST
(0);

15304 
rc
 = 
pVfs
->
	`xO≥n
’Vfs, 
zP©h
, 
pFûe
, 
Êags
 & 0x87f7f, 
pFœgsOut
);

15305 
	`as£π
–
rc
==
SQLITE_OK
 || 
pFûe
->
pMëhods
==0 );

15306  
rc
;

15308 
SQLITE_PRIVATE
 
	`sqlôe3OsDñëe
(
sqlôe3_vfs
 *
pVfs
, c⁄° *
zP©h
, 
dúSync
){

15309 
	`DO_OS_MALLOC_TEST
(0);

15310 
	`as£π
–
dúSync
==0 || dirSync==1 );

15311  
pVfs
->
	`xDñëe
’Vfs, 
zP©h
, 
dúSync
);

15313 
SQLITE_PRIVATE
 
	`sqlôe3OsAc˚ss
(

15314 
sqlôe3_vfs
 *
pVfs
,

15315 c⁄° *
zP©h
,

15316 
Êags
,

15317 *
pResOut


15319 
	`DO_OS_MALLOC_TEST
(0);

15320  
pVfs
->
	`xAc˚ss
’Vfs, 
zP©h
, 
Êags
, 
pResOut
);

15322 
SQLITE_PRIVATE
 
	`sqlôe3OsFuŒP©h«me
(

15323 
sqlôe3_vfs
 *
pVfs
,

15324 c⁄° *
zP©h
,

15325 
nP©hOut
,

15326 *
zP©hOut


15328 
	`DO_OS_MALLOC_TEST
(0);

15329 
zP©hOut
[0] = 0;

15330  
pVfs
->
	`xFuŒP©h«me
’Vfs, 
zP©h
, 
nP©hOut
, 
zP©hOut
);

15332 #i‚de‡
SQLITE_OMIT_LOAD_EXTENSION


15333 
SQLITE_PRIVATE
 *
	`sqlôe3OsDlO≥n
(
sqlôe3_vfs
 *
pVfs
, c⁄° *
zP©h
){

15334  
pVfs
->
	`xDlO≥n
’Vfs, 
zP©h
);

15336 
SQLITE_PRIVATE
 
	`sqlôe3OsDlEº‹
(
sqlôe3_vfs
 *
pVfs
, 
nByã
, *
zBufOut
){

15337 
pVfs
->
	`xDlEº‹
’Vfs, 
nByã
, 
zBufOut
);

15339 
SQLITE_PRIVATE
 (*
	`sqlôe3OsDlSym
(
sqlôe3_vfs
 *
pVfs
, *
pHdÀ
, c⁄° *
zSym
))(){

15340  
pVfs
->
	`xDlSym
’Vfs, 
pHdÀ
, 
zSym
);

15342 
SQLITE_PRIVATE
 
	`sqlôe3OsDlClo£
(
sqlôe3_vfs
 *
pVfs
, *
pH™dÀ
){

15343 
pVfs
->
	`xDlClo£
’Vfs, 
pH™dÀ
);

15346 
SQLITE_PRIVATE
 
	`sqlôe3OsR™dom√ss
(
sqlôe3_vfs
 *
pVfs
, 
nByã
, *
zBufOut
){

15347  
pVfs
->
	`xR™dom√ss
’Vfs, 
nByã
, 
zBufOut
);

15349 
SQLITE_PRIVATE
 
	`sqlôe3OsSÀï
(
sqlôe3_vfs
 *
pVfs
, 
nMi¸o
){

15350  
pVfs
->
	`xSÀï
’Vfs, 
nMi¸o
);

15352 
SQLITE_PRIVATE
 
	`sqlôe3OsCuºítTimeI¡64
(
sqlôe3_vfs
 *
pVfs
, 
sqlôe3_öt64
 *
pTimeOut
){

15353 
rc
;

15360 if–
pVfs
->
iVîsi⁄
>=2 &&ÖVfs->
xCuºítTimeI¡64
 ){

15361 
rc
 = 
pVfs
->
	`xCuºítTimeI¡64
’Vfs, 
pTimeOut
);

15363 
r
;

15364 
rc
 = 
pVfs
->
	`xCuºítTime
’Vfs, &
r
);

15365 *
pTimeOut
 = (
sqlôe3_öt64
)(
r
*86400000.0);

15367  
rc
;

15370 
SQLITE_PRIVATE
 
	`sqlôe3OsO≥nMÆloc
(

15371 
sqlôe3_vfs
 *
pVfs
,

15372 c⁄° *
zFûe
,

15373 
sqlôe3_fûe
 **
µFûe
,

15374 
Êags
,

15375 *
pOutFœgs


15377 
rc
 = 
SQLITE_NOMEM
;

15378 
sqlôe3_fûe
 *
pFûe
;

15379 
pFûe
 = (
sqlôe3_fûe
 *)
	`sqlôe3MÆlocZîo
(
pVfs
->
szOsFûe
);

15380 if–
pFûe
 ){

15381 
rc
 = 
	`sqlôe3OsO≥n
(
pVfs
, 
zFûe
, 
pFûe
, 
Êags
, 
pOutFœgs
);

15382 if–
rc
!=
SQLITE_OK
 ){

15383 
	`sqlôe3_‰ì
(
pFûe
);

15385 *
µFûe
 = 
pFûe
;

15388  
rc
;

15390 
SQLITE_PRIVATE
 
	`sqlôe3OsClo£Fªe
(
sqlôe3_fûe
 *
pFûe
){

15391 
rc
 = 
SQLITE_OK
;

15392 
	`as£π
–
pFûe
 );

15393 
rc
 = 
	`sqlôe3OsClo£
(
pFûe
);

15394 
	`sqlôe3_‰ì
(
pFûe
);

15395  
rc
;

15404 
SQLITE_PRIVATE
 
	`sqlôe3OsInô
(){

15405 *
p
 = 
	`sqlôe3_mÆloc
(10);

15406 if–
p
==0 )  
SQLITE_NOMEM
;

15407 
	`sqlôe3_‰ì
(
p
);

15408  
	`sqlôe3_os_öô
();

15414 
sqlôe3_vfs
 * 
SQLITE_WSD
 
vfsLi°
 = 0;

15415 
	#vfsLi°
 
	`GLOBAL
(
sqlôe3_vfs
 *, 
vfsLi°
)

	)

15421 
SQLITE_API
 
sqlôe3_vfs
 *
	`sqlôe3_vfs_föd
(c⁄° *
zVfs
){

15422 
sqlôe3_vfs
 *
pVfs
 = 0;

15423 #i‡
SQLITE_THREADSAFE


15424 
sqlôe3_muãx
 *
muãx
;

15426 #i‚de‡
SQLITE_OMIT_AUTOINIT


15427 
rc
 = 
	`sqlôe3_öôülize
();

15428 if–
rc
 )  0;

15430 #i‡
SQLITE_THREADSAFE


15431 
muãx
 = 
	`sqlôe3MuãxAŒoc
(
SQLITE_MUTEX_STATIC_MASTER
);

15433 
	`sqlôe3_muãx_íãr
(
muãx
);

15434 
pVfs
 = 
vfsLi°
;ÖVfs;ÖVfsıVfs->
pNext
){

15435 if–
zVfs
==0 ) ;

15436 if–
	`°rcmp
(
zVfs
, 
pVfs
->
zName
)==0 ) ;

15438 
	`sqlôe3_muãx_Àave
(
muãx
);

15439  
pVfs
;

15445 
	`vfsU∆ök
(
sqlôe3_vfs
 *
pVfs
){

15446 
	`as£π
–
	`sqlôe3_muãx_hñd
(
	`sqlôe3MuãxAŒoc
(
SQLITE_MUTEX_STATIC_MASTER
)) );

15447 if–
pVfs
==0 ){

15449 }if–
vfsLi°
==
pVfs
 ){

15450 
vfsLi°
 = 
pVfs
->
pNext
;

15451 }if–
vfsLi°
 ){

15452 
sqlôe3_vfs
 *
p
 = 
vfsLi°
;

15453  
p
->
pNext
 &&Ö->pNext!=
pVfs
 ){

15454 
p
 =Ö->
pNext
;

15456 if–
p
->
pNext
==
pVfs
 ){

15457 
p
->
pNext
 = 
pVfs
->pNext;

15467 
SQLITE_API
 
	`sqlôe3_vfs_ªgi°î
(
sqlôe3_vfs
 *
pVfs
, 
makeDÊt
){

15468 
	`MUTEX_LOGIC
(
sqlôe3_muãx
 *
muãx
;)

15469 #i‚de‡
SQLITE_OMIT_AUTOINIT


15470 
rc
 = 
	`sqlôe3_öôülize
();

15471 if–
rc
 ) Ñc;

15473 
	`MUTEX_LOGIC
–
muãx
 = 
	`sqlôe3MuãxAŒoc
(
SQLITE_MUTEX_STATIC_MASTER
); )

15474 
	`sqlôe3_muãx_íãr
(
muãx
);

15475 
	`vfsU∆ök
(
pVfs
);

15476 if–
makeDÊt
 || 
vfsLi°
==0 ){

15477 
pVfs
->
pNext
 = 
vfsLi°
;

15478 
vfsLi°
 = 
pVfs
;

15480 
pVfs
->
pNext
 = 
vfsLi°
->pNext;

15481 
vfsLi°
->
pNext
 = 
pVfs
;

15483 
	`as£π
(
vfsLi°
);

15484 
	`sqlôe3_muãx_Àave
(
muãx
);

15485  
SQLITE_OK
;

15491 
SQLITE_API
 
	`sqlôe3_vfs_uƒegi°î
(
sqlôe3_vfs
 *
pVfs
){

15492 #i‡
SQLITE_THREADSAFE


15493 
sqlôe3_muãx
 *
muãx
 = 
	`sqlôe3MuãxAŒoc
(
SQLITE_MUTEX_STATIC_MASTER
);

15495 
	`sqlôe3_muãx_íãr
(
muãx
);

15496 
	`vfsU∆ök
(
pVfs
);

15497 
	`sqlôe3_muãx_Àave
(
muãx
);

15498  
SQLITE_OK
;

15530 #i‚de‡
SQLITE_OMIT_BUILTIN_TEST


15535 
BíignMÆlocHooks
 
	tBíignMÆlocHooks
;

15536 
SQLITE_WSD
 
	sBíignMÆlocHooks
 {

15537 (*
xBíignBegö
)();

15538 (*
xBíignEnd
)();

15539 } 
sqlôe3Hooks
 = { 0, 0 };

15547 #ifde‡
SQLITE_OMIT_WSD


15548 
	#wsdHooksInô
 \

15549 
BíignMÆlocHooks
 *
x
 = &
	`GLOBAL
(BíignMÆlocHooks,
sqlôe3Hooks
)

	)

15550 
	#wsdHooks
 
x
[0]

	)

15552 
	#wsdHooksInô


	)

15553 
	#wsdHooks
 
sqlôe3Hooks


	)

15561 
SQLITE_PRIVATE
 
	`sqlôe3BíignMÆlocHooks
(

15562 (*
xBíignBegö
)(),

15563 (*
xBíignEnd
)()

15565 
wsdHooksInô
;

15566 
wsdHooks
.
xBíignBegö
 = xBenignBegin;

15567 
wsdHooks
.
xBíignEnd
 = xBenignEnd;

15575 
SQLITE_PRIVATE
 
	`sqlôe3BegöBíignMÆloc
(){

15576 
wsdHooksInô
;

15577 if–
wsdHooks
.
xBíignBegö
 ){

15578 
wsdHooks
.
	`xBíignBegö
();

15581 
SQLITE_PRIVATE
 
	`sqlôe3EndBíignMÆloc
(){

15582 
wsdHooksInô
;

15583 if–
wsdHooks
.
xBíignEnd
 ){

15584 
wsdHooks
.
	`xBíignEnd
();

15616 #ifde‡
SQLITE_ZERO_MALLOC


15621 *
	`sqlôe3MemMÆloc
(
nByã
){  0; }

15622 
	`sqlôe3MemFªe
(*
pPri‹
){ ; }

15623 *
	`sqlôe3MemRóŒoc
(*
pPri‹
, 
nByã
){  0; }

15624 
	`sqlôe3MemSize
(*
pPri‹
){  0; }

15625 
	`sqlôe3MemRoundup
(
n
){ Ç; }

15626 
	`sqlôe3MemInô
(*
NŸU£d
){  
SQLITE_OK
; }

15627 
	`sqlôe3MemShutdown
(*
NŸU£d
){ ; }

15635 
SQLITE_PRIVATE
 
	`sqlôe3MemSëDeÁu…
(){

15636 c⁄° 
sqlôe3_mem_mëhods
 
deÁu…Mëhods
 = {

15637 
sqlôe3MemMÆloc
,

15638 
sqlôe3MemFªe
,

15639 
sqlôe3MemRóŒoc
,

15640 
sqlôe3MemSize
,

15641 
sqlôe3MemRoundup
,

15642 
sqlôe3MemInô
,

15643 
sqlôe3MemShutdown
,

15646 
	`sqlôe3_c⁄fig
(
SQLITE_CONFIG_MALLOC
, &
deÁu…Mëhods
);

15702 #ifde‡
SQLITE_SYSTEM_MALLOC


15709 #i‡
	`deföed
(
_MSC_VER
Ë&& !deföed(
SQLITE_WITHOUT_MSIZE
)

15710 
	#SQLITE_MALLOCSIZE
 
_msize


	)

15713 #i‡
	`deföed
(
__APPLE__
Ë&& !deföed(
SQLITE_WITHOUT_ZONEMALLOC
)

15719 
	~<sys/sys˘l.h
>

15720 
	~<mÆloc/mÆloc.h
>

15721 
	~<libkîn/OSAtomic.h
>

15722 
mÆloc_z⁄e_t
* 
_sqlôeZ⁄e_
;

15723 
	#SQLITE_MALLOC
(
x
Ë
	`mÆloc_z⁄e_mÆloc
(
_sqlôeZ⁄e_
, (x))

	)

15724 
	#SQLITE_FREE
(
x
Ë
	`mÆloc_z⁄e_‰ì
(
_sqlôeZ⁄e_
, (x));

	)

15725 
	#SQLITE_REALLOC
(
x
,
y
Ë
	`mÆloc_z⁄e_ªÆloc
(
_sqlôeZ⁄e_
, (x), (y))

	)

15726 
	#SQLITE_MALLOCSIZE
(
x
) \

15727 (
_sqlôeZ⁄e_
 ? _sqlôeZ⁄e_->
	`size
(_sqlôeZ⁄e_,
x
Ë: 
	`mÆloc_size
(x))

	)

15735 
	#SQLITE_MALLOC
(
x
Ë
	`mÆloc
(x)

	)

15736 
	#SQLITE_FREE
(
x
Ë
	`‰ì
(x)

	)

15737 
	#SQLITE_REALLOC
(
x
,
y
Ë
	`ªÆloc
((x),(y))

	)

15739 #i‡(
	`deföed
(
_MSC_VER
Ë&& !deföed(
SQLITE_WITHOUT_MSIZE
)) \

15740 || (
	`deföed
(
HAVE_MALLOC_H
Ë&& deföed(
HAVE_MALLOC_USABLE_SIZE
))

15741 
	~<mÆloc.h
>

15743 #ifde‡
HAVE_MALLOC_USABLE_SIZE


15744 #i‚de‡
SQLITE_MALLOCSIZE


15745 
	#SQLITE_MALLOCSIZE
(
x
Ë
	`mÆloc_ußbÀ_size
(x)

	)

15748 #unde‡
SQLITE_MALLOCSIZE


15761 *
	`sqlôe3MemMÆloc
(
nByã
){

15762 #ifde‡
SQLITE_MALLOCSIZE


15763 *
p
 = 
	`SQLITE_MALLOC
–
nByã
 );

15764 if–
p
==0 ){

15765 
	`ã°ˇ£
–
sqlôe3GlobÆC⁄fig
.
xLog
!=0 );

15766 
	`sqlôe3_log
(
SQLITE_NOMEM
, "ÁûedÅÿÆloˇã %u byã†o‡mem‹y", 
nByã
);

15768  
p
;

15770 
sqlôe3_öt64
 *
p
;

15771 
	`as£π
–
nByã
>0 );

15772 
nByã
 = 
	`ROUND8
(nByte);

15773 
p
 = 
	`SQLITE_MALLOC
–
nByã
+8 );

15774 if–
p
 ){

15775 
p
[0] = 
nByã
;

15776 
p
++;

15778 
	`ã°ˇ£
–
sqlôe3GlobÆC⁄fig
.
xLog
!=0 );

15779 
	`sqlôe3_log
(
SQLITE_NOMEM
, "ÁûedÅÿÆloˇã %u byã†o‡mem‹y", 
nByã
);

15781  (*)
p
;

15793 
	`sqlôe3MemFªe
(*
pPri‹
){

15794 #ifde‡
SQLITE_MALLOCSIZE


15795 
	`SQLITE_FREE
(
pPri‹
);

15797 
sqlôe3_öt64
 *
p
 = (sqlôe3_öt64*)
pPri‹
;

15798 
	`as£π
–
pPri‹
!=0 );

15799 
p
--;

15800 
	`SQLITE_FREE
(
p
);

15808 
	`sqlôe3MemSize
(*
pPri‹
){

15809 #ifde‡
SQLITE_MALLOCSIZE


15810  
pPri‹
 ? ()
	`SQLITE_MALLOCSIZE
(pPrior) : 0;

15812 
sqlôe3_öt64
 *
p
;

15813 if–
pPri‹
==0 )  0;

15814 
p
 = (
sqlôe3_öt64
*)
pPri‹
;

15815 
p
--;

15816  ()
p
[0];

15830 *
	`sqlôe3MemRóŒoc
(*
pPri‹
, 
nByã
){

15831 #ifde‡
SQLITE_MALLOCSIZE


15832 *
p
 = 
	`SQLITE_REALLOC
(
pPri‹
, 
nByã
);

15833 if–
p
==0 ){

15834 
	`ã°ˇ£
–
sqlôe3GlobÆC⁄fig
.
xLog
!=0 );

15835 
	`sqlôe3_log
(
SQLITE_NOMEM
,

15837 
	`SQLITE_MALLOCSIZE
(
pPri‹
), 
nByã
);

15839  
p
;

15841 
sqlôe3_öt64
 *
p
 = (sqlôe3_öt64*)
pPri‹
;

15842 
	`as£π
–
pPri‹
!=0 && 
nByã
>0 );

15843 
	`as£π
–
nByã
==
	`ROUND8
(nByte) );

15844 
p
--;

15845 
p
 = 
	`SQLITE_REALLOC
’, 
nByã
+8 );

15846 if–
p
 ){

15847 
p
[0] = 
nByã
;

15848 
p
++;

15850 
	`ã°ˇ£
–
sqlôe3GlobÆC⁄fig
.
xLog
!=0 );

15851 
	`sqlôe3_log
(
SQLITE_NOMEM
,

15853 
	`sqlôe3MemSize
(
pPri‹
), 
nByã
);

15855  (*)
p
;

15862 
	`sqlôe3MemRoundup
(
n
){

15863  
	`ROUND8
(
n
);

15869 
	`sqlôe3MemInô
(*
NŸU£d
){

15870 #i‡
	`deföed
(
__APPLE__
Ë&& !deföed(
SQLITE_WITHOUT_ZONEMALLOC
)

15871 
˝uCou¡
;

15872 
size_t
 
Àn
;

15873 if–
_sqlôeZ⁄e_
 ){

15874  
SQLITE_OK
;

15876 
Àn
 = (
˝uCou¡
);

15878 
	`sys˘lby«me
("hw.n˝u", &
˝uCou¡
, &
Àn
, 
NULL
, 0);

15879 if–
˝uCou¡
>1 ){

15881 
_sqlôeZ⁄e_
 = 
	`mÆloc_deÁu…_z⁄e
();

15885 
boﬁ
 
suc˚ss
;

15886 
mÆloc_z⁄e_t
* 
√wz⁄e
 = 
	`mÆloc_¸óã_z⁄e
(4096, 0);

15887 
	`mÆloc_£t_z⁄e_«me
(
√wz⁄e
, "Sqlite_Heap");

15889 
suc˚ss
 = 
	`OSAtomicCom∑ªAndSw≠PåB¨rõr
(
NULL
, 
√wz⁄e
,

15890 (* vﬁ©ûê*)&
_sqlôeZ⁄e_
);

15891 }!
_sqlôeZ⁄e_
);

15892 if–!
suc˚ss
 ){

15894 
	`mÆloc_de°roy_z⁄e
(
√wz⁄e
);

15898 
	`UNUSED_PARAMETER
(
NŸU£d
);

15899  
SQLITE_OK
;

15905 
	`sqlôe3MemShutdown
(*
NŸU£d
){

15906 
	`UNUSED_PARAMETER
(
NŸU£d
);

15916 
SQLITE_PRIVATE
 
	`sqlôe3MemSëDeÁu…
(){

15917 c⁄° 
sqlôe3_mem_mëhods
 
deÁu…Mëhods
 = {

15918 
sqlôe3MemMÆloc
,

15919 
sqlôe3MemFªe
,

15920 
sqlôe3MemRóŒoc
,

15921 
sqlôe3MemSize
,

15922 
sqlôe3MemRoundup
,

15923 
sqlôe3MemInô
,

15924 
sqlôe3MemShutdown
,

15927 
	`sqlôe3_c⁄fig
(
SQLITE_CONFIG_MALLOC
, &
deÁu…Mëhods
);

15960 #ifde‡
SQLITE_MEMDEBUG


15965 #ifde‡
__GLIBC__


15966 
	`backåa˚
(**,);

15967 
	`backåa˚_symbﬁs_fd
(*const*,,);

15969 
	#backåa˚
(
A
,
B
Ë1

	)

15970 
	#backåa˚_symbﬁs_fd
(
A
,
B
,
C
)

	)

15987 
	sMemBlockHdr
 {

15988 
i64
 
iSize
;

15989 
MemBlockHdr
 *
pNext
, *
pPªv
;

15990 
nBackåa˚
;

15991 
nBackåa˚SlŸs
;

15992 
u8
 
nTôÀ
;

15993 
u8
 
eTy≥
;

15994 
iF‹eGu¨d
;

16000 
	#FOREGUARD
 0x80F5E153

	)

16001 
	#REARGUARD
 0xE4676B53

	)

16006 
	#NCSIZE
 1000

	)

16019 
sqlôe3_muãx
 *
muãx
;

16024 
MemBlockHdr
 *
pFú°
;

16025 
MemBlockHdr
 *
pLa°
;

16030 
nBackåa˚
;

16031 (*
xBackåa˚
)(, , **);

16036 
nTôÀ
;

16037 
zTôÀ
[100];

16043 
dißŒow
;

16051 
nAŒoc
[
NCSIZE
];

16052 
nCuºít
[
NCSIZE
];

16053 
mxCuºít
[
NCSIZE
];

16055 } 
mem
;

16061 
	`adju°Sèts
(
iSize
, 
ö¸emít
){

16062 
i
 = 
	`ROUND8
(
iSize
)/8;

16063 if–
i
>
NCSIZE
-1 ){

16064 
i
 = 
NCSIZE
 - 1;

16066 if–
ö¸emít
>0 ){

16067 
mem
.
nAŒoc
[
i
]++;

16068 
mem
.
nCuºít
[
i
]++;

16069 if–
mem
.
nCuºít
[
i
]>mem.
mxCuºít
[i] ){

16070 
mem
.
mxCuºít
[
i
] = mem.
nCuºít
[i];

16073 
mem
.
nCuºít
[
i
]--;

16074 
	`as£π
–
mem
.
nCuºít
[
i
]>=0 );

16084 
MemBlockHdr
 *
	`sqlôe3MemsysGëHódî
(*
pAŒoˇti⁄
){

16085 
MemBlockHdr
 *
p
;

16086 *
pI¡
;

16087 
u8
 *
pU8
;

16088 
nRe£rve
;

16090 
p
 = (
MemBlockHdr
*)
pAŒoˇti⁄
;

16091 
p
--;

16092 
	`as£π
–
p
->
iF‹eGu¨d
==()
FOREGUARD
 );

16093 
nRe£rve
 = 
	`ROUND8
(
p
->
iSize
);

16094 
pI¡
 = (*)
pAŒoˇti⁄
;

16095 
pU8
 = (
u8
*)
pAŒoˇti⁄
;

16096 
	`as£π
–
pI¡
[
nRe£rve
/()]==()
REARGUARD
 );

16101  
nRe£rve
-- > 
p
->
iSize
 ) 
	`as£π
–
pU8
[nReserve]==0x65 );

16102  
p
;

16108 
	`sqlôe3MemSize
(*
p
){

16109 
MemBlockHdr
 *
pHdr
;

16110 if–!
p
 ){

16113 
pHdr
 = 
	`sqlôe3MemsysGëHódî
(
p
);

16114  ()
pHdr
->
iSize
;

16120 
	`sqlôe3MemInô
(*
NŸU£d
){

16121 
	`UNUSED_PARAMETER
(
NŸU£d
);

16122 
	`as£π
–((
MemBlockHdr
)&7) == 0 );

16123 if–!
sqlôe3GlobÆC⁄fig
.
bMem°©
 ){

16126 
mem
.
muãx
 = 
	`sqlôe3MuãxAŒoc
(
SQLITE_MUTEX_STATIC_MEM
);

16128  
SQLITE_OK
;

16134 
	`sqlôe3MemShutdown
(*
NŸU£d
){

16135 
	`UNUSED_PARAMETER
(
NŸU£d
);

16136 
mem
.
muãx
 = 0;

16142 
	`sqlôe3MemRoundup
(
n
){

16143  
	`ROUND8
(
n
);

16151 
	`øndomFûl
(*
pBuf
, 
nByã
){

16152 
x
, 
y
, 
r
;

16153 
x
 = 
	`SQLITE_PTR_TO_INT
(
pBuf
);

16154 
y
 = 
nByã
 | 1;

16155  
nByã
 >= 4 ){

16156 
x
 = (x>>1) ^ (-()(x&1) & 0xd0000001);

16157 
y
 = y*1103515245 + 12345;

16158 
r
 = 
x
 ^ 
y
;

16159 *(*)
pBuf
 = 
r
;

16160 
pBuf
 += 4;

16161 
nByã
 -= 4;

16163  
nByã
-- > 0 ){

16164 
x
 = (x>>1) ^ (-()(x&1) & 0xd0000001);

16165 
y
 = y*1103515245 + 12345;

16166 
r
 = 
x
 ^ 
y
;

16167 *(
pBuf
++Ë
r
 & 0xff;

16174 *
	`sqlôe3MemMÆloc
(
nByã
){

16175 
MemBlockHdr
 *
pHdr
;

16176 **
pBt
;

16177 *
z
;

16178 *
pI¡
;

16179 *
p
 = 0;

16180 
tŸÆSize
;

16181 
nRe£rve
;

16182 
	`sqlôe3_muãx_íãr
(
mem
.
muãx
);

16183 
	`as£π
–
mem
.
dißŒow
==0 );

16184 
nRe£rve
 = 
	`ROUND8
(
nByã
);

16185 
tŸÆSize
 = 
nRe£rve
 + (*
pHdr
) + () +

16186 
mem
.
nBackåa˚
*(*Ë+ mem.
nTôÀ
;

16187 
p
 = 
	`mÆloc
(
tŸÆSize
);

16188 if–
p
 ){

16189 
z
 = 
p
;

16190 
pBt
 = (**)&
z
[
mem
.
nTôÀ
];

16191 
pHdr
 = (
MemBlockHdr
*)&
pBt
[
mem
.
nBackåa˚
];

16192 
pHdr
->
pNext
 = 0;

16193 
pHdr
->
pPªv
 = 
mem
.
pLa°
;

16194 if–
mem
.
pLa°
 ){

16195 
mem
.
pLa°
->
pNext
 = 
pHdr
;

16197 
mem
.
pFú°
 = 
pHdr
;

16199 
mem
.
pLa°
 = 
pHdr
;

16200 
pHdr
->
iF‹eGu¨d
 = 
FOREGUARD
;

16201 
pHdr
->
eTy≥
 = 
MEMTYPE_HEAP
;

16202 
pHdr
->
nBackåa˚SlŸs
 = 
mem
.
nBackåa˚
;

16203 
pHdr
->
nTôÀ
 = 
mem
.nTitle;

16204 if–
mem
.
nBackåa˚
 ){

16205 *
aAddr
[40];

16206 
pHdr
->
nBackåa˚
 = 
	`backåa˚
(
aAddr
, 
mem
.nBacktrace+1)-1;

16207 
	`mem˝y
(
pBt
, &
aAddr
[1], 
pHdr
->
nBackåa˚
*(*));

16208 
	`as£π
(
pBt
[0]);

16209 if–
mem
.
xBackåa˚
 ){

16210 
mem
.
	`xBackåa˚
(
nByã
, 
pHdr
->
nBackåa˚
-1, &
aAddr
[1]);

16213 
pHdr
->
nBackåa˚
 = 0;

16215 if–
mem
.
nTôÀ
 ){

16216 
	`mem˝y
(
z
, 
mem
.
zTôÀ
, mem.
nTôÀ
);

16218 
pHdr
->
iSize
 = 
nByã
;

16219 
	`adju°Sèts
(
nByã
, +1);

16220 
pI¡
 = (*)&
pHdr
[1];

16221 
pI¡
[
nRe£rve
/()] = 
REARGUARD
;

16222 
	`øndomFûl
((*)
pI¡
, 
nByã
);

16223 
	`mem£t
(((*)
pI¡
)+
nByã
, 0x65, 
nRe£rve
-nByte);

16224 
p
 = (*)
pI¡
;

16226 
	`sqlôe3_muãx_Àave
(
mem
.
muãx
);

16227  
p
;

16233 
	`sqlôe3MemFªe
(*
pPri‹
){

16234 
MemBlockHdr
 *
pHdr
;

16235 **
pBt
;

16236 *
z
;

16237 
	`as£π
–
sqlôe3GlobÆC⁄fig
.
bMem°©
 || sqlôe3GlobÆC⁄fig.
bC‹eMuãx
==0

16238 || 
mem
.
muãx
!=0 );

16239 
pHdr
 = 
	`sqlôe3MemsysGëHódî
(
pPri‹
);

16240 
pBt
 = (**)
pHdr
;

16241 
pBt
 -
pHdr
->
nBackåa˚SlŸs
;

16242 
	`sqlôe3_muãx_íãr
(
mem
.
muãx
);

16243 if–
pHdr
->
pPªv
 ){

16244 
	`as£π
–
pHdr
->
pPªv
->
pNext
==pHdr );

16245 
pHdr
->
pPªv
->
pNext
 =ÖHdr->pNext;

16247 
	`as£π
–
mem
.
pFú°
==
pHdr
 );

16248 
mem
.
pFú°
 = 
pHdr
->
pNext
;

16250 if–
pHdr
->
pNext
 ){

16251 
	`as£π
–
pHdr
->
pNext
->
pPªv
==pHdr );

16252 
pHdr
->
pNext
->
pPªv
 =ÖHdr->pPrev;

16254 
	`as£π
–
mem
.
pLa°
==
pHdr
 );

16255 
mem
.
pLa°
 = 
pHdr
->
pPªv
;

16257 
z
 = (*)
pBt
;

16258 
z
 -
pHdr
->
nTôÀ
;

16259 
	`adju°Sèts
(()
pHdr
->
iSize
, -1);

16260 
	`øndomFûl
(
z
, (*)*
pHdr
->
nBackåa˚SlŸs
 + (*pHdr) +

16261 ()
pHdr
->
iSize
 + (Ë+ÖHdr->
nTôÀ
);

16262 
	`‰ì
(
z
);

16263 
	`sqlôe3_muãx_Àave
(
mem
.
muãx
);

16275 *
	`sqlôe3MemRóŒoc
(*
pPri‹
, 
nByã
){

16276 
MemBlockHdr
 *
pOldHdr
;

16277 *
pNew
;

16278 
	`as£π
–
mem
.
dißŒow
==0 );

16279 
	`as£π
–(
nByã
 & 7)==0 );

16280 
pOldHdr
 = 
	`sqlôe3MemsysGëHódî
(
pPri‹
);

16281 
pNew
 = 
	`sqlôe3MemMÆloc
(
nByã
);

16282 if–
pNew
 ){

16283 
	`mem˝y
(
pNew
, 
pPri‹
, ()(
nByã
<
pOldHdr
->
iSize
 ?ÇByte :ÖOldHdr->iSize));

16284 if–
nByã
>
pOldHdr
->
iSize
 ){

16285 
	`øndomFûl
(&((*)
pNew
)[
pOldHdr
->
iSize
], 
nByã
 - ()pOldHdr->iSize);

16287 
	`sqlôe3MemFªe
(
pPri‹
);

16289  
pNew
;

16296 
SQLITE_PRIVATE
 
	`sqlôe3MemSëDeÁu…
(){

16297 c⁄° 
sqlôe3_mem_mëhods
 
deÁu…Mëhods
 = {

16298 
sqlôe3MemMÆloc
,

16299 
sqlôe3MemFªe
,

16300 
sqlôe3MemRóŒoc
,

16301 
sqlôe3MemSize
,

16302 
sqlôe3MemRoundup
,

16303 
sqlôe3MemInô
,

16304 
sqlôe3MemShutdown
,

16307 
	`sqlôe3_c⁄fig
(
SQLITE_CONFIG_MALLOC
, &
deÁu…Mëhods
);

16313 
SQLITE_PRIVATE
 
	`sqlôe3MemdebugSëTy≥
(*
p
, 
u8
 
eTy≥
){

16314 if–
p
 && 
sqlôe3GlobÆC⁄fig
.
m
.
xMÆloc
==
sqlôe3MemMÆloc
 ){

16315 
MemBlockHdr
 *
pHdr
;

16316 
pHdr
 = 
	`sqlôe3MemsysGëHódî
(
p
);

16317 
	`as£π
–
pHdr
->
iF‹eGu¨d
==
FOREGUARD
 );

16318 
pHdr
->
eTy≥
 =ÉType;

16331 
SQLITE_PRIVATE
 
	`sqlôe3MemdebugHasTy≥
(*
p
, 
u8
 
eTy≥
){

16332 
rc
 = 1;

16333 if–
p
 && 
sqlôe3GlobÆC⁄fig
.
m
.
xMÆloc
==
sqlôe3MemMÆloc
 ){

16334 
MemBlockHdr
 *
pHdr
;

16335 
pHdr
 = 
	`sqlôe3MemsysGëHódî
(
p
);

16336 
	`as£π
–
pHdr
->
iF‹eGu¨d
==
FOREGUARD
 );

16337 if–(
pHdr
->
eTy≥
&eType)==0 ){

16338 
rc
 = 0;

16341  
rc
;

16353 
SQLITE_PRIVATE
 
	`sqlôe3MemdebugNoTy≥
(*
p
, 
u8
 
eTy≥
){

16354 
rc
 = 1;

16355 if–
p
 && 
sqlôe3GlobÆC⁄fig
.
m
.
xMÆloc
==
sqlôe3MemMÆloc
 ){

16356 
MemBlockHdr
 *
pHdr
;

16357 
pHdr
 = 
	`sqlôe3MemsysGëHódî
(
p
);

16358 
	`as£π
–
pHdr
->
iF‹eGu¨d
==
FOREGUARD
 );

16359 if–(
pHdr
->
eTy≥
&eType)!=0 ){

16360 
rc
 = 0;

16363  
rc
;

16371 
SQLITE_PRIVATE
 
	`sqlôe3MemdebugBackåa˚
(
dïth
){

16372 if–
dïth
<0 ){ depth = 0; }

16373 if–
dïth
>20 ){ depth = 20; }

16374 
dïth
 = (depth+1)&0xfe;

16375 
mem
.
nBackåa˚
 = 
dïth
;

16378 
SQLITE_PRIVATE
 
	`sqlôe3MemdebugBackåa˚CÆlback
((*
xBackåa˚
)(, , **)){

16379 
mem
.
xBackåa˚
 = xBacktrace;

16385 
SQLITE_PRIVATE
 
	`sqlôe3MemdebugSëtôÀ
(c⁄° *
zTôÀ
){

16386 
n
 = 
	`sqlôe3SåÀn30
(
zTôÀ
) + 1;

16387 
	`sqlôe3_muãx_íãr
(
mem
.
muãx
);

16388 if–
n
>=(
mem
.
zTôÀ
) )Ç = (mem.zTitle)-1;

16389 
	`mem˝y
(
mem
.
zTôÀ
, zTôÀ, 
n
);

16390 
mem
.
zTôÀ
[
n
] = 0;

16391 
mem
.
nTôÀ
 = 
	`ROUND8
(
n
);

16392 
	`sqlôe3_muãx_Àave
(
mem
.
muãx
);

16395 
SQLITE_PRIVATE
 
	`sqlôe3MemdebugSync
(){

16396 
MemBlockHdr
 *
pHdr
;

16397 
pHdr
=
mem
.
pFú°
;ÖHdr;ÖHdrıHdr->
pNext
){

16398 **
pBt
 = (**)
pHdr
;

16399 
pBt
 -
pHdr
->
nBackåa˚SlŸs
;

16400 
mem
.
	`xBackåa˚
(()
pHdr
->
iSize
,ÖHdr->
nBackåa˚
-1, &
pBt
[1]);

16408 
SQLITE_PRIVATE
 
	`sqlôe3MemdebugDump
(c⁄° *
zFûíame
){

16409 
FILE
 *
out
;

16410 
MemBlockHdr
 *
pHdr
;

16411 **
pBt
;

16412 
i
;

16413 
out
 = 
	`f›í
(
zFûíame
, "w");

16414 if–
out
==0 ){

16415 
	`Ârötf
(
°dîr
, "** UnableÅo output memory debug outputÜog: %s **\n",

16416 
zFûíame
);

16419 
pHdr
=
mem
.
pFú°
;ÖHdr;ÖHdrıHdr->
pNext
){

16420 *
z
 = (*)
pHdr
;

16421 
z
 -
pHdr
->
nBackåa˚SlŸs
*(*Ë+ÖHdr->
nTôÀ
;

16422 
	`Ârötf
(
out
, "**** %lld bytesát %p from %s ****\n",

16423 
pHdr
->
iSize
, &pHdr[1],ÖHdr->
nTôÀ
 ? 
z
 : "???");

16424 if–
pHdr
->
nBackåa˚
 ){

16425 
	`fÊush
(
out
);

16426 
pBt
 = (**)
pHdr
;

16427 
pBt
 -
pHdr
->
nBackåa˚SlŸs
;

16428 
	`backåa˚_symbﬁs_fd
(
pBt
, 
pHdr
->
nBackåa˚
, 
	`fûío
(
out
));

16429 
	`Ârötf
(
out
, "\n");

16432 
	`Ârötf
(
out
, "COUNTS:\n");

16433 
i
=0; i<
NCSIZE
-1; i++){

16434 if–
mem
.
nAŒoc
[
i
] ){

16435 
	`Ârötf
(
out
, " %5d: %10d %10d %10d\n",

16436 
i
*8, 
mem
.
nAŒoc
[i], mem.
nCuºít
[i], mem.
mxCuºít
[i]);

16439 if–
mem
.
nAŒoc
[
NCSIZE
-1] ){

16440 
	`Ârötf
(
out
, " %5d: %10d %10d %10d\n",

16441 
NCSIZE
*8-8, 
mem
.
nAŒoc
[NCSIZE-1],

16442 
mem
.
nCuºít
[
NCSIZE
-1], mem.
mxCuºít
[NCSIZE-1]);

16444 
	`f˛o£
(
out
);

16450 
SQLITE_PRIVATE
 
	`sqlôe3MemdebugMÆlocCou¡
(){

16451 
i
;

16452 
nTŸÆ
 = 0;

16453 
i
=0; i<
NCSIZE
; i++){

16454 
nTŸÆ
 +
mem
.
nAŒoc
[
i
];

16456  
nTŸÆ
;

16497 #ifde‡
SQLITE_ENABLE_MEMSYS3


16502 
	#MX_SMALL
 10

	)

16508 
	#N_HASH
 61

	)

16542 
Mem3Block
 
	tMem3Block
;

16543 
	sMem3Block
 {

16546 
u32
 
¥evSize
;

16547 
u32
 
size4x
;

16548 } 
hdr
;

16550 
u32
 
√xt
;

16551 
u32
 
¥ev
;

16552 } 
li°
;

16553 } 
u
;

16562 
SQLITE_WSD
 
	sMem3GlobÆ
 {

16567 
u32
 
nPoﬁ
;

16568 
Mem3Block
 *
aPoﬁ
;

16573 
Æ¨mBusy
;

16578 
sqlôe3_muãx
 *
muãx
;

16583 
u32
 
mnMa°î
;

16591 
u32
 
iMa°î
;

16592 
u32
 
szMa°î
;

16599 
u32
 
aiSmÆl
[
MX_SMALL
-1];

16600 
u32
 
aiHash
[
N_HASH
];

16601 } 
mem3
 = { 97535575 };

16603 
	#mem3
 
	`GLOBAL
(
Mem3GlobÆ
, 
mem3
)

	)

16609 
	`memsys3U∆ökFromLi°
(
u32
 
i
, u32 *
pRoŸ
){

16610 
u32
 
√xt
 = 
mem3
.
aPoﬁ
[
i
].
u
.
li°
.next;

16611 
u32
 
¥ev
 = 
mem3
.
aPoﬁ
[
i
].
u
.
li°
.prev;

16612 
	`as£π
–
	`sqlôe3_muãx_hñd
(
mem3
.
muãx
) );

16613 if–
¥ev
==0 ){

16614 *
pRoŸ
 = 
√xt
;

16616 
mem3
.
aPoﬁ
[
¥ev
].
u
.
li°
.
√xt
 =Çext;

16618 if–
√xt
 ){

16619 
mem3
.
aPoﬁ
[
√xt
].
u
.
li°
.
¥ev
 =Örev;

16621 
mem3
.
aPoﬁ
[
i
].
u
.
li°
.
√xt
 = 0;

16622 
mem3
.
aPoﬁ
[
i
].
u
.
li°
.
¥ev
 = 0;

16629 
	`memsys3U∆ök
(
u32
 
i
){

16630 
u32
 
size
, 
hash
;

16631 
	`as£π
–
	`sqlôe3_muãx_hñd
(
mem3
.
muãx
) );

16632 
	`as£π
–(
mem3
.
aPoﬁ
[
i
-1].
u
.
hdr
.
size4x
 & 1)==0 );

16633 
	`as£π
–
i
>=1 );

16634 
size
 = 
mem3
.
aPoﬁ
[
i
-1].
u
.
hdr
.
size4x
/4;

16635 
	`as£π
–
size
==
mem3
.
aPoﬁ
[
i
+size-1].
u
.
hdr
.
¥evSize
 );

16636 
	`as£π
–
size
>=2 );

16637 if–
size
 <
MX_SMALL
 ){

16638 
	`memsys3U∆ökFromLi°
(
i
, &
mem3
.
aiSmÆl
[
size
-2]);

16640 
hash
 = 
size
 % 
N_HASH
;

16641 
	`memsys3U∆ökFromLi°
(
i
, &
mem3
.
aiHash
[
hash
]);

16649 
	`memsys3LökI¡oLi°
(
u32
 
i
, u32 *
pRoŸ
){

16650 
	`as£π
–
	`sqlôe3_muãx_hñd
(
mem3
.
muãx
) );

16651 
mem3
.
aPoﬁ
[
i
].
u
.
li°
.
√xt
 = *
pRoŸ
;

16652 
mem3
.
aPoﬁ
[
i
].
u
.
li°
.
¥ev
 = 0;

16653 if–*
pRoŸ
 ){

16654 
mem3
.
aPoﬁ
[*
pRoŸ
].
u
.
li°
.
¥ev
 = 
i
;

16656 *
pRoŸ
 = 
i
;

16663 
	`memsys3Lök
(
u32
 
i
){

16664 
u32
 
size
, 
hash
;

16665 
	`as£π
–
	`sqlôe3_muãx_hñd
(
mem3
.
muãx
) );

16666 
	`as£π
–
i
>=1 );

16667 
	`as£π
–(
mem3
.
aPoﬁ
[
i
-1].
u
.
hdr
.
size4x
 & 1)==0 );

16668 
size
 = 
mem3
.
aPoﬁ
[
i
-1].
u
.
hdr
.
size4x
/4;

16669 
	`as£π
–
size
==
mem3
.
aPoﬁ
[
i
+size-1].
u
.
hdr
.
¥evSize
 );

16670 
	`as£π
–
size
>=2 );

16671 if–
size
 <
MX_SMALL
 ){

16672 
	`memsys3LökI¡oLi°
(
i
, &
mem3
.
aiSmÆl
[
size
-2]);

16674 
hash
 = 
size
 % 
N_HASH
;

16675 
	`memsys3LökI¡oLi°
(
i
, &
mem3
.
aiHash
[
hash
]);

16684 
	`memsys3E¡î
(){

16685 if–
sqlôe3GlobÆC⁄fig
.
bMem°©
==0 && 
mem3
.
muãx
==0 ){

16686 
mem3
.
muãx
 = 
	`sqlôe3MuãxAŒoc
(
SQLITE_MUTEX_STATIC_MEM
);

16688 
	`sqlôe3_muãx_íãr
(
mem3
.
muãx
);

16690 
	`memsys3Lóve
(){

16691 
	`sqlôe3_muãx_Àave
(
mem3
.
muãx
);

16697 
	`memsys3OutOfMem‹y
(
nByã
){

16698 if–!
mem3
.
Æ¨mBusy
 ){

16699 
mem3
.
Æ¨mBusy
 = 1;

16700 
	`as£π
–
	`sqlôe3_muãx_hñd
(
mem3
.
muãx
) );

16701 
	`sqlôe3_muãx_Àave
(
mem3
.
muãx
);

16702 
	`sqlôe3_ªÀa£_mem‹y
(
nByã
);

16703 
	`sqlôe3_muãx_íãr
(
mem3
.
muãx
);

16704 
mem3
.
Æ¨mBusy
 = 0;

16714 *
	`memsys3Checkout
(
u32
 
i
, u32 
nBlock
){

16715 
u32
 
x
;

16716 
	`as£π
–
	`sqlôe3_muãx_hñd
(
mem3
.
muãx
) );

16717 
	`as£π
–
i
>=1 );

16718 
	`as£π
–
mem3
.
aPoﬁ
[
i
-1].
u
.
hdr
.
size4x
/4==
nBlock
 );

16719 
	`as£π
–
mem3
.
aPoﬁ
[
i
+
nBlock
-1].
u
.
hdr
.
¥evSize
==nBlock );

16720 
x
 = 
mem3
.
aPoﬁ
[
i
-1].
u
.
hdr
.
size4x
;

16721 
mem3
.
aPoﬁ
[
i
-1].
u
.
hdr
.
size4x
 = 
nBlock
*4 | 1 | (
x
&2);

16722 
mem3
.
aPoﬁ
[
i
+
nBlock
-1].
u
.
hdr
.
¥evSize
 =ÇBlock;

16723 
mem3
.
aPoﬁ
[
i
+
nBlock
-1].
u
.
hdr
.
size4x
 |= 2;

16724  &
mem3
.
aPoﬁ
[
i
];

16732 *
	`memsys3FromMa°î
(
u32
 
nBlock
){

16733 
	`as£π
–
	`sqlôe3_muãx_hñd
(
mem3
.
muãx
) );

16734 
	`as£π
–
mem3
.
szMa°î
>=
nBlock
 );

16735 if–
nBlock
>=
mem3
.
szMa°î
-1 ){

16737 *
p
 = 
	`memsys3Checkout
(
mem3
.
iMa°î
, mem3.
szMa°î
);

16738 
mem3
.
iMa°î
 = 0;

16739 
mem3
.
szMa°î
 = 0;

16740 
mem3
.
mnMa°î
 = 0;

16741  
p
;

16744 
u32
 
√wi
, 
x
;

16745 
√wi
 = 
mem3
.
iMa°î
 + mem3.
szMa°î
 - 
nBlock
;

16746 
	`as£π
–
√wi
 > 
mem3
.
iMa°î
+1 );

16747 
mem3
.
aPoﬁ
[mem3.
iMa°î
+mem3.
szMa°î
-1].
u
.
hdr
.
¥evSize
 = 
nBlock
;

16748 
mem3
.
aPoﬁ
[mem3.
iMa°î
+mem3.
szMa°î
-1].
u
.
hdr
.
size4x
 |= 2;

16749 
mem3
.
aPoﬁ
[
√wi
-1].
u
.
hdr
.
size4x
 = 
nBlock
*4 + 1;

16750 
mem3
.
szMa°î
 -
nBlock
;

16751 
mem3
.
aPoﬁ
[
√wi
-1].
u
.
hdr
.
¥evSize
 = mem3.
szMa°î
;

16752 
x
 = 
mem3
.
aPoﬁ
[mem3.
iMa°î
-1].
u
.
hdr
.
size4x
 & 2;

16753 
mem3
.
aPoﬁ
[mem3.
iMa°î
-1].
u
.
hdr
.
size4x
 = mem3.
szMa°î
*4 | 
x
;

16754 if–
mem3
.
szMa°î
 < mem3.
mnMa°î
 ){

16755 
mem3
.
mnMa°î
 = mem3.
szMa°î
;

16757  (*)&
mem3
.
aPoﬁ
[
√wi
];

16777 
	`memsys3Mîge
(
u32
 *
pRoŸ
){

16778 
u32
 
iNext
, 
¥ev
, 
size
, 
i
, 
x
;

16780 
	`as£π
–
	`sqlôe3_muãx_hñd
(
mem3
.
muãx
) );

16781 
i
=*
pRoŸ
; i>0; i=
iNext
){

16782 
iNext
 = 
mem3
.
aPoﬁ
[
i
].
u
.
li°
.
√xt
;

16783 
size
 = 
mem3
.
aPoﬁ
[
i
-1].
u
.
hdr
.
size4x
;

16784 
	`as£π
–(
size
&1)==0 );

16785 if–(
size
&2)==0 ){

16786 
	`memsys3U∆ökFromLi°
(
i
, 
pRoŸ
);

16787 
	`as£π
–
i
 > 
mem3
.
aPoﬁ
[i-1].
u
.
hdr
.
¥evSize
 );

16788 
¥ev
 = 
i
 - 
mem3
.
aPoﬁ
[i-1].
u
.
hdr
.
¥evSize
;

16789 if–
¥ev
==
iNext
 ){

16790 
iNext
 = 
mem3
.
aPoﬁ
[
¥ev
].
u
.
li°
.
√xt
;

16792 
	`memsys3U∆ök
(
¥ev
);

16793 
size
 = 
i
 + size/4 - 
¥ev
;

16794 
x
 = 
mem3
.
aPoﬁ
[
¥ev
-1].
u
.
hdr
.
size4x
 & 2;

16795 
mem3
.
aPoﬁ
[
¥ev
-1].
u
.
hdr
.
size4x
 = 
size
*4 | 
x
;

16796 
mem3
.
aPoﬁ
[
¥ev
+
size
-1].
u
.
hdr
.
¥evSize
 = size;

16797 
	`memsys3Lök
(
¥ev
);

16798 
i
 = 
¥ev
;

16800 
size
 /= 4;

16802 if–
size
>
mem3
.
szMa°î
 ){

16803 
mem3
.
iMa°î
 = 
i
;

16804 
mem3
.
szMa°î
 = 
size
;

16816 *
	`memsys3MÆlocUnß„
(
nByã
){

16817 
u32
 
i
;

16818 
u32
 
nBlock
;

16819 
u32
 
toFªe
;

16821 
	`as£π
–
	`sqlôe3_muãx_hñd
(
mem3
.
muãx
) );

16822 
	`as£π
–(
Mem3Block
)==8 );

16823 if–
nByã
<=12 ){

16824 
nBlock
 = 2;

16826 
nBlock
 = (
nByã
 + 11)/8;

16828 
	`as£π
–
nBlock
>=2 );

16835 if–
nBlock
 <
MX_SMALL
 ){

16836 
i
 = 
mem3
.
aiSmÆl
[
nBlock
-2];

16837 if–
i
>0 ){

16838 
	`memsys3U∆ökFromLi°
(
i
, &
mem3
.
aiSmÆl
[
nBlock
-2]);

16839  
	`memsys3Checkout
(
i
, 
nBlock
);

16842 
hash
 = 
nBlock
 % 
N_HASH
;

16843 
i
=
mem3
.
aiHash
[
hash
]; i>0; i=mem3.
aPoﬁ
[i].
u
.
li°
.
√xt
){

16844 if–
mem3
.
aPoﬁ
[
i
-1].
u
.
hdr
.
size4x
/4==
nBlock
 ){

16845 
	`memsys3U∆ökFromLi°
(
i
, &
mem3
.
aiHash
[
hash
]);

16846  
	`memsys3Checkout
(
i
, 
nBlock
);

16855 if–
mem3
.
szMa°î
>=
nBlock
 ){

16856  
	`memsys3FromMa°î
(
nBlock
);

16867 
toFªe
=
nBlock
*16;ÅoFªe<(
mem3
.
nPoﬁ
*16);ÅoFree *= 2){

16868 
	`memsys3OutOfMem‹y
(
toFªe
);

16869 if–
mem3
.
iMa°î
 ){

16870 
	`memsys3Lök
(
mem3
.
iMa°î
);

16871 
mem3
.
iMa°î
 = 0;

16872 
mem3
.
szMa°î
 = 0;

16874 
i
=0; i<
N_HASH
; i++){

16875 
	`memsys3Mîge
(&
mem3
.
aiHash
[
i
]);

16877 
i
=0; i<
MX_SMALL
-1; i++){

16878 
	`memsys3Mîge
(&
mem3
.
aiSmÆl
[
i
]);

16880 if–
mem3
.
szMa°î
 ){

16881 
	`memsys3U∆ök
(
mem3
.
iMa°î
);

16882 if–
mem3
.
szMa°î
>=
nBlock
 ){

16883  
	`memsys3FromMa°î
(
nBlock
);

16898 
	`memsys3FªeUnß„
(*
pOld
){

16899 
Mem3Block
 *
p
 = (Mem3Block*)
pOld
;

16900 
i
;

16901 
u32
 
size
, 
x
;

16902 
	`as£π
–
	`sqlôe3_muãx_hñd
(
mem3
.
muãx
) );

16903 
	`as£π
–
p
>
mem3
.
aPoﬁ
 &&Ö<&mem3.aPoﬁ[mem3.
nPoﬁ
] );

16904 
i
 = 
p
 - 
mem3
.
aPoﬁ
;

16905 
	`as£π
–(
mem3
.
aPoﬁ
[
i
-1].
u
.
hdr
.
size4x
&1)==1 );

16906 
size
 = 
mem3
.
aPoﬁ
[
i
-1].
u
.
hdr
.
size4x
/4;

16907 
	`as£π
–
i
+
size
<=
mem3
.
nPoﬁ
+1 );

16908 
mem3
.
aPoﬁ
[
i
-1].
u
.
hdr
.
size4x
 &= ~1;

16909 
mem3
.
aPoﬁ
[
i
+
size
-1].
u
.
hdr
.
¥evSize
 = size;

16910 
mem3
.
aPoﬁ
[
i
+
size
-1].
u
.
hdr
.
size4x
 &= ~2;

16911 
	`memsys3Lök
(
i
);

16914 if–
mem3
.
iMa°î
 ){

16915  (
mem3
.
aPoﬁ
[mem3.
iMa°î
-1].
u
.
hdr
.
size4x
&2)==0 ){

16916 
size
 = 
mem3
.
aPoﬁ
[mem3.
iMa°î
-1].
u
.
hdr
.
¥evSize
;

16917 
mem3
.
iMa°î
 -
size
;

16918 
mem3
.
szMa°î
 +
size
;

16919 
	`memsys3U∆ök
(
mem3
.
iMa°î
);

16920 
x
 = 
mem3
.
aPoﬁ
[mem3.
iMa°î
-1].
u
.
hdr
.
size4x
 & 2;

16921 
mem3
.
aPoﬁ
[mem3.
iMa°î
-1].
u
.
hdr
.
size4x
 = mem3.
szMa°î
*4 | 
x
;

16922 
mem3
.
aPoﬁ
[mem3.
iMa°î
+mem3.
szMa°î
-1].
u
.
hdr
.
¥evSize
 = mem3.szMaster;

16924 
x
 = 
mem3
.
aPoﬁ
[mem3.
iMa°î
-1].
u
.
hdr
.
size4x
 & 2;

16925  (
mem3
.
aPoﬁ
[mem3.
iMa°î
+mem3.
szMa°î
-1].
u
.
hdr
.
size4x
&1)==0 ){

16926 
	`memsys3U∆ök
(
mem3
.
iMa°î
+mem3.
szMa°î
);

16927 
mem3
.
szMa°î
 +mem3.
aPoﬁ
[mem3.
iMa°î
+mem3.szMa°î-1].
u
.
hdr
.
size4x
/4;

16928 
mem3
.
aPoﬁ
[mem3.
iMa°î
-1].
u
.
hdr
.
size4x
 = mem3.
szMa°î
*4 | 
x
;

16929 
mem3
.
aPoﬁ
[mem3.
iMa°î
+mem3.
szMa°î
-1].
u
.
hdr
.
¥evSize
 = mem3.szMaster;

16939 
	`memsys3Size
(*
p
){

16940 
Mem3Block
 *
pBlock
;

16941 if–
p
==0 )  0;

16942 
pBlock
 = (
Mem3Block
*)
p
;

16943 
	`as£π
–(
pBlock
[-1].
u
.
hdr
.
size4x
&1)!=0 );

16944  (
pBlock
[-1].
u
.
hdr
.
size4x
&~3)*2 - 4;

16950 
	`memsys3Roundup
(
n
){

16951 if–
n
<=12 ){

16954  ((
n
+11)&~7) - 4;

16961 *
	`memsys3MÆloc
(
nByãs
){

16962 
sqlôe3_öt64
 *
p
;

16963 
	`as£π
–
nByãs
>0 );

16964 
	`memsys3E¡î
();

16965 
p
 = 
	`memsys3MÆlocUnß„
(
nByãs
);

16966 
	`memsys3Lóve
();

16967  (*)
p
;

16973 
	`memsys3Fªe
(*
pPri‹
){

16974 
	`as£π
–
pPri‹
 );

16975 
	`memsys3E¡î
();

16976 
	`memsys3FªeUnß„
(
pPri‹
);

16977 
	`memsys3Lóve
();

16983 *
	`memsys3RóŒoc
(*
pPri‹
, 
nByãs
){

16984 
nOld
;

16985 *
p
;

16986 if–
pPri‹
==0 ){

16987  
	`sqlôe3_mÆloc
(
nByãs
);

16989 if–
nByãs
<=0 ){

16990 
	`sqlôe3_‰ì
(
pPri‹
);

16993 
nOld
 = 
	`memsys3Size
(
pPri‹
);

16994 if–
nByãs
<=
nOld
 &&ÇBytes>=nOld-128 ){

16995  
pPri‹
;

16997 
	`memsys3E¡î
();

16998 
p
 = 
	`memsys3MÆlocUnß„
(
nByãs
);

16999 if–
p
 ){

17000 if–
nOld
<
nByãs
 ){

17001 
	`mem˝y
(
p
, 
pPri‹
, 
nOld
);

17003 
	`mem˝y
(
p
, 
pPri‹
, 
nByãs
);

17005 
	`memsys3FªeUnß„
(
pPri‹
);

17007 
	`memsys3Lóve
();

17008  
p
;

17014 
	`memsys3Inô
(*
NŸU£d
){

17015 
	`UNUSED_PARAMETER
(
NŸU£d
);

17016 if–!
sqlôe3GlobÆC⁄fig
.
pHóp
 ){

17017  
SQLITE_ERROR
;

17021 
	`as£π
–(
Mem3Block
)==8 );

17022 
mem3
.
aPoﬁ
 = (
Mem3Block
 *)
sqlôe3GlobÆC⁄fig
.
pHóp
;

17023 
mem3
.
nPoﬁ
 = (
sqlôe3GlobÆC⁄fig
.
nHóp
 / (
Mem3Block
)) - 2;

17026 
mem3
.
szMa°î
 = mem3.
nPoﬁ
;

17027 
mem3
.
mnMa°î
 = mem3.
szMa°î
;

17028 
mem3
.
iMa°î
 = 1;

17029 
mem3
.
aPoﬁ
[0].
u
.
hdr
.
size4x
 = (mem3.
szMa°î
<<2) + 2;

17030 
mem3
.
aPoﬁ
[mem3.
nPoﬁ
].
u
.
hdr
.
¥evSize
 = mem3.nPool;

17031 
mem3
.
aPoﬁ
[mem3.
nPoﬁ
].
u
.
hdr
.
size4x
 = 1;

17033  
SQLITE_OK
;

17039 
	`memsys3Shutdown
(*
NŸU£d
){

17040 
	`UNUSED_PARAMETER
(
NŸU£d
);

17041 
mem3
.
muãx
 = 0;

17051 
SQLITE_PRIVATE
 
	`sqlôe3Memsys3Dump
(c⁄° *
zFûíame
){

17052 #ifde‡
SQLITE_DEBUG


17053 
FILE
 *
out
;

17054 
u32
 
i
, 
j
;

17055 
u32
 
size
;

17056 if–
zFûíame
==0 || zFilename[0]==0 ){

17057 
out
 = 
°dout
;

17059 
out
 = 
	`f›í
(
zFûíame
, "w");

17060 if–
out
==0 ){

17061 
	`Ârötf
(
°dîr
, "** UnableÅo output memory debug outputÜog: %s **\n",

17062 
zFûíame
);

17066 
	`memsys3E¡î
();

17067 
	`Ârötf
(
out
, "CHUNKS:\n");

17068 
i
=1; i<=
mem3
.
nPoﬁ
; i+=
size
/4){

17069 
size
 = 
mem3
.
aPoﬁ
[
i
-1].
u
.
hdr
.
size4x
;

17070 if–
size
/4<=1 ){

17071 
	`Ârötf
(
out
, "%∞sizêîr‹\n", &
mem3
.
aPoﬁ
[
i
]);

17072 
	`as£π
( 0 );

17075 if–(
size
&1)==0 && 
mem3
.
aPoﬁ
[
i
+size/4-1].
u
.
hdr
.
¥evSize
!=size/4 ){

17076 
	`Ârötf
(
out
, "%∞èû sizêd€†nŸ m©ch\n", &
mem3
.
aPoﬁ
[
i
]);

17077 
	`as£π
( 0 );

17080 if–((
mem3
.
aPoﬁ
[
i
+
size
/4-1].
u
.
hdr
.
size4x
&2)>>1)!=(size&1) ){

17081 
	`Ârötf
(
out
, "%∞èû checkouàbô i†öc‹ª˘\n", &
mem3
.
aPoﬁ
[
i
]);

17082 
	`as£π
( 0 );

17085 if–
size
&1 ){

17086 
	`Ârötf
(
out
, "%∞%6d byã†checked out\n", &
mem3
.
aPoﬁ
[
i
], (
size
/4)*8-8);

17088 
	`Ârötf
(
out
, "%∞%6d byã†‰ì%s\n", &
mem3
.
aPoﬁ
[
i
], (
size
/4)*8-8,

17089 
i
==
mem3
.
iMa°î
 ? " **master**" : "");

17092 
i
=0; i<
MX_SMALL
-1; i++){

17093 if–
mem3
.
aiSmÆl
[
i
]==0 ) ;

17094 
	`Ârötf
(
out
, "smÆl(%2d):", 
i
);

17095 
j
 = 
mem3
.
aiSmÆl
[
i
]; j>0; j=mem3.
aPoﬁ
[j].
u
.
li°
.
√xt
){

17096 
	`Ârötf
(
out
, " %p(%d)", &
mem3
.
aPoﬁ
[
j
],

17097 (
mem3
.
aPoﬁ
[
j
-1].
u
.
hdr
.
size4x
/4)*8-8);

17099 
	`Ârötf
(
out
, "\n");

17101 
i
=0; i<
N_HASH
; i++){

17102 if–
mem3
.
aiHash
[
i
]==0 ) ;

17103 
	`Ârötf
(
out
, "hash(%2d):", 
i
);

17104 
j
 = 
mem3
.
aiHash
[
i
]; j>0; j=mem3.
aPoﬁ
[j].
u
.
li°
.
√xt
){

17105 
	`Ârötf
(
out
, " %p(%d)", &
mem3
.
aPoﬁ
[
j
],

17106 (
mem3
.
aPoﬁ
[
j
-1].
u
.
hdr
.
size4x
/4)*8-8);

17108 
	`Ârötf
(
out
, "\n");

17110 
	`Ârötf
(
out
, "ma°î=%d\n", 
mem3
.
iMa°î
);

17111 
	`Ârötf
(
out
, "nowU£d=%d\n", 
mem3
.
nPoﬁ
*8 - mem3.
szMa°î
*8);

17112 
	`Ârötf
(
out
, "mxU£d=%d\n", 
mem3
.
nPoﬁ
*8 - mem3.
mnMa°î
*8);

17113 
	`sqlôe3_muãx_Àave
(
mem3
.
muãx
);

17114 if–
out
==
°dout
 ){

17115 
	`fÊush
(
°dout
);

17117 
	`f˛o£
(
out
);

17120 
	`UNUSED_PARAMETER
(
zFûíame
);

17135 
SQLITE_PRIVATE
 c⁄° 
sqlôe3_mem_mëhods
 *
	`sqlôe3MemGëMemsys3
(){

17136 c⁄° 
sqlôe3_mem_mëhods
 
mempoﬁMëhods
 = {

17137 
memsys3MÆloc
,

17138 
memsys3Fªe
,

17139 
memsys3RóŒoc
,

17140 
memsys3Size
,

17141 
memsys3Roundup
,

17142 
memsys3Inô
,

17143 
memsys3Shutdown
,

17146  &
mempoﬁMëhods
;

17208 #ifde‡
SQLITE_ENABLE_MEMSYS5


17218 
Mem5Lök
 
	tMem5Lök
;

17219 
	sMem5Lök
 {

17220 
√xt
;

17221 
¥ev
;

17229 
	#LOGMAX
 30

	)

17234 
	#CTRL_LOGSIZE
 0x1‡

	)

17235 
	#CTRL_FREE
 0x20

	)

17243 
SQLITE_WSD
 
	sMem5GlobÆ
 {

17247 
szAtom
;

17248 
nBlock
;

17249 
u8
 *
zPoﬁ
;

17254 
sqlôe3_muãx
 *
muãx
;

17259 
u64
 
nAŒoc
;

17260 
u64
 
tŸÆAŒoc
;

17261 
u64
 
tŸÆEx˚ss
;

17262 
u32
 
cuºítOut
;

17263 
u32
 
cuºítCou¡
;

17264 
u32
 
maxOut
;

17265 
u32
 
maxCou¡
;

17266 
u32
 
maxReque°
;

17273 
aiFªñi°
[
LOGMAX
+1];

17279 
u8
 *
aCål
;

17281 } 
mem5
;

17286 
	#mem5
 
	`GLOBAL
(
Mem5GlobÆ
, 
mem5
)

	)

17292 
	#MEM5LINK
(
idx
Ë((
Mem5Lök
 *)(&
mem5
.
zPoﬁ
[(idx)*mem5.
szAtom
]))

	)

17298 
	`memsys5U∆ök
(
i
, 
iLogsize
){

17299 
√xt
, 
¥ev
;

17300 
	`as£π
–
i
>=0 && i<
mem5
.
nBlock
 );

17301 
	`as£π
–
iLogsize
>=0 && iLogsize<=
LOGMAX
 );

17302 
	`as£π
–(
mem5
.
aCål
[
i
] & 
CTRL_LOGSIZE
)==
iLogsize
 );

17304 
√xt
 = 
	`MEM5LINK
(
i
)->next;

17305 
¥ev
 = 
	`MEM5LINK
(
i
)->prev;

17306 if–
¥ev
<0 ){

17307 
mem5
.
aiFªñi°
[
iLogsize
] = 
√xt
;

17309 
	`MEM5LINK
(
¥ev
)->
√xt
 =Çext;

17311 if–
√xt
>=0 ){

17312 
	`MEM5LINK
(
√xt
)->
¥ev
 =Örev;

17320 
	`memsys5Lök
(
i
, 
iLogsize
){

17321 
x
;

17322 
	`as£π
–
	`sqlôe3_muãx_hñd
(
mem5
.
muãx
) );

17323 
	`as£π
–
i
>=0 && i<
mem5
.
nBlock
 );

17324 
	`as£π
–
iLogsize
>=0 && iLogsize<=
LOGMAX
 );

17325 
	`as£π
–(
mem5
.
aCål
[
i
] & 
CTRL_LOGSIZE
)==
iLogsize
 );

17327 
x
 = 
	`MEM5LINK
(
i
)->
√xt
 = 
mem5
.
aiFªñi°
[
iLogsize
];

17328 
	`MEM5LINK
(
i
)->
¥ev
 = -1;

17329 if–
x
>=0 ){

17330 
	`as£π
–
x
<
mem5
.
nBlock
 );

17331 
	`MEM5LINK
(
x
)->
¥ev
 = 
i
;

17333 
mem5
.
aiFªñi°
[
iLogsize
] = 
i
;

17341 
	`memsys5E¡î
(){

17342 
	`sqlôe3_muãx_íãr
(
mem5
.
muãx
);

17344 
	`memsys5Lóve
(){

17345 
	`sqlôe3_muãx_Àave
(
mem5
.
muãx
);

17353 
	`memsys5Size
(*
p
){

17354 
iSize
 = 0;

17355 if–
p
 ){

17356 
i
 = ((
u8
 *)
p
-
mem5
.
zPoﬁ
)/mem5.
szAtom
;

17357 
	`as£π
–
i
>=0 && i<
mem5
.
nBlock
 );

17358 
iSize
 = 
mem5
.
szAtom
 * (1 << (mem5.
aCål
[
i
]&
CTRL_LOGSIZE
));

17360  
iSize
;

17367 
	`memsys5U∆ökFú°
(
iLogsize
){

17368 
i
;

17369 
iFú°
;

17371 
	`as£π
–
iLogsize
>=0 && iLogsize<=
LOGMAX
 );

17372 
i
 = 
iFú°
 = 
mem5
.
aiFªñi°
[
iLogsize
];

17373 
	`as£π
–
iFú°
>=0 );

17374  
i
>0 ){

17375 if–
i
<
iFú°
 ) iFirst = i;

17376 
i
 = 
	`MEM5LINK
(i)->
√xt
;

17378 
	`memsys5U∆ök
(
iFú°
, 
iLogsize
);

17379  
iFú°
;

17392 *
	`memsys5MÆlocUnß„
(
nByã
){

17393 
i
;

17394 
iBö
;

17395 
iFuŒSz
;

17396 
iLogsize
;

17399 
	`as£π
–
nByã
>0 );

17403 if–(
u32
)
nByã
>
mem5
.
maxReque°
 ){

17404 
mem5
.
maxReque°
 = 
nByã
;

17410 if–
nByã
 > 0x40000000 ){

17415 
iFuŒSz
=
mem5
.
szAtom
, 
iLogsize
=0; iFuŒSz<
nByã
; iFullSz *= 2, iLogsize++){}

17421 
iBö
=
iLogsize
; 
mem5
.
aiFªñi°
[iBö]<0 && iBö<=
LOGMAX
; iBin++){}

17422 if–
iBö
>
LOGMAX
 ){

17423 
	`ã°ˇ£
–
sqlôe3GlobÆC⁄fig
.
xLog
!=0 );

17424 
	`sqlôe3_log
(
SQLITE_NOMEM
, "ÁûedÅÿÆloˇã %u byãs", 
nByã
);

17427 
i
 = 
	`memsys5U∆ökFú°
(
iBö
);

17428  
iBö
>
iLogsize
 ){

17429 
√wSize
;

17431 
iBö
--;

17432 
√wSize
 = 1 << 
iBö
;

17433 
mem5
.
aCål
[
i
+
√wSize
] = 
CTRL_FREE
 | 
iBö
;

17434 
	`memsys5Lök
(
i
+
√wSize
, 
iBö
);

17436 
mem5
.
aCål
[
i
] = 
iLogsize
;

17439 
mem5
.
nAŒoc
++;

17440 
mem5
.
tŸÆAŒoc
 +
iFuŒSz
;

17441 
mem5
.
tŸÆEx˚ss
 +
iFuŒSz
 - 
nByã
;

17442 
mem5
.
cuºítCou¡
++;

17443 
mem5
.
cuºítOut
 +
iFuŒSz
;

17444 if–
mem5
.
maxCou¡
<mem5.
cuºítCou¡
 ) mem5.maxCount = mem5.currentCount;

17445 if–
mem5
.
maxOut
<mem5.
cuºítOut
 ) mem5.maxOut = mem5.currentOut;

17448  (*)&
mem5
.
zPoﬁ
[
i
*mem5.
szAtom
];

17454 
	`memsys5FªeUnß„
(*
pOld
){

17455 
u32
 
size
, 
iLogsize
;

17456 
iBlock
;

17461 
iBlock
 = ((
u8
 *)
pOld
-
mem5
.
zPoﬁ
)/mem5.
szAtom
;

17464 
	`as£π
–
iBlock
>=0 && iBlock<
mem5
.
nBlock
 );

17465 
	`as£π
–((
u8
 *)
pOld
-
mem5
.
zPoﬁ
)%mem5.
szAtom
==0 );

17466 
	`as£π
–(
mem5
.
aCål
[
iBlock
] & 
CTRL_FREE
)==0 );

17468 
iLogsize
 = 
mem5
.
aCål
[
iBlock
] & 
CTRL_LOGSIZE
;

17469 
size
 = 1<<
iLogsize
;

17470 
	`as£π
–
iBlock
+
size
-1<(
u32
)
mem5
.
nBlock
 );

17472 
mem5
.
aCål
[
iBlock
] |
CTRL_FREE
;

17473 
mem5
.
aCål
[
iBlock
+
size
-1] |
CTRL_FREE
;

17474 
	`as£π
–
mem5
.
cuºítCou¡
>0 );

17475 
	`as£π
–
mem5
.
cuºítOut
>=(
size
*mem5.
szAtom
) );

17476 
mem5
.
cuºítCou¡
--;

17477 
mem5
.
cuºítOut
 -
size
*mem5.
szAtom
;

17478 
	`as£π
–
mem5
.
cuºítOut
>0 || mem5.
cuºítCou¡
==0 );

17479 
	`as£π
–
mem5
.
cuºítCou¡
>0 || mem5.
cuºítOut
==0 );

17481 
mem5
.
aCål
[
iBlock
] = 
CTRL_FREE
 | 
iLogsize
;

17482  
	`ALWAYS
(
iLogsize
<
LOGMAX
) ){

17483 
iBuddy
;

17484 if–(
iBlock
>>
iLogsize
) & 1 ){

17485 
iBuddy
 = 
iBlock
 - 
size
;

17487 
iBuddy
 = 
iBlock
 + 
size
;

17489 
	`as£π
–
iBuddy
>=0 );

17490 if–(
iBuddy
+(1<<
iLogsize
))>
mem5
.
nBlock
 ) ;

17491 if–
mem5
.
aCål
[
iBuddy
]!=(
CTRL_FREE
 | 
iLogsize
) ) ;

17492 
	`memsys5U∆ök
(
iBuddy
, 
iLogsize
);

17493 
iLogsize
++;

17494 if–
iBuddy
<
iBlock
 ){

17495 
mem5
.
aCål
[
iBuddy
] = 
CTRL_FREE
 | 
iLogsize
;

17496 
mem5
.
aCål
[
iBlock
] = 0;

17497 
iBlock
 = 
iBuddy
;

17499 
mem5
.
aCål
[
iBlock
] = 
CTRL_FREE
 | 
iLogsize
;

17500 
mem5
.
aCål
[
iBuddy
] = 0;

17502 
size
 *= 2;

17504 
	`memsys5Lök
(
iBlock
, 
iLogsize
);

17510 *
	`memsys5MÆloc
(
nByãs
){

17511 
sqlôe3_öt64
 *
p
 = 0;

17512 if–
nByãs
>0 ){

17513 
	`memsys5E¡î
();

17514 
p
 = 
	`memsys5MÆlocUnß„
(
nByãs
);

17515 
	`memsys5Lóve
();

17517  (*)
p
;

17526 
	`memsys5Fªe
(*
pPri‹
){

17527 
	`as£π
–
pPri‹
!=0 );

17528 
	`memsys5E¡î
();

17529 
	`memsys5FªeUnß„
(
pPri‹
);

17530 
	`memsys5Lóve
();

17545 *
	`memsys5RóŒoc
(*
pPri‹
, 
nByãs
){

17546 
nOld
;

17547 *
p
;

17548 
	`as£π
–
pPri‹
!=0 );

17549 
	`as£π
–(
nByãs
&(nBytes-1))==0 );

17550 
	`as£π
–
nByãs
>=0 );

17551 if–
nByãs
==0 ){

17554 
nOld
 = 
	`memsys5Size
(
pPri‹
);

17555 if–
nByãs
<=
nOld
 ){

17556  
pPri‹
;

17558 
	`memsys5E¡î
();

17559 
p
 = 
	`memsys5MÆlocUnß„
(
nByãs
);

17560 if–
p
 ){

17561 
	`mem˝y
(
p
, 
pPri‹
, 
nOld
);

17562 
	`memsys5FªeUnß„
(
pPri‹
);

17564 
	`memsys5Lóve
();

17565  
p
;

17577 
	`memsys5Roundup
(
n
){

17578 
iFuŒSz
;

17579 if–
n
 > 0x40000000 )  0;

17580 
iFuŒSz
=
mem5
.
szAtom
; iFuŒSz<
n
; iFullSz *= 2);

17581  
iFuŒSz
;

17594 
	`memsys5Log
(
iVÆue
){

17595 
iLog
;

17596 
iLog
=0; (iLog<()((()*8)-1)Ë&& (1<<iLog)<
iVÆue
; iLog++);

17597  
iLog
;

17606 
	`memsys5Inô
(*
NŸU£d
){

17607 
ii
;

17608 
nByã
;

17609 
u8
 *
zByã
;

17610 
nMöLog
;

17611 
iOff£t
;

17613 
	`UNUSED_PARAMETER
(
NŸU£d
);

17616 
mem5
.
muãx
 = 0;

17621 
	`as£π
–((
Mem5Lök
)&((Mem5Link)-1))==0 );

17623 
nByã
 = 
sqlôe3GlobÆC⁄fig
.
nHóp
;

17624 
zByã
 = (
u8
*)
sqlôe3GlobÆC⁄fig
.
pHóp
;

17625 
	`as£π
–
zByã
!=0 );

17628 
nMöLog
 = 
	`memsys5Log
(
sqlôe3GlobÆC⁄fig
.
mnReq
);

17629 
mem5
.
szAtom
 = (1<<
nMöLog
);

17630  ()(
Mem5Lök
)>
mem5
.
szAtom
 ){

17631 
mem5
.
szAtom
 = mem5.szAtom << 1;

17634 
mem5
.
nBlock
 = (
nByã
 / (mem5.
szAtom
+(
u8
)));

17635 
mem5
.
zPoﬁ
 = 
zByã
;

17636 
mem5
.
aCål
 = (
u8
 *)&mem5.
zPoﬁ
[mem5.
nBlock
*mem5.
szAtom
];

17638 
ii
=0; ii<=
LOGMAX
; ii++){

17639 
mem5
.
aiFªñi°
[
ii
] = -1;

17642 
iOff£t
 = 0;

17643 
ii
=
LOGMAX
; ii>=0; ii--){

17644 
nAŒoc
 = (1<<
ii
);

17645 if–(
iOff£t
+
nAŒoc
)<=
mem5
.
nBlock
 ){

17646 
mem5
.
aCål
[
iOff£t
] = 
ii
 | 
CTRL_FREE
;

17647 
	`memsys5Lök
(
iOff£t
, 
ii
);

17648 
iOff£t
 +
nAŒoc
;

17650 
	`as£π
((
iOff£t
+
nAŒoc
)>
mem5
.
nBlock
);

17654 if–
sqlôe3GlobÆC⁄fig
.
bMem°©
==0 ){

17655 
mem5
.
muãx
 = 
	`sqlôe3MuãxAŒoc
(
SQLITE_MUTEX_STATIC_MEM
);

17658  
SQLITE_OK
;

17664 
	`memsys5Shutdown
(*
NŸU£d
){

17665 
	`UNUSED_PARAMETER
(
NŸU£d
);

17666 
mem5
.
muãx
 = 0;

17670 #ifde‡
SQLITE_TEST


17675 
SQLITE_PRIVATE
 
	`sqlôe3Memsys5Dump
(c⁄° *
zFûíame
){

17676 
FILE
 *
out
;

17677 
i
, 
j
, 
n
;

17678 
nMöLog
;

17680 if–
zFûíame
==0 || zFilename[0]==0 ){

17681 
out
 = 
°dout
;

17683 
out
 = 
	`f›í
(
zFûíame
, "w");

17684 if–
out
==0 ){

17685 
	`Ârötf
(
°dîr
, "** UnableÅo output memory debug outputÜog: %s **\n",

17686 
zFûíame
);

17690 
	`memsys5E¡î
();

17691 
nMöLog
 = 
	`memsys5Log
(
mem5
.
szAtom
);

17692 
i
=0; i<=
LOGMAX
 && i+
nMöLog
<32; i++){

17693 
n
=0, 
j
=
mem5
.
aiFªñi°
[
i
]; j>=0; j = 
	`MEM5LINK
(j)->
√xt
,Ç++){}

17694 
	`Ârötf
(
out
, "‰ìli° iãm†o‡sizê%d: %d\n", 
mem5
.
szAtom
 << 
i
, 
n
);

17696 
	`Ârötf
(
out
, "mem5.nAŒo¯ = %Œu\n", 
mem5
.
nAŒoc
);

17697 
	`Ârötf
(
out
, "mem5.tŸÆAŒo¯ = %Œu\n", 
mem5
.
tŸÆAŒoc
);

17698 
	`Ârötf
(
out
, "mem5.tŸÆEx˚s† = %Œu\n", 
mem5
.
tŸÆEx˚ss
);

17699 
	`Ârötf
(
out
, "mem5.cuºítOuà = %u\n", 
mem5
.
cuºítOut
);

17700 
	`Ârötf
(
out
, "mem5.cuºítCou¡ = %u\n", 
mem5
.
cuºítCou¡
);

17701 
	`Ârötf
(
out
, "mem5.maxOuà = %u\n", 
mem5
.
maxOut
);

17702 
	`Ârötf
(
out
, "mem5.maxCou¡ = %u\n", 
mem5
.
maxCou¡
);

17703 
	`Ârötf
(
out
, "mem5.maxReque° = %u\n", 
mem5
.
maxReque°
);

17704 
	`memsys5Lóve
();

17705 if–
out
==
°dout
 ){

17706 
	`fÊush
(
°dout
);

17708 
	`f˛o£
(
out
);

17718 
SQLITE_PRIVATE
 c⁄° 
sqlôe3_mem_mëhods
 *
	`sqlôe3MemGëMemsys5
(){

17719 c⁄° 
sqlôe3_mem_mëhods
 
memsys5Mëhods
 = {

17720 
memsys5MÆloc
,

17721 
memsys5Fªe
,

17722 
memsys5RóŒoc
,

17723 
memsys5Size
,

17724 
memsys5Roundup
,

17725 
memsys5Inô
,

17726 
memsys5Shutdown
,

17729  &
memsys5Mëhods
;

17752 #i‡
	`deföed
(
SQLITE_DEBUG
Ë&& !deföed(
SQLITE_MUTEX_OMIT
)

17758 
SQLITE_WSD
 
muãxIsInô
 = 0;

17762 #i‚de‡
SQLITE_MUTEX_OMIT


17766 
SQLITE_PRIVATE
 
	`sqlôe3MuãxInô
(){

17767 
rc
 = 
SQLITE_OK
;

17768 if–!
sqlôe3GlobÆC⁄fig
.
muãx
.
xMuãxAŒoc
 ){

17774 
sqlôe3_muãx_mëhods
 c⁄° *
pFrom
;

17775 
sqlôe3_muãx_mëhods
 *
pTo
 = &
sqlôe3GlobÆC⁄fig
.
muãx
;

17777 if–
sqlôe3GlobÆC⁄fig
.
bC‹eMuãx
 ){

17778 
pFrom
 = 
	`sqlôe3DeÁu…Muãx
();

17780 
pFrom
 = 
	`sqlôe3No›Muãx
();

17782 
	`mem˝y
(
pTo
, 
pFrom
, 
	`off£tof
(
sqlôe3_muãx_mëhods
, 
xMuãxAŒoc
));

17783 
	`mem˝y
(&
pTo
->
xMuãxFªe
, &
pFrom
->xMutexFree,

17784 (*
pTo
Ë- 
	`off£tof
(
sqlôe3_muãx_mëhods
, 
xMuãxFªe
));

17785 
pTo
->
xMuãxAŒoc
 = 
pFrom
->xMutexAlloc;

17787 
rc
 = 
sqlôe3GlobÆC⁄fig
.
muãx
.
	`xMuãxInô
();

17789 #ifde‡
SQLITE_DEBUG


17790 
	`GLOBAL
(, 
muãxIsInô
) = 1;

17793  
rc
;

17800 
SQLITE_PRIVATE
 
	`sqlôe3MuãxEnd
(){

17801 
rc
 = 
SQLITE_OK
;

17802 if–
sqlôe3GlobÆC⁄fig
.
muãx
.
xMuãxEnd
 ){

17803 
rc
 = 
sqlôe3GlobÆC⁄fig
.
muãx
.
	`xMuãxEnd
();

17806 #ifde‡
SQLITE_DEBUG


17807 
	`GLOBAL
(, 
muãxIsInô
) = 0;

17810  
rc
;

17816 
SQLITE_API
 
sqlôe3_muãx
 *
	`sqlôe3_muãx_Æloc
(
id
){

17817 #i‚de‡
SQLITE_OMIT_AUTOINIT


17818 if–
	`sqlôe3_öôülize
() )  0;

17820  
sqlôe3GlobÆC⁄fig
.
muãx
.
	`xMuãxAŒoc
(
id
);

17823 
SQLITE_PRIVATE
 
sqlôe3_muãx
 *
	`sqlôe3MuãxAŒoc
(
id
){

17824 if–!
sqlôe3GlobÆC⁄fig
.
bC‹eMuãx
 ){

17827 
	`as£π
–
	`GLOBAL
(, 
muãxIsInô
) );

17828  
sqlôe3GlobÆC⁄fig
.
muãx
.
	`xMuãxAŒoc
(
id
);

17834 
SQLITE_API
 
	`sqlôe3_muãx_‰ì
(
sqlôe3_muãx
 *
p
){

17835 if–
p
 ){

17836 
sqlôe3GlobÆC⁄fig
.
muãx
.
	`xMuãxFªe
(
p
);

17844 
SQLITE_API
 
	`sqlôe3_muãx_íãr
(
sqlôe3_muãx
 *
p
){

17845 if–
p
 ){

17846 
sqlôe3GlobÆC⁄fig
.
muãx
.
	`xMuãxE¡î
(
p
);

17854 
SQLITE_API
 
	`sqlôe3_muãx_åy
(
sqlôe3_muãx
 *
p
){

17855 
rc
 = 
SQLITE_OK
;

17856 if–
p
 ){

17857  
sqlôe3GlobÆC⁄fig
.
muãx
.
	`xMuãxTry
(
p
);

17859  
rc
;

17868 
SQLITE_API
 
	`sqlôe3_muãx_Àave
(
sqlôe3_muãx
 *
p
){

17869 if–
p
 ){

17870 
sqlôe3GlobÆC⁄fig
.
muãx
.
	`xMuãxLóve
(
p
);

17874 #i‚de‡
NDEBUG


17879 
SQLITE_API
 
	`sqlôe3_muãx_hñd
(
sqlôe3_muãx
 *
p
){

17880  
p
==0 || 
sqlôe3GlobÆC⁄fig
.
muãx
.
	`xMuãxHñd
(p);

17882 
SQLITE_API
 
	`sqlôe3_muãx_nŸhñd
(
sqlôe3_muãx
 *
p
){

17883  
p
==0 || 
sqlôe3GlobÆC⁄fig
.
muãx
.
	`xMuãxNŸhñd
(p);

17919 #i‚de‡
SQLITE_MUTEX_OMIT


17921 #i‚de‡
SQLITE_DEBUG


17927 
	`no›MuãxInô
(){  
SQLITE_OK
; }

17928 
	`no›MuãxEnd
(){  
SQLITE_OK
; }

17929 
sqlôe3_muãx
 *
	`no›MuãxAŒoc
(
id
){

17930 
	`UNUSED_PARAMETER
(
id
);

17931  (
sqlôe3_muãx
*)8;

17933 
	`no›MuãxFªe
(
sqlôe3_muãx
 *
p
){ 
	`UNUSED_PARAMETER
(p); ; }

17934 
	`no›MuãxE¡î
(
sqlôe3_muãx
 *
p
){ 
	`UNUSED_PARAMETER
(p); ; }

17935 
	`no›MuãxTry
(
sqlôe3_muãx
 *
p
){

17936 
	`UNUSED_PARAMETER
(
p
);

17937  
SQLITE_OK
;

17939 
	`no›MuãxLóve
(
sqlôe3_muãx
 *
p
){ 
	`UNUSED_PARAMETER
(p); ; }

17941 
SQLITE_PRIVATE
 
sqlôe3_muãx_mëhods
 c⁄° *
	`sqlôe3No›Muãx
(){

17942 c⁄° 
sqlôe3_muãx_mëhods
 
sMuãx
 = {

17943 
no›MuãxInô
,

17944 
no›MuãxEnd
,

17945 
no›MuãxAŒoc
,

17946 
no›MuãxFªe
,

17947 
no›MuãxE¡î
,

17948 
no›MuãxTry
,

17949 
no›MuãxLóve
,

17955  &
sMuãx
;

17959 #ifde‡
SQLITE_DEBUG


17969 
	ssqlôe3_debug_muãx
 {

17970 
id
;

17971 
˙t
;

17972 } 
	tsqlôe3_debug_muãx
;

17978 
	`debugMuãxHñd
(
sqlôe3_muãx
 *
pX
){

17979 
sqlôe3_debug_muãx
 *
p
 = (sqlôe3_debug_muãx*)
pX
;

17980  
p
==0 ||Ö->
˙t
>0;

17982 
	`debugMuãxNŸhñd
(
sqlôe3_muãx
 *
pX
){

17983 
sqlôe3_debug_muãx
 *
p
 = (sqlôe3_debug_muãx*)
pX
;

17984  
p
==0 ||Ö->
˙t
==0;

17990 
	`debugMuãxInô
(){  
SQLITE_OK
; }

17991 
	`debugMuãxEnd
(){  
SQLITE_OK
; }

17998 
sqlôe3_muãx
 *
	`debugMuãxAŒoc
(
id
){

17999 
sqlôe3_debug_muãx
 
aSètic
[6];

18000 
sqlôe3_debug_muãx
 *
pNew
 = 0;

18001  
id
 ){

18002 
SQLITE_MUTEX_FAST
:

18003 
SQLITE_MUTEX_RECURSIVE
: {

18004 
pNew
 = 
	`sqlôe3MÆloc
((*pNew));

18005 if–
pNew
 ){

18006 
pNew
->
id
 = id;

18007 
pNew
->
˙t
 = 0;

18012 
	`as£π
–
id
-2 >= 0 );

18013 
	`as£π
–
id
-2 < ()((
aSètic
)/(aStatic[0])) );

18014 
pNew
 = &
aSètic
[
id
-2];

18015 
pNew
->
id
 = id;

18019  (
sqlôe3_muãx
*)
pNew
;

18025 
	`debugMuãxFªe
(
sqlôe3_muãx
 *
pX
){

18026 
sqlôe3_debug_muãx
 *
p
 = (sqlôe3_debug_muãx*)
pX
;

18027 
	`as£π
–
p
->
˙t
==0 );

18028 
	`as£π
–
p
->
id
==
SQLITE_MUTEX_FAST
 ||Ö->id==
SQLITE_MUTEX_RECURSIVE
 );

18029 
	`sqlôe3_‰ì
(
p
);

18043 
	`debugMuãxE¡î
(
sqlôe3_muãx
 *
pX
){

18044 
sqlôe3_debug_muãx
 *
p
 = (sqlôe3_debug_muãx*)
pX
;

18045 
	`as£π
–
p
->
id
==
SQLITE_MUTEX_RECURSIVE
 || 
	`debugMuãxNŸhñd
(
pX
) );

18046 
p
->
˙t
++;

18048 
	`debugMuãxTry
(
sqlôe3_muãx
 *
pX
){

18049 
sqlôe3_debug_muãx
 *
p
 = (sqlôe3_debug_muãx*)
pX
;

18050 
	`as£π
–
p
->
id
==
SQLITE_MUTEX_RECURSIVE
 || 
	`debugMuãxNŸhñd
(
pX
) );

18051 
p
->
˙t
++;

18052  
SQLITE_OK
;

18061 
	`debugMuãxLóve
(
sqlôe3_muãx
 *
pX
){

18062 
sqlôe3_debug_muãx
 *
p
 = (sqlôe3_debug_muãx*)
pX
;

18063 
	`as£π
–
	`debugMuãxHñd
(
pX
) );

18064 
p
->
˙t
--;

18065 
	`as£π
–
p
->
id
==
SQLITE_MUTEX_RECURSIVE
 || 
	`debugMuãxNŸhñd
(
pX
) );

18068 
SQLITE_PRIVATE
 
sqlôe3_muãx_mëhods
 c⁄° *
	`sqlôe3No›Muãx
(){

18069 c⁄° 
sqlôe3_muãx_mëhods
 
sMuãx
 = {

18070 
debugMuãxInô
,

18071 
debugMuãxEnd
,

18072 
debugMuãxAŒoc
,

18073 
debugMuãxFªe
,

18074 
debugMuãxE¡î
,

18075 
debugMuãxTry
,

18076 
debugMuãxLóve
,

18078 
debugMuãxHñd
,

18079 
debugMuãxNŸhñd


18082  &
sMuãx
;

18090 #ifde‡
SQLITE_MUTEX_NOOP


18091 
SQLITE_PRIVATE
 
sqlôe3_muãx_mëhods
 c⁄° *
	`sqlôe3DeÁu…Muãx
(){

18092  
	`sqlôe3No›Muãx
();

18120 #ifde‡
SQLITE_MUTEX_PTHREADS


18122 
	~<±hªad.h
>

18129 #i‡
	`deföed
(
SQLITE_DEBUG
Ë|| deföed(
SQLITE_HOMEGROWN_RECURSIVE_MUTEX
)

18130 
	#SQLITE_MUTEX_NREF
 1

	)

18132 
	#SQLITE_MUTEX_NREF
 0

	)

18138 
	ssqlôe3_muãx
 {

18139 
±hªad_muãx_t
 
muãx
;

18140 #i‡
SQLITE_MUTEX_NREF


18141 
id
;

18142 vﬁ©ûê
nRef
;

18143 vﬁ©ûê
±hªad_t
 
ow√r
;

18144 
åa˚
;

18147 #i‡
SQLITE_MUTEX_NREF


18148 
	#SQLITE3_MUTEX_INITIALIZER
 { 
PTHREAD_MUTEX_INITIALIZER
, 0, 0, (
±hªad_t
)0, 0 }

	)

18150 
	#SQLITE3_MUTEX_INITIALIZER
 { 
PTHREAD_MUTEX_INITIALIZER
 }

	)

18169 #i‡!
	`deföed
(
NDEBUG
Ë|| deföed(
SQLITE_DEBUG
)

18170 
	`±hªadMuãxHñd
(
sqlôe3_muãx
 *
p
){

18171  (
p
->
nRef
!=0 && 
	`±hªad_equÆ
’->
ow√r
, 
	`±hªad_£lf
()));

18173 
	`±hªadMuãxNŸhñd
(
sqlôe3_muãx
 *
p
){

18174  
p
->
nRef
==0 || 
	`±hªad_equÆ
’->
ow√r
, 
	`±hªad_£lf
())==0;

18181 
	`±hªadMuãxInô
(){  
SQLITE_OK
; }

18182 
	`±hªadMuãxEnd
(){  
SQLITE_OK
; }

18226 
sqlôe3_muãx
 *
	`±hªadMuãxAŒoc
(
iTy≥
){

18227 
sqlôe3_muãx
 
°©icMuãxes
[] = {

18228 
SQLITE3_MUTEX_INITIALIZER
,

18229 
SQLITE3_MUTEX_INITIALIZER
,

18230 
SQLITE3_MUTEX_INITIALIZER
,

18231 
SQLITE3_MUTEX_INITIALIZER
,

18232 
SQLITE3_MUTEX_INITIALIZER
,

18233 
SQLITE3_MUTEX_INITIALIZER


18235 
sqlôe3_muãx
 *
p
;

18236  
iTy≥
 ){

18237 
SQLITE_MUTEX_RECURSIVE
: {

18238 
p
 = 
	`sqlôe3MÆlocZîo
( (*p) );

18239 if–
p
 ){

18240 #ifde‡
SQLITE_HOMEGROWN_RECURSIVE_MUTEX


18243 
	`±hªad_muãx_öô
(&
p
->
muãx
, 0);

18246 
±hªad_muãx©å_t
 
ªcursiveAâr
;

18247 
	`±hªad_muãx©å_öô
(&
ªcursiveAâr
);

18248 
	`±hªad_muãx©å_£ây≥
(&
ªcursiveAâr
, 
PTHREAD_MUTEX_RECURSIVE
);

18249 
	`±hªad_muãx_öô
(&
p
->
muãx
, &
ªcursiveAâr
);

18250 
	`±hªad_muãx©å_de°roy
(&
ªcursiveAâr
);

18252 #i‡
SQLITE_MUTEX_NREF


18253 
p
->
id
 = 
iTy≥
;

18258 
SQLITE_MUTEX_FAST
: {

18259 
p
 = 
	`sqlôe3MÆlocZîo
( (*p) );

18260 if–
p
 ){

18261 #i‡
SQLITE_MUTEX_NREF


18262 
p
->
id
 = 
iTy≥
;

18264 
	`±hªad_muãx_öô
(&
p
->
muãx
, 0);

18269 
	`as£π
–
iTy≥
-2 >= 0 );

18270 
	`as£π
–
iTy≥
-2 < 
	`AºaySize
(
°©icMuãxes
) );

18271 
p
 = &
°©icMuãxes
[
iTy≥
-2];

18272 #i‡
SQLITE_MUTEX_NREF


18273 
p
->
id
 = 
iTy≥
;

18278  
p
;

18287 
	`±hªadMuãxFªe
(
sqlôe3_muãx
 *
p
){

18288 
	`as£π
–
p
->
nRef
==0 );

18289 
	`as£π
–
p
->
id
==
SQLITE_MUTEX_FAST
 ||Ö->id==
SQLITE_MUTEX_RECURSIVE
 );

18290 
	`±hªad_muãx_de°roy
(&
p
->
muãx
);

18291 
	`sqlôe3_‰ì
(
p
);

18305 
	`±hªadMuãxE¡î
(
sqlôe3_muãx
 *
p
){

18306 
	`as£π
–
p
->
id
==
SQLITE_MUTEX_RECURSIVE
 || 
	`±hªadMuãxNŸhñd
(p) );

18308 #ifde‡
SQLITE_HOMEGROWN_RECURSIVE_MUTEX


18320 
±hªad_t
 
£lf
 = 
	`±hªad_£lf
();

18321 if–
p
->
nRef
>0 && 
	`±hªad_equÆ
’->
ow√r
, 
£lf
) ){

18322 
p
->
nRef
++;

18324 
	`±hªad_muãx_lock
(&
p
->
muãx
);

18325 
	`as£π
–
p
->
nRef
==0 );

18326 
p
->
ow√r
 = 
£lf
;

18327 
p
->
nRef
 = 1;

18333 
	`±hªad_muãx_lock
(&
p
->
muãx
);

18334 #i‡
SQLITE_MUTEX_NREF


18335 
	`as£π
–
p
->
nRef
>0 ||Ö->
ow√r
==0 );

18336 
p
->
ow√r
 = 
	`±hªad_£lf
();

18337 
p
->
nRef
++;

18341 #ifde‡
SQLITE_DEBUG


18342 if–
p
->
åa˚
 ){

18343 
	`¥ötf
("íã∏muãx %∞(%dËwôhÇRef=%d\n", 
p
,Ö->
åa˚
,Ö->
nRef
);

18347 
	`±hªadMuãxTry
(
sqlôe3_muãx
 *
p
){

18348 
rc
;

18349 
	`as£π
–
p
->
id
==
SQLITE_MUTEX_RECURSIVE
 || 
	`±hªadMuãxNŸhñd
(p) );

18351 #ifde‡
SQLITE_HOMEGROWN_RECURSIVE_MUTEX


18363 
±hªad_t
 
£lf
 = 
	`±hªad_£lf
();

18364 if–
p
->
nRef
>0 && 
	`±hªad_equÆ
’->
ow√r
, 
£lf
) ){

18365 
p
->
nRef
++;

18366 
rc
 = 
SQLITE_OK
;

18367 }if–
	`±hªad_muãx_åylock
(&
p
->
muãx
)==0 ){

18368 
	`as£π
–
p
->
nRef
==0 );

18369 
p
->
ow√r
 = 
£lf
;

18370 
p
->
nRef
 = 1;

18371 
rc
 = 
SQLITE_OK
;

18373 
rc
 = 
SQLITE_BUSY
;

18379 if–
	`±hªad_muãx_åylock
(&
p
->
muãx
)==0 ){

18380 #i‡
SQLITE_MUTEX_NREF


18381 
p
->
ow√r
 = 
	`±hªad_£lf
();

18382 
p
->
nRef
++;

18384 
rc
 = 
SQLITE_OK
;

18386 
rc
 = 
SQLITE_BUSY
;

18390 #ifde‡
SQLITE_DEBUG


18391 if–
rc
==
SQLITE_OK
 && 
p
->
åa˚
 ){

18392 
	`¥ötf
("íã∏muãx %∞(%dËwôhÇRef=%d\n", 
p
,Ö->
åa˚
,Ö->
nRef
);

18395  
rc
;

18404 
	`±hªadMuãxLóve
(
sqlôe3_muãx
 *
p
){

18405 
	`as£π
–
	`±hªadMuãxHñd
(
p
) );

18406 #i‡
SQLITE_MUTEX_NREF


18407 
p
->
nRef
--;

18408 if–
p
->
nRef
==0 )Ö->
ow√r
 = 0;

18410 
	`as£π
–
p
->
nRef
==0 ||Ö->
id
==
SQLITE_MUTEX_RECURSIVE
 );

18412 #ifde‡
SQLITE_HOMEGROWN_RECURSIVE_MUTEX


18413 if–
p
->
nRef
==0 ){

18414 
	`±hªad_muãx_u∆ock
(&
p
->
muãx
);

18417 
	`±hªad_muãx_u∆ock
(&
p
->
muãx
);

18420 #ifde‡
SQLITE_DEBUG


18421 if–
p
->
åa˚
 ){

18422 
	`¥ötf
("Àavêmuãx %∞(%dËwôhÇRef=%d\n", 
p
,Ö->
åa˚
,Ö->
nRef
);

18427 
SQLITE_PRIVATE
 
sqlôe3_muãx_mëhods
 c⁄° *
	`sqlôe3DeÁu…Muãx
(){

18428 c⁄° 
sqlôe3_muãx_mëhods
 
sMuãx
 = {

18429 
±hªadMuãxInô
,

18430 
±hªadMuãxEnd
,

18431 
±hªadMuãxAŒoc
,

18432 
±hªadMuãxFªe
,

18433 
±hªadMuãxE¡î
,

18434 
±hªadMuãxTry
,

18435 
±hªadMuãxLóve
,

18436 #ifde‡
SQLITE_DEBUG


18437 
±hªadMuãxHñd
,

18438 
±hªadMuãxNŸhñd


18445  &
sMuãx
;

18470 #ifde‡
SQLITE_MUTEX_W32


18475 
	ssqlôe3_muãx
 {

18476 
CRITICAL_SECTION
 
muãx
;

18477 
id
;

18478 #ifde‡
SQLITE_DEBUG


18479 vﬁ©ûê
nRef
;

18480 vﬁ©ûê
DWORD
 
ow√r
;

18481 
åa˚
;

18484 
	#SQLITE_W32_MUTEX_INITIALIZER
 { 0 }

	)

18485 #ifde‡
SQLITE_DEBUG


18486 
	#SQLITE3_MUTEX_INITIALIZER
 { 
SQLITE_W32_MUTEX_INITIALIZER
, 0, 0L, (
DWORD
)0, 0 }

	)

18488 
	#SQLITE3_MUTEX_INITIALIZER
 { 
SQLITE_W32_MUTEX_INITIALIZER
, 0 }

	)

18509 #i‡
SQLITE_OS_WINCE
 || 
SQLITE_OS_WINRT


18510 
	#muãxIsNT
(Ë(1)

	)

18512 
	`muãxIsNT
(){

18513 
osTy≥
 = 0;

18514 if–
osTy≥
==0 ){

18515 
OSVERSIONINFO
 
sInfo
;

18516 
sInfo
.
dwOSVîsi⁄InfoSize
 = (sInfo);

18517 
	`GëVîsi⁄Ex
(&
sInfo
);

18518 
osTy≥
 = 
sInfo
.
dwPœtf‹mId
==
VER_PLATFORM_WIN32_NT
 ? 2 : 1;

18520  
osTy≥
==2;

18525 #ifde‡
SQLITE_DEBUG


18530 
	`wöMuãxHñd
(
sqlôe3_muãx
 *
p
){

18531  
p
->
nRef
!=0 &&Ö->
ow√r
==
	`GëCuºítThªadId
();

18533 
	`wöMuãxNŸhñd2
(
sqlôe3_muãx
 *
p
, 
DWORD
 
tid
){

18534  
p
->
nRef
==0 ||Ö->
ow√r
!=
tid
;

18536 
	`wöMuãxNŸhñd
(
sqlôe3_muãx
 *
p
){

18537 
DWORD
 
tid
 = 
	`GëCuºítThªadId
();

18538  
	`wöMuãxNŸhñd2
(
p
, 
tid
);

18546 
sqlôe3_muãx
 
wöMuãx_°©icMuãxes
[6] = {

18547 
SQLITE3_MUTEX_INITIALIZER
,

18548 
SQLITE3_MUTEX_INITIALIZER
,

18549 
SQLITE3_MUTEX_INITIALIZER
,

18550 
SQLITE3_MUTEX_INITIALIZER
,

18551 
SQLITE3_MUTEX_INITIALIZER
,

18552 
SQLITE3_MUTEX_INITIALIZER


18554 
wöMuãx_isInô
 = 0;

18560 
LONG
 
wöMuãx_lock
 = 0;

18562 
SQLITE_API
 
	`sqlôe3_wö32_¶ìp
(
DWORD
 
mûli£c⁄ds
);

18564 
	`wöMuãxInô
(){

18566 if–
	`I¡îlockedCom∑ªExch™ge
(&
wöMuãx_lock
, 1, 0)==0 ){

18567 
i
;

18568 
i
=0; i<
	`AºaySize
(
wöMuãx_°©icMuãxes
); i++){

18569 #i‡
SQLITE_OS_WINRT


18570 
	`InôülizeCrôiˇlSe˘i⁄Ex
(&
wöMuãx_°©icMuãxes
[
i
].
muãx
, 0, 0);

18572 
	`InôülizeCrôiˇlSe˘i⁄
(&
wöMuãx_°©icMuãxes
[
i
].
muãx
);

18575 
wöMuãx_isInô
 = 1;

18578  !
wöMuãx_isInô
 ){

18579 
	`sqlôe3_wö32_¶ìp
(1);

18582  
SQLITE_OK
;

18585 
	`wöMuãxEnd
(){

18588 if–
	`I¡îlockedCom∑ªExch™ge
(&
wöMuãx_lock
, 0, 1)==1 ){

18589 if–
wöMuãx_isInô
==1 ){

18590 
i
;

18591 
i
=0; i<
	`AºaySize
(
wöMuãx_°©icMuãxes
); i++){

18592 
	`DñëeCrôiˇlSe˘i⁄
(&
wöMuãx_°©icMuãxes
[
i
].
muãx
);

18594 
wöMuãx_isInô
 = 0;

18597  
SQLITE_OK
;

18642 
sqlôe3_muãx
 *
	`wöMuãxAŒoc
(
iTy≥
){

18643 
sqlôe3_muãx
 *
p
;

18645  
iTy≥
 ){

18646 
SQLITE_MUTEX_FAST
:

18647 
SQLITE_MUTEX_RECURSIVE
: {

18648 
p
 = 
	`sqlôe3MÆlocZîo
( (*p) );

18649 if–
p
 ){

18650 #ifde‡
SQLITE_DEBUG


18651 
p
->
id
 = 
iTy≥
;

18653 #i‡
SQLITE_OS_WINRT


18654 
	`InôülizeCrôiˇlSe˘i⁄Ex
(&
p
->
muãx
, 0, 0);

18656 
	`InôülizeCrôiˇlSe˘i⁄
(&
p
->
muãx
);

18662 
	`as£π
–
wöMuãx_isInô
==1 );

18663 
	`as£π
–
iTy≥
-2 >= 0 );

18664 
	`as£π
–
iTy≥
-2 < 
	`AºaySize
(
wöMuãx_°©icMuãxes
) );

18665 
p
 = &
wöMuãx_°©icMuãxes
[
iTy≥
-2];

18666 #ifde‡
SQLITE_DEBUG


18667 
p
->
id
 = 
iTy≥
;

18672  
p
;

18681 
	`wöMuãxFªe
(
sqlôe3_muãx
 *
p
){

18682 
	`as£π
–
p
 );

18683 
	`as£π
–
p
->
nRef
==0 &&Ö->
ow√r
==0 );

18684 
	`as£π
–
p
->
id
==
SQLITE_MUTEX_FAST
 ||Ö->id==
SQLITE_MUTEX_RECURSIVE
 );

18685 
	`DñëeCrôiˇlSe˘i⁄
(&
p
->
muãx
);

18686 
	`sqlôe3_‰ì
(
p
);

18700 
	`wöMuãxE¡î
(
sqlôe3_muãx
 *
p
){

18701 #ifde‡
SQLITE_DEBUG


18702 
DWORD
 
tid
 = 
	`GëCuºítThªadId
();

18703 
	`as£π
–
p
->
id
==
SQLITE_MUTEX_RECURSIVE
 || 
	`wöMuãxNŸhñd2
’, 
tid
) );

18705 
	`E¡îCrôiˇlSe˘i⁄
(&
p
->
muãx
);

18706 #ifde‡
SQLITE_DEBUG


18707 
	`as£π
–
p
->
nRef
>0 ||Ö->
ow√r
==0 );

18708 
p
->
ow√r
 = 
tid
;

18709 
p
->
nRef
++;

18710 if–
p
->
åa˚
 ){

18711 
	`¥ötf
("íã∏muãx %∞(%dËwôhÇRef=%d\n", 
p
,Ö->
åa˚
,Ö->
nRef
);

18715 
	`wöMuãxTry
(
sqlôe3_muãx
 *
p
){

18716 #i‚de‡
NDEBUG


18717 
DWORD
 
tid
 = 
	`GëCuºítThªadId
();

18719 
rc
 = 
SQLITE_BUSY
;

18720 
	`as£π
–
p
->
id
==
SQLITE_MUTEX_RECURSIVE
 || 
	`wöMuãxNŸhñd2
’, 
tid
) );

18733 if–
	`muãxIsNT
(Ë&& 
	`TryE¡îCrôiˇlSe˘i⁄
(&
p
->
muãx
) ){

18734 
p
->
ow√r
 = 
tid
;

18735 
p
->
nRef
++;

18736 
rc
 = 
SQLITE_OK
;

18739 
	`UNUSED_PARAMETER
(
p
);

18741 #ifde‡
SQLITE_DEBUG


18742 if–
rc
==
SQLITE_OK
 && 
p
->
åa˚
 ){

18743 
	`¥ötf
("åy muãx %∞(%dËwôhÇRef=%d\n", 
p
,Ö->
åa˚
,Ö->
nRef
);

18746  
rc
;

18755 
	`wöMuãxLóve
(
sqlôe3_muãx
 *
p
){

18756 #i‚de‡
NDEBUG


18757 
DWORD
 
tid
 = 
	`GëCuºítThªadId
();

18758 
	`as£π
–
p
->
nRef
>0 );

18759 
	`as£π
–
p
->
ow√r
==
tid
 );

18760 
p
->
nRef
--;

18761 if–
p
->
nRef
==0 )Ö->
ow√r
 = 0;

18762 
	`as£π
–
p
->
nRef
==0 ||Ö->
id
==
SQLITE_MUTEX_RECURSIVE
 );

18764 
	`LóveCrôiˇlSe˘i⁄
(&
p
->
muãx
);

18765 #ifde‡
SQLITE_DEBUG


18766 if–
p
->
åa˚
 ){

18767 
	`¥ötf
("Àavêmuãx %∞(%dËwôhÇRef=%d\n", 
p
,Ö->
åa˚
,Ö->
nRef
);

18772 
SQLITE_PRIVATE
 
sqlôe3_muãx_mëhods
 c⁄° *
	`sqlôe3DeÁu…Muãx
(){

18773 c⁄° 
sqlôe3_muãx_mëhods
 
sMuãx
 = {

18774 
wöMuãxInô
,

18775 
wöMuãxEnd
,

18776 
wöMuãxAŒoc
,

18777 
wöMuãxFªe
,

18778 
wöMuãxE¡î
,

18779 
wöMuãxTry
,

18780 
wöMuãxLóve
,

18781 #ifde‡
SQLITE_DEBUG


18782 
wöMuãxHñd
,

18783 
wöMuãxNŸhñd


18790  &
sMuãx
;

18817 
SQLITE_API
 
	`sqlôe3_ªÀa£_mem‹y
(
n
){

18818 #ifde‡
SQLITE_ENABLE_MEMORY_MANAGEMENT


18819  
	`sqlôe3PˇcheRñó£Mem‹y
(
n
);

18824 
	`UNUSED_PARAMETER
(
n
);

18833 
	sS¸©chFªe¶Ÿ
 {

18834 
S¸©chFªe¶Ÿ
 *
pNext
;

18835 } 
	tS¸©chFªe¶Ÿ
;

18840 
SQLITE_WSD
 
	sMem0GlobÆ
 {

18841 
sqlôe3_muãx
 *
muãx
;

18849 
sqlôe3_öt64
 
Æ¨mThªshﬁd
;

18850 (*
Æ¨mCÆlback
)(*, 
sqlôe3_öt64
,);

18851 *
Æ¨mArg
;

18859 *
pS¸©chEnd
;

18860 
S¸©chFªe¶Ÿ
 *
pS¸©chFªe
;

18861 
u32
 
nS¸©chFªe
;

18867 
√¨lyFuŒ
;

18868 } 
mem0
 = { 0, 0, 0, 0, 0, 0, 0, 0 };

18870 
	#mem0
 
	`GLOBAL
(
Mem0GlobÆ
, 
mem0
)

	)

18877 
	`so·HópLimôEnf‹˚r
(

18878 *
NŸU£d
,

18879 
sqlôe3_öt64
 
NŸU£d2
,

18880 
ÆlocSize


18882 
	`UNUSED_PARAMETER2
(
NŸU£d
, 
NŸU£d2
);

18883 
	`sqlôe3_ªÀa£_mem‹y
(
ÆlocSize
);

18889 
	`sqlôe3Mem‹yAœrm
(

18890 (*
xCÆlback
)(*
pArg
, 
sqlôe3_öt64
 
u£d
,
N
),

18891 *
pArg
,

18892 
sqlôe3_öt64
 
iThªshﬁd


18894 
nU£d
;

18895 
	`sqlôe3_muãx_íãr
(
mem0
.
muãx
);

18896 
mem0
.
Æ¨mCÆlback
 = 
xCÆlback
;

18897 
mem0
.
Æ¨mArg
 = 
pArg
;

18898 
mem0
.
Æ¨mThªshﬁd
 = 
iThªshﬁd
;

18899 
nU£d
 = 
	`sqlôe3SètusVÆue
(
SQLITE_STATUS_MEMORY_USED
);

18900 
mem0
.
√¨lyFuŒ
 = (
iThªshﬁd
>0 && iThªshﬁd<=
nU£d
);

18901 
	`sqlôe3_muãx_Àave
(
mem0
.
muãx
);

18902  
SQLITE_OK
;

18905 #i‚de‡
SQLITE_OMIT_DEPRECATED


18910 
SQLITE_API
 
	`sqlôe3_mem‹y_Æ¨m
(

18911 (*
xCÆlback
)(*
pArg
, 
sqlôe3_öt64
 
u£d
,
N
),

18912 *
pArg
,

18913 
sqlôe3_öt64
 
iThªshﬁd


18915  
	`sqlôe3Mem‹yAœrm
(
xCÆlback
, 
pArg
, 
iThªshﬁd
);

18923 
SQLITE_API
 
sqlôe3_öt64
 
	`sqlôe3_so·_hóp_limô64
(sqlôe3_öt64 
n
){

18924 
sqlôe3_öt64
 
¥i‹Limô
;

18925 
sqlôe3_öt64
 
ex˚ss
;

18926 #i‚de‡
SQLITE_OMIT_AUTOINIT


18927 
rc
 = 
	`sqlôe3_öôülize
();

18928 if–
rc
 )  -1;

18930 
	`sqlôe3_muãx_íãr
(
mem0
.
muãx
);

18931 
¥i‹Limô
 = 
mem0
.
Æ¨mThªshﬁd
;

18932 
	`sqlôe3_muãx_Àave
(
mem0
.
muãx
);

18933 if–
n
<0 )  
¥i‹Limô
;

18934 if–
n
>0 ){

18935 
	`sqlôe3Mem‹yAœrm
(
so·HópLimôEnf‹˚r
, 0, 
n
);

18937 
	`sqlôe3Mem‹yAœrm
(0, 0, 0);

18939 
ex˚ss
 = 
	`sqlôe3_mem‹y_u£d
(Ë- 
n
;

18940 if–
ex˚ss
>0 ) 
	`sqlôe3_ªÀa£_mem‹y
(()(excess & 0x7fffffff));

18941  
¥i‹Limô
;

18943 
SQLITE_API
 
	`sqlôe3_so·_hóp_limô
(
n
){

18944 if–
n
<0 )Ç = 0;

18945 
	`sqlôe3_so·_hóp_limô64
(
n
);

18951 
SQLITE_PRIVATE
 
	`sqlôe3MÆlocInô
(){

18952 if–
sqlôe3GlobÆC⁄fig
.
m
.
xMÆloc
==0 ){

18953 
	`sqlôe3MemSëDeÁu…
();

18955 
	`mem£t
(&
mem0
, 0, (mem0));

18956 if–
sqlôe3GlobÆC⁄fig
.
bC‹eMuãx
 ){

18957 
mem0
.
muãx
 = 
	`sqlôe3MuãxAŒoc
(
SQLITE_MUTEX_STATIC_MEM
);

18959 if–
sqlôe3GlobÆC⁄fig
.
pS¸©ch
 && sqlôe3GlobÆC⁄fig.
szS¸©ch
>=100

18960 && 
sqlôe3GlobÆC⁄fig
.
nS¸©ch
>0 ){

18961 
i
, 
n
, 
sz
;

18962 
S¸©chFªe¶Ÿ
 *
pSlŸ
;

18963 
sz
 = 
	`ROUNDDOWN8
(
sqlôe3GlobÆC⁄fig
.
szS¸©ch
);

18964 
sqlôe3GlobÆC⁄fig
.
szS¸©ch
 = 
sz
;

18965 
pSlŸ
 = (
S¸©chFªe¶Ÿ
*)
sqlôe3GlobÆC⁄fig
.
pS¸©ch
;

18966 
n
 = 
sqlôe3GlobÆC⁄fig
.
nS¸©ch
;

18967 
mem0
.
pS¸©chFªe
 = 
pSlŸ
;

18968 
mem0
.
nS¸©chFªe
 = 
n
;

18969 
i
=0; i<
n
-1; i++){

18970 
pSlŸ
->
pNext
 = (
S¸©chFªe¶Ÿ
*)(
sz
+(*)pSlot);

18971 
pSlŸ
 =ÖSlŸ->
pNext
;

18973 
pSlŸ
->
pNext
 = 0;

18974 
mem0
.
pS¸©chEnd
 = (*)&
pSlŸ
[1];

18976 
mem0
.
pS¸©chEnd
 = 0;

18977 
sqlôe3GlobÆC⁄fig
.
pS¸©ch
 = 0;

18978 
sqlôe3GlobÆC⁄fig
.
szS¸©ch
 = 0;

18979 
sqlôe3GlobÆC⁄fig
.
nS¸©ch
 = 0;

18981 if–
sqlôe3GlobÆC⁄fig
.
pPage
==0 || sqlôe3GlobÆC⁄fig.
szPage
<512

18982 || 
sqlôe3GlobÆC⁄fig
.
nPage
<1 ){

18983 
sqlôe3GlobÆC⁄fig
.
pPage
 = 0;

18984 
sqlôe3GlobÆC⁄fig
.
szPage
 = 0;

18985 
sqlôe3GlobÆC⁄fig
.
nPage
 = 0;

18987  
sqlôe3GlobÆC⁄fig
.
m
.
	`xInô
(sqlôe3GlobÆC⁄fig.m.
pAµD©a
);

18995 
SQLITE_PRIVATE
 
	`sqlôe3HópNóæyFuŒ
(){

18996  
mem0
.
√¨lyFuŒ
;

19002 
SQLITE_PRIVATE
 
	`sqlôe3MÆlocEnd
(){

19003 if–
sqlôe3GlobÆC⁄fig
.
m
.
xShutdown
 ){

19004 
sqlôe3GlobÆC⁄fig
.
m
.
	`xShutdown
(sqlôe3GlobÆC⁄fig.m.
pAµD©a
);

19006 
	`mem£t
(&
mem0
, 0, (mem0));

19012 
SQLITE_API
 
sqlôe3_öt64
 
	`sqlôe3_mem‹y_u£d
(){

19013 
n
, 
mx
;

19014 
sqlôe3_öt64
 
ªs
;

19015 
	`sqlôe3_°©us
(
SQLITE_STATUS_MEMORY_USED
, &
n
, &
mx
, 0);

19016 
ªs
 = (
sqlôe3_öt64
)
n
;

19017  
ªs
;

19025 
SQLITE_API
 
sqlôe3_öt64
 
	`sqlôe3_mem‹y_highw©î
(
ª£tFœg
){

19026 
n
, 
mx
;

19027 
sqlôe3_öt64
 
ªs
;

19028 
	`sqlôe3_°©us
(
SQLITE_STATUS_MEMORY_USED
, &
n
, &
mx
, 
ª£tFœg
);

19029 
ªs
 = (
sqlôe3_öt64
)
mx
;

19030  
ªs
;

19036 
	`sqlôe3MÆlocAœrm
(
nByã
){

19037 (*
xCÆlback
)(*,
sqlôe3_öt64
,);

19038 
sqlôe3_öt64
 
nowU£d
;

19039 *
pArg
;

19040 if–
mem0
.
Æ¨mCÆlback
==0 ) ;

19041 
xCÆlback
 = 
mem0
.
Æ¨mCÆlback
;

19042 
nowU£d
 = 
	`sqlôe3SètusVÆue
(
SQLITE_STATUS_MEMORY_USED
);

19043 
pArg
 = 
mem0
.
Æ¨mArg
;

19044 
mem0
.
Æ¨mCÆlback
 = 0;

19045 
	`sqlôe3_muãx_Àave
(
mem0
.
muãx
);

19046 
	`xCÆlback
(
pArg
, 
nowU£d
, 
nByã
);

19047 
	`sqlôe3_muãx_íãr
(
mem0
.
muãx
);

19048 
mem0
.
Æ¨mCÆlback
 = 
xCÆlback
;

19049 
mem0
.
Æ¨mArg
 = 
pArg
;

19056 
	`mÆlocWôhAœrm
(
n
, **
µ
){

19057 
nFuŒ
;

19058 *
p
;

19059 
	`as£π
–
	`sqlôe3_muãx_hñd
(
mem0
.
muãx
) );

19060 
nFuŒ
 = 
sqlôe3GlobÆC⁄fig
.
m
.
	`xRoundup
(
n
);

19061 
	`sqlôe3SètusSë
(
SQLITE_STATUS_MALLOC_SIZE
, 
n
);

19062 if–
mem0
.
Æ¨mCÆlback
!=0 ){

19063 
nU£d
 = 
	`sqlôe3SètusVÆue
(
SQLITE_STATUS_MEMORY_USED
);

19064 if–
nU£d
 >
mem0
.
Æ¨mThªshﬁd
 - 
nFuŒ
 ){

19065 
mem0
.
√¨lyFuŒ
 = 1;

19066 
	`sqlôe3MÆlocAœrm
(
nFuŒ
);

19068 
mem0
.
√¨lyFuŒ
 = 0;

19071 
p
 = 
sqlôe3GlobÆC⁄fig
.
m
.
	`xMÆloc
(
nFuŒ
);

19072 #ifde‡
SQLITE_ENABLE_MEMORY_MANAGEMENT


19073 if–
p
==0 && 
mem0
.
Æ¨mCÆlback
 ){

19074 
	`sqlôe3MÆlocAœrm
(
nFuŒ
);

19075 
p
 = 
sqlôe3GlobÆC⁄fig
.
m
.
	`xMÆloc
(
nFuŒ
);

19078 if–
p
 ){

19079 
nFuŒ
 = 
	`sqlôe3MÆlocSize
(
p
);

19080 
	`sqlôe3SètusAdd
(
SQLITE_STATUS_MEMORY_USED
, 
nFuŒ
);

19081 
	`sqlôe3SètusAdd
(
SQLITE_STATUS_MALLOC_COUNT
, 1);

19083 *
µ
 = 
p
;

19084  
nFuŒ
;

19091 
SQLITE_PRIVATE
 *
	`sqlôe3MÆloc
(
n
){

19092 *
p
;

19093 if–
n
<=0

19094 || 
n
>=0x7fffff00

19101 
p
 = 0;

19102 }if–
sqlôe3GlobÆC⁄fig
.
bMem°©
 ){

19103 
	`sqlôe3_muãx_íãr
(
mem0
.
muãx
);

19104 
	`mÆlocWôhAœrm
(
n
, &
p
);

19105 
	`sqlôe3_muãx_Àave
(
mem0
.
muãx
);

19107 
p
 = 
sqlôe3GlobÆC⁄fig
.
m
.
	`xMÆloc
(
n
);

19109 
	`as£π
–
	`EIGHT_BYTE_ALIGNMENT
(
p
) );

19110  
p
;

19118 
SQLITE_API
 *
	`sqlôe3_mÆloc
(
n
){

19119 #i‚de‡
SQLITE_OMIT_AUTOINIT


19120 if–
	`sqlôe3_öôülize
() )  0;

19122  
	`sqlôe3MÆloc
(
n
);

19131 #i‡
SQLITE_THREADSAFE
==0 && !
	`deföed
(
NDEBUG
)

19132 
s¸©chAŒocOut
 = 0;

19144 
SQLITE_PRIVATE
 *
	`sqlôe3S¸©chMÆloc
(
n
){

19145 *
p
;

19146 
	`as£π
–
n
>0 );

19148 
	`sqlôe3_muãx_íãr
(
mem0
.
muãx
);

19149 if–
mem0
.
nS¸©chFªe
 && 
sqlôe3GlobÆC⁄fig
.
szS¸©ch
>=
n
 ){

19150 
p
 = 
mem0
.
pS¸©chFªe
;

19151 
mem0
.
pS¸©chFªe
 = mem0.pS¸©chFªe->
pNext
;

19152 
mem0
.
nS¸©chFªe
--;

19153 
	`sqlôe3SètusAdd
(
SQLITE_STATUS_SCRATCH_USED
, 1);

19154 
	`sqlôe3SètusSë
(
SQLITE_STATUS_SCRATCH_SIZE
, 
n
);

19155 
	`sqlôe3_muãx_Àave
(
mem0
.
muãx
);

19157 if–
sqlôe3GlobÆC⁄fig
.
bMem°©
 ){

19158 
	`sqlôe3SètusSë
(
SQLITE_STATUS_SCRATCH_SIZE
, 
n
);

19159 
n
 = 
	`mÆlocWôhAœrm
“, &
p
);

19160 if–
p
 ) 
	`sqlôe3SètusAdd
(
SQLITE_STATUS_SCRATCH_OVERFLOW
, 
n
);

19161 
	`sqlôe3_muãx_Àave
(
mem0
.
muãx
);

19163 
	`sqlôe3_muãx_Àave
(
mem0
.
muãx
);

19164 
p
 = 
sqlôe3GlobÆC⁄fig
.
m
.
	`xMÆloc
(
n
);

19166 
	`sqlôe3MemdebugSëTy≥
(
p
, 
MEMTYPE_SCRATCH
);

19168 
	`as£π
–
	`sqlôe3_muãx_nŸhñd
(
mem0
.
muãx
) );

19171 #i‡
SQLITE_THREADSAFE
==0 && !
	`deföed
(
NDEBUG
)

19176 
	`as£π
–
s¸©chAŒocOut
<=1 );

19177 if–
p
 ) 
s¸©chAŒocOut
++;

19180  
p
;

19182 
SQLITE_PRIVATE
 
	`sqlôe3S¸©chFªe
(*
p
){

19183 if–
p
 ){

19185 #i‡
SQLITE_THREADSAFE
==0 && !
	`deföed
(
NDEBUG
)

19190 
	`as£π
–
s¸©chAŒocOut
>=1 && scratchAllocOut<=2 );

19191 
s¸©chAŒocOut
--;

19194 if–
p
>=
sqlôe3GlobÆC⁄fig
.
pS¸©ch
 &&Ö<
mem0
.
pS¸©chEnd
 ){

19196 
S¸©chFªe¶Ÿ
 *
pSlŸ
;

19197 
pSlŸ
 = (
S¸©chFªe¶Ÿ
*)
p
;

19198 
	`sqlôe3_muãx_íãr
(
mem0
.
muãx
);

19199 
pSlŸ
->
pNext
 = 
mem0
.
pS¸©chFªe
;

19200 
mem0
.
pS¸©chFªe
 = 
pSlŸ
;

19201 
mem0
.
nS¸©chFªe
++;

19202 
	`as£π
–
mem0
.
nS¸©chFªe
 <(
u32
)
sqlôe3GlobÆC⁄fig
.
nS¸©ch
 );

19203 
	`sqlôe3SètusAdd
(
SQLITE_STATUS_SCRATCH_USED
, -1);

19204 
	`sqlôe3_muãx_Àave
(
mem0
.
muãx
);

19207 
	`as£π
–
	`sqlôe3MemdebugHasTy≥
(
p
, 
MEMTYPE_SCRATCH
) );

19208 
	`as£π
–
	`sqlôe3MemdebugNoTy≥
(
p
, ~
MEMTYPE_SCRATCH
) );

19209 
	`sqlôe3MemdebugSëTy≥
(
p
, 
MEMTYPE_HEAP
);

19210 if–
sqlôe3GlobÆC⁄fig
.
bMem°©
 ){

19211 
iSize
 = 
	`sqlôe3MÆlocSize
(
p
);

19212 
	`sqlôe3_muãx_íãr
(
mem0
.
muãx
);

19213 
	`sqlôe3SètusAdd
(
SQLITE_STATUS_SCRATCH_OVERFLOW
, -
iSize
);

19214 
	`sqlôe3SètusAdd
(
SQLITE_STATUS_MEMORY_USED
, -
iSize
);

19215 
	`sqlôe3SètusAdd
(
SQLITE_STATUS_MALLOC_COUNT
, -1);

19216 
sqlôe3GlobÆC⁄fig
.
m
.
	`xFªe
(
p
);

19217 
	`sqlôe3_muãx_Àave
(
mem0
.
muãx
);

19219 
sqlôe3GlobÆC⁄fig
.
m
.
	`xFªe
(
p
);

19228 #i‚de‡
SQLITE_OMIT_LOOKASIDE


19229 
	`isLookaside
(
sqlôe3
 *
db
, *
p
){

19230  
p
 &&Ö>=
db
->
lookaside
.
pSèπ
 &&Ö<db->lookaside.
pEnd
;

19233 
	#isLookaside
(
A
,
B
Ë0

	)

19240 
SQLITE_PRIVATE
 
	`sqlôe3MÆlocSize
(*
p
){

19241 
	`as£π
–
	`sqlôe3MemdebugHasTy≥
(
p
, 
MEMTYPE_HEAP
) );

19242 
	`as£π
–
	`sqlôe3MemdebugNoTy≥
(
p
, 
MEMTYPE_DB
) );

19243  
sqlôe3GlobÆC⁄fig
.
m
.
	`xSize
(
p
);

19245 
SQLITE_PRIVATE
 
	`sqlôe3DbMÆlocSize
(
sqlôe3
 *
db
, *
p
){

19246 
	`as£π
–
db
==0 || 
	`sqlôe3_muãx_hñd
(db->
muãx
) );

19247 if–
db
 && 
	`isLookaside
(db, 
p
) ){

19248  
db
->
lookaside
.
sz
;

19250 
	`as£π
–
	`sqlôe3MemdebugHasTy≥
(
p
, 
MEMTYPE_DB
) );

19251 
	`as£π
–
	`sqlôe3MemdebugHasTy≥
(
p
, 
MEMTYPE_LOOKASIDE
|
MEMTYPE_HEAP
) );

19252 
	`as£π
–
db
!=0 || 
	`sqlôe3MemdebugNoTy≥
(
p
, 
MEMTYPE_LOOKASIDE
) );

19253  
sqlôe3GlobÆC⁄fig
.
m
.
	`xSize
(
p
);

19260 
SQLITE_API
 
	`sqlôe3_‰ì
(*
p
){

19261 if–
p
==0 ) ;

19262 
	`as£π
–
	`sqlôe3MemdebugNoTy≥
(
p
, 
MEMTYPE_DB
) );

19263 
	`as£π
–
	`sqlôe3MemdebugHasTy≥
(
p
, 
MEMTYPE_HEAP
) );

19264 if–
sqlôe3GlobÆC⁄fig
.
bMem°©
 ){

19265 
	`sqlôe3_muãx_íãr
(
mem0
.
muãx
);

19266 
	`sqlôe3SètusAdd
(
SQLITE_STATUS_MEMORY_USED
, -
	`sqlôe3MÆlocSize
(
p
));

19267 
	`sqlôe3SètusAdd
(
SQLITE_STATUS_MALLOC_COUNT
, -1);

19268 
sqlôe3GlobÆC⁄fig
.
m
.
	`xFªe
(
p
);

19269 
	`sqlôe3_muãx_Àave
(
mem0
.
muãx
);

19271 
sqlôe3GlobÆC⁄fig
.
m
.
	`xFªe
(
p
);

19279 
SQLITE_PRIVATE
 
	`sqlôe3DbFªe
(
sqlôe3
 *
db
, *
p
){

19280 
	`as£π
–
db
==0 || 
	`sqlôe3_muãx_hñd
(db->
muãx
) );

19281 if–
p
==0 ) ;

19282 if–
db
 ){

19283 if–
db
->
≤ByãsFªed
 ){

19284 *
db
->
≤ByãsFªed
 +
	`sqlôe3DbMÆlocSize
(db, 
p
);

19287 if–
	`isLookaside
(
db
, 
p
) ){

19288 
LookasideSlŸ
 *
pBuf
 = (LookasideSlŸ*)
p
;

19289 #i‡
SQLITE_DEBUG


19291 
	`mem£t
(
p
, 0xØ, 
db
->
lookaside
.
sz
);

19293 
pBuf
->
pNext
 = 
db
->
lookaside
.
pFªe
;

19294 
db
->
lookaside
.
pFªe
 = 
pBuf
;

19295 
db
->
lookaside
.
nOut
--;

19299 
	`as£π
–
	`sqlôe3MemdebugHasTy≥
(
p
, 
MEMTYPE_DB
) );

19300 
	`as£π
–
	`sqlôe3MemdebugHasTy≥
(
p
, 
MEMTYPE_LOOKASIDE
|
MEMTYPE_HEAP
) );

19301 
	`as£π
–
db
!=0 || 
	`sqlôe3MemdebugNoTy≥
(
p
, 
MEMTYPE_LOOKASIDE
) );

19302 
	`sqlôe3MemdebugSëTy≥
(
p
, 
MEMTYPE_HEAP
);

19303 
	`sqlôe3_‰ì
(
p
);

19309 
SQLITE_PRIVATE
 *
	`sqlôe3RóŒoc
(*
pOld
, 
nByãs
){

19310 
nOld
, 
nNew
, 
nDiff
;

19311 *
pNew
;

19312 if–
pOld
==0 ){

19313  
	`sqlôe3MÆloc
(
nByãs
);

19315 if–
nByãs
<=0 ){

19316 
	`sqlôe3_‰ì
(
pOld
);

19319 if–
nByãs
>=0x7fffff00 ){

19323 
nOld
 = 
	`sqlôe3MÆlocSize
(
pOld
);

19327 
nNew
 = 
sqlôe3GlobÆC⁄fig
.
m
.
	`xRoundup
(
nByãs
);

19328 if–
nOld
==
nNew
 ){

19329 
pNew
 = 
pOld
;

19330 }if–
sqlôe3GlobÆC⁄fig
.
bMem°©
 ){

19331 
	`sqlôe3_muãx_íãr
(
mem0
.
muãx
);

19332 
	`sqlôe3SètusSë
(
SQLITE_STATUS_MALLOC_SIZE
, 
nByãs
);

19333 
nDiff
 = 
nNew
 - 
nOld
;

19334 if–
	`sqlôe3SètusVÆue
(
SQLITE_STATUS_MEMORY_USED
) >=

19335 
mem0
.
Æ¨mThªshﬁd
-
nDiff
 ){

19336 
	`sqlôe3MÆlocAœrm
(
nDiff
);

19338 
	`as£π
–
	`sqlôe3MemdebugHasTy≥
(
pOld
, 
MEMTYPE_HEAP
) );

19339 
	`as£π
–
	`sqlôe3MemdebugNoTy≥
(
pOld
, ~
MEMTYPE_HEAP
) );

19340 
pNew
 = 
sqlôe3GlobÆC⁄fig
.
m
.
	`xRóŒoc
(
pOld
, 
nNew
);

19341 if–
pNew
==0 && 
mem0
.
Æ¨mCÆlback
 ){

19342 
	`sqlôe3MÆlocAœrm
(
nByãs
);

19343 
pNew
 = 
sqlôe3GlobÆC⁄fig
.
m
.
	`xRóŒoc
(
pOld
, 
nNew
);

19345 if–
pNew
 ){

19346 
nNew
 = 
	`sqlôe3MÆlocSize
(
pNew
);

19347 
	`sqlôe3SètusAdd
(
SQLITE_STATUS_MEMORY_USED
, 
nNew
-
nOld
);

19349 
	`sqlôe3_muãx_Àave
(
mem0
.
muãx
);

19351 
pNew
 = 
sqlôe3GlobÆC⁄fig
.
m
.
	`xRóŒoc
(
pOld
, 
nNew
);

19353 
	`as£π
–
	`EIGHT_BYTE_ALIGNMENT
(
pNew
) );

19354  
pNew
;

19361 
SQLITE_API
 *
	`sqlôe3_ªÆloc
(*
pOld
, 
n
){

19362 #i‚de‡
SQLITE_OMIT_AUTOINIT


19363 if–
	`sqlôe3_öôülize
() )  0;

19365  
	`sqlôe3RóŒoc
(
pOld
, 
n
);

19372 
SQLITE_PRIVATE
 *
	`sqlôe3MÆlocZîo
(
n
){

19373 *
p
 = 
	`sqlôe3MÆloc
(
n
);

19374 if–
p
 ){

19375 
	`mem£t
(
p
, 0, 
n
);

19377  
p
;

19384 
SQLITE_PRIVATE
 *
	`sqlôe3DbMÆlocZîo
(
sqlôe3
 *
db
, 
n
){

19385 *
p
 = 
	`sqlôe3DbMÆlocRaw
(
db
, 
n
);

19386 if–
p
 ){

19387 
	`mem£t
(
p
, 0, 
n
);

19389  
p
;

19410 
SQLITE_PRIVATE
 *
	`sqlôe3DbMÆlocRaw
(
sqlôe3
 *
db
, 
n
){

19411 *
p
;

19412 
	`as£π
–
db
==0 || 
	`sqlôe3_muãx_hñd
(db->
muãx
) );

19413 
	`as£π
–
db
==0 || db->
≤ByãsFªed
==0 );

19414 #i‚de‡
SQLITE_OMIT_LOOKASIDE


19415 if–
db
 ){

19416 
LookasideSlŸ
 *
pBuf
;

19417 if–
db
->
mÆlocFaûed
 ){

19420 if–
db
->
lookaside
.
bE«bÀd
 ){

19421 if–
n
>
db
->
lookaside
.
sz
 ){

19422 
db
->
lookaside
.
™Sèt
[1]++;

19423 }if–(
pBuf
 = 
db
->
lookaside
.
pFªe
)==0 ){

19424 
db
->
lookaside
.
™Sèt
[2]++;

19426 
db
->
lookaside
.
pFªe
 = 
pBuf
->
pNext
;

19427 
db
->
lookaside
.
nOut
++;

19428 
db
->
lookaside
.
™Sèt
[0]++;

19429 if–
db
->
lookaside
.
nOut
>db->lookaside.
mxOut
 ){

19430 
db
->
lookaside
.
mxOut
 = db->lookaside.
nOut
;

19432  (*)
pBuf
;

19437 if–
db
 && db->
mÆlocFaûed
 ){

19441 
p
 = 
	`sqlôe3MÆloc
(
n
);

19442 if–!
p
 && 
db
 ){

19443 
db
->
mÆlocFaûed
 = 1;

19445 
	`sqlôe3MemdebugSëTy≥
(
p
, 
MEMTYPE_DB
 |

19446 ((
db
 && db->
lookaside
.
bE«bÀd
Ë? 
MEMTYPE_LOOKASIDE
 : 
MEMTYPE_HEAP
));

19447  
p
;

19454 
SQLITE_PRIVATE
 *
	`sqlôe3DbRóŒoc
(
sqlôe3
 *
db
, *
p
, 
n
){

19455 *
pNew
 = 0;

19456 
	`as£π
–
db
!=0 );

19457 
	`as£π
–
	`sqlôe3_muãx_hñd
(
db
->
muãx
) );

19458 if–
db
->
mÆlocFaûed
==0 ){

19459 if–
p
==0 ){

19460  
	`sqlôe3DbMÆlocRaw
(
db
, 
n
);

19462 if–
	`isLookaside
(
db
, 
p
) ){

19463 if–
n
<=
db
->
lookaside
.
sz
 ){

19464  
p
;

19466 
pNew
 = 
	`sqlôe3DbMÆlocRaw
(
db
, 
n
);

19467 if–
pNew
 ){

19468 
	`mem˝y
(
pNew
, 
p
, 
db
->
lookaside
.
sz
);

19469 
	`sqlôe3DbFªe
(
db
, 
p
);

19472 
	`as£π
–
	`sqlôe3MemdebugHasTy≥
(
p
, 
MEMTYPE_DB
) );

19473 
	`as£π
–
	`sqlôe3MemdebugHasTy≥
(
p
, 
MEMTYPE_LOOKASIDE
|
MEMTYPE_HEAP
) );

19474 
	`sqlôe3MemdebugSëTy≥
(
p
, 
MEMTYPE_HEAP
);

19475 
pNew
 = 
	`sqlôe3_ªÆloc
(
p
, 
n
);

19476 if–!
pNew
 ){

19477 
	`sqlôe3MemdebugSëTy≥
(
p
, 
MEMTYPE_DB
|
MEMTYPE_HEAP
);

19478 
db
->
mÆlocFaûed
 = 1;

19480 
	`sqlôe3MemdebugSëTy≥
(
pNew
, 
MEMTYPE_DB
 |

19481 (
db
->
lookaside
.
bE«bÀd
 ? 
MEMTYPE_LOOKASIDE
 : 
MEMTYPE_HEAP
));

19484  
pNew
;

19491 
SQLITE_PRIVATE
 *
	`sqlôe3DbRóŒocOrFªe
(
sqlôe3
 *
db
, *
p
, 
n
){

19492 *
pNew
;

19493 
pNew
 = 
	`sqlôe3DbRóŒoc
(
db
, 
p
, 
n
);

19494 if–!
pNew
 ){

19495 
	`sqlôe3DbFªe
(
db
, 
p
);

19497  
pNew
;

19507 
SQLITE_PRIVATE
 *
	`sqlôe3DbSåDup
(
sqlôe3
 *
db
, c⁄° *
z
){

19508 *
zNew
;

19509 
size_t
 
n
;

19510 if–
z
==0 ){

19513 
n
 = 
	`sqlôe3SåÀn30
(
z
) + 1;

19514 
	`as£π
–(
n
&0x7fffffff)==n );

19515 
zNew
 = 
	`sqlôe3DbMÆlocRaw
(
db
, ()
n
);

19516 if–
zNew
 ){

19517 
	`mem˝y
(
zNew
, 
z
, 
n
);

19519  
zNew
;

19521 
SQLITE_PRIVATE
 *
	`sqlôe3DbSåNDup
(
sqlôe3
 *
db
, c⁄° *
z
, 
n
){

19522 *
zNew
;

19523 if–
z
==0 ){

19526 
	`as£π
–(
n
&0x7fffffff)==n );

19527 
zNew
 = 
	`sqlôe3DbMÆlocRaw
(
db
, 
n
+1);

19528 if–
zNew
 ){

19529 
	`mem˝y
(
zNew
, 
z
, 
n
);

19530 
zNew
[
n
] = 0;

19532  
zNew
;

19540 
SQLITE_PRIVATE
 
	`sqlôe3SëSåög
(**
pz
, 
sqlôe3
 *
db
, c⁄° *
zF‹m©
, ...){

19541 
va_li°
 
≠
;

19542 *
z
;

19544 
	`va_°¨t
(
≠
, 
zF‹m©
);

19545 
z
 = 
	`sqlôe3VMPrötf
(
db
, 
zF‹m©
, 
≠
);

19546 
	`va_íd
(
≠
);

19547 
	`sqlôe3DbFªe
(
db
, *
pz
);

19548 *
pz
 = 
z
;

19565 
SQLITE_PRIVATE
 
	`sqlôe3ApiExô
(
sqlôe3
* 
db
, 
rc
){

19570 
	`as£π
–!
db
 || 
	`sqlôe3_muãx_hñd
(db->
muãx
) );

19571 if–
db
 && (db->
mÆlocFaûed
 || 
rc
==
SQLITE_IOERR_NOMEM
) ){

19572 
	`sqlôe3Eº‹
(
db
, 
SQLITE_NOMEM
, 0);

19573 
db
->
mÆlocFaûed
 = 0;

19574 
rc
 = 
SQLITE_NOMEM
;

19576  
rc
 & (
db
 ? db->
îrMask
 : 0xff);

19600 
	#ëRADIX
 1

	)

19601 
	#ëFLOAT
 2

	)

19602 
	#ëEXP
 3

	)

19603 
	#ëGENERIC
 4

	)

19604 
	#ëSIZE
 5

	)

19605 
	#ëSTRING
 6

	)

19606 
	#ëDYNSTRING
 7

	)

19607 
	#ëPERCENT
 8

	)

19608 
	#ëCHARX
 9

	)

19610 
	#ëSQLESCAPE
 10

	)

19611 
	#ëSQLESCAPE2
 11

	)

19613 
	#ëTOKEN
 12

	)

19614 
	#ëSRCLIST
 13

	)

19615 
	#ëPOINTER
 14

	)

19616 
	#ëSQLESCAPE3
 15

	)

19617 
	#ëORDINAL
 16

	)

19619 
	#ëINVALID
 0

	)

19625 
	tëByã
;

19631 
	së_öfo
 {

19632 
fmây≥
;

19633 
ëByã
 
ba£
;

19634 
ëByã
 
Êags
;

19635 
ëByã
 
ty≥
;

19636 
ëByã
 
ch¨£t
;

19637 
ëByã
 
¥efix
;

19638 } 
	të_öfo
;

19643 
	#FLAG_SIGNED
 1

	)

19644 
	#FLAG_INTERN
 2

	)

19645 
	#FLAG_STRING
 4

	)

19652 c⁄° 
aDigôs
[] = "0123456789ABCDEF0123456789abcdef";

19653 c⁄° 
aPªfix
[] = "-x0\000X0";

19654 c⁄° 
ë_öfo
 
fmtöfo
[] = {

19655 { 'd', 10, 1, 
ëRADIX
, 0, 0 },

19656 { 's', 0, 4, 
ëSTRING
, 0, 0 },

19657 { 'g', 0, 1, 
ëGENERIC
, 30, 0 },

19658 { 'z', 0, 4, 
ëDYNSTRING
, 0, 0 },

19659 { 'q', 0, 4, 
ëSQLESCAPE
, 0, 0 },

19660 { 'Q', 0, 4, 
ëSQLESCAPE2
, 0, 0 },

19661 { 'w', 0, 4, 
ëSQLESCAPE3
, 0, 0 },

19662 { 'c', 0, 0, 
ëCHARX
, 0, 0 },

19663 { 'o', 8, 0, 
ëRADIX
, 0, 2 },

19664 { 'u', 10, 0, 
ëRADIX
, 0, 0 },

19665 { 'x', 16, 0, 
ëRADIX
, 16, 1 },

19666 { 'X', 16, 0, 
ëRADIX
, 0, 4 },

19667 #i‚de‡
SQLITE_OMIT_FLOATING_POINT


19668 { 'f', 0, 1, 
ëFLOAT
, 0, 0 },

19669 { 'e', 0, 1, 
ëEXP
, 30, 0 },

19670 { 'E', 0, 1, 
ëEXP
, 14, 0 },

19671 { 'G', 0, 1, 
ëGENERIC
, 14, 0 },

19673 { 'i', 10, 1, 
ëRADIX
, 0, 0 },

19674 { 'n', 0, 0, 
ëSIZE
, 0, 0 },

19675 { '%', 0, 0, 
ëPERCENT
, 0, 0 },

19676 { 'p', 16, 0, 
ëPOINTER
, 0, 1 },

19680 { 'T', 0, 2, 
ëTOKEN
, 0, 0 },

19681 { 'S', 0, 2, 
ëSRCLIST
, 0, 0 },

19682 { 'r', 10, 3, 
ëORDINAL
, 0, 0 },

19689 #i‚de‡
SQLITE_OMIT_FLOATING_POINT


19703 
	`ë_gëdigô
(
LONGDOUBLE_TYPE
 *
vÆ
, *
˙t
){

19704 
digô
;

19705 
LONGDOUBLE_TYPE
 
d
;

19706 if–(*
˙t
)<=0 )  '0';

19707 (*
˙t
)--;

19708 
digô
 = ()*
vÆ
;

19709 
d
 = 
digô
;

19710 
digô
 += '0';

19711 *
vÆ
 = (*vÆ - 
d
)*10.0;

19712  ()
digô
;

19719 
SQLITE_PRIVATE
 
	`sqlôe3AµídS∑˚
(
SåAccum
 *
pAccum
, 
N
){

19720 c⁄° 
zS∑˚s
[] = " ";

19721  
N
>=()(
zS∑˚s
)-1 ){

19722 
	`sqlôe3SåAccumAµíd
(
pAccum
, 
zS∑˚s
, (zSpaces)-1);

19723 
N
 -(
zS∑˚s
)-1;

19725 if–
N
>0 ){

19726 
	`sqlôe3SåAccumAµíd
(
pAccum
, 
zS∑˚s
, 
N
);

19734 #i‚de‡
SQLITE_PRINT_BUF_SIZE


19735 
	#SQLITE_PRINT_BUF_SIZE
 70

	)

19737 
	#ëBUFSIZE
 
SQLITE_PRINT_BUF_SIZE


	)

19742 
SQLITE_PRIVATE
 
	`sqlôe3VXPrötf
(

19743 
SåAccum
 *
pAccum
,

19744 
u£Exãnded
,

19745 c⁄° *
fmt
,

19746 
va_li°
 
≠


19748 
c
;

19749 *
buÂt
;

19750 
¥ecisi⁄
;

19751 
Àngth
;

19752 
idx
;

19753 
width
;

19754 
ëByã
 
Êag_À·ju°ify
;

19755 
ëByã
 
Êag_∂ussign
;

19756 
ëByã
 
Êag_bœnksign
;

19757 
ëByã
 
Êag_Æã∫©ef‹m
;

19758 
ëByã
 
Êag_Ætf‹m2
;

19759 
ëByã
 
Êag_zî›ad
;

19760 
ëByã
 
Êag_l⁄g
;

19761 
ëByã
 
Êag_l⁄gl⁄g
;

19762 
ëByã
 
d⁄e
;

19763 
ëByã
 
xty≥
 = 0;

19764 
¥efix
;

19765 
sqlôe_uöt64
 
l⁄gvÆue
;

19766 
LONGDOUBLE_TYPE
 
ªÆvÆue
;

19767 c⁄° 
ë_öfo
 *
öf›
;

19768 *
zOut
;

19769 
nOut
;

19770 *
zExåa
;

19771 #i‚de‡
SQLITE_OMIT_FLOATING_POINT


19772 
exp
, 
e2
;

19773 
nsd
;

19774 
roundî
;

19775 
ëByã
 
Êag_dp
;

19776 
ëByã
 
Êag_πz
;

19778 
buf
[
ëBUFSIZE
];

19780 
buÂt
 = 0;

19781 ; (
c
=(*
fmt
))!=0; ++fmt){

19782 if–
c
!='%' ){

19783 
amt
;

19784 
buÂt
 = (*)
fmt
;

19785 
amt
 = 1;

19786  (
c
=(*++
fmt
))!='%' && c!=0 ) 
amt
++;

19787 
	`sqlôe3SåAccumAµíd
(
pAccum
, 
buÂt
, 
amt
);

19788 if–
c
==0 ) ;

19790 if–(
c
=(*++
fmt
))==0 ){

19791 
	`sqlôe3SåAccumAµíd
(
pAccum
, "%", 1);

19795 
Êag_À·ju°ify
 = 
Êag_∂ussign
 = 
Êag_bœnksign
 =

19796 
Êag_Æã∫©ef‹m
 = 
Êag_Ætf‹m2
 = 
Êag_zî›ad
 = 0;

19797 
d⁄e
 = 0;

19799  
c
 ){

19800 '-': 
Êag_À·ju°ify
 = 1; ;

19801 '+': 
Êag_∂ussign
 = 1; ;

19802 ' ': 
Êag_bœnksign
 = 1; ;

19803 '#': 
Êag_Æã∫©ef‹m
 = 1; ;

19804 '!': 
Êag_Ætf‹m2
 = 1; ;

19805 '0': 
Êag_zî›ad
 = 1; ;

19806 : 
d⁄e
 = 1; ;

19808 } !
d⁄e
 && (
c
=(*++
fmt
))!=0 );

19810 
width
 = 0;

19811 if–
c
=='*' ){

19812 
width
 = 
	`va_¨g
(
≠
,);

19813 if–
width
<0 ){

19814 
Êag_À·ju°ify
 = 1;

19815 
width
 = -width;

19817 
c
 = *++
fmt
;

19819  
c
>='0' && c<='9' ){

19820 
width
 = width*10 + 
c
 - '0';

19821 
c
 = *++
fmt
;

19825 if–
c
=='.' ){

19826 
¥ecisi⁄
 = 0;

19827 
c
 = *++
fmt
;

19828 if–
c
=='*' ){

19829 
¥ecisi⁄
 = 
	`va_¨g
(
≠
,);

19830 if–
¥ecisi⁄
<0 )Örecision = -precision;

19831 
c
 = *++
fmt
;

19833  
c
>='0' && c<='9' ){

19834 
¥ecisi⁄
 =Öªcisi⁄*10 + 
c
 - '0';

19835 
c
 = *++
fmt
;

19839 
¥ecisi⁄
 = -1;

19842 if–
c
=='l' ){

19843 
Êag_l⁄g
 = 1;

19844 
c
 = *++
fmt
;

19845 if–
c
=='l' ){

19846 
Êag_l⁄gl⁄g
 = 1;

19847 
c
 = *++
fmt
;

19849 
Êag_l⁄gl⁄g
 = 0;

19852 
Êag_l⁄g
 = 
Êag_l⁄gl⁄g
 = 0;

19855 
öf›
 = &
fmtöfo
[0];

19856 
xty≥
 = 
ëINVALID
;

19857 
idx
=0; idx<
	`AºaySize
(
fmtöfo
); idx++){

19858 if–
c
==
fmtöfo
[
idx
].
fmây≥
 ){

19859 
öf›
 = &
fmtöfo
[
idx
];

19860 if–
u£Exãnded
 || (
öf›
->
Êags
 & 
FLAG_INTERN
)==0 ){

19861 
xty≥
 = 
öf›
->
ty≥
;

19868 
zExåa
 = 0;

19891  
xty≥
 ){

19892 
ëPOINTER
:

19893 
Êag_l⁄gl⁄g
 = (*)==(
i64
);

19894 
Êag_l⁄g
 = (*)==();

19896 
ëORDINAL
:

19897 
ëRADIX
:

19898 if–
öf›
->
Êags
 & 
FLAG_SIGNED
 ){

19899 
i64
 
v
;

19900 if–
Êag_l⁄gl⁄g
 ){

19901 
v
 = 
	`va_¨g
(
≠
,
i64
);

19902 }if–
Êag_l⁄g
 ){

19903 
v
 = 
	`va_¨g
(
≠
,);

19905 
v
 = 
	`va_¨g
(
≠
,);

19907 if–
v
<0 ){

19908 if–
v
==
SMALLEST_INT64
 ){

19909 
l⁄gvÆue
 = ((
u64
)1)<<63;

19911 
l⁄gvÆue
 = -
v
;

19913 
¥efix
 = '-';

19915 
l⁄gvÆue
 = 
v
;

19916 if–
Êag_∂ussign
 ) 
¥efix
 = '+';

19917 if–
Êag_bœnksign
 ) 
¥efix
 = ' ';

19918 
¥efix
 = 0;

19921 if–
Êag_l⁄gl⁄g
 ){

19922 
l⁄gvÆue
 = 
	`va_¨g
(
≠
,
u64
);

19923 }if–
Êag_l⁄g
 ){

19924 
l⁄gvÆue
 = 
	`va_¨g
(
≠
,);

19926 
l⁄gvÆue
 = 
	`va_¨g
(
≠
,);

19928 
¥efix
 = 0;

19930 if–
l⁄gvÆue
==0 ) 
Êag_Æã∫©ef‹m
 = 0;

19931 if–
Êag_zî›ad
 && 
¥ecisi⁄
<
width
-(
¥efix
!=0) ){

19932 
¥ecisi⁄
 = 
width
-(
¥efix
!=0);

19934 if–
¥ecisi⁄
<
ëBUFSIZE
-10 ){

19935 
nOut
 = 
ëBUFSIZE
;

19936 
zOut
 = 
buf
;

19938 
nOut
 = 
¥ecisi⁄
 + 10;

19939 
zOut
 = 
zExåa
 = 
	`sqlôe3MÆloc
–
nOut
 );

19940 if–
zOut
==0 ){

19941 
pAccum
->
accEº‹
 = 
STRACCUM_NOMEM
;

19945 
buÂt
 = &
zOut
[
nOut
-1];

19946 if–
xty≥
==
ëORDINAL
 ){

19947 c⁄° 
zOrd
[] = "thstndrd";

19948 
x
 = ()(
l⁄gvÆue
 % 10);

19949 if–
x
>=4 || (
l⁄gvÆue
/10)%10==1 ){

19950 
x
 = 0;

19952 *(--
buÂt
Ë
zOrd
[
x
*2+1];

19953 *(--
buÂt
Ë
zOrd
[
x
*2];

19956 c⁄° *
c£t
;

19957 
ba£
;

19958 
c£t
 = &
aDigôs
[
öf›
->
ch¨£t
];

19959 
ba£
 = 
öf›
->base;

19961 *(--
buÂt
Ë
c£t
[
l⁄gvÆue
%
ba£
];

19962 
l⁄gvÆue
 =Ü⁄gvÆue/
ba£
;

19963 } 
l⁄gvÆue
>0 );

19965 
Àngth
 = ()(&
zOut
[
nOut
-1]-
buÂt
);

19966 
idx
=
¥ecisi⁄
-
Àngth
; idx>0; idx--){

19967 *(--
buÂt
) = '0';

19969 if–
¥efix
 ) *(--
buÂt
) =Örefix;

19970 if–
Êag_Æã∫©ef‹m
 && 
öf›
->
¥efix
 ){

19971 c⁄° *
¥e
;

19972 
x
;

19973 
¥e
 = &
aPªfix
[
öf›
->
¥efix
];

19974 ; (
x
=(*
¥e
))!=0;Öª++Ë*(--
buÂt
) = x;

19976 
Àngth
 = ()(&
zOut
[
nOut
-1]-
buÂt
);

19978 
ëFLOAT
:

19979 
ëEXP
:

19980 
ëGENERIC
:

19981 
ªÆvÆue
 = 
	`va_¨g
(
≠
,);

19982 #ifde‡
SQLITE_OMIT_FLOATING_POINT


19983 
Àngth
 = 0;

19985 if–
¥ecisi⁄
<0 )Örecision = 6;

19986 if–
ªÆvÆue
<0.0 ){

19987 
ªÆvÆue
 = -realvalue;

19988 
¥efix
 = '-';

19990 if–
Êag_∂ussign
 ) 
¥efix
 = '+';

19991 if–
Êag_bœnksign
 ) 
¥efix
 = ' ';

19992 
¥efix
 = 0;

19994 if–
xty≥
==
ëGENERIC
 && 
¥ecisi⁄
>0 )Örecision--;

19995 
idx
=
¥ecisi⁄
, 
roundî
=0.5; idx>0; idx--,Ñounder*=0.1){}

19996 if–
xty≥
==
ëFLOAT
 ) 
ªÆvÆue
 +
roundî
;

19998 
exp
 = 0;

19999 if–
	`sqlôe3IsNaN
(()
ªÆvÆue
) ){

20000 
buÂt
 = "NaN";

20001 
Àngth
 = 3;

20004 if–
ªÆvÆue
>0.0 ){

20005 
LONGDOUBLE_TYPE
 
sˇÀ
 = 1.0;

20006  
ªÆvÆue
>=1e100*
sˇÀ
 && 
exp
<=350 ){ scale *= 1e100;exp+=100;}

20007  
ªÆvÆue
>=1e64*
sˇÀ
 && 
exp
<=350 ){ scale *= 1e64;Éxp+=64; }

20008  
ªÆvÆue
>=1e8*
sˇÀ
 && 
exp
<=350 ){ scale *= 1e8;Éxp+=8; }

20009  
ªÆvÆue
>=10.0*
sˇÀ
 && 
exp
<=350 ){ scale *= 10.0;Éxp++; }

20010 
ªÆvÆue
 /
sˇÀ
;

20011  
ªÆvÆue
<1e-8 ){ÑólvÆuê*1e8; 
exp
-=8; }

20012  
ªÆvÆue
<1.0 ){ÑólvÆuê*10.0; 
exp
--; }

20013 if–
exp
>350 ){

20014 if–
¥efix
=='-' ){

20015 
buÂt
 = "-Inf";

20016 }if–
¥efix
=='+' ){

20017 
buÂt
 = "+Inf";

20019 
buÂt
 = "Inf";

20021 
Àngth
 = 
	`sqlôe3SåÀn30
(
buÂt
);

20025 
buÂt
 = 
buf
;

20030 if–
xty≥
!=
ëFLOAT
 ){

20031 
ªÆvÆue
 +
roundî
;

20032 if–
ªÆvÆue
>=10.0 ){ÑólvÆuê*0.1; 
exp
++; }

20034 if–
xty≥
==
ëGENERIC
 ){

20035 
Êag_πz
 = !
Êag_Æã∫©ef‹m
;

20036 if–
exp
<-4 ||Éxp>
¥ecisi⁄
 ){

20037 
xty≥
 = 
ëEXP
;

20039 
¥ecisi⁄
 =Öªcisi⁄ - 
exp
;

20040 
xty≥
 = 
ëFLOAT
;

20043 
Êag_πz
 = 
Êag_Ætf‹m2
;

20045 if–
xty≥
==
ëEXP
 ){

20046 
e2
 = 0;

20048 
e2
 = 
exp
;

20050 if–
	`MAX
(
e2
,0)+
¥ecisi⁄
+
width
 > 
ëBUFSIZE
 - 15 ){

20051 
buÂt
 = 
zExåa
 = 
	`sqlôe3MÆloc
–
	`MAX
(
e2
,0)+
¥ecisi⁄
+
width
+15 );

20052 if–
buÂt
==0 ){

20053 
pAccum
->
accEº‹
 = 
STRACCUM_NOMEM
;

20057 
zOut
 = 
buÂt
;

20058 
nsd
 = 16 + 
Êag_Ætf‹m2
*10;

20059 
Êag_dp
 = (
¥ecisi⁄
>0 ?1:0Ë| 
Êag_Æã∫©ef‹m
 | 
Êag_Ætf‹m2
;

20061 if–
¥efix
 ){

20062 *(
buÂt
++Ë
¥efix
;

20065 if–
e2
<0 ){

20066 *(
buÂt
++) = '0';

20068 ; 
e2
>=0;É2--){

20069 *(
buÂt
++Ë
	`ë_gëdigô
(&
ªÆvÆue
,&
nsd
);

20073 if–
Êag_dp
 ){

20074 *(
buÂt
++) = '.';

20078 
e2
++;É2<0; 
¥ecisi⁄
--,É2++){

20079 
	`as£π
–
¥ecisi⁄
>0 );

20080 *(
buÂt
++) = '0';

20083  (
¥ecisi⁄
--)>0 ){

20084 *(
buÂt
++Ë
	`ë_gëdigô
(&
ªÆvÆue
,&
nsd
);

20087 if–
Êag_πz
 && 
Êag_dp
 ){

20088  
buÂt
[-1]=='0' ) *(--bufpt) = 0;

20089 
	`as£π
–
buÂt
>
zOut
 );

20090 if–
buÂt
[-1]=='.' ){

20091 if–
Êag_Ætf‹m2
 ){

20092 *(
buÂt
++) = '0';

20094 *(--
buÂt
) = 0;

20099 if–
xty≥
==
ëEXP
 ){

20100 *(
buÂt
++Ë
aDigôs
[
öf›
->
ch¨£t
];

20101 if–
exp
<0 ){

20102 *(
buÂt
++Ë'-'; 
exp
 = -exp;

20104 *(
buÂt
++) = '+';

20106 if–
exp
>=100 ){

20107 *(
buÂt
++Ë()((
exp
/100)+'0');

20108 
exp
 %= 100;

20110 *(
buÂt
++Ë()(
exp
/10+'0');

20111 *(
buÂt
++Ë()(
exp
%10+'0');

20113 *
buÂt
 = 0;

20118 
Àngth
 = ()(
buÂt
-
zOut
);

20119 
buÂt
 = 
zOut
;

20123 if–
Êag_zî›ad
 && !
Êag_À·ju°ify
 && 
Àngth
 < 
width
){

20124 
i
;

20125 
nPad
 = 
width
 - 
Àngth
;

20126 
i
=
width
; i>=
nPad
; i--){

20127 
buÂt
[
i
] = buÂt[i-
nPad
];

20129 
i
 = 
¥efix
!=0;

20130  
nPad
-- ) 
buÂt
[
i
++] = '0';

20131 
Àngth
 = 
width
;

20135 
ëSIZE
:

20136 *(
	`va_¨g
(
≠
,*)Ë
pAccum
->
nCh¨
;

20137 
Àngth
 = 
width
 = 0;

20139 
ëPERCENT
:

20140 
buf
[0] = '%';

20141 
buÂt
 = 
buf
;

20142 
Àngth
 = 1;

20144 
ëCHARX
:

20145 
c
 = 
	`va_¨g
(
≠
,);

20146 
buf
[0] = ()
c
;

20147 if–
¥ecisi⁄
>=0 ){

20148 
idx
=1; idx<
¥ecisi⁄
; idx++Ë
buf
[idx] = ()
c
;

20149 
Àngth
 = 
¥ecisi⁄
;

20151 
Àngth
 =1;

20153 
buÂt
 = 
buf
;

20155 
ëSTRING
:

20156 
ëDYNSTRING
:

20157 
buÂt
 = 
	`va_¨g
(
≠
,*);

20158 if–
buÂt
==0 ){

20159 
buÂt
 = "";

20160 }if–
xty≥
==
ëDYNSTRING
 ){

20161 
zExåa
 = 
buÂt
;

20163 if–
¥ecisi⁄
>=0 ){

20164 
Àngth
=0;Üígth<
¥ecisi⁄
 && 
buÂt
[length];Üength++){}

20166 
Àngth
 = 
	`sqlôe3SåÀn30
(
buÂt
);

20169 
ëSQLESCAPE
:

20170 
ëSQLESCAPE2
:

20171 
ëSQLESCAPE3
: {

20172 
i
, 
j
, 
k
, 
n
, 
i¢uŒ
;

20173 
√edQuŸe
;

20174 
ch
;

20175 
q
 = ((
xty≥
==
ëSQLESCAPE3
)?'"':'\'');

20176 *
esˇrg
 = 
	`va_¨g
(
≠
,*);

20177 
i¢uŒ
 = 
esˇrg
==0;

20178 if–
i¢uŒ
 ) 
esˇrg
 = (
xty≥
==
ëSQLESCAPE2
 ? "NULL" : "(NULL)");

20179 
k
 = 
¥ecisi⁄
;

20180 
i
=
n
=0; 
k
!=0 && (
ch
=
esˇrg
[i])!=0; i++, k--){

20181 if–
ch
==
q
 ) 
n
++;

20183 
√edQuŸe
 = !
i¢uŒ
 && 
xty≥
==
ëSQLESCAPE2
;

20184 
n
 +
i
 + 1 + 
√edQuŸe
*2;

20185 if–
n
>
ëBUFSIZE
 ){

20186 
buÂt
 = 
zExåa
 = 
	`sqlôe3MÆloc
–
n
 );

20187 if–
buÂt
==0 ){

20188 
pAccum
->
accEº‹
 = 
STRACCUM_NOMEM
;

20192 
buÂt
 = 
buf
;

20194 
j
 = 0;

20195 if–
√edQuŸe
 ) 
buÂt
[
j
++] = 
q
;

20196 
k
 = 
i
;

20197 
i
=0; i<
k
; i++){

20198 
buÂt
[
j
++] = 
ch
 = 
esˇrg
[
i
];

20199 if–
ch
==
q
 ) 
buÂt
[
j
++] = ch;

20201 if–
√edQuŸe
 ) 
buÂt
[
j
++] = 
q
;

20202 
buÂt
[
j
] = 0;

20203 
Àngth
 = 
j
;

20209 
ëTOKEN
: {

20210 
Tokí
 *
pTokí
 = 
	`va_¨g
(
≠
, Token*);

20211 if–
pTokí
 ){

20212 
	`sqlôe3SåAccumAµíd
(
pAccum
, (c⁄° *)
pTokí
->
z
,ÖTokí->
n
);

20214 
Àngth
 = 
width
 = 0;

20217 
ëSRCLIST
: {

20218 
SrcLi°
 *
pSrc
 = 
	`va_¨g
(
≠
, SrcList*);

20219 
k
 = 
	`va_¨g
(
≠
, );

20220 
SrcLi°_ôem
 *
pIãm
 = &
pSrc
->
a
[
k
];

20221 
	`as£π
–
k
>=0 && k<
pSrc
->
nSrc
 );

20222 if–
pIãm
->
zD©aba£
 ){

20223 
	`sqlôe3SåAccumAµíd
(
pAccum
, 
pIãm
->
zD©aba£
, -1);

20224 
	`sqlôe3SåAccumAµíd
(
pAccum
, ".", 1);

20226 
	`sqlôe3SåAccumAµíd
(
pAccum
, 
pIãm
->
zName
, -1);

20227 
Àngth
 = 
width
 = 0;

20231 
	`as£π
–
xty≥
==
ëINVALID
 );

20240 if–!
Êag_À·ju°ify
 ){

20241 
n•a˚
;

20242 
n•a˚
 = 
width
-
Àngth
;

20243 if–
n•a˚
>0 ){

20244 
	`sqlôe3AµídS∑˚
(
pAccum
, 
n•a˚
);

20247 if–
Àngth
>0 ){

20248 
	`sqlôe3SåAccumAµíd
(
pAccum
, 
buÂt
, 
Àngth
);

20250 if–
Êag_À·ju°ify
 ){

20251 
n•a˚
;

20252 
n•a˚
 = 
width
-
Àngth
;

20253 if–
n•a˚
>0 ){

20254 
	`sqlôe3AµídS∑˚
(
pAccum
, 
n•a˚
);

20257 
	`sqlôe3_‰ì
(
zExåa
);

20264 
SQLITE_PRIVATE
 
	`sqlôe3SåAccumAµíd
(
SåAccum
 *
p
, c⁄° *
z
, 
N
){

20265 
	`as£π
–
z
!=0 || 
N
==0 );

20266 if–
p
->
accEº‹
 ){

20267 
	`ã°ˇ£
(
p
->
accEº‹
==
STRACCUM_TOOBIG
);

20268 
	`ã°ˇ£
(
p
->
accEº‹
==
STRACCUM_NOMEM
);

20271 
	`as£π
–
p
->
zText
!=0 ||Ö->
nCh¨
==0 );

20272 if–
N
<=0 ){

20273 if–
N
==0 || 
z
[0]==0 ) ;

20274 
N
 = 
	`sqlôe3SåÀn30
(
z
);

20276 if–
p
->
nCh¨
+
N
 >p->
nAŒoc
 ){

20277 *
zNew
;

20278 if–!
p
->
u£MÆloc
 ){

20279 
p
->
accEº‹
 = 
STRACCUM_TOOBIG
;

20280 
N
 = 
p
->
nAŒoc
 -Ö->
nCh¨
 - 1;

20281 if–
N
<=0 ){

20285 *
zOld
 = (
p
->
zText
=ı->
zBa£
 ? 0 :Ö->zText);

20286 
i64
 
szNew
 = 
p
->
nCh¨
;

20287 
szNew
 +
N
 + 1;

20288 if–
szNew
 > 
p
->
mxAŒoc
 ){

20289 
	`sqlôe3SåAccumRe£t
(
p
);

20290 
p
->
accEº‹
 = 
STRACCUM_TOOBIG
;

20293 
p
->
nAŒoc
 = ()
szNew
;

20295 if–
p
->
u£MÆloc
==1 ){

20296 
zNew
 = 
	`sqlôe3DbRóŒoc
(
p
->
db
, 
zOld
,Ö->
nAŒoc
);

20298 
zNew
 = 
	`sqlôe3_ªÆloc
(
zOld
, 
p
->
nAŒoc
);

20300 if–
zNew
 ){

20301 if–
zOld
==0 && 
p
->
nCh¨
>0 ) 
	`mem˝y
(
zNew
,Ö->
zText
,Ö->nChar);

20302 
p
->
zText
 = 
zNew
;

20304 
p
->
accEº‹
 = 
STRACCUM_NOMEM
;

20305 
	`sqlôe3SåAccumRe£t
(
p
);

20310 
	`as£π
–
p
->
zText
 );

20311 
	`mem˝y
(&
p
->
zText
[p->
nCh¨
], 
z
, 
N
);

20312 
p
->
nCh¨
 +
N
;

20320 
SQLITE_PRIVATE
 *
	`sqlôe3SåAccumFöish
(
SåAccum
 *
p
){

20321 if–
p
->
zText
 ){

20322 
p
->
zText
[p->
nCh¨
] = 0;

20323 if–
p
->
u£MÆloc
 &&Ö->
zText
=ı->
zBa£
 ){

20324 if–
p
->
u£MÆloc
==1 ){

20325 
p
->
zText
 = 
	`sqlôe3DbMÆlocRaw
’->
db
,Ö->
nCh¨
+1 );

20327 
p
->
zText
 = 
	`sqlôe3_mÆloc
’->
nCh¨
+1);

20329 if–
p
->
zText
 ){

20330 
	`mem˝y
(
p
->
zText
,Ö->
zBa£
,Ö->
nCh¨
+1);

20332 
p
->
accEº‹
 = 
STRACCUM_NOMEM
;

20336  
p
->
zText
;

20342 
SQLITE_PRIVATE
 
	`sqlôe3SåAccumRe£t
(
SåAccum
 *
p
){

20343 if–
p
->
zText
!ı->
zBa£
 ){

20344 if–
p
->
u£MÆloc
==1 ){

20345 
	`sqlôe3DbFªe
(
p
->
db
,Ö->
zText
);

20347 
	`sqlôe3_‰ì
(
p
->
zText
);

20350 
p
->
zText
 = 0;

20356 
SQLITE_PRIVATE
 
	`sqlôe3SåAccumInô
(
SåAccum
 *
p
, *
zBa£
, 
n
, 
mx
){

20357 
p
->
zText
 =Ö->
zBa£
 = zBase;

20358 
p
->
db
 = 0;

20359 
p
->
nCh¨
 = 0;

20360 
p
->
nAŒoc
 = 
n
;

20361 
p
->
mxAŒoc
 = 
mx
;

20362 
p
->
u£MÆloc
 = 1;

20363 
p
->
accEº‹
 = 0;

20370 
SQLITE_PRIVATE
 *
	`sqlôe3VMPrötf
(
sqlôe3
 *
db
, c⁄° *
zF‹m©
, 
va_li°
 
≠
){

20371 *
z
;

20372 
zBa£
[
SQLITE_PRINT_BUF_SIZE
];

20373 
SåAccum
 
acc
;

20374 
	`as£π
–
db
!=0 );

20375 
	`sqlôe3SåAccumInô
(&
acc
, 
zBa£
, (zBase),

20376 
db
->
aLimô
[
SQLITE_LIMIT_LENGTH
]);

20377 
acc
.
db
 = db;

20378 
	`sqlôe3VXPrötf
(&
acc
, 1, 
zF‹m©
, 
≠
);

20379 
z
 = 
	`sqlôe3SåAccumFöish
(&
acc
);

20380 if–
acc
.
accEº‹
==
STRACCUM_NOMEM
 ){

20381 
db
->
mÆlocFaûed
 = 1;

20383  
z
;

20390 
SQLITE_PRIVATE
 *
	`sqlôe3MPrötf
(
sqlôe3
 *
db
, c⁄° *
zF‹m©
, ...){

20391 
va_li°
 
≠
;

20392 *
z
;

20393 
	`va_°¨t
(
≠
, 
zF‹m©
);

20394 
z
 = 
	`sqlôe3VMPrötf
(
db
, 
zF‹m©
, 
≠
);

20395 
	`va_íd
(
≠
);

20396  
z
;

20407 
SQLITE_PRIVATE
 *
	`sqlôe3MAµídf
(
sqlôe3
 *
db
, *
zSå
, c⁄° *
zF‹m©
, ...){

20408 
va_li°
 
≠
;

20409 *
z
;

20410 
	`va_°¨t
(
≠
, 
zF‹m©
);

20411 
z
 = 
	`sqlôe3VMPrötf
(
db
, 
zF‹m©
, 
≠
);

20412 
	`va_íd
(
≠
);

20413 
	`sqlôe3DbFªe
(
db
, 
zSå
);

20414  
z
;

20421 
SQLITE_API
 *
	`sqlôe3_vm¥ötf
(c⁄° *
zF‹m©
, 
va_li°
 
≠
){

20422 *
z
;

20423 
zBa£
[
SQLITE_PRINT_BUF_SIZE
];

20424 
SåAccum
 
acc
;

20425 #i‚de‡
SQLITE_OMIT_AUTOINIT


20426 if–
	`sqlôe3_öôülize
() )  0;

20428 
	`sqlôe3SåAccumInô
(&
acc
, 
zBa£
, (zBa£), 
SQLITE_MAX_LENGTH
);

20429 
acc
.
u£MÆloc
 = 2;

20430 
	`sqlôe3VXPrötf
(&
acc
, 0, 
zF‹m©
, 
≠
);

20431 
z
 = 
	`sqlôe3SåAccumFöish
(&
acc
);

20432  
z
;

20439 
SQLITE_API
 *
	`sqlôe3_m¥ötf
(c⁄° *
zF‹m©
, ...){

20440 
va_li°
 
≠
;

20441 *
z
;

20442 #i‚de‡
SQLITE_OMIT_AUTOINIT


20443 if–
	`sqlôe3_öôülize
() )  0;

20445 
	`va_°¨t
(
≠
, 
zF‹m©
);

20446 
z
 = 
	`sqlôe3_vm¥ötf
(
zF‹m©
, 
≠
);

20447 
	`va_íd
(
≠
);

20448  
z
;

20464 
SQLITE_API
 *
	`sqlôe3_v¢¥ötf
(
n
, *
zBuf
, c⁄° *
zF‹m©
, 
va_li°
 
≠
){

20465 
SåAccum
 
acc
;

20466 if–
n
<=0 )  
zBuf
;

20467 
	`sqlôe3SåAccumInô
(&
acc
, 
zBuf
, 
n
, 0);

20468 
acc
.
u£MÆloc
 = 0;

20469 
	`sqlôe3VXPrötf
(&
acc
, 0, 
zF‹m©
, 
≠
);

20470  
	`sqlôe3SåAccumFöish
(&
acc
);

20472 
SQLITE_API
 *
	`sqlôe3_¢¥ötf
(
n
, *
zBuf
, c⁄° *
zF‹m©
, ...){

20473 *
z
;

20474 
va_li°
 
≠
;

20475 
	`va_°¨t
(
≠
,
zF‹m©
);

20476 
z
 = 
	`sqlôe3_v¢¥ötf
(
n
, 
zBuf
, 
zF‹m©
, 
≠
);

20477 
	`va_íd
(
≠
);

20478  
z
;

20490 
	`ªndîLogMsg
(
iEºCode
, c⁄° *
zF‹m©
, 
va_li°
 
≠
){

20491 
SåAccum
 
acc
;

20492 
zMsg
[
SQLITE_PRINT_BUF_SIZE
*3];

20494 
	`sqlôe3SåAccumInô
(&
acc
, 
zMsg
, (zMsg), 0);

20495 
acc
.
u£MÆloc
 = 0;

20496 
	`sqlôe3VXPrötf
(&
acc
, 0, 
zF‹m©
, 
≠
);

20497 
sqlôe3GlobÆC⁄fig
.
	`xLog
(sqlôe3GlobÆC⁄fig.
pLogArg
, 
iEºCode
,

20498 
	`sqlôe3SåAccumFöish
(&
acc
));

20504 
SQLITE_API
 
	`sqlôe3_log
(
iEºCode
, c⁄° *
zF‹m©
, ...){

20505 
va_li°
 
≠
;

20506 if–
sqlôe3GlobÆC⁄fig
.
xLog
 ){

20507 
	`va_°¨t
(
≠
, 
zF‹m©
);

20508 
	`ªndîLogMsg
(
iEºCode
, 
zF‹m©
, 
≠
);

20509 
	`va_íd
(
≠
);

20513 #i‡
	`deföed
(
SQLITE_DEBUG
)

20519 
SQLITE_PRIVATE
 
	`sqlôe3DebugPrötf
(c⁄° *
zF‹m©
, ...){

20520 
va_li°
 
≠
;

20521 
SåAccum
 
acc
;

20522 
zBuf
[500];

20523 
	`sqlôe3SåAccumInô
(&
acc
, 
zBuf
, (zBuf), 0);

20524 
acc
.
u£MÆloc
 = 0;

20525 
	`va_°¨t
(
≠
,
zF‹m©
);

20526 
	`sqlôe3VXPrötf
(&
acc
, 0, 
zF‹m©
, 
≠
);

20527 
	`va_íd
(
≠
);

20528 
	`sqlôe3SåAccumFöish
(&
acc
);

20529 
	`Ârötf
(
°dout
,"%s", 
zBuf
);

20530 
	`fÊush
(
°dout
);

20534 #i‚de‡
SQLITE_OMIT_TRACE


20538 
SQLITE_PRIVATE
 
	`sqlôe3XPrötf
(
SåAccum
 *
p
, c⁄° *
zF‹m©
, ...){

20539 
va_li°
 
≠
;

20540 
	`va_°¨t
(
≠
,
zF‹m©
);

20541 
	`sqlôe3VXPrötf
(
p
, 1, 
zF‹m©
, 
≠
);

20542 
	`va_íd
(
≠
);

20570 
SQLITE_WSD
 
	ssqlôe3P∫gTy≥
 {

20571 
isInô
;

20572 
i
, 
j
;

20573 
s
[256];

20574 } 
sqlôe3P∫g
;

20579 
SQLITE_API
 
	`sqlôe3_øndom√ss
(
N
, *
pBuf
){

20580 
t
;

20581 *
zBuf
 = 
pBuf
;

20589 #ifde‡
SQLITE_OMIT_WSD


20590 
sqlôe3P∫gTy≥
 *
p
 = &
	`GLOBAL
(sqlôe3P∫gTy≥, 
sqlôe3P∫g
);

20591 
	#wsdP∫g
 
p
[0]

	)

20593 
	#wsdP∫g
 
sqlôe3P∫g


	)

20596 #i‡
SQLITE_THREADSAFE


20597 
sqlôe3_muãx
 *
muãx
 = 
	`sqlôe3MuãxAŒoc
(
SQLITE_MUTEX_STATIC_PRNG
);

20598 
	`sqlôe3_muãx_íãr
(
muãx
);

20610 if–!
wsdP∫g
.
isInô
 ){

20611 
i
;

20612 
k
[256];

20613 
wsdP∫g
.
j
 = 0;

20614 
wsdP∫g
.
i
 = 0;

20615 
	`sqlôe3OsR™dom√ss
(
	`sqlôe3_vfs_föd
(0), 256, 
k
);

20616 
i
=0; i<256; i++){

20617 
wsdP∫g
.
s
[
i
] = (
u8
)i;

20619 
i
=0; i<256; i++){

20620 
wsdP∫g
.
j
 +wsdP∫g.
s
[
i
] + 
k
[i];

20621 
t
 = 
wsdP∫g
.
s
[wsdP∫g.
j
];

20622 
wsdP∫g
.
s
[wsdP∫g.
j
] = wsdP∫g.s[
i
];

20623 
wsdP∫g
.
s
[
i
] = 
t
;

20625 
wsdP∫g
.
isInô
 = 1;

20628  
N
-- ){

20629 
wsdP∫g
.
i
++;

20630 
t
 = 
wsdP∫g
.
s
[wsdP∫g.
i
];

20631 
wsdP∫g
.
j
 +
t
;

20632 
wsdP∫g
.
s
[wsdP∫g.
i
] = wsdP∫g.s[wsdP∫g.
j
];

20633 
wsdP∫g
.
s
[wsdP∫g.
j
] = 
t
;

20634 
t
 +
wsdP∫g
.
s
[wsdP∫g.
i
];

20635 *(
zBuf
++Ë
wsdP∫g
.
s
[
t
];

20637 
	`sqlôe3_muãx_Àave
(
muãx
);

20640 #i‚de‡
SQLITE_OMIT_BUILTIN_TEST


20650 
SQLITE_WSD
 
sqlôe3P∫gTy≥
 
sqlôe3SavedP∫g
;

20651 
SQLITE_PRIVATE
 
	`sqlôe3P∫gSaveSèã
(){

20652 
	`mem˝y
(

20653 &
	`GLOBAL
(
sqlôe3P∫gTy≥
, 
sqlôe3SavedP∫g
),

20654 &
	`GLOBAL
(
sqlôe3P∫gTy≥
, 
sqlôe3P∫g
),

20655 (
sqlôe3P∫g
)

20658 
SQLITE_PRIVATE
 
	`sqlôe3P∫gRe°‹eSèã
(){

20659 
	`mem˝y
(

20660 &
	`GLOBAL
(
sqlôe3P∫gTy≥
, 
sqlôe3P∫g
),

20661 &
	`GLOBAL
(
sqlôe3P∫gTy≥
, 
sqlôe3SavedP∫g
),

20662 (
sqlôe3P∫g
)

20665 
SQLITE_PRIVATE
 
	`sqlôe3P∫gRe£tSèã
(){

20666 
	`GLOBAL
(
sqlôe3P∫gTy≥
, 
sqlôe3P∫g
).
isInô
 = 0;

20709 #i‚de‡
SQLITE_AMALGAMATION


20714 
SQLITE_PRIVATE
 c⁄° 
sqlôe3⁄e
 = 1;

20721 c⁄° 
sqlôe3Utf8Tøns1
[] = {

20733 
	#WRITE_UTF8
(
zOut
, 
c
) { \

20734 if–
c
<0x00080 ){ \

20735 *
zOut
++ = (
u8
)(
c
&0xFF); \

20737 if–
c
<0x00800 ){ \

20738 *
zOut
++ = 0xC0 + (
u8
)((
c
>>6)&0x1F); \

20739 *
zOut
++ = 0x80 + (
u8
)(
c
 & 0x3F); \

20741 if–
c
<0x10000 ){ \

20742 *
zOut
++ = 0xE0 + (
u8
)((
c
>>12)&0x0F); \

20743 *
zOut
++ = 0x80 + (
u8
)((
c
>>6) & 0x3F); \

20744 *
zOut
++ = 0x80 + (
u8
)(
c
 & 0x3F); \

20746 *
zOut
++ = 0xF0 + (
u8
)((
c
>>18) & 0x07); \

20747 *
zOut
++ = 0x80 + (
u8
)((
c
>>12) & 0x3F); \

20748 *
zOut
++ = 0x80 + (
u8
)((
c
>>6) & 0x3F); \

20749 *
zOut
++ = 0x80 + (
u8
)(
c
 & 0x3F); \

20751 }

	)

20753 
	#WRITE_UTF16LE
(
zOut
, 
c
) { \

20754 if–
c
<=0xFFFF ){ \

20755 *
zOut
++ = (
u8
)(
c
&0x00FF); \

20756 *
zOut
++ = (
u8
)((
c
>>8)&0x00FF); \

20758 *
zOut
++ = (
u8
)(((
c
>>10)&0x003F) + (((c-0x10000)>>10)&0x00C0)); \

20759 *
zOut
++ = (
u8
)(0x00D8 + (((
c
-0x10000)>>18)&0x03)); \

20760 *
zOut
++ = (
u8
)(
c
&0x00FF); \

20761 *
zOut
++ = (
u8
)(0x00DC + ((
c
>>8)&0x03)); \

20763 }

	)

20765 
	#WRITE_UTF16BE
(
zOut
, 
c
) { \

20766 if–
c
<=0xFFFF ){ \

20767 *
zOut
++ = (
u8
)((
c
>>8)&0x00FF); \

20768 *
zOut
++ = (
u8
)(
c
&0x00FF); \

20770 *
zOut
++ = (
u8
)(0x00D8 + (((
c
-0x10000)>>18)&0x03)); \

20771 *
zOut
++ = (
u8
)(((
c
>>10)&0x003F) + (((c-0x10000)>>10)&0x00C0)); \

20772 *
zOut
++ = (
u8
)(0x00DC + ((
c
>>8)&0x03)); \

20773 *
zOut
++ = (
u8
)(
c
&0x00FF); \

20775 }

	)

20777 
	#READ_UTF16LE
(
zIn
, 
TERM
, 
c
){ \

20778 
c
 = (*
zIn
++); \

20779 
c
 +((*
zIn
++)<<8); \

20780 if–
c
>=0xD800 && c<0xE000 && 
TERM
 ){ \

20781 
c2
 = (*
zIn
++); \

20782 
c2
 +((*
zIn
++)<<8); \

20783 
c
 = (
c2
&0x03FF) + ((c&0x003F)<<10) + (((c&0x03C0)+0x0040)<<10); \

20785 }

	)

20787 
	#READ_UTF16BE
(
zIn
, 
TERM
, 
c
){ \

20788 
c
 = ((*
zIn
++)<<8); \

20789 
c
 +(*
zIn
++); \

20790 if–
c
>=0xD800 && c<0xE000 && 
TERM
 ){ \

20791 
c2
 = ((*
zIn
++)<<8); \

20792 
c2
 +(*
zIn
++); \

20793 
c
 = (
c2
&0x03FF) + ((c&0x003F)<<10) + (((c&0x03C0)+0x0040)<<10); \

20795 }

	)

20824 
	#READ_UTF8
(
zIn
, 
zTîm
, 
c
) \

20825 
c
 = *(
zIn
++); \

20826 if–
c
>=0xc0 ){ \

20827 
c
 = 
sqlôe3Utf8Tøns1
[c-0xc0]; \

20828  
zIn
!=
zTîm
 && (*zIn & 0xc0)==0x80 ){ \

20829 
c
 = (c<<6Ë+ (0x3‡& *(
zIn
++)); \

20831 if–
c
<0x80 \

20832 || (
c
&0xFFFFF800)==0xD800 \

20833 || (
c
&0xFFFFFFFE)==0xFFFE ){ c = 0xFFFD; } \

20834 }

	)

20835 
SQLITE_PRIVATE
 
u32
 
	`sqlôe3Utf8Ród
(

20836 c⁄° **
pz


20838 
c
;

20843 
c
 = *((*
pz
)++);

20844 if–
c
>=0xc0 ){

20845 
c
 = 
sqlôe3Utf8Tøns1
[c-0xc0];

20846  (*(*
pz
) & 0xc0)==0x80 ){

20847 
c
 = (c<<6Ë+ (0x3‡& *((*
pz
)++));

20849 if–
c
<0x80

20850 || (
c
&0xFFFFF800)==0xD800

20851 || (
c
&0xFFFFFFFE)==0xFFFE ){ c = 0xFFFD; }

20853  
c
;

20865 #i‚de‡
SQLITE_OMIT_UTF16


20871 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemTøn¶©e
(
Mem
 *
pMem
, 
u8
 
desúedEnc
){

20872 
Àn
;

20873 *
zOut
;

20874 *
zIn
;

20875 *
zTîm
;

20876 *
z
;

20877 
c
;

20879 
	`as£π
–
pMem
->
db
==0 || 
	`sqlôe3_muãx_hñd
’Mem->db->
muãx
) );

20880 
	`as£π
–
pMem
->
Êags
&
MEM_Så
 );

20881 
	`as£π
–
pMem
->
íc
!=
desúedEnc
 );

20882 
	`as£π
–
pMem
->
íc
!=0 );

20883 
	`as£π
–
pMem
->
n
>=0 );

20885 #i‡
	`deföed
(
TRANSLATE_TRACE
Ë&& deföed(
SQLITE_DEBUG
)

20887 
zBuf
[100];

20888 
	`sqlôe3VdbeMemPªâyPröt
(
pMem
, 
zBuf
);

20889 
	`Ârötf
(
°dîr
, "INPUT: %s\n", 
zBuf
);

20897 if–
pMem
->
íc
!=
SQLITE_UTF8
 && 
desúedEnc
!=SQLITE_UTF8 ){

20898 
u8
 
ãmp
;

20899 
rc
;

20900 
rc
 = 
	`sqlôe3VdbeMemMakeWrôóbÀ
(
pMem
);

20901 if–
rc
!=
SQLITE_OK
 ){

20902 
	`as£π
–
rc
==
SQLITE_NOMEM
 );

20903  
SQLITE_NOMEM
;

20905 
zIn
 = (
u8
*)
pMem
->
z
;

20906 
zTîm
 = &
zIn
[
pMem
->
n
&~1];

20907  
zIn
<
zTîm
 ){

20908 
ãmp
 = *
zIn
;

20909 *
zIn
 = *(zIn+1);

20910 
zIn
++;

20911 *
zIn
++ = 
ãmp
;

20913 
pMem
->
íc
 = 
desúedEnc
;

20914 
å™¶©e_out
;

20918 if–
desúedEnc
==
SQLITE_UTF8
 ){

20924 
pMem
->
n
 &= ~1;

20925 
Àn
 = 
pMem
->
n
 * 2 + 1;

20932 
Àn
 = 
pMem
->
n
 * 2 + 2;

20941 
zIn
 = (
u8
*)
pMem
->
z
;

20942 
zTîm
 = &
zIn
[
pMem
->
n
];

20943 
zOut
 = 
	`sqlôe3DbMÆlocRaw
(
pMem
->
db
, 
Àn
);

20944 if–!
zOut
 ){

20945  
SQLITE_NOMEM
;

20947 
z
 = 
zOut
;

20949 if–
pMem
->
íc
==
SQLITE_UTF8
 ){

20950 if–
desúedEnc
==
SQLITE_UTF16LE
 ){

20952  
zIn
<
zTîm
 ){

20953 
	`READ_UTF8
(
zIn
, 
zTîm
, 
c
);

20954 
	`WRITE_UTF16LE
(
z
, 
c
);

20957 
	`as£π
–
desúedEnc
==
SQLITE_UTF16BE
 );

20959  
zIn
<
zTîm
 ){

20960 
	`READ_UTF8
(
zIn
, 
zTîm
, 
c
);

20961 
	`WRITE_UTF16BE
(
z
, 
c
);

20964 
pMem
->
n
 = ()(
z
 - 
zOut
);

20965 *
z
++ = 0;

20967 
	`as£π
–
desúedEnc
==
SQLITE_UTF8
 );

20968 if–
pMem
->
íc
==
SQLITE_UTF16LE
 ){

20970  
zIn
<
zTîm
 ){

20971 
	`READ_UTF16LE
(
zIn
, zIn<
zTîm
, 
c
);

20972 
	`WRITE_UTF8
(
z
, 
c
);

20976  
zIn
<
zTîm
 ){

20977 
	`READ_UTF16BE
(
zIn
, zIn<
zTîm
, 
c
);

20978 
	`WRITE_UTF8
(
z
, 
c
);

20981 
pMem
->
n
 = ()(
z
 - 
zOut
);

20983 *
z
 = 0;

20984 
	`as£π
–(
pMem
->
n
+(
desúedEnc
==
SQLITE_UTF8
?1:2))<=
Àn
 );

20986 
	`sqlôe3VdbeMemRñó£
(
pMem
);

20987 
pMem
->
Êags
 &~(
MEM_Sètic
|
MEM_Dyn
|
MEM_Ephem
);

20988 
pMem
->
íc
 = 
desúedEnc
;

20989 
pMem
->
Êags
 |(
MEM_Tîm
|
MEM_Dyn
);

20990 
pMem
->
z
 = (*)
zOut
;

20991 
pMem
->
zMÆloc
 =ÖMem->
z
;

20993 
å™¶©e_out
:

20994 #i‡
	`deföed
(
TRANSLATE_TRACE
Ë&& deföed(
SQLITE_DEBUG
)

20996 
zBuf
[100];

20997 
	`sqlôe3VdbeMemPªâyPröt
(
pMem
, 
zBuf
);

20998 
	`Ârötf
(
°dîr
, "OUTPUT: %s\n", 
zBuf
);

21001  
SQLITE_OK
;

21013 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemH™dÀBom
(
Mem
 *
pMem
){

21014 
rc
 = 
SQLITE_OK
;

21015 
u8
 
bom
 = 0;

21017 
	`as£π
–
pMem
->
n
>=0 );

21018 if–
pMem
->
n
>1 ){

21019 
u8
 
b1
 = *(u8 *)
pMem
->
z
;

21020 
u8
 
b2
 = *(((u8 *)
pMem
->
z
) + 1);

21021 if–
b1
==0xFE && 
b2
==0xFF ){

21022 
bom
 = 
SQLITE_UTF16BE
;

21024 if–
b1
==0xFF && 
b2
==0xFE ){

21025 
bom
 = 
SQLITE_UTF16LE
;

21029 if–
bom
 ){

21030 
rc
 = 
	`sqlôe3VdbeMemMakeWrôóbÀ
(
pMem
);

21031 if–
rc
==
SQLITE_OK
 ){

21032 
pMem
->
n
 -= 2;

21033 
	`memmove
(
pMem
->
z
, &pMem->z[2],ÖMem->
n
);

21034 
pMem
->
z
[pMem->
n
] = '\0';

21035 
pMem
->
z
[pMem->
n
+1] = '\0';

21036 
pMem
->
Êags
 |
MEM_Tîm
;

21037 
pMem
->
íc
 = 
bom
;

21040  
rc
;

21051 
SQLITE_PRIVATE
 
	`sqlôe3Utf8Ch¨Lí
(c⁄° *
zIn
, 
nByã
){

21052 
r
 = 0;

21053 c⁄° 
u8
 *
z
 = (c⁄° u8*)
zIn
;

21054 c⁄° 
u8
 *
zTîm
;

21055 if–
nByã
>=0 ){

21056 
zTîm
 = &
z
[
nByã
];

21058 
zTîm
 = (c⁄° 
u8
*)(-1);

21060 
	`as£π
–
z
<=
zTîm
 );

21061  *
z
!=0 && z<
zTîm
 ){

21062 
	`SQLITE_SKIP_UTF8
(
z
);

21063 
r
++;

21065  
r
;

21071 #i‡
	`deföed
(
SQLITE_TEST
Ë&& deföed(
SQLITE_DEBUG
)

21081 
SQLITE_PRIVATE
 
	`sqlôe3Utf8To8
(*
zIn
){

21082 *
zOut
 = 
zIn
;

21083 *
zSèπ
 = 
zIn
;

21084 
u32
 
c
;

21086  
zIn
[0] && 
zOut
<=zIn ){

21087 
c
 = 
	`sqlôe3Utf8Ród
((c⁄° 
u8
**)&
zIn
);

21088 if–
c
!=0xfffd ){

21089 
	`WRITE_UTF8
(
zOut
, 
c
);

21092 *
zOut
 = 0;

21093  ()(
zOut
 - 
zSèπ
);

21097 #i‚de‡
SQLITE_OMIT_UTF16


21105 
SQLITE_PRIVATE
 *
	`sqlôe3Utf16to8
(
sqlôe3
 *
db
, c⁄° *
z
, 
nByã
, 
u8
 
íc
){

21106 
Mem
 
m
;

21107 
	`mem£t
(&
m
, 0, (m));

21108 
m
.
db
 = db;

21109 
	`sqlôe3VdbeMemSëSå
(&
m
, 
z
, 
nByã
, 
íc
, 
SQLITE_STATIC
);

21110 
	`sqlôe3VdbeCh™geEncodög
(&
m
, 
SQLITE_UTF8
);

21111 if–
db
->
mÆlocFaûed
 ){

21112 
	`sqlôe3VdbeMemRñó£
(&
m
);

21113 
m
.
z
 = 0;

21115 
	`as£π
–(
m
.
Êags
 & 
MEM_Tîm
)!=0 || 
db
->
mÆlocFaûed
 );

21116 
	`as£π
–(
m
.
Êags
 & 
MEM_Så
)!=0 || 
db
->
mÆlocFaûed
 );

21117 
	`as£π
–(
m
.
Êags
 & 
MEM_Dyn
)!=0 || 
db
->
mÆlocFaûed
 );

21118 
	`as£π
–
m
.
z
 || 
db
->
mÆlocFaûed
 );

21119  
m
.
z
;

21127 
SQLITE_PRIVATE
 
	`sqlôe3Utf16ByãLí
(c⁄° *
zIn
, 
nCh¨
){

21128 
c
;

21129 c⁄° *
z
 = 
zIn
;

21130 
n
 = 0;

21132 if–
SQLITE_UTF16NATIVE
==
SQLITE_UTF16BE
 ){

21133  
n
<
nCh¨
 ){

21134 
	`READ_UTF16BE
(
z
, 1, 
c
);

21135 
n
++;

21138  
n
<
nCh¨
 ){

21139 
	`READ_UTF16LE
(
z
, 1, 
c
);

21140 
n
++;

21143  ()(
z
-(c⁄° *)
zIn
);

21146 #i‡
	`deföed
(
SQLITE_TEST
)

21152 
SQLITE_PRIVATE
 
	`sqlôe3UtfSñfTe°
(){

21153 
i
, 
t
;

21154 
zBuf
[20];

21155 *
z
;

21156 
n
;

21157 
c
;

21159 
i
=0; i<0x00110000; i++){

21160 
z
 = 
zBuf
;

21161 
	`WRITE_UTF8
(
z
, 
i
);

21162 
n
 = ()(
z
-
zBuf
);

21163 
	`as£π
–
n
>0 &&Ç<=4 );

21164 
z
[0] = 0;

21165 
z
 = 
zBuf
;

21166 
c
 = 
	`sqlôe3Utf8Ród
((c⁄° 
u8
**)&
z
);

21167 
t
 = 
i
;

21168 if–
i
>=0xD800 && i<=0xDFFF ) 
t
 = 0xFFFD;

21169 if–(
i
&0xFFFFFFFE)==0xFFFE ) 
t
 = 0xFFFD;

21170 
	`as£π
–
c
==
t
 );

21171 
	`as£π
–(
z
-
zBuf
)==
n
 );

21173 
i
=0; i<0x00110000; i++){

21174 if–
i
>=0xD800 && i<0xE000 ) ;

21175 
z
 = 
zBuf
;

21176 
	`WRITE_UTF16LE
(
z
, 
i
);

21177 
n
 = ()(
z
-
zBuf
);

21178 
	`as£π
–
n
>0 &&Ç<=4 );

21179 
z
[0] = 0;

21180 
z
 = 
zBuf
;

21181 
	`READ_UTF16LE
(
z
, 1, 
c
);

21182 
	`as£π
–
c
==
i
 );

21183 
	`as£π
–(
z
-
zBuf
)==
n
 );

21185 
i
=0; i<0x00110000; i++){

21186 if–
i
>=0xD800 && i<0xE000 ) ;

21187 
z
 = 
zBuf
;

21188 
	`WRITE_UTF16BE
(
z
, 
i
);

21189 
n
 = ()(
z
-
zBuf
);

21190 
	`as£π
–
n
>0 &&Ç<=4 );

21191 
z
[0] = 0;

21192 
z
 = 
zBuf
;

21193 
	`READ_UTF16BE
(
z
, 1, 
c
);

21194 
	`as£π
–
c
==
i
 );

21195 
	`as£π
–(
z
-
zBuf
)==
n
 );

21221 #ifde‡
SQLITE_HAVE_ISNAN


21222 
	~<m©h.h
>

21228 #ifde‡
SQLITE_COVERAGE_TEST


21229 
SQLITE_PRIVATE
 
	`sqlôe3Covîage
(
x
){

21230 
dummy
 = 0;

21231 
dummy
 +()
x
;

21235 #i‚de‡
SQLITE_OMIT_FLOATING_POINT


21242 
SQLITE_PRIVATE
 
	`sqlôe3IsNaN
(
x
){

21243 
rc
;

21244 #i‡!
	`deföed
(
SQLITE_HAVE_ISNAN
)

21268 #ifde‡
__FAST_MATH__


21269 #îr‹ 
SQLôe
 
wûl
 
nŸ
 
w‹k
 
c‹ª˘ly
 
wôh
 
the
 -
fÁ°
-
m©h
 
›ti⁄
 
of
 
GCC
.

21271 vﬁ©ûê
y
 = 
x
;

21272 vﬁ©ûê
z
 = 
y
;

21273 
rc
 = (
y
!=
z
);

21275 
rc
 = 
	`i¢™
(
x
);

21277 
	`ã°ˇ£
–
rc
 );

21278  
rc
;

21290 
SQLITE_PRIVATE
 
	`sqlôe3SåÀn30
(c⁄° *
z
){

21291 c⁄° *
z2
 = 
z
;

21292 if–
z
==0 )  0;

21293  *
z2
 ){ z2++; }

21294  0x3ffffff‡& ()(
z2
 - 
z
);

21318 
SQLITE_PRIVATE
 
	`sqlôe3Eº‹
(
sqlôe3
 *
db
, 
îr_code
, c⁄° *
zF‹m©
, ...){

21319 if–
db
 && (db->
pEº
 || (db->pEº = 
	`sqlôe3VÆueNew
(db))!=0) ){

21320 
db
->
îrCode
 = 
îr_code
;

21321 if–
zF‹m©
 ){

21322 *
z
;

21323 
va_li°
 
≠
;

21324 
	`va_°¨t
(
≠
, 
zF‹m©
);

21325 
z
 = 
	`sqlôe3VMPrötf
(
db
, 
zF‹m©
, 
≠
);

21326 
	`va_íd
(
≠
);

21327 
	`sqlôe3VÆueSëSå
(
db
->
pEº
, -1, 
z
, 
SQLITE_UTF8
, 
SQLITE_DYNAMIC
);

21329 
	`sqlôe3VÆueSëSå
(
db
->
pEº
, 0, 0, 
SQLITE_UTF8
, 
SQLITE_STATIC
);

21351 
SQLITE_PRIVATE
 
	`sqlôe3Eº‹Msg
(
P¨£
 *
pP¨£
, c⁄° *
zF‹m©
, ...){

21352 *
zMsg
;

21353 
va_li°
 
≠
;

21354 
sqlôe3
 *
db
 = 
pP¨£
->db;

21355 
	`va_°¨t
(
≠
, 
zF‹m©
);

21356 
zMsg
 = 
	`sqlôe3VMPrötf
(
db
, 
zF‹m©
, 
≠
);

21357 
	`va_íd
(
≠
);

21358 if–
db
->
suµªssEº
 ){

21359 
	`sqlôe3DbFªe
(
db
, 
zMsg
);

21361 
pP¨£
->
nEº
++;

21362 
	`sqlôe3DbFªe
(
db
, 
pP¨£
->
zEºMsg
);

21363 
pP¨£
->
zEºMsg
 = 
zMsg
;

21364 
pP¨£
->
rc
 = 
SQLITE_ERROR
;

21385 
SQLITE_PRIVATE
 
	`sqlôe3DequŸe
(*
z
){

21386 
quŸe
;

21387 
i
, 
j
;

21388 if–
z
==0 )  -1;

21389 
quŸe
 = 
z
[0];

21390  
quŸe
 ){

21394 '[': 
quŸe
 = ']'; ;

21397 
i
=1, 
j
=0;; i++){

21398 
	`as£π
–
z
[
i
] );

21399 if–
z
[
i
]==
quŸe
 ){

21400 if–
z
[
i
+1]==
quŸe
 ){

21401 
z
[
j
++] = 
quŸe
;

21402 
i
++;

21407 
z
[
j
++] = z[
i
];

21410 
z
[
j
] = 0;

21411  
j
;

21415 
	#UµîToLowî
 
sqlôe3UµîToLowî


	)

21427 
SQLITE_API
 
	`sqlôe3_°ricmp
(c⁄° *
zLe·
, c⁄° *
zRight
){

21428 *
a
, *
b
;

21429 
a
 = (*)
zLe·
;

21430 
b
 = (*)
zRight
;

21431  *
a
!=0 && 
UµîToLowî
[*a]==UµîToLowî[*
b
]){á++; b++; }

21432  
UµîToLowî
[*
a
] - UµîToLowî[*
b
];

21434 
SQLITE_API
 
	`sqlôe3_°∫icmp
(c⁄° *
zLe·
, c⁄° *
zRight
, 
N
){

21435 *
a
, *
b
;

21436 
a
 = (*)
zLe·
;

21437 
b
 = (*)
zRight
;

21438  
N
-- > 0 && *
a
!=0 && 
UµîToLowî
[*a]==UµîToLowî[*
b
]){á++; b++; }

21439  
N
<0 ? 0 : 
UµîToLowî
[*
a
] - UµîToLowî[*
b
];

21464 
SQLITE_PRIVATE
 
	`sqlôe3AtoF
(c⁄° *
z
, *
pResu…
, 
Àngth
, 
u8
 
íc
){

21465 #i‚de‡
SQLITE_OMIT_FLOATING_POINT


21466 
ö¸
;

21467 c⁄° *
zEnd
 = 
z
 + 
Àngth
;

21469 
sign
 = 1;

21470 
i64
 
s
 = 0;

21471 
d
 = 0;

21472 
esign
 = 1;

21473 
e
 = 0;

21474 
eVÆid
 = 1;

21475 
ªsu…
;

21476 
nDigôs
 = 0;

21477 
n⁄Num
 = 0;

21479 
	`as£π
–
íc
==
SQLITE_UTF8
 ||Énc==
SQLITE_UTF16LE
 ||Énc==
SQLITE_UTF16BE
 );

21480 *
pResu…
 = 0.0;

21482 if–
íc
==
SQLITE_UTF8
 ){

21483 
ö¸
 = 1;

21485 
i
;

21486 
ö¸
 = 2;

21487 
	`as£π
–
SQLITE_UTF16LE
==2 && 
SQLITE_UTF16BE
==3 );

21488 
i
=3-
íc
; i<
Àngth
 && 
z
[i]==0; i+=2){}

21489 
n⁄Num
 = 
i
<
Àngth
;

21490 
zEnd
 = 
z
+
i
+
íc
-3;

21491 
z
 +(
íc
&1);

21495  
z
<
zEnd
 && 
	`sqlôe3Is•a˚
(*zËËz+=
ö¸
;

21496 if–
z
>=
zEnd
 )  0;

21499 if–*
z
=='-' ){

21500 
sign
 = -1;

21501 
z
+=
ö¸
;

21502 }if–*
z
=='+' ){

21503 
z
+=
ö¸
;

21507  
z
<
zEnd
 && z[0]=='0' ) z+=
ö¸
, 
nDigôs
++;

21510  
z
<
zEnd
 && 
	`sqlôe3Isdigô
(*zË&& 
s
<((
LARGEST_INT64
-9)/10) ){

21511 
s
 = s*10 + (*
z
 - '0');

21512 
z
+=
ö¸
, 
nDigôs
++;

21517  
z
<
zEnd
 && 
	`sqlôe3Isdigô
(*zËËz+=
ö¸
, 
nDigôs
++, 
d
++;

21518 if–
z
>=
zEnd
 ) 
do_©of_ˇlc
;

21521 if–*
z
=='.' ){

21522 
z
+=
ö¸
;

21525  
z
<
zEnd
 && 
	`sqlôe3Isdigô
(*zË&& 
s
<((
LARGEST_INT64
-9)/10) ){

21526 
s
 = s*10 + (*
z
 - '0');

21527 
z
+=
ö¸
, 
nDigôs
++, 
d
--;

21530  
z
<
zEnd
 && 
	`sqlôe3Isdigô
(*zËËz+=
ö¸
, 
nDigôs
++;

21532 if–
z
>=
zEnd
 ) 
do_©of_ˇlc
;

21535 if–*
z
=='e' || *z=='E' ){

21536 
z
+=
ö¸
;

21537 
eVÆid
 = 0;

21538 if–
z
>=
zEnd
 ) 
do_©of_ˇlc
;

21540 if–*
z
=='-' ){

21541 
esign
 = -1;

21542 
z
+=
ö¸
;

21543 }if–*
z
=='+' ){

21544 
z
+=
ö¸
;

21547  
z
<
zEnd
 && 
	`sqlôe3Isdigô
(*z) ){

21548 
e
 =É<10000 ? (e*10 + (*
z
 - '0')) : 10000;

21549 
z
+=
ö¸
;

21550 
eVÆid
 = 1;

21555 if–
nDigôs
 && 
eVÆid
 ){

21556  
z
<
zEnd
 && 
	`sqlôe3Is•a˚
(*zËËz+=
ö¸
;

21559 
do_©of_ˇlc
:

21561 
e
 = (e*
esign
Ë+ 
d
;

21562 if–
e
<0 ) {

21563 
esign
 = -1;

21564 
e
 *= -1;

21566 
esign
 = 1;

21570 if–!
s
 ) {

21573 
ªsu…
 = (
sign
<0 && 
nDigôs
) ? -()0 : ()0;

21576 if–
esign
>0 ){

21577  
s
<(
LARGEST_INT64
/10Ë&& 
e
>0 )É--,s*=10;

21579  !(
s
%10Ë&& 
e
>0 )É--,s/=10;

21583 
s
 = 
sign
<0 ? -s : s;

21587 if–
e
 ){

21588 
LONGDOUBLE_TYPE
 
sˇÀ
 = 1.0;

21590 if–
e
>307 &&É<342 ){

21591  
e
%308 ) { 
sˇÀ
 *= 1.0e+1;É -= 1; }

21592 if–
esign
<0 ){

21593 
ªsu…
 = 
s
 / 
sˇÀ
;

21594 
ªsu…
 /= 1.0e+308;

21596 
ªsu…
 = 
s
 * 
sˇÀ
;

21597 
ªsu…
 *= 1.0e+308;

21599 }if–
e
>=342 ){

21600 if–
esign
<0 ){

21601 
ªsu…
 = 0.0*
s
;

21603 
ªsu…
 = 1e308*1e308*
s
;

21608  
e
%22 ) { 
sˇÀ
 *= 1.0e+1;É -= 1; }

21609  
e
>0 ) { 
sˇÀ
 *= 1.0e+22;É -= 22; }

21610 if–
esign
<0 ){

21611 
ªsu…
 = 
s
 / 
sˇÀ
;

21613 
ªsu…
 = 
s
 * 
sˇÀ
;

21617 
ªsu…
 = ()
s
;

21622 *
pResu…
 = 
ªsu…
;

21625  
z
>=
zEnd
 && 
nDigôs
>0 && 
eVÆid
 && 
n⁄Num
==0;

21627  !
	`sqlôe3Atoi64
(
z
, 
pResu…
, 
Àngth
, 
íc
);

21645 
	`com∑ª2pow63
(c⁄° *
zNum
, 
ö¸
){

21646 
c
 = 0;

21647 
i
;

21649 c⁄° *
pow63
 = "922337203685477580";

21650 
i
=0; 
c
==0 && i<18; i++){

21651 
c
 = (
zNum
[
i
*
ö¸
]-
pow63
[i])*10;

21653 if–
c
==0 ){

21654 
c
 = 
zNum
[18*
ö¸
] - '8';

21655 
	`ã°ˇ£
–
c
==(-1) );

21656 
	`ã°ˇ£
–
c
==0 );

21657 
	`ã°ˇ£
–
c
==(+1) );

21659  
c
;

21681 
SQLITE_PRIVATE
 
	`sqlôe3Atoi64
(c⁄° *
zNum
, 
i64
 *
pNum
, 
Àngth
, 
u8
 
íc
){

21682 
ö¸
;

21683 
u64
 
u
 = 0;

21684 
√g
 = 0;

21685 
i
;

21686 
c
 = 0;

21687 
n⁄Num
 = 0;

21688 c⁄° *
zSèπ
;

21689 c⁄° *
zEnd
 = 
zNum
 + 
Àngth
;

21690 
	`as£π
–
íc
==
SQLITE_UTF8
 ||Énc==
SQLITE_UTF16LE
 ||Énc==
SQLITE_UTF16BE
 );

21691 if–
íc
==
SQLITE_UTF8
 ){

21692 
ö¸
 = 1;

21694 
ö¸
 = 2;

21695 
	`as£π
–
SQLITE_UTF16LE
==2 && 
SQLITE_UTF16BE
==3 );

21696 
i
=3-
íc
; i<
Àngth
 && 
zNum
[i]==0; i+=2){}

21697 
n⁄Num
 = 
i
<
Àngth
;

21698 
zEnd
 = 
zNum
+
i
+
íc
-3;

21699 
zNum
 +(
íc
&1);

21701  
zNum
<
zEnd
 && 
	`sqlôe3Is•a˚
(*zNumËËzNum+=
ö¸
;

21702 if–
zNum
<
zEnd
 ){

21703 if–*
zNum
=='-' ){

21704 
√g
 = 1;

21705 
zNum
+=
ö¸
;

21706 }if–*
zNum
=='+' ){

21707 
zNum
+=
ö¸
;

21710 
zSèπ
 = 
zNum
;

21711  
zNum
<
zEnd
 && zNum[0]=='0' ){ zNum+=
ö¸
; }

21712 
i
=0; &
zNum
[i]<
zEnd
 && (
c
=zNum[i])>='0' && c<='9'; i+=
ö¸
){

21713 
u
 = u*10 + 
c
 - '0';

21715 if–
u
>
LARGEST_INT64
 ){

21716 *
pNum
 = 
SMALLEST_INT64
;

21717 }if–
√g
 ){

21718 *
pNum
 = -(
i64
)
u
;

21720 *
pNum
 = (
i64
)
u
;

21722 
	`ã°ˇ£
–
i
==18 );

21723 
	`ã°ˇ£
–
i
==19 );

21724 
	`ã°ˇ£
–
i
==20 );

21725 if–(
c
!=0 && &
zNum
[
i
]<
zEnd
Ë|| (i==0 && 
zSèπ
==zNumË|| i>19*
ö¸
 || 
n⁄Num
 ){

21729 }if–
i
<19*
ö¸
 ){

21731 
	`as£π
–
u
<=
LARGEST_INT64
 );

21735 
c
 = 
	`com∑ª2pow63
(
zNum
, 
ö¸
);

21736 if–
c
<0 ){

21738 
	`as£π
–
u
<=
LARGEST_INT64
 );

21740 }if–
c
>0 ){

21746 
	`as£π
–
u
-1==
LARGEST_INT64
 );

21747 
	`as£π
–(*
pNum
)==
SMALLEST_INT64
 );

21748  
√g
 ? 0 : 2;

21761 
SQLITE_PRIVATE
 
	`sqlôe3GëI¡32
(c⁄° *
zNum
, *
pVÆue
){

21762 
sqlôe_öt64
 
v
 = 0;

21763 
i
, 
c
;

21764 
√g
 = 0;

21765 if–
zNum
[0]=='-' ){

21766 
√g
 = 1;

21767 
zNum
++;

21768 }if–
zNum
[0]=='+' ){

21769 
zNum
++;

21771  
zNum
[0]=='0' ) zNum++;

21772 
i
=0; i<11 && (
c
 = 
zNum
[i] - '0')>=0 && c<=9; i++){

21773 
v
 = v*10 + 
c
;

21781 
	`ã°ˇ£
–
i
==10 );

21782 if–
i
>10 ){

21785 
	`ã°ˇ£
–
v
-
√g
==2147483647 );

21786 if–
v
-
√g
>2147483647 ){

21789 if–
√g
 ){

21790 
v
 = -v;

21792 *
pVÆue
 = ()
v
;

21800 
SQLITE_PRIVATE
 
	`sqlôe3Atoi
(c⁄° *
z
){

21801 
x
 = 0;

21802 if–
z
 ) 
	`sqlôe3GëI¡32
(z, &
x
);

21803  
x
;

21835 
SQLITE_PRIVATE
 
	`sqlôe3PutV¨öt
(*
p
, 
u64
 
v
){

21836 
i
, 
j
, 
n
;

21837 
u8
 
buf
[10];

21838 if–
v
 & (((
u64
)0xff000000)<<32) ){

21839 
p
[8] = (
u8
)
v
;

21840 
v
 >>= 8;

21841 
i
=7; i>=0; i--){

21842 
p
[
i
] = (
u8
)((
v
 & 0x7f) | 0x80);

21843 
v
 >>= 7;

21847 
n
 = 0;

21849 
buf
[
n
++] = (
u8
)((
v
 & 0x7f) | 0x80);

21850 
v
 >>= 7;

21851 } 
v
!=0 );

21852 
buf
[0] &= 0x7f;

21853 
	`as£π
–
n
<=9 );

21854 
i
=0, 
j
=
n
-1; j>=0; j--, i++){

21855 
p
[
i
] = 
buf
[
j
];

21857  
n
;

21868 
SQLITE_PRIVATE
 
	`sqlôe3PutV¨öt32
(*
p
, 
u32
 
v
){

21869 #i‚de‡
putV¨öt32


21870 if–(
v
 & ~0x7f)==0 ){

21871 
p
[0] = 
v
;

21875 if–(
v
 & ~0x3fff)==0 ){

21876 
p
[0] = (
u8
)((
v
>>7) | 0x80);

21877 
p
[1] = (
u8
)(
v
 & 0x7f);

21880  
	`sqlôe3PutV¨öt
(
p
, 
v
);

21892 
	#SLOT_2_0
 0x001fc07f

	)

21893 
	#SLOT_4_2_0
 0xf01fc07f

	)

21900 
SQLITE_PRIVATE
 
u8
 
	`sqlôe3GëV¨öt
(c⁄° *
p
, 
u64
 *
v
){

21901 
u32
 
a
,
b
,
s
;

21903 
a
 = *
p
;

21905 i‡(!(
a
&0x80))

21907 *
v
 = 
a
;

21911 
p
++;

21912 
b
 = *
p
;

21914 i‡(!(
b
&0x80))

21916 
a
 &= 0x7f;

21917 
a
 =á<<7;

21918 
a
 |
b
;

21919 *
v
 = 
a
;

21924 
	`as£π
–
SLOT_2_0
 == ((0x7f<<14) | (0x7f)) );

21925 
	`as£π
–
SLOT_4_2_0
 == ((0xfU<<28) | (0x7f<<14) | (0x7f)) );

21927 
p
++;

21928 
a
 =á<<14;

21929 
a
 |*
p
;

21931 i‡(!(
a
&0x80))

21933 
a
 &
SLOT_2_0
;

21934 
b
 &= 0x7f;

21935 
b
 = b<<7;

21936 
a
 |
b
;

21937 *
v
 = 
a
;

21942 
a
 &
SLOT_2_0
;

21943 
p
++;

21944 
b
 = b<<14;

21945 
b
 |*
p
;

21947 i‡(!(
b
&0x80))

21949 
b
 &
SLOT_2_0
;

21952 
a
 =á<<7;

21953 
a
 |
b
;

21954 *
v
 = 
a
;

21963 
b
 &
SLOT_2_0
;

21964 
s
 = 
a
;

21967 
p
++;

21968 
a
 =á<<14;

21969 
a
 |*
p
;

21971 i‡(!(
a
&0x80))

21976 
b
 = b<<7;

21977 
a
 |
b
;

21978 
s
 = s>>18;

21979 *
v
 = ((
u64
)
s
)<<32 | 
a
;

21984 
s
 = s<<7;

21985 
s
 |
b
;

21988 
p
++;

21989 
b
 = b<<14;

21990 
b
 |*
p
;

21992 i‡(!(
b
&0x80))

21996 
a
 &
SLOT_2_0
;

21997 
a
 =á<<7;

21998 
a
 |
b
;

21999 
s
 = s>>18;

22000 *
v
 = ((
u64
)
s
)<<32 | 
a
;

22004 
p
++;

22005 
a
 =á<<14;

22006 
a
 |*
p
;

22008 i‡(!(
a
&0x80))

22010 
a
 &
SLOT_4_2_0
;

22011 
b
 &
SLOT_2_0
;

22012 
b
 = b<<7;

22013 
a
 |
b
;

22014 
s
 = s>>11;

22015 *
v
 = ((
u64
)
s
)<<32 | 
a
;

22020 
a
 &
SLOT_2_0
;

22021 
p
++;

22022 
b
 = b<<14;

22023 
b
 |*
p
;

22025 i‡(!(
b
&0x80))

22027 
b
 &
SLOT_4_2_0
;

22030 
a
 =á<<7;

22031 
a
 |
b
;

22032 
s
 = s>>4;

22033 *
v
 = ((
u64
)
s
)<<32 | 
a
;

22037 
p
++;

22038 
a
 =á<<15;

22039 
a
 |*
p
;

22044 
b
 &
SLOT_2_0
;

22045 
b
 = b<<8;

22046 
a
 |
b
;

22048 
s
 = s<<4;

22049 
b
 = 
p
[-4];

22050 
b
 &= 0x7f;

22051 
b
 = b>>3;

22052 
s
 |
b
;

22054 *
v
 = ((
u64
)
s
)<<32 | 
a
;

22070 
SQLITE_PRIVATE
 
u8
 
	`sqlôe3GëV¨öt32
(c⁄° *
p
, 
u32
 *
v
){

22071 
u32
 
a
,
b
;

22075 
a
 = *
p
;

22077 #i‚de‡
gëV¨öt32


22078 i‡(!(
a
&0x80))

22081 *
v
 = 
a
;

22087 
p
++;

22088 
b
 = *
p
;

22090 i‡(!(
b
&0x80))

22093 
a
 &= 0x7f;

22094 
a
 =á<<7;

22095 *
v
 = 
a
 | 
b
;

22100 
p
++;

22101 
a
 =á<<14;

22102 
a
 |*
p
;

22104 i‡(!(
a
&0x80))

22107 
a
 &= (0x7f<<14)|(0x7f);

22108 
b
 &= 0x7f;

22109 
b
 = b<<7;

22110 *
v
 = 
a
 | 
b
;

22125 
u64
 
v64
;

22126 
u8
 
n
;

22128 
p
 -= 2;

22129 
n
 = 
	`sqlôe3GëV¨öt
(
p
, &
v64
);

22130 
	`as£π
–
n
>3 &&Ç<=9 );

22131 if–(
v64
 & 
SQLITE_MAX_U32
)!=v64 ){

22132 *
v
 = 0xffffffff;

22134 *
v
 = (
u32
)
v64
;

22136  
n
;

22144 
p
++;

22145 
b
 = b<<14;

22146 
b
 |*
p
;

22148 i‡(!(
b
&0x80))

22151 
b
 &= (0x7f<<14)|(0x7f);

22152 
a
 &= (0x7f<<14)|(0x7f);

22153 
a
 =á<<7;

22154 *
v
 = 
a
 | 
b
;

22158 
p
++;

22159 
a
 =á<<14;

22160 
a
 |*
p
;

22162 i‡(!(
a
&0x80))

22165 
a
 &
SLOT_4_2_0
;

22166 
b
 &
SLOT_4_2_0
;

22167 
b
 = b<<7;

22168 *
v
 = 
a
 | 
b
;

22177 
u64
 
v64
;

22178 
u8
 
n
;

22180 
p
 -= 4;

22181 
n
 = 
	`sqlôe3GëV¨öt
(
p
, &
v64
);

22182 
	`as£π
–
n
>5 &&Ç<=9 );

22183 *
v
 = (
u32
)
v64
;

22184  
n
;

22193 
SQLITE_PRIVATE
 
	`sqlôe3V¨ötLí
(
u64
 
v
){

22194 
i
 = 0;

22196 
i
++;

22197 
v
 >>= 7;

22198 } 
v
!=0 && 
	`ALWAYS
(
i
<9) );

22199  
i
;

22206 
SQLITE_PRIVATE
 
u32
 
	`sqlôe3Gë4byã
(c⁄° 
u8
 *
p
){

22207  (
p
[0]<<24) | (p[1]<<16) | (p[2]<<8) |Ö[3];

22209 
SQLITE_PRIVATE
 
	`sqlôe3Put4byã
(*
p
, 
u32
 
v
){

22210 
p
[0] = (
u8
)(
v
>>24);

22211 
p
[1] = (
u8
)(
v
>>16);

22212 
p
[2] = (
u8
)(
v
>>8);

22213 
p
[3] = (
u8
)
v
;

22223 
SQLITE_PRIVATE
 
u8
 
	`sqlôe3HexToI¡
(
h
){

22224 
	`as£π
–(
h
>='0' && h<='9') || (h>='a' && h<='f') || (h>='A' && h<='F') );

22225 #ifde‡
SQLITE_ASCII


22226 
h
 += 9*(1&(h>>6));

22228 #ifde‡
SQLITE_EBCDIC


22229 
h
 += 9*(1&~(h>>4));

22231  (
u8
)(
h
 & 0xf);

22234 #i‡!
	`deföed
(
SQLITE_OMIT_BLOB_LITERAL
Ë|| deföed(
SQLITE_HAS_CODEC
)

22241 
SQLITE_PRIVATE
 *
	`sqlôe3HexToBlob
(
sqlôe3
 *
db
, c⁄° *
z
, 
n
){

22242 *
zBlob
;

22243 
i
;

22245 
zBlob
 = (*)
	`sqlôe3DbMÆlocRaw
(
db
, 
n
/2 + 1);

22246 
n
--;

22247 if–
zBlob
 ){

22248 
i
=0; i<
n
; i+=2){

22249 
zBlob
[
i
/2] = (
	`sqlôe3HexToI¡
(
z
[i])<<4) | sqlite3HexToInt(z[i+1]);

22251 
zBlob
[
i
/2] = 0;

22253  
zBlob
;

22262 
	`logBadC⁄√˘i⁄
(c⁄° *
zTy≥
){

22263 
	`sqlôe3_log
(
SQLITE_MISUSE
,

22265 
zTy≥


22283 
SQLITE_PRIVATE
 
	`sqlôe3Sa„tyCheckOk
(
sqlôe3
 *
db
){

22284 
u32
 
magic
;

22285 if–
db
==0 ){

22286 
	`logBadC⁄√˘i⁄
("NULL");

22289 
magic
 = 
db
->magic;

22290 if–
magic
!=
SQLITE_MAGIC_OPEN
 ){

22291 if–
	`sqlôe3Sa„tyCheckSickOrOk
(
db
) ){

22292 
	`ã°ˇ£
–
sqlôe3GlobÆC⁄fig
.
xLog
!=0 );

22293 
	`logBadC⁄√˘i⁄
("unopened");

22300 
SQLITE_PRIVATE
 
	`sqlôe3Sa„tyCheckSickOrOk
(
sqlôe3
 *
db
){

22301 
u32
 
magic
;

22302 
magic
 = 
db
->magic;

22303 if–
magic
!=
SQLITE_MAGIC_SICK
 &&

22304 
magic
!=
SQLITE_MAGIC_OPEN
 &&

22305 
magic
!=
SQLITE_MAGIC_BUSY
 ){

22306 
	`ã°ˇ£
–
sqlôe3GlobÆC⁄fig
.
xLog
!=0 );

22307 
	`logBadC⁄√˘i⁄
("invalid");

22320 
SQLITE_PRIVATE
 
	`sqlôe3AddI¡64
(
i64
 *
pA
, i64 
iB
){

22321 
i64
 
iA
 = *
pA
;

22322 
	`ã°ˇ£
–
iA
==0 );Åestcase( iA==1 );

22323 
	`ã°ˇ£
–
iB
==-1 );Åestcase( iB==0 );

22324 if–
iB
>=0 ){

22325 
	`ã°ˇ£
–
iA
>0 && 
LARGEST_INT64
 - iA =
iB
 );

22326 
	`ã°ˇ£
–
iA
>0 && 
LARGEST_INT64
 - iA =
iB
 - 1 );

22327 if–
iA
>0 && 
LARGEST_INT64
 - iA < 
iB
 )  1;

22328 *
pA
 +
iB
;

22330 
	`ã°ˇ£
–
iA
<0 && -(iA + 
LARGEST_INT64
Ë=
iB
 + 1 );

22331 
	`ã°ˇ£
–
iA
<0 && -(iA + 
LARGEST_INT64
Ë=
iB
 + 2 );

22332 if–
iA
<0 && -(iA + 
LARGEST_INT64
Ë> 
iB
 + 1 )  1;

22333 *
pA
 +
iB
;

22337 
SQLITE_PRIVATE
 
	`sqlôe3SubI¡64
(
i64
 *
pA
, i64 
iB
){

22338 
	`ã°ˇ£
–
iB
==
SMALLEST_INT64
+1 );

22339 if–
iB
==
SMALLEST_INT64
 ){

22340 
	`ã°ˇ£
–(*
pA
)==(-1) );Åestcase( (*pA)==0 );

22341 if–(*
pA
)>=0 )  1;

22342 *
pA
 -
iB
;

22345  
	`sqlôe3AddI¡64
(
pA
, -
iB
);

22348 
	#TWOPOWER32
 (((
i64
)1)<<32)

	)

22349 
	#TWOPOWER31
 (((
i64
)1)<<31)

	)

22350 
SQLITE_PRIVATE
 
	`sqlôe3MulI¡64
(
i64
 *
pA
, i64 
iB
){

22351 
i64
 
iA
 = *
pA
;

22352 
i64
 
iA1
, 
iA0
, 
iB1
, 
iB0
, 
r
;

22354 
iA1
 = 
iA
/
TWOPOWER32
;

22355 
iA0
 = 
iA
 % 
TWOPOWER32
;

22356 
iB1
 = 
iB
/
TWOPOWER32
;

22357 
iB0
 = 
iB
 % 
TWOPOWER32
;

22358 if–
iA1
*
iB1
 != 0 )  1;

22359 
	`as£π
–
iA1
*
iB0
==0 || 
iA0
*
iB1
==0 );

22360 
r
 = 
iA1
*
iB0
 + 
iA0
*
iB1
;

22361 
	`ã°ˇ£
–
r
==(-
TWOPOWER31
)-1 );

22362 
	`ã°ˇ£
–
r
==(-
TWOPOWER31
) );

22363 
	`ã°ˇ£
–
r
==
TWOPOWER31
 );

22364 
	`ã°ˇ£
–
r
==
TWOPOWER31
-1 );

22365 if–
r
<(-
TWOPOWER31
) ||Ñ>=TWOPOWER31 )  1;

22366 
r
 *
TWOPOWER32
;

22367 if–
	`sqlôe3AddI¡64
(&
r
, 
iA0
*
iB0
) )  1;

22368 *
pA
 = 
r
;

22376 
SQLITE_PRIVATE
 
	`sqlôe3AbsI¡32
(
x
){

22377 if–
x
>=0 )  x;

22378 if–
x
==()0x80000000 )  0x7fffffff;

22379  -
x
;

22382 #ifde‡
SQLITE_ENABLE_8_3_NAMES


22400 
SQLITE_PRIVATE
 
	`sqlôe3FûeSuffix3
(c⁄° *
zBa£Fûíame
, *
z
){

22401 #i‡
SQLITE_ENABLE_8_3_NAMES
<2

22402 if–
	`sqlôe3_uri_boﬁón
(
zBa£Fûíame
, "8_3_names", 0) )

22405 
i
, 
sz
;

22406 
sz
 = 
	`sqlôe3SåÀn30
(
z
);

22407 
i
=
sz
-1; i>0 && 
z
[i]!='/' && z[i]!='.'; i--){}

22408 if–
z
[
i
]=='.' && 
	`ALWAYS
(
sz
>i+4ËË
	`memmove
(&z[i+1], &z[sz-3], 4);

22419 
SQLITE_PRIVATE
 
LogE°
 
	`sqlôe3LogE°Add
(LogE° 
a
, LogE° 
b
){

22420 c⁄° 
x
[] = {

22431 if–
a
>=
b
 ){

22432 if–
a
>
b
+49 ) á;

22433 if–
a
>
b
+31 ) á+1;

22434  
a
+
x
[a-
b
];

22436 if–
b
>
a
+49 )  b;

22437 if–
b
>
a
+31 )  b+1;

22438  
b
+
x
[b-
a
];

22446 
SQLITE_PRIVATE
 
LogE°
 
	`sqlôe3LogE°
(
u64
 
x
){

22447 
LogE°
 
a
[] = { 0, 2, 3, 5, 6, 7, 8, 9 };

22448 
LogE°
 
y
 = 40;

22449 if–
x
<8 ){

22450 if–
x
<2 )  0;

22451  
x
<8 ){ 
y
 -= 10; x <<= 1; }

22453  
x
>255 ){ 
y
 += 40; x >>= 4; }

22454  
x
>15 ){ 
y
 += 10; x >>= 1; }

22456  
a
[
x
&7] + 
y
 - 10;

22459 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


22464 
SQLITE_PRIVATE
 
LogE°
 
	`sqlôe3LogE°FromDoubÀ
(
x
){

22465 
u64
 
a
;

22466 
LogE°
 
e
;

22467 
	`as£π
–(
x
)==8 && (
a
)==8 );

22468 if–
x
<=1 )  0;

22469 if–
x
<=2000000000 )  
	`sqlôe3LogE°
((
u64
)x);

22470 
	`mem˝y
(&
a
, &
x
, 8);

22471 
e
 = (
a
>>52) - 1022;

22472  
e
*10;

22479 
SQLITE_PRIVATE
 
u64
 
	`sqlôe3LogE°ToI¡
(
LogE°
 
x
){

22480 
u64
 
n
;

22481 if–
x
<10 )  1;

22482 
n
 = 
x
%10;

22483 
x
 /= 10;

22484 if–
n
>=5 )Ç -= 2;

22485 if–
n
>=1 )Ç -= 1;

22486 if–
x
>=3 )  (
n
+8)<<(x-3);

22487  (
n
+8)>>(3-
x
);

22513 
SQLITE_PRIVATE
 
	`sqlôe3HashInô
(
Hash
 *
pNew
){

22514 
	`as£π
–
pNew
!=0 );

22515 
pNew
->
fú°
 = 0;

22516 
pNew
->
cou¡
 = 0;

22517 
pNew
->
htsize
 = 0;

22518 
pNew
->
ht
 = 0;

22525 
SQLITE_PRIVATE
 
	`sqlôe3HashCÀ¨
(
Hash
 *
pH
){

22526 
HashEÀm
 *
ñem
;

22528 
	`as£π
–
pH
!=0 );

22529 
ñem
 = 
pH
->
fú°
;

22530 
pH
->
fú°
 = 0;

22531 
	`sqlôe3_‰ì
(
pH
->
ht
);

22532 
pH
->
ht
 = 0;

22533 
pH
->
htsize
 = 0;

22534  
ñem
 ){

22535 
HashEÀm
 *
√xt_ñem
 = 
ñem
->
√xt
;

22536 
	`sqlôe3_‰ì
(
ñem
);

22537 
ñem
 = 
√xt_ñem
;

22539 
pH
->
cou¡
 = 0;

22545 
	`°rHash
(c⁄° *
z
, 
nKey
){

22546 
h
 = 0;

22547 
	`as£π
–
nKey
>=0 );

22548  
nKey
 > 0 ){

22549 
h
 = (h<<3Ë^ h ^ 
sqlôe3UµîToLowî
[()*
z
++];

22550 
nKey
--;

22552  
h
;

22559 
	`ö£πEÀmít
(

22560 
Hash
 *
pH
,

22561 
_ht
 *
pE¡ry
,

22562 
HashEÀm
 *
pNew


22564 
HashEÀm
 *
pHód
;

22565 if–
pE¡ry
 ){

22566 
pHód
 = 
pE¡ry
->
cou¡
 ?ÖE¡ry->
chaö
 : 0;

22567 
pE¡ry
->
cou¡
++;

22568 
pE¡ry
->
chaö
 = 
pNew
;

22570 
pHód
 = 0;

22572 if–
pHód
 ){

22573 
pNew
->
√xt
 = 
pHód
;

22574 
pNew
->
¥ev
 = 
pHód
->prev;

22575 if–
pHód
->
¥ev
 ){ÖHód->¥ev->
√xt
 = 
pNew
; }

22576 { 
pH
->
fú°
 = 
pNew
; }

22577 
pHód
->
¥ev
 = 
pNew
;

22579 
pNew
->
√xt
 = 
pH
->
fú°
;

22580 if–
pH
->
fú°
 ){ÖH->fú°->
¥ev
 = 
pNew
; }

22581 
pNew
->
¥ev
 = 0;

22582 
pH
->
fú°
 = 
pNew
;

22593 
	`ªhash
(
Hash
 *
pH
, 
√w_size
){

22594 
_ht
 *
√w_ht
;

22595 
HashEÀm
 *
ñem
, *
√xt_ñem
;

22597 #i‡
SQLITE_MALLOC_SOFT_LIMIT
>0

22598 if–
√w_size
*(
_ht
)>
SQLITE_MALLOC_SOFT_LIMIT
 ){

22599 
√w_size
 = 
SQLITE_MALLOC_SOFT_LIMIT
/(
_ht
);

22601 if–
√w_size
==
pH
->
htsize
 )  0;

22612 
	`sqlôe3BegöBíignMÆloc
();

22613 
√w_ht
 = (
_ht
 *)
	`sqlôe3MÆloc
–
√w_size
*(_ht) );

22614 
	`sqlôe3EndBíignMÆloc
();

22616 if–
√w_ht
==0 )  0;

22617 
	`sqlôe3_‰ì
(
pH
->
ht
);

22618 
pH
->
ht
 = 
√w_ht
;

22619 
pH
->
htsize
 = 
√w_size
 = 
	`sqlôe3MÆlocSize
(
√w_ht
)/(
_ht
);

22620 
	`mem£t
(
√w_ht
, 0, 
√w_size
*(
_ht
));

22621 
ñem
=
pH
->
fú°
,ÖH->fú°=0;ÉÀm;ÉÀm = 
√xt_ñem
){

22622 
h
 = 
	`°rHash
(
ñem
->
pKey
,ÉÀm->
nKey
Ë% 
√w_size
;

22623 
√xt_ñem
 = 
ñem
->
√xt
;

22624 
	`ö£πEÀmít
(
pH
, &
√w_ht
[
h
], 
ñem
);

22633 
HashEÀm
 *
	`födEÀmítGivíHash
(

22634 c⁄° 
Hash
 *
pH
,

22635 c⁄° *
pKey
,

22636 
nKey
,

22637 
h


22639 
HashEÀm
 *
ñem
;

22640 
cou¡
;

22642 if–
pH
->
ht
 ){

22643 
_ht
 *
pE¡ry
 = &
pH
->
ht
[
h
];

22644 
ñem
 = 
pE¡ry
->
chaö
;

22645 
cou¡
 = 
pE¡ry
->count;

22647 
ñem
 = 
pH
->
fú°
;

22648 
cou¡
 = 
pH
->count;

22650  
cou¡
-- && 
	`ALWAYS
(
ñem
) ){

22651 if–
ñem
->
nKey
=ÚKey && 
	`sqlôe3SåNICmp
”Àm->
pKey
,pKey,nKey)==0 ){

22652  
ñem
;

22654 
ñem
 =ÉÀm->
√xt
;

22662 
	`ªmoveEÀmítGivíHash
(

22663 
Hash
 *
pH
,

22664 
HashEÀm
* 
ñem
,

22665 
h


22667 
_ht
 *
pE¡ry
;

22668 if–
ñem
->
¥ev
 ){

22669 
ñem
->
¥ev
->
√xt
 =Élem->next;

22671 
pH
->
fú°
 = 
ñem
->
√xt
;

22673 if–
ñem
->
√xt
 ){

22674 
ñem
->
√xt
->
¥ev
 =Élem->prev;

22676 if–
pH
->
ht
 ){

22677 
pE¡ry
 = &
pH
->
ht
[
h
];

22678 if–
pE¡ry
->
chaö
==
ñem
 ){

22679 
pE¡ry
->
chaö
 = 
ñem
->
√xt
;

22681 
pE¡ry
->
cou¡
--;

22682 
	`as£π
–
pE¡ry
->
cou¡
>=0 );

22684 
	`sqlôe3_‰ì
–
ñem
 );

22685 
pH
->
cou¡
--;

22686 if–
pH
->
cou¡
==0 ){

22687 
	`as£π
–
pH
->
fú°
==0 );

22688 
	`as£π
–
pH
->
cou¡
==0 );

22689 
	`sqlôe3HashCÀ¨
(
pH
);

22697 
SQLITE_PRIVATE
 *
	`sqlôe3HashFöd
(c⁄° 
Hash
 *
pH
, c⁄° *
pKey
, 
nKey
){

22698 
HashEÀm
 *
ñem
;

22699 
h
;

22701 
	`as£π
–
pH
!=0 );

22702 
	`as£π
–
pKey
!=0 );

22703 
	`as£π
–
nKey
>=0 );

22704 if–
pH
->
ht
 ){

22705 
h
 = 
	`°rHash
(
pKey
, 
nKey
Ë% 
pH
->
htsize
;

22707 
h
 = 0;

22709 
ñem
 = 
	`födEÀmítGivíHash
(
pH
, 
pKey
, 
nKey
, 
h
);

22710  
ñem
 ?ÉÀm->
d©a
 : 0;

22727 
SQLITE_PRIVATE
 *
	`sqlôe3HashIn£π
(
Hash
 *
pH
, c⁄° *
pKey
, 
nKey
, *
d©a
){

22728 
h
;

22729 
HashEÀm
 *
ñem
;

22730 
HashEÀm
 *
√w_ñem
;

22732 
	`as£π
–
pH
!=0 );

22733 
	`as£π
–
pKey
!=0 );

22734 
	`as£π
–
nKey
>=0 );

22735 if–
pH
->
htsize
 ){

22736 
h
 = 
	`°rHash
(
pKey
, 
nKey
Ë% 
pH
->
htsize
;

22738 
h
 = 0;

22740 
ñem
 = 
	`födEÀmítGivíHash
(
pH
,
pKey
,
nKey
,
h
);

22741 if–
ñem
 ){

22742 *
ﬁd_d©a
 = 
ñem
->
d©a
;

22743 if–
d©a
==0 ){

22744 
	`ªmoveEÀmítGivíHash
(
pH
,
ñem
,
h
);

22746 
ñem
->
d©a
 = data;

22747 
ñem
->
pKey
 =ÖKey;

22748 
	`as£π
(
nKey
==
ñem
->nKey);

22750  
ﬁd_d©a
;

22752 if–
d©a
==0 )  0;

22753 
√w_ñem
 = (
HashEÀm
*)
	`sqlôe3MÆloc
( (HashElem) );

22754 if–
√w_ñem
==0 )  
d©a
;

22755 
√w_ñem
->
pKey
 =ÖKey;

22756 
√w_ñem
->
nKey
 =ÇKey;

22757 
√w_ñem
->
d©a
 = data;

22758 
pH
->
cou¡
++;

22759 if–
pH
->
cou¡
>=10 &&ÖH->cou¡ > 2*pH->
htsize
 ){

22760 if–
	`ªhash
(
pH
,ÖH->
cou¡
*2) ){

22761 
	`as£π
–
pH
->
htsize
>0 );

22762 
h
 = 
	`°rHash
(
pKey
, 
nKey
Ë% 
pH
->
htsize
;

22765 if–
pH
->
ht
 ){

22766 
	`ö£πEÀmít
(
pH
, &pH->
ht
[
h
], 
√w_ñem
);

22768 
	`ö£πEÀmít
(
pH
, 0, 
√w_ñem
);

22777 #i‡!
	`deföed
(
SQLITE_OMIT_EXPLAIN
Ë|| !deföed(
NDEBUG
Ë|| deföed(
VDBE_PROFILE
Ë|| deföed(
SQLITE_DEBUG
)

22778 
SQLITE_PRIVATE
 c⁄° *
	`sqlôe3OpcodeName
(
i
){

22779 c⁄° *c⁄° 
azName
[] = { "?",

22926  
azName
[
i
];

22977 #i‡
SQLITE_OS_UNIX


22996 #i‡!
	`deföed
(
SQLITE_ENABLE_LOCKING_STYLE
)

22997 #i‡
	`deföed
(
__APPLE__
)

22998 
	#SQLITE_ENABLE_LOCKING_STYLE
 1

	)

23000 
	#SQLITE_ENABLE_LOCKING_STYLE
 0

	)

23008 #i‚de‡
OS_VXWORKS


23009 #i‡
	`deföed
(
__RTP__
Ë|| deföed(
_WRS_KERNEL
)

23010 
	#OS_VXWORKS
 1

	)

23012 
	#OS_VXWORKS
 0

	)

23034 #i‚de‡
SQLITE_DISABLE_LFS


23035 
	#_LARGE_FILE
 1

	)

23036 #i‚de‡
_FILE_OFFSET_BITS


23037 
	#_FILE_OFFSET_BITS
 64

	)

23039 
	#_LARGEFILE_SOURCE
 1

	)

23045 
	~<sys/ty≥s.h
>

23046 
	~<sys/°©.h
>

23047 
	~<f˙é.h
>

23048 
	~<uni°d.h
>

23050 
	~<sys/time.h
>

23051 
	~<î∫o.h
>

23052 #i‡!
	`deföed
(
SQLITE_OMIT_WAL
Ë|| 
SQLITE_MAX_MMAP_SIZE
>0

23053 
	~<sys/mm™.h
>

23057 #i‡
SQLITE_ENABLE_LOCKING_STYLE


23058 
	~<sys/io˘l.h
>

23059 #i‡
OS_VXWORKS


23060 
	~<£m≠h‹e.h
>

23061 
	~<limôs.h
>

23063 
	~<sys/fûe.h
>

23064 
	~<sys/∑øm.h
>

23068 #i‡
	`deföed
(
__APPLE__
Ë|| (
SQLITE_ENABLE_LOCKING_STYLE
 && !
OS_VXWORKS
)

23069 
	~<sys/mou¡.h
>

23072 #ifde‡
HAVE_UTIME


23073 
	~<utime.h
>

23079 
	#SQLITE_FSFLAGS_IS_MSDOS
 0x1

	)

23085 #i‡
SQLITE_THREADSAFE


23087 
	#SQLITE_UNIX_THREADS
 1

	)

23093 #i‚de‡
SQLITE_DEFAULT_FILE_PERMISSIONS


23094 
	#SQLITE_DEFAULT_FILE_PERMISSIONS
 0644

	)

23100 #i‚de‡
SQLITE_DEFAULT_PROXYDIR_PERMISSIONS


23101 
	#SQLITE_DEFAULT_PROXYDIR_PERMISSIONS
 0755

	)

23107 
	#MAX_PATHNAME
 512

	)

23113 
	#IS_LOCK_ERROR
(
x
Ë((x !
SQLITE_OK
Ë&& (x !
SQLITE_BUSY
))

	)

23116 
unixShm
 
	tunixShm
;

23117 
unixShmNode
 
	tunixShmNode
;

23118 
unixInodeInfo
 
	tunixInodeInfo
;

23119 
UnixUnu£dFd
 
	tUnixUnu£dFd
;

23127 
	sUnixUnu£dFd
 {

23128 
fd
;

23129 
Êags
;

23130 
UnixUnu£dFd
 *
pNext
;

23137 
unixFûe
 
	tunixFûe
;

23138 
	sunixFûe
 {

23139 
sqlôe3_io_mëhods
 c⁄° *
pMëhod
;

23140 
sqlôe3_vfs
 *
pVfs
;

23141 
unixInodeInfo
 *
pInode
;

23142 
h
;

23143 
eFûeLock
;

23144 
˘æFœgs
;

23145 
œ°Eºno
;

23146 *
lockögC⁄ãxt
;

23147 
UnixUnu£dFd
 *
pUnu£d
;

23148 c⁄° *
zP©h
;

23149 
unixShm
 *
pShm
;

23150 
szChunk
;

23151 #i‡
SQLITE_MAX_MMAP_SIZE
>0

23152 
nFëchOut
;

23153 
sqlôe3_öt64
 
mm≠Size
;

23154 
sqlôe3_öt64
 
mm≠SizeA˘uÆ
;

23155 
sqlôe3_öt64
 
mm≠SizeMax
;

23156 *
pM≠Regi⁄
;

23158 #ifde‡
__QNXNTO__


23159 
£˘‹Size
;

23160 
devi˚Ch¨a˘îi°ics
;

23162 #i‡
SQLITE_ENABLE_LOCKING_STYLE


23163 
›íFœgs
;

23165 #i‡
SQLITE_ENABLE_LOCKING_STYLE
 || 
	`deföed
(
__APPLE__
)

23166 
fsFœgs
;

23168 #i‡
OS_VXWORKS


23169 
vxw‹ksFûeId
 *
pId
;

23171 #ifde‡
SQLITE_DEBUG


23179 
å™sC¡rChng
;

23180 
dbUpd©e
;

23181 
öN‹mÆWrôe
;

23185 #ifde‡
SQLITE_TEST


23189 
aPaddög
[32];

23196 
	#UNIXFILE_EXCL
 0x01

	)

23197 
	#UNIXFILE_RDONLY
 0x02

	)

23198 
	#UNIXFILE_PERSIST_WAL
 0x04

	)

23199 #i‚de‡
SQLITE_DISABLE_DIRSYNC


23200 
	#UNIXFILE_DIRSYNC
 0x08

	)

23202 
	#UNIXFILE_DIRSYNC
 0x00

	)

23204 
	#UNIXFILE_PSOW
 0x10

	)

23205 
	#UNIXFILE_DELETE
 0x20

	)

23206 
	#UNIXFILE_URI
 0x40

	)

23207 
	#UNIXFILE_NOLOCK
 0x80

	)

23208 
	#UNIXFILE_WARNED
 0x0100

	)

23234 #i‚de‡
_OS_COMMON_H_


23235 
	#_OS_COMMON_H_


	)

23242 #ifde‡
MEMORY_DEBUG


23246 #i‡
	`deföed
(
SQLITE_TEST
Ë&& deföed(
SQLITE_DEBUG
)

23247 #i‚de‡
SQLITE_DEBUG_OS_TRACE


23248 
	#SQLITE_DEBUG_OS_TRACE
 0

	)

23250 
sqlôe3OSTø˚
 = 
SQLITE_DEBUG_OS_TRACE
;

23251 
	#OSTRACE
(
X
Ëif–
sqlôe3OSTø˚
 ) 
sqlôe3DebugPrötf
 
	)
X

23253 
	#OSTRACE
(
X
)

	)

23260 #ifde‡
SQLITE_PERFORMANCE_TRACE


23283 #i‚de‡
_HWTIME_H_


23284 
	#_HWTIME_H_


	)

23292 #i‡(
	`deföed
(
__GNUC__
Ë|| deföed(
_MSC_VER
)) && \

23293 (
	`deföed
(
i386
Ë|| deföed(
__i386__
Ë|| deföed(
_M_IX86
))

23295 #i‡
	`deföed
(
__GNUC__
)

23297 
__ölöe__
 
sqlôe_uöt64
 
	`sqlôe3Hwtime
(){

23298 
lo
, 
hi
;

23299 
__asm__
 
	`__vﬁ©ûe__
 ("rdtsc" : "˜" (
lo
), "=d" (
hi
));

23300  (
sqlôe_uöt64
)
hi
 << 32 | 
lo
;

23303 #ñi‡
	`deföed
(
_MSC_VER
)

23305 
	`__de˛•ec
(
«ked
Ë
__ölöe
 
sqlôe_uöt64
 
__cde˛
 
	`sqlôe3Hwtime
(){

23306 
__asm
 {

23307 
rdtsc


23308 
ªt
 ;  
vÆue
 
©
 
EDX
:
EAX


23314 #ñi‡(
	`deföed
(
__GNUC__
Ë&& deföed(
__x86_64__
))

23316 
__ölöe__
 
sqlôe_uöt64
 
	`sqlôe3Hwtime
(){

23317 
vÆ
;

23318 
__asm__
 
	`__vﬁ©ûe__
 ("rdtsc" : "=A" (
vÆ
));

23319  
vÆ
;

23322 #ñi‡(
	`deföed
(
__GNUC__
Ë&& deföed(
__µc__
))

23324 
__ölöe__
 
sqlôe_uöt64
 
	`sqlôe3Hwtime
(){

23325 
ªtvÆ
;

23326 
junk
;

23327 
__asm__
 
	`__vﬁ©ûe__
 ("\n\
1: mftbu %1\n\
 %L0\n\
 %0\n\
 %0,%1\n\
 1b"

23333 : "Ù" (
ªtvÆ
), "Ù" (
junk
));

23334  
ªtvÆ
;

23339 #îr‹ 
Nìd
 
im∂emíèti⁄
 
of
 
	`sqlôe3Hwtime
(Ë
your
 
∂©f‹m
.

23348 
SQLITE_PRIVATE
 
sqlôe_uöt64
 
	`sqlôe3Hwtime
(){  ((sqlite_uint64)0); }

23357 
sqlôe_uöt64
 
g_°¨t
;

23358 
sqlôe_uöt64
 
g_ñ≠£d
;

23359 
	#TIMER_START
 
g_°¨t
=
	`sqlôe3Hwtime
()

	)

23360 
	#TIMER_END
 
g_ñ≠£d
=
	`sqlôe3Hwtime
()-
g_°¨t


	)

23361 
	#TIMER_ELAPSED
 
g_ñ≠£d


	)

23363 
	#TIMER_START


	)

23364 
	#TIMER_END


	)

23365 
	#TIMER_ELAPSED
 ((
sqlôe_uöt64
)0)

	)

23373 #ifde‡
SQLITE_TEST


23374 
SQLITE_API
 
sqlôe3_io_îr‹_hô
 = 0;

23375 
SQLITE_API
 
sqlôe3_io_îr‹_h¨dhô
 = 0;

23376 
SQLITE_API
 
sqlôe3_io_îr‹_≥ndög
 = 0;

23377 
SQLITE_API
 
sqlôe3_io_îr‹_≥rsi°
 = 0;

23378 
SQLITE_API
 
sqlôe3_io_îr‹_bíign
 = 0;

23379 
SQLITE_API
 
sqlôe3_diskfuŒ_≥ndög
 = 0;

23380 
SQLITE_API
 
sqlôe3_diskfuŒ
 = 0;

23381 
	#SimuœãIOEº‹Bíign
(
X
Ë
sqlôe3_io_îr‹_bíign
=(X)

	)

23382 
	#SimuœãIOEº‹
(
CODE
) \

23383 if–(
sqlôe3_io_îr‹_≥rsi°
 && 
sqlôe3_io_îr‹_hô
) \

23384 || 
sqlôe3_io_îr‹_≥ndög
-- == 1 ) \

23385 { 
	`loˇl_i€º
(); 
CODE
; }

	)

23386 
	`loˇl_i€º
(){

23387 
	`IOTRACE
(("IOERR\n"));

23388 
sqlôe3_io_îr‹_hô
++;

23389 if–!
sqlôe3_io_îr‹_bíign
 ) 
sqlôe3_io_îr‹_h¨dhô
++;

23391 
	#SimuœãDiskfuŒEº‹
(
CODE
) \

23392 if–
sqlôe3_diskfuŒ_≥ndög
 ){ \

23393 if–
sqlôe3_diskfuŒ_≥ndög
 == 1 ){ \

23394 
	`loˇl_i€º
(); \

23395 
sqlôe3_diskfuŒ
 = 1; \

23396 
sqlôe3_io_îr‹_hô
 = 1; \

23397 
CODE
; \

23399 
sqlôe3_diskfuŒ_≥ndög
--; \

23401 }

	)

23403 
	#SimuœãIOEº‹Bíign
(
X
)

	)

23404 
	#SimuœãIOEº‹
(
A
)

	)

23405 
	#SimuœãDiskfuŒEº‹
(
A
)

	)

23411 #ifde‡
SQLITE_TEST


23412 
SQLITE_API
 
sqlôe3_›í_fûe_cou¡
 = 0;

23413 
	#O≥nCou¡î
(
X
Ë
sqlôe3_›í_fûe_cou¡
+=(X)

	)

23415 
	#O≥nCou¡î
(
X
)

	)

23426 #i‚de‡
O_LARGEFILE


23427 
	#O_LARGEFILE
 0

	)

23429 #ifde‡
SQLITE_DISABLE_LFS


23430 #unde‡
O_LARGEFILE


23431 
	#O_LARGEFILE
 0

	)

23433 #i‚de‡
O_NOFOLLOW


23434 
	#O_NOFOLLOW
 0

	)

23436 #i‚de‡
O_BINARY


23437 
	#O_BINARY
 0

	)

23444 #i‡
SQLITE_THREADSAFE


23445 
	#thªadid
 
	`±hªad_£lf
()

	)

23447 
	#thªadid
 0

	)

23453 #i‡!
	`deföed
(
HAVE_MREMAP
)

23454 #i‡
	`deföed
(
__löux__
Ë&& deföed(
_GNU_SOURCE
)

23455 
	#HAVE_MREMAP
 1

	)

23457 
	#HAVE_MREMAP
 0

	)

23469 
	`posixO≥n
(c⁄° *
zFûe
, 
Êags
, 
mode
){

23470  
	`›í
(
zFûe
, 
Êags
, 
mode
);

23478 
	`posixFchown
(
fd
, 
uid_t
 
uid
, 
gid_t
 
gid
){

23479  
	`gëeuid
(Ë? 0 : 
	`fchown
(
fd
,
uid
,
gid
);

23483 
	`›íDúe˘‹y
(const *, *);

23491 
	sunix_sysˇŒ
 {

23492 c⁄° *
zName
;

23493 
sqlôe3_sysˇŒ_±r
 
pCuºít
;

23494 
sqlôe3_sysˇŒ_±r
 
pDeÁu…
;

23495 } 
aSysˇŒ
[] = {

23496 { "›í", (
sqlôe3_sysˇŒ_±r
)
posixO≥n
, 0 },

23497 
	#osO≥n
 (((*)(c⁄° *,,))
aSysˇŒ
[0].
pCuºít
)

	)

23499 { "˛o£", (
sqlôe3_sysˇŒ_±r
)
˛o£
, 0 },

23500 
	#osClo£
 (((*)())
aSysˇŒ
[1].
pCuºít
)

	)

23502 { "ac˚ss", (
sqlôe3_sysˇŒ_±r
)
ac˚ss
, 0 },

23503 
	#osAc˚ss
 (((*)(c⁄° *,))
aSysˇŒ
[2].
pCuºít
)

	)

23505 { "gëcwd", (
sqlôe3_sysˇŒ_±r
)
gëcwd
, 0 },

23506 
	#osGëcwd
 ((*(*)(*,
size_t
))
aSysˇŒ
[3].
pCuºít
)

	)

23508 { "°©", (
sqlôe3_sysˇŒ_±r
)
°©
, 0 },

23509 
	#osSèt
 (((*)(c⁄° *,
°©
*))
aSysˇŒ
[4].
pCuºít
)

	)

23517 #ifde‡
__DJGPP__


23519 
	#osF°©
(
a
,
b
,
c
Ë0

	)

23521 { "f°©", (
sqlôe3_sysˇŒ_±r
)
f°©
, 0 },

23522 
	#osF°©
 (((*)(,
°©
*))
aSysˇŒ
[5].
pCuºít
)

	)

23525 { "·runˇã", (
sqlôe3_sysˇŒ_±r
)
·runˇã
, 0 },

23526 
	#osFåunˇã
 (((*)(,
off_t
))
aSysˇŒ
[6].
pCuºít
)

	)

23528 { "f˙é", (
sqlôe3_sysˇŒ_±r
)
f˙é
, 0 },

23529 
	#osF˙é
 (((*)(,,...))
aSysˇŒ
[7].
pCuºít
)

	)

23531 { "ªad", (
sqlôe3_sysˇŒ_±r
)
ªad
, 0 },

23532 
	#osRód
 ((
	`ssize_t
(*)(,*,
size_t
))
aSysˇŒ
[8].
pCuºít
)

	)

23534 #i‡
	`deföed
(
USE_PREAD
Ë|| 
SQLITE_ENABLE_LOCKING_STYLE


23535 { "¥ód", (
sqlôe3_sysˇŒ_±r
)
¥ód
, 0 },

23537 { "¥ód", (
sqlôe3_sysˇŒ_±r
)0, 0 },

23539 
	#osPªad
 ((
	`ssize_t
(*)(,*,
size_t
,
off_t
))
aSysˇŒ
[9].
pCuºít
)

	)

23541 #i‡
	`deföed
(
USE_PREAD64
)

23542 { "¥ód64", (
sqlôe3_sysˇŒ_±r
)
¥ód64
, 0 },

23544 { "¥ód64", (
sqlôe3_sysˇŒ_±r
)0, 0 },

23546 
	#osPªad64
 ((
	`ssize_t
(*)(,*,
size_t
,
off_t
))
aSysˇŒ
[10].
pCuºít
)

	)

23548 { "wrôe", (
sqlôe3_sysˇŒ_±r
)
wrôe
, 0 },

23549 
	#osWrôe
 ((
	`ssize_t
(*)(,c⁄° *,
size_t
))
aSysˇŒ
[11].
pCuºít
)

	)

23551 #i‡
	`deföed
(
USE_PREAD
Ë|| 
SQLITE_ENABLE_LOCKING_STYLE


23552 { "pwrôe", (
sqlôe3_sysˇŒ_±r
)
pwrôe
, 0 },

23554 { "pwrôe", (
sqlôe3_sysˇŒ_±r
)0, 0 },

23556 
	#osPwrôe
 ((
	`ssize_t
(*)(,c⁄° *,
size_t
,
off_t
))\

23557 
aSysˇŒ
[12].
pCuºít
)

	)

23559 #i‡
	`deföed
(
USE_PREAD64
)

23560 { "pwrôe64", (
sqlôe3_sysˇŒ_±r
)
pwrôe64
, 0 },

23562 { "pwrôe64", (
sqlôe3_sysˇŒ_±r
)0, 0 },

23564 
	#osPwrôe64
 ((
	`ssize_t
(*)(,c⁄° *,
size_t
,
off_t
))\

23565 
aSysˇŒ
[13].
pCuºít
)

	)

23567 { "fchmod", (
sqlôe3_sysˇŒ_±r
)
fchmod
, 0 },

23568 
	#osFchmod
 (((*)(,
mode_t
))
aSysˇŒ
[14].
pCuºít
)

	)

23570 #i‡
	`deföed
(
HAVE_POSIX_FALLOCATE
) && HAVE_POSIX_FALLOCATE

23571 { "ÁŒoˇã", (
sqlôe3_sysˇŒ_±r
)
posix_ÁŒoˇã
, 0 },

23573 { "ÁŒoˇã", (
sqlôe3_sysˇŒ_±r
)0, 0 },

23575 
	#osFÆloˇã
 (((*)(,
off_t
,off_t))
aSysˇŒ
[15].
pCuºít
)

	)

23577 { "u∆ök", (
sqlôe3_sysˇŒ_±r
)
u∆ök
, 0 },

23578 
	#osU∆ök
 (((*)(c⁄° *))
aSysˇŒ
[16].
pCuºít
)

	)

23580 { "›íDúe˘‹y", (
sqlôe3_sysˇŒ_±r
)
›íDúe˘‹y
, 0 },

23581 
	#osO≥nDúe˘‹y
 (((*)(c⁄° *,*))
aSysˇŒ
[17].
pCuºít
)

	)

23583 { "mkdú", (
sqlôe3_sysˇŒ_±r
)
mkdú
, 0 },

23584 
	#osMkdú
 (((*)(c⁄° *,
mode_t
))
aSysˇŒ
[18].
pCuºít
)

	)

23586 { "rmdú", (
sqlôe3_sysˇŒ_±r
)
rmdú
, 0 },

23587 
	#osRmdú
 (((*)(c⁄° *))
aSysˇŒ
[19].
pCuºít
)

	)

23589 { "fchown", (
sqlôe3_sysˇŒ_±r
)
posixFchown
, 0 },

23590 
	#osFchown
 (((*)(,
uid_t
,
gid_t
))
aSysˇŒ
[20].
pCuºít
)

	)

23592 #i‡!
	`deföed
(
SQLITE_OMIT_WAL
Ë|| 
SQLITE_MAX_MMAP_SIZE
>0

23593 { "mm≠", (
sqlôe3_sysˇŒ_±r
)
mm≠
, 0 },

23594 
	#osMm≠
 ((*(*)(*,
size_t
,,,,
off_t
))
aSysˇŒ
[21].
pCuºít
)

	)

23596 { "munm≠", (
sqlôe3_sysˇŒ_±r
)
munm≠
, 0 },

23597 
	#osMunm≠
 ((*(*)(*,
size_t
))
aSysˇŒ
[22].
pCuºít
)

	)

23599 #i‡
HAVE_MREMAP


23600 { "mªm≠", (
sqlôe3_sysˇŒ_±r
)
mªm≠
, 0 },

23602 { "mªm≠", (
sqlôe3_sysˇŒ_±r
)0, 0 },

23604 
	#osMªm≠
 ((*(*)(*,
size_t
,size_t,,...))
aSysˇŒ
[23].
pCuºít
)

	)

23615 
	`unixSëSy°emCÆl
(

23616 
sqlôe3_vfs
 *
pNŸU£d
,

23617 c⁄° *
zName
,

23618 
sqlôe3_sysˇŒ_±r
 
pNewFunc


23620 
i
;

23621 
rc
 = 
SQLITE_NOTFOUND
;

23623 
	`UNUSED_PARAMETER
(
pNŸU£d
);

23624 if–
zName
==0 ){

23628 
rc
 = 
SQLITE_OK
;

23629 
i
=0; i<(
aSysˇŒ
)/(aSyscall[0]); i++){

23630 if–
aSysˇŒ
[
i
].
pDeÁu…
 ){

23631 
aSysˇŒ
[
i
].
pCuºít
 =áSysˇŒ[i].
pDeÁu…
;

23638 
i
=0; i<(
aSysˇŒ
)/(aSyscall[0]); i++){

23639 if–
	`°rcmp
(
zName
, 
aSysˇŒ
[
i
].zName)==0 ){

23640 if–
aSysˇŒ
[
i
].
pDeÁu…
==0 ){

23641 
aSysˇŒ
[
i
].
pDeÁu…
 =áSysˇŒ[i].
pCuºít
;

23643 
rc
 = 
SQLITE_OK
;

23644 if–
pNewFunc
==0 )ÖNewFun¯
aSysˇŒ
[
i
].
pDeÁu…
;

23645 
aSysˇŒ
[
i
].
pCuºít
 = 
pNewFunc
;

23650  
rc
;

23658 
sqlôe3_sysˇŒ_±r
 
	`unixGëSy°emCÆl
(

23659 
sqlôe3_vfs
 *
pNŸU£d
,

23660 c⁄° *
zName


23662 
i
;

23664 
	`UNUSED_PARAMETER
(
pNŸU£d
);

23665 
i
=0; i<(
aSysˇŒ
)/(aSyscall[0]); i++){

23666 if–
	`°rcmp
(
zName
, 
aSysˇŒ
[
i
].zName)==0 ) áSysˇŒ[i].
pCuºít
;

23677 c⁄° *
	`unixNextSy°emCÆl
(
sqlôe3_vfs
 *
p
, c⁄° *
zName
){

23678 
i
 = -1;

23680 
	`UNUSED_PARAMETER
(
p
);

23681 if–
zName
 ){

23682 
i
=0; i<
	`AºaySize
(
aSysˇŒ
)-1; i++){

23683 if–
	`°rcmp
(
zName
, 
aSysˇŒ
[
i
].zName)==0 ) ;

23686 
i
++; i<
	`AºaySize
(
aSysˇŒ
); i++){

23687 if–
aSysˇŒ
[
i
].
pCuºít
!=0 ) áSysˇŒ[i].
zName
;

23697 #i‚de‡
SQLITE_MINIMUM_FILE_DESCRIPTOR


23698 
	#SQLITE_MINIMUM_FILE_DESCRIPTOR
 3

	)

23718 
	`robu°_›í
(c⁄° *
z
, 
f
, 
mode_t
 
m
){

23719 
fd
;

23720 
mode_t
 
m2
 = 
m
 ? m : 
SQLITE_DEFAULT_FILE_PERMISSIONS
;

23722 #i‡
	`deföed
(
O_CLOEXEC
)

23723 
fd
 = 
	`osO≥n
(
z
,
f
|
O_CLOEXEC
,
m2
);

23725 
fd
 = 
	`osO≥n
(
z
,
f
,
m2
);

23727 if–
fd
<0 ){

23728 if–
î∫o
==
EINTR
 ) ;

23731 if–
fd
>=
SQLITE_MINIMUM_FILE_DESCRIPTOR
 ) ;

23732 
	`osClo£
(
fd
);

23733 
	`sqlôe3_log
(
SQLITE_WARNING
,

23734 "©ãm±Åÿ›í \"%s\"á†fûêdes¸ùt‹ %d", 
z
, 
fd
);

23735 
fd
 = -1;

23736 if–
	`osO≥n
("/dev/nuŒ", 
f
, 
m
)<0 ) ;

23738 if–
fd
>=0 ){

23739 if–
m
!=0 ){

23740 
°©
 
°©buf
;

23741 if–
	`osF°©
(
fd
, &
°©buf
)==0

23742 && 
°©buf
.
°_size
==0

23743 && (
°©buf
.
°_mode
&0777)!=
m


23745 
	`osFchmod
(
fd
, 
m
);

23748 #i‡
	`deföed
(
FD_CLOEXEC
Ë&& (!deföed(
O_CLOEXEC
) || O_CLOEXEC==0)

23749 
	`osF˙é
(
fd
, 
F_SETFD
, osF˙é(fd, 
F_GETFD
, 0Ë| 
FD_CLOEXEC
);

23752  
fd
;

23769 
	`unixE¡îMuãx
(){

23770 
	`sqlôe3_muãx_íãr
(
	`sqlôe3MuãxAŒoc
(
SQLITE_MUTEX_STATIC_MASTER
));

23772 
	`unixLóveMuãx
(){

23773 
	`sqlôe3_muãx_Àave
(
	`sqlôe3MuãxAŒoc
(
SQLITE_MUTEX_STATIC_MASTER
));

23775 #ifde‡
SQLITE_DEBUG


23776 
	`unixMuãxHñd
() {

23777  
	`sqlôe3_muãx_hñd
(
	`sqlôe3MuãxAŒoc
(
SQLITE_MUTEX_STATIC_MASTER
));

23782 #i‡
	`deföed
(
SQLITE_TEST
Ë&& deföed(
SQLITE_DEBUG
)

23788 c⁄° *
	`azFûeLock
(
eFûeLock
){

23789  
eFûeLock
 ){

23790 
NO_LOCK
:  "NONE";

23791 
SHARED_LOCK
:  "SHARED";

23792 
RESERVED_LOCK
:  "RESERVED";

23793 
PENDING_LOCK
:  "PENDING";

23794 
EXCLUSIVE_LOCK
:  "EXCLUSIVE";

23800 #ifde‡
SQLITE_LOCK_TRACE


23809 
	`lockTø˚
(
fd
, 
›
, 
Êock
 *
p
){

23810 *
zOpName
, *
zTy≥
;

23811 
s
;

23812 
ßvedEºno
;

23813 if–
›
==
F_GETLK
 ){

23814 
zOpName
 = "GETLK";

23815 }if–
›
==
F_SETLK
 ){

23816 
zOpName
 = "SETLK";

23818 
s
 = 
	`osF˙é
(
fd
, 
›
, 
p
);

23819 
	`sqlôe3DebugPrötf
("f˙é unknow¿%d %d %d\n", 
fd
, 
›
, 
s
);

23820  
s
;

23822 if–
p
->
l_ty≥
==
F_RDLCK
 ){

23823 
zTy≥
 = "RDLCK";

23824 }if–
p
->
l_ty≥
==
F_WRLCK
 ){

23825 
zTy≥
 = "WRLCK";

23826 }if–
p
->
l_ty≥
==
F_UNLCK
 ){

23827 
zTy≥
 = "UNLCK";

23829 
	`as£π
( 0 );

23831 
	`as£π
–
p
->
l_whí˚
==
SEEK_SET
 );

23832 
s
 = 
	`osF˙é
(
fd
, 
›
, 
p
);

23833 
ßvedEºno
 = 
î∫o
;

23834 
	`sqlôe3DebugPrötf
("fcntl %d %d %s %s %d %d %d %d\n",

23835 
thªadid
, 
fd
, 
zOpName
, 
zTy≥
, ()
p
->
l_°¨t
, (Ì->
l_Àn
,

23836 ()
p
->
l_pid
, 
s
);

23837 if–
s
==(-1Ë&& 
›
==
F_SETLK
 && (
p
->
l_ty≥
==
F_RDLCK
 ||Ö->l_ty≥==
F_WRLCK
) ){

23838 
Êock
 
l2
;

23839 
l2
 = *
p
;

23840 
	`osF˙é
(
fd
, 
F_GETLK
, &
l2
);

23841 if–
l2
.
l_ty≥
==
F_RDLCK
 ){

23842 
zTy≥
 = "RDLCK";

23843 }if–
l2
.
l_ty≥
==
F_WRLCK
 ){

23844 
zTy≥
 = "WRLCK";

23845 }if–
l2
.
l_ty≥
==
F_UNLCK
 ){

23846 
zTy≥
 = "UNLCK";

23848 
	`as£π
( 0 );

23850 
	`sqlôe3DebugPrötf
("fcntl-failure-reason: %s %d %d %d\n",

23851 
zTy≥
, ()
l2
.
l_°¨t
, (Ó2.
l_Àn
, (Ó2.
l_pid
);

23853 
î∫o
 = 
ßvedEºno
;

23854  
s
;

23856 #unde‡
osF˙é


23857 
	#osF˙é
 
lockTø˚


	)

23863 
	`robu°_·runˇã
(
h
, 
sqlôe3_öt64
 
sz
){

23864 
rc
;

23865 do{ 
rc
 = 
	`osFåunˇã
(
h
,
sz
); }Ñc<0 && 
î∫o
==
EINTR
 );

23866  
rc
;

23879 
	`sqlôeEº‹FromPosixEº‹
(
posixEº‹
, 
sqlôeIOEº
) {

23880 
posixEº‹
) {

23894  
SQLITE_OK
;

23897 
EAGAIN
:

23898 
ETIMEDOUT
:

23899 
EBUSY
:

23900 
EINTR
:

23901 
ENOLCK
:

23904  
SQLITE_BUSY
;

23906 
EACCES
:

23908 if–(
sqlôeIOEº
 =
SQLITE_IOERR_LOCK
) ||

23909 (
sqlôeIOEº
 =
SQLITE_IOERR_UNLOCK
) ||

23910 (
sqlôeIOEº
 =
SQLITE_IOERR_RDLOCK
) ||

23911 (
sqlôeIOEº
 =
SQLITE_IOERR_CHECKRESERVEDLOCK
) ){

23912  
SQLITE_BUSY
;

23915 
EPERM
:

23916  
SQLITE_PERM
;

23924 
EDEADLK
:

23925  
SQLITE_IOERR_BLOCKED
;

23928 #i‡
EOPNOTSUPP
!=
ENOTSUP


23929 
EOPNOTSUPP
:

23933 #ifde‡
ENOTSUP


23934 
ENOTSUP
:

23938 
EIO
:

23939 
EBADF
:

23940 
EINVAL
:

23941 
ENOTCONN
:

23942 
ENODEV
:

23943 
ENXIO
:

23944 
ENOENT
:

23945 #ifde‡
ESTALE


23946 
ESTALE
:

23948 
ENOSYS
:

23952  
sqlôeIOEº
;

23974 
	svxw‹ksFûeId
 {

23975 
vxw‹ksFûeId
 *
pNext
;

23976 
nRef
;

23977 
nName
;

23978 *
zC™⁄iˇlName
;

23981 #i‡
OS_VXWORKS


23986 
vxw‹ksFûeId
 *
vxw‹ksFûeLi°
 = 0;

24001 
	`vxw‹ksSim∂ifyName
(*
z
, 
n
){

24002 
i
, 
j
;

24003  
n
>1 && 
z
[n-1]=='/' ){Ç--; }

24004 
i
=
j
=0; i<
n
; i++){

24005 if–
z
[
i
]=='/' ){

24006 if–
z
[
i
+1]=='/' ) ;

24007 if–
z
[
i
+1]=='.' && i+2<
n
 && z[i+2]=='/' ){

24008 
i
 += 1;

24011 if–
z
[
i
+1]=='.' && i+3<
n
 && z[i+2]=='.' && z[i+3]=='/' ){

24012  
j
>0 && 
z
[j-1]!='/' ){ j--; }

24013 if–
j
>0 ){ j--; }

24014 
i
 += 2;

24018 
z
[
j
++] = z[
i
];

24020 
z
[
j
] = 0;

24021  
j
;

24035 
vxw‹ksFûeId
 *
	`vxw‹ksFödFûeId
(c⁄° *
zAbsﬁuãName
){

24036 
vxw‹ksFûeId
 *
pNew
;

24037 
vxw‹ksFûeId
 *
pC™did©e
;

24038 
n
;

24040 
	`as£π
–
zAbsﬁuãName
[0]=='/' );

24041 
n
 = ()
	`°æí
(
zAbsﬁuãName
);

24042 
pNew
 = 
	`sqlôe3_mÆloc
–(*pNewË+ (
n
+1) );

24043 if–
pNew
==0 )  0;

24044 
pNew
->
zC™⁄iˇlName
 = (*)&pNew[1];

24045 
	`mem˝y
(
pNew
->
zC™⁄iˇlName
, 
zAbsﬁuãName
, 
n
+1);

24046 
n
 = 
	`vxw‹ksSim∂ifyName
(
pNew
->
zC™⁄iˇlName
,Ç);

24052 
	`unixE¡îMuãx
();

24053 
pC™did©e
=
vxw‹ksFûeLi°
;ÖC™did©e;ÖC™did©eıC™did©e->
pNext
){

24054 if–
pC™did©e
->
nName
==
n


24055 && 
	`memcmp
(
pC™did©e
->
zC™⁄iˇlName
, 
pNew
->zC™⁄iˇlName, 
n
)==0

24057 
	`sqlôe3_‰ì
(
pNew
);

24058 
pC™did©e
->
nRef
++;

24059 
	`unixLóveMuãx
();

24060  
pC™did©e
;

24065 
pNew
->
nRef
 = 1;

24066 
pNew
->
nName
 = 
n
;

24067 
pNew
->
pNext
 = 
vxw‹ksFûeLi°
;

24068 
vxw‹ksFûeLi°
 = 
pNew
;

24069 
	`unixLóveMuãx
();

24070  
pNew
;

24077 
	`vxw‹ksRñó£FûeId
(
vxw‹ksFûeId
 *
pId
){

24078 
	`unixE¡îMuãx
();

24079 
	`as£π
–
pId
->
nRef
>0 );

24080 
pId
->
nRef
--;

24081 if–
pId
->
nRef
==0 ){

24082 
vxw‹ksFûeId
 **
µ
;

24083 
µ
=&
vxw‹ksFûeLi°
; *µ && *µ!=
pId
;Ö∞&((*µ)->
pNext
)){}

24084 
	`as£π
–*
µ
==
pId
 );

24085 *
µ
 = 
pId
->
pNext
;

24086 
	`sqlôe3_‰ì
(
pId
);

24088 
	`unixLóveMuãx
();

24189 
	sunixFûeId
 {

24190 
dev_t
 
dev
;

24191 #i‡
OS_VXWORKS


24192 
vxw‹ksFûeId
 *
pId
;

24194 
öo_t
 
öo
;

24207 
	sunixInodeInfo
 {

24208 
unixFûeId
 
fûeId
;

24209 
nSh¨ed
;

24210 
eFûeLock
;

24211 
bPro˚ssLock
;

24212 
nRef
;

24213 
unixShmNode
 *
pShmNode
;

24214 
nLock
;

24215 
UnixUnu£dFd
 *
pUnu£d
;

24216 
unixInodeInfo
 *
pNext
;

24217 
unixInodeInfo
 *
pPªv
;

24218 #i‡
SQLITE_ENABLE_LOCKING_STYLE


24219 
sh¨edByã
;

24221 #i‡
OS_VXWORKS


24222 
£m_t
 *
pSem
;

24223 
aSemName
[
MAX_PATHNAME
+2];

24230 
unixInodeInfo
 *
öodeLi°
 = 0;

24248 
	#unixLogEº‹
(
a
,
b
,
c
Ë
	`unixLogEº‹AtLöe
◊,b,c,
__LINE__
)

	)

24249 
	`unixLogEº‹AtLöe
(

24250 
îrcode
,

24251 c⁄° *
zFunc
,

24252 c⁄° *
zP©h
,

24253 
iLöe


24255 *
zEº
;

24256 
iEºno
 = 
î∫o
;

24262 #i‡
SQLITE_THREADSAFE
 && 
	`deföed
(
HAVE_STRERROR_R
)

24263 
aEº
[80];

24264 
	`mem£t
(
aEº
, 0, (aErr));

24265 
zEº
 = 
aEº
;

24279 #i‡
	`deföed
(
STRERROR_R_CHAR_P
Ë|| deföed(
__USE_GNU
)

24280 
zEº
 =

24282 
	`°ªº‹_r
(
iEºno
, 
aEº
, (aErr)-1);

24284 #ñi‡
SQLITE_THREADSAFE


24286 
zEº
 = "";

24289 
zEº
 = 
	`°ªº‹
(
iEºno
);

24292 if–
zP©h
==0 ) zPath = "";

24293 
	`sqlôe3_log
(
îrcode
,

24295 
iLöe
, 
iEºno
, 
zFunc
, 
zP©h
, 
zEº


24298  
îrcode
;

24314 
	`robu°_˛o£
(
unixFûe
 *
pFûe
, 
h
, 
löío
){

24315 if–
	`osClo£
(
h
) ){

24316 
	`unixLogEº‹AtLöe
(
SQLITE_IOERR_CLOSE
, "close",

24317 
pFûe
 ?ÖFûe->
zP©h
 : 0, 
löío
);

24324 
	`˛o£PídögFds
(
unixFûe
 *
pFûe
){

24325 
unixInodeInfo
 *
pInode
 = 
pFûe
->pInode;

24326 
UnixUnu£dFd
 *
p
;

24327 
UnixUnu£dFd
 *
pNext
;

24328 
p
=
pInode
->
pUnu£d
;Ö;Ö=
pNext
){

24329 
pNext
 = 
p
->pNext;

24330 
	`robu°_˛o£
(
pFûe
, 
p
->
fd
, 
__LINE__
);

24331 
	`sqlôe3_‰ì
(
p
);

24333 
pInode
->
pUnu£d
 = 0;

24342 
	`ªÀa£InodeInfo
(
unixFûe
 *
pFûe
){

24343 
unixInodeInfo
 *
pInode
 = 
pFûe
->pInode;

24344 
	`as£π
–
	`unixMuãxHñd
() );

24345 if–
	`ALWAYS
(
pInode
) ){

24346 
pInode
->
nRef
--;

24347 if–
pInode
->
nRef
==0 ){

24348 
	`as£π
–
pInode
->
pShmNode
==0 );

24349 
	`˛o£PídögFds
(
pFûe
);

24350 if–
pInode
->
pPªv
 ){

24351 
	`as£π
–
pInode
->
pPªv
->
pNext
==pInode );

24352 
pInode
->
pPªv
->
pNext
 =ÖInode->pNext;

24354 
	`as£π
–
öodeLi°
==
pInode
 );

24355 
öodeLi°
 = 
pInode
->
pNext
;

24357 if–
pInode
->
pNext
 ){

24358 
	`as£π
–
pInode
->
pNext
->
pPªv
==pInode );

24359 
pInode
->
pNext
->
pPªv
 =ÖInode->pPrev;

24361 
	`sqlôe3_‰ì
(
pInode
);

24376 
	`födInodeInfo
(

24377 
unixFûe
 *
pFûe
,

24378 
unixInodeInfo
 **
µInode


24380 
rc
;

24381 
fd
;

24382 
unixFûeId
 
fûeId
;

24383 
°©
 
°©buf
;

24384 
unixInodeInfo
 *
pInode
 = 0;

24386 
	`as£π
–
	`unixMuãxHñd
() );

24391 
fd
 = 
pFûe
->
h
;

24392 
rc
 = 
	`osF°©
(
fd
, &
°©buf
);

24393 if–
rc
!=0 ){

24394 
pFûe
->
œ°Eºno
 = 
î∫o
;

24395 #ifde‡
EOVERFLOW


24396 if–
pFûe
->
œ°Eºno
==
EOVERFLOW
 )  
SQLITE_NOLFS
;

24398  
SQLITE_IOERR
;

24401 #ifde‡
__APPLE__


24412 if–
°©buf
.
°_size
==0 && (
pFûe
->
fsFœgs
 & 
SQLITE_FSFLAGS_IS_MSDOS
)!=0 ){

24413 do{ 
rc
 = 
	`osWrôe
(
fd
, "S", 1); }Ñc<0 && 
î∫o
==
EINTR
 );

24414 if–
rc
!=1 ){

24415 
pFûe
->
œ°Eºno
 = 
î∫o
;

24416  
SQLITE_IOERR
;

24418 
rc
 = 
	`osF°©
(
fd
, &
°©buf
);

24419 if–
rc
!=0 ){

24420 
pFûe
->
œ°Eºno
 = 
î∫o
;

24421  
SQLITE_IOERR
;

24426 
	`mem£t
(&
fûeId
, 0, (fileId));

24427 
fûeId
.
dev
 = 
°©buf
.
°_dev
;

24428 #i‡
OS_VXWORKS


24429 
fûeId
.
pId
 = 
pFûe
->pId;

24431 
fûeId
.
öo
 = 
°©buf
.
°_öo
;

24433 
pInode
 = 
öodeLi°
;

24434  
pInode
 && 
	`memcmp
(&
fûeId
, &pInode->fileId, (fileId)) ){

24435 
pInode
 =ÖInode->
pNext
;

24437 if–
pInode
==0 ){

24438 
pInode
 = 
	`sqlôe3_mÆloc
( (*pInode) );

24439 if–
pInode
==0 ){

24440  
SQLITE_NOMEM
;

24442 
	`mem£t
(
pInode
, 0, (*pInode));

24443 
	`mem˝y
(&
pInode
->
fûeId
, &fileId, (fileId));

24444 
pInode
->
nRef
 = 1;

24445 
pInode
->
pNext
 = 
öodeLi°
;

24446 
pInode
->
pPªv
 = 0;

24447 if–
öodeLi°
 ) inodeLi°->
pPªv
 = 
pInode
;

24448 
öodeLi°
 = 
pInode
;

24450 
pInode
->
nRef
++;

24452 *
µInode
 = 
pInode
;

24453  
SQLITE_OK
;

24466 
	`vîifyDbFûe
(
unixFûe
 *
pFûe
){

24467 
°©
 
buf
;

24468 
rc
;

24469 if–
pFûe
->
˘æFœgs
 & 
UNIXFILE_WARNED
 ){

24474 
rc
 = 
	`osF°©
(
pFûe
->
h
, &
buf
);

24475 if–
rc
!=0 ){

24476 
	`sqlôe3_log
(
SQLITE_WARNING
, "ˇ¬Ÿ f°© db fûê%s", 
pFûe
->
zP©h
);

24477 
pFûe
->
˘æFœgs
 |
UNIXFILE_WARNED
;

24480 if–
buf
.
°_∆ök
==0 && (
pFûe
->
˘æFœgs
 & 
UNIXFILE_DELETE
)==0 ){

24481 
	`sqlôe3_log
(
SQLITE_WARNING
, "fûêu∆öked whûê›í: %s", 
pFûe
->
zP©h
);

24482 
pFûe
->
˘æFœgs
 |
UNIXFILE_WARNED
;

24485 if–
buf
.
°_∆ök
>1 ){

24486 
	`sqlôe3_log
(
SQLITE_WARNING
, "mu…ùÀÜök†tÿfûe: %s", 
pFûe
->
zP©h
);

24487 
pFûe
->
˘æFœgs
 |
UNIXFILE_WARNED
;

24490 if–
pFûe
->
pInode
!=0

24491 && ((
rc
 = 
	`osSèt
(
pFûe
->
zP©h
, &
buf
))!=0

24492 || 
buf
.
°_öo
!=
pFûe
->
pInode
->
fûeId
.
öo
)

24494 
	`sqlôe3_log
(
SQLITE_WARNING
, "fûêª«med whûê›í: %s", 
pFûe
->
zP©h
);

24495 
pFûe
->
˘æFœgs
 |
UNIXFILE_WARNED
;

24507 
	`unixCheckRe£rvedLock
(
sqlôe3_fûe
 *
id
, *
pResOut
){

24508 
rc
 = 
SQLITE_OK
;

24509 
ª£rved
 = 0;

24510 
unixFûe
 *
pFûe
 = (unixFûe*)
id
;

24512 
	`SimuœãIOEº‹
– 
SQLITE_IOERR_CHECKRESERVEDLOCK
; );

24514 
	`as£π
–
pFûe
 );

24515 
	`unixE¡îMuãx
();

24518 if–
pFûe
->
pInode
->
eFûeLock
>
SHARED_LOCK
 ){

24519 
ª£rved
 = 1;

24524 #i‚de‡
__DJGPP__


24525 if–!
ª£rved
 && !
pFûe
->
pInode
->
bPro˚ssLock
 ){

24526 
Êock
 
lock
;

24527 
lock
.
l_whí˚
 = 
SEEK_SET
;

24528 
lock
.
l_°¨t
 = 
RESERVED_BYTE
;

24529 
lock
.
l_Àn
 = 1;

24530 
lock
.
l_ty≥
 = 
F_WRLCK
;

24531 if–
	`osF˙é
(
pFûe
->
h
, 
F_GETLK
, &
lock
) ){

24532 
rc
 = 
SQLITE_IOERR_CHECKRESERVEDLOCK
;

24533 
pFûe
->
œ°Eºno
 = 
î∫o
;

24534 } if–
lock
.
l_ty≥
!=
F_UNLCK
 ){

24535 
ª£rved
 = 1;

24540 
	`unixLóveMuãx
();

24541 
	`OSTRACE
(("TEST WR-LOCK %d %d %d (unix)\n", 
pFûe
->
h
, 
rc
, 
ª£rved
));

24543 *
pResOut
 = 
ª£rved
;

24544  
rc
;

24566 
	`unixFûeLock
(
unixFûe
 *
pFûe
, 
Êock
 *
pLock
){

24567 
rc
;

24568 
unixInodeInfo
 *
pInode
 = 
pFûe
->pInode;

24569 
	`as£π
–
	`unixMuãxHñd
() );

24570 
	`as£π
–
pInode
!=0 );

24571 if–((
pFûe
->
˘æFœgs
 & 
UNIXFILE_EXCL
)!=0 || 
pInode
->
bPro˚ssLock
)

24572 && ((
pFûe
->
˘æFœgs
 & 
UNIXFILE_RDONLY
)==0)

24574 if–
pInode
->
bPro˚ssLock
==0 ){

24575 
Êock
 
lock
;

24576 
	`as£π
–
pInode
->
nLock
==0 );

24577 
lock
.
l_whí˚
 = 
SEEK_SET
;

24578 
lock
.
l_°¨t
 = 
SHARED_FIRST
;

24579 
lock
.
l_Àn
 = 
SHARED_SIZE
;

24580 
lock
.
l_ty≥
 = 
F_WRLCK
;

24581 
rc
 = 
	`osF˙é
(
pFûe
->
h
, 
F_SETLK
, &
lock
);

24582 if–
rc
<0 ) Ñc;

24583 
pInode
->
bPro˚ssLock
 = 1;

24584 
pInode
->
nLock
++;

24586 
rc
 = 0;

24589 
rc
 = 
	`osF˙é
(
pFûe
->
h
, 
F_SETLK
, 
pLock
);

24591  
rc
;

24618 
	`unixLock
(
sqlôe3_fûe
 *
id
, 
eFûeLock
){

24657 
rc
 = 
SQLITE_OK
;

24658 
unixFûe
 *
pFûe
 = (unixFûe*)
id
;

24659 
unixInodeInfo
 *
pInode
;

24660 
Êock
 
lock
;

24661 
tEºno
 = 0;

24663 
	`as£π
–
pFûe
 );

24664 
	`OSTRACE
(("LOCK %d %†wa†%s(%s,%dËpid=%d (unix)\n", 
pFûe
->
h
,

24665 
	`azFûeLock
(
eFûeLock
),ázFûeLock(
pFûe
->eFileLock),

24666 
	`azFûeLock
(
pFûe
->
pInode
->
eFûeLock
),ÖFûe->pInode->
nSh¨ed
 , 
	`gëpid
()));

24672 if–
pFûe
->
eFûeLock
>=eFileLock ){

24673 
	`OSTRACE
(("LOCK %d %†ok (Æªady hñdË(unix)\n", 
pFûe
->
h
,

24674 
	`azFûeLock
(
eFûeLock
)));

24675  
SQLITE_OK
;

24683 
	`as£π
–
pFûe
->
eFûeLock
!=
NO_LOCK
 ||ÉFûeLock==
SHARED_LOCK
 );

24684 
	`as£π
–
eFûeLock
!=
PENDING_LOCK
 );

24685 
	`as£π
–
eFûeLock
!=
RESERVED_LOCK
 || 
pFûe
->eFûeLock==
SHARED_LOCK
 );

24689 
	`unixE¡îMuãx
();

24690 
pInode
 = 
pFûe
->pInode;

24695 if–(
pFûe
->
eFûeLock
!=
pInode
->eFileLock &&

24696 (
pInode
->
eFûeLock
>=
PENDING_LOCK
 ||ÉFûeLock>
SHARED_LOCK
))

24698 
rc
 = 
SQLITE_BUSY
;

24699 
íd_lock
;

24706 if–
eFûeLock
==
SHARED_LOCK
 &&

24707 (
pInode
->
eFûeLock
==
SHARED_LOCK
 ||ÖInode->eFûeLock==
RESERVED_LOCK
) ){

24708 
	`as£π
–
eFûeLock
==
SHARED_LOCK
 );

24709 
	`as£π
–
pFûe
->
eFûeLock
==0 );

24710 
	`as£π
–
pInode
->
nSh¨ed
>0 );

24711 
pFûe
->
eFûeLock
 = 
SHARED_LOCK
;

24712 
pInode
->
nSh¨ed
++;

24713 
pInode
->
nLock
++;

24714 
íd_lock
;

24722 
lock
.
l_Àn
 = 1L;

24723 
lock
.
l_whí˚
 = 
SEEK_SET
;

24724 if–
eFûeLock
==
SHARED_LOCK


24725 || (
eFûeLock
==
EXCLUSIVE_LOCK
 && 
pFûe
->eFûeLock<
PENDING_LOCK
)

24727 
lock
.
l_ty≥
 = (
eFûeLock
==
SHARED_LOCK
?
F_RDLCK
:
F_WRLCK
);

24728 
lock
.
l_°¨t
 = 
PENDING_BYTE
;

24729 if–
	`unixFûeLock
(
pFûe
, &
lock
) ){

24730 
tEºno
 = 
î∫o
;

24731 
rc
 = 
	`sqlôeEº‹FromPosixEº‹
(
tEºno
, 
SQLITE_IOERR_LOCK
);

24732 if–
rc
!=
SQLITE_BUSY
 ){

24733 
pFûe
->
œ°Eºno
 = 
tEºno
;

24735 
íd_lock
;

24743 if–
eFûeLock
==
SHARED_LOCK
 ){

24744 
	`as£π
–
pInode
->
nSh¨ed
==0 );

24745 
	`as£π
–
pInode
->
eFûeLock
==0 );

24746 
	`as£π
–
rc
==
SQLITE_OK
 );

24749 
lock
.
l_°¨t
 = 
SHARED_FIRST
;

24750 
lock
.
l_Àn
 = 
SHARED_SIZE
;

24751 if–
	`unixFûeLock
(
pFûe
, &
lock
) ){

24752 
tEºno
 = 
î∫o
;

24753 
rc
 = 
	`sqlôeEº‹FromPosixEº‹
(
tEºno
, 
SQLITE_IOERR_LOCK
);

24757 
lock
.
l_°¨t
 = 
PENDING_BYTE
;

24758 
lock
.
l_Àn
 = 1L;

24759 
lock
.
l_ty≥
 = 
F_UNLCK
;

24760 if–
	`unixFûeLock
(
pFûe
, &
lock
Ë&& 
rc
==
SQLITE_OK
 ){

24762 
tEºno
 = 
î∫o
;

24763 
rc
 = 
SQLITE_IOERR_UNLOCK
;

24766 if–
rc
 ){

24767 if–
rc
!=
SQLITE_BUSY
 ){

24768 
pFûe
->
œ°Eºno
 = 
tEºno
;

24770 
íd_lock
;

24772 
pFûe
->
eFûeLock
 = 
SHARED_LOCK
;

24773 
pInode
->
nLock
++;

24774 
pInode
->
nSh¨ed
 = 1;

24776 }if–
eFûeLock
==
EXCLUSIVE_LOCK
 && 
pInode
->
nSh¨ed
>1 ){

24779 
rc
 = 
SQLITE_BUSY
;

24785 
	`as£π
–0!=
pFûe
->
eFûeLock
 );

24786 
lock
.
l_ty≥
 = 
F_WRLCK
;

24788 
	`as£π
–
eFûeLock
==
RESERVED_LOCK
 ||ÉFûeLock==
EXCLUSIVE_LOCK
 );

24789 if–
eFûeLock
==
RESERVED_LOCK
 ){

24790 
lock
.
l_°¨t
 = 
RESERVED_BYTE
;

24791 
lock
.
l_Àn
 = 1L;

24793 
lock
.
l_°¨t
 = 
SHARED_FIRST
;

24794 
lock
.
l_Àn
 = 
SHARED_SIZE
;

24797 if–
	`unixFûeLock
(
pFûe
, &
lock
) ){

24798 
tEºno
 = 
î∫o
;

24799 
rc
 = 
	`sqlôeEº‹FromPosixEº‹
(
tEºno
, 
SQLITE_IOERR_LOCK
);

24800 if–
rc
!=
SQLITE_BUSY
 ){

24801 
pFûe
->
œ°Eºno
 = 
tEºno
;

24807 #ifde‡
SQLITE_DEBUG


24813 if–
rc
==
SQLITE_OK


24814 && 
pFûe
->
eFûeLock
<=
SHARED_LOCK


24815 && 
eFûeLock
==
RESERVED_LOCK


24817 
pFûe
->
å™sC¡rChng
 = 0;

24818 
pFûe
->
dbUpd©e
 = 0;

24819 
pFûe
->
öN‹mÆWrôe
 = 1;

24824 if–
rc
==
SQLITE_OK
 ){

24825 
pFûe
->
eFûeLock
 =ÉFileLock;

24826 
pInode
->
eFûeLock
 =ÉFileLock;

24827 }if–
eFûeLock
==
EXCLUSIVE_LOCK
 ){

24828 
pFûe
->
eFûeLock
 = 
PENDING_LOCK
;

24829 
pInode
->
eFûeLock
 = 
PENDING_LOCK
;

24832 
íd_lock
:

24833 
	`unixLóveMuãx
();

24834 
	`OSTRACE
(("LOCK %d %†%†(unix)\n", 
pFûe
->
h
, 
	`azFûeLock
(
eFûeLock
),

24835 
rc
==
SQLITE_OK
 ? "ok" : "failed"));

24836  
rc
;

24843 
	`£tPídögFd
(
unixFûe
 *
pFûe
){

24844 
unixInodeInfo
 *
pInode
 = 
pFûe
->pInode;

24845 
UnixUnu£dFd
 *
p
 = 
pFûe
->
pUnu£d
;

24846 
p
->
pNext
 = 
pInode
->
pUnu£d
;

24847 
pInode
->
pUnu£d
 = 
p
;

24848 
pFûe
->
h
 = -1;

24849 
pFûe
->
pUnu£d
 = 0;

24865 
	`posixU∆ock
(
sqlôe3_fûe
 *
id
, 
eFûeLock
, 
h™dÀNFSU∆ock
){

24866 
unixFûe
 *
pFûe
 = (unixFûe*)
id
;

24867 
unixInodeInfo
 *
pInode
;

24868 
Êock
 
lock
;

24869 
rc
 = 
SQLITE_OK
;

24871 
	`as£π
–
pFûe
 );

24872 
	`OSTRACE
(("UNLOCK %d %d wa†%d(%d,%dËpid=%d (unix)\n", 
pFûe
->
h
, 
eFûeLock
,

24873 
pFûe
->
eFûeLock
,ÖFûe->
pInode
->eFûeLock,ÖFûe->pInode->
nSh¨ed
,

24874 
	`gëpid
()));

24876 
	`as£π
–
eFûeLock
<=
SHARED_LOCK
 );

24877 if–
pFûe
->
eFûeLock
<=eFileLock ){

24878  
SQLITE_OK
;

24880 
	`unixE¡îMuãx
();

24881 
pInode
 = 
pFûe
->pInode;

24882 
	`as£π
–
pInode
->
nSh¨ed
!=0 );

24883 if–
pFûe
->
eFûeLock
>
SHARED_LOCK
 ){

24884 
	`as£π
–
pInode
->
eFûeLock
==
pFûe
->eFileLock );

24886 #ifde‡
SQLITE_DEBUG


24895 
pFûe
->
öN‹mÆWrôe
 = 0;

24907 if–
eFûeLock
==
SHARED_LOCK
 ){

24909 #i‡!
	`deföed
(
__APPLE__
Ë|| !
SQLITE_ENABLE_LOCKING_STYLE


24910 ()
h™dÀNFSU∆ock
;

24911 
	`as£π
–
h™dÀNFSU∆ock
==0 );

24913 #i‡
	`deföed
(
__APPLE__
Ë&& 
SQLITE_ENABLE_LOCKING_STYLE


24914 if–
h™dÀNFSU∆ock
 ){

24915 
tEºno
;

24916 
off_t
 
divSize
 = 
SHARED_SIZE
 - 1;

24918 
lock
.
l_ty≥
 = 
F_UNLCK
;

24919 
lock
.
l_whí˚
 = 
SEEK_SET
;

24920 
lock
.
l_°¨t
 = 
SHARED_FIRST
;

24921 
lock
.
l_Àn
 = 
divSize
;

24922 if–
	`unixFûeLock
(
pFûe
, &
lock
)==(-1) ){

24923 
tEºno
 = 
î∫o
;

24924 
rc
 = 
SQLITE_IOERR_UNLOCK
;

24925 if–
	`IS_LOCK_ERROR
(
rc
) ){

24926 
pFûe
->
œ°Eºno
 = 
tEºno
;

24928 
íd_u∆ock
;

24930 
lock
.
l_ty≥
 = 
F_RDLCK
;

24931 
lock
.
l_whí˚
 = 
SEEK_SET
;

24932 
lock
.
l_°¨t
 = 
SHARED_FIRST
;

24933 
lock
.
l_Àn
 = 
divSize
;

24934 if–
	`unixFûeLock
(
pFûe
, &
lock
)==(-1) ){

24935 
tEºno
 = 
î∫o
;

24936 
rc
 = 
	`sqlôeEº‹FromPosixEº‹
(
tEºno
, 
SQLITE_IOERR_RDLOCK
);

24937 if–
	`IS_LOCK_ERROR
(
rc
) ){

24938 
pFûe
->
œ°Eºno
 = 
tEºno
;

24940 
íd_u∆ock
;

24942 
lock
.
l_ty≥
 = 
F_UNLCK
;

24943 
lock
.
l_whí˚
 = 
SEEK_SET
;

24944 
lock
.
l_°¨t
 = 
SHARED_FIRST
+
divSize
;

24945 
lock
.
l_Àn
 = 
SHARED_SIZE
-
divSize
;

24946 if–
	`unixFûeLock
(
pFûe
, &
lock
)==(-1) ){

24947 
tEºno
 = 
î∫o
;

24948 
rc
 = 
SQLITE_IOERR_UNLOCK
;

24949 if–
	`IS_LOCK_ERROR
(
rc
) ){

24950 
pFûe
->
œ°Eºno
 = 
tEºno
;

24952 
íd_u∆ock
;

24957 
lock
.
l_ty≥
 = 
F_RDLCK
;

24958 
lock
.
l_whí˚
 = 
SEEK_SET
;

24959 
lock
.
l_°¨t
 = 
SHARED_FIRST
;

24960 
lock
.
l_Àn
 = 
SHARED_SIZE
;

24961 if–
	`unixFûeLock
(
pFûe
, &
lock
) ){

24968 
rc
 = 
SQLITE_IOERR_RDLOCK
;

24969 
pFûe
->
œ°Eºno
 = 
î∫o
;

24970 
íd_u∆ock
;

24974 
lock
.
l_ty≥
 = 
F_UNLCK
;

24975 
lock
.
l_whí˚
 = 
SEEK_SET
;

24976 
lock
.
l_°¨t
 = 
PENDING_BYTE
;

24977 
lock
.
l_Àn
 = 2L; 
	`as£π
–
PENDING_BYTE
+1==
RESERVED_BYTE
 );

24978 if–
	`unixFûeLock
(
pFûe
, &
lock
)==0 ){

24979 
pInode
->
eFûeLock
 = 
SHARED_LOCK
;

24981 
rc
 = 
SQLITE_IOERR_UNLOCK
;

24982 
pFûe
->
œ°Eºno
 = 
î∫o
;

24983 
íd_u∆ock
;

24986 if–
eFûeLock
==
NO_LOCK
 ){

24991 
pInode
->
nSh¨ed
--;

24992 if–
pInode
->
nSh¨ed
==0 ){

24993 
lock
.
l_ty≥
 = 
F_UNLCK
;

24994 
lock
.
l_whí˚
 = 
SEEK_SET
;

24995 
lock
.
l_°¨t
 =Üock.
l_Àn
 = 0L;

24996 if–
	`unixFûeLock
(
pFûe
, &
lock
)==0 ){

24997 
pInode
->
eFûeLock
 = 
NO_LOCK
;

24999 
rc
 = 
SQLITE_IOERR_UNLOCK
;

25000 
pFûe
->
œ°Eºno
 = 
î∫o
;

25001 
pInode
->
eFûeLock
 = 
NO_LOCK
;

25002 
pFûe
->
eFûeLock
 = 
NO_LOCK
;

25010 
pInode
->
nLock
--;

25011 
	`as£π
–
pInode
->
nLock
>=0 );

25012 if–
pInode
->
nLock
==0 ){

25013 
	`˛o£PídögFds
(
pFûe
);

25017 
íd_u∆ock
:

25018 
	`unixLóveMuãx
();

25019 if–
rc
==
SQLITE_OK
 ) 
pFûe
->
eFûeLock
 =ÉFileLock;

25020  
rc
;

25030 
	`unixU∆ock
(
sqlôe3_fûe
 *
id
, 
eFûeLock
){

25031 
	`as£π
–
eFûeLock
==
SHARED_LOCK
 || ((
unixFûe
 *)
id
)->
nFëchOut
==0 );

25032  
	`posixU∆ock
(
id
, 
eFûeLock
, 0);

25035 #i‡
SQLITE_MAX_MMAP_SIZE
>0

25036 
	`unixM≠fûe
(
unixFûe
 *
pFd
, 
i64
 
nByã
);

25037 
	`unixUnm≠fûe
(
unixFûe
 *
pFd
);

25050 
	`˛o£UnixFûe
(
sqlôe3_fûe
 *
id
){

25051 
unixFûe
 *
pFûe
 = (unixFûe*)
id
;

25052 #i‡
SQLITE_MAX_MMAP_SIZE
>0

25053 
	`unixUnm≠fûe
(
pFûe
);

25055 if–
pFûe
->
h
>=0 ){

25056 
	`robu°_˛o£
(
pFûe
,ÖFûe->
h
, 
__LINE__
);

25057 
pFûe
->
h
 = -1;

25059 #i‡
OS_VXWORKS


25060 if–
pFûe
->
pId
 ){

25061 if–
pFûe
->
˘æFœgs
 & 
UNIXFILE_DELETE
 ){

25062 
	`osU∆ök
(
pFûe
->
pId
->
zC™⁄iˇlName
);

25064 
	`vxw‹ksRñó£FûeId
(
pFûe
->
pId
);

25065 
pFûe
->
pId
 = 0;

25068 
	`OSTRACE
(("CLOSE %-3d\n", 
pFûe
->
h
));

25069 
	`O≥nCou¡î
(-1);

25070 
	`sqlôe3_‰ì
(
pFûe
->
pUnu£d
);

25071 
	`mem£t
(
pFûe
, 0, (
unixFûe
));

25072  
SQLITE_OK
;

25078 
	`unixClo£
(
sqlôe3_fûe
 *
id
){

25079 
rc
 = 
SQLITE_OK
;

25080 
unixFûe
 *
pFûe
 = (unixFûê*)
id
;

25081 
	`vîifyDbFûe
(
pFûe
);

25082 
	`unixU∆ock
(
id
, 
NO_LOCK
);

25083 
	`unixE¡îMuãx
();

25088 
	`as£π
–
pFûe
->
pInode
->
nLock
>0 ||ÖFûe->pInode->
bPro˚ssLock
==0 );

25089 if–
	`ALWAYS
(
pFûe
->
pInode
Ë&&ÖFûe->pInode->
nLock
 ){

25095 
	`£tPídögFd
(
pFûe
);

25097 
	`ªÀa£InodeInfo
(
pFûe
);

25098 
rc
 = 
	`˛o£UnixFûe
(
id
);

25099 
	`unixLóveMuãx
();

25100  
rc
;

25123 
	`nﬁockCheckRe£rvedLock
(
sqlôe3_fûe
 *
NŸU£d
, *
pResOut
){

25124 
	`UNUSED_PARAMETER
(
NŸU£d
);

25125 *
pResOut
 = 0;

25126  
SQLITE_OK
;

25128 
	`nﬁockLock
(
sqlôe3_fûe
 *
NŸU£d
, 
NŸU£d2
){

25129 
	`UNUSED_PARAMETER2
(
NŸU£d
, 
NŸU£d2
);

25130  
SQLITE_OK
;

25132 
	`nﬁockU∆ock
(
sqlôe3_fûe
 *
NŸU£d
, 
NŸU£d2
){

25133 
	`UNUSED_PARAMETER2
(
NŸU£d
, 
NŸU£d2
);

25134  
SQLITE_OK
;

25140 
	`nﬁockClo£
(
sqlôe3_fûe
 *
id
) {

25141  
	`˛o£UnixFûe
(
id
);

25173 
	#DOTLOCK_SUFFIX
 ".lock"

	)

25185 
	`dŸlockCheckRe£rvedLock
(
sqlôe3_fûe
 *
id
, *
pResOut
) {

25186 
rc
 = 
SQLITE_OK
;

25187 
ª£rved
 = 0;

25188 
unixFûe
 *
pFûe
 = (unixFûe*)
id
;

25190 
	`SimuœãIOEº‹
– 
SQLITE_IOERR_CHECKRESERVEDLOCK
; );

25192 
	`as£π
–
pFûe
 );

25195 if–
pFûe
->
eFûeLock
>
SHARED_LOCK
 ){

25198 
ª£rved
 = 1;

25201 c⁄° *
zLockFûe
 = (c⁄° *)
pFûe
->
lockögC⁄ãxt
;

25202 
ª£rved
 = 
	`osAc˚ss
(
zLockFûe
, 0)==0;

25204 
	`OSTRACE
(("TEST WR-LOCK %d %d %d (dŸlock)\n", 
pFûe
->
h
, 
rc
, 
ª£rved
));

25205 *
pResOut
 = 
ª£rved
;

25206  
rc
;

25236 
	`dŸlockLock
(
sqlôe3_fûe
 *
id
, 
eFûeLock
) {

25237 
unixFûe
 *
pFûe
 = (unixFûe*)
id
;

25238 *
zLockFûe
 = (*)
pFûe
->
lockögC⁄ãxt
;

25239 
rc
 = 
SQLITE_OK
;

25245 if–
pFûe
->
eFûeLock
 > 
NO_LOCK
 ){

25246 
pFûe
->
eFûeLock
 =ÉFileLock;

25248 #ifde‡
HAVE_UTIME


25249 
	`utime
(
zLockFûe
, 
NULL
);

25251 
	`utimes
(
zLockFûe
, 
NULL
);

25253  
SQLITE_OK
;

25257 
rc
 = 
	`osMkdú
(
zLockFûe
, 0777);

25258 if–
rc
<0 ){

25260 
tEºno
 = 
î∫o
;

25261 if–
EEXIST
 =
tEºno
 ){

25262 
rc
 = 
SQLITE_BUSY
;

25264 
rc
 = 
	`sqlôeEº‹FromPosixEº‹
(
tEºno
, 
SQLITE_IOERR_LOCK
);

25265 if–
	`IS_LOCK_ERROR
(
rc
) ){

25266 
pFûe
->
œ°Eºno
 = 
tEºno
;

25269  
rc
;

25273 
pFûe
->
eFûeLock
 =ÉFileLock;

25274  
rc
;

25286 
	`dŸlockU∆ock
(
sqlôe3_fûe
 *
id
, 
eFûeLock
) {

25287 
unixFûe
 *
pFûe
 = (unixFûe*)
id
;

25288 *
zLockFûe
 = (*)
pFûe
->
lockögC⁄ãxt
;

25289 
rc
;

25291 
	`as£π
–
pFûe
 );

25292 
	`OSTRACE
(("UNLOCK %d %d wa†%dÖid=%d (dŸlock)\n", 
pFûe
->
h
, 
eFûeLock
,

25293 
pFûe
->
eFûeLock
, 
	`gëpid
()));

25294 
	`as£π
–
eFûeLock
<=
SHARED_LOCK
 );

25297 if–
pFûe
->
eFûeLock
==eFileLock ){

25298  
SQLITE_OK
;

25304 if–
eFûeLock
==
SHARED_LOCK
 ){

25305 
pFûe
->
eFûeLock
 = 
SHARED_LOCK
;

25306  
SQLITE_OK
;

25310 
	`as£π
–
eFûeLock
==
NO_LOCK
 );

25311 
rc
 = 
	`osRmdú
(
zLockFûe
);

25312 if–
rc
<0 && 
î∫o
==
ENOTDIR
 )Ñ¯
	`osU∆ök
(
zLockFûe
);

25313 if–
rc
<0 ){

25314 
tEºno
 = 
î∫o
;

25315 
rc
 = 0;

25316 if–
ENOENT
 !
tEºno
 ){

25317 
rc
 = 
SQLITE_IOERR_UNLOCK
;

25319 if–
	`IS_LOCK_ERROR
(
rc
) ){

25320 
pFûe
->
œ°Eºno
 = 
tEºno
;

25322  
rc
;

25324 
pFûe
->
eFûeLock
 = 
NO_LOCK
;

25325  
SQLITE_OK
;

25331 
	`dŸlockClo£
(
sqlôe3_fûe
 *
id
) {

25332 
rc
 = 
SQLITE_OK
;

25333 if–
id
 ){

25334 
unixFûe
 *
pFûe
 = (unixFûe*)
id
;

25335 
	`dŸlockU∆ock
(
id
, 
NO_LOCK
);

25336 
	`sqlôe3_‰ì
(
pFûe
->
lockögC⁄ãxt
);

25337 
rc
 = 
	`˛o£UnixFûe
(
id
);

25339  
rc
;

25359 #i‡
SQLITE_ENABLE_LOCKING_STYLE
 && !
OS_VXWORKS


25364 #ifde‡
EINTR


25365 
	`robu°_Êock
(
fd
, 
›
){

25366 
rc
;

25367 do{ 
rc
 = 
	`Êock
(
fd
,
›
); }Ñc<0 && 
î∫o
==
EINTR
 );

25368  
rc
;

25371 
	#robu°_Êock
(
a
,
b
Ë
	`Êock
◊,b)

	)

25381 
	`ÊockCheckRe£rvedLock
(
sqlôe3_fûe
 *
id
, *
pResOut
){

25382 
rc
 = 
SQLITE_OK
;

25383 
ª£rved
 = 0;

25384 
unixFûe
 *
pFûe
 = (unixFûe*)
id
;

25386 
	`SimuœãIOEº‹
– 
SQLITE_IOERR_CHECKRESERVEDLOCK
; );

25388 
	`as£π
–
pFûe
 );

25391 if–
pFûe
->
eFûeLock
>
SHARED_LOCK
 ){

25392 
ª£rved
 = 1;

25396 if–!
ª£rved
 ){

25398 
Ãc
 = 
	`robu°_Êock
(
pFûe
->
h
, 
LOCK_EX
 | 
LOCK_NB
);

25399 if–!
Ãc
 ){

25401 
Ãc
 = 
	`robu°_Êock
(
pFûe
->
h
, 
LOCK_UN
);

25402 i‡–
Ãc
 ) {

25403 
tEºno
 = 
î∫o
;

25405 
Ãc
 = 
SQLITE_IOERR_UNLOCK
;

25406 if–
	`IS_LOCK_ERROR
(
Ãc
) ){

25407 
pFûe
->
œ°Eºno
 = 
tEºno
;

25408 
rc
 = 
Ãc
;

25412 
tEºno
 = 
î∫o
;

25413 
ª£rved
 = 1;

25415 
Ãc
 = 
	`sqlôeEº‹FromPosixEº‹
(
tEºno
, 
SQLITE_IOERR_LOCK
);

25416 if–
	`IS_LOCK_ERROR
(
Ãc
) ){

25417 
pFûe
->
œ°Eºno
 = 
tEºno
;

25418 
rc
 = 
Ãc
;

25422 
	`OSTRACE
(("TEST WR-LOCK %d %d %d (Êock)\n", 
pFûe
->
h
, 
rc
, 
ª£rved
));

25424 #ifde‡
SQLITE_IGNORE_FLOCK_LOCK_ERRORS


25425 if–(
rc
 & 
SQLITE_IOERR
) == SQLITE_IOERR ){

25426 
rc
 = 
SQLITE_OK
;

25427 
ª£rved
=1;

25430 *
pResOut
 = 
ª£rved
;

25431  
rc
;

25463 
	`ÊockLock
(
sqlôe3_fûe
 *
id
, 
eFûeLock
) {

25464 
rc
 = 
SQLITE_OK
;

25465 
unixFûe
 *
pFûe
 = (unixFûe*)
id
;

25467 
	`as£π
–
pFûe
 );

25471 i‡(
pFûe
->
eFûeLock
 > 
NO_LOCK
) {

25472 
pFûe
->
eFûeLock
 =ÉFileLock;

25473  
SQLITE_OK
;

25478 i‡(
	`robu°_Êock
(
pFûe
->
h
, 
LOCK_EX
 | 
LOCK_NB
)) {

25479 
tEºno
 = 
î∫o
;

25481 
rc
 = 
	`sqlôeEº‹FromPosixEº‹
(
tEºno
, 
SQLITE_IOERR_LOCK
);

25482 if–
	`IS_LOCK_ERROR
(
rc
) ){

25483 
pFûe
->
œ°Eºno
 = 
tEºno
;

25487 
pFûe
->
eFûeLock
 =ÉFileLock;

25489 
	`OSTRACE
(("LOCK %d %†%†(Êock)\n", 
pFûe
->
h
, 
	`azFûeLock
(
eFûeLock
),

25490 
rc
==
SQLITE_OK
 ? "ok" : "failed"));

25491 #ifde‡
SQLITE_IGNORE_FLOCK_LOCK_ERRORS


25492 if–(
rc
 & 
SQLITE_IOERR
) == SQLITE_IOERR ){

25493 
rc
 = 
SQLITE_BUSY
;

25496  
rc
;

25507 
	`ÊockU∆ock
(
sqlôe3_fûe
 *
id
, 
eFûeLock
) {

25508 
unixFûe
 *
pFûe
 = (unixFûe*)
id
;

25510 
	`as£π
–
pFûe
 );

25511 
	`OSTRACE
(("UNLOCK %d %d wa†%dÖid=%d (Êock)\n", 
pFûe
->
h
, 
eFûeLock
,

25512 
pFûe
->
eFûeLock
, 
	`gëpid
()));

25513 
	`as£π
–
eFûeLock
<=
SHARED_LOCK
 );

25516 if–
pFûe
->
eFûeLock
==eFileLock ){

25517  
SQLITE_OK
;

25521 i‡(
eFûeLock
==
SHARED_LOCK
) {

25522 
pFûe
->
eFûeLock
 =ÉFileLock;

25523  
SQLITE_OK
;

25527 if–
	`robu°_Êock
(
pFûe
->
h
, 
LOCK_UN
) ){

25528 #ifde‡
SQLITE_IGNORE_FLOCK_LOCK_ERRORS


25529  
SQLITE_OK
;

25531  
SQLITE_IOERR_UNLOCK
;

25533 
pFûe
->
eFûeLock
 = 
NO_LOCK
;

25534  
SQLITE_OK
;

25541 
	`ÊockClo£
(
sqlôe3_fûe
 *
id
) {

25542 
rc
 = 
SQLITE_OK
;

25543 if–
id
 ){

25544 
	`ÊockU∆ock
(
id
, 
NO_LOCK
);

25545 
rc
 = 
	`˛o£UnixFûe
(
id
);

25547  
rc
;

25565 #i‡
OS_VXWORKS


25573 
	`£mCheckRe£rvedLock
(
sqlôe3_fûe
 *
id
, *
pResOut
) {

25574 
rc
 = 
SQLITE_OK
;

25575 
ª£rved
 = 0;

25576 
unixFûe
 *
pFûe
 = (unixFûe*)
id
;

25578 
	`SimuœãIOEº‹
– 
SQLITE_IOERR_CHECKRESERVEDLOCK
; );

25580 
	`as£π
–
pFûe
 );

25583 if–
pFûe
->
eFûeLock
>
SHARED_LOCK
 ){

25584 
ª£rved
 = 1;

25588 if–!
ª£rved
 ){

25589 
£m_t
 *
pSem
 = 
pFûe
->
pInode
->pSem;

25590 
°©
 
°©Buf
;

25592 if–
	`£m_åywaô
(
pSem
)==-1 ){

25593 
tEºno
 = 
î∫o
;

25594 if–
EAGAIN
 !
tEºno
 ){

25595 
rc
 = 
	`sqlôeEº‹FromPosixEº‹
(
tEºno
, 
SQLITE_IOERR_CHECKRESERVEDLOCK
);

25596 
pFûe
->
œ°Eºno
 = 
tEºno
;

25599 
ª£rved
 = (
pFûe
->
eFûeLock
 < 
SHARED_LOCK
);

25603 
	`£m_po°
(
pSem
);

25606 
	`OSTRACE
(("TEST WR-LOCK %d %d %d (£m)\n", 
pFûe
->
h
, 
rc
, 
ª£rved
));

25608 *
pResOut
 = 
ª£rved
;

25609  
rc
;

25641 
	`£mLock
(
sqlôe3_fûe
 *
id
, 
eFûeLock
) {

25642 
unixFûe
 *
pFûe
 = (unixFûe*)
id
;

25643 
fd
;

25644 
£m_t
 *
pSem
 = 
pFûe
->
pInode
->pSem;

25645 
rc
 = 
SQLITE_OK
;

25649 i‡(
pFûe
->
eFûeLock
 > 
NO_LOCK
) {

25650 
pFûe
->
eFûeLock
 =ÉFileLock;

25651 
rc
 = 
SQLITE_OK
;

25652 
£m_íd_lock
;

25656 if–
	`£m_åywaô
(
pSem
)==-1 ){

25657 
rc
 = 
SQLITE_BUSY
;

25658 
£m_íd_lock
;

25662 
pFûe
->
eFûeLock
 =ÉFileLock;

25664 
£m_íd_lock
:

25665  
rc
;

25675 
	`£mU∆ock
(
sqlôe3_fûe
 *
id
, 
eFûeLock
) {

25676 
unixFûe
 *
pFûe
 = (unixFûe*)
id
;

25677 
£m_t
 *
pSem
 = 
pFûe
->
pInode
->pSem;

25679 
	`as£π
–
pFûe
 );

25680 
	`as£π
–
pSem
 );

25681 
	`OSTRACE
(("UNLOCK %d %d wa†%dÖid=%d (£m)\n", 
pFûe
->
h
, 
eFûeLock
,

25682 
pFûe
->
eFûeLock
, 
	`gëpid
()));

25683 
	`as£π
–
eFûeLock
<=
SHARED_LOCK
 );

25686 if–
pFûe
->
eFûeLock
==eFileLock ){

25687  
SQLITE_OK
;

25691 i‡(
eFûeLock
==
SHARED_LOCK
) {

25692 
pFûe
->
eFûeLock
 =ÉFileLock;

25693  
SQLITE_OK
;

25697 i‡–
	`£m_po°
(
pSem
)==-1 ) {

25698 
rc
, 
tEºno
 = 
î∫o
;

25699 
rc
 = 
	`sqlôeEº‹FromPosixEº‹
(
tEºno
, 
SQLITE_IOERR_UNLOCK
);

25700 if–
	`IS_LOCK_ERROR
(
rc
) ){

25701 
pFûe
->
œ°Eºno
 = 
tEºno
;

25703  
rc
;

25705 
pFûe
->
eFûeLock
 = 
NO_LOCK
;

25706  
SQLITE_OK
;

25712 
	`£mClo£
(
sqlôe3_fûe
 *
id
) {

25713 if–
id
 ){

25714 
unixFûe
 *
pFûe
 = (unixFûe*)
id
;

25715 
	`£mU∆ock
(
id
, 
NO_LOCK
);

25716 
	`as£π
–
pFûe
 );

25717 
	`unixE¡îMuãx
();

25718 
	`ªÀa£InodeInfo
(
pFûe
);

25719 
	`unixLóveMuãx
();

25720 
	`˛o£UnixFûe
(
id
);

25722  
SQLITE_OK
;

25743 #i‡
	`deföed
(
__APPLE__
Ë&& 
SQLITE_ENABLE_LOCKING_STYLE


25747 
aÂLockögC⁄ãxt
 
	taÂLockögC⁄ãxt
;

25748 
	saÂLockögC⁄ãxt
 {

25749 
ª£rved
;

25750 c⁄° *
dbP©h
;

25753 
	sByãR™geLockPB2


25755 
off£t
;

25756 
Àngth
;

25757 
ªtR™geSèπ
;

25758 
unLockFœg
;

25759 
°¨tEndFœg
;

25760 
fd
;

25763 
	#aÂfsByãR™geLock2FSCTL
 
	`_IOWR
('z', 23, 
ByãR™geLockPB2
)

	)

25771 
	`aÂSëLock
(

25772 c⁄° *
∑th
,

25773 
unixFûe
 *
pFûe
,

25774 
off£t
,

25775 
Àngth
,

25776 
£tLockFœg


25778 
ByãR™geLockPB2
 
pb
;

25779 
îr
;

25781 
pb
.
unLockFœg
 = 
£tLockFœg
 ? 0 : 1;

25782 
pb
.
°¨tEndFœg
 = 0;

25783 
pb
.
off£t
 = offset;

25784 
pb
.
Àngth
 =Üength;

25785 
pb
.
fd
 = 
pFûe
->
h
;

25787 
	`OSTRACE
(("AFPSETLOCK [%s] for %d%s inÑange %llx:%llx\n",

25788 (
£tLockFœg
?"ON":"OFF"), 
pFûe
->
h
, (
pb
.
fd
==-1?"[testval-1]":""),

25789 
off£t
, 
Àngth
));

25790 
îr
 = 
	`fs˘l
(
∑th
, 
aÂfsByãR™geLock2FSCTL
, &
pb
, 0);

25791 i‡–
îr
==-1 ) {

25792 
rc
;

25793 
tEºno
 = 
î∫o
;

25794 
	`OSTRACE
(("AFPSETLOCK failedÅo fsctl() '%s' %d %s\n",

25795 
∑th
, 
tEºno
, 
	`°ªº‹
(tErrno)));

25796 #ifde‡
SQLITE_IGNORE_AFP_LOCK_ERRORS


25797 
rc
 = 
SQLITE_BUSY
;

25799 
rc
 = 
	`sqlôeEº‹FromPosixEº‹
(
tEºno
,

25800 
£tLockFœg
 ? 
SQLITE_IOERR_LOCK
 : 
SQLITE_IOERR_UNLOCK
);

25802 if–
	`IS_LOCK_ERROR
(
rc
) ){

25803 
pFûe
->
œ°Eºno
 = 
tEºno
;

25805  
rc
;

25807  
SQLITE_OK
;

25817 
	`aÂCheckRe£rvedLock
(
sqlôe3_fûe
 *
id
, *
pResOut
){

25818 
rc
 = 
SQLITE_OK
;

25819 
ª£rved
 = 0;

25820 
unixFûe
 *
pFûe
 = (unixFûe*)
id
;

25821 
aÂLockögC⁄ãxt
 *
c⁄ãxt
;

25823 
	`SimuœãIOEº‹
– 
SQLITE_IOERR_CHECKRESERVEDLOCK
; );

25825 
	`as£π
–
pFûe
 );

25826 
c⁄ãxt
 = (
aÂLockögC⁄ãxt
 *Ë
pFûe
->
lockögC⁄ãxt
;

25827 if–
c⁄ãxt
->
ª£rved
 ){

25828 *
pResOut
 = 1;

25829  
SQLITE_OK
;

25831 
	`unixE¡îMuãx
();

25834 if–
pFûe
->
pInode
->
eFûeLock
>
SHARED_LOCK
 ){

25835 
ª£rved
 = 1;

25840 if–!
ª£rved
 ){

25842 
Ãc
 = 
	`aÂSëLock
(
c⁄ãxt
->
dbP©h
, 
pFûe
, 
RESERVED_BYTE
, 1,1);

25843 if–
SQLITE_OK
==
Ãc
 ){

25846 
Ãc
 = 
	`aÂSëLock
(
c⁄ãxt
->
dbP©h
, 
pFûe
, 
RESERVED_BYTE
, 1, 0);

25849 
ª£rved
 = 1;

25851 if–
	`IS_LOCK_ERROR
(
Ãc
) ){

25852 
rc
=
Ãc
;

25856 
	`unixLóveMuãx
();

25857 
	`OSTRACE
(("TEST WR-LOCK %d %d %d (aÂ)\n", 
pFûe
->
h
, 
rc
, 
ª£rved
));

25859 *
pResOut
 = 
ª£rved
;

25860  
rc
;

25887 
	`aÂLock
(
sqlôe3_fûe
 *
id
, 
eFûeLock
){

25888 
rc
 = 
SQLITE_OK
;

25889 
unixFûe
 *
pFûe
 = (unixFûe*)
id
;

25890 
unixInodeInfo
 *
pInode
 = 
pFûe
->pInode;

25891 
aÂLockögC⁄ãxt
 *
c⁄ãxt
 = (aÂLockögC⁄ãxà*Ë
pFûe
->
lockögC⁄ãxt
;

25893 
	`as£π
–
pFûe
 );

25894 
	`OSTRACE
(("LOCK %d %†wa†%s(%s,%dËpid=%d (aÂ)\n", 
pFûe
->
h
,

25895 
	`azFûeLock
(
eFûeLock
),ázFûeLock(
pFûe
->eFileLock),

25896 
	`azFûeLock
(
pInode
->
eFûeLock
),ÖInode->
nSh¨ed
 , 
	`gëpid
()));

25902 if–
pFûe
->
eFûeLock
>=eFileLock ){

25903 
	`OSTRACE
(("LOCK %d %†ok (Æªady hñdË◊Â)\n", 
pFûe
->
h
,

25904 
	`azFûeLock
(
eFûeLock
)));

25905  
SQLITE_OK
;

25913 
	`as£π
–
pFûe
->
eFûeLock
!=
NO_LOCK
 ||ÉFûeLock==
SHARED_LOCK
 );

25914 
	`as£π
–
eFûeLock
!=
PENDING_LOCK
 );

25915 
	`as£π
–
eFûeLock
!=
RESERVED_LOCK
 || 
pFûe
->eFûeLock==
SHARED_LOCK
 );

25919 
	`unixE¡îMuãx
();

25920 
pInode
 = 
pFûe
->pInode;

25925 if–(
pFûe
->
eFûeLock
!=
pInode
->eFileLock &&

25926 (
pInode
->
eFûeLock
>=
PENDING_LOCK
 ||ÉFûeLock>
SHARED_LOCK
))

25928 
rc
 = 
SQLITE_BUSY
;

25929 
aÂ_íd_lock
;

25936 if–
eFûeLock
==
SHARED_LOCK
 &&

25937 (
pInode
->
eFûeLock
==
SHARED_LOCK
 ||ÖInode->eFûeLock==
RESERVED_LOCK
) ){

25938 
	`as£π
–
eFûeLock
==
SHARED_LOCK
 );

25939 
	`as£π
–
pFûe
->
eFûeLock
==0 );

25940 
	`as£π
–
pInode
->
nSh¨ed
>0 );

25941 
pFûe
->
eFûeLock
 = 
SHARED_LOCK
;

25942 
pInode
->
nSh¨ed
++;

25943 
pInode
->
nLock
++;

25944 
aÂ_íd_lock
;

25951 if–
eFûeLock
==
SHARED_LOCK


25952 || (
eFûeLock
==
EXCLUSIVE_LOCK
 && 
pFûe
->eFûeLock<
PENDING_LOCK
)

25954 
Áûed
;

25955 
Áûed
 = 
	`aÂSëLock
(
c⁄ãxt
->
dbP©h
, 
pFûe
, 
PENDING_BYTE
, 1, 1);

25956 i‡(
Áûed
) {

25957 
rc
 = 
Áûed
;

25958 
aÂ_íd_lock
;

25965 if–
eFûeLock
==
SHARED_LOCK
 ){

25966 
Ãc1
, 
Ãc2
, 
Ãc1Eºno
 = 0;

25967 
lk
, 
mask
;

25969 
	`as£π
–
pInode
->
nSh¨ed
==0 );

25970 
	`as£π
–
pInode
->
eFûeLock
==0 );

25972 
mask
 = (()==8Ë? 
LARGEST_INT64
 : 0x7fffffff;

25975 
lk
 = 
	`øndom
();

25976 
pInode
->
sh¨edByã
 = (
lk
 & 
mask
)%(
SHARED_SIZE
 - 1);

25977 
Ãc1
 = 
	`aÂSëLock
(
c⁄ãxt
->
dbP©h
, 
pFûe
,

25978 
SHARED_FIRST
+
pInode
->
sh¨edByã
, 1, 1);

25979 if–
	`IS_LOCK_ERROR
(
Ãc1
) ){

25980 
Ãc1Eºno
 = 
pFûe
->
œ°Eºno
;

25983 
Ãc2
 = 
	`aÂSëLock
(
c⁄ãxt
->
dbP©h
, 
pFûe
, 
PENDING_BYTE
, 1, 0);

25985 if–
	`IS_LOCK_ERROR
(
Ãc1
) ) {

25986 
pFûe
->
œ°Eºno
 = 
Ãc1Eºno
;

25987 
rc
 = 
Ãc1
;

25988 
aÂ_íd_lock
;

25989 } if–
	`IS_LOCK_ERROR
(
Ãc2
) ){

25990 
rc
 = 
Ãc2
;

25991 
aÂ_íd_lock
;

25992 } if–
Ãc1
 !
SQLITE_OK
 ) {

25993 
rc
 = 
Ãc1
;

25995 
pFûe
->
eFûeLock
 = 
SHARED_LOCK
;

25996 
pInode
->
nLock
++;

25997 
pInode
->
nSh¨ed
 = 1;

25999 }if–
eFûeLock
==
EXCLUSIVE_LOCK
 && 
pInode
->
nSh¨ed
>1 ){

26002 
rc
 = 
SQLITE_BUSY
;

26008 
Áûed
 = 0;

26009 
	`as£π
–0!=
pFûe
->
eFûeLock
 );

26010 i‡(
eFûeLock
 >
RESERVED_LOCK
 && 
pFûe
->eFileLock < RESERVED_LOCK) {

26012 
Áûed
 = 
	`aÂSëLock
(
c⁄ãxt
->
dbP©h
, 
pFûe
, 
RESERVED_BYTE
, 1,1);

26013 if–!
Áûed
 ){

26014 
c⁄ãxt
->
ª£rved
 = 1;

26017 i‡(!
Áûed
 && 
eFûeLock
 =
EXCLUSIVE_LOCK
) {

26023 if–!(
Áûed
 = 
	`aÂSëLock
(
c⁄ãxt
->
dbP©h
, 
pFûe
, 
SHARED_FIRST
 +

26024 
pInode
->
sh¨edByã
, 1, 0)) ){

26025 
Áûed2
 = 
SQLITE_OK
;

26027 
Áûed
 = 
	`aÂSëLock
(
c⁄ãxt
->
dbP©h
, 
pFûe
, 
SHARED_FIRST
,

26028 
SHARED_SIZE
, 1);

26029 if–
Áûed
 && (
Áûed2
 = 
	`aÂSëLock
(
c⁄ãxt
->
dbP©h
, 
pFûe
,

26030 
SHARED_FIRST
 + 
pInode
->
sh¨edByã
, 1, 1)) ){

26034 
rc
 = ((
Áûed
 & 
SQLITE_IOERR
Ë=SQLITE_IOERRË? 
Áûed2
 :

26035 
SQLITE_IOERR_LOCK
;

26036 
aÂ_íd_lock
;

26039 
rc
 = 
Áûed
;

26042 if–
Áûed
 ){

26043 
rc
 = 
Áûed
;

26047 if–
rc
==
SQLITE_OK
 ){

26048 
pFûe
->
eFûeLock
 =ÉFileLock;

26049 
pInode
->
eFûeLock
 =ÉFileLock;

26050 }if–
eFûeLock
==
EXCLUSIVE_LOCK
 ){

26051 
pFûe
->
eFûeLock
 = 
PENDING_LOCK
;

26052 
pInode
->
eFûeLock
 = 
PENDING_LOCK
;

26055 
aÂ_íd_lock
:

26056 
	`unixLóveMuãx
();

26057 
	`OSTRACE
(("LOCK %d %†%†◊Â)\n", 
pFûe
->
h
, 
	`azFûeLock
(
eFûeLock
),

26058 
rc
==
SQLITE_OK
 ? "ok" : "failed"));

26059  
rc
;

26069 
	`aÂU∆ock
(
sqlôe3_fûe
 *
id
, 
eFûeLock
) {

26070 
rc
 = 
SQLITE_OK
;

26071 
unixFûe
 *
pFûe
 = (unixFûe*)
id
;

26072 
unixInodeInfo
 *
pInode
;

26073 
aÂLockögC⁄ãxt
 *
c⁄ãxt
 = (aÂLockögC⁄ãxà*Ë
pFûe
->
lockögC⁄ãxt
;

26074 
skùSh¨ed
 = 0;

26075 #ifde‡
SQLITE_TEST


26076 
h
 = 
pFûe
->h;

26079 
	`as£π
–
pFûe
 );

26080 
	`OSTRACE
(("UNLOCK %d %d wa†%d(%d,%dËpid=%d (aÂ)\n", 
pFûe
->
h
, 
eFûeLock
,

26081 
pFûe
->
eFûeLock
,ÖFûe->
pInode
->eFûeLock,ÖFûe->pInode->
nSh¨ed
,

26082 
	`gëpid
()));

26084 
	`as£π
–
eFûeLock
<=
SHARED_LOCK
 );

26085 if–
pFûe
->
eFûeLock
<=eFileLock ){

26086  
SQLITE_OK
;

26088 
	`unixE¡îMuãx
();

26089 
pInode
 = 
pFûe
->pInode;

26090 
	`as£π
–
pInode
->
nSh¨ed
!=0 );

26091 if–
pFûe
->
eFûeLock
>
SHARED_LOCK
 ){

26092 
	`as£π
–
pInode
->
eFûeLock
==
pFûe
->eFileLock );

26093 
	`SimuœãIOEº‹Bíign
(1);

26094 
	`SimuœãIOEº‹
–
h
=(-1) )

26095 
	`SimuœãIOEº‹Bíign
(0);

26097 #ifde‡
SQLITE_DEBUG


26106 
	`as£π
–
pFûe
->
öN‹mÆWrôe
==0

26107 || 
pFûe
->
dbUpd©e
==0

26108 || 
pFûe
->
å™sC¡rChng
==1 );

26109 
pFûe
->
öN‹mÆWrôe
 = 0;

26112 if–
pFûe
->
eFûeLock
==
EXCLUSIVE_LOCK
 ){

26113 
rc
 = 
	`aÂSëLock
(
c⁄ãxt
->
dbP©h
, 
pFûe
, 
SHARED_FIRST
, 
SHARED_SIZE
, 0);

26114 if–
rc
==
SQLITE_OK
 && (
eFûeLock
==
SHARED_LOCK
 || 
pInode
->
nSh¨ed
>1) ){

26116 
sh¨edLockByã
 = 
SHARED_FIRST
+
pInode
->
sh¨edByã
;

26117 
rc
 = 
	`aÂSëLock
(
c⁄ãxt
->
dbP©h
, 
pFûe
, 
sh¨edLockByã
, 1, 1);

26119 
skùSh¨ed
 = 1;

26122 if–
rc
==
SQLITE_OK
 && 
pFûe
->
eFûeLock
>=
PENDING_LOCK
 ){

26123 
rc
 = 
	`aÂSëLock
(
c⁄ãxt
->
dbP©h
, 
pFûe
, 
PENDING_BYTE
, 1, 0);

26125 if–
rc
==
SQLITE_OK
 && 
pFûe
->
eFûeLock
>=
RESERVED_LOCK
 && 
c⁄ãxt
->
ª£rved
 ){

26126 
rc
 = 
	`aÂSëLock
(
c⁄ãxt
->
dbP©h
, 
pFûe
, 
RESERVED_BYTE
, 1, 0);

26127 if–!
rc
 ){

26128 
c⁄ãxt
->
ª£rved
 = 0;

26131 if–
rc
==
SQLITE_OK
 && (
eFûeLock
==
SHARED_LOCK
 || 
pInode
->
nSh¨ed
>1)){

26132 
pInode
->
eFûeLock
 = 
SHARED_LOCK
;

26135 if–
rc
==
SQLITE_OK
 && 
eFûeLock
==
NO_LOCK
 ){

26141 
sh¨edLockByã
 = 
SHARED_FIRST
+
pInode
->
sh¨edByã
;

26142 
pInode
->
nSh¨ed
--;

26143 if–
pInode
->
nSh¨ed
==0 ){

26144 
	`SimuœãIOEº‹Bíign
(1);

26145 
	`SimuœãIOEº‹
–
h
=(-1) )

26146 
	`SimuœãIOEº‹Bíign
(0);

26147 if–!
skùSh¨ed
 ){

26148 
rc
 = 
	`aÂSëLock
(
c⁄ãxt
->
dbP©h
, 
pFûe
, 
sh¨edLockByã
, 1, 0);

26150 if–!
rc
 ){

26151 
pInode
->
eFûeLock
 = 
NO_LOCK
;

26152 
pFûe
->
eFûeLock
 = 
NO_LOCK
;

26155 if–
rc
==
SQLITE_OK
 ){

26156 
pInode
->
nLock
--;

26157 
	`as£π
–
pInode
->
nLock
>=0 );

26158 if–
pInode
->
nLock
==0 ){

26159 
	`˛o£PídögFds
(
pFûe
);

26164 
	`unixLóveMuãx
();

26165 if–
rc
==
SQLITE_OK
 ) 
pFûe
->
eFûeLock
 =ÉFileLock;

26166  
rc
;

26172 
	`aÂClo£
(
sqlôe3_fûe
 *
id
) {

26173 
rc
 = 
SQLITE_OK
;

26174 if–
id
 ){

26175 
unixFûe
 *
pFûe
 = (unixFûe*)
id
;

26176 
	`aÂU∆ock
(
id
, 
NO_LOCK
);

26177 
	`unixE¡îMuãx
();

26178 if–
pFûe
->
pInode
 &&ÖFûe->pInode->
nLock
 ){

26184 
	`£tPídögFd
(
pFûe
);

26186 
	`ªÀa£InodeInfo
(
pFûe
);

26187 
	`sqlôe3_‰ì
(
pFûe
->
lockögC⁄ãxt
);

26188 
rc
 = 
	`˛o£UnixFûe
(
id
);

26189 
	`unixLóveMuãx
();

26191  
rc
;

26207 #i‡
	`deföed
(
__APPLE__
Ë&& 
SQLITE_ENABLE_LOCKING_STYLE


26215 
	`nfsU∆ock
(
sqlôe3_fûe
 *
id
, 
eFûeLock
){

26216  
	`posixU∆ock
(
id
, 
eFûeLock
, 1);

26251 
	`£ekAndRód
(
unixFûe
 *
id
, 
sqlôe3_öt64
 
off£t
, *
pBuf
, 
˙t
){

26252 
gŸ
;

26253 
¥i‹
 = 0;

26254 #i‡(!
	`deföed
(
USE_PREAD
Ë&& !deföed(
USE_PREAD64
))

26255 
i64
 
√wOff£t
;

26257 
TIMER_START
;

26258 
	`as£π
–
˙t
==(cnt&0x1ffff) );

26259 
	`as£π
–
id
->
h
>2 );

26260 
˙t
 &= 0x1ffff;

26262 #i‡
	`deföed
(
USE_PREAD
)

26263 
gŸ
 = 
	`osPªad
(
id
->
h
, 
pBuf
, 
˙t
, 
off£t
);

26264 
	`SimuœãIOEº‹
–
gŸ
 = -1 );

26265 #ñi‡
	`deföed
(
USE_PREAD64
)

26266 
gŸ
 = 
	`osPªad64
(
id
->
h
, 
pBuf
, 
˙t
, 
off£t
);

26267 
	`SimuœãIOEº‹
–
gŸ
 = -1 );

26269 
√wOff£t
 = 
	`l£ek
(
id
->
h
, 
off£t
, 
SEEK_SET
);

26270 
	`SimuœãIOEº‹
–
√wOff£t
-- );

26271 if–
√wOff£t
!=
off£t
 ){

26272 if–
√wOff£t
 == -1 ){

26273 ((
unixFûe
*)
id
)->
œ°Eºno
 = 
î∫o
;

26275 ((
unixFûe
*)
id
)->
œ°Eºno
 = 0;

26279 
gŸ
 = 
	`osRód
(
id
->
h
, 
pBuf
, 
˙t
);

26281 if–
gŸ
==
˙t
 ) ;

26282 if–
gŸ
<0 ){

26283 if–
î∫o
==
EINTR
 ){ 
gŸ
 = 1; ; }

26284 
¥i‹
 = 0;

26285 ((
unixFûe
*)
id
)->
œ°Eºno
 = 
î∫o
;

26287 }if–
gŸ
>0 ){

26288 
˙t
 -
gŸ
;

26289 
off£t
 +
gŸ
;

26290 
¥i‹
 +
gŸ
;

26291 
pBuf
 = (*)(
gŸ
 + (*)pBuf);

26293 } 
gŸ
>0 );

26294 
TIMER_END
;

26295 
	`OSTRACE
(("READ %-3d %5d %7lld %llu\n",

26296 
id
->
h
, 
gŸ
+
¥i‹
, 
off£t
-¥i‹, 
TIMER_ELAPSED
));

26297  
gŸ
+
¥i‹
;

26305 
	`unixRód
(

26306 
sqlôe3_fûe
 *
id
,

26307 *
pBuf
,

26308 
amt
,

26309 
sqlôe3_öt64
 
off£t


26311 
unixFûe
 *
pFûe
 = (unixFûê*)
id
;

26312 
gŸ
;

26313 
	`as£π
–
id
 );

26314 
	`as£π
–
off£t
>=0 );

26315 
	`as£π
–
amt
>0 );

26320 
	`as£π
–
pFûe
->
pUnu£d
==0

26321 || 
off£t
>=
PENDING_BYTE
+512

26322 || 
off£t
+
amt
<=
PENDING_BYTE


26326 #i‡
SQLITE_MAX_MMAP_SIZE
>0

26329 if–
off£t
<
pFûe
->
mm≠Size
 ){

26330 if–
off£t
+
amt
 <
pFûe
->
mm≠Size
 ){

26331 
	`mem˝y
(
pBuf
, &((
u8
 *)(
pFûe
->
pM≠Regi⁄
))[
off£t
], 
amt
);

26332  
SQLITE_OK
;

26334 
nC›y
 = 
pFûe
->
mm≠Size
 - 
off£t
;

26335 
	`mem˝y
(
pBuf
, &((
u8
 *)(
pFûe
->
pM≠Regi⁄
))[
off£t
], 
nC›y
);

26336 
pBuf
 = &((
u8
 *ÌBuf)[
nC›y
];

26337 
amt
 -
nC›y
;

26338 
off£t
 +
nC›y
;

26343 
gŸ
 = 
	`£ekAndRód
(
pFûe
, 
off£t
, 
pBuf
, 
amt
);

26344 if–
gŸ
==
amt
 ){

26345  
SQLITE_OK
;

26346 }if–
gŸ
<0 ){

26348  
SQLITE_IOERR_READ
;

26350 
pFûe
->
œ°Eºno
 = 0;

26352 
	`mem£t
(&((*)
pBuf
)[
gŸ
], 0, 
amt
-got);

26353  
SQLITE_IOERR_SHORT_READ
;

26364 
	`£ekAndWrôeFd
(

26365 
fd
,

26366 
i64
 
iOff
,

26367 c⁄° *
pBuf
,

26368 
nBuf
,

26369 *
piEºno


26371 
rc
 = 0;

26373 
	`as£π
–
nBuf
==(nBuf&0x1ffff) );

26374 
	`as£π
–
fd
>2 );

26375 
nBuf
 &= 0x1ffff;

26376 
TIMER_START
;

26378 #i‡
	`deföed
(
USE_PREAD
)

26379 do{ 
rc
 = 
	`osPwrôe
(
fd
, 
pBuf
, 
nBuf
, 
iOff
); }Ñc<0 && 
î∫o
==
EINTR
 );

26380 #ñi‡
	`deföed
(
USE_PREAD64
)

26381 do{ 
rc
 = 
	`osPwrôe64
(
fd
, 
pBuf
, 
nBuf
, 
iOff
);}Ñc<0 && 
î∫o
==
EINTR
);

26384 
i64
 
iSìk
 = 
	`l£ek
(
fd
, 
iOff
, 
SEEK_SET
);

26385 
	`SimuœãIOEº‹
–
iSìk
-- );

26387 if–
iSìk
!=
iOff
 ){

26388 if–
piEºno
 ) *piEºnÿ(
iSìk
==-1 ? 
î∫o
 : 0);

26391 
rc
 = 
	`osWrôe
(
fd
, 
pBuf
, 
nBuf
);

26392 } 
rc
<0 && 
î∫o
==
EINTR
 );

26395 
TIMER_END
;

26396 
	`OSTRACE
(("WRITE %-3d %5d %7Œd %Œu\n", 
fd
, 
rc
, 
iOff
, 
TIMER_ELAPSED
));

26398 if–
rc
<0 && 
piEºno
 ) *piEºnÿ
î∫o
;

26399  
rc
;

26410 
	`£ekAndWrôe
(
unixFûe
 *
id
, 
i64
 
off£t
, c⁄° *
pBuf
, 
˙t
){

26411  
	`£ekAndWrôeFd
(
id
->
h
, 
off£t
, 
pBuf
, 
˙t
, &id->
œ°Eºno
);

26419 
	`unixWrôe
(

26420 
sqlôe3_fûe
 *
id
,

26421 c⁄° *
pBuf
,

26422 
amt
,

26423 
sqlôe3_öt64
 
off£t


26425 
unixFûe
 *
pFûe
 = (unixFûe*)
id
;

26426 
wrŸe
 = 0;

26427 
	`as£π
–
id
 );

26428 
	`as£π
–
amt
>0 );

26433 
	`as£π
–
pFûe
->
pUnu£d
==0

26434 || 
off£t
>=
PENDING_BYTE
+512

26435 || 
off£t
+
amt
<=
PENDING_BYTE


26439 #ifde‡
SQLITE_DEBUG


26446 if–
pFûe
->
öN‹mÆWrôe
 ){

26447 
pFûe
->
dbUpd©e
 = 1;

26448 if–
off£t
<=24 && off£t+
amt
>=27 ){

26449 
rc
;

26450 
ﬁdC¡r
[4];

26451 
	`SimuœãIOEº‹Bíign
(1);

26452 
rc
 = 
	`£ekAndRód
(
pFûe
, 24, 
ﬁdC¡r
, 4);

26453 
	`SimuœãIOEº‹Bíign
(0);

26454 if–
rc
!=4 || 
	`memcmp
(
ﬁdC¡r
, &((*)
pBuf
)[24-
off£t
], 4)!=0 ){

26455 
pFûe
->
å™sC¡rChng
 = 1;

26461 #i‡
SQLITE_MAX_MMAP_SIZE
>0

26464 if–
off£t
<
pFûe
->
mm≠Size
 ){

26465 if–
off£t
+
amt
 <
pFûe
->
mm≠Size
 ){

26466 
	`mem˝y
(&((
u8
 *)(
pFûe
->
pM≠Regi⁄
))[
off£t
], 
pBuf
, 
amt
);

26467  
SQLITE_OK
;

26469 
nC›y
 = 
pFûe
->
mm≠Size
 - 
off£t
;

26470 
	`mem˝y
(&((
u8
 *)(
pFûe
->
pM≠Regi⁄
))[
off£t
], 
pBuf
, 
nC›y
);

26471 
pBuf
 = &((
u8
 *ÌBuf)[
nC›y
];

26472 
amt
 -
nC›y
;

26473 
off£t
 +
nC›y
;

26478  
amt
>0 && (
wrŸe
 = 
	`£ekAndWrôe
(
pFûe
, 
off£t
, 
pBuf
,ámt))>0 ){

26479 
amt
 -
wrŸe
;

26480 
off£t
 +
wrŸe
;

26481 
pBuf
 = &((*ÌBuf)[
wrŸe
];

26483 
	`SimuœãIOEº‹
(–
wrŸe
=(-1), 
amt
=1 ));

26484 
	`SimuœãDiskfuŒEº‹
(–
wrŸe
=0, 
amt
=1 ));

26486 if–
amt
>0 ){

26487 if–
wrŸe
<0 && 
pFûe
->
œ°Eºno
!=
ENOSPC
 ){

26489  
SQLITE_IOERR_WRITE
;

26491 
pFûe
->
œ°Eºno
 = 0;

26492  
SQLITE_FULL
;

26496  
SQLITE_OK
;

26499 #ifde‡
SQLITE_TEST


26504 
SQLITE_API
 
sqlôe3_sync_cou¡
 = 0;

26505 
SQLITE_API
 
sqlôe3_fuŒsync_cou¡
 = 0;

26514 #i‡!
	`deföed
(
fd©async
)

26515 
	#fd©async
 
fsync


	)

26523 #ifde‡
F_FULLFSYNC


26524 
	#HAVE_FULLFSYNC
 1

	)

26526 
	#HAVE_FULLFSYNC
 0

	)

26554 
	`fuŒ_fsync
(
fd
, 
fuŒSync
, 
d©aO∆y
){

26555 
rc
;

26561 #ifde‡
SQLITE_NO_SYNC


26562 
	`UNUSED_PARAMETER
(
fd
);

26563 
	`UNUSED_PARAMETER
(
fuŒSync
);

26564 
	`UNUSED_PARAMETER
(
d©aO∆y
);

26565 #ñi‡
HAVE_FULLFSYNC


26566 
	`UNUSED_PARAMETER
(
d©aO∆y
);

26568 
	`UNUSED_PARAMETER
(
fuŒSync
);

26569 
	`UNUSED_PARAMETER
(
d©aO∆y
);

26576 #ifde‡
SQLITE_TEST


26577 if–
fuŒSync
 ) 
sqlôe3_fuŒsync_cou¡
++;

26578 
sqlôe3_sync_cou¡
++;

26584 #ifde‡
SQLITE_NO_SYNC


26585 
rc
 = 
SQLITE_OK
;

26586 #ñi‡
HAVE_FULLFSYNC


26587 if–
fuŒSync
 ){

26588 
rc
 = 
	`osF˙é
(
fd
, 
F_FULLFSYNC
, 0);

26590 
rc
 = 1;

26600 if–
rc
 )Ñ¯
	`fsync
(
fd
);

26602 #ñi‡
	`deföed
(
__APPLE__
)

26606 
rc
 = 
	`fsync
(
fd
);

26608 
rc
 = 
	`fd©async
(
fd
);

26609 #i‡
OS_VXWORKS


26610 if–
rc
==-1 && 
î∫o
==
ENOTSUP
 ){

26611 
rc
 = 
	`fsync
(
fd
);

26616 if–
OS_VXWORKS
 && 
rc
!= -1 ){

26617 
rc
 = 0;

26619  
rc
;

26645 
	`›íDúe˘‹y
(c⁄° *
zFûíame
, *
pFd
){

26646 
ii
;

26647 
fd
 = -1;

26648 
zDú«me
[
MAX_PATHNAME
+1];

26650 
	`sqlôe3_¢¥ötf
(
MAX_PATHNAME
, 
zDú«me
, "%s", 
zFûíame
);

26651 
ii
=()
	`°æí
(
zDú«me
); ii>1 && zDirname[ii]!='/'; ii--);

26652 if–
ii
>0 ){

26653 
zDú«me
[
ii
] = '\0';

26654 
fd
 = 
	`robu°_›í
(
zDú«me
, 
O_RDONLY
|
O_BINARY
, 0);

26655 if–
fd
>=0 ){

26656 
	`OSTRACE
(("OPENDIR %-3d %s\n", 
fd
, 
zDú«me
));

26659 *
pFd
 = 
fd
;

26660  (
fd
>=0?
SQLITE_OK
:
	`unixLogEº‹
(
SQLITE_CANTOPEN_BKPT
, "›í", 
zDú«me
));

26678 
	`unixSync
(
sqlôe3_fûe
 *
id
, 
Êags
){

26679 
rc
;

26680 
unixFûe
 *
pFûe
 = (unixFûe*)
id
;

26682 
isD©aO∆y
 = (
Êags
&
SQLITE_SYNC_DATAONLY
);

26683 
isFuŒsync
 = (
Êags
&0x0F)==
SQLITE_SYNC_FULL
;

26686 
	`as£π
((
Êags
&0x0F)==
SQLITE_SYNC_NORMAL


26687 || (
Êags
&0x0F)==
SQLITE_SYNC_FULL


26693 
	`SimuœãDiskfuŒEº‹
– 
SQLITE_FULL
 );

26695 
	`as£π
–
pFûe
 );

26696 
	`OSTRACE
(("SYNC %-3d\n", 
pFûe
->
h
));

26697 
rc
 = 
	`fuŒ_fsync
(
pFûe
->
h
, 
isFuŒsync
, 
isD©aO∆y
);

26698 
	`SimuœãIOEº‹
–
rc
=1 );

26699 if–
rc
 ){

26700 
pFûe
->
œ°Eºno
 = 
î∫o
;

26701  
	`unixLogEº‹
(
SQLITE_IOERR_FSYNC
, "fuŒ_fsync", 
pFûe
->
zP©h
);

26708 if–
pFûe
->
˘æFœgs
 & 
UNIXFILE_DIRSYNC
 ){

26709 
dúfd
;

26710 
	`OSTRACE
(("DIRSYNC %†(have_fuŒfsync=%d fuŒsync=%d)\n", 
pFûe
->
zP©h
,

26711 
HAVE_FULLFSYNC
, 
isFuŒsync
));

26712 
rc
 = 
	`osO≥nDúe˘‹y
(
pFûe
->
zP©h
, &
dúfd
);

26713 if–
rc
==
SQLITE_OK
 && 
dúfd
>=0 ){

26714 
	`fuŒ_fsync
(
dúfd
, 0, 0);

26715 
	`robu°_˛o£
(
pFûe
, 
dúfd
, 
__LINE__
);

26716 }if–
rc
==
SQLITE_CANTOPEN
 ){

26717 
rc
 = 
SQLITE_OK
;

26719 
pFûe
->
˘æFœgs
 &~
UNIXFILE_DIRSYNC
;

26721  
rc
;

26727 
	`unixTrunˇã
(
sqlôe3_fûe
 *
id
, 
i64
 
nByã
){

26728 
unixFûe
 *
pFûe
 = (unixFûê*)
id
;

26729 
rc
;

26730 
	`as£π
–
pFûe
 );

26731 
	`SimuœãIOEº‹
– 
SQLITE_IOERR_TRUNCATE
 );

26738 if–
pFûe
->
szChunk
>0 ){

26739 
nByã
 = (“Byã + 
pFûe
->
szChunk
 - 1)/pFile->szChunk) *ÖFile->szChunk;

26742 
rc
 = 
	`robu°_·runˇã
(
pFûe
->
h
, (
off_t
)
nByã
);

26743 if–
rc
 ){

26744 
pFûe
->
œ°Eºno
 = 
î∫o
;

26745  
	`unixLogEº‹
(
SQLITE_IOERR_TRUNCATE
, "·runˇã", 
pFûe
->
zP©h
);

26747 #ifde‡
SQLITE_DEBUG


26755 if–
pFûe
->
öN‹mÆWrôe
 && 
nByã
==0 ){

26756 
pFûe
->
å™sC¡rChng
 = 1;

26760 #i‡
SQLITE_MAX_MMAP_SIZE
>0

26765 if–
nByã
<
pFûe
->
mm≠Size
 ){

26766 
pFûe
->
mm≠Size
 = 
nByã
;

26770  
SQLITE_OK
;

26777 
	`unixFûeSize
(
sqlôe3_fûe
 *
id
, 
i64
 *
pSize
){

26778 
rc
;

26779 
°©
 
buf
;

26780 
	`as£π
–
id
 );

26781 
rc
 = 
	`osF°©
(((
unixFûe
*)
id
)->
h
, &
buf
);

26782 
	`SimuœãIOEº‹
–
rc
=1 );

26783 if–
rc
!=0 ){

26784 ((
unixFûe
*)
id
)->
œ°Eºno
 = 
î∫o
;

26785  
SQLITE_IOERR_FSTAT
;

26787 *
pSize
 = 
buf
.
°_size
;

26795 if–*
pSize
==1 ) *pSize = 0;

26798  
SQLITE_OK
;

26801 #i‡
SQLITE_ENABLE_LOCKING_STYLE
 && 
	`deföed
(
__APPLE__
)

26806 
	`¥oxyFûeC⁄åﬁ
(
sqlôe3_fûe
*,,*);

26815 
	`f˙éSizeHöt
(
unixFûe
 *
pFûe
, 
i64
 
nByã
){

26816 if–
pFûe
->
szChunk
>0 ){

26817 
i64
 
nSize
;

26818 
°©
 
buf
;

26820 if–
	`osF°©
(
pFûe
->
h
, &
buf
ËË 
SQLITE_IOERR_FSTAT
;

26822 
nSize
 = ((
nByã
+
pFûe
->
szChunk
-1) /ÖFile->szChunk) *ÖFile->szChunk;

26823 if–
nSize
>(
i64
)
buf
.
°_size
 ){

26825 #i‡
	`deföed
(
HAVE_POSIX_FALLOCATE
) && HAVE_POSIX_FALLOCATE

26829 
îr
;

26831 
îr
 = 
	`osFÆloˇã
(
pFûe
->
h
, 
buf
.
°_size
, 
nSize
-buf.st_size);

26832 } 
îr
==
EINTR
 );

26833 if–
îr
 )  
SQLITE_IOERR_WRITE
;

26841 
nBlk
 = 
buf
.
°_blksize
;

26842 
i64
 
iWrôe
;

26844 if–
	`robu°_·runˇã
(
pFûe
->
h
, 
nSize
) ){

26845 
pFûe
->
œ°Eºno
 = 
î∫o
;

26846  
	`unixLogEº‹
(
SQLITE_IOERR_TRUNCATE
, "·runˇã", 
pFûe
->
zP©h
);

26848 
iWrôe
 = ((
buf
.
°_size
 + 2*
nBlk
 - 1)/nBlk)*nBlk-1;

26849  
iWrôe
<
nSize
 ){

26850 
nWrôe
 = 
	`£ekAndWrôe
(
pFûe
, 
iWrôe
, "", 1);

26851 if–
nWrôe
!=1 )  
SQLITE_IOERR_WRITE
;

26852 
iWrôe
 +
nBlk
;

26858 #i‡
SQLITE_MAX_MMAP_SIZE
>0

26859 if–
pFûe
->
mm≠SizeMax
>0 && 
nByã
>pFûe->
mm≠Size
 ){

26860 
rc
;

26861 if–
pFûe
->
szChunk
<=0 ){

26862 if–
	`robu°_·runˇã
(
pFûe
->
h
, 
nByã
) ){

26863 
pFûe
->
œ°Eºno
 = 
î∫o
;

26864  
	`unixLogEº‹
(
SQLITE_IOERR_TRUNCATE
, "·runˇã", 
pFûe
->
zP©h
);

26868 
rc
 = 
	`unixM≠fûe
(
pFûe
, 
nByã
);

26869  
rc
;

26873  
SQLITE_OK
;

26882 
	`unixModeBô
(
unixFûe
 *
pFûe
, 
mask
, *
pArg
){

26883 if–*
pArg
<0 ){

26884 *
pArg
 = (
pFûe
->
˘æFœgs
 & 
mask
)!=0;

26885 }if–(*
pArg
)==0 ){

26886 
pFûe
->
˘æFœgs
 &~
mask
;

26888 
pFûe
->
˘æFœgs
 |
mask
;

26893 
	`unixGëTem≤ame
(
nBuf
, *
zBuf
);

26898 
	`unixFûeC⁄åﬁ
(
sqlôe3_fûe
 *
id
, 
›
, *
pArg
){

26899 
unixFûe
 *
pFûe
 = (unixFûe*)
id
;

26900  
›
 ){

26901 
SQLITE_FCNTL_LOCKSTATE
: {

26902 *(*)
pArg
 = 
pFûe
->
eFûeLock
;

26903  
SQLITE_OK
;

26905 
SQLITE_LAST_ERRNO
: {

26906 *(*)
pArg
 = 
pFûe
->
œ°Eºno
;

26907  
SQLITE_OK
;

26909 
SQLITE_FCNTL_CHUNK_SIZE
: {

26910 
pFûe
->
szChunk
 = *(*)
pArg
;

26911  
SQLITE_OK
;

26913 
SQLITE_FCNTL_SIZE_HINT
: {

26914 
rc
;

26915 
	`SimuœãIOEº‹Bíign
(1);

26916 
rc
 = 
	`f˙éSizeHöt
(
pFûe
, *(
i64
 *)
pArg
);

26917 
	`SimuœãIOEº‹Bíign
(0);

26918  
rc
;

26920 
SQLITE_FCNTL_PERSIST_WAL
: {

26921 
	`unixModeBô
(
pFûe
, 
UNIXFILE_PERSIST_WAL
, (*)
pArg
);

26922  
SQLITE_OK
;

26924 
SQLITE_FCNTL_POWERSAFE_OVERWRITE
: {

26925 
	`unixModeBô
(
pFûe
, 
UNIXFILE_PSOW
, (*)
pArg
);

26926  
SQLITE_OK
;

26928 
SQLITE_FCNTL_VFSNAME
: {

26929 *(**)
pArg
 = 
	`sqlôe3_m¥ötf
("%s", 
pFûe
->
pVfs
->
zName
);

26930  
SQLITE_OK
;

26932 
SQLITE_FCNTL_TEMPFILENAME
: {

26933 *
zTFûe
 = 
	`sqlôe3_mÆloc
–
pFûe
->
pVfs
->
mxP©h«me
 );

26934 if–
zTFûe
 ){

26935 
	`unixGëTem≤ame
(
pFûe
->
pVfs
->
mxP©h«me
, 
zTFûe
);

26936 *(**)
pArg
 = 
zTFûe
;

26938  
SQLITE_OK
;

26940 #i‡
SQLITE_MAX_MMAP_SIZE
>0

26941 
SQLITE_FCNTL_MMAP_SIZE
: {

26942 
i64
 
√wLimô
 = *(i64*)
pArg
;

26943 
rc
 = 
SQLITE_OK
;

26944 if–
√wLimô
>
sqlôe3GlobÆC⁄fig
.
mxMm≠
 ){

26945 
√wLimô
 = 
sqlôe3GlobÆC⁄fig
.
mxMm≠
;

26947 *(
i64
*)
pArg
 = 
pFûe
->
mm≠SizeMax
;

26948 if–
√wLimô
>=0 &&ÇewLimô!=
pFûe
->
mm≠SizeMax
 &&ÖFûe->
nFëchOut
==0 ){

26949 
pFûe
->
mm≠SizeMax
 = 
√wLimô
;

26950 if–
pFûe
->
mm≠Size
>0 ){

26951 
	`unixUnm≠fûe
(
pFûe
);

26952 
rc
 = 
	`unixM≠fûe
(
pFûe
, -1);

26955  
rc
;

26958 #ifde‡
SQLITE_DEBUG


26964 
SQLITE_FCNTL_DB_UNCHANGED
: {

26965 ((
unixFûe
*)
id
)->
dbUpd©e
 = 0;

26966  
SQLITE_OK
;

26969 #i‡
SQLITE_ENABLE_LOCKING_STYLE
 && 
	`deföed
(
__APPLE__
)

26970 
SQLITE_SET_LOCKPROXYFILE
:

26971 
SQLITE_GET_LOCKPROXYFILE
: {

26972  
	`¥oxyFûeC⁄åﬁ
(
id
,
›
,
pArg
);

26976  
SQLITE_NOTFOUND
;

26989 #i‚de‡
__QNXNTO__


26990 
	`unixSe˘‹Size
(
sqlôe3_fûe
 *
NŸU£d
){

26991 
	`UNUSED_PARAMETER
(
NŸU£d
);

26992  
SQLITE_DEFAULT_SECTOR_SIZE
;

26999 #ifde‡
__QNXNTO__


27000 
	~<sys/dcmd_blk.h
>

27001 
	~<sys/°©vfs.h
>

27002 
	`unixSe˘‹Size
(
sqlôe3_fûe
 *
id
){

27003 
unixFûe
 *
pFûe
 = (unixFûe*)
id
;

27004 if–
pFûe
->
£˘‹Size
 == 0 ){

27005 
°©vfs
 
fsInfo
;

27008 
pFûe
->
£˘‹Size
 = 
SQLITE_DEFAULT_SECTOR_SIZE
;

27009 
pFûe
->
devi˚Ch¨a˘îi°ics
 = 0;

27010 if–
	`f°©vfs
(
pFûe
->
h
, &
fsInfo
) == -1 ) {

27011  
pFûe
->
£˘‹Size
;

27014 if–!
	`°rcmp
(
fsInfo
.
f_ba£ty≥
, "tmp") ) {

27015 
pFûe
->
£˘‹Size
 = 
fsInfo
.
f_bsize
;

27016 
pFûe
->
devi˚Ch¨a˘îi°ics
 =

27017 
SQLITE_IOCAP_ATOMIC4K
 |

27018 
SQLITE_IOCAP_SAFE_APPEND
 |

27020 
SQLITE_IOCAP_SEQUENTIAL
 |

27023 }if–
	`°r°r
(
fsInfo
.
f_ba£ty≥
, "etfs") ){

27024 
pFûe
->
£˘‹Size
 = 
fsInfo
.
f_bsize
;

27025 
pFûe
->
devi˚Ch¨a˘îi°ics
 =

27027 (
pFûe
->
£˘‹Size
 / 512 * 
SQLITE_IOCAP_ATOMIC512
) |

27028 
SQLITE_IOCAP_SAFE_APPEND
 |

27030 
SQLITE_IOCAP_SEQUENTIAL
 |

27033 }if–!
	`°rcmp
(
fsInfo
.
f_ba£ty≥
, "qnx6") ){

27034 
pFûe
->
£˘‹Size
 = 
fsInfo
.
f_bsize
;

27035 
pFûe
->
devi˚Ch¨a˘îi°ics
 =

27036 
SQLITE_IOCAP_ATOMIC
 |

27037 
SQLITE_IOCAP_SAFE_APPEND
 |

27039 
SQLITE_IOCAP_SEQUENTIAL
 |

27042 }if–!
	`°rcmp
(
fsInfo
.
f_ba£ty≥
, "qnx4") ){

27043 
pFûe
->
£˘‹Size
 = 
fsInfo
.
f_bsize
;

27044 
pFûe
->
devi˚Ch¨a˘îi°ics
 =

27046 ((
pFûe
->
£˘‹Size
 / 512 * 
SQLITE_IOCAP_ATOMIC512
) << 1) - 2 |

27047 
SQLITE_IOCAP_SEQUENTIAL
 |

27050 }if–
	`°r°r
(
fsInfo
.
f_ba£ty≥
, "dos") ){

27051 
pFûe
->
£˘‹Size
 = 
fsInfo
.
f_bsize
;

27052 
pFûe
->
devi˚Ch¨a˘îi°ics
 =

27054 ((
pFûe
->
£˘‹Size
 / 512 * 
SQLITE_IOCAP_ATOMIC512
) << 1) - 2 |

27055 
SQLITE_IOCAP_SEQUENTIAL
 |

27059 
pFûe
->
devi˚Ch¨a˘îi°ics
 =

27060 
SQLITE_IOCAP_ATOMIC512
 |

27061 
SQLITE_IOCAP_SAFE_APPEND
 |

27068 if–
pFûe
->
£˘‹Size
 % 512 != 0 ){

27069 
pFûe
->
devi˚Ch¨a˘îi°ics
 = 0;

27070 
pFûe
->
£˘‹Size
 = 
SQLITE_DEFAULT_SECTOR_SIZE
;

27072  
pFûe
->
£˘‹Size
;

27089 
	`unixDevi˚Ch¨a˘îi°ics
(
sqlôe3_fûe
 *
id
){

27090 
unixFûe
 *
p
 = (unixFûe*)
id
;

27091 
rc
 = 0;

27092 #ifde‡
__QNXNTO__


27093 if–
p
->
£˘‹Size
==0 ) 
	`unixSe˘‹Size
(
id
);

27094 
rc
 = 
p
->
devi˚Ch¨a˘îi°ics
;

27096 if–
p
->
˘æFœgs
 & 
UNIXFILE_PSOW
 ){

27097 
rc
 |
SQLITE_IOCAP_POWERSAFE_OVERWRITE
;

27099  
rc
;

27102 #i‚de‡
SQLITE_OMIT_WAL


27134 
	sunixShmNode
 {

27135 
unixInodeInfo
 *
pInode
;

27136 
sqlôe3_muãx
 *
muãx
;

27137 *
zFûíame
;

27138 
h
;

27139 
szRegi⁄
;

27140 
u16
 
nRegi⁄
;

27141 
u8
 
isRód⁄ly
;

27142 **
≠Regi⁄
;

27143 
nRef
;

27144 
unixShm
 *
pFú°
;

27145 #ifde‡
SQLITE_DEBUG


27146 
u8
 
ex˛Mask
;

27147 
u8
 
sh¨edMask
;

27148 
u8
 
√xtShmId
;

27165 
	sunixShm
 {

27166 
unixShmNode
 *
pShmNode
;

27167 
unixShm
 *
pNext
;

27168 
u8
 
hasMuãx
;

27169 
u8
 
id
;

27170 
u16
 
sh¨edMask
;

27171 
u16
 
ex˛Mask
;

27177 
	#UNIX_SHM_BASE
 ((22+
SQLITE_SHM_NLOCK
)*4Ë

	)

27178 
	#UNIX_SHM_DMS
 (
UNIX_SHM_BASE
+
SQLITE_SHM_NLOCK
Ë

	)

27186 
	`unixShmSy°emLock
(

27187 
unixShmNode
 *
pShmNode
,

27188 
lockTy≥
,

27189 
of°
,

27190 
n


27192 
Êock
 
f
;

27193 
rc
 = 
SQLITE_OK
;

27196 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pShmNode
->
muãx
Ë||ÖShmNode->
nRef
==0 );

27199 
	`as£π
–
n
==1 || 
lockTy≥
!=
F_RDLCK
 );

27202 
	`as£π
–
n
>=1 &&Ç<
SQLITE_SHM_NLOCK
 );

27204 if–
pShmNode
->
h
>=0 ){

27206 
	`mem£t
(&
f
, 0, (f));

27207 
f
.
l_ty≥
 = 
lockTy≥
;

27208 
f
.
l_whí˚
 = 
SEEK_SET
;

27209 
f
.
l_°¨t
 = 
of°
;

27210 
f
.
l_Àn
 = 
n
;

27212 
rc
 = 
	`osF˙é
(
pShmNode
->
h
, 
F_SETLK
, &
f
);

27213 
rc
 = (rc!=(-1)Ë? 
SQLITE_OK
 : 
SQLITE_BUSY
;

27217 #ifde‡
SQLITE_DEBUG


27218 { 
u16
 
mask
;

27219 
	`OSTRACE
(("SHM-LOCK "));

27220 
mask
 = (1<<(
of°
+
n
)) - (1<<ofst);

27221 if–
rc
==
SQLITE_OK
 ){

27222 if–
lockTy≥
==
F_UNLCK
 ){

27223 
	`OSTRACE
(("u∆ock %d ok", 
of°
));

27224 
pShmNode
->
ex˛Mask
 &~
mask
;

27225 
pShmNode
->
sh¨edMask
 &~
mask
;

27226 }if–
lockTy≥
==
F_RDLCK
 ){

27227 
	`OSTRACE
(("ªad-lock %d ok", 
of°
));

27228 
pShmNode
->
ex˛Mask
 &~
mask
;

27229 
pShmNode
->
sh¨edMask
 |
mask
;

27231 
	`as£π
–
lockTy≥
==
F_WRLCK
 );

27232 
	`OSTRACE
(("wrôe-lock %d ok", 
of°
));

27233 
pShmNode
->
ex˛Mask
 |
mask
;

27234 
pShmNode
->
sh¨edMask
 &~
mask
;

27237 if–
lockTy≥
==
F_UNLCK
 ){

27238 
	`OSTRACE
(("u∆ock %d faûed", 
of°
));

27239 }if–
lockTy≥
==
F_RDLCK
 ){

27240 
	`OSTRACE
(("read-lock failed"));

27242 
	`as£π
–
lockTy≥
==
F_WRLCK
 );

27243 
	`OSTRACE
(("wrôe-lock %d faûed", 
of°
));

27246 
	`OSTRACE
((" -áfterwards %03x,%03x\n",

27247 
pShmNode
->
sh¨edMask
,ÖShmNode->
ex˛Mask
));

27251  
rc
;

27261 
	`unixShmPurge
(
unixFûe
 *
pFd
){

27262 
unixShmNode
 *
p
 = 
pFd
->
pInode
->
pShmNode
;

27263 
	`as£π
–
	`unixMuãxHñd
() );

27264 if–
p
 &&Ö->
nRef
==0 ){

27265 
i
;

27266 
	`as£π
–
p
->
pInode
==
pFd
->pInode );

27267 
	`sqlôe3_muãx_‰ì
(
p
->
muãx
);

27268 
i
=0; i<
p
->
nRegi⁄
; i++){

27269 if–
p
->
h
>=0 ){

27270 
	`osMunm≠
(
p
->
≠Regi⁄
[
i
],Ö->
szRegi⁄
);

27272 
	`sqlôe3_‰ì
(
p
->
≠Regi⁄
[
i
]);

27275 
	`sqlôe3_‰ì
(
p
->
≠Regi⁄
);

27276 if–
p
->
h
>=0 ){

27277 
	`robu°_˛o£
(
pFd
, 
p
->
h
, 
__LINE__
);

27278 
p
->
h
 = -1;

27280 
p
->
pInode
->
pShmNode
 = 0;

27281 
	`sqlôe3_‰ì
(
p
);

27320 
	`unixO≥nSh¨edMem‹y
(
unixFûe
 *
pDbFd
){

27321 
unixShm
 *
p
 = 0;

27322 
unixShmNode
 *
pShmNode
;

27323 
rc
;

27324 
unixInodeInfo
 *
pInode
;

27325 *
zShmFûíame
;

27326 
nShmFûíame
;

27329 
p
 = 
	`sqlôe3_mÆloc
( (*p) );

27330 if–
p
==0 )  
SQLITE_NOMEM
;

27331 
	`mem£t
(
p
, 0, (*p));

27332 
	`as£π
–
pDbFd
->
pShm
==0 );

27337 
	`unixE¡îMuãx
();

27338 
pInode
 = 
pDbFd
->pInode;

27339 
pShmNode
 = 
pInode
->pShmNode;

27340 if–
pShmNode
==0 ){

27341 
°©
 
sSèt
;

27347 if–
	`osF°©
(
pDbFd
->
h
, &
sSèt
Ë&& 
pInode
->
bPro˚ssLock
==0 ){

27348 
rc
 = 
SQLITE_IOERR_FSTAT
;

27349 
shm_›í_îr
;

27352 #ifde‡
SQLITE_SHM_DIRECTORY


27353 
nShmFûíame
 = (
SQLITE_SHM_DIRECTORY
) + 31;

27355 
nShmFûíame
 = 6 + ()
	`°æí
(
pDbFd
->
zP©h
);

27357 
pShmNode
 = 
	`sqlôe3_mÆloc
–(*pShmNodeË+ 
nShmFûíame
 );

27358 if–
pShmNode
==0 ){

27359 
rc
 = 
SQLITE_NOMEM
;

27360 
shm_›í_îr
;

27362 
	`mem£t
(
pShmNode
, 0, (*pShmNode)+
nShmFûíame
);

27363 
zShmFûíame
 = 
pShmNode
->
zFûíame
 = (*)&pShmNode[1];

27364 #ifde‡
SQLITE_SHM_DIRECTORY


27365 
	`sqlôe3_¢¥ötf
(
nShmFûíame
, 
zShmFûíame
,

27366 
SQLITE_SHM_DIRECTORY
 "/sqlite-shm-%x-%x",

27367 (
u32
)
sSèt
.
°_öo
, (u32)sSèt.
°_dev
);

27369 
	`sqlôe3_¢¥ötf
(
nShmFûíame
, 
zShmFûíame
, "%s-shm", 
pDbFd
->
zP©h
);

27370 
	`sqlôe3FûeSuffix3
(
pDbFd
->
zP©h
, 
zShmFûíame
);

27372 
pShmNode
->
h
 = -1;

27373 
pDbFd
->
pInode
->
pShmNode
 =ÖShmNode;

27374 
pShmNode
->
pInode
 = 
pDbFd
->pInode;

27375 
pShmNode
->
muãx
 = 
	`sqlôe3_muãx_Æloc
(
SQLITE_MUTEX_FAST
);

27376 if–
pShmNode
->
muãx
==0 ){

27377 
rc
 = 
SQLITE_NOMEM
;

27378 
shm_›í_îr
;

27381 if–
pInode
->
bPro˚ssLock
==0 ){

27382 
›íFœgs
 = 
O_RDWR
 | 
O_CREAT
;

27383 if–
	`sqlôe3_uri_boﬁón
(
pDbFd
->
zP©h
, "readonly_shm", 0) ){

27384 
›íFœgs
 = 
O_RDONLY
;

27385 
pShmNode
->
isRód⁄ly
 = 1;

27387 
pShmNode
->
h
 = 
	`robu°_›í
(
zShmFûíame
, 
›íFœgs
, (
sSèt
.
°_mode
&0777));

27388 if–
pShmNode
->
h
<0 ){

27389 
rc
 = 
	`unixLogEº‹
(
SQLITE_CANTOPEN_BKPT
, "›í", 
zShmFûíame
);

27390 
shm_›í_îr
;

27397 
	`osFchown
(
pShmNode
->
h
, 
sSèt
.
°_uid
, sSèt.
°_gid
);

27402 
rc
 = 
SQLITE_OK
;

27403 if–
	`unixShmSy°emLock
(
pShmNode
, 
F_WRLCK
, 
UNIX_SHM_DMS
, 1)==
SQLITE_OK
 ){

27404 if–
	`robu°_·runˇã
(
pShmNode
->
h
, 0) ){

27405 
rc
 = 
	`unixLogEº‹
(
SQLITE_IOERR_SHMOPEN
, "·runˇã", 
zShmFûíame
);

27408 if–
rc
==
SQLITE_OK
 ){

27409 
rc
 = 
	`unixShmSy°emLock
(
pShmNode
, 
F_RDLCK
, 
UNIX_SHM_DMS
, 1);

27411 if–
rc
 ) 
shm_›í_îr
;

27416 
p
->
pShmNode
 =ÖShmNode;

27417 #ifde‡
SQLITE_DEBUG


27418 
p
->
id
 = 
pShmNode
->
√xtShmId
++;

27420 
pShmNode
->
nRef
++;

27421 
pDbFd
->
pShm
 = 
p
;

27422 
	`unixLóveMuãx
();

27431 
	`sqlôe3_muãx_íãr
(
pShmNode
->
muãx
);

27432 
p
->
pNext
 = 
pShmNode
->
pFú°
;

27433 
pShmNode
->
pFú°
 = 
p
;

27434 
	`sqlôe3_muãx_Àave
(
pShmNode
->
muãx
);

27435  
SQLITE_OK
;

27438 
shm_›í_îr
:

27439 
	`unixShmPurge
(
pDbFd
);

27440 
	`sqlôe3_‰ì
(
p
);

27441 
	`unixLóveMuãx
();

27442  
rc
;

27464 
	`unixShmM≠
(

27465 
sqlôe3_fûe
 *
fd
,

27466 
iRegi⁄
,

27467 
szRegi⁄
,

27468 
bExãnd
,

27469 vﬁ©ûê**
µ


27471 
unixFûe
 *
pDbFd
 = (unixFûe*)
fd
;

27472 
unixShm
 *
p
;

27473 
unixShmNode
 *
pShmNode
;

27474 
rc
 = 
SQLITE_OK
;

27477 if–
pDbFd
->
pShm
==0 ){

27478 
rc
 = 
	`unixO≥nSh¨edMem‹y
(
pDbFd
);

27479 if–
rc
!=
SQLITE_OK
 ) Ñc;

27482 
p
 = 
pDbFd
->
pShm
;

27483 
pShmNode
 = 
p
->pShmNode;

27484 
	`sqlôe3_muãx_íãr
(
pShmNode
->
muãx
);

27485 
	`as£π
–
szRegi⁄
==
pShmNode
->szRegi⁄ ||ÖShmNode->
nRegi⁄
==0 );

27486 
	`as£π
–
pShmNode
->
pInode
==
pDbFd
->pInode );

27487 
	`as£π
–
pShmNode
->
h
>=0 || 
pDbFd
->
pInode
->
bPro˚ssLock
==1 );

27488 
	`as£π
–
pShmNode
->
h
<0 || 
pDbFd
->
pInode
->
bPro˚ssLock
==0 );

27490 if–
pShmNode
->
nRegi⁄
<=
iRegi⁄
 ){

27491 **
≠New
;

27492 
nByã
 = (
iRegi⁄
+1)*
szRegi⁄
;

27493 
°©
 
sSèt
;

27495 
pShmNode
->
szRegi⁄
 = szRegion;

27497 if–
pShmNode
->
h
>=0 ){

27502 if–
	`osF°©
(
pShmNode
->
h
, &
sSèt
) ){

27503 
rc
 = 
SQLITE_IOERR_SHMSIZE
;

27504 
shm∑ge_out
;

27507 if–
sSèt
.
°_size
<
nByã
 ){

27511 if–!
bExãnd
 ){

27512 
shm∑ge_out
;

27523 c⁄° 
pgsz
 = 4096;

27524 
iPg
;

27527 
	`as£π
–(
nByã
 % 
pgsz
)==0 );

27528 
iPg
=(
sSèt
.
°_size
/
pgsz
); iPg<(
nByã
/pgsz); iPg++){

27529 if–
	`£ekAndWrôeFd
(
pShmNode
->
h
, 
iPg
*
pgsz
 +Ögsz-1, "", 1, 0)!=1 ){

27530 c⁄° *
zFûe
 = 
pShmNode
->
zFûíame
;

27531 
rc
 = 
	`unixLogEº‹
(
SQLITE_IOERR_SHMSIZE
, "wrôe", 
zFûe
);

27532 
shm∑ge_out
;

27540 
≠New
 = (**)
	`sqlôe3_ªÆloc
(

27541 
pShmNode
->
≠Regi⁄
, (
iRegi⁄
+1)*(*)

27543 if–!
≠New
 ){

27544 
rc
 = 
SQLITE_IOERR_NOMEM
;

27545 
shm∑ge_out
;

27547 
pShmNode
->
≠Regi⁄
 = 
≠New
;

27548 
pShmNode
->
nRegi⁄
<=
iRegi⁄
){

27549 *
pMem
;

27550 if–
pShmNode
->
h
>=0 ){

27551 
pMem
 = 
	`osMm≠
(0, 
szRegi⁄
,

27552 
pShmNode
->
isRód⁄ly
 ? 
PROT_READ
 : PROT_READ|
PROT_WRITE
,

27553 
MAP_SHARED
, 
pShmNode
->
h
, 
szRegi⁄
*(
i64
ÌShmNode->
nRegi⁄


27555 if–
pMem
==
MAP_FAILED
 ){

27556 
rc
 = 
	`unixLogEº‹
(
SQLITE_IOERR_SHMMAP
, "mm≠", 
pShmNode
->
zFûíame
);

27557 
shm∑ge_out
;

27560 
pMem
 = 
	`sqlôe3_mÆloc
(
szRegi⁄
);

27561 if–
pMem
==0 ){

27562 
rc
 = 
SQLITE_NOMEM
;

27563 
shm∑ge_out
;

27565 
	`mem£t
(
pMem
, 0, 
szRegi⁄
);

27567 
pShmNode
->
≠Regi⁄
[pShmNode->
nRegi⁄
] = 
pMem
;

27568 
pShmNode
->
nRegi⁄
++;

27572 
shm∑ge_out
:

27573 if–
pShmNode
->
nRegi⁄
>
iRegi⁄
 ){

27574 *
µ
 = 
pShmNode
->
≠Regi⁄
[
iRegi⁄
];

27576 *
µ
 = 0;

27578 if–
pShmNode
->
isRód⁄ly
 && 
rc
==
SQLITE_OK
 )Ñ¯
SQLITE_READONLY
;

27579 
	`sqlôe3_muãx_Àave
(
pShmNode
->
muãx
);

27580  
rc
;

27591 
	`unixShmLock
(

27592 
sqlôe3_fûe
 *
fd
,

27593 
of°
,

27594 
n
,

27595 
Êags


27597 
unixFûe
 *
pDbFd
 = (unixFûe*)
fd
;

27598 
unixShm
 *
p
 = 
pDbFd
->
pShm
;

27599 
unixShm
 *
pX
;

27600 
unixShmNode
 *
pShmNode
 = 
p
->pShmNode;

27601 
rc
 = 
SQLITE_OK
;

27602 
u16
 
mask
;

27604 
	`as£π
–
pShmNode
==
pDbFd
->
pInode
->pShmNode );

27605 
	`as£π
–
pShmNode
->
pInode
==
pDbFd
->pInode );

27606 
	`as£π
–
of°
>=0 && of°+
n
<=
SQLITE_SHM_NLOCK
 );

27607 
	`as£π
–
n
>=1 );

27608 
	`as£π
–
Êags
==(
SQLITE_SHM_LOCK
 | 
SQLITE_SHM_SHARED
)

27609 || 
Êags
==(
SQLITE_SHM_LOCK
 | 
SQLITE_SHM_EXCLUSIVE
)

27610 || 
Êags
==(
SQLITE_SHM_UNLOCK
 | 
SQLITE_SHM_SHARED
)

27611 || 
Êags
==(
SQLITE_SHM_UNLOCK
 | 
SQLITE_SHM_EXCLUSIVE
) );

27612 
	`as£π
–
n
==1 || (
Êags
 & 
SQLITE_SHM_EXCLUSIVE
)!=0 );

27613 
	`as£π
–
pShmNode
->
h
>=0 || 
pDbFd
->
pInode
->
bPro˚ssLock
==1 );

27614 
	`as£π
–
pShmNode
->
h
<0 || 
pDbFd
->
pInode
->
bPro˚ssLock
==0 );

27616 
mask
 = (1<<(
of°
+
n
)) - (1<<ofst);

27617 
	`as£π
–
n
>1 || 
mask
==(1<<
of°
) );

27618 
	`sqlôe3_muãx_íãr
(
pShmNode
->
muãx
);

27619 if–
Êags
 & 
SQLITE_SHM_UNLOCK
 ){

27620 
u16
 
ÆlMask
 = 0;

27623 
pX
=
pShmNode
->
pFú°
;ÖX;ÖXıX->
pNext
){

27624 if–
pX
==
p
 ) ;

27625 
	`as£π
–(
pX
->
ex˛Mask
 & (
p
->ex˛Mask|p->
sh¨edMask
))==0 );

27626 
ÆlMask
 |
pX
->
sh¨edMask
;

27630 if–(
mask
 & 
ÆlMask
)==0 ){

27631 
rc
 = 
	`unixShmSy°emLock
(
pShmNode
, 
F_UNLCK
, 
of°
+
UNIX_SHM_BASE
, 
n
);

27633 
rc
 = 
SQLITE_OK
;

27637 if–
rc
==
SQLITE_OK
 ){

27638 
p
->
ex˛Mask
 &~
mask
;

27639 
p
->
sh¨edMask
 &~
mask
;

27641 }if–
Êags
 & 
SQLITE_SHM_SHARED
 ){

27642 
u16
 
ÆlSh¨ed
 = 0;

27648 
pX
=
pShmNode
->
pFú°
;ÖX;ÖXıX->
pNext
){

27649 if–(
pX
->
ex˛Mask
 & 
mask
)!=0 ){

27650 
rc
 = 
SQLITE_BUSY
;

27653 
ÆlSh¨ed
 |
pX
->
sh¨edMask
;

27657 if–
rc
==
SQLITE_OK
 ){

27658 if–(
ÆlSh¨ed
 & 
mask
)==0 ){

27659 
rc
 = 
	`unixShmSy°emLock
(
pShmNode
, 
F_RDLCK
, 
of°
+
UNIX_SHM_BASE
, 
n
);

27661 
rc
 = 
SQLITE_OK
;

27666 if–
rc
==
SQLITE_OK
 ){

27667 
p
->
sh¨edMask
 |
mask
;

27673 
pX
=
pShmNode
->
pFú°
;ÖX;ÖXıX->
pNext
){

27674 if–(
pX
->
ex˛Mask
 & 
mask
)!=0 || (pX->
sh¨edMask
 & mask)!=0 ){

27675 
rc
 = 
SQLITE_BUSY
;

27683 if–
rc
==
SQLITE_OK
 ){

27684 
rc
 = 
	`unixShmSy°emLock
(
pShmNode
, 
F_WRLCK
, 
of°
+
UNIX_SHM_BASE
, 
n
);

27685 if–
rc
==
SQLITE_OK
 ){

27686 
	`as£π
–(
p
->
sh¨edMask
 & 
mask
)==0 );

27687 
p
->
ex˛Mask
 |
mask
;

27691 
	`sqlôe3_muãx_Àave
(
pShmNode
->
muãx
);

27692 
	`OSTRACE
(("SHM-LOCK shmid-%d,Öid-%d got %03x,%03x\n",

27693 
p
->
id
, 
	`gëpid
(),Ö->
sh¨edMask
,Ö->
ex˛Mask
));

27694  
rc
;

27703 
	`unixShmB¨rõr
(

27704 
sqlôe3_fûe
 *
fd


27706 
	`UNUSED_PARAMETER
(
fd
);

27707 
	`unixE¡îMuãx
();

27708 
	`unixLóveMuãx
();

27718 
	`unixShmUnm≠
(

27719 
sqlôe3_fûe
 *
fd
,

27720 
dñëeFœg


27722 
unixShm
 *
p
;

27723 
unixShmNode
 *
pShmNode
;

27724 
unixShm
 **
µ
;

27725 
unixFûe
 *
pDbFd
;

27727 
pDbFd
 = (
unixFûe
*)
fd
;

27728 
p
 = 
pDbFd
->
pShm
;

27729 if–
p
==0 )  
SQLITE_OK
;

27730 
pShmNode
 = 
p
->pShmNode;

27732 
	`as£π
–
pShmNode
==
pDbFd
->
pInode
->pShmNode );

27733 
	`as£π
–
pShmNode
->
pInode
==
pDbFd
->pInode );

27737 
	`sqlôe3_muãx_íãr
(
pShmNode
->
muãx
);

27738 
µ
=&
pShmNode
->
pFú°
; (*µ)!=
p
;Ö∞&(*µ)->
pNext
){}

27739 *
µ
 = 
p
->
pNext
;

27742 
	`sqlôe3_‰ì
(
p
);

27743 
pDbFd
->
pShm
 = 0;

27744 
	`sqlôe3_muãx_Àave
(
pShmNode
->
muãx
);

27748 
	`unixE¡îMuãx
();

27749 
	`as£π
–
pShmNode
->
nRef
>0 );

27750 
pShmNode
->
nRef
--;

27751 if–
pShmNode
->
nRef
==0 ){

27752 if–
dñëeFœg
 && 
pShmNode
->
h
>=0 ) 
	`osU∆ök
’ShmNode->
zFûíame
);

27753 
	`unixShmPurge
(
pDbFd
);

27755 
	`unixLóveMuãx
();

27757  
SQLITE_OK
;

27762 
	#unixShmM≠
 0

	)

27763 
	#unixShmLock
 0

	)

27764 
	#unixShmB¨rõr
 0

	)

27765 
	#unixShmUnm≠
 0

	)

27768 #i‡
SQLITE_MAX_MMAP_SIZE
>0

27772 
	`unixUnm≠fûe
(
unixFûe
 *
pFd
){

27773 
	`as£π
–
pFd
->
nFëchOut
==0 );

27774 if–
pFd
->
pM≠Regi⁄
 ){

27775 
	`osMunm≠
(
pFd
->
pM≠Regi⁄
,ÖFd->
mm≠SizeA˘uÆ
);

27776 
pFd
->
pM≠Regi⁄
 = 0;

27777 
pFd
->
mm≠Size
 = 0;

27778 
pFd
->
mm≠SizeA˘uÆ
 = 0;

27785 
	`unixGëPagesize
(){

27786 #i‡
HAVE_MREMAP


27788 #ñi‡
	`deföed
(
_BSD_SOURCE
)

27789  
	`gë∑gesize
();

27791  ()
	`sysc⁄f
(
_SC_PAGESIZE
);

27810 
	`unixRem≠fûe
(

27811 
unixFûe
 *
pFd
,

27812 
i64
 
nNew


27814 c⁄° *
zEº
 = "mmap";

27815 
h
 = 
pFd
->h;

27816 
u8
 *
pOrig
 = (u8 *)
pFd
->
pM≠Regi⁄
;

27817 
i64
 
nOrig
 = 
pFd
->
mm≠SizeA˘uÆ
;

27818 
u8
 *
pNew
 = 0;

27819 
Êags
 = 
PROT_READ
;

27821 
	`as£π
–
pFd
->
nFëchOut
==0 );

27822 
	`as£π
–
nNew
>
pFd
->
mm≠Size
 );

27823 
	`as£π
–
nNew
<=
pFd
->
mm≠SizeMax
 );

27824 
	`as£π
–
nNew
>0 );

27825 
	`as£π
–
pFd
->
mm≠SizeA˘uÆ
>ıFd->
mm≠Size
 );

27826 
	`as£π
–
MAP_FAILED
!=0 );

27828 if–(
pFd
->
˘æFœgs
 & 
UNIXFILE_RDONLY
)==0 ) 
Êags
 |
PROT_WRITE
;

27830 if–
pOrig
 ){

27831 c⁄° 
szSy•age
 = 
	`unixGëPagesize
();

27832 
i64
 
nReu£
 = (
pFd
->
mm≠Size
 & ~(
szSy•age
-1));

27833 
u8
 *
pReq
 = &
pOrig
[
nReu£
];

27836 if–
nReu£
!=
nOrig
 ){

27837 
	`osMunm≠
(
pReq
, 
nOrig
-
nReu£
);

27840 #i‡
HAVE_MREMAP


27841 
pNew
 = 
	`osMªm≠
(
pOrig
, 
nReu£
, 
nNew
, 
MREMAP_MAYMOVE
);

27842 
zEº
 = "mremap";

27844 
pNew
 = 
	`osMm≠
(
pReq
, 
nNew
-
nReu£
, 
Êags
, 
MAP_SHARED
, 
h
,ÇReuse);

27845 if–
pNew
!=
MAP_FAILED
 ){

27846 if–
pNew
!=
pReq
 ){

27847 
	`osMunm≠
(
pNew
, 
nNew
 - 
nReu£
);

27848 
pNew
 = 0;

27850 
pNew
 = 
pOrig
;

27856 if–
pNew
==
MAP_FAILED
 ||ÖNew==0 ){

27857 
	`osMunm≠
(
pOrig
, 
nReu£
);

27862 if–
pNew
==0 ){

27863 
pNew
 = 
	`osMm≠
(0, 
nNew
, 
Êags
, 
MAP_SHARED
, 
h
, 0);

27866 if–
pNew
==
MAP_FAILED
 ){

27867 
pNew
 = 0;

27868 
nNew
 = 0;

27869 
	`unixLogEº‹
(
SQLITE_OK
, 
zEº
, 
pFd
->
zP©h
);

27874 
pFd
->
mm≠SizeMax
 = 0;

27876 
pFd
->
pM≠Regi⁄
 = (*)
pNew
;

27877 
pFd
->
mm≠Size
 =ÖFd->
mm≠SizeA˘uÆ
 = 
nNew
;

27896 
	`unixM≠fûe
(
unixFûe
 *
pFd
, 
i64
 
nByã
){

27897 
i64
 
nM≠
 = 
nByã
;

27898 
rc
;

27900 
	`as£π
–
nM≠
>=0 || 
pFd
->
nFëchOut
==0 );

27901 if–
pFd
->
nFëchOut
>0 )  
SQLITE_OK
;

27903 if–
nM≠
<0 ){

27904 
°©
 
°©buf
;

27905 
rc
 = 
	`osF°©
(
pFd
->
h
, &
°©buf
);

27906 if–
rc
!=
SQLITE_OK
 ){

27907  
SQLITE_IOERR_FSTAT
;

27909 
nM≠
 = 
°©buf
.
°_size
;

27911 if–
nM≠
>
pFd
->
mm≠SizeMax
 ){

27912 
nM≠
 = 
pFd
->
mm≠SizeMax
;

27915 if–
nM≠
!=
pFd
->
mm≠Size
 ){

27916 if–
nM≠
>0 ){

27917 
	`unixRem≠fûe
(
pFd
, 
nM≠
);

27919 
	`unixUnm≠fûe
(
pFd
);

27923  
SQLITE_OK
;

27939 
	`unixFëch
(
sqlôe3_fûe
 *
fd
, 
i64
 
iOff
, 
nAmt
, **
µ
){

27940 #i‡
SQLITE_MAX_MMAP_SIZE
>0

27941 
unixFûe
 *
pFd
 = (unixFûê*)
fd
;

27943 *
µ
 = 0;

27945 #i‡
SQLITE_MAX_MMAP_SIZE
>0

27946 if–
pFd
->
mm≠SizeMax
>0 ){

27947 if–
pFd
->
pM≠Regi⁄
==0 ){

27948 
rc
 = 
	`unixM≠fûe
(
pFd
, -1);

27949 if–
rc
!=
SQLITE_OK
 ) Ñc;

27951 if–
pFd
->
mm≠Size
 >
iOff
+
nAmt
 ){

27952 *
µ
 = &((
u8
 *)
pFd
->
pM≠Regi⁄
)[
iOff
];

27953 
pFd
->
nFëchOut
++;

27957  
SQLITE_OK
;

27970 
	`unixUn„tch
(
sqlôe3_fûe
 *
fd
, 
i64
 
iOff
, *
p
){

27971 
unixFûe
 *
pFd
 = (unixFûê*)
fd
;

27972 
	`UNUSED_PARAMETER
(
iOff
);

27974 #i‡
SQLITE_MAX_MMAP_SIZE
>0

27978 
	`as£π
–(
p
==0)==(
pFd
->
nFëchOut
==0) );

27981 
	`as£π
–
p
==0 ||Ö==&((
u8
 *)
pFd
->
pM≠Regi⁄
)[
iOff
] );

27983 if–
p
 ){

27984 
pFd
->
nFëchOut
--;

27986 
	`unixUnm≠fûe
(
pFd
);

27989 
	`as£π
–
pFd
->
nFëchOut
>=0 );

27991  
SQLITE_OK
;

28034 
	#IOMETHODS
(
FINDER
, 
METHOD
, 
VERSION
, 
CLOSE
, 
LOCK
, 
UNLOCK
, 
CKLOCK
) \

28035 c⁄° 
sqlôe3_io_mëhods
 
METHOD
 = { \

28036 
VERSION
, \

28037 
CLOSE
, \

28038 
unixRód
, \

28039 
unixWrôe
, \

28040 
unixTrunˇã
, \

28041 
unixSync
, \

28042 
unixFûeSize
, \

28043 
LOCK
, \

28044 
UNLOCK
, \

28045 
CKLOCK
, \

28046 
unixFûeC⁄åﬁ
, \

28047 
unixSe˘‹Size
, \

28048 
unixDevi˚Ch¨a˘îi°ics
, \

28049 
unixShmM≠
, \

28050 
unixShmLock
, \

28051 
unixShmB¨rõr
, \

28052 
unixShmUnm≠
, \

28053 
unixFëch
, \

28054 
unixUn„tch
, \

28056 c⁄° 
sqlôe3_io_mëhods
 *
FINDER
##
	`Im∂
(c⁄° *
z
, 
unixFûe
 *
p
){ \

28057 
	`UNUSED_PARAMETER
(
z
); UNUSED_PARAMETER(
p
); \

28058  &
METHOD
; \

28060 c⁄° 
sqlôe3_io_mëhods
 *(*c⁄° 
FINDER
)(c⁄° *,
unixFûe
 *
p
) \

28061 
FINDER
##
Im∂
;

	)

28068 
	`IOMETHODS
(

28069 
posixIoFödî
,

28070 
posixIoMëhods
,

28072 
unixClo£
,

28073 
unixLock
,

28074 
unixU∆ock
,

28075 
unixCheckRe£rvedLock


28077 
	`IOMETHODS
(

28078 
nﬁockIoFödî
,

28079 
nﬁockIoMëhods
,

28081 
nﬁockClo£
,

28082 
nﬁockLock
,

28083 
nﬁockU∆ock
,

28084 
nﬁockCheckRe£rvedLock


28086 
	`IOMETHODS
(

28087 
dŸlockIoFödî
,

28088 
dŸlockIoMëhods
,

28090 
dŸlockClo£
,

28091 
dŸlockLock
,

28092 
dŸlockU∆ock
,

28093 
dŸlockCheckRe£rvedLock


28096 #i‡
SQLITE_ENABLE_LOCKING_STYLE
 && !
OS_VXWORKS


28097 
	`IOMETHODS
(

28098 
ÊockIoFödî
,

28099 
ÊockIoMëhods
,

28101 
ÊockClo£
,

28102 
ÊockLock
,

28103 
ÊockU∆ock
,

28104 
ÊockCheckRe£rvedLock


28108 #i‡
OS_VXWORKS


28109 
	`IOMETHODS
(

28110 
£mIoFödî
,

28111 
£mIoMëhods
,

28113 
£mClo£
,

28114 
£mLock
,

28115 
£mU∆ock
,

28116 
£mCheckRe£rvedLock


28120 #i‡
	`deföed
(
__APPLE__
Ë&& 
SQLITE_ENABLE_LOCKING_STYLE


28121 
	`IOMETHODS
(

28122 
aÂIoFödî
,

28123 
aÂIoMëhods
,

28125 
aÂClo£
,

28126 
aÂLock
,

28127 
aÂU∆ock
,

28128 
aÂCheckRe£rvedLock


28141 #i‡
	`deföed
(
__APPLE__
Ë&& 
SQLITE_ENABLE_LOCKING_STYLE


28142 
	`¥oxyClo£
(
sqlôe3_fûe
*);

28143 
	`¥oxyLock
(
sqlôe3_fûe
*, );

28144 
	`¥oxyU∆ock
(
sqlôe3_fûe
*, );

28145 
	`¥oxyCheckRe£rvedLock
(
sqlôe3_fûe
*, *);

28146 
	`IOMETHODS
(

28147 
¥oxyIoFödî
,

28148 
¥oxyIoMëhods
,

28150 
¥oxyClo£
,

28151 
¥oxyLock
,

28152 
¥oxyU∆ock
,

28153 
¥oxyCheckRe£rvedLock


28158 #i‡
	`deföed
(
__APPLE__
Ë&& 
SQLITE_ENABLE_LOCKING_STYLE


28159 
	`IOMETHODS
(

28160 
nfsIoFödî
,

28161 
nfsIoMëhods
,

28163 
unixClo£
,

28164 
unixLock
,

28165 
nfsU∆ock
,

28166 
unixCheckRe£rvedLock


28170 #i‡
	`deföed
(
__APPLE__
Ë&& 
SQLITE_ENABLE_LOCKING_STYLE


28178 c⁄° 
sqlôe3_io_mëhods
 *
	`autﬁockIoFödîIm∂
(

28179 c⁄° *
fûeP©h
,

28180 
unixFûe
 *
pNew


28182 c⁄° 
	sM≠pög
 {

28183 c⁄° *
zFûesy°em
;

28184 c⁄° 
sqlôe3_io_mëhods
 *
pMëhods
;

28185 } 
aM≠
[] = {

28186 { "hfs", &
posixIoMëhods
 },

28187 { "ufs", &
posixIoMëhods
 },

28188 { "aÂfs", &
aÂIoMëhods
 },

28189 { "smbfs", &
aÂIoMëhods
 },

28190 { "webdav", &
nﬁockIoMëhods
 },

28193 
i
;

28194 
°©fs
 
fsInfo
;

28195 
Êock
 
lockInfo
;

28197 if–!
fûeP©h
 ){

28200  &
nﬁockIoMëhods
;

28202 if–
	`°©fs
(
fûeP©h
, &
fsInfo
) != -1 ){

28203 if–
fsInfo
.
f_Êags
 & 
MNT_RDONLY
 ){

28204  &
nﬁockIoMëhods
;

28206 
i
=0; 
aM≠
[i].
zFûesy°em
; i++){

28207 if–
	`°rcmp
(
fsInfo
.
f_f°y≥«me
, 
aM≠
[
i
].
zFûesy°em
)==0 ){

28208  
aM≠
[
i
].
pMëhods
;

28217 
lockInfo
.
l_Àn
 = 1;

28218 
lockInfo
.
l_°¨t
 = 0;

28219 
lockInfo
.
l_whí˚
 = 
SEEK_SET
;

28220 
lockInfo
.
l_ty≥
 = 
F_RDLCK
;

28221 if–
	`osF˙é
(
pNew
->
h
, 
F_GETLK
, &
lockInfo
)!=-1 ) {

28222 if–
	`°rcmp
(
fsInfo
.
f_f°y≥«me
, "nfs")==0 ){

28223  &
nfsIoMëhods
;

28225  &
posixIoMëhods
;

28228  &
dŸlockIoMëhods
;

28231 c⁄° 
sqlôe3_io_mëhods


28232 *(*c⁄° 
autﬁockIoFödî
)(c⁄° *,
unixFûe
*Ë
autﬁockIoFödîIm∂
;

28236 #i‡
OS_VXWORKS
 && 
SQLITE_ENABLE_LOCKING_STYLE


28244 c⁄° 
sqlôe3_io_mëhods
 *
	`autﬁockIoFödîIm∂
(

28245 c⁄° *
fûeP©h
,

28246 
unixFûe
 *
pNew


28248 
Êock
 
lockInfo
;

28250 if–!
fûeP©h
 ){

28253  &
nﬁockIoMëhods
;

28259 
lockInfo
.
l_Àn
 = 1;

28260 
lockInfo
.
l_°¨t
 = 0;

28261 
lockInfo
.
l_whí˚
 = 
SEEK_SET
;

28262 
lockInfo
.
l_ty≥
 = 
F_RDLCK
;

28263 if–
	`osF˙é
(
pNew
->
h
, 
F_GETLK
, &
lockInfo
)!=-1 ) {

28264  &
posixIoMëhods
;

28266  &
£mIoMëhods
;

28269 c⁄° 
sqlôe3_io_mëhods


28270 *(*c⁄° 
autﬁockIoFödî
)(c⁄° *,
unixFûe
*Ë
autﬁockIoFödîIm∂
;

28277 c⁄° 
	tsqlôe3_io_mëhods
 *(*
	tfödî_ty≥
)(c⁄° *,
	tunixFûe
*);

28290 
	`fûlInUnixFûe
(

28291 
sqlôe3_vfs
 *
pVfs
,

28292 
h
,

28293 
sqlôe3_fûe
 *
pId
,

28294 c⁄° *
zFûíame
,

28295 
˘æFœgs


28297 c⁄° 
sqlôe3_io_mëhods
 *
pLockögStyÀ
;

28298 
unixFûe
 *
pNew
 = (unixFûê*)
pId
;

28299 
rc
 = 
SQLITE_OK
;

28301 
	`as£π
–
pNew
->
pInode
==
NULL
 );

28307 #i‡
	`deföed
(
__APPLE__
Ë&& 
SQLITE_ENABLE_LOCKING_STYLE


28308 
	`as£π
–
zFûíame
==0 || zFilename[0]=='/'

28309 || 
pVfs
->
pAµD©a
==(*)&
autﬁockIoFödî
 );

28311 
	`as£π
–
zFûíame
==0 || zFilename[0]=='/' );

28315 
	`as£π
–
zFûíame
!=0 || (
˘æFœgs
 & 
UNIXFILE_NOLOCK
)!=0 );

28317 
	`OSTRACE
(("OPEN %-3d %s\n", 
h
, 
zFûíame
));

28318 
pNew
->
h
 = h;

28319 
pNew
->
pVfs
 =ÖVfs;

28320 
pNew
->
zP©h
 = 
zFûíame
;

28321 
pNew
->
˘æFœgs
 = (
u8
)ctrlFlags;

28322 #i‡
SQLITE_MAX_MMAP_SIZE
>0

28323 
pNew
->
mm≠SizeMax
 = 
sqlôe3GlobÆC⁄fig
.
szMm≠
;

28325 if–
	`sqlôe3_uri_boﬁón
(((
˘æFœgs
 & 
UNIXFILE_URI
Ë? 
zFûíame
 : 0),

28326 "psow", 
SQLITE_POWERSAFE_OVERWRITE
) ){

28327 
pNew
->
˘æFœgs
 |
UNIXFILE_PSOW
;

28329 if–
	`°rcmp
(
pVfs
->
zName
,"unix-excl")==0 ){

28330 
pNew
->
˘æFœgs
 |
UNIXFILE_EXCL
;

28333 #i‡
OS_VXWORKS


28334 
pNew
->
pId
 = 
	`vxw‹ksFödFûeId
(
zFûíame
);

28335 if–
pNew
->
pId
==0 ){

28336 
˘æFœgs
 |
UNIXFILE_NOLOCK
;

28337 
rc
 = 
SQLITE_NOMEM
;

28341 if–
˘æFœgs
 & 
UNIXFILE_NOLOCK
 ){

28342 
pLockögStyÀ
 = &
nﬁockIoMëhods
;

28344 
pLockögStyÀ
 = (**(
födî_ty≥
*)
pVfs
->
pAµD©a
)(
zFûíame
, 
pNew
);

28345 #i‡
SQLITE_ENABLE_LOCKING_STYLE


28349 
pNew
->
lockögC⁄ãxt
 = (*)
zFûíame
;

28353 if–
pLockögStyÀ
 =&
posixIoMëhods


28354 #i‡
	`deföed
(
__APPLE__
Ë&& 
SQLITE_ENABLE_LOCKING_STYLE


28355 || 
pLockögStyÀ
 =&
nfsIoMëhods


28358 
	`unixE¡îMuãx
();

28359 
rc
 = 
	`födInodeInfo
(
pNew
, &pNew->
pInode
);

28360 if–
rc
!=
SQLITE_OK
 ){

28379 
	`robu°_˛o£
(
pNew
, 
h
, 
__LINE__
);

28380 
h
 = -1;

28382 
	`unixLóveMuãx
();

28385 #i‡
SQLITE_ENABLE_LOCKING_STYLE
 && 
	`deföed
(
__APPLE__
)

28386 if–
pLockögStyÀ
 =&
aÂIoMëhods
 ){

28390 
aÂLockögC⁄ãxt
 *
pCtx
;

28391 
pNew
->
lockögC⁄ãxt
 = 
pCtx
 = 
	`sqlôe3_mÆloc
( (*pCtx) );

28392 if–
pCtx
==0 ){

28393 
rc
 = 
SQLITE_NOMEM
;

28398 
pCtx
->
dbP©h
 = 
zFûíame
;

28399 
pCtx
->
ª£rved
 = 0;

28400 
	`§™domdev
();

28401 
	`unixE¡îMuãx
();

28402 
rc
 = 
	`födInodeInfo
(
pNew
, &pNew->
pInode
);

28403 if–
rc
!=
SQLITE_OK
 ){

28404 
	`sqlôe3_‰ì
(
pNew
->
lockögC⁄ãxt
);

28405 
	`robu°_˛o£
(
pNew
, 
h
, 
__LINE__
);

28406 
h
 = -1;

28408 
	`unixLóveMuãx
();

28413 if–
pLockögStyÀ
 =&
dŸlockIoMëhods
 ){

28417 *
zLockFûe
;

28418 
nFûíame
;

28419 
	`as£π
–
zFûíame
!=0 );

28420 
nFûíame
 = ()
	`°æí
(
zFûíame
) + 6;

28421 
zLockFûe
 = (*)
	`sqlôe3_mÆloc
(
nFûíame
);

28422 if–
zLockFûe
==0 ){

28423 
rc
 = 
SQLITE_NOMEM
;

28425 
	`sqlôe3_¢¥ötf
(
nFûíame
, 
zLockFûe
, "%s" 
DOTLOCK_SUFFIX
, 
zFûíame
);

28427 
pNew
->
lockögC⁄ãxt
 = 
zLockFûe
;

28430 #i‡
OS_VXWORKS


28431 if–
pLockögStyÀ
 =&
£mIoMëhods
 ){

28435 
	`unixE¡îMuãx
();

28436 
rc
 = 
	`födInodeInfo
(
pNew
, &pNew->
pInode
);

28437 if–(
rc
==
SQLITE_OK
Ë&& (
pNew
->
pInode
->
pSem
==
NULL
) ){

28438 *
zSemName
 = 
pNew
->
pInode
->
aSemName
;

28439 
n
;

28440 
	`sqlôe3_¢¥ötf
(
MAX_PATHNAME
, 
zSemName
, "/%s.sem",

28441 
pNew
->
pId
->
zC™⁄iˇlName
);

28442  
n
=1; 
zSemName
[n];Ç++ )

28443 if–
zSemName
[
n
]=='/' ) zSemName[n] = '_';

28444 
pNew
->
pInode
->
pSem
 = 
	`£m_›í
(
zSemName
, 
O_CREAT
, 0666, 1);

28445 if–
pNew
->
pInode
->
pSem
 =
SEM_FAILED
 ){

28446 
rc
 = 
SQLITE_NOMEM
;

28447 
pNew
->
pInode
->
aSemName
[0] = '\0';

28450 
	`unixLóveMuãx
();

28454 
pNew
->
œ°Eºno
 = 0;

28455 #i‡
OS_VXWORKS


28456 if–
rc
!=
SQLITE_OK
 ){

28457 if–
h
>=0 ) 
	`robu°_˛o£
(
pNew
, h, 
__LINE__
);

28458 
h
 = -1;

28459 
	`osU∆ök
(
zFûíame
);

28460 
pNew
->
˘æFœgs
 |
UNIXFILE_DELETE
;

28463 if–
rc
!=
SQLITE_OK
 ){

28464 if–
h
>=0 ) 
	`robu°_˛o£
(
pNew
, h, 
__LINE__
);

28466 
pNew
->
pMëhod
 = 
pLockögStyÀ
;

28467 
	`O≥nCou¡î
(+1);

28468 
	`vîifyDbFûe
(
pNew
);

28470  
rc
;

28477 c⁄° *
	`unixTempFûeDú
(){

28478 c⁄° *
azDús
[] = {

28487 
i
;

28488 
°©
 
buf
;

28489 c⁄° *
zDú
 = 0;

28491 
azDús
[0] = 
sqlôe3_ãmp_dúe˘‹y
;

28492 if–!
azDús
[1] )ázDús[1] = 
	`gëív
("SQLITE_TMPDIR");

28493 if–!
azDús
[2] )ázDús[2] = 
	`gëív
("TMPDIR");

28494 
i
=0; i<(
azDús
)/◊zDús[0]); 
zDú
=azDirs[i++]){

28495 if–
zDú
==0 ) ;

28496 if–
	`osSèt
(
zDú
, &
buf
) ) ;

28497 if–!
	`S_ISDIR
(
buf
.
°_mode
) ) ;

28498 if–
	`osAc˚ss
(
zDú
, 07) ) ;

28501  
zDú
;

28509 
	`unixGëTem≤ame
(
nBuf
, *
zBuf
){

28510 c⁄° 
zCh¨s
[] =

28514 
i
, 
j
;

28515 c⁄° *
zDú
;

28521 
	`SimuœãIOEº‹
– 
SQLITE_IOERR
 );

28523 
zDú
 = 
	`unixTempFûeDú
();

28524 if–
zDú
==0 ) zDir = ".";

28529 if–(
	`°æí
(
zDú
Ë+ såÀn(
SQLITE_TEMP_FILE_PREFIX
Ë+ 18Ë>(
size_t
)
nBuf
 ){

28530  
SQLITE_ERROR
;

28534 
	`sqlôe3_¢¥ötf
(
nBuf
-18, 
zBuf
, "%s/"
SQLITE_TEMP_FILE_PREFIX
, 
zDú
);

28535 
j
 = ()
	`°æí
(
zBuf
);

28536 
	`sqlôe3_øndom√ss
(15, &
zBuf
[
j
]);

28537 
i
=0; i<15; i++, 
j
++){

28538 
zBuf
[
j
] = ()
zCh¨s
[ (()zBuf[j])%((zChars)-1) ];

28540 
zBuf
[
j
] = 0;

28541 
zBuf
[
j
+1] = 0;

28542 } 
	`osAc˚ss
(
zBuf
,0)==0 );

28543  
SQLITE_OK
;

28546 #i‡
SQLITE_ENABLE_LOCKING_STYLE
 && 
	`deföed
(
__APPLE__
)

28552 
	`¥oxyTønsf‹mUnixFûe
(
unixFûe
*, const *);

28571 
UnixUnu£dFd
 *
	`födReußbÀFd
(c⁄° *
zP©h
, 
Êags
){

28572 
UnixUnu£dFd
 *
pUnu£d
 = 0;

28579 #i‡!
OS_VXWORKS


28580 
°©
 
sSèt
;

28590 if–0==
	`osSèt
(
zP©h
, &
sSèt
) ){

28591 
unixInodeInfo
 *
pInode
;

28593 
	`unixE¡îMuãx
();

28594 
pInode
 = 
öodeLi°
;

28595  
pInode
 && (pInode->
fûeId
.
dev
!=
sSèt
.
°_dev


28596 || 
pInode
->
fûeId
.
öo
!=
sSèt
.
°_öo
) ){

28597 
pInode
 =ÖInode->
pNext
;

28599 if–
pInode
 ){

28600 
UnixUnu£dFd
 **
µ
;

28601 
µ
=&
pInode
->
pUnu£d
; *µ && (*µ)->
Êags
!=Êags;Öp=&((*µ)->
pNext
));

28602 
pUnu£d
 = *
µ
;

28603 if–
pUnu£d
 ){

28604 *
µ
 = 
pUnu£d
->
pNext
;

28607 
	`unixLóveMuãx
();

28610  
pUnu£d
;

28634 
	`födCª©eFûeMode
(

28635 c⁄° *
zP©h
,

28636 
Êags
,

28637 
mode_t
 *
pMode
,

28638 
uid_t
 *
pUid
,

28639 
gid_t
 *
pGid


28641 
rc
 = 
SQLITE_OK
;

28642 *
pMode
 = 0;

28643 *
pUid
 = 0;

28644 *
pGid
 = 0;

28645 if–
Êags
 & (
SQLITE_OPEN_WAL
|
SQLITE_OPEN_MAIN_JOURNAL
) ){

28646 
zDb
[
MAX_PATHNAME
+1];

28647 
nDb
;

28648 
°©
 
sSèt
;

28662 
nDb
 = 
	`sqlôe3SåÀn30
(
zP©h
) - 1;

28663 #ifde‡
SQLITE_ENABLE_8_3_NAMES


28664  
nDb
>0 && 
	`sqlôe3Iß um
(
zP©h
[nDb]) )ÇDb--;

28665 if–
nDb
==0 || 
zP©h
[nDb]!='-' )  
SQLITE_OK
;

28667  
zP©h
[
nDb
]!='-' ){

28668 
	`as£π
–
nDb
>0 );

28669 
	`as£π
–
zP©h
[
nDb
]!='\n' );

28670 
nDb
--;

28673 
	`mem˝y
(
zDb
, 
zP©h
, 
nDb
);

28674 
zDb
[
nDb
] = '\0';

28676 if–0==
	`osSèt
(
zDb
, &
sSèt
) ){

28677 *
pMode
 = 
sSèt
.
°_mode
 & 0777;

28678 *
pUid
 = 
sSèt
.
°_uid
;

28679 *
pGid
 = 
sSèt
.
°_gid
;

28681 
rc
 = 
SQLITE_IOERR_FSTAT
;

28683 }if–
Êags
 & 
SQLITE_OPEN_DELETEONCLOSE
 ){

28684 *
pMode
 = 0600;

28686  
rc
;

28711 
	`unixO≥n
(

28712 
sqlôe3_vfs
 *
pVfs
,

28713 c⁄° *
zP©h
,

28714 
sqlôe3_fûe
 *
pFûe
,

28715 
Êags
,

28716 *
pOutFœgs


28718 
unixFûe
 *
p
 = (unixFûê*)
pFûe
;

28719 
fd
 = -1;

28720 
›íFœgs
 = 0;

28721 
eTy≥
 = 
Êags
&0xFFFFFF00;

28722 
noLock
;

28723 
rc
 = 
SQLITE_OK
;

28724 
˘æFœgs
 = 0;

28726 
isEx˛usive
 = (
Êags
 & 
SQLITE_OPEN_EXCLUSIVE
);

28727 
isDñëe
 = (
Êags
 & 
SQLITE_OPEN_DELETEONCLOSE
);

28728 
isCª©e
 = (
Êags
 & 
SQLITE_OPEN_CREATE
);

28729 
isRód⁄ly
 = (
Êags
 & 
SQLITE_OPEN_READONLY
);

28730 
isRódWrôe
 = (
Êags
 & 
SQLITE_OPEN_READWRITE
);

28731 #i‡
SQLITE_ENABLE_LOCKING_STYLE


28732 
isAutoProxy
 = (
Êags
 & 
SQLITE_OPEN_AUTOPROXY
);

28734 #i‡
	`deföed
(
__APPLE__
Ë|| 
SQLITE_ENABLE_LOCKING_STYLE


28735 
°©fs
 
fsInfo
;

28742 
syncDú
 = (
isCª©e
 && (

28743 
eTy≥
==
SQLITE_OPEN_MASTER_JOURNAL


28744 || 
eTy≥
==
SQLITE_OPEN_MAIN_JOURNAL


28745 || 
eTy≥
==
SQLITE_OPEN_WAL


28751 
zTm≤ame
[
MAX_PATHNAME
+2];

28752 c⁄° *
zName
 = 
zP©h
;

28761 
	`as£π
((
isRód⁄ly
==0 || 
isRódWrôe
==0) && (isReadWrite || isReadonly));

28762 
	`as£π
(
isCª©e
==0 || 
isRódWrôe
);

28763 
	`as£π
(
isEx˛usive
==0 || 
isCª©e
);

28764 
	`as£π
(
isDñëe
==0 || 
isCª©e
);

28768 
	`as£π
–(!
isDñëe
 && 
zName
Ë|| 
eTy≥
!=
SQLITE_OPEN_MAIN_DB
 );

28769 
	`as£π
–(!
isDñëe
 && 
zName
Ë|| 
eTy≥
!=
SQLITE_OPEN_MAIN_JOURNAL
 );

28770 
	`as£π
–(!
isDñëe
 && 
zName
Ë|| 
eTy≥
!=
SQLITE_OPEN_MASTER_JOURNAL
 );

28771 
	`as£π
–(!
isDñëe
 && 
zName
Ë|| 
eTy≥
!=
SQLITE_OPEN_WAL
 );

28774 
	`as£π
–
eTy≥
==
SQLITE_OPEN_MAIN_DB
 ||ÉTy≥==
SQLITE_OPEN_TEMP_DB


28775 || 
eTy≥
==
SQLITE_OPEN_MAIN_JOURNAL
 ||ÉTy≥==
SQLITE_OPEN_TEMP_JOURNAL


28776 || 
eTy≥
==
SQLITE_OPEN_SUBJOURNAL
 ||ÉTy≥==
SQLITE_OPEN_MASTER_JOURNAL


28777 || 
eTy≥
==
SQLITE_OPEN_TRANSIENT_DB
 ||ÉTy≥==
SQLITE_OPEN_WAL


28780 
	`mem£t
(
p
, 0, (
unixFûe
));

28782 if–
eTy≥
==
SQLITE_OPEN_MAIN_DB
 ){

28783 
UnixUnu£dFd
 *
pUnu£d
;

28784 
pUnu£d
 = 
	`födReußbÀFd
(
zName
, 
Êags
);

28785 if–
pUnu£d
 ){

28786 
fd
 = 
pUnu£d
->fd;

28788 
pUnu£d
 = 
	`sqlôe3_mÆloc
((*pUnused));

28789 if–!
pUnu£d
 ){

28790  
SQLITE_NOMEM
;

28793 
p
->
pUnu£d
 =ÖUnused;

28798 
	`as£π
–(
Êags
 & 
SQLITE_OPEN_URI
Ë|| 
zName
[
	`°æí
(zName)+1]==0 );

28800 }if–!
zName
 ){

28802 
	`as£π
(
isDñëe
 && !
syncDú
);

28803 
rc
 = 
	`unixGëTem≤ame
(
MAX_PATHNAME
+2, 
zTm≤ame
);

28804 if–
rc
!=
SQLITE_OK
 ){

28805  
rc
;

28807 
zName
 = 
zTm≤ame
;

28811 
	`as£π
–
zName
[
	`°æí
(zName)+1]==0 );

28818 if–
isRód⁄ly
 ) 
›íFœgs
 |
O_RDONLY
;

28819 if–
isRódWrôe
 ) 
›íFœgs
 |
O_RDWR
;

28820 if–
isCª©e
 ) 
›íFœgs
 |
O_CREAT
;

28821 if–
isEx˛usive
 ) 
›íFœgs
 |(
O_EXCL
|
O_NOFOLLOW
);

28822 
›íFœgs
 |(
O_LARGEFILE
|
O_BINARY
);

28824 if–
fd
<0 ){

28825 
mode_t
 
›íMode
;

28826 
uid_t
 
uid
;

28827 
gid_t
 
gid
;

28828 
rc
 = 
	`födCª©eFûeMode
(
zName
, 
Êags
, &
›íMode
, &
uid
, &
gid
);

28829 if–
rc
!=
SQLITE_OK
 ){

28830 
	`as£π
–!
p
->
pUnu£d
 );

28831 
	`as£π
–
eTy≥
==
SQLITE_OPEN_WAL
 ||ÉTy≥==
SQLITE_OPEN_MAIN_JOURNAL
 );

28832  
rc
;

28834 
fd
 = 
	`robu°_›í
(
zName
, 
›íFœgs
, 
›íMode
);

28835 
	`OSTRACE
(("OPENX %-3d %†0%o\n", 
fd
, 
zName
, 
›íFœgs
));

28836 if–
fd
<0 && 
î∫o
!=
EISDIR
 && 
isRódWrôe
 && !
isEx˛usive
 ){

28838 
Êags
 &~(
SQLITE_OPEN_READWRITE
|
SQLITE_OPEN_CREATE
);

28839 
›íFœgs
 &~(
O_RDWR
|
O_CREAT
);

28840 
Êags
 |
SQLITE_OPEN_READONLY
;

28841 
›íFœgs
 |
O_RDONLY
;

28842 
isRód⁄ly
 = 1;

28843 
fd
 = 
	`robu°_›í
(
zName
, 
›íFœgs
, 
›íMode
);

28845 if–
fd
<0 ){

28846 
rc
 = 
	`unixLogEº‹
(
SQLITE_CANTOPEN_BKPT
, "›í", 
zName
);

28847 
›í_föished
;

28854 if–
Êags
 & (
SQLITE_OPEN_WAL
|
SQLITE_OPEN_MAIN_JOURNAL
) ){

28855 
	`osFchown
(
fd
, 
uid
, 
gid
);

28858 
	`as£π
–
fd
>=0 );

28859 if–
pOutFœgs
 ){

28860 *
pOutFœgs
 = 
Êags
;

28863 if–
p
->
pUnu£d
 ){

28864 
p
->
pUnu£d
->
fd
 = fd;

28865 
p
->
pUnu£d
->
Êags
 = flags;

28868 if–
isDñëe
 ){

28869 #i‡
OS_VXWORKS


28870 
zP©h
 = 
zName
;

28872 
	`osU∆ök
(
zName
);

28875 #i‡
SQLITE_ENABLE_LOCKING_STYLE


28877 
p
->
›íFœgs
 = openFlags;

28881 
noLock
 = 
eTy≥
!=
SQLITE_OPEN_MAIN_DB
;

28884 #i‡
	`deföed
(
__APPLE__
Ë|| 
SQLITE_ENABLE_LOCKING_STYLE


28885 if–
	`f°©fs
(
fd
, &
fsInfo
) == -1 ){

28886 ((
unixFûe
*)
pFûe
)->
œ°Eºno
 = 
î∫o
;

28887 
	`robu°_˛o£
(
p
, 
fd
, 
__LINE__
);

28888  
SQLITE_IOERR_ACCESS
;

28890 i‡(0 =
	`°∫cmp
("msdos", 
fsInfo
.
f_f°y≥«me
, 5)) {

28891 ((
unixFûe
*)
pFûe
)->
fsFœgs
 |
SQLITE_FSFLAGS_IS_MSDOS
;

28896 if–
isDñëe
 ) 
˘æFœgs
 |
UNIXFILE_DELETE
;

28897 if–
isRód⁄ly
 ) 
˘æFœgs
 |
UNIXFILE_RDONLY
;

28898 if–
noLock
 ) 
˘æFœgs
 |
UNIXFILE_NOLOCK
;

28899 if–
syncDú
 ) 
˘æFœgs
 |
UNIXFILE_DIRSYNC
;

28900 if–
Êags
 & 
SQLITE_OPEN_URI
 ) 
˘æFœgs
 |
UNIXFILE_URI
;

28902 #i‡
SQLITE_ENABLE_LOCKING_STYLE


28903 #i‡
SQLITE_PREFER_PROXY_LOCKING


28904 
isAutoProxy
 = 1;

28906 if–
isAutoProxy
 && (
zP©h
!=
NULL
Ë&& (!
noLock
Ë&& 
pVfs
->
xO≥n
 ){

28907 *
ívf‹˚
 = 
	`gëív
("SQLITE_FORCE_PROXY_LOCKING");

28908 
u£Proxy
 = 0;

28912 if–
ívf‹˚
!=
NULL
 ){

28913 
u£Proxy
 = 
	`©oi
(
ívf‹˚
)>0;

28915 if–
	`°©fs
(
zP©h
, &
fsInfo
) == -1 ){

28923 
p
->
œ°Eºno
 = 
î∫o
;

28924 
	`robu°_˛o£
(
p
, 
fd
, 
__LINE__
);

28925 
rc
 = 
SQLITE_IOERR_ACCESS
;

28926 
›í_föished
;

28928 
u£Proxy
 = !(
fsInfo
.
f_Êags
&
MNT_LOCAL
);

28930 if–
u£Proxy
 ){

28931 
rc
 = 
	`fûlInUnixFûe
(
pVfs
, 
fd
, 
pFûe
, 
zP©h
, 
˘æFœgs
);

28932 if–
rc
==
SQLITE_OK
 ){

28933 
rc
 = 
	`¥oxyTønsf‹mUnixFûe
((
unixFûe
*)
pFûe
, ":auto:");

28934 if–
rc
!=
SQLITE_OK
 ){

28939 
	`unixClo£
(
pFûe
);

28940  
rc
;

28943 
›í_föished
;

28948 
rc
 = 
	`fûlInUnixFûe
(
pVfs
, 
fd
, 
pFûe
, 
zP©h
, 
˘æFœgs
);

28950 
›í_föished
:

28951 if–
rc
!=
SQLITE_OK
 ){

28952 
	`sqlôe3_‰ì
(
p
->
pUnu£d
);

28954  
rc
;

28962 
	`unixDñëe
(

28963 
sqlôe3_vfs
 *
NŸU£d
,

28964 c⁄° *
zP©h
,

28965 
dúSync


28967 
rc
 = 
SQLITE_OK
;

28968 
	`UNUSED_PARAMETER
(
NŸU£d
);

28969 
	`SimuœãIOEº‹
( 
SQLITE_IOERR_DELETE
);

28970 if–
	`osU∆ök
(
zP©h
)==(-1) ){

28971 if–
î∫o
==
ENOENT
 ){

28972 
rc
 = 
SQLITE_IOERR_DELETE_NOENT
;

28974 
rc
 = 
	`unixLogEº‹
(
SQLITE_IOERR_DELETE
, "u∆ök", 
zP©h
);

28976  
rc
;

28978 #i‚de‡
SQLITE_DISABLE_DIRSYNC


28979 if–(
dúSync
 & 1)!=0 ){

28980 
fd
;

28981 
rc
 = 
	`osO≥nDúe˘‹y
(
zP©h
, &
fd
);

28982 if–
rc
==
SQLITE_OK
 ){

28983 #i‡
OS_VXWORKS


28984 if–
	`fsync
(
fd
)==-1 )

28986 if–
	`fsync
(
fd
) )

28989 
rc
 = 
	`unixLogEº‹
(
SQLITE_IOERR_DIR_FSYNC
, "fsync", 
zP©h
);

28991 
	`robu°_˛o£
(0, 
fd
, 
__LINE__
);

28992 }if–
rc
==
SQLITE_CANTOPEN
 ){

28993 
rc
 = 
SQLITE_OK
;

28997  
rc
;

29010 
	`unixAc˚ss
(

29011 
sqlôe3_vfs
 *
NŸU£d
,

29012 c⁄° *
zP©h
,

29013 
Êags
,

29014 *
pResOut


29016 
amode
 = 0;

29017 
	`UNUSED_PARAMETER
(
NŸU£d
);

29018 
	`SimuœãIOEº‹
– 
SQLITE_IOERR_ACCESS
; );

29019  
Êags
 ){

29020 
SQLITE_ACCESS_EXISTS
:

29021 
amode
 = 
F_OK
;

29023 
SQLITE_ACCESS_READWRITE
:

29024 
amode
 = 
W_OK
|
R_OK
;

29026 
SQLITE_ACCESS_READ
:

29027 
amode
 = 
R_OK
;

29031 
	`as£π
(!"Invalid flagsárgument");

29033 *
pResOut
 = (
	`osAc˚ss
(
zP©h
, 
amode
)==0);

29034 if–
Êags
==
SQLITE_ACCESS_EXISTS
 && *
pResOut
 ){

29035 
°©
 
buf
;

29036 if–0==
	`osSèt
(
zP©h
, &
buf
Ë&& buf.
°_size
==0 ){

29037 *
pResOut
 = 0;

29040  
SQLITE_OK
;

29053 
	`unixFuŒP©h«me
(

29054 
sqlôe3_vfs
 *
pVfs
,

29055 c⁄° *
zP©h
,

29056 
nOut
,

29057 *
zOut


29065 
	`SimuœãIOEº‹
– 
SQLITE_ERROR
 );

29067 
	`as£π
–
pVfs
->
mxP©h«me
==
MAX_PATHNAME
 );

29068 
	`UNUSED_PARAMETER
(
pVfs
);

29070 
zOut
[
nOut
-1] = '\0';

29071 if–
zP©h
[0]=='/' ){

29072 
	`sqlôe3_¢¥ötf
(
nOut
, 
zOut
, "%s", 
zP©h
);

29074 
nCwd
;

29075 if–
	`osGëcwd
(
zOut
, 
nOut
-1)==0 ){

29076  
	`unixLogEº‹
(
SQLITE_CANTOPEN_BKPT
, "gëcwd", 
zP©h
);

29078 
nCwd
 = ()
	`°æí
(
zOut
);

29079 
	`sqlôe3_¢¥ötf
(
nOut
-
nCwd
, &
zOut
[nCwd], "/%s", 
zP©h
);

29081  
SQLITE_OK
;

29085 #i‚de‡
SQLITE_OMIT_LOAD_EXTENSION


29090 
	~<dlf˙.h
>

29091 *
	`unixDlO≥n
(
sqlôe3_vfs
 *
NŸU£d
, c⁄° *
zFûíame
){

29092 
	`UNUSED_PARAMETER
(
NŸU£d
);

29093  
	`dl›í
(
zFûíame
, 
RTLD_NOW
 | 
RTLD_GLOBAL
);

29103 
	`unixDlEº‹
(
sqlôe3_vfs
 *
NŸU£d
, 
nBuf
, *
zBufOut
){

29104 c⁄° *
zEº
;

29105 
	`UNUSED_PARAMETER
(
NŸU£d
);

29106 
	`unixE¡îMuãx
();

29107 
zEº
 = 
	`dÀº‹
();

29108 if–
zEº
 ){

29109 
	`sqlôe3_¢¥ötf
(
nBuf
, 
zBufOut
, "%s", 
zEº
);

29111 
	`unixLóveMuãx
();

29113 (*
	`unixDlSym
(
sqlôe3_vfs
 *
NŸU£d
, *
p
, c⁄° *
zSym
))(){

29131 (*(*
x
)(*,const *))();

29132 
	`UNUSED_PARAMETER
(
NŸU£d
);

29133 
x
 = ((*(*)(*,c⁄° *))())
dlsym
;

29134  (*
x
)(
p
, 
zSym
);

29136 
	`unixDlClo£
(
sqlôe3_vfs
 *
NŸU£d
, *
pH™dÀ
){

29137 
	`UNUSED_PARAMETER
(
NŸU£d
);

29138 
	`dl˛o£
(
pH™dÀ
);

29141 
	#unixDlO≥n
 0

	)

29142 
	#unixDlEº‹
 0

	)

29143 
	#unixDlSym
 0

	)

29144 
	#unixDlClo£
 0

	)

29150 
	`unixR™dom√ss
(
sqlôe3_vfs
 *
NŸU£d
, 
nBuf
, *
zBuf
){

29151 
	`UNUSED_PARAMETER
(
NŸU£d
);

29152 
	`as£π
((
size_t
)
nBuf
>=((
time_t
)+()));

29166 
	`mem£t
(
zBuf
, 0, 
nBuf
);

29167 #i‡!
	`deföed
(
SQLITE_TEST
)

29169 
pid
, 
fd
, 
gŸ
;

29170 
fd
 = 
	`robu°_›í
("/dev/uøndom", 
O_RDONLY
, 0);

29171 if–
fd
<0 ){

29172 
time_t
 
t
;

29173 
	`time
(&
t
);

29174 
	`mem˝y
(
zBuf
, &
t
, (t));

29175 
pid
 = 
	`gëpid
();

29176 
	`mem˝y
(&
zBuf
[(
t
)], &
pid
, (pid));

29177 
	`as£π
–(
t
)+(
pid
)<=(
size_t
)
nBuf
 );

29178 
nBuf
 = (
t
Ë+ (
pid
);

29180 do{ 
gŸ
 = 
	`osRód
(
fd
, 
zBuf
, 
nBuf
); } gŸ<0 && 
î∫o
==
EINTR
 );

29181 
	`robu°_˛o£
(0, 
fd
, 
__LINE__
);

29185  
nBuf
;

29197 
	`unixSÀï
(
sqlôe3_vfs
 *
NŸU£d
, 
mi¸o£c⁄ds
){

29198 #i‡
OS_VXWORKS


29199 
time•ec
 
•
;

29201 
•
.
tv_£c
 = 
mi¸o£c⁄ds
 / 1000000;

29202 
•
.
tv_n£c
 = (
mi¸o£c⁄ds
 % 1000000) * 1000;

29203 
	`«no¶ìp
(&
•
, 
NULL
);

29204 
	`UNUSED_PARAMETER
(
NŸU£d
);

29205  
mi¸o£c⁄ds
;

29206 #ñi‡
	`deföed
(
HAVE_USLEEP
) && HAVE_USLEEP

29207 
	`u¶ìp
(
mi¸o£c⁄ds
);

29208 
	`UNUSED_PARAMETER
(
NŸU£d
);

29209  
mi¸o£c⁄ds
;

29211 
£c⁄ds
 = (
mi¸o£c⁄ds
+999999)/1000000;

29212 
	`¶ìp
(
£c⁄ds
);

29213 
	`UNUSED_PARAMETER
(
NŸU£d
);

29214  
£c⁄ds
*1000000;

29223 #ifde‡
SQLITE_TEST


29224 
SQLITE_API
 
sqlôe3_cuºít_time
 = 0;

29237 
	`unixCuºítTimeI¡64
(
sqlôe3_vfs
 *
NŸU£d
, 
sqlôe3_öt64
 *
piNow
){

29238 c⁄° 
sqlôe3_öt64
 
unixEpoch
 = 24405875*(sqlite3_int64)8640000;

29239 
rc
 = 
SQLITE_OK
;

29240 #i‡
	`deföed
(
NO_GETTOD
)

29241 
time_t
 
t
;

29242 
	`time
(&
t
);

29243 *
piNow
 = ((
sqlôe3_öt64
)
t
)*1000 + 
unixEpoch
;

29244 #ñi‡
OS_VXWORKS


29245 
time•ec
 
sNow
;

29246 
	`˛ock_gëtime
(
CLOCK_REALTIME
, &
sNow
);

29247 *
piNow
 = 
unixEpoch
 + 1000*(
sqlôe3_öt64
)
sNow
.
tv_£c
 + sNow.
tv_n£c
/1000000;

29249 
timevÆ
 
sNow
;

29250 if–
	`gëtimeofday
(&
sNow
, 0)==0 ){

29251 *
piNow
 = 
unixEpoch
 + 1000*(
sqlôe3_öt64
)
sNow
.
tv_£c
 + sNow.
tv_u£c
/1000;

29253 
rc
 = 
SQLITE_ERROR
;

29257 #ifde‡
SQLITE_TEST


29258 if–
sqlôe3_cuºít_time
 ){

29259 *
piNow
 = 1000*(
sqlôe3_öt64
)
sqlôe3_cuºít_time
 + 
unixEpoch
;

29262 
	`UNUSED_PARAMETER
(
NŸU£d
);

29263  
rc
;

29271 
	`unixCuºítTime
(
sqlôe3_vfs
 *
NŸU£d
, *
¥Now
){

29272 
sqlôe3_öt64
 
i
 = 0;

29273 
rc
;

29274 
	`UNUSED_PARAMETER
(
NŸU£d
);

29275 
rc
 = 
	`unixCuºítTimeI¡64
(0, &
i
);

29276 *
¥Now
 = 
i
/86400000.0;

29277  
rc
;

29287 
	`unixGëLa°Eº‹
(
sqlôe3_vfs
 *
NŸU£d
, 
NŸU£d2
, *
NŸU£d3
){

29288 
	`UNUSED_PARAMETER
(
NŸU£d
);

29289 
	`UNUSED_PARAMETER
(
NŸU£d2
);

29290 
	`UNUSED_PARAMETER
(
NŸU£d3
);

29451 #i‡
	`deföed
(
__APPLE__
Ë&& 
SQLITE_ENABLE_LOCKING_STYLE


29457 
¥oxyLockögC⁄ãxt
 
	t¥oxyLockögC⁄ãxt
;

29458 
	s¥oxyLockögC⁄ãxt
 {

29459 
unixFûe
 *
c⁄chFûe
;

29460 *
c⁄chFûeP©h
;

29461 
unixFûe
 *
lockProxy
;

29462 *
lockProxyP©h
;

29463 *
dbP©h
;

29464 
c⁄chHñd
;

29465 *
ﬁdLockögC⁄ãxt
;

29466 
sqlôe3_io_mëhods
 c⁄° *
pOldMëhod
;

29474 
	`¥oxyGëLockP©h
(c⁄° *
dbP©h
, *
lP©h
, 
size_t
 
maxLí
){

29475 
Àn
;

29476 
dbLí
;

29477 
i
;

29479 #ifde‡
LOCKPROXYDIR


29480 
Àn
 = 
	`°æ˝y
(
lP©h
, 
LOCKPROXYDIR
, 
maxLí
);

29482 #ifde‡
_CS_DARWIN_USER_TEMP_DIR


29484 if–!
	`c⁄f°r
(
_CS_DARWIN_USER_TEMP_DIR
, 
lP©h
, 
maxLí
) ){

29485 
	`OSTRACE
(("GETLOCKPATH failed %sÉrrno=%dÖid=%d\n",

29486 
lP©h
, 
î∫o
, 
	`gëpid
()));

29487  
SQLITE_IOERR_LOCK
;

29489 
Àn
 = 
	`°æˇt
(
lP©h
, "sqlôïlocks", 
maxLí
);

29492 
Àn
 = 
	`°æ˝y
(
lP©h
, "/tmp/", 
maxLí
);

29496 if–
lP©h
[
Àn
-1]!='/' ){

29497 
Àn
 = 
	`°æˇt
(
lP©h
, "/", 
maxLí
);

29501 
dbLí
 = ()
	`°æí
(
dbP©h
);

29502  
i
=0; i<
dbLí
 && (i+
Àn
+7)<()
maxLí
; i++){

29503 
c
 = 
dbP©h
[
i
];

29504 
lP©h
[
i
+
Àn
] = (
c
=='/')?'_':c;

29506 
lP©h
[
i
+
Àn
]='\0';

29507 
	`°æˇt
(
lP©h
, ":auto:", 
maxLí
);

29508 
	`OSTRACE
(("GETLOCKPATHÖroxyÜockÖ©h=%†pid=%d\n", 
lP©h
, 
	`gëpid
()));

29509  
SQLITE_OK
;

29515 
	`¥oxyCª©eLockP©h
(c⁄° *
lockP©h
){

29516 
i
, 
Àn
;

29517 
buf
[
MAXPATHLEN
];

29518 
°¨t
 = 0;

29520 
	`as£π
(
lockP©h
!=
NULL
);

29522 
Àn
 = ()
	`°æí
(
lockP©h
);

29523 
buf
[0] = 
lockP©h
[0];

29524  
i
=1; i<
Àn
; i++ ){

29525 if–
lockP©h
[
i
] ='/' && (ò- 
°¨t
 > 0) ){

29527 if–
i
-
°¨t
>2 || (i-°¨t==1 && 
buf
[start] != '.' && buf[start] != '/')

29528 || (
i
-
°¨t
==2 && 
buf
[start] != '.' && buf[start+1] != '.') ){

29529 
buf
[
i
]='\0';

29530 if–
	`osMkdú
(
buf
, 
SQLITE_DEFAULT_PROXYDIR_PERMISSIONS
) ){

29531 
îr
=
î∫o
;

29532 if–
îr
!=
EEXIST
 ) {

29533 
	`OSTRACE
(("CREATELOCKPATH FAILED creating %s, "

29535 
buf
, 
	`°ªº‹
(
îr
), 
lockP©h
, 
	`gëpid
()));

29536  
îr
;

29540 
°¨t
=
i
+1;

29542 
buf
[
i
] = 
lockP©h
[i];

29544 
	`OSTRACE
(("CREATELOCKPATHÖroxyÜockÖ©h=%†pid=%d\n", 
lockP©h
, 
	`gëpid
()));

29555 
	`¥oxyCª©eUnixFûe
(

29556 c⁄° *
∑th
,

29557 
unixFûe
 **
µFûe
,

29558 
i¶ockfûe


29560 
fd
 = -1;

29561 
unixFûe
 *
pNew
;

29562 
rc
 = 
SQLITE_OK
;

29563 
›íFœgs
 = 
O_RDWR
 | 
O_CREAT
;

29564 
sqlôe3_vfs
 
dummyVfs
;

29565 
ãºno
 = 0;

29566 
UnixUnu£dFd
 *
pUnu£d
 = 
NULL
;

29574 
pUnu£d
 = 
	`födReußbÀFd
(
∑th
, 
›íFœgs
);

29575 if–
pUnu£d
 ){

29576 
fd
 = 
pUnu£d
->fd;

29578 
pUnu£d
 = 
	`sqlôe3_mÆloc
((*pUnused));

29579 if–!
pUnu£d
 ){

29580  
SQLITE_NOMEM
;

29583 if–
fd
<0 ){

29584 
fd
 = 
	`robu°_›í
(
∑th
, 
›íFœgs
, 0);

29585 
ãºno
 = 
î∫o
;

29586 if–
fd
<0 && 
î∫o
==
ENOENT
 && 
i¶ockfûe
 ){

29587 if–
	`¥oxyCª©eLockP©h
(
∑th
Ë=
SQLITE_OK
 ){

29588 
fd
 = 
	`robu°_›í
(
∑th
, 
›íFœgs
, 0);

29592 if–
fd
<0 ){

29593 
›íFœgs
 = 
O_RDONLY
;

29594 
fd
 = 
	`robu°_›í
(
∑th
, 
›íFœgs
, 0);

29595 
ãºno
 = 
î∫o
;

29597 if–
fd
<0 ){

29598 if–
i¶ockfûe
 ){

29599  
SQLITE_BUSY
;

29601 
ãºno
) {

29602 
EACCES
:

29603  
SQLITE_PERM
;

29604 
EIO
:

29605  
SQLITE_IOERR_LOCK
;

29607  
SQLITE_CANTOPEN_BKPT
;

29611 
pNew
 = (
unixFûe
 *)
	`sqlôe3_mÆloc
((*pNew));

29612 if–
pNew
==
NULL
 ){

29613 
rc
 = 
SQLITE_NOMEM
;

29614 
íd_¸óã_¥oxy
;

29616 
	`mem£t
(
pNew
, 0, (
unixFûe
));

29617 
pNew
->
›íFœgs
 = openFlags;

29618 
	`mem£t
(&
dummyVfs
, 0, (dummyVfs));

29619 
dummyVfs
.
pAµD©a
 = (*)&
autﬁockIoFödî
;

29620 
dummyVfs
.
zName
 = "dummy";

29621 
pUnu£d
->
fd
 = fd;

29622 
pUnu£d
->
Êags
 = 
›íFœgs
;

29623 
pNew
->
pUnu£d
 =ÖUnused;

29625 
rc
 = 
	`fûlInUnixFûe
(&
dummyVfs
, 
fd
, (
sqlôe3_fûe
*)
pNew
, 
∑th
, 0);

29626 if–
rc
==
SQLITE_OK
 ){

29627 *
µFûe
 = 
pNew
;

29628  
SQLITE_OK
;

29630 
íd_¸óã_¥oxy
:

29631 
	`robu°_˛o£
(
pNew
, 
fd
, 
__LINE__
);

29632 
	`sqlôe3_‰ì
(
pNew
);

29633 
	`sqlôe3_‰ì
(
pUnu£d
);

29634  
rc
;

29637 #ifde‡
SQLITE_TEST


29639 
SQLITE_API
 
sqlôe3_ho°id_num
 = 0;

29642 
	#PROXY_HOSTIDLEN
 16

	)

29645 
	`gëho°uuid
(
uuid_t
 
id
, c⁄° 
time•ec
 *
waô
);

29650 
	`¥oxyGëHo°ID
(*
pHo°ID
, *
pEº‹
){

29651 
	`as£π
(
PROXY_HOSTIDLEN
 =(
uuid_t
));

29652 
	`mem£t
(
pHo°ID
, 0, 
PROXY_HOSTIDLEN
);

29653 #i‡
	`deföed
(
__MAX_OS_X_VERSION_MIN_REQUIRED
)\

29654 && 
__MAC_OS_X_VERSION_MIN_REQUIRED
<1050

29656 c⁄° 
time•ec
 
timeout
 = {1, 0};

29657 if–
	`gëho°uuid
(
pHo°ID
, &
timeout
) ){

29658 
îr
 = 
î∫o
;

29659 if–
pEº‹
 ){

29660 *
pEº‹
 = 
îr
;

29662  
SQLITE_IOERR
;

29666 
	`UNUSED_PARAMETER
(
pEº‹
);

29668 #ifde‡
SQLITE_TEST


29670 if–
sqlôe3_ho°id_num
 != 0){

29671 
pHo°ID
[0] = ()’Ho°ID[0] + ()(
sqlôe3_ho°id_num
 & 0xFF));

29675  
SQLITE_OK
;

29680 
	#PROXY_CONCHVERSION
 2

	)

29681 
	#PROXY_HEADERLEN
 1

	)

29682 
	#PROXY_PATHINDEX
 (
PROXY_HEADERLEN
+
PROXY_HOSTIDLEN
)

	)

29683 
	#PROXY_MAXCONCHLEN
 (
PROXY_HEADERLEN
+
PROXY_HOSTIDLEN
+
MAXPATHLEN
)

	)

29691 
	`¥oxyBªakC⁄chLock
(
unixFûe
 *
pFûe
, 
uuid_t
 
myHo°ID
){

29692 
¥oxyLockögC⁄ãxt
 *
pCtx
 = (¥oxyLockögC⁄ãxà*)
pFûe
->
lockögC⁄ãxt
;

29693 
unixFûe
 *
c⁄chFûe
 = 
pCtx
->conchFile;

29694 
tP©h
[
MAXPATHLEN
];

29695 
buf
[
PROXY_MAXCONCHLEN
];

29696 *
cP©h
 = 
pCtx
->
c⁄chFûeP©h
;

29697 
size_t
 
ªadLí
 = 0;

29698 
size_t
 
∑thLí
 = 0;

29699 
îrmsg
[64] = "";

29700 
fd
 = -1;

29701 
rc
 = -1;

29702 
	`UNUSED_PARAMETER
(
myHo°ID
);

29705 
∑thLí
 = 
	`°æ˝y
(
tP©h
, 
cP©h
, 
MAXPATHLEN
);

29706 if–
∑thLí
>
MAXPATHLEN
 ||ÖathLen<6 ||

29707 (
	`°æ˝y
(&
tP©h
[
∑thLí
-5], "break", 6) != 5) ){

29708 
	`sqlôe3_¢¥ötf
((
îrmsg
),îrmsg,"∑thÉº‹ (À¿%d)",()
∑thLí
);

29709 
íd_bªaklock
;

29712 
ªadLí
 = 
	`osPªad
(
c⁄chFûe
->
h
, 
buf
, 
PROXY_MAXCONCHLEN
, 0);

29713 if–
ªadLí
<
PROXY_PATHINDEX
 ){

29714 
	`sqlôe3_¢¥ötf
((
îrmsg
),îrmsg,"ªadÉº‹ (À¿%d)",()
ªadLí
);

29715 
íd_bªaklock
;

29718 
fd
 = 
	`robu°_›í
(
tP©h
, (
O_RDWR
|
O_CREAT
|
O_EXCL
), 0);

29719 if–
fd
<0 ){

29720 
	`sqlôe3_¢¥ötf
((
îrmsg
),Éºmsg, "¸óã faûed (%d)", 
î∫o
);

29721 
íd_bªaklock
;

29723 if–
	`osPwrôe
(
fd
, 
buf
, 
ªadLí
, 0Ë!(
ssize_t
)readLen ){

29724 
	`sqlôe3_¢¥ötf
((
îrmsg
),Éºmsg, "wrôêÁûed (%d)", 
î∫o
);

29725 
íd_bªaklock
;

29727 if–
	`ª«me
(
tP©h
, 
cP©h
) ){

29728 
	`sqlôe3_¢¥ötf
((
îrmsg
),Éºmsg, "ª«mêÁûed (%d)", 
î∫o
);

29729 
íd_bªaklock
;

29731 
rc
 = 0;

29732 
	`Ârötf
(
°dîr
, "brokê°Æêlock o¿%s\n", 
cP©h
);

29733 
	`robu°_˛o£
(
pFûe
, 
c⁄chFûe
->
h
, 
__LINE__
);

29734 
c⁄chFûe
->
h
 = 
fd
;

29735 
c⁄chFûe
->
›íFœgs
 = 
O_RDWR
 | 
O_CREAT
;

29737 
íd_bªaklock
:

29738 if–
rc
 ){

29739 if–
fd
>=0 ){

29740 
	`osU∆ök
(
tP©h
);

29741 
	`robu°_˛o£
(
pFûe
, 
fd
, 
__LINE__
);

29743 
	`Ârötf
(
°dîr
, "ÁûedÅÿbªak sèÀÜock o¿%s, %s\n", 
cP©h
, 
îrmsg
);

29745  
rc
;

29751 
	`¥oxyC⁄chLock
(
unixFûe
 *
pFûe
, 
uuid_t
 
myHo°ID
, 
lockTy≥
){

29752 
¥oxyLockögC⁄ãxt
 *
pCtx
 = (¥oxyLockögC⁄ãxà*)
pFûe
->
lockögC⁄ãxt
;

29753 
unixFûe
 *
c⁄chFûe
 = 
pCtx
->conchFile;

29754 
rc
 = 
SQLITE_OK
;

29755 
nTrõs
 = 0;

29756 
time•ec
 
c⁄chModTime
;

29758 
	`mem£t
(&
c⁄chModTime
, 0, (conchModTime));

29760 
rc
 = 
c⁄chFûe
->
pMëhod
->
	`xLock
((
sqlôe3_fûe
*)c⁄chFûe, 
lockTy≥
);

29761 
nTrõs
 ++;

29762 if–
rc
==
SQLITE_BUSY
 ){

29769 
°©
 
buf
;

29770 if–
	`osF°©
(
c⁄chFûe
->
h
, &
buf
) ){

29771 
pFûe
->
œ°Eºno
 = 
î∫o
;

29772  
SQLITE_IOERR_LOCK
;

29775 if–
nTrõs
==1 ){

29776 
c⁄chModTime
 = 
buf
.
°_mtime•ec
;

29777 
	`u¶ìp
(500000);

29781 
	`as£π
–
nTrõs
>1 );

29782 if–
c⁄chModTime
.
tv_£c
 !
buf
.
°_mtime•ec
.tv_sec ||

29783 
c⁄chModTime
.
tv_n£c
 !
buf
.
°_mtime•ec
.tv_nsec ){

29784  
SQLITE_BUSY
;

29787 if–
nTrõs
==2 ){

29788 
tBuf
[
PROXY_MAXCONCHLEN
];

29789 
Àn
 = 
	`osPªad
(
c⁄chFûe
->
h
, 
tBuf
, 
PROXY_MAXCONCHLEN
, 0);

29790 if–
Àn
<0 ){

29791 
pFûe
->
œ°Eºno
 = 
î∫o
;

29792  
SQLITE_IOERR_LOCK
;

29794 if–
Àn
>
PROXY_PATHINDEX
 && 
tBuf
[0]==()
PROXY_CONCHVERSION
){

29796 if–0!=
	`memcmp
(&
tBuf
[
PROXY_HEADERLEN
], 
myHo°ID
, 
PROXY_HOSTIDLEN
) ){

29797  
SQLITE_BUSY
;

29801  
SQLITE_BUSY
;

29803 
	`u¶ìp
(10000000);

29807 
	`as£π
–
nTrõs
==3 );

29808 if–0==
	`¥oxyBªakC⁄chLock
(
pFûe
, 
myHo°ID
) ){

29809 
rc
 = 
SQLITE_OK
;

29810 if–
lockTy≥
==
EXCLUSIVE_LOCK
 ){

29811 
rc
 = 
c⁄chFûe
->
pMëhod
->
	`xLock
((
sqlôe3_fûe
*)c⁄chFûe, 
SHARED_LOCK
);

29813 if–!
rc
 ){

29814 
rc
 = 
c⁄chFûe
->
pMëhod
->
	`xLock
((
sqlôe3_fûe
*)c⁄chFûe, 
lockTy≥
);

29818 }  
rc
==
SQLITE_BUSY
 && 
nTrõs
<3 );

29820  
rc
;

29829 
	`¥oxyTakeC⁄ch
(
unixFûe
 *
pFûe
){

29830 
¥oxyLockögC⁄ãxt
 *
pCtx
 = (¥oxyLockögC⁄ãxà*)
pFûe
->
lockögC⁄ãxt
;

29832 if–
pCtx
->
c⁄chHñd
!=0 ){

29833  
SQLITE_OK
;

29835 
unixFûe
 *
c⁄chFûe
 = 
pCtx
->conchFile;

29836 
uuid_t
 
myHo°ID
;

29837 
pEº‹
 = 0;

29838 
ªadBuf
[
PROXY_MAXCONCHLEN
];

29839 
lockP©h
[
MAXPATHLEN
];

29840 *
ãmpLockP©h
 = 
NULL
;

29841 
rc
 = 
SQLITE_OK
;

29842 
¸óãC⁄ch
 = 0;

29843 
ho°IdM©ch
 = 0;

29844 
ªadLí
 = 0;

29845 
åyOldLockP©h
 = 0;

29846 
f‹˚NewLockP©h
 = 0;

29848 
	`OSTRACE
(("TAKECONCH %d f‹ %†pid=%d\n", 
c⁄chFûe
->
h
,

29849 (
pCtx
->
lockProxyP©h
 ?ÖCtx->lockProxyP©h : ":auto:"), 
	`gëpid
()));

29851 
rc
 = 
	`¥oxyGëHo°ID
(
myHo°ID
, &
pEº‹
);

29852 if–(
rc
&0xff)==
SQLITE_IOERR
 ){

29853 
pFûe
->
œ°Eºno
 = 
pEº‹
;

29854 
íd_èkec⁄ch
;

29856 
rc
 = 
	`¥oxyC⁄chLock
(
pFûe
, 
myHo°ID
, 
SHARED_LOCK
);

29857 if–
rc
!=
SQLITE_OK
 ){

29858 
íd_èkec⁄ch
;

29861 
ªadLí
 = 
	`£ekAndRód
((
unixFûe
*)
c⁄chFûe
, 0, 
ªadBuf
, 
PROXY_MAXCONCHLEN
);

29862 if–
ªadLí
<0 ){

29864 
pFûe
->
œ°Eºno
 = 
c⁄chFûe
->lastErrno;

29865 
rc
 = 
SQLITE_IOERR_READ
;

29866 
íd_èkec⁄ch
;

29867 }if–
ªadLí
<=(
PROXY_HEADERLEN
+
PROXY_HOSTIDLEN
) ||

29868 
ªadBuf
[0]!=()
PROXY_CONCHVERSION
 ){

29872 
¸óãC⁄ch
 = 1;

29880 if–!
¸óãC⁄ch
 && !
f‹˚NewLockP©h
 ){

29881 
ho°IdM©ch
 = !
	`memcmp
(&
ªadBuf
[
PROXY_HEADERLEN
], 
myHo°ID
,

29882 
PROXY_HOSTIDLEN
);

29884 if–!
pCtx
->
lockProxyP©h
 ){

29888 if–
ho°IdM©ch
 ){

29889 
size_t
 
∑thLí
 = (
ªadLí
 - 
PROXY_PATHINDEX
);

29891 if–
∑thLí
>=
MAXPATHLEN
 ){

29892 
∑thLí
=
MAXPATHLEN
-1;

29894 
	`mem˝y
(
lockP©h
, &
ªadBuf
[
PROXY_PATHINDEX
], 
∑thLí
);

29895 
lockP©h
[
∑thLí
] = 0;

29896 
ãmpLockP©h
 = 
lockP©h
;

29897 
åyOldLockP©h
 = 1;

29899 
íd_èkec⁄ch
;

29901 }if–
ho°IdM©ch


29902 && !
	`°∫cmp
(
pCtx
->
lockProxyP©h
, &
ªadBuf
[
PROXY_PATHINDEX
],

29903 
ªadLí
-
PROXY_PATHINDEX
)

29906 
íd_èkec⁄ch
;

29911 if–(
c⁄chFûe
->
›íFœgs
&
O_RDWR
) == 0 ){

29912 
rc
 = 
SQLITE_BUSY
;

29913 
íd_èkec⁄ch
;

29917 if–!
pCtx
->
lockProxyP©h
 ){

29918 
	`¥oxyGëLockP©h
(
pCtx
->
dbP©h
, 
lockP©h
, 
MAXPATHLEN
);

29919 
ãmpLockP©h
 = 
lockP©h
;

29927 
	`futimes
(
c⁄chFûe
->
h
, 
NULL
);

29928 if–
ho°IdM©ch
 && !
¸óãC⁄ch
 ){

29929 if–
c⁄chFûe
->
pInode
 && c⁄chFûe->pInode->
nSh¨ed
>1 ){

29932 
rc
 = 
SQLITE_BUSY
;

29934 
rc
 = 
	`¥oxyC⁄chLock
(
pFûe
, 
myHo°ID
, 
EXCLUSIVE_LOCK
);

29937 
rc
 = 
c⁄chFûe
->
pMëhod
->
	`xLock
((
sqlôe3_fûe
*)c⁄chFûe, 
EXCLUSIVE_LOCK
);

29939 if–
rc
==
SQLITE_OK
 ){

29940 
wrôeBuf„r
[
PROXY_MAXCONCHLEN
];

29941 
wrôeSize
 = 0;

29943 
wrôeBuf„r
[0] = ()
PROXY_CONCHVERSION
;

29944 
	`mem˝y
(&
wrôeBuf„r
[
PROXY_HEADERLEN
], 
myHo°ID
, 
PROXY_HOSTIDLEN
);

29945 if–
pCtx
->
lockProxyP©h
!=
NULL
 ){

29946 
	`°æ˝y
(&
wrôeBuf„r
[
PROXY_PATHINDEX
], 
pCtx
->
lockProxyP©h
, 
MAXPATHLEN
);

29948 
	`°æ˝y
(&
wrôeBuf„r
[
PROXY_PATHINDEX
], 
ãmpLockP©h
, 
MAXPATHLEN
);

29950 
wrôeSize
 = 
PROXY_PATHINDEX
 + 
	`°æí
(&
wrôeBuf„r
[PROXY_PATHINDEX]);

29951 
	`robu°_·runˇã
(
c⁄chFûe
->
h
, 
wrôeSize
);

29952 
rc
 = 
	`unixWrôe
((
sqlôe3_fûe
 *)
c⁄chFûe
, 
wrôeBuf„r
, 
wrôeSize
, 0);

29953 
	`fsync
(
c⁄chFûe
->
h
);

29957 if–
rc
==
SQLITE_OK
 && 
¸óãC⁄ch
 ){

29958 
°©
 
buf
;

29959 
îr
 = 
	`osF°©
(
pFûe
->
h
, &
buf
);

29960 if–
îr
==0 ){

29961 
mode_t
 
cmode
 = 
buf
.
°_mode
&(
S_IRUSR
|
S_IWUSR
 | 
S_IRGRP
|
S_IWGRP
 |

29962 
S_IROTH
|
S_IWOTH
);

29964 #i‚de‡
SQLITE_PROXY_DEBUG


29965 
	`osFchmod
(
c⁄chFûe
->
h
, 
cmode
);

29968 
rc
 = 
	`osFchmod
(
c⁄chFûe
->
h
, 
cmode
);

29969 } 
rc
==(-1Ë&& 
î∫o
==
EINTR
 );

29970 if–
rc
!=0 ){

29971 
code
 = 
î∫o
;

29972 
	`Ârötf
(
°dîr
, "fchmod %o FAILED with %d %s\n",

29973 
cmode
, 
code
, 
	`°ªº‹
(code));

29975 
	`Ârötf
(
°dîr
, "fchmod %ÿSUCCEDED\n",
cmode
);

29978 
code
 = 
î∫o
;

29979 
	`Ârötf
(
°dîr
, "STAT FAILED[%d] with %d %s\n",

29980 
îr
, 
code
, 
	`°ªº‹
(code));

29985 
c⁄chFûe
->
pMëhod
->
	`xU∆ock
((
sqlôe3_fûe
*)c⁄chFûe, 
SHARED_LOCK
);

29987 
íd_èkec⁄ch
:

29988 
	`OSTRACE
(("TRANSPROXY: CLOSE %d\n", 
pFûe
->
h
));

29989 if–
rc
==
SQLITE_OK
 && 
pFûe
->
›íFœgs
 ){

29990 
fd
;

29991 if–
pFûe
->
h
>=0 ){

29992 
	`robu°_˛o£
(
pFûe
,ÖFûe->
h
, 
__LINE__
);

29994 
pFûe
->
h
 = -1;

29995 
fd
 = 
	`robu°_›í
(
pCtx
->
dbP©h
, 
pFûe
->
›íFœgs
, 0);

29996 
	`OSTRACE
(("TRANSPROXY: OPEN %d\n", 
fd
));

29997 if–
fd
>=0 ){

29998 
pFûe
->
h
 = 
fd
;

30000 
rc
=
SQLITE_CANTOPEN_BKPT
;

30004 if–
rc
==
SQLITE_OK
 && !
pCtx
->
lockProxy
 ){

30005 *
∑th
 = 
ãmpLockP©h
 ?ÅempLockP©h : 
pCtx
->
lockProxyP©h
;

30006 
rc
 = 
	`¥oxyCª©eUnixFûe
(
∑th
, &
pCtx
->
lockProxy
, 1);

30007 if–
rc
!=
SQLITE_OK
 &&Ñc!=
SQLITE_NOMEM
 && 
åyOldLockP©h
 ){

30011 
f‹˚NewLockP©h
 = 1;

30012 
åyOldLockP©h
 = 0;

30016 if–
rc
==
SQLITE_OK
 ){

30020 if–
ãmpLockP©h
 ){

30021 
pCtx
->
lockProxyP©h
 = 
	`sqlôe3DbSåDup
(0, 
ãmpLockP©h
);

30022 if–!
pCtx
->
lockProxyP©h
 ){

30023 
rc
 = 
SQLITE_NOMEM
;

30027 if–
rc
==
SQLITE_OK
 ){

30028 
pCtx
->
c⁄chHñd
 = 1;

30030 if–
pCtx
->
lockProxy
->
pMëhod
 =&
aÂIoMëhods
 ){

30031 
aÂLockögC⁄ãxt
 *
aÂCtx
;

30032 
aÂCtx
 = (
aÂLockögC⁄ãxt
 *)
pCtx
->
lockProxy
->
lockögC⁄ãxt
;

30033 
aÂCtx
->
dbP©h
 = 
pCtx
->
lockProxyP©h
;

30036 
c⁄chFûe
->
pMëhod
->
	`xU∆ock
((
sqlôe3_fûe
*)c⁄chFûe, 
NO_LOCK
);

30038 
	`OSTRACE
(("TAKECONCH %d %s\n", 
c⁄chFûe
->
h
,

30039 
rc
==
SQLITE_OK
?"ok":"failed"));

30040  
rc
;

30049 
	`¥oxyRñó£C⁄ch
(
unixFûe
 *
pFûe
){

30050 
rc
 = 
SQLITE_OK
;

30051 
¥oxyLockögC⁄ãxt
 *
pCtx
;

30052 
unixFûe
 *
c⁄chFûe
;

30054 
pCtx
 = (
¥oxyLockögC⁄ãxt
 *)
pFûe
->
lockögC⁄ãxt
;

30055 
c⁄chFûe
 = 
pCtx
->conchFile;

30056 
	`OSTRACE
(("RELEASECONCH %d f‹ %†pid=%d\n", 
c⁄chFûe
->
h
,

30057 (
pCtx
->
lockProxyP©h
 ?ÖCtx->lockProxyPath : ":auto:"),

30058 
	`gëpid
()));

30059 if–
pCtx
->
c⁄chHñd
>0 ){

30060 
rc
 = 
c⁄chFûe
->
pMëhod
->
	`xU∆ock
((
sqlôe3_fûe
*)c⁄chFûe, 
NO_LOCK
);

30062 
pCtx
->
c⁄chHñd
 = 0;

30063 
	`OSTRACE
(("RELEASECONCH %d %s\n", 
c⁄chFûe
->
h
,

30064 (
rc
==
SQLITE_OK
 ? "ok" : "failed")));

30065  
rc
;

30079 
	`¥oxyCª©eC⁄chP©h«me
(*
dbP©h
, **
pC⁄chP©h
){

30080 
i
;

30081 
Àn
 = ()
	`°æí
(
dbP©h
);

30082 *
c⁄chP©h
;

30086 *
pC⁄chP©h
 = 
c⁄chP©h
 = (*)
	`sqlôe3_mÆloc
(
Àn
 + 8);

30087 if–
c⁄chP©h
==0 ){

30088  
SQLITE_NOMEM
;

30090 
	`mem˝y
(
c⁄chP©h
, 
dbP©h
, 
Àn
+1);

30093  
i
=(
Àn
-1); i>=0; i-- ){

30094 if–
c⁄chP©h
[
i
]=='/' ){

30095 
i
++;

30099 
c⁄chP©h
[
i
]='.';

30100  
i
<
Àn
 ){

30101 
c⁄chP©h
[
i
+1]=
dbP©h
[i];

30102 
i
++;

30106 
	`mem˝y
(&
c⁄chP©h
[
i
+1], "-conch", 7);

30107 
	`as£π
–()
	`°æí
(
c⁄chP©h
Ë=
Àn
+7 );

30109  
SQLITE_OK
;

30116 
	`swôchLockProxyP©h
(
unixFûe
 *
pFûe
, c⁄° *
∑th
) {

30117 
¥oxyLockögC⁄ãxt
 *
pCtx
 = (¥oxyLockögC⁄ãxt*)
pFûe
->
lockögC⁄ãxt
;

30118 *
ﬁdP©h
 = 
pCtx
->
lockProxyP©h
;

30119 
rc
 = 
SQLITE_OK
;

30121 if–
pFûe
->
eFûeLock
!=
NO_LOCK
 ){

30122  
SQLITE_BUSY
;

30126 if–!
∑th
 ||Ö©h[0]=='\0' || !
	`°rcmp
(path, ":auto:") ||

30127 (
ﬁdP©h
 && !
	`°∫cmp
(ﬁdP©h, 
∑th
, 
MAXPATHLEN
)) ){

30128  
SQLITE_OK
;

30130 
unixFûe
 *
lockProxy
 = 
pCtx
->lockProxy;

30131 
pCtx
->
lockProxy
=
NULL
;

30132 
pCtx
->
c⁄chHñd
 = 0;

30133 if–
lockProxy
!=
NULL
 ){

30134 
rc
=
lockProxy
->
pMëhod
->
	`xClo£
((
sqlôe3_fûe
 *)lockProxy);

30135 if–
rc
 ) Ñc;

30136 
	`sqlôe3_‰ì
(
lockProxy
);

30138 
	`sqlôe3_‰ì
(
ﬁdP©h
);

30139 
pCtx
->
lockProxyP©h
 = 
	`sqlôe3DbSåDup
(0, 
∑th
);

30142  
rc
;

30152 
	`¥oxyGëDbP©hF‹UnixFûe
(
unixFûe
 *
pFûe
, *
dbP©h
){

30153 #i‡
	`deföed
(
__APPLE__
)

30154 if–
pFûe
->
pMëhod
 =&
aÂIoMëhods
 ){

30157 
	`as£π
–()
	`°æí
((*)
pFûe
->
lockögC⁄ãxt
)<=
MAXPATHLEN
 );

30158 
	`°æ˝y
(
dbP©h
, ((
aÂLockögC⁄ãxt
 *)
pFûe
->
lockögC⁄ãxt
)->dbP©h, 
MAXPATHLEN
);

30161 if–
pFûe
->
pMëhod
 =&
dŸlockIoMëhods
 ){

30164 
Àn
 = 
	`°æí
((*)
pFûe
->
lockögC⁄ãxt
Ë- såÀn(
DOTLOCK_SUFFIX
);

30165 
	`mem˝y
(
dbP©h
, (*)
pFûe
->
lockögC⁄ãxt
, 
Àn
 + 1);

30168 
	`as£π
–
	`°æí
((*)
pFûe
->
lockögC⁄ãxt
)<=
MAXPATHLEN
 );

30169 
	`°æ˝y
(
dbP©h
, (*)
pFûe
->
lockögC⁄ãxt
, 
MAXPATHLEN
);

30171  
SQLITE_OK
;

30182 
	`¥oxyTønsf‹mUnixFûe
(
unixFûe
 *
pFûe
, c⁄° *
∑th
) {

30183 
¥oxyLockögC⁄ãxt
 *
pCtx
;

30184 
dbP©h
[
MAXPATHLEN
+1];

30185 *
lockP©h
=
NULL
;

30186 
rc
 = 
SQLITE_OK
;

30188 if–
pFûe
->
eFûeLock
!=
NO_LOCK
 ){

30189  
SQLITE_BUSY
;

30191 
	`¥oxyGëDbP©hF‹UnixFûe
(
pFûe
, 
dbP©h
);

30192 if–!
∑th
 ||Ö©h[0]=='\0' || !
	`°rcmp
(path, ":auto:") ){

30193 
lockP©h
=
NULL
;

30195 
lockP©h
=(*)
∑th
;

30198 
	`OSTRACE
(("TRANSPROXY %d f‹ %†pid=%d\n", 
pFûe
->
h
,

30199 (
lockP©h
 ?ÜockP©h : ":auto:"), 
	`gëpid
()));

30201 
pCtx
 = 
	`sqlôe3_mÆloc
( (*pCtx) );

30202 if–
pCtx
==0 ){

30203  
SQLITE_NOMEM
;

30205 
	`mem£t
(
pCtx
, 0, (*pCtx));

30207 
rc
 = 
	`¥oxyCª©eC⁄chP©h«me
(
dbP©h
, &
pCtx
->
c⁄chFûeP©h
);

30208 if–
rc
==
SQLITE_OK
 ){

30209 
rc
 = 
	`¥oxyCª©eUnixFûe
(
pCtx
->
c⁄chFûeP©h
, &pCtx->
c⁄chFûe
, 0);

30210 if–
rc
==
SQLITE_CANTOPEN
 && ((
pFûe
->
›íFœgs
&
O_RDWR
) == 0) ){

30216 
°©fs
 
fsInfo
;

30217 
°©
 
c⁄chInfo
;

30218 
goLockÀss
 = 0;

30220 if–
	`osSèt
(
pCtx
->
c⁄chFûeP©h
, &
c⁄chInfo
) == -1 ) {

30221 
îr
 = 
î∫o
;

30222 if–(
îr
==
ENOENT
Ë&& (
	`°©fs
(
dbP©h
, &
fsInfo
) != -1) ){

30223 
goLockÀss
 = (
fsInfo
.
f_Êags
&
MNT_RDONLY
) == MNT_RDONLY;

30226 if–
goLockÀss
 ){

30227 
pCtx
->
c⁄chHñd
 = -1;

30228 
rc
 = 
SQLITE_OK
;

30232 if–
rc
==
SQLITE_OK
 && 
lockP©h
 ){

30233 
pCtx
->
lockProxyP©h
 = 
	`sqlôe3DbSåDup
(0, 
lockP©h
);

30236 if–
rc
==
SQLITE_OK
 ){

30237 
pCtx
->
dbP©h
 = 
	`sqlôe3DbSåDup
(0, dbPath);

30238 if–
pCtx
->
dbP©h
==
NULL
 ){

30239 
rc
 = 
SQLITE_NOMEM
;

30242 if–
rc
==
SQLITE_OK
 ){

30246 
pCtx
->
ﬁdLockögC⁄ãxt
 = 
pFûe
->
lockögC⁄ãxt
;

30247 
pFûe
->
lockögC⁄ãxt
 = 
pCtx
;

30248 
pCtx
->
pOldMëhod
 = 
pFûe
->
pMëhod
;

30249 
pFûe
->
pMëhod
 = &
¥oxyIoMëhods
;

30251 if–
pCtx
->
c⁄chFûe
 ){

30252 
pCtx
->
c⁄chFûe
->
pMëhod
->
	`xClo£
((
sqlôe3_fûe
 *)pCtx->conchFile);

30253 
	`sqlôe3_‰ì
(
pCtx
->
c⁄chFûe
);

30255 
	`sqlôe3DbFªe
(0, 
pCtx
->
lockProxyP©h
);

30256 
	`sqlôe3_‰ì
(
pCtx
->
c⁄chFûeP©h
);

30257 
	`sqlôe3_‰ì
(
pCtx
);

30259 
	`OSTRACE
(("TRANSPROXY %d %s\n", 
pFûe
->
h
,

30260 (
rc
==
SQLITE_OK
 ? "ok" : "failed")));

30261  
rc
;

30269 
	`¥oxyFûeC⁄åﬁ
(
sqlôe3_fûe
 *
id
, 
›
, *
pArg
){

30270  
›
 ){

30271 
SQLITE_GET_LOCKPROXYFILE
: {

30272 
unixFûe
 *
pFûe
 = (unixFûe*)
id
;

30273 if–
pFûe
->
pMëhod
 =&
¥oxyIoMëhods
 ){

30274 
¥oxyLockögC⁄ãxt
 *
pCtx
 = (¥oxyLockögC⁄ãxt*)
pFûe
->
lockögC⁄ãxt
;

30275 
	`¥oxyTakeC⁄ch
(
pFûe
);

30276 if–
pCtx
->
lockProxyP©h
 ){

30277 *(c⁄° **)
pArg
 = 
pCtx
->
lockProxyP©h
;

30279 *(c⁄° **)
pArg
 = ":auto: (not held)";

30282 *(c⁄° **)
pArg
 = 
NULL
;

30284  
SQLITE_OK
;

30286 
SQLITE_SET_LOCKPROXYFILE
: {

30287 
unixFûe
 *
pFûe
 = (unixFûe*)
id
;

30288 
rc
 = 
SQLITE_OK
;

30289 
isProxyStyÀ
 = (
pFûe
->
pMëhod
 =&
¥oxyIoMëhods
);

30290 if–
pArg
==
NULL
 || (const *)pArg==0 ){

30291 if–
isProxyStyÀ
 ){

30293 
rc
 = 
SQLITE_ERROR
 ;

30296 
rc
 = 
SQLITE_OK
;

30299 c⁄° *
¥oxyP©h
 = (c⁄° *)
pArg
;

30300 if–
isProxyStyÀ
 ){

30301 
¥oxyLockögC⁄ãxt
 *
pCtx
 =

30302 (
¥oxyLockögC⁄ãxt
*)
pFûe
->
lockögC⁄ãxt
;

30303 if–!
	`°rcmp
(
pArg
, ":auto:")

30304 || (
pCtx
->
lockProxyP©h
 &&

30305 !
	`°∫cmp
(
pCtx
->
lockProxyP©h
, 
¥oxyP©h
, 
MAXPATHLEN
))

30307 
rc
 = 
SQLITE_OK
;

30309 
rc
 = 
	`swôchLockProxyP©h
(
pFûe
, 
¥oxyP©h
);

30313 
rc
 = 
	`¥oxyTønsf‹mUnixFûe
(
pFûe
, 
¥oxyP©h
);

30316  
rc
;

30319 
	`as£π
( 0 );

30323  
SQLITE_ERROR
;

30339 
	`¥oxyCheckRe£rvedLock
(
sqlôe3_fûe
 *
id
, *
pResOut
) {

30340 
unixFûe
 *
pFûe
 = (unixFûe*)
id
;

30341 
rc
 = 
	`¥oxyTakeC⁄ch
(
pFûe
);

30342 if–
rc
==
SQLITE_OK
 ){

30343 
¥oxyLockögC⁄ãxt
 *
pCtx
 = (¥oxyLockögC⁄ãxà*)
pFûe
->
lockögC⁄ãxt
;

30344 if–
pCtx
->
c⁄chHñd
>0 ){

30345 
unixFûe
 *
¥oxy
 = 
pCtx
->
lockProxy
;

30346  
¥oxy
->
pMëhod
->
	`xCheckRe£rvedLock
((
sqlôe3_fûe
*Ìroxy, 
pResOut
);

30348 
pResOut
=0;

30351  
rc
;

30378 
	`¥oxyLock
(
sqlôe3_fûe
 *
id
, 
eFûeLock
) {

30379 
unixFûe
 *
pFûe
 = (unixFûe*)
id
;

30380 
rc
 = 
	`¥oxyTakeC⁄ch
(
pFûe
);

30381 if–
rc
==
SQLITE_OK
 ){

30382 
¥oxyLockögC⁄ãxt
 *
pCtx
 = (¥oxyLockögC⁄ãxà*)
pFûe
->
lockögC⁄ãxt
;

30383 if–
pCtx
->
c⁄chHñd
>0 ){

30384 
unixFûe
 *
¥oxy
 = 
pCtx
->
lockProxy
;

30385 
rc
 = 
¥oxy
->
pMëhod
->
	`xLock
((
sqlôe3_fûe
*Ìroxy, 
eFûeLock
);

30386 
pFûe
->
eFûeLock
 = 
¥oxy
->eFileLock;

30391  
rc
;

30402 
	`¥oxyU∆ock
(
sqlôe3_fûe
 *
id
, 
eFûeLock
) {

30403 
unixFûe
 *
pFûe
 = (unixFûe*)
id
;

30404 
rc
 = 
	`¥oxyTakeC⁄ch
(
pFûe
);

30405 if–
rc
==
SQLITE_OK
 ){

30406 
¥oxyLockögC⁄ãxt
 *
pCtx
 = (¥oxyLockögC⁄ãxà*)
pFûe
->
lockögC⁄ãxt
;

30407 if–
pCtx
->
c⁄chHñd
>0 ){

30408 
unixFûe
 *
¥oxy
 = 
pCtx
->
lockProxy
;

30409 
rc
 = 
¥oxy
->
pMëhod
->
	`xU∆ock
((
sqlôe3_fûe
*Ìroxy, 
eFûeLock
);

30410 
pFûe
->
eFûeLock
 = 
¥oxy
->eFileLock;

30415  
rc
;

30421 
	`¥oxyClo£
(
sqlôe3_fûe
 *
id
) {

30422 if–
id
 ){

30423 
unixFûe
 *
pFûe
 = (unixFûe*)
id
;

30424 
¥oxyLockögC⁄ãxt
 *
pCtx
 = (¥oxyLockögC⁄ãxà*)
pFûe
->
lockögC⁄ãxt
;

30425 
unixFûe
 *
lockProxy
 = 
pCtx
->lockProxy;

30426 
unixFûe
 *
c⁄chFûe
 = 
pCtx
->conchFile;

30427 
rc
 = 
SQLITE_OK
;

30429 if–
lockProxy
 ){

30430 
rc
 = 
lockProxy
->
pMëhod
->
	`xU∆ock
((
sqlôe3_fûe
*ÓockProxy, 
NO_LOCK
);

30431 if–
rc
 ) Ñc;

30432 
rc
 = 
lockProxy
->
pMëhod
->
	`xClo£
((
sqlôe3_fûe
*)lockProxy);

30433 if–
rc
 ) Ñc;

30434 
	`sqlôe3_‰ì
(
lockProxy
);

30435 
pCtx
->
lockProxy
 = 0;

30437 if–
c⁄chFûe
 ){

30438 if–
pCtx
->
c⁄chHñd
 ){

30439 
rc
 = 
	`¥oxyRñó£C⁄ch
(
pFûe
);

30440 if–
rc
 ) Ñc;

30442 
rc
 = 
c⁄chFûe
->
pMëhod
->
	`xClo£
((
sqlôe3_fûe
*)conchFile);

30443 if–
rc
 ) Ñc;

30444 
	`sqlôe3_‰ì
(
c⁄chFûe
);

30446 
	`sqlôe3DbFªe
(0, 
pCtx
->
lockProxyP©h
);

30447 
	`sqlôe3_‰ì
(
pCtx
->
c⁄chFûeP©h
);

30448 
	`sqlôe3DbFªe
(0, 
pCtx
->
dbP©h
);

30450 
pFûe
->
lockögC⁄ãxt
 = 
pCtx
->
ﬁdLockögC⁄ãxt
;

30451 
pFûe
->
pMëhod
 = 
pCtx
->
pOldMëhod
;

30452 
	`sqlôe3_‰ì
(
pCtx
);

30453  
pFûe
->
pMëhod
->
	`xClo£
(
id
);

30455  
SQLITE_OK
;

30483 
SQLITE_API
 
	`sqlôe3_os_öô
(){

30504 
	#UNIXVFS
(
VFSNAME
, 
FINDER
) { \

30506 (
unixFûe
), \

30507 
MAX_PATHNAME
, \

30509 
VFSNAME
, \

30510 (*)&
FINDER
, \

30511 
unixO≥n
, \

30512 
unixDñëe
, \

30513 
unixAc˚ss
, \

30514 
unixFuŒP©h«me
, \

30515 
unixDlO≥n
, \

30516 
unixDlEº‹
, \

30517 
unixDlSym
, \

30518 
unixDlClo£
, \

30519 
unixR™dom√ss
, \

30520 
unixSÀï
, \

30521 
unixCuºítTime
, \

30522 
unixGëLa°Eº‹
, \

30523 
unixCuºítTimeI¡64
, \

30524 
unixSëSy°emCÆl
, \

30525 
unixGëSy°emCÆl
, \

30526 
unixNextSy°emCÆl
, \

30527 }

	)

30536 
sqlôe3_vfs
 
aVfs
[] = {

30537 #i‡
SQLITE_ENABLE_LOCKING_STYLE
 && (
OS_VXWORKS
 || 
	`deföed
(
__APPLE__
))

30538 
	`UNIXVFS
("unix", 
autﬁockIoFödî
 ),

30540 
	`UNIXVFS
("unix", 
posixIoFödî
 ),

30542 
	`UNIXVFS
("unix-n⁄e", 
nﬁockIoFödî
 ),

30543 
	`UNIXVFS
("unix-dŸfûe", 
dŸlockIoFödî
 ),

30544 
	`UNIXVFS
("unix-ex˛", 
posixIoFödî
 ),

30545 #i‡
OS_VXWORKS


30546 
	`UNIXVFS
("unix-«med£m", 
£mIoFödî
 ),

30548 #i‡
SQLITE_ENABLE_LOCKING_STYLE


30549 
	`UNIXVFS
("unix-posix", 
posixIoFödî
 ),

30550 #i‡!
OS_VXWORKS


30551 
	`UNIXVFS
("unix-Êock", 
ÊockIoFödî
 ),

30554 #i‡
SQLITE_ENABLE_LOCKING_STYLE
 && 
	`deföed
(
__APPLE__
)

30555 
	`UNIXVFS
("unix-aÂ", 
aÂIoFödî
 ),

30556 
	`UNIXVFS
("unix-nfs", 
nfsIoFödî
 ),

30557 
	`UNIXVFS
("unix-¥oxy", 
¥oxyIoFödî
 ),

30560 
i
;

30564 
	`as£π
–
	`AºaySize
(
aSysˇŒ
)==24 );

30567 
i
=0; i<((
aVfs
)/(
sqlôe3_vfs
)); i++){

30568 
	`sqlôe3_vfs_ªgi°î
(&
aVfs
[
i
], i==0);

30570  
SQLITE_OK
;

30580 
SQLITE_API
 
	`sqlôe3_os_íd
(){

30581  
SQLITE_OK
;

30602 #i‡
SQLITE_OS_WIN


30604 #ifde‡
__CYGWIN__


30605 
	~<sys/cygwö.h
>

30606 
	~<î∫o.h
>

30633 #i‚de‡
_OS_COMMON_H_


30634 
	#_OS_COMMON_H_


	)

30641 #ifde‡
MEMORY_DEBUG


30645 #i‡
	`deföed
(
SQLITE_TEST
Ë&& deföed(
SQLITE_DEBUG
)

30646 #i‚de‡
SQLITE_DEBUG_OS_TRACE


30647 
	#SQLITE_DEBUG_OS_TRACE
 0

	)

30649 
sqlôe3OSTø˚
 = 
SQLITE_DEBUG_OS_TRACE
;

30650 
	#OSTRACE
(
X
Ëif–
sqlôe3OSTø˚
 ) 
sqlôe3DebugPrötf
 
	)
X

30652 
	#OSTRACE
(
X
)

	)

30659 #ifde‡
SQLITE_PERFORMANCE_TRACE


30682 #i‚de‡
_HWTIME_H_


30683 
	#_HWTIME_H_


	)

30691 #i‡(
	`deföed
(
__GNUC__
Ë|| deföed(
_MSC_VER
)) && \

30692 (
	`deföed
(
i386
Ë|| deföed(
__i386__
Ë|| deföed(
_M_IX86
))

30694 #i‡
	`deföed
(
__GNUC__
)

30696 
__ölöe__
 
sqlôe_uöt64
 
	`sqlôe3Hwtime
(){

30697 
lo
, 
hi
;

30698 
__asm__
 
	`__vﬁ©ûe__
 ("rdtsc" : "˜" (
lo
), "=d" (
hi
));

30699  (
sqlôe_uöt64
)
hi
 << 32 | 
lo
;

30702 #ñi‡
	`deföed
(
_MSC_VER
)

30704 
	`__de˛•ec
(
«ked
Ë
__ölöe
 
sqlôe_uöt64
 
__cde˛
 
	`sqlôe3Hwtime
(){

30705 
__asm
 {

30706 
rdtsc


30707 
ªt
 ;  
vÆue
 
©
 
EDX
:
EAX


30713 #ñi‡(
	`deföed
(
__GNUC__
Ë&& deföed(
__x86_64__
))

30715 
__ölöe__
 
sqlôe_uöt64
 
	`sqlôe3Hwtime
(){

30716 
vÆ
;

30717 
__asm__
 
	`__vﬁ©ûe__
 ("rdtsc" : "=A" (
vÆ
));

30718  
vÆ
;

30721 #ñi‡(
	`deföed
(
__GNUC__
Ë&& deföed(
__µc__
))

30723 
__ölöe__
 
sqlôe_uöt64
 
	`sqlôe3Hwtime
(){

30724 
ªtvÆ
;

30725 
junk
;

30726 
__asm__
 
	`__vﬁ©ûe__
 ("\n\
1: mftbu %1\n\
 %L0\n\
 %0\n\
 %0,%1\n\
 1b"

30732 : "Ù" (
ªtvÆ
), "Ù" (
junk
));

30733  
ªtvÆ
;

30738 #îr‹ 
Nìd
 
im∂emíèti⁄
 
of
 
	`sqlôe3Hwtime
(Ë
your
 
∂©f‹m
.

30747 
SQLITE_PRIVATE
 
sqlôe_uöt64
 
	`sqlôe3Hwtime
(){  ((sqlite_uint64)0); }

30756 
sqlôe_uöt64
 
g_°¨t
;

30757 
sqlôe_uöt64
 
g_ñ≠£d
;

30758 
	#TIMER_START
 
g_°¨t
=
	`sqlôe3Hwtime
()

	)

30759 
	#TIMER_END
 
g_ñ≠£d
=
	`sqlôe3Hwtime
()-
g_°¨t


	)

30760 
	#TIMER_ELAPSED
 
g_ñ≠£d


	)

30762 
	#TIMER_START


	)

30763 
	#TIMER_END


	)

30764 
	#TIMER_ELAPSED
 ((
sqlôe_uöt64
)0)

	)

30772 #ifde‡
SQLITE_TEST


30773 
SQLITE_API
 
sqlôe3_io_îr‹_hô
 = 0;

30774 
SQLITE_API
 
sqlôe3_io_îr‹_h¨dhô
 = 0;

30775 
SQLITE_API
 
sqlôe3_io_îr‹_≥ndög
 = 0;

30776 
SQLITE_API
 
sqlôe3_io_îr‹_≥rsi°
 = 0;

30777 
SQLITE_API
 
sqlôe3_io_îr‹_bíign
 = 0;

30778 
SQLITE_API
 
sqlôe3_diskfuŒ_≥ndög
 = 0;

30779 
SQLITE_API
 
sqlôe3_diskfuŒ
 = 0;

30780 
	#SimuœãIOEº‹Bíign
(
X
Ë
sqlôe3_io_îr‹_bíign
=(X)

	)

30781 
	#SimuœãIOEº‹
(
CODE
) \

30782 if–(
sqlôe3_io_îr‹_≥rsi°
 && 
sqlôe3_io_îr‹_hô
) \

30783 || 
sqlôe3_io_îr‹_≥ndög
-- == 1 ) \

30784 { 
	`loˇl_i€º
(); 
CODE
; }

	)

30785 
	`loˇl_i€º
(){

30786 
	`IOTRACE
(("IOERR\n"));

30787 
sqlôe3_io_îr‹_hô
++;

30788 if–!
sqlôe3_io_îr‹_bíign
 ) 
sqlôe3_io_îr‹_h¨dhô
++;

30790 
	#SimuœãDiskfuŒEº‹
(
CODE
) \

30791 if–
sqlôe3_diskfuŒ_≥ndög
 ){ \

30792 if–
sqlôe3_diskfuŒ_≥ndög
 == 1 ){ \

30793 
	`loˇl_i€º
(); \

30794 
sqlôe3_diskfuŒ
 = 1; \

30795 
sqlôe3_io_îr‹_hô
 = 1; \

30796 
CODE
; \

30798 
sqlôe3_diskfuŒ_≥ndög
--; \

30800 }

	)

30802 
	#SimuœãIOEº‹Bíign
(
X
)

	)

30803 
	#SimuœãIOEº‹
(
A
)

	)

30804 
	#SimuœãDiskfuŒEº‹
(
A
)

	)

30810 #ifde‡
SQLITE_TEST


30811 
SQLITE_API
 
sqlôe3_›í_fûe_cou¡
 = 0;

30812 
	#O≥nCou¡î
(
X
Ë
sqlôe3_›í_fûe_cou¡
+=(X)

	)

30814 
	#O≥nCou¡î
(
X
)

	)

30826 #i‡!
SQLITE_OS_WINNT
 && !
	`deföed
(
SQLITE_OMIT_WAL
)

30835 #i‡!
SQLITE_OS_WINCE
 && !
SQLITE_OS_WINRT
 && !
	`deföed
(
SQLITE_WIN32_NO_ANSI
)

30836 
	#SQLITE_WIN32_HAS_ANSI


	)

30843 #i‡(
SQLITE_OS_WINCE
 || 
SQLITE_OS_WINNT
 || 
SQLITE_OS_WINRT
) && \

30844 !
	`deföed
(
SQLITE_WIN32_NO_WIDE
)

30845 
	#SQLITE_WIN32_HAS_WIDE


	)

30851 #i‡!
	`deföed
(
SQLITE_WIN32_HAS_ANSI
Ë&& !deföed(
SQLITE_WIN32_HAS_WIDE
)

30860 #i‚de‡
SQLITE_WIN32_MAX_PATH_CHARS


30861 
	#SQLITE_WIN32_MAX_PATH_CHARS
 (
MAX_PATH
)

	)

30868 #i‚de‡
SQLITE_WINNT_MAX_PATH_CHARS


30869 
	#SQLITE_WINNT_MAX_PATH_CHARS
 (32767)

	)

30877 #i‚de‡
SQLITE_WIN32_MAX_PATH_BYTES


30878 
	#SQLITE_WIN32_MAX_PATH_BYTES
 (
SQLITE_WIN32_MAX_PATH_CHARS
*4)

	)

30885 #i‚de‡
SQLITE_WINNT_MAX_PATH_BYTES


30886 
	#SQLITE_WINNT_MAX_PATH_BYTES
 \

30887 ((
WCHAR
Ë* 
SQLITE_WINNT_MAX_PATH_CHARS
)

	)

30893 #i‚de‡
SQLITE_WIN32_MAX_ERRMSG_CHARS


30894 
	#SQLITE_WIN32_MAX_ERRMSG_CHARS
 (1024)

	)

30901 #i‚de‡
wöIsDúSï


30902 
	#wöIsDúSï
(
a
Ë((◊Ë='/'Ë|| (◊Ë='\\'))

	)

30909 #i‚de‡
UNUSED_VARIABLE_VALUE


30910 
	#UNUSED_VARIABLE_VALUE
(
x
Ë()(x)

	)

30916 #i‚de‡
wöGëDúDï


30917 #ifde‡
__CYGWIN__


30918 
	#wöGëDúDï
(Ë"/"

	)

30920 
	#wöGëDúDï
(Ë"\\"

	)

30929 #i‡
SQLITE_WIN32_FILEMAPPING_API
 && !
	`deföed
(
SQLITE_OMIT_WAL
)

30934 #i‡
SQLITE_OS_WINRT


30935 
WINBASEAPI
 
HANDLE
 
WINAPI
 
	`Cª©eFûeM≠pögFromAµ
(HANDLE, \

30936 
LPSECURITY_ATTRIBUTES
, 
ULONG
, 
ULONG64
, 
LPCWSTR
);

30938 
WINBASEAPI
 
LPVOID
 
WINAPI
 
	`M≠VõwOfFûeFromAµ
(
HANDLE
, 
ULONG
, 
ULONG64
, 
SIZE_T
);

30940 #i‡
	`deföed
(
SQLITE_WIN32_HAS_ANSI
)

30941 
WINBASEAPI
 
HANDLE
 
WINAPI
 
	`Cª©eFûeM≠pögA
(HANDLE, 
LPSECURITY_ATTRIBUTES
, \

30942 
DWORD
, DWORD, DWORD, 
LPCSTR
);

30945 #i‡
	`deföed
(
SQLITE_WIN32_HAS_WIDE
)

30946 
WINBASEAPI
 
HANDLE
 
WINAPI
 
	`Cª©eFûeM≠pögW
(HANDLE, 
LPSECURITY_ATTRIBUTES
, \

30947 
DWORD
, DWORD, DWORD, 
LPCWSTR
);

30950 
WINBASEAPI
 
LPVOID
 
WINAPI
 
	`M≠VõwOfFûe
(
HANDLE
, 
DWORD
, DWORD, DWORD, 
SIZE_T
);

30956 
WINBASEAPI
 
BOOL
 
WINAPI
 
	`Unm≠VõwOfFûe
(
LPCVOID
);

30962 #i‚de‡
INVALID_FILE_ATTRIBUTES


30963 
	#INVALID_FILE_ATTRIBUTES
 ((
DWORD
)-1)

	)

30966 #i‚de‡
FILE_FLAG_MASK


30967 
	#FILE_FLAG_MASK
 (0xFF3C0000)

	)

30970 #i‚de‡
FILE_ATTRIBUTE_MASK


30971 
	#FILE_ATTRIBUTE_MASK
 (0x0003FFF7)

	)

30974 #i‚de‡
SQLITE_OMIT_WAL


30976 
wöShm
 
	twöShm
;

30977 
wöShmNode
 
	twöShmNode
;

30984 #i‡
SQLITE_OS_WINCE


30985 
	swö˚Lock
 {

30986 
nRódîs
;

30987 
BOOL
 
bPídög
;

30988 
BOOL
 
bRe£rved
;

30989 
BOOL
 
bEx˛usive
;

30990 } 
	twö˚Lock
;

30997 
wöFûe
 
	twöFûe
;

30998 
	swöFûe
 {

30999 c⁄° 
sqlôe3_io_mëhods
 *
pMëhod
;

31000 
sqlôe3_vfs
 *
pVfs
;

31001 
HANDLE
 
h
;

31002 
u8
 
lockty≥
;

31003 
sh¨edLockByã
;

31004 
u8
 
˘æFœgs
;

31005 
DWORD
 
œ°Eºno
;

31006 #i‚de‡
SQLITE_OMIT_WAL


31007 
wöShm
 *
pShm
;

31009 c⁄° *
zP©h
;

31010 
szChunk
;

31011 #i‡
SQLITE_OS_WINCE


31012 
LPWSTR
 
zDñëeOnClo£
;

31013 
HANDLE
 
hMuãx
;

31014 
HANDLE
 
hSh¨ed
;

31015 
wö˚Lock
 
loˇl
;

31016 
wö˚Lock
 *
sh¨ed
;

31018 #i‡
SQLITE_MAX_MMAP_SIZE
>0

31019 
nFëchOut
;

31020 
HANDLE
 
hM≠
;

31021 *
pM≠Regi⁄
;

31022 
sqlôe3_öt64
 
mm≠Size
;

31023 
sqlôe3_öt64
 
mm≠SizeA˘uÆ
;

31024 
sqlôe3_öt64
 
mm≠SizeMax
;

31031 
	#WINFILE_RDONLY
 0x02

	)

31032 
	#WINFILE_PERSIST_WAL
 0x04

	)

31033 
	#WINFILE_PSOW
 0x10

	)

31038 #i‚de‡
SQLITE_WIN32_DBG_BUF_SIZE


31039 
	#SQLITE_WIN32_DBG_BUF_SIZE
 (()(4096-(
DWORD
)))

	)

31046 #i‚de‡
SQLITE_WIN32_DATA_DIRECTORY_TYPE


31047 
	#SQLITE_WIN32_DATA_DIRECTORY_TYPE
 (1)

	)

31054 #i‚de‡
SQLITE_WIN32_TEMP_DIRECTORY_TYPE


31055 
	#SQLITE_WIN32_TEMP_DIRECTORY_TYPE
 (2)

	)

31062 #ifde‡
SQLITE_WIN32_MALLOC


31078 #i‚de‡
SQLITE_WIN32_HEAP_CREATE


31079 
	#SQLITE_WIN32_HEAP_CREATE
 (
TRUE
)

	)

31085 #i‚de‡
SQLITE_WIN32_HEAP_INIT_SIZE


31086 
	#SQLITE_WIN32_HEAP_INIT_SIZE
 ((
SQLITE_DEFAULT_CACHE_SIZE
) * \

31087 (
SQLITE_DEFAULT_PAGE_SIZE
Ë+ 4194304)

	)

31093 #i‚de‡
SQLITE_WIN32_HEAP_MAX_SIZE


31094 
	#SQLITE_WIN32_HEAP_MAX_SIZE
 (0)

	)

31101 #i‚de‡
SQLITE_WIN32_HEAP_FLAGS


31102 
	#SQLITE_WIN32_HEAP_FLAGS
 (0)

	)

31110 
wöMemD©a
 
	twöMemD©a
;

31111 
	swöMemD©a
 {

31112 #i‚de‡
NDEBUG


31113 
u32
 
magic
;

31115 
HANDLE
 
hHóp
;

31116 
BOOL
 
bOw√d
;

31119 #i‚de‡
NDEBUG


31120 
	#WINMEM_MAGIC
 0x42b2830b

	)

31123 
wöMemD©a
 
wö_mem_d©a
 = {

31124 #i‚de‡
NDEBUG


31125 
WINMEM_MAGIC
,

31127 
NULL
, 
FALSE


31130 #i‚de‡
NDEBUG


31131 
	#wöMemAs£πMagic
(Ë
	`as£π
–
wö_mem_d©a
.
magic
==
WINMEM_MAGIC
 )

	)

31133 
	#wöMemAs£πMagic
()

	)

31136 
	#wöMemGëHóp
(Ë
wö_mem_d©a
.
hHóp


	)

31138 *
	`wöMemMÆloc
(
nByãs
);

31139 
	`wöMemFªe
(*
pPri‹
);

31140 *
	`wöMemRóŒoc
(*
pPri‹
, 
nByãs
);

31141 
	`wöMemSize
(*
p
);

31142 
	`wöMemRoundup
(
n
);

31143 
	`wöMemInô
(*
pAµD©a
);

31144 
	`wöMemShutdown
(*
pAµD©a
);

31146 
SQLITE_PRIVATE
 c⁄° 
sqlôe3_mem_mëhods
 *
	`sqlôe3MemGëWö32
();

31161 #ifde‡
SQLITE_TEST


31162 
SQLITE_API
 
sqlôe3_os_ty≥
 = 0;

31163 #ñi‡!
SQLITE_OS_WINCE
 && !
SQLITE_OS_WINRT
 && \

31164 
	`deföed
(
SQLITE_WIN32_HAS_ANSI
Ë&& deföed(
SQLITE_WIN32_HAS_WIDE
)

31165 
sqlôe3_os_ty≥
 = 0;

31168 #i‚de‡
SYSCALL


31169 
	#SYSCALL
 
sqlôe3_sysˇŒ_±r


	)

31176 #i‡
SQLITE_OS_WINCE
 || 
SQLITE_OS_WINRT


31177 
	#osAªFûeApisANSI
(Ë1

	)

31186 
	swö_sysˇŒ
 {

31187 c⁄° *
zName
;

31188 
sqlôe3_sysˇŒ_±r
 
pCuºít
;

31189 
sqlôe3_sysˇŒ_±r
 
pDeÁu…
;

31190 } 
aSysˇŒ
[] = {

31191 #i‡!
SQLITE_OS_WINCE
 && !
SQLITE_OS_WINRT


31192 { "AªFûeApisANSI", (
SYSCALL
)
AªFûeApisANSI
, 0 },

31194 { "AªFûeApisANSI", (
SYSCALL
)0, 0 },

31197 #i‚de‡
osAªFûeApisANSI


31198 
	#osAªFûeApisANSI
 ((
	`BOOL
(
WINAPI
*)(
VOID
))
aSysˇŒ
[0].
pCuºít
)

	)

31201 #i‡
SQLITE_OS_WINCE
 && 
	`deföed
(
SQLITE_WIN32_HAS_WIDE
)

31202 { "Ch¨LowîW", (
SYSCALL
)
Ch¨LowîW
, 0 },

31204 { "Ch¨LowîW", (
SYSCALL
)0, 0 },

31207 
	#osCh¨LowîW
 ((
	`LPWSTR
(
WINAPI
*)(
LPWSTR
))
aSysˇŒ
[1].
pCuºít
)

	)

31209 #i‡
SQLITE_OS_WINCE
 && 
	`deföed
(
SQLITE_WIN32_HAS_WIDE
)

31210 { "Ch¨UµîW", (
SYSCALL
)
Ch¨UµîW
, 0 },

31212 { "Ch¨UµîW", (
SYSCALL
)0, 0 },

31215 
	#osCh¨UµîW
 ((
	`LPWSTR
(
WINAPI
*)(
LPWSTR
))
aSysˇŒ
[2].
pCuºít
)

	)

31217 { "Clo£H™dÀ", (
SYSCALL
)
Clo£H™dÀ
, 0 },

31219 
	#osClo£H™dÀ
 ((
	`BOOL
(
WINAPI
*)(
HANDLE
))
aSysˇŒ
[3].
pCuºít
)

	)

31221 #i‡
	`deföed
(
SQLITE_WIN32_HAS_ANSI
)

31222 { "Cª©eFûeA", (
SYSCALL
)
Cª©eFûeA
, 0 },

31224 { "Cª©eFûeA", (
SYSCALL
)0, 0 },

31227 
	#osCª©eFûeA
 ((
	`HANDLE
(
WINAPI
*)(
LPCSTR
,
DWORD
,DWORD, \

31228 
LPSECURITY_ATTRIBUTES
,
DWORD
,DWORD,
HANDLE
))
aSysˇŒ
[4].
pCuºít
)

	)

31230 #i‡!
SQLITE_OS_WINRT
 && 
	`deföed
(
SQLITE_WIN32_HAS_WIDE
)

31231 { "Cª©eFûeW", (
SYSCALL
)
Cª©eFûeW
, 0 },

31233 { "Cª©eFûeW", (
SYSCALL
)0, 0 },

31236 
	#osCª©eFûeW
 ((
	`HANDLE
(
WINAPI
*)(
LPCWSTR
,
DWORD
,DWORD, \

31237 
LPSECURITY_ATTRIBUTES
,
DWORD
,DWORD,
HANDLE
))
aSysˇŒ
[5].
pCuºít
)

	)

31239 #i‡(!
SQLITE_OS_WINRT
 && 
	`deföed
(
SQLITE_WIN32_HAS_ANSI
) && \

31240 !
	`deföed
(
SQLITE_OMIT_WAL
))

31241 { "Cª©eFûeM≠pögA", (
SYSCALL
)
Cª©eFûeM≠pögA
, 0 },

31243 { "Cª©eFûeM≠pögA", (
SYSCALL
)0, 0 },

31246 
	#osCª©eFûeM≠pögA
 ((
	`HANDLE
(
WINAPI
*)(
HANDLE
,
LPSECURITY_ATTRIBUTES
, \

31247 
DWORD
,DWORD,DWORD,
LPCSTR
))
aSysˇŒ
[6].
pCuºít
)

	)

31249 #i‡
SQLITE_OS_WINCE
 || (!
SQLITE_OS_WINRT
 && 
	`deföed
(
SQLITE_WIN32_HAS_WIDE
) && \

31250 !
	`deföed
(
SQLITE_OMIT_WAL
))

31251 { "Cª©eFûeM≠pögW", (
SYSCALL
)
Cª©eFûeM≠pögW
, 0 },

31253 { "Cª©eFûeM≠pögW", (
SYSCALL
)0, 0 },

31256 
	#osCª©eFûeM≠pögW
 ((
	`HANDLE
(
WINAPI
*)(
HANDLE
,
LPSECURITY_ATTRIBUTES
, \

31257 
DWORD
,DWORD,DWORD,
LPCWSTR
))
aSysˇŒ
[7].
pCuºít
)

	)

31259 #i‡!
SQLITE_OS_WINRT
 && 
	`deföed
(
SQLITE_WIN32_HAS_WIDE
)

31260 { "Cª©eMuãxW", (
SYSCALL
)
Cª©eMuãxW
, 0 },

31262 { "Cª©eMuãxW", (
SYSCALL
)0, 0 },

31265 
	#osCª©eMuãxW
 ((
	`HANDLE
(
WINAPI
*)(
LPSECURITY_ATTRIBUTES
,
BOOL
, \

31266 
LPCWSTR
))
aSysˇŒ
[8].
pCuºít
)

	)

31268 #i‡
	`deföed
(
SQLITE_WIN32_HAS_ANSI
)

31269 { "DñëeFûeA", (
SYSCALL
)
DñëeFûeA
, 0 },

31271 { "DñëeFûeA", (
SYSCALL
)0, 0 },

31274 
	#osDñëeFûeA
 ((
	`BOOL
(
WINAPI
*)(
LPCSTR
))
aSysˇŒ
[9].
pCuºít
)

	)

31276 #i‡
	`deföed
(
SQLITE_WIN32_HAS_WIDE
)

31277 { "DñëeFûeW", (
SYSCALL
)
DñëeFûeW
, 0 },

31279 { "DñëeFûeW", (
SYSCALL
)0, 0 },

31282 
	#osDñëeFûeW
 ((
	`BOOL
(
WINAPI
*)(
LPCWSTR
))
aSysˇŒ
[10].
pCuºít
)

	)

31284 #i‡
SQLITE_OS_WINCE


31285 { "FûeTimeToLoˇlFûeTime", (
SYSCALL
)
FûeTimeToLoˇlFûeTime
, 0 },

31287 { "FûeTimeToLoˇlFûeTime", (
SYSCALL
)0, 0 },

31290 
	#osFûeTimeToLoˇlFûeTime
 ((
	`BOOL
(
WINAPI
*)(
CONST
 
FILETIME
*, \

31291 
LPFILETIME
))
aSysˇŒ
[11].
pCuºít
)

	)

31293 #i‡
SQLITE_OS_WINCE


31294 { "FûeTimeToSy°emTime", (
SYSCALL
)
FûeTimeToSy°emTime
, 0 },

31296 { "FûeTimeToSy°emTime", (
SYSCALL
)0, 0 },

31299 
	#osFûeTimeToSy°emTime
 ((
	`BOOL
(
WINAPI
*)(
CONST
 
FILETIME
*, \

31300 
LPSYSTEMTIME
))
aSysˇŒ
[12].
pCuºít
)

	)

31302 { "FlushFûeBuf„rs", (
SYSCALL
)
FlushFûeBuf„rs
, 0 },

31304 
	#osFlushFûeBuf„rs
 ((
	`BOOL
(
WINAPI
*)(
HANDLE
))
aSysˇŒ
[13].
pCuºít
)

	)

31306 #i‡
	`deföed
(
SQLITE_WIN32_HAS_ANSI
)

31307 { "F‹m©MesßgeA", (
SYSCALL
)
F‹m©MesßgeA
, 0 },

31309 { "F‹m©MesßgeA", (
SYSCALL
)0, 0 },

31312 
	#osF‹m©MesßgeA
 ((
	`DWORD
(
WINAPI
*)(
DWORD
,
LPCVOID
,DWORD,DWORD,
LPSTR
, \

31313 
DWORD
,
va_li°
*))
aSysˇŒ
[14].
pCuºít
)

	)

31315 #i‡
	`deföed
(
SQLITE_WIN32_HAS_WIDE
)

31316 { "F‹m©MesßgeW", (
SYSCALL
)
F‹m©MesßgeW
, 0 },

31318 { "F‹m©MesßgeW", (
SYSCALL
)0, 0 },

31321 
	#osF‹m©MesßgeW
 ((
	`DWORD
(
WINAPI
*)(
DWORD
,
LPCVOID
,DWORD,DWORD,
LPWSTR
, \

31322 
DWORD
,
va_li°
*))
aSysˇŒ
[15].
pCuºít
)

	)

31324 #i‡!
	`deföed
(
SQLITE_OMIT_LOAD_EXTENSION
)

31325 { "FªeLibøry", (
SYSCALL
)
FªeLibøry
, 0 },

31327 { "FªeLibøry", (
SYSCALL
)0, 0 },

31330 
	#osFªeLibøry
 ((
	`BOOL
(
WINAPI
*)(
HMODULE
))
aSysˇŒ
[16].
pCuºít
)

	)

31332 { "GëCuºítPro˚ssId", (
SYSCALL
)
GëCuºítPro˚ssId
, 0 },

31334 
	#osGëCuºítPro˚ssId
 ((
	`DWORD
(
WINAPI
*)(
VOID
))
aSysˇŒ
[17].
pCuºít
)

	)

31336 #i‡!
SQLITE_OS_WINCE
 && 
	`deföed
(
SQLITE_WIN32_HAS_ANSI
)

31337 { "GëDiskFªeS∑˚A", (
SYSCALL
)
GëDiskFªeS∑˚A
, 0 },

31339 { "GëDiskFªeS∑˚A", (
SYSCALL
)0, 0 },

31342 
	#osGëDiskFªeS∑˚A
 ((
	`BOOL
(
WINAPI
*)(
LPCSTR
,
LPDWORD
,LPDWORD,LPDWORD, \

31343 
LPDWORD
))
aSysˇŒ
[18].
pCuºít
)

	)

31345 #i‡!
SQLITE_OS_WINCE
 && !
SQLITE_OS_WINRT
 && 
	`deföed
(
SQLITE_WIN32_HAS_WIDE
)

31346 { "GëDiskFªeS∑˚W", (
SYSCALL
)
GëDiskFªeS∑˚W
, 0 },

31348 { "GëDiskFªeS∑˚W", (
SYSCALL
)0, 0 },

31351 
	#osGëDiskFªeS∑˚W
 ((
	`BOOL
(
WINAPI
*)(
LPCWSTR
,
LPDWORD
,LPDWORD,LPDWORD, \

31352 
LPDWORD
))
aSysˇŒ
[19].
pCuºít
)

	)

31354 #i‡
	`deföed
(
SQLITE_WIN32_HAS_ANSI
)

31355 { "GëFûeAâribuãsA", (
SYSCALL
)
GëFûeAâribuãsA
, 0 },

31357 { "GëFûeAâribuãsA", (
SYSCALL
)0, 0 },

31360 
	#osGëFûeAâribuãsA
 ((
	`DWORD
(
WINAPI
*)(
LPCSTR
))
aSysˇŒ
[20].
pCuºít
)

	)

31362 #i‡!
SQLITE_OS_WINRT
 && 
	`deföed
(
SQLITE_WIN32_HAS_WIDE
)

31363 { "GëFûeAâribuãsW", (
SYSCALL
)
GëFûeAâribuãsW
, 0 },

31365 { "GëFûeAâribuãsW", (
SYSCALL
)0, 0 },

31368 
	#osGëFûeAâribuãsW
 ((
	`DWORD
(
WINAPI
*)(
LPCWSTR
))
aSysˇŒ
[21].
pCuºít
)

	)

31370 #i‡
	`deföed
(
SQLITE_WIN32_HAS_WIDE
)

31371 { "GëFûeAâribuãsExW", (
SYSCALL
)
GëFûeAâribuãsExW
, 0 },

31373 { "GëFûeAâribuãsExW", (
SYSCALL
)0, 0 },

31376 
	#osGëFûeAâribuãsExW
 ((
	`BOOL
(
WINAPI
*)(
LPCWSTR
,
GET_FILEEX_INFO_LEVELS
, \

31377 
LPVOID
))
aSysˇŒ
[22].
pCuºít
)

	)

31379 #i‡!
SQLITE_OS_WINRT


31380 { "GëFûeSize", (
SYSCALL
)
GëFûeSize
, 0 },

31382 { "GëFûeSize", (
SYSCALL
)0, 0 },

31385 
	#osGëFûeSize
 ((
	`DWORD
(
WINAPI
*)(
HANDLE
,
LPDWORD
))
aSysˇŒ
[23].
pCuºít
)

	)

31387 #i‡!
SQLITE_OS_WINCE
 && 
	`deföed
(
SQLITE_WIN32_HAS_ANSI
)

31388 { "GëFuŒP©hNameA", (
SYSCALL
)
GëFuŒP©hNameA
, 0 },

31390 { "GëFuŒP©hNameA", (
SYSCALL
)0, 0 },

31393 
	#osGëFuŒP©hNameA
 ((
	`DWORD
(
WINAPI
*)(
LPCSTR
,
DWORD
,
LPSTR
, \

31394 
LPSTR
*))
aSysˇŒ
[24].
pCuºít
)

	)

31396 #i‡!
SQLITE_OS_WINCE
 && !
SQLITE_OS_WINRT
 && 
	`deföed
(
SQLITE_WIN32_HAS_WIDE
)

31397 { "GëFuŒP©hNameW", (
SYSCALL
)
GëFuŒP©hNameW
, 0 },

31399 { "GëFuŒP©hNameW", (
SYSCALL
)0, 0 },

31402 
	#osGëFuŒP©hNameW
 ((
	`DWORD
(
WINAPI
*)(
LPCWSTR
,
DWORD
,
LPWSTR
, \

31403 
LPWSTR
*))
aSysˇŒ
[25].
pCuºít
)

	)

31405 { "GëLa°Eº‹", (
SYSCALL
)
GëLa°Eº‹
, 0 },

31407 
	#osGëLa°Eº‹
 ((
	`DWORD
(
WINAPI
*)(
VOID
))
aSysˇŒ
[26].
pCuºít
)

	)

31409 #i‡!
	`deföed
(
SQLITE_OMIT_LOAD_EXTENSION
)

31410 #i‡
SQLITE_OS_WINCE


31412 { "GëProcAddªssA", (
SYSCALL
)
GëProcAddªssA
, 0 },

31416 { "GëProcAddªssA", (
SYSCALL
)
GëProcAddªss
, 0 },

31419 { "GëProcAddªssA", (
SYSCALL
)0, 0 },

31422 
	#osGëProcAddªssA
 ((
	`FARPROC
(
WINAPI
*)(
HMODULE
, \

31423 
LPCSTR
))
aSysˇŒ
[27].
pCuºít
)

	)

31425 #i‡!
SQLITE_OS_WINRT


31426 { "GëSy°emInfo", (
SYSCALL
)
GëSy°emInfo
, 0 },

31428 { "GëSy°emInfo", (
SYSCALL
)0, 0 },

31431 
	#osGëSy°emInfo
 ((
	`VOID
(
WINAPI
*)(
LPSYSTEM_INFO
))
aSysˇŒ
[28].
pCuºít
)

	)

31433 { "GëSy°emTime", (
SYSCALL
)
GëSy°emTime
, 0 },

31435 
	#osGëSy°emTime
 ((
	`VOID
(
WINAPI
*)(
LPSYSTEMTIME
))
aSysˇŒ
[29].
pCuºít
)

	)

31437 #i‡!
SQLITE_OS_WINCE


31438 { "GëSy°emTimeAsFûeTime", (
SYSCALL
)
GëSy°emTimeAsFûeTime
, 0 },

31440 { "GëSy°emTimeAsFûeTime", (
SYSCALL
)0, 0 },

31443 
	#osGëSy°emTimeAsFûeTime
 ((
	`VOID
(
WINAPI
*)( \

31444 
LPFILETIME
))
aSysˇŒ
[30].
pCuºít
)

	)

31446 #i‡
	`deföed
(
SQLITE_WIN32_HAS_ANSI
)

31447 { "GëTempP©hA", (
SYSCALL
)
GëTempP©hA
, 0 },

31449 { "GëTempP©hA", (
SYSCALL
)0, 0 },

31452 
	#osGëTempP©hA
 ((
	`DWORD
(
WINAPI
*)(
DWORD
,
LPSTR
))
aSysˇŒ
[31].
pCuºít
)

	)

31454 #i‡!
SQLITE_OS_WINRT
 && 
	`deföed
(
SQLITE_WIN32_HAS_WIDE
)

31455 { "GëTempP©hW", (
SYSCALL
)
GëTempP©hW
, 0 },

31457 { "GëTempP©hW", (
SYSCALL
)0, 0 },

31460 
	#osGëTempP©hW
 ((
	`DWORD
(
WINAPI
*)(
DWORD
,
LPWSTR
))
aSysˇŒ
[32].
pCuºít
)

	)

31462 #i‡!
SQLITE_OS_WINRT


31463 { "GëTickCou¡", (
SYSCALL
)
GëTickCou¡
, 0 },

31465 { "GëTickCou¡", (
SYSCALL
)0, 0 },

31468 
	#osGëTickCou¡
 ((
	`DWORD
(
WINAPI
*)(
VOID
))
aSysˇŒ
[33].
pCuºít
)

	)

31470 #i‡
	`deföed
(
SQLITE_WIN32_HAS_ANSI
)

31471 { "GëVîsi⁄ExA", (
SYSCALL
)
GëVîsi⁄ExA
, 0 },

31473 { "GëVîsi⁄ExA", (
SYSCALL
)0, 0 },

31476 
	#osGëVîsi⁄ExA
 ((
	`BOOL
(
WINAPI
*)( \

31477 
LPOSVERSIONINFOA
))
aSysˇŒ
[34].
pCuºít
)

	)

31479 #i‡!
SQLITE_OS_WINRT
 && 
	`deföed
(
SQLITE_WIN32_HAS_WIDE
)

31480 { "GëVîsi⁄ExW", (
SYSCALL
)
GëVîsi⁄ExW
, 0 },

31482 { "GëVîsi⁄ExW", (
SYSCALL
)0, 0 },

31485 
	#osGëVîsi⁄ExW
 ((
	`BOOL
(
WINAPI
*)( \

31486 
LPOSVERSIONINFOW
))
aSysˇŒ
[35].
pCuºít
)

	)

31488 { "HópAŒoc", (
SYSCALL
)
HópAŒoc
, 0 },

31490 
	#osHópAŒoc
 ((
	`LPVOID
(
WINAPI
*)(
HANDLE
,
DWORD
, \

31491 
SIZE_T
))
aSysˇŒ
[36].
pCuºít
)

	)

31493 #i‡!
SQLITE_OS_WINRT


31494 { "HópCª©e", (
SYSCALL
)
HópCª©e
, 0 },

31496 { "HópCª©e", (
SYSCALL
)0, 0 },

31499 
	#osHópCª©e
 ((
	`HANDLE
(
WINAPI
*)(
DWORD
,
SIZE_T
, \

31500 
SIZE_T
))
aSysˇŒ
[37].
pCuºít
)

	)

31502 #i‡!
SQLITE_OS_WINRT


31503 { "HópDe°roy", (
SYSCALL
)
HópDe°roy
, 0 },

31505 { "HópDe°roy", (
SYSCALL
)0, 0 },

31508 
	#osHópDe°roy
 ((
	`BOOL
(
WINAPI
*)(
HANDLE
))
aSysˇŒ
[38].
pCuºít
)

	)

31510 { "HópFªe", (
SYSCALL
)
HópFªe
, 0 },

31512 
	#osHópFªe
 ((
	`BOOL
(
WINAPI
*)(
HANDLE
,
DWORD
,
LPVOID
))
aSysˇŒ
[39].
pCuºít
)

	)

31514 { "HópReAŒoc", (
SYSCALL
)
HópReAŒoc
, 0 },

31516 
	#osHópReAŒoc
 ((
	`LPVOID
(
WINAPI
*)(
HANDLE
,
DWORD
,
LPVOID
, \

31517 
SIZE_T
))
aSysˇŒ
[40].
pCuºít
)

	)

31519 { "HópSize", (
SYSCALL
)
HópSize
, 0 },

31521 
	#osHópSize
 ((
	`SIZE_T
(
WINAPI
*)(
HANDLE
,
DWORD
, \

31522 
LPCVOID
))
aSysˇŒ
[41].
pCuºít
)

	)

31524 #i‡!
SQLITE_OS_WINRT


31525 { "HópVÆid©e", (
SYSCALL
)
HópVÆid©e
, 0 },

31527 { "HópVÆid©e", (
SYSCALL
)0, 0 },

31530 
	#osHópVÆid©e
 ((
	`BOOL
(
WINAPI
*)(
HANDLE
,
DWORD
, \

31531 
LPCVOID
))
aSysˇŒ
[42].
pCuºít
)

	)

31533 #i‡
	`deföed
(
SQLITE_WIN32_HAS_ANSI
Ë&& !deföed(
SQLITE_OMIT_LOAD_EXTENSION
)

31534 { "LﬂdLibøryA", (
SYSCALL
)
LﬂdLibøryA
, 0 },

31536 { "LﬂdLibøryA", (
SYSCALL
)0, 0 },

31539 
	#osLﬂdLibøryA
 ((
	`HMODULE
(
WINAPI
*)(
LPCSTR
))
aSysˇŒ
[43].
pCuºít
)

	)

31541 #i‡!
SQLITE_OS_WINRT
 && 
	`deföed
(
SQLITE_WIN32_HAS_WIDE
) && \

31542 !
	`deföed
(
SQLITE_OMIT_LOAD_EXTENSION
)

31543 { "LﬂdLibøryW", (
SYSCALL
)
LﬂdLibøryW
, 0 },

31545 { "LﬂdLibøryW", (
SYSCALL
)0, 0 },

31548 
	#osLﬂdLibøryW
 ((
	`HMODULE
(
WINAPI
*)(
LPCWSTR
))
aSysˇŒ
[44].
pCuºít
)

	)

31550 #i‡!
SQLITE_OS_WINRT


31551 { "LoˇlFªe", (
SYSCALL
)
LoˇlFªe
, 0 },

31553 { "LoˇlFªe", (
SYSCALL
)0, 0 },

31556 
	#osLoˇlFªe
 ((
	`HLOCAL
(
WINAPI
*)(
HLOCAL
))
aSysˇŒ
[45].
pCuºít
)

	)

31558 #i‡!
SQLITE_OS_WINCE
 && !
SQLITE_OS_WINRT


31559 { "LockFûe", (
SYSCALL
)
LockFûe
, 0 },

31561 { "LockFûe", (
SYSCALL
)0, 0 },

31564 #i‚de‡
osLockFûe


31565 
	#osLockFûe
 ((
	`BOOL
(
WINAPI
*)(
HANDLE
,
DWORD
,DWORD,DWORD, \

31566 
DWORD
))
aSysˇŒ
[46].
pCuºít
)

	)

31569 #i‡!
SQLITE_OS_WINCE


31570 { "LockFûeEx", (
SYSCALL
)
LockFûeEx
, 0 },

31572 { "LockFûeEx", (
SYSCALL
)0, 0 },

31575 #i‚de‡
osLockFûeEx


31576 
	#osLockFûeEx
 ((
	`BOOL
(
WINAPI
*)(
HANDLE
,
DWORD
,DWORD,DWORD,DWORD, \

31577 
LPOVERLAPPED
))
aSysˇŒ
[47].
pCuºít
)

	)

31580 #i‡
SQLITE_OS_WINCE
 || (!
SQLITE_OS_WINRT
 && !
	`deföed
(
SQLITE_OMIT_WAL
))

31581 { "M≠VõwOfFûe", (
SYSCALL
)
M≠VõwOfFûe
, 0 },

31583 { "M≠VõwOfFûe", (
SYSCALL
)0, 0 },

31586 
	#osM≠VõwOfFûe
 ((
	`LPVOID
(
WINAPI
*)(
HANDLE
,
DWORD
,DWORD,DWORD, \

31587 
SIZE_T
))
aSysˇŒ
[48].
pCuºít
)

	)

31589 { "Mu…iByãToWideCh¨", (
SYSCALL
)
Mu…iByãToWideCh¨
, 0 },

31591 
	#osMu…iByãToWideCh¨
 (((
WINAPI
*)(
UINT
,
DWORD
,
LPCSTR
,,
LPWSTR
, \

31592 ))
aSysˇŒ
[49].
pCuºít
)

	)

31594 { "QuîyPîf‹m™˚Cou¡î", (
SYSCALL
)
QuîyPîf‹m™˚Cou¡î
, 0 },

31596 
	#osQuîyPîf‹m™˚Cou¡î
 ((
	`BOOL
(
WINAPI
*)( \

31597 
LARGE_INTEGER
*))
aSysˇŒ
[50].
pCuºít
)

	)

31599 { "RódFûe", (
SYSCALL
)
RódFûe
, 0 },

31601 
	#osRódFûe
 ((
	`BOOL
(
WINAPI
*)(
HANDLE
,
LPVOID
,
DWORD
,
LPDWORD
, \

31602 
LPOVERLAPPED
))
aSysˇŒ
[51].
pCuºít
)

	)

31604 { "SëEndOfFûe", (
SYSCALL
)
SëEndOfFûe
, 0 },

31606 
	#osSëEndOfFûe
 ((
	`BOOL
(
WINAPI
*)(
HANDLE
))
aSysˇŒ
[52].
pCuºít
)

	)

31608 #i‡!
SQLITE_OS_WINRT


31609 { "SëFûePoöãr", (
SYSCALL
)
SëFûePoöãr
, 0 },

31611 { "SëFûePoöãr", (
SYSCALL
)0, 0 },

31614 
	#osSëFûePoöãr
 ((
	`DWORD
(
WINAPI
*)(
HANDLE
,
LONG
,
PLONG
, \

31615 
DWORD
))
aSysˇŒ
[53].
pCuºít
)

	)

31617 #i‡!
SQLITE_OS_WINRT


31618 { "SÀï", (
SYSCALL
)
SÀï
, 0 },

31620 { "SÀï", (
SYSCALL
)0, 0 },

31623 
	#osSÀï
 ((
	`VOID
(
WINAPI
*)(
DWORD
))
aSysˇŒ
[54].
pCuºít
)

	)

31625 { "Sy°emTimeToFûeTime", (
SYSCALL
)
Sy°emTimeToFûeTime
, 0 },

31627 
	#osSy°emTimeToFûeTime
 ((
	`BOOL
(
WINAPI
*)(
CONST
 
SYSTEMTIME
*, \

31628 
LPFILETIME
))
aSysˇŒ
[55].
pCuºít
)

	)

31630 #i‡!
SQLITE_OS_WINCE
 && !
SQLITE_OS_WINRT


31631 { "U∆ockFûe", (
SYSCALL
)
U∆ockFûe
, 0 },

31633 { "U∆ockFûe", (
SYSCALL
)0, 0 },

31636 #i‚de‡
osU∆ockFûe


31637 
	#osU∆ockFûe
 ((
	`BOOL
(
WINAPI
*)(
HANDLE
,
DWORD
,DWORD,DWORD, \

31638 
DWORD
))
aSysˇŒ
[56].
pCuºít
)

	)

31641 #i‡!
SQLITE_OS_WINCE


31642 { "U∆ockFûeEx", (
SYSCALL
)
U∆ockFûeEx
, 0 },

31644 { "U∆ockFûeEx", (
SYSCALL
)0, 0 },

31647 
	#osU∆ockFûeEx
 ((
	`BOOL
(
WINAPI
*)(
HANDLE
,
DWORD
,DWORD,DWORD, \

31648 
LPOVERLAPPED
))
aSysˇŒ
[57].
pCuºít
)

	)

31650 #i‡
SQLITE_OS_WINCE
 || !
	`deföed
(
SQLITE_OMIT_WAL
)

31651 { "Unm≠VõwOfFûe", (
SYSCALL
)
Unm≠VõwOfFûe
, 0 },

31653 { "Unm≠VõwOfFûe", (
SYSCALL
)0, 0 },

31656 
	#osUnm≠VõwOfFûe
 ((
	`BOOL
(
WINAPI
*)(
LPCVOID
))
aSysˇŒ
[58].
pCuºít
)

	)

31658 { "WideCh¨ToMu…iByã", (
SYSCALL
)
WideCh¨ToMu…iByã
, 0 },

31660 
	#osWideCh¨ToMu…iByã
 (((
WINAPI
*)(
UINT
,
DWORD
,
LPCWSTR
,,
LPSTR
,, \

31661 
LPCSTR
,
LPBOOL
))
aSysˇŒ
[59].
pCuºít
)

	)

31663 { "WrôeFûe", (
SYSCALL
)
WrôeFûe
, 0 },

31665 
	#osWrôeFûe
 ((
	`BOOL
(
WINAPI
*)(
HANDLE
,
LPCVOID
,
DWORD
,
LPDWORD
, \

31666 
LPOVERLAPPED
))
aSysˇŒ
[60].
pCuºít
)

	)

31668 #i‡
SQLITE_OS_WINRT


31669 { "Cª©eEvítExW", (
SYSCALL
)
Cª©eEvítExW
, 0 },

31671 { "Cª©eEvítExW", (
SYSCALL
)0, 0 },

31674 
	#osCª©eEvítExW
 ((
	`HANDLE
(
WINAPI
*)(
LPSECURITY_ATTRIBUTES
,
LPCWSTR
, \

31675 
DWORD
,DWORD))
aSysˇŒ
[61].
pCuºít
)

	)

31677 #i‡!
SQLITE_OS_WINRT


31678 { "WaôF‹SögÀObje˘", (
SYSCALL
)
WaôF‹SögÀObje˘
, 0 },

31680 { "WaôF‹SögÀObje˘", (
SYSCALL
)0, 0 },

31683 
	#osWaôF‹SögÀObje˘
 ((
	`DWORD
(
WINAPI
*)(
HANDLE
, \

31684 
DWORD
))
aSysˇŒ
[62].
pCuºít
)

	)

31686 #i‡
SQLITE_OS_WINRT


31687 { "WaôF‹SögÀObje˘Ex", (
SYSCALL
)
WaôF‹SögÀObje˘Ex
, 0 },

31689 { "WaôF‹SögÀObje˘Ex", (
SYSCALL
)0, 0 },

31692 
	#osWaôF‹SögÀObje˘Ex
 ((
	`DWORD
(
WINAPI
*)(
HANDLE
,
DWORD
, \

31693 
BOOL
))
aSysˇŒ
[63].
pCuºít
)

	)

31695 #i‡
SQLITE_OS_WINRT


31696 { "SëFûePoöãrEx", (
SYSCALL
)
SëFûePoöãrEx
, 0 },

31698 { "SëFûePoöãrEx", (
SYSCALL
)0, 0 },

31701 
	#osSëFûePoöãrEx
 ((
	`BOOL
(
WINAPI
*)(
HANDLE
,
LARGE_INTEGER
, \

31702 
PLARGE_INTEGER
,
DWORD
))
aSysˇŒ
[64].
pCuºít
)

	)

31704 #i‡
SQLITE_OS_WINRT


31705 { "GëFûeInf‹m©i⁄ByH™dÀEx", (
SYSCALL
)
GëFûeInf‹m©i⁄ByH™dÀEx
, 0 },

31707 { "GëFûeInf‹m©i⁄ByH™dÀEx", (
SYSCALL
)0, 0 },

31710 
	#osGëFûeInf‹m©i⁄ByH™dÀEx
 ((
	`BOOL
(
WINAPI
*)(
HANDLE
, \

31711 
FILE_INFO_BY_HANDLE_CLASS
,
LPVOID
,
DWORD
))
aSysˇŒ
[65].
pCuºít
)

	)

31713 #i‡
SQLITE_OS_WINRT
 && !
	`deföed
(
SQLITE_OMIT_WAL
)

31714 { "M≠VõwOfFûeFromAµ", (
SYSCALL
)
M≠VõwOfFûeFromAµ
, 0 },

31716 { "M≠VõwOfFûeFromAµ", (
SYSCALL
)0, 0 },

31719 
	#osM≠VõwOfFûeFromAµ
 ((
	`LPVOID
(
WINAPI
*)(
HANDLE
,
ULONG
,
ULONG64
, \

31720 
SIZE_T
))
aSysˇŒ
[66].
pCuºít
)

	)

31722 #i‡
SQLITE_OS_WINRT


31723 { "Cª©eFûe2", (
SYSCALL
)
Cª©eFûe2
, 0 },

31725 { "Cª©eFûe2", (
SYSCALL
)0, 0 },

31728 
	#osCª©eFûe2
 ((
	`HANDLE
(
WINAPI
*)(
LPCWSTR
,
DWORD
,DWORD,DWORD, \

31729 
LPCREATEFILE2_EXTENDED_PARAMETERS
))
aSysˇŒ
[67].
pCuºít
)

	)

31731 #i‡
SQLITE_OS_WINRT
 && !
	`deföed
(
SQLITE_OMIT_LOAD_EXTENSION
)

31732 { "LﬂdPackagedLibøry", (
SYSCALL
)
LﬂdPackagedLibøry
, 0 },

31734 { "LﬂdPackagedLibøry", (
SYSCALL
)0, 0 },

31737 
	#osLﬂdPackagedLibøry
 ((
	`HMODULE
(
WINAPI
*)(
LPCWSTR
, \

31738 
DWORD
))
aSysˇŒ
[68].
pCuºít
)

	)

31740 #i‡
SQLITE_OS_WINRT


31741 { "GëTickCou¡64", (
SYSCALL
)
GëTickCou¡64
, 0 },

31743 { "GëTickCou¡64", (
SYSCALL
)0, 0 },

31746 
	#osGëTickCou¡64
 ((
	`ULONGLONG
(
WINAPI
*)(
VOID
))
aSysˇŒ
[69].
pCuºít
)

	)

31748 #i‡
SQLITE_OS_WINRT


31749 { "GëN©iveSy°emInfo", (
SYSCALL
)
GëN©iveSy°emInfo
, 0 },

31751 { "GëN©iveSy°emInfo", (
SYSCALL
)0, 0 },

31754 
	#osGëN©iveSy°emInfo
 ((
	`VOID
(
WINAPI
*)( \

31755 
LPSYSTEM_INFO
))
aSysˇŒ
[70].
pCuºít
)

	)

31757 #i‡
	`deföed
(
SQLITE_WIN32_HAS_ANSI
)

31758 { "OuçutDebugSåögA", (
SYSCALL
)
OuçutDebugSåögA
, 0 },

31760 { "OuçutDebugSåögA", (
SYSCALL
)0, 0 },

31763 
	#osOuçutDebugSåögA
 ((
	`VOID
(
WINAPI
*)(
LPCSTR
))
aSysˇŒ
[71].
pCuºít
)

	)

31765 #i‡
	`deföed
(
SQLITE_WIN32_HAS_WIDE
)

31766 { "OuçutDebugSåögW", (
SYSCALL
)
OuçutDebugSåögW
, 0 },

31768 { "OuçutDebugSåögW", (
SYSCALL
)0, 0 },

31771 
	#osOuçutDebugSåögW
 ((
	`VOID
(
WINAPI
*)(
LPCWSTR
))
aSysˇŒ
[72].
pCuºít
)

	)

31773 { "GëPro˚ssHóp", (
SYSCALL
)
GëPro˚ssHóp
, 0 },

31775 
	#osGëPro˚ssHóp
 ((
	`HANDLE
(
WINAPI
*)(
VOID
))
aSysˇŒ
[73].
pCuºít
)

	)

31777 #i‡
SQLITE_OS_WINRT
 && !
	`deföed
(
SQLITE_OMIT_WAL
)

31778 { "Cª©eFûeM≠pögFromAµ", (
SYSCALL
)
Cª©eFûeM≠pögFromAµ
, 0 },

31780 { "Cª©eFûeM≠pögFromAµ", (
SYSCALL
)0, 0 },

31783 
	#osCª©eFûeM≠pögFromAµ
 ((
	`HANDLE
(
WINAPI
*)(
HANDLE
, \

31784 
LPSECURITY_ATTRIBUTES
,
ULONG
,
ULONG64
,
LPCWSTR
))
aSysˇŒ
[74].
pCuºít
)

	)

31794 
	`wöSëSy°emCÆl
(

31795 
sqlôe3_vfs
 *
pNŸU£d
,

31796 c⁄° *
zName
,

31797 
sqlôe3_sysˇŒ_±r
 
pNewFunc


31799 
i
;

31800 
rc
 = 
SQLITE_NOTFOUND
;

31802 
	`UNUSED_PARAMETER
(
pNŸU£d
);

31803 if–
zName
==0 ){

31807 
rc
 = 
SQLITE_OK
;

31808 
i
=0; i<(
aSysˇŒ
)/(aSyscall[0]); i++){

31809 if–
aSysˇŒ
[
i
].
pDeÁu…
 ){

31810 
aSysˇŒ
[
i
].
pCuºít
 =áSysˇŒ[i].
pDeÁu…
;

31817 
i
=0; i<(
aSysˇŒ
)/(aSyscall[0]); i++){

31818 if–
	`°rcmp
(
zName
, 
aSysˇŒ
[
i
].zName)==0 ){

31819 if–
aSysˇŒ
[
i
].
pDeÁu…
==0 ){

31820 
aSysˇŒ
[
i
].
pDeÁu…
 =áSysˇŒ[i].
pCuºít
;

31822 
rc
 = 
SQLITE_OK
;

31823 if–
pNewFunc
==0 )ÖNewFun¯
aSysˇŒ
[
i
].
pDeÁu…
;

31824 
aSysˇŒ
[
i
].
pCuºít
 = 
pNewFunc
;

31829  
rc
;

31837 
sqlôe3_sysˇŒ_±r
 
	`wöGëSy°emCÆl
(

31838 
sqlôe3_vfs
 *
pNŸU£d
,

31839 c⁄° *
zName


31841 
i
;

31843 
	`UNUSED_PARAMETER
(
pNŸU£d
);

31844 
i
=0; i<(
aSysˇŒ
)/(aSyscall[0]); i++){

31845 if–
	`°rcmp
(
zName
, 
aSysˇŒ
[
i
].zName)==0 ) áSysˇŒ[i].
pCuºít
;

31856 c⁄° *
	`wöNextSy°emCÆl
(
sqlôe3_vfs
 *
p
, c⁄° *
zName
){

31857 
i
 = -1;

31859 
	`UNUSED_PARAMETER
(
p
);

31860 if–
zName
 ){

31861 
i
=0; i<
	`AºaySize
(
aSysˇŒ
)-1; i++){

31862 if–
	`°rcmp
(
zName
, 
aSysˇŒ
[
i
].zName)==0 ) ;

31865 
i
++; i<
	`AºaySize
(
aSysˇŒ
); i++){

31866 if–
aSysˇŒ
[
i
].
pCuºít
!=0 ) áSysˇŒ[i].
zName
;

31876 
SQLITE_API
 
	`sqlôe3_wö32_wrôe_debug
(c⁄° *
zBuf
, 
nBuf
){

31877 
zDbgBuf
[
SQLITE_WIN32_DBG_BUF_SIZE
];

31878 
nMö
 = 
	`MIN
(
nBuf
, (
SQLITE_WIN32_DBG_BUF_SIZE
 - 1));

31879 if–
nMö
<-1 )ÇMin = -1;

31880 
	`as£π
–
nMö
==-1 ||ÇMö==0 ||ÇMö<
SQLITE_WIN32_DBG_BUF_SIZE
 );

31881 #i‡
	`deföed
(
SQLITE_WIN32_HAS_ANSI
)

31882 if–
nMö
>0 ){

31883 
	`mem£t
(
zDbgBuf
, 0, 
SQLITE_WIN32_DBG_BUF_SIZE
);

31884 
	`mem˝y
(
zDbgBuf
, 
zBuf
, 
nMö
);

31885 
	`osOuçutDebugSåögA
(
zDbgBuf
);

31887 
	`osOuçutDebugSåögA
(
zBuf
);

31889 #ñi‡
	`deföed
(
SQLITE_WIN32_HAS_WIDE
)

31890 
	`mem£t
(
zDbgBuf
, 0, 
SQLITE_WIN32_DBG_BUF_SIZE
);

31891 i‡–
	`osMu…iByãToWideCh¨
(

31892 
	`osAªFûeApisANSI
(Ë? 
CP_ACP
 : 
CP_OEMCP
, 0, 
zBuf
,

31893 
nMö
, (
LPWSTR
)
zDbgBuf
, 
SQLITE_WIN32_DBG_BUF_SIZE
/(
WCHAR
))<=0 ){

31896 
	`osOuçutDebugSåögW
((
LPCWSTR
)
zDbgBuf
);

31898 if–
nMö
>0 ){

31899 
	`mem£t
(
zDbgBuf
, 0, 
SQLITE_WIN32_DBG_BUF_SIZE
);

31900 
	`mem˝y
(
zDbgBuf
, 
zBuf
, 
nMö
);

31901 
	`Ârötf
(
°dîr
, "%s", 
zDbgBuf
);

31903 
	`Ârötf
(
°dîr
, "%s", 
zBuf
);

31912 #i‡
SQLITE_OS_WINRT


31913 
HANDLE
 
¶ìpObj
 = 
NULL
;

31916 
SQLITE_API
 
	`sqlôe3_wö32_¶ìp
(
DWORD
 
mûli£c⁄ds
){

31917 #i‡
SQLITE_OS_WINRT


31918 i‡–
¶ìpObj
==
NULL
 ){

31919 
¶ìpObj
 = 
	`osCª©eEvítExW
(
NULL
, NULL, 
CREATE_EVENT_MANUAL_RESET
,

31920 
SYNCHRONIZE
);

31922 
	`as£π
–
¶ìpObj
!=
NULL
 );

31923 
	`osWaôF‹SögÀObje˘Ex
(
¶ìpObj
, 
mûli£c⁄ds
, 
FALSE
);

31925 
	`osSÀï
(
mûli£c⁄ds
);

31940 #i‚de‡
NTDDI_WIN8


31941 
	#NTDDI_WIN8
 0x06020000

	)

31944 #i‡
SQLITE_OS_WINCE
 || 
SQLITE_OS_WINRT
 || !
	`deföed
(
SQLITE_WIN32_HAS_ANSI
)

31945 
	#osIsNT
(Ë(1)

	)

31946 #ñi‡!
	`deföed
(
SQLITE_WIN32_HAS_WIDE
)

31947 
	#osIsNT
(Ë(0)

	)

31949 
	`osIsNT
(){

31950 if–
sqlôe3_os_ty≥
==0 ){

31951 #i‡
	`deföed
(
NTDDI_VERSION
Ë&& NTDDI_VERSION >
NTDDI_WIN8


31952 
OSVERSIONINFOW
 
sInfo
;

31953 
sInfo
.
dwOSVîsi⁄InfoSize
 = (sInfo);

31954 
	`osGëVîsi⁄ExW
(&
sInfo
);

31956 
OSVERSIONINFOA
 
sInfo
;

31957 
sInfo
.
dwOSVîsi⁄InfoSize
 = (sInfo);

31958 
	`osGëVîsi⁄ExA
(&
sInfo
);

31960 
sqlôe3_os_ty≥
 = 
sInfo
.
dwPœtf‹mId
==
VER_PLATFORM_WIN32_NT
 ? 2 : 1;

31962  
sqlôe3_os_ty≥
==2;

31966 #ifde‡
SQLITE_WIN32_MALLOC


31970 *
	`wöMemMÆloc
(
nByãs
){

31971 
HANDLE
 
hHóp
;

31972 *
p
;

31974 
	`wöMemAs£πMagic
();

31975 
hHóp
 = 
	`wöMemGëHóp
();

31976 
	`as£π
–
hHóp
!=0 );

31977 
	`as£π
–
hHóp
!=
INVALID_HANDLE_VALUE
 );

31978 #i‡!
SQLITE_OS_WINRT
 && 
	`deföed
(
SQLITE_WIN32_MALLOC_VALIDATE
)

31979 
	`as£π
 ( 
	`osHópVÆid©e
(
hHóp
, 
SQLITE_WIN32_HEAP_FLAGS
, 
NULL
) );

31981 
	`as£π
–
nByãs
>=0 );

31982 
p
 = 
	`osHópAŒoc
(
hHóp
, 
SQLITE_WIN32_HEAP_FLAGS
, (
SIZE_T
)
nByãs
);

31983 if–!
p
 ){

31984 
	`sqlôe3_log
(
SQLITE_NOMEM
, "failedÅo HeapAlloc %u bytes (%lu), heap=%p",

31985 
nByãs
, 
	`osGëLa°Eº‹
(), (*)
hHóp
);

31987  
p
;

31993 
	`wöMemFªe
(*
pPri‹
){

31994 
HANDLE
 
hHóp
;

31996 
	`wöMemAs£πMagic
();

31997 
hHóp
 = 
	`wöMemGëHóp
();

31998 
	`as£π
–
hHóp
!=0 );

31999 
	`as£π
–
hHóp
!=
INVALID_HANDLE_VALUE
 );

32000 #i‡!
SQLITE_OS_WINRT
 && 
	`deföed
(
SQLITE_WIN32_MALLOC_VALIDATE
)

32001 
	`as£π
 ( 
	`osHópVÆid©e
(
hHóp
, 
SQLITE_WIN32_HEAP_FLAGS
, 
pPri‹
) );

32003 if–!
pPri‹
 ) ;

32004 if–!
	`osHópFªe
(
hHóp
, 
SQLITE_WIN32_HEAP_FLAGS
, 
pPri‹
) ){

32005 
	`sqlôe3_log
(
SQLITE_NOMEM
, "failedÅo HeapFree block %p (%lu), heap=%p",

32006 
pPri‹
, 
	`osGëLa°Eº‹
(), (*)
hHóp
);

32013 *
	`wöMemRóŒoc
(*
pPri‹
, 
nByãs
){

32014 
HANDLE
 
hHóp
;

32015 *
p
;

32017 
	`wöMemAs£πMagic
();

32018 
hHóp
 = 
	`wöMemGëHóp
();

32019 
	`as£π
–
hHóp
!=0 );

32020 
	`as£π
–
hHóp
!=
INVALID_HANDLE_VALUE
 );

32021 #i‡!
SQLITE_OS_WINRT
 && 
	`deföed
(
SQLITE_WIN32_MALLOC_VALIDATE
)

32022 
	`as£π
 ( 
	`osHópVÆid©e
(
hHóp
, 
SQLITE_WIN32_HEAP_FLAGS
, 
pPri‹
) );

32024 
	`as£π
–
nByãs
>=0 );

32025 if–!
pPri‹
 ){

32026 
p
 = 
	`osHópAŒoc
(
hHóp
, 
SQLITE_WIN32_HEAP_FLAGS
, (
SIZE_T
)
nByãs
);

32028 
p
 = 
	`osHópReAŒoc
(
hHóp
, 
SQLITE_WIN32_HEAP_FLAGS
, 
pPri‹
, (
SIZE_T
)
nByãs
);

32030 if–!
p
 ){

32031 
	`sqlôe3_log
(
SQLITE_NOMEM
, "failedÅo %s %u bytes (%lu), heap=%p",

32032 
pPri‹
 ? "HópReAŒoc" : "HópAŒoc", 
nByãs
, 
	`osGëLa°Eº‹
(),

32033 (*)
hHóp
);

32035  
p
;

32041 
	`wöMemSize
(*
p
){

32042 
HANDLE
 
hHóp
;

32043 
SIZE_T
 
n
;

32045 
	`wöMemAs£πMagic
();

32046 
hHóp
 = 
	`wöMemGëHóp
();

32047 
	`as£π
–
hHóp
!=0 );

32048 
	`as£π
–
hHóp
!=
INVALID_HANDLE_VALUE
 );

32049 #i‡!
SQLITE_OS_WINRT
 && 
	`deföed
(
SQLITE_WIN32_MALLOC_VALIDATE
)

32050 
	`as£π
 ( 
	`osHópVÆid©e
(
hHóp
, 
SQLITE_WIN32_HEAP_FLAGS
, 
NULL
) );

32052 if–!
p
 )  0;

32053 
n
 = 
	`osHópSize
(
hHóp
, 
SQLITE_WIN32_HEAP_FLAGS
, 
p
);

32054 if–
n
==(
SIZE_T
)-1 ){

32055 
	`sqlôe3_log
(
SQLITE_NOMEM
, "failedÅo HeapSize block %p (%lu), heap=%p",

32056 
p
, 
	`osGëLa°Eº‹
(), (*)
hHóp
);

32059  ()
n
;

32065 
	`wöMemRoundup
(
n
){

32066  
n
;

32072 
	`wöMemInô
(*
pAµD©a
){

32073 
wöMemD©a
 *
pWöMemD©a
 = (wöMemD©®*)
pAµD©a
;

32075 if–!
pWöMemD©a
 )  
SQLITE_ERROR
;

32076 
	`as£π
–
pWöMemD©a
->
magic
==
WINMEM_MAGIC
 );

32078 #i‡!
SQLITE_OS_WINRT
 && 
SQLITE_WIN32_HEAP_CREATE


32079 if–!
pWöMemD©a
->
hHóp
 ){

32080 
pWöMemD©a
->
hHóp
 = 
	`osHópCª©e
(
SQLITE_WIN32_HEAP_FLAGS
,

32081 
SQLITE_WIN32_HEAP_INIT_SIZE
,

32082 
SQLITE_WIN32_HEAP_MAX_SIZE
);

32083 if–!
pWöMemD©a
->
hHóp
 ){

32084 
	`sqlôe3_log
(
SQLITE_NOMEM
,

32086 
	`osGëLa°Eº‹
(), 
SQLITE_WIN32_HEAP_FLAGS
,

32087 
SQLITE_WIN32_HEAP_INIT_SIZE
, 
SQLITE_WIN32_HEAP_MAX_SIZE
);

32088  
SQLITE_NOMEM
;

32090 
pWöMemD©a
->
bOw√d
 = 
TRUE
;

32091 
	`as£π
–
pWöMemD©a
->
bOw√d
 );

32094 
pWöMemD©a
->
hHóp
 = 
	`osGëPro˚ssHóp
();

32095 if–!
pWöMemD©a
->
hHóp
 ){

32096 
	`sqlôe3_log
(
SQLITE_NOMEM
,

32097 "ÁûedÅÿGëPro˚ssHó∞(%lu)", 
	`osGëLa°Eº‹
());

32098  
SQLITE_NOMEM
;

32100 
pWöMemD©a
->
bOw√d
 = 
FALSE
;

32101 
	`as£π
–!
pWöMemD©a
->
bOw√d
 );

32103 
	`as£π
–
pWöMemD©a
->
hHóp
!=0 );

32104 
	`as£π
–
pWöMemD©a
->
hHóp
!=
INVALID_HANDLE_VALUE
 );

32105 #i‡!
SQLITE_OS_WINRT
 && 
	`deföed
(
SQLITE_WIN32_MALLOC_VALIDATE
)

32106 
	`as£π
–
	`osHópVÆid©e
(
pWöMemD©a
->
hHóp
, 
SQLITE_WIN32_HEAP_FLAGS
, 
NULL
) );

32108  
SQLITE_OK
;

32114 
	`wöMemShutdown
(*
pAµD©a
){

32115 
wöMemD©a
 *
pWöMemD©a
 = (wöMemD©®*)
pAµD©a
;

32117 if–!
pWöMemD©a
 ) ;

32118 if–
pWöMemD©a
->
hHóp
 ){

32119 
	`as£π
–
pWöMemD©a
->
hHóp
!=
INVALID_HANDLE_VALUE
 );

32120 #i‡!
SQLITE_OS_WINRT
 && 
	`deföed
(
SQLITE_WIN32_MALLOC_VALIDATE
)

32121 
	`as£π
–
	`osHópVÆid©e
(
pWöMemD©a
->
hHóp
, 
SQLITE_WIN32_HEAP_FLAGS
, 
NULL
) );

32123 if–
pWöMemD©a
->
bOw√d
 ){

32124 if–!
	`osHópDe°roy
(
pWöMemD©a
->
hHóp
) ){

32125 
	`sqlôe3_log
(
SQLITE_NOMEM
, "failedÅo HeapDestroy (%lu), heap=%p",

32126 
	`osGëLa°Eº‹
(), (*)
pWöMemD©a
->
hHóp
);

32128 
pWöMemD©a
->
bOw√d
 = 
FALSE
;

32130 
pWöMemD©a
->
hHóp
 = 
NULL
;

32142 
SQLITE_PRIVATE
 c⁄° 
sqlôe3_mem_mëhods
 *
	`sqlôe3MemGëWö32
(){

32143 c⁄° 
sqlôe3_mem_mëhods
 
wöMemMëhods
 = {

32144 
wöMemMÆloc
,

32145 
wöMemFªe
,

32146 
wöMemRóŒoc
,

32147 
wöMemSize
,

32148 
wöMemRoundup
,

32149 
wöMemInô
,

32150 
wöMemShutdown
,

32151 &
wö_mem_d©a


32153  &
wöMemMëhods
;

32156 
SQLITE_PRIVATE
 
	`sqlôe3MemSëDeÁu…
(){

32157 
	`sqlôe3_c⁄fig
(
SQLITE_CONFIG_MALLOC
, 
	`sqlôe3MemGëWö32
());

32166 
LPWSTR
 
	`wöUtf8ToUnicode
(c⁄° *
zFûíame
){

32167 
nCh¨
;

32168 
LPWSTR
 
zWideFûíame
;

32170 
nCh¨
 = 
	`osMu…iByãToWideCh¨
(
CP_UTF8
, 0, 
zFûíame
, -1, 
NULL
, 0);

32171 if–
nCh¨
==0 ){

32174 
zWideFûíame
 = 
	`sqlôe3MÆlocZîo
–
nCh¨
*(zWideFilename[0]) );

32175 if–
zWideFûíame
==0 ){

32178 
nCh¨
 = 
	`osMu…iByãToWideCh¨
(
CP_UTF8
, 0, 
zFûíame
, -1, 
zWideFûíame
,

32179 
nCh¨
);

32180 if–
nCh¨
==0 ){

32181 
	`sqlôe3_‰ì
(
zWideFûíame
);

32182 
zWideFûíame
 = 0;

32184  
zWideFûíame
;

32191 *
	`wöUnicodeToUtf8
(
LPCWSTR
 
zWideFûíame
){

32192 
nByã
;

32193 *
zFûíame
;

32195 
nByã
 = 
	`osWideCh¨ToMu…iByã
(
CP_UTF8
, 0, 
zWideFûíame
, -1, 0, 0, 0, 0);

32196 if–
nByã
 == 0 ){

32199 
zFûíame
 = 
	`sqlôe3MÆlocZîo
–
nByã
 );

32200 if–
zFûíame
==0 ){

32203 
nByã
 = 
	`osWideCh¨ToMu…iByã
(
CP_UTF8
, 0, 
zWideFûíame
, -1, 
zFûíame
,ÇByte,

32205 if–
nByã
 == 0 ){

32206 
	`sqlôe3_‰ì
(
zFûíame
);

32207 
zFûíame
 = 0;

32209  
zFûíame
;

32219 
LPWSTR
 
	`wöMbcsToUnicode
(c⁄° *
zFûíame
){

32220 
nByã
;

32221 
LPWSTR
 
zMbcsFûíame
;

32222 
codïage
 = 
	`osAªFûeApisANSI
(Ë? 
CP_ACP
 : 
CP_OEMCP
;

32224 
nByã
 = 
	`osMu…iByãToWideCh¨
(
codïage
, 0, 
zFûíame
, -1, 
NULL
,

32225 0)*(
WCHAR
);

32226 if–
nByã
==0 ){

32229 
zMbcsFûíame
 = 
	`sqlôe3MÆlocZîo
–
nByã
*(zMbcsFilename[0]) );

32230 if–
zMbcsFûíame
==0 ){

32233 
nByã
 = 
	`osMu…iByãToWideCh¨
(
codïage
, 0, 
zFûíame
, -1, 
zMbcsFûíame
,

32234 
nByã
);

32235 if–
nByã
==0 ){

32236 
	`sqlôe3_‰ì
(
zMbcsFûíame
);

32237 
zMbcsFûíame
 = 0;

32239  
zMbcsFûíame
;

32249 *
	`wöUnicodeToMbcs
(
LPCWSTR
 
zWideFûíame
){

32250 
nByã
;

32251 *
zFûíame
;

32252 
codïage
 = 
	`osAªFûeApisANSI
(Ë? 
CP_ACP
 : 
CP_OEMCP
;

32254 
nByã
 = 
	`osWideCh¨ToMu…iByã
(
codïage
, 0, 
zWideFûíame
, -1, 0, 0, 0, 0);

32255 if–
nByã
 == 0 ){

32258 
zFûíame
 = 
	`sqlôe3MÆlocZîo
–
nByã
 );

32259 if–
zFûíame
==0 ){

32262 
nByã
 = 
	`osWideCh¨ToMu…iByã
(
codïage
, 0, 
zWideFûíame
, -1, 
zFûíame
,

32263 
nByã
, 0, 0);

32264 if–
nByã
 == 0 ){

32265 
	`sqlôe3_‰ì
(
zFûíame
);

32266 
zFûíame
 = 0;

32268  
zFûíame
;

32275 
SQLITE_API
 *
	`sqlôe3_wö32_mbcs_to_utf8
(c⁄° *
zFûíame
){

32276 *
zFûíameUtf8
;

32277 
LPWSTR
 
zTmpWide
;

32279 
zTmpWide
 = 
	`wöMbcsToUnicode
(
zFûíame
);

32280 if–
zTmpWide
==0 ){

32283 
zFûíameUtf8
 = 
	`wöUnicodeToUtf8
(
zTmpWide
);

32284 
	`sqlôe3_‰ì
(
zTmpWide
);

32285  
zFûíameUtf8
;

32292 
SQLITE_API
 *
	`sqlôe3_wö32_utf8_to_mbcs
(c⁄° *
zFûíame
){

32293 *
zFûíameMbcs
;

32294 
LPWSTR
 
zTmpWide
;

32296 
zTmpWide
 = 
	`wöUtf8ToUnicode
(
zFûíame
);

32297 if–
zTmpWide
==0 ){

32300 
zFûíameMbcs
 = 
	`wöUnicodeToMbcs
(
zTmpWide
);

32301 
	`sqlôe3_‰ì
(
zTmpWide
);

32302  
zFûíameMbcs
;

32312 
SQLITE_API
 
	`sqlôe3_wö32_£t_dúe˘‹y
(
DWORD
 
ty≥
, 
LPCWSTR
 
zVÆue
){

32313 **
µDúe˘‹y
 = 0;

32314 #i‚de‡
SQLITE_OMIT_AUTOINIT


32315 
rc
 = 
	`sqlôe3_öôülize
();

32316 if–
rc
 ) Ñc;

32318 if–
ty≥
==
SQLITE_WIN32_DATA_DIRECTORY_TYPE
 ){

32319 
µDúe˘‹y
 = &
sqlôe3_d©a_dúe˘‹y
;

32320 }if–
ty≥
==
SQLITE_WIN32_TEMP_DIRECTORY_TYPE
 ){

32321 
µDúe˘‹y
 = &
sqlôe3_ãmp_dúe˘‹y
;

32323 
	`as£π
–!
µDúe˘‹y
 || 
ty≥
==
SQLITE_WIN32_DATA_DIRECTORY_TYPE


32324 || 
ty≥
==
SQLITE_WIN32_TEMP_DIRECTORY_TYPE


32326 
	`as£π
–!
µDúe˘‹y
 || 
	`sqlôe3MemdebugHasTy≥
(*µDúe˘‹y, 
MEMTYPE_HEAP
) );

32327 if–
µDúe˘‹y
 ){

32328 *
zVÆueUtf8
 = 0;

32329 if–
zVÆue
 && zValue[0] ){

32330 
zVÆueUtf8
 = 
	`wöUnicodeToUtf8
(
zVÆue
);

32331 i‡–
zVÆueUtf8
==0 ){

32332  
SQLITE_NOMEM
;

32335 
	`sqlôe3_‰ì
(*
µDúe˘‹y
);

32336 *
µDúe˘‹y
 = 
zVÆueUtf8
;

32337  
SQLITE_OK
;

32339  
SQLITE_ERROR
;

32347 
	`wöGëLa°Eº‹Msg
(
DWORD
 
œ°Eºno
, 
nBuf
, *
zBuf
){

32352 
DWORD
 
dwLí
 = 0;

32353 *
zOut
 = 0;

32355 if–
	`osIsNT
() ){

32356 #i‡
SQLITE_OS_WINRT


32357 
WCHAR
 
zTempWide
[
SQLITE_WIN32_MAX_ERRMSG_CHARS
+1];

32358 
dwLí
 = 
	`osF‹m©MesßgeW
(
FORMAT_MESSAGE_FROM_SYSTEM
 |

32359 
FORMAT_MESSAGE_IGNORE_INSERTS
,

32360 
NULL
,

32361 
œ°Eºno
,

32363 
zTempWide
,

32364 
SQLITE_WIN32_MAX_ERRMSG_CHARS
,

32367 
LPWSTR
 
zTempWide
 = 
NULL
;

32368 
dwLí
 = 
	`osF‹m©MesßgeW
(
FORMAT_MESSAGE_ALLOCATE_BUFFER
 |

32369 
FORMAT_MESSAGE_FROM_SYSTEM
 |

32370 
FORMAT_MESSAGE_IGNORE_INSERTS
,

32371 
NULL
,

32372 
œ°Eºno
,

32374 (
LPWSTR
Ë&
zTempWide
,

32378 if–
dwLí
 > 0 ){

32380 
	`sqlôe3BegöBíignMÆloc
();

32381 
zOut
 = 
	`wöUnicodeToUtf8
(
zTempWide
);

32382 
	`sqlôe3EndBíignMÆloc
();

32383 #i‡!
SQLITE_OS_WINRT


32385 
	`osLoˇlFªe
(
zTempWide
);

32389 #ifde‡
SQLITE_WIN32_HAS_ANSI


32391 *
zTemp
 = 
NULL
;

32392 
dwLí
 = 
	`osF‹m©MesßgeA
(
FORMAT_MESSAGE_ALLOCATE_BUFFER
 |

32393 
FORMAT_MESSAGE_FROM_SYSTEM
 |

32394 
FORMAT_MESSAGE_IGNORE_INSERTS
,

32395 
NULL
,

32396 
œ°Eºno
,

32398 (
LPSTR
Ë&
zTemp
,

32401 if–
dwLí
 > 0 ){

32403 
	`sqlôe3BegöBíignMÆloc
();

32404 
zOut
 = 
	`sqlôe3_wö32_mbcs_to_utf8
(
zTemp
);

32405 
	`sqlôe3EndBíignMÆloc
();

32407 
	`osLoˇlFªe
(
zTemp
);

32411 if–0 =
dwLí
 ){

32412 
	`sqlôe3_¢¥ötf
(
nBuf
, 
zBuf
, "OsEº‹ 0x%lx (%lu)", 
œ°Eºno
,ÜastErrno);

32415 
	`sqlôe3_¢¥ötf
(
nBuf
, 
zBuf
, "%s", 
zOut
);

32417 
	`sqlôe3_‰ì
(
zOut
);

32437 
	#wöLogEº‹
(
a
,
b
,
c
,
d
Ë
	`wöLogEº‹AtLöe
◊,b,c,d,
__LINE__
)

	)

32438 
	`wöLogEº‹AtLöe
(

32439 
îrcode
,

32440 
DWORD
 
œ°Eºno
,

32441 c⁄° *
zFunc
,

32442 c⁄° *
zP©h
,

32443 
iLöe


32445 
zMsg
[500];

32446 
i
;

32448 
zMsg
[0] = 0;

32449 
	`wöGëLa°Eº‹Msg
(
œ°Eºno
, (
zMsg
), zMsg);

32450 
	`as£π
–
îrcode
!=
SQLITE_OK
 );

32451 if–
zP©h
==0 ) zPath = "";

32452 
i
=0; 
zMsg
[i] && zMsg[i]!='\r' && zMsg[i]!='\n'; i++){}

32453 
zMsg
[
i
] = 0;

32454 
	`sqlôe3_log
(
îrcode
,

32456 
iLöe
, 
œ°Eºno
, 
zFunc
, 
zP©h
, 
zMsg


32459  
îrcode
;

32468 #i‚de‡
SQLITE_WIN32_IOERR_RETRY


32469 
	#SQLITE_WIN32_IOERR_RETRY
 10

	)

32471 #i‚de‡
SQLITE_WIN32_IOERR_RETRY_DELAY


32472 
	#SQLITE_WIN32_IOERR_RETRY_DELAY
 25

	)

32474 
wöI€ºRëry
 = 
SQLITE_WIN32_IOERR_RETRY
;

32475 
wöI€ºRëryDñay
 = 
SQLITE_WIN32_IOERR_RETRY_DELAY
;

32482 
	`wöRëryI€º
(*
≤Rëry
, 
DWORD
 *
pEº‹
){

32483 
DWORD
 
e
 = 
	`osGëLa°Eº‹
();

32484 if–*
≤Rëry
>=
wöI€ºRëry
 ){

32485 if–
pEº‹
 ){

32486 *
pEº‹
 = 
e
;

32490 if–
e
==
ERROR_ACCESS_DENIED
 ||

32491 
e
==
ERROR_LOCK_VIOLATION
 ||

32492 
e
==
ERROR_SHARING_VIOLATION
 ){

32493 
	`sqlôe3_wö32_¶ìp
(
wöI€ºRëryDñay
*(1+*
≤Rëry
));

32494 ++*
≤Rëry
;

32497 if–
pEº‹
 ){

32498 *
pEº‹
 = 
e
;

32506 
	`wöLogI€º
(
nRëry
){

32507 if–
nRëry
 ){

32508 
	`sqlôe3_log
(
SQLITE_IOERR
,

32510 
wöI€ºRëryDñay
*
nRëry
*(nRetry+1)/2

32515 #i‡
SQLITE_OS_WINCE


32519 #i‡!
	`deföed
(
SQLITE_MSVC_LOCALTIME_API
) || !SQLITE_MSVC_LOCALTIME_API

32525 
tm
 *
__cde˛
 
	`loˇ…ime
(c⁄° 
time_t
 *
t
)

32527 
tm
 
y
;

32528 
FILETIME
 
uTm
, 
lTm
;

32529 
SYSTEMTIME
 
pTm
;

32530 
sqlôe3_öt64
 
t64
;

32531 
t64
 = *
t
;

32532 
t64
 = (t64 + 11644473600)*10000000;

32533 
uTm
.
dwLowD©eTime
 = (
DWORD
)(
t64
 & 0xFFFFFFFF);

32534 
uTm
.
dwHighD©eTime
(
DWORD
)(
t64
 >> 32);

32535 
	`osFûeTimeToLoˇlFûeTime
(&
uTm
,&
lTm
);

32536 
	`osFûeTimeToSy°emTime
(&
lTm
,&
pTm
);

32537 
y
.
tm_yór
 = 
pTm
.
wYór
 - 1900;

32538 
y
.
tm_m⁄
 = 
pTm
.
wM⁄th
 - 1;

32539 
y
.
tm_wday
 = 
pTm
.
wDayOfWìk
;

32540 
y
.
tm_mday
 = 
pTm
.
wDay
;

32541 
y
.
tm_hour
 = 
pTm
.
wHour
;

32542 
y
.
tm_mö
 = 
pTm
.
wMöuã
;

32543 
y
.
tm_£c
 = 
pTm
.
wSec⁄d
;

32544  &
y
;

32548 
	#HANDLE_TO_WINFILE
(
a
Ë(
wöFûe
*)&((*Ô)[-()
	`off£tof
(wöFûe,
h
)]

	)

32553 
	`wö˚MuãxAcquúe
(
HANDLE
 
h
){

32554 
DWORD
 
dwEº
;

32556 
dwEº
 = 
	`osWaôF‹SögÀObje˘
(
h
, 
INFINITE
);

32557 } 
dwEº
 !
WAIT_OBJECT_0
 && dwEº !
WAIT_ABANDONED
);

32562 
	#wö˚MuãxRñó£
(
h
Ë
	`Rñó£Muãx
(h)

	)

32568 
	`wö˚Cª©eLock
(c⁄° *
zFûíame
, 
wöFûe
 *
pFûe
){

32569 
LPWSTR
 
zTok
;

32570 
LPWSTR
 
zName
;

32571 
DWORD
 
œ°Eºno
;

32572 
BOOL
 
bLogged
 = 
FALSE
;

32573 
BOOL
 
bInô
 = 
TRUE
;

32575 
zName
 = 
	`wöUtf8ToUnicode
(
zFûíame
);

32576 if–
zName
==0 ){

32578  
SQLITE_IOERR_NOMEM
;

32582 
	`mem£t
(&
pFûe
->
loˇl
, 0, (pFile->local));

32586 
zTok
 = 
	`osCh¨LowîW
(
zName
);

32587 ;*
zTok
;zTok++){

32588 i‡(*
zTok
 == '\\') *zTok = '_';

32592 
pFûe
->
hMuãx
 = 
	`osCª©eMuãxW
(
NULL
, 
FALSE
, 
zName
);

32593 i‡(!
pFûe
->
hMuãx
){

32594 
pFûe
->
œ°Eºno
 = 
	`osGëLa°Eº‹
();

32595 
	`sqlôe3_‰ì
(
zName
);

32596  
	`wöLogEº‹
(
SQLITE_IOERR
, 
pFûe
->
œ°Eºno
,

32597 "wö˚Cª©eLock1", 
zFûíame
);

32601 
	`wö˚MuãxAcquúe
(
pFûe
->
hMuãx
);

32607 
	`osCh¨UµîW
(
zName
);

32608 
pFûe
->
hSh¨ed
 = 
	`osCª©eFûeM≠pögW
(
INVALID_HANDLE_VALUE
, 
NULL
,

32609 
PAGE_READWRITE
, 0, (
wö˚Lock
),

32610 
zName
);

32614 
œ°Eºno
 = 
	`osGëLa°Eº‹
();

32615 i‡(
œ°Eºno
 =
ERROR_ALREADY_EXISTS
){

32616 
bInô
 = 
FALSE
;

32619 
	`sqlôe3_‰ì
(
zName
);

32622 if–
pFûe
->
hSh¨ed
 ){

32623 
pFûe
->
sh¨ed
 = (
wö˚Lock
*)
	`osM≠VõwOfFûe
’Fûe->
hSh¨ed
,

32624 
FILE_MAP_READ
|
FILE_MAP_WRITE
, 0, 0, (
wö˚Lock
));

32626 if–!
pFûe
->
sh¨ed
 ){

32627 
pFûe
->
œ°Eºno
 = 
	`osGëLa°Eº‹
();

32628 
	`wöLogEº‹
(
SQLITE_IOERR
, 
pFûe
->
œ°Eºno
,

32629 "wö˚Cª©eLock2", 
zFûíame
);

32630 
bLogged
 = 
TRUE
;

32631 
	`osClo£H™dÀ
(
pFûe
->
hSh¨ed
);

32632 
pFûe
->
hSh¨ed
 = 
NULL
;

32637 if–
pFûe
->
hSh¨ed
==
NULL
 ){

32638 if–!
bLogged
 ){

32639 
pFûe
->
œ°Eºno
 =ÜastErrno;

32640 
	`wöLogEº‹
(
SQLITE_IOERR
, 
pFûe
->
œ°Eºno
,

32641 "wö˚Cª©eLock3", 
zFûíame
);

32642 
bLogged
 = 
TRUE
;

32644 
	`wö˚MuãxRñó£
(
pFûe
->
hMuãx
);

32645 
	`osClo£H™dÀ
(
pFûe
->
hMuãx
);

32646 
pFûe
->
hMuãx
 = 
NULL
;

32647  
SQLITE_IOERR
;

32651 if–
bInô
 ){

32652 
	`mem£t
(
pFûe
->
sh¨ed
, 0, (
wö˚Lock
));

32655 
	`wö˚MuãxRñó£
(
pFûe
->
hMuãx
);

32656  
SQLITE_OK
;

32662 
	`wö˚De°royLock
(
wöFûe
 *
pFûe
){

32663 i‡(
pFûe
->
hMuãx
){

32665 
	`wö˚MuãxAcquúe
(
pFûe
->
hMuãx
);

32669 i‡(
pFûe
->
loˇl
.
nRódîs
){

32670 
pFûe
->
sh¨ed
->
nRódîs
 --;

32672 i‡(
pFûe
->
loˇl
.
bRe£rved
){

32673 
pFûe
->
sh¨ed
->
bRe£rved
 = 
FALSE
;

32675 i‡(
pFûe
->
loˇl
.
bPídög
){

32676 
pFûe
->
sh¨ed
->
bPídög
 = 
FALSE
;

32678 i‡(
pFûe
->
loˇl
.
bEx˛usive
){

32679 
pFûe
->
sh¨ed
->
bEx˛usive
 = 
FALSE
;

32683 
	`osUnm≠VõwOfFûe
(
pFûe
->
sh¨ed
);

32684 
	`osClo£H™dÀ
(
pFûe
->
hSh¨ed
);

32687 
	`wö˚MuãxRñó£
(
pFûe
->
hMuãx
);

32688 
	`osClo£H™dÀ
(
pFûe
->
hMuãx
);

32689 
pFûe
->
hMuãx
 = 
NULL
;

32696 
BOOL
 
	`wö˚LockFûe
(

32697 
LPHANDLE
 
phFûe
,

32698 
DWORD
 
dwFûeOff£tLow
,

32699 
DWORD
 
dwFûeOff£tHigh
,

32700 
DWORD
 
nNumbîOfByãsToLockLow
,

32701 
DWORD
 
nNumbîOfByãsToLockHigh


32703 
wöFûe
 *
pFûe
 = 
	`HANDLE_TO_WINFILE
(
phFûe
);

32704 
BOOL
 
bRëu∫
 = 
FALSE
;

32706 
	`UNUSED_PARAMETER
(
dwFûeOff£tHigh
);

32707 
	`UNUSED_PARAMETER
(
nNumbîOfByãsToLockHigh
);

32709 i‡(!
pFûe
->
hMuãx
Ë 
TRUE
;

32710 
	`wö˚MuãxAcquúe
(
pFûe
->
hMuãx
);

32713 i‡(
dwFûeOff£tLow
 =(
DWORD
)
SHARED_FIRST


32714 && 
nNumbîOfByãsToLockLow
 =(
DWORD
)
SHARED_SIZE
){

32715 i‡(
pFûe
->
sh¨ed
->
nRódîs
 =0 &&ÖFûe->sh¨ed->
bEx˛usive
 == 0){

32716 
pFûe
->
sh¨ed
->
bEx˛usive
 = 
TRUE
;

32717 
pFûe
->
loˇl
.
bEx˛usive
 = 
TRUE
;

32718 
bRëu∫
 = 
TRUE
;

32723 i‡(
dwFûeOff£tLow
 =(
DWORD
)
SHARED_FIRST
 &&

32724 
nNumbîOfByãsToLockLow
 == 1){

32725 i‡(
pFûe
->
sh¨ed
->
bEx˛usive
 == 0){

32726 
pFûe
->
loˇl
.
nRódîs
 ++;

32727 i‡(
pFûe
->
loˇl
.
nRódîs
 == 1){

32728 
pFûe
->
sh¨ed
->
nRódîs
 ++;

32730 
bRëu∫
 = 
TRUE
;

32735 i‡(
dwFûeOff£tLow
 =(
DWORD
)
PENDING_BYTE


32736 && 
nNumbîOfByãsToLockLow
 == 1){

32738 i‡(
pFûe
->
sh¨ed
->
bPídög
 == 0) {

32739 
pFûe
->
sh¨ed
->
bPídög
 = 
TRUE
;

32740 
pFûe
->
loˇl
.
bPídög
 = 
TRUE
;

32741 
bRëu∫
 = 
TRUE
;

32746 i‡(
dwFûeOff£tLow
 =(
DWORD
)
RESERVED_BYTE


32747 && 
nNumbîOfByãsToLockLow
 == 1){

32748 i‡(
pFûe
->
sh¨ed
->
bRe£rved
 == 0) {

32749 
pFûe
->
sh¨ed
->
bRe£rved
 = 
TRUE
;

32750 
pFûe
->
loˇl
.
bRe£rved
 = 
TRUE
;

32751 
bRëu∫
 = 
TRUE
;

32755 
	`wö˚MuãxRñó£
(
pFûe
->
hMuãx
);

32756  
bRëu∫
;

32762 
BOOL
 
	`wö˚U∆ockFûe
(

32763 
LPHANDLE
 
phFûe
,

32764 
DWORD
 
dwFûeOff£tLow
,

32765 
DWORD
 
dwFûeOff£tHigh
,

32766 
DWORD
 
nNumbîOfByãsToU∆ockLow
,

32767 
DWORD
 
nNumbîOfByãsToU∆ockHigh


32769 
wöFûe
 *
pFûe
 = 
	`HANDLE_TO_WINFILE
(
phFûe
);

32770 
BOOL
 
bRëu∫
 = 
FALSE
;

32772 
	`UNUSED_PARAMETER
(
dwFûeOff£tHigh
);

32773 
	`UNUSED_PARAMETER
(
nNumbîOfByãsToU∆ockHigh
);

32775 i‡(!
pFûe
->
hMuãx
Ë 
TRUE
;

32776 
	`wö˚MuãxAcquúe
(
pFûe
->
hMuãx
);

32779 i‡(
dwFûeOff£tLow
 =(
DWORD
)
SHARED_FIRST
){

32781 i‡(
pFûe
->
loˇl
.
bEx˛usive
){

32782 
	`as£π
(
nNumbîOfByãsToU∆ockLow
 =(
DWORD
)
SHARED_SIZE
);

32783 
pFûe
->
loˇl
.
bEx˛usive
 = 
FALSE
;

32784 
pFûe
->
sh¨ed
->
bEx˛usive
 = 
FALSE
;

32785 
bRëu∫
 = 
TRUE
;

32789 i‡(
pFûe
->
loˇl
.
nRódîs
){

32790 
	`as£π
(
nNumbîOfByãsToU∆ockLow
 =(
DWORD
)
SHARED_SIZE


32791 || 
nNumbîOfByãsToU∆ockLow
 == 1);

32792 
pFûe
->
loˇl
.
nRódîs
 --;

32793 i‡(
pFûe
->
loˇl
.
nRódîs
 == 0)

32795 
pFûe
->
sh¨ed
->
nRódîs
 --;

32797 
bRëu∫
 = 
TRUE
;

32802 i‡(
dwFûeOff£tLow
 =(
DWORD
)
PENDING_BYTE


32803 && 
nNumbîOfByãsToU∆ockLow
 == 1){

32804 i‡(
pFûe
->
loˇl
.
bPídög
){

32805 
pFûe
->
loˇl
.
bPídög
 = 
FALSE
;

32806 
pFûe
->
sh¨ed
->
bPídög
 = 
FALSE
;

32807 
bRëu∫
 = 
TRUE
;

32811 i‡(
dwFûeOff£tLow
 =(
DWORD
)
RESERVED_BYTE


32812 && 
nNumbîOfByãsToU∆ockLow
 == 1){

32813 i‡(
pFûe
->
loˇl
.
bRe£rved
) {

32814 
pFûe
->
loˇl
.
bRe£rved
 = 
FALSE
;

32815 
pFûe
->
sh¨ed
->
bRe£rved
 = 
FALSE
;

32816 
bRëu∫
 = 
TRUE
;

32820 
	`wö˚MuãxRñó£
(
pFûe
->
hMuãx
);

32821  
bRëu∫
;

32831 
BOOL
 
	`wöLockFûe
(

32832 
LPHANDLE
 
phFûe
,

32833 
DWORD
 
Êags
,

32834 
DWORD
 
off£tLow
,

32835 
DWORD
 
off£tHigh
,

32836 
DWORD
 
numByãsLow
,

32837 
DWORD
 
numByãsHigh


32839 #i‡
SQLITE_OS_WINCE


32844  
	`wö˚LockFûe
(
phFûe
, 
off£tLow
, 
off£tHigh
,

32845 
numByãsLow
, 
numByãsHigh
);

32847 if–
	`osIsNT
() ){

32848 
OVERLAPPED
 
ovÕ
;

32849 
	`mem£t
(&
ovÕ
, 0, (
OVERLAPPED
));

32850 
ovÕ
.
Off£t
 = 
off£tLow
;

32851 
ovÕ
.
Off£tHigh
 = 
off£tHigh
;

32852  
	`osLockFûeEx
(*
phFûe
, 
Êags
, 0, 
numByãsLow
, 
numByãsHigh
, &
ovÕ
);

32854  
	`osLockFûe
(*
phFûe
, 
off£tLow
, 
off£tHigh
, 
numByãsLow
,

32855 
numByãsHigh
);

32863 
BOOL
 
	`wöU∆ockFûe
(

32864 
LPHANDLE
 
phFûe
,

32865 
DWORD
 
off£tLow
,

32866 
DWORD
 
off£tHigh
,

32867 
DWORD
 
numByãsLow
,

32868 
DWORD
 
numByãsHigh


32870 #i‡
SQLITE_OS_WINCE


32875  
	`wö˚U∆ockFûe
(
phFûe
, 
off£tLow
, 
off£tHigh
,

32876 
numByãsLow
, 
numByãsHigh
);

32878 if–
	`osIsNT
() ){

32879 
OVERLAPPED
 
ovÕ
;

32880 
	`mem£t
(&
ovÕ
, 0, (
OVERLAPPED
));

32881 
ovÕ
.
Off£t
 = 
off£tLow
;

32882 
ovÕ
.
Off£tHigh
 = 
off£tHigh
;

32883  
	`osU∆ockFûeEx
(*
phFûe
, 0, 
numByãsLow
, 
numByãsHigh
, &
ovÕ
);

32885  
	`osU∆ockFûe
(*
phFûe
, 
off£tLow
, 
off£tHigh
, 
numByãsLow
,

32886 
numByãsHigh
);

32899 #i‚de‡
INVALID_SET_FILE_POINTER


32900 
	#INVALID_SET_FILE_POINTER
 ((
DWORD
)-1)

	)

32908 
	`wöSìkFûe
(
wöFûe
 *
pFûe
, 
sqlôe3_öt64
 
iOff£t
){

32909 #i‡!
SQLITE_OS_WINRT


32910 
LONG
 
uµîBôs
;

32911 
LONG
 
lowîBôs
;

32912 
DWORD
 
dwRë
;

32913 
DWORD
 
œ°Eºno
;

32915 
	`OSTRACE
(("SEEK fûe=%p, off£t=%Œd\n", 
pFûe
->
h
, 
iOff£t
));

32917 
uµîBôs
 = (
LONG
)((
iOff£t
>>32) & 0x7fffffff);

32918 
lowîBôs
 = (
LONG
)(
iOff£t
 & 0xffffffff);

32927 
dwRë
 = 
	`osSëFûePoöãr
(
pFûe
->
h
, 
lowîBôs
, &
uµîBôs
, 
FILE_BEGIN
);

32929 if–(
dwRë
==
INVALID_SET_FILE_POINTER


32930 && ((
œ°Eºno
 = 
	`osGëLa°Eº‹
())!=
NO_ERROR
)) ){

32931 
pFûe
->
œ°Eºno
 =ÜastErrno;

32932 
	`wöLogEº‹
(
SQLITE_IOERR_SEEK
, 
pFûe
->
œ°Eºno
,

32933 "wöSìkFûe", 
pFûe
->
zP©h
);

32934 
	`OSTRACE
(("SEEK fûe=%p,Ñc=SQLITE_IOERR_SEEK\n", 
pFûe
->
h
));

32938 
	`OSTRACE
(("SEEK fûe=%p,Ñc=SQLITE_OK\n", 
pFûe
->
h
));

32945 
LARGE_INTEGER
 
x
;

32946 
BOOL
 
bRë
;

32948 
x
.
QuadP¨t
 = 
iOff£t
;

32949 
bRë
 = 
	`osSëFûePoöãrEx
(
pFûe
->
h
, 
x
, 0, 
FILE_BEGIN
);

32951 if(!
bRë
){

32952 
pFûe
->
œ°Eºno
 = 
	`osGëLa°Eº‹
();

32953 
	`wöLogEº‹
(
SQLITE_IOERR_SEEK
, 
pFûe
->
œ°Eºno
,

32954 "wöSìkFûe", 
pFûe
->
zP©h
);

32955 
	`OSTRACE
(("SEEK fûe=%p,Ñc=SQLITE_IOERR_SEEK\n", 
pFûe
->
h
));

32959 
	`OSTRACE
(("SEEK fûe=%p,Ñc=SQLITE_OK\n", 
pFûe
->
h
));

32964 #i‡
SQLITE_MAX_MMAP_SIZE
>0

32966 
	`wöM≠fûe
(
wöFûe
*, 
sqlôe3_öt64
);

32967 
	`wöUnm≠fûe
(
wöFûe
*);

32980 
	#MX_CLOSE_ATTEMPT
 3

	)

32981 
	`wöClo£
(
sqlôe3_fûe
 *
id
){

32982 
rc
, 
˙t
 = 0;

32983 
wöFûe
 *
pFûe
 = (wöFûe*)
id
;

32985 
	`as£π
–
id
!=0 );

32986 #i‚de‡
SQLITE_OMIT_WAL


32987 
	`as£π
–
pFûe
->
pShm
==0 );

32989 
	`as£π
–
pFûe
->
h
!=
NULL
 &&ÖFûe->h!=
INVALID_HANDLE_VALUE
 );

32990 
	`OSTRACE
(("CLOSE fûe=%p\n", 
pFûe
->
h
));

32992 #i‡
SQLITE_MAX_MMAP_SIZE
>0

32993 
	`wöUnm≠fûe
(
pFûe
);

32997 
rc
 = 
	`osClo£H™dÀ
(
pFûe
->
h
);

32999 } 
rc
==0 && ++
˙t
 < 
MX_CLOSE_ATTEMPT
 && (
	`sqlôe3_wö32_¶ìp
(100), 1) );

33000 #i‡
SQLITE_OS_WINCE


33001 
	#WINCE_DELETION_ATTEMPTS
 3

	)

33002 
	`wö˚De°royLock
(
pFûe
);

33003 if–
pFûe
->
zDñëeOnClo£
 ){

33004 
˙t
 = 0;

33006 
	`osDñëeFûeW
(
pFûe
->
zDñëeOnClo£
)==0

33007 && 
	`osGëFûeAâribuãsW
(
pFûe
->
zDñëeOnClo£
)!=0xffffffff

33008 && 
˙t
++ < 
WINCE_DELETION_ATTEMPTS


33010 
	`sqlôe3_wö32_¶ìp
(100);

33012 
	`sqlôe3_‰ì
(
pFûe
->
zDñëeOnClo£
);

33015 if–
rc
 ){

33016 
pFûe
->
h
 = 
NULL
;

33018 
	`O≥nCou¡î
(-1);

33019 
	`OSTRACE
(("CLOSE fûe=%p,Ñc=%s\n", 
pFûe
->
h
, 
rc
 ? "ok" : "failed"));

33020  
rc
 ? 
SQLITE_OK


33021 : 
	`wöLogEº‹
(
SQLITE_IOERR_CLOSE
, 
	`osGëLa°Eº‹
(),

33022 "wöClo£", 
pFûe
->
zP©h
);

33030 
	`wöRód
(

33031 
sqlôe3_fûe
 *
id
,

33032 *
pBuf
,

33033 
amt
,

33034 
sqlôe3_öt64
 
off£t


33036 #i‡!
SQLITE_OS_WINCE


33037 
OVERLAPPED
 
ovîœµed
;

33039 
wöFûe
 *
pFûe
 = (wöFûe*)
id
;

33040 
DWORD
 
nRód
;

33041 
nRëry
 = 0;

33043 
	`as£π
–
id
!=0 );

33044 
	`as£π
–
amt
>0 );

33045 
	`as£π
–
off£t
>=0 );

33046 
	`SimuœãIOEº‹
( 
SQLITE_IOERR_READ
);

33047 
	`OSTRACE
(("READ file=%p, buffer=%p,ámount=%d, offset=%lld,Üock=%d\n",

33048 
pFûe
->
h
, 
pBuf
, 
amt
, 
off£t
,ÖFûe->
lockty≥
));

33050 #i‡
SQLITE_MAX_MMAP_SIZE
>0

33053 if–
off£t
<
pFûe
->
mm≠Size
 ){

33054 if–
off£t
+
amt
 <
pFûe
->
mm≠Size
 ){

33055 
	`mem˝y
(
pBuf
, &((
u8
 *)(
pFûe
->
pM≠Regi⁄
))[
off£t
], 
amt
);

33056 
	`OSTRACE
(("READ-MMAP fûe=%p,Ñc=SQLITE_OK\n", 
pFûe
->
h
));

33057  
SQLITE_OK
;

33059 
nC›y
 = ()(
pFûe
->
mm≠Size
 - 
off£t
);

33060 
	`mem˝y
(
pBuf
, &((
u8
 *)(
pFûe
->
pM≠Regi⁄
))[
off£t
], 
nC›y
);

33061 
pBuf
 = &((
u8
 *ÌBuf)[
nC›y
];

33062 
amt
 -
nC›y
;

33063 
off£t
 +
nC›y
;

33068 #i‡
SQLITE_OS_WINCE


33069 if–
	`wöSìkFûe
(
pFûe
, 
off£t
) ){

33070 
	`OSTRACE
(("READ fûe=%p,Ñc=SQLITE_FULL\n", 
pFûe
->
h
));

33071  
SQLITE_FULL
;

33073  !
	`osRódFûe
(
pFûe
->
h
, 
pBuf
, 
amt
, &
nRód
, 0) ){

33075 
	`mem£t
(&
ovîœµed
, 0, (
OVERLAPPED
));

33076 
ovîœµed
.
Off£t
 = (
LONG
)(
off£t
 & 0xffffffff);

33077 
ovîœµed
.
Off£tHigh
 = (
LONG
)((
off£t
>>32) & 0x7fffffff);

33078  !
	`osRódFûe
(
pFûe
->
h
, 
pBuf
, 
amt
, &
nRód
, &
ovîœµed
) &&

33079 
	`osGëLa°Eº‹
()!=
ERROR_HANDLE_EOF
 ){

33081 
DWORD
 
œ°Eºno
;

33082 if–
	`wöRëryI€º
(&
nRëry
, &
œ°Eºno
) ) ;

33083 
pFûe
->
œ°Eºno
 =ÜastErrno;

33084 
	`OSTRACE
(("READ fûe=%p,Ñc=SQLITE_IOERR_READ\n", 
pFûe
->
h
));

33085  
	`wöLogEº‹
(
SQLITE_IOERR_READ
, 
pFûe
->
œ°Eºno
,

33086 "wöRód", 
pFûe
->
zP©h
);

33088 
	`wöLogI€º
(
nRëry
);

33089 if–
nRód
<(
DWORD
)
amt
 ){

33091 
	`mem£t
(&((*)
pBuf
)[
nRód
], 0, 
amt
-nRead);

33092 
	`OSTRACE
(("READ fûe=%p,Ñc=SQLITE_IOERR_SHORT_READ\n", 
pFûe
->
h
));

33093  
SQLITE_IOERR_SHORT_READ
;

33096 
	`OSTRACE
(("READ fûe=%p,Ñc=SQLITE_OK\n", 
pFûe
->
h
));

33097  
SQLITE_OK
;

33104 
	`wöWrôe
(

33105 
sqlôe3_fûe
 *
id
,

33106 c⁄° *
pBuf
,

33107 
amt
,

33108 
sqlôe3_öt64
 
off£t


33110 
rc
 = 0;

33111 
wöFûe
 *
pFûe
 = (wöFûe*)
id
;

33112 
nRëry
 = 0;

33114 
	`as£π
–
amt
>0 );

33115 
	`as£π
–
pFûe
 );

33116 
	`SimuœãIOEº‹
( 
SQLITE_IOERR_WRITE
);

33117 
	`SimuœãDiskfuŒEº‹
( 
SQLITE_FULL
);

33119 
	`OSTRACE
(("WRITE file=%p, buffer=%p,ámount=%d, offset=%lld,Üock=%d\n",

33120 
pFûe
->
h
, 
pBuf
, 
amt
, 
off£t
,ÖFûe->
lockty≥
));

33122 #i‡
SQLITE_MAX_MMAP_SIZE
>0

33125 if–
off£t
<
pFûe
->
mm≠Size
 ){

33126 if–
off£t
+
amt
 <
pFûe
->
mm≠Size
 ){

33127 
	`mem˝y
(&((
u8
 *)(
pFûe
->
pM≠Regi⁄
))[
off£t
], 
pBuf
, 
amt
);

33128 
	`OSTRACE
(("WRITE-MMAP fûe=%p,Ñc=SQLITE_OK\n", 
pFûe
->
h
));

33129  
SQLITE_OK
;

33131 
nC›y
 = ()(
pFûe
->
mm≠Size
 - 
off£t
);

33132 
	`mem˝y
(&((
u8
 *)(
pFûe
->
pM≠Regi⁄
))[
off£t
], 
pBuf
, 
nC›y
);

33133 
pBuf
 = &((
u8
 *ÌBuf)[
nC›y
];

33134 
amt
 -
nC›y
;

33135 
off£t
 +
nC›y
;

33140 #i‡
SQLITE_OS_WINCE


33141 
rc
 = 
	`wöSìkFûe
(
pFûe
, 
off£t
);

33142 if–
rc
==0 ){

33146 #i‡!
SQLITE_OS_WINCE


33147 
OVERLAPPED
 
ovîœµed
;

33149 
u8
 *
aRem
 = (u8 *)
pBuf
;

33150 
nRem
 = 
amt
;

33151 
DWORD
 
nWrôe
;

33152 
DWORD
 
œ°Eºno
 = 
NO_ERROR
;

33154 #i‡!
SQLITE_OS_WINCE


33155 
	`mem£t
(&
ovîœµed
, 0, (
OVERLAPPED
));

33156 
ovîœµed
.
Off£t
 = (
LONG
)(
off£t
 & 0xffffffff);

33157 
ovîœµed
.
Off£tHigh
 = (
LONG
)((
off£t
>>32) & 0x7fffffff);

33160  
nRem
>0 ){

33161 #i‡
SQLITE_OS_WINCE


33162 if–!
	`osWrôeFûe
(
pFûe
->
h
, 
aRem
, 
nRem
, &
nWrôe
, 0) ){

33164 if–!
	`osWrôeFûe
(
pFûe
->
h
, 
aRem
, 
nRem
, &
nWrôe
, &
ovîœµed
) ){

33166 if–
	`wöRëryI€º
(&
nRëry
, &
œ°Eºno
) ) ;

33169 
	`as£π
–
nWrôe
==0 ||ÇWrôe<=(
DWORD
)
nRem
 );

33170 if–
nWrôe
==0 ||ÇWrôe>(
DWORD
)
nRem
 ){

33171 
œ°Eºno
 = 
	`osGëLa°Eº‹
();

33174 #i‡!
SQLITE_OS_WINCE


33175 
off£t
 +
nWrôe
;

33176 
ovîœµed
.
Off£t
 = (
LONG
)(
off£t
 & 0xffffffff);

33177 
ovîœµed
.
Off£tHigh
 = (
LONG
)((
off£t
>>32) & 0x7fffffff);

33179 
aRem
 +
nWrôe
;

33180 
nRem
 -
nWrôe
;

33182 if–
nRem
>0 ){

33183 
pFûe
->
œ°Eºno
 =ÜastErrno;

33184 
rc
 = 1;

33188 if–
rc
 ){

33189 if––
pFûe
->
œ°Eºno
==
ERROR_HANDLE_DISK_FULL
 )

33190 || ( 
pFûe
->
œ°Eºno
==
ERROR_DISK_FULL
 )){

33191 
	`OSTRACE
(("WRITE fûe=%p,Ñc=SQLITE_FULL\n", 
pFûe
->
h
));

33192  
	`wöLogEº‹
(
SQLITE_FULL
, 
pFûe
->
œ°Eºno
,

33193 "wöWrôe1", 
pFûe
->
zP©h
);

33195 
	`OSTRACE
(("WRITE fûe=%p,Ñc=SQLITE_IOERR_WRITE\n", 
pFûe
->
h
));

33196  
	`wöLogEº‹
(
SQLITE_IOERR_WRITE
, 
pFûe
->
œ°Eºno
,

33197 "wöWrôe2", 
pFûe
->
zP©h
);

33199 
	`wöLogI€º
(
nRëry
);

33201 
	`OSTRACE
(("WRITE fûe=%p,Ñc=SQLITE_OK\n", 
pFûe
->
h
));

33202  
SQLITE_OK
;

33208 
	`wöTrunˇã
(
sqlôe3_fûe
 *
id
, 
sqlôe3_öt64
 
nByã
){

33209 
wöFûe
 *
pFûe
 = (wöFûe*)
id
;

33210 
rc
 = 
SQLITE_OK
;

33211 
DWORD
 
œ°Eºno
;

33213 
	`as£π
–
pFûe
 );

33214 
	`SimuœãIOEº‹
( 
SQLITE_IOERR_TRUNCATE
);

33215 
	`OSTRACE
(("TRUNCATE file=%p, size=%lld,Üock=%d\n",

33216 
pFûe
->
h
, 
nByã
,ÖFûe->
lockty≥
));

33223 if–
pFûe
->
szChunk
>0 ){

33224 
nByã
 = (“Byã + 
pFûe
->
szChunk
 - 1)/pFile->szChunk) *ÖFile->szChunk;

33228 if–
	`wöSìkFûe
(
pFûe
, 
nByã
) ){

33229 
rc
 = 
	`wöLogEº‹
(
SQLITE_IOERR_TRUNCATE
, 
pFûe
->
œ°Eºno
,

33230 "wöTrunˇã1", 
pFûe
->
zP©h
);

33231 }if–0==
	`osSëEndOfFûe
(
pFûe
->
h
) &&

33232 ((
œ°Eºno
 = 
	`osGëLa°Eº‹
())!=
ERROR_USER_MAPPED_FILE
) ){

33233 
pFûe
->
œ°Eºno
 =ÜastErrno;

33234 
rc
 = 
	`wöLogEº‹
(
SQLITE_IOERR_TRUNCATE
, 
pFûe
->
œ°Eºno
,

33235 "wöTrunˇã2", 
pFûe
->
zP©h
);

33238 #i‡
SQLITE_MAX_MMAP_SIZE
>0

33243 if–
pFûe
->
pM≠Regi⁄
 && 
nByã
<pFûe->
mm≠Size
 ){

33244 
pFûe
->
mm≠Size
 = 
nByã
;

33248 
	`OSTRACE
(("TRUNCATE fûe=%p,Ñc=%s\n", 
pFûe
->
h
, 
	`sqlôe3EºName
(
rc
)));

33249  
rc
;

33252 #ifde‡
SQLITE_TEST


33257 
SQLITE_API
 
sqlôe3_sync_cou¡
 = 0;

33258 
SQLITE_API
 
sqlôe3_fuŒsync_cou¡
 = 0;

33264 
	`wöSync
(
sqlôe3_fûe
 *
id
, 
Êags
){

33265 #i‚de‡
SQLITE_NO_SYNC


33269 
BOOL
 
rc
;

33271 #i‡!
	`deföed
(
NDEBUG
Ë|| !deföed(
SQLITE_NO_SYNC
) || \

33272 (
	`deföed
(
SQLITE_TEST
Ë&& deföed(
SQLITE_DEBUG
))

33277 
wöFûe
 *
pFûe
 = (wöFûe*)
id
;

33279 
	`UNUSED_PARAMETER
(
id
);

33282 
	`as£π
–
pFûe
 );

33284 
	`as£π
((
Êags
&0x0F)==
SQLITE_SYNC_NORMAL


33285 || (
Êags
&0x0F)==
SQLITE_SYNC_FULL


33291 
	`SimuœãDiskfuŒEº‹
– 
SQLITE_FULL
 );

33293 
	`OSTRACE
(("SYNC file=%p, flags=%x,Üock=%d\n",

33294 
pFûe
->
h
, 
Êags
,ÖFûe->
lockty≥
));

33296 #i‚de‡
SQLITE_TEST


33297 
	`UNUSED_PARAMETER
(
Êags
);

33299 if–(
Êags
&0x0F)==
SQLITE_SYNC_FULL
 ){

33300 
sqlôe3_fuŒsync_cou¡
++;

33302 
sqlôe3_sync_cou¡
++;

33308 #ifde‡
SQLITE_NO_SYNC


33309 
	`OSTRACE
(("SYNC-NOP fûe=%p,Ñc=SQLITE_OK\n", 
pFûe
->
h
));

33310  
SQLITE_OK
;

33312 
rc
 = 
	`osFlushFûeBuf„rs
(
pFûe
->
h
);

33313 
	`SimuœãIOEº‹
–
rc
=
FALSE
 );

33314 if–
rc
 ){

33315 
	`OSTRACE
(("SYNC fûe=%p,Ñc=SQLITE_OK\n", 
pFûe
->
h
));

33316  
SQLITE_OK
;

33318 
pFûe
->
œ°Eºno
 = 
	`osGëLa°Eº‹
();

33319 
	`OSTRACE
(("SYNC fûe=%p,Ñc=SQLITE_IOERR_FSYNC\n", 
pFûe
->
h
));

33320  
	`wöLogEº‹
(
SQLITE_IOERR_FSYNC
, 
pFûe
->
œ°Eºno
,

33321 "wöSync", 
pFûe
->
zP©h
);

33329 
	`wöFûeSize
(
sqlôe3_fûe
 *
id
, 
sqlôe3_öt64
 *
pSize
){

33330 
wöFûe
 *
pFûe
 = (wöFûe*)
id
;

33331 
rc
 = 
SQLITE_OK
;

33333 
	`as£π
–
id
!=0 );

33334 
	`as£π
–
pSize
!=0 );

33335 
	`SimuœãIOEº‹
( 
SQLITE_IOERR_FSTAT
);

33336 
	`OSTRACE
(("SIZE fûe=%p,ÖSize=%p\n", 
pFûe
->
h
, 
pSize
));

33338 #i‡
SQLITE_OS_WINRT


33340 
FILE_STANDARD_INFO
 
öfo
;

33341 if–
	`osGëFûeInf‹m©i⁄ByH™dÀEx
(
pFûe
->
h
, 
FûeSènd¨dInfo
,

33342 &
öfo
, (info)) ){

33343 *
pSize
 = 
öfo
.
EndOfFûe
.
QuadP¨t
;

33345 
pFûe
->
œ°Eºno
 = 
	`osGëLa°Eº‹
();

33346 
rc
 = 
	`wöLogEº‹
(
SQLITE_IOERR_FSTAT
, 
pFûe
->
œ°Eºno
,

33347 "wöFûeSize", 
pFûe
->
zP©h
);

33352 
DWORD
 
uµîBôs
;

33353 
DWORD
 
lowîBôs
;

33354 
DWORD
 
œ°Eºno
;

33356 
lowîBôs
 = 
	`osGëFûeSize
(
pFûe
->
h
, &
uµîBôs
);

33357 *
pSize
 = (((
sqlôe3_öt64
)
uµîBôs
)<<32Ë+ 
lowîBôs
;

33358 if–(
lowîBôs
 =
INVALID_FILE_SIZE
)

33359 && ((
œ°Eºno
 = 
	`osGëLa°Eº‹
())!=
NO_ERROR
) ){

33360 
pFûe
->
œ°Eºno
 =ÜastErrno;

33361 
rc
 = 
	`wöLogEº‹
(
SQLITE_IOERR_FSTAT
, 
pFûe
->
œ°Eºno
,

33362 "wöFûeSize", 
pFûe
->
zP©h
);

33366 
	`OSTRACE
(("SIZE file=%p,ÖSize=%p, *pSize=%lld,Ñc=%s\n",

33367 
pFûe
->
h
, 
pSize
, *pSize, 
	`sqlôe3EºName
(
rc
)));

33368  
rc
;

33374 #i‚de‡
LOCKFILE_FAIL_IMMEDIATELY


33375 
	#LOCKFILE_FAIL_IMMEDIATELY
 1

	)

33378 #i‚de‡
LOCKFILE_EXCLUSIVE_LOCK


33379 
	#LOCKFILE_EXCLUSIVE_LOCK
 2

	)

33389 #i‚de‡
SQLITE_LOCKFILE_FLAGS


33390 
	#SQLITE_LOCKFILE_FLAGS
 (
LOCKFILE_FAIL_IMMEDIATELY
 | \

33391 
LOCKFILE_EXCLUSIVE_LOCK
)

	)

33398 #i‚de‡
SQLITE_LOCKFILEEX_FLAGS


33399 
	#SQLITE_LOCKFILEEX_FLAGS
 (
LOCKFILE_FAIL_IMMEDIATELY
)

	)

33407 
	`wöGëRódLock
(
wöFûe
 *
pFûe
){

33408 
ªs
;

33409 
	`OSTRACE
(("READ-LOCK fûe=%p,Üock=%d\n", 
pFûe
->
h
,ÖFûe->
lockty≥
));

33410 if–
	`osIsNT
() ){

33411 #i‡
SQLITE_OS_WINCE


33416 
ªs
 = 
	`wö˚LockFûe
(&
pFûe
->
h
, 
SHARED_FIRST
, 0, 1, 0);

33418 
ªs
 = 
	`wöLockFûe
(&
pFûe
->
h
, 
SQLITE_LOCKFILEEX_FLAGS
, 
SHARED_FIRST
, 0,

33419 
SHARED_SIZE
, 0);

33422 #ifde‡
SQLITE_WIN32_HAS_ANSI


33424 
lk
;

33425 
	`sqlôe3_øndom√ss
((
lk
), &lk);

33426 
pFûe
->
sh¨edLockByã
 = ()((
lk
 & 0x7fffffff)%(
SHARED_SIZE
 - 1));

33427 
ªs
 = 
	`wöLockFûe
(&
pFûe
->
h
, 
SQLITE_LOCKFILE_FLAGS
,

33428 
SHARED_FIRST
+
pFûe
->
sh¨edLockByã
, 0, 1, 0);

33431 if–
ªs
 == 0 ){

33432 
pFûe
->
œ°Eºno
 = 
	`osGëLa°Eº‹
();

33435 
	`OSTRACE
(("READ-LOCK fûe=%p,Ñc=%s\n", 
pFûe
->
h
, 
	`sqlôe3EºName
(
ªs
)));

33436  
ªs
;

33442 
	`wöU∆ockRódLock
(
wöFûe
 *
pFûe
){

33443 
ªs
;

33444 
DWORD
 
œ°Eºno
;

33445 
	`OSTRACE
(("READ-UNLOCK fûe=%p,Üock=%d\n", 
pFûe
->
h
,ÖFûe->
lockty≥
));

33446 if–
	`osIsNT
() ){

33447 
ªs
 = 
	`wöU∆ockFûe
(&
pFûe
->
h
, 
SHARED_FIRST
, 0, 
SHARED_SIZE
, 0);

33449 #ifde‡
SQLITE_WIN32_HAS_ANSI


33451 
ªs
 = 
	`wöU∆ockFûe
(&
pFûe
->
h
, 
SHARED_FIRST
+pFûe->
sh¨edLockByã
, 0, 1, 0);

33454 if–
ªs
==0 && ((
œ°Eºno
 = 
	`osGëLa°Eº‹
())!=
ERROR_NOT_LOCKED
) ){

33455 
pFûe
->
œ°Eºno
 =ÜastErrno;

33456 
	`wöLogEº‹
(
SQLITE_IOERR_UNLOCK
, 
pFûe
->
œ°Eºno
,

33457 "wöU∆ockRódLock", 
pFûe
->
zP©h
);

33459 
	`OSTRACE
(("READ-UNLOCK fûe=%p,Ñc=%s\n", 
pFûe
->
h
, 
	`sqlôe3EºName
(
ªs
)));

33460  
ªs
;

33489 
	`wöLock
(
sqlôe3_fûe
 *
id
, 
lockty≥
){

33490 
rc
 = 
SQLITE_OK
;

33491 
ªs
 = 1;

33492 
√wLockty≥
;

33493 
gŸPídögLock
 = 0;

33494 
wöFûe
 *
pFûe
 = (wöFûe*)
id
;

33495 
DWORD
 
œ°Eºno
 = 
NO_ERROR
;

33497 
	`as£π
–
id
!=0 );

33498 
	`OSTRACE
(("LOCK file=%p, oldLock=%d(%d),ÇewLock=%d\n",

33499 
pFûe
->
h
,ÖFûe->
lockty≥
,ÖFûe->
sh¨edLockByã
,Üocktype));

33505 if–
pFûe
->
lockty≥
>=locktype ){

33506 
	`OSTRACE
(("LOCK-HELD fûe=%p,Ñc=SQLITE_OK\n", 
pFûe
->
h
));

33507  
SQLITE_OK
;

33512 
	`as£π
–
pFûe
->
lockty≥
!=
NO_LOCK
 ||Üockty≥==
SHARED_LOCK
 );

33513 
	`as£π
–
lockty≥
!=
PENDING_LOCK
 );

33514 
	`as£π
–
lockty≥
!=
RESERVED_LOCK
 || 
pFûe
->lockty≥==
SHARED_LOCK
 );

33520 
√wLockty≥
 = 
pFûe
->
lockty≥
;

33521 if–(
pFûe
->
lockty≥
==
NO_LOCK
)

33522 || ( (
lockty≥
==
EXCLUSIVE_LOCK
)

33523 && (
pFûe
->
lockty≥
==
RESERVED_LOCK
))

33525 
˙t
 = 3;

33526  
˙t
-->0 && (
ªs
 = 
	`wöLockFûe
(&
pFûe
->
h
, 
SQLITE_LOCKFILE_FLAGS
,

33527 
PENDING_BYTE
, 0, 1, 0))==0 ){

33534 
	`OSTRACE
(("LOCK-PENDING-FAIL file=%p, count=%d,Ñc=%s\n",

33535 
pFûe
->
h
, 
˙t
, 
	`sqlôe3EºName
(
ªs
)));

33536 if–
˙t
 ) 
	`sqlôe3_wö32_¶ìp
(1);

33538 
gŸPídögLock
 = 
ªs
;

33539 if–!
ªs
 ){

33540 
œ°Eºno
 = 
	`osGëLa°Eº‹
();

33546 if–
lockty≥
==
SHARED_LOCK
 && 
ªs
 ){

33547 
	`as£π
–
pFûe
->
lockty≥
==
NO_LOCK
 );

33548 
ªs
 = 
	`wöGëRódLock
(
pFûe
);

33549 if–
ªs
 ){

33550 
√wLockty≥
 = 
SHARED_LOCK
;

33552 
œ°Eºno
 = 
	`osGëLa°Eº‹
();

33558 if–
lockty≥
==
RESERVED_LOCK
 && 
ªs
 ){

33559 
	`as£π
–
pFûe
->
lockty≥
==
SHARED_LOCK
 );

33560 
ªs
 = 
	`wöLockFûe
(&
pFûe
->
h
, 
SQLITE_LOCKFILE_FLAGS
, 
RESERVED_BYTE
, 0, 1, 0);

33561 if–
ªs
 ){

33562 
√wLockty≥
 = 
RESERVED_LOCK
;

33564 
œ°Eºno
 = 
	`osGëLa°Eº‹
();

33570 if–
lockty≥
==
EXCLUSIVE_LOCK
 && 
ªs
 ){

33571 
√wLockty≥
 = 
PENDING_LOCK
;

33572 
gŸPídögLock
 = 0;

33577 if–
lockty≥
==
EXCLUSIVE_LOCK
 && 
ªs
 ){

33578 
	`as£π
–
pFûe
->
lockty≥
>=
SHARED_LOCK
 );

33579 
ªs
 = 
	`wöU∆ockRódLock
(
pFûe
);

33580 
ªs
 = 
	`wöLockFûe
(&
pFûe
->
h
, 
SQLITE_LOCKFILE_FLAGS
, 
SHARED_FIRST
, 0,

33581 
SHARED_SIZE
, 0);

33582 if–
ªs
 ){

33583 
√wLockty≥
 = 
EXCLUSIVE_LOCK
;

33585 
œ°Eºno
 = 
	`osGëLa°Eº‹
();

33586 
	`wöGëRódLock
(
pFûe
);

33593 if–
gŸPídögLock
 && 
lockty≥
==
SHARED_LOCK
 ){

33594 
	`wöU∆ockFûe
(&
pFûe
->
h
, 
PENDING_BYTE
, 0, 1, 0);

33600 if–
ªs
 ){

33601 
rc
 = 
SQLITE_OK
;

33603 
pFûe
->
œ°Eºno
 =ÜastErrno;

33604 
rc
 = 
SQLITE_BUSY
;

33605 
	`OSTRACE
(("LOCK-FAIL file=%p, wanted=%d, got=%d\n",

33606 
pFûe
->
h
, 
lockty≥
, 
√wLockty≥
));

33608 
pFûe
->
lockty≥
 = (
u8
)
√wLockty≥
;

33609 
	`OSTRACE
(("LOCK file=%p,Üock=%d,Ñc=%s\n",

33610 
pFûe
->
h
,ÖFûe->
lockty≥
, 
	`sqlôe3EºName
(
rc
)));

33611  
rc
;

33619 
	`wöCheckRe£rvedLock
(
sqlôe3_fûe
 *
id
, *
pResOut
){

33620 
rc
;

33621 
wöFûe
 *
pFûe
 = (wöFûe*)
id
;

33623 
	`SimuœãIOEº‹
– 
SQLITE_IOERR_CHECKRESERVEDLOCK
; );

33624 
	`OSTRACE
(("TEST-WR-LOCK fûe=%p,ÖResOut=%p\n", 
pFûe
->
h
, 
pResOut
));

33626 
	`as£π
–
id
!=0 );

33627 if–
pFûe
->
lockty≥
>=
RESERVED_LOCK
 ){

33628 
rc
 = 1;

33629 
	`OSTRACE
(("TEST-WR-LOCK fûe=%p,Ñc=%d (loˇl)\n", 
pFûe
->
h
, 
rc
));

33631 
rc
 = 
	`wöLockFûe
(&
pFûe
->
h
, 
SQLITE_LOCKFILEEX_FLAGS
,
RESERVED_BYTE
, 0, 1, 0);

33632 if–
rc
 ){

33633 
	`wöU∆ockFûe
(&
pFûe
->
h
, 
RESERVED_BYTE
, 0, 1, 0);

33635 
rc
 = !rc;

33636 
	`OSTRACE
(("TEST-WR-LOCK fûe=%p,Ñc=%d (ªmŸe)\n", 
pFûe
->
h
, 
rc
));

33638 *
pResOut
 = 
rc
;

33639 
	`OSTRACE
(("TEST-WR-LOCK file=%p,ÖResOut=%p, *pResOut=%d,Ñc=SQLITE_OK\n",

33640 
pFûe
->
h
, 
pResOut
, *pResOut));

33641  
SQLITE_OK
;

33655 
	`wöU∆ock
(
sqlôe3_fûe
 *
id
, 
lockty≥
){

33656 
ty≥
;

33657 
wöFûe
 *
pFûe
 = (wöFûe*)
id
;

33658 
rc
 = 
SQLITE_OK
;

33659 
	`as£π
–
pFûe
!=0 );

33660 
	`as£π
–
lockty≥
<=
SHARED_LOCK
 );

33661 
	`OSTRACE
(("UNLOCK file=%p, oldLock=%d(%d),ÇewLock=%d\n",

33662 
pFûe
->
h
,ÖFûe->
lockty≥
,ÖFûe->
sh¨edLockByã
,Üocktype));

33663 
ty≥
 = 
pFûe
->
lockty≥
;

33664 if–
ty≥
>=
EXCLUSIVE_LOCK
 ){

33665 
	`wöU∆ockFûe
(&
pFûe
->
h
, 
SHARED_FIRST
, 0, 
SHARED_SIZE
, 0);

33666 if–
lockty≥
==
SHARED_LOCK
 && !
	`wöGëRódLock
(
pFûe
) ){

33669 
rc
 = 
	`wöLogEº‹
(
SQLITE_IOERR_UNLOCK
, 
	`osGëLa°Eº‹
(),

33670 "wöU∆ock", 
pFûe
->
zP©h
);

33673 if–
ty≥
>=
RESERVED_LOCK
 ){

33674 
	`wöU∆ockFûe
(&
pFûe
->
h
, 
RESERVED_BYTE
, 0, 1, 0);

33676 if–
lockty≥
==
NO_LOCK
 && 
ty≥
>=
SHARED_LOCK
 ){

33677 
	`wöU∆ockRódLock
(
pFûe
);

33679 if–
ty≥
>=
PENDING_LOCK
 ){

33680 
	`wöU∆ockFûe
(&
pFûe
->
h
, 
PENDING_BYTE
, 0, 1, 0);

33682 
pFûe
->
lockty≥
 = (
u8
)locktype;

33683 
	`OSTRACE
(("UNLOCK file=%p,Üock=%d,Ñc=%s\n",

33684 
pFûe
->
h
,ÖFûe->
lockty≥
, 
	`sqlôe3EºName
(
rc
)));

33685  
rc
;

33694 
	`wöModeBô
(
wöFûe
 *
pFûe
, 
mask
, *
pArg
){

33695 if–*
pArg
<0 ){

33696 *
pArg
 = (
pFûe
->
˘æFœgs
 & 
mask
)!=0;

33697 }if–(*
pArg
)==0 ){

33698 
pFûe
->
˘æFœgs
 &~
mask
;

33700 
pFûe
->
˘æFœgs
 |
mask
;

33705 
	`wöGëTem≤ame
(
sqlôe3_vfs
 *, **);

33706 
	`wöIsDú
(const *);

33707 
BOOL
 
	`wöIsDriveLëãrAndCﬁ⁄
(const *);

33712 
	`wöFûeC⁄åﬁ
(
sqlôe3_fûe
 *
id
, 
›
, *
pArg
){

33713 
wöFûe
 *
pFûe
 = (wöFûe*)
id
;

33714 
	`OSTRACE
(("FCNTL fûe=%p, op=%d,ÖArg=%p\n", 
pFûe
->
h
, 
›
, 
pArg
));

33715  
›
 ){

33716 
SQLITE_FCNTL_LOCKSTATE
: {

33717 *(*)
pArg
 = 
pFûe
->
lockty≥
;

33718 
	`OSTRACE
(("FCNTL fûe=%p,Ñc=SQLITE_OK\n", 
pFûe
->
h
));

33719  
SQLITE_OK
;

33721 
SQLITE_LAST_ERRNO
: {

33722 *(*)
pArg
 = ()
pFûe
->
œ°Eºno
;

33723 
	`OSTRACE
(("FCNTL fûe=%p,Ñc=SQLITE_OK\n", 
pFûe
->
h
));

33724  
SQLITE_OK
;

33726 
SQLITE_FCNTL_CHUNK_SIZE
: {

33727 
pFûe
->
szChunk
 = *(*)
pArg
;

33728 
	`OSTRACE
(("FCNTL fûe=%p,Ñc=SQLITE_OK\n", 
pFûe
->
h
));

33729  
SQLITE_OK
;

33731 
SQLITE_FCNTL_SIZE_HINT
: {

33732 if–
pFûe
->
szChunk
>0 ){

33733 
sqlôe3_öt64
 
ﬁdSz
;

33734 
rc
 = 
	`wöFûeSize
(
id
, &
ﬁdSz
);

33735 if–
rc
==
SQLITE_OK
 ){

33736 
sqlôe3_öt64
 
√wSz
 = *(sqlôe3_öt64*)
pArg
;

33737 if–
√wSz
>
ﬁdSz
 ){

33738 
	`SimuœãIOEº‹Bíign
(1);

33739 
rc
 = 
	`wöTrunˇã
(
id
, 
√wSz
);

33740 
	`SimuœãIOEº‹Bíign
(0);

33743 
	`OSTRACE
(("FCNTL fûe=%p,Ñc=%s\n", 
pFûe
->
h
, 
	`sqlôe3EºName
(
rc
)));

33744  
rc
;

33746 
	`OSTRACE
(("FCNTL fûe=%p,Ñc=SQLITE_OK\n", 
pFûe
->
h
));

33747  
SQLITE_OK
;

33749 
SQLITE_FCNTL_PERSIST_WAL
: {

33750 
	`wöModeBô
(
pFûe
, 
WINFILE_PERSIST_WAL
, (*)
pArg
);

33751 
	`OSTRACE
(("FCNTL fûe=%p,Ñc=SQLITE_OK\n", 
pFûe
->
h
));

33752  
SQLITE_OK
;

33754 
SQLITE_FCNTL_POWERSAFE_OVERWRITE
: {

33755 
	`wöModeBô
(
pFûe
, 
WINFILE_PSOW
, (*)
pArg
);

33756 
	`OSTRACE
(("FCNTL fûe=%p,Ñc=SQLITE_OK\n", 
pFûe
->
h
));

33757  
SQLITE_OK
;

33759 
SQLITE_FCNTL_VFSNAME
: {

33760 *(**)
pArg
 = 
	`sqlôe3_m¥ötf
("win32");

33761 
	`OSTRACE
(("FCNTL fûe=%p,Ñc=SQLITE_OK\n", 
pFûe
->
h
));

33762  
SQLITE_OK
;

33764 
SQLITE_FCNTL_WIN32_AV_RETRY
: {

33765 *
a
 = (*)
pArg
;

33766 if–
a
[0]>0 ){

33767 
wöI€ºRëry
 = 
a
[0];

33769 
a
[0] = 
wöI€ºRëry
;

33771 if–
a
[1]>0 ){

33772 
wöI€ºRëryDñay
 = 
a
[1];

33774 
a
[1] = 
wöI€ºRëryDñay
;

33776 
	`OSTRACE
(("FCNTL fûe=%p,Ñc=SQLITE_OK\n", 
pFûe
->
h
));

33777  
SQLITE_OK
;

33779 
SQLITE_FCNTL_TEMPFILENAME
: {

33780 *
zTFûe
 = 0;

33781 
rc
 = 
	`wöGëTem≤ame
(
pFûe
->
pVfs
, &
zTFûe
);

33782 if–
rc
==
SQLITE_OK
 ){

33783 *(**)
pArg
 = 
zTFûe
;

33785 
	`OSTRACE
(("FCNTL fûe=%p,Ñc=%s\n", 
pFûe
->
h
, 
	`sqlôe3EºName
(
rc
)));

33786  
rc
;

33788 #i‡
SQLITE_MAX_MMAP_SIZE
>0

33789 
SQLITE_FCNTL_MMAP_SIZE
: {

33790 
i64
 
√wLimô
 = *(i64*)
pArg
;

33791 
rc
 = 
SQLITE_OK
;

33792 if–
√wLimô
>
sqlôe3GlobÆC⁄fig
.
mxMm≠
 ){

33793 
√wLimô
 = 
sqlôe3GlobÆC⁄fig
.
mxMm≠
;

33795 *(
i64
*)
pArg
 = 
pFûe
->
mm≠SizeMax
;

33796 if–
√wLimô
>=0 &&ÇewLimô!=
pFûe
->
mm≠SizeMax
 &&ÖFûe->
nFëchOut
==0 ){

33797 
pFûe
->
mm≠SizeMax
 = 
√wLimô
;

33798 if–
pFûe
->
mm≠Size
>0 ){

33799 
	`wöUnm≠fûe
(
pFûe
);

33800 
rc
 = 
	`wöM≠fûe
(
pFûe
, -1);

33803 
	`OSTRACE
(("FCNTL fûe=%p,Ñc=%s\n", 
pFûe
->
h
, 
	`sqlôe3EºName
(
rc
)));

33804  
rc
;

33808 
	`OSTRACE
(("FCNTL fûe=%p,Ñc=SQLITE_NOTFOUND\n", 
pFûe
->
h
));

33809  
SQLITE_NOTFOUND
;

33822 
	`wöSe˘‹Size
(
sqlôe3_fûe
 *
id
){

33823 ()
id
;

33824  
SQLITE_DEFAULT_SECTOR_SIZE
;

33830 
	`wöDevi˚Ch¨a˘îi°ics
(
sqlôe3_fûe
 *
id
){

33831 
wöFûe
 *
p
 = (wöFûe*)
id
;

33832  
SQLITE_IOCAP_UNDELETABLE_WHEN_OPEN
 |

33833 ((
p
->
˘æFœgs
 & 
WINFILE_PSOW
)?
SQLITE_IOCAP_POWERSAFE_OVERWRITE
:0);

33842 
SYSTEM_INFO
 
wöSysInfo
;

33844 #i‚de‡
SQLITE_OMIT_WAL


33859 
	`wöShmE¡îMuãx
(){

33860 
	`sqlôe3_muãx_íãr
(
	`sqlôe3MuãxAŒoc
(
SQLITE_MUTEX_STATIC_MASTER
));

33862 
	`wöShmLóveMuãx
(){

33863 
	`sqlôe3_muãx_Àave
(
	`sqlôe3MuãxAŒoc
(
SQLITE_MUTEX_STATIC_MASTER
));

33865 #ifde‡
SQLITE_DEBUG


33866 
	`wöShmMuãxHñd
() {

33867  
	`sqlôe3_muãx_hñd
(
	`sqlôe3MuãxAŒoc
(
SQLITE_MUTEX_STATIC_MASTER
));

33894 
	swöShmNode
 {

33895 
sqlôe3_muãx
 *
muãx
;

33896 *
zFûíame
;

33897 
wöFûe
 
hFûe
;

33899 
szRegi⁄
;

33900 
nRegi⁄
;

33901 
	sShmRegi⁄
 {

33902 
HANDLE
 
hM≠
;

33903 *
pM≠
;

33904 } *
aRegi⁄
;

33905 
DWORD
 
œ°Eºno
;

33907 
nRef
;

33908 
wöShm
 *
pFú°
;

33909 
wöShmNode
 *
pNext
;

33910 #ifde‡
SQLITE_DEBUG


33911 
u8
 
√xtShmId
;

33920 
wöShmNode
 *
wöShmNodeLi°
 = 0;

33935 
	swöShm
 {

33936 
wöShmNode
 *
pShmNode
;

33937 
wöShm
 *
pNext
;

33938 
u8
 
hasMuãx
;

33939 
u16
 
sh¨edMask
;

33940 
u16
 
ex˛Mask
;

33941 #ifde‡
SQLITE_DEBUG


33942 
u8
 
id
;

33949 
	#WIN_SHM_BASE
 ((22+
SQLITE_SHM_NLOCK
)*4Ë

	)

33950 
	#WIN_SHM_DMS
 (
WIN_SHM_BASE
+
SQLITE_SHM_NLOCK
Ë

	)

33955 
	#_SHM_UNLCK
 1

	)

33956 
	#_SHM_RDLCK
 2

	)

33957 
	#_SHM_WRLCK
 3

	)

33958 
	`wöShmSy°emLock
(

33959 
wöShmNode
 *
pFûe
,

33960 
lockTy≥
,

33961 
of°
,

33962 
nByã


33964 
rc
 = 0;

33967 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pFûe
->
muãx
Ë||ÖFûe->
nRef
==0 );

33969 
	`OSTRACE
(("SHM-LOCK file=%p,Üock=%d, offset=%d, size=%d\n",

33970 
pFûe
->
hFûe
.
h
, 
lockTy≥
, 
of°
, 
nByã
));

33973 if–
lockTy≥
==
_SHM_UNLCK
 ){

33974 
rc
 = 
	`wöU∆ockFûe
(&
pFûe
->
hFûe
.
h
, 
of°
, 0, 
nByã
, 0);

33977 
DWORD
 
dwFœgs
 = 
LOCKFILE_FAIL_IMMEDIATELY
;

33978 if–
lockTy≥
 =
_SHM_WRLCK
 ) 
dwFœgs
 |
LOCKFILE_EXCLUSIVE_LOCK
;

33979 
rc
 = 
	`wöLockFûe
(&
pFûe
->
hFûe
.
h
, 
dwFœgs
, 
of°
, 0, 
nByã
, 0);

33982 if–
rc
!= 0 ){

33983 
rc
 = 
SQLITE_OK
;

33985 
pFûe
->
œ°Eºno
 = 
	`osGëLa°Eº‹
();

33986 
rc
 = 
SQLITE_BUSY
;

33989 
	`OSTRACE
(("SHM-LOCK file=%p, func=%s,Érrno=%lu,Ñc=%s\n",

33990 
pFûe
->
hFûe
.
h
, (
lockTy≥
 =
_SHM_UNLCK
) ? "winUnlockFile" :

33991 "wöLockFûe", 
pFûe
->
œ°Eºno
, 
	`sqlôe3EºName
(
rc
)));

33993  
rc
;

33997 
	`wöO≥n
(
sqlôe3_vfs
*,c⁄° *,
sqlôe3_fûe
*,,*);

33998 
	`wöDñëe
(
sqlôe3_vfs
 *,const *,);

34006 
	`wöShmPurge
(
sqlôe3_vfs
 *
pVfs
, 
dñëeFœg
){

34007 
wöShmNode
 **
µ
;

34008 
wöShmNode
 *
p
;

34009 
	`as£π
–
	`wöShmMuãxHñd
() );

34010 
	`OSTRACE
(("SHM-PURGEÖid=%lu, deleteFlag=%d\n",

34011 
	`osGëCuºítPro˚ssId
(), 
dñëeFœg
));

34012 
µ
 = &
wöShmNodeLi°
;

34013  (
p
 = *
µ
)!=0 ){

34014 if–
p
->
nRef
==0 ){

34015 
i
;

34016 if–
p
->
muãx
 ){ 
	`sqlôe3_muãx_‰ì
(p->mutex); }

34017 
i
=0; i<
p
->
nRegi⁄
; i++){

34018 
BOOL
 
bRc
 = 
	`osUnm≠VõwOfFûe
(
p
->
aRegi⁄
[
i
].
pM≠
);

34019 
	`OSTRACE
(("SHM-PURGE-UNMAPÖid=%lu,Ñegion=%d,Ñc=%s\n",

34020 
	`osGëCuºítPro˚ssId
(), 
i
, 
bRc
 ? "ok" : "failed"));

34021 
	`UNUSED_VARIABLE_VALUE
(
bRc
);

34022 
bRc
 = 
	`osClo£H™dÀ
(
p
->
aRegi⁄
[
i
].
hM≠
);

34023 
	`OSTRACE
(("SHM-PURGE-CLOSEÖid=%lu,Ñegion=%d,Ñc=%s\n",

34024 
	`osGëCuºítPro˚ssId
(), 
i
, 
bRc
 ? "ok" : "failed"));

34025 
	`UNUSED_VARIABLE_VALUE
(
bRc
);

34027 if–
p
->
hFûe
.
h
!=
NULL
 &&Ö->hFûe.h!=
INVALID_HANDLE_VALUE
 ){

34028 
	`SimuœãIOEº‹Bíign
(1);

34029 
	`wöClo£
((
sqlôe3_fûe
 *)&
p
->
hFûe
);

34030 
	`SimuœãIOEº‹Bíign
(0);

34032 if–
dñëeFœg
 ){

34033 
	`SimuœãIOEº‹Bíign
(1);

34034 
	`sqlôe3BegöBíignMÆloc
();

34035 
	`wöDñëe
(
pVfs
, 
p
->
zFûíame
, 0);

34036 
	`sqlôe3EndBíignMÆloc
();

34037 
	`SimuœãIOEº‹Bíign
(0);

34039 *
µ
 = 
p
->
pNext
;

34040 
	`sqlôe3_‰ì
(
p
->
aRegi⁄
);

34041 
	`sqlôe3_‰ì
(
p
);

34043 
µ
 = &
p
->
pNext
;

34055 
	`wöO≥nSh¨edMem‹y
(
wöFûe
 *
pDbFd
){

34056 
wöShm
 *
p
;

34057 
wöShmNode
 *
pShmNode
 = 0;

34058 
rc
;

34059 
wöShmNode
 *
pNew
;

34060 
nName
;

34062 
	`as£π
–
pDbFd
->
pShm
==0 );

34067 
p
 = 
	`sqlôe3MÆlocZîo
( (*p) );

34068 if–
p
==0 )  
SQLITE_IOERR_NOMEM
;

34069 
nName
 = 
	`sqlôe3SåÀn30
(
pDbFd
->
zP©h
);

34070 
pNew
 = 
	`sqlôe3MÆlocZîo
–(*
pShmNode
Ë+ 
nName
 + 17 );

34071 if–
pNew
==0 ){

34072 
	`sqlôe3_‰ì
(
p
);

34073  
SQLITE_IOERR_NOMEM
;

34075 
pNew
->
zFûíame
 = (*)&pNew[1];

34076 
	`sqlôe3_¢¥ötf
(
nName
+15, 
pNew
->
zFûíame
, "%s-shm", 
pDbFd
->
zP©h
);

34077 
	`sqlôe3FûeSuffix3
(
pDbFd
->
zP©h
, 
pNew
->
zFûíame
);

34082 
	`wöShmE¡îMuãx
();

34083 
pShmNode
 = 
wöShmNodeLi°
;ÖShmNode;ÖShmNodeıShmNode->
pNext
){

34087 if–
	`sqlôe3SåICmp
(
pShmNode
->
zFûíame
, 
pNew
->zFilename)==0 ) ;

34089 if–
pShmNode
 ){

34090 
	`sqlôe3_‰ì
(
pNew
);

34092 
pShmNode
 = 
pNew
;

34093 
pNew
 = 0;

34094 ((
wöFûe
*)(&
pShmNode
->
hFûe
))->
h
 = 
INVALID_HANDLE_VALUE
;

34095 
pShmNode
->
pNext
 = 
wöShmNodeLi°
;

34096 
wöShmNodeLi°
 = 
pShmNode
;

34098 
pShmNode
->
muãx
 = 
	`sqlôe3_muãx_Æloc
(
SQLITE_MUTEX_FAST
);

34099 if–
pShmNode
->
muãx
==0 ){

34100 
rc
 = 
SQLITE_IOERR_NOMEM
;

34101 
shm_›í_îr
;

34104 
rc
 = 
	`wöO≥n
(
pDbFd
->
pVfs
,

34105 
pShmNode
->
zFûíame
,

34106 (
sqlôe3_fûe
*)&
pShmNode
->
hFûe
,

34107 
SQLITE_OPEN_WAL
 | 
SQLITE_OPEN_READWRITE
 | 
SQLITE_OPEN_CREATE
,

34109 if–
SQLITE_OK
!=
rc
 ){

34110 
shm_›í_îr
;

34116 if–
	`wöShmSy°emLock
(
pShmNode
, 
_SHM_WRLCK
, 
WIN_SHM_DMS
, 1)==
SQLITE_OK
 ){

34117 
rc
 = 
	`wöTrunˇã
((
sqlôe3_fûe
 *)&
pShmNode
->
hFûe
, 0);

34118 if–
rc
!=
SQLITE_OK
 ){

34119 
rc
 = 
	`wöLogEº‹
(
SQLITE_IOERR_SHMOPEN
, 
	`osGëLa°Eº‹
(),

34120 "wöO≥nShm", 
pDbFd
->
zP©h
);

34123 if–
rc
==
SQLITE_OK
 ){

34124 
	`wöShmSy°emLock
(
pShmNode
, 
_SHM_UNLCK
, 
WIN_SHM_DMS
, 1);

34125 
rc
 = 
	`wöShmSy°emLock
(
pShmNode
, 
_SHM_RDLCK
, 
WIN_SHM_DMS
, 1);

34127 if–
rc
 ) 
shm_›í_îr
;

34131 
p
->
pShmNode
 =ÖShmNode;

34132 #ifde‡
SQLITE_DEBUG


34133 
p
->
id
 = 
pShmNode
->
√xtShmId
++;

34135 
pShmNode
->
nRef
++;

34136 
pDbFd
->
pShm
 = 
p
;

34137 
	`wöShmLóveMuãx
();

34146 
	`sqlôe3_muãx_íãr
(
pShmNode
->
muãx
);

34147 
p
->
pNext
 = 
pShmNode
->
pFú°
;

34148 
pShmNode
->
pFú°
 = 
p
;

34149 
	`sqlôe3_muãx_Àave
(
pShmNode
->
muãx
);

34150  
SQLITE_OK
;

34153 
shm_›í_îr
:

34154 
	`wöShmSy°emLock
(
pShmNode
, 
_SHM_UNLCK
, 
WIN_SHM_DMS
, 1);

34155 
	`wöShmPurge
(
pDbFd
->
pVfs
, 0);

34156 
	`sqlôe3_‰ì
(
p
);

34157 
	`sqlôe3_‰ì
(
pNew
);

34158 
	`wöShmLóveMuãx
();

34159  
rc
;

34166 
	`wöShmUnm≠
(

34167 
sqlôe3_fûe
 *
fd
,

34168 
dñëeFœg


34170 
wöFûe
 *
pDbFd
;

34171 
wöShm
 *
p
;

34172 
wöShmNode
 *
pShmNode
;

34173 
wöShm
 **
µ
;

34175 
pDbFd
 = (
wöFûe
*)
fd
;

34176 
p
 = 
pDbFd
->
pShm
;

34177 if–
p
==0 )  
SQLITE_OK
;

34178 
pShmNode
 = 
p
->pShmNode;

34182 
	`sqlôe3_muãx_íãr
(
pShmNode
->
muãx
);

34183 
µ
=&
pShmNode
->
pFú°
; (*µ)!=
p
;Ö∞&(*µ)->
pNext
){}

34184 *
µ
 = 
p
->
pNext
;

34187 
	`sqlôe3_‰ì
(
p
);

34188 
pDbFd
->
pShm
 = 0;

34189 
	`sqlôe3_muãx_Àave
(
pShmNode
->
muãx
);

34193 
	`wöShmE¡îMuãx
();

34194 
	`as£π
–
pShmNode
->
nRef
>0 );

34195 
pShmNode
->
nRef
--;

34196 if–
pShmNode
->
nRef
==0 ){

34197 
	`wöShmPurge
(
pDbFd
->
pVfs
, 
dñëeFœg
);

34199 
	`wöShmLóveMuãx
();

34201  
SQLITE_OK
;

34207 
	`wöShmLock
(

34208 
sqlôe3_fûe
 *
fd
,

34209 
of°
,

34210 
n
,

34211 
Êags


34213 
wöFûe
 *
pDbFd
 = (wöFûe*)
fd
;

34214 
wöShm
 *
p
 = 
pDbFd
->
pShm
;

34215 
wöShm
 *
pX
;

34216 
wöShmNode
 *
pShmNode
 = 
p
->pShmNode;

34217 
rc
 = 
SQLITE_OK
;

34218 
u16
 
mask
;

34220 
	`as£π
–
of°
>=0 && of°+
n
<=
SQLITE_SHM_NLOCK
 );

34221 
	`as£π
–
n
>=1 );

34222 
	`as£π
–
Êags
==(
SQLITE_SHM_LOCK
 | 
SQLITE_SHM_SHARED
)

34223 || 
Êags
==(
SQLITE_SHM_LOCK
 | 
SQLITE_SHM_EXCLUSIVE
)

34224 || 
Êags
==(
SQLITE_SHM_UNLOCK
 | 
SQLITE_SHM_SHARED
)

34225 || 
Êags
==(
SQLITE_SHM_UNLOCK
 | 
SQLITE_SHM_EXCLUSIVE
) );

34226 
	`as£π
–
n
==1 || (
Êags
 & 
SQLITE_SHM_EXCLUSIVE
)!=0 );

34228 
mask
 = (
u16
)((1U<<(
of°
+
n
)) - (1U<<ofst));

34229 
	`as£π
–
n
>1 || 
mask
==(1<<
of°
) );

34230 
	`sqlôe3_muãx_íãr
(
pShmNode
->
muãx
);

34231 if–
Êags
 & 
SQLITE_SHM_UNLOCK
 ){

34232 
u16
 
ÆlMask
 = 0;

34235 
pX
=
pShmNode
->
pFú°
;ÖX;ÖXıX->
pNext
){

34236 if–
pX
==
p
 ) ;

34237 
	`as£π
–(
pX
->
ex˛Mask
 & (
p
->ex˛Mask|p->
sh¨edMask
))==0 );

34238 
ÆlMask
 |
pX
->
sh¨edMask
;

34242 if–(
mask
 & 
ÆlMask
)==0 ){

34243 
rc
 = 
	`wöShmSy°emLock
(
pShmNode
, 
_SHM_UNLCK
, 
of°
+
WIN_SHM_BASE
, 
n
);

34245 
rc
 = 
SQLITE_OK
;

34249 if–
rc
==
SQLITE_OK
 ){

34250 
p
->
ex˛Mask
 &~
mask
;

34251 
p
->
sh¨edMask
 &~
mask
;

34253 }if–
Êags
 & 
SQLITE_SHM_SHARED
 ){

34254 
u16
 
ÆlSh¨ed
 = 0;

34260 
pX
=
pShmNode
->
pFú°
;ÖX;ÖXıX->
pNext
){

34261 if–(
pX
->
ex˛Mask
 & 
mask
)!=0 ){

34262 
rc
 = 
SQLITE_BUSY
;

34265 
ÆlSh¨ed
 |
pX
->
sh¨edMask
;

34269 if–
rc
==
SQLITE_OK
 ){

34270 if–(
ÆlSh¨ed
 & 
mask
)==0 ){

34271 
rc
 = 
	`wöShmSy°emLock
(
pShmNode
, 
_SHM_RDLCK
, 
of°
+
WIN_SHM_BASE
, 
n
);

34273 
rc
 = 
SQLITE_OK
;

34278 if–
rc
==
SQLITE_OK
 ){

34279 
p
->
sh¨edMask
 |
mask
;

34285 
pX
=
pShmNode
->
pFú°
;ÖX;ÖXıX->
pNext
){

34286 if–(
pX
->
ex˛Mask
 & 
mask
)!=0 || (pX->
sh¨edMask
 & mask)!=0 ){

34287 
rc
 = 
SQLITE_BUSY
;

34295 if–
rc
==
SQLITE_OK
 ){

34296 
rc
 = 
	`wöShmSy°emLock
(
pShmNode
, 
_SHM_WRLCK
, 
of°
+
WIN_SHM_BASE
, 
n
);

34297 if–
rc
==
SQLITE_OK
 ){

34298 
	`as£π
–(
p
->
sh¨edMask
 & 
mask
)==0 );

34299 
p
->
ex˛Mask
 |
mask
;

34303 
	`sqlôe3_muãx_Àave
(
pShmNode
->
muãx
);

34304 
	`OSTRACE
(("SHM-LOCKÖid=%lu, id=%d, sharedMask=%03x,ÉxclMask=%03x,Ñc=%s\n",

34305 
	`osGëCuºítPro˚ssId
(), 
p
->
id
,Ö->
sh¨edMask
,Ö->
ex˛Mask
,

34306 
	`sqlôe3EºName
(
rc
)));

34307  
rc
;

34316 
	`wöShmB¨rõr
(

34317 
sqlôe3_fûe
 *
fd


34319 
	`UNUSED_PARAMETER
(
fd
);

34321 
	`wöShmE¡îMuãx
();

34322 
	`wöShmLóveMuãx
();

34344 
	`wöShmM≠
(

34345 
sqlôe3_fûe
 *
fd
,

34346 
iRegi⁄
,

34347 
szRegi⁄
,

34348 
isWrôe
,

34349 vﬁ©ûê**
µ


34351 
wöFûe
 *
pDbFd
 = (wöFûe*)
fd
;

34352 
wöShm
 *
p
 = 
pDbFd
->
pShm
;

34353 
wöShmNode
 *
pShmNode
;

34354 
rc
 = 
SQLITE_OK
;

34356 if–!
p
 ){

34357 
rc
 = 
	`wöO≥nSh¨edMem‹y
(
pDbFd
);

34358 if–
rc
!=
SQLITE_OK
 ) Ñc;

34359 
p
 = 
pDbFd
->
pShm
;

34361 
pShmNode
 = 
p
->pShmNode;

34363 
	`sqlôe3_muãx_íãr
(
pShmNode
->
muãx
);

34364 
	`as£π
–
szRegi⁄
==
pShmNode
->szRegi⁄ ||ÖShmNode->
nRegi⁄
==0 );

34366 if–
pShmNode
->
nRegi⁄
<=
iRegi⁄
 ){

34367 
ShmRegi⁄
 *
≠New
;

34368 
nByã
 = (
iRegi⁄
+1)*
szRegi⁄
;

34369 
sqlôe3_öt64
 
sz
;

34371 
pShmNode
->
szRegi⁄
 = szRegion;

34377 
rc
 = 
	`wöFûeSize
((
sqlôe3_fûe
 *)&
pShmNode
->
hFûe
, &
sz
);

34378 if–
rc
!=
SQLITE_OK
 ){

34379 
rc
 = 
	`wöLogEº‹
(
SQLITE_IOERR_SHMSIZE
, 
	`osGëLa°Eº‹
(),

34380 "wöShmM≠1", 
pDbFd
->
zP©h
);

34381 
shm∑ge_out
;

34384 if–
sz
<
nByã
 ){

34391 if–!
isWrôe
 ) 
shm∑ge_out
;

34392 
rc
 = 
	`wöTrunˇã
((
sqlôe3_fûe
 *)&
pShmNode
->
hFûe
, 
nByã
);

34393 if–
rc
!=
SQLITE_OK
 ){

34394 
rc
 = 
	`wöLogEº‹
(
SQLITE_IOERR_SHMSIZE
, 
	`osGëLa°Eº‹
(),

34395 "wöShmM≠2", 
pDbFd
->
zP©h
);

34396 
shm∑ge_out
;

34401 
≠New
 = (
ShmRegi⁄
 *)
	`sqlôe3_ªÆloc
(

34402 
pShmNode
->
aRegi⁄
, (
iRegi⁄
+1)*(
≠New
[0])

34404 if–!
≠New
 ){

34405 
rc
 = 
SQLITE_IOERR_NOMEM
;

34406 
shm∑ge_out
;

34408 
pShmNode
->
aRegi⁄
 = 
≠New
;

34410  
pShmNode
->
nRegi⁄
<=
iRegi⁄
 ){

34411 
HANDLE
 
hM≠
 = 
NULL
;

34412 *
pM≠
 = 0;

34414 #i‡
SQLITE_OS_WINRT


34415 
hM≠
 = 
	`osCª©eFûeM≠pögFromAµ
(
pShmNode
->
hFûe
.
h
,

34416 
NULL
, 
PAGE_READWRITE
, 
nByã
, NULL

34418 #ñi‡
	`deföed
(
SQLITE_WIN32_HAS_WIDE
)

34419 
hM≠
 = 
	`osCª©eFûeM≠pögW
(
pShmNode
->
hFûe
.
h
,

34420 
NULL
, 
PAGE_READWRITE
, 0, 
nByã
, NULL

34422 #ñi‡
	`deföed
(
SQLITE_WIN32_HAS_ANSI
)

34423 
hM≠
 = 
	`osCª©eFûeM≠pögA
(
pShmNode
->
hFûe
.
h
,

34424 
NULL
, 
PAGE_READWRITE
, 0, 
nByã
, NULL

34427 
	`OSTRACE
(("SHM-MAP-CREATEÖid=%lu,Ñegion=%d, size=%d,Ñc=%s\n",

34428 
	`osGëCuºítPro˚ssId
(), 
pShmNode
->
nRegi⁄
, 
nByã
,

34429 
hM≠
 ? "ok" : "failed"));

34430 if–
hM≠
 ){

34431 
iOff£t
 = 
pShmNode
->
nRegi⁄
*
szRegi⁄
;

34432 
iOff£tShi·
 = 
iOff£t
 % 
wöSysInfo
.
dwAŒoˇti⁄Gønuœrôy
;

34433 #i‡
SQLITE_OS_WINRT


34434 
pM≠
 = 
	`osM≠VõwOfFûeFromAµ
(
hM≠
, 
FILE_MAP_WRITE
 | 
FILE_MAP_READ
,

34435 
iOff£t
 - 
iOff£tShi·
, 
szRegi⁄
 + iOffsetShift

34438 
pM≠
 = 
	`osM≠VõwOfFûe
(
hM≠
, 
FILE_MAP_WRITE
 | 
FILE_MAP_READ
,

34439 0, 
iOff£t
 - 
iOff£tShi·
, 
szRegi⁄
 + iOffsetShift

34442 
	`OSTRACE
(("SHM-MAP-MAPÖid=%lu,Ñegion=%d, offset=%d, size=%d,Ñc=%s\n",

34443 
	`osGëCuºítPro˚ssId
(), 
pShmNode
->
nRegi⁄
, 
iOff£t
,

34444 
szRegi⁄
, 
pM≠
 ? "ok" : "failed"));

34446 if–!
pM≠
 ){

34447 
pShmNode
->
œ°Eºno
 = 
	`osGëLa°Eº‹
();

34448 
rc
 = 
	`wöLogEº‹
(
SQLITE_IOERR_SHMMAP
, 
pShmNode
->
œ°Eºno
,

34449 "wöShmM≠3", 
pDbFd
->
zP©h
);

34450 if–
hM≠
 ) 
	`osClo£H™dÀ
(hMap);

34451 
shm∑ge_out
;

34454 
pShmNode
->
aRegi⁄
[pShmNode->
nRegi⁄
].
pM≠
 =ÖMap;

34455 
pShmNode
->
aRegi⁄
[pShmNode->
nRegi⁄
].
hM≠
 = hMap;

34456 
pShmNode
->
nRegi⁄
++;

34460 
shm∑ge_out
:

34461 if–
pShmNode
->
nRegi⁄
>
iRegi⁄
 ){

34462 
iOff£t
 = 
iRegi⁄
*
szRegi⁄
;

34463 
iOff£tShi·
 = 
iOff£t
 % 
wöSysInfo
.
dwAŒoˇti⁄Gønuœrôy
;

34464 *
p
 = (*)
pShmNode
->
aRegi⁄
[
iRegi⁄
].
pM≠
;

34465 *
µ
 = (*)&
p
[
iOff£tShi·
];

34467 *
µ
 = 0;

34469 
	`sqlôe3_muãx_Àave
(
pShmNode
->
muãx
);

34470  
rc
;

34474 
	#wöShmM≠
 0

	)

34475 
	#wöShmLock
 0

	)

34476 
	#wöShmB¨rõr
 0

	)

34477 
	#wöShmUnm≠
 0

	)

34483 #i‡
SQLITE_MAX_MMAP_SIZE
>0

34484 
	`wöUnm≠fûe
(
wöFûe
 *
pFûe
){

34485 
	`as£π
–
pFûe
!=0 );

34486 
	`OSTRACE
(("UNMAP-FILEÖid=%lu,ÖFile=%p, hMap=%p,ÖMapRegion=%p, "

34488 
	`osGëCuºítPro˚ssId
(), 
pFûe
,ÖFûe->
hM≠
,ÖFûe->
pM≠Regi⁄
,

34489 
pFûe
->
mm≠Size
,ÖFûe->
mm≠SizeA˘uÆ
,ÖFûe->
mm≠SizeMax
));

34490 if–
pFûe
->
pM≠Regi⁄
 ){

34491 if–!
	`osUnm≠VõwOfFûe
(
pFûe
->
pM≠Regi⁄
) ){

34492 
pFûe
->
œ°Eºno
 = 
	`osGëLa°Eº‹
();

34493 
	`OSTRACE
(("UNMAP-FILEÖid=%lu,ÖFile=%p,ÖMapRegion=%p, "

34494 "rc=SQLITE_IOERR_MMAP\n", 
	`osGëCuºítPro˚ssId
(), 
pFûe
,

34495 
pFûe
->
pM≠Regi⁄
));

34496  
	`wöLogEº‹
(
SQLITE_IOERR_MMAP
, 
pFûe
->
œ°Eºno
,

34497 "wöUnm≠fûe1", 
pFûe
->
zP©h
);

34499 
pFûe
->
pM≠Regi⁄
 = 0;

34500 
pFûe
->
mm≠Size
 = 0;

34501 
pFûe
->
mm≠SizeA˘uÆ
 = 0;

34503 if–
pFûe
->
hM≠
!=
NULL
 ){

34504 if–!
	`osClo£H™dÀ
(
pFûe
->
hM≠
) ){

34505 
pFûe
->
œ°Eºno
 = 
	`osGëLa°Eº‹
();

34506 
	`OSTRACE
(("UNMAP-FILEÖid=%lu,ÖFile=%p, hMap=%p,Ñc=SQLITE_IOERR_MMAP\n",

34507 
	`osGëCuºítPro˚ssId
(), 
pFûe
,ÖFûe->
hM≠
));

34508  
	`wöLogEº‹
(
SQLITE_IOERR_MMAP
, 
pFûe
->
œ°Eºno
,

34509 "wöUnm≠fûe2", 
pFûe
->
zP©h
);

34511 
pFûe
->
hM≠
 = 
NULL
;

34513 
	`OSTRACE
(("UNMAP-FILEÖid=%lu,ÖFile=%p,Ñc=SQLITE_OK\n",

34514 
	`osGëCuºítPro˚ssId
(), 
pFûe
));

34515  
SQLITE_OK
;

34534 
	`wöM≠fûe
(
wöFûe
 *
pFd
, 
sqlôe3_öt64
 
nByã
){

34535 
sqlôe3_öt64
 
nM≠
 = 
nByã
;

34536 
rc
;

34538 
	`as£π
–
nM≠
>=0 || 
pFd
->
nFëchOut
==0 );

34539 
	`OSTRACE
(("MAP-FILEÖid=%lu,ÖFile=%p, size=%lld\n",

34540 
	`osGëCuºítPro˚ssId
(), 
pFd
, 
nByã
));

34542 if–
pFd
->
nFëchOut
>0 )  
SQLITE_OK
;

34544 if–
nM≠
<0 ){

34545 
rc
 = 
	`wöFûeSize
((
sqlôe3_fûe
*)
pFd
, &
nM≠
);

34546 if–
rc
 ){

34547 
	`OSTRACE
(("MAP-FILEÖid=%lu,ÖFile=%p,Ñc=SQLITE_IOERR_FSTAT\n",

34548 
	`osGëCuºítPro˚ssId
(), 
pFd
));

34549  
SQLITE_IOERR_FSTAT
;

34552 if–
nM≠
>
pFd
->
mm≠SizeMax
 ){

34553 
nM≠
 = 
pFd
->
mm≠SizeMax
;

34555 
nM≠
 &~(
sqlôe3_öt64
)(
wöSysInfo
.
dwPageSize
 - 1);

34557 if–
nM≠
==0 && 
pFd
->
mm≠Size
>0 ){

34558 
	`wöUnm≠fûe
(
pFd
);

34560 if–
nM≠
!=
pFd
->
mm≠Size
 ){

34561 *
pNew
 = 0;

34562 
DWORD
 
¥Ÿe˘
 = 
PAGE_READONLY
;

34563 
DWORD
 
Êags
 = 
FILE_MAP_READ
;

34565 
	`wöUnm≠fûe
(
pFd
);

34566 if–(
pFd
->
˘æFœgs
 & 
WINFILE_RDONLY
)==0 ){

34567 
¥Ÿe˘
 = 
PAGE_READWRITE
;

34568 
Êags
 |
FILE_MAP_WRITE
;

34570 #i‡
SQLITE_OS_WINRT


34571 
pFd
->
hM≠
 = 
	`osCª©eFûeM≠pögFromAµ
’Fd->
h
, 
NULL
, 
¥Ÿe˘
, 
nM≠
, NULL);

34572 #ñi‡
	`deföed
(
SQLITE_WIN32_HAS_WIDE
)

34573 
pFd
->
hM≠
 = 
	`osCª©eFûeM≠pögW
’Fd->
h
, 
NULL
, 
¥Ÿe˘
,

34574 (
DWORD
)((
nM≠
>>32) & 0xffffffff),

34575 (
DWORD
)(
nM≠
 & 0xffffffff), 
NULL
);

34576 #ñi‡
	`deföed
(
SQLITE_WIN32_HAS_ANSI
)

34577 
pFd
->
hM≠
 = 
	`osCª©eFûeM≠pögA
’Fd->
h
, 
NULL
, 
¥Ÿe˘
,

34578 (
DWORD
)((
nM≠
>>32) & 0xffffffff),

34579 (
DWORD
)(
nM≠
 & 0xffffffff), 
NULL
);

34581 if–
pFd
->
hM≠
==
NULL
 ){

34582 
pFd
->
œ°Eºno
 = 
	`osGëLa°Eº‹
();

34583 
rc
 = 
	`wöLogEº‹
(
SQLITE_IOERR_MMAP
, 
pFd
->
œ°Eºno
,

34584 "wöM≠fûe1", 
pFd
->
zP©h
);

34586 
	`OSTRACE
(("MAP-FILE-CREATEÖid=%lu,ÖFile=%p,Ñc=%s\n",

34587 
	`osGëCuºítPro˚ssId
(), 
pFd
, 
	`sqlôe3EºName
(
rc
)));

34588  
SQLITE_OK
;

34590 
	`as£π
–(
nM≠
 % 
wöSysInfo
.
dwPageSize
)==0 );

34591 
	`as£π
–(
SIZE_T
)==(
sqlôe3_öt64
Ë|| 
nM≠
<=0xffffffff );

34592 #i‡
SQLITE_OS_WINRT


34593 
pNew
 = 
	`osM≠VõwOfFûeFromAµ
(
pFd
->
hM≠
, 
Êags
, 0, (
SIZE_T
)
nM≠
);

34595 
pNew
 = 
	`osM≠VõwOfFûe
(
pFd
->
hM≠
, 
Êags
, 0, 0, (
SIZE_T
)
nM≠
);

34597 if–
pNew
==
NULL
 ){

34598 
	`osClo£H™dÀ
(
pFd
->
hM≠
);

34599 
pFd
->
hM≠
 = 
NULL
;

34600 
pFd
->
œ°Eºno
 = 
	`osGëLa°Eº‹
();

34601 
rc
 = 
	`wöLogEº‹
(
SQLITE_IOERR_MMAP
, 
pFd
->
œ°Eºno
,

34602 "wöM≠fûe2", 
pFd
->
zP©h
);

34604 
	`OSTRACE
(("MAP-FILE-MAPÖid=%lu,ÖFile=%p,Ñc=%s\n",

34605 
	`osGëCuºítPro˚ssId
(), 
pFd
, 
	`sqlôe3EºName
(
rc
)));

34606  
SQLITE_OK
;

34608 
pFd
->
pM≠Regi⁄
 = 
pNew
;

34609 
pFd
->
mm≠Size
 = 
nM≠
;

34610 
pFd
->
mm≠SizeA˘uÆ
 = 
nM≠
;

34613 
	`OSTRACE
(("MAP-FILEÖid=%lu,ÖFile=%p,Ñc=SQLITE_OK\n",

34614 
	`osGëCuºítPro˚ssId
(), 
pFd
));

34615  
SQLITE_OK
;

34631 
	`wöFëch
(
sqlôe3_fûe
 *
fd
, 
i64
 
iOff
, 
nAmt
, **
µ
){

34632 #i‡
SQLITE_MAX_MMAP_SIZE
>0

34633 
wöFûe
 *
pFd
 = (wöFûe*)
fd
;

34635 *
µ
 = 0;

34637 
	`OSTRACE
(("FETCHÖid=%lu,ÖFile=%p, offset=%lld,ámount=%d,Öp=%p\n",

34638 
	`osGëCuºítPro˚ssId
(), 
fd
, 
iOff
, 
nAmt
, 
µ
));

34640 #i‡
SQLITE_MAX_MMAP_SIZE
>0

34641 if–
pFd
->
mm≠SizeMax
>0 ){

34642 if–
pFd
->
pM≠Regi⁄
==0 ){

34643 
rc
 = 
	`wöM≠fûe
(
pFd
, -1);

34644 if–
rc
!=
SQLITE_OK
 ){

34645 
	`OSTRACE
(("FETCHÖid=%lu,ÖFile=%p,Ñc=%s\n",

34646 
	`osGëCuºítPro˚ssId
(), 
pFd
, 
	`sqlôe3EºName
(
rc
)));

34647  
rc
;

34650 if–
pFd
->
mm≠Size
 >
iOff
+
nAmt
 ){

34651 *
µ
 = &((
u8
 *)
pFd
->
pM≠Regi⁄
)[
iOff
];

34652 
pFd
->
nFëchOut
++;

34657 
	`OSTRACE
(("FETCHÖid=%lu,ÖFile=%p,Öp=%p, *pp=%p,Ñc=SQLITE_OK\n",

34658 
	`osGëCuºítPro˚ssId
(), 
fd
, 
µ
, *pp));

34659  
SQLITE_OK
;

34672 
	`wöUn„tch
(
sqlôe3_fûe
 *
fd
, 
i64
 
iOff
, *
p
){

34673 #i‡
SQLITE_MAX_MMAP_SIZE
>0

34674 
wöFûe
 *
pFd
 = (wöFûe*)
fd
;

34679 
	`as£π
–(
p
==0)==(
pFd
->
nFëchOut
==0) );

34682 
	`as£π
–
p
==0 ||Ö==&((
u8
 *)
pFd
->
pM≠Regi⁄
)[
iOff
] );

34684 
	`OSTRACE
(("UNFETCHÖid=%lu,ÖFile=%p, offset=%lld,Ö=%p\n",

34685 
	`osGëCuºítPro˚ssId
(), 
pFd
, 
iOff
, 
p
));

34687 if–
p
 ){

34688 
pFd
->
nFëchOut
--;

34694 
	`wöUnm≠fûe
(
pFd
);

34697 
	`as£π
–
pFd
->
nFëchOut
>=0 );

34700 
	`OSTRACE
(("UNFETCHÖid=%lu,ÖFile=%p,Ñc=SQLITE_OK\n",

34701 
	`osGëCuºítPro˚ssId
(), 
fd
));

34702  
SQLITE_OK
;

34715 c⁄° 
sqlôe3_io_mëhods
 
wöIoMëhod
 = {

34717 
wöClo£
,

34718 
wöRód
,

34719 
wöWrôe
,

34720 
wöTrunˇã
,

34721 
wöSync
,

34722 
wöFûeSize
,

34723 
wöLock
,

34724 
wöU∆ock
,

34725 
wöCheckRe£rvedLock
,

34726 
wöFûeC⁄åﬁ
,

34727 
wöSe˘‹Size
,

34728 
wöDevi˚Ch¨a˘îi°ics
,

34729 
wöShmM≠
,

34730 
wöShmLock
,

34731 
wöShmB¨rõr
,

34732 
wöShmUnm≠
,

34733 
wöFëch
,

34734 
wöUn„tch


34750 *
	`wöC⁄vîtToUtf8Fûíame
(c⁄° *
zFûíame
){

34751 *
zC⁄vîãd
 = 0;

34752 if–
	`osIsNT
() ){

34753 
zC⁄vîãd
 = 
	`wöUnicodeToUtf8
(
zFûíame
);

34755 #ifde‡
SQLITE_WIN32_HAS_ANSI


34757 
zC⁄vîãd
 = 
	`sqlôe3_wö32_mbcs_to_utf8
(
zFûíame
);

34761  
zC⁄vîãd
;

34771 *
	`wöC⁄vîtFromUtf8Fûíame
(c⁄° *
zFûíame
){

34772 *
zC⁄vîãd
 = 0;

34773 if–
	`osIsNT
() ){

34774 
zC⁄vîãd
 = 
	`wöUtf8ToUnicode
(
zFûíame
);

34776 #ifde‡
SQLITE_WIN32_HAS_ANSI


34778 
zC⁄vîãd
 = 
	`sqlôe3_wö32_utf8_to_mbcs
(
zFûíame
);

34782  
zC⁄vîãd
;

34789 
	`wöEndsInDúSï
(*
zBuf
){

34790 if–
zBuf
 ){

34791 
nLí
 = 
	`sqlôe3SåÀn30
(
zBuf
);

34792  
nLí
>0 && 
	`wöIsDúSï
(
zBuf
[nLen-1]);

34801 
	`wöGëTem≤ame
(
sqlôe3_vfs
 *
pVfs
, **
pzBuf
){

34802 
zCh¨s
[] =

34806 
size_t
 
i
, 
j
;

34807 
nBuf
, 
nLí
;

34808 *
zBuf
;

34814 
	`SimuœãIOEº‹
– 
SQLITE_IOERR
 );

34819 
nBuf
 = 
pVfs
->
mxP©h«me
;

34820 
zBuf
 = 
	`sqlôe3MÆlocZîo
–
nBuf
+2 );

34821 if–!
zBuf
 ){

34822 
	`OSTRACE
(("TEMP-FILENAMEÑc=SQLITE_IOERR_NOMEM\n"));

34823  
SQLITE_IOERR_NOMEM
;

34830 
	`as£π
–
nBuf
>30 );

34831 if–
sqlôe3_ãmp_dúe˘‹y
 ){

34832 
	`sqlôe3_¢¥ötf
(
nBuf
-30, 
zBuf
, "%s%s", 
sqlôe3_ãmp_dúe˘‹y
,

34833 
	`wöEndsInDúSï
(
sqlôe3_ãmp_dúe˘‹y
) ? "" :

34834 
	`wöGëDúDï
());

34836 #i‡
	`deföed
(
__CYGWIN__
)

34838 c⁄° *
azDús
[] = {

34850 
i
;

34851 c⁄° *
zDú
 = 0;

34853 if–!
azDús
[0] )ázDús[0] = 
	`gëív
("SQLITE_TMPDIR");

34854 if–!
azDús
[1] )ázDús[1] = 
	`gëív
("TMPDIR");

34855 if–!
azDús
[2] )ázDús[2] = 
	`gëív
("TMP");

34856 if–!
azDús
[3] )ázDús[3] = 
	`gëív
("TEMP");

34857 if–!
azDús
[4] )ázDús[4] = 
	`gëív
("USERPROFILE");

34858 
i
=0; i<(
azDús
)/◊zDús[0]); 
zDú
=azDirs[i++]){

34859 *
zC⁄vîãd
;

34860 if–
zDú
==0 ) ;

34866 if–
	`wöIsDriveLëãrAndCﬁ⁄
(
zDú
) ){

34867 
zC⁄vîãd
 = 
	`wöC⁄vîtFromUtf8Fûíame
(
zDú
);

34868 if–!
zC⁄vîãd
 ){

34869 
	`sqlôe3_‰ì
(
zBuf
);

34870 
	`OSTRACE
(("TEMP-FILENAMEÑc=SQLITE_IOERR_NOMEM\n"));

34871  
SQLITE_IOERR_NOMEM
;

34873 if–
	`wöIsDú
(
zC⁄vîãd
) ){

34874 
	`sqlôe3_¢¥ötf
(
nBuf
-30, 
zBuf
, "%s", 
zDú
);

34875 
	`sqlôe3_‰ì
(
zC⁄vîãd
);

34878 
	`sqlôe3_‰ì
(
zC⁄vîãd
);

34880 
zC⁄vîãd
 = 
	`sqlôe3MÆlocZîo
–
nBuf
+1 );

34881 if–!
zC⁄vîãd
 ){

34882 
	`sqlôe3_‰ì
(
zBuf
);

34883 
	`OSTRACE
(("TEMP-FILENAMEÑc=SQLITE_IOERR_NOMEM\n"));

34884  
SQLITE_IOERR_NOMEM
;

34886 if–
	`cygwö_c⁄v_∑th
(

34887 
	`osIsNT
(Ë? 
CCP_POSIX_TO_WIN_W
 : 
CCP_POSIX_TO_WIN_A
, 
zDú
,

34888 
zC⁄vîãd
, 
nBuf
+1)<0 ){

34889 
	`sqlôe3_‰ì
(
zC⁄vîãd
);

34890 
	`sqlôe3_‰ì
(
zBuf
);

34891 
	`OSTRACE
(("TEMP-FILENAMEÑc=SQLITE_IOERR_CONVPATH\n"));

34892  
	`wöLogEº‹
(
SQLITE_IOERR_CONVPATH
, (
DWORD
)
î∫o
,

34893 "wöGëTem≤ame1", 
zDú
);

34895 if–
	`wöIsDú
(
zC⁄vîãd
) ){

34900 if–
	`osIsNT
() ){

34901 *
zUtf8
 = 
	`wöUnicodeToUtf8
(
zC⁄vîãd
);

34902 if–!
zUtf8
 ){

34903 
	`sqlôe3_‰ì
(
zC⁄vîãd
);

34904 
	`sqlôe3_‰ì
(
zBuf
);

34905 
	`OSTRACE
(("TEMP-FILENAMEÑc=SQLITE_IOERR_NOMEM\n"));

34906  
SQLITE_IOERR_NOMEM
;

34908 
	`sqlôe3_¢¥ötf
(
nBuf
-30, 
zBuf
, "%s", 
zUtf8
);

34909 
	`sqlôe3_‰ì
(
zUtf8
);

34910 
	`sqlôe3_‰ì
(
zC⁄vîãd
);

34913 
	`sqlôe3_¢¥ötf
(
nBuf
-30, 
zBuf
, "%s", 
zC⁄vîãd
);

34914 
	`sqlôe3_‰ì
(
zC⁄vîãd
);

34918 
	`sqlôe3_‰ì
(
zC⁄vîãd
);

34922 #ñi‡!
SQLITE_OS_WINRT
 && !
	`deföed
(
__CYGWIN__
)

34923 if–
	`osIsNT
() ){

34924 *
zMu…i
;

34925 
LPWSTR
 
zWideP©h
 = 
	`sqlôe3MÆlocZîo
–
nBuf
*(
WCHAR
) );

34926 if–!
zWideP©h
 ){

34927 
	`sqlôe3_‰ì
(
zBuf
);

34928 
	`OSTRACE
(("TEMP-FILENAMEÑc=SQLITE_IOERR_NOMEM\n"));

34929  
SQLITE_IOERR_NOMEM
;

34931 if–
	`osGëTempP©hW
(
nBuf
, 
zWideP©h
)==0 ){

34932 
	`sqlôe3_‰ì
(
zWideP©h
);

34933 
	`sqlôe3_‰ì
(
zBuf
);

34934 
	`OSTRACE
(("TEMP-FILENAMEÑc=SQLITE_IOERR_GETTEMPPATH\n"));

34935  
	`wöLogEº‹
(
SQLITE_IOERR_GETTEMPPATH
, 
	`osGëLa°Eº‹
(),

34938 
zMu…i
 = 
	`wöUnicodeToUtf8
(
zWideP©h
);

34939 if–
zMu…i
 ){

34940 
	`sqlôe3_¢¥ötf
(
nBuf
-30, 
zBuf
, "%s", 
zMu…i
);

34941 
	`sqlôe3_‰ì
(
zMu…i
);

34942 
	`sqlôe3_‰ì
(
zWideP©h
);

34944 
	`sqlôe3_‰ì
(
zWideP©h
);

34945 
	`sqlôe3_‰ì
(
zBuf
);

34946 
	`OSTRACE
(("TEMP-FILENAMEÑc=SQLITE_IOERR_NOMEM\n"));

34947  
SQLITE_IOERR_NOMEM
;

34950 #ifde‡
SQLITE_WIN32_HAS_ANSI


34952 *
zUtf8
;

34953 *
zMbcsP©h
 = 
	`sqlôe3MÆlocZîo
–
nBuf
 );

34954 if–!
zMbcsP©h
 ){

34955 
	`sqlôe3_‰ì
(
zBuf
);

34956 
	`OSTRACE
(("TEMP-FILENAMEÑc=SQLITE_IOERR_NOMEM\n"));

34957  
SQLITE_IOERR_NOMEM
;

34959 if–
	`osGëTempP©hA
(
nBuf
, 
zMbcsP©h
)==0 ){

34960 
	`sqlôe3_‰ì
(
zBuf
);

34961 
	`OSTRACE
(("TEMP-FILENAMEÑc=SQLITE_IOERR_GETTEMPPATH\n"));

34962  
	`wöLogEº‹
(
SQLITE_IOERR_GETTEMPPATH
, 
	`osGëLa°Eº‹
(),

34965 
zUtf8
 = 
	`sqlôe3_wö32_mbcs_to_utf8
(
zMbcsP©h
);

34966 if–
zUtf8
 ){

34967 
	`sqlôe3_¢¥ötf
(
nBuf
-30, 
zBuf
, "%s", 
zUtf8
);

34968 
	`sqlôe3_‰ì
(
zUtf8
);

34970 
	`sqlôe3_‰ì
(
zBuf
);

34971 
	`OSTRACE
(("TEMP-FILENAMEÑc=SQLITE_IOERR_NOMEM\n"));

34972  
SQLITE_IOERR_NOMEM
;

34981 
nLí
 = 
	`sqlôe3SåÀn30
(
zBuf
);

34983 if–(
nLí
 + 
	`sqlôe3SåÀn30
(
SQLITE_TEMP_FILE_PREFIX
Ë+ 18Ë>
nBuf
 ){

34984 
	`sqlôe3_‰ì
(
zBuf
);

34985 
	`OSTRACE
(("TEMP-FILENAMEÑc=SQLITE_ERROR\n"));

34986  
	`wöLogEº‹
(
SQLITE_ERROR
, 0, "winGetTempname3", 0);

34989 
	`sqlôe3_¢¥ötf
(
nBuf
-18-
nLí
, 
zBuf
+nLí, 
SQLITE_TEMP_FILE_PREFIX
);

34991 
j
 = 
	`sqlôe3SåÀn30
(
zBuf
);

34992 
	`sqlôe3_øndom√ss
(15, &
zBuf
[
j
]);

34993 
i
=0; i<15; i++, 
j
++){

34994 
zBuf
[
j
] = ()
zCh¨s
[ (()zBuf[j])%((zChars)-1) ];

34996 
zBuf
[
j
] = 0;

34997 
zBuf
[
j
+1] = 0;

34998 *
pzBuf
 = 
zBuf
;

35000 
	`OSTRACE
(("TEMP-FILENAMEÇame=%s,Ñc=SQLITE_OK\n", 
zBuf
));

35001  
SQLITE_OK
;

35009 
	`wöIsDú
(c⁄° *
zC⁄vîãd
){

35010 
DWORD
 
©å
;

35011 
rc
 = 0;

35012 
DWORD
 
œ°Eºno
;

35014 if–
	`osIsNT
() ){

35015 
˙t
 = 0;

35016 
WIN32_FILE_ATTRIBUTE_DATA
 
sAârD©a
;

35017 
	`mem£t
(&
sAârD©a
, 0, (sAttrData));

35018  !(
rc
 = 
	`osGëFûeAâribuãsExW
((
LPCWSTR
)
zC⁄vîãd
,

35019 
GëFûeExInfoSènd¨d
,

35020 &
sAârD©a
)Ë&& 
	`wöRëryI€º
(&
˙t
, &
œ°Eºno
) ){}

35021 if–!
rc
 ){

35024 
©å
 = 
sAârD©a
.
dwFûeAâribuãs
;

35025 #i‡
SQLITE_OS_WINCE
==0

35027 
©å
 = 
	`osGëFûeAâribuãsA
((*)
zC⁄vîãd
);

35030  (
©å
!=
INVALID_FILE_ATTRIBUTES
Ë&& (©å&
FILE_ATTRIBUTE_DIRECTORY
);

35036 
	`wöO≥n
(

35037 
sqlôe3_vfs
 *
pVfs
,

35038 c⁄° *
zName
,

35039 
sqlôe3_fûe
 *
id
,

35040 
Êags
,

35041 *
pOutFœgs


35043 
HANDLE
 
h
;

35044 
DWORD
 
œ°Eºno
;

35045 
DWORD
 
dwDesúedAc˚ss
;

35046 
DWORD
 
dwSh¨eMode
;

35047 
DWORD
 
dwCª©i⁄Di•osôi⁄
;

35048 
DWORD
 
dwFœgsAndAâribuãs
 = 0;

35049 #i‡
SQLITE_OS_WINCE


35050 
isTemp
 = 0;

35052 
wöFûe
 *
pFûe
 = (wöFûe*)
id
;

35053 *
zC⁄vîãd
;

35054 c⁄° *
zUtf8Name
 = 
zName
;

35055 
˙t
 = 0;

35060 *
zTm≤ame
 = 0;

35062 
rc
 = 
SQLITE_OK
;

35063 #i‡!
	`deföed
(
NDEBUG
Ë|| 
SQLITE_OS_WINCE


35064 
eTy≥
 = 
Êags
&0xFFFFFF00;

35067 
isEx˛usive
 = (
Êags
 & 
SQLITE_OPEN_EXCLUSIVE
);

35068 
isDñëe
 = (
Êags
 & 
SQLITE_OPEN_DELETEONCLOSE
);

35069 
isCª©e
 = (
Êags
 & 
SQLITE_OPEN_CREATE
);

35070 
isRód⁄ly
 = (
Êags
 & 
SQLITE_OPEN_READONLY
);

35071 
isRódWrôe
 = (
Êags
 & 
SQLITE_OPEN_READWRITE
);

35073 #i‚de‡
NDEBUG


35074 
isO≥nJou∫Æ
 = (
isCª©e
 && (

35075 
eTy≥
==
SQLITE_OPEN_MASTER_JOURNAL


35076 || 
eTy≥
==
SQLITE_OPEN_MAIN_JOURNAL


35077 || 
eTy≥
==
SQLITE_OPEN_WAL


35081 
	`OSTRACE
(("OPENÇame=%s,ÖFile=%p, flags=%x,ÖOutFlags=%p\n",

35082 
zUtf8Name
, 
id
, 
Êags
, 
pOutFœgs
));

35091 
	`as£π
((
isRód⁄ly
==0 || 
isRódWrôe
==0) && (isReadWrite || isReadonly));

35092 
	`as£π
(
isCª©e
==0 || 
isRódWrôe
);

35093 
	`as£π
(
isEx˛usive
==0 || 
isCª©e
);

35094 
	`as£π
(
isDñëe
==0 || 
isCª©e
);

35098 
	`as£π
–(!
isDñëe
 && 
zName
Ë|| 
eTy≥
!=
SQLITE_OPEN_MAIN_DB
 );

35099 
	`as£π
–(!
isDñëe
 && 
zName
Ë|| 
eTy≥
!=
SQLITE_OPEN_MAIN_JOURNAL
 );

35100 
	`as£π
–(!
isDñëe
 && 
zName
Ë|| 
eTy≥
!=
SQLITE_OPEN_MASTER_JOURNAL
 );

35101 
	`as£π
–(!
isDñëe
 && 
zName
Ë|| 
eTy≥
!=
SQLITE_OPEN_WAL
 );

35104 
	`as£π
–
eTy≥
==
SQLITE_OPEN_MAIN_DB
 ||ÉTy≥==
SQLITE_OPEN_TEMP_DB


35105 || 
eTy≥
==
SQLITE_OPEN_MAIN_JOURNAL
 ||ÉTy≥==
SQLITE_OPEN_TEMP_JOURNAL


35106 || 
eTy≥
==
SQLITE_OPEN_SUBJOURNAL
 ||ÉTy≥==
SQLITE_OPEN_MASTER_JOURNAL


35107 || 
eTy≥
==
SQLITE_OPEN_TRANSIENT_DB
 ||ÉTy≥==
SQLITE_OPEN_WAL


35110 
	`as£π
–
pFûe
!=0 );

35111 
	`mem£t
(
pFûe
, 0, (
wöFûe
));

35112 
pFûe
->
h
 = 
INVALID_HANDLE_VALUE
;

35114 #i‡
SQLITE_OS_WINRT


35115 if–!
zUtf8Name
 && !
sqlôe3_ãmp_dúe˘‹y
 ){

35116 
	`sqlôe3_log
(
SQLITE_ERROR
,

35124 if–!
zUtf8Name
 ){

35125 
	`as£π
–
isDñëe
 && !
isO≥nJou∫Æ
 );

35126 
rc
 = 
	`wöGëTem≤ame
(
pVfs
, &
zTm≤ame
);

35127 if–
rc
!=
SQLITE_OK
 ){

35128 
	`OSTRACE
(("OPENÇame=%s,Ñc=%s", 
zUtf8Name
, 
	`sqlôe3EºName
(
rc
)));

35129  
rc
;

35131 
zUtf8Name
 = 
zTm≤ame
;

35138 
	`as£π
–(
eTy≥
!=
SQLITE_OPEN_MAIN_DB
Ë|| (
Êags
 & 
SQLITE_OPEN_URI
) ||

35139 
zUtf8Name
[
	`sqlôe3SåÀn30
(zUtf8Name)+1]==0 );

35142 
zC⁄vîãd
 = 
	`wöC⁄vîtFromUtf8Fûíame
(
zUtf8Name
);

35143 if–
zC⁄vîãd
==0 ){

35144 
	`sqlôe3_‰ì
(
zTm≤ame
);

35145 
	`OSTRACE
(("OPENÇame=%s,Ñc=SQLITE_IOERR_NOMEM", 
zUtf8Name
));

35146  
SQLITE_IOERR_NOMEM
;

35149 if–
	`wöIsDú
(
zC⁄vîãd
) ){

35150 
	`sqlôe3_‰ì
(
zC⁄vîãd
);

35151 
	`sqlôe3_‰ì
(
zTm≤ame
);

35152 
	`OSTRACE
(("OPENÇame=%s,Ñc=SQLITE_CANTOPEN_ISDIR", 
zUtf8Name
));

35153  
SQLITE_CANTOPEN_ISDIR
;

35156 if–
isRódWrôe
 ){

35157 
dwDesúedAc˚ss
 = 
GENERIC_READ
 | 
GENERIC_WRITE
;

35159 
dwDesúedAc˚ss
 = 
GENERIC_READ
;

35166 if–
isEx˛usive
 ){

35169 
dwCª©i⁄Di•osôi⁄
 = 
CREATE_NEW
;

35170 }if–
isCª©e
 ){

35172 
dwCª©i⁄Di•osôi⁄
 = 
OPEN_ALWAYS
;

35175 
dwCª©i⁄Di•osôi⁄
 = 
OPEN_EXISTING
;

35178 
dwSh¨eMode
 = 
FILE_SHARE_READ
 | 
FILE_SHARE_WRITE
;

35180 if–
isDñëe
 ){

35181 #i‡
SQLITE_OS_WINCE


35182 
dwFœgsAndAâribuãs
 = 
FILE_ATTRIBUTE_HIDDEN
;

35183 
isTemp
 = 1;

35185 
dwFœgsAndAâribuãs
 = 
FILE_ATTRIBUTE_TEMPORARY


35186 | 
FILE_ATTRIBUTE_HIDDEN


35187 | 
FILE_FLAG_DELETE_ON_CLOSE
;

35190 
dwFœgsAndAâribuãs
 = 
FILE_ATTRIBUTE_NORMAL
;

35194 #i‡
SQLITE_OS_WINCE


35195 
dwFœgsAndAâribuãs
 |
FILE_FLAG_RANDOM_ACCESS
;

35198 if–
	`osIsNT
() ){

35199 #i‡
SQLITE_OS_WINRT


35200 
CREATEFILE2_EXTENDED_PARAMETERS
 
exãndedP¨amëîs
;

35201 
exãndedP¨amëîs
.
dwSize
 = (
CREATEFILE2_EXTENDED_PARAMETERS
);

35202 
exãndedP¨amëîs
.
dwFûeAâribuãs
 =

35203 
dwFœgsAndAâribuãs
 & 
FILE_ATTRIBUTE_MASK
;

35204 
exãndedP¨amëîs
.
dwFûeFœgs
 = 
dwFœgsAndAâribuãs
 & 
FILE_FLAG_MASK
;

35205 
exãndedP¨amëîs
.
dwSecurôyQosFœgs
 = 
SECURITY_ANONYMOUS
;

35206 
exãndedP¨amëîs
.
ÕSecurôyAâribuãs
 = 
NULL
;

35207 
exãndedP¨amëîs
.
hTem∂©eFûe
 = 
NULL
;

35208  (
h
 = 
	`osCª©eFûe2
((
LPCWSTR
)
zC⁄vîãd
,

35209 
dwDesúedAc˚ss
,

35210 
dwSh¨eMode
,

35211 
dwCª©i⁄Di•osôi⁄
,

35212 &
exãndedP¨amëîs
))==
INVALID_HANDLE_VALUE
 &&

35213 
	`wöRëryI€º
(&
˙t
, &
œ°Eºno
) ){

35217  (
h
 = 
	`osCª©eFûeW
((
LPCWSTR
)
zC⁄vîãd
,

35218 
dwDesúedAc˚ss
,

35219 
dwSh¨eMode
, 
NULL
,

35220 
dwCª©i⁄Di•osôi⁄
,

35221 
dwFœgsAndAâribuãs
,

35222 
NULL
))==
INVALID_HANDLE_VALUE
 &&

35223 
	`wöRëryI€º
(&
˙t
, &
œ°Eºno
) ){

35228 #ifde‡
SQLITE_WIN32_HAS_ANSI


35230  (
h
 = 
	`osCª©eFûeA
((
LPCSTR
)
zC⁄vîãd
,

35231 
dwDesúedAc˚ss
,

35232 
dwSh¨eMode
, 
NULL
,

35233 
dwCª©i⁄Di•osôi⁄
,

35234 
dwFœgsAndAâribuãs
,

35235 
NULL
))==
INVALID_HANDLE_VALUE
 &&

35236 
	`wöRëryI€º
(&
˙t
, &
œ°Eºno
) ){

35241 
	`wöLogI€º
(
˙t
);

35243 
	`OSTRACE
(("OPEN fûe=%p,Çame=%s,ác˚ss=%lx,Ñc=%s\n", 
h
, 
zUtf8Name
,

35244 
dwDesúedAc˚ss
, (
h
==
INVALID_HANDLE_VALUE
) ? "failed" : "ok"));

35246 if–
h
==
INVALID_HANDLE_VALUE
 ){

35247 
pFûe
->
œ°Eºno
 =ÜastErrno;

35248 
	`wöLogEº‹
(
SQLITE_CANTOPEN
, 
pFûe
->
œ°Eºno
, "wöO≥n", 
zUtf8Name
);

35249 
	`sqlôe3_‰ì
(
zC⁄vîãd
);

35250 
	`sqlôe3_‰ì
(
zTm≤ame
);

35251 if–
isRódWrôe
 && !
isEx˛usive
 ){

35252  
	`wöO≥n
(
pVfs
, 
zName
, 
id
,

35253 ((
Êags
|
SQLITE_OPEN_READONLY
) &

35254 ~(
SQLITE_OPEN_CREATE
|
SQLITE_OPEN_READWRITE
)),

35255 
pOutFœgs
);

35257  
SQLITE_CANTOPEN_BKPT
;

35261 if–
pOutFœgs
 ){

35262 if–
isRódWrôe
 ){

35263 *
pOutFœgs
 = 
SQLITE_OPEN_READWRITE
;

35265 *
pOutFœgs
 = 
SQLITE_OPEN_READONLY
;

35269 
	`OSTRACE
(("OPEN file=%p,Çame=%s,áccess=%lx,ÖOutFlags=%p, *pOutFlags=%d, "

35270 "rc=%s\n", 
h
, 
zUtf8Name
, 
dwDesúedAc˚ss
, 
pOutFœgs
,ÖOutFlags ?

35271 *
pOutFœgs
 : 0, (
h
==
INVALID_HANDLE_VALUE
) ? "failed" : "ok"));

35273 #i‡
SQLITE_OS_WINCE


35274 if–
isRódWrôe
 && 
eTy≥
==
SQLITE_OPEN_MAIN_DB


35275 && (
rc
 = 
	`wö˚Cª©eLock
(
zName
, 
pFûe
))!=
SQLITE_OK


35277 
	`osClo£H™dÀ
(
h
);

35278 
	`sqlôe3_‰ì
(
zC⁄vîãd
);

35279 
	`sqlôe3_‰ì
(
zTm≤ame
);

35280 
	`OSTRACE
(("OPEN-CE-LOCKÇame=%s,Ñc=%s\n", 
zName
, 
	`sqlôe3EºName
(
rc
)));

35281  
rc
;

35283 if–
isTemp
 ){

35284 
pFûe
->
zDñëeOnClo£
 = 
zC⁄vîãd
;

35288 
	`sqlôe3_‰ì
(
zC⁄vîãd
);

35291 
	`sqlôe3_‰ì
(
zTm≤ame
);

35292 
pFûe
->
pMëhod
 = &
wöIoMëhod
;

35293 
pFûe
->
pVfs
 =ÖVfs;

35294 
pFûe
->
h
 = h;

35295 if–
isRód⁄ly
 ){

35296 
pFûe
->
˘æFœgs
 |
WINFILE_RDONLY
;

35298 if–
	`sqlôe3_uri_boﬁón
(
zName
, "psow", 
SQLITE_POWERSAFE_OVERWRITE
) ){

35299 
pFûe
->
˘æFœgs
 |
WINFILE_PSOW
;

35301 
pFûe
->
œ°Eºno
 = 
NO_ERROR
;

35302 
pFûe
->
zP©h
 = 
zName
;

35303 #i‡
SQLITE_MAX_MMAP_SIZE
>0

35304 
pFûe
->
hM≠
 = 
NULL
;

35305 
pFûe
->
pM≠Regi⁄
 = 0;

35306 
pFûe
->
mm≠Size
 = 0;

35307 
pFûe
->
mm≠SizeA˘uÆ
 = 0;

35308 
pFûe
->
mm≠SizeMax
 = 
sqlôe3GlobÆC⁄fig
.
szMm≠
;

35311 
	`O≥nCou¡î
(+1);

35312  
rc
;

35327 
	`wöDñëe
(

35328 
sqlôe3_vfs
 *
pVfs
,

35329 c⁄° *
zFûíame
,

35330 
syncDú


35332 
˙t
 = 0;

35333 
rc
;

35334 
DWORD
 
©å
;

35335 
DWORD
 
œ°Eºno
;

35336 *
zC⁄vîãd
;

35337 
	`UNUSED_PARAMETER
(
pVfs
);

35338 
	`UNUSED_PARAMETER
(
syncDú
);

35340 
	`SimuœãIOEº‹
( 
SQLITE_IOERR_DELETE
);

35341 
	`OSTRACE
(("DELETEÇame=%s, syncDú=%d\n", 
zFûíame
, 
syncDú
));

35343 
zC⁄vîãd
 = 
	`wöC⁄vîtFromUtf8Fûíame
(
zFûíame
);

35344 if–
zC⁄vîãd
==0 ){

35345 
	`OSTRACE
(("DELETEÇame=%s,Ñc=SQLITE_IOERR_NOMEM\n", 
zFûíame
));

35346  
SQLITE_IOERR_NOMEM
;

35348 if–
	`osIsNT
() ){

35350 #i‡
SQLITE_OS_WINRT


35351 
WIN32_FILE_ATTRIBUTE_DATA
 
sAârD©a
;

35352 
	`mem£t
(&
sAârD©a
, 0, (sAttrData));

35353 i‡–
	`osGëFûeAâribuãsExW
(
zC⁄vîãd
, 
GëFûeExInfoSènd¨d
,

35354 &
sAârD©a
) ){

35355 
©å
 = 
sAârD©a
.
dwFûeAâribuãs
;

35357 
œ°Eºno
 = 
	`osGëLa°Eº‹
();

35358 if–
œ°Eºno
==
ERROR_FILE_NOT_FOUND


35359 || 
œ°Eºno
==
ERROR_PATH_NOT_FOUND
 ){

35360 
rc
 = 
SQLITE_IOERR_DELETE_NOENT
;

35362 
rc
 = 
SQLITE_ERROR
;

35367 
©å
 = 
	`osGëFûeAâribuãsW
(
zC⁄vîãd
);

35369 i‡–
©å
==
INVALID_FILE_ATTRIBUTES
 ){

35370 
œ°Eºno
 = 
	`osGëLa°Eº‹
();

35371 if–
œ°Eºno
==
ERROR_FILE_NOT_FOUND


35372 || 
œ°Eºno
==
ERROR_PATH_NOT_FOUND
 ){

35373 
rc
 = 
SQLITE_IOERR_DELETE_NOENT
;

35375 
rc
 = 
SQLITE_ERROR
;

35379 i‡–
©å
&
FILE_ATTRIBUTE_DIRECTORY
 ){

35380 
rc
 = 
SQLITE_ERROR
;

35383 i‡–
	`osDñëeFûeW
(
zC⁄vîãd
) ){

35384 
rc
 = 
SQLITE_OK
;

35387 i‡–!
	`wöRëryI€º
(&
˙t
, &
œ°Eºno
) ){

35388 
rc
 = 
SQLITE_ERROR
;

35393 #ifde‡
SQLITE_WIN32_HAS_ANSI


35396 
©å
 = 
	`osGëFûeAâribuãsA
(
zC⁄vîãd
);

35397 i‡–
©å
==
INVALID_FILE_ATTRIBUTES
 ){

35398 
œ°Eºno
 = 
	`osGëLa°Eº‹
();

35399 if–
œ°Eºno
==
ERROR_FILE_NOT_FOUND


35400 || 
œ°Eºno
==
ERROR_PATH_NOT_FOUND
 ){

35401 
rc
 = 
SQLITE_IOERR_DELETE_NOENT
;

35403 
rc
 = 
SQLITE_ERROR
;

35407 i‡–
©å
&
FILE_ATTRIBUTE_DIRECTORY
 ){

35408 
rc
 = 
SQLITE_ERROR
;

35411 i‡–
	`osDñëeFûeA
(
zC⁄vîãd
) ){

35412 
rc
 = 
SQLITE_OK
;

35415 i‡–!
	`wöRëryI€º
(&
˙t
, &
œ°Eºno
) ){

35416 
rc
 = 
SQLITE_ERROR
;

35422 if–
rc
 &&Ñc!=
SQLITE_IOERR_DELETE_NOENT
 ){

35423 
rc
 = 
	`wöLogEº‹
(
SQLITE_IOERR_DELETE
, 
œ°Eºno
, "wöDñëe", 
zFûíame
);

35425 
	`wöLogI€º
(
˙t
);

35427 
	`sqlôe3_‰ì
(
zC⁄vîãd
);

35428 
	`OSTRACE
(("DELETEÇame=%s,Ñc=%s\n", 
zFûíame
, 
	`sqlôe3EºName
(
rc
)));

35429  
rc
;

35435 
	`wöAc˚ss
(

35436 
sqlôe3_vfs
 *
pVfs
,

35437 c⁄° *
zFûíame
,

35438 
Êags
,

35439 *
pResOut


35441 
DWORD
 
©å
;

35442 
rc
 = 0;

35443 
DWORD
 
œ°Eºno
;

35444 *
zC⁄vîãd
;

35445 
	`UNUSED_PARAMETER
(
pVfs
);

35447 
	`SimuœãIOEº‹
– 
SQLITE_IOERR_ACCESS
; );

35448 
	`OSTRACE
(("ACCESSÇame=%s, flags=%x,ÖResOut=%p\n",

35449 
zFûíame
, 
Êags
, 
pResOut
));

35451 
zC⁄vîãd
 = 
	`wöC⁄vîtFromUtf8Fûíame
(
zFûíame
);

35452 if–
zC⁄vîãd
==0 ){

35453 
	`OSTRACE
(("ACCESSÇame=%s,Ñc=SQLITE_IOERR_NOMEM\n", 
zFûíame
));

35454  
SQLITE_IOERR_NOMEM
;

35456 if–
	`osIsNT
() ){

35457 
˙t
 = 0;

35458 
WIN32_FILE_ATTRIBUTE_DATA
 
sAârD©a
;

35459 
	`mem£t
(&
sAârD©a
, 0, (sAttrData));

35460  !(
rc
 = 
	`osGëFûeAâribuãsExW
((
LPCWSTR
)
zC⁄vîãd
,

35461 
GëFûeExInfoSènd¨d
,

35462 &
sAârD©a
)Ë&& 
	`wöRëryI€º
(&
˙t
, &
œ°Eºno
) ){}

35463 if–
rc
 ){

35467 if–
Êags
==
SQLITE_ACCESS_EXISTS


35468 && 
sAârD©a
.
nFûeSizeHigh
==0

35469 && 
sAârD©a
.
nFûeSizeLow
==0 ){

35470 
©å
 = 
INVALID_FILE_ATTRIBUTES
;

35472 
©å
 = 
sAârD©a
.
dwFûeAâribuãs
;

35475 
	`wöLogI€º
(
˙t
);

35476 if–
œ°Eºno
!=
ERROR_FILE_NOT_FOUND
 &&Üa°Eºno!=
ERROR_PATH_NOT_FOUND
 ){

35477 
	`sqlôe3_‰ì
(
zC⁄vîãd
);

35478  
	`wöLogEº‹
(
SQLITE_IOERR_ACCESS
, 
œ°Eºno
, "winAccess",

35479 
zFûíame
);

35481 
©å
 = 
INVALID_FILE_ATTRIBUTES
;

35485 #ifde‡
SQLITE_WIN32_HAS_ANSI


35487 
©å
 = 
	`osGëFûeAâribuãsA
((*)
zC⁄vîãd
);

35490 
	`sqlôe3_‰ì
(
zC⁄vîãd
);

35491  
Êags
 ){

35492 
SQLITE_ACCESS_READ
:

35493 
SQLITE_ACCESS_EXISTS
:

35494 
rc
 = 
©å
!=
INVALID_FILE_ATTRIBUTES
;

35496 
SQLITE_ACCESS_READWRITE
:

35497 
rc
 = 
©å
!=
INVALID_FILE_ATTRIBUTES
 &&

35498 (
©å
 & 
FILE_ATTRIBUTE_READONLY
)==0;

35501 
	`as£π
(!"Invalid flagsárgument");

35503 *
pResOut
 = 
rc
;

35504 
	`OSTRACE
(("ACCESSÇame=%s,ÖResOut=%p, *pResOut=%d,Ñc=SQLITE_OK\n",

35505 
zFûíame
, 
pResOut
, *pResOut));

35506  
SQLITE_OK
;

35513 
BOOL
 
	`wöIsDriveLëãrAndCﬁ⁄
(

35514 c⁄° *
zP©h«me


35516  ( 
	`sqlôe3IßÕha
(
zP©h«me
[0]) && zPathname[1]==':' );

35525 
BOOL
 
	`wöIsVîb©imP©h«me
(

35526 c⁄° *
zP©h«me


35535 i‡–
	`wöIsDúSï
(
zP©h«me
[0]) ){

35536  
TRUE
;

35545 i‡–
	`wöIsDriveLëãrAndCﬁ⁄
(
zP©h«me
) ){

35546  
TRUE
;

35553  
FALSE
;

35561 
	`wöFuŒP©h«me
(

35562 
sqlôe3_vfs
 *
pVfs
,

35563 c⁄° *
zRñ©ive
,

35564 
nFuŒ
,

35565 *
zFuŒ


35568 #i‡
	`deföed
(
__CYGWIN__
)

35569 
	`SimuœãIOEº‹
– 
SQLITE_ERROR
 );

35570 
	`UNUSED_PARAMETER
(
nFuŒ
);

35571 
	`as£π
–
nFuŒ
>=
pVfs
->
mxP©h«me
 );

35572 i‡–
sqlôe3_d©a_dúe˘‹y
 && !
	`wöIsVîb©imP©h«me
(
zRñ©ive
) ){

35579 *
zOut
 = 
	`sqlôe3MÆlocZîo
–
pVfs
->
mxP©h«me
+1 );

35580 if–!
zOut
 ){

35581  
SQLITE_IOERR_NOMEM
;

35583 if–
	`cygwö_c⁄v_∑th
(
CCP_POSIX_TO_WIN_A
|
CCP_RELATIVE
, 
zRñ©ive
, 
zOut
,

35584 
pVfs
->
mxP©h«me
+1)<0 ){

35585 
	`sqlôe3_‰ì
(
zOut
);

35586  
	`wöLogEº‹
(
SQLITE_CANTOPEN_CONVPATH
, (
DWORD
)
î∫o
,

35587 "wöFuŒP©h«me1", 
zRñ©ive
);

35589 
	`sqlôe3_¢¥ötf
(
	`MIN
(
nFuŒ
, 
pVfs
->
mxP©h«me
), 
zFuŒ
, "%s%s%s",

35590 
sqlôe3_d©a_dúe˘‹y
, 
	`wöGëDúDï
(), 
zOut
);

35591 
	`sqlôe3_‰ì
(
zOut
);

35593 if–
	`cygwö_c⁄v_∑th
(
CCP_POSIX_TO_WIN_A
, 
zRñ©ive
, 
zFuŒ
, 
nFuŒ
)<0 ){

35594  
	`wöLogEº‹
(
SQLITE_CANTOPEN_CONVPATH
, (
DWORD
)
î∫o
,

35595 "wöFuŒP©h«me2", 
zRñ©ive
);

35598  
SQLITE_OK
;

35601 #i‡(
SQLITE_OS_WINCE
 || 
SQLITE_OS_WINRT
Ë&& !
	`deföed
(
__CYGWIN__
)

35602 
	`SimuœãIOEº‹
– 
SQLITE_ERROR
 );

35605 i‡–
sqlôe3_d©a_dúe˘‹y
 && !
	`wöIsVîb©imP©h«me
(
zRñ©ive
) ){

35612 
	`sqlôe3_¢¥ötf
(
	`MIN
(
nFuŒ
, 
pVfs
->
mxP©h«me
), 
zFuŒ
, "%s%s%s",

35613 
sqlôe3_d©a_dúe˘‹y
, 
	`wöGëDúDï
(), 
zRñ©ive
);

35615 
	`sqlôe3_¢¥ötf
(
	`MIN
(
nFuŒ
, 
pVfs
->
mxP©h«me
), 
zFuŒ
, "%s", 
zRñ©ive
);

35617  
SQLITE_OK
;

35620 #i‡!
SQLITE_OS_WINCE
 && !
SQLITE_OS_WINRT
 && !
	`deföed
(
__CYGWIN__
)

35621 
DWORD
 
nByã
;

35622 *
zC⁄vîãd
;

35623 *
zOut
;

35628 if–
zRñ©ive
[0]=='/' && 
	`wöIsDriveLëãrAndCﬁ⁄
(zRelative+1) ){

35629 
zRñ©ive
++;

35637 
	`SimuœãIOEº‹
– 
SQLITE_ERROR
 );

35638 i‡–
sqlôe3_d©a_dúe˘‹y
 && !
	`wöIsVîb©imP©h«me
(
zRñ©ive
) ){

35645 
	`sqlôe3_¢¥ötf
(
	`MIN
(
nFuŒ
, 
pVfs
->
mxP©h«me
), 
zFuŒ
, "%s%s%s",

35646 
sqlôe3_d©a_dúe˘‹y
, 
	`wöGëDúDï
(), 
zRñ©ive
);

35647  
SQLITE_OK
;

35649 
zC⁄vîãd
 = 
	`wöC⁄vîtFromUtf8Fûíame
(
zRñ©ive
);

35650 if–
zC⁄vîãd
==0 ){

35651  
SQLITE_IOERR_NOMEM
;

35653 if–
	`osIsNT
() ){

35654 
LPWSTR
 
zTemp
;

35655 
nByã
 = 
	`osGëFuŒP©hNameW
((
LPCWSTR
)
zC⁄vîãd
, 0, 0, 0);

35656 if–
nByã
==0 ){

35657 
	`sqlôe3_‰ì
(
zC⁄vîãd
);

35658  
	`wöLogEº‹
(
SQLITE_CANTOPEN_FULLPATH
, 
	`osGëLa°Eº‹
(),

35659 "wöFuŒP©h«me1", 
zRñ©ive
);

35661 
nByã
 += 3;

35662 
zTemp
 = 
	`sqlôe3MÆlocZîo
–
nByã
*(zTemp[0]) );

35663 if–
zTemp
==0 ){

35664 
	`sqlôe3_‰ì
(
zC⁄vîãd
);

35665  
SQLITE_IOERR_NOMEM
;

35667 
nByã
 = 
	`osGëFuŒP©hNameW
((
LPCWSTR
)
zC⁄vîãd
,ÇByã, 
zTemp
, 0);

35668 if–
nByã
==0 ){

35669 
	`sqlôe3_‰ì
(
zC⁄vîãd
);

35670 
	`sqlôe3_‰ì
(
zTemp
);

35671  
	`wöLogEº‹
(
SQLITE_CANTOPEN_FULLPATH
, 
	`osGëLa°Eº‹
(),

35672 "wöFuŒP©h«me2", 
zRñ©ive
);

35674 
	`sqlôe3_‰ì
(
zC⁄vîãd
);

35675 
zOut
 = 
	`wöUnicodeToUtf8
(
zTemp
);

35676 
	`sqlôe3_‰ì
(
zTemp
);

35678 #ifde‡
SQLITE_WIN32_HAS_ANSI


35680 *
zTemp
;

35681 
nByã
 = 
	`osGëFuŒP©hNameA
((*)
zC⁄vîãd
, 0, 0, 0);

35682 if–
nByã
==0 ){

35683 
	`sqlôe3_‰ì
(
zC⁄vîãd
);

35684  
	`wöLogEº‹
(
SQLITE_CANTOPEN_FULLPATH
, 
	`osGëLa°Eº‹
(),

35685 "wöFuŒP©h«me3", 
zRñ©ive
);

35687 
nByã
 += 3;

35688 
zTemp
 = 
	`sqlôe3MÆlocZîo
–
nByã
*(zTemp[0]) );

35689 if–
zTemp
==0 ){

35690 
	`sqlôe3_‰ì
(
zC⁄vîãd
);

35691  
SQLITE_IOERR_NOMEM
;

35693 
nByã
 = 
	`osGëFuŒP©hNameA
((*)
zC⁄vîãd
,ÇByã, 
zTemp
, 0);

35694 if–
nByã
==0 ){

35695 
	`sqlôe3_‰ì
(
zC⁄vîãd
);

35696 
	`sqlôe3_‰ì
(
zTemp
);

35697  
	`wöLogEº‹
(
SQLITE_CANTOPEN_FULLPATH
, 
	`osGëLa°Eº‹
(),

35698 "wöFuŒP©h«me4", 
zRñ©ive
);

35700 
	`sqlôe3_‰ì
(
zC⁄vîãd
);

35701 
zOut
 = 
	`sqlôe3_wö32_mbcs_to_utf8
(
zTemp
);

35702 
	`sqlôe3_‰ì
(
zTemp
);

35705 if–
zOut
 ){

35706 
	`sqlôe3_¢¥ötf
(
	`MIN
(
nFuŒ
, 
pVfs
->
mxP©h«me
), 
zFuŒ
, "%s", 
zOut
);

35707 
	`sqlôe3_‰ì
(
zOut
);

35708  
SQLITE_OK
;

35710  
SQLITE_IOERR_NOMEM
;

35715 #i‚de‡
SQLITE_OMIT_LOAD_EXTENSION


35724 *
	`wöDlO≥n
(
sqlôe3_vfs
 *
pVfs
, c⁄° *
zFûíame
){

35725 
HANDLE
 
h
;

35726 *
zC⁄vîãd
 = 
	`wöC⁄vîtFromUtf8Fûíame
(
zFûíame
);

35727 
	`UNUSED_PARAMETER
(
pVfs
);

35728 if–
zC⁄vîãd
==0 ){

35731 if–
	`osIsNT
() ){

35732 #i‡
SQLITE_OS_WINRT


35733 
h
 = 
	`osLﬂdPackagedLibøry
((
LPCWSTR
)
zC⁄vîãd
, 0);

35735 
h
 = 
	`osLﬂdLibøryW
((
LPCWSTR
)
zC⁄vîãd
);

35738 #ifde‡
SQLITE_WIN32_HAS_ANSI


35740 
h
 = 
	`osLﬂdLibøryA
((*)
zC⁄vîãd
);

35743 
	`sqlôe3_‰ì
(
zC⁄vîãd
);

35744  (*)
h
;

35746 
	`wöDlEº‹
(
sqlôe3_vfs
 *
pVfs
, 
nBuf
, *
zBufOut
){

35747 
	`UNUSED_PARAMETER
(
pVfs
);

35748 
	`wöGëLa°Eº‹Msg
(
	`osGëLa°Eº‹
(), 
nBuf
, 
zBufOut
);

35750 (*
	`wöDlSym
(
sqlôe3_vfs
 *
pVfs
,*
pH
,c⁄° *
zSym
))(){

35751 
	`UNUSED_PARAMETER
(
pVfs
);

35752  ((*)())
	`osGëProcAddªssA
((
HANDLE
)
pH
, 
zSym
);

35754 
	`wöDlClo£
(
sqlôe3_vfs
 *
pVfs
, *
pH™dÀ
){

35755 
	`UNUSED_PARAMETER
(
pVfs
);

35756 
	`osFªeLibøry
((
HANDLE
)
pH™dÀ
);

35759 
	#wöDlO≥n
 0

	)

35760 
	#wöDlEº‹
 0

	)

35761 
	#wöDlSym
 0

	)

35762 
	#wöDlClo£
 0

	)

35769 
	`wöR™dom√ss
(
sqlôe3_vfs
 *
pVfs
, 
nBuf
, *
zBuf
){

35770 
n
 = 0;

35771 
	`UNUSED_PARAMETER
(
pVfs
);

35772 #i‡
	`deföed
(
SQLITE_TEST
)

35773 
n
 = 
nBuf
;

35774 
	`mem£t
(
zBuf
, 0, 
nBuf
);

35776 if–(
SYSTEMTIME
)<=
nBuf
-
n
 ){

35777 
SYSTEMTIME
 
x
;

35778 
	`osGëSy°emTime
(&
x
);

35779 
	`mem˝y
(&
zBuf
[
n
], &
x
, (x));

35780 
n
 +(
x
);

35782 if–(
DWORD
)<=
nBuf
-
n
 ){

35783 
DWORD
 
pid
 = 
	`osGëCuºítPro˚ssId
();

35784 
	`mem˝y
(&
zBuf
[
n
], &
pid
, (pid));

35785 
n
 +(
pid
);

35787 #i‡
SQLITE_OS_WINRT


35788 if–(
ULONGLONG
)<=
nBuf
-
n
 ){

35789 
ULONGLONG
 
˙t
 = 
	`osGëTickCou¡64
();

35790 
	`mem˝y
(&
zBuf
[
n
], &
˙t
, (cnt));

35791 
n
 +(
˙t
);

35794 if–(
DWORD
)<=
nBuf
-
n
 ){

35795 
DWORD
 
˙t
 = 
	`osGëTickCou¡
();

35796 
	`mem˝y
(&
zBuf
[
n
], &
˙t
, (cnt));

35797 
n
 +(
˙t
);

35800 if–(
LARGE_INTEGER
)<=
nBuf
-
n
 ){

35801 
LARGE_INTEGER
 
i
;

35802 
	`osQuîyPîf‹m™˚Cou¡î
(&
i
);

35803 
	`mem˝y
(&
zBuf
[
n
], &
i
, (i));

35804 
n
 +(
i
);

35807  
n
;

35814 
	`wöSÀï
(
sqlôe3_vfs
 *
pVfs
, 
mi¸o£c
){

35815 
	`sqlôe3_wö32_¶ìp
((
mi¸o£c
+999)/1000);

35816 
	`UNUSED_PARAMETER
(
pVfs
);

35817  ((
mi¸o£c
+999)/1000)*1000;

35825 #ifde‡
SQLITE_TEST


35826 
SQLITE_API
 
sqlôe3_cuºít_time
 = 0;

35839 
	`wöCuºítTimeI¡64
(
sqlôe3_vfs
 *
pVfs
, 
sqlôe3_öt64
 *
piNow
){

35843 
FILETIME
 
·
;

35844 c⁄° 
sqlôe3_öt64
 
wöFûëimeEpoch
 = 23058135*(sqlite3_int64)8640000;

35845 #ifde‡
SQLITE_TEST


35846 c⁄° 
sqlôe3_öt64
 
unixEpoch
 = 24405875*(sqlite3_int64)8640000;

35849 c⁄° 
sqlôe3_öt64
 
max32BôVÆue
 =

35850 (
sqlôe3_öt64
)2000000000 + (sqlite3_int64)2000000000 +

35851 (
sqlôe3_öt64
)294967296;

35853 #i‡
SQLITE_OS_WINCE


35854 
SYSTEMTIME
 
time
;

35855 
	`osGëSy°emTime
(&
time
);

35857 i‡(!
	`osSy°emTimeToFûeTime
(&
time
,&
·
)){

35858  
SQLITE_ERROR
;

35861 
	`osGëSy°emTimeAsFûeTime
–&
·
 );

35864 *
piNow
 = 
wöFûëimeEpoch
 +

35865 ((((
sqlôe3_öt64
)
·
.
dwHighD©eTime
)*
max32BôVÆue
) +

35866 (
sqlôe3_öt64
)
·
.
dwLowD©eTime
)/(sqlite3_int64)10000;

35868 #ifde‡
SQLITE_TEST


35869 if–
sqlôe3_cuºít_time
 ){

35870 *
piNow
 = 1000*(
sqlôe3_öt64
)
sqlôe3_cuºít_time
 + 
unixEpoch
;

35873 
	`UNUSED_PARAMETER
(
pVfs
);

35874  
SQLITE_OK
;

35882 
	`wöCuºítTime
(
sqlôe3_vfs
 *
pVfs
, *
¥Now
){

35883 
rc
;

35884 
sqlôe3_öt64
 
i
;

35885 
rc
 = 
	`wöCuºítTimeI¡64
(
pVfs
, &
i
);

35886 if–!
rc
 ){

35887 *
¥Now
 = 
i
/86400000.0;

35889  
rc
;

35922 
	`wöGëLa°Eº‹
(
sqlôe3_vfs
 *
pVfs
, 
nBuf
, *
zBuf
){

35923 
	`UNUSED_PARAMETER
(
pVfs
);

35924  
	`wöGëLa°Eº‹Msg
(
	`osGëLa°Eº‹
(), 
nBuf
, 
zBuf
);

35930 
SQLITE_API
 
	`sqlôe3_os_öô
(){

35931 
sqlôe3_vfs
 
wöVfs
 = {

35933 (
wöFûe
),

35934 
SQLITE_WIN32_MAX_PATH_BYTES
,

35938 
wöO≥n
,

35939 
wöDñëe
,

35940 
wöAc˚ss
,

35941 
wöFuŒP©h«me
,

35942 
wöDlO≥n
,

35943 
wöDlEº‹
,

35944 
wöDlSym
,

35945 
wöDlClo£
,

35946 
wöR™dom√ss
,

35947 
wöSÀï
,

35948 
wöCuºítTime
,

35949 
wöGëLa°Eº‹
,

35950 
wöCuºítTimeI¡64
,

35951 
wöSëSy°emCÆl
,

35952 
wöGëSy°emCÆl
,

35953 
wöNextSy°emCÆl
,

35955 #i‡
	`deföed
(
SQLITE_WIN32_HAS_WIDE
)

35956 
sqlôe3_vfs
 
wöL⁄gP©hVfs
 = {

35958 (
wöFûe
),

35959 
SQLITE_WINNT_MAX_PATH_BYTES
,

35963 
wöO≥n
,

35964 
wöDñëe
,

35965 
wöAc˚ss
,

35966 
wöFuŒP©h«me
,

35967 
wöDlO≥n
,

35968 
wöDlEº‹
,

35969 
wöDlSym
,

35970 
wöDlClo£
,

35971 
wöR™dom√ss
,

35972 
wöSÀï
,

35973 
wöCuºítTime
,

35974 
wöGëLa°Eº‹
,

35975 
wöCuºítTimeI¡64
,

35976 
wöSëSy°emCÆl
,

35977 
wöGëSy°emCÆl
,

35978 
wöNextSy°emCÆl
,

35984 
	`as£π
–
	`AºaySize
(
aSysˇŒ
)==75 );

35987 
	`mem£t
(&
wöSysInfo
, 0, (
SYSTEM_INFO
));

35988 #i‡
SQLITE_OS_WINRT


35989 
	`osGëN©iveSy°emInfo
(&
wöSysInfo
);

35991 
	`osGëSy°emInfo
(&
wöSysInfo
);

35993 
	`as£π
–
wöSysInfo
.
dwAŒoˇti⁄Gønuœrôy
>0 );

35994 
	`as£π
–
wöSysInfo
.
dwPageSize
>0 );

35996 
	`sqlôe3_vfs_ªgi°î
(&
wöVfs
, 1);

35998 #i‡
	`deföed
(
SQLITE_WIN32_HAS_WIDE
)

35999 
	`sqlôe3_vfs_ªgi°î
(&
wöL⁄gP©hVfs
, 0);

36002  
SQLITE_OK
;

36005 
SQLITE_API
 
	`sqlôe3_os_íd
(){

36006 #i‡
SQLITE_OS_WINRT


36007 if–
¶ìpObj
!=
NULL
 ){

36008 
	`osClo£H™dÀ
(
¶ìpObj
);

36009 
¶ìpObj
 = 
NULL
;

36012  
SQLITE_OK
;

36057 
	#BITVEC_SZ
 512

	)

36061 
	#BITVEC_USIZE
 (((
BITVEC_SZ
-(3*(
u32
)))/(
Bôvec
*))*(Bôvec*))

	)

36067 
	#BITVEC_TELEM
 
u8


	)

36069 
	#BITVEC_SZELEM
 8

	)

36071 
	#BITVEC_NELEM
 (
BITVEC_USIZE
/(
BITVEC_TELEM
))

	)

36073 
	#BITVEC_NBIT
 (
BITVEC_NELEM
*
BITVEC_SZELEM
)

	)

36076 
	#BITVEC_NINT
 (
BITVEC_USIZE
/(
u32
))

	)

36079 
	#BITVEC_MXHASH
 (
BITVEC_NINT
/2)

	)

36084 
	#BITVEC_HASH
(
X
Ë(((X)*1)%
BITVEC_NINT
)

	)

36086 
	#BITVEC_NPTR
 (
BITVEC_USIZE
/(
Bôvec
 *))

	)

36110 
	sBôvec
 {

36111 
u32
 
iSize
;

36112 
u32
 
nSë
;

36115 
u32
 
iDivis‹
;

36120 
BITVEC_TELEM
 
aBôm≠
[
BITVEC_NELEM
];

36121 
u32
 
aHash
[
BITVEC_NINT
];

36122 
Bôvec
 *
≠Sub
[
BITVEC_NPTR
];

36123 } 
u
;

36131 
SQLITE_PRIVATE
 
Bôvec
 *
	`sqlôe3BôvecCª©e
(
u32
 
iSize
){

36132 
Bôvec
 *
p
;

36133 
	`as£π
–(*
p
)==
BITVEC_SZ
 );

36134 
p
 = 
	`sqlôe3MÆlocZîo
( (*p) );

36135 if–
p
 ){

36136 
p
->
iSize
 = iSize;

36138  
p
;

36146 
SQLITE_PRIVATE
 
	`sqlôe3BôvecTe°
(
Bôvec
 *
p
, 
u32
 
i
){

36147 if–
p
==0 )  0;

36148 if–
i
>
p
->
iSize
 || i==0 )  0;

36149 
i
--;

36150  
p
->
iDivis‹
 ){

36151 
u32
 
bö
 = 
i
/
p
->
iDivis‹
;

36152 
i
 = i%
p
->
iDivis‹
;

36153 
p
 =Ö->
u
.
≠Sub
[
bö
];

36154 i‡(!
p
) {

36158 if–
p
->
iSize
<=
BITVEC_NBIT
 ){

36159  (
p
->
u
.
aBôm≠
[
i
/
BITVEC_SZELEM
] & (1<<(i&(BITVEC_SZELEM-1))))!=0;

36161 
u32
 
h
 = 
	`BITVEC_HASH
(
i
++);

36162  
p
->
u
.
aHash
[
h
] ){

36163 if–
p
->
u
.
aHash
[
h
]==
i
 )  1;

36164 
h
 = (h+1Ë% 
BITVEC_NINT
;

36182 
SQLITE_PRIVATE
 
	`sqlôe3BôvecSë
(
Bôvec
 *
p
, 
u32
 
i
){

36183 
u32
 
h
;

36184 if–
p
==0 )  
SQLITE_OK
;

36185 
	`as£π
–
i
>0 );

36186 
	`as£π
–
i
<=
p
->
iSize
 );

36187 
i
--;

36188 (
p
->
iSize
 > 
BITVEC_NBIT
Ë&&Ö->
iDivis‹
) {

36189 
u32
 
bö
 = 
i
/
p
->
iDivis‹
;

36190 
i
 = i%
p
->
iDivis‹
;

36191 if–
p
->
u
.
≠Sub
[
bö
]==0 ){

36192 
p
->
u
.
≠Sub
[
bö
] = 
	`sqlôe3BôvecCª©e
–p->
iDivis‹
 );

36193 if–
p
->
u
.
≠Sub
[
bö
]==0 )  
SQLITE_NOMEM
;

36195 
p
 =Ö->
u
.
≠Sub
[
bö
];

36197 if–
p
->
iSize
<=
BITVEC_NBIT
 ){

36198 
p
->
u
.
aBôm≠
[
i
/
BITVEC_SZELEM
] |= 1 << (i&(BITVEC_SZELEM-1));

36199  
SQLITE_OK
;

36201 
h
 = 
	`BITVEC_HASH
(
i
++);

36205 if–!
p
->
u
.
aHash
[
h
] ){

36206 i‡(
p
->
nSë
<(
BITVEC_NINT
-1)) {

36207 
bôvec_£t_íd
;

36209 
bôvec_£t_ªhash
;

36215 if–
p
->
u
.
aHash
[
h
]==
i
 )  
SQLITE_OK
;

36216 
h
++;

36217 if–
h
>=
BITVEC_NINT
 ) h = 0;

36218 }  
p
->
u
.
aHash
[
h
] );

36222 
bôvec_£t_ªhash
:

36223 if–
p
->
nSë
>=
BITVEC_MXHASH
 ){

36224 
j
;

36225 
rc
;

36226 
u32
 *
aiVÆues
 = 
	`sqlôe3SèckAŒocRaw
(0, (
p
->
u
.
aHash
));

36227 if–
aiVÆues
==0 ){

36228  
SQLITE_NOMEM
;

36230 
	`mem˝y
(
aiVÆues
, 
p
->
u
.
aHash
, (p->u.aHash));

36231 
	`mem£t
(
p
->
u
.
≠Sub
, 0, (p->u.apSub));

36232 
p
->
iDivis‹
 = (p->
iSize
 + 
BITVEC_NPTR
 - 1)/BITVEC_NPTR;

36233 
rc
 = 
	`sqlôe3BôvecSë
(
p
, 
i
);

36234 
j
=0; j<
BITVEC_NINT
; j++){

36235 if–
aiVÆues
[
j
] ) 
rc
 |
	`sqlôe3BôvecSë
(
p
,áiValues[j]);

36237 
	`sqlôe3SèckFªe
(0, 
aiVÆues
);

36238  
rc
;

36241 
bôvec_£t_íd
:

36242 
p
->
nSë
++;

36243 
p
->
u
.
aHash
[
h
] = 
i
;

36244  
SQLITE_OK
;

36253 
SQLITE_PRIVATE
 
	`sqlôe3BôvecCÀ¨
(
Bôvec
 *
p
, 
u32
 
i
, *
pBuf
){

36254 if–
p
==0 ) ;

36255 
	`as£π
–
i
>0 );

36256 
i
--;

36257  
p
->
iDivis‹
 ){

36258 
u32
 
bö
 = 
i
/
p
->
iDivis‹
;

36259 
i
 = i%
p
->
iDivis‹
;

36260 
p
 =Ö->
u
.
≠Sub
[
bö
];

36261 i‡(!
p
) {

36265 if–
p
->
iSize
<=
BITVEC_NBIT
 ){

36266 
p
->
u
.
aBôm≠
[
i
/
BITVEC_SZELEM
] &= ~(1 << (i&(BITVEC_SZELEM-1)));

36268 
j
;

36269 
u32
 *
aiVÆues
 = 
pBuf
;

36270 
	`mem˝y
(
aiVÆues
, 
p
->
u
.
aHash
, (p->u.aHash));

36271 
	`mem£t
(
p
->
u
.
aHash
, 0, (p->u.aHash));

36272 
p
->
nSë
 = 0;

36273 
j
=0; j<
BITVEC_NINT
; j++){

36274 if–
aiVÆues
[
j
] &&áiVÆues[j]!=(
i
+1) ){

36275 
u32
 
h
 = 
	`BITVEC_HASH
(
aiVÆues
[
j
]-1);

36276 
p
->
nSë
++;

36277  
p
->
u
.
aHash
[
h
] ){

36278 
h
++;

36279 if–
h
>=
BITVEC_NINT
 ) h = 0;

36281 
p
->
u
.
aHash
[
h
] = 
aiVÆues
[
j
];

36290 
SQLITE_PRIVATE
 
	`sqlôe3BôvecDe°roy
(
Bôvec
 *
p
){

36291 if–
p
==0 ) ;

36292 if–
p
->
iDivis‹
 ){

36293 
i
;

36294 
i
=0; i<
BITVEC_NPTR
; i++){

36295 
	`sqlôe3BôvecDe°roy
(
p
->
u
.
≠Sub
[
i
]);

36298 
	`sqlôe3_‰ì
(
p
);

36305 
SQLITE_PRIVATE
 
u32
 
	`sqlôe3BôvecSize
(
Bôvec
 *
p
){

36306  
p
->
iSize
;

36309 #i‚de‡
SQLITE_OMIT_BUILTIN_TEST


36316 
	#SETBIT
(
V
,
I
ËV[I>>3] |(1<<(I&7))

	)

36317 
	#CLEARBIT
(
V
,
I
ËV[I>>3] &~(1<<(I&7))

	)

36318 
	#TESTBIT
(
V
,
I
Ë(V[I>>3]&(1<<(I&7)))!=0

	)

36350 
SQLITE_PRIVATE
 
	`sqlôe3BôvecBuûtöTe°
(
sz
, *
aOp
){

36351 
Bôvec
 *
pBôvec
 = 0;

36352 *
pV
 = 0;

36353 
rc
 = -1;

36354 
i
, 
nx
, 
pc
, 
›
;

36355 *
pTmpS∑˚
;

36359 
pBôvec
 = 
	`sqlôe3BôvecCª©e
–
sz
 );

36360 
pV
 = 
	`sqlôe3MÆlocZîo
–(
sz
+7)/8 + 1 );

36361 
pTmpS∑˚
 = 
	`sqlôe3_mÆloc
(
BITVEC_SZ
);

36362 if–
pBôvec
==0 || 
pV
==0 || 
pTmpS∑˚
==0 ) 
bôvec_íd
;

36365 
	`sqlôe3BôvecSë
(0, 1);

36366 
	`sqlôe3BôvecCÀ¨
(0, 1, 
pTmpS∑˚
);

36369 
pc
 = 0;

36370  (
›
 = 
aOp
[
pc
])!=0 ){

36371  
›
 ){

36375 
nx
 = 4;

36376 
i
 = 
aOp
[
pc
+2] - 1;

36377 
aOp
[
pc
+2] +=áOp[pc+3];

36383 
nx
 = 2;

36384 
	`sqlôe3_øndom√ss
((
i
), &i);

36388 if–(--
aOp
[
pc
+1]Ë> 0 ) 
nx
 = 0;

36389 
pc
 +
nx
;

36390 
i
 = (ò& 0x7fffffff)%
sz
;

36391 if–(
›
 & 1)!=0 ){

36392 
	`SETBIT
(
pV
, (
i
+1));

36393 if–
›
!=5 ){

36394 if–
	`sqlôe3BôvecSë
(
pBôvec
, 
i
+1ËË
bôvec_íd
;

36397 
	`CLEARBIT
(
pV
, (
i
+1));

36398 
	`sqlôe3BôvecCÀ¨
(
pBôvec
, 
i
+1, 
pTmpS∑˚
);

36407 
rc
 = 
	`sqlôe3BôvecTe°
(0,0Ë+ sqlôe3BôvecTe°(
pBôvec
, 
sz
+1)

36408 + 
	`sqlôe3BôvecTe°
(
pBôvec
, 0)

36409 + (
	`sqlôe3BôvecSize
(
pBôvec
Ë- 
sz
);

36410 
i
=1; i<=
sz
; i++){

36411 if–(
	`TESTBIT
(
pV
,
i
))!=
	`sqlôe3BôvecTe°
(
pBôvec
,i) ){

36412 
rc
 = 
i
;

36418 
bôvec_íd
:

36419 
	`sqlôe3_‰ì
(
pTmpS∑˚
);

36420 
	`sqlôe3_‰ì
(
pV
);

36421 
	`sqlôe3BôvecDe°roy
(
pBôvec
);

36422  
rc
;

36445 
	sPCache
 {

36446 
PgHdr
 *
pDúty
, *
pDútyTaû
;

36447 
PgHdr
 *
pSyn˚d
;

36448 
nRef
;

36449 
szCache
;

36450 
szPage
;

36451 
szExåa
;

36452 
bPurgóbÀ
;

36453 (*
xSåess
)(*,
PgHdr
*);

36454 *
pSåess
;

36455 
sqlôe3_pˇche
 *
pCache
;

36456 
PgHdr
 *
pPage1
;

36465 #ifde‡
SQLITE_ENABLE_EXPENSIVE_ASSERT


36466 
	#ex≥nsive_as£π
(
X
Ë
	`as£π
(X)

	)

36468 
	#ex≥nsive_as£π
(
X
)

	)

36473 #i‡!
	`deföed
(
NDEBUG
Ë&& deföed(
SQLITE_ENABLE_EXPENSIVE_ASSERT
)

36481 
	`pˇcheCheckSyn˚d
(
PCache
 *
pCache
){

36482 
PgHdr
 *
p
;

36483 
p
=
pCache
->
pDútyTaû
;Ö!ıCache->
pSyn˚d
;Öı->
pDútyPªv
){

36484 
	`as£π
–
p
->
nRef
 || (p->
Êags
&
PGHDR_NEED_SYNC
) );

36486  (
p
==0 ||Ö->
nRef
 || (p->
Êags
&
PGHDR_NEED_SYNC
)==0);

36493 
	`pˇcheRemoveFromDútyLi°
(
PgHdr
 *
pPage
){

36494 
PCache
 *
p
 = 
pPage
->
pCache
;

36496 
	`as£π
–
pPage
->
pDútyNext
 ||ÖPage==
p
->
pDútyTaû
 );

36497 
	`as£π
–
pPage
->
pDútyPªv
 ||ÖPage==
p
->
pDúty
 );

36500 if–
p
->
pSyn˚d
==
pPage
 ){

36501 
PgHdr
 *
pSyn˚d
 = 
pPage
->
pDútyPªv
;

36502  
pSyn˚d
 && (pSyn˚d->
Êags
&
PGHDR_NEED_SYNC
) ){

36503 
pSyn˚d
 =ÖSyn˚d->
pDútyPªv
;

36505 
p
->
pSyn˚d
 =ÖSynced;

36508 if–
pPage
->
pDútyNext
 ){

36509 
pPage
->
pDútyNext
->
pDútyPªv
 =ÖPage->pDirtyPrev;

36511 
	`as£π
–
pPage
==
p
->
pDútyTaû
 );

36512 
p
->
pDútyTaû
 = 
pPage
->
pDútyPªv
;

36514 if–
pPage
->
pDútyPªv
 ){

36515 
pPage
->
pDútyPªv
->
pDútyNext
 =ÖPage->pDirtyNext;

36517 
	`as£π
–
pPage
==
p
->
pDúty
 );

36518 
p
->
pDúty
 = 
pPage
->
pDútyNext
;

36520 
pPage
->
pDútyNext
 = 0;

36521 
pPage
->
pDútyPªv
 = 0;

36523 
	`ex≥nsive_as£π
–
	`pˇcheCheckSyn˚d
(
p
) );

36530 
	`pˇcheAddToDútyLi°
(
PgHdr
 *
pPage
){

36531 
PCache
 *
p
 = 
pPage
->
pCache
;

36533 
	`as£π
–
pPage
->
pDútyNext
==0 &&ÖPage->
pDútyPªv
==0 && 
p
->
pDúty
!=pPage );

36535 
pPage
->
pDútyNext
 = 
p
->
pDúty
;

36536 if–
pPage
->
pDútyNext
 ){

36537 
	`as£π
–
pPage
->
pDútyNext
->
pDútyPªv
==0 );

36538 
pPage
->
pDútyNext
->
pDútyPªv
 =ÖPage;

36540 
p
->
pDúty
 = 
pPage
;

36541 if–!
p
->
pDútyTaû
 ){

36542 
p
->
pDútyTaû
 = 
pPage
;

36544 if–!
p
->
pSyn˚d
 && 0==(
pPage
->
Êags
&
PGHDR_NEED_SYNC
) ){

36545 
p
->
pSyn˚d
 = 
pPage
;

36547 
	`ex≥nsive_as£π
–
	`pˇcheCheckSyn˚d
(
p
) );

36554 
	`pˇcheU≈ö
(
PgHdr
 *
p
){

36555 
PCache
 *
pCache
 = 
p
->pCache;

36556 if–
pCache
->
bPurgóbÀ
 ){

36557 if–
p
->
pgno
==1 ){

36558 
pCache
->
pPage1
 = 0;

36560 
sqlôe3GlobÆC⁄fig
.
pˇche2
.
	`xU≈ö
(
pCache
->pCache, 
p
->
pPage
, 0);

36569 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheInôülize
(){

36570 if–
sqlôe3GlobÆC⁄fig
.
pˇche2
.
xInô
==0 ){

36574 
	`sqlôe3PCacheSëDeÁu…
();

36576  
sqlôe3GlobÆC⁄fig
.
pˇche2
.
	`xInô
(sqlôe3GlobÆC⁄fig.pˇche2.
pArg
);

36578 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheShutdown
(){

36579 if–
sqlôe3GlobÆC⁄fig
.
pˇche2
.
xShutdown
 ){

36581 
sqlôe3GlobÆC⁄fig
.
pˇche2
.
	`xShutdown
(sqlôe3GlobÆC⁄fig.pˇche2.
pArg
);

36588 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheSize
(){  (
PCache
); }

36596 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheO≥n
(

36597 
szPage
,

36598 
szExåa
,

36599 
bPurgóbÀ
,

36600 (*
xSåess
)(*,
PgHdr
*),

36601 *
pSåess
,

36602 
PCache
 *
p


36604 
	`mem£t
(
p
, 0, (
PCache
));

36605 
p
->
szPage
 = szPage;

36606 
p
->
szExåa
 = szExtra;

36607 
p
->
bPurgóbÀ
 = bPurgeable;

36608 
p
->
xSåess
 = xStress;

36609 
p
->
pSåess
 =ÖStress;

36610 
p
->
szCache
 = 100;

36617 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheSëPageSize
(
PCache
 *
pCache
, 
szPage
){

36618 
	`as£π
–
pCache
->
nRef
==0 &&ÖCache->
pDúty
==0 );

36619 if–
pCache
->pCache ){

36620 
sqlôe3GlobÆC⁄fig
.
pˇche2
.
	`xDe°roy
(
pCache
->pCache);

36621 
pCache
->pCache = 0;

36622 
pCache
->
pPage1
 = 0;

36624 
pCache
->
szPage
 = szPage;

36630 
	`numbîOfCachePages
(
PCache
 *
p
){

36631 if–
p
->
szCache
>=0 ){

36632  
p
->
szCache
;

36634  ()((-1024*(
i64
)
p
->
szCache
)/’->
szPage
+p->
szExåa
));

36641 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheFëch
(

36642 
PCache
 *
pCache
,

36643 
Pgno
 
pgno
,

36644 
¸óãFœg
,

36645 
PgHdr
 **
µPage


36647 
sqlôe3_pˇche_∑ge
 *
pPage
 = 0;

36648 
PgHdr
 *
pPgHdr
 = 0;

36649 
eCª©e
;

36651 
	`as£π
–
pCache
!=0 );

36652 
	`as£π
–
¸óãFœg
==1 || createFlag==0 );

36653 
	`as£π
–
pgno
>0 );

36658 if–!
pCache
->pCachê&& 
¸óãFœg
 ){

36659 
sqlôe3_pˇche
 *
p
;

36660 
p
 = 
sqlôe3GlobÆC⁄fig
.
pˇche2
.
	`xCª©e
(

36661 
pCache
->
szPage
,ÖCache->
szExåa
 + (
PgHdr
),ÖCache->
bPurgóbÀ


36663 if–!
p
 ){

36664  
SQLITE_NOMEM
;

36666 
sqlôe3GlobÆC⁄fig
.
pˇche2
.
	`xCachesize
(
p
, 
	`numbîOfCachePages
(
pCache
));

36667 
pCache
->pCachê
p
;

36670 
eCª©e
 = 
¸óãFœg
 * (1 + (!
pCache
->
bPurgóbÀ
 || !pCache->
pDúty
));

36671 if–
pCache
->pCache ){

36672 
pPage
 = 
sqlôe3GlobÆC⁄fig
.
pˇche2
.
	`xFëch
(
pCache
->pCache, 
pgno
, 
eCª©e
);

36675 if–!
pPage
 && 
eCª©e
==1 ){

36676 
PgHdr
 *
pPg
;

36683 
	`ex≥nsive_as£π
–
	`pˇcheCheckSyn˚d
(
pCache
) );

36684 
pPg
=
pCache
->
pSyn˚d
;

36685 
pPg
 && (pPg->
nRef
 || (pPg->
Êags
&
PGHDR_NEED_SYNC
));

36686 
pPg
ıPg->
pDútyPªv


36688 
pCache
->
pSyn˚d
 = 
pPg
;

36689 if–!
pPg
 ){

36690 
pPg
=
pCache
->
pDútyTaû
;ÖPg &&ÖPg->
nRef
;ÖPgıPg->
pDútyPªv
);

36692 if–
pPg
 ){

36693 
rc
;

36694 #ifde‡
SQLITE_LOG_CACHE_SPILL


36695 
	`sqlôe3_log
(
SQLITE_FULL
,

36697 
pPg
->
pgno
,Ögno,

36698 
sqlôe3GlobÆC⁄fig
.
pˇche
.
	`xPagecou¡
(
pCache
->pCache),

36699 
	`numbîOfCachePages
(
pCache
));

36701 
rc
 = 
pCache
->
	`xSåess
’Cache->
pSåess
, 
pPg
);

36702 if–
rc
!=
SQLITE_OK
 &&Ñc!=
SQLITE_BUSY
 ){

36703  
rc
;

36707 
pPage
 = 
sqlôe3GlobÆC⁄fig
.
pˇche2
.
	`xFëch
(
pCache
->pCache, 
pgno
, 2);

36710 if–
pPage
 ){

36711 
pPgHdr
 = (
PgHdr
 *)
pPage
->
pExåa
;

36713 if–!
pPgHdr
->
pPage
 ){

36714 
	`mem£t
(
pPgHdr
, 0, (
PgHdr
));

36715 
pPgHdr
->
pPage
 =ÖPage;

36716 
pPgHdr
->
pD©a
 = 
pPage
->
pBuf
;

36717 
pPgHdr
->
pExåa
 = (*)&pPgHdr[1];

36718 
	`mem£t
(
pPgHdr
->
pExåa
, 0, 
pCache
->
szExåa
);

36719 
pPgHdr
->
pCache
 =ÖCache;

36720 
pPgHdr
->
pgno
 =Ögno;

36722 
	`as£π
–
pPgHdr
->
pCache
==pCache );

36723 
	`as£π
–
pPgHdr
->
pgno
==pgno );

36724 
	`as£π
–
pPgHdr
->
pD©a
==
pPage
->
pBuf
 );

36725 
	`as£π
–
pPgHdr
->
pExåa
==(*)&pPgHdr[1] );

36727 if–0==
pPgHdr
->
nRef
 ){

36728 
pCache
->
nRef
++;

36730 
pPgHdr
->
nRef
++;

36731 if–
pgno
==1 ){

36732 
pCache
->
pPage1
 = 
pPgHdr
;

36735 *
µPage
 = 
pPgHdr
;

36736  (
pPgHdr
==0 && 
eCª©e
Ë? 
SQLITE_NOMEM
 : 
SQLITE_OK
;

36743 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheRñó£
(
PgHdr
 *
p
){

36744 
	`as£π
–
p
->
nRef
>0 );

36745 
p
->
nRef
--;

36746 if–
p
->
nRef
==0 ){

36747 
PCache
 *
pCache
 = 
p
->pCache;

36748 
pCache
->
nRef
--;

36749 if–(
p
->
Êags
&
PGHDR_DIRTY
)==0 ){

36750 
	`pˇcheU≈ö
(
p
);

36753 
	`pˇcheRemoveFromDútyLi°
(
p
);

36754 
	`pˇcheAddToDútyLi°
(
p
);

36762 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheRef
(
PgHdr
 *
p
){

36763 
	`as£π
(
p
->
nRef
>0);

36764 
p
->
nRef
++;

36772 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheDr›
(
PgHdr
 *
p
){

36773 
PCache
 *
pCache
;

36774 
	`as£π
–
p
->
nRef
==1 );

36775 if–
p
->
Êags
&
PGHDR_DIRTY
 ){

36776 
	`pˇcheRemoveFromDútyLi°
(
p
);

36778 
pCache
 = 
p
->pCache;

36779 
pCache
->
nRef
--;

36780 if–
p
->
pgno
==1 ){

36781 
pCache
->
pPage1
 = 0;

36783 
sqlôe3GlobÆC⁄fig
.
pˇche2
.
	`xU≈ö
(
pCache
->pCache, 
p
->
pPage
, 1);

36790 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheMakeDúty
(
PgHdr
 *
p
){

36791 
p
->
Êags
 &~
PGHDR_DONT_WRITE
;

36792 
	`as£π
–
p
->
nRef
>0 );

36793 if–0==(
p
->
Êags
 & 
PGHDR_DIRTY
) ){

36794 
p
->
Êags
 |
PGHDR_DIRTY
;

36795 
	`pˇcheAddToDútyLi°
–
p
);

36803 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheMakeCÀ™
(
PgHdr
 *
p
){

36804 if–(
p
->
Êags
 & 
PGHDR_DIRTY
) ){

36805 
	`pˇcheRemoveFromDútyLi°
(
p
);

36806 
p
->
Êags
 &~(
PGHDR_DIRTY
|
PGHDR_NEED_SYNC
);

36807 if–
p
->
nRef
==0 ){

36808 
	`pˇcheU≈ö
(
p
);

36816 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheCÀ™AŒ
(
PCache
 *
pCache
){

36817 
PgHdr
 *
p
;

36818  (
p
 = 
pCache
->
pDúty
)!=0 ){

36819 
	`sqlôe3PˇcheMakeCÀ™
(
p
);

36826 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheCÀ¨SyncFœgs
(
PCache
 *
pCache
){

36827 
PgHdr
 *
p
;

36828 
p
=
pCache
->
pDúty
;Ö;Öı->
pDútyNext
){

36829 
p
->
Êags
 &~
PGHDR_NEED_SYNC
;

36831 
pCache
->
pSyn˚d
 =ÖCache->
pDútyTaû
;

36837 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheMove
(
PgHdr
 *
p
, 
Pgno
 
√wPgno
){

36838 
PCache
 *
pCache
 = 
p
->pCache;

36839 
	`as£π
–
p
->
nRef
>0 );

36840 
	`as£π
–
√wPgno
>0 );

36841 
sqlôe3GlobÆC⁄fig
.
pˇche2
.
	`xRekey
(
pCache
->pCache, 
p
->
pPage
,Ö->
pgno
,
√wPgno
);

36842 
p
->
pgno
 = 
√wPgno
;

36843 if–(
p
->
Êags
&
PGHDR_DIRTY
Ë&& (p->Êags&
PGHDR_NEED_SYNC
) ){

36844 
	`pˇcheRemoveFromDútyLi°
(
p
);

36845 
	`pˇcheAddToDútyLi°
(
p
);

36858 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheTrunˇã
(
PCache
 *
pCache
, 
Pgno
 
pgno
){

36859 if–
pCache
->pCache ){

36860 
PgHdr
 *
p
;

36861 
PgHdr
 *
pNext
;

36862 
p
=
pCache
->
pDúty
;Ö;Ö=
pNext
){

36863 
pNext
 = 
p
->
pDútyNext
;

36868 
	`as£π
–
p
->
pgno
>0 );

36869 if–
	`ALWAYS
(
p
->
pgno
>pgno) ){

36870 
	`as£π
–
p
->
Êags
&
PGHDR_DIRTY
 );

36871 
	`sqlôe3PˇcheMakeCÀ™
(
p
);

36874 if–
pgno
==0 && 
pCache
->
pPage1
 ){

36875 
	`mem£t
(
pCache
->
pPage1
->
pD©a
, 0,ÖCache->
szPage
);

36876 
pgno
 = 1;

36878 
sqlôe3GlobÆC⁄fig
.
pˇche2
.
	`xTrunˇã
(
pCache
->pCache, 
pgno
+1);

36885 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheClo£
(
PCache
 *
pCache
){

36886 if–
pCache
->pCache ){

36887 
sqlôe3GlobÆC⁄fig
.
pˇche2
.
	`xDe°roy
(
pCache
->pCache);

36894 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheCÀ¨
(
PCache
 *
pCache
){

36895 
	`sqlôe3PˇcheTrunˇã
(
pCache
, 0);

36902 
PgHdr
 *
	`pˇcheMîgeDútyLi°
(PgHd∏*
pA
, PgHd∏*
pB
){

36903 
PgHdr
 
ªsu…
, *
pTaû
;

36904 
pTaû
 = &
ªsu…
;

36905  
pA
 && 
pB
 ){

36906 if–
pA
->
pgno
<
pB
->pgno ){

36907 
pTaû
->
pDúty
 = 
pA
;

36908 
pTaû
 = 
pA
;

36909 
pA
 =ÖA->
pDúty
;

36911 
pTaû
->
pDúty
 = 
pB
;

36912 
pTaû
 = 
pB
;

36913 
pB
 =ÖB->
pDúty
;

36916 if–
pA
 ){

36917 
pTaû
->
pDúty
 = 
pA
;

36918 }if–
pB
 ){

36919 
pTaû
->
pDúty
 = 
pB
;

36921 
pTaû
->
pDúty
 = 0;

36923  
ªsu…
.
pDúty
;

36936 
	#N_SORT_BUCKET
 32

	)

36937 
PgHdr
 *
	`pˇcheS‹tDútyLi°
(PgHd∏*
pIn
){

36938 
PgHdr
 *
a
[
N_SORT_BUCKET
], *
p
;

36939 
i
;

36940 
	`mem£t
(
a
, 0, (a));

36941  
pIn
 ){

36942 
p
 = 
pIn
;

36943 
pIn
 = 
p
->
pDúty
;

36944 
p
->
pDúty
 = 0;

36945 
i
=0; 
	`ALWAYS
(i<
N_SORT_BUCKET
-1); i++){

36946 if–
a
[
i
]==0 ){

36947 
a
[
i
] = 
p
;

36950 
p
 = 
	`pˇcheMîgeDútyLi°
(
a
[
i
],Ö);

36951 
a
[
i
] = 0;

36954 if–
	`NEVER
(
i
==
N_SORT_BUCKET
-1) ){

36958 
a
[
i
] = 
	`pˇcheMîgeDútyLi°
◊[i], 
p
);

36961 
p
 = 
a
[0];

36962 
i
=1; i<
N_SORT_BUCKET
; i++){

36963 
p
 = 
	`pˇcheMîgeDútyLi°
’, 
a
[
i
]);

36965  
p
;

36971 
SQLITE_PRIVATE
 
PgHdr
 *
	`sqlôe3PˇcheDútyLi°
(
PCache
 *
pCache
){

36972 
PgHdr
 *
p
;

36973 
p
=
pCache
->
pDúty
;Ö;Öı->
pDútyNext
){

36974 
p
->
pDúty
 =Ö->
pDútyNext
;

36976  
	`pˇcheS‹tDútyLi°
(
pCache
->
pDúty
);

36982 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheRefCou¡
(
PCache
 *
pCache
){

36983  
pCache
->
nRef
;

36989 
SQLITE_PRIVATE
 
	`sqlôe3PˇchePageRefcou¡
(
PgHdr
 *
p
){

36990  
p
->
nRef
;

36996 
SQLITE_PRIVATE
 
	`sqlôe3PˇchePagecou¡
(
PCache
 *
pCache
){

36997 
nPage
 = 0;

36998 if–
pCache
->pCache ){

36999 
nPage
 = 
sqlôe3GlobÆC⁄fig
.
pˇche2
.
	`xPagecou¡
(
pCache
->pCache);

37001  
nPage
;

37004 #ifde‡
SQLITE_TEST


37008 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheGëCachesize
(
PCache
 *
pCache
){

37009  
	`numbîOfCachePages
(
pCache
);

37016 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheSëCachesize
(
PCache
 *
pCache
, 
mxPage
){

37017 
pCache
->
szCache
 = 
mxPage
;

37018 if–
pCache
->pCache ){

37019 
sqlôe3GlobÆC⁄fig
.
pˇche2
.
	`xCachesize
(
pCache
->pCache,

37020 
	`numbîOfCachePages
(
pCache
));

37027 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheShrök
(
PCache
 *
pCache
){

37028 if–
pCache
->pCache ){

37029 
sqlôe3GlobÆC⁄fig
.
pˇche2
.
	`xShrök
(
pCache
->pCache);

37033 #i‡
	`deföed
(
SQLITE_CHECK_PAGES
Ë|| deföed(
SQLITE_DEBUG
)

37039 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheIãøãDúty
(
PCache
 *
pCache
, (*
xIãr
)(
PgHdr
 *)){

37040 
PgHdr
 *
pDúty
;

37041 
pDúty
=
pCache
->pDúty;ÖDúty;ÖDútyıDúty->
pDútyNext
){

37042 
	`xIãr
(
pDúty
);

37069 
PCache1
 
	tPCache1
;

37070 
PgHdr1
 
	tPgHdr1
;

37071 
PgFªe¶Ÿ
 
	tPgFªe¶Ÿ
;

37072 
PGroup
 
	tPGroup
;

37096 
	sPGroup
 {

37097 
sqlôe3_muãx
 *
muãx
;

37098 
nMaxPage
;

37099 
nMöPage
;

37100 
mxPö√d
;

37101 
nCuºítPage
;

37102 
PgHdr1
 *
pLruHód
, *
pLruTaû
;

37113 
	sPCache1
 {

37119 
PGroup
 *
pGroup
;

37120 
szPage
;

37121 
szExåa
;

37122 
bPurgóbÀ
;

37123 
nMö
;

37124 
nMax
;

37125 
n90p˘
;

37126 
iMaxKey
;

37131 
nRecy˛abÀ
;

37132 
nPage
;

37133 
nHash
;

37134 
PgHdr1
 **
≠Hash
;

37143 
	sPgHdr1
 {

37144 
sqlôe3_pˇche_∑ge
 
∑ge
;

37145 
iKey
;

37146 
PgHdr1
 *
pNext
;

37147 
PCache1
 *
pCache
;

37148 
PgHdr1
 *
pLruNext
;

37149 
PgHdr1
 *
pLruPªv
;

37156 
	sPgFªe¶Ÿ
 {

37157 
PgFªe¶Ÿ
 *
pNext
;

37163 
SQLITE_WSD
 
	sPCacheGlobÆ
 {

37164 
PGroup
 
gΩ
;

37171 
isInô
;

37172 
szSlŸ
;

37173 
nSlŸ
;

37174 
nRe£rve
;

37175 *
pSèπ
, *
pEnd
;

37177 
sqlôe3_muãx
 *
muãx
;

37178 
PgFªe¶Ÿ
 *
pFªe
;

37179 
nFªeSlŸ
;

37184 
bUndîPªssuª
;

37185 } 
pˇche1_g
;

37192 
	#pˇche1
 (
	`GLOBAL
(
PCacheGlobÆ
, 
pˇche1_g
))

	)

37197 
	#pˇche1E¡îMuãx
(
X
Ë
	`sqlôe3_muãx_íãr
((X)->
muãx
)

	)

37198 
	#pˇche1LóveMuãx
(
X
Ë
	`sqlôe3_muãx_Àave
((X)->
muãx
)

	)

37212 
SQLITE_PRIVATE
 
	`sqlôe3PCacheBuf„rSëup
(*
pBuf
, 
sz
, 
n
){

37213 if–
pˇche1
.
isInô
 ){

37214 
PgFªe¶Ÿ
 *
p
;

37215 
sz
 = 
	`ROUNDDOWN8
(sz);

37216 
pˇche1
.
szSlŸ
 = 
sz
;

37217 
pˇche1
.
nSlŸ
 =Öˇche1.
nFªeSlŸ
 = 
n
;

37218 
pˇche1
.
nRe£rve
 = 
n
>90 ? 10 : (n/10 + 1);

37219 
pˇche1
.
pSèπ
 = 
pBuf
;

37220 
pˇche1
.
pFªe
 = 0;

37221 
pˇche1
.
bUndîPªssuª
 = 0;

37222  
n
-- ){

37223 
p
 = (
PgFªe¶Ÿ
*)
pBuf
;

37224 
p
->
pNext
 = 
pˇche1
.
pFªe
;

37225 
pˇche1
.
pFªe
 = 
p
;

37226 
pBuf
 = (*)&((*ÌBuf)[
sz
];

37228 
pˇche1
.
pEnd
 = 
pBuf
;

37241 *
	`pˇche1AŒoc
(
nByã
){

37242 *
p
 = 0;

37243 
	`as£π
–
	`sqlôe3_muãx_nŸhñd
(
pˇche1
.
gΩ
.
muãx
) );

37244 
	`sqlôe3SètusSë
(
SQLITE_STATUS_PAGECACHE_SIZE
, 
nByã
);

37245 if–
nByã
<=
pˇche1
.
szSlŸ
 ){

37246 
	`sqlôe3_muãx_íãr
(
pˇche1
.
muãx
);

37247 
p
 = (
PgHdr1
 *)
pˇche1
.
pFªe
;

37248 if–
p
 ){

37249 
pˇche1
.
pFªe
 =Öˇche1.pFªe->
pNext
;

37250 
pˇche1
.
nFªeSlŸ
--;

37251 
pˇche1
.
bUndîPªssuª
 =Öˇche1.
nFªeSlŸ
<pˇche1.
nRe£rve
;

37252 
	`as£π
–
pˇche1
.
nFªeSlŸ
>=0 );

37253 
	`sqlôe3SètusAdd
(
SQLITE_STATUS_PAGECACHE_USED
, 1);

37255 
	`sqlôe3_muãx_Àave
(
pˇche1
.
muãx
);

37257 if–
p
==0 ){

37261 
p
 = 
	`sqlôe3MÆloc
(
nByã
);

37262 #i‚de‡
SQLITE_DISABLE_PAGECACHE_OVERFLOW_STATS


37263 if–
p
 ){

37264 
sz
 = 
	`sqlôe3MÆlocSize
(
p
);

37265 
	`sqlôe3_muãx_íãr
(
pˇche1
.
muãx
);

37266 
	`sqlôe3SètusAdd
(
SQLITE_STATUS_PAGECACHE_OVERFLOW
, 
sz
);

37267 
	`sqlôe3_muãx_Àave
(
pˇche1
.
muãx
);

37270 
	`sqlôe3MemdebugSëTy≥
(
p
, 
MEMTYPE_PCACHE
);

37272  
p
;

37278 
	`pˇche1Fªe
(*
p
){

37279 
nFªed
 = 0;

37280 if–
p
==0 )  0;

37281 if–
p
>=
pˇche1
.
pSèπ
 &&Ö<pˇche1.
pEnd
 ){

37282 
PgFªe¶Ÿ
 *
pSlŸ
;

37283 
	`sqlôe3_muãx_íãr
(
pˇche1
.
muãx
);

37284 
	`sqlôe3SètusAdd
(
SQLITE_STATUS_PAGECACHE_USED
, -1);

37285 
pSlŸ
 = (
PgFªe¶Ÿ
*)
p
;

37286 
pSlŸ
->
pNext
 = 
pˇche1
.
pFªe
;

37287 
pˇche1
.
pFªe
 = 
pSlŸ
;

37288 
pˇche1
.
nFªeSlŸ
++;

37289 
pˇche1
.
bUndîPªssuª
 =Öˇche1.
nFªeSlŸ
<pˇche1.
nRe£rve
;

37290 
	`as£π
–
pˇche1
.
nFªeSlŸ
<ıˇche1.
nSlŸ
 );

37291 
	`sqlôe3_muãx_Àave
(
pˇche1
.
muãx
);

37293 
	`as£π
–
	`sqlôe3MemdebugHasTy≥
(
p
, 
MEMTYPE_PCACHE
) );

37294 
	`sqlôe3MemdebugSëTy≥
(
p
, 
MEMTYPE_HEAP
);

37295 
nFªed
 = 
	`sqlôe3MÆlocSize
(
p
);

37296 #i‚de‡
SQLITE_DISABLE_PAGECACHE_OVERFLOW_STATS


37297 
	`sqlôe3_muãx_íãr
(
pˇche1
.
muãx
);

37298 
	`sqlôe3SètusAdd
(
SQLITE_STATUS_PAGECACHE_OVERFLOW
, -
nFªed
);

37299 
	`sqlôe3_muãx_Àave
(
pˇche1
.
muãx
);

37301 
	`sqlôe3_‰ì
(
p
);

37303  
nFªed
;

37306 #ifde‡
SQLITE_ENABLE_MEMORY_MANAGEMENT


37310 
	`pˇche1MemSize
(*
p
){

37311 if–
p
>=
pˇche1
.
pSèπ
 &&Ö<pˇche1.
pEnd
 ){

37312  
pˇche1
.
szSlŸ
;

37314 
iSize
;

37315 
	`as£π
–
	`sqlôe3MemdebugHasTy≥
(
p
, 
MEMTYPE_PCACHE
) );

37316 
	`sqlôe3MemdebugSëTy≥
(
p
, 
MEMTYPE_HEAP
);

37317 
iSize
 = 
	`sqlôe3MÆlocSize
(
p
);

37318 
	`sqlôe3MemdebugSëTy≥
(
p
, 
MEMTYPE_PCACHE
);

37319  
iSize
;

37327 
PgHdr1
 *
	`pˇche1AŒocPage
(
PCache1
 *
pCache
){

37328 
PgHdr1
 *
p
 = 0;

37329 *
pPg
;

37334 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pCache
->
pGroup
->
muãx
) );

37335 
	`pˇche1LóveMuãx
(
pCache
->
pGroup
);

37336 #ifde‡
SQLITE_PCACHE_SEPARATE_HEADER


37337 
pPg
 = 
	`pˇche1AŒoc
(
pCache
->
szPage
);

37338 
p
 = 
	`sqlôe3MÆloc
((
PgHdr1
Ë+ 
pCache
->
szExåa
);

37339 if–!
pPg
 || !
p
 ){

37340 
	`pˇche1Fªe
(
pPg
);

37341 
	`sqlôe3_‰ì
(
p
);

37342 
pPg
 = 0;

37345 
pPg
 = 
	`pˇche1AŒoc
((
PgHdr1
Ë+ 
pCache
->
szPage
 +ÖCache->
szExåa
);

37346 
p
 = (
PgHdr1
 *)&((
u8
 *)
pPg
)[
pCache
->
szPage
];

37348 
	`pˇche1E¡îMuãx
(
pCache
->
pGroup
);

37350 if–
pPg
 ){

37351 
p
->
∑ge
.
pBuf
 = 
pPg
;

37352 
p
->
∑ge
.
pExåa
 = &p[1];

37353 if–
pCache
->
bPurgóbÀ
 ){

37354 
pCache
->
pGroup
->
nCuºítPage
++;

37356  
p
;

37368 
	`pˇche1FªePage
(
PgHdr1
 *
p
){

37369 if–
	`ALWAYS
(
p
) ){

37370 
PCache1
 *
pCache
 = 
p
->pCache;

37371 
	`as£π
–
	`sqlôe3_muãx_hñd
(
p
->
pCache
->
pGroup
->
muãx
) );

37372 
	`pˇche1Fªe
(
p
->
∑ge
.
pBuf
);

37373 #ifde‡
SQLITE_PCACHE_SEPARATE_HEADER


37374 
	`sqlôe3_‰ì
(
p
);

37376 if–
pCache
->
bPurgóbÀ
 ){

37377 
pCache
->
pGroup
->
nCuºítPage
--;

37387 
SQLITE_PRIVATE
 *
	`sqlôe3PageMÆloc
(
sz
){

37388  
	`pˇche1AŒoc
(
sz
);

37394 
SQLITE_PRIVATE
 
	`sqlôe3PageFªe
(*
p
){

37395 
	`pˇche1Fªe
(
p
);

37415 
	`pˇche1UndîMem‹yPªssuª
(
PCache1
 *
pCache
){

37416 if–
pˇche1
.
nSlŸ
 && (
pCache
->
szPage
+pCache->
szExåa
)<ıˇche1.
szSlŸ
 ){

37417  
pˇche1
.
bUndîPªssuª
;

37419  
	`sqlôe3HópNóæyFuŒ
();

37432 
	`pˇche1ResizeHash
(
PCache1
 *
p
){

37433 
PgHdr1
 **
≠New
;

37434 
nNew
;

37435 
i
;

37437 
	`as£π
–
	`sqlôe3_muãx_hñd
(
p
->
pGroup
->
muãx
) );

37439 
nNew
 = 
p
->
nHash
*2;

37440 if–
nNew
<256 ){

37441 
nNew
 = 256;

37444 
	`pˇche1LóveMuãx
(
p
->
pGroup
);

37445 if–
p
->
nHash
 ){ 
	`sqlôe3BegöBíignMÆloc
(); }

37446 
≠New
 = (
PgHdr1
 **)
	`sqlôe3MÆlocZîo
((PgHdr1 *)*
nNew
);

37447 if–
p
->
nHash
 ){ 
	`sqlôe3EndBíignMÆloc
(); }

37448 
	`pˇche1E¡îMuãx
(
p
->
pGroup
);

37449 if–
≠New
 ){

37450 
i
=0; i<
p
->
nHash
; i++){

37451 
PgHdr1
 *
pPage
;

37452 
PgHdr1
 *
pNext
 = 
p
->
≠Hash
[
i
];

37453  (
pPage
 = 
pNext
)!=0 ){

37454 
h
 = 
pPage
->
iKey
 % 
nNew
;

37455 
pNext
 = 
pPage
->pNext;

37456 
pPage
->
pNext
 = 
≠New
[
h
];

37457 
≠New
[
h
] = 
pPage
;

37460 
	`sqlôe3_‰ì
(
p
->
≠Hash
);

37461 
p
->
≠Hash
 = 
≠New
;

37462 
p
->
nHash
 = 
nNew
;

37465  (
p
->
≠Hash
 ? 
SQLITE_OK
 : 
SQLITE_NOMEM
);

37477 
	`pˇche1PöPage
(
PgHdr1
 *
pPage
){

37478 
PCache1
 *
pCache
;

37479 
PGroup
 *
pGroup
;

37481 if–
pPage
==0 ) ;

37482 
pCache
 = 
pPage
->pCache;

37483 
pGroup
 = 
pCache
->pGroup;

37484 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pGroup
->
muãx
) );

37485 if–
pPage
->
pLruNext
 ||ÖPage==
pGroup
->
pLruTaû
 ){

37486 if–
pPage
->
pLruPªv
 ){

37487 
pPage
->
pLruPªv
->
pLruNext
 =ÖPage->pLruNext;

37489 if–
pPage
->
pLruNext
 ){

37490 
pPage
->
pLruNext
->
pLruPªv
 =ÖPage->pLruPrev;

37492 if–
pGroup
->
pLruHód
==
pPage
 ){

37493 
pGroup
->
pLruHód
 = 
pPage
->
pLruNext
;

37495 if–
pGroup
->
pLruTaû
==
pPage
 ){

37496 
pGroup
->
pLruTaû
 = 
pPage
->
pLruPªv
;

37498 
pPage
->
pLruNext
 = 0;

37499 
pPage
->
pLruPªv
 = 0;

37500 
pPage
->
pCache
->
nRecy˛abÀ
--;

37511 
	`pˇche1RemoveFromHash
(
PgHdr1
 *
pPage
){

37512 
h
;

37513 
PCache1
 *
pCache
 = 
pPage
->pCache;

37514 
PgHdr1
 **
µ
;

37516 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pCache
->
pGroup
->
muãx
) );

37517 
h
 = 
pPage
->
iKey
 % 
pCache
->
nHash
;

37518 
µ
=&
pCache
->
≠Hash
[
h
]; (*µ)!=
pPage
;Öp=&(*µ)->
pNext
);

37519 *
µ
 = (*µ)->
pNext
;

37521 
pCache
->
nPage
--;

37528 
	`pˇche1Enf‹˚MaxPage
(
PGroup
 *
pGroup
){

37529 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pGroup
->
muãx
) );

37530  
pGroup
->
nCuºítPage
>pGroup->
nMaxPage
 &&ÖGroup->
pLruTaû
 ){

37531 
PgHdr1
 *
p
 = 
pGroup
->
pLruTaû
;

37532 
	`as£π
–
p
->
pCache
->
pGroup
==pGroup );

37533 
	`pˇche1PöPage
(
p
);

37534 
	`pˇche1RemoveFromHash
(
p
);

37535 
	`pˇche1FªePage
(
p
);

37546 
	`pˇche1TrunˇãUnß„
(

37547 
PCache1
 *
pCache
,

37548 
iLimô


37550 
	`TESTONLY
–
nPage
 = 0; )

37551 
h
;

37552 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pCache
->
pGroup
->
muãx
) );

37553 
h
=0; h<
pCache
->
nHash
; h++){

37554 
PgHdr1
 **
µ
 = &
pCache
->
≠Hash
[
h
];

37555 
PgHdr1
 *
pPage
;

37556  (
pPage
 = *
µ
)!=0 ){

37557 if–
pPage
->
iKey
>=
iLimô
 ){

37558 
pCache
->
nPage
--;

37559 *
µ
 = 
pPage
->
pNext
;

37560 
	`pˇche1PöPage
(
pPage
);

37561 
	`pˇche1FªePage
(
pPage
);

37563 
µ
 = &
pPage
->
pNext
;

37564 
	`TESTONLY
–
nPage
++; )

37568 
	`as£π
–
pCache
->
nPage
==nPage );

37577 
	`pˇche1Inô
(*
NŸU£d
){

37578 
	`UNUSED_PARAMETER
(
NŸU£d
);

37579 
	`as£π
–
pˇche1
.
isInô
==0 );

37580 
	`mem£t
(&
pˇche1
, 0, (pcache1));

37581 if–
sqlôe3GlobÆC⁄fig
.
bC‹eMuãx
 ){

37582 
pˇche1
.
gΩ
.
muãx
 = 
	`sqlôe3_muãx_Æloc
(
SQLITE_MUTEX_STATIC_LRU
);

37583 
pˇche1
.
muãx
 = 
	`sqlôe3_muãx_Æloc
(
SQLITE_MUTEX_STATIC_PMEM
);

37585 
pˇche1
.
gΩ
.
mxPö√d
 = 10;

37586 
pˇche1
.
isInô
 = 1;

37587  
SQLITE_OK
;

37595 
	`pˇche1Shutdown
(*
NŸU£d
){

37596 
	`UNUSED_PARAMETER
(
NŸU£d
);

37597 
	`as£π
–
pˇche1
.
isInô
!=0 );

37598 
	`mem£t
(&
pˇche1
, 0, (pcache1));

37606 
sqlôe3_pˇche
 *
	`pˇche1Cª©e
(
szPage
, 
szExåa
, 
bPurgóbÀ
){

37607 
PCache1
 *
pCache
;

37608 
PGroup
 *
pGroup
;

37609 
sz
;

37623 #i‡
	`deföed
(
SQLITE_ENABLE_MEMORY_MANAGEMENT
Ë|| 
SQLITE_THREADSAFE
==0

37624 c⁄° 
£∑øãCache
 = 0;

37626 
£∑øãCache
 = 
sqlôe3GlobÆC⁄fig
.
bC‹eMuãx
>0;

37629 
	`as£π
–(
szPage
 & (szPage-1))==0 && szPage>=512 && szPage<=65536 );

37630 
	`as£π
–
szExåa
 < 300 );

37632 
sz
 = (
PCache1
Ë+ (
PGroup
)*
£∑øãCache
;

37633 
pCache
 = (
PCache1
 *)
	`sqlôe3MÆlocZîo
(
sz
);

37634 if–
pCache
 ){

37635 if–
£∑øãCache
 ){

37636 
pGroup
 = (
PGroup
*)&
pCache
[1];

37637 
pGroup
->
mxPö√d
 = 10;

37639 
pGroup
 = &
pˇche1
.
gΩ
;

37641 
pCache
->
pGroup
 =ÖGroup;

37642 
pCache
->
szPage
 = szPage;

37643 
pCache
->
szExåa
 = szExtra;

37644 
pCache
->
bPurgóbÀ
 = (bPurgeable ? 1 : 0);

37645 if–
bPurgóbÀ
 ){

37646 
pCache
->
nMö
 = 10;

37647 
	`pˇche1E¡îMuãx
(
pGroup
);

37648 
pGroup
->
nMöPage
 +
pCache
->
nMö
;

37649 
pGroup
->
mxPö√d
 =ÖGroup->
nMaxPage
 + 10 -ÖGroup->
nMöPage
;

37650 
	`pˇche1LóveMuãx
(
pGroup
);

37653  (
sqlôe3_pˇche
 *)
pCache
;

37661 
	`pˇche1Cachesize
(
sqlôe3_pˇche
 *
p
, 
nMax
){

37662 
PCache1
 *
pCache
 = (PCache1 *)
p
;

37663 if–
pCache
->
bPurgóbÀ
 ){

37664 
PGroup
 *
pGroup
 = 
pCache
->pGroup;

37665 
	`pˇche1E¡îMuãx
(
pGroup
);

37666 
pGroup
->
nMaxPage
 +(
nMax
 - 
pCache
->nMax);

37667 
pGroup
->
mxPö√d
 =ÖGroup->
nMaxPage
 + 10 -ÖGroup->
nMöPage
;

37668 
pCache
->
nMax
 =ÇMax;

37669 
pCache
->
n90p˘
 =ÖCache->
nMax
*9/10;

37670 
	`pˇche1Enf‹˚MaxPage
(
pGroup
);

37671 
	`pˇche1LóveMuãx
(
pGroup
);

37680 
	`pˇche1Shrök
(
sqlôe3_pˇche
 *
p
){

37681 
PCache1
 *
pCache
 = (PCache1*)
p
;

37682 if–
pCache
->
bPurgóbÀ
 ){

37683 
PGroup
 *
pGroup
 = 
pCache
->pGroup;

37684 
ßvedMaxPage
;

37685 
	`pˇche1E¡îMuãx
(
pGroup
);

37686 
ßvedMaxPage
 = 
pGroup
->
nMaxPage
;

37687 
pGroup
->
nMaxPage
 = 0;

37688 
	`pˇche1Enf‹˚MaxPage
(
pGroup
);

37689 
pGroup
->
nMaxPage
 = 
ßvedMaxPage
;

37690 
	`pˇche1LóveMuãx
(
pGroup
);

37697 
	`pˇche1Pagecou¡
(
sqlôe3_pˇche
 *
p
){

37698 
n
;

37699 
PCache1
 *
pCache
 = (PCache1*)
p
;

37700 
	`pˇche1E¡îMuãx
(
pCache
->
pGroup
);

37701 
n
 = 
pCache
->
nPage
;

37702 
	`pˇche1LóveMuãx
(
pCache
->
pGroup
);

37703  
n
;

37760 
sqlôe3_pˇche_∑ge
 *
	`pˇche1Fëch
(

37761 
sqlôe3_pˇche
 *
p
,

37762 
iKey
,

37763 
¸óãFœg


37765 
nPö√d
;

37766 
PCache1
 *
pCache
 = (PCache1 *)
p
;

37767 
PGroup
 *
pGroup
;

37768 
PgHdr1
 *
pPage
 = 0;

37770 
	`as£π
–
pCache
->
bPurgóbÀ
 || 
¸óãFœg
!=1 );

37771 
	`as£π
–
pCache
->
bPurgóbÀ
 ||ÖCache->
nMö
==0 );

37772 
	`as£π
–
pCache
->
bPurgóbÀ
==0 ||ÖCache->
nMö
==10 );

37773 
	`as£π
–
pCache
->
nMö
==0 ||ÖCache->
bPurgóbÀ
 );

37774 
	`pˇche1E¡îMuãx
(
pGroup
 = 
pCache
->pGroup);

37777 if–
pCache
->
nHash
>0 ){

37778 
h
 = 
iKey
 % 
pCache
->
nHash
;

37779 
pPage
=
pCache
->
≠Hash
[
h
];ÖPage&&pPage->
iKey
!=iKey;ÖPageıPage->
pNext
);

37783 if–
pPage
 || 
¸óãFœg
==0 ){

37784 
	`pˇche1PöPage
(
pPage
);

37785 
„tch_out
;

37795 #ifde‡
SQLITE_MUTEX_OMIT


37796 
pGroup
 = 
pCache
->pGroup;

37800 
	`as£π
–
pCache
->
nPage
 >pCache->
nRecy˛abÀ
 );

37801 
nPö√d
 = 
pCache
->
nPage
 -ÖCache->
nRecy˛abÀ
;

37802 
	`as£π
–
pGroup
->
mxPö√d
 =pGroup->
nMaxPage
 + 10 -ÖGroup->
nMöPage
 );

37803 
	`as£π
–
pCache
->
n90p˘
 =pCache->
nMax
*9/10 );

37804 if–
¸óãFœg
==1 && (

37805 
nPö√d
>=
pGroup
->
mxPö√d


37806 || 
nPö√d
>=
pCache
->
n90p˘


37807 || 
	`pˇche1UndîMem‹yPªssuª
(
pCache
)

37809 
„tch_out
;

37812 if–
pCache
->
nPage
>ıCache->
nHash
 && 
	`pˇche1ResizeHash
(pCache) ){

37813 
„tch_out
;

37815 
	`as£π
–
pCache
->
nHash
>0 &&ÖCache->
≠Hash
 );

37818 if–
pCache
->
bPurgóbÀ
 && 
pGroup
->
pLruTaû
 && (

37819 (
pCache
->
nPage
+1>ıCache->
nMax
)

37820 || 
pGroup
->
nCuºítPage
>ıGroup->
nMaxPage


37821 || 
	`pˇche1UndîMem‹yPªssuª
(
pCache
)

37823 
PCache1
 *
pOthî
;

37824 
pPage
 = 
pGroup
->
pLruTaû
;

37825 
	`pˇche1RemoveFromHash
(
pPage
);

37826 
	`pˇche1PöPage
(
pPage
);

37827 
pOthî
 = 
pPage
->
pCache
;

37831 
	`as£π
–(
pCache
->
szPage
 & (pCache->szPage-1))==0 &&ÖCache->szPage>=512 );

37832 
	`as£π
–
pCache
->
szExåa
<512 );

37833 
	`as£π
–(
pOthî
->
szPage
 & (pOther->szPage-1))==0 &&ÖOther->szPage>=512 );

37834 
	`as£π
–
pOthî
->
szExåa
<512 );

37836 if–
pOthî
->
szPage
+pOthî->
szExåa
 !
pCache
->szPage+pCache->szExtra ){

37837 
	`pˇche1FªePage
(
pPage
);

37838 
pPage
 = 0;

37840 
pGroup
->
nCuºítPage
 -(
pOthî
->
bPurgóbÀ
 - 
pCache
->bPurgeable);

37847 if–!
pPage
 ){

37848 if–
¸óãFœg
==1 ) 
	`sqlôe3BegöBíignMÆloc
();

37849 
pPage
 = 
	`pˇche1AŒocPage
(
pCache
);

37850 if–
¸óãFœg
==1 ) 
	`sqlôe3EndBíignMÆloc
();

37853 if–
pPage
 ){

37854 
h
 = 
iKey
 % 
pCache
->
nHash
;

37855 
pCache
->
nPage
++;

37856 
pPage
->
iKey
 = iKey;

37857 
pPage
->
pNext
 = 
pCache
->
≠Hash
[
h
];

37858 
pPage
->
pCache
 =ÖCache;

37859 
pPage
->
pLruPªv
 = 0;

37860 
pPage
->
pLruNext
 = 0;

37861 *(**)
pPage
->
∑ge
.
pExåa
 = 0;

37862 
pCache
->
≠Hash
[
h
] = 
pPage
;

37865 
„tch_out
:

37866 if–
pPage
 && 
iKey
>
pCache
->
iMaxKey
 ){

37867 
pCache
->
iMaxKey
 = 
iKey
;

37869 
	`pˇche1LóveMuãx
(
pGroup
);

37870  &
pPage
->
∑ge
;

37879 
	`pˇche1U≈ö
(

37880 
sqlôe3_pˇche
 *
p
,

37881 
sqlôe3_pˇche_∑ge
 *
pPg
,

37882 
ªu£U∆ikñy


37884 
PCache1
 *
pCache
 = (PCache1 *)
p
;

37885 
PgHdr1
 *
pPage
 = (PgHdr1 *)
pPg
;

37886 
PGroup
 *
pGroup
 = 
pCache
->pGroup;

37888 
	`as£π
–
pPage
->
pCache
==pCache );

37889 
	`pˇche1E¡îMuãx
(
pGroup
);

37894 
	`as£π
–
pPage
->
pLruPªv
==0 &&ÖPage->
pLruNext
==0 );

37895 
	`as£π
–
pGroup
->
pLruHód
!=
pPage
 &&ÖGroup->
pLruTaû
!=pPage );

37897 if–
ªu£U∆ikñy
 || 
pGroup
->
nCuºítPage
>pGroup->
nMaxPage
 ){

37898 
	`pˇche1RemoveFromHash
(
pPage
);

37899 
	`pˇche1FªePage
(
pPage
);

37902 if–
pGroup
->
pLruHód
 ){

37903 
pGroup
->
pLruHód
->
pLruPªv
 = 
pPage
;

37904 
pPage
->
pLruNext
 = 
pGroup
->
pLruHód
;

37905 
pGroup
->
pLruHód
 = 
pPage
;

37907 
pGroup
->
pLruTaû
 = 
pPage
;

37908 
pGroup
->
pLruHód
 = 
pPage
;

37910 
pCache
->
nRecy˛abÀ
++;

37913 
	`pˇche1LóveMuãx
(
pCache
->
pGroup
);

37919 
	`pˇche1Rekey
(

37920 
sqlôe3_pˇche
 *
p
,

37921 
sqlôe3_pˇche_∑ge
 *
pPg
,

37922 
iOld
,

37923 
iNew


37925 
PCache1
 *
pCache
 = (PCache1 *)
p
;

37926 
PgHdr1
 *
pPage
 = (PgHdr1 *)
pPg
;

37927 
PgHdr1
 **
µ
;

37928 
h
;

37929 
	`as£π
–
pPage
->
iKey
==
iOld
 );

37930 
	`as£π
–
pPage
->
pCache
==pCache );

37932 
	`pˇche1E¡îMuãx
(
pCache
->
pGroup
);

37934 
h
 = 
iOld
%
pCache
->
nHash
;

37935 
µ
 = &
pCache
->
≠Hash
[
h
];

37936  (*
µ
)!=
pPage
 ){

37937 
µ
 = &(*µ)->
pNext
;

37939 *
µ
 = 
pPage
->
pNext
;

37941 
h
 = 
iNew
%
pCache
->
nHash
;

37942 
pPage
->
iKey
 = 
iNew
;

37943 
pPage
->
pNext
 = 
pCache
->
≠Hash
[
h
];

37944 
pCache
->
≠Hash
[
h
] = 
pPage
;

37945 if–
iNew
>
pCache
->
iMaxKey
 ){

37946 
pCache
->
iMaxKey
 = 
iNew
;

37949 
	`pˇche1LóveMuãx
(
pCache
->
pGroup
);

37959 
	`pˇche1Trunˇã
(
sqlôe3_pˇche
 *
p
, 
iLimô
){

37960 
PCache1
 *
pCache
 = (PCache1 *)
p
;

37961 
	`pˇche1E¡îMuãx
(
pCache
->
pGroup
);

37962 if–
iLimô
<=
pCache
->
iMaxKey
 ){

37963 
	`pˇche1TrunˇãUnß„
(
pCache
, 
iLimô
);

37964 
pCache
->
iMaxKey
 = 
iLimô
-1;

37966 
	`pˇche1LóveMuãx
(
pCache
->
pGroup
);

37974 
	`pˇche1De°roy
(
sqlôe3_pˇche
 *
p
){

37975 
PCache1
 *
pCache
 = (PCache1 *)
p
;

37976 
PGroup
 *
pGroup
 = 
pCache
->pGroup;

37977 
	`as£π
–
pCache
->
bPurgóbÀ
 || (pCache->
nMax
==0 &&ÖCache->
nMö
==0) );

37978 
	`pˇche1E¡îMuãx
(
pGroup
);

37979 
	`pˇche1TrunˇãUnß„
(
pCache
, 0);

37980 
	`as£π
–
pGroup
->
nMaxPage
 >
pCache
->
nMax
 );

37981 
pGroup
->
nMaxPage
 -
pCache
->
nMax
;

37982 
	`as£π
–
pGroup
->
nMöPage
 >
pCache
->
nMö
 );

37983 
pGroup
->
nMöPage
 -
pCache
->
nMö
;

37984 
pGroup
->
mxPö√d
 =ÖGroup->
nMaxPage
 + 10 -ÖGroup->
nMöPage
;

37985 
	`pˇche1Enf‹˚MaxPage
(
pGroup
);

37986 
	`pˇche1LóveMuãx
(
pGroup
);

37987 
	`sqlôe3_‰ì
(
pCache
->
≠Hash
);

37988 
	`sqlôe3_‰ì
(
pCache
);

37996 
SQLITE_PRIVATE
 
	`sqlôe3PCacheSëDeÁu…
(){

37997 c⁄° 
sqlôe3_pˇche_mëhods2
 
deÁu…Mëhods
 = {

38000 
pˇche1Inô
,

38001 
pˇche1Shutdown
,

38002 
pˇche1Cª©e
,

38003 
pˇche1Cachesize
,

38004 
pˇche1Pagecou¡
,

38005 
pˇche1Fëch
,

38006 
pˇche1U≈ö
,

38007 
pˇche1Rekey
,

38008 
pˇche1Trunˇã
,

38009 
pˇche1De°roy
,

38010 
pˇche1Shrök


38012 
	`sqlôe3_c⁄fig
(
SQLITE_CONFIG_PCACHE2
, &
deÁu…Mëhods
);

38015 #ifde‡
SQLITE_ENABLE_MEMORY_MANAGEMENT


38025 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheRñó£Mem‹y
(
nReq
){

38026 
nFªe
 = 0;

38027 
	`as£π
–
	`sqlôe3_muãx_nŸhñd
(
pˇche1
.
gΩ
.
muãx
) );

38028 
	`as£π
–
	`sqlôe3_muãx_nŸhñd
(
pˇche1
.
muãx
) );

38029 if–
pˇche1
.
pSèπ
==0 ){

38030 
PgHdr1
 *
p
;

38031 
	`pˇche1E¡îMuãx
(&
pˇche1
.
gΩ
);

38032  (
nReq
<0 || 
nFªe
<nReqË&& ((
p
=
pˇche1
.
gΩ
.
pLruTaû
)!=0) ){

38033 
nFªe
 +
	`pˇche1MemSize
(
p
->
∑ge
.
pBuf
);

38034 #ifde‡
SQLITE_PCACHE_SEPARATE_HEADER


38035 
nFªe
 +
	`sqlôe3MemSize
(
p
);

38037 
	`pˇche1PöPage
(
p
);

38038 
	`pˇche1RemoveFromHash
(
p
);

38039 
	`pˇche1FªePage
(
p
);

38041 
	`pˇche1LóveMuãx
(&
pˇche1
.
gΩ
);

38043  
nFªe
;

38047 #ifde‡
SQLITE_TEST


38052 
SQLITE_PRIVATE
 
	`sqlôe3PˇcheSèts
(

38053 *
≤Cuºít
,

38054 *
≤Max
,

38055 *
≤Mö
,

38056 *
≤Recy˛abÀ


38058 
PgHdr1
 *
p
;

38059 
nRecy˛abÀ
 = 0;

38060 
p
=
pˇche1
.
gΩ
.
pLruHód
;Ö;Öı->
pLruNext
){

38061 
nRecy˛abÀ
++;

38063 *
≤Cuºít
 = 
pˇche1
.
gΩ
.
nCuºítPage
;

38064 *
≤Max
 = ()
pˇche1
.
gΩ
.
nMaxPage
;

38065 *
≤Mö
 = ()
pˇche1
.
gΩ
.
nMöPage
;

38066 *
≤Recy˛abÀ
 = 
nRecy˛abÀ
;

38139 
	#ROWSET_ALLOCATION_SIZE
 1024

	)

38144 
	#ROWSET_ENTRY_PER_CHUNK
 \

38145 ((
ROWSET_ALLOCATION_SIZE
-8)/(
RowSëE¡ry
))

	)

38155 
	sRowSëE¡ry
 {

38156 
i64
 
v
;

38157 
RowSëE¡ry
 *
pRight
;

38158 
RowSëE¡ry
 *
pLe·
;

38167 
	sRowSëChunk
 {

38168 
RowSëChunk
 *
pNextChunk
;

38169 
RowSëE¡ry
 
aE¡ry
[
ROWSET_ENTRY_PER_CHUNK
];

38177 
	sRowSë
 {

38178 
RowSëChunk
 *
pChunk
;

38179 
sqlôe3
 *
db
;

38180 
RowSëE¡ry
 *
pE¡ry
;

38181 
RowSëE¡ry
 *
pLa°
;

38182 
RowSëE¡ry
 *
pFªsh
;

38183 
RowSëE¡ry
 *
pF‹e°
;

38184 
u16
 
nFªsh
;

38185 
u8
 
rsFœgs
;

38186 
u8
 
iB©ch
;

38192 
	#ROWSET_SORTED
 0x01

	)

38193 
	#ROWSET_NEXT
 0x02

	)

38207 
SQLITE_PRIVATE
 
RowSë
 *
	`sqlôe3RowSëInô
(
sqlôe3
 *
db
, *
pS∑˚
, 
N
){

38208 
RowSë
 *
p
;

38209 
	`as£π
–
N
 >
	`ROUND8
((*
p
)) );

38210 
p
 = 
pS∑˚
;

38211 
p
->
pChunk
 = 0;

38212 
p
->
db
 = db;

38213 
p
->
pE¡ry
 = 0;

38214 
p
->
pLa°
 = 0;

38215 
p
->
pF‹e°
 = 0;

38216 
p
->
pFªsh
 = (
RowSëE¡ry
*)(
	`ROUND8
((*p)) + (*)p);

38217 
p
->
nFªsh
 = (
u16
)((
N
 - 
	`ROUND8
((*p)))/(
RowSëE¡ry
));

38218 
p
->
rsFœgs
 = 
ROWSET_SORTED
;

38219 
p
->
iB©ch
 = 0;

38220  
p
;

38228 
SQLITE_PRIVATE
 
	`sqlôe3RowSëCÀ¨
(
RowSë
 *
p
){

38229 
RowSëChunk
 *
pChunk
, *
pNextChunk
;

38230 
pChunk
=
p
->pChunk;ÖChunk;ÖChunk = 
pNextChunk
){

38231 
pNextChunk
 = 
pChunk
->pNextChunk;

38232 
	`sqlôe3DbFªe
(
p
->
db
, 
pChunk
);

38234 
p
->
pChunk
 = 0;

38235 
p
->
nFªsh
 = 0;

38236 
p
->
pE¡ry
 = 0;

38237 
p
->
pLa°
 = 0;

38238 
p
->
pF‹e°
 = 0;

38239 
p
->
rsFœgs
 = 
ROWSET_SORTED
;

38250 
RowSëE¡ry
 *
	`rowSëE¡ryAŒoc
(
RowSë
 *
p
){

38251 
	`as£π
–
p
!=0 );

38252 if–
p
->
nFªsh
==0 ){

38253 
RowSëChunk
 *
pNew
;

38254 
pNew
 = 
	`sqlôe3DbMÆlocRaw
(
p
->
db
, (*pNew));

38255 if–
pNew
==0 ){

38258 
pNew
->
pNextChunk
 = 
p
->
pChunk
;

38259 
p
->
pChunk
 = 
pNew
;

38260 
p
->
pFªsh
 = 
pNew
->
aE¡ry
;

38261 
p
->
nFªsh
 = 
ROWSET_ENTRY_PER_CHUNK
;

38263 
p
->
nFªsh
--;

38264  
p
->
pFªsh
++;

38273 
SQLITE_PRIVATE
 
	`sqlôe3RowSëIn£π
(
RowSë
 *
p
, 
i64
 
rowid
){

38274 
RowSëE¡ry
 *
pE¡ry
;

38275 
RowSëE¡ry
 *
pLa°
;

38278 
	`as£π
–
p
!=0 && (p->
rsFœgs
 & 
ROWSET_NEXT
)==0 );

38280 
pE¡ry
 = 
	`rowSëE¡ryAŒoc
(
p
);

38281 if–
pE¡ry
==0 ) ;

38282 
pE¡ry
->
v
 = 
rowid
;

38283 
pE¡ry
->
pRight
 = 0;

38284 
pLa°
 = 
p
->pLast;

38285 if–
pLa°
 ){

38286 if–(
p
->
rsFœgs
 & 
ROWSET_SORTED
)!=0 && 
rowid
<=
pLa°
->
v
 ){

38287 
p
->
rsFœgs
 &~
ROWSET_SORTED
;

38289 
pLa°
->
pRight
 = 
pE¡ry
;

38291 
p
->
pE¡ry
 =ÖEntry;

38293 
p
->
pLa°
 = 
pE¡ry
;

38302 
RowSëE¡ry
 *
	`rowSëE¡ryMîge
(

38303 
RowSëE¡ry
 *
pA
,

38304 
RowSëE¡ry
 *
pB


38306 
RowSëE¡ry
 
hód
;

38307 
RowSëE¡ry
 *
pTaû
;

38309 
pTaû
 = &
hód
;

38310  
pA
 && 
pB
 ){

38311 
	`as£π
–
pA
->
pRight
==0 ||ÖA->
v
<=pA->pRight->v );

38312 
	`as£π
–
pB
->
pRight
==0 ||ÖB->
v
<=pB->pRight->v );

38313 if–
pA
->
v
<
pB
->v ){

38314 
pTaû
->
pRight
 = 
pA
;

38315 
pA
 =ÖA->
pRight
;

38316 
pTaû
 =ÖTaû->
pRight
;

38317 }if–
pB
->
v
<
pA
->v ){

38318 
pTaû
->
pRight
 = 
pB
;

38319 
pB
 =ÖB->
pRight
;

38320 
pTaû
 =ÖTaû->
pRight
;

38322 
pA
 =ÖA->
pRight
;

38325 if–
pA
 ){

38326 
	`as£π
–
pA
->
pRight
==0 ||ÖA->
v
<=pA->pRight->v );

38327 
pTaû
->
pRight
 = 
pA
;

38329 
	`as£π
–
pB
==0 ||ÖB->
pRight
==0 ||ÖB->
v
<=pB->pRight->v );

38330 
pTaû
->
pRight
 = 
pB
;

38332  
hód
.
pRight
;

38339 
RowSëE¡ry
 *
	`rowSëE¡ryS‹t
(RowSëE¡ry *
pIn
){

38340 
i
;

38341 
RowSëE¡ry
 *
pNext
, *
aBuckë
[40];

38343 
	`mem£t
(
aBuckë
, 0, (aBucket));

38344  
pIn
 ){

38345 
pNext
 = 
pIn
->
pRight
;

38346 
pIn
->
pRight
 = 0;

38347 
i
=0; 
aBuckë
[i]; i++){

38348 
pIn
 = 
	`rowSëE¡ryMîge
(
aBuckë
[
i
],ÖIn);

38349 
aBuckë
[
i
] = 0;

38351 
aBuckë
[
i
] = 
pIn
;

38352 
pIn
 = 
pNext
;

38354 
pIn
 = 0;

38355 
i
=0; i<(
aBuckë
)/(aBucket[0]); i++){

38356 
pIn
 = 
	`rowSëE¡ryMîge
’In, 
aBuckë
[
i
]);

38358  
pIn
;

38367 
	`rowSëTªeToLi°
(

38368 
RowSëE¡ry
 *
pIn
,

38369 
RowSëE¡ry
 **
µFú°
,

38370 
RowSëE¡ry
 **
µLa°


38372 
	`as£π
–
pIn
!=0 );

38373 if–
pIn
->
pLe·
 ){

38374 
RowSëE¡ry
 *
p
;

38375 
	`rowSëTªeToLi°
(
pIn
->
pLe·
, 
µFú°
, &
p
);

38376 
p
->
pRight
 = 
pIn
;

38378 *
µFú°
 = 
pIn
;

38380 if–
pIn
->
pRight
 ){

38381 
	`rowSëTªeToLi°
(
pIn
->
pRight
, &pIn->pRight, 
µLa°
);

38383 *
µLa°
 = 
pIn
;

38385 
	`as£π
–(*
µLa°
)->
pRight
==0 );

38402 
RowSëE¡ry
 *
	`rowSëNDìpTªe
(

38403 
RowSëE¡ry
 **
µLi°
,

38404 
iDïth


38406 
RowSëE¡ry
 *
p
;

38407 
RowSëE¡ry
 *
pLe·
;

38408 if–*
µLi°
==0 ){

38411 if–
iDïth
==1 ){

38412 
p
 = *
µLi°
;

38413 *
µLi°
 = 
p
->
pRight
;

38414 
p
->
pLe·
 =Ö->
pRight
 = 0;

38415  
p
;

38417 
pLe·
 = 
	`rowSëNDìpTªe
(
µLi°
, 
iDïth
-1);

38418 
p
 = *
µLi°
;

38419 if–
p
==0 ){

38420  
pLe·
;

38422 
p
->
pLe·
 =ÖLeft;

38423 *
µLi°
 = 
p
->
pRight
;

38424 
p
->
pRight
 = 
	`rowSëNDìpTªe
(
µLi°
, 
iDïth
-1);

38425  
p
;

38432 
RowSëE¡ry
 *
	`rowSëLi°ToTªe
(RowSëE¡ry *
pLi°
){

38433 
iDïth
;

38434 
RowSëE¡ry
 *
p
;

38435 
RowSëE¡ry
 *
pLe·
;

38437 
	`as£π
–
pLi°
!=0 );

38438 
p
 = 
pLi°
;

38439 
pLi°
 = 
p
->
pRight
;

38440 
p
->
pLe·
 =Ö->
pRight
 = 0;

38441 
iDïth
=1; 
pLi°
; iDepth++){

38442 
pLe·
 = 
p
;

38443 
p
 = 
pLi°
;

38444 
pLi°
 = 
p
->
pRight
;

38445 
p
->
pLe·
 =ÖLeft;

38446 
p
->
pRight
 = 
	`rowSëNDìpTªe
(&
pLi°
, 
iDïth
);

38448  
p
;

38457 
	`rowSëToLi°
(
RowSë
 *
p
){

38460 
	`as£π
–
p
!=0 && (p->
rsFœgs
 & 
ROWSET_NEXT
)==0 );

38462 if–(
p
->
rsFœgs
 & 
ROWSET_SORTED
)==0 ){

38463 
p
->
pE¡ry
 = 
	`rowSëE¡ryS‹t
(p->pEntry);

38470 
	`as£π
–
p
->
pF‹e°
==0 );

38472  
p
->
pF‹e°
 ){

38473 
RowSëE¡ry
 *
pTªe
 = 
p
->
pF‹e°
->
pLe·
;

38474 if–
pTªe
 ){

38475 
RowSëE¡ry
 *
pHód
, *
pTaû
;

38476 
	`rowSëTªeToLi°
(
pTªe
, &
pHód
, &
pTaû
);

38477 
p
->
pE¡ry
 = 
	`rowSëE¡ryMîge
’->pE¡ry, 
pHód
);

38479 
p
->
pF‹e°
 =Ö->pF‹e°->
pRight
;

38482 
p
->
rsFœgs
 |
ROWSET_NEXT
;

38493 
SQLITE_PRIVATE
 
	`sqlôe3RowSëNext
(
RowSë
 *
p
, 
i64
 *
pRowid
){

38494 
	`as£π
–
p
!=0 );

38497 if–(
p
->
rsFœgs
 & 
ROWSET_NEXT
)==0 ) 
	`rowSëToLi°
(p);

38500 if–
p
->
pE¡ry
 ){

38501 *
pRowid
 = 
p
->
pE¡ry
->
v
;

38502 
p
->
pE¡ry
 =Ö->pE¡ry->
pRight
;

38503 if–
p
->
pE¡ry
==0 ){

38504 
	`sqlôe3RowSëCÀ¨
(
p
);

38520 
SQLITE_PRIVATE
 
	`sqlôe3RowSëTe°
(
RowSë
 *
pRowSë
, 
u8
 
iB©ch
, 
sqlôe3_öt64
 
iRowid
){

38521 
RowSëE¡ry
 *
p
, *
pTªe
;

38524 
	`as£π
–
pRowSë
!=0 && (pRowSë->
rsFœgs
 & 
ROWSET_NEXT
)==0 );

38528 if–
iB©ch
!=
pRowSë
->iBatch ){

38529 
p
 = 
pRowSë
->
pE¡ry
;

38530 if–
p
 ){

38531 
RowSëE¡ry
 **
µPªvTªe
 = &
pRowSë
->
pF‹e°
;

38532 if–(
pRowSë
->
rsFœgs
 & 
ROWSET_SORTED
)==0 ){

38533 
p
 = 
	`rowSëE¡ryS‹t
(p);

38535 
pTªe
 = 
pRowSë
->
pF‹e°
;ÖTªe;ÖTªeıTªe->
pRight
){

38536 
µPªvTªe
 = &
pTªe
->
pRight
;

38537 if–
pTªe
->
pLe·
==0 ){

38538 
pTªe
->
pLe·
 = 
	`rowSëLi°ToTªe
(
p
);

38541 
RowSëE¡ry
 *
pAux
, *
pTaû
;

38542 
	`rowSëTªeToLi°
(
pTªe
->
pLe·
, &
pAux
, &
pTaû
);

38543 
pTªe
->
pLe·
 = 0;

38544 
p
 = 
	`rowSëE¡ryMîge
(
pAux
,Ö);

38547 if–
pTªe
==0 ){

38548 *
µPªvTªe
 = 
pTªe
 = 
	`rowSëE¡ryAŒoc
(
pRowSë
);

38549 if–
pTªe
 ){

38550 
pTªe
->
v
 = 0;

38551 
pTªe
->
pRight
 = 0;

38552 
pTªe
->
pLe·
 = 
	`rowSëLi°ToTªe
(
p
);

38555 
pRowSë
->
pE¡ry
 = 0;

38556 
pRowSë
->
pLa°
 = 0;

38557 
pRowSë
->
rsFœgs
 |
ROWSET_SORTED
;

38559 
pRowSë
->
iB©ch
 = iBatch;

38565 
pTªe
 = 
pRowSë
->
pF‹e°
;ÖTªe;ÖTªeıTªe->
pRight
){

38566 
p
 = 
pTªe
->
pLe·
;

38567  
p
 ){

38568 if–
p
->
v
<
iRowid
 ){

38569 
p
 =Ö->
pRight
;

38570 }if–
p
->
v
>
iRowid
 ){

38571 
p
 =Ö->
pLe·
;

38602 #i‚de‡
SQLITE_OMIT_DISKIO


38621 #i‚de‡
_WAL_H_


38622 
	#_WAL_H_


	)

38628 
	#WAL_SYNC_TRANSACTIONS
 0x20

	)

38629 
	#SQLITE_SYNC_MASK
 0x13

	)

38631 #ifde‡
SQLITE_OMIT_WAL


38632 
	#sqlôe3WÆO≥n
(
x
,
y
,
z
Ë0

	)

38633 
	#sqlôe3WÆLimô
(
x
,
y
)

	)

38634 
	#sqlôe3WÆClo£
(
w
,
x
,
y
,
z
Ë0

	)

38635 
	#sqlôe3WÆBegöRódTønß˘i⁄
(
y
,
z
Ë0

	)

38636 
	#sqlôe3WÆEndRódTønß˘i⁄
(
z
)

	)

38637 
	#sqlôe3WÆDbsize
(
y
Ë0

	)

38638 
	#sqlôe3WÆBegöWrôeTønß˘i⁄
(
y
Ë0

	)

38639 
	#sqlôe3WÆEndWrôeTønß˘i⁄
(
x
Ë0

	)

38640 
	#sqlôe3WÆUndo
(
x
,
y
,
z
Ë0

	)

38641 
	#sqlôe3WÆSavïoöt
(
y
,
z
)

	)

38642 
	#sqlôe3WÆSavïoötUndo
(
y
,
z
Ë0

	)

38643 
	#sqlôe3WÆFømes
(
u
,
v
,
w
,
x
,
y
,
z
Ë0

	)

38644 
	#sqlôe3WÆCheckpoöt
(
r
,
s
,
t
,
u
,
v
,
w
,
x
,
y
,
z
Ë0

	)

38645 
	#sqlôe3WÆCÆlback
(
z
Ë0

	)

38646 
	#sqlôe3WÆEx˛usiveMode
(
y
,
z
Ë0

	)

38647 
	#sqlôe3WÆHópMem‹y
(
z
Ë0

	)

38648 
	#sqlôe3WÆFømesize
(
z
Ë0

	)

38649 
	#sqlôe3WÆFödFøme
(
x
,
y
,
z
Ë0

	)

38652 
	#WAL_SAVEPOINT_NDATA
 4

	)

38657 
WÆ
 
	tWÆ
;

38660 
SQLITE_PRIVATE
 
	`sqlôe3WÆO≥n
(
sqlôe3_vfs
*, 
sqlôe3_fûe
*, c⁄° *, , 
i64
, 
WÆ
**);

38661 
SQLITE_PRIVATE
 
	`sqlôe3WÆClo£
(
WÆ
 *
pWÆ
, 
sync_Êags
, , 
u8
 *);

38664 
SQLITE_PRIVATE
 
	`sqlôe3WÆLimô
(
WÆ
*, 
i64
);

38673 
SQLITE_PRIVATE
 
	`sqlôe3WÆBegöRódTønß˘i⁄
(
WÆ
 *
pWÆ
, *);

38674 
SQLITE_PRIVATE
 
	`sqlôe3WÆEndRódTønß˘i⁄
(
WÆ
 *
pWÆ
);

38677 
SQLITE_PRIVATE
 
	`sqlôe3WÆFödFøme
(
WÆ
 *, 
Pgno
, 
u32
 *);

38678 
SQLITE_PRIVATE
 
	`sqlôe3WÆRódFøme
(
WÆ
 *, 
u32
, , 
u8
 *);

38681 
SQLITE_PRIVATE
 
Pgno
 
	`sqlôe3WÆDbsize
(
WÆ
 *
pWÆ
);

38684 
SQLITE_PRIVATE
 
	`sqlôe3WÆBegöWrôeTønß˘i⁄
(
WÆ
 *
pWÆ
);

38685 
SQLITE_PRIVATE
 
	`sqlôe3WÆEndWrôeTønß˘i⁄
(
WÆ
 *
pWÆ
);

38688 
SQLITE_PRIVATE
 
	`sqlôe3WÆUndo
(
WÆ
 *
pWÆ
, (*
xUndo
)(*, 
Pgno
), *
pUndoCtx
);

38692 
SQLITE_PRIVATE
 
	`sqlôe3WÆSavïoöt
(
WÆ
 *
pWÆ
, 
u32
 *
aWÆD©a
);

38696 
SQLITE_PRIVATE
 
	`sqlôe3WÆSavïoötUndo
(
WÆ
 *
pWÆ
, 
u32
 *
aWÆD©a
);

38699 
SQLITE_PRIVATE
 
	`sqlôe3WÆFømes
(
WÆ
 *
pWÆ
, , 
PgHdr
 *, 
Pgno
, , );

38702 
SQLITE_PRIVATE
 
	`sqlôe3WÆCheckpoöt
(

38703 
WÆ
 *
pWÆ
,

38704 
eMode
,

38705 (*
xBusy
)(*),

38706 *
pBusyArg
,

38707 
sync_Êags
,

38708 
nBuf
,

38709 
u8
 *
zBuf
,

38710 *
≤Log
,

38711 *
≤Ck±


38719 
SQLITE_PRIVATE
 
	`sqlôe3WÆCÆlback
(
WÆ
 *
pWÆ
);

38724 
SQLITE_PRIVATE
 
	`sqlôe3WÆEx˛usiveMode
(
WÆ
 *
pWÆ
, 
›
);

38730 
SQLITE_PRIVATE
 
	`sqlôe3WÆHópMem‹y
(
WÆ
 *
pWÆ
);

38732 #ifde‡
SQLITE_ENABLE_ZIPVFS


38736 
SQLITE_PRIVATE
 
	`sqlôe3WÆFømesize
(
WÆ
 *
pWÆ
);

38836 
sqlôe3PagîTø˚
=1;

38837 
	#sqlôe3DebugPrötf
 
¥ötf


	)

38838 
	#PAGERTRACE
(
X
Ëif–
sqlôe3PagîTø˚
 ){ 
sqlôe3DebugPrötf
 X; }

	)

38840 
	#PAGERTRACE
(
X
)

	)

38851 
	#PAGERID
(
p
Ë(()’->
fd
))

	)

38852 
	#FILEHANDLEID
(
fd
Ë(()fd)

	)

39071 
	#PAGER_OPEN
 0

	)

39072 
	#PAGER_READER
 1

	)

39073 
	#PAGER_WRITER_LOCKED
 2

	)

39074 
	#PAGER_WRITER_CACHEMOD
 3

	)

39075 
	#PAGER_WRITER_DBMOD
 4

	)

39076 
	#PAGER_WRITER_FINISHED
 5

	)

39077 
	#PAGER_ERROR
 6

	)

39127 
	#UNKNOWN_LOCK
 (
EXCLUSIVE_LOCK
+1)

	)

39132 #ifde‡
SQLITE_HAS_CODEC


39133 
	#CODEC1
(
P
,
D
,
N
,
X
,
E
) \

39134 if–
P
->
xCodec
 && P->
	`xCodec
(P->
pCodec
,
D
,
N
,
X
)==0 ){ 
E
; }

	)

39135 
	#CODEC2
(
P
,
D
,
N
,
X
,
E
,
O
) \

39136 if–
P
->
xCodec
==0 ){ 
O
=(*)
D
; }\

39137 if–(
O
=(*)(
P
->
	`xCodec
(P->
pCodec
,
D
,
N
,
X
)))==0 ){ 
E
; }

	)

39139 
	#CODEC1
(
P
,
D
,
N
,
X
,
E
Ë

	)

39140 
	#CODEC2
(
P
,
D
,
N
,
X
,
E
,
O
ËO=(*)
	)
D

39149 
	#MAX_SECTOR_SIZE
 0x10000

	)

39164 
PagîSavïoöt
 
	tPagîSavïoöt
;

39165 
	sPagîSavïoöt
 {

39166 
i64
 
iOff£t
;

39167 
i64
 
iHdrOff£t
;

39168 
Bôvec
 *
pInSavïoöt
;

39169 
Pgno
 
nOrig
;

39170 
Pgno
 
iSubRec
;

39171 #i‚de‡
SQLITE_OMIT_WAL


39172 
u32
 
aWÆD©a
[
WAL_SAVEPOINT_NDATA
];

39179 
	#SPILLFLAG_OFF
 0x01

	)

39180 
	#SPILLFLAG_ROLLBACK
 0x02

	)

39181 
	#SPILLFLAG_NOSYNC
 0x04

	)

39339 
	sPagî
 {

39340 
sqlôe3_vfs
 *
pVfs
;

39341 
u8
 
ex˛usiveMode
;

39342 
u8
 
jou∫ÆMode
;

39343 
u8
 
u£Jou∫Æ
;

39344 
u8
 
noSync
;

39345 
u8
 
fuŒSync
;

39346 
u8
 
ck±SyncFœgs
;

39347 
u8
 
wÆSyncFœgs
;

39348 
u8
 
syncFœgs
;

39349 
u8
 
ãmpFûe
;

39350 
u8
 
ªadO∆y
;

39351 
u8
 
memDb
;

39362 
u8
 
eSèã
;

39363 
u8
 
eLock
;

39364 
u8
 
ch™geCou¡D⁄e
;

39365 
u8
 
£tMa°î
;

39366 
u8
 
doNŸSpûl
;

39367 
u8
 
subjInMem‹y
;

39368 
Pgno
 
dbSize
;

39369 
Pgno
 
dbOrigSize
;

39370 
Pgno
 
dbFûeSize
;

39371 
Pgno
 
dbHötSize
;

39372 
îrCode
;

39373 
nRec
;

39374 
u32
 
cksumInô
;

39375 
u32
 
nSubRec
;

39376 
Bôvec
 *
pInJou∫Æ
;

39377 
sqlôe3_fûe
 *
fd
;

39378 
sqlôe3_fûe
 *
jfd
;

39379 
sqlôe3_fûe
 *
sjfd
;

39380 
i64
 
jou∫ÆOff
;

39381 
i64
 
jou∫ÆHdr
;

39382 
sqlôe3_backup
 *
pBackup
;

39383 
PagîSavïoöt
 *
aSavïoöt
;

39384 
nSavïoöt
;

39385 
dbFûeVîs
[16];

39387 
u8
 
bU£Fëch
;

39388 
nMm≠Out
;

39389 
sqlôe3_öt64
 
szMm≠
;

39390 
PgHdr
 *
pMm≠Fªñi°
;

39395 
u16
 
nExåa
;

39396 
i16
 
nRe£rve
;

39397 
u32
 
vfsFœgs
;

39398 
u32
 
£˘‹Size
;

39399 
∑geSize
;

39400 
Pgno
 
mxPgno
;

39401 
i64
 
jou∫ÆSizeLimô
;

39402 *
zFûíame
;

39403 *
zJou∫Æ
;

39404 (*
xBusyH™dÀr
)(*);

39405 *
pBusyH™dÀrArg
;

39406 
aSèt
[3];

39407 #ifde‡
SQLITE_TEST


39408 
nRód
;

39410 (*
xReöôî
)(
DbPage
*);

39411 #ifde‡
SQLITE_HAS_CODEC


39412 *(*
xCodec
)(*,*,
Pgno
,);

39413 (*
xCodecSizeChng
)(*,,);

39414 (*
xCodecFªe
)(*);

39415 *
pCodec
;

39417 *
pTmpS∑˚
;

39418 
PCache
 *
pPCache
;

39419 #i‚de‡
SQLITE_OMIT_WAL


39420 
WÆ
 *
pWÆ
;

39421 *
zWÆ
;

39430 
	#PAGER_STAT_HIT
 0

	)

39431 
	#PAGER_STAT_MISS
 1

	)

39432 
	#PAGER_STAT_WRITE
 2

	)

39439 #ifde‡
SQLITE_TEST


39440 
SQLITE_API
 
sqlôe3_∑gî_ªaddb_cou¡
 = 0;

39441 
SQLITE_API
 
sqlôe3_∑gî_wrôedb_cou¡
 = 0;

39442 
SQLITE_API
 
sqlôe3_∑gî_wrôej_cou¡
 = 0;

39443 
	#PAGER_INCR
(
v
Ëv++

	)

39445 
	#PAGER_INCR
(
v
)

	)

39473 c⁄° 
aJou∫ÆMagic
[] = {

39481 
	#JOURNAL_PG_SZ
(
pPagî
Ë(’Pagî->
∑geSize
Ë+ 8)

	)

39487 
	#JOURNAL_HDR_SZ
(
pPagî
Ë’Pagî->
£˘‹Size
)

	)

39495 #ifde‡
SQLITE_OMIT_MEMORYDB


39496 
	#MEMDB
 0

	)

39498 
	#MEMDB
 
pPagî
->
memDb


	)

39505 #i‡
SQLITE_MAX_MMAP_SIZE
>0

39506 
	#USEFETCH
(
x
Ë((x)->
bU£Fëch
)

	)

39508 
	#USEFETCH
(
x
Ë0

	)

39514 
	#PAGER_MAX_PGNO
 2147483647

	)

39528 
	#isO≥n
(
pFd
Ë(’Fd)->
pMëhods
)

	)

39534 #i‚de‡
SQLITE_OMIT_WAL


39535 
	`∑gîU£WÆ
(
Pagî
 *
pPagî
){

39536  (
pPagî
->
pWÆ
!=0);

39539 
	#∑gîU£WÆ
(
x
Ë0

	)

39540 
	#∑gîRﬁlbackWÆ
(
x
Ë0

	)

39541 
	#∑gîWÆFømes
(
v
,
w
,
x
,
y
Ë0

	)

39542 
	#∑gîO≥nWÆIfPª£¡
(
z
Ë
SQLITE_OK


	)

39543 
	#∑gîBegöRódTønß˘i⁄
(
z
Ë
SQLITE_OK


	)

39546 #i‚de‡
NDEBUG


39555 
	`as£π_∑gî_°©e
(
Pagî
 *
p
){

39556 
Pagî
 *
pPagî
 = 
p
;

39559 
	`as£π
–
p
->
eSèã
==
PAGER_OPEN


39560 || 
p
->
eSèã
==
PAGER_READER


39561 || 
p
->
eSèã
==
PAGER_WRITER_LOCKED


39562 || 
p
->
eSèã
==
PAGER_WRITER_CACHEMOD


39563 || 
p
->
eSèã
==
PAGER_WRITER_DBMOD


39564 || 
p
->
eSèã
==
PAGER_WRITER_FINISHED


39565 || 
p
->
eSèã
==
PAGER_ERROR


39572 
	`as£π
–
p
->
ãmpFûe
==0 ||Ö->
eLock
==
EXCLUSIVE_LOCK
 );

39573 
	`as£π
–
p
->
ãmpFûe
==0 || 
pPagî
->
ch™geCou¡D⁄e
 );

39578 
	`as£π
–
p
->
jou∫ÆMode
==
PAGER_JOURNALMODE_OFF
 ||Ö->
u£Jou∫Æ
 );

39579 
	`as£π
–
p
->
jou∫ÆMode
!=
PAGER_JOURNALMODE_OFF
 || !
	`isO≥n
’->
jfd
) );

39589 if–
MEMDB
 ){

39590 
	`as£π
–
p
->
noSync
 );

39591 
	`as£π
–
p
->
jou∫ÆMode
==
PAGER_JOURNALMODE_OFF


39592 || 
p
->
jou∫ÆMode
==
PAGER_JOURNALMODE_MEMORY


39594 
	`as£π
–
p
->
eSèã
!=
PAGER_ERROR
 &&Ö->eSèã!=
PAGER_OPEN
 );

39595 
	`as£π
–
	`∑gîU£WÆ
(
p
)==0 );

39601 
	`as£π
–
pPagî
->
ch™geCou¡D⁄e
==0 ||ÖPagî->
eLock
>=
RESERVED_LOCK
 );

39602 
	`as£π
–
p
->
eLock
!=
PENDING_LOCK
 );

39604  
p
->
eSèã
 ){

39605 
PAGER_OPEN
:

39606 
	`as£π
–!
MEMDB
 );

39607 
	`as£π
–
pPagî
->
îrCode
==
SQLITE_OK
 );

39608 
	`as£π
–
	`sqlôe3PˇcheRefCou¡
(
pPagî
->
pPCache
)==0 ||ÖPagî->
ãmpFûe
 );

39611 
PAGER_READER
:

39612 
	`as£π
–
pPagî
->
îrCode
==
SQLITE_OK
 );

39613 
	`as£π
–
p
->
eLock
!=
UNKNOWN_LOCK
 );

39614 
	`as£π
–
p
->
eLock
>=
SHARED_LOCK
 );

39617 
PAGER_WRITER_LOCKED
:

39618 
	`as£π
–
p
->
eLock
!=
UNKNOWN_LOCK
 );

39619 
	`as£π
–
pPagî
->
îrCode
==
SQLITE_OK
 );

39620 if–!
	`∑gîU£WÆ
(
pPagî
) ){

39621 
	`as£π
–
p
->
eLock
>=
RESERVED_LOCK
 );

39623 
	`as£π
–
pPagî
->
dbSize
=ıPagî->
dbOrigSize
 );

39624 
	`as£π
–
pPagî
->
dbOrigSize
=ıPagî->
dbFûeSize
 );

39625 
	`as£π
–
pPagî
->
dbOrigSize
=ıPagî->
dbHötSize
 );

39626 
	`as£π
–
pPagî
->
£tMa°î
==0 );

39629 
PAGER_WRITER_CACHEMOD
:

39630 
	`as£π
–
p
->
eLock
!=
UNKNOWN_LOCK
 );

39631 
	`as£π
–
pPagî
->
îrCode
==
SQLITE_OK
 );

39632 if–!
	`∑gîU£WÆ
(
pPagî
) ){

39638 
	`as£π
–
p
->
eLock
>=
RESERVED_LOCK
 );

39639 
	`as£π
–
	`isO≥n
(
p
->
jfd
)

39640 || 
p
->
jou∫ÆMode
==
PAGER_JOURNALMODE_OFF


39641 || 
p
->
jou∫ÆMode
==
PAGER_JOURNALMODE_WAL


39644 
	`as£π
–
pPagî
->
dbOrigSize
=ıPagî->
dbFûeSize
 );

39645 
	`as£π
–
pPagî
->
dbOrigSize
=ıPagî->
dbHötSize
 );

39648 
PAGER_WRITER_DBMOD
:

39649 
	`as£π
–
p
->
eLock
==
EXCLUSIVE_LOCK
 );

39650 
	`as£π
–
pPagî
->
îrCode
==
SQLITE_OK
 );

39651 
	`as£π
–!
	`∑gîU£WÆ
(
pPagî
) );

39652 
	`as£π
–
p
->
eLock
>=
EXCLUSIVE_LOCK
 );

39653 
	`as£π
–
	`isO≥n
(
p
->
jfd
)

39654 || 
p
->
jou∫ÆMode
==
PAGER_JOURNALMODE_OFF


39655 || 
p
->
jou∫ÆMode
==
PAGER_JOURNALMODE_WAL


39657 
	`as£π
–
pPagî
->
dbOrigSize
<ıPagî->
dbHötSize
 );

39660 
PAGER_WRITER_FINISHED
:

39661 
	`as£π
–
p
->
eLock
==
EXCLUSIVE_LOCK
 );

39662 
	`as£π
–
pPagî
->
îrCode
==
SQLITE_OK
 );

39663 
	`as£π
–!
	`∑gîU£WÆ
(
pPagî
) );

39664 
	`as£π
–
	`isO≥n
(
p
->
jfd
)

39665 || 
p
->
jou∫ÆMode
==
PAGER_JOURNALMODE_OFF


39666 || 
p
->
jou∫ÆMode
==
PAGER_JOURNALMODE_WAL


39670 
PAGER_ERROR
:

39675 
	`as£π
–
pPagî
->
îrCode
!=
SQLITE_OK
 );

39676 
	`as£π
–
	`sqlôe3PˇcheRefCou¡
(
pPagî
->
pPCache
)>0 );

39684 #ifde‡
SQLITE_DEBUG


39693 *
	`¥öt_∑gî_°©e
(
Pagî
 *
p
){

39694 
zRë
[1024];

39696 
	`sqlôe3_¢¥ötf
(1024, 
zRë
,

39705 , 
p
->
zFûíame


39706 , 
p
->
eSèã
==
PAGER_OPEN
 ? "OPEN" :

39707 
p
->
eSèã
==
PAGER_READER
 ? "READER" :

39708 
p
->
eSèã
==
PAGER_WRITER_LOCKED
 ? "WRITER_LOCKED" :

39709 
p
->
eSèã
==
PAGER_WRITER_CACHEMOD
 ? "WRITER_CACHEMOD" :

39710 
p
->
eSèã
==
PAGER_WRITER_DBMOD
 ? "WRITER_DBMOD" :

39711 
p
->
eSèã
==
PAGER_WRITER_FINISHED
 ? "WRITER_FINISHED" :

39712 
p
->
eSèã
==
PAGER_ERROR
 ? "ERROR" : "?error?"

39713 , ()
p
->
îrCode


39714 , 
p
->
eLock
==
NO_LOCK
 ? "NO_LOCK" :

39715 
p
->
eLock
==
RESERVED_LOCK
 ? "RESERVED" :

39716 
p
->
eLock
==
EXCLUSIVE_LOCK
 ? "EXCLUSIVE" :

39717 
p
->
eLock
==
SHARED_LOCK
 ? "SHARED" :

39718 
p
->
eLock
==
UNKNOWN_LOCK
 ? "UNKNOWN" : "?error?"

39719 , 
p
->
ex˛usiveMode
 ? "exclusive" : "normal"

39720 , 
p
->
jou∫ÆMode
==
PAGER_JOURNALMODE_MEMORY
 ? "memory" :

39721 
p
->
jou∫ÆMode
==
PAGER_JOURNALMODE_OFF
 ? "off" :

39722 
p
->
jou∫ÆMode
==
PAGER_JOURNALMODE_DELETE
 ? "delete" :

39723 
p
->
jou∫ÆMode
==
PAGER_JOURNALMODE_PERSIST
 ? "persist" :

39724 
p
->
jou∫ÆMode
==
PAGER_JOURNALMODE_TRUNCATE
 ? "truncate" :

39725 
p
->
jou∫ÆMode
==
PAGER_JOURNALMODE_WAL
 ? "wal" : "?error?"

39726 , ()
p
->
ãmpFûe
, (Ì->
memDb
, (Ì->
u£Jou∫Æ


39727 , 
p
->
jou∫ÆOff
,Ö->
jou∫ÆHdr


39728 , ()
p
->
dbSize
, (Ì->
dbOrigSize
, (Ì->
dbFûeSize


39731  
zRë
;

39744 
	`subjRequúesPage
(
PgHdr
 *
pPg
){

39745 
Pagî
 *
pPagî
 = 
pPg
->pPager;

39746 
PagîSavïoöt
 *
p
;

39747 
Pgno
 
pgno
;

39748 
i
;

39749 if–
pPagî
->
nSavïoöt
 ){

39750 
pgno
 = 
pPg
->pgno;

39751 
i
=0; i<
pPagî
->
nSavïoöt
; i++){

39752 
p
 = &
pPagî
->
aSavïoöt
[
i
];

39753 if–
p
->
nOrig
>=
pgno
 && 0==
	`sqlôe3BôvecTe°
’->
pInSavïoöt
,Ögno) ){

39764 
	`∑geInJou∫Æ
(
PgHdr
 *
pPg
){

39765  
	`sqlôe3BôvecTe°
(
pPg
->
pPagî
->
pInJou∫Æ
,ÖPg->
pgno
);

39775 
	`ªad32bôs
(
sqlôe3_fûe
 *
fd
, 
i64
 
off£t
, 
u32
 *
pRes
){

39776 
ac
[4];

39777 
rc
 = 
	`sqlôe3OsRód
(
fd
, 
ac
, ◊c), 
off£t
);

39778 if–
rc
==
SQLITE_OK
 ){

39779 *
pRes
 = 
	`sqlôe3Gë4byã
(
ac
);

39781  
rc
;

39787 
	#put32bôs
(
A
,
B
Ë
	`sqlôe3Put4byã
((
u8
*)A,B)

	)

39794 
	`wrôe32bôs
(
sqlôe3_fûe
 *
fd
, 
i64
 
off£t
, 
u32
 
vÆ
){

39795 
ac
[4];

39796 
	`put32bôs
(
ac
, 
vÆ
);

39797  
	`sqlôe3OsWrôe
(
fd
, 
ac
, 4, 
off£t
);

39809 
	`∑gîU∆ockDb
(
Pagî
 *
pPagî
, 
eLock
){

39810 
rc
 = 
SQLITE_OK
;

39812 
	`as£π
–!
pPagî
->
ex˛usiveMode
 ||ÖPagî->
eLock
==eLock );

39813 
	`as£π
–
eLock
==
NO_LOCK
 ||ÉLock==
SHARED_LOCK
 );

39814 
	`as£π
–
eLock
!=
NO_LOCK
 || 
	`∑gîU£WÆ
(
pPagî
)==0 );

39815 if–
	`isO≥n
(
pPagî
->
fd
) ){

39816 
	`as£π
–
pPagî
->
eLock
>=eLock );

39817 
rc
 = 
	`sqlôe3OsU∆ock
(
pPagî
->
fd
, 
eLock
);

39818 if–
pPagî
->
eLock
!=
UNKNOWN_LOCK
 ){

39819 
pPagî
->
eLock
 = (
u8
)eLock;

39821 
	`IOTRACE
(("UNLOCK %∞%d\n", 
pPagî
, 
eLock
))

39823  
rc
;

39836 
	`∑gîLockDb
(
Pagî
 *
pPagî
, 
eLock
){

39837 
rc
 = 
SQLITE_OK
;

39839 
	`as£π
–
eLock
==
SHARED_LOCK
 ||ÉLock==
RESERVED_LOCK
 ||ÉLock==
EXCLUSIVE_LOCK
 );

39840 if–
pPagî
->
eLock
<eLock ||ÖPagî->eLock==
UNKNOWN_LOCK
 ){

39841 
rc
 = 
	`sqlôe3OsLock
(
pPagî
->
fd
, 
eLock
);

39842 if–
rc
==
SQLITE_OK
 && (
pPagî
->
eLock
!=
UNKNOWN_LOCK
||eLock==
EXCLUSIVE_LOCK
) ){

39843 
pPagî
->
eLock
 = (
u8
)eLock;

39844 
	`IOTRACE
(("LOCK %∞%d\n", 
pPagî
, 
eLock
))

39847  
rc
;

39867 #ifde‡
SQLITE_ENABLE_ATOMIC_WRITE


39868 
	`j∫lBuf„rSize
(
Pagî
 *
pPagî
){

39869 
	`as£π
–!
MEMDB
 );

39870 if–!
pPagî
->
ãmpFûe
 ){

39871 
dc
;

39872 
nSe˘‹
;

39873 
szPage
;

39875 
	`as£π
–
	`isO≥n
(
pPagî
->
fd
) );

39876 
dc
 = 
	`sqlôe3OsDevi˚Ch¨a˘îi°ics
(
pPagî
->
fd
);

39877 
nSe˘‹
 = 
pPagî
->
£˘‹Size
;

39878 
szPage
 = 
pPagî
->
∑geSize
;

39880 
	`as£π
(
SQLITE_IOCAP_ATOMIC512
==(512>>8));

39881 
	`as£π
(
SQLITE_IOCAP_ATOMIC64K
==(65536>>8));

39882 if–0==(
dc
&(
SQLITE_IOCAP_ATOMIC
|(
szPage
>>8)Ë|| 
nSe˘‹
>szPage) ){

39887  
	`JOURNAL_HDR_SZ
(
pPagî
Ë+ 
	`JOURNAL_PG_SZ
(pPager);

39896 #ifde‡
SQLITE_CHECK_PAGES


39900 
u32
 
	`∑gî_d©ahash
(
nByã
, *
pD©a
){

39901 
u32
 
hash
 = 0;

39902 
i
;

39903 
i
=0; i<
nByã
; i++){

39904 
hash
 = (hash*1039Ë+ 
pD©a
[
i
];

39906  
hash
;

39908 
u32
 
	`∑gî_∑gehash
(
PgHdr
 *
pPage
){

39909  
	`∑gî_d©ahash
(
pPage
->
pPagî
->
∑geSize
, (*ÌPage->
pD©a
);

39911 
	`∑gî_£t_∑gehash
(
PgHdr
 *
pPage
){

39912 
pPage
->
∑geHash
 = 
	`∑gî_∑gehash
(pPage);

39920 
	#CHECK_PAGE
(
x
Ë
	`checkPage
(x)

	)

39921 
	`checkPage
(
PgHdr
 *
pPg
){

39922 
Pagî
 *
pPagî
 = 
pPg
->pPager;

39923 
	`as£π
–
pPagî
->
eSèã
!=
PAGER_ERROR
 );

39924 
	`as£π
–(
pPg
->
Êags
&
PGHDR_DIRTY
Ë||ÖPg->
∑geHash
==
	`∑gî_∑gehash
(pPg) );

39928 
	#∑gî_d©ahash
(
X
,
Y
Ë0

	)

39929 
	#∑gî_∑gehash
(
X
Ë0

	)

39930 
	#∑gî_£t_∑gehash
(
X
)

	)

39931 
	#CHECK_PAGE
(
x
)

	)

39959 
	`ªadMa°îJou∫Æ
(
sqlôe3_fûe
 *
pJ∫l
, *
zMa°î
, 
u32
 
nMa°î
){

39960 
rc
;

39961 
u32
 
Àn
;

39962 
i64
 
szJ
;

39963 
u32
 
cksum
;

39964 
u32
 
u
;

39965 
aMagic
[8];

39966 
zMa°î
[0] = '\0';

39968 if–
SQLITE_OK
!=(
rc
 = 
	`sqlôe3OsFûeSize
(
pJ∫l
, &
szJ
))

39969 || 
szJ
<16

39970 || 
SQLITE_OK
!=(
rc
 = 
	`ªad32bôs
(
pJ∫l
, 
szJ
-16, &
Àn
))

39971 || 
Àn
>=
nMa°î


39972 || 
SQLITE_OK
!=(
rc
 = 
	`ªad32bôs
(
pJ∫l
, 
szJ
-12, &
cksum
))

39973 || 
SQLITE_OK
!=(
rc
 = 
	`sqlôe3OsRód
(
pJ∫l
, 
aMagic
, 8, 
szJ
-8))

39974 || 
	`memcmp
(
aMagic
, 
aJou∫ÆMagic
, 8)

39975 || 
SQLITE_OK
!=(
rc
 = 
	`sqlôe3OsRód
(
pJ∫l
, 
zMa°î
, 
Àn
, 
szJ
-16-len))

39977  
rc
;

39981 
u
=0; u<
Àn
; u++){

39982 
cksum
 -
zMa°î
[
u
];

39984 if–
cksum
 ){

39990 
Àn
 = 0;

39992 
zMa°î
[
Àn
] = '\0';

39994  
SQLITE_OK
;

40012 
i64
 
	`jou∫ÆHdrOff£t
(
Pagî
 *
pPagî
){

40013 
i64
 
off£t
 = 0;

40014 
i64
 
c
 = 
pPagî
->
jou∫ÆOff
;

40015 if–
c
 ){

40016 
off£t
 = ((
c
-1)/
	`JOURNAL_HDR_SZ
(
pPagî
) + 1) * JOURNAL_HDR_SZ(pPager);

40018 
	`as£π
–
off£t
%
	`JOURNAL_HDR_SZ
(
pPagî
)==0 );

40019 
	`as£π
–
off£t
>=
c
 );

40020 
	`as£π
–(
off£t
-
c
)<
	`JOURNAL_HDR_SZ
(
pPagî
) );

40021  
off£t
;

40045 
	`zîoJou∫ÆHdr
(
Pagî
 *
pPagî
, 
doTrunˇã
){

40046 
rc
 = 
SQLITE_OK
;

40047 
	`as£π
–
	`isO≥n
(
pPagî
->
jfd
) );

40048 if–
pPagî
->
jou∫ÆOff
 ){

40049 c⁄° 
i64
 
iLimô
 = 
pPagî
->
jou∫ÆSizeLimô
;

40051 
	`IOTRACE
(("JZEROHDR %p\n", 
pPagî
))

40052 if–
doTrunˇã
 || 
iLimô
==0 ){

40053 
rc
 = 
	`sqlôe3OsTrunˇã
(
pPagî
->
jfd
, 0);

40055 c⁄° 
zîoHdr
[28] = {0};

40056 
rc
 = 
	`sqlôe3OsWrôe
(
pPagî
->
jfd
, 
zîoHdr
, (zeroHdr), 0);

40058 if–
rc
==
SQLITE_OK
 && !
pPagî
->
noSync
 ){

40059 
rc
 = 
	`sqlôe3OsSync
(
pPagî
->
jfd
, 
SQLITE_SYNC_DATAONLY
|pPagî->
syncFœgs
);

40068 if–
rc
==
SQLITE_OK
 && 
iLimô
>0 ){

40069 
i64
 
sz
;

40070 
rc
 = 
	`sqlôe3OsFûeSize
(
pPagî
->
jfd
, &
sz
);

40071 if–
rc
==
SQLITE_OK
 && 
sz
>
iLimô
 ){

40072 
rc
 = 
	`sqlôe3OsTrunˇã
(
pPagî
->
jfd
, 
iLimô
);

40076  
rc
;

40094 
	`wrôeJou∫ÆHdr
(
Pagî
 *
pPagî
){

40095 
rc
 = 
SQLITE_OK
;

40096 *
zHódî
 = 
pPagî
->
pTmpS∑˚
;

40097 
u32
 
nHódî
 = (u32)
pPagî
->
∑geSize
;

40098 
u32
 
nWrôe
;

40099 
ii
;

40101 
	`as£π
–
	`isO≥n
(
pPagî
->
jfd
) );

40103 if–
nHódî
>
	`JOURNAL_HDR_SZ
(
pPagî
) ){

40104 
nHódî
 = 
	`JOURNAL_HDR_SZ
(
pPagî
);

40111 
ii
=0; ii<
pPagî
->
nSavïoöt
; ii++){

40112 if–
pPagî
->
aSavïoöt
[
ii
].
iHdrOff£t
==0 ){

40113 
pPagî
->
aSavïoöt
[
ii
].
iHdrOff£t
 =ÖPagî->
jou∫ÆOff
;

40117 
pPagî
->
jou∫ÆHdr
 =ÖPagî->
jou∫ÆOff
 = 
	`jou∫ÆHdrOff£t
(pPager);

40139 
	`as£π
–
	`isO≥n
(
pPagî
->
fd
Ë||ÖPagî->
noSync
 );

40140 if–
pPagî
->
noSync
 || (pPagî->
jou∫ÆMode
==
PAGER_JOURNALMODE_MEMORY
)

40141 || (
	`sqlôe3OsDevi˚Ch¨a˘îi°ics
(
pPagî
->
fd
)&
SQLITE_IOCAP_SAFE_APPEND
)

40143 
	`mem˝y
(
zHódî
, 
aJou∫ÆMagic
, (aJournalMagic));

40144 
	`put32bôs
(&
zHódî
[(
aJou∫ÆMagic
)], 0xffffffff);

40146 
	`mem£t
(
zHódî
, 0, (
aJou∫ÆMagic
)+4);

40150 
	`sqlôe3_øndom√ss
((
pPagî
->
cksumInô
), &pPager->cksumInit);

40151 
	`put32bôs
(&
zHódî
[(
aJou∫ÆMagic
)+4], 
pPagî
->
cksumInô
);

40153 
	`put32bôs
(&
zHódî
[(
aJou∫ÆMagic
)+8], 
pPagî
->
dbOrigSize
);

40155 
	`put32bôs
(&
zHódî
[(
aJou∫ÆMagic
)+12], 
pPagî
->
£˘‹Size
);

40158 
	`put32bôs
(&
zHódî
[(
aJou∫ÆMagic
)+16], 
pPagî
->
∑geSize
);

40165 
	`mem£t
(&
zHódî
[(
aJou∫ÆMagic
)+20], 0,

40166 
nHódî
-((
aJou∫ÆMagic
)+20));

40185 
nWrôe
=0; 
rc
==
SQLITE_OK
&&nWrôe<
	`JOURNAL_HDR_SZ
(
pPagî
);ÇWrôe+=
nHódî
){

40186 
	`IOTRACE
(("JHDR %∞%Œd %d\n", 
pPagî
,ÖPagî->
jou∫ÆHdr
, 
nHódî
))

40187 
rc
 = 
	`sqlôe3OsWrôe
(
pPagî
->
jfd
, 
zHódî
, 
nHódî
,ÖPagî->
jou∫ÆOff
);

40188 
	`as£π
–
pPagî
->
jou∫ÆHdr
 <pPagî->
jou∫ÆOff
 );

40189 
pPagî
->
jou∫ÆOff
 +
nHódî
;

40192  
rc
;

40212 
	`ªadJou∫ÆHdr
(

40213 
Pagî
 *
pPagî
,

40214 
isHŸ
,

40215 
i64
 
jou∫ÆSize
,

40216 
u32
 *
pNRec
,

40217 
u32
 *
pDbSize


40219 
rc
;

40220 
aMagic
[8];

40221 
i64
 
iHdrOff
;

40223 
	`as£π
–
	`isO≥n
(
pPagî
->
jfd
) );

40229 
pPagî
->
jou∫ÆOff
 = 
	`jou∫ÆHdrOff£t
(pPager);

40230 if–
pPagî
->
jou∫ÆOff
+
	`JOURNAL_HDR_SZ
’PagîË> 
jou∫ÆSize
 ){

40231  
SQLITE_DONE
;

40233 
iHdrOff
 = 
pPagî
->
jou∫ÆOff
;

40240 if–
isHŸ
 || 
iHdrOff
!=
pPagî
->
jou∫ÆHdr
 ){

40241 
rc
 = 
	`sqlôe3OsRód
(
pPagî
->
jfd
, 
aMagic
, ◊Magic), 
iHdrOff
);

40242 if–
rc
 ){

40243  
rc
;

40245 if–
	`memcmp
(
aMagic
, 
aJou∫ÆMagic
, (aMagic))!=0 ){

40246  
SQLITE_DONE
;

40254 if–
SQLITE_OK
!=(
rc
 = 
	`ªad32bôs
(
pPagî
->
jfd
, 
iHdrOff
+8, 
pNRec
))

40255 || 
SQLITE_OK
!=(
rc
 = 
	`ªad32bôs
(
pPagî
->
jfd
, 
iHdrOff
+12, &pPagî->
cksumInô
))

40256 || 
SQLITE_OK
!=(
rc
 = 
	`ªad32bôs
(
pPagî
->
jfd
, 
iHdrOff
+16, 
pDbSize
))

40258  
rc
;

40261 if–
pPagî
->
jou∫ÆOff
==0 ){

40262 
u32
 
iPageSize
;

40263 
u32
 
iSe˘‹Size
;

40266 if–
SQLITE_OK
!=(
rc
 = 
	`ªad32bôs
(
pPagî
->
jfd
, 
iHdrOff
+20, &
iSe˘‹Size
))

40267 || 
SQLITE_OK
!=(
rc
 = 
	`ªad32bôs
(
pPagî
->
jfd
, 
iHdrOff
+24, &
iPageSize
))

40269  
rc
;

40276 if–
iPageSize
==0 ){

40277 
iPageSize
 = 
pPagî
->
∑geSize
;

40285 if–
iPageSize
<512 || 
iSe˘‹Size
<32

40286 || 
iPageSize
>
SQLITE_MAX_PAGE_SIZE
 || 
iSe˘‹Size
>
MAX_SECTOR_SIZE


40287 || ((
iPageSize
-1)&iPageSize)!=0 || ((
iSe˘‹Size
-1)&iSectorSize)!=0

40294  
SQLITE_DONE
;

40301 
rc
 = 
	`sqlôe3PagîSëPagesize
(
pPagî
, &
iPageSize
, -1);

40302 
	`ã°ˇ£
–
rc
!=
SQLITE_OK
 );

40310 
pPagî
->
£˘‹Size
 = 
iSe˘‹Size
;

40313 
pPagî
->
jou∫ÆOff
 +
	`JOURNAL_HDR_SZ
(pPager);

40314  
rc
;

40337 
	`wrôeMa°îJou∫Æ
(
Pagî
 *
pPagî
, c⁄° *
zMa°î
){

40338 
rc
;

40339 
nMa°î
;

40340 
i64
 
iHdrOff
;

40341 
i64
 
j∫lSize
;

40342 
u32
 
cksum
 = 0;

40344 
	`as£π
–
pPagî
->
£tMa°î
==0 );

40345 
	`as£π
–!
	`∑gîU£WÆ
(
pPagî
) );

40347 if–!
zMa°î


40348 || 
pPagî
->
jou∫ÆMode
==
PAGER_JOURNALMODE_MEMORY


40349 || 
pPagî
->
jou∫ÆMode
==
PAGER_JOURNALMODE_OFF


40351  
SQLITE_OK
;

40353 
pPagî
->
£tMa°î
 = 1;

40354 
	`as£π
–
	`isO≥n
(
pPagî
->
jfd
) );

40355 
	`as£π
–
pPagî
->
jou∫ÆHdr
 <pPagî->
jou∫ÆOff
 );

40358 
nMa°î
=0; 
zMa°î
[nMaster];ÇMaster++){

40359 
cksum
 +
zMa°î
[
nMa°î
];

40366 if–
pPagî
->
fuŒSync
 ){

40367 
pPagî
->
jou∫ÆOff
 = 
	`jou∫ÆHdrOff£t
(pPager);

40369 
iHdrOff
 = 
pPagî
->
jou∫ÆOff
;

40374 if–(0 !(
rc
 = 
	`wrôe32bôs
(
pPagî
->
jfd
, 
iHdrOff
, 
	`PAGER_MJ_PGNO
(pPager))))

40375 || (0 !(
rc
 = 
	`sqlôe3OsWrôe
(
pPagî
->
jfd
, 
zMa°î
, 
nMa°î
, 
iHdrOff
+4)))

40376 || (0 !(
rc
 = 
	`wrôe32bôs
(
pPagî
->
jfd
, 
iHdrOff
+4+
nMa°î
,ÇMaster)))

40377 || (0 !(
rc
 = 
	`wrôe32bôs
(
pPagî
->
jfd
, 
iHdrOff
+4+
nMa°î
+4, 
cksum
)))

40378 || (0 !(
rc
 = 
	`sqlôe3OsWrôe
(
pPagî
->
jfd
, 
aJou∫ÆMagic
, 8, 
iHdrOff
+4+
nMa°î
+8)))

40380  
rc
;

40382 
pPagî
->
jou∫ÆOff
 +(
nMa°î
+20);

40394 if–
SQLITE_OK
==(
rc
 = 
	`sqlôe3OsFûeSize
(
pPagî
->
jfd
, &
j∫lSize
))

40395 && 
j∫lSize
>
pPagî
->
jou∫ÆOff


40397 
rc
 = 
	`sqlôe3OsTrunˇã
(
pPagî
->
jfd
,ÖPagî->
jou∫ÆOff
);

40399  
rc
;

40407 
PgHdr
 *
	`∑gî_lookup
(
Pagî
 *
pPagî
, 
Pgno
 
pgno
){

40408 
PgHdr
 *
p
;

40413 ()
	`sqlôe3PˇcheFëch
(
pPagî
->
pPCache
, 
pgno
, 0, &
p
);

40414  
p
;

40420 
	`∑gî_ª£t
(
Pagî
 *
pPagî
){

40421 
	`sqlôe3BackupRe°¨t
(
pPagî
->
pBackup
);

40422 
	`sqlôe3PˇcheCÀ¨
(
pPagî
->
pPCache
);

40430 
	`ªÀa£AŒSavïoöts
(
Pagî
 *
pPagî
){

40431 
ii
;

40432 
ii
=0; ii<
pPagî
->
nSavïoöt
; ii++){

40433 
	`sqlôe3BôvecDe°roy
(
pPagî
->
aSavïoöt
[
ii
].
pInSavïoöt
);

40435 if–!
pPagî
->
ex˛usiveMode
 || 
	`sqlôe3IsMemJou∫Æ
’Pagî->
sjfd
) ){

40436 
	`sqlôe3OsClo£
(
pPagî
->
sjfd
);

40438 
	`sqlôe3_‰ì
(
pPagî
->
aSavïoöt
);

40439 
pPagî
->
aSavïoöt
 = 0;

40440 
pPagî
->
nSavïoöt
 = 0;

40441 
pPagî
->
nSubRec
 = 0;

40449 
	`addToSavïoötBôvecs
(
Pagî
 *
pPagî
, 
Pgno
 
pgno
){

40450 
ii
;

40451 
rc
 = 
SQLITE_OK
;

40453 
ii
=0; ii<
pPagî
->
nSavïoöt
; ii++){

40454 
PagîSavïoöt
 *
p
 = &
pPagî
->
aSavïoöt
[
ii
];

40455 if–
pgno
<=
p
->
nOrig
 ){

40456 
rc
 |
	`sqlôe3BôvecSë
(
p
->
pInSavïoöt
, 
pgno
);

40457 
	`ã°ˇ£
–
rc
==
SQLITE_NOMEM
 );

40458 
	`as£π
–
rc
==
SQLITE_OK
 ||Ñc==
SQLITE_NOMEM
 );

40461  
rc
;

40481 
	`∑gî_u∆ock
(
Pagî
 *
pPagî
){

40483 
	`as£π
–
pPagî
->
eSèã
==
PAGER_READER


40484 || 
pPagî
->
eSèã
==
PAGER_OPEN


40485 || 
pPagî
->
eSèã
==
PAGER_ERROR


40488 
	`sqlôe3BôvecDe°roy
(
pPagî
->
pInJou∫Æ
);

40489 
pPagî
->
pInJou∫Æ
 = 0;

40490 
	`ªÀa£AŒSavïoöts
(
pPagî
);

40492 if–
	`∑gîU£WÆ
(
pPagî
) ){

40493 
	`as£π
–!
	`isO≥n
(
pPagî
->
jfd
) );

40494 
	`sqlôe3WÆEndRódTønß˘i⁄
(
pPagî
->
pWÆ
);

40495 
pPagî
->
eSèã
 = 
PAGER_OPEN
;

40496 }if–!
pPagî
->
ex˛usiveMode
 ){

40497 
rc
;

40498 
iDc
 = 
	`isO≥n
(
pPagî
->
fd
)?
	`sqlôe3OsDevi˚Ch¨a˘îi°ics
(pPager->fd):0;

40505 
	`as£π
–(
PAGER_JOURNALMODE_MEMORY
 & 5)!=1 );

40506 
	`as£π
–(
PAGER_JOURNALMODE_OFF
 & 5)!=1 );

40507 
	`as£π
–(
PAGER_JOURNALMODE_WAL
 & 5)!=1 );

40508 
	`as£π
–(
PAGER_JOURNALMODE_DELETE
 & 5)!=1 );

40509 
	`as£π
–(
PAGER_JOURNALMODE_TRUNCATE
 & 5)==1 );

40510 
	`as£π
–(
PAGER_JOURNALMODE_PERSIST
 & 5)==1 );

40511 if–0==(
iDc
 & 
SQLITE_IOCAP_UNDELETABLE_WHEN_OPEN
)

40512 || 1!=(
pPagî
->
jou∫ÆMode
 & 5)

40514 
	`sqlôe3OsClo£
(
pPagî
->
jfd
);

40522 
rc
 = 
	`∑gîU∆ockDb
(
pPagî
, 
NO_LOCK
);

40523 if–
rc
!=
SQLITE_OK
 && 
pPagî
->
eSèã
==
PAGER_ERROR
 ){

40524 
pPagî
->
eLock
 = 
UNKNOWN_LOCK
;

40531 
	`as£π
–
pPagî
->
îrCode
 ||ÖPagî->
eSèã
!=
PAGER_ERROR
 );

40532 
pPagî
->
ch™geCou¡D⁄e
 = 0;

40533 
pPagî
->
eSèã
 = 
PAGER_OPEN
;

40541 if–
pPagî
->
îrCode
 ){

40542 
	`as£π
–!
MEMDB
 );

40543 
	`∑gî_ª£t
(
pPagî
);

40544 
pPagî
->
ch™geCou¡D⁄e
 =ÖPagî->
ãmpFûe
;

40545 
pPagî
->
eSèã
 = 
PAGER_OPEN
;

40546 
pPagî
->
îrCode
 = 
SQLITE_OK
;

40547 if–
	`USEFETCH
(
pPagî
ËË
	`sqlôe3OsUn„tch
’Pagî->
fd
, 0, 0);

40550 
pPagî
->
jou∫ÆOff
 = 0;

40551 
pPagî
->
jou∫ÆHdr
 = 0;

40552 
pPagî
->
£tMa°î
 = 0;

40574 
	`∑gî_îr‹
(
Pagî
 *
pPagî
, 
rc
){

40575 
rc2
 = 
rc
 & 0xff;

40576 
	`as£π
–
rc
==
SQLITE_OK
 || !
MEMDB
 );

40577 
	`as£π
(

40578 
pPagî
->
îrCode
==
SQLITE_FULL
 ||

40579 
pPagî
->
îrCode
==
SQLITE_OK
 ||

40580 (
pPagî
->
îrCode
 & 0xff)==
SQLITE_IOERR


40582 if–
rc2
==
SQLITE_FULL
 ||Ñc2==
SQLITE_IOERR
 ){

40583 
pPagî
->
îrCode
 = 
rc
;

40584 
pPagî
->
eSèã
 = 
PAGER_ERROR
;

40586  
rc
;

40589 
	`∑gî_åunˇã
(
Pagî
 *
pPagî
, 
Pgno
 
nPage
);

40644 
	`∑gî_íd_å™ß˘i⁄
(
Pagî
 *
pPagî
, 
hasMa°î
, 
bCommô
){

40645 
rc
 = 
SQLITE_OK
;

40646 
rc2
 = 
SQLITE_OK
;

40661 
	`as£π
–
	`as£π_∑gî_°©e
(
pPagî
) );

40662 
	`as£π
–
pPagî
->
eSèã
!=
PAGER_ERROR
 );

40663 if–
pPagî
->
eSèã
<
PAGER_WRITER_LOCKED
 &&ÖPagî->
eLock
<
RESERVED_LOCK
 ){

40664  
SQLITE_OK
;

40667 
	`ªÀa£AŒSavïoöts
(
pPagî
);

40668 
	`as£π
–
	`isO≥n
(
pPagî
->
jfd
Ë||ÖPagî->
pInJou∫Æ
==0 );

40669 if–
	`isO≥n
(
pPagî
->
jfd
) ){

40670 
	`as£π
–!
	`∑gîU£WÆ
(
pPagî
) );

40673 if–
	`sqlôe3IsMemJou∫Æ
(
pPagî
->
jfd
) ){

40674 
	`as£π
–
pPagî
->
jou∫ÆMode
==
PAGER_JOURNALMODE_MEMORY
 );

40675 
	`sqlôe3OsClo£
(
pPagî
->
jfd
);

40676 }if–
pPagî
->
jou∫ÆMode
==
PAGER_JOURNALMODE_TRUNCATE
 ){

40677 if–
pPagî
->
jou∫ÆOff
==0 ){

40678 
rc
 = 
SQLITE_OK
;

40680 
rc
 = 
	`sqlôe3OsTrunˇã
(
pPagî
->
jfd
, 0);

40682 
pPagî
->
jou∫ÆOff
 = 0;

40683 }if–
pPagî
->
jou∫ÆMode
==
PAGER_JOURNALMODE_PERSIST


40684 || (
pPagî
->
ex˛usiveMode
 &&ÖPagî->
jou∫ÆMode
!=
PAGER_JOURNALMODE_WAL
)

40686 
rc
 = 
	`zîoJou∫ÆHdr
(
pPagî
, 
hasMa°î
);

40687 
pPagî
->
jou∫ÆOff
 = 0;

40694 
bDñëe
 = (!
pPagî
->
ãmpFûe
 && 
	`sqlôe3Jou∫ÆExi°s
’Pagî->
jfd
));

40695 
	`as£π
–
pPagî
->
jou∫ÆMode
==
PAGER_JOURNALMODE_DELETE


40696 || 
pPagî
->
jou∫ÆMode
==
PAGER_JOURNALMODE_MEMORY


40697 || 
pPagî
->
jou∫ÆMode
==
PAGER_JOURNALMODE_WAL


40699 
	`sqlôe3OsClo£
(
pPagî
->
jfd
);

40700 if–
bDñëe
 ){

40701 
rc
 = 
	`sqlôe3OsDñëe
(
pPagî
->
pVfs
,ÖPagî->
zJou∫Æ
, 0);

40706 #ifde‡
SQLITE_CHECK_PAGES


40707 
	`sqlôe3PˇcheIãøãDúty
(
pPagî
->
pPCache
, 
∑gî_£t_∑gehash
);

40708 if–
pPagî
->
dbSize
==0 && 
	`sqlôe3PˇcheRefCou¡
’Pagî->
pPCache
)>0 ){

40709 
PgHdr
 *
p
 = 
	`∑gî_lookup
(
pPagî
, 1);

40710 if–
p
 ){

40711 
p
->
∑geHash
 = 0;

40712 
	`sqlôe3PagîUƒef
(
p
);

40717 
	`sqlôe3BôvecDe°roy
(
pPagî
->
pInJou∫Æ
);

40718 
pPagî
->
pInJou∫Æ
 = 0;

40719 
pPagî
->
nRec
 = 0;

40720 
	`sqlôe3PˇcheCÀ™AŒ
(
pPagî
->
pPCache
);

40721 
	`sqlôe3PˇcheTrunˇã
(
pPagî
->
pPCache
,ÖPagî->
dbSize
);

40723 if–
	`∑gîU£WÆ
(
pPagî
) ){

40728 
rc2
 = 
	`sqlôe3WÆEndWrôeTønß˘i⁄
(
pPagî
->
pWÆ
);

40729 
	`as£π
–
rc2
==
SQLITE_OK
 );

40730 }if–
rc
==
SQLITE_OK
 && 
bCommô
 && 
pPagî
->
dbFûeSize
>pPagî->
dbSize
 ){

40737 
	`as£π
–
pPagî
->
eLock
==
EXCLUSIVE_LOCK
 );

40738 
rc
 = 
	`∑gî_åunˇã
(
pPagî
,ÖPagî->
dbSize
);

40741 if–!
pPagî
->
ex˛usiveMode


40742 && (!
	`∑gîU£WÆ
(
pPagî
Ë|| 
	`sqlôe3WÆEx˛usiveMode
’Pagî->
pWÆ
, 0))

40744 
rc2
 = 
	`∑gîU∆ockDb
(
pPagî
, 
SHARED_LOCK
);

40745 
pPagî
->
ch™geCou¡D⁄e
 = 0;

40747 
pPagî
->
eSèã
 = 
PAGER_READER
;

40748 
pPagî
->
£tMa°î
 = 0;

40750  (
rc
==
SQLITE_OK
?
rc2
:rc);

40770 
	`∑gîU∆ockAndRﬁlback
(
Pagî
 *
pPagî
){

40771 if–
pPagî
->
eSèã
!=
PAGER_ERROR
 &&ÖPagî->eSèã!=
PAGER_OPEN
 ){

40772 
	`as£π
–
	`as£π_∑gî_°©e
(
pPagî
) );

40773 if–
pPagî
->
eSèã
>=
PAGER_WRITER_LOCKED
 ){

40774 
	`sqlôe3BegöBíignMÆloc
();

40775 
	`sqlôe3PagîRﬁlback
(
pPagî
);

40776 
	`sqlôe3EndBíignMÆloc
();

40777 }if–!
pPagî
->
ex˛usiveMode
 ){

40778 
	`as£π
–
pPagî
->
eSèã
==
PAGER_READER
 );

40779 
	`∑gî_íd_å™ß˘i⁄
(
pPagî
, 0, 0);

40782 
	`∑gî_u∆ock
(
pPagî
);

40804 
u32
 
	`∑gî_cksum
(
Pagî
 *
pPagî
, c⁄° 
u8
 *
aD©a
){

40805 
u32
 
cksum
 = 
pPagî
->
cksumInô
;

40806 
i
 = 
pPagî
->
∑geSize
-200;

40807  
i
>0 ){

40808 
cksum
 +
aD©a
[
i
];

40809 
i
 -= 200;

40811  
cksum
;

40818 #ifde‡
SQLITE_HAS_CODEC


40819 
	`∑gîRï‹tSize
(
Pagî
 *
pPagî
){

40820 if–
pPagî
->
xCodecSizeChng
 ){

40821 
pPagî
->
	`xCodecSizeChng
’Pagî->
pCodec
,ÖPagî->
∑geSize
,

40822 ()
pPagî
->
nRe£rve
);

40826 
	#∑gîRï‹tSize
(
X
Ë

	)

40866 
	`∑gî_∂ayback_⁄e_∑ge
(

40867 
Pagî
 *
pPagî
,

40868 
i64
 *
pOff£t
,

40869 
Bôvec
 *
pD⁄e
,

40870 
isMaöJ∫l
,

40871 
isSavï¡


40873 
rc
;

40874 
PgHdr
 *
pPg
;

40875 
Pgno
 
pgno
;

40876 
u32
 
cksum
;

40877 *
aD©a
;

40878 
sqlôe3_fûe
 *
jfd
;

40879 
isSyn˚d
;

40881 
	`as£π
–(
isMaöJ∫l
&~1)==0 );

40882 
	`as£π
–(
isSavï¡
&~1)==0 );

40883 
	`as£π
–
isMaöJ∫l
 || 
pD⁄e
 );

40884 
	`as£π
–
isSavï¡
 || 
pD⁄e
==0 );

40886 
aD©a
 = 
pPagî
->
pTmpS∑˚
;

40887 
	`as£π
–
aD©a
 );

40888 
	`as£π
–
	`∑gîU£WÆ
(
pPagî
)==0 || (!
isMaöJ∫l
 && 
isSavï¡
) );

40896 
	`as£π
–
pPagî
->
eSèã
>=
PAGER_WRITER_CACHEMOD


40897 || (
pPagî
->
eSèã
==
PAGER_OPEN
 &&ÖPagî->
eLock
==
EXCLUSIVE_LOCK
)

40899 
	`as£π
–
pPagî
->
eSèã
>=
PAGER_WRITER_CACHEMOD
 || 
isMaöJ∫l
 );

40904 
jfd
 = 
isMaöJ∫l
 ? 
pPagî
->jfd :ÖPagî->
sjfd
;

40905 
rc
 = 
	`ªad32bôs
(
jfd
, *
pOff£t
, &
pgno
);

40906 if–
rc
!=
SQLITE_OK
 ) Ñc;

40907 
rc
 = 
	`sqlôe3OsRód
(
jfd
, (
u8
*)
aD©a
, 
pPagî
->
∑geSize
, (*
pOff£t
)+4);

40908 if–
rc
!=
SQLITE_OK
 ) Ñc;

40909 *
pOff£t
 +
pPagî
->
∑geSize
 + 4 + 
isMaöJ∫l
*4;

40916 if–
pgno
==0 ||Ögno==
	`PAGER_MJ_PGNO
(
pPagî
) ){

40917 
	`as£π
–!
isSavï¡
 );

40918  
SQLITE_DONE
;

40920 if–
pgno
>(
Pgno
)
pPagî
->
dbSize
 || 
	`sqlôe3BôvecTe°
(
pD⁄e
,Ögno) ){

40921  
SQLITE_OK
;

40923 if–
isMaöJ∫l
 ){

40924 
rc
 = 
	`ªad32bôs
(
jfd
, (*
pOff£t
)-4, &
cksum
);

40925 if–
rc
 ) Ñc;

40926 if–!
isSavï¡
 && 
	`∑gî_cksum
(
pPagî
, (
u8
*)
aD©a
)!=
cksum
 ){

40927  
SQLITE_DONE
;

40934 if–
pD⁄e
 && (
rc
 = 
	`sqlôe3BôvecSë
’D⁄e, 
pgno
))!=
SQLITE_OK
 ){

40935  
rc
;

40940 if–
pgno
==1 && 
pPagî
->
nRe£rve
!=((
u8
*)
aD©a
)[20] ){

40941 
pPagî
->
nRe£rve
 = ((
u8
*)
aD©a
)[20];

40942 
	`∑gîRï‹tSize
(
pPagî
);

40980 if–
	`∑gîU£WÆ
(
pPagî
) ){

40981 
pPg
 = 0;

40983 
pPg
 = 
	`∑gî_lookup
(
pPagî
, 
pgno
);

40985 
	`as£π
–
pPg
 || !
MEMDB
 );

40986 
	`as£π
–
pPagî
->
eSèã
!=
PAGER_OPEN
 || 
pPg
==0 );

40987 
	`PAGERTRACE
(("PLAYBACK %dÖage %d hash(%08x) %s\n",

40988 
	`PAGERID
(
pPagî
), 
pgno
, 
	`∑gî_d©ahash
’Pagî->
∑geSize
, (
u8
*)
aD©a
),

40989 (
isMaöJ∫l
?"main-journal":"sub-journal")

40991 if–
isMaöJ∫l
 ){

40992 
isSyn˚d
 = 
pPagî
->
noSync
 || (*
pOff£t
 <pPagî->
jou∫ÆHdr
);

40994 
isSyn˚d
 = (
pPg
==0 || 0==’Pg->
Êags
 & 
PGHDR_NEED_SYNC
));

40996 if–
	`isO≥n
(
pPagî
->
fd
)

40997 && (
pPagî
->
eSèã
>=
PAGER_WRITER_DBMOD
 ||ÖPagî->eSèã==
PAGER_OPEN
)

40998 && 
isSyn˚d


41000 
i64
 
of°
 = (
pgno
-1)*(i64)
pPagî
->
∑geSize
;

41001 
	`ã°ˇ£
–!
isSavï¡
 && 
pPg
!=0 && (pPg->
Êags
&
PGHDR_NEED_SYNC
)!=0 );

41002 
	`as£π
–!
	`∑gîU£WÆ
(
pPagî
) );

41003 
rc
 = 
	`sqlôe3OsWrôe
(
pPagî
->
fd
, (
u8
 *)
aD©a
,ÖPagî->
∑geSize
, 
of°
);

41004 if–
pgno
>
pPagî
->
dbFûeSize
 ){

41005 
pPagî
->
dbFûeSize
 = 
pgno
;

41007 if–
pPagî
->
pBackup
 ){

41008 
	`CODEC1
(
pPagî
, 
aD©a
, 
pgno
, 3, 
rc
=
SQLITE_NOMEM
);

41009 
	`sqlôe3BackupUpd©e
(
pPagî
->
pBackup
, 
pgno
, (
u8
*)
aD©a
);

41010 
	`CODEC2
(
pPagî
, 
aD©a
, 
pgno
, 7, 
rc
=
SQLITE_NOMEM
,áData);

41012 }if–!
isMaöJ∫l
 && 
pPg
==0 ){

41029 
	`as£π
–
isSavï¡
 );

41030 
	`as£π
–(
pPagî
->
doNŸSpûl
 & 
SPILLFLAG_ROLLBACK
)==0 );

41031 
pPagî
->
doNŸSpûl
 |
SPILLFLAG_ROLLBACK
;

41032 
rc
 = 
	`sqlôe3PagîAcquúe
(
pPagî
, 
pgno
, &
pPg
, 1);

41033 
	`as£π
–(
pPagî
->
doNŸSpûl
 & 
SPILLFLAG_ROLLBACK
)!=0 );

41034 
pPagî
->
doNŸSpûl
 &~
SPILLFLAG_ROLLBACK
;

41035 if–
rc
!=
SQLITE_OK
 ) Ñc;

41036 
pPg
->
Êags
 &~
PGHDR_NEED_READ
;

41037 
	`sqlôe3PˇcheMakeDúty
(
pPg
);

41039 if–
pPg
 ){

41046 *
pD©a
;

41047 
pD©a
 = 
pPg
->pData;

41048 
	`mem˝y
(
pD©a
, (
u8
*)
aD©a
, 
pPagî
->
∑geSize
);

41049 
pPagî
->
	`xReöôî
(
pPg
);

41050 if–
isMaöJ∫l
 && (!
isSavï¡
 || *
pOff£t
<=
pPagî
->
jou∫ÆHdr
) ){

41070 
	`as£π
–!
	`∑gîU£WÆ
(
pPagî
) );

41071 
	`sqlôe3PˇcheMakeCÀ™
(
pPg
);

41073 
	`∑gî_£t_∑gehash
(
pPg
);

41077 if–
pgno
==1 ){

41078 
	`mem˝y
(&
pPagî
->
dbFûeVîs
, &((
u8
*)
pD©a
)[24],(pPager->dbFileVers));

41082 
	`CODEC1
(
pPagî
, 
pD©a
, 
pPg
->
pgno
, 3, 
rc
=
SQLITE_NOMEM
);

41083 
	`sqlôe3PˇcheRñó£
(
pPg
);

41085  
rc
;

41131 
	`∑gî_dñma°î
(
Pagî
 *
pPagî
, c⁄° *
zMa°î
){

41132 
sqlôe3_vfs
 *
pVfs
 = 
pPagî
->pVfs;

41133 
rc
;

41134 
sqlôe3_fûe
 *
pMa°î
;

41135 
sqlôe3_fûe
 *
pJou∫Æ
;

41136 *
zMa°îJou∫Æ
 = 0;

41137 
i64
 
nMa°îJou∫Æ
;

41138 *
zJou∫Æ
;

41139 *
zMa°îPå
;

41140 
nMa°îPå
;

41145 
pMa°î
 = (
sqlôe3_fûe
 *)
	`sqlôe3MÆlocZîo
(
pVfs
->
szOsFûe
 * 2);

41146 
pJou∫Æ
 = (
sqlôe3_fûe
 *)(((
u8
 *)
pMa°î
Ë+ 
pVfs
->
szOsFûe
);

41147 if–!
pMa°î
 ){

41148 
rc
 = 
SQLITE_NOMEM
;

41150 c⁄° 
Êags
 = (
SQLITE_OPEN_READONLY
|
SQLITE_OPEN_MASTER_JOURNAL
);

41151 
rc
 = 
	`sqlôe3OsO≥n
(
pVfs
, 
zMa°î
, 
pMa°î
, 
Êags
, 0);

41153 if–
rc
!=
SQLITE_OK
 ) 
dñma°î_out
;

41160 
rc
 = 
	`sqlôe3OsFûeSize
(
pMa°î
, &
nMa°îJou∫Æ
);

41161 if–
rc
!=
SQLITE_OK
 ) 
dñma°î_out
;

41162 
nMa°îPå
 = 
pVfs
->
mxP©h«me
+1;

41163 
zMa°îJou∫Æ
 = 
	`sqlôe3MÆloc
(()
nMa°îJou∫Æ
 + 
nMa°îPå
 + 1);

41164 if–!
zMa°îJou∫Æ
 ){

41165 
rc
 = 
SQLITE_NOMEM
;

41166 
dñma°î_out
;

41168 
zMa°îPå
 = &
zMa°îJou∫Æ
[
nMa°îJou∫Æ
+1];

41169 
rc
 = 
	`sqlôe3OsRód
(
pMa°î
, 
zMa°îJou∫Æ
, ()
nMa°îJou∫Æ
, 0);

41170 if–
rc
!=
SQLITE_OK
 ) 
dñma°î_out
;

41171 
zMa°îJou∫Æ
[
nMa°îJou∫Æ
] = 0;

41173 
zJou∫Æ
 = 
zMa°îJou∫Æ
;

41174  (
zJou∫Æ
-
zMa°îJou∫Æ
)<
nMa°îJou∫Æ
 ){

41175 
exi°s
;

41176 
rc
 = 
	`sqlôe3OsAc˚ss
(
pVfs
, 
zJou∫Æ
, 
SQLITE_ACCESS_EXISTS
, &
exi°s
);

41177 if–
rc
!=
SQLITE_OK
 ){

41178 
dñma°î_out
;

41180 if–
exi°s
 ){

41185 
c
;

41186 
Êags
 = (
SQLITE_OPEN_READONLY
|
SQLITE_OPEN_MAIN_JOURNAL
);

41187 
rc
 = 
	`sqlôe3OsO≥n
(
pVfs
, 
zJou∫Æ
, 
pJou∫Æ
, 
Êags
, 0);

41188 if–
rc
!=
SQLITE_OK
 ){

41189 
dñma°î_out
;

41192 
rc
 = 
	`ªadMa°îJou∫Æ
(
pJou∫Æ
, 
zMa°îPå
, 
nMa°îPå
);

41193 
	`sqlôe3OsClo£
(
pJou∫Æ
);

41194 if–
rc
!=
SQLITE_OK
 ){

41195 
dñma°î_out
;

41198 
c
 = 
zMa°îPå
[0]!=0 && 
	`°rcmp
(zMa°îPå, 
zMa°î
)==0;

41199 if–
c
 ){

41201 
dñma°î_out
;

41204 
zJou∫Æ
 +(
	`sqlôe3SåÀn30
(zJournal)+1);

41207 
	`sqlôe3OsClo£
(
pMa°î
);

41208 
rc
 = 
	`sqlôe3OsDñëe
(
pVfs
, 
zMa°î
, 0);

41210 
dñma°î_out
:

41211 
	`sqlôe3_‰ì
(
zMa°îJou∫Æ
);

41212 if–
pMa°î
 ){

41213 
	`sqlôe3OsClo£
(
pMa°î
);

41214 
	`as£π
–!
	`isO≥n
(
pJou∫Æ
) );

41215 
	`sqlôe3_‰ì
(
pMa°î
);

41217  
rc
;

41241 
	`∑gî_åunˇã
(
Pagî
 *
pPagî
, 
Pgno
 
nPage
){

41242 
rc
 = 
SQLITE_OK
;

41243 
	`as£π
–
pPagî
->
eSèã
!=
PAGER_ERROR
 );

41244 
	`as£π
–
pPagî
->
eSèã
!=
PAGER_READER
 );

41246 if–
	`isO≥n
(
pPagî
->
fd
)

41247 && (
pPagî
->
eSèã
>=
PAGER_WRITER_DBMOD
 ||ÖPagî->eSèã==
PAGER_OPEN
)

41249 
i64
 
cuºítSize
, 
√wSize
;

41250 
szPage
 = 
pPagî
->
∑geSize
;

41251 
	`as£π
–
pPagî
->
eLock
==
EXCLUSIVE_LOCK
 );

41253 
rc
 = 
	`sqlôe3OsFûeSize
(
pPagî
->
fd
, &
cuºítSize
);

41254 
√wSize
 = 
szPage
*(
i64
)
nPage
;

41255 if–
rc
==
SQLITE_OK
 && 
cuºítSize
!=
√wSize
 ){

41256 if–
cuºítSize
>
√wSize
 ){

41257 
rc
 = 
	`sqlôe3OsTrunˇã
(
pPagî
->
fd
, 
√wSize
);

41258 }if–(
cuºítSize
+
szPage
)<=
√wSize
 ){

41259 *
pTmp
 = 
pPagî
->
pTmpS∑˚
;

41260 
	`mem£t
(
pTmp
, 0, 
szPage
);

41261 
	`ã°ˇ£
–(
√wSize
-
szPage
Ë=
cuºítSize
 );

41262 
	`ã°ˇ£
–(
√wSize
-
szPage
Ë> 
cuºítSize
 );

41263 
rc
 = 
	`sqlôe3OsWrôe
(
pPagî
->
fd
, 
pTmp
, 
szPage
, 
√wSize
-szPage);

41265 if–
rc
==
SQLITE_OK
 ){

41266 
pPagî
->
dbFûeSize
 = 
nPage
;

41270  
rc
;

41277 
SQLITE_PRIVATE
 
	`sqlôe3Se˘‹Size
(
sqlôe3_fûe
 *
pFûe
){

41278 
iRë
 = 
	`sqlôe3OsSe˘‹Size
(
pFûe
);

41279 if–
iRë
<32 ){

41280 
iRë
 = 512;

41281 }if–
iRë
>
MAX_SECTOR_SIZE
 ){

41282 
	`as£π
–
MAX_SECTOR_SIZE
>=512 );

41283 
iRë
 = 
MAX_SECTOR_SIZE
;

41285  
iRë
;

41311 
	`£tSe˘‹Size
(
Pagî
 *
pPagî
){

41312 
	`as£π
–
	`isO≥n
(
pPagî
->
fd
Ë||ÖPagî->
ãmpFûe
 );

41314 if–
pPagî
->
ãmpFûe


41315 || (
	`sqlôe3OsDevi˚Ch¨a˘îi°ics
(
pPagî
->
fd
) &

41316 
SQLITE_IOCAP_POWERSAFE_OVERWRITE
)!=0

41321 
pPagî
->
£˘‹Size
 = 512;

41323 
pPagî
->
£˘‹Size
 = 
	`sqlôe3Se˘‹Size
’Pagî->
fd
);

41384 
	`∑gî_∂ayback
(
Pagî
 *
pPagî
, 
isHŸ
){

41385 
sqlôe3_vfs
 *
pVfs
 = 
pPagî
->pVfs;

41386 
i64
 
szJ
;

41387 
u32
 
nRec
;

41388 
u32
 
u
;

41389 
Pgno
 
mxPg
 = 0;

41390 
rc
;

41391 
ªs
 = 1;

41392 *
zMa°î
 = 0;

41393 
√edPagîRe£t
;

41394 
nPœyback
 = 0;

41399 
	`as£π
–
	`isO≥n
(
pPagî
->
jfd
) );

41400 
rc
 = 
	`sqlôe3OsFûeSize
(
pPagî
->
jfd
, &
szJ
);

41401 if–
rc
!=
SQLITE_OK
 ){

41402 
íd_∂ayback
;

41416 
zMa°î
 = 
pPagî
->
pTmpS∑˚
;

41417 
rc
 = 
	`ªadMa°îJou∫Æ
(
pPagî
->
jfd
, 
zMa°î
,ÖPagî->
pVfs
->
mxP©h«me
+1);

41418 if–
rc
==
SQLITE_OK
 && 
zMa°î
[0] ){

41419 
rc
 = 
	`sqlôe3OsAc˚ss
(
pVfs
, 
zMa°î
, 
SQLITE_ACCESS_EXISTS
, &
ªs
);

41421 
zMa°î
 = 0;

41422 if–
rc
!=
SQLITE_OK
 || !
ªs
 ){

41423 
íd_∂ayback
;

41425 
pPagî
->
jou∫ÆOff
 = 0;

41426 
√edPagîRe£t
 = 
isHŸ
;

41438 
rc
 = 
	`ªadJou∫ÆHdr
(
pPagî
, 
isHŸ
, 
szJ
, &
nRec
, &
mxPg
);

41439 if–
rc
!=
SQLITE_OK
 ){

41440 if–
rc
==
SQLITE_DONE
 ){

41441 
rc
 = 
SQLITE_OK
;

41443 
íd_∂ayback
;

41451 if–
nRec
==0xffffffff ){

41452 
	`as£π
–
pPagî
->
jou∫ÆOff
==
	`JOURNAL_HDR_SZ
(pPager) );

41453 
nRec
 = ()((
szJ
 - 
	`JOURNAL_HDR_SZ
(
pPagî
))/
	`JOURNAL_PG_SZ
(pPager));

41470 if–
nRec
==0 && !
isHŸ
 &&

41471 
pPagî
->
jou∫ÆHdr
+
	`JOURNAL_HDR_SZ
’Pagî)=ıPagî->
jou∫ÆOff
 ){

41472 
nRec
 = ()((
szJ
 - 
pPagî
->
jou∫ÆOff
Ë/ 
	`JOURNAL_PG_SZ
(pPager));

41478 if–
pPagî
->
jou∫ÆOff
==
	`JOURNAL_HDR_SZ
(pPager) ){

41479 
rc
 = 
	`∑gî_åunˇã
(
pPagî
, 
mxPg
);

41480 if–
rc
!=
SQLITE_OK
 ){

41481 
íd_∂ayback
;

41483 
pPagî
->
dbSize
 = 
mxPg
;

41489 
u
=0; u<
nRec
; u++){

41490 if–
√edPagîRe£t
 ){

41491 
	`∑gî_ª£t
(
pPagî
);

41492 
√edPagîRe£t
 = 0;

41494 
rc
 = 
	`∑gî_∂ayback_⁄e_∑ge
(
pPagî
,&pPagî->
jou∫ÆOff
,0,1,0);

41495 if–
rc
==
SQLITE_OK
 ){

41496 
nPœyback
++;

41498 if–
rc
==
SQLITE_DONE
 ){

41499 
pPagî
->
jou∫ÆOff
 = 
szJ
;

41501 }if–
rc
==
SQLITE_IOERR_SHORT_READ
 ){

41507 
rc
 = 
SQLITE_OK
;

41508 
íd_∂ayback
;

41515 
íd_∂ayback
;

41521 
	`as£π
( 0 );

41523 
íd_∂ayback
:

41529 #ifde‡
SQLITE_DEBUG


41530 if–
pPagî
->
fd
->
pMëhods
 ){

41531 
	`sqlôe3OsFûeC⁄åﬁHöt
(
pPagî
->
fd
,
SQLITE_FCNTL_DB_UNCHANGED
,0);

41544 
pPagî
->
ch™geCou¡D⁄e
 =ÖPagî->
ãmpFûe
;

41546 if–
rc
==
SQLITE_OK
 ){

41547 
zMa°î
 = 
pPagî
->
pTmpS∑˚
;

41548 
rc
 = 
	`ªadMa°îJou∫Æ
(
pPagî
->
jfd
, 
zMa°î
,ÖPagî->
pVfs
->
mxP©h«me
+1);

41549 
	`ã°ˇ£
–
rc
!=
SQLITE_OK
 );

41551 if–
rc
==
SQLITE_OK


41552 && (
pPagî
->
eSèã
>=
PAGER_WRITER_DBMOD
 ||ÖPagî->eSèã==
PAGER_OPEN
)

41554 
rc
 = 
	`sqlôe3PagîSync
(
pPagî
);

41556 if–
rc
==
SQLITE_OK
 ){

41557 
rc
 = 
	`∑gî_íd_å™ß˘i⁄
(
pPagî
, 
zMa°î
[0]!='\0', 0);

41558 
	`ã°ˇ£
–
rc
!=
SQLITE_OK
 );

41560 if–
rc
==
SQLITE_OK
 && 
zMa°î
[0] && 
ªs
 ){

41564 
rc
 = 
	`∑gî_dñma°î
(
pPagî
, 
zMa°î
);

41565 
	`ã°ˇ£
–
rc
!=
SQLITE_OK
 );

41567 if–
isHŸ
 && 
nPœyback
 ){

41568 
	`sqlôe3_log
(
SQLITE_NOTICE_RECOVER_ROLLBACK
, "recovered %dÖages from %s",

41569 
nPœyback
, 
pPagî
->
zJou∫Æ
);

41576 
	`£tSe˘‹Size
(
pPagî
);

41577  
rc
;

41592 
	`ªadDbPage
(
PgHdr
 *
pPg
, 
u32
 
iFøme
){

41593 
Pagî
 *
pPagî
 = 
pPg
->pPager;

41594 
Pgno
 
pgno
 = 
pPg
->pgno;

41595 
rc
 = 
SQLITE_OK
;

41596 
pgsz
 = 
pPagî
->
∑geSize
;

41598 
	`as£π
–
pPagî
->
eSèã
>=
PAGER_READER
 && !
MEMDB
 );

41599 
	`as£π
–
	`isO≥n
(
pPagî
->
fd
) );

41601 #i‚de‡
SQLITE_OMIT_WAL


41602 if–
iFøme
 ){

41604 
rc
 = 
	`sqlôe3WÆRódFøme
(
pPagî
->
pWÆ
, 
iFøme
, 
pgsz
, 
pPg
->
pD©a
);

41608 
i64
 
iOff£t
 = (
pgno
-1)*(i64)
pPagî
->
∑geSize
;

41609 
rc
 = 
	`sqlôe3OsRód
(
pPagî
->
fd
, 
pPg
->
pD©a
, 
pgsz
, 
iOff£t
);

41610 if–
rc
==
SQLITE_IOERR_SHORT_READ
 ){

41611 
rc
 = 
SQLITE_OK
;

41615 if–
pgno
==1 ){

41616 if–
rc
 ){

41629 
	`mem£t
(
pPagî
->
dbFûeVîs
, 0xff, (pPager->dbFileVers));

41631 
u8
 *
dbFûeVîs
 = &((u8*)
pPg
->
pD©a
)[24];

41632 
	`mem˝y
(&
pPagî
->
dbFûeVîs
, dbFileVers, (pPager->dbFileVers));

41635 
	`CODEC1
(
pPagî
, 
pPg
->
pD©a
, 
pgno
, 3, 
rc
 = 
SQLITE_NOMEM
);

41637 
	`PAGER_INCR
(
sqlôe3_∑gî_ªaddb_cou¡
);

41638 
	`PAGER_INCR
(
pPagî
->
nRód
);

41639 
	`IOTRACE
(("PGIN %∞%d\n", 
pPagî
, 
pgno
));

41640 
	`PAGERTRACE
(("FETCH %dÖage %d hash(%08x)\n",

41641 
	`PAGERID
(
pPagî
), 
pgno
, 
	`∑gî_∑gehash
(
pPg
)));

41643  
rc
;

41654 
	`∑gî_wrôe_ch™gecou¡î
(
PgHdr
 *
pPg
){

41655 
u32
 
ch™ge_cou¡î
;

41658 
ch™ge_cou¡î
 = 
	`sqlôe3Gë4byã
((
u8
*)
pPg
->
pPagî
->
dbFûeVîs
)+1;

41659 
	`put32bôs
(((*)
pPg
->
pD©a
)+24, 
ch™ge_cou¡î
);

41664 
	`put32bôs
(((*)
pPg
->
pD©a
)+92, 
ch™ge_cou¡î
);

41665 
	`put32bôs
(((*)
pPg
->
pD©a
)+96, 
SQLITE_VERSION_NUMBER
);

41668 #i‚de‡
SQLITE_OMIT_WAL


41681 
	`∑gîUndoCÆlback
(*
pCtx
, 
Pgno
 
iPg
){

41682 
rc
 = 
SQLITE_OK
;

41683 
Pagî
 *
pPagî
 = (Pagî *)
pCtx
;

41684 
PgHdr
 *
pPg
;

41686 
	`as£π
–
	`∑gîU£WÆ
(
pPagî
) );

41687 
pPg
 = 
	`sqlôe3PagîLookup
(
pPagî
, 
iPg
);

41688 if–
pPg
 ){

41689 if–
	`sqlôe3PˇchePageRefcou¡
(
pPg
)==1 ){

41690 
	`sqlôe3PˇcheDr›
(
pPg
);

41692 
u32
 
iFøme
 = 0;

41693 
rc
 = 
	`sqlôe3WÆFödFøme
(
pPagî
->
pWÆ
, 
pPg
->
pgno
, &
iFøme
);

41694 if–
rc
==
SQLITE_OK
 ){

41695 
rc
 = 
	`ªadDbPage
(
pPg
, 
iFøme
);

41697 if–
rc
==
SQLITE_OK
 ){

41698 
pPagî
->
	`xReöôî
(
pPg
);

41700 
	`sqlôe3PagîUƒef
(
pPg
);

41712 
	`sqlôe3BackupRe°¨t
(
pPagî
->
pBackup
);

41714  
rc
;

41720 
	`∑gîRﬁlbackWÆ
(
Pagî
 *
pPagî
){

41721 
rc
;

41722 
PgHdr
 *
pLi°
;

41731 
pPagî
->
dbSize
 =ÖPagî->
dbOrigSize
;

41732 
rc
 = 
	`sqlôe3WÆUndo
(
pPagî
->
pWÆ
, 
∑gîUndoCÆlback
, (*)pPager);

41733 
pLi°
 = 
	`sqlôe3PˇcheDútyLi°
(
pPagî
->
pPCache
);

41734  
pLi°
 && 
rc
==
SQLITE_OK
 ){

41735 
PgHdr
 *
pNext
 = 
pLi°
->
pDúty
;

41736 
rc
 = 
	`∑gîUndoCÆlback
((*)
pPagî
, 
pLi°
->
pgno
);

41737 
pLi°
 = 
pNext
;

41740  
rc
;

41752 
	`∑gîWÆFømes
(

41753 
Pagî
 *
pPagî
,

41754 
PgHdr
 *
pLi°
,

41755 
Pgno
 
nTrunˇã
,

41756 
isCommô


41758 
rc
;

41759 
nLi°
;

41760 #i‡
	`deföed
(
SQLITE_DEBUG
Ë|| deföed(
SQLITE_CHECK_PAGES
)

41761 
PgHdr
 *
p
;

41764 
	`as£π
–
pPagî
->
pWÆ
 );

41765 
	`as£π
–
pLi°
 );

41766 #ifde‡
SQLITE_DEBUG


41768 
p
=
pLi°
;Ö &&Ö->
pDúty
;Ö=p->pDirty){

41769 
	`as£π
–
p
->
pgno
 <Ö->
pDúty
->pgno );

41773 
	`as£π
–
pLi°
->
pDúty
==0 || 
isCommô
 );

41774 if–
isCommô
 ){

41779 
PgHdr
 *
p
;

41780 
PgHdr
 **
µNext
 = &
pLi°
;

41781 
nLi°
 = 0;

41782 
p
=
pLi°
; (*
µNext
 =Ö)!=0;Öı->
pDúty
){

41783 if–
p
->
pgno
<=
nTrunˇã
 ){

41784 
µNext
 = &
p
->
pDúty
;

41785 
nLi°
++;

41788 
	`as£π
–
pLi°
 );

41790 
nLi°
 = 1;

41792 
pPagî
->
aSèt
[
PAGER_STAT_WRITE
] +
nLi°
;

41794 if–
pLi°
->
pgno
==1 ) 
	`∑gî_wrôe_ch™gecou¡î
(pList);

41795 
rc
 = 
	`sqlôe3WÆFømes
(
pPagî
->
pWÆ
,

41796 
pPagî
->
∑geSize
, 
pLi°
, 
nTrunˇã
, 
isCommô
,ÖPagî->
wÆSyncFœgs


41798 if–
rc
==
SQLITE_OK
 && 
pPagî
->
pBackup
 ){

41799 
PgHdr
 *
p
;

41800 
p
=
pLi°
;Ö;Öı->
pDúty
){

41801 
	`sqlôe3BackupUpd©e
(
pPagî
->
pBackup
, 
p
->
pgno
, (
u8
 *Ì->
pD©a
);

41805 #ifde‡
SQLITE_CHECK_PAGES


41806 
pLi°
 = 
	`sqlôe3PˇcheDútyLi°
(
pPagî
->
pPCache
);

41807 
p
=
pLi°
;Ö;Öı->
pDúty
){

41808 
	`∑gî_£t_∑gehash
(
p
);

41812  
rc
;

41823 
	`∑gîBegöRódTønß˘i⁄
(
Pagî
 *
pPagî
){

41824 
rc
;

41825 
ch™ged
 = 0;

41827 
	`as£π
–
	`∑gîU£WÆ
(
pPagî
) );

41828 
	`as£π
–
pPagî
->
eSèã
==
PAGER_OPEN
 ||ÖPagî->eSèã==
PAGER_READER
 );

41835 
	`sqlôe3WÆEndRódTønß˘i⁄
(
pPagî
->
pWÆ
);

41837 
rc
 = 
	`sqlôe3WÆBegöRódTønß˘i⁄
(
pPagî
->
pWÆ
, &
ch™ged
);

41838 if–
rc
!=
SQLITE_OK
 || 
ch™ged
 ){

41839 
	`∑gî_ª£t
(
pPagî
);

41840 if–
	`USEFETCH
(
pPagî
ËË
	`sqlôe3OsUn„tch
’Pagî->
fd
, 0, 0);

41843  
rc
;

41856 
	`∑gîPagecou¡
(
Pagî
 *
pPagî
, 
Pgno
 *
≤Page
){

41857 
Pgno
 
nPage
;

41865 
	`as£π
–
pPagî
->
eSèã
==
PAGER_OPEN
 );

41866 
	`as£π
–
pPagî
->
eLock
>=
SHARED_LOCK
 );

41867 
nPage
 = 
	`sqlôe3WÆDbsize
(
pPagî
->
pWÆ
);

41875 if–
nPage
==0 ){

41876 
i64
 
n
 = 0;

41877 
	`as£π
–
	`isO≥n
(
pPagî
->
fd
Ë||ÖPagî->
ãmpFûe
 );

41878 if–
	`isO≥n
(
pPagî
->
fd
) ){

41879 
rc
 = 
	`sqlôe3OsFûeSize
(
pPagî
->
fd
, &
n
);

41880 if–
rc
!=
SQLITE_OK
 ){

41881  
rc
;

41884 
nPage
 = (
Pgno
)((
n
+
pPagî
->
∑geSize
-1) /ÖPager->pageSize);

41891 if–
nPage
>
pPagî
->
mxPgno
 ){

41892 
pPagî
->
mxPgno
 = (
Pgno
)
nPage
;

41895 *
≤Page
 = 
nPage
;

41896  
SQLITE_OK
;

41899 #i‚de‡
SQLITE_OMIT_WAL


41918 
	`∑gîO≥nWÆIfPª£¡
(
Pagî
 *
pPagî
){

41919 
rc
 = 
SQLITE_OK
;

41920 
	`as£π
–
pPagî
->
eSèã
==
PAGER_OPEN
 );

41921 
	`as£π
–
pPagî
->
eLock
>=
SHARED_LOCK
 );

41923 if–!
pPagî
->
ãmpFûe
 ){

41924 
isWÆ
;

41925 
Pgno
 
nPage
;

41927 
rc
 = 
	`∑gîPagecou¡
(
pPagî
, &
nPage
);

41928 if–
rc
 ) Ñc;

41929 if–
nPage
==0 ){

41930 
rc
 = 
	`sqlôe3OsDñëe
(
pPagî
->
pVfs
,ÖPagî->
zWÆ
, 0);

41931 if–
rc
==
SQLITE_IOERR_DELETE_NOENT
 )Ñ¯
SQLITE_OK
;

41932 
isWÆ
 = 0;

41934 
rc
 = 
	`sqlôe3OsAc˚ss
(

41935 
pPagî
->
pVfs
,ÖPagî->
zWÆ
, 
SQLITE_ACCESS_EXISTS
, &
isWÆ


41938 if–
rc
==
SQLITE_OK
 ){

41939 if–
isWÆ
 ){

41940 
	`ã°ˇ£
–
	`sqlôe3PˇchePagecou¡
(
pPagî
->
pPCache
)==0 );

41941 
rc
 = 
	`sqlôe3PagîO≥nWÆ
(
pPagî
, 0);

41942 }if–
pPagî
->
jou∫ÆMode
==
PAGER_JOURNALMODE_WAL
 ){

41943 
pPagî
->
jou∫ÆMode
 = 
PAGER_JOURNALMODE_DELETE
;

41947  
rc
;

41987 
	`∑gîPœybackSavïoöt
(
Pagî
 *
pPagî
, 
PagîSavïoöt
 *
pSavïoöt
){

41988 
i64
 
szJ
;

41989 
i64
 
iHdrOff
;

41990 
rc
 = 
SQLITE_OK
;

41991 
Bôvec
 *
pD⁄e
 = 0;

41993 
	`as£π
–
pPagî
->
eSèã
!=
PAGER_ERROR
 );

41994 
	`as£π
–
pPagî
->
eSèã
>=
PAGER_WRITER_LOCKED
 );

41997 if–
pSavïoöt
 ){

41998 
pD⁄e
 = 
	`sqlôe3BôvecCª©e
(
pSavïoöt
->
nOrig
);

41999 if–!
pD⁄e
 ){

42000  
SQLITE_NOMEM
;

42007 
pPagî
->
dbSize
 = 
pSavïoöt
 ?ÖSavïoöt->
nOrig
 :ÖPagî->
dbOrigSize
;

42008 
pPagî
->
ch™geCou¡D⁄e
 =ÖPagî->
ãmpFûe
;

42010 if–!
pSavïoöt
 && 
	`∑gîU£WÆ
(
pPagî
) ){

42011  
	`∑gîRﬁlbackWÆ
(
pPagî
);

42019 
szJ
 = 
pPagî
->
jou∫ÆOff
;

42020 
	`as£π
–
	`∑gîU£WÆ
(
pPagî
)==0 || 
szJ
==0 );

42029 if–
pSavïoöt
 && !
	`∑gîU£WÆ
(
pPagî
) ){

42030 
iHdrOff
 = 
pSavïoöt
->
iHdrOff£t
 ?ÖSavïoöt->iHdrOff£à: 
szJ
;

42031 
pPagî
->
jou∫ÆOff
 = 
pSavïoöt
->
iOff£t
;

42032  
rc
==
SQLITE_OK
 && 
pPagî
->
jou∫ÆOff
<
iHdrOff
 ){

42033 
rc
 = 
	`∑gî_∂ayback_⁄e_∑ge
(
pPagî
, &pPagî->
jou∫ÆOff
, 
pD⁄e
, 1, 1);

42035 
	`as£π
–
rc
!=
SQLITE_DONE
 );

42037 
pPagî
->
jou∫ÆOff
 = 0;

42045  
rc
==
SQLITE_OK
 && 
pPagî
->
jou∫ÆOff
<
szJ
 ){

42046 
u32
 
ii
;

42047 
u32
 
nJRec
 = 0;

42048 
u32
 
dummy
;

42049 
rc
 = 
	`ªadJou∫ÆHdr
(
pPagî
, 0, 
szJ
, &
nJRec
, &
dummy
);

42050 
	`as£π
–
rc
!=
SQLITE_DONE
 );

42057 if–
nJRec
==0

42058 && 
pPagî
->
jou∫ÆHdr
+
	`JOURNAL_HDR_SZ
’Pagî)=ıPagî->
jou∫ÆOff


42060 
nJRec
 = (
u32
)((
szJ
 - 
pPagî
->
jou∫ÆOff
)/
	`JOURNAL_PG_SZ
(pPager));

42062 
ii
=0; 
rc
==
SQLITE_OK
 && ii<
nJRec
 && 
pPagî
->
jou∫ÆOff
<
szJ
; ii++){

42063 
rc
 = 
	`∑gî_∂ayback_⁄e_∑ge
(
pPagî
, &pPagî->
jou∫ÆOff
, 
pD⁄e
, 1, 1);

42065 
	`as£π
–
rc
!=
SQLITE_DONE
 );

42067 
	`as£π
–
rc
!=
SQLITE_OK
 || 
pPagî
->
jou∫ÆOff
>=
szJ
 );

42073 if–
pSavïoöt
 ){

42074 
u32
 
ii
;

42075 
i64
 
off£t
 = (i64)
pSavïoöt
->
iSubRec
*(4+
pPagî
->
∑geSize
);

42077 if–
	`∑gîU£WÆ
(
pPagî
) ){

42078 
rc
 = 
	`sqlôe3WÆSavïoötUndo
(
pPagî
->
pWÆ
, 
pSavïoöt
->
aWÆD©a
);

42080 
ii
=
pSavïoöt
->
iSubRec
; 
rc
==
SQLITE_OK
 && ii<
pPagî
->
nSubRec
; ii++){

42081 
	`as£π
–
off£t
==(
i64
)
ii
*(4+
pPagî
->
∑geSize
) );

42082 
rc
 = 
	`∑gî_∂ayback_⁄e_∑ge
(
pPagî
, &
off£t
, 
pD⁄e
, 0, 1);

42084 
	`as£π
–
rc
!=
SQLITE_DONE
 );

42087 
	`sqlôe3BôvecDe°roy
(
pD⁄e
);

42088 if–
rc
==
SQLITE_OK
 ){

42089 
pPagî
->
jou∫ÆOff
 = 
szJ
;

42092  
rc
;

42098 
SQLITE_PRIVATE
 
	`sqlôe3PagîSëCachesize
(
Pagî
 *
pPagî
, 
mxPage
){

42099 
	`sqlôe3PˇcheSëCachesize
(
pPagî
->
pPCache
, 
mxPage
);

42105 
	`∑gîFixM≠limô
(
Pagî
 *
pPagî
){

42106 #i‡
SQLITE_MAX_MMAP_SIZE
>0

42107 
sqlôe3_fûe
 *
fd
 = 
pPagî
->fd;

42108 if–
	`isO≥n
(
fd
Ë&& fd->
pMëhods
->
iVîsi⁄
>=3 ){

42109 
sqlôe3_öt64
 
sz
;

42110 
sz
 = 
pPagî
->
szMm≠
;

42111 
pPagî
->
bU£Fëch
 = (
sz
>0);

42112 
	`sqlôe3OsFûeC⁄åﬁHöt
(
pPagî
->
fd
, 
SQLITE_FCNTL_MMAP_SIZE
, &
sz
);

42120 
SQLITE_PRIVATE
 
	`sqlôe3PagîSëMm≠Limô
(
Pagî
 *
pPagî
, 
sqlôe3_öt64
 
szMm≠
){

42121 
pPagî
->
szMm≠
 = szMmap;

42122 
	`∑gîFixM≠limô
(
pPagî
);

42128 
SQLITE_PRIVATE
 
	`sqlôe3PagîShrök
(
Pagî
 *
pPagî
){

42129 
	`sqlôe3PˇcheShrök
(
pPagî
->
pPCache
);

42178 #i‚de‡
SQLITE_OMIT_PAGER_PRAGMAS


42179 
SQLITE_PRIVATE
 
	`sqlôe3PagîSëFœgs
(

42180 
Pagî
 *
pPagî
,

42181 
pgFœgs


42183 
Àvñ
 = 
pgFœgs
 & 
PAGER_SYNCHRONOUS_MASK
;

42184 
	`as£π
–
Àvñ
>=1 &&Üevel<=3 );

42185 
pPagî
->
noSync
 = (
Àvñ
==1 ||ÖPagî->
ãmpFûe
) ?1:0;

42186 
pPagî
->
fuŒSync
 = (
Àvñ
==3 && !pPagî->
ãmpFûe
) ?1:0;

42187 if–
pPagî
->
noSync
 ){

42188 
pPagî
->
syncFœgs
 = 0;

42189 
pPagî
->
ck±SyncFœgs
 = 0;

42190 }if–
pgFœgs
 & 
PAGER_FULLFSYNC
 ){

42191 
pPagî
->
syncFœgs
 = 
SQLITE_SYNC_FULL
;

42192 
pPagî
->
ck±SyncFœgs
 = 
SQLITE_SYNC_FULL
;

42193 }if–
pgFœgs
 & 
PAGER_CKPT_FULLFSYNC
 ){

42194 
pPagî
->
syncFœgs
 = 
SQLITE_SYNC_NORMAL
;

42195 
pPagî
->
ck±SyncFœgs
 = 
SQLITE_SYNC_FULL
;

42197 
pPagî
->
syncFœgs
 = 
SQLITE_SYNC_NORMAL
;

42198 
pPagî
->
ck±SyncFœgs
 = 
SQLITE_SYNC_NORMAL
;

42200 
pPagî
->
wÆSyncFœgs
 =ÖPagî->
syncFœgs
;

42201 if–
pPagî
->
fuŒSync
 ){

42202 
pPagî
->
wÆSyncFœgs
 |
WAL_SYNC_TRANSACTIONS
;

42204 if–
pgFœgs
 & 
PAGER_CACHESPILL
 ){

42205 
pPagî
->
doNŸSpûl
 &~
SPILLFLAG_OFF
;

42207 
pPagî
->
doNŸSpûl
 |
SPILLFLAG_OFF
;

42217 #ifde‡
SQLITE_TEST


42218 
SQLITE_API
 
sqlôe3_›íãmp_cou¡
 = 0;

42236 
	`∑gîO≥¡emp
(

42237 
Pagî
 *
pPagî
,

42238 
sqlôe3_fûe
 *
pFûe
,

42239 
vfsFœgs


42241 
rc
;

42243 #ifde‡
SQLITE_TEST


42244 
sqlôe3_›íãmp_cou¡
++;

42247 
vfsFœgs
 |
SQLITE_OPEN_READWRITE
 | 
SQLITE_OPEN_CREATE
 |

42248 
SQLITE_OPEN_EXCLUSIVE
 | 
SQLITE_OPEN_DELETEONCLOSE
;

42249 
rc
 = 
	`sqlôe3OsO≥n
(
pPagî
->
pVfs
, 0, 
pFûe
, 
vfsFœgs
, 0);

42250 
	`as£π
–
rc
!=
SQLITE_OK
 || 
	`isO≥n
(
pFûe
) );

42251  
rc
;

42275 
SQLITE_PRIVATE
 
	`sqlôe3PagîSëBusyh™dÀr
(

42276 
Pagî
 *
pPagî
,

42277 (*
xBusyH™dÀr
)(*),

42278 *
pBusyH™dÀrArg


42280 
pPagî
->
xBusyH™dÀr
 = xBusyHandler;

42281 
pPagî
->
pBusyH™dÀrArg
 =ÖBusyHandlerArg;

42283 if–
	`isO≥n
(
pPagî
->
fd
) ){

42284 **
≠
 = (**)&
pPagî
->
xBusyH™dÀr
;

42285 
	`as£π
–(((*)(*))(
≠
[0]))==
xBusyH™dÀr
 );

42286 
	`as£π
–
≠
[1]==
pBusyH™dÀrArg
 );

42287 
	`sqlôe3OsFûeC⁄åﬁHöt
(
pPagî
->
fd
, 
SQLITE_FCNTL_BUSYHANDLER
, (*)
≠
);

42321 
SQLITE_PRIVATE
 
	`sqlôe3PagîSëPagesize
(
Pagî
 *
pPagî
, 
u32
 *
pPageSize
, 
nRe£rve
){

42322 
rc
 = 
SQLITE_OK
;

42334 
u32
 
∑geSize
 = *
pPageSize
;

42335 
	`as£π
–
∑geSize
==0 || (∑geSize>=512 &&ÖageSize<=
SQLITE_MAX_PAGE_SIZE
) );

42336 if–(
pPagî
->
memDb
==0 ||ÖPagî->
dbSize
==0)

42337 && 
	`sqlôe3PˇcheRefCou¡
(
pPagî
->
pPCache
)==0

42338 && 
∑geSize
 &&ÖageSize!=(
u32
)
pPagî
->pageSize

42340 *
pNew
 = 
NULL
;

42341 
i64
 
nByã
 = 0;

42343 if–
pPagî
->
eSèã
>
PAGER_OPEN
 && 
	`isO≥n
’Pagî->
fd
) ){

42344 
rc
 = 
	`sqlôe3OsFûeSize
(
pPagî
->
fd
, &
nByã
);

42346 if–
rc
==
SQLITE_OK
 ){

42347 
pNew
 = (*)
	`sqlôe3PageMÆloc
(
∑geSize
);

42348 if–!
pNew
 ) 
rc
 = 
SQLITE_NOMEM
;

42351 if–
rc
==
SQLITE_OK
 ){

42352 
	`∑gî_ª£t
(
pPagî
);

42353 
pPagî
->
dbSize
 = (
Pgno
)((
nByã
+
∑geSize
-1)/pageSize);

42354 
pPagî
->
∑geSize
 =ÖageSize;

42355 
	`sqlôe3PageFªe
(
pPagî
->
pTmpS∑˚
);

42356 
pPagî
->
pTmpS∑˚
 = 
pNew
;

42357 
	`sqlôe3PˇcheSëPageSize
(
pPagî
->
pPCache
, 
∑geSize
);

42361 *
pPageSize
 = 
pPagî
->
∑geSize
;

42362 if–
rc
==
SQLITE_OK
 ){

42363 if–
nRe£rve
<0 )ÇRe£rvê
pPagî
->nReserve;

42364 
	`as£π
–
nRe£rve
>=0 &&ÇReserve<1000 );

42365 
pPagî
->
nRe£rve
 = (
i16
)nReserve;

42366 
	`∑gîRï‹tSize
(
pPagî
);

42367 
	`∑gîFixM≠limô
(
pPagî
);

42369  
rc
;

42380 
SQLITE_PRIVATE
 *
	`sqlôe3PagîTempS∑˚
(
Pagî
 *
pPagî
){

42381  
pPagî
->
pTmpS∑˚
;

42391 
SQLITE_PRIVATE
 
	`sqlôe3PagîMaxPageCou¡
(
Pagî
 *
pPagî
, 
mxPage
){

42392 if–
mxPage
>0 ){

42393 
pPagî
->
mxPgno
 = 
mxPage
;

42395 
	`as£π
–
pPagî
->
eSèã
!=
PAGER_OPEN
 );

42396 
	`as£π
–
pPagî
->
mxPgno
>ıPagî->
dbSize
 );

42397  
pPagî
->
mxPgno
;

42408 #ifde‡
SQLITE_TEST


42409 
SQLITE_API
 
sqlôe3_io_îr‹_≥ndög
;

42410 
SQLITE_API
 
sqlôe3_io_îr‹_hô
;

42411 
ßved_˙t
;

42412 
	`dißbÀ_simuœãd_io_îr‹s
(){

42413 
ßved_˙t
 = 
sqlôe3_io_îr‹_≥ndög
;

42414 
sqlôe3_io_îr‹_≥ndög
 = -1;

42416 
	`íabÀ_simuœãd_io_îr‹s
(){

42417 
sqlôe3_io_îr‹_≥ndög
 = 
ßved_˙t
;

42420 
	#dißbÀ_simuœãd_io_îr‹s
()

	)

42421 
	#íabÀ_simuœãd_io_îr‹s
()

	)

42438 
SQLITE_PRIVATE
 
	`sqlôe3PagîRódFûehódî
(
Pagî
 *
pPagî
, 
N
, *
pDe°
){

42439 
rc
 = 
SQLITE_OK
;

42440 
	`mem£t
(
pDe°
, 0, 
N
);

42441 
	`as£π
–
	`isO≥n
(
pPagî
->
fd
Ë||ÖPagî->
ãmpFûe
 );

42447 
	`as£π
–!
	`∑gîU£WÆ
(
pPagî
) );

42449 if–
	`isO≥n
(
pPagî
->
fd
) ){

42450 
	`IOTRACE
(("DBHDR %∞0 %d\n", 
pPagî
, 
N
))

42451 
rc
 = 
	`sqlôe3OsRód
(
pPagî
->
fd
, 
pDe°
, 
N
, 0);

42452 if–
rc
==
SQLITE_IOERR_SHORT_READ
 ){

42453 
rc
 = 
SQLITE_OK
;

42456  
rc
;

42466 
SQLITE_PRIVATE
 
	`sqlôe3PagîPagecou¡
(
Pagî
 *
pPagî
, *
≤Page
){

42467 
	`as£π
–
pPagî
->
eSèã
>=
PAGER_READER
 );

42468 
	`as£π
–
pPagî
->
eSèã
!=
PAGER_WRITER_FINISHED
 );

42469 *
≤Page
 = ()
pPagî
->
dbSize
;

42487 
	`∑gî_waô_⁄_lock
(
Pagî
 *
pPagî
, 
lockty≥
){

42488 
rc
;

42495 
	`as£π
–(
pPagî
->
eLock
>=
lockty≥
)

42496 || (
pPagî
->
eLock
==
NO_LOCK
 && 
lockty≥
==
SHARED_LOCK
)

42497 || (
pPagî
->
eLock
==
RESERVED_LOCK
 && 
lockty≥
==
EXCLUSIVE_LOCK
)

42501 
rc
 = 
	`∑gîLockDb
(
pPagî
, 
lockty≥
);

42502 } 
rc
==
SQLITE_BUSY
 && 
pPagî
->
	`xBusyH™dÀr
’Pagî->
pBusyH™dÀrArg
) );

42503  
rc
;

42528 #i‡
	`deföed
(
SQLITE_DEBUG
)

42529 
	`as£πTrunˇãC⁄°øötCb
(
PgHdr
 *
pPg
){

42530 
	`as£π
–
pPg
->
Êags
&
PGHDR_DIRTY
 );

42531 
	`as£π
–!
	`subjRequúesPage
(
pPg
Ë||ÖPg->
pgno
<ıPg->
pPagî
->
dbSize
 );

42533 
	`as£πTrunˇãC⁄°øöt
(
Pagî
 *
pPagî
){

42534 
	`sqlôe3PˇcheIãøãDúty
(
pPagî
->
pPCache
, 
as£πTrunˇãC⁄°øötCb
);

42537 
	#as£πTrunˇãC⁄°øöt
(
pPagî
)

	)

42551 
SQLITE_PRIVATE
 
	`sqlôe3PagîTrunˇãImage
(
Pagî
 *
pPagî
, 
Pgno
 
nPage
){

42552 
	`as£π
–
pPagî
->
dbSize
>=
nPage
 );

42553 
	`as£π
–
pPagî
->
eSèã
>=
PAGER_WRITER_CACHEMOD
 );

42554 
pPagî
->
dbSize
 = 
nPage
;

42582 
	`∑gîSyncHŸJou∫Æ
(
Pagî
 *
pPagî
){

42583 
rc
 = 
SQLITE_OK
;

42584 if–!
pPagî
->
noSync
 ){

42585 
rc
 = 
	`sqlôe3OsSync
(
pPagî
->
jfd
, 
SQLITE_SYNC_NORMAL
);

42587 if–
rc
==
SQLITE_OK
 ){

42588 
rc
 = 
	`sqlôe3OsFûeSize
(
pPagî
->
jfd
, &pPagî->
jou∫ÆHdr
);

42590  
rc
;

42603 
	`∑gîAcquúeM≠Page
(

42604 
Pagî
 *
pPagî
,

42605 
Pgno
 
pgno
,

42606 *
pD©a
,

42607 
PgHdr
 **
µPage


42609 
PgHdr
 *
p
;

42611 if–
pPagî
->
pMm≠Fªñi°
 ){

42612 *
µPage
 = 
p
 = 
pPagî
->
pMm≠Fªñi°
;

42613 
pPagî
->
pMm≠Fªñi°
 = 
p
->
pDúty
;

42614 
p
->
pDúty
 = 0;

42615 
	`mem£t
(
p
->
pExåa
, 0, 
pPagî
->
nExåa
);

42617 *
µPage
 = 
p
 = (
PgHdr
 *)
	`sqlôe3MÆlocZîo
((PgHdrË+ 
pPagî
->
nExåa
);

42618 if–
p
==0 ){

42619 
	`sqlôe3OsUn„tch
(
pPagî
->
fd
, (
i64
)(
pgno
-1Ë*ÖPagî->
∑geSize
, 
pD©a
);

42620  
SQLITE_NOMEM
;

42622 
p
->
pExåa
 = (*)&p[1];

42623 
p
->
Êags
 = 
PGHDR_MMAP
;

42624 
p
->
nRef
 = 1;

42625 
p
->
pPagî
 =ÖPager;

42628 
	`as£π
–
p
->
pExåa
==(*)&p[1] );

42629 
	`as£π
–
p
->
pPage
==0 );

42630 
	`as£π
–
p
->
Êags
==
PGHDR_MMAP
 );

42631 
	`as£π
–
p
->
pPagî
==pPager );

42632 
	`as£π
–
p
->
nRef
==1 );

42634 
p
->
pgno
 =Ögno;

42635 
p
->
pD©a
 =ÖData;

42636 
pPagî
->
nMm≠Out
++;

42638  
SQLITE_OK
;

42645 
	`∑gîRñó£M≠Page
(
PgHdr
 *
pPg
){

42646 
Pagî
 *
pPagî
 = 
pPg
->pPager;

42647 
pPagî
->
nMm≠Out
--;

42648 
pPg
->
pDúty
 = 
pPagî
->
pMm≠Fªñi°
;

42649 
pPagî
->
pMm≠Fªñi°
 = 
pPg
;

42651 
	`as£π
–
pPagî
->
fd
->
pMëhods
->
iVîsi⁄
>=3 );

42652 
	`sqlôe3OsUn„tch
(
pPagî
->
fd
, (
i64
)(
pPg
->
pgno
-1)*pPagî->
∑geSize
,ÖPg->
pD©a
);

42658 
	`∑gîFªeM≠Hdrs
(
Pagî
 *
pPagî
){

42659 
PgHdr
 *
p
;

42660 
PgHdr
 *
pNext
;

42661 
p
=
pPagî
->
pMm≠Fªñi°
;Ö;Ö=
pNext
){

42662 
pNext
 = 
p
->
pDúty
;

42663 
	`sqlôe3_‰ì
(
p
);

42682 
SQLITE_PRIVATE
 
	`sqlôe3PagîClo£
(
Pagî
 *
pPagî
){

42683 
u8
 *
pTmp
 = (u8 *)
pPagî
->
pTmpS∑˚
;

42685 
	`as£π
–
	`as£π_∑gî_°©e
(
pPagî
) );

42686 
	`dißbÀ_simuœãd_io_îr‹s
();

42687 
	`sqlôe3BegöBíignMÆloc
();

42688 
	`∑gîFªeM≠Hdrs
(
pPagî
);

42690 
pPagî
->
ex˛usiveMode
 = 0;

42691 #i‚de‡
SQLITE_OMIT_WAL


42692 
	`sqlôe3WÆClo£
(
pPagî
->
pWÆ
,ÖPagî->
ck±SyncFœgs
,ÖPagî->
∑geSize
, 
pTmp
);

42693 
pPagî
->
pWÆ
 = 0;

42695 
	`∑gî_ª£t
(
pPagî
);

42696 if–
MEMDB
 ){

42697 
	`∑gî_u∆ock
(
pPagî
);

42710 if–
	`isO≥n
(
pPagî
->
jfd
) ){

42711 
	`∑gî_îr‹
(
pPagî
, 
	`∑gîSyncHŸJou∫Æ
(pPager));

42713 
	`∑gîU∆ockAndRﬁlback
(
pPagî
);

42715 
	`sqlôe3EndBíignMÆloc
();

42716 
	`íabÀ_simuœãd_io_îr‹s
();

42717 
	`PAGERTRACE
(("CLOSE %d\n", 
	`PAGERID
(
pPagî
)));

42718 
	`IOTRACE
(("CLOSE %p\n", 
pPagî
))

42719 
	`sqlôe3OsClo£
(
pPagî
->
jfd
);

42720 
	`sqlôe3OsClo£
(
pPagî
->
fd
);

42721 
	`sqlôe3PageFªe
(
pTmp
);

42722 
	`sqlôe3PˇcheClo£
(
pPagî
->
pPCache
);

42724 #ifde‡
SQLITE_HAS_CODEC


42725 if–
pPagî
->
xCodecFªe
 )ÖPagî->
	`xCodecFªe
’Pagî->
pCodec
);

42728 
	`as£π
–!
pPagî
->
aSavïoöt
 && !pPagî->
pInJou∫Æ
 );

42729 
	`as£π
–!
	`isO≥n
(
pPagî
->
jfd
Ë&& !isO≥n’Pagî->
sjfd
) );

42731 
	`sqlôe3_‰ì
(
pPagî
);

42732  
SQLITE_OK
;

42735 #i‡!
	`deföed
(
NDEBUG
Ë|| deföed(
SQLITE_TEST
)

42739 
SQLITE_PRIVATE
 
Pgno
 
	`sqlôe3PagîPagíumbî
(
DbPage
 *
pPg
){

42740  
pPg
->
pgno
;

42747 
SQLITE_PRIVATE
 
	`sqlôe3PagîRef
(
DbPage
 *
pPg
){

42748 
	`sqlôe3PˇcheRef
(
pPg
);

42786 
	`syncJou∫Æ
(
Pagî
 *
pPagî
, 
√wHdr
){

42787 
rc
;

42789 
	`as£π
–
pPagî
->
eSèã
==
PAGER_WRITER_CACHEMOD


42790 || 
pPagî
->
eSèã
==
PAGER_WRITER_DBMOD


42792 
	`as£π
–
	`as£π_∑gî_°©e
(
pPagî
) );

42793 
	`as£π
–!
	`∑gîU£WÆ
(
pPagî
) );

42795 
rc
 = 
	`sqlôe3PagîEx˛usiveLock
(
pPagî
);

42796 if–
rc
!=
SQLITE_OK
 ) Ñc;

42798 if–!
pPagî
->
noSync
 ){

42799 
	`as£π
–!
pPagî
->
ãmpFûe
 );

42800 if–
	`isO≥n
(
pPagî
->
jfd
Ë&&ÖPagî->
jou∫ÆMode
!=
PAGER_JOURNALMODE_MEMORY
 ){

42801 c⁄° 
iDc
 = 
	`sqlôe3OsDevi˚Ch¨a˘îi°ics
(
pPagî
->
fd
);

42802 
	`as£π
–
	`isO≥n
(
pPagî
->
jfd
) );

42804 if–0==(
iDc
&
SQLITE_IOCAP_SAFE_APPEND
) ){

42827 
i64
 
iNextHdrOff£t
;

42828 
u8
 
aMagic
[8];

42829 
u8
 
zHódî
[(
aJou∫ÆMagic
)+4];

42831 
	`mem˝y
(
zHódî
, 
aJou∫ÆMagic
, (aJournalMagic));

42832 
	`put32bôs
(&
zHódî
[(
aJou∫ÆMagic
)], 
pPagî
->
nRec
);

42834 
iNextHdrOff£t
 = 
	`jou∫ÆHdrOff£t
(
pPagî
);

42835 
rc
 = 
	`sqlôe3OsRód
(
pPagî
->
jfd
, 
aMagic
, 8, 
iNextHdrOff£t
);

42836 if–
rc
==
SQLITE_OK
 && 0==
	`memcmp
(
aMagic
, 
aJou∫ÆMagic
, 8) ){

42837 c⁄° 
u8
 
zîobyã
 = 0;

42838 
rc
 = 
	`sqlôe3OsWrôe
(
pPagî
->
jfd
, &
zîobyã
, 1, 
iNextHdrOff£t
);

42840 if–
rc
!=
SQLITE_OK
 &&Ñc!=
SQLITE_IOERR_SHORT_READ
 ){

42841  
rc
;

42855 if–
pPagî
->
fuŒSync
 && 0==(
iDc
&
SQLITE_IOCAP_SEQUENTIAL
) ){

42856 
	`PAGERTRACE
(("SYNC jou∫Æ o‡%d\n", 
	`PAGERID
(
pPagî
)));

42857 
	`IOTRACE
(("JSYNC %p\n", 
pPagî
))

42858 
rc
 = 
	`sqlôe3OsSync
(
pPagî
->
jfd
,ÖPagî->
syncFœgs
);

42859 if–
rc
!=
SQLITE_OK
 ) Ñc;

42861 
	`IOTRACE
(("JHDR %∞%Œd\n", 
pPagî
,ÖPagî->
jou∫ÆHdr
));

42862 
rc
 = 
	`sqlôe3OsWrôe
(

42863 
pPagî
->
jfd
, 
zHódî
, (zHódî),ÖPagî->
jou∫ÆHdr


42865 if–
rc
!=
SQLITE_OK
 ) Ñc;

42867 if–0==(
iDc
&
SQLITE_IOCAP_SEQUENTIAL
) ){

42868 
	`PAGERTRACE
(("SYNC jou∫Æ o‡%d\n", 
	`PAGERID
(
pPagî
)));

42869 
	`IOTRACE
(("JSYNC %p\n", 
pPagî
))

42870 
rc
 = 
	`sqlôe3OsSync
(
pPagî
->
jfd
,ÖPagî->
syncFœgs
|

42871 (
pPagî
->
syncFœgs
==
SQLITE_SYNC_FULL
?
SQLITE_SYNC_DATAONLY
:0)

42873 if–
rc
!=
SQLITE_OK
 ) Ñc;

42876 
pPagî
->
jou∫ÆHdr
 =ÖPagî->
jou∫ÆOff
;

42877 if–
√wHdr
 && 0==(
iDc
&
SQLITE_IOCAP_SAFE_APPEND
) ){

42878 
pPagî
->
nRec
 = 0;

42879 
rc
 = 
	`wrôeJou∫ÆHdr
(
pPagî
);

42880 if–
rc
!=
SQLITE_OK
 ) Ñc;

42883 
pPagî
->
jou∫ÆHdr
 =ÖPagî->
jou∫ÆOff
;

42891 
	`sqlôe3PˇcheCÀ¨SyncFœgs
(
pPagî
->
pPCache
);

42892 
pPagî
->
eSèã
 = 
PAGER_WRITER_DBMOD
;

42893 
	`as£π
–
	`as£π_∑gî_°©e
(
pPagî
) );

42894  
SQLITE_OK
;

42929 
	`∑gî_wrôe_∑gñi°
(
Pagî
 *
pPagî
, 
PgHdr
 *
pLi°
){

42930 
rc
 = 
SQLITE_OK
;

42933 
	`as£π
–!
	`∑gîU£WÆ
(
pPagî
) );

42934 
	`as£π
–
pPagî
->
eSèã
==
PAGER_WRITER_DBMOD
 );

42935 
	`as£π
–
pPagî
->
eLock
==
EXCLUSIVE_LOCK
 );

42941 if–!
	`isO≥n
(
pPagî
->
fd
) ){

42942 
	`as£π
–
pPagî
->
ãmpFûe
 && 
rc
==
SQLITE_OK
 );

42943 
rc
 = 
	`∑gîO≥¡emp
(
pPagî
,ÖPagî->
fd
,ÖPagî->
vfsFœgs
);

42949 
	`as£π
–
rc
!=
SQLITE_OK
 || 
	`isO≥n
(
pPagî
->
fd
) );

42950 if–
rc
==
SQLITE_OK


42951 && 
pPagî
->
dbHötSize
<pPagî->
dbSize


42952 && (
pLi°
->
pDúty
 ||ÖLi°->
pgno
>
pPagî
->
dbHötSize
)

42954 
sqlôe3_öt64
 
szFûe
 = 
pPagî
->
∑geSize
 * (sqlôe3_öt64ÌPagî->
dbSize
;

42955 
	`sqlôe3OsFûeC⁄åﬁHöt
(
pPagî
->
fd
, 
SQLITE_FCNTL_SIZE_HINT
, &
szFûe
);

42956 
pPagî
->
dbHötSize
 =ÖPagî->
dbSize
;

42959  
rc
==
SQLITE_OK
 && 
pLi°
 ){

42960 
Pgno
 
pgno
 = 
pLi°
->pgno;

42970 if–
pgno
<=
pPagî
->
dbSize
 && 0==(
pLi°
->
Êags
&
PGHDR_DONT_WRITE
) ){

42971 
i64
 
off£t
 = (
pgno
-1)*(i64)
pPagî
->
∑geSize
;

42972 *
pD©a
;

42974 
	`as£π
–(
pLi°
->
Êags
&
PGHDR_NEED_SYNC
)==0 );

42975 if–
pLi°
->
pgno
==1 ) 
	`∑gî_wrôe_ch™gecou¡î
(pList);

42978 
	`CODEC2
(
pPagî
, 
pLi°
->
pD©a
, 
pgno
, 6,  
SQLITE_NOMEM
,ÖData);

42981 
rc
 = 
	`sqlôe3OsWrôe
(
pPagî
->
fd
, 
pD©a
,ÖPagî->
∑geSize
, 
off£t
);

42987 if–
pgno
==1 ){

42988 
	`mem˝y
(&
pPagî
->
dbFûeVîs
, &
pD©a
[24], (pPager->dbFileVers));

42990 if–
pgno
>
pPagî
->
dbFûeSize
 ){

42991 
pPagî
->
dbFûeSize
 = 
pgno
;

42993 
pPagî
->
aSèt
[
PAGER_STAT_WRITE
]++;

42996 
	`sqlôe3BackupUpd©e
(
pPagî
->
pBackup
, 
pgno
, (
u8
*)
pLi°
->
pD©a
);

42998 
	`PAGERTRACE
(("STORE %dÖage %d hash(%08x)\n",

42999 
	`PAGERID
(
pPagî
), 
pgno
, 
	`∑gî_∑gehash
(
pLi°
)));

43000 
	`IOTRACE
(("PGOUT %∞%d\n", 
pPagî
, 
pgno
));

43001 
	`PAGER_INCR
(
sqlôe3_∑gî_wrôedb_cou¡
);

43003 
	`PAGERTRACE
(("NOSTORE %dÖagê%d\n", 
	`PAGERID
(
pPagî
), 
pgno
));

43005 
	`∑gî_£t_∑gehash
(
pLi°
);

43006 
pLi°
 =ÖLi°->
pDúty
;

43009  
rc
;

43020 
	`›íSubJou∫Æ
(
Pagî
 *
pPagî
){

43021 
rc
 = 
SQLITE_OK
;

43022 if–!
	`isO≥n
(
pPagî
->
sjfd
) ){

43023 if–
pPagî
->
jou∫ÆMode
==
PAGER_JOURNALMODE_MEMORY
 ||ÖPagî->
subjInMem‹y
 ){

43024 
	`sqlôe3MemJou∫ÆO≥n
(
pPagî
->
sjfd
);

43026 
rc
 = 
	`∑gîO≥¡emp
(
pPagî
,ÖPagî->
sjfd
, 
SQLITE_OPEN_SUBJOURNAL
);

43029  
rc
;

43045 
	`subjou∫ÆPage
(
PgHdr
 *
pPg
){

43046 
rc
 = 
SQLITE_OK
;

43047 
Pagî
 *
pPagî
 = 
pPg
->pPager;

43048 if–
pPagî
->
jou∫ÆMode
!=
PAGER_JOURNALMODE_OFF
 ){

43051 
	`as£π
–
pPagî
->
u£Jou∫Æ
 );

43052 
	`as£π
–
	`isO≥n
(
pPagî
->
jfd
Ë|| 
	`∑gîU£WÆ
(pPager) );

43053 
	`as£π
–
	`isO≥n
(
pPagî
->
sjfd
Ë||ÖPagî->
nSubRec
==0 );

43054 
	`as£π
–
	`∑gîU£WÆ
(
pPagî
)

43055 || 
	`∑geInJou∫Æ
(
pPg
)

43056 || 
pPg
->
pgno
>
pPagî
->
dbOrigSize


43058 
rc
 = 
	`›íSubJou∫Æ
(
pPagî
);

43062 if–
rc
==
SQLITE_OK
 ){

43063 *
pD©a
 = 
pPg
->pData;

43064 
i64
 
off£t
 = (i64)
pPagî
->
nSubRec
*(4+pPagî->
∑geSize
);

43065 *
pD©a2
;

43067 
	`CODEC2
(
pPagî
, 
pD©a
, 
pPg
->
pgno
, 7,  
SQLITE_NOMEM
, 
pD©a2
);

43068 
	`PAGERTRACE
(("STMT-JOURNAL %dÖagê%d\n", 
	`PAGERID
(
pPagî
), 
pPg
->
pgno
));

43069 
rc
 = 
	`wrôe32bôs
(
pPagî
->
sjfd
, 
off£t
, 
pPg
->
pgno
);

43070 if–
rc
==
SQLITE_OK
 ){

43071 
rc
 = 
	`sqlôe3OsWrôe
(
pPagî
->
sjfd
, 
pD©a2
,ÖPagî->
∑geSize
, 
off£t
+4);

43075 if–
rc
==
SQLITE_OK
 ){

43076 
pPagî
->
nSubRec
++;

43077 
	`as£π
–
pPagî
->
nSavïoöt
>0 );

43078 
rc
 = 
	`addToSavïoötBôvecs
(
pPagî
, 
pPg
->
pgno
);

43080  
rc
;

43102 
	`∑gîSåess
(*
p
, 
PgHdr
 *
pPg
){

43103 
Pagî
 *
pPagî
 = (Pagî *)
p
;

43104 
rc
 = 
SQLITE_OK
;

43106 
	`as£π
–
pPg
->
pPagî
==pPager );

43107 
	`as£π
–
pPg
->
Êags
&
PGHDR_DIRTY
 );

43125 if–
	`NEVER
(
pPagî
->
îrCode
ËË 
SQLITE_OK
;

43126 
	`ã°ˇ£
–
pPagî
->
doNŸSpûl
 & 
SPILLFLAG_ROLLBACK
 );

43127 
	`ã°ˇ£
–
pPagî
->
doNŸSpûl
 & 
SPILLFLAG_OFF
 );

43128 
	`ã°ˇ£
–
pPagî
->
doNŸSpûl
 & 
SPILLFLAG_NOSYNC
 );

43129 if–
pPagî
->
doNŸSpûl


43130 && ((
pPagî
->
doNŸSpûl
 & (
SPILLFLAG_ROLLBACK
|
SPILLFLAG_OFF
))!=0

43131 || (
pPg
->
Êags
 & 
PGHDR_NEED_SYNC
)!=0)

43133  
SQLITE_OK
;

43136 
pPg
->
pDúty
 = 0;

43137 if–
	`∑gîU£WÆ
(
pPagî
) ){

43139 if–
	`subjRequúesPage
(
pPg
) ){

43140 
rc
 = 
	`subjou∫ÆPage
(
pPg
);

43142 if–
rc
==
SQLITE_OK
 ){

43143 
rc
 = 
	`∑gîWÆFømes
(
pPagî
, 
pPg
, 0, 0);

43148 if–
pPg
->
Êags
&
PGHDR_NEED_SYNC


43149 || 
pPagî
->
eSèã
==
PAGER_WRITER_CACHEMOD


43151 
rc
 = 
	`syncJou∫Æ
(
pPagî
, 1);

43181 if–
	`NEVER
(

43182 
rc
==
SQLITE_OK
 && 
pPg
->
pgno
>
pPagî
->
dbSize
 && 
	`subjRequúesPage
(pPg)

43184 
rc
 = 
	`subjou∫ÆPage
(
pPg
);

43188 if–
rc
==
SQLITE_OK
 ){

43189 
	`as£π
–(
pPg
->
Êags
&
PGHDR_NEED_SYNC
)==0 );

43190 
rc
 = 
	`∑gî_wrôe_∑gñi°
(
pPagî
, 
pPg
);

43195 if–
rc
==
SQLITE_OK
 ){

43196 
	`PAGERTRACE
(("STRESS %dÖagê%d\n", 
	`PAGERID
(
pPagî
), 
pPg
->
pgno
));

43197 
	`sqlôe3PˇcheMakeCÀ™
(
pPg
);

43200  
	`∑gî_îr‹
(
pPagî
, 
rc
);

43234 
SQLITE_PRIVATE
 
	`sqlôe3PagîO≥n
(

43235 
sqlôe3_vfs
 *
pVfs
,

43236 
Pagî
 **
µPagî
,

43237 c⁄° *
zFûíame
,

43238 
nExåa
,

43239 
Êags
,

43240 
vfsFœgs
,

43241 (*
xReöô
)(
DbPage
*)

43243 
u8
 *
pPå
;

43244 
Pagî
 *
pPagî
 = 0;

43245 
rc
 = 
SQLITE_OK
;

43246 
ãmpFûe
 = 0;

43247 
memDb
 = 0;

43248 
ªadO∆y
 = 0;

43249 
jou∫ÆFûeSize
;

43250 *
zP©h«me
 = 0;

43251 
nP©h«me
 = 0;

43252 
u£Jou∫Æ
 = (
Êags
 & 
PAGER_OMIT_JOURNAL
)==0;

43253 
pˇcheSize
 = 
	`sqlôe3PˇcheSize
();

43254 
u32
 
szPageDÊt
 = 
SQLITE_DEFAULT_PAGE_SIZE
;

43255 c⁄° *
zUri
 = 0;

43256 
nUri
 = 0;

43266 if–
	`sqlôe3Jou∫ÆSize
(
pVfs
)>
	`sqlôe3MemJou∫ÆSize
() ){

43267 
jou∫ÆFûeSize
 = 
	`ROUND8
(
	`sqlôe3Jou∫ÆSize
(
pVfs
));

43269 
jou∫ÆFûeSize
 = 
	`ROUND8
(
	`sqlôe3MemJou∫ÆSize
());

43273 *
µPagî
 = 0;

43275 #i‚de‡
SQLITE_OMIT_MEMORYDB


43276 if–
Êags
 & 
PAGER_MEMORY
 ){

43277 
memDb
 = 1;

43278 if–
zFûíame
 && zFilename[0] ){

43279 
zP©h«me
 = 
	`sqlôe3DbSåDup
(0, 
zFûíame
);

43280 if–
zP©h«me
==0 )  
SQLITE_NOMEM
;

43281 
nP©h«me
 = 
	`sqlôe3SåÀn30
(
zP©h«me
);

43282 
zFûíame
 = 0;

43291 if–
zFûíame
 && zFilename[0] ){

43292 c⁄° *
z
;

43293 
nP©h«me
 = 
pVfs
->
mxP©h«me
+1;

43294 
zP©h«me
 = 
	`sqlôe3DbMÆlocRaw
(0, 
nP©h«me
*2);

43295 if–
zP©h«me
==0 ){

43296  
SQLITE_NOMEM
;

43298 
zP©h«me
[0] = 0;

43299 
rc
 = 
	`sqlôe3OsFuŒP©h«me
(
pVfs
, 
zFûíame
, 
nP©h«me
, 
zP©h«me
);

43300 
nP©h«me
 = 
	`sqlôe3SåÀn30
(
zP©h«me
);

43301 
z
 = 
zUri
 = &
zFûíame
[
	`sqlôe3SåÀn30
(zFilename)+1];

43302  *
z
 ){

43303 
z
 +
	`sqlôe3SåÀn30
(z)+1;

43304 
z
 +
	`sqlôe3SåÀn30
(z)+1;

43306 
nUri
 = ()(&
z
[1] - 
zUri
);

43307 
	`as£π
–
nUri
>=0 );

43308 if–
rc
==
SQLITE_OK
 && 
nP©h«me
+8>
pVfs
->
mxP©h«me
 ){

43315 
rc
 = 
SQLITE_CANTOPEN_BKPT
;

43317 if–
rc
!=
SQLITE_OK
 ){

43318 
	`sqlôe3DbFªe
(0, 
zP©h«me
);

43319  
rc
;

43335 
pPå
 = (
u8
 *)
	`sqlôe3MÆlocZîo
(

43336 
	`ROUND8
((*
pPagî
)) +

43337 
	`ROUND8
(
pˇcheSize
) +

43338 
	`ROUND8
(
pVfs
->
szOsFûe
) +

43339 
jou∫ÆFûeSize
 * 2 +

43340 
nP©h«me
 + 1 + 
nUri
 +

43341 
nP©h«me
 + 8 + 2

43342 #i‚de‡
SQLITE_OMIT_WAL


43343 + 
nP©h«me
 + 4 + 2

43346 
	`as£π
–
	`EIGHT_BYTE_ALIGNMENT
(
	`SQLITE_INT_TO_PTR
(
jou∫ÆFûeSize
)) );

43347 if–!
pPå
 ){

43348 
	`sqlôe3DbFªe
(0, 
zP©h«me
);

43349  
SQLITE_NOMEM
;

43351 
pPagî
 = (
Pagî
*)(
pPå
);

43352 
pPagî
->
pPCache
 = (
PCache
*)(
pPå
 +
	`ROUND8
((*pPager)));

43353 
pPagî
->
fd
 = (
sqlôe3_fûe
*)(
pPå
 +
	`ROUND8
(
pˇcheSize
));

43354 
pPagî
->
sjfd
 = (
sqlôe3_fûe
*)(
pPå
 +
	`ROUND8
(
pVfs
->
szOsFûe
));

43355 
pPagî
->
jfd
 = (
sqlôe3_fûe
*)(
pPå
 +
jou∫ÆFûeSize
);

43356 
pPagî
->
zFûíame
 = (*)(
pPå
 +
jou∫ÆFûeSize
);

43357 
	`as£π
–
	`EIGHT_BYTE_ALIGNMENT
(
pPagî
->
jfd
) );

43360 if–
zP©h«me
 ){

43361 
	`as£π
–
nP©h«me
>0 );

43362 
pPagî
->
zJou∫Æ
 = (*)(
pPå
 +
nP©h«me
 + 1 + 
nUri
);

43363 
	`mem˝y
(
pPagî
->
zFûíame
, 
zP©h«me
, 
nP©h«me
);

43364 if–
nUri
 ) 
	`mem˝y
(&
pPagî
->
zFûíame
[
nP©h«me
+1], 
zUri
,ÇUri);

43365 
	`mem˝y
(
pPagî
->
zJou∫Æ
, 
zP©h«me
, 
nP©h«me
);

43366 
	`mem˝y
(&
pPagî
->
zJou∫Æ
[
nP©h«me
], "-journal\000", 8+2);

43367 
	`sqlôe3FûeSuffix3
(
pPagî
->
zFûíame
,ÖPagî->
zJou∫Æ
);

43368 #i‚de‡
SQLITE_OMIT_WAL


43369 
pPagî
->
zWÆ
 = &pPagî->
zJou∫Æ
[
nP©h«me
+8+1];

43370 
	`mem˝y
(
pPagî
->
zWÆ
, 
zP©h«me
, 
nP©h«me
);

43371 
	`mem˝y
(&
pPagî
->
zWÆ
[
nP©h«me
], "-wal\000", 4+1);

43372 
	`sqlôe3FûeSuffix3
(
pPagî
->
zFûíame
,ÖPagî->
zWÆ
);

43374 
	`sqlôe3DbFªe
(0, 
zP©h«me
);

43376 
pPagî
->
pVfs
 =ÖVfs;

43377 
pPagî
->
vfsFœgs
 = vfsFlags;

43381 if–
zFûíame
 && zFilename[0] ){

43382 
fout
 = 0;

43383 
rc
 = 
	`sqlôe3OsO≥n
(
pVfs
, 
pPagî
->
zFûíame
,ÖPagî->
fd
, 
vfsFœgs
, &
fout
);

43384 
	`as£π
–!
memDb
 );

43385 
ªadO∆y
 = (
fout
&
SQLITE_OPEN_READONLY
);

43395 if–
rc
==
SQLITE_OK
 && !
ªadO∆y
 ){

43396 
	`£tSe˘‹Size
(
pPagî
);

43397 
	`as£π
(
SQLITE_DEFAULT_PAGE_SIZE
<=
SQLITE_MAX_DEFAULT_PAGE_SIZE
);

43398 if–
szPageDÊt
<
pPagî
->
£˘‹Size
 ){

43399 if–
pPagî
->
£˘‹Size
>
SQLITE_MAX_DEFAULT_PAGE_SIZE
 ){

43400 
szPageDÊt
 = 
SQLITE_MAX_DEFAULT_PAGE_SIZE
;

43402 
szPageDÊt
 = (
u32
)
pPagî
->
£˘‹Size
;

43405 #ifde‡
SQLITE_ENABLE_ATOMIC_WRITE


43407 
iDc
 = 
	`sqlôe3OsDevi˚Ch¨a˘îi°ics
(
pPagî
->
fd
);

43408 
ii
;

43409 
	`as£π
(
SQLITE_IOCAP_ATOMIC512
==(512>>8));

43410 
	`as£π
(
SQLITE_IOCAP_ATOMIC64K
==(65536>>8));

43411 
	`as£π
(
SQLITE_MAX_DEFAULT_PAGE_SIZE
<=65536);

43412 
ii
=
szPageDÊt
; ii<=
SQLITE_MAX_DEFAULT_PAGE_SIZE
; ii=ii*2){

43413 if–
iDc
&(
SQLITE_IOCAP_ATOMIC
|(
ii
>>8)) ){

43414 
szPageDÊt
 = 
ii
;

43429 
ãmpFûe
 = 1;

43430 
pPagî
->
eSèã
 = 
PAGER_READER
;

43431 
pPagî
->
eLock
 = 
EXCLUSIVE_LOCK
;

43432 
ªadO∆y
 = (
vfsFœgs
&
SQLITE_OPEN_READONLY
);

43438 if–
rc
==
SQLITE_OK
 ){

43439 
	`as£π
–
pPagî
->
memDb
==0 );

43440 
rc
 = 
	`sqlôe3PagîSëPagesize
(
pPagî
, &
szPageDÊt
, -1);

43441 
	`ã°ˇ£
–
rc
!=
SQLITE_OK
 );

43447 if–
rc
!=
SQLITE_OK
 ){

43448 
	`as£π
–!
pPagî
->
pTmpS∑˚
 );

43449 
	`sqlôe3OsClo£
(
pPagî
->
fd
);

43450 
	`sqlôe3_‰ì
(
pPagî
);

43451  
rc
;

43455 
	`as£π
–
nExåa
<1000 );

43456 
nExåa
 = 
	`ROUND8
(nExtra);

43457 
	`sqlôe3PˇcheO≥n
(
szPageDÊt
, 
nExåa
, !
memDb
,

43458 !
memDb
?
∑gîSåess
:0, (*)
pPagî
,ÖPagî->
pPCache
);

43460 
	`PAGERTRACE
(("OPEN %d %s\n", 
	`FILEHANDLEID
(
pPagî
->
fd
),ÖPagî->
zFûíame
));

43461 
	`IOTRACE
(("OPEN %∞%s\n", 
pPagî
,ÖPagî->
zFûíame
))

43463 
pPagî
->
u£Jou∫Æ
 = (
u8
)useJournal;

43470 
pPagî
->
mxPgno
 = 
SQLITE_MAX_PAGE_COUNT
;

43473 
	`as£π
–
pPagî
->
°©e
 =(
ãmpFûe
 ? 
PAGER_EXCLUSIVE
 : 
PAGER_UNLOCK
) );

43476 
pPagî
->
ãmpFûe
 = (
u8
)tempFile;

43477 
	`as£π
–
ãmpFûe
==
PAGER_LOCKINGMODE_NORMAL


43478 || 
ãmpFûe
==
PAGER_LOCKINGMODE_EXCLUSIVE
 );

43479 
	`as£π
–
PAGER_LOCKINGMODE_EXCLUSIVE
==1 );

43480 
pPagî
->
ex˛usiveMode
 = (
u8
)
ãmpFûe
;

43481 
pPagî
->
ch™geCou¡D⁄e
 =ÖPagî->
ãmpFûe
;

43482 
pPagî
->
memDb
 = (
u8
)memDb;

43483 
pPagî
->
ªadO∆y
 = (
u8
)readOnly;

43484 
	`as£π
–
u£Jou∫Æ
 || 
pPagî
->
ãmpFûe
 );

43485 
pPagî
->
noSync
 =ÖPagî->
ãmpFûe
;

43486 if–
pPagî
->
noSync
 ){

43487 
	`as£π
–
pPagî
->
fuŒSync
==0 );

43488 
	`as£π
–
pPagî
->
syncFœgs
==0 );

43489 
	`as£π
–
pPagî
->
wÆSyncFœgs
==0 );

43490 
	`as£π
–
pPagî
->
ck±SyncFœgs
==0 );

43492 
pPagî
->
fuŒSync
 = 1;

43493 
pPagî
->
syncFœgs
 = 
SQLITE_SYNC_NORMAL
;

43494 
pPagî
->
wÆSyncFœgs
 = 
SQLITE_SYNC_NORMAL
 | 
WAL_SYNC_TRANSACTIONS
;

43495 
pPagî
->
ck±SyncFœgs
 = 
SQLITE_SYNC_NORMAL
;

43500 
pPagî
->
nExåa
 = (
u16
)nExtra;

43501 
pPagî
->
jou∫ÆSizeLimô
 = 
SQLITE_DEFAULT_JOURNAL_SIZE_LIMIT
;

43502 
	`as£π
–
	`isO≥n
(
pPagî
->
fd
Ë|| 
ãmpFûe
 );

43503 
	`£tSe˘‹Size
(
pPagî
);

43504 if–!
u£Jou∫Æ
 ){

43505 
pPagî
->
jou∫ÆMode
 = 
PAGER_JOURNALMODE_OFF
;

43506 }if–
memDb
 ){

43507 
pPagî
->
jou∫ÆMode
 = 
PAGER_JOURNALMODE_MEMORY
;

43511 
pPagî
->
xReöôî
 = 
xReöô
;

43515 *
µPagî
 = 
pPagî
;

43516  
SQLITE_OK
;

43552 
	`hasHŸJou∫Æ
(
Pagî
 *
pPagî
, *
pExi°s
){

43553 
sqlôe3_vfs
 * c⁄° 
pVfs
 = 
pPagî
->pVfs;

43554 
rc
 = 
SQLITE_OK
;

43555 
exi°s
 = 1;

43556 
j∫lO≥n
 = !!
	`isO≥n
(
pPagî
->
jfd
);

43558 
	`as£π
–
pPagî
->
u£Jou∫Æ
 );

43559 
	`as£π
–
	`isO≥n
(
pPagî
->
fd
) );

43560 
	`as£π
–
pPagî
->
eSèã
==
PAGER_OPEN
 );

43562 
	`as£π
–
j∫lO≥n
==0 || ( 
	`sqlôe3OsDevi˚Ch¨a˘îi°ics
(
pPagî
->
jfd
) &

43563 
SQLITE_IOCAP_UNDELETABLE_WHEN_OPEN


43566 *
pExi°s
 = 0;

43567 if–!
j∫lO≥n
 ){

43568 
rc
 = 
	`sqlôe3OsAc˚ss
(
pVfs
, 
pPagî
->
zJou∫Æ
, 
SQLITE_ACCESS_EXISTS
, &
exi°s
);

43570 if–
rc
==
SQLITE_OK
 && 
exi°s
 ){

43571 
locked
 = 0;

43581 
rc
 = 
	`sqlôe3OsCheckRe£rvedLock
(
pPagî
->
fd
, &
locked
);

43582 if–
rc
==
SQLITE_OK
 && !
locked
 ){

43583 
Pgno
 
nPage
;

43591 
rc
 = 
	`∑gîPagecou¡
(
pPagî
, &
nPage
);

43592 if–
rc
==
SQLITE_OK
 ){

43593 if–
nPage
==0 ){

43594 
	`sqlôe3BegöBíignMÆloc
();

43595 if–
	`∑gîLockDb
(
pPagî
, 
RESERVED_LOCK
)==
SQLITE_OK
 ){

43596 
	`sqlôe3OsDñëe
(
pVfs
, 
pPagî
->
zJou∫Æ
, 0);

43597 if–!
pPagî
->
ex˛usiveMode
 ) 
	`∑gîU∆ockDb
’Pagî, 
SHARED_LOCK
);

43599 
	`sqlôe3EndBíignMÆloc
();

43607 if–!
j∫lO≥n
 ){

43608 
f
 = 
SQLITE_OPEN_READONLY
|
SQLITE_OPEN_MAIN_JOURNAL
;

43609 
rc
 = 
	`sqlôe3OsO≥n
(
pVfs
, 
pPagî
->
zJou∫Æ
,ÖPagî->
jfd
, 
f
, &f);

43611 if–
rc
==
SQLITE_OK
 ){

43612 
u8
 
fú°
 = 0;

43613 
rc
 = 
	`sqlôe3OsRód
(
pPagî
->
jfd
, (*)&
fú°
, 1, 0);

43614 if–
rc
==
SQLITE_IOERR_SHORT_READ
 ){

43615 
rc
 = 
SQLITE_OK
;

43617 if–!
j∫lO≥n
 ){

43618 
	`sqlôe3OsClo£
(
pPagî
->
jfd
);

43620 *
pExi°s
 = (
fú°
!=0);

43621 }if–
rc
==
SQLITE_CANTOPEN
 ){

43631 *
pExi°s
 = 1;

43632 
rc
 = 
SQLITE_OK
;

43639  
rc
;

43669 
SQLITE_PRIVATE
 
	`sqlôe3PagîSh¨edLock
(
Pagî
 *
pPagî
){

43670 
rc
 = 
SQLITE_OK
;

43677 
	`as£π
–
	`sqlôe3PˇcheRefCou¡
(
pPagî
->
pPCache
)==0 );

43678 
	`as£π
–
	`as£π_∑gî_°©e
(
pPagî
) );

43679 
	`as£π
–
pPagî
->
eSèã
==
PAGER_OPEN
 ||ÖPagî->eSèã==
PAGER_READER
 );

43680 if–
	`NEVER
(
MEMDB
 && 
pPagî
->
îrCode
) ){ ÖPager->errCode; }

43682 if–!
	`∑gîU£WÆ
(
pPagî
Ë&&ÖPagî->
eSèã
==
PAGER_OPEN
 ){

43683 
bHŸJou∫Æ
 = 1;

43685 
	`as£π
–!
MEMDB
 );

43687 
rc
 = 
	`∑gî_waô_⁄_lock
(
pPagî
, 
SHARED_LOCK
);

43688 if–
rc
!=
SQLITE_OK
 ){

43689 
	`as£π
–
pPagî
->
eLock
==
NO_LOCK
 ||ÖPagî->eLock==
UNKNOWN_LOCK
 );

43690 
Áûed
;

43696 if–
pPagî
->
eLock
<=
SHARED_LOCK
 ){

43697 
rc
 = 
	`hasHŸJou∫Æ
(
pPagî
, &
bHŸJou∫Æ
);

43699 if–
rc
!=
SQLITE_OK
 ){

43700 
Áûed
;

43702 if–
bHŸJou∫Æ
 ){

43703 if–
pPagî
->
ªadO∆y
 ){

43704 
rc
 = 
SQLITE_READONLY_ROLLBACK
;

43705 
Áûed
;

43723 
rc
 = 
	`∑gîLockDb
(
pPagî
, 
EXCLUSIVE_LOCK
);

43724 if–
rc
!=
SQLITE_OK
 ){

43725 
Áûed
;

43741 if–!
	`isO≥n
(
pPagî
->
jfd
) ){

43742 
sqlôe3_vfs
 * c⁄° 
pVfs
 = 
pPagî
->pVfs;

43743 
bExi°s
;

43744 
rc
 = 
	`sqlôe3OsAc˚ss
(

43745 
pVfs
, 
pPagî
->
zJou∫Æ
, 
SQLITE_ACCESS_EXISTS
, &
bExi°s
);

43746 if–
rc
==
SQLITE_OK
 && 
bExi°s
 ){

43747 
fout
 = 0;

43748 
f
 = 
SQLITE_OPEN_READWRITE
|
SQLITE_OPEN_MAIN_JOURNAL
;

43749 
	`as£π
–!
pPagî
->
ãmpFûe
 );

43750 
rc
 = 
	`sqlôe3OsO≥n
(
pVfs
, 
pPagî
->
zJou∫Æ
,ÖPagî->
jfd
, 
f
, &
fout
);

43751 
	`as£π
–
rc
!=
SQLITE_OK
 || 
	`isO≥n
(
pPagî
->
jfd
) );

43752 if–
rc
==
SQLITE_OK
 && 
fout
&
SQLITE_OPEN_READONLY
 ){

43753 
rc
 = 
SQLITE_CANTOPEN_BKPT
;

43754 
	`sqlôe3OsClo£
(
pPagî
->
jfd
);

43767 if–
	`isO≥n
(
pPagî
->
jfd
) ){

43768 
	`as£π
–
rc
==
SQLITE_OK
 );

43769 
rc
 = 
	`∑gîSyncHŸJou∫Æ
(
pPagî
);

43770 if–
rc
==
SQLITE_OK
 ){

43771 
rc
 = 
	`∑gî_∂ayback
(
pPagî
, 1);

43772 
pPagî
->
eSèã
 = 
PAGER_OPEN
;

43774 }if–!
pPagî
->
ex˛usiveMode
 ){

43775 
	`∑gîU∆ockDb
(
pPagî
, 
SHARED_LOCK
);

43778 if–
rc
!=
SQLITE_OK
 ){

43795 
	`∑gî_îr‹
(
pPagî
, 
rc
);

43796 
Áûed
;

43799 
	`as£π
–
pPagî
->
eSèã
==
PAGER_OPEN
 );

43800 
	`as£π
–(
pPagî
->
eLock
==
SHARED_LOCK
)

43801 || (
pPagî
->
ex˛usiveMode
 &&ÖPagî->
eLock
>
SHARED_LOCK
)

43805 if–!
pPagî
->
ãmpFûe
 && (

43806 
pPagî
->
pBackup


43807 || 
	`sqlôe3PˇchePagecou¡
(
pPagî
->
pPCache
)>0

43808 || 
	`USEFETCH
(
pPagî
)

43826 
Pgno
 
nPage
 = 0;

43827 
dbFûeVîs
[(
pPagî
->dbFileVers)];

43829 
rc
 = 
	`∑gîPagecou¡
(
pPagî
, &
nPage
);

43830 if–
rc
 ) 
Áûed
;

43832 if–
nPage
>0 ){

43833 
	`IOTRACE
(("CKVERS %∞%d\n", 
pPagî
, (
dbFûeVîs
)));

43834 
rc
 = 
	`sqlôe3OsRód
(
pPagî
->
fd
, &
dbFûeVîs
, (dbFileVers), 24);

43835 if–
rc
!=
SQLITE_OK
 &&Ñc!=
SQLITE_IOERR_SHORT_READ
 ){

43836 
Áûed
;

43839 
	`mem£t
(
dbFûeVîs
, 0, (dbFileVers));

43842 if–
	`memcmp
(
pPagî
->
dbFûeVîs
, dbFileVers, (dbFileVers))!=0 ){

43843 
	`∑gî_ª£t
(
pPagî
);

43851 if–
	`USEFETCH
(
pPagî
) ){

43852 
	`sqlôe3OsUn„tch
(
pPagî
->
fd
, 0, 0);

43860 
rc
 = 
	`∑gîO≥nWÆIfPª£¡
(
pPagî
);

43861 #i‚de‡
SQLITE_OMIT_WAL


43862 
	`as£π
–
pPagî
->
pWÆ
==0 || 
rc
==
SQLITE_OK
 );

43866 if–
	`∑gîU£WÆ
(
pPagî
) ){

43867 
	`as£π
–
rc
==
SQLITE_OK
 );

43868 
rc
 = 
	`∑gîBegöRódTønß˘i⁄
(
pPagî
);

43871 if–
pPagî
->
eSèã
==
PAGER_OPEN
 && 
rc
==
SQLITE_OK
 ){

43872 
rc
 = 
	`∑gîPagecou¡
(
pPagî
, &pPagî->
dbSize
);

43875 
Áûed
:

43876 if–
rc
!=
SQLITE_OK
 ){

43877 
	`as£π
–!
MEMDB
 );

43878 
	`∑gî_u∆ock
(
pPagî
);

43879 
	`as£π
–
pPagî
->
eSèã
==
PAGER_OPEN
 );

43881 
pPagî
->
eSèã
 = 
PAGER_READER
;

43883  
rc
;

43894 
	`∑gîU∆ockIfUnu£d
(
Pagî
 *
pPagî
){

43895 if–
pPagî
->
nMm≠Out
==0 && (
	`sqlôe3PˇcheRefCou¡
’Pagî->
pPCache
)==0) ){

43896 
	`∑gîU∆ockAndRﬁlback
(
pPagî
);

43950 
SQLITE_PRIVATE
 
	`sqlôe3PagîAcquúe
(

43951 
Pagî
 *
pPagî
,

43952 
Pgno
 
pgno
,

43953 
DbPage
 **
µPage
,

43954 
Êags


43956 
rc
 = 
SQLITE_OK
;

43957 
PgHdr
 *
pPg
 = 0;

43958 
u32
 
iFøme
 = 0;

43959 c⁄° 
noC⁄ã¡
 = (
Êags
 & 
PAGER_GET_NOCONTENT
);

43965 c⁄° 
bMm≠Ok
 = (
pgno
!=1 && 
	`USEFETCH
(
pPagî
)

43966 && (
pPagî
->
eSèã
==
PAGER_READER
 || (
Êags
 & 
PAGER_GET_READONLY
))

43967 #ifde‡
SQLITE_HAS_CODEC


43968 && 
pPagî
->
xCodec
==0

43972 
	`as£π
–
pPagî
->
eSèã
>=
PAGER_READER
 );

43973 
	`as£π
–
	`as£π_∑gî_°©e
(
pPagî
) );

43974 
	`as£π
–
noC⁄ã¡
==0 || 
bMm≠Ok
==0 );

43976 if–
pgno
==0 ){

43977  
SQLITE_CORRUPT_BKPT
;

43982 if–
pPagî
->
îrCode
!=
SQLITE_OK
 ){

43983 
rc
 = 
pPagî
->
îrCode
;

43986 if–
bMm≠Ok
 && 
	`∑gîU£WÆ
(
pPagî
) ){

43987 
rc
 = 
	`sqlôe3WÆFödFøme
(
pPagî
->
pWÆ
, 
pgno
, &
iFøme
);

43988 if–
rc
!=
SQLITE_OK
 ) 
∑gî_acquúe_îr
;

43991 if–
iFøme
==0 && 
bMm≠Ok
 ){

43992 *
pD©a
 = 0;

43994 
rc
 = 
	`sqlôe3OsFëch
(
pPagî
->
fd
,

43995 (
i64
)(
pgno
-1Ë* 
pPagî
->
∑geSize
,ÖPagî->∑geSize, &
pD©a


43998 if–
rc
==
SQLITE_OK
 && 
pD©a
 ){

43999 if–
pPagî
->
eSèã
>
PAGER_READER
 ){

44000 ()
	`sqlôe3PˇcheFëch
(
pPagî
->
pPCache
, 
pgno
, 0, &
pPg
);

44002 if–
pPg
==0 ){

44003 
rc
 = 
	`∑gîAcquúeM≠Page
(
pPagî
, 
pgno
, 
pD©a
, &
pPg
);

44005 
	`sqlôe3OsUn„tch
(
pPagî
->
fd
, (
i64
)(
pgno
-1)*pPagî->
∑geSize
, 
pD©a
);

44007 if–
pPg
 ){

44008 
	`as£π
–
rc
==
SQLITE_OK
 );

44009 *
µPage
 = 
pPg
;

44010  
SQLITE_OK
;

44013 if–
rc
!=
SQLITE_OK
 ){

44014 
∑gî_acquúe_îr
;

44018 
rc
 = 
	`sqlôe3PˇcheFëch
(
pPagî
->
pPCache
, 
pgno
, 1, 
µPage
);

44021 if–
rc
!=
SQLITE_OK
 ){

44025 
pPg
 = 0;

44026 
∑gî_acquúe_îr
;

44028 
	`as£π
–(*
µPage
)->
pgno
==pgno );

44029 
	`as£π
–(*
µPage
)->
pPagî
==pPager || (*ppPage)->pPager==0 );

44031 if–(*
µPage
)->
pPagî
 && !
noC⁄ã¡
 ){

44034 
	`as£π
–
pgno
<=
PAGER_MAX_PGNO
 &&Ögno!=
	`PAGER_MJ_PGNO
(
pPagî
) );

44035 
pPagî
->
aSèt
[
PAGER_STAT_HIT
]++;

44036  
SQLITE_OK
;

44042 
pPg
 = *
µPage
;

44043 
pPg
->
pPagî
 =ÖPager;

44047 if–
pgno
>
PAGER_MAX_PGNO
 ||Ögno==
	`PAGER_MJ_PGNO
(
pPagî
) ){

44048 
rc
 = 
SQLITE_CORRUPT_BKPT
;

44049 
∑gî_acquúe_îr
;

44052 if–
MEMDB
 || 
pPagî
->
dbSize
<
pgno
 || 
noC⁄ã¡
 || !
	`isO≥n
’Pagî->
fd
) ){

44053 if–
pgno
>
pPagî
->
mxPgno
 ){

44054 
rc
 = 
SQLITE_FULL
;

44055 
∑gî_acquúe_îr
;

44057 if–
noC⁄ã¡
 ){

44064 
	`sqlôe3BegöBíignMÆloc
();

44065 if–
pgno
<=
pPagî
->
dbOrigSize
 ){

44066 
	`TESTONLY
–
rc
 = ) 
	`sqlôe3BôvecSë
(
pPagî
->
pInJou∫Æ
, 
pgno
);

44067 
	`ã°ˇ£
–
rc
==
SQLITE_NOMEM
 );

44069 
	`TESTONLY
–
rc
 = ) 
	`addToSavïoötBôvecs
(
pPagî
, 
pgno
);

44070 
	`ã°ˇ£
–
rc
==
SQLITE_NOMEM
 );

44071 
	`sqlôe3EndBíignMÆloc
();

44073 
	`mem£t
(
pPg
->
pD©a
, 0, 
pPagî
->
∑geSize
);

44074 
	`IOTRACE
(("ZERO %∞%d\n", 
pPagî
, 
pgno
));

44076 if–
	`∑gîU£WÆ
(
pPagî
Ë&& 
bMm≠Ok
==0 ){

44077 
rc
 = 
	`sqlôe3WÆFödFøme
(
pPagî
->
pWÆ
, 
pgno
, &
iFøme
);

44078 if–
rc
!=
SQLITE_OK
 ) 
∑gî_acquúe_îr
;

44080 
	`as£π
–
pPg
->
pPagî
==pPager );

44081 
pPagî
->
aSèt
[
PAGER_STAT_MISS
]++;

44082 
rc
 = 
	`ªadDbPage
(
pPg
, 
iFøme
);

44083 if–
rc
!=
SQLITE_OK
 ){

44084 
∑gî_acquúe_îr
;

44087 
	`∑gî_£t_∑gehash
(
pPg
);

44090  
SQLITE_OK
;

44092 
∑gî_acquúe_îr
:

44093 
	`as£π
–
rc
!=
SQLITE_OK
 );

44094 if–
pPg
 ){

44095 
	`sqlôe3PˇcheDr›
(
pPg
);

44097 
	`∑gîU∆ockIfUnu£d
(
pPagî
);

44099 *
µPage
 = 0;

44100  
rc
;

44114 
SQLITE_PRIVATE
 
DbPage
 *
	`sqlôe3PagîLookup
(
Pagî
 *
pPagî
, 
Pgno
 
pgno
){

44115 
PgHdr
 *
pPg
 = 0;

44116 
	`as£π
–
pPagî
!=0 );

44117 
	`as£π
–
pgno
!=0 );

44118 
	`as£π
–
pPagî
->
pPCache
!=0 );

44119 
	`as£π
–
pPagî
->
eSèã
>=
PAGER_READER
 &&ÖPagî->eSèã!=
PAGER_ERROR
 );

44120 
	`sqlôe3PˇcheFëch
(
pPagî
->
pPCache
, 
pgno
, 0, &
pPg
);

44121  
pPg
;

44132 
SQLITE_PRIVATE
 
	`sqlôe3PagîUƒef
(
DbPage
 *
pPg
){

44133 if–
pPg
 ){

44134 
Pagî
 *
pPagî
 = 
pPg
->pPager;

44135 if–
pPg
->
Êags
 & 
PGHDR_MMAP
 ){

44136 
	`∑gîRñó£M≠Page
(
pPg
);

44138 
	`sqlôe3PˇcheRñó£
(
pPg
);

44140 
	`∑gîU∆ockIfUnu£d
(
pPagî
);

44166 
	`∑gî_›í_jou∫Æ
(
Pagî
 *
pPagî
){

44167 
rc
 = 
SQLITE_OK
;

44168 
sqlôe3_vfs
 * c⁄° 
pVfs
 = 
pPagî
->pVfs;

44170 
	`as£π
–
pPagî
->
eSèã
==
PAGER_WRITER_LOCKED
 );

44171 
	`as£π
–
	`as£π_∑gî_°©e
(
pPagî
) );

44172 
	`as£π
–
pPagî
->
pInJou∫Æ
==0 );

44177 if–
	`NEVER
(
pPagî
->
îrCode
) ) ÖPager->errCode;

44179 if–!
	`∑gîU£WÆ
(
pPagî
Ë&&ÖPagî->
jou∫ÆMode
!=
PAGER_JOURNALMODE_OFF
 ){

44180 
pPagî
->
pInJou∫Æ
 = 
	`sqlôe3BôvecCª©e
’Pagî->
dbSize
);

44181 if–
pPagî
->
pInJou∫Æ
==0 ){

44182  
SQLITE_NOMEM
;

44186 if–!
	`isO≥n
(
pPagî
->
jfd
) ){

44187 if–
pPagî
->
jou∫ÆMode
==
PAGER_JOURNALMODE_MEMORY
 ){

44188 
	`sqlôe3MemJou∫ÆO≥n
(
pPagî
->
jfd
);

44190 c⁄° 
Êags
 =

44191 
SQLITE_OPEN_READWRITE
|
SQLITE_OPEN_CREATE
|

44192 (
pPagî
->
ãmpFûe
 ?

44193 (
SQLITE_OPEN_DELETEONCLOSE
|
SQLITE_OPEN_TEMP_JOURNAL
):

44194 (
SQLITE_OPEN_MAIN_JOURNAL
)

44196 #ifde‡
SQLITE_ENABLE_ATOMIC_WRITE


44197 
rc
 = 
	`sqlôe3Jou∫ÆO≥n
(

44198 
pVfs
, 
pPagî
->
zJou∫Æ
,ÖPagî->
jfd
, 
Êags
, 
	`j∫lBuf„rSize
(pPager)

44201 
rc
 = 
	`sqlôe3OsO≥n
(
pVfs
, 
pPagî
->
zJou∫Æ
,ÖPagî->
jfd
, 
Êags
, 0);

44204 
	`as£π
–
rc
!=
SQLITE_OK
 || 
	`isO≥n
(
pPagî
->
jfd
) );

44211 if–
rc
==
SQLITE_OK
 ){

44213 
pPagî
->
nRec
 = 0;

44214 
pPagî
->
jou∫ÆOff
 = 0;

44215 
pPagî
->
£tMa°î
 = 0;

44216 
pPagî
->
jou∫ÆHdr
 = 0;

44217 
rc
 = 
	`wrôeJou∫ÆHdr
(
pPagî
);

44221 if–
rc
!=
SQLITE_OK
 ){

44222 
	`sqlôe3BôvecDe°roy
(
pPagî
->
pInJou∫Æ
);

44223 
pPagî
->
pInJou∫Æ
 = 0;

44225 
	`as£π
–
pPagî
->
eSèã
==
PAGER_WRITER_LOCKED
 );

44226 
pPagî
->
eSèã
 = 
PAGER_WRITER_CACHEMOD
;

44229  
rc
;

44249 
SQLITE_PRIVATE
 
	`sqlôe3PagîBegö
(
Pagî
 *
pPagî
, 
exFœg
, 
subjInMem‹y
){

44250 
rc
 = 
SQLITE_OK
;

44252 if–
pPagî
->
îrCode
 ) ÖPager->errCode;

44253 
	`as£π
–
pPagî
->
eSèã
>=
PAGER_READER
 &&ÖPagî->eSèã<
PAGER_ERROR
 );

44254 
pPagî
->
subjInMem‹y
 = (
u8
)subjInMemory;

44256 if–
	`ALWAYS
(
pPagî
->
eSèã
==
PAGER_READER
) ){

44257 
	`as£π
–
pPagî
->
pInJou∫Æ
==0 );

44259 if–
	`∑gîU£WÆ
(
pPagî
) ){

44263 if–
pPagî
->
ex˛usiveMode
 && 
	`sqlôe3WÆEx˛usiveMode
’Pagî->
pWÆ
, -1) ){

44264 
rc
 = 
	`∑gîLockDb
(
pPagî
, 
EXCLUSIVE_LOCK
);

44265 if–
rc
!=
SQLITE_OK
 ){

44266  
rc
;

44268 
	`sqlôe3WÆEx˛usiveMode
(
pPagî
->
pWÆ
, 1);

44276 
rc
 = 
	`sqlôe3WÆBegöWrôeTønß˘i⁄
(
pPagî
->
pWÆ
);

44283 
rc
 = 
	`∑gîLockDb
(
pPagî
, 
RESERVED_LOCK
);

44284 if–
rc
==
SQLITE_OK
 && 
exFœg
 ){

44285 
rc
 = 
	`∑gî_waô_⁄_lock
(
pPagî
, 
EXCLUSIVE_LOCK
);

44289 if–
rc
==
SQLITE_OK
 ){

44299 
pPagî
->
eSèã
 = 
PAGER_WRITER_LOCKED
;

44300 
pPagî
->
dbHötSize
 =ÖPagî->
dbSize
;

44301 
pPagî
->
dbFûeSize
 =ÖPagî->
dbSize
;

44302 
pPagî
->
dbOrigSize
 =ÖPagî->
dbSize
;

44303 
pPagî
->
jou∫ÆOff
 = 0;

44306 
	`as£π
–
rc
==
SQLITE_OK
 || 
pPagî
->
eSèã
==
PAGER_READER
 );

44307 
	`as£π
–
rc
!=
SQLITE_OK
 || 
pPagî
->
eSèã
==
PAGER_WRITER_LOCKED
 );

44308 
	`as£π
–
	`as£π_∑gî_°©e
(
pPagî
) );

44311 
	`PAGERTRACE
(("TRANSACTION %d\n", 
	`PAGERID
(
pPagî
)));

44312  
rc
;

44322 
	`∑gî_wrôe
(
PgHdr
 *
pPg
){

44323 *
pD©a
 = 
pPg
->pData;

44324 
Pagî
 *
pPagî
 = 
pPg
->pPager;

44325 
rc
 = 
SQLITE_OK
;

44331 
	`as£π
–
pPagî
->
eSèã
==
PAGER_WRITER_LOCKED


44332 || 
pPagî
->
eSèã
==
PAGER_WRITER_CACHEMOD


44333 || 
pPagî
->
eSèã
==
PAGER_WRITER_DBMOD


44335 
	`as£π
–
	`as£π_∑gî_°©e
(
pPagî
) );

44339 if–
	`NEVER
(
pPagî
->
îrCode
) ) ÖPager->errCode;

44343 if–
	`NEVER
(
pPagî
->
ªadO∆y
ËË 
SQLITE_PERM
;

44345 
	`CHECK_PAGE
(
pPg
);

44356 if–
pPagî
->
eSèã
==
PAGER_WRITER_LOCKED
 ){

44357 
rc
 = 
	`∑gî_›í_jou∫Æ
(
pPagî
);

44358 if–
rc
!=
SQLITE_OK
 ) Ñc;

44360 
	`as£π
–
pPagî
->
eSèã
>=
PAGER_WRITER_CACHEMOD
 );

44361 
	`as£π
–
	`as£π_∑gî_°©e
(
pPagî
) );

44366 
	`sqlôe3PˇcheMakeDúty
(
pPg
);

44367 if–
	`∑geInJou∫Æ
(
pPg
Ë&& !
	`subjRequúesPage
(pPg) ){

44368 
	`as£π
–!
	`∑gîU£WÆ
(
pPagî
) );

44375 if–!
	`∑geInJou∫Æ
(
pPg
Ë&& !
	`∑gîU£WÆ
(
pPagî
) ){

44376 
	`as£π
–
	`∑gîU£WÆ
(
pPagî
)==0 );

44377 if–
pPg
->
pgno
<=
pPagî
->
dbOrigSize
 && 
	`isO≥n
’Pagî->
jfd
) ){

44378 
u32
 
cksum
;

44379 *
pD©a2
;

44380 
i64
 
iOff
 = 
pPagî
->
jou∫ÆOff
;

44385 
	`as£π
–
pPg
->
pgno
!=
	`PAGER_MJ_PGNO
(
pPagî
) );

44387 
	`as£π
–
pPagî
->
jou∫ÆHdr
<ıPagî->
jou∫ÆOff
 );

44388 
	`CODEC2
(
pPagî
, 
pD©a
, 
pPg
->
pgno
, 7,  
SQLITE_NOMEM
, 
pD©a2
);

44389 
cksum
 = 
	`∑gî_cksum
(
pPagî
, (
u8
*)
pD©a2
);

44398 
pPg
->
Êags
 |
PGHDR_NEED_SYNC
;

44400 
rc
 = 
	`wrôe32bôs
(
pPagî
->
jfd
, 
iOff
, 
pPg
->
pgno
);

44401 if–
rc
!=
SQLITE_OK
 ) Ñc;

44402 
rc
 = 
	`sqlôe3OsWrôe
(
pPagî
->
jfd
, 
pD©a2
,ÖPagî->
∑geSize
, 
iOff
+4);

44403 if–
rc
!=
SQLITE_OK
 ) Ñc;

44404 
rc
 = 
	`wrôe32bôs
(
pPagî
->
jfd
, 
iOff
+pPagî->
∑geSize
+4, 
cksum
);

44405 if–
rc
!=
SQLITE_OK
 ) Ñc;

44407 
	`IOTRACE
(("JOUT %∞%d %Œd %d\n", 
pPagî
, 
pPg
->
pgno
,

44408 
pPagî
->
jou∫ÆOff
,ÖPagî->
∑geSize
));

44409 
	`PAGER_INCR
(
sqlôe3_∑gî_wrôej_cou¡
);

44410 
	`PAGERTRACE
(("JOURNAL %dÖage %dÇeedSync=%d hash(%08x)\n",

44411 
	`PAGERID
(
pPagî
), 
pPg
->
pgno
,

44412 ((
pPg
->
Êags
&
PGHDR_NEED_SYNC
)?1:0), 
	`∑gî_∑gehash
(pPg)));

44414 
pPagî
->
jou∫ÆOff
 +8 +ÖPagî->
∑geSize
;

44415 
pPagî
->
nRec
++;

44416 
	`as£π
–
pPagî
->
pInJou∫Æ
!=0 );

44417 
rc
 = 
	`sqlôe3BôvecSë
(
pPagî
->
pInJou∫Æ
, 
pPg
->
pgno
);

44418 
	`ã°ˇ£
–
rc
==
SQLITE_NOMEM
 );

44419 
	`as£π
–
rc
==
SQLITE_OK
 ||Ñc==
SQLITE_NOMEM
 );

44420 
rc
 |
	`addToSavïoötBôvecs
(
pPagî
, 
pPg
->
pgno
);

44421 if–
rc
!=
SQLITE_OK
 ){

44422 
	`as£π
–
rc
==
SQLITE_NOMEM
 );

44423  
rc
;

44426 if–
pPagî
->
eSèã
!=
PAGER_WRITER_DBMOD
 ){

44427 
pPg
->
Êags
 |
PGHDR_NEED_SYNC
;

44429 
	`PAGERTRACE
(("APPEND %dÖage %dÇeedSync=%d\n",

44430 
	`PAGERID
(
pPagî
), 
pPg
->
pgno
,

44431 ((
pPg
->
Êags
&
PGHDR_NEED_SYNC
)?1:0)));

44440 if–
	`subjRequúesPage
(
pPg
) ){

44441 
rc
 = 
	`subjou∫ÆPage
(
pPg
);

44447 if–
pPagî
->
dbSize
<
pPg
->
pgno
 ){

44448 
pPagî
->
dbSize
 = 
pPg
->
pgno
;

44450  
rc
;

44467 
SQLITE_PRIVATE
 
	`sqlôe3PagîWrôe
(
DbPage
 *
pDbPage
){

44468 
rc
 = 
SQLITE_OK
;

44470 
PgHdr
 *
pPg
 = 
pDbPage
;

44471 
Pagî
 *
pPagî
 = 
pPg
->pPager;

44472 
Pgno
 
nPagePîSe˘‹
 = (
pPagî
->
£˘‹Size
/pPagî->
∑geSize
);

44474 
	`as£π
–(
pPg
->
Êags
 & 
PGHDR_MMAP
)==0 );

44475 
	`as£π
–
pPagî
->
eSèã
>=
PAGER_WRITER_LOCKED
 );

44476 
	`as£π
–
pPagî
->
eSèã
!=
PAGER_ERROR
 );

44477 
	`as£π
–
	`as£π_∑gî_°©e
(
pPagî
) );

44479 if–
nPagePîSe˘‹
>1 ){

44480 
Pgno
 
nPageCou¡
;

44481 
Pgno
 
pg1
;

44482 
nPage
 = 0;

44483 
ii
;

44484 
√edSync
 = 0;

44490 
	`as£π
–!
MEMDB
 );

44491 
	`as£π
–(
pPagî
->
doNŸSpûl
 & 
SPILLFLAG_NOSYNC
)==0 );

44492 
pPagî
->
doNŸSpûl
 |
SPILLFLAG_NOSYNC
;

44498 
pg1
 = ((
pPg
->
pgno
-1Ë& ~(
nPagePîSe˘‹
-1)) + 1;

44500 
nPageCou¡
 = 
pPagî
->
dbSize
;

44501 if–
pPg
->
pgno
>
nPageCou¡
 ){

44502 
nPage
 = (
pPg
->
pgno
 - 
pg1
)+1;

44503 }if–(
pg1
+
nPagePîSe˘‹
-1)>
nPageCou¡
 ){

44504 
nPage
 = 
nPageCou¡
+1-
pg1
;

44506 
nPage
 = 
nPagePîSe˘‹
;

44508 
	`as£π
(
nPage
>0);

44509 
	`as£π
(
pg1
<=
pPg
->
pgno
);

44510 
	`as£π
((
pg1
+
nPage
)>
pPg
->
pgno
);

44512 
ii
=0; ii<
nPage
 && 
rc
==
SQLITE_OK
; ii++){

44513 
Pgno
 
pg
 = 
pg1
+
ii
;

44514 
PgHdr
 *
pPage
;

44515 if–
pg
==
pPg
->
pgno
 || !
	`sqlôe3BôvecTe°
(
pPagî
->
pInJou∫Æ
,Ög) ){

44516 if–
pg
!=
	`PAGER_MJ_PGNO
(
pPagî
) ){

44517 
rc
 = 
	`sqlôe3PagîGë
(
pPagî
, 
pg
, &
pPage
);

44518 if–
rc
==
SQLITE_OK
 ){

44519 
rc
 = 
	`∑gî_wrôe
(
pPage
);

44520 if–
pPage
->
Êags
&
PGHDR_NEED_SYNC
 ){

44521 
√edSync
 = 1;

44523 
	`sqlôe3PagîUƒef
(
pPage
);

44526 }if–(
pPage
 = 
	`∑gî_lookup
(
pPagî
, 
pg
))!=0 ){

44527 if–
pPage
->
Êags
&
PGHDR_NEED_SYNC
 ){

44528 
√edSync
 = 1;

44530 
	`sqlôe3PagîUƒef
(
pPage
);

44540 if–
rc
==
SQLITE_OK
 && 
√edSync
 ){

44541 
	`as£π
–!
MEMDB
 );

44542 
ii
=0; ii<
nPage
; ii++){

44543 
PgHdr
 *
pPage
 = 
	`∑gî_lookup
(
pPagî
, 
pg1
+
ii
);

44544 if–
pPage
 ){

44545 
pPage
->
Êags
 |
PGHDR_NEED_SYNC
;

44546 
	`sqlôe3PagîUƒef
(
pPage
);

44551 
	`as£π
–(
pPagî
->
doNŸSpûl
 & 
SPILLFLAG_NOSYNC
)!=0 );

44552 
pPagî
->
doNŸSpûl
 &~
SPILLFLAG_NOSYNC
;

44554 
rc
 = 
	`∑gî_wrôe
(
pDbPage
);

44556  
rc
;

44564 #i‚de‡
NDEBUG


44565 
SQLITE_PRIVATE
 
	`sqlôe3PagîIswrôóbÀ
(
DbPage
 *
pPg
){

44566  
pPg
->
Êags
&
PGHDR_DIRTY
;

44584 
SQLITE_PRIVATE
 
	`sqlôe3PagîD⁄tWrôe
(
PgHdr
 *
pPg
){

44585 
Pagî
 *
pPagî
 = 
pPg
->pPager;

44586 if–(
pPg
->
Êags
&
PGHDR_DIRTY
Ë&& 
pPagî
->
nSavïoöt
==0 ){

44587 
	`PAGERTRACE
(("DONT_WRITEÖagê%d o‡%d\n", 
pPg
->
pgno
, 
	`PAGERID
(
pPagî
)));

44588 
	`IOTRACE
(("CLEAN %∞%d\n", 
pPagî
, 
pPg
->
pgno
))

44589 
pPg
->
Êags
 |
PGHDR_DONT_WRITE
;

44590 
	`∑gî_£t_∑gehash
(
pPg
);

44616 
	`∑gî_ö¸_ch™gecou¡î
(
Pagî
 *
pPagî
, 
isDúe˘Mode
){

44617 
rc
 = 
SQLITE_OK
;

44619 
	`as£π
–
pPagî
->
eSèã
==
PAGER_WRITER_CACHEMOD


44620 || 
pPagî
->
eSèã
==
PAGER_WRITER_DBMOD


44622 
	`as£π
–
	`as£π_∑gî_°©e
(
pPagî
) );

44634 #i‚de‡
SQLITE_ENABLE_ATOMIC_WRITE


44635 
	#DIRECT_MODE
 0

	)

44636 
	`as£π
–
isDúe˘Mode
==0 );

44637 
	`UNUSED_PARAMETER
(
isDúe˘Mode
);

44639 
	#DIRECT_MODE
 
isDúe˘Mode


	)

44642 if–!
pPagî
->
ch™geCou¡D⁄e
 && 
	`ALWAYS
’Pagî->
dbSize
>0) ){

44643 
PgHdr
 *
pPgHdr
;

44645 
	`as£π
–!
pPagî
->
ãmpFûe
 && 
	`isO≥n
’Pagî->
fd
) );

44648 
rc
 = 
	`sqlôe3PagîGë
(
pPagî
, 1, &
pPgHdr
);

44649 
	`as£π
–
pPgHdr
==0 || 
rc
==
SQLITE_OK
 );

44656 if–!
DIRECT_MODE
 && 
	`ALWAYS
(
rc
==
SQLITE_OK
) ){

44657 
rc
 = 
	`sqlôe3PagîWrôe
(
pPgHdr
);

44660 if–
rc
==
SQLITE_OK
 ){

44662 
	`∑gî_wrôe_ch™gecou¡î
(
pPgHdr
);

44665 if–
DIRECT_MODE
 ){

44666 c⁄° *
zBuf
;

44667 
	`as£π
–
pPagî
->
dbFûeSize
>0 );

44668 
	`CODEC2
(
pPagî
, 
pPgHdr
->
pD©a
, 1, 6, 
rc
=
SQLITE_NOMEM
, 
zBuf
);

44669 if–
rc
==
SQLITE_OK
 ){

44670 
rc
 = 
	`sqlôe3OsWrôe
(
pPagî
->
fd
, 
zBuf
,ÖPagî->
∑geSize
, 0);

44671 
pPagî
->
aSèt
[
PAGER_STAT_WRITE
]++;

44673 if–
rc
==
SQLITE_OK
 ){

44677 c⁄° *
pC›y
 = (c⁄° *)&((c⁄° *)
zBuf
)[24];

44678 
	`mem˝y
(&
pPagî
->
dbFûeVîs
, 
pC›y
, (pPager->dbFileVers));

44679 
pPagî
->
ch™geCou¡D⁄e
 = 1;

44682 
pPagî
->
ch™geCou¡D⁄e
 = 1;

44687 
	`sqlôe3PagîUƒef
(
pPgHdr
);

44689  
rc
;

44699 
SQLITE_PRIVATE
 
	`sqlôe3PagîSync
(
Pagî
 *
pPagî
){

44700 
rc
 = 
SQLITE_OK
;

44701 if–!
pPagî
->
noSync
 ){

44702 
	`as£π
–!
MEMDB
 );

44703 
rc
 = 
	`sqlôe3OsSync
(
pPagî
->
fd
,ÖPagî->
syncFœgs
);

44704 }if–
	`isO≥n
(
pPagî
->
fd
) ){

44705 
	`as£π
–!
MEMDB
 );

44706 
rc
 = 
	`sqlôe3OsFûeC⁄åﬁ
(
pPagî
->
fd
, 
SQLITE_FCNTL_SYNC_OMITTED
, 0);

44707 if–
rc
==
SQLITE_NOTFOUND
 ){

44708 
rc
 = 
SQLITE_OK
;

44711  
rc
;

44725 
SQLITE_PRIVATE
 
	`sqlôe3PagîEx˛usiveLock
(
Pagî
 *
pPagî
){

44726 
rc
 = 
SQLITE_OK
;

44727 
	`as£π
–
pPagî
->
eSèã
==
PAGER_WRITER_CACHEMOD


44728 || 
pPagî
->
eSèã
==
PAGER_WRITER_DBMOD


44729 || 
pPagî
->
eSèã
==
PAGER_WRITER_LOCKED


44731 
	`as£π
–
	`as£π_∑gî_°©e
(
pPagî
) );

44732 if–0==
	`∑gîU£WÆ
(
pPagî
) ){

44733 
rc
 = 
	`∑gî_waô_⁄_lock
(
pPagî
, 
EXCLUSIVE_LOCK
);

44735  
rc
;

44764 
SQLITE_PRIVATE
 
	`sqlôe3PagîCommôPha£O√
(

44765 
Pagî
 *
pPagî
,

44766 c⁄° *
zMa°î
,

44767 
noSync


44769 
rc
 = 
SQLITE_OK
;

44771 
	`as£π
–
pPagî
->
eSèã
==
PAGER_WRITER_LOCKED


44772 || 
pPagî
->
eSèã
==
PAGER_WRITER_CACHEMOD


44773 || 
pPagî
->
eSèã
==
PAGER_WRITER_DBMOD


44774 || 
pPagî
->
eSèã
==
PAGER_ERROR


44776 
	`as£π
–
	`as£π_∑gî_°©e
(
pPagî
) );

44779 if–
	`NEVER
(
pPagî
->
îrCode
) ) ÖPager->errCode;

44781 
	`PAGERTRACE
(("DATABASE SYNC: File=%s zMaster=%sÇSize=%d\n",

44782 
pPagî
->
zFûíame
, 
zMa°î
,ÖPagî->
dbSize
));

44785 if–
pPagî
->
eSèã
<
PAGER_WRITER_CACHEMOD
 )  
SQLITE_OK
;

44787 if–
MEMDB
 ){

44792 
	`sqlôe3BackupRe°¨t
(
pPagî
->
pBackup
);

44794 if–
	`∑gîU£WÆ
(
pPagî
) ){

44795 
PgHdr
 *
pLi°
 = 
	`sqlôe3PˇcheDútyLi°
(
pPagî
->
pPCache
);

44796 
PgHdr
 *
pPageO√
 = 0;

44797 if–
pLi°
==0 ){

44800 
rc
 = 
	`sqlôe3PagîGë
(
pPagî
, 1, &
pPageO√
);

44801 
pLi°
 = 
pPageO√
;

44802 
pLi°
->
pDúty
 = 0;

44804 
	`as£π
–
rc
==
SQLITE_OK
 );

44805 if–
	`ALWAYS
(
pLi°
) ){

44806 
rc
 = 
	`∑gîWÆFømes
(
pPagî
, 
pLi°
,ÖPagî->
dbSize
, 1);

44808 
	`sqlôe3PagîUƒef
(
pPageO√
);

44809 if–
rc
==
SQLITE_OK
 ){

44810 
	`sqlôe3PˇcheCÀ™AŒ
(
pPagî
->
pPCache
);

44836 #ifde‡
SQLITE_ENABLE_ATOMIC_WRITE


44837 
PgHdr
 *
pPg
;

44838 
	`as£π
–
	`isO≥n
(
pPagî
->
jfd
)

44839 || 
pPagî
->
jou∫ÆMode
==
PAGER_JOURNALMODE_OFF


44840 || 
pPagî
->
jou∫ÆMode
==
PAGER_JOURNALMODE_WAL


44842 if–!
zMa°î
 && 
	`isO≥n
(
pPagî
->
jfd
)

44843 && 
pPagî
->
jou∫ÆOff
==
	`j∫lBuf„rSize
(pPager)

44844 && 
pPagî
->
dbSize
>ıPagî->
dbOrigSize


44845 && (0==(
pPg
 = 
	`sqlôe3PˇcheDútyLi°
(
pPagî
->
pPCache
)Ë|| 0=ıPg->
pDúty
)

44853 
rc
 = 
	`∑gî_ö¸_ch™gecou¡î
(
pPagî
, 1);

44855 
rc
 = 
	`sqlôe3Jou∫ÆCª©e
(
pPagî
->
jfd
);

44856 if–
rc
==
SQLITE_OK
 ){

44857 
rc
 = 
	`∑gî_ö¸_ch™gecou¡î
(
pPagî
, 0);

44861 
rc
 = 
	`∑gî_ö¸_ch™gecou¡î
(
pPagî
, 0);

44863 if–
rc
!=
SQLITE_OK
 ) 
commô_pha£_⁄e_exô
;

44869 
rc
 = 
	`wrôeMa°îJou∫Æ
(
pPagî
, 
zMa°î
);

44870 if–
rc
!=
SQLITE_OK
 ) 
commô_pha£_⁄e_exô
;

44883 
rc
 = 
	`syncJou∫Æ
(
pPagî
, 0);

44884 if–
rc
!=
SQLITE_OK
 ) 
commô_pha£_⁄e_exô
;

44886 
rc
 = 
	`∑gî_wrôe_∑gñi°
(
pPagî
,
	`sqlôe3PˇcheDútyLi°
’Pagî->
pPCache
));

44887 if–
rc
!=
SQLITE_OK
 ){

44888 
	`as£π
–
rc
!=
SQLITE_IOERR_BLOCKED
 );

44889 
commô_pha£_⁄e_exô
;

44891 
	`sqlôe3PˇcheCÀ™AŒ
(
pPagî
->
pPCache
);

44899 if–
pPagî
->
dbSize
>pPagî->
dbFûeSize
 ){

44900 
Pgno
 
nNew
 = 
pPagî
->
dbSize
 - (pPagî->dbSize==
	`PAGER_MJ_PGNO
(pPager));

44901 
	`as£π
–
pPagî
->
eSèã
==
PAGER_WRITER_DBMOD
 );

44902 
rc
 = 
	`∑gî_åunˇã
(
pPagî
, 
nNew
);

44903 if–
rc
!=
SQLITE_OK
 ) 
commô_pha£_⁄e_exô
;

44907 if–!
noSync
 ){

44908 
rc
 = 
	`sqlôe3PagîSync
(
pPagî
);

44910 
	`IOTRACE
(("DBSYNC %p\n", 
pPagî
))

44914 
commô_pha£_⁄e_exô
:

44915 if–
rc
==
SQLITE_OK
 && !
	`∑gîU£WÆ
(
pPagî
) ){

44916 
pPagî
->
eSèã
 = 
PAGER_WRITER_FINISHED
;

44918  
rc
;

44937 
SQLITE_PRIVATE
 
	`sqlôe3PagîCommôPha£Two
(
Pagî
 *
pPagî
){

44938 
rc
 = 
SQLITE_OK
;

44943 if–
	`NEVER
(
pPagî
->
îrCode
) ) ÖPager->errCode;

44945 
	`as£π
–
pPagî
->
eSèã
==
PAGER_WRITER_LOCKED


44946 || 
pPagî
->
eSèã
==
PAGER_WRITER_FINISHED


44947 || (
	`∑gîU£WÆ
(
pPagî
Ë&&ÖPagî->
eSèã
==
PAGER_WRITER_CACHEMOD
)

44949 
	`as£π
–
	`as£π_∑gî_°©e
(
pPagî
) );

44962 if–
pPagî
->
eSèã
==
PAGER_WRITER_LOCKED


44963 && 
pPagî
->
ex˛usiveMode


44964 && 
pPagî
->
jou∫ÆMode
==
PAGER_JOURNALMODE_PERSIST


44966 
	`as£π
–
pPagî
->
jou∫ÆOff
==
	`JOURNAL_HDR_SZ
(pPager) || !pPager->journalOff );

44967 
pPagî
->
eSèã
 = 
PAGER_READER
;

44968  
SQLITE_OK
;

44971 
	`PAGERTRACE
(("COMMIT %d\n", 
	`PAGERID
(
pPagî
)));

44972 
rc
 = 
	`∑gî_íd_å™ß˘i⁄
(
pPagî
,ÖPagî->
£tMa°î
, 1);

44973  
	`∑gî_îr‹
(
pPagî
, 
rc
);

45002 
SQLITE_PRIVATE
 
	`sqlôe3PagîRﬁlback
(
Pagî
 *
pPagî
){

45003 
rc
 = 
SQLITE_OK
;

45004 
	`PAGERTRACE
(("ROLLBACK %d\n", 
	`PAGERID
(
pPagî
)));

45010 
	`as£π
–
	`as£π_∑gî_°©e
(
pPagî
) );

45011 if–
pPagî
->
eSèã
==
PAGER_ERROR
 ) ÖPagî->
îrCode
;

45012 if–
pPagî
->
eSèã
<=
PAGER_READER
 )  
SQLITE_OK
;

45014 if–
	`∑gîU£WÆ
(
pPagî
) ){

45015 
rc2
;

45016 
rc
 = 
	`sqlôe3PagîSavïoöt
(
pPagî
, 
SAVEPOINT_ROLLBACK
, -1);

45017 
rc2
 = 
	`∑gî_íd_å™ß˘i⁄
(
pPagî
,ÖPagî->
£tMa°î
, 0);

45018 if–
rc
==
SQLITE_OK
 )Ñ¯
rc2
;

45019 }if–!
	`isO≥n
(
pPagî
->
jfd
Ë||ÖPagî->
eSèã
==
PAGER_WRITER_LOCKED
 ){

45020 
eSèã
 = 
pPagî
->eState;

45021 
rc
 = 
	`∑gî_íd_å™ß˘i⁄
(
pPagî
, 0, 0);

45022 if–!
MEMDB
 && 
eSèã
>
PAGER_WRITER_LOCKED
 ){

45027 
pPagî
->
îrCode
 = 
SQLITE_ABORT
;

45028 
pPagî
->
eSèã
 = 
PAGER_ERROR
;

45029  
rc
;

45032 
rc
 = 
	`∑gî_∂ayback
(
pPagî
, 0);

45035 
	`as£π
–
pPagî
->
eSèã
==
PAGER_READER
 || 
rc
!=
SQLITE_OK
 );

45036 
	`as£π
–
rc
==
SQLITE_OK
 ||Ñc==
SQLITE_FULL
 ||Ñc==
SQLITE_CORRUPT


45037 || 
rc
==
SQLITE_NOMEM
 || (rc&0xFF)==
SQLITE_IOERR
 );

45042  
	`∑gî_îr‹
(
pPagî
, 
rc
);

45049 
SQLITE_PRIVATE
 
u8
 
	`sqlôe3PagîI§ód⁄ly
(
Pagî
 *
pPagî
){

45050  
pPagî
->
ªadO∆y
;

45056 
SQLITE_PRIVATE
 
	`sqlôe3PagîRefcou¡
(
Pagî
 *
pPagî
){

45057  
	`sqlôe3PˇcheRefCou¡
(
pPagî
->
pPCache
);

45064 
SQLITE_PRIVATE
 
	`sqlôe3PagîMemU£d
(
Pagî
 *
pPagî
){

45065 
≥rPageSize
 = 
pPagî
->
∑geSize
 +ÖPagî->
nExåa
 + (
PgHdr
)

45067  
≥rPageSize
*
	`sqlôe3PˇchePagecou¡
(
pPagî
->
pPCache
)

45068 + 
	`sqlôe3MÆlocSize
(
pPagî
)

45069 + 
pPagî
->
∑geSize
;

45075 
SQLITE_PRIVATE
 
	`sqlôe3PagîPageRefcou¡
(
DbPage
 *
pPage
){

45076  
	`sqlôe3PˇchePageRefcou¡
(
pPage
);

45079 #ifde‡
SQLITE_TEST


45083 
SQLITE_PRIVATE
 *
	`sqlôe3PagîSèts
(
Pagî
 *
pPagî
){

45084 
a
[11];

45085 
a
[0] = 
	`sqlôe3PˇcheRefCou¡
(
pPagî
->
pPCache
);

45086 
a
[1] = 
	`sqlôe3PˇchePagecou¡
(
pPagî
->
pPCache
);

45087 
a
[2] = 
	`sqlôe3PˇcheGëCachesize
(
pPagî
->
pPCache
);

45088 
a
[3] = 
pPagî
->
eSèã
==
PAGER_OPEN
 ? -1 : (ËpPagî->
dbSize
;

45089 
a
[4] = 
pPagî
->
eSèã
;

45090 
a
[5] = 
pPagî
->
îrCode
;

45091 
a
[6] = 
pPagî
->
aSèt
[
PAGER_STAT_HIT
];

45092 
a
[7] = 
pPagî
->
aSèt
[
PAGER_STAT_MISS
];

45093 
a
[8] = 0;

45094 
a
[9] = 
pPagî
->
nRód
;

45095 
a
[10] = 
pPagî
->
aSèt
[
PAGER_STAT_WRITE
];

45096  
a
;

45107 
SQLITE_PRIVATE
 
	`sqlôe3PagîCacheSèt
(
Pagî
 *
pPagî
, 
eSèt
, 
ª£t
, *
≤VÆ
){

45109 
	`as£π
–
eSèt
==
SQLITE_DBSTATUS_CACHE_HIT


45110 || 
eSèt
==
SQLITE_DBSTATUS_CACHE_MISS


45111 || 
eSèt
==
SQLITE_DBSTATUS_CACHE_WRITE


45114 
	`as£π
–
SQLITE_DBSTATUS_CACHE_HIT
+1==
SQLITE_DBSTATUS_CACHE_MISS
 );

45115 
	`as£π
–
SQLITE_DBSTATUS_CACHE_HIT
+2==
SQLITE_DBSTATUS_CACHE_WRITE
 );

45116 
	`as£π
–
PAGER_STAT_HIT
==0 && 
PAGER_STAT_MISS
==1 && 
PAGER_STAT_WRITE
==2 );

45118 *
≤VÆ
 +
pPagî
->
aSèt
[
eSèt
 - 
SQLITE_DBSTATUS_CACHE_HIT
];

45119 if–
ª£t
 ){

45120 
pPagî
->
aSèt
[
eSèt
 - 
SQLITE_DBSTATUS_CACHE_HIT
] = 0;

45127 
SQLITE_PRIVATE
 
	`sqlôe3PagîIsMemdb
(
Pagî
 *
pPagî
){

45128  
MEMDB
;

45141 
SQLITE_PRIVATE
 
	`sqlôe3PagîO≥nSavïoöt
(
Pagî
 *
pPagî
, 
nSavïoöt
){

45142 
rc
 = 
SQLITE_OK
;

45143 
nCuºít
 = 
pPagî
->
nSavïoöt
;

45145 
	`as£π
–
pPagî
->
eSèã
>=
PAGER_WRITER_LOCKED
 );

45146 
	`as£π
–
	`as£π_∑gî_°©e
(
pPagî
) );

45148 if–
nSavïoöt
>
nCuºít
 && 
pPagî
->
u£Jou∫Æ
 ){

45149 
ii
;

45150 
PagîSavïoöt
 *
aNew
;

45156 
aNew
 = (
PagîSavïoöt
 *)
	`sqlôe3RóŒoc
(

45157 
pPagî
->
aSavïoöt
, (
PagîSavïoöt
)*
nSavïoöt


45159 if–!
aNew
 ){

45160  
SQLITE_NOMEM
;

45162 
	`mem£t
(&
aNew
[
nCuºít
], 0, (
nSavïoöt
-nCuºítË* (
PagîSavïoöt
));

45163 
pPagî
->
aSavïoöt
 = 
aNew
;

45166 
ii
=
nCuºít
; ii<
nSavïoöt
; ii++){

45167 
aNew
[
ii
].
nOrig
 = 
pPagî
->
dbSize
;

45168 if–
	`isO≥n
(
pPagî
->
jfd
Ë&&ÖPagî->
jou∫ÆOff
>0 ){

45169 
aNew
[
ii
].
iOff£t
 = 
pPagî
->
jou∫ÆOff
;

45171 
aNew
[
ii
].
iOff£t
 = 
	`JOURNAL_HDR_SZ
(
pPagî
);

45173 
aNew
[
ii
].
iSubRec
 = 
pPagî
->
nSubRec
;

45174 
aNew
[
ii
].
pInSavïoöt
 = 
	`sqlôe3BôvecCª©e
(
pPagî
->
dbSize
);

45175 if–!
aNew
[
ii
].
pInSavïoöt
 ){

45176  
SQLITE_NOMEM
;

45178 if–
	`∑gîU£WÆ
(
pPagî
) ){

45179 
	`sqlôe3WÆSavïoöt
(
pPagî
->
pWÆ
, 
aNew
[
ii
].
aWÆD©a
);

45181 
pPagî
->
nSavïoöt
 = 
ii
+1;

45183 
	`as£π
–
pPagî
->
nSavïoöt
==nSavepoint );

45184 
	`as£πTrunˇãC⁄°øöt
(
pPagî
);

45187  
rc
;

45220 
SQLITE_PRIVATE
 
	`sqlôe3PagîSavïoöt
(
Pagî
 *
pPagî
, 
›
, 
iSavïoöt
){

45221 
rc
 = 
pPagî
->
îrCode
;

45223 
	`as£π
–
›
==
SAVEPOINT_RELEASE
 || op==
SAVEPOINT_ROLLBACK
 );

45224 
	`as£π
–
iSavïoöt
>=0 || 
›
==
SAVEPOINT_ROLLBACK
 );

45226 if–
rc
==
SQLITE_OK
 && 
iSavïoöt
<
pPagî
->
nSavïoöt
 ){

45227 
ii
;

45228 
nNew
;

45234 
nNew
 = 
iSavïoöt
 + (–
›
==
SAVEPOINT_RELEASE
 ) ? 0 : 1);

45235 
ii
=
nNew
; ii<
pPagî
->
nSavïoöt
; ii++){

45236 
	`sqlôe3BôvecDe°roy
(
pPagî
->
aSavïoöt
[
ii
].
pInSavïoöt
);

45238 
pPagî
->
nSavïoöt
 = 
nNew
;

45242 if–
›
==
SAVEPOINT_RELEASE
 ){

45243 if–
nNew
==0 && 
	`isO≥n
(
pPagî
->
sjfd
) ){

45245 if–
	`sqlôe3IsMemJou∫Æ
(
pPagî
->
sjfd
) ){

45246 
rc
 = 
	`sqlôe3OsTrunˇã
(
pPagî
->
sjfd
, 0);

45247 
	`as£π
–
rc
==
SQLITE_OK
 );

45249 
pPagî
->
nSubRec
 = 0;

45257 if–
	`∑gîU£WÆ
(
pPagî
Ë|| 
	`isO≥n
’Pagî->
jfd
) ){

45258 
PagîSavïoöt
 *
pSavïoöt
 = (
nNew
==0)?0:&
pPagî
->
aSavïoöt
[nNew-1];

45259 
rc
 = 
	`∑gîPœybackSavïoöt
(
pPagî
, 
pSavïoöt
);

45260 
	`as£π
(
rc
!=
SQLITE_DONE
);

45264  
rc
;

45277 
SQLITE_PRIVATE
 c⁄° *
	`sqlôe3PagîFûíame
(
Pagî
 *
pPagî
, 
nuŒIfMemDb
){

45278  (
nuŒIfMemDb
 && 
pPagî
->
memDb
Ë? "" :ÖPagî->
zFûíame
;

45284 
SQLITE_PRIVATE
 c⁄° 
sqlôe3_vfs
 *
	`sqlôe3PagîVfs
(
Pagî
 *
pPagî
){

45285  
pPagî
->
pVfs
;

45293 
SQLITE_PRIVATE
 
sqlôe3_fûe
 *
	`sqlôe3PagîFûe
(
Pagî
 *
pPagî
){

45294  
pPagî
->
fd
;

45300 
SQLITE_PRIVATE
 c⁄° *
	`sqlôe3PagîJou∫Æ«me
(
Pagî
 *
pPagî
){

45301  
pPagî
->
zJou∫Æ
;

45308 
SQLITE_PRIVATE
 
	`sqlôe3PagîNosync
(
Pagî
 *
pPagî
){

45309  
pPagî
->
noSync
;

45312 #ifde‡
SQLITE_HAS_CODEC


45316 
SQLITE_PRIVATE
 
	`sqlôe3PagîSëCodec
(

45317 
Pagî
 *
pPagî
,

45318 *(*
xCodec
)(*,*,
Pgno
,),

45319 (*
xCodecSizeChng
)(*,,),

45320 (*
xCodecFªe
)(*),

45321 *
pCodec


45323 if–
pPagî
->
xCodecFªe
 )ÖPagî->
	`xCodecFªe
’Pagî->
pCodec
);

45324 
pPagî
->
xCodec
 =ÖPagî->
memDb
 ? 0 : xCodec;

45325 
pPagî
->
xCodecSizeChng
 = xCodecSizeChng;

45326 
pPagî
->
xCodecFªe
 = xCodecFree;

45327 
pPagî
->
pCodec
 =ÖCodec;

45328 
	`∑gîRï‹tSize
(
pPagî
);

45330 
SQLITE_PRIVATE
 *
	`sqlôe3PagîGëCodec
(
Pagî
 *
pPagî
){

45331  
pPagî
->
pCodec
;

45341 
SQLITE_PRIVATE
 *
	`sqlôe3PagîCodec
(
PgHdr
 *
pPg
){

45342 *
aD©a
 = 0;

45343 
	`CODEC2
(
pPg
->
pPagî
,ÖPg->
pD©a
,ÖPg->
pgno
, 6,  0, 
aD©a
);

45344  
aD©a
;

45350 
SQLITE_PRIVATE
 
	`sqlôe3PagîSèã
(
Pagî
 *
pPagî
){

45351  
pPagî
->
eSèã
;

45355 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


45381 
SQLITE_PRIVATE
 
	`sqlôe3PagîMovïage
(
Pagî
 *
pPagî
, 
DbPage
 *
pPg
, 
Pgno
 
pgno
, 
isCommô
){

45382 
PgHdr
 *
pPgOld
;

45383 
Pgno
 
√edSyncPgno
 = 0;

45384 
rc
;

45385 
Pgno
 
‹igPgno
;

45387 
	`as£π
–
pPg
->
nRef
>0 );

45388 
	`as£π
–
pPagî
->
eSèã
==
PAGER_WRITER_CACHEMOD


45389 || 
pPagî
->
eSèã
==
PAGER_WRITER_DBMOD


45391 
	`as£π
–
	`as£π_∑gî_°©e
(
pPagî
) );

45396 if–
MEMDB
 ){

45397 
rc
 = 
	`sqlôe3PagîWrôe
(
pPg
);

45398 if–
rc
 ) Ñc;

45419 if–
pPg
->
Êags
&
PGHDR_DIRTY


45420 && 
	`subjRequúesPage
(
pPg
)

45421 && 
SQLITE_OK
!=(
rc
 = 
	`subjou∫ÆPage
(
pPg
))

45423  
rc
;

45426 
	`PAGERTRACE
(("MOVE %dÖage %d (needSync=%d) movesÅo %d\n",

45427 
	`PAGERID
(
pPagî
), 
pPg
->
pgno
, (pPg->
Êags
&
PGHDR_NEED_SYNC
)?1:0,Ögno));

45428 
	`IOTRACE
(("MOVE %∞%d %d\n", 
pPagî
, 
pPg
->
pgno
,Ögno))

45437 if–(
pPg
->
Êags
&
PGHDR_NEED_SYNC
Ë&& !
isCommô
 ){

45438 
√edSyncPgno
 = 
pPg
->
pgno
;

45439 
	`as£π
–
pPagî
->
jou∫ÆMode
==
PAGER_JOURNALMODE_OFF
 ||

45440 
	`∑geInJou∫Æ
(
pPg
Ë||ÖPg->
pgno
>
pPagî
->
dbOrigSize
 );

45441 
	`as£π
–
pPg
->
Êags
&
PGHDR_DIRTY
 );

45449 
pPg
->
Êags
 &~
PGHDR_NEED_SYNC
;

45450 
pPgOld
 = 
	`∑gî_lookup
(
pPagî
, 
pgno
);

45451 
	`as£π
–!
pPgOld
 ||ÖPgOld->
nRef
==1 );

45452 if–
pPgOld
 ){

45453 
pPg
->
Êags
 |(
pPgOld
->Êags&
PGHDR_NEED_SYNC
);

45454 if–
MEMDB
 ){

45457 
	`sqlôe3PˇcheMove
(
pPgOld
, 
pPagî
->
dbSize
+1);

45459 
	`sqlôe3PˇcheDr›
(
pPgOld
);

45463 
‹igPgno
 = 
pPg
->
pgno
;

45464 
	`sqlôe3PˇcheMove
(
pPg
, 
pgno
);

45465 
	`sqlôe3PˇcheMakeDúty
(
pPg
);

45471 if–
MEMDB
 ){

45472 
	`as£π
–
pPgOld
 );

45473 
	`sqlôe3PˇcheMove
(
pPgOld
, 
‹igPgno
);

45474 
	`sqlôe3PagîUƒef
(
pPgOld
);

45477 if–
√edSyncPgno
 ){

45492 
PgHdr
 *
pPgHdr
;

45493 
rc
 = 
	`sqlôe3PagîGë
(
pPagî
, 
√edSyncPgno
, &
pPgHdr
);

45494 if–
rc
!=
SQLITE_OK
 ){

45495 if–
√edSyncPgno
<=
pPagî
->
dbOrigSize
 ){

45496 
	`as£π
–
pPagî
->
pTmpS∑˚
!=0 );

45497 
	`sqlôe3BôvecCÀ¨
(
pPagî
->
pInJou∫Æ
, 
√edSyncPgno
,ÖPagî->
pTmpS∑˚
);

45499  
rc
;

45501 
pPgHdr
->
Êags
 |
PGHDR_NEED_SYNC
;

45502 
	`sqlôe3PˇcheMakeDúty
(
pPgHdr
);

45503 
	`sqlôe3PagîUƒef
(
pPgHdr
);

45506  
SQLITE_OK
;

45513 
SQLITE_PRIVATE
 *
	`sqlôe3PagîGëD©a
(
DbPage
 *
pPg
){

45514 
	`as£π
–
pPg
->
nRef
>0 ||ÖPg->
pPagî
->
memDb
 );

45515  
pPg
->
pD©a
;

45522 
SQLITE_PRIVATE
 *
	`sqlôe3PagîGëExåa
(
DbPage
 *
pPg
){

45523  
pPg
->
pExåa
;

45536 
SQLITE_PRIVATE
 
	`sqlôe3PagîLockögMode
(
Pagî
 *
pPagî
, 
eMode
){

45537 
	`as£π
–
eMode
==
PAGER_LOCKINGMODE_QUERY


45538 || 
eMode
==
PAGER_LOCKINGMODE_NORMAL


45539 || 
eMode
==
PAGER_LOCKINGMODE_EXCLUSIVE
 );

45540 
	`as£π
–
PAGER_LOCKINGMODE_QUERY
<0 );

45541 
	`as£π
–
PAGER_LOCKINGMODE_NORMAL
>=0 && 
PAGER_LOCKINGMODE_EXCLUSIVE
>=0 );

45542 
	`as£π
–
pPagî
->
ex˛usiveMode
 || 0==
	`sqlôe3WÆHópMem‹y
’Pagî->
pWÆ
) );

45543 if–
eMode
>=0 && !
pPagî
->
ãmpFûe
 && !
	`sqlôe3WÆHópMem‹y
’Pagî->
pWÆ
) ){

45544 
pPagî
->
ex˛usiveMode
 = (
u8
)
eMode
;

45546  ()
pPagî
->
ex˛usiveMode
;

45569 
SQLITE_PRIVATE
 
	`sqlôe3PagîSëJou∫ÆMode
(
Pagî
 *
pPagî
, 
eMode
){

45570 
u8
 
eOld
 = 
pPagî
->
jou∫ÆMode
;

45572 #ifde‡
SQLITE_DEBUG


45575 
	`¥öt_∑gî_°©e
(
pPagî
);

45580 
	`as£π
–
eMode
==
PAGER_JOURNALMODE_DELETE


45581 || 
eMode
==
PAGER_JOURNALMODE_TRUNCATE


45582 || 
eMode
==
PAGER_JOURNALMODE_PERSIST


45583 || 
eMode
==
PAGER_JOURNALMODE_OFF


45584 || 
eMode
==
PAGER_JOURNALMODE_WAL


45585 || 
eMode
==
PAGER_JOURNALMODE_MEMORY
 );

45591 
	`as£π
–
pPagî
->
ãmpFûe
==0 || 
eMode
!=
PAGER_JOURNALMODE_WAL
 );

45596 if–
MEMDB
 ){

45597 
	`as£π
–
eOld
==
PAGER_JOURNALMODE_MEMORY
 ||ÉOld==
PAGER_JOURNALMODE_OFF
 );

45598 if–
eMode
!=
PAGER_JOURNALMODE_MEMORY
 &&ÉMode!=
PAGER_JOURNALMODE_OFF
 ){

45599 
eMode
 = 
eOld
;

45603 if–
eMode
!=
eOld
 ){

45606 
	`as£π
–
pPagî
->
eSèã
!=
PAGER_ERROR
 );

45607 
pPagî
->
jou∫ÆMode
 = (
u8
)
eMode
;

45613 
	`as£π
–(
PAGER_JOURNALMODE_TRUNCATE
 & 5)==1 );

45614 
	`as£π
–(
PAGER_JOURNALMODE_PERSIST
 & 5)==1 );

45615 
	`as£π
–(
PAGER_JOURNALMODE_DELETE
 & 5)==0 );

45616 
	`as£π
–(
PAGER_JOURNALMODE_MEMORY
 & 5)==4 );

45617 
	`as£π
–(
PAGER_JOURNALMODE_OFF
 & 5)==0 );

45618 
	`as£π
–(
PAGER_JOURNALMODE_WAL
 & 5)==5 );

45620 
	`as£π
–
	`isO≥n
(
pPagî
->
fd
Ë||ÖPagî->
ex˛usiveMode
 );

45621 if–!
pPagî
->
ex˛usiveMode
 && (
eOld
 & 5)==1 && (
eMode
 & 1)==0 ){

45631 
	`sqlôe3OsClo£
(
pPagî
->
jfd
);

45632 if–
pPagî
->
eLock
>=
RESERVED_LOCK
 ){

45633 
	`sqlôe3OsDñëe
(
pPagî
->
pVfs
,ÖPagî->
zJou∫Æ
, 0);

45635 
rc
 = 
SQLITE_OK
;

45636 
°©e
 = 
pPagî
->
eSèã
;

45637 
	`as£π
–
°©e
==
PAGER_OPEN
 || sèã==
PAGER_READER
 );

45638 if–
°©e
==
PAGER_OPEN
 ){

45639 
rc
 = 
	`sqlôe3PagîSh¨edLock
(
pPagî
);

45641 if–
pPagî
->
eSèã
==
PAGER_READER
 ){

45642 
	`as£π
–
rc
==
SQLITE_OK
 );

45643 
rc
 = 
	`∑gîLockDb
(
pPagî
, 
RESERVED_LOCK
);

45645 if–
rc
==
SQLITE_OK
 ){

45646 
	`sqlôe3OsDñëe
(
pPagî
->
pVfs
,ÖPagî->
zJou∫Æ
, 0);

45648 if–
rc
==
SQLITE_OK
 && 
°©e
==
PAGER_READER
 ){

45649 
	`∑gîU∆ockDb
(
pPagî
, 
SHARED_LOCK
);

45650 }if–
°©e
==
PAGER_OPEN
 ){

45651 
	`∑gî_u∆ock
(
pPagî
);

45653 
	`as£π
–
°©e
==
pPagî
->
eSèã
 );

45659  ()
pPagî
->
jou∫ÆMode
;

45665 
SQLITE_PRIVATE
 
	`sqlôe3PagîGëJou∫ÆMode
(
Pagî
 *
pPagî
){

45666  ()
pPagî
->
jou∫ÆMode
;

45674 
SQLITE_PRIVATE
 
	`sqlôe3PagîOkToCh™geJou∫ÆMode
(
Pagî
 *
pPagî
){

45675 
	`as£π
–
	`as£π_∑gî_°©e
(
pPagî
) );

45676 if–
pPagî
->
eSèã
>=
PAGER_WRITER_CACHEMOD
 )  0;

45677 if–
	`NEVER
(
	`isO≥n
(
pPagî
->
jfd
Ë&&ÖPagî->
jou∫ÆOff
>0) )  0;

45687 
SQLITE_PRIVATE
 
i64
 
	`sqlôe3PagîJou∫ÆSizeLimô
(
Pagî
 *
pPagî
, i64 
iLimô
){

45688 if–
iLimô
>=-1 ){

45689 
pPagî
->
jou∫ÆSizeLimô
 = 
iLimô
;

45690 
	`sqlôe3WÆLimô
(
pPagî
->
pWÆ
, 
iLimô
);

45692  
pPagî
->
jou∫ÆSizeLimô
;

45701 
SQLITE_PRIVATE
 
sqlôe3_backup
 **
	`sqlôe3PagîBackupPå
(
Pagî
 *
pPagî
){

45702  &
pPagî
->
pBackup
;

45705 #i‚de‡
SQLITE_OMIT_VACUUM


45709 
SQLITE_PRIVATE
 
	`sqlôe3PagîCÀ¨Cache
(
Pagî
 *
pPagî
){

45710 if–!
MEMDB
 && 
pPagî
->
ãmpFûe
==0 ) 
	`∑gî_ª£t
(pPager);

45714 #i‚de‡
SQLITE_OMIT_WAL


45722 
SQLITE_PRIVATE
 
	`sqlôe3PagîCheckpoöt
(
Pagî
 *
pPagî
, 
eMode
, *
≤Log
, *
≤Ck±
){

45723 
rc
 = 
SQLITE_OK
;

45724 if–
pPagî
->
pWÆ
 ){

45725 
rc
 = 
	`sqlôe3WÆCheckpoöt
(
pPagî
->
pWÆ
, 
eMode
,

45726 
pPagî
->
xBusyH™dÀr
,ÖPagî->
pBusyH™dÀrArg
,

45727 
pPagî
->
ck±SyncFœgs
,ÖPagî->
∑geSize
, (
u8
 *ÌPagî->
pTmpS∑˚
,

45728 
≤Log
, 
≤Ck±


45731  
rc
;

45734 
SQLITE_PRIVATE
 
	`sqlôe3PagîWÆCÆlback
(
Pagî
 *
pPagî
){

45735  
	`sqlôe3WÆCÆlback
(
pPagî
->
pWÆ
);

45742 
SQLITE_PRIVATE
 
	`sqlôe3PagîWÆSuµ‹ãd
(
Pagî
 *
pPagî
){

45743 c⁄° 
sqlôe3_io_mëhods
 *
pMëhods
 = 
pPagî
->
fd
->pMethods;

45744  
pPagî
->
ex˛usiveMode
 || (
pMëhods
->
iVîsi⁄
>=2 &&ÖMëhods->
xShmM≠
);

45751 
	`∑gîEx˛usiveLock
(
Pagî
 *
pPagî
){

45752 
rc
;

45754 
	`as£π
–
pPagî
->
eLock
==
SHARED_LOCK
 ||ÖPagî->eLock==
EXCLUSIVE_LOCK
 );

45755 
rc
 = 
	`∑gîLockDb
(
pPagî
, 
EXCLUSIVE_LOCK
);

45756 if–
rc
!=
SQLITE_OK
 ){

45759 
	`∑gîU∆ockDb
(
pPagî
, 
SHARED_LOCK
);

45762  
rc
;

45771 
	`∑gîO≥nWÆ
(
Pagî
 *
pPagî
){

45772 
rc
 = 
SQLITE_OK
;

45774 
	`as£π
–
pPagî
->
pWÆ
==0 &&ÖPagî->
ãmpFûe
==0 );

45775 
	`as£π
–
pPagî
->
eLock
==
SHARED_LOCK
 ||ÖPagî->eLock==
EXCLUSIVE_LOCK
 );

45782 if–
pPagî
->
ex˛usiveMode
 ){

45783 
rc
 = 
	`∑gîEx˛usiveLock
(
pPagî
);

45789 if–
rc
==
SQLITE_OK
 ){

45790 
rc
 = 
	`sqlôe3WÆO≥n
(
pPagî
->
pVfs
,

45791 
pPagî
->
fd
,ÖPagî->
zWÆ
,ÖPagî->
ex˛usiveMode
,

45792 
pPagî
->
jou∫ÆSizeLimô
, &pPagî->
pWÆ


45795 
	`∑gîFixM≠limô
(
pPagî
);

45797  
rc
;

45816 
SQLITE_PRIVATE
 
	`sqlôe3PagîO≥nWÆ
(

45817 
Pagî
 *
pPagî
,

45818 *
pbO≥n


45820 
rc
 = 
SQLITE_OK
;

45822 
	`as£π
–
	`as£π_∑gî_°©e
(
pPagî
) );

45823 
	`as£π
–
pPagî
->
eSèã
==
PAGER_OPEN
 || 
pbO≥n
 );

45824 
	`as£π
–
pPagî
->
eSèã
==
PAGER_READER
 || !
pbO≥n
 );

45825 
	`as£π
–
pbO≥n
==0 || *pbOpen==0 );

45826 
	`as£π
–
pbO≥n
!=0 || (!
pPagî
->
ãmpFûe
 && !pPagî->
pWÆ
) );

45828 if–!
pPagî
->
ãmpFûe
 && !pPagî->
pWÆ
 ){

45829 if–!
	`sqlôe3PagîWÆSuµ‹ãd
(
pPagî
ËË 
SQLITE_CANTOPEN
;

45832 
	`sqlôe3OsClo£
(
pPagî
->
jfd
);

45834 
rc
 = 
	`∑gîO≥nWÆ
(
pPagî
);

45835 if–
rc
==
SQLITE_OK
 ){

45836 
pPagî
->
jou∫ÆMode
 = 
PAGER_JOURNALMODE_WAL
;

45837 
pPagî
->
eSèã
 = 
PAGER_OPEN
;

45840 *
pbO≥n
 = 1;

45843  
rc
;

45855 
SQLITE_PRIVATE
 
	`sqlôe3PagîClo£WÆ
(
Pagî
 *
pPagî
){

45856 
rc
 = 
SQLITE_OK
;

45858 
	`as£π
–
pPagî
->
jou∫ÆMode
==
PAGER_JOURNALMODE_WAL
 );

45864 if–!
pPagî
->
pWÆ
 ){

45865 
logexi°s
 = 0;

45866 
rc
 = 
	`∑gîLockDb
(
pPagî
, 
SHARED_LOCK
);

45867 if–
rc
==
SQLITE_OK
 ){

45868 
rc
 = 
	`sqlôe3OsAc˚ss
(

45869 
pPagî
->
pVfs
,ÖPagî->
zWÆ
, 
SQLITE_ACCESS_EXISTS
, &
logexi°s


45872 if–
rc
==
SQLITE_OK
 && 
logexi°s
 ){

45873 
rc
 = 
	`∑gîO≥nWÆ
(
pPagî
);

45880 if–
rc
==
SQLITE_OK
 && 
pPagî
->
pWÆ
 ){

45881 
rc
 = 
	`∑gîEx˛usiveLock
(
pPagî
);

45882 if–
rc
==
SQLITE_OK
 ){

45883 
rc
 = 
	`sqlôe3WÆClo£
(
pPagî
->
pWÆ
,ÖPagî->
ck±SyncFœgs
,

45884 
pPagî
->
∑geSize
, (
u8
*ÌPagî->
pTmpS∑˚
);

45885 
pPagî
->
pWÆ
 = 0;

45886 
	`∑gîFixM≠limô
(
pPagî
);

45889  
rc
;

45894 #ifde‡
SQLITE_ENABLE_ZIPVFS


45902 
SQLITE_PRIVATE
 
	`sqlôe3PagîWÆFømesize
(
Pagî
 *
pPagî
){

45903 
	`as£π
–
pPagî
->
eSèã
==
PAGER_READER
 );

45904  
	`sqlôe3WÆFømesize
(
pPagî
->
pWÆ
);

46154 #i‚de‡
SQLITE_OMIT_WAL


46160 #i‡
	`deföed
(
SQLITE_TEST
Ë&& deföed(
SQLITE_DEBUG
)

46161 
SQLITE_PRIVATE
 
sqlôe3WÆTø˚
 = 0;

46162 
	#WALTRACE
(
X
Ëif(
sqlôe3WÆTø˚
Ë
sqlôe3DebugPrötf
 
	)
X

46164 
	#WALTRACE
(
X
)

	)

46180 
	#WAL_MAX_VERSION
 3007000

	)

46181 
	#WALINDEX_MAX_VERSION
 3007000

	)

46187 
	#WAL_WRITE_LOCK
 0

	)

46188 
	#WAL_ALL_BUT_WRITE
 1

	)

46189 
	#WAL_CKPT_LOCK
 1

	)

46190 
	#WAL_RECOVER_LOCK
 2

	)

46191 
	#WAL_READ_LOCK
(
I
Ë(3+(I))

	)

46192 
	#WAL_NREADER
 (
SQLITE_SHM_NLOCK
-3)

	)

46196 
WÆIndexHdr
 
	tWÆIndexHdr
;

46197 
WÆIãøt‹
 
	tWÆIãøt‹
;

46198 
WÆCk±Info
 
	tWÆCk±Info
;

46211 
	sWÆIndexHdr
 {

46212 
u32
 
iVîsi⁄
;

46213 
u32
 
unu£d
;

46214 
u32
 
iCh™ge
;

46215 
u8
 
isInô
;

46216 
u8
 
bigEndCksum
;

46217 
u16
 
szPage
;

46218 
u32
 
mxFøme
;

46219 
u32
 
nPage
;

46220 
u32
 
aFømeCksum
[2];

46221 
u32
 
aSÆt
[2];

46222 
u32
 
aCksum
[2];

46274 
	sWÆCk±Info
 {

46275 
u32
 
nBackfûl
;

46276 
u32
 
aRódM¨k
[
WAL_NREADER
];

46278 
	#READMARK_NOT_USED
 0xffffffff

	)

46286 
	#WALINDEX_LOCK_OFFSET
 ((
WÆIndexHdr
)*2 + (
WÆCk±Info
))

	)

46287 
	#WALINDEX_LOCK_RESERVED
 16

	)

46288 
	#WALINDEX_HDR_SIZE
 (
WALINDEX_LOCK_OFFSET
+
WALINDEX_LOCK_RESERVED
)

	)

46291 
	#WAL_FRAME_HDRSIZE
 24

	)

46295 
	#WAL_HDRSIZE
 32

	)

46306 
	#WAL_MAGIC
 0x377f0682

	)

46313 
	#wÆFømeOff£t
(
iFøme
, 
szPage
) ( \

46314 
WAL_HDRSIZE
 + ((
iFøme
)-1)*(
i64
)((
szPage
)+
WAL_FRAME_HDRSIZE
) \

46315 )

	)

46321 
	sWÆ
 {

46322 
sqlôe3_vfs
 *
pVfs
;

46323 
sqlôe3_fûe
 *
pDbFd
;

46324 
sqlôe3_fûe
 *
pWÆFd
;

46325 
u32
 
iCÆlback
;

46326 
i64
 
mxWÆSize
;

46327 
nWiD©a
;

46328 
szFú°Block
;

46329 vﬁ©ûê
u32
 **
≠WiD©a
;

46330 
u32
 
szPage
;

46331 
i16
 
ªadLock
;

46332 
u8
 
syncFœgs
;

46333 
u8
 
ex˛usiveMode
;

46334 
u8
 
wrôeLock
;

46335 
u8
 
ck±Lock
;

46336 
u8
 
ªadO∆y
;

46337 
u8
 
åunˇãOnCommô
;

46338 
u8
 
syncHódî
;

46339 
u8
 
∑dToSe˘‹Bound¨y
;

46340 
WÆIndexHdr
 
hdr
;

46341 c⁄° *
zWÆName
;

46342 
u32
 
nCk±
;

46343 #ifde‡
SQLITE_DEBUG


46344 
u8
 
lockEº‹
;

46351 
	#WAL_NORMAL_MODE
 0

	)

46352 
	#WAL_EXCLUSIVE_MODE
 1

	)

46353 
	#WAL_HEAPMEMORY_MODE
 2

	)

46358 
	#WAL_RDWR
 0

	)

46359 
	#WAL_RDONLY
 1

	)

46360 
	#WAL_SHM_RDONLY
 2

	)

46366 
u16
 
	tht_¶Ÿ
;

46383 
	sWÆIãøt‹
 {

46384 
iPri‹
;

46385 
nSegmít
;

46386 
	sWÆSegmít
 {

46387 
iNext
;

46388 
ht_¶Ÿ
 *
aIndex
;

46389 
u32
 *
aPgno
;

46390 
nE¡ry
;

46391 
iZîo
;

46392 } 
aSegmít
[1];

46403 
	#HASHTABLE_NPAGE
 4096

	)

46404 
	#HASHTABLE_HASH_1
 383

	)

46405 
	#HASHTABLE_NSLOT
 (
HASHTABLE_NPAGE
*2Ë

	)

46412 
	#HASHTABLE_NPAGE_ONE
 (
HASHTABLE_NPAGE
 - (
WALINDEX_HDR_SIZE
/(
u32
)))

	)

46415 
	#WALINDEX_PGSZ
 ( \

46416 (
ht_¶Ÿ
)*
HASHTABLE_NSLOT
 + 
HASHTABLE_NPAGE
*(
u32
) \

46417 )

	)

46428 
	`wÆIndexPage
(
WÆ
 *
pWÆ
, 
iPage
, vﬁ©ûê
u32
 **
µPage
){

46429 
rc
 = 
SQLITE_OK
;

46432 if–
pWÆ
->
nWiD©a
<=
iPage
 ){

46433 
nByã
 = (
u32
*)*(
iPage
+1);

46434 vﬁ©ûê
u32
 **
≠New
;

46435 
≠New
 = (vﬁ©ûê
u32
 **)
	`sqlôe3_ªÆloc
((*)
pWÆ
->
≠WiD©a
, 
nByã
);

46436 if–!
≠New
 ){

46437 *
µPage
 = 0;

46438  
SQLITE_NOMEM
;

46440 
	`mem£t
((*)&
≠New
[
pWÆ
->
nWiD©a
], 0,

46441 (
u32
*)*(
iPage
+1-
pWÆ
->
nWiD©a
));

46442 
pWÆ
->
≠WiD©a
 = 
≠New
;

46443 
pWÆ
->
nWiD©a
 = 
iPage
+1;

46447 if–
pWÆ
->
≠WiD©a
[
iPage
]==0 ){

46448 if–
pWÆ
->
ex˛usiveMode
==
WAL_HEAPMEMORY_MODE
 ){

46449 
pWÆ
->
≠WiD©a
[
iPage
] = (
u32
 vﬁ©ûê*)
	`sqlôe3MÆlocZîo
(
WALINDEX_PGSZ
);

46450 if–!
pWÆ
->
≠WiD©a
[
iPage
] ) 
rc
 = 
SQLITE_NOMEM
;

46452 
rc
 = 
	`sqlôe3OsShmM≠
(
pWÆ
->
pDbFd
, 
iPage
, 
WALINDEX_PGSZ
,

46453 
pWÆ
->
wrôeLock
, (vﬁ©ûê**)&pWÆ->
≠WiD©a
[
iPage
]

46455 if–
rc
==
SQLITE_READONLY
 ){

46456 
pWÆ
->
ªadO∆y
 |
WAL_SHM_RDONLY
;

46457 
rc
 = 
SQLITE_OK
;

46462 *
µPage
 = 
pWÆ
->
≠WiD©a
[
iPage
];

46463 
	`as£π
–
iPage
==0 || *
µPage
 || 
rc
!=
SQLITE_OK
 );

46464  
rc
;

46470 vﬁ©ûê
WÆCk±Info
 *
	`wÆCk±Info
(
WÆ
 *
pWÆ
){

46471 
	`as£π
–
pWÆ
->
nWiD©a
>0 &&ÖWÆ->
≠WiD©a
[0] );

46472  (vﬁ©ûê
WÆCk±Info
*)&(
pWÆ
->
≠WiD©a
[0][(
WÆIndexHdr
)/2]);

46478 vﬁ©ûê
WÆIndexHdr
 *
	`wÆIndexHdr
(
WÆ
 *
pWÆ
){

46479 
	`as£π
–
pWÆ
->
nWiD©a
>0 &&ÖWÆ->
≠WiD©a
[0] );

46480  (vﬁ©ûê
WÆIndexHdr
*)
pWÆ
->
≠WiD©a
[0];

46490 
	#BYTESWAP32
(
x
) ( \

46491 (((
x
)&0x000000FF)<<24) + (((x)&0x0000FF00)<<8) \

46492 + (((
x
)&0x00FF0000)>>8) + (((x)&0xFF000000)>>24) \

46493 )

	)

46504 
	`wÆChecksumByãs
(

46505 
«tiveCksum
,

46506 
u8
 *
a
,

46507 
nByã
,

46508 c⁄° 
u32
 *
aIn
,

46509 
u32
 *
aOut


46511 
u32
 
s1
, 
s2
;

46512 
u32
 *
aD©a
 = (u32 *)
a
;

46513 
u32
 *
aEnd
 = (u32 *)&
a
[
nByã
];

46515 if–
aIn
 ){

46516 
s1
 = 
aIn
[0];

46517 
s2
 = 
aIn
[1];

46519 
s1
 = 
s2
 = 0;

46522 
	`as£π
–
nByã
>=8 );

46523 
	`as£π
–(
nByã
&0x00000007)==0 );

46525 if–
«tiveCksum
 ){

46527 
s1
 +*
aD©a
++ + 
s2
;

46528 
s2
 +*
aD©a
++ + 
s1
;

46529 } 
aD©a
<
aEnd
 );

46532 
s1
 +
	`BYTESWAP32
(
aD©a
[0]Ë+ 
s2
;

46533 
s2
 +
	`BYTESWAP32
(
aD©a
[1]Ë+ 
s1
;

46534 
aD©a
 += 2;

46535 } 
aD©a
<
aEnd
 );

46538 
aOut
[0] = 
s1
;

46539 
aOut
[1] = 
s2
;

46542 
	`wÆShmB¨rõr
(
WÆ
 *
pWÆ
){

46543 if–
pWÆ
->
ex˛usiveMode
!=
WAL_HEAPMEMORY_MODE
 ){

46544 
	`sqlôe3OsShmB¨rõr
(
pWÆ
->
pDbFd
);

46553 
	`wÆIndexWrôeHdr
(
WÆ
 *
pWÆ
){

46554 vﬁ©ûê
WÆIndexHdr
 *
aHdr
 = 
	`wÆIndexHdr
(
pWÆ
);

46555 c⁄° 
nCksum
 = 
	`off£tof
(
WÆIndexHdr
, 
aCksum
);

46557 
	`as£π
–
pWÆ
->
wrôeLock
 );

46558 
pWÆ
->
hdr
.
isInô
 = 1;

46559 
pWÆ
->
hdr
.
iVîsi⁄
 = 
WALINDEX_MAX_VERSION
;

46560 
	`wÆChecksumByãs
(1, (
u8
*)&
pWÆ
->
hdr
, 
nCksum
, 0,ÖWÆ->hdr.
aCksum
);

46561 
	`mem˝y
((*)&
aHdr
[1], (*)&
pWÆ
->
hdr
, (
WÆIndexHdr
));

46562 
	`wÆShmB¨rõr
(
pWÆ
);

46563 
	`mem˝y
((*)&
aHdr
[0], (*)&
pWÆ
->
hdr
, (
WÆIndexHdr
));

46579 
	`wÆEncodeFøme
(

46580 
WÆ
 *
pWÆ
,

46581 
u32
 
iPage
,

46582 
u32
 
nTrunˇã
,

46583 
u8
 *
aD©a
,

46584 
u8
 *
aFøme


46586 
«tiveCksum
;

46587 
u32
 *
aCksum
 = 
pWÆ
->
hdr
.
aFømeCksum
;

46588 
	`as£π
–
WAL_FRAME_HDRSIZE
==24 );

46589 
	`sqlôe3Put4byã
(&
aFøme
[0], 
iPage
);

46590 
	`sqlôe3Put4byã
(&
aFøme
[4], 
nTrunˇã
);

46591 
	`mem˝y
(&
aFøme
[8], 
pWÆ
->
hdr
.
aSÆt
, 8);

46593 
«tiveCksum
 = (
pWÆ
->
hdr
.
bigEndCksum
==
SQLITE_BIGENDIAN
);

46594 
	`wÆChecksumByãs
(
«tiveCksum
, 
aFøme
, 8, 
aCksum
,áCksum);

46595 
	`wÆChecksumByãs
(
«tiveCksum
, 
aD©a
, 
pWÆ
->
szPage
, 
aCksum
,áCksum);

46597 
	`sqlôe3Put4byã
(&
aFøme
[16], 
aCksum
[0]);

46598 
	`sqlôe3Put4byã
(&
aFøme
[20], 
aCksum
[1]);

46606 
	`wÆDecodeFøme
(

46607 
WÆ
 *
pWÆ
,

46608 
u32
 *
piPage
,

46609 
u32
 *
≤Trunˇã
,

46610 
u8
 *
aD©a
,

46611 
u8
 *
aFøme


46613 
«tiveCksum
;

46614 
u32
 *
aCksum
 = 
pWÆ
->
hdr
.
aFømeCksum
;

46615 
u32
 
pgno
;

46616 
	`as£π
–
WAL_FRAME_HDRSIZE
==24 );

46621 if–
	`memcmp
(&
pWÆ
->
hdr
.
aSÆt
, &
aFøme
[8], 8)!=0 ){

46627 
pgno
 = 
	`sqlôe3Gë4byã
(&
aFøme
[0]);

46628 if–
pgno
==0 ){

46637 
«tiveCksum
 = (
pWÆ
->
hdr
.
bigEndCksum
==
SQLITE_BIGENDIAN
);

46638 
	`wÆChecksumByãs
(
«tiveCksum
, 
aFøme
, 8, 
aCksum
,áCksum);

46639 
	`wÆChecksumByãs
(
«tiveCksum
, 
aD©a
, 
pWÆ
->
szPage
, 
aCksum
,áCksum);

46640 if–
aCksum
[0]!=
	`sqlôe3Gë4byã
(&
aFøme
[16])

46641 || 
aCksum
[1]!=
	`sqlôe3Gë4byã
(&
aFøme
[20])

46650 *
piPage
 = 
pgno
;

46651 *
≤Trunˇã
 = 
	`sqlôe3Gë4byã
(&
aFøme
[4]);

46656 #i‡
	`deföed
(
SQLITE_TEST
Ë&& deföed(
SQLITE_DEBUG
)

46661 c⁄° *
	`wÆLockName
(
lockIdx
){

46662 if–
lockIdx
==
WAL_WRITE_LOCK
 ){

46664 }if–
lockIdx
==
WAL_CKPT_LOCK
 ){

46666 }if–
lockIdx
==
WAL_RECOVER_LOCK
 ){

46669 
zName
[15];

46670 
	`sqlôe3_¢¥ötf
((
zName
), zName, "READ-LOCK[%d]",

46671 
lockIdx
-
	`WAL_READ_LOCK
(0));

46672  
zName
;

46685 
	`wÆLockSh¨ed
(
WÆ
 *
pWÆ
, 
lockIdx
){

46686 
rc
;

46687 if–
pWÆ
->
ex˛usiveMode
 )  
SQLITE_OK
;

46688 
rc
 = 
	`sqlôe3OsShmLock
(
pWÆ
->
pDbFd
, 
lockIdx
, 1,

46689 
SQLITE_SHM_LOCK
 | 
SQLITE_SHM_SHARED
);

46690 
	`WALTRACE
(("WAL%p:ácquúêSHARED-%†%s\n", 
pWÆ
,

46691 
	`wÆLockName
(
lockIdx
), 
rc
 ? "failed" : "ok"));

46692 
	`VVA_ONLY
–
pWÆ
->
lockEº‹
 = (
u8
)(
rc
!=
SQLITE_OK
 &&Ñc!=
SQLITE_BUSY
); )

46693  
rc
;

46695 
	`wÆU∆ockSh¨ed
(
WÆ
 *
pWÆ
, 
lockIdx
){

46696 if–
pWÆ
->
ex˛usiveMode
 ) ;

46697 ()
	`sqlôe3OsShmLock
(
pWÆ
->
pDbFd
, 
lockIdx
, 1,

46698 
SQLITE_SHM_UNLOCK
 | 
SQLITE_SHM_SHARED
);

46699 
	`WALTRACE
(("WAL%p:Ññó£ SHARED-%s\n", 
pWÆ
, 
	`wÆLockName
(
lockIdx
)));

46701 
	`wÆLockEx˛usive
(
WÆ
 *
pWÆ
, 
lockIdx
, 
n
){

46702 
rc
;

46703 if–
pWÆ
->
ex˛usiveMode
 )  
SQLITE_OK
;

46704 
rc
 = 
	`sqlôe3OsShmLock
(
pWÆ
->
pDbFd
, 
lockIdx
, 
n
,

46705 
SQLITE_SHM_LOCK
 | 
SQLITE_SHM_EXCLUSIVE
);

46706 
	`WALTRACE
(("WAL%p:ácquúêEXCLUSIVE-%†˙t=%d %s\n", 
pWÆ
,

46707 
	`wÆLockName
(
lockIdx
), 
n
, 
rc
 ? "failed" : "ok"));

46708 
	`VVA_ONLY
–
pWÆ
->
lockEº‹
 = (
u8
)(
rc
!=
SQLITE_OK
 &&Ñc!=
SQLITE_BUSY
); )

46709  
rc
;

46711 
	`wÆU∆ockEx˛usive
(
WÆ
 *
pWÆ
, 
lockIdx
, 
n
){

46712 if–
pWÆ
->
ex˛usiveMode
 ) ;

46713 ()
	`sqlôe3OsShmLock
(
pWÆ
->
pDbFd
, 
lockIdx
, 
n
,

46714 
SQLITE_SHM_UNLOCK
 | 
SQLITE_SHM_EXCLUSIVE
);

46715 
	`WALTRACE
(("WAL%p:Ññó£ EXCLUSIVE-%†˙t=%d\n", 
pWÆ
,

46716 
	`wÆLockName
(
lockIdx
), 
n
));

46724 
	`wÆHash
(
u32
 
iPage
){

46725 
	`as£π
–
iPage
>0 );

46726 
	`as£π
–(
HASHTABLE_NSLOT
 & (HASHTABLE_NSLOT-1))==0 );

46727  (
iPage
*
HASHTABLE_HASH_1
Ë& (
HASHTABLE_NSLOT
-1);

46729 
	`wÆNextHash
(
iPri‹Hash
){

46730  (
iPri‹Hash
+1)&(
HASHTABLE_NSLOT
-1);

46747 
	`wÆHashGë
(

46748 
WÆ
 *
pWÆ
,

46749 
iHash
,

46750 vﬁ©ûê
ht_¶Ÿ
 **
∑Hash
,

46751 vﬁ©ûê
u32
 **
∑Pgno
,

46752 
u32
 *
piZîo


46754 
rc
;

46755 vﬁ©ûê
u32
 *
aPgno
;

46757 
rc
 = 
	`wÆIndexPage
(
pWÆ
, 
iHash
, &
aPgno
);

46758 
	`as£π
–
rc
==
SQLITE_OK
 || 
iHash
>0 );

46760 if–
rc
==
SQLITE_OK
 ){

46761 
u32
 
iZîo
;

46762 vﬁ©ûê
ht_¶Ÿ
 *
aHash
;

46764 
aHash
 = (vﬁ©ûê
ht_¶Ÿ
 *)&
aPgno
[
HASHTABLE_NPAGE
];

46765 if–
iHash
==0 ){

46766 
aPgno
 = &aPgno[
WALINDEX_HDR_SIZE
/(
u32
)];

46767 
iZîo
 = 0;

46769 
iZîo
 = 
HASHTABLE_NPAGE_ONE
 + (
iHash
-1)*
HASHTABLE_NPAGE
;

46772 *
∑Pgno
 = &
aPgno
[-1];

46773 *
∑Hash
 = 
aHash
;

46774 *
piZîo
 = 
iZîo
;

46776  
rc
;

46785 
	`wÆFømePage
(
u32
 
iFøme
){

46786 
iHash
 = (
iFøme
+
HASHTABLE_NPAGE
-
HASHTABLE_NPAGE_ONE
-1) / HASHTABLE_NPAGE;

46787 
	`as£π
–(
iHash
==0 || 
iFøme
>
HASHTABLE_NPAGE_ONE
)

46788 && (
iHash
>=1 || 
iFøme
<=
HASHTABLE_NPAGE_ONE
)

46789 && (
iHash
<=1 || 
iFøme
>(
HASHTABLE_NPAGE_ONE
+
HASHTABLE_NPAGE
))

46790 && (
iHash
>=2 || 
iFøme
<=
HASHTABLE_NPAGE_ONE
+
HASHTABLE_NPAGE
)

46791 && (
iHash
<=2 || 
iFøme
>(
HASHTABLE_NPAGE_ONE
+2*
HASHTABLE_NPAGE
))

46793  
iHash
;

46799 
u32
 
	`wÆFømePgno
(
WÆ
 *
pWÆ
, u32 
iFøme
){

46800 
iHash
 = 
	`wÆFømePage
(
iFøme
);

46801 if–
iHash
==0 ){

46802  
pWÆ
->
≠WiD©a
[0][
WALINDEX_HDR_SIZE
/(
u32
Ë+ 
iFøme
 - 1];

46804  
pWÆ
->
≠WiD©a
[
iHash
][(
iFøme
-1-
HASHTABLE_NPAGE_ONE
)%
HASHTABLE_NPAGE
];

46819 
	`wÆCÀ™upHash
(
WÆ
 *
pWÆ
){

46820 vﬁ©ûê
ht_¶Ÿ
 *
aHash
 = 0;

46821 vﬁ©ûê
u32
 *
aPgno
 = 0;

46822 
u32
 
iZîo
 = 0;

46823 
iLimô
 = 0;

46824 
nByã
;

46825 
i
;

46827 
	`as£π
–
pWÆ
->
wrôeLock
 );

46828 
	`ã°ˇ£
–
pWÆ
->
hdr
.
mxFøme
==
HASHTABLE_NPAGE_ONE
-1 );

46829 
	`ã°ˇ£
–
pWÆ
->
hdr
.
mxFøme
==
HASHTABLE_NPAGE_ONE
 );

46830 
	`ã°ˇ£
–
pWÆ
->
hdr
.
mxFøme
==
HASHTABLE_NPAGE_ONE
+1 );

46832 if–
pWÆ
->
hdr
.
mxFøme
==0 ) ;

46838 
	`as£π
–
pWÆ
->
nWiD©a
>
	`wÆFømePage
’WÆ->
hdr
.
mxFøme
) );

46839 
	`as£π
–
pWÆ
->
≠WiD©a
[
	`wÆFømePage
’WÆ->
hdr
.
mxFøme
)] );

46840 
	`wÆHashGë
(
pWÆ
, 
	`wÆFømePage
’WÆ->
hdr
.
mxFøme
), &
aHash
, &
aPgno
, &
iZîo
);

46845 
iLimô
 = 
pWÆ
->
hdr
.
mxFøme
 - 
iZîo
;

46846 
	`as£π
–
iLimô
>0 );

46847 
i
=0; i<
HASHTABLE_NSLOT
; i++){

46848 if–
aHash
[
i
]>
iLimô
 ){

46849 
aHash
[
i
] = 0;

46856 
nByã
 = ()((*)
aHash
 - (*)&
aPgno
[
iLimô
+1]);

46857 
	`mem£t
((*)&
aPgno
[
iLimô
+1], 0, 
nByã
);

46859 #ifde‡
SQLITE_ENABLE_EXPENSIVE_ASSERT


46863 if–
iLimô
 ){

46864 
i
;

46865 
iKey
;

46866 
i
=1; i<=
iLimô
; i++){

46867 
iKey
=
	`wÆHash
(
aPgno
[
i
]); 
aHash
[iKey]; iKey=
	`wÆNextHash
(iKey)){

46868 if–
aHash
[
iKey
]==
i
 ) ;

46870 
	`as£π
–
aHash
[
iKey
]==
i
 );

46881 
	`wÆIndexAµíd
(
WÆ
 *
pWÆ
, 
u32
 
iFøme
, u32 
iPage
){

46882 
rc
;

46883 
u32
 
iZîo
 = 0;

46884 vﬁ©ûê
u32
 *
aPgno
 = 0;

46885 vﬁ©ûê
ht_¶Ÿ
 *
aHash
 = 0;

46887 
rc
 = 
	`wÆHashGë
(
pWÆ
, 
	`wÆFømePage
(
iFøme
), &
aHash
, &
aPgno
, &
iZîo
);

46892 if–
rc
==
SQLITE_OK
 ){

46893 
iKey
;

46894 
idx
;

46895 
nCﬁlide
;

46897 
idx
 = 
iFøme
 - 
iZîo
;

46898 
	`as£π
–
idx
 <
HASHTABLE_NSLOT
/2 + 1 );

46903 if–
idx
==1 ){

46904 
nByã
 = ()((
u8
 *)&
aHash
[
HASHTABLE_NSLOT
] - (u8 *)&
aPgno
[1]);

46905 
	`mem£t
((*)&
aPgno
[1], 0, 
nByã
);

46914 if–
aPgno
[
idx
] ){

46915 
	`wÆCÀ™upHash
(
pWÆ
);

46916 
	`as£π
–!
aPgno
[
idx
] );

46920 
nCﬁlide
 = 
idx
;

46921 
iKey
=
	`wÆHash
(
iPage
); 
aHash
[iKey]; iKey=
	`wÆNextHash
(iKey)){

46922 if–(
nCﬁlide
--)==0 )  
SQLITE_CORRUPT_BKPT
;

46924 
aPgno
[
idx
] = 
iPage
;

46925 
aHash
[
iKey
] = (
ht_¶Ÿ
)
idx
;

46927 #ifde‡
SQLITE_ENABLE_EXPENSIVE_ASSERT


46932 
i
;

46933 
nE¡ry
 = 0;

46934 
i
=0; i<
HASHTABLE_NSLOT
; i++){ if–
aHash
[i] ) 
nE¡ry
++; }

46935 
	`as£π
–
nE¡ry
==
idx
 );

46943 if–(
idx
&0x3ff)==0 ){

46944 
i
;

46945 
i
=1; i<=
idx
; i++){

46946 
iKey
=
	`wÆHash
(
aPgno
[
i
]); 
aHash
[iKey]; iKey=
	`wÆNextHash
(iKey)){

46947 if–
aHash
[
iKey
]==
i
 ) ;

46949 
	`as£π
–
aHash
[
iKey
]==
i
 );

46956  
rc
;

46970 
	`wÆIndexRecovî
(
WÆ
 *
pWÆ
){

46971 
rc
;

46972 
i64
 
nSize
;

46973 
u32
 
aFømeCksum
[2] = {0, 0};

46974 
iLock
;

46975 
nLock
;

46983 
	`as£π
–
pWÆ
->
ck±Lock
==1 ||ÖWal->ckptLock==0 );

46984 
	`as£π
–
WAL_ALL_BUT_WRITE
==
WAL_WRITE_LOCK
+1 );

46985 
	`as£π
–
WAL_CKPT_LOCK
==
WAL_ALL_BUT_WRITE
 );

46986 
	`as£π
–
pWÆ
->
wrôeLock
 );

46987 
iLock
 = 
WAL_ALL_BUT_WRITE
 + 
pWÆ
->
ck±Lock
;

46988 
nLock
 = 
SQLITE_SHM_NLOCK
 - 
iLock
;

46989 
rc
 = 
	`wÆLockEx˛usive
(
pWÆ
, 
iLock
, 
nLock
);

46990 if–
rc
 ){

46991  
rc
;

46993 
	`WALTRACE
(("WAL%p:Ñecovîy begö...\n", 
pWÆ
));

46995 
	`mem£t
(&
pWÆ
->
hdr
, 0, (
WÆIndexHdr
));

46997 
rc
 = 
	`sqlôe3OsFûeSize
(
pWÆ
->
pWÆFd
, &
nSize
);

46998 if–
rc
!=
SQLITE_OK
 ){

46999 
ªcovîy_îr‹
;

47002 if–
nSize
>
WAL_HDRSIZE
 ){

47003 
u8
 
aBuf
[
WAL_HDRSIZE
];

47004 
u8
 *
aFøme
 = 0;

47005 
szFøme
;

47006 
u8
 *
aD©a
;

47007 
iFøme
;

47008 
i64
 
iOff£t
;

47009 
szPage
;

47010 
u32
 
magic
;

47011 
u32
 
vîsi⁄
;

47012 
isVÆid
;

47015 
rc
 = 
	`sqlôe3OsRód
(
pWÆ
->
pWÆFd
, 
aBuf
, 
WAL_HDRSIZE
, 0);

47016 if–
rc
!=
SQLITE_OK
 ){

47017 
ªcovîy_îr‹
;

47025 
magic
 = 
	`sqlôe3Gë4byã
(&
aBuf
[0]);

47026 
szPage
 = 
	`sqlôe3Gë4byã
(&
aBuf
[8]);

47027 if–(
magic
&0xFFFFFFFE)!=
WAL_MAGIC


47028 || 
szPage
&(szPage-1)

47029 || 
szPage
>
SQLITE_MAX_PAGE_SIZE


47030 || 
szPage
<512

47032 
föished
;

47034 
pWÆ
->
hdr
.
bigEndCksum
 = (
u8
)(
magic
&0x00000001);

47035 
pWÆ
->
szPage
 = szPage;

47036 
pWÆ
->
nCk±
 = 
	`sqlôe3Gë4byã
(&
aBuf
[12]);

47037 
	`mem˝y
(&
pWÆ
->
hdr
.
aSÆt
, &
aBuf
[16], 8);

47040 
	`wÆChecksumByãs
(
pWÆ
->
hdr
.
bigEndCksum
==
SQLITE_BIGENDIAN
,

47041 
aBuf
, 
WAL_HDRSIZE
-2*4, 0, 
pWÆ
->
hdr
.
aFømeCksum


47043 if–
pWÆ
->
hdr
.
aFømeCksum
[0]!=
	`sqlôe3Gë4byã
(&
aBuf
[24])

47044 || 
pWÆ
->
hdr
.
aFømeCksum
[1]!=
	`sqlôe3Gë4byã
(&
aBuf
[28])

47046 
föished
;

47051 
vîsi⁄
 = 
	`sqlôe3Gë4byã
(&
aBuf
[4]);

47052 if–
vîsi⁄
!=
WAL_MAX_VERSION
 ){

47053 
rc
 = 
SQLITE_CANTOPEN_BKPT
;

47054 
föished
;

47058 
szFøme
 = 
szPage
 + 
WAL_FRAME_HDRSIZE
;

47059 
aFøme
 = (
u8
 *)
	`sqlôe3_mÆloc
(
szFøme
);

47060 if–!
aFøme
 ){

47061 
rc
 = 
SQLITE_NOMEM
;

47062 
ªcovîy_îr‹
;

47064 
aD©a
 = &
aFøme
[
WAL_FRAME_HDRSIZE
];

47067 
iFøme
 = 0;

47068 
iOff£t
=
WAL_HDRSIZE
; (iOff£t+
szFøme
)<=
nSize
; iOffset+=szFrame){

47069 
u32
 
pgno
;

47070 
u32
 
nTrunˇã
;

47073 
iFøme
++;

47074 
rc
 = 
	`sqlôe3OsRód
(
pWÆ
->
pWÆFd
, 
aFøme
, 
szFøme
, 
iOff£t
);

47075 if–
rc
!=
SQLITE_OK
 ) ;

47076 
isVÆid
 = 
	`wÆDecodeFøme
(
pWÆ
, &
pgno
, &
nTrunˇã
, 
aD©a
, 
aFøme
);

47077 if–!
isVÆid
 ) ;

47078 
rc
 = 
	`wÆIndexAµíd
(
pWÆ
, 
iFøme
, 
pgno
);

47079 if–
rc
!=
SQLITE_OK
 ) ;

47082 if–
nTrunˇã
 ){

47083 
pWÆ
->
hdr
.
mxFøme
 = 
iFøme
;

47084 
pWÆ
->
hdr
.
nPage
 = 
nTrunˇã
;

47085 
pWÆ
->
hdr
.
szPage
 = (
u16
)((szPage&0xff00) | (szPage>>16));

47086 
	`ã°ˇ£
–
szPage
<=32768 );

47087 
	`ã°ˇ£
–
szPage
>=65536 );

47088 
aFømeCksum
[0] = 
pWÆ
->
hdr
.aFrameCksum[0];

47089 
aFømeCksum
[1] = 
pWÆ
->
hdr
.aFrameCksum[1];

47093 
	`sqlôe3_‰ì
(
aFøme
);

47096 
föished
:

47097 if–
rc
==
SQLITE_OK
 ){

47098 vﬁ©ûê
WÆCk±Info
 *
pInfo
;

47099 
i
;

47100 
pWÆ
->
hdr
.
aFømeCksum
[0] =áFrameCksum[0];

47101 
pWÆ
->
hdr
.
aFømeCksum
[1] =áFrameCksum[1];

47102 
	`wÆIndexWrôeHdr
(
pWÆ
);

47108 
pInfo
 = 
	`wÆCk±Info
(
pWÆ
);

47109 
pInfo
->
nBackfûl
 = 0;

47110 
pInfo
->
aRódM¨k
[0] = 0;

47111 
i
=1; i<
WAL_NREADER
; i++Ë
pInfo
->
aRódM¨k
[i] = 
READMARK_NOT_USED
;

47112 if–
pWÆ
->
hdr
.
mxFøme
 ) 
pInfo
->
aRódM¨k
[1] =ÖWal->hdr.mxFrame;

47119 if–
pWÆ
->
hdr
.
nPage
 ){

47120 
	`sqlôe3_log
(
SQLITE_NOTICE_RECOVER_WAL
,

47122 
pWÆ
->
hdr
.
mxFøme
,ÖWÆ->
zWÆName


47127 
ªcovîy_îr‹
:

47128 
	`WALTRACE
(("WAL%p:Ñecovîy %s\n", 
pWÆ
, 
rc
 ? "failed" : "ok"));

47129 
	`wÆU∆ockEx˛usive
(
pWÆ
, 
iLock
, 
nLock
);

47130  
rc
;

47136 
	`wÆIndexClo£
(
WÆ
 *
pWÆ
, 
isDñëe
){

47137 if–
pWÆ
->
ex˛usiveMode
==
WAL_HEAPMEMORY_MODE
 ){

47138 
i
;

47139 
i
=0; i<
pWÆ
->
nWiD©a
; i++){

47140 
	`sqlôe3_‰ì
((*)
pWÆ
->
≠WiD©a
[
i
]);

47141 
pWÆ
->
≠WiD©a
[
i
] = 0;

47144 
	`sqlôe3OsShmUnm≠
(
pWÆ
->
pDbFd
, 
isDñëe
);

47163 
SQLITE_PRIVATE
 
	`sqlôe3WÆO≥n
(

47164 
sqlôe3_vfs
 *
pVfs
,

47165 
sqlôe3_fûe
 *
pDbFd
,

47166 c⁄° *
zWÆName
,

47167 
bNoShm
,

47168 
i64
 
mxWÆSize
,

47169 
WÆ
 **
µWÆ


47171 
rc
;

47172 
WÆ
 *
pRë
;

47173 
Êags
;

47175 
	`as£π
–
zWÆName
 && zWalName[0] );

47176 
	`as£π
–
pDbFd
 );

47182 #ifde‡
WIN_SHM_BASE


47183 
	`as£π
–
WIN_SHM_BASE
==
WALINDEX_LOCK_OFFSET
 );

47185 #ifde‡
UNIX_SHM_BASE


47186 
	`as£π
–
UNIX_SHM_BASE
==
WALINDEX_LOCK_OFFSET
 );

47191 *
µWÆ
 = 0;

47192 
pRë
 = (
WÆ
*)
	`sqlôe3MÆlocZîo
((WÆË+ 
pVfs
->
szOsFûe
);

47193 if–!
pRë
 ){

47194  
SQLITE_NOMEM
;

47197 
pRë
->
pVfs
 =ÖVfs;

47198 
pRë
->
pWÆFd
 = (
sqlôe3_fûe
 *)&pRet[1];

47199 
pRë
->
pDbFd
 =ÖDbFd;

47200 
pRë
->
ªadLock
 = -1;

47201 
pRë
->
mxWÆSize
 = mxWalSize;

47202 
pRë
->
zWÆName
 = zWalName;

47203 
pRë
->
syncHódî
 = 1;

47204 
pRë
->
∑dToSe˘‹Bound¨y
 = 1;

47205 
pRë
->
ex˛usiveMode
 = (
bNoShm
 ? 
WAL_HEAPMEMORY_MODE
: 
WAL_NORMAL_MODE
);

47208 
Êags
 = (
SQLITE_OPEN_READWRITE
|
SQLITE_OPEN_CREATE
|
SQLITE_OPEN_WAL
);

47209 
rc
 = 
	`sqlôe3OsO≥n
(
pVfs
, 
zWÆName
, 
pRë
->
pWÆFd
, 
Êags
, &flags);

47210 if–
rc
==
SQLITE_OK
 && 
Êags
&
SQLITE_OPEN_READONLY
 ){

47211 
pRë
->
ªadO∆y
 = 
WAL_RDONLY
;

47214 if–
rc
!=
SQLITE_OK
 ){

47215 
	`wÆIndexClo£
(
pRë
, 0);

47216 
	`sqlôe3OsClo£
(
pRë
->
pWÆFd
);

47217 
	`sqlôe3_‰ì
(
pRë
);

47219 
iDC
 = 
	`sqlôe3OsDevi˚Ch¨a˘îi°ics
(
pRë
->
pWÆFd
);

47220 if–
iDC
 & 
SQLITE_IOCAP_SEQUENTIAL
 ){ 
pRë
->
syncHódî
 = 0; }

47221 if–
iDC
 & 
SQLITE_IOCAP_POWERSAFE_OVERWRITE
 ){

47222 
pRë
->
∑dToSe˘‹Bound¨y
 = 0;

47224 *
µWÆ
 = 
pRë
;

47225 
	`WALTRACE
(("WAL%d: o≥√d\n", 
pRë
));

47227  
rc
;

47233 
SQLITE_PRIVATE
 
	`sqlôe3WÆLimô
(
WÆ
 *
pWÆ
, 
i64
 
iLimô
){

47234 if–
pWÆ
 )ÖWÆ->
mxWÆSize
 = 
iLimô
;

47247 
	`wÆIãøt‹Next
(

47248 
WÆIãøt‹
 *
p
,

47249 
u32
 *
piPage
,

47250 
u32
 *
piFøme


47252 
u32
 
iMö
;

47253 
u32
 
iRë
 = 0xFFFFFFFF;

47254 
i
;

47256 
iMö
 = 
p
->
iPri‹
;

47257 
	`as£π
–
iMö
<0xffffffff );

47258 
i
=
p
->
nSegmít
-1; i>=0; i--){

47259 
WÆSegmít
 *
pSegmít
 = &
p
->
aSegmít
[
i
];

47260  
pSegmít
->
iNext
<pSegmít->
nE¡ry
 ){

47261 
u32
 
iPg
 = 
pSegmít
->
aPgno
[pSegmít->
aIndex
[pSegmít->
iNext
]];

47262 if–
iPg
>
iMö
 ){

47263 if–
iPg
<
iRë
 ){

47264 
iRë
 = 
iPg
;

47265 *
piFøme
 = 
pSegmít
->
iZîo
 +ÖSegmít->
aIndex
[pSegmít->
iNext
];

47269 
pSegmít
->
iNext
++;

47273 *
piPage
 = 
p
->
iPri‹
 = 
iRë
;

47274  (
iRë
==0xFFFFFFFF);

47300 
	`wÆMîge
(

47301 c⁄° 
u32
 *
aC⁄ã¡
,

47302 
ht_¶Ÿ
 *
aLe·
,

47303 
nLe·
,

47304 
ht_¶Ÿ
 **
∑Right
,

47305 *
≤Right
,

47306 
ht_¶Ÿ
 *
aTmp


47308 
iLe·
 = 0;

47309 
iRight
 = 0;

47310 
iOut
 = 0;

47311 
nRight
 = *
≤Right
;

47312 
ht_¶Ÿ
 *
aRight
 = *
∑Right
;

47314 
	`as£π
–
nLe·
>0 && 
nRight
>0 );

47315  
iRight
<
nRight
 || 
iLe·
<
nLe·
 ){

47316 
ht_¶Ÿ
 
log∑ge
;

47317 
Pgno
 
db∑ge
;

47319 if–(
iLe·
<
nLe·
)

47320 && (
iRight
>=
nRight
 || 
aC⁄ã¡
[
aLe·
[
iLe·
]]<aC⁄ã¡[
aRight
[iRight]])

47322 
log∑ge
 = 
aLe·
[
iLe·
++];

47324 
log∑ge
 = 
aRight
[
iRight
++];

47326 
db∑ge
 = 
aC⁄ã¡
[
log∑ge
];

47328 
aTmp
[
iOut
++] = 
log∑ge
;

47329 if–
iLe·
<
nLe·
 && 
aC⁄ã¡
[
aLe·
[iLe·]]==
db∑ge
 ) iLeft++;

47331 
	`as£π
–
iLe·
>=
nLe·
 || 
aC⁄ã¡
[
aLe·
[iLe·]]>
db∑ge
 );

47332 
	`as£π
–
iRight
>=
nRight
 || 
aC⁄ã¡
[
aRight
[iRight]]>
db∑ge
 );

47335 *
∑Right
 = 
aLe·
;

47336 *
≤Right
 = 
iOut
;

47337 
	`mem˝y
(
aLe·
, 
aTmp
, ◊Tmp[0])*
iOut
);

47357 
	`wÆMîges‹t
(

47358 c⁄° 
u32
 *
aC⁄ã¡
,

47359 
ht_¶Ÿ
 *
aBuf„r
,

47360 
ht_¶Ÿ
 *
aLi°
,

47361 *
≤Li°


47363 
	sSubli°
 {

47364 
nLi°
;

47365 
ht_¶Ÿ
 *
aLi°
;

47368 c⁄° 
nLi°
 = *
≤Li°
;

47369 
nMîge
 = 0;

47370 
ht_¶Ÿ
 *
aMîge
 = 0;

47371 
iLi°
;

47372 
iSub
 = 0;

47373 
Subli°
 
aSub
[13];

47375 
	`mem£t
(
aSub
, 0, (aSub));

47376 
	`as£π
–
nLi°
<=
HASHTABLE_NPAGE
 &&ÇList>0 );

47377 
	`as£π
–
HASHTABLE_NPAGE
==(1<<(
	`AºaySize
(
aSub
)-1)) );

47379 
iLi°
=0; iLi°<
nLi°
; iList++){

47380 
nMîge
 = 1;

47381 
aMîge
 = &
aLi°
[
iLi°
];

47382 
iSub
=0; 
iLi°
 & (1<<iSub); iSub++){

47383 
Subli°
 *
p
 = &
aSub
[
iSub
];

47384 
	`as£π
–
p
->
aLi°
 &&Ö->
nLi°
<=(1<<
iSub
) );

47385 
	`as£π
–
p
->
aLi°
==&aLi°[
iLi°
&~((2<<
iSub
)-1)] );

47386 
	`wÆMîge
(
aC⁄ã¡
, 
p
->
aLi°
,Ö->
nLi°
, &
aMîge
, &
nMîge
, 
aBuf„r
);

47388 
aSub
[
iSub
].
aLi°
 = 
aMîge
;

47389 
aSub
[
iSub
].
nLi°
 = 
nMîge
;

47392 
iSub
++; iSub<
	`AºaySize
(
aSub
); iSub++){

47393 if–
nLi°
 & (1<<
iSub
) ){

47394 
Subli°
 *
p
 = &
aSub
[
iSub
];

47395 
	`as£π
–
p
->
nLi°
<=(1<<
iSub
) );

47396 
	`as£π
–
p
->
aLi°
==&aLi°[
nLi°
&~((2<<
iSub
)-1)] );

47397 
	`wÆMîge
(
aC⁄ã¡
, 
p
->
aLi°
,Ö->
nLi°
, &
aMîge
, &
nMîge
, 
aBuf„r
);

47400 
	`as£π
–
aMîge
==
aLi°
 );

47401 *
≤Li°
 = 
nMîge
;

47403 #ifde‡
SQLITE_DEBUG


47405 
i
;

47406 
i
=1; i<*
≤Li°
; i++){

47407 
	`as£π
–
aC⁄ã¡
[
aLi°
[
i
]] >áContent[aList[i-1]] );

47416 
	`wÆIãøt‹Fªe
(
WÆIãøt‹
 *
p
){

47417 
	`sqlôe3S¸©chFªe
(
p
);

47432 
	`wÆIãøt‹Inô
(
WÆ
 *
pWÆ
, 
WÆIãøt‹
 **
µ
){

47433 
WÆIãøt‹
 *
p
;

47434 
nSegmít
;

47435 
u32
 
iLa°
;

47436 
nByã
;

47437 
i
;

47438 
ht_¶Ÿ
 *
aTmp
;

47439 
rc
 = 
SQLITE_OK
;

47444 
	`as£π
–
pWÆ
->
ck±Lock
 &&ÖWÆ->
hdr
.
mxFøme
>0 );

47445 
iLa°
 = 
pWÆ
->
hdr
.
mxFøme
;

47448 
nSegmít
 = 
	`wÆFømePage
(
iLa°
) + 1;

47449 
nByã
 = (
WÆIãøt‹
)

47450 + (
nSegmít
-1)*(
WÆSegmít
)

47451 + 
iLa°
*(
ht_¶Ÿ
);

47452 
p
 = (
WÆIãøt‹
 *)
	`sqlôe3S¸©chMÆloc
(
nByã
);

47453 if–!
p
 ){

47454  
SQLITE_NOMEM
;

47456 
	`mem£t
(
p
, 0, 
nByã
);

47457 
p
->
nSegmít
 =ÇSegment;

47462 
aTmp
 = (
ht_¶Ÿ
 *)
	`sqlôe3S¸©chMÆloc
(

47463 (
ht_¶Ÿ
Ë* (
iLa°
>
HASHTABLE_NPAGE
?HASHTABLE_NPAGE:iLast)

47465 if–!
aTmp
 ){

47466 
rc
 = 
SQLITE_NOMEM
;

47469 
i
=0; 
rc
==
SQLITE_OK
 && i<
nSegmít
; i++){

47470 vﬁ©ûê
ht_¶Ÿ
 *
aHash
;

47471 
u32
 
iZîo
;

47472 vﬁ©ûê
u32
 *
aPgno
;

47474 
rc
 = 
	`wÆHashGë
(
pWÆ
, 
i
, &
aHash
, &
aPgno
, &
iZîo
);

47475 if–
rc
==
SQLITE_OK
 ){

47476 
j
;

47477 
nE¡ry
;

47478 
ht_¶Ÿ
 *
aIndex
;

47480 
aPgno
++;

47481 if–(
i
+1)==
nSegmít
 ){

47482 
nE¡ry
 = ()(
iLa°
 - 
iZîo
);

47484 
nE¡ry
 = ()((
u32
*)
aHash
 - (u32*)
aPgno
);

47486 
aIndex
 = &((
ht_¶Ÿ
 *)&
p
->
aSegmít
[p->
nSegmít
])[
iZîo
];

47487 
iZîo
++;

47489 
j
=0; j<
nE¡ry
; j++){

47490 
aIndex
[
j
] = (
ht_¶Ÿ
)j;

47492 
	`wÆMîges‹t
((
u32
 *)
aPgno
, 
aTmp
, 
aIndex
, &
nE¡ry
);

47493 
p
->
aSegmít
[
i
].
iZîo
 = iZero;

47494 
p
->
aSegmít
[
i
].
nE¡ry
 =ÇEntry;

47495 
p
->
aSegmít
[
i
].
aIndex
 =áIndex;

47496 
p
->
aSegmít
[
i
].
aPgno
 = (
u32
 *)aPgno;

47499 
	`sqlôe3S¸©chFªe
(
aTmp
);

47501 if–
rc
!=
SQLITE_OK
 ){

47502 
	`wÆIãøt‹Fªe
(
p
);

47504 *
µ
 = 
p
;

47505  
rc
;

47514 
	`wÆBusyLock
(

47515 
WÆ
 *
pWÆ
,

47516 (*
xBusy
)(*),

47517 *
pBusyArg
,

47518 
lockIdx
,

47519 
n


47521 
rc
;

47523 
rc
 = 
	`wÆLockEx˛usive
(
pWÆ
, 
lockIdx
, 
n
);

47524 } 
xBusy
 && 
rc
==
SQLITE_BUSY
 && 
	`xBusy
(
pBusyArg
) );

47525  
rc
;

47532 
	`wÆPagesize
(
WÆ
 *
pWÆ
){

47533  (
pWÆ
->
hdr
.
szPage
&0xfe00) + ((pWal->hdr.szPage&0x0001)<<16);

47567 
	`wÆCheckpoöt
(

47568 
WÆ
 *
pWÆ
,

47569 
eMode
,

47570 (*
xBusyCÆl
)(*),

47571 *
pBusyArg
,

47572 
sync_Êags
,

47573 
u8
 *
zBuf


47575 
rc
;

47576 
szPage
;

47577 
WÆIãøt‹
 *
pIãr
 = 0;

47578 
u32
 
iDb∑ge
 = 0;

47579 
u32
 
iFøme
 = 0;

47580 
u32
 
mxSa„Føme
;

47581 
u32
 
mxPage
;

47582 
i
;

47583 vﬁ©ûê
WÆCk±Info
 *
pInfo
;

47584 (*
xBusy
)(*) = 0;

47586 
szPage
 = 
	`wÆPagesize
(
pWÆ
);

47587 
	`ã°ˇ£
–
szPage
<=32768 );

47588 
	`ã°ˇ£
–
szPage
>=65536 );

47589 
pInfo
 = 
	`wÆCk±Info
(
pWÆ
);

47590 if–
pInfo
->
nBackfûl
>=
pWÆ
->
hdr
.
mxFøme
 )  
SQLITE_OK
;

47593 
rc
 = 
	`wÆIãøt‹Inô
(
pWÆ
, &
pIãr
);

47594 if–
rc
!=
SQLITE_OK
 ){

47595  
rc
;

47597 
	`as£π
–
pIãr
 );

47599 if–
eMode
!=
SQLITE_CHECKPOINT_PASSIVE
 ) 
xBusy
 = 
xBusyCÆl
;

47606 
mxSa„Føme
 = 
pWÆ
->
hdr
.
mxFøme
;

47607 
mxPage
 = 
pWÆ
->
hdr
.
nPage
;

47608 
i
=1; i<
WAL_NREADER
; i++){

47609 
u32
 
y
 = 
pInfo
->
aRódM¨k
[
i
];

47610 if–
mxSa„Føme
>
y
 ){

47611 
	`as£π
–
y
<=
pWÆ
->
hdr
.
mxFøme
 );

47612 
rc
 = 
	`wÆBusyLock
(
pWÆ
, 
xBusy
, 
pBusyArg
, 
	`WAL_READ_LOCK
(
i
), 1);

47613 if–
rc
==
SQLITE_OK
 ){

47614 
pInfo
->
aRódM¨k
[
i
] = (i==1 ? 
mxSa„Føme
 : 
READMARK_NOT_USED
);

47615 
	`wÆU∆ockEx˛usive
(
pWÆ
, 
	`WAL_READ_LOCK
(
i
), 1);

47616 }if–
rc
==
SQLITE_BUSY
 ){

47617 
mxSa„Føme
 = 
y
;

47618 
xBusy
 = 0;

47620 
wÆcheckpoöt_out
;

47625 if–
pInfo
->
nBackfûl
<
mxSa„Føme


47626 && (
rc
 = 
	`wÆBusyLock
(
pWÆ
, 
xBusy
, 
pBusyArg
, 
	`WAL_READ_LOCK
(0), 1))==
SQLITE_OK


47628 
i64
 
nSize
;

47629 
u32
 
nBackfûl
 = 
pInfo
->nBackfill;

47632 if–
sync_Êags
 ){

47633 
rc
 = 
	`sqlôe3OsSync
(
pWÆ
->
pWÆFd
, 
sync_Êags
);

47639 if–
rc
==
SQLITE_OK
 ){

47640 
i64
 
nReq
 = ((i64)
mxPage
 * 
szPage
);

47641 
rc
 = 
	`sqlôe3OsFûeSize
(
pWÆ
->
pDbFd
, &
nSize
);

47642 if–
rc
==
SQLITE_OK
 && 
nSize
<
nReq
 ){

47643 
	`sqlôe3OsFûeC⁄åﬁHöt
(
pWÆ
->
pDbFd
, 
SQLITE_FCNTL_SIZE_HINT
, &
nReq
);

47649  
rc
==
SQLITE_OK
 && 0==
	`wÆIãøt‹Next
(
pIãr
, &
iDb∑ge
, &
iFøme
) ){

47650 
i64
 
iOff£t
;

47651 
	`as£π
–
	`wÆFømePgno
(
pWÆ
, 
iFøme
)==
iDb∑ge
 );

47652 if–
iFøme
<=
nBackfûl
 || iFøme>
mxSa„Føme
 || 
iDb∑ge
>
mxPage
 ) ;

47653 
iOff£t
 = 
	`wÆFømeOff£t
(
iFøme
, 
szPage
Ë+ 
WAL_FRAME_HDRSIZE
;

47655 
rc
 = 
	`sqlôe3OsRód
(
pWÆ
->
pWÆFd
, 
zBuf
, 
szPage
, 
iOff£t
);

47656 if–
rc
!=
SQLITE_OK
 ) ;

47657 
iOff£t
 = (
iDb∑ge
-1)*(
i64
)
szPage
;

47658 
	`ã°ˇ£
–
	`IS_BIG_INT
(
iOff£t
) );

47659 
rc
 = 
	`sqlôe3OsWrôe
(
pWÆ
->
pDbFd
, 
zBuf
, 
szPage
, 
iOff£t
);

47660 if–
rc
!=
SQLITE_OK
 ) ;

47664 if–
rc
==
SQLITE_OK
 ){

47665 if–
mxSa„Føme
==
	`wÆIndexHdr
(
pWÆ
)->
mxFøme
 ){

47666 
i64
 
szDb
 = 
pWÆ
->
hdr
.
nPage
*(i64)
szPage
;

47667 
	`ã°ˇ£
–
	`IS_BIG_INT
(
szDb
) );

47668 
rc
 = 
	`sqlôe3OsTrunˇã
(
pWÆ
->
pDbFd
, 
szDb
);

47669 if–
rc
==
SQLITE_OK
 && 
sync_Êags
 ){

47670 
rc
 = 
	`sqlôe3OsSync
(
pWÆ
->
pDbFd
, 
sync_Êags
);

47673 if–
rc
==
SQLITE_OK
 ){

47674 
pInfo
->
nBackfûl
 = 
mxSa„Føme
;

47679 
	`wÆU∆ockEx˛usive
(
pWÆ
, 
	`WAL_READ_LOCK
(0), 1);

47682 if–
rc
==
SQLITE_BUSY
 ){

47685 
rc
 = 
SQLITE_OK
;

47693 if–
rc
==
SQLITE_OK
 && 
eMode
!=
SQLITE_CHECKPOINT_PASSIVE
 ){

47694 
	`as£π
–
pWÆ
->
wrôeLock
 );

47695 if–
pInfo
->
nBackfûl
<
pWÆ
->
hdr
.
mxFøme
 ){

47696 
rc
 = 
SQLITE_BUSY
;

47697 }if–
eMode
==
SQLITE_CHECKPOINT_RESTART
 ){

47698 
	`as£π
–
mxSa„Føme
==
pWÆ
->
hdr
.
mxFøme
 );

47699 
rc
 = 
	`wÆBusyLock
(
pWÆ
, 
xBusy
, 
pBusyArg
, 
	`WAL_READ_LOCK
(1), 
WAL_NREADER
-1);

47700 if–
rc
==
SQLITE_OK
 ){

47701 
	`wÆU∆ockEx˛usive
(
pWÆ
, 
	`WAL_READ_LOCK
(1), 
WAL_NREADER
-1);

47706 
wÆcheckpoöt_out
:

47707 
	`wÆIãøt‹Fªe
(
pIãr
);

47708  
rc
;

47715 
	`wÆLimôSize
(
WÆ
 *
pWÆ
, 
i64
 
nMax
){

47716 
i64
 
sz
;

47717 
rx
;

47718 
	`sqlôe3BegöBíignMÆloc
();

47719 
rx
 = 
	`sqlôe3OsFûeSize
(
pWÆ
->
pWÆFd
, &
sz
);

47720 if–
rx
==
SQLITE_OK
 && (
sz
 > 
nMax
 ) ){

47721 
rx
 = 
	`sqlôe3OsTrunˇã
(
pWÆ
->
pWÆFd
, 
nMax
);

47723 
	`sqlôe3EndBíignMÆloc
();

47724 if–
rx
 ){

47725 
	`sqlôe3_log
(
rx
, "ˇ¬ŸÜimô WAL size: %s", 
pWÆ
->
zWÆName
);

47732 
SQLITE_PRIVATE
 
	`sqlôe3WÆClo£
(

47733 
WÆ
 *
pWÆ
,

47734 
sync_Êags
,

47735 
nBuf
,

47736 
u8
 *
zBuf


47738 
rc
 = 
SQLITE_OK
;

47739 if–
pWÆ
 ){

47740 
isDñëe
 = 0;

47750 
rc
 = 
	`sqlôe3OsLock
(
pWÆ
->
pDbFd
, 
SQLITE_LOCK_EXCLUSIVE
);

47751 if–
rc
==
SQLITE_OK
 ){

47752 if–
pWÆ
->
ex˛usiveMode
==
WAL_NORMAL_MODE
 ){

47753 
pWÆ
->
ex˛usiveMode
 = 
WAL_EXCLUSIVE_MODE
;

47755 
rc
 = 
	`sqlôe3WÆCheckpoöt
(

47756 
pWÆ
, 
SQLITE_CHECKPOINT_PASSIVE
, 0, 0, 
sync_Êags
, 
nBuf
, 
zBuf
, 0, 0

47758 if–
rc
==
SQLITE_OK
 ){

47759 
bPîsi°
 = -1;

47760 
	`sqlôe3OsFûeC⁄åﬁHöt
(

47761 
pWÆ
->
pDbFd
, 
SQLITE_FCNTL_PERSIST_WAL
, &
bPîsi°


47763 if–
bPîsi°
!=1 ){

47767 
isDñëe
 = 1;

47768 }if–
pWÆ
->
mxWÆSize
>=0 ){

47775 
	`wÆLimôSize
(
pWÆ
, 0);

47780 
	`wÆIndexClo£
(
pWÆ
, 
isDñëe
);

47781 
	`sqlôe3OsClo£
(
pWÆ
->
pWÆFd
);

47782 if–
isDñëe
 ){

47783 
	`sqlôe3BegöBíignMÆloc
();

47784 
	`sqlôe3OsDñëe
(
pWÆ
->
pVfs
,ÖWÆ->
zWÆName
, 0);

47785 
	`sqlôe3EndBíignMÆloc
();

47787 
	`WALTRACE
(("WAL%p: clo£d\n", 
pWÆ
));

47788 
	`sqlôe3_‰ì
((*)
pWÆ
->
≠WiD©a
);

47789 
	`sqlôe3_‰ì
(
pWÆ
);

47791  
rc
;

47811 
	`wÆIndexTryHdr
(
WÆ
 *
pWÆ
, *
pCh™ged
){

47812 
u32
 
aCksum
[2];

47813 
WÆIndexHdr
 
h1
, 
h2
;

47814 
WÆIndexHdr
 vﬁ©ûê*
aHdr
;

47817 
	`as£π
–
pWÆ
->
nWiD©a
>0 &&ÖWÆ->
≠WiD©a
[0] );

47829 
aHdr
 = 
	`wÆIndexHdr
(
pWÆ
);

47830 
	`mem˝y
(&
h1
, (*)&
aHdr
[0], (h1));

47831 
	`wÆShmB¨rõr
(
pWÆ
);

47832 
	`mem˝y
(&
h2
, (*)&
aHdr
[1], (h2));

47834 if–
	`memcmp
(&
h1
, &
h2
, (h1))!=0 ){

47837 if–
h1
.
isInô
==0 ){

47840 
	`wÆChecksumByãs
(1, (
u8
*)&
h1
, (h1)-(h1.
aCksum
), 0,áCksum);

47841 if–
aCksum
[0]!=
h1
.aCksum[0] ||áCksum[1]!=h1.aCksum[1] ){

47845 if–
	`memcmp
(&
pWÆ
->
hdr
, &
h1
, (
WÆIndexHdr
)) ){

47846 *
pCh™ged
 = 1;

47847 
	`mem˝y
(&
pWÆ
->
hdr
, &
h1
, (
WÆIndexHdr
));

47848 
pWÆ
->
szPage
 = (pWÆ->
hdr
.szPage&0xfe00) + ((pWal->hdr.szPage&0x0001)<<16);

47849 
	`ã°ˇ£
–
pWÆ
->
szPage
<=32768 );

47850 
	`ã°ˇ£
–
pWÆ
->
szPage
>=65536 );

47869 
	`wÆIndexRódHdr
(
WÆ
 *
pWÆ
, *
pCh™ged
){

47870 
rc
;

47871 
badHdr
;

47872 vﬁ©ûê
u32
 *
∑ge0
;

47877 
	`as£π
–
pCh™ged
 );

47878 
rc
 = 
	`wÆIndexPage
(
pWÆ
, 0, &
∑ge0
);

47879 if–
rc
!=
SQLITE_OK
 ){

47880  
rc
;

47882 
	`as£π
–
∑ge0
 || 
pWÆ
->
wrôeLock
==0 );

47889 
badHdr
 = (
∑ge0
 ? 
	`wÆIndexTryHdr
(
pWÆ
, 
pCh™ged
) : 1);

47894 
	`as£π
–
badHdr
==0 || 
pWÆ
->
wrôeLock
==0 );

47895 if–
badHdr
 ){

47896 if–
pWÆ
->
ªadO∆y
 & 
WAL_SHM_RDONLY
 ){

47897 if–
SQLITE_OK
==(
rc
 = 
	`wÆLockSh¨ed
(
pWÆ
, 
WAL_WRITE_LOCK
)) ){

47898 
	`wÆU∆ockSh¨ed
(
pWÆ
, 
WAL_WRITE_LOCK
);

47899 
rc
 = 
SQLITE_READONLY_RECOVERY
;

47901 }if–
SQLITE_OK
==(
rc
 = 
	`wÆLockEx˛usive
(
pWÆ
, 
WAL_WRITE_LOCK
, 1)) ){

47902 
pWÆ
->
wrôeLock
 = 1;

47903 if–
SQLITE_OK
==(
rc
 = 
	`wÆIndexPage
(
pWÆ
, 0, &
∑ge0
)) ){

47904 
badHdr
 = 
	`wÆIndexTryHdr
(
pWÆ
, 
pCh™ged
);

47905 if–
badHdr
 ){

47910 
rc
 = 
	`wÆIndexRecovî
(
pWÆ
);

47911 *
pCh™ged
 = 1;

47914 
pWÆ
->
wrôeLock
 = 0;

47915 
	`wÆU∆ockEx˛usive
(
pWÆ
, 
WAL_WRITE_LOCK
, 1);

47923 if–
badHdr
==0 && 
pWÆ
->
hdr
.
iVîsi⁄
!=
WALINDEX_MAX_VERSION
 ){

47924 
rc
 = 
SQLITE_CANTOPEN_BKPT
;

47927  
rc
;

47934 
	#WAL_RETRY
 (-1)

	)

47986 
	`wÆTryBegöRód
(
WÆ
 *
pWÆ
, *
pCh™ged
, 
u£WÆ
, 
˙t
){

47987 vﬁ©ûê
WÆCk±Info
 *
pInfo
;

47988 
u32
 
mxRódM¨k
;

47989 
mxI
;

47990 
i
;

47991 
rc
 = 
SQLITE_OK
;

47993 
	`as£π
–
pWÆ
->
ªadLock
<0 );

48012 if–
˙t
>5 ){

48013 
nDñay
 = 1;

48014 if–
˙t
>100 ){

48015 
	`VVA_ONLY
–
pWÆ
->
lockEº‹
 = 1; )

48016  
SQLITE_PROTOCOL
;

48018 if–
˙t
>=10 ) 
nDñay
 = (cnt-9)*238;

48019 
	`sqlôe3OsSÀï
(
pWÆ
->
pVfs
, 
nDñay
);

48022 if–!
u£WÆ
 ){

48023 
rc
 = 
	`wÆIndexRódHdr
(
pWÆ
, 
pCh™ged
);

48024 if–
rc
==
SQLITE_BUSY
 ){

48033 if–
pWÆ
->
≠WiD©a
[0]==0 ){

48041 
rc
 = 
WAL_RETRY
;

48042 }if–
SQLITE_OK
==(
rc
 = 
	`wÆLockSh¨ed
(
pWÆ
, 
WAL_RECOVER_LOCK
)) ){

48043 
	`wÆU∆ockSh¨ed
(
pWÆ
, 
WAL_RECOVER_LOCK
);

48044 
rc
 = 
WAL_RETRY
;

48045 }if–
rc
==
SQLITE_BUSY
 ){

48046 
rc
 = 
SQLITE_BUSY_RECOVERY
;

48049 if–
rc
!=
SQLITE_OK
 ){

48050  
rc
;

48054 
pInfo
 = 
	`wÆCk±Info
(
pWÆ
);

48055 if–!
u£WÆ
 && 
pInfo
->
nBackfûl
==
pWÆ
->
hdr
.
mxFøme
 ){

48059 
rc
 = 
	`wÆLockSh¨ed
(
pWÆ
, 
	`WAL_READ_LOCK
(0));

48060 
	`wÆShmB¨rõr
(
pWÆ
);

48061 if–
rc
==
SQLITE_OK
 ){

48062 if–
	`memcmp
((*)
	`wÆIndexHdr
(
pWÆ
), &pWÆ->
hdr
, (
WÆIndexHdr
)) ){

48076 
	`wÆU∆ockSh¨ed
(
pWÆ
, 
	`WAL_READ_LOCK
(0));

48077  
WAL_RETRY
;

48079 
pWÆ
->
ªadLock
 = 0;

48080  
SQLITE_OK
;

48081 }if–
rc
!=
SQLITE_BUSY
 ){

48082  
rc
;

48091 
mxRódM¨k
 = 0;

48092 
mxI
 = 0;

48093 
i
=1; i<
WAL_NREADER
; i++){

48094 
u32
 
thisM¨k
 = 
pInfo
->
aRódM¨k
[
i
];

48095 if–
mxRódM¨k
<=
thisM¨k
 &&ÅhisM¨k<=
pWÆ
->
hdr
.
mxFøme
 ){

48096 
	`as£π
–
thisM¨k
!=
READMARK_NOT_USED
 );

48097 
mxRódM¨k
 = 
thisM¨k
;

48098 
mxI
 = 
i
;

48103 if–(
pWÆ
->
ªadO∆y
 & 
WAL_SHM_RDONLY
)==0

48104 && (
mxRódM¨k
<
pWÆ
->
hdr
.
mxFøme
 || 
mxI
==0)

48106 
i
=1; i<
WAL_NREADER
; i++){

48107 
rc
 = 
	`wÆLockEx˛usive
(
pWÆ
, 
	`WAL_READ_LOCK
(
i
), 1);

48108 if–
rc
==
SQLITE_OK
 ){

48109 
mxRódM¨k
 = 
pInfo
->
aRódM¨k
[
i
] = 
pWÆ
->
hdr
.
mxFøme
;

48110 
mxI
 = 
i
;

48111 
	`wÆU∆ockEx˛usive
(
pWÆ
, 
	`WAL_READ_LOCK
(
i
), 1);

48113 }if–
rc
!=
SQLITE_BUSY
 ){

48114  
rc
;

48118 if–
mxI
==0 ){

48119 
	`as£π
–
rc
==
SQLITE_BUSY
 || (
pWÆ
->
ªadO∆y
 & 
WAL_SHM_RDONLY
)!=0 );

48120  
rc
==
SQLITE_BUSY
 ? 
WAL_RETRY
 : 
SQLITE_READONLY_CANTLOCK
;

48123 
rc
 = 
	`wÆLockSh¨ed
(
pWÆ
, 
	`WAL_READ_LOCK
(
mxI
));

48124 if–
rc
 ){

48125  
rc
==
SQLITE_BUSY
 ? 
WAL_RETRY
 :Ñc;

48147 
	`wÆShmB¨rõr
(
pWÆ
);

48148 if–
pInfo
->
aRódM¨k
[
mxI
]!=
mxRódM¨k


48149 || 
	`memcmp
((*)
	`wÆIndexHdr
(
pWÆ
), &pWÆ->
hdr
, (
WÆIndexHdr
))

48151 
	`wÆU∆ockSh¨ed
(
pWÆ
, 
	`WAL_READ_LOCK
(
mxI
));

48152  
WAL_RETRY
;

48154 
	`as£π
–
mxRódM¨k
<=
pWÆ
->
hdr
.
mxFøme
 );

48155 
pWÆ
->
ªadLock
 = (
i16
)
mxI
;

48158  
rc
;

48175 
SQLITE_PRIVATE
 
	`sqlôe3WÆBegöRódTønß˘i⁄
(
WÆ
 *
pWÆ
, *
pCh™ged
){

48176 
rc
;

48177 
˙t
 = 0;

48180 
rc
 = 
	`wÆTryBegöRód
(
pWÆ
, 
pCh™ged
, 0, ++
˙t
);

48181 } 
rc
==
WAL_RETRY
 );

48182 
	`ã°ˇ£
–(
rc
&0xff)==
SQLITE_BUSY
 );

48183 
	`ã°ˇ£
–(
rc
&0xff)==
SQLITE_IOERR
 );

48184 
	`ã°ˇ£
–
rc
==
SQLITE_PROTOCOL
 );

48185 
	`ã°ˇ£
–
rc
==
SQLITE_OK
 );

48186  
rc
;

48193 
SQLITE_PRIVATE
 
	`sqlôe3WÆEndRódTønß˘i⁄
(
WÆ
 *
pWÆ
){

48194 
	`sqlôe3WÆEndWrôeTønß˘i⁄
(
pWÆ
);

48195 if–
pWÆ
->
ªadLock
>=0 ){

48196 
	`wÆU∆ockSh¨ed
(
pWÆ
, 
	`WAL_READ_LOCK
’WÆ->
ªadLock
));

48197 
pWÆ
->
ªadLock
 = -1;

48209 
SQLITE_PRIVATE
 
	`sqlôe3WÆFödFøme
(

48210 
WÆ
 *
pWÆ
,

48211 
Pgno
 
pgno
,

48212 
u32
 *
piRód


48214 
u32
 
iRód
 = 0;

48215 
u32
 
iLa°
 = 
pWÆ
->
hdr
.
mxFøme
;

48216 
iHash
;

48219 
	`as£π
–
pWÆ
->
ªadLock
>=0 ||ÖWÆ->
lockEº‹
 );

48227 if–
iLa°
==0 || 
pWÆ
->
ªadLock
==0 ){

48228 *
piRód
 = 0;

48229  
SQLITE_OK
;

48257 
iHash
=
	`wÆFømePage
(
iLa°
); iHash>=0 && 
iRód
==0; iHash--){

48258 vﬁ©ûê
ht_¶Ÿ
 *
aHash
;

48259 vﬁ©ûê
u32
 *
aPgno
;

48260 
u32
 
iZîo
;

48261 
iKey
;

48262 
nCﬁlide
;

48263 
rc
;

48265 
rc
 = 
	`wÆHashGë
(
pWÆ
, 
iHash
, &
aHash
, &
aPgno
, &
iZîo
);

48266 if–
rc
!=
SQLITE_OK
 ){

48267  
rc
;

48269 
nCﬁlide
 = 
HASHTABLE_NSLOT
;

48270 
iKey
=
	`wÆHash
(
pgno
); 
aHash
[iKey]; iKey=
	`wÆNextHash
(iKey)){

48271 
u32
 
iFøme
 = 
aHash
[
iKey
] + 
iZîo
;

48272 if–
iFøme
<=
iLa°
 && 
aPgno
[
aHash
[
iKey
]]==
pgno
 ){

48274 
iRód
 = 
iFøme
;

48276 if–(
nCﬁlide
--)==0 ){

48277  
SQLITE_CORRUPT_BKPT
;

48282 #ifde‡
SQLITE_ENABLE_EXPENSIVE_ASSERT


48287 
u32
 
iRód2
 = 0;

48288 
u32
 
iTe°
;

48289 
iTe°
=
iLa°
; iTest>0; iTest--){

48290 if–
	`wÆFømePgno
(
pWÆ
, 
iTe°
)==
pgno
 ){

48291 
iRód2
 = 
iTe°
;

48295 
	`as£π
–
iRód
==
iRód2
 );

48299 *
piRód
 = 
iRód
;

48300  
SQLITE_OK
;

48308 
SQLITE_PRIVATE
 
	`sqlôe3WÆRódFøme
(

48309 
WÆ
 *
pWÆ
,

48310 
u32
 
iRód
,

48311 
nOut
,

48312 
u8
 *
pOut


48314 
sz
;

48315 
i64
 
iOff£t
;

48316 
sz
 = 
pWÆ
->
hdr
.
szPage
;

48317 
sz
 = (sz&0xfe00) + ((sz&0x0001)<<16);

48318 
	`ã°ˇ£
–
sz
<=32768 );

48319 
	`ã°ˇ£
–
sz
>=65536 );

48320 
iOff£t
 = 
	`wÆFømeOff£t
(
iRód
, 
sz
Ë+ 
WAL_FRAME_HDRSIZE
;

48322  
	`sqlôe3OsRód
(
pWÆ
->
pWÆFd
, 
pOut
, (
nOut
>
sz
 ? sz :ÇOut), 
iOff£t
);

48328 
SQLITE_PRIVATE
 
Pgno
 
	`sqlôe3WÆDbsize
(
WÆ
 *
pWÆ
){

48329 if–
pWÆ
 && 
	`ALWAYS
’WÆ->
ªadLock
>=0) ){

48330  
pWÆ
->
hdr
.
nPage
;

48349 
SQLITE_PRIVATE
 
	`sqlôe3WÆBegöWrôeTønß˘i⁄
(
WÆ
 *
pWÆ
){

48350 
rc
;

48354 
	`as£π
–
pWÆ
->
ªadLock
>=0 );

48356 if–
pWÆ
->
ªadO∆y
 ){

48357  
SQLITE_READONLY
;

48363 
rc
 = 
	`wÆLockEx˛usive
(
pWÆ
, 
WAL_WRITE_LOCK
, 1);

48364 if–
rc
 ){

48365  
rc
;

48367 
pWÆ
->
wrôeLock
 = 1;

48373 if–
	`memcmp
(&
pWÆ
->
hdr
, (*)
	`wÆIndexHdr
’WÆ), (
WÆIndexHdr
))!=0 ){

48374 
	`wÆU∆ockEx˛usive
(
pWÆ
, 
WAL_WRITE_LOCK
, 1);

48375 
pWÆ
->
wrôeLock
 = 0;

48376 
rc
 = 
SQLITE_BUSY_SNAPSHOT
;

48379  
rc
;

48386 
SQLITE_PRIVATE
 
	`sqlôe3WÆEndWrôeTønß˘i⁄
(
WÆ
 *
pWÆ
){

48387 if–
pWÆ
->
wrôeLock
 ){

48388 
	`wÆU∆ockEx˛usive
(
pWÆ
, 
WAL_WRITE_LOCK
, 1);

48389 
pWÆ
->
wrôeLock
 = 0;

48390 
pWÆ
->
åunˇãOnCommô
 = 0;

48392  
SQLITE_OK
;

48407 
SQLITE_PRIVATE
 
	`sqlôe3WÆUndo
(
WÆ
 *
pWÆ
, (*
xUndo
)(*, 
Pgno
), *
pUndoCtx
){

48408 
rc
 = 
SQLITE_OK
;

48409 if–
	`ALWAYS
(
pWÆ
->
wrôeLock
) ){

48410 
Pgno
 
iMax
 = 
pWÆ
->
hdr
.
mxFøme
;

48411 
Pgno
 
iFøme
;

48416 
	`mem˝y
(&
pWÆ
->
hdr
, (*)
	`wÆIndexHdr
’WÆ), (
WÆIndexHdr
));

48418 
iFøme
=
pWÆ
->
hdr
.
mxFøme
+1;

48419 
	`ALWAYS
(
rc
==
SQLITE_OK
Ë&& 
iFøme
<=
iMax
;

48420 
iFøme
++

48433 
	`as£π
–
	`wÆFømePgno
(
pWÆ
, 
iFøme
)!=1 );

48434 
rc
 = 
	`xUndo
(
pUndoCtx
, 
	`wÆFømePgno
(
pWÆ
, 
iFøme
));

48436 if–
iMax
!=
pWÆ
->
hdr
.
mxFøme
 ) 
	`wÆCÀ™upHash
(pWal);

48438 
	`as£π
–
rc
==
SQLITE_OK
 );

48439  
rc
;

48448 
SQLITE_PRIVATE
 
	`sqlôe3WÆSavïoöt
(
WÆ
 *
pWÆ
, 
u32
 *
aWÆD©a
){

48449 
	`as£π
–
pWÆ
->
wrôeLock
 );

48450 
aWÆD©a
[0] = 
pWÆ
->
hdr
.
mxFøme
;

48451 
aWÆD©a
[1] = 
pWÆ
->
hdr
.
aFømeCksum
[0];

48452 
aWÆD©a
[2] = 
pWÆ
->
hdr
.
aFømeCksum
[1];

48453 
aWÆD©a
[3] = 
pWÆ
->
nCk±
;

48462 
SQLITE_PRIVATE
 
	`sqlôe3WÆSavïoötUndo
(
WÆ
 *
pWÆ
, 
u32
 *
aWÆD©a
){

48463 
rc
 = 
SQLITE_OK
;

48465 
	`as£π
–
pWÆ
->
wrôeLock
 );

48466 
	`as£π
–
aWÆD©a
[3]!=
pWÆ
->
nCk±
 ||áWÆD©a[0]<ıWÆ->
hdr
.
mxFøme
 );

48468 if–
aWÆD©a
[3]!=
pWÆ
->
nCk±
 ){

48473 
aWÆD©a
[0] = 0;

48474 
aWÆD©a
[3] = 
pWÆ
->
nCk±
;

48477 if–
aWÆD©a
[0]<
pWÆ
->
hdr
.
mxFøme
 ){

48478 
pWÆ
->
hdr
.
mxFøme
 = 
aWÆD©a
[0];

48479 
pWÆ
->
hdr
.
aFømeCksum
[0] = 
aWÆD©a
[1];

48480 
pWÆ
->
hdr
.
aFømeCksum
[1] = 
aWÆD©a
[2];

48481 
	`wÆCÀ™upHash
(
pWÆ
);

48484  
rc
;

48500 
	`wÆRe°¨tLog
(
WÆ
 *
pWÆ
){

48501 
rc
 = 
SQLITE_OK
;

48502 
˙t
;

48504 if–
pWÆ
->
ªadLock
==0 ){

48505 vﬁ©ûê
WÆCk±Info
 *
pInfo
 = 
	`wÆCk±Info
(
pWÆ
);

48506 
	`as£π
–
pInfo
->
nBackfûl
==
pWÆ
->
hdr
.
mxFøme
 );

48507 if–
pInfo
->
nBackfûl
>0 ){

48508 
u32
 
ß…1
;

48509 
	`sqlôe3_øndom√ss
(4, &
ß…1
);

48510 
rc
 = 
	`wÆLockEx˛usive
(
pWÆ
, 
	`WAL_READ_LOCK
(1), 
WAL_NREADER
-1);

48511 if–
rc
==
SQLITE_OK
 ){

48522 
i
;

48523 
u32
 *
aSÆt
 = 
pWÆ
->
hdr
.aSalt;

48525 
pWÆ
->
nCk±
++;

48526 
pWÆ
->
hdr
.
mxFøme
 = 0;

48527 
	`sqlôe3Put4byã
((
u8
*)&
aSÆt
[0], 1 + 
	`sqlôe3Gë4byã
((u8*)&aSalt[0]));

48528 
aSÆt
[1] = 
ß…1
;

48529 
	`wÆIndexWrôeHdr
(
pWÆ
);

48530 
pInfo
->
nBackfûl
 = 0;

48531 
pInfo
->
aRódM¨k
[1] = 0;

48532 
i
=2; i<
WAL_NREADER
; i++Ë
pInfo
->
aRódM¨k
[i] = 
READMARK_NOT_USED
;

48533 
	`as£π
–
pInfo
->
aRódM¨k
[0]==0 );

48534 
	`wÆU∆ockEx˛usive
(
pWÆ
, 
	`WAL_READ_LOCK
(1), 
WAL_NREADER
-1);

48535 }if–
rc
!=
SQLITE_BUSY
 ){

48536  
rc
;

48539 
	`wÆU∆ockSh¨ed
(
pWÆ
, 
	`WAL_READ_LOCK
(0));

48540 
pWÆ
->
ªadLock
 = -1;

48541 
˙t
 = 0;

48543 
nŸU£d
;

48544 
rc
 = 
	`wÆTryBegöRód
(
pWÆ
, &
nŸU£d
, 1, ++
˙t
);

48545 } 
rc
==
WAL_RETRY
 );

48546 
	`as£π
–(
rc
&0xff)!=
SQLITE_BUSY
 );

48547 
	`ã°ˇ£
–(
rc
&0xff)==
SQLITE_IOERR
 );

48548 
	`ã°ˇ£
–
rc
==
SQLITE_PROTOCOL
 );

48549 
	`ã°ˇ£
–
rc
==
SQLITE_OK
 );

48551  
rc
;

48559 
	sWÆWrôî
 {

48560 
WÆ
 *
pWÆ
;

48561 
sqlôe3_fûe
 *
pFd
;

48562 
sqlôe3_öt64
 
iSyncPoöt
;

48563 
syncFœgs
;

48564 
szPage
;

48565 } 
	tWÆWrôî
;

48575 
	`wÆWrôeToLog
(

48576 
WÆWrôî
 *
p
,

48577 *
pC⁄ã¡
,

48578 
iAmt
,

48579 
sqlôe3_öt64
 
iOff£t


48581 
rc
;

48582 if–
iOff£t
<
p
->
iSyncPoöt
 && iOff£t+
iAmt
>=p->iSyncPoint ){

48583 
iFú°Amt
 = ()(
p
->
iSyncPoöt
 - 
iOff£t
);

48584 
rc
 = 
	`sqlôe3OsWrôe
(
p
->
pFd
, 
pC⁄ã¡
, 
iFú°Amt
, 
iOff£t
);

48585 if–
rc
 ) Ñc;

48586 
iOff£t
 +
iFú°Amt
;

48587 
iAmt
 -
iFú°Amt
;

48588 
pC⁄ã¡
 = (*)(
iFú°Amt
 + (*)pContent);

48589 
	`as£π
–
p
->
syncFœgs
 & (
SQLITE_SYNC_NORMAL
|
SQLITE_SYNC_FULL
) );

48590 
rc
 = 
	`sqlôe3OsSync
(
p
->
pFd
,Ö->
syncFœgs
);

48591 if–
iAmt
==0 || 
rc
 ) Ñc;

48593 
rc
 = 
	`sqlôe3OsWrôe
(
p
->
pFd
, 
pC⁄ã¡
, 
iAmt
, 
iOff£t
);

48594  
rc
;

48600 
	`wÆWrôeO√Føme
(

48601 
WÆWrôî
 *
p
,

48602 
PgHdr
 *
pPage
,

48603 
nTrunˇã
,

48604 
sqlôe3_öt64
 
iOff£t


48606 
rc
;

48607 *
pD©a
;

48608 
u8
 
aFøme
[
WAL_FRAME_HDRSIZE
];

48609 #i‡
	`deföed
(
SQLITE_HAS_CODEC
)

48610 if–(
pD©a
 = 
	`sqlôe3PagîCodec
(
pPage
))==0 )  
SQLITE_NOMEM
;

48612 
pD©a
 = 
pPage
->pData;

48614 
	`wÆEncodeFøme
(
p
->
pWÆ
, 
pPage
->
pgno
, 
nTrunˇã
, 
pD©a
, 
aFøme
);

48615 
rc
 = 
	`wÆWrôeToLog
(
p
, 
aFøme
, ◊Føme), 
iOff£t
);

48616 if–
rc
 ) Ñc;

48618 
rc
 = 
	`wÆWrôeToLog
(
p
, 
pD©a
,Ö->
szPage
, 
iOff£t
+(
aFøme
));

48619  
rc
;

48626 
SQLITE_PRIVATE
 
	`sqlôe3WÆFømes
(

48627 
WÆ
 *
pWÆ
,

48628 
szPage
,

48629 
PgHdr
 *
pLi°
,

48630 
Pgno
 
nTrunˇã
,

48631 
isCommô
,

48632 
sync_Êags


48634 
rc
;

48635 
u32
 
iFøme
;

48636 
PgHdr
 *
p
;

48637 
PgHdr
 *
pLa°
 = 0;

48638 
nExåa
 = 0;

48639 
szFøme
;

48640 
i64
 
iOff£t
;

48641 
WÆWrôî
 
w
;

48643 
	`as£π
–
pLi°
 );

48644 
	`as£π
–
pWÆ
->
wrôeLock
 );

48648 
	`as£π
–(
isCommô
!=0)==(
nTrunˇã
!=0) );

48650 #i‡
	`deföed
(
SQLITE_TEST
Ë&& deföed(
SQLITE_DEBUG
)

48651 { 
˙t
; ˙t=0, 
p
=
pLi°
;Ö;Öı->
pDúty
, cnt++){}

48652 
	`WALTRACE
(("WAL%p: frame write begin. %d frames. mxFrame=%d. %s\n",

48653 
pWÆ
, 
˙t
,ÖWÆ->
hdr
.
mxFøme
, 
isCommô
 ? "Commit" : "Spill"));

48660 if–
SQLITE_OK
!=(
rc
 = 
	`wÆRe°¨tLog
(
pWÆ
)) ){

48661  
rc
;

48668 
iFøme
 = 
pWÆ
->
hdr
.
mxFøme
;

48669 if–
iFøme
==0 ){

48670 
u8
 
aWÆHdr
[
WAL_HDRSIZE
];

48671 
u32
 
aCksum
[2];

48673 
	`sqlôe3Put4byã
(&
aWÆHdr
[0], (
WAL_MAGIC
 | 
SQLITE_BIGENDIAN
));

48674 
	`sqlôe3Put4byã
(&
aWÆHdr
[4], 
WAL_MAX_VERSION
);

48675 
	`sqlôe3Put4byã
(&
aWÆHdr
[8], 
szPage
);

48676 
	`sqlôe3Put4byã
(&
aWÆHdr
[12], 
pWÆ
->
nCk±
);

48677 if–
pWÆ
->
nCk±
==0 ) 
	`sqlôe3_øndom√ss
(8,ÖWÆ->
hdr
.
aSÆt
);

48678 
	`mem˝y
(&
aWÆHdr
[16], 
pWÆ
->
hdr
.
aSÆt
, 8);

48679 
	`wÆChecksumByãs
(1, 
aWÆHdr
, 
WAL_HDRSIZE
-2*4, 0, 
aCksum
);

48680 
	`sqlôe3Put4byã
(&
aWÆHdr
[24], 
aCksum
[0]);

48681 
	`sqlôe3Put4byã
(&
aWÆHdr
[28], 
aCksum
[1]);

48683 
pWÆ
->
szPage
 = szPage;

48684 
pWÆ
->
hdr
.
bigEndCksum
 = 
SQLITE_BIGENDIAN
;

48685 
pWÆ
->
hdr
.
aFømeCksum
[0] = 
aCksum
[0];

48686 
pWÆ
->
hdr
.
aFømeCksum
[1] = 
aCksum
[1];

48687 
pWÆ
->
åunˇãOnCommô
 = 1;

48689 
rc
 = 
	`sqlôe3OsWrôe
(
pWÆ
->
pWÆFd
, 
aWÆHdr
, (aWalHdr), 0);

48690 
	`WALTRACE
(("WAL%p: wÆ-hódî wrôê%s\n", 
pWÆ
, 
rc
 ? "failed" : "ok"));

48691 if–
rc
!=
SQLITE_OK
 ){

48692  
rc
;

48702 if–
pWÆ
->
syncHódî
 && 
sync_Êags
 ){

48703 
rc
 = 
	`sqlôe3OsSync
(
pWÆ
->
pWÆFd
, 
sync_Êags
 & 
SQLITE_SYNC_MASK
);

48704 if–
rc
 ) Ñc;

48707 
	`as£π
–()
pWÆ
->
szPage
==szPage );

48710 
w
.
pWÆ
 =ÖWal;

48711 
w
.
pFd
 = 
pWÆ
->
pWÆFd
;

48712 
w
.
iSyncPoöt
 = 0;

48713 
w
.
syncFœgs
 = 
sync_Êags
;

48714 
w
.
szPage
 = szPage;

48715 
iOff£t
 = 
	`wÆFømeOff£t
(
iFøme
+1, 
szPage
);

48716 
szFøme
 = 
szPage
 + 
WAL_FRAME_HDRSIZE
;

48719 
p
=
pLi°
;Ö;Öı->
pDúty
){

48720 
nDbSize
;

48721 
iFøme
++;

48722 
	`as£π
–
iOff£t
==
	`wÆFømeOff£t
(
iFøme
, 
szPage
) );

48723 
nDbSize
 = (
isCommô
 && 
p
->
pDúty
==0Ë? 
nTrunˇã
 : 0;

48724 
rc
 = 
	`wÆWrôeO√Føme
(&
w
, 
p
, 
nDbSize
, 
iOff£t
);

48725 if–
rc
 ) Ñc;

48726 
pLa°
 = 
p
;

48727 
iOff£t
 +
szFøme
;

48744 if–
isCommô
 && (
sync_Êags
 & 
WAL_SYNC_TRANSACTIONS
)!=0 ){

48745 if–
pWÆ
->
∑dToSe˘‹Bound¨y
 ){

48746 
£˘‹Size
 = 
	`sqlôe3Se˘‹Size
(
pWÆ
->
pWÆFd
);

48747 
w
.
iSyncPoöt
 = ((
iOff£t
+
£˘‹Size
-1)/sectorSize)*sectorSize;

48748  
iOff£t
<
w
.
iSyncPoöt
 ){

48749 
rc
 = 
	`wÆWrôeO√Føme
(&
w
, 
pLa°
, 
nTrunˇã
, 
iOff£t
);

48750 if–
rc
 ) Ñc;

48751 
iOff£t
 +
szFøme
;

48752 
nExåa
++;

48755 
rc
 = 
	`sqlôe3OsSync
(
w
.
pFd
, 
sync_Êags
 & 
SQLITE_SYNC_MASK
);

48763 if–
isCommô
 && 
pWÆ
->
åunˇãOnCommô
 &&ÖWÆ->
mxWÆSize
>=0 ){

48764 
i64
 
sz
 = 
pWÆ
->
mxWÆSize
;

48765 if–
	`wÆFømeOff£t
(
iFøme
+
nExåa
+1, 
szPage
)>
pWÆ
->
mxWÆSize
 ){

48766 
sz
 = 
	`wÆFømeOff£t
(
iFøme
+
nExåa
+1, 
szPage
);

48768 
	`wÆLimôSize
(
pWÆ
, 
sz
);

48769 
pWÆ
->
åunˇãOnCommô
 = 0;

48777 
iFøme
 = 
pWÆ
->
hdr
.
mxFøme
;

48778 
p
=
pLi°
;Ö && 
rc
==
SQLITE_OK
;Öı->
pDúty
){

48779 
iFøme
++;

48780 
rc
 = 
	`wÆIndexAµíd
(
pWÆ
, 
iFøme
, 
p
->
pgno
);

48782  
rc
==
SQLITE_OK
 && 
nExåa
>0 ){

48783 
iFøme
++;

48784 
nExåa
--;

48785 
rc
 = 
	`wÆIndexAµíd
(
pWÆ
, 
iFøme
, 
pLa°
->
pgno
);

48788 if–
rc
==
SQLITE_OK
 ){

48790 
pWÆ
->
hdr
.
szPage
 = (
u16
)((szPage&0xff00) | (szPage>>16));

48791 
	`ã°ˇ£
–
szPage
<=32768 );

48792 
	`ã°ˇ£
–
szPage
>=65536 );

48793 
pWÆ
->
hdr
.
mxFøme
 = 
iFøme
;

48794 if–
isCommô
 ){

48795 
pWÆ
->
hdr
.
iCh™ge
++;

48796 
pWÆ
->
hdr
.
nPage
 = 
nTrunˇã
;

48799 if–
isCommô
 ){

48800 
	`wÆIndexWrôeHdr
(
pWÆ
);

48801 
pWÆ
->
iCÆlback
 = 
iFøme
;

48805 
	`WALTRACE
(("WAL%p: fømêwrôê%s\n", 
pWÆ
, 
rc
 ? "failed" : "ok"));

48806  
rc
;

48819 
SQLITE_PRIVATE
 
	`sqlôe3WÆCheckpoöt
(

48820 
WÆ
 *
pWÆ
,

48821 
eMode
,

48822 (*
xBusy
)(*),

48823 *
pBusyArg
,

48824 
sync_Êags
,

48825 
nBuf
,

48826 
u8
 *
zBuf
,

48827 *
≤Log
,

48828 *
≤Ck±


48830 
rc
;

48831 
isCh™ged
 = 0;

48832 
eMode2
 = 
eMode
;

48834 
	`as£π
–
pWÆ
->
ck±Lock
==0 );

48835 
	`as£π
–
pWÆ
->
wrôeLock
==0 );

48837 if–
pWÆ
->
ªadO∆y
 )  
SQLITE_READONLY
;

48838 
	`WALTRACE
(("WAL%p: checkpoöàbegös\n", 
pWÆ
));

48839 
rc
 = 
	`wÆLockEx˛usive
(
pWÆ
, 
WAL_CKPT_LOCK
, 1);

48840 if–
rc
 ){

48844  
rc
;

48846 
pWÆ
->
ck±Lock
 = 1;

48857 if–
eMode
!=
SQLITE_CHECKPOINT_PASSIVE
 ){

48858 
rc
 = 
	`wÆBusyLock
(
pWÆ
, 
xBusy
, 
pBusyArg
, 
WAL_WRITE_LOCK
, 1);

48859 if–
rc
==
SQLITE_OK
 ){

48860 
pWÆ
->
wrôeLock
 = 1;

48861 }if–
rc
==
SQLITE_BUSY
 ){

48862 
eMode2
 = 
SQLITE_CHECKPOINT_PASSIVE
;

48863 
rc
 = 
SQLITE_OK
;

48868 if–
rc
==
SQLITE_OK
 ){

48869 
rc
 = 
	`wÆIndexRódHdr
(
pWÆ
, &
isCh™ged
);

48870 if–
isCh™ged
 && 
pWÆ
->
pDbFd
->
pMëhods
->
iVîsi⁄
>=3 ){

48871 
	`sqlôe3OsUn„tch
(
pWÆ
->
pDbFd
, 0, 0);

48876 if–
rc
==
SQLITE_OK
 ){

48877 if–
pWÆ
->
hdr
.
mxFøme
 && 
	`wÆPagesize
’WÆ)!=
nBuf
 ){

48878 
rc
 = 
SQLITE_CORRUPT_BKPT
;

48880 
rc
 = 
	`wÆCheckpoöt
(
pWÆ
, 
eMode2
, 
xBusy
, 
pBusyArg
, 
sync_Êags
, 
zBuf
);

48884 if–
rc
==
SQLITE_OK
 ||Ñc==
SQLITE_BUSY
 ){

48885 if–
≤Log
 ) *≤Log = ()
pWÆ
->
hdr
.
mxFøme
;

48886 if–
≤Ck±
 ) *≤Ck± = ()(
	`wÆCk±Info
(
pWÆ
)->
nBackfûl
);

48890 if–
isCh™ged
 ){

48897 
	`mem£t
(&
pWÆ
->
hdr
, 0, (
WÆIndexHdr
));

48901 
	`sqlôe3WÆEndWrôeTønß˘i⁄
(
pWÆ
);

48902 
	`wÆU∆ockEx˛usive
(
pWÆ
, 
WAL_CKPT_LOCK
, 1);

48903 
pWÆ
->
ck±Lock
 = 0;

48904 
	`WALTRACE
(("WAL%p: checkpoöà%s\n", 
pWÆ
, 
rc
 ? "failed" : "ok"));

48905  (
rc
==
SQLITE_OK
 && 
eMode
!=
eMode2
 ? 
SQLITE_BUSY
 :Ñc);

48913 
SQLITE_PRIVATE
 
	`sqlôe3WÆCÆlback
(
WÆ
 *
pWÆ
){

48914 
u32
 
ªt
 = 0;

48915 if–
pWÆ
 ){

48916 
ªt
 = 
pWÆ
->
iCÆlback
;

48917 
pWÆ
->
iCÆlback
 = 0;

48919  ()
ªt
;

48946 
SQLITE_PRIVATE
 
	`sqlôe3WÆEx˛usiveMode
(
WÆ
 *
pWÆ
, 
›
){

48947 
rc
;

48948 
	`as£π
–
pWÆ
->
wrôeLock
==0 );

48949 
	`as£π
–
pWÆ
->
ex˛usiveMode
!=
WAL_HEAPMEMORY_MODE
 || 
›
==-1 );

48957 
	`as£π
–
pWÆ
->
ªadLock
>=0 ||ÖWÆ->
lockEº‹
 );

48958 
	`as£π
–
pWÆ
->
ªadLock
>=0 || (
›
<=0 &&ÖWÆ->
ex˛usiveMode
==0) );

48960 if–
›
==0 ){

48961 if–
pWÆ
->
ex˛usiveMode
 ){

48962 
pWÆ
->
ex˛usiveMode
 = 0;

48963 if–
	`wÆLockSh¨ed
(
pWÆ
, 
	`WAL_READ_LOCK
’WÆ->
ªadLock
))!=
SQLITE_OK
 ){

48964 
pWÆ
->
ex˛usiveMode
 = 1;

48966 
rc
 = 
pWÆ
->
ex˛usiveMode
==0;

48969 
rc
 = 0;

48971 }if–
›
>0 ){

48972 
	`as£π
–
pWÆ
->
ex˛usiveMode
==0 );

48973 
	`as£π
–
pWÆ
->
ªadLock
>=0 );

48974 
	`wÆU∆ockSh¨ed
(
pWÆ
, 
	`WAL_READ_LOCK
’WÆ->
ªadLock
));

48975 
pWÆ
->
ex˛usiveMode
 = 1;

48976 
rc
 = 1;

48978 
rc
 = 
pWÆ
->
ex˛usiveMode
==0;

48980  
rc
;

48988 
SQLITE_PRIVATE
 
	`sqlôe3WÆHópMem‹y
(
WÆ
 *
pWÆ
){

48989  (
pWÆ
 &&ÖWÆ->
ex˛usiveMode
==
WAL_HEAPMEMORY_MODE
 );

48992 #ifde‡
SQLITE_ENABLE_ZIPVFS


48998 
SQLITE_PRIVATE
 
	`sqlôe3WÆFømesize
(
WÆ
 *
pWÆ
){

48999 
	`as£π
–
pWÆ
==0 ||ÖWÆ->
ªadLock
>=0 );

49000  (
pWÆ
 ?ÖWÆ->
szPage
 : 0);

49247 
	#MX_CELL_SIZE
(
pBt
Ë(()’Bt->
∑geSize
-8))

	)

49254 
	#MX_CELL
(
pBt
Ë(’Bt->
∑geSize
-8)/6)

	)

49257 
MemPage
 
	tMemPage
;

49258 
BtLock
 
	tBtLock
;

49272 #i‚de‡
SQLITE_FILE_HEADER


49273 
	#SQLITE_FILE_HEADER
 "SQLôêf‹m© 3"

	)

49280 
	#PTF_INTKEY
 0x01

	)

49281 
	#PTF_ZERODATA
 0x02

	)

49282 
	#PTF_LEAFDATA
 0x04

	)

49283 
	#PTF_LEAF
 0x08

	)

49298 
	sMemPage
 {

49299 
u8
 
isInô
;

49300 
u8
 
nOvîÊow
;

49301 
u8
 
ötKey
;

49302 
u8
 
Àaf
;

49303 
u8
 
hasD©a
;

49304 
u8
 
hdrOff£t
;

49305 
u8
 
chûdPåSize
;

49306 
u8
 
max1byãPaylﬂd
;

49307 
u16
 
maxLoˇl
;

49308 
u16
 
möLoˇl
;

49309 
u16
 
˚ŒOff£t
;

49310 
u16
 
nFªe
;

49311 
u16
 
nCñl
;

49312 
u16
 
maskPage
;

49313 
u16
 
aiOvÊ
[5];

49315 
u8
 *
≠OvÊ
[5];

49316 
BtSh¨ed
 *
pBt
;

49317 
u8
 *
aD©a
;

49318 
u8
 *
aD©aEnd
;

49319 
u8
 *
aCñlIdx
;

49320 
DbPage
 *
pDbPage
;

49321 
Pgno
 
pgno
;

49329 
	#EXTRA_SIZE
 (
MemPage
)

	)

49338 
	sBtLock
 {

49339 
Båì
 *
pBåì
;

49340 
Pgno
 
iTabÀ
;

49341 
u8
 
eLock
;

49342 
BtLock
 *
pNext
;

49346 
	#READ_LOCK
 1

	)

49347 
	#WRITE_LOCK
 2

	)

49370 
	sBåì
 {

49371 
sqlôe3
 *
db
;

49372 
BtSh¨ed
 *
pBt
;

49373 
u8
 
öTøns
;

49374 
u8
 
sh¨abÀ
;

49375 
u8
 
locked
;

49376 
w™tToLock
;

49377 
nBackup
;

49378 
Båì
 *
pNext
;

49379 
Båì
 *
pPªv
;

49380 #i‚de‡
SQLITE_OMIT_SHARED_CACHE


49381 
BtLock
 
lock
;

49392 
	#TRANS_NONE
 0

	)

49393 
	#TRANS_READ
 1

	)

49394 
	#TRANS_WRITE
 2

	)

49431 
	sBtSh¨ed
 {

49432 
Pagî
 *
pPagî
;

49433 
sqlôe3
 *
db
;

49434 
BtCurs‹
 *
pCurs‹
;

49435 
MemPage
 *
pPage1
;

49436 
u8
 
›íFœgs
;

49437 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


49438 
u8
 
autoVacuum
;

49439 
u8
 
ö¸Vacuum
;

49440 
u8
 
bDoTrunˇã
;

49442 
u8
 
öTønß˘i⁄
;

49443 
u8
 
max1byãPaylﬂd
;

49444 
u16
 
btsFœgs
;

49445 
u16
 
maxLoˇl
;

49446 
u16
 
möLoˇl
;

49447 
u16
 
maxLóf
;

49448 
u16
 
möLóf
;

49449 
u32
 
∑geSize
;

49450 
u32
 
ußbÀSize
;

49451 
nTønß˘i⁄
;

49452 
u32
 
nPage
;

49453 *
pSchema
;

49454 (*
xFªeSchema
)(*);

49455 
sqlôe3_muãx
 *
muãx
;

49456 
Bôvec
 *
pHasC⁄ã¡
;

49457 #i‚de‡
SQLITE_OMIT_SHARED_CACHE


49458 
nRef
;

49459 
BtSh¨ed
 *
pNext
;

49460 
BtLock
 *
pLock
;

49461 
Båì
 *
pWrôî
;

49463 
u8
 *
pTmpS∑˚
;

49469 
	#BTS_READ_ONLY
 0x0001

	)

49470 
	#BTS_PAGESIZE_FIXED
 0x0002

	)

49471 
	#BTS_SECURE_DELETE
 0x0004

	)

49472 
	#BTS_INITIALLY_EMPTY
 0x0008

	)

49473 
	#BTS_NO_WAL
 0x0010

	)

49474 
	#BTS_EXCLUSIVE
 0x0020

	)

49475 
	#BTS_PENDING
 0x0040

	)

49482 
CñlInfo
 
	tCñlInfo
;

49483 
	sCñlInfo
 {

49484 
i64
 
nKey
;

49485 
u8
 *
pCñl
;

49486 
u32
 
nD©a
;

49487 
u32
 
nPaylﬂd
;

49488 
u16
 
nHódî
;

49489 
u16
 
nLoˇl
;

49490 
u16
 
iOvîÊow
;

49491 
u16
 
nSize
;

49503 
	#BTCURSOR_MAX_DEPTH
 20

	)

49519 
	sBtCurs‹
 {

49520 
Båì
 *
pBåì
;

49521 
BtSh¨ed
 *
pBt
;

49522 
BtCurs‹
 *
pNext
, *
pPªv
;

49523 
KeyInfo
 *
pKeyInfo
;

49524 #i‚de‡
SQLITE_OMIT_INCRBLOB


49525 
Pgno
 *
aOvîÊow
;

49527 
Pgno
 
pgnoRoŸ
;

49528 
sqlôe3_öt64
 
ˇchedRowid
;

49529 
CñlInfo
 
öfo
;

49530 
i64
 
nKey
;

49531 *
pKey
;

49532 
skùNext
;

49533 
u8
 
wrFœg
;

49534 
u8
 
©La°
;

49535 
u8
 
vÆidNKey
;

49536 
u8
 
eSèã
;

49537 #i‚de‡
SQLITE_OMIT_INCRBLOB


49538 
u8
 
isIn¸blobH™dÀ
;

49540 
u8
 
höts
;

49541 
i16
 
iPage
;

49542 
u16
 
aiIdx
[
BTCURSOR_MAX_DEPTH
];

49543 
MemPage
 *
≠Page
[
BTCURSOR_MAX_DEPTH
];

49576 
	#CURSOR_INVALID
 0

	)

49577 
	#CURSOR_VALID
 1

	)

49578 
	#CURSOR_SKIPNEXT
 2

	)

49579 
	#CURSOR_REQUIRESEEK
 3

	)

49580 
	#CURSOR_FAULT
 4

	)

49585 
	#PENDING_BYTE_PAGE
(
pBt
Ë
	`PAGER_MJ_PGNO
’Bt)

	)

49602 
	#PTRMAP_PAGENO
(
pBt
, 
pgno
Ë
	`±rm≠Pagío
’Bt,Ögno)

	)

49603 
	#PTRMAP_PTROFFSET
(
pg±rm≠
, 
pgno
Ë(5*’gno-pg±rm≠-1))

	)

49604 
	#PTRMAP_ISPAGE
(
pBt
, 
pgno
Ë(
	`PTRMAP_PAGENO
(’Bt),’gno))==’gno))

	)

49637 
	#PTRMAP_ROOTPAGE
 1

	)

49638 
	#PTRMAP_FREEPAGE
 2

	)

49639 
	#PTRMAP_OVERFLOW1
 3

	)

49640 
	#PTRMAP_OVERFLOW2
 4

	)

49641 
	#PTRMAP_BTREE
 5

	)

49646 
	#båìI¡egrôy
(
p
) \

49647 
	`as£π
–
p
->
pBt
->
öTønß˘i⁄
!=
TRANS_NONE
 ||Ö->pBt->
nTønß˘i⁄
==0 ); \

49648 
	`as£π
–
p
->
pBt
->
öTønß˘i⁄
>ı->
öTøns
 );

	)

49658 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


49659 
	#ISAUTOVACUUM
 (
pBt
->
autoVacuum
)

	)

49661 
	#ISAUTOVACUUM
 0

	)

49675 
I¡egrôyCk
 
	tI¡egrôyCk
;

49676 
	sI¡egrôyCk
 {

49677 
BtSh¨ed
 *
pBt
;

49678 
Pagî
 *
pPagî
;

49679 
u8
 *
aPgRef
;

49680 
Pgno
 
nPage
;

49681 
mxEº
;

49682 
nEº
;

49683 
mÆlocFaûed
;

49684 
SåAccum
 
îrMsg
;

49690 
	#gë2byã
(
x
Ë((x)[0]<<8 | (x)[1])

	)

49691 
	#put2byã
(
p
,
v
Ë(’)[0] = (
u8
)((v)>>8), (p)[1] = (u8)(v))

	)

49692 
	#gë4byã
 
sqlôe3Gë4byã


	)

49693 
	#put4byã
 
sqlôe3Put4byã


	)

49697 #i‚de‡
SQLITE_OMIT_SHARED_CACHE


49698 #i‡
SQLITE_THREADSAFE


49705 
	`lockBåìMuãx
(
Båì
 *
p
){

49706 
	`as£π
–
p
->
locked
==0 );

49707 
	`as£π
–
	`sqlôe3_muãx_nŸhñd
(
p
->
pBt
->
muãx
) );

49708 
	`as£π
–
	`sqlôe3_muãx_hñd
(
p
->
db
->
muãx
) );

49710 
	`sqlôe3_muãx_íãr
(
p
->
pBt
->
muãx
);

49711 
p
->
pBt
->
db
 =Ö->db;

49712 
p
->
locked
 = 1;

49719 
	`u∆ockBåìMuãx
(
Båì
 *
p
){

49720 
BtSh¨ed
 *
pBt
 = 
p
->pBt;

49721 
	`as£π
–
p
->
locked
==1 );

49722 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pBt
->
muãx
) );

49723 
	`as£π
–
	`sqlôe3_muãx_hñd
(
p
->
db
->
muãx
) );

49724 
	`as£π
–
p
->
db
==
pBt
->db );

49726 
	`sqlôe3_muãx_Àave
(
pBt
->
muãx
);

49727 
p
->
locked
 = 0;

49746 
SQLITE_PRIVATE
 
	`sqlôe3BåìE¡î
(
Båì
 *
p
){

49747 
Båì
 *
pL©î
;

49753 
	`as£π
–
p
->
pNext
==0 ||Ö->pNext->
pBt
>p->pBt );

49754 
	`as£π
–
p
->
pPªv
==0 ||Ö->pPªv->
pBt
<p->pBt );

49755 
	`as£π
–
p
->
pNext
==0 ||Ö->pNext->
db
==p->db );

49756 
	`as£π
–
p
->
pPªv
==0 ||Ö->pPªv->
db
==p->db );

49757 
	`as£π
–
p
->
sh¨abÀ
 || (p->
pNext
==0 &&Ö->
pPªv
==0) );

49760 
	`as£π
–!
p
->
locked
 ||Ö->
w™tToLock
>0 );

49761 
	`as£π
–
p
->
sh¨abÀ
 ||Ö->
w™tToLock
==0 );

49764 
	`as£π
–
	`sqlôe3_muãx_hñd
(
p
->
db
->
muãx
) );

49768 
	`as£π
–(
p
->
locked
==0 &&Ö->
sh¨abÀ
Ë||Ö->
pBt
->
db
==p->db );

49770 if–!
p
->
sh¨abÀ
 ) ;

49771 
p
->
w™tToLock
++;

49772 if–
p
->
locked
 ) ;

49778 if–
	`sqlôe3_muãx_åy
(
p
->
pBt
->
muãx
)==
SQLITE_OK
 ){

49779 
p
->
pBt
->
db
 =Ö->db;

49780 
p
->
locked
 = 1;

49789 
pL©î
=
p
->
pNext
;ÖLater;ÖLater=pLater->pNext){

49790 
	`as£π
–
pL©î
->
sh¨abÀ
 );

49791 
	`as£π
–
pL©î
->
pNext
==0 ||ÖL©î->pNext->
pBt
>pLater->pBt );

49792 
	`as£π
–!
pL©î
->
locked
 ||ÖL©î->
w™tToLock
>0 );

49793 if–
pL©î
->
locked
 ){

49794 
	`u∆ockBåìMuãx
(
pL©î
);

49797 
	`lockBåìMuãx
(
p
);

49798 
pL©î
=
p
->
pNext
;ÖLater;ÖLater=pLater->pNext){

49799 if–
pL©î
->
w™tToLock
 ){

49800 
	`lockBåìMuãx
(
pL©î
);

49808 
SQLITE_PRIVATE
 
	`sqlôe3BåìLóve
(
Båì
 *
p
){

49809 if–
p
->
sh¨abÀ
 ){

49810 
	`as£π
–
p
->
w™tToLock
>0 );

49811 
p
->
w™tToLock
--;

49812 if–
p
->
w™tToLock
==0 ){

49813 
	`u∆ockBåìMuãx
(
p
);

49818 #i‚de‡
NDEBUG


49825 
SQLITE_PRIVATE
 
	`sqlôe3BåìHﬁdsMuãx
(
Båì
 *
p
){

49826 
	`as£π
–
p
->
sh¨abÀ
==0 ||Ö->
locked
==0 ||Ö->
w™tToLock
>0 );

49827 
	`as£π
–
p
->
sh¨abÀ
==0 ||Ö->
locked
==0 ||Ö->
db
=ı->
pBt
->db );

49828 
	`as£π
–
p
->
sh¨abÀ
==0 ||Ö->
locked
==0 || 
	`sqlôe3_muãx_hñd
’->
pBt
->
muãx
) );

49829 
	`as£π
–
p
->
sh¨abÀ
==0 ||Ö->
locked
==0 || 
	`sqlôe3_muãx_hñd
’->
db
->
muãx
) );

49831  (
p
->
sh¨abÀ
==0 ||Ö->
locked
);

49836 #i‚de‡
SQLITE_OMIT_INCRBLOB


49842 
SQLITE_PRIVATE
 
	`sqlôe3BåìE¡îCurs‹
(
BtCurs‹
 *
pCur
){

49843 
	`sqlôe3BåìE¡î
(
pCur
->
pBåì
);

49845 
SQLITE_PRIVATE
 
	`sqlôe3BåìLóveCurs‹
(
BtCurs‹
 *
pCur
){

49846 
	`sqlôe3BåìLóve
(
pCur
->
pBåì
);

49865 
SQLITE_PRIVATE
 
	`sqlôe3BåìE¡îAŒ
(
sqlôe3
 *
db
){

49866 
i
;

49867 
Båì
 *
p
;

49868 
	`as£π
–
	`sqlôe3_muãx_hñd
(
db
->
muãx
) );

49869 
i
=0; i<
db
->
nDb
; i++){

49870 
p
 = 
db
->
aDb
[
i
].
pBt
;

49871 if–
p
 ) 
	`sqlôe3BåìE¡î
(p);

49874 
SQLITE_PRIVATE
 
	`sqlôe3BåìLóveAŒ
(
sqlôe3
 *
db
){

49875 
i
;

49876 
Båì
 *
p
;

49877 
	`as£π
–
	`sqlôe3_muãx_hñd
(
db
->
muãx
) );

49878 
i
=0; i<
db
->
nDb
; i++){

49879 
p
 = 
db
->
aDb
[
i
].
pBt
;

49880 if–
p
 ) 
	`sqlôe3BåìLóve
(p);

49888 
SQLITE_PRIVATE
 
	`sqlôe3BåìSh¨abÀ
(
Båì
 *
p
){

49889  
p
->
sh¨abÀ
;

49892 #i‚de‡
NDEBUG


49899 
SQLITE_PRIVATE
 
	`sqlôe3BåìHﬁdsAŒMuãxes
(
sqlôe3
 *
db
){

49900 
i
;

49901 if–!
	`sqlôe3_muãx_hñd
(
db
->
muãx
) ){

49904 
i
=0; i<
db
->
nDb
; i++){

49905 
Båì
 *
p
;

49906 
p
 = 
db
->
aDb
[
i
].
pBt
;

49907 if–
p
 &&Ö->
sh¨abÀ
 &&

49908 (
p
->
w™tToLock
==0 || !
	`sqlôe3_muãx_hñd
’->
pBt
->
muãx
)) ){

49916 #i‚de‡
NDEBUG


49928 
SQLITE_PRIVATE
 
	`sqlôe3SchemaMuãxHñd
(
sqlôe3
 *
db
, 
iDb
, 
Schema
 *
pSchema
){

49929 
Båì
 *
p
;

49930 
	`as£π
–
db
!=0 );

49931 if–
pSchema
 ) 
iDb
 = 
	`sqlôe3SchemaToIndex
(
db
,ÖSchema);

49932 
	`as£π
–
iDb
>=0 && iDb<
db
->
nDb
 );

49933 if–!
	`sqlôe3_muãx_hñd
(
db
->
muãx
) )  0;

49934 if–
iDb
==1 )  1;

49935 
p
 = 
db
->
aDb
[
iDb
].
pBt
;

49936 
	`as£π
–
p
!=0 );

49937  
p
->
sh¨abÀ
==0 ||Ö->
locked
==1;

49952 
SQLITE_PRIVATE
 
	`sqlôe3BåìE¡î
(
Båì
 *
p
){

49953 
p
->
pBt
->
db
 =Ö->db;

49955 
SQLITE_PRIVATE
 
	`sqlôe3BåìE¡îAŒ
(
sqlôe3
 *
db
){

49956 
i
;

49957 
i
=0; i<
db
->
nDb
; i++){

49958 
Båì
 *
p
 = 
db
->
aDb
[
i
].
pBt
;

49959 if–
p
 ){

49960 
p
->
pBt
->
db
 =Ö->db;

49989 c⁄° 
zMagicHódî
[] = 
SQLITE_FILE_HEADER
;

49996 
sqlôe3BåìTø˚
=1;

49997 
	#TRACE
(
X
Ëif(
sqlôe3BåìTø˚
){
¥ötf
 X;
	`fÊush
(
°dout
);}

	)

49999 
	#TRACE
(
X
)

	)

50011 
	#gë2byãNŸZîo
(
X
Ë((((()
	`gë2byã
(X))-1)&0xffff)+1)

	)

50016 
	#BTALLOC_ANY
 0

	)

50017 
	#BTALLOC_EXACT
 1

	)

50018 
	#BTALLOC_LE
 2

	)

50026 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


50027 
	#IfNŸOmôAV
(
ex¥
Ë”x¥)

	)

50029 
	#IfNŸOmôAV
(
ex¥
Ë0

	)

50032 #i‚de‡
SQLITE_OMIT_SHARED_CACHE


50041 #ifde‡
SQLITE_TEST


50042 
SQLITE_PRIVATE
 
BtSh¨ed
 *
SQLITE_WSD
 
sqlôe3Sh¨edCacheLi°
 = 0;

50044 
BtSh¨ed
 *
SQLITE_WSD
 
sqlôe3Sh¨edCacheLi°
 = 0;

50048 #i‚de‡
SQLITE_OMIT_SHARED_CACHE


50056 
SQLITE_API
 
	`sqlôe3_íabÀ_sh¨ed_ˇche
(
íabÀ
){

50057 
sqlôe3GlobÆC⁄fig
.
sh¨edCacheE«bÀd
 = 
íabÀ
;

50058  
SQLITE_OK
;

50064 #ifde‡
SQLITE_OMIT_SHARED_CACHE


50074 
	#quîySh¨edCacheTabÀLock
(
a
,
b
,
c
Ë
SQLITE_OK


	)

50075 
	#£tSh¨edCacheTabÀLock
(
a
,
b
,
c
Ë
SQLITE_OK


	)

50076 
	#˛órAŒSh¨edCacheTabÀLocks
(
a
)

	)

50077 
	#downgødeAŒSh¨edCacheTabÀLocks
(
a
)

	)

50078 
	#hasSh¨edCacheTabÀLock
(
a
,
b
,
c
,
d
Ë1

	)

50079 
	#hasRódC⁄Êi˘s
(
a
, 
b
Ë0

	)

50082 #i‚de‡
SQLITE_OMIT_SHARED_CACHE


50084 #ifde‡
SQLITE_DEBUG


50107 
	`hasSh¨edCacheTabÀLock
(

50108 
Båì
 *
pBåì
,

50109 
Pgno
 
iRoŸ
,

50110 
isIndex
,

50111 
eLockTy≥


50113 
Schema
 *
pSchema
 = (Schem®*)
pBåì
->
pBt
->pSchema;

50114 
Pgno
 
iTab
 = 0;

50115 
BtLock
 *
pLock
;

50121 if–(
pBåì
->
sh¨abÀ
==0)

50122 || (
eLockTy≥
==
READ_LOCK
 && (
pBåì
->
db
->
Êags
 & 
SQLITE_RódUncommôãd
))

50132 if–
isIndex
 && (!
pSchema
 || (pSchema->
Êags
&
DB_SchemaLﬂded
)==0) ){

50140 if–
isIndex
 ){

50141 
HashEÀm
 *
p
;

50142 
p
=
	`sqlôeHashFú°
(&
pSchema
->
idxHash
);Ö;Ö=
	`sqlôeHashNext
(p)){

50143 
Index
 *
pIdx
 = (Index *)
	`sqlôeHashD©a
(
p
);

50144 if–
pIdx
->
äum
==()
iRoŸ
 ){

50145 
iTab
 = 
pIdx
->
pTabÀ
->
äum
;

50149 
iTab
 = 
iRoŸ
;

50155 
pLock
=
pBåì
->
pBt
->pLock;ÖLock;ÖLockıLock->
pNext
){

50156 if–
pLock
->
pBåì
==pBtree

50157 && (
pLock
->
iTabÀ
==
iTab
 || (pLock->
eLock
==
WRITE_LOCK
 &&ÖLock->iTable==1))

50158 && 
pLock
->
eLock
>=
eLockTy≥


50169 #ifde‡
SQLITE_DEBUG


50188 
	`hasRódC⁄Êi˘s
(
Båì
 *
pBåì
, 
Pgno
 
iRoŸ
){

50189 
BtCurs‹
 *
p
;

50190 
p
=
pBåì
->
pBt
->
pCurs‹
;Ö;Öı->
pNext
){

50191 if–
p
->
pgnoRoŸ
==
iRoŸ


50192 && 
p
->
pBåì
!=pBtree

50193 && 0==(
p
->
pBåì
->
db
->
Êags
 & 
SQLITE_RódUncommôãd
)

50208 
	`quîySh¨edCacheTabÀLock
(
Båì
 *
p
, 
Pgno
 
iTab
, 
u8
 
eLock
){

50209 
BtSh¨ed
 *
pBt
 = 
p
->pBt;

50210 
BtLock
 *
pIãr
;

50212 
	`as£π
–
	`sqlôe3BåìHﬁdsMuãx
(
p
) );

50213 
	`as£π
–
eLock
==
READ_LOCK
 ||ÉLock==
WRITE_LOCK
 );

50214 
	`as£π
–
p
->
db
!=0 );

50215 
	`as£π
–!(
p
->
db
->
Êags
&
SQLITE_RódUncommôãd
)||
eLock
==
WRITE_LOCK
||
iTab
==1 );

50221 
	`as£π
–
eLock
==
READ_LOCK
 || (
p
==
pBt
->
pWrôî
 &&Ö->
öTøns
==
TRANS_WRITE
) );

50222 
	`as£π
–
eLock
==
READ_LOCK
 || 
pBt
->
öTønß˘i⁄
==
TRANS_WRITE
 );

50225 if–!
p
->
sh¨abÀ
 ){

50226  
SQLITE_OK
;

50232 if–
pBt
->
pWrôî
!=
p
 && (pBt->
btsFœgs
 & 
BTS_EXCLUSIVE
)!=0 ){

50233 
	`sqlôe3C⁄√˘i⁄Blocked
(
p
->
db
, 
pBt
->
pWrôî
->db);

50234  
SQLITE_LOCKED_SHAREDCACHE
;

50237 
pIãr
=
pBt
->
pLock
;ÖIãr;ÖIãrıIãr->
pNext
){

50247 
	`as£π
–
pIãr
->
eLock
==
READ_LOCK
 ||ÖIãr->eLock==
WRITE_LOCK
 );

50248 
	`as£π
–
eLock
==
READ_LOCK
 || 
pIãr
->
pBåì
==
p
 ||ÖIter->eLock==READ_LOCK);

50249 if–
pIãr
->
pBåì
!=
p
 &&ÖIãr->
iTabÀ
==
iTab
 &&ÖIãr->
eLock
!=eLock ){

50250 
	`sqlôe3C⁄√˘i⁄Blocked
(
p
->
db
, 
pIãr
->
pBåì
->db);

50251 if–
eLock
==
WRITE_LOCK
 ){

50252 
	`as£π
–
p
==
pBt
->
pWrôî
 );

50253 
pBt
->
btsFœgs
 |
BTS_PENDING
;

50255  
SQLITE_LOCKED_SHAREDCACHE
;

50258  
SQLITE_OK
;

50262 #i‚de‡
SQLITE_OMIT_SHARED_CACHE


50280 
	`£tSh¨edCacheTabÀLock
(
Båì
 *
p
, 
Pgno
 
iTabÀ
, 
u8
 
eLock
){

50281 
BtSh¨ed
 *
pBt
 = 
p
->pBt;

50282 
BtLock
 *
pLock
 = 0;

50283 
BtLock
 *
pIãr
;

50285 
	`as£π
–
	`sqlôe3BåìHﬁdsMuãx
(
p
) );

50286 
	`as£π
–
eLock
==
READ_LOCK
 ||ÉLock==
WRITE_LOCK
 );

50287 
	`as£π
–
p
->
db
!=0 );

50293 
	`as£π
–0==(
p
->
db
->
Êags
&
SQLITE_RódUncommôãd
Ë|| 
eLock
==
WRITE_LOCK
 );

50297 
	`as£π
–
p
->
sh¨abÀ
 );

50298 
	`as£π
–
SQLITE_OK
==
	`quîySh¨edCacheTabÀLock
(
p
, 
iTabÀ
, 
eLock
) );

50301 
pIãr
=
pBt
->
pLock
;ÖIãr;ÖIãrıIãr->
pNext
){

50302 if–
pIãr
->
iTabÀ
==iTabÀ &&ÖIãr->
pBåì
==
p
 ){

50303 
pLock
 = 
pIãr
;

50311 if–!
pLock
 ){

50312 
pLock
 = (
BtLock
 *)
	`sqlôe3MÆlocZîo
((BtLock));

50313 if–!
pLock
 ){

50314  
SQLITE_NOMEM
;

50316 
pLock
->
iTabÀ
 = iTable;

50317 
pLock
->
pBåì
 = 
p
;

50318 
pLock
->
pNext
 = 
pBt
->pLock;

50319 
pBt
->
pLock
 =ÖLock;

50326 
	`as£π
–
WRITE_LOCK
>
READ_LOCK
 );

50327 if–
eLock
>
pLock
->eLock ){

50328 
pLock
->
eLock
 =ÉLock;

50331  
SQLITE_OK
;

50335 #i‚de‡
SQLITE_OMIT_SHARED_CACHE


50344 
	`˛órAŒSh¨edCacheTabÀLocks
(
Båì
 *
p
){

50345 
BtSh¨ed
 *
pBt
 = 
p
->pBt;

50346 
BtLock
 **
µIãr
 = &
pBt
->
pLock
;

50348 
	`as£π
–
	`sqlôe3BåìHﬁdsMuãx
(
p
) );

50349 
	`as£π
–
p
->
sh¨abÀ
 || 0==*
µIãr
 );

50350 
	`as£π
–
p
->
öTøns
>0 );

50352  *
µIãr
 ){

50353 
BtLock
 *
pLock
 = *
µIãr
;

50354 
	`as£π
–(
pBt
->
btsFœgs
 & 
BTS_EXCLUSIVE
)==0 ||ÖBt->
pWrôî
==
pLock
->
pBåì
 );

50355 
	`as£π
–
pLock
->
pBåì
->
öTøns
>ıLock->
eLock
 );

50356 if–
pLock
->
pBåì
==
p
 ){

50357 *
µIãr
 = 
pLock
->
pNext
;

50358 
	`as£π
–
pLock
->
iTabÀ
!=1 ||ÖLock==&
p
->
lock
 );

50359 if–
pLock
->
iTabÀ
!=1 ){

50360 
	`sqlôe3_‰ì
(
pLock
);

50363 
µIãr
 = &
pLock
->
pNext
;

50367 
	`as£π
–(
pBt
->
btsFœgs
 & 
BTS_PENDING
)==0 ||ÖBt->
pWrôî
 );

50368 if–
pBt
->
pWrôî
==
p
 ){

50369 
pBt
->
pWrôî
 = 0;

50370 
pBt
->
btsFœgs
 &~(
BTS_EXCLUSIVE
|
BTS_PENDING
);

50371 }if–
pBt
->
nTønß˘i⁄
==2 ){

50381 
pBt
->
btsFœgs
 &~
BTS_PENDING
;

50388 
	`downgødeAŒSh¨edCacheTabÀLocks
(
Båì
 *
p
){

50389 
BtSh¨ed
 *
pBt
 = 
p
->pBt;

50390 if–
pBt
->
pWrôî
==
p
 ){

50391 
BtLock
 *
pLock
;

50392 
pBt
->
pWrôî
 = 0;

50393 
pBt
->
btsFœgs
 &~(
BTS_EXCLUSIVE
|
BTS_PENDING
);

50394 
pLock
=
pBt
->pLock;ÖLock;ÖLockıLock->
pNext
){

50395 
	`as£π
–
pLock
->
eLock
==
READ_LOCK
 ||ÖLock->
pBåì
==
p
 );

50396 
pLock
->
eLock
 = 
READ_LOCK
;

50403 
	`ªÀa£Page
(
MemPage
 *
pPage
);

50410 #ifde‡
SQLITE_DEBUG


50411 
	`curs‹HﬁdsMuãx
(
BtCurs‹
 *
p
){

50412  
	`sqlôe3_muãx_hñd
(
p
->
pBt
->
muãx
);

50417 #i‚de‡
SQLITE_OMIT_INCRBLOB


50421 
	`övÆid©eOvîÊowCache
(
BtCurs‹
 *
pCur
){

50422 
	`as£π
–
	`curs‹HﬁdsMuãx
(
pCur
) );

50423 
	`sqlôe3_‰ì
(
pCur
->
aOvîÊow
);

50424 
pCur
->
aOvîÊow
 = 0;

50431 
	`övÆid©eAŒOvîÊowCache
(
BtSh¨ed
 *
pBt
){

50432 
BtCurs‹
 *
p
;

50433 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pBt
->
muãx
) );

50434 
p
=
pBt
->
pCurs‹
;Ö;Öı->
pNext
){

50435 
	`övÆid©eOvîÊowCache
(
p
);

50452 
	`övÆid©eIn¸blobCurs‹s
(

50453 
Båì
 *
pBåì
,

50454 
i64
 
iRow
,

50455 
isCÀ¨TabÀ


50457 
BtCurs‹
 *
p
;

50458 
BtSh¨ed
 *
pBt
 = 
pBåì
->pBt;

50459 
	`as£π
–
	`sqlôe3BåìHﬁdsMuãx
(
pBåì
) );

50460 
p
=
pBt
->
pCurs‹
;Ö;Öı->
pNext
){

50461 if–
p
->
isIn¸blobH™dÀ
 && (
isCÀ¨TabÀ
 ||Ö->
öfo
.
nKey
==
iRow
) ){

50462 
p
->
eSèã
 = 
CURSOR_INVALID
;

50469 
	#övÆid©eOvîÊowCache
(
x
)

	)

50470 
	#övÆid©eAŒOvîÊowCache
(
x
)

	)

50471 
	#övÆid©eIn¸blobCurs‹s
(
x
,
y
,
z
)

	)

50509 
	`båìSëHasC⁄ã¡
(
BtSh¨ed
 *
pBt
, 
Pgno
 
pgno
){

50510 
rc
 = 
SQLITE_OK
;

50511 if–!
pBt
->
pHasC⁄ã¡
 ){

50512 
	`as£π
–
pgno
<=
pBt
->
nPage
 );

50513 
pBt
->
pHasC⁄ã¡
 = 
	`sqlôe3BôvecCª©e
’Bt->
nPage
);

50514 if–!
pBt
->
pHasC⁄ã¡
 ){

50515 
rc
 = 
SQLITE_NOMEM
;

50518 if–
rc
==
SQLITE_OK
 && 
pgno
<=
	`sqlôe3BôvecSize
(
pBt
->
pHasC⁄ã¡
) ){

50519 
rc
 = 
	`sqlôe3BôvecSë
(
pBt
->
pHasC⁄ã¡
, 
pgno
);

50521  
rc
;

50531 
	`båìGëHasC⁄ã¡
(
BtSh¨ed
 *
pBt
, 
Pgno
 
pgno
){

50532 
Bôvec
 *
p
 = 
pBt
->
pHasC⁄ã¡
;

50533  (
p
 && (
pgno
>
	`sqlôe3BôvecSize
’Ë|| 
	`sqlôe3BôvecTe°
(p,Ögno)));

50540 
	`båìCÀ¨HasC⁄ã¡
(
BtSh¨ed
 *
pBt
){

50541 
	`sqlôe3BôvecDe°roy
(
pBt
->
pHasC⁄ã¡
);

50542 
pBt
->
pHasC⁄ã¡
 = 0;

50548 
	`båìRñó£AŒCurs‹Pages
(
BtCurs‹
 *
pCur
){

50549 
i
;

50550 
i
=0; i<=
pCur
->
iPage
; i++){

50551 
	`ªÀa£Page
(
pCur
->
≠Page
[
i
]);

50552 
pCur
->
≠Page
[
i
] = 0;

50554 
pCur
->
iPage
 = -1;

50565 
	`ßveCurs‹Posôi⁄
(
BtCurs‹
 *
pCur
){

50566 
rc
;

50568 
	`as£π
–
CURSOR_VALID
==
pCur
->
eSèã
 );

50569 
	`as£π
–0==
pCur
->
pKey
 );

50570 
	`as£π
–
	`curs‹HﬁdsMuãx
(
pCur
) );

50572 
rc
 = 
	`sqlôe3BåìKeySize
(
pCur
, &pCur->
nKey
);

50573 
	`as£π
–
rc
==
SQLITE_OK
 );

50581 if–0==
pCur
->
≠Page
[0]->
ötKey
 ){

50582 *
pKey
 = 
	`sqlôe3MÆloc
–()
pCur
->
nKey
 );

50583 if–
pKey
 ){

50584 
rc
 = 
	`sqlôe3BåìKey
(
pCur
, 0, (ÌCur->
nKey
, 
pKey
);

50585 if–
rc
==
SQLITE_OK
 ){

50586 
pCur
->
pKey
 =ÖKey;

50588 
	`sqlôe3_‰ì
(
pKey
);

50591 
rc
 = 
SQLITE_NOMEM
;

50594 
	`as£π
–!
pCur
->
≠Page
[0]->
ötKey
 || !pCur->
pKey
 );

50596 if–
rc
==
SQLITE_OK
 ){

50597 
	`båìRñó£AŒCurs‹Pages
(
pCur
);

50598 
pCur
->
eSèã
 = 
CURSOR_REQUIRESEEK
;

50601 
	`övÆid©eOvîÊowCache
(
pCur
);

50602  
rc
;

50610 
	`ßveAŒCurs‹s
(
BtSh¨ed
 *
pBt
, 
Pgno
 
iRoŸ
, 
BtCurs‹
 *
pEx˚±
){

50611 
BtCurs‹
 *
p
;

50612 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pBt
->
muãx
) );

50613 
	`as£π
–
pEx˚±
==0 ||ÖEx˚±->
pBt
==pBt );

50614 
p
=
pBt
->
pCurs‹
;Ö;Öı->
pNext
){

50615 if–
p
!=
pEx˚±
 && (0==
iRoŸ
 ||Ö->
pgnoRoŸ
==iRoot) ){

50616 if–
p
->
eSèã
==
CURSOR_VALID
 ){

50617 
rc
 = 
	`ßveCurs‹Posôi⁄
(
p
);

50618 if–
SQLITE_OK
!=
rc
 ){

50619  
rc
;

50622 
	`ã°ˇ£
–
p
->
iPage
>0 );

50623 
	`båìRñó£AŒCurs‹Pages
(
p
);

50627  
SQLITE_OK
;

50633 
SQLITE_PRIVATE
 
	`sqlôe3BåìCÀ¨Curs‹
(
BtCurs‹
 *
pCur
){

50634 
	`as£π
–
	`curs‹HﬁdsMuãx
(
pCur
) );

50635 
	`sqlôe3_‰ì
(
pCur
->
pKey
);

50636 
pCur
->
pKey
 = 0;

50637 
pCur
->
eSèã
 = 
CURSOR_INVALID
;

50645 
	`båìMovëo
(

50646 
BtCurs‹
 *
pCur
,

50647 c⁄° *
pKey
,

50648 
i64
 
nKey
,

50649 
büs
,

50650 *
pRes


50652 
rc
;

50653 
U≈ackedRec‹d
 *
pIdxKey
;

50654 
aS∑˚
[150];

50655 *
pFªe
 = 0;

50657 if–
pKey
 ){

50658 
	`as£π
–
nKey
==(
i64
)()nKey );

50659 
pIdxKey
 = 
	`sqlôe3VdbeAŒocU≈ackedRec‹d
(

50660 
pCur
->
pKeyInfo
, 
aS∑˚
, ◊S∑˚), &
pFªe


50662 if–
pIdxKey
==0 )  
SQLITE_NOMEM
;

50663 
	`sqlôe3VdbeRec‹dU≈ack
(
pCur
->
pKeyInfo
, ()
nKey
, 
pKey
, 
pIdxKey
);

50665 
pIdxKey
 = 0;

50667 
rc
 = 
	`sqlôe3BåìMovëoU≈acked
(
pCur
, 
pIdxKey
, 
nKey
, 
büs
, 
pRes
);

50668 if–
pFªe
 ){

50669 
	`sqlôe3DbFªe
(
pCur
->
pKeyInfo
->
db
, 
pFªe
);

50671  
rc
;

50681 
	`båìRe°‹eCurs‹Posôi⁄
(
BtCurs‹
 *
pCur
){

50682 
rc
;

50683 
	`as£π
–
	`curs‹HﬁdsMuãx
(
pCur
) );

50684 
	`as£π
–
pCur
->
eSèã
>=
CURSOR_REQUIRESEEK
 );

50685 if–
pCur
->
eSèã
==
CURSOR_FAULT
 ){

50686  
pCur
->
skùNext
;

50688 
pCur
->
eSèã
 = 
CURSOR_INVALID
;

50689 
rc
 = 
	`båìMovëo
(
pCur
,ÖCur->
pKey
,ÖCur->
nKey
, 0, &pCur->
skùNext
);

50690 if–
rc
==
SQLITE_OK
 ){

50691 
	`sqlôe3_‰ì
(
pCur
->
pKey
);

50692 
pCur
->
pKey
 = 0;

50693 
	`as£π
–
pCur
->
eSèã
==
CURSOR_VALID
 ||ÖCur->eSèã==
CURSOR_INVALID
 );

50694 if–
pCur
->
skùNext
 &&ÖCur->
eSèã
==
CURSOR_VALID
 ){

50695 
pCur
->
eSèã
 = 
CURSOR_SKIPNEXT
;

50698  
rc
;

50701 
	#ª°‹eCurs‹Posôi⁄
(
p
) \

50702 (
p
->
eSèã
>=
CURSOR_REQUIRESEEK
 ? \

50703 
	`båìRe°‹eCurs‹Posôi⁄
(
p
) : \

50704 
SQLITE_OK
)

	)

50714 
SQLITE_PRIVATE
 
	`sqlôe3BåìCurs‹HasMoved
(
BtCurs‹
 *
pCur
, *
pHasMoved
){

50715 
rc
;

50717 
rc
 = 
	`ª°‹eCurs‹Posôi⁄
(
pCur
);

50718 if–
rc
 ){

50719 *
pHasMoved
 = 1;

50720  
rc
;

50722 if–
pCur
->
eSèã
!=
CURSOR_VALID
 || 
	`NEVER
’Cur->
skùNext
!=0) ){

50723 *
pHasMoved
 = 1;

50725 *
pHasMoved
 = 0;

50727  
SQLITE_OK
;

50730 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


50740 
Pgno
 
	`±rm≠Pagío
(
BtSh¨ed
 *
pBt
, Pgnÿ
pgno
){

50741 
nPagesPîM≠Page
;

50742 
Pgno
 
iPåM≠
, 
ªt
;

50743 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pBt
->
muãx
) );

50744 if–
pgno
<2 )  0;

50745 
nPagesPîM≠Page
 = (
pBt
->
ußbÀSize
/5)+1;

50746 
iPåM≠
 = (
pgno
-2)/
nPagesPîM≠Page
;

50747 
ªt
 = (
iPåM≠
*
nPagesPîM≠Page
) + 2;

50748 if–
ªt
==
	`PENDING_BYTE_PAGE
(
pBt
) ){

50749 
ªt
++;

50751  
ªt
;

50764 
	`±rm≠Put
(
BtSh¨ed
 *
pBt
, 
Pgno
 
key
, 
u8
 
eTy≥
, Pgnÿ
∑ª¡
, *
pRC
){

50765 
DbPage
 *
pDbPage
;

50766 
u8
 *
pPåm≠
;

50767 
Pgno
 
iPåm≠
;

50768 
off£t
;

50769 
rc
;

50771 if–*
pRC
 ) ;

50773 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pBt
->
muãx
) );

50775 
	`as£π
–0==
	`PTRMAP_ISPAGE
(
pBt
, 
	`PENDING_BYTE_PAGE
(pBt)) );

50777 
	`as£π
–
pBt
->
autoVacuum
 );

50778 if–
key
==0 ){

50779 *
pRC
 = 
SQLITE_CORRUPT_BKPT
;

50782 
iPåm≠
 = 
	`PTRMAP_PAGENO
(
pBt
, 
key
);

50783 
rc
 = 
	`sqlôe3PagîGë
(
pBt
->
pPagî
, 
iPåm≠
, &
pDbPage
);

50784 if–
rc
!=
SQLITE_OK
 ){

50785 *
pRC
 = 
rc
;

50788 
off£t
 = 
	`PTRMAP_PTROFFSET
(
iPåm≠
, 
key
);

50789 if–
off£t
<0 ){

50790 *
pRC
 = 
SQLITE_CORRUPT_BKPT
;

50791 
±rm≠_exô
;

50793 
	`as£π
–
off£t
 <()
pBt
->
ußbÀSize
-5 );

50794 
pPåm≠
 = (
u8
 *)
	`sqlôe3PagîGëD©a
(
pDbPage
);

50796 if–
eTy≥
!=
pPåm≠
[
off£t
] || 
	`gë4byã
(&pPåm≠[off£t+1])!=
∑ª¡
 ){

50797 
	`TRACE
(("PTRMAP_UPDATE: %d->(%d,%d)\n", 
key
, 
eTy≥
, 
∑ª¡
));

50798 *
pRC

rc
 = 
	`sqlôe3PagîWrôe
(
pDbPage
);

50799 if–
rc
==
SQLITE_OK
 ){

50800 
pPåm≠
[
off£t
] = 
eTy≥
;

50801 
	`put4byã
(&
pPåm≠
[
off£t
+1], 
∑ª¡
);

50805 
±rm≠_exô
:

50806 
	`sqlôe3PagîUƒef
(
pDbPage
);

50816 
	`±rm≠Gë
(
BtSh¨ed
 *
pBt
, 
Pgno
 
key
, 
u8
 *
pETy≥
, Pgnÿ*
pPgno
){

50817 
DbPage
 *
pDbPage
;

50818 
iPåm≠
;

50819 
u8
 *
pPåm≠
;

50820 
off£t
;

50821 
rc
;

50823 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pBt
->
muãx
) );

50825 
iPåm≠
 = 
	`PTRMAP_PAGENO
(
pBt
, 
key
);

50826 
rc
 = 
	`sqlôe3PagîGë
(
pBt
->
pPagî
, 
iPåm≠
, &
pDbPage
);

50827 if–
rc
!=0 ){

50828  
rc
;

50830 
pPåm≠
 = (
u8
 *)
	`sqlôe3PagîGëD©a
(
pDbPage
);

50832 
off£t
 = 
	`PTRMAP_PTROFFSET
(
iPåm≠
, 
key
);

50833 if–
off£t
<0 ){

50834 
	`sqlôe3PagîUƒef
(
pDbPage
);

50835  
SQLITE_CORRUPT_BKPT
;

50837 
	`as£π
–
off£t
 <()
pBt
->
ußbÀSize
-5 );

50838 
	`as£π
–
pETy≥
!=0 );

50839 *
pETy≥
 = 
pPåm≠
[
off£t
];

50840 if–
pPgno
 ) *pPgnÿ
	`gë4byã
(&
pPåm≠
[
off£t
+1]);

50842 
	`sqlôe3PagîUƒef
(
pDbPage
);

50843 if–*
pETy≥
<1 || *pETy≥>5 )  
SQLITE_CORRUPT_BKPT
;

50844  
SQLITE_OK
;

50848 
	#±rm≠Put
(
w
,
x
,
y
,
z
,
rc
)

	)

50849 
	#±rm≠Gë
(
w
,
x
,
y
,
z
Ë
SQLITE_OK


	)

50850 
	#±rm≠PutOvÊPå
(
x
, 
y
, 
rc
)

	)

50860 
	#födCñl
(
P
,
I
) \

50861 ((
P
)->
aD©a
 + ((P)->
maskPage
 & 
	`gë2byã
(&(P)->
aCñlIdx
[2*(
I
)])))

	)

50862 
	#födCñlv2
(
D
,
M
,
O
,
I
Ë(D+(M&
	`gë2byã
(D+(O+2*(I)))))

	)

50869 
u8
 *
	`födOvîÊowCñl
(
MemPage
 *
pPage
, 
iCñl
){

50870 
i
;

50871 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pPage
->
pBt
->
muãx
) );

50872 
i
=
pPage
->
nOvîÊow
-1; i>=0; i--){

50873 
k
;

50874 
k
 = 
pPage
->
aiOvÊ
[
i
];

50875 if–
k
<=
iCñl
 ){

50876 if–
k
==
iCñl
 ){

50877  
pPage
->
≠OvÊ
[
i
];

50879 
iCñl
--;

50882  
	`födCñl
(
pPage
, 
iCñl
);

50894 
	`båìP¨£CñlPå
(

50895 
MemPage
 *
pPage
,

50896 
u8
 *
pCñl
,

50897 
CñlInfo
 *
pInfo


50899 
u16
 
n
;

50900 
u32
 
nPaylﬂd
;

50902 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pPage
->
pBt
->
muãx
) );

50904 
pInfo
->
pCñl
 =ÖCell;

50905 
	`as£π
–
pPage
->
Àaf
==0 ||ÖPage->leaf==1 );

50906 
n
 = 
pPage
->
chûdPåSize
;

50907 
	`as£π
–
n
==4-4*
pPage
->
Àaf
 );

50908 if–
pPage
->
ötKey
 ){

50909 if–
pPage
->
hasD©a
 ){

50910 
	`as£π
–
n
==0 );

50911 
n
 = 
	`gëV¨öt32
(
pCñl
, 
nPaylﬂd
);

50913 
nPaylﬂd
 = 0;

50915 
n
 +
	`gëV¨öt
(&
pCñl
[n], (
u64
*)&
pInfo
->
nKey
);

50916 
pInfo
->
nD©a
 = 
nPaylﬂd
;

50918 
pInfo
->
nD©a
 = 0;

50919 
n
 +
	`gëV¨öt32
(&
pCñl
[n], 
nPaylﬂd
);

50920 
pInfo
->
nKey
 = 
nPaylﬂd
;

50922 
pInfo
->
nPaylﬂd
 =ÇPayload;

50923 
pInfo
->
nHódî
 = 
n
;

50924 
	`ã°ˇ£
–
nPaylﬂd
==
pPage
->
maxLoˇl
 );

50925 
	`ã°ˇ£
–
nPaylﬂd
==
pPage
->
maxLoˇl
+1 );

50926 if–
	`likñy
(
nPaylﬂd
<=
pPage
->
maxLoˇl
) ){

50930 if–(
pInfo
->
nSize
 = (
u16
)(
n
+
nPaylﬂd
))<4 )ÖInfo->nSize = 4;

50931 
pInfo
->
nLoˇl
 = (
u16
)
nPaylﬂd
;

50932 
pInfo
->
iOvîÊow
 = 0;

50943 
möLoˇl
;

50944 
maxLoˇl
;

50945 
suΩlus
;

50947 
möLoˇl
 = 
pPage
->minLocal;

50948 
maxLoˇl
 = 
pPage
->maxLocal;

50949 
suΩlus
 = 
möLoˇl
 + (
nPaylﬂd
 - möLoˇl)%(
pPage
->
pBt
->
ußbÀSize
 - 4);

50950 
	`ã°ˇ£
–
suΩlus
==
maxLoˇl
 );

50951 
	`ã°ˇ£
–
suΩlus
==
maxLoˇl
+1 );

50952 if–
suΩlus
 <
maxLoˇl
 ){

50953 
pInfo
->
nLoˇl
 = (
u16
)
suΩlus
;

50955 
pInfo
->
nLoˇl
 = (
u16
)
möLoˇl
;

50957 
pInfo
->
iOvîÊow
 = (
u16
)’Info->
nLoˇl
 + 
n
);

50958 
pInfo
->
nSize
 =ÖInfo->
iOvîÊow
 + 4;

50961 
	#∑r£Cñl
(
pPage
, 
iCñl
, 
pInfo
) \

50962 
	`båìP¨£CñlPå
((
pPage
), 
	`födCñl
(’Page), (
iCñl
)), (
pInfo
))

	)

50963 
	`båìP¨£Cñl
(

50964 
MemPage
 *
pPage
,

50965 
iCñl
,

50966 
CñlInfo
 *
pInfo


50968 
	`∑r£Cñl
(
pPage
, 
iCñl
, 
pInfo
);

50977 
u16
 
	`˚ŒSizePå
(
MemPage
 *
pPage
, 
u8
 *
pCñl
){

50978 
u8
 *
pIãr
 = &
pCñl
[
pPage
->
chûdPåSize
];

50979 
u32
 
nSize
;

50981 #ifde‡
SQLITE_DEBUG


50986 
CñlInfo
 
debugöfo
;

50987 
	`båìP¨£CñlPå
(
pPage
, 
pCñl
, &
debugöfo
);

50990 if–
pPage
->
ötKey
 ){

50991 
u8
 *
pEnd
;

50992 if–
pPage
->
hasD©a
 ){

50993 
pIãr
 +
	`gëV¨öt32
’Iãr, 
nSize
);

50995 
nSize
 = 0;

51001 
pEnd
 = &
pIãr
[9];

51002  (*
pIãr
++)&0x80 &&ÖIãr<
pEnd
 );

51004 
pIãr
 +
	`gëV¨öt32
’Iãr, 
nSize
);

51007 
	`ã°ˇ£
–
nSize
==
pPage
->
maxLoˇl
 );

51008 
	`ã°ˇ£
–
nSize
==
pPage
->
maxLoˇl
+1 );

51009 if–
nSize
>
pPage
->
maxLoˇl
 ){

51010 
möLoˇl
 = 
pPage
->minLocal;

51011 
nSize
 = 
möLoˇl
 + (nSizê- möLoˇlË% (
pPage
->
pBt
->
ußbÀSize
 - 4);

51012 
	`ã°ˇ£
–
nSize
==
pPage
->
maxLoˇl
 );

51013 
	`ã°ˇ£
–
nSize
==
pPage
->
maxLoˇl
+1 );

51014 if–
nSize
>
pPage
->
maxLoˇl
 ){

51015 
nSize
 = 
möLoˇl
;

51017 
nSize
 += 4;

51019 
nSize
 +(
u32
)(
pIãr
 - 
pCñl
);

51022 if–
nSize
<4 ){

51023 
nSize
 = 4;

51026 
	`as£π
–
nSize
==
debugöfo
.nSize );

51027  (
u16
)
nSize
;

51030 #ifde‡
SQLITE_DEBUG


51033 
u16
 
	`˚ŒSize
(
MemPage
 *
pPage
, 
iCñl
){

51034  
	`˚ŒSizePå
(
pPage
, 
	`födCñl
’Page, 
iCñl
));

51038 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


51044 
	`±rm≠PutOvÊPå
(
MemPage
 *
pPage
, 
u8
 *
pCñl
, *
pRC
){

51045 
CñlInfo
 
öfo
;

51046 if–*
pRC
 ) ;

51047 
	`as£π
–
pCñl
!=0 );

51048 
	`båìP¨£CñlPå
(
pPage
, 
pCñl
, &
öfo
);

51049 
	`as£π
–(
öfo
.
nD©a
+(
pPage
->
ötKey
?0:öfo.
nKey
))==öfo.
nPaylﬂd
 );

51050 if–
öfo
.
iOvîÊow
 ){

51051 
Pgno
 
ovÊ
 = 
	`gë4byã
(&
pCñl
[
öfo
.
iOvîÊow
]);

51052 
	`±rm≠Put
(
pPage
->
pBt
, 
ovÊ
, 
PTRMAP_OVERFLOW1
,ÖPage->
pgno
, 
pRC
);

51064 
	`de‰agmítPage
(
MemPage
 *
pPage
){

51065 
i
;

51066 
pc
;

51067 
hdr
;

51068 
size
;

51069 
ußbÀSize
;

51070 
˚ŒOff£t
;

51071 
cbrk
;

51072 
nCñl
;

51073 *
d©a
;

51074 *
ãmp
;

51075 
iCñlFú°
;

51076 
iCñlLa°
;

51079 
	`as£π
–
	`sqlôe3PagîIswrôóbÀ
(
pPage
->
pDbPage
) );

51080 
	`as£π
–
pPage
->
pBt
!=0 );

51081 
	`as£π
–
pPage
->
pBt
->
ußbÀSize
 <
SQLITE_MAX_PAGE_SIZE
 );

51082 
	`as£π
–
pPage
->
nOvîÊow
==0 );

51083 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pPage
->
pBt
->
muãx
) );

51084 
ãmp
 = 
	`sqlôe3PagîTempS∑˚
(
pPage
->
pBt
->
pPagî
);

51085 
d©a
 = 
pPage
->
aD©a
;

51086 
hdr
 = 
pPage
->
hdrOff£t
;

51087 
˚ŒOff£t
 = 
pPage
->cellOffset;

51088 
nCñl
 = 
pPage
->nCell;

51089 
	`as£π
–
nCñl
==
	`gë2byã
(&
d©a
[
hdr
+3]) );

51090 
ußbÀSize
 = 
pPage
->
pBt
->usableSize;

51091 
cbrk
 = 
	`gë2byã
(&
d©a
[
hdr
+5]);

51092 
	`mem˝y
(&
ãmp
[
cbrk
], &
d©a
[cbrk], 
ußbÀSize
 - cbrk);

51093 
cbrk
 = 
ußbÀSize
;

51094 
iCñlFú°
 = 
˚ŒOff£t
 + 2*
nCñl
;

51095 
iCñlLa°
 = 
ußbÀSize
 - 4;

51096 
i
=0; i<
nCñl
; i++){

51097 
u8
 *
pAddr
;

51098 
pAddr
 = &
d©a
[
˚ŒOff£t
 + 
i
*2];

51099 
pc
 = 
	`gë2byã
(
pAddr
);

51100 
	`ã°ˇ£
–
pc
==
iCñlFú°
 );

51101 
	`ã°ˇ£
–
pc
==
iCñlLa°
 );

51102 #i‡!
	`deföed
(
SQLITE_ENABLE_OVERSIZE_CELL_CHECK
)

51106 if–
pc
<
iCñlFú°
 ||Öc>
iCñlLa°
 ){

51107  
SQLITE_CORRUPT_BKPT
;

51110 
	`as£π
–
pc
>=
iCñlFú°
 &&Öc<=
iCñlLa°
 );

51111 
size
 = 
	`˚ŒSizePå
(
pPage
, &
ãmp
[
pc
]);

51112 
cbrk
 -
size
;

51113 #i‡
	`deföed
(
SQLITE_ENABLE_OVERSIZE_CELL_CHECK
)

51114 if–
cbrk
<
iCñlFú°
 ){

51115  
SQLITE_CORRUPT_BKPT
;

51118 if–
cbrk
<
iCñlFú°
 || 
pc
+
size
>
ußbÀSize
 ){

51119  
SQLITE_CORRUPT_BKPT
;

51122 
	`as£π
–
cbrk
+
size
<=
ußbÀSize
 && cbrk>=
iCñlFú°
 );

51123 
	`ã°ˇ£
–
cbrk
+
size
==
ußbÀSize
 );

51124 
	`ã°ˇ£
–
pc
+
size
==
ußbÀSize
 );

51125 
	`mem˝y
(&
d©a
[
cbrk
], &
ãmp
[
pc
], 
size
);

51126 
	`put2byã
(
pAddr
, 
cbrk
);

51128 
	`as£π
–
cbrk
>=
iCñlFú°
 );

51129 
	`put2byã
(&
d©a
[
hdr
+5], 
cbrk
);

51130 
d©a
[
hdr
+1] = 0;

51131 
d©a
[
hdr
+2] = 0;

51132 
d©a
[
hdr
+7] = 0;

51133 
	`mem£t
(&
d©a
[
iCñlFú°
], 0, 
cbrk
-iCellFirst);

51134 
	`as£π
–
	`sqlôe3PagîIswrôóbÀ
(
pPage
->
pDbPage
) );

51135 if–
cbrk
-
iCñlFú°
!=
pPage
->
nFªe
 ){

51136  
SQLITE_CORRUPT_BKPT
;

51138  
SQLITE_OK
;

51154 
	`ÆloˇãS∑˚
(
MemPage
 *
pPage
, 
nByã
, *
pIdx
){

51155 c⁄° 
hdr
 = 
pPage
->
hdrOff£t
;

51156 
u8
 * c⁄° 
d©a
 = 
pPage
->
aD©a
;

51157 
nFøg
;

51158 
t›
;

51159 
g≠
;

51160 
rc
;

51161 
ußbÀSize
;

51163 
	`as£π
–
	`sqlôe3PagîIswrôóbÀ
(
pPage
->
pDbPage
) );

51164 
	`as£π
–
pPage
->
pBt
 );

51165 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pPage
->
pBt
->
muãx
) );

51166 
	`as£π
–
nByã
>=0 );

51167 
	`as£π
–
pPage
->
nFªe
>=
nByã
 );

51168 
	`as£π
–
pPage
->
nOvîÊow
==0 );

51169 
ußbÀSize
 = 
pPage
->
pBt
->usableSize;

51170 
	`as£π
–
nByã
 < 
ußbÀSize
-8 );

51172 
nFøg
 = 
d©a
[
hdr
+7];

51173 
	`as£π
–
pPage
->
˚ŒOff£t
 =
hdr
 + 12 - 4*pPage->
Àaf
 );

51174 
g≠
 = 
pPage
->
˚ŒOff£t
 + 2*pPage->
nCñl
;

51175 
t›
 = 
	`gë2byãNŸZîo
(&
d©a
[
hdr
+5]);

51176 if–
g≠
>
t›
 )  
SQLITE_CORRUPT_BKPT
;

51177 
	`ã°ˇ£
–
g≠
+2==
t›
 );

51178 
	`ã°ˇ£
–
g≠
+1==
t›
 );

51179 
	`ã°ˇ£
–
g≠
==
t›
 );

51181 if–
nFøg
>=60 ){

51183 
rc
 = 
	`de‰agmítPage
(
pPage
);

51184 if–
rc
 ) Ñc;

51185 
t›
 = 
	`gë2byãNŸZîo
(&
d©a
[
hdr
+5]);

51186 }if–
g≠
+2<=
t›
 ){

51191 
pc
, 
addr
;

51192 
addr
=
hdr
+1; (
pc
 = 
	`gë2byã
(&
d©a
[addr]))>0;áddr=pc){

51193 
size
;

51194 if–
pc
>
ußbÀSize
-4 ||Öc<
addr
+4 ){

51195  
SQLITE_CORRUPT_BKPT
;

51197 
size
 = 
	`gë2byã
(&
d©a
[
pc
+2]);

51198 if–
size
>=
nByã
 ){

51199 
x
 = 
size
 - 
nByã
;

51200 
	`ã°ˇ£
–
x
==4 );

51201 
	`ã°ˇ£
–
x
==3 );

51202 if–
x
<4 ){

51205 
	`mem˝y
(&
d©a
[
addr
], &d©a[
pc
], 2);

51206 
d©a
[
hdr
+7] = (
u8
)(
nFøg
 + 
x
);

51207 }if–
size
+
pc
 > 
ußbÀSize
 ){

51208  
SQLITE_CORRUPT_BKPT
;

51212 
	`put2byã
(&
d©a
[
pc
+2], 
x
);

51214 *
pIdx
 = 
pc
 + 
x
;

51215  
SQLITE_OK
;

51223 
	`ã°ˇ£
–
g≠
+2+
nByã
==
t›
 );

51224 if–
g≠
+2+
nByã
>
t›
 ){

51225 
rc
 = 
	`de‰agmítPage
(
pPage
);

51226 if–
rc
 ) Ñc;

51227 
t›
 = 
	`gë2byãNŸZîo
(&
d©a
[
hdr
+5]);

51228 
	`as£π
–
g≠
+
nByã
<=
t›
 );

51238 
t›
 -
nByã
;

51239 
	`put2byã
(&
d©a
[
hdr
+5], 
t›
);

51240 
	`as£π
–
t›
+
nByã
 <()
pPage
->
pBt
->
ußbÀSize
 );

51241 *
pIdx
 = 
t›
;

51242  
SQLITE_OK
;

51253 
	`‰ìS∑˚
(
MemPage
 *
pPage
, 
°¨t
, 
size
){

51254 
addr
, 
pbegö
, 
hdr
;

51255 
iLa°
;

51256 *
d©a
 = 
pPage
->
aD©a
;

51258 
	`as£π
–
pPage
->
pBt
!=0 );

51259 
	`as£π
–
	`sqlôe3PagîIswrôóbÀ
(
pPage
->
pDbPage
) );

51260 
	`as£π
–
°¨t
>=
pPage
->
hdrOff£t
+6+pPage->
chûdPåSize
 );

51261 
	`as£π
–(
°¨t
 + 
size
Ë<()
pPage
->
pBt
->
ußbÀSize
 );

51262 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pPage
->
pBt
->
muãx
) );

51263 
	`as£π
–
size
>=0 );

51265 if–
pPage
->
pBt
->
btsFœgs
 & 
BTS_SECURE_DELETE
 ){

51268 
	`mem£t
(&
d©a
[
°¨t
], 0, 
size
);

51280 
hdr
 = 
pPage
->
hdrOff£t
;

51281 
addr
 = 
hdr
 + 1;

51282 
iLa°
 = 
pPage
->
pBt
->
ußbÀSize
 - 4;

51283 
	`as£π
–
°¨t
<=
iLa°
 );

51284  (
pbegö
 = 
	`gë2byã
(&
d©a
[
addr
]))<
°¨t
 &&Öbegin>0 ){

51285 if–
pbegö
<
addr
+4 ){

51286  
SQLITE_CORRUPT_BKPT
;

51288 
addr
 = 
pbegö
;

51290 if–
pbegö
>
iLa°
 ){

51291  
SQLITE_CORRUPT_BKPT
;

51293 
	`as£π
–
pbegö
>
addr
 ||Öbegin==0 );

51294 
	`put2byã
(&
d©a
[
addr
], 
°¨t
);

51295 
	`put2byã
(&
d©a
[
°¨t
], 
pbegö
);

51296 
	`put2byã
(&
d©a
[
°¨t
+2], 
size
);

51297 
pPage
->
nFªe
 =ÖPage->nFªê+ (
u16
)
size
;

51300 
addr
 = 
hdr
 + 1;

51301  (
pbegö
 = 
	`gë2byã
(&
d©a
[
addr
]))>0 ){

51302 
≤ext
, 
psize
, 
x
;

51303 
	`as£π
–
pbegö
>
addr
 );

51304 
	`as£π
–
pbegö
 <()
pPage
->
pBt
->
ußbÀSize
-4 );

51305 
≤ext
 = 
	`gë2byã
(&
d©a
[
pbegö
]);

51306 
psize
 = 
	`gë2byã
(&
d©a
[
pbegö
+2]);

51307 if–
pbegö
 + 
psize
 + 3 >
≤ext
 &&Önext>0 ){

51308 
‰ag
 = 
≤ext
 - (
pbegö
+
psize
);

51309 if–(
‰ag
<0Ë|| (‰ag>()
d©a
[
hdr
+7]) ){

51310  
SQLITE_CORRUPT_BKPT
;

51312 
d©a
[
hdr
+7] -(
u8
)
‰ag
;

51313 
x
 = 
	`gë2byã
(&
d©a
[
≤ext
]);

51314 
	`put2byã
(&
d©a
[
pbegö
], 
x
);

51315 
x
 = 
≤ext
 + 
	`gë2byã
(&
d©a
[≤ext+2]Ë- 
pbegö
;

51316 
	`put2byã
(&
d©a
[
pbegö
+2], 
x
);

51318 
addr
 = 
pbegö
;

51323 if–
d©a
[
hdr
+1]==data[hdr+5] && data[hdr+2]==data[hdr+6] ){

51324 
t›
;

51325 
pbegö
 = 
	`gë2byã
(&
d©a
[
hdr
+1]);

51326 
	`mem˝y
(&
d©a
[
hdr
+1], &d©a[
pbegö
], 2);

51327 
t›
 = 
	`gë2byã
(&
d©a
[
hdr
+5]Ë+ gë2byã(&d©a[
pbegö
+2]);

51328 
	`put2byã
(&
d©a
[
hdr
+5], 
t›
);

51330 
	`as£π
–
	`sqlôe3PagîIswrôóbÀ
(
pPage
->
pDbPage
) );

51331  
SQLITE_OK
;

51346 
	`decodeFœgs
(
MemPage
 *
pPage
, 
ÊagByã
){

51347 
BtSh¨ed
 *
pBt
;

51349 
	`as£π
–
pPage
->
hdrOff£t
==’Page->
pgno
==1 ? 100 : 0) );

51350 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pPage
->
pBt
->
muãx
) );

51351 
pPage
->
Àaf
 = (
u8
)(
ÊagByã
>>3); 
	`as£π
–
PTF_LEAF
 == 1<<3 );

51352 
ÊagByã
 &~
PTF_LEAF
;

51353 
pPage
->
chûdPåSize
 = 4-4*pPage->
Àaf
;

51354 
pBt
 = 
pPage
->pBt;

51355 if–
ÊagByã
==(
PTF_LEAFDATA
 | 
PTF_INTKEY
) ){

51356 
pPage
->
ötKey
 = 1;

51357 
pPage
->
hasD©a
 =ÖPage->
Àaf
;

51358 
pPage
->
maxLoˇl
 = 
pBt
->
maxLóf
;

51359 
pPage
->
möLoˇl
 = 
pBt
->
möLóf
;

51360 }if–
ÊagByã
==
PTF_ZERODATA
 ){

51361 
pPage
->
ötKey
 = 0;

51362 
pPage
->
hasD©a
 = 0;

51363 
pPage
->
maxLoˇl
 = 
pBt
->maxLocal;

51364 
pPage
->
möLoˇl
 = 
pBt
->minLocal;

51366  
SQLITE_CORRUPT_BKPT
;

51368 
pPage
->
max1byãPaylﬂd
 = 
pBt
->max1bytePayload;

51369  
SQLITE_OK
;

51381 
	`båìInôPage
(
MemPage
 *
pPage
){

51383 
	`as£π
–
pPage
->
pBt
!=0 );

51384 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pPage
->
pBt
->
muãx
) );

51385 
	`as£π
–
pPage
->
pgno
==
	`sqlôe3PagîPagíumbî
’Page->
pDbPage
) );

51386 
	`as£π
–
pPage
 =
	`sqlôe3PagîGëExåa
’Page->
pDbPage
) );

51387 
	`as£π
–
pPage
->
aD©a
 =
	`sqlôe3PagîGëD©a
’Page->
pDbPage
) );

51389 if–!
pPage
->
isInô
 ){

51390 
u16
 
pc
;

51391 
u8
 
hdr
;

51392 
u8
 *
d©a
;

51393 
BtSh¨ed
 *
pBt
;

51394 
ußbÀSize
;

51395 
u16
 
˚ŒOff£t
;

51396 
nFªe
;

51397 
t›
;

51398 
iCñlFú°
;

51399 
iCñlLa°
;

51401 
pBt
 = 
pPage
->pBt;

51403 
hdr
 = 
pPage
->
hdrOff£t
;

51404 
d©a
 = 
pPage
->
aD©a
;

51405 if–
	`decodeFœgs
(
pPage
, 
d©a
[
hdr
]ËË 
SQLITE_CORRUPT_BKPT
;

51406 
	`as£π
–
pBt
->
∑geSize
>=512 &&ÖBt->pageSize<=65536 );

51407 
pPage
->
maskPage
 = (
u16
)(
pBt
->
∑geSize
 - 1);

51408 
pPage
->
nOvîÊow
 = 0;

51409 
ußbÀSize
 = 
pBt
->usableSize;

51410 
pPage
->
˚ŒOff£t
 = cñlOff£à
hdr
 + 12 - 4*pPage->
Àaf
;

51411 
pPage
->
aD©aEnd
 = &
d©a
[
ußbÀSize
];

51412 
pPage
->
aCñlIdx
 = &
d©a
[
˚ŒOff£t
];

51413 
t›
 = 
	`gë2byãNŸZîo
(&
d©a
[
hdr
+5]);

51414 
pPage
->
nCñl
 = 
	`gë2byã
(&
d©a
[
hdr
+3]);

51415 if–
pPage
->
nCñl
>
	`MX_CELL
(
pBt
) ){

51417  
SQLITE_CORRUPT_BKPT
;

51419 
	`ã°ˇ£
–
pPage
->
nCñl
==
	`MX_CELL
(
pBt
) );

51428 
iCñlFú°
 = 
˚ŒOff£t
 + 2*
pPage
->
nCñl
;

51429 
iCñlLa°
 = 
ußbÀSize
 - 4;

51430 #i‡
	`deföed
(
SQLITE_ENABLE_OVERSIZE_CELL_CHECK
)

51432 
i
;

51433 
sz
;

51435 if–!
pPage
->
Àaf
 ) 
iCñlLa°
--;

51436 
i
=0; i<
pPage
->
nCñl
; i++){

51437 
pc
 = 
	`gë2byã
(&
d©a
[
˚ŒOff£t
+
i
*2]);

51438 
	`ã°ˇ£
–
pc
==
iCñlFú°
 );

51439 
	`ã°ˇ£
–
pc
==
iCñlLa°
 );

51440 if–
pc
<
iCñlFú°
 ||Öc>
iCñlLa°
 ){

51441  
SQLITE_CORRUPT_BKPT
;

51443 
sz
 = 
	`˚ŒSizePå
(
pPage
, &
d©a
[
pc
]);

51444 
	`ã°ˇ£
–
pc
+
sz
==
ußbÀSize
 );

51445 if–
pc
+
sz
>
ußbÀSize
 ){

51446  
SQLITE_CORRUPT_BKPT
;

51449 if–!
pPage
->
Àaf
 ) 
iCñlLa°
++;

51454 
pc
 = 
	`gë2byã
(&
d©a
[
hdr
+1]);

51455 
nFªe
 = 
d©a
[
hdr
+7] + 
t›
;

51456  
pc
>0 ){

51457 
u16
 
√xt
, 
size
;

51458 if–
pc
<
iCñlFú°
 ||Öc>
iCñlLa°
 ){

51460  
SQLITE_CORRUPT_BKPT
;

51462 
√xt
 = 
	`gë2byã
(&
d©a
[
pc
]);

51463 
size
 = 
	`gë2byã
(&
d©a
[
pc
+2]);

51464 if–(
√xt
>0 &&Çext<=
pc
+
size
+3Ë||Öc+size>
ußbÀSize
 ){

51467  
SQLITE_CORRUPT_BKPT
;

51469 
nFªe
 =ÇFªê+ 
size
;

51470 
pc
 = 
√xt
;

51480 if–
nFªe
>
ußbÀSize
 ){

51481  
SQLITE_CORRUPT_BKPT
;

51483 
pPage
->
nFªe
 = (
u16
)“Fªê- 
iCñlFú°
);

51484 
pPage
->
isInô
 = 1;

51486  
SQLITE_OK
;

51493 
	`zîoPage
(
MemPage
 *
pPage
, 
Êags
){

51494 *
d©a
 = 
pPage
->
aD©a
;

51495 
BtSh¨ed
 *
pBt
 = 
pPage
->pBt;

51496 
u8
 
hdr
 = 
pPage
->
hdrOff£t
;

51497 
u16
 
fú°
;

51499 
	`as£π
–
	`sqlôe3PagîPagíumbî
(
pPage
->
pDbPage
)=ıPage->
pgno
 );

51500 
	`as£π
–
	`sqlôe3PagîGëExåa
(
pPage
->
pDbPage
) == (*)pPage );

51501 
	`as£π
–
	`sqlôe3PagîGëD©a
(
pPage
->
pDbPage
Ë=
d©a
 );

51502 
	`as£π
–
	`sqlôe3PagîIswrôóbÀ
(
pPage
->
pDbPage
) );

51503 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pBt
->
muãx
) );

51504 if–
pBt
->
btsFœgs
 & 
BTS_SECURE_DELETE
 ){

51505 
	`mem£t
(&
d©a
[
hdr
], 0, 
pBt
->
ußbÀSize
 - hdr);

51507 
d©a
[
hdr
] = ()
Êags
;

51508 
fú°
 = 
hdr
 + 8 + 4*((
Êags
&
PTF_LEAF
)==0 ?1:0);

51509 
	`mem£t
(&
d©a
[
hdr
+1], 0, 4);

51510 
d©a
[
hdr
+7] = 0;

51511 
	`put2byã
(&
d©a
[
hdr
+5], 
pBt
->
ußbÀSize
);

51512 
pPage
->
nFªe
 = (
u16
)(
pBt
->
ußbÀSize
 - 
fú°
);

51513 
	`decodeFœgs
(
pPage
, 
Êags
);

51514 
pPage
->
hdrOff£t
 = 
hdr
;

51515 
pPage
->
˚ŒOff£t
 = 
fú°
;

51516 
pPage
->
aD©aEnd
 = &
d©a
[
pBt
->
ußbÀSize
];

51517 
pPage
->
aCñlIdx
 = &
d©a
[
fú°
];

51518 
pPage
->
nOvîÊow
 = 0;

51519 
	`as£π
–
pBt
->
∑geSize
>=512 &&ÖBt->pageSize<=65536 );

51520 
pPage
->
maskPage
 = (
u16
)(
pBt
->
∑geSize
 - 1);

51521 
pPage
->
nCñl
 = 0;

51522 
pPage
->
isInô
 = 1;

51530 
MemPage
 *
	`båìPageFromDbPage
(
DbPage
 *
pDbPage
, 
Pgno
 
pgno
, 
BtSh¨ed
 *
pBt
){

51531 
MemPage
 *
pPage
 = (MemPage*)
	`sqlôe3PagîGëExåa
(
pDbPage
);

51532 
pPage
->
aD©a
 = 
	`sqlôe3PagîGëD©a
(
pDbPage
);

51533 
pPage
->
pDbPage
 =ÖDbPage;

51534 
pPage
->
pBt
 =ÖBt;

51535 
pPage
->
pgno
 =Ögno;

51536 
pPage
->
hdrOff£t
 =ÖPage->
pgno
==1 ? 100 : 0;

51537  
pPage
;

51551 
	`båìGëPage
(

51552 
BtSh¨ed
 *
pBt
,

51553 
Pgno
 
pgno
,

51554 
MemPage
 **
µPage
,

51555 
Êags


51557 
rc
;

51558 
DbPage
 *
pDbPage
;

51560 
	`as£π
–
Êags
==0 || fœgs==
PAGER_GET_NOCONTENT
 || fœgs==
PAGER_GET_READONLY
 );

51561 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pBt
->
muãx
) );

51562 
rc
 = 
	`sqlôe3PagîAcquúe
(
pBt
->
pPagî
, 
pgno
, (
DbPage
**)&
pDbPage
, 
Êags
);

51563 if–
rc
 ) Ñc;

51564 *
µPage
 = 
	`båìPageFromDbPage
(
pDbPage
, 
pgno
, 
pBt
);

51565  
SQLITE_OK
;

51573 
MemPage
 *
	`båìPageLookup
(
BtSh¨ed
 *
pBt
, 
Pgno
 
pgno
){

51574 
DbPage
 *
pDbPage
;

51575 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pBt
->
muãx
) );

51576 
pDbPage
 = 
	`sqlôe3PagîLookup
(
pBt
->
pPagî
, 
pgno
);

51577 if–
pDbPage
 ){

51578  
	`båìPageFromDbPage
(
pDbPage
, 
pgno
, 
pBt
);

51587 
Pgno
 
	`båìPagecou¡
(
BtSh¨ed
 *
pBt
){

51588  
pBt
->
nPage
;

51590 
SQLITE_PRIVATE
 
u32
 
	`sqlôe3BåìLa°Page
(
Båì
 *
p
){

51591 
	`as£π
–
	`sqlôe3BåìHﬁdsMuãx
(
p
) );

51592 
	`as£π
–((
p
->
pBt
->
nPage
)&0x8000000)==0 );

51593  ()
	`båìPagecou¡
(
p
->
pBt
);

51604 
	`gëAndInôPage
(

51605 
BtSh¨ed
 *
pBt
,

51606 
Pgno
 
pgno
,

51607 
MemPage
 **
µPage
,

51608 
bRód⁄ly


51610 
rc
;

51611 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pBt
->
muãx
) );

51612 
	`as£π
–
bRód⁄ly
==
PAGER_GET_READONLY
 || bReadonly==0 );

51614 if–
pgno
>
	`båìPagecou¡
(
pBt
) ){

51615 
rc
 = 
SQLITE_CORRUPT_BKPT
;

51617 
rc
 = 
	`båìGëPage
(
pBt
, 
pgno
, 
µPage
, 
bRód⁄ly
);

51618 if–
rc
==
SQLITE_OK
 ){

51619 
rc
 = 
	`båìInôPage
(*
µPage
);

51620 if–
rc
!=
SQLITE_OK
 ){

51621 
	`ªÀa£Page
(*
µPage
);

51626 
	`ã°ˇ£
–
pgno
==0 );

51627 
	`as£π
–
pgno
!=0 || 
rc
==
SQLITE_CORRUPT
 );

51628  
rc
;

51635 
	`ªÀa£Page
(
MemPage
 *
pPage
){

51636 if–
pPage
 ){

51637 
	`as£π
–
pPage
->
aD©a
 );

51638 
	`as£π
–
pPage
->
pBt
 );

51639 
	`as£π
–
	`sqlôe3PagîGëExåa
(
pPage
->
pDbPage
) == (*)pPage );

51640 
	`as£π
–
	`sqlôe3PagîGëD©a
(
pPage
->
pDbPage
)=ıPage->
aD©a
 );

51641 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pPage
->
pBt
->
muãx
) );

51642 
	`sqlôe3PagîUƒef
(
pPage
->
pDbPage
);

51654 
	`∑geReöô
(
DbPage
 *
pD©a
){

51655 
MemPage
 *
pPage
;

51656 
pPage
 = (
MemPage
 *)
	`sqlôe3PagîGëExåa
(
pD©a
);

51657 
	`as£π
–
	`sqlôe3PagîPageRefcou¡
(
pD©a
)>0 );

51658 if–
pPage
->
isInô
 ){

51659 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pPage
->
pBt
->
muãx
) );

51660 
pPage
->
isInô
 = 0;

51661 if–
	`sqlôe3PagîPageRefcou¡
(
pD©a
)>1 ){

51668 
	`båìInôPage
(
pPage
);

51676 
	`båìInvokeBusyH™dÀr
(*
pArg
){

51677 
BtSh¨ed
 *
pBt
 = (BtSh¨ed*)
pArg
;

51678 
	`as£π
–
pBt
->
db
 );

51679 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pBt
->
db
->
muãx
) );

51680  
	`sqlôe3InvokeBusyH™dÀr
(&
pBt
->
db
->
busyH™dÀr
);

51704 
SQLITE_PRIVATE
 
	`sqlôe3BåìO≥n
(

51705 
sqlôe3_vfs
 *
pVfs
,

51706 c⁄° *
zFûíame
,

51707 
sqlôe3
 *
db
,

51708 
Båì
 **
µBåì
,

51709 
Êags
,

51710 
vfsFœgs


51712 
BtSh¨ed
 *
pBt
 = 0;

51713 
Båì
 *
p
;

51714 
sqlôe3_muãx
 *
muãxO≥n
 = 0;

51715 
rc
 = 
SQLITE_OK
;

51716 
u8
 
nRe£rve
;

51717 
zDbHódî
[100];

51720 c⁄° 
isTempDb
 = 
zFûíame
==0 || zFilename[0]==0;

51725 #ifde‡
SQLITE_OMIT_MEMORYDB


51726 c⁄° 
isMemdb
 = 0;

51728 c⁄° 
isMemdb
 = (
zFûíame
 && 
	`°rcmp
(zFilename, ":memory:")==0)

51729 || (
isTempDb
 && 
	`sqlôe3TempInMem‹y
(
db
))

51730 || (
vfsFœgs
 & 
SQLITE_OPEN_MEMORY
)!=0;

51733 
	`as£π
–
db
!=0 );

51734 
	`as£π
–
pVfs
!=0 );

51735 
	`as£π
–
	`sqlôe3_muãx_hñd
(
db
->
muãx
) );

51736 
	`as£π
–(
Êags
&0xff)==flags );

51739 
	`as£π
–(
Êags
 & 
BTREE_UNORDERED
)==0 || (Êag†& 
BTREE_SINGLE
)!=0 );

51742 
	`as£π
–(
Êags
 & 
BTREE_SINGLE
)==0 || 
isTempDb
 );

51744 if–
isMemdb
 ){

51745 
Êags
 |
BTREE_MEMORY
;

51747 if–(
vfsFœgs
 & 
SQLITE_OPEN_MAIN_DB
)!=0 && (
isMemdb
 || 
isTempDb
) ){

51748 
vfsFœgs
 = (vfsFœg†& ~
SQLITE_OPEN_MAIN_DB
Ë| 
SQLITE_OPEN_TEMP_DB
;

51750 
p
 = 
	`sqlôe3MÆlocZîo
((
Båì
));

51751 if–!
p
 ){

51752  
SQLITE_NOMEM
;

51754 
p
->
öTøns
 = 
TRANS_NONE
;

51755 
p
->
db
 = db;

51756 #i‚de‡
SQLITE_OMIT_SHARED_CACHE


51757 
p
->
lock
.
pBåì
 =Ö;

51758 
p
->
lock
.
iTabÀ
 = 1;

51761 #i‡!
	`deföed
(
SQLITE_OMIT_SHARED_CACHE
Ë&& !deföed(
SQLITE_OMIT_DISKIO
)

51766 if–
isTempDb
==0 && (
isMemdb
==0 || (
vfsFœgs
&
SQLITE_OPEN_URI
)!=0) ){

51767 if–
vfsFœgs
 & 
SQLITE_OPEN_SHAREDCACHE
 ){

51768 
nFuŒP©h«me
 = 
pVfs
->
mxP©h«me
+1;

51769 *
zFuŒP©h«me
 = 
	`sqlôe3MÆloc
(
nFuŒP©h«me
);

51770 
	`MUTEX_LOGIC
–
sqlôe3_muãx
 *
muãxSh¨ed
; )

51771 
p
->
sh¨abÀ
 = 1;

51772 if–!
zFuŒP©h«me
 ){

51773 
	`sqlôe3_‰ì
(
p
);

51774  
SQLITE_NOMEM
;

51776 if–
isMemdb
 ){

51777 
	`mem˝y
(
zFuŒP©h«me
, 
zFûíame
, 
	`sqlôe3SåÀn30
(zFilename)+1);

51779 
rc
 = 
	`sqlôe3OsFuŒP©h«me
(
pVfs
, 
zFûíame
,

51780 
nFuŒP©h«me
, 
zFuŒP©h«me
);

51781 if–
rc
 ){

51782 
	`sqlôe3_‰ì
(
zFuŒP©h«me
);

51783 
	`sqlôe3_‰ì
(
p
);

51784  
rc
;

51787 #i‡
SQLITE_THREADSAFE


51788 
muãxO≥n
 = 
	`sqlôe3MuãxAŒoc
(
SQLITE_MUTEX_STATIC_OPEN
);

51789 
	`sqlôe3_muãx_íãr
(
muãxO≥n
);

51790 
muãxSh¨ed
 = 
	`sqlôe3MuãxAŒoc
(
SQLITE_MUTEX_STATIC_MASTER
);

51791 
	`sqlôe3_muãx_íãr
(
muãxSh¨ed
);

51793 
pBt
=
	`GLOBAL
(
BtSh¨ed
*,
sqlôe3Sh¨edCacheLi°
);ÖBt;ÖBtıBt->
pNext
){

51794 
	`as£π
–
pBt
->
nRef
>0 );

51795 if–0==
	`°rcmp
(
zFuŒP©h«me
, 
	`sqlôe3PagîFûíame
(
pBt
->
pPagî
, 0))

51796 && 
	`sqlôe3PagîVfs
(
pBt
->
pPagî
)==
pVfs
 ){

51797 
iDb
;

51798 
iDb
=
db
->
nDb
-1; iDb>=0; iDb--){

51799 
Båì
 *
pExi°ög
 = 
db
->
aDb
[
iDb
].
pBt
;

51800 if–
pExi°ög
 &&ÖExi°ög->
pBt
==pBt ){

51801 
	`sqlôe3_muãx_Àave
(
muãxSh¨ed
);

51802 
	`sqlôe3_muãx_Àave
(
muãxO≥n
);

51803 
	`sqlôe3_‰ì
(
zFuŒP©h«me
);

51804 
	`sqlôe3_‰ì
(
p
);

51805  
SQLITE_CONSTRAINT
;

51808 
p
->
pBt
 =ÖBt;

51809 
pBt
->
nRef
++;

51813 
	`sqlôe3_muãx_Àave
(
muãxSh¨ed
);

51814 
	`sqlôe3_‰ì
(
zFuŒP©h«me
);

51816 #ifde‡
SQLITE_DEBUG


51823 
p
->
sh¨abÀ
 = 1;

51828 if–
pBt
==0 ){

51834 
	`as£π
–(
i64
)==8 || (i64)==4 );

51835 
	`as£π
–(
u64
)==8 || (u64)==4 );

51836 
	`as£π
–(
u32
)==4 );

51837 
	`as£π
–(
u16
)==2 );

51838 
	`as£π
–(
Pgno
)==4 );

51840 
pBt
 = 
	`sqlôe3MÆlocZîo
( (*pBt) );

51841 if–
pBt
==0 ){

51842 
rc
 = 
SQLITE_NOMEM
;

51843 
båì_›í_out
;

51845 
rc
 = 
	`sqlôe3PagîO≥n
(
pVfs
, &
pBt
->
pPagî
, 
zFûíame
,

51846 
EXTRA_SIZE
, 
Êags
, 
vfsFœgs
, 
∑geReöô
);

51847 if–
rc
==
SQLITE_OK
 ){

51848 
	`sqlôe3PagîSëMm≠Limô
(
pBt
->
pPagî
, 
db
->
szMm≠
);

51849 
rc
 = 
	`sqlôe3PagîRódFûehódî
(
pBt
->
pPagî
,(
zDbHódî
),zDbHeader);

51851 if–
rc
!=
SQLITE_OK
 ){

51852 
båì_›í_out
;

51854 
pBt
->
›íFœgs
 = (
u8
)
Êags
;

51855 
pBt
->
db
 = db;

51856 
	`sqlôe3PagîSëBusyh™dÀr
(
pBt
->
pPagî
, 
båìInvokeBusyH™dÀr
,ÖBt);

51857 
p
->
pBt
 =ÖBt;

51859 
pBt
->
pCurs‹
 = 0;

51860 
pBt
->
pPage1
 = 0;

51861 if–
	`sqlôe3PagîI§ód⁄ly
(
pBt
->
pPagî
ËËpBt->
btsFœgs
 |
BTS_READ_ONLY
;

51862 #ifde‡
SQLITE_SECURE_DELETE


51863 
pBt
->
btsFœgs
 |
BTS_SECURE_DELETE
;

51865 
pBt
->
∑geSize
 = (
zDbHódî
[16]<<8) | (zDbHeader[17]<<16);

51866 if–
pBt
->
∑geSize
<512 ||ÖBt->∑geSize>
SQLITE_MAX_PAGE_SIZE


51867 || ((
pBt
->
∑geSize
-1)&pBt->pageSize)!=0 ){

51868 
pBt
->
∑geSize
 = 0;

51869 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


51876 if–
zFûíame
 && !
isMemdb
 ){

51877 
pBt
->
autoVacuum
 = (
SQLITE_DEFAULT_AUTOVACUUM
 ? 1 : 0);

51878 
pBt
->
ö¸Vacuum
 = (
SQLITE_DEFAULT_AUTOVACUUM
==2 ? 1 : 0);

51881 
nRe£rve
 = 0;

51883 
nRe£rve
 = 
zDbHódî
[20];

51884 
pBt
->
btsFœgs
 |
BTS_PAGESIZE_FIXED
;

51885 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


51886 
pBt
->
autoVacuum
 = (
	`gë4byã
(&
zDbHódî
[36 + 4*4])?1:0);

51887 
pBt
->
ö¸Vacuum
 = (
	`gë4byã
(&
zDbHódî
[36 + 7*4])?1:0);

51890 
rc
 = 
	`sqlôe3PagîSëPagesize
(
pBt
->
pPagî
, &pBt->
∑geSize
, 
nRe£rve
);

51891 if–
rc
 ) 
båì_›í_out
;

51892 
pBt
->
ußbÀSize
 =ÖBt->
∑geSize
 - 
nRe£rve
;

51893 
	`as£π
–(
pBt
->
∑geSize
 & 7)==0 );

51895 #i‡!
	`deföed
(
SQLITE_OMIT_SHARED_CACHE
Ë&& !deföed(
SQLITE_OMIT_DISKIO
)

51898 if–
p
->
sh¨abÀ
 ){

51899 
	`MUTEX_LOGIC
–
sqlôe3_muãx
 *
muãxSh¨ed
; )

51900 
pBt
->
nRef
 = 1;

51901 
	`MUTEX_LOGIC
–
muãxSh¨ed
 = 
	`sqlôe3MuãxAŒoc
(
SQLITE_MUTEX_STATIC_MASTER
);)

51902 if–
SQLITE_THREADSAFE
 && 
sqlôe3GlobÆC⁄fig
.
bC‹eMuãx
 ){

51903 
pBt
->
muãx
 = 
	`sqlôe3MuãxAŒoc
(
SQLITE_MUTEX_FAST
);

51904 if–
pBt
->
muãx
==0 ){

51905 
rc
 = 
SQLITE_NOMEM
;

51906 
db
->
mÆlocFaûed
 = 0;

51907 
båì_›í_out
;

51910 
	`sqlôe3_muãx_íãr
(
muãxSh¨ed
);

51911 
pBt
->
pNext
 = 
	`GLOBAL
(
BtSh¨ed
*,
sqlôe3Sh¨edCacheLi°
);

51912 
	`GLOBAL
(
BtSh¨ed
*,
sqlôe3Sh¨edCacheLi°
Ë
pBt
;

51913 
	`sqlôe3_muãx_Àave
(
muãxSh¨ed
);

51918 #i‡!
	`deföed
(
SQLITE_OMIT_SHARED_CACHE
Ë&& !deföed(
SQLITE_OMIT_DISKIO
)

51923 if–
p
->
sh¨abÀ
 ){

51924 
i
;

51925 
Båì
 *
pSib
;

51926 
i
=0; i<
db
->
nDb
; i++){

51927 if–(
pSib
 = 
db
->
aDb
[
i
].
pBt
)!=0 &&ÖSib->
sh¨abÀ
 ){

51928  
pSib
->
pPªv
 ){ÖSib =ÖSib->pPrev; }

51929 if–
p
->
pBt
<
pSib
->pBt ){

51930 
p
->
pNext
 = 
pSib
;

51931 
p
->
pPªv
 = 0;

51932 
pSib
->
pPªv
 = 
p
;

51934  
pSib
->
pNext
 &&ÖSib->pNext->
pBt
<
p
->pBt ){

51935 
pSib
 =ÖSib->
pNext
;

51937 
p
->
pNext
 = 
pSib
->pNext;

51938 
p
->
pPªv
 = 
pSib
;

51939 if–
p
->
pNext
 ){

51940 
p
->
pNext
->
pPªv
 =Ö;

51942 
pSib
->
pNext
 = 
p
;

51949 *
µBåì
 = 
p
;

51951 
båì_›í_out
:

51952 if–
rc
!=
SQLITE_OK
 ){

51953 if–
pBt
 &&ÖBt->
pPagî
 ){

51954 
	`sqlôe3PagîClo£
(
pBt
->
pPagî
);

51956 
	`sqlôe3_‰ì
(
pBt
);

51957 
	`sqlôe3_‰ì
(
p
);

51958 *
µBåì
 = 0;

51964 if–
	`sqlôe3BåìSchema
(
p
, 0, 0)==0 ){

51965 
	`sqlôe3PagîSëCachesize
(
p
->
pBt
->
pPagî
, 
SQLITE_DEFAULT_CACHE_SIZE
);

51968 if–
muãxO≥n
 ){

51969 
	`as£π
–
	`sqlôe3_muãx_hñd
(
muãxO≥n
) );

51970 
	`sqlôe3_muãx_Àave
(
muãxO≥n
);

51972  
rc
;

51981 
	`ªmoveFromSh¨ögLi°
(
BtSh¨ed
 *
pBt
){

51982 #i‚de‡
SQLITE_OMIT_SHARED_CACHE


51983 
	`MUTEX_LOGIC
–
sqlôe3_muãx
 *
pMa°î
; )

51984 
BtSh¨ed
 *
pLi°
;

51985 
ªmoved
 = 0;

51987 
	`as£π
–
	`sqlôe3_muãx_nŸhñd
(
pBt
->
muãx
) );

51988 
	`MUTEX_LOGIC
–
pMa°î
 = 
	`sqlôe3MuãxAŒoc
(
SQLITE_MUTEX_STATIC_MASTER
); )

51989 
	`sqlôe3_muãx_íãr
(
pMa°î
);

51990 
pBt
->
nRef
--;

51991 if–
pBt
->
nRef
<=0 ){

51992 if–
	`GLOBAL
(
BtSh¨ed
*,
sqlôe3Sh¨edCacheLi°
)==
pBt
 ){

51993 
	`GLOBAL
(
BtSh¨ed
*,
sqlôe3Sh¨edCacheLi°
Ë
pBt
->
pNext
;

51995 
pLi°
 = 
	`GLOBAL
(
BtSh¨ed
*,
sqlôe3Sh¨edCacheLi°
);

51996  
	`ALWAYS
(
pLi°
Ë&&ÖLi°->
pNext
!=
pBt
 ){

51997 
pLi°
ıLi°->
pNext
;

51999 if–
	`ALWAYS
(
pLi°
) ){

52000 
pLi°
->
pNext
 = 
pBt
->pNext;

52003 if–
SQLITE_THREADSAFE
 ){

52004 
	`sqlôe3_muãx_‰ì
(
pBt
->
muãx
);

52006 
ªmoved
 = 1;

52008 
	`sqlôe3_muãx_Àave
(
pMa°î
);

52009  
ªmoved
;

52019 
	`ÆloˇãTempS∑˚
(
BtSh¨ed
 *
pBt
){

52020 if–!
pBt
->
pTmpS∑˚
 ){

52021 
pBt
->
pTmpS∑˚
 = 
	`sqlôe3PageMÆloc
–pBt->
∑geSize
 );

52033 if–
pBt
->
pTmpS∑˚
 ) 
	`mem£t
(pBt->pTmpSpace, 0, 4);

52040 
	`‰ìTempS∑˚
(
BtSh¨ed
 *
pBt
){

52041 
	`sqlôe3PageFªe
–
pBt
->
pTmpS∑˚
);

52042 
pBt
->
pTmpS∑˚
 = 0;

52048 
SQLITE_PRIVATE
 
	`sqlôe3BåìClo£
(
Båì
 *
p
){

52049 
BtSh¨ed
 *
pBt
 = 
p
->pBt;

52050 
BtCurs‹
 *
pCur
;

52053 
	`as£π
–
	`sqlôe3_muãx_hñd
(
p
->
db
->
muãx
) );

52054 
	`sqlôe3BåìE¡î
(
p
);

52055 
pCur
 = 
pBt
->
pCurs‹
;

52056  
pCur
 ){

52057 
BtCurs‹
 *
pTmp
 = 
pCur
;

52058 
pCur
 =ÖCur->
pNext
;

52059 if–
pTmp
->
pBåì
==
p
 ){

52060 
	`sqlôe3BåìClo£Curs‹
(
pTmp
);

52068 
	`sqlôe3BåìRﬁlback
(
p
, 
SQLITE_OK
);

52069 
	`sqlôe3BåìLóve
(
p
);

52075 
	`as£π
–
p
->
w™tToLock
==0 &&Ö->
locked
==0 );

52076 if–!
p
->
sh¨abÀ
 || 
	`ªmoveFromSh¨ögLi°
(
pBt
) ){

52082 
	`as£π
–!
pBt
->
pCurs‹
 );

52083 
	`sqlôe3PagîClo£
(
pBt
->
pPagî
);

52084 if–
pBt
->
xFªeSchema
 &&ÖBt->
pSchema
 ){

52085 
pBt
->
	`xFªeSchema
’Bt->
pSchema
);

52087 
	`sqlôe3DbFªe
(0, 
pBt
->
pSchema
);

52088 
	`‰ìTempS∑˚
(
pBt
);

52089 
	`sqlôe3_‰ì
(
pBt
);

52092 #i‚de‡
SQLITE_OMIT_SHARED_CACHE


52093 
	`as£π
–
p
->
w™tToLock
==0 );

52094 
	`as£π
–
p
->
locked
==0 );

52095 if–
p
->
pPªv
 )Ö->pPªv->
pNext
 =Ö->pNext;

52096 if–
p
->
pNext
 )Ö->pNext->
pPªv
 =Ö->pPrev;

52099 
	`sqlôe3_‰ì
(
p
);

52100  
SQLITE_OK
;

52118 
SQLITE_PRIVATE
 
	`sqlôe3BåìSëCacheSize
(
Båì
 *
p
, 
mxPage
){

52119 
BtSh¨ed
 *
pBt
 = 
p
->pBt;

52120 
	`as£π
–
	`sqlôe3_muãx_hñd
(
p
->
db
->
muãx
) );

52121 
	`sqlôe3BåìE¡î
(
p
);

52122 
	`sqlôe3PagîSëCachesize
(
pBt
->
pPagî
, 
mxPage
);

52123 
	`sqlôe3BåìLóve
(
p
);

52124  
SQLITE_OK
;

52131 
SQLITE_PRIVATE
 
	`sqlôe3BåìSëMm≠Limô
(
Båì
 *
p
, 
sqlôe3_öt64
 
szMm≠
){

52132 
BtSh¨ed
 *
pBt
 = 
p
->pBt;

52133 
	`as£π
–
	`sqlôe3_muãx_hñd
(
p
->
db
->
muãx
) );

52134 
	`sqlôe3BåìE¡î
(
p
);

52135 
	`sqlôe3PagîSëMm≠Limô
(
pBt
->
pPagî
, 
szMm≠
);

52136 
	`sqlôe3BåìLóve
(
p
);

52137  
SQLITE_OK
;

52148 #i‚de‡
SQLITE_OMIT_PAGER_PRAGMAS


52149 
SQLITE_PRIVATE
 
	`sqlôe3BåìSëPagîFœgs
(

52150 
Båì
 *
p
,

52151 
pgFœgs


52153 
BtSh¨ed
 *
pBt
 = 
p
->pBt;

52154 
	`as£π
–
	`sqlôe3_muãx_hñd
(
p
->
db
->
muãx
) );

52155 
	`sqlôe3BåìE¡î
(
p
);

52156 
	`sqlôe3PagîSëFœgs
(
pBt
->
pPagî
, 
pgFœgs
);

52157 
	`sqlôe3BåìLóve
(
p
);

52158  
SQLITE_OK
;

52166 
SQLITE_PRIVATE
 
	`sqlôe3BåìSyncDißbÀd
(
Båì
 *
p
){

52167 
BtSh¨ed
 *
pBt
 = 
p
->pBt;

52168 
rc
;

52169 
	`as£π
–
	`sqlôe3_muãx_hñd
(
p
->
db
->
muãx
) );

52170 
	`sqlôe3BåìE¡î
(
p
);

52171 
	`as£π
–
pBt
 &&ÖBt->
pPagî
 );

52172 
rc
 = 
	`sqlôe3PagîNosync
(
pBt
->
pPagî
);

52173 
	`sqlôe3BåìLóve
(
p
);

52174  
rc
;

52197 
SQLITE_PRIVATE
 
	`sqlôe3BåìSëPageSize
(
Båì
 *
p
, 
∑geSize
, 
nRe£rve
, 
iFix
){

52198 
rc
 = 
SQLITE_OK
;

52199 
BtSh¨ed
 *
pBt
 = 
p
->pBt;

52200 
	`as£π
–
nRe£rve
>=-1 &&ÇReserve<=255 );

52201 
	`sqlôe3BåìE¡î
(
p
);

52202 if–
pBt
->
btsFœgs
 & 
BTS_PAGESIZE_FIXED
 ){

52203 
	`sqlôe3BåìLóve
(
p
);

52204  
SQLITE_READONLY
;

52206 if–
nRe£rve
<0 ){

52207 
nRe£rve
 = 
pBt
->
∑geSize
 -ÖBt->
ußbÀSize
;

52209 
	`as£π
–
nRe£rve
>=0 &&ÇReserve<=255 );

52210 if–
∑geSize
>=512 &&ÖageSize<=
SQLITE_MAX_PAGE_SIZE
 &&

52211 ((
∑geSize
-1)&pageSize)==0 ){

52212 
	`as£π
–(
∑geSize
 & 7)==0 );

52213 
	`as£π
–!
pBt
->
pPage1
 && !pBt->
pCurs‹
 );

52214 
pBt
->
∑geSize
 = (
u32
)pageSize;

52215 
	`‰ìTempS∑˚
(
pBt
);

52217 
rc
 = 
	`sqlôe3PagîSëPagesize
(
pBt
->
pPagî
, &pBt->
∑geSize
, 
nRe£rve
);

52218 
pBt
->
ußbÀSize
 =ÖBt->
∑geSize
 - (
u16
)
nRe£rve
;

52219 if–
iFix
 ) 
pBt
->
btsFœgs
 |
BTS_PAGESIZE_FIXED
;

52220 
	`sqlôe3BåìLóve
(
p
);

52221  
rc
;

52227 
SQLITE_PRIVATE
 
	`sqlôe3BåìGëPageSize
(
Båì
 *
p
){

52228  
p
->
pBt
->
∑geSize
;

52231 #i‡
	`deföed
(
SQLITE_HAS_CODEC
Ë|| deföed(
SQLITE_DEBUG
)

52243 
SQLITE_PRIVATE
 
	`sqlôe3BåìGëRe£rveNoMuãx
(
Båì
 *
p
){

52244 
	`as£π
–
	`sqlôe3_muãx_hñd
(
p
->
pBt
->
muãx
) );

52245  
p
->
pBt
->
∑geSize
 -Ö->pBt->
ußbÀSize
;

52249 #i‡!
	`deföed
(
SQLITE_OMIT_PAGER_PRAGMAS
Ë|| !deföed(
SQLITE_OMIT_VACUUM
)

52255 
SQLITE_PRIVATE
 
	`sqlôe3BåìGëRe£rve
(
Båì
 *
p
){

52256 
n
;

52257 
	`sqlôe3BåìE¡î
(
p
);

52258 
n
 = 
p
->
pBt
->
∑geSize
 -Ö->pBt->
ußbÀSize
;

52259 
	`sqlôe3BåìLóve
(
p
);

52260  
n
;

52268 
SQLITE_PRIVATE
 
	`sqlôe3BåìMaxPageCou¡
(
Båì
 *
p
, 
mxPage
){

52269 
n
;

52270 
	`sqlôe3BåìE¡î
(
p
);

52271 
n
 = 
	`sqlôe3PagîMaxPageCou¡
(
p
->
pBt
->
pPagî
, 
mxPage
);

52272 
	`sqlôe3BåìLóve
(
p
);

52273  
n
;

52281 
SQLITE_PRIVATE
 
	`sqlôe3BåìSecuªDñëe
(
Båì
 *
p
, 
√wFœg
){

52282 
b
;

52283 if–
p
==0 )  0;

52284 
	`sqlôe3BåìE¡î
(
p
);

52285 if–
√wFœg
>=0 ){

52286 
p
->
pBt
->
btsFœgs
 &~
BTS_SECURE_DELETE
;

52287 if–
√wFœg
 ) 
p
->
pBt
->
btsFœgs
 |
BTS_SECURE_DELETE
;

52289 
b
 = (
p
->
pBt
->
btsFœgs
 & 
BTS_SECURE_DELETE
)!=0;

52290 
	`sqlôe3BåìLóve
(
p
);

52291  
b
;

52301 
SQLITE_PRIVATE
 
	`sqlôe3BåìSëAutoVacuum
(
Båì
 *
p
, 
autoVacuum
){

52302 #ifde‡
SQLITE_OMIT_AUTOVACUUM


52303  
SQLITE_READONLY
;

52305 
BtSh¨ed
 *
pBt
 = 
p
->pBt;

52306 
rc
 = 
SQLITE_OK
;

52307 
u8
 
av
 = (u8)
autoVacuum
;

52309 
	`sqlôe3BåìE¡î
(
p
);

52310 if–(
pBt
->
btsFœgs
 & 
BTS_PAGESIZE_FIXED
)!=0 && (
av
 ?1:0)!ıBt->
autoVacuum
 ){

52311 
rc
 = 
SQLITE_READONLY
;

52313 
pBt
->
autoVacuum
 = 
av
 ?1:0;

52314 
pBt
->
ö¸Vacuum
 = 
av
==2 ?1:0;

52316 
	`sqlôe3BåìLóve
(
p
);

52317  
rc
;

52325 
SQLITE_PRIVATE
 
	`sqlôe3BåìGëAutoVacuum
(
Båì
 *
p
){

52326 #ifde‡
SQLITE_OMIT_AUTOVACUUM


52327  
BTREE_AUTOVACUUM_NONE
;

52329 
rc
;

52330 
	`sqlôe3BåìE¡î
(
p
);

52331 
rc
 = (

52332 (!
p
->
pBt
->
autoVacuum
)?
BTREE_AUTOVACUUM_NONE
:

52333 (!
p
->
pBt
->
ö¸Vacuum
)?
BTREE_AUTOVACUUM_FULL
:

52334 
BTREE_AUTOVACUUM_INCR


52336 
	`sqlôe3BåìLóve
(
p
);

52337  
rc
;

52351 
	`lockBåì
(
BtSh¨ed
 *
pBt
){

52352 
rc
;

52353 
MemPage
 *
pPage1
;

52354 
nPage
;

52355 
nPageFûe
 = 0;

52356 
nPageHódî
;

52358 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pBt
->
muãx
) );

52359 
	`as£π
–
pBt
->
pPage1
==0 );

52360 
rc
 = 
	`sqlôe3PagîSh¨edLock
(
pBt
->
pPagî
);

52361 if–
rc
!=
SQLITE_OK
 ) Ñc;

52362 
rc
 = 
	`båìGëPage
(
pBt
, 1, &
pPage1
, 0);

52363 if–
rc
!=
SQLITE_OK
 ) Ñc;

52368 
nPage
 = 
nPageHódî
 = 
	`gë4byã
(28+(
u8
*)
pPage1
->
aD©a
);

52369 
	`sqlôe3PagîPagecou¡
(
pBt
->
pPagî
, &
nPageFûe
);

52370 if–
nPage
==0 || 
	`memcmp
(24+(
u8
*)
pPage1
->
aD©a
, 92+(u8*)pPage1->aData,4)!=0 ){

52371 
nPage
 = 
nPageFûe
;

52373 if–
nPage
>0 ){

52374 
u32
 
∑geSize
;

52375 
u32
 
ußbÀSize
;

52376 
u8
 *
∑ge1
 = 
pPage1
->
aD©a
;

52377 
rc
 = 
SQLITE_NOTADB
;

52378 if–
	`memcmp
(
∑ge1
, 
zMagicHódî
, 16)!=0 ){

52379 
∑ge1_öô_Áûed
;

52382 #ifde‡
SQLITE_OMIT_WAL


52383 if–
∑ge1
[18]>1 ){

52384 
pBt
->
btsFœgs
 |
BTS_READ_ONLY
;

52386 if–
∑ge1
[19]>1 ){

52387 
∑ge1_öô_Áûed
;

52390 if–
∑ge1
[18]>2 ){

52391 
pBt
->
btsFœgs
 |
BTS_READ_ONLY
;

52393 if–
∑ge1
[19]>2 ){

52394 
∑ge1_öô_Áûed
;

52405 if–
∑ge1
[19]==2 && (
pBt
->
btsFœgs
 & 
BTS_NO_WAL
)==0 ){

52406 
isO≥n
 = 0;

52407 
rc
 = 
	`sqlôe3PagîO≥nWÆ
(
pBt
->
pPagî
, &
isO≥n
);

52408 if–
rc
!=
SQLITE_OK
 ){

52409 
∑ge1_öô_Áûed
;

52410 }if–
isO≥n
==0 ){

52411 
	`ªÀa£Page
(
pPage1
);

52412  
SQLITE_OK
;

52414 
rc
 = 
SQLITE_NOTADB
;

52423 if–
	`memcmp
(&
∑ge1
[21], "\100\040\040",3)!=0 ){

52424 
∑ge1_öô_Áûed
;

52426 
∑geSize
 = (
∑ge1
[16]<<8) | (page1[17]<<16);

52427 if–((
∑geSize
-1)&pageSize)!=0

52428 || 
∑geSize
>
SQLITE_MAX_PAGE_SIZE


52429 || 
∑geSize
<=256

52431 
∑ge1_öô_Áûed
;

52433 
	`as£π
–(
∑geSize
 & 7)==0 );

52434 
ußbÀSize
 = 
∑geSize
 - 
∑ge1
[20];

52435 if–(
u32
)
∑geSize
!=
pBt
->pageSize ){

52442 
	`ªÀa£Page
(
pPage1
);

52443 
pBt
->
ußbÀSize
 = usableSize;

52444 
pBt
->
∑geSize
 =ÖageSize;

52445 
	`‰ìTempS∑˚
(
pBt
);

52446 
rc
 = 
	`sqlôe3PagîSëPagesize
(
pBt
->
pPagî
, &pBt->
∑geSize
,

52447 
∑geSize
-
ußbÀSize
);

52448  
rc
;

52450 if–(
pBt
->
db
->
Êags
 & 
SQLITE_RecovîyMode
)==0 && 
nPage
>
nPageFûe
 ){

52451 
rc
 = 
SQLITE_CORRUPT_BKPT
;

52452 
∑ge1_öô_Áûed
;

52454 if–
ußbÀSize
<480 ){

52455 
∑ge1_öô_Áûed
;

52457 
pBt
->
∑geSize
 =ÖageSize;

52458 
pBt
->
ußbÀSize
 = usableSize;

52459 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


52460 
pBt
->
autoVacuum
 = (
	`gë4byã
(&
∑ge1
[36 + 4*4])?1:0);

52461 
pBt
->
ö¸Vacuum
 = (
	`gë4byã
(&
∑ge1
[36 + 7*4])?1:0);

52478 
pBt
->
maxLoˇl
 = (
u16
)(’Bt->
ußbÀSize
-12)*64/255 - 23);

52479 
pBt
->
möLoˇl
 = (
u16
)(’Bt->
ußbÀSize
-12)*32/255 - 23);

52480 
pBt
->
maxLóf
 = (
u16
)’Bt->
ußbÀSize
 - 35);

52481 
pBt
->
möLóf
 = (
u16
)(’Bt->
ußbÀSize
-12)*32/255 - 23);

52482 if–
pBt
->
maxLoˇl
>127 ){

52483 
pBt
->
max1byãPaylﬂd
 = 127;

52485 
pBt
->
max1byãPaylﬂd
 = (
u8
ÌBt->
maxLoˇl
;

52487 
	`as£π
–
pBt
->
maxLóf
 + 23 <
	`MX_CELL_SIZE
(pBt) );

52488 
pBt
->
pPage1
 =ÖPage1;

52489 
pBt
->
nPage
 =ÇPage;

52490  
SQLITE_OK
;

52492 
∑ge1_öô_Áûed
:

52493 
	`ªÀa£Page
(
pPage1
);

52494 
pBt
->
pPage1
 = 0;

52495  
rc
;

52498 #i‚de‡
NDEBUG


52511 
	`cou¡VÆidCurs‹s
(
BtSh¨ed
 *
pBt
, 
wrO∆y
){

52512 
BtCurs‹
 *
pCur
;

52513 
r
 = 0;

52514 
pCur
=
pBt
->
pCurs‹
;ÖCur;ÖCurıCur->
pNext
){

52515 if–(
wrO∆y
==0 || 
pCur
->
wrFœg
Ë&&ÖCur->
eSèã
!=
CURSOR_FAULT
 ) 
r
++;

52517  
r
;

52529 
	`u∆ockBåìIfUnu£d
(
BtSh¨ed
 *
pBt
){

52530 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pBt
->
muãx
) );

52531 
	`as£π
–
	`cou¡VÆidCurs‹s
(
pBt
,0)==0 ||ÖBt->
öTønß˘i⁄
>
TRANS_NONE
 );

52532 if–
pBt
->
öTønß˘i⁄
==
TRANS_NONE
 &&ÖBt->
pPage1
!=0 ){

52533 
	`as£π
–
pBt
->
pPage1
->
aD©a
 );

52534 
	`as£π
–
	`sqlôe3PagîRefcou¡
(
pBt
->
pPagî
)==1 );

52535 
	`as£π
–
pBt
->
pPage1
->
aD©a
 );

52536 
	`ªÀa£Page
(
pBt
->
pPage1
);

52537 
pBt
->
pPage1
 = 0;

52546 
	`√wD©aba£
(
BtSh¨ed
 *
pBt
){

52547 
MemPage
 *
pP1
;

52548 *
d©a
;

52549 
rc
;

52551 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pBt
->
muãx
) );

52552 if–
pBt
->
nPage
>0 ){

52553  
SQLITE_OK
;

52555 
pP1
 = 
pBt
->
pPage1
;

52556 
	`as£π
–
pP1
!=0 );

52557 
d©a
 = 
pP1
->
aD©a
;

52558 
rc
 = 
	`sqlôe3PagîWrôe
(
pP1
->
pDbPage
);

52559 if–
rc
 ) Ñc;

52560 
	`mem˝y
(
d©a
, 
zMagicHódî
, (zMagicHeader));

52561 
	`as£π
–(
zMagicHódî
)==16 );

52562 
d©a
[16] = (
u8
)((
pBt
->
∑geSize
>>8)&0xff);

52563 
d©a
[17] = (
u8
)((
pBt
->
∑geSize
>>16)&0xff);

52564 
d©a
[18] = 1;

52565 
d©a
[19] = 1;

52566 
	`as£π
–
pBt
->
ußbÀSize
<ıBt->
∑geSize
 &&ÖBt->usableSize+255>=pBt->pageSize);

52567 
d©a
[20] = (
u8
)(
pBt
->
∑geSize
 -ÖBt->
ußbÀSize
);

52568 
d©a
[21] = 64;

52569 
d©a
[22] = 32;

52570 
d©a
[23] = 32;

52571 
	`mem£t
(&
d©a
[24], 0, 100-24);

52572 
	`zîoPage
(
pP1
, 
PTF_INTKEY
|
PTF_LEAF
|
PTF_LEAFDATA
 );

52573 
pBt
->
btsFœgs
 |
BTS_PAGESIZE_FIXED
;

52574 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


52575 
	`as£π
–
pBt
->
autoVacuum
==1 ||ÖBt->autoVacuum==0 );

52576 
	`as£π
–
pBt
->
ö¸Vacuum
==1 ||ÖBt->incrVacuum==0 );

52577 
	`put4byã
(&
d©a
[36 + 4*4], 
pBt
->
autoVacuum
);

52578 
	`put4byã
(&
d©a
[36 + 7*4], 
pBt
->
ö¸Vacuum
);

52580 
pBt
->
nPage
 = 1;

52581 
d©a
[31] = 1;

52582  
SQLITE_OK
;

52590 
SQLITE_PRIVATE
 
	`sqlôe3BåìNewDb
(
Båì
 *
p
){

52591 
rc
;

52592 
	`sqlôe3BåìE¡î
(
p
);

52593 
p
->
pBt
->
nPage
 = 0;

52594 
rc
 = 
	`√wD©aba£
(
p
->
pBt
);

52595 
	`sqlôe3BåìLóve
(
p
);

52596  
rc
;

52634 
SQLITE_PRIVATE
 
	`sqlôe3BåìBegöTøns
(
Båì
 *
p
, 
wrÊag
){

52635 
sqlôe3
 *
pBlock
 = 0;

52636 
BtSh¨ed
 *
pBt
 = 
p
->pBt;

52637 
rc
 = 
SQLITE_OK
;

52639 
	`sqlôe3BåìE¡î
(
p
);

52640 
	`båìI¡egrôy
(
p
);

52646 if–
p
->
öTøns
==
TRANS_WRITE
 || (p->öTøns==
TRANS_READ
 && !
wrÊag
) ){

52647 
å™s_begun
;

52649 
	`as£π
–
pBt
->
öTønß˘i⁄
==
TRANS_WRITE
 || 
	`IfNŸOmôAV
’Bt->
bDoTrunˇã
)==0 );

52652 if–(
pBt
->
btsFœgs
 & 
BTS_READ_ONLY
)!=0 && 
wrÊag
 ){

52653 
rc
 = 
SQLITE_READONLY
;

52654 
å™s_begun
;

52657 #i‚de‡
SQLITE_OMIT_SHARED_CACHE


52662 if–(
wrÊag
 && 
pBt
->
öTønß˘i⁄
==
TRANS_WRITE
)

52663 || (
pBt
->
btsFœgs
 & 
BTS_PENDING
)!=0

52665 
pBlock
 = 
pBt
->
pWrôî
->
db
;

52666 }if–
wrÊag
>1 ){

52667 
BtLock
 *
pIãr
;

52668 
pIãr
=
pBt
->
pLock
;ÖIãr;ÖIãrıIãr->
pNext
){

52669 if–
pIãr
->
pBåì
!=
p
 ){

52670 
pBlock
 = 
pIãr
->
pBåì
->
db
;

52675 if–
pBlock
 ){

52676 
	`sqlôe3C⁄√˘i⁄Blocked
(
p
->
db
, 
pBlock
);

52677 
rc
 = 
SQLITE_LOCKED_SHAREDCACHE
;

52678 
å™s_begun
;

52685 
rc
 = 
	`quîySh¨edCacheTabÀLock
(
p
, 
MASTER_ROOT
, 
READ_LOCK
);

52686 if–
SQLITE_OK
!=
rc
 ) 
å™s_begun
;

52688 
pBt
->
btsFœgs
 &~
BTS_INITIALLY_EMPTY
;

52689 if–
pBt
->
nPage
==0 )ÖBt->
btsFœgs
 |
BTS_INITIALLY_EMPTY
;

52698  
pBt
->
pPage1
==0 && 
SQLITE_OK
==(
rc
 = 
	`lockBåì
(pBt)) );

52700 if–
rc
==
SQLITE_OK
 && 
wrÊag
 ){

52701 if–(
pBt
->
btsFœgs
 & 
BTS_READ_ONLY
)!=0 ){

52702 
rc
 = 
SQLITE_READONLY
;

52704 
rc
 = 
	`sqlôe3PagîBegö
(
pBt
->
pPagî
,
wrÊag
>1,
	`sqlôe3TempInMem‹y
(
p
->
db
));

52705 if–
rc
==
SQLITE_OK
 ){

52706 
rc
 = 
	`√wD©aba£
(
pBt
);

52711 if–
rc
!=
SQLITE_OK
 ){

52712 
	`u∆ockBåìIfUnu£d
(
pBt
);

52714 } (
rc
&0xFF)==
SQLITE_BUSY
 && 
pBt
->
öTønß˘i⁄
==
TRANS_NONE
 &&

52715 
	`båìInvokeBusyH™dÀr
(
pBt
) );

52717 if–
rc
==
SQLITE_OK
 ){

52718 if–
p
->
öTøns
==
TRANS_NONE
 ){

52719 
pBt
->
nTønß˘i⁄
++;

52720 #i‚de‡
SQLITE_OMIT_SHARED_CACHE


52721 if–
p
->
sh¨abÀ
 ){

52722 
	`as£π
–
p
->
lock
.
pBåì
=ı &&Ö->lock.
iTabÀ
==1 );

52723 
p
->
lock
.
eLock
 = 
READ_LOCK
;

52724 
p
->
lock
.
pNext
 = 
pBt
->
pLock
;

52725 
pBt
->
pLock
 = &
p
->
lock
;

52729 
p
->
öTøns
 = (
wrÊag
?
TRANS_WRITE
:
TRANS_READ
);

52730 if–
p
->
öTøns
>
pBt
->
öTønß˘i⁄
 ){

52731 
pBt
->
öTønß˘i⁄
 = 
p
->
öTøns
;

52733 if–
wrÊag
 ){

52734 
MemPage
 *
pPage1
 = 
pBt
->pPage1;

52735 #i‚de‡
SQLITE_OMIT_SHARED_CACHE


52736 
	`as£π
–!
pBt
->
pWrôî
 );

52737 
pBt
->
pWrôî
 = 
p
;

52738 
pBt
->
btsFœgs
 &~
BTS_EXCLUSIVE
;

52739 if–
wrÊag
>1 ) 
pBt
->
btsFœgs
 |
BTS_EXCLUSIVE
;

52748 if–
pBt
->
nPage
!=
	`gë4byã
(&
pPage1
->
aD©a
[28]) ){

52749 
rc
 = 
	`sqlôe3PagîWrôe
(
pPage1
->
pDbPage
);

52750 if–
rc
==
SQLITE_OK
 ){

52751 
	`put4byã
(&
pPage1
->
aD©a
[28], 
pBt
->
nPage
);

52758 
å™s_begun
:

52759 if–
rc
==
SQLITE_OK
 && 
wrÊag
 ){

52764 
rc
 = 
	`sqlôe3PagîO≥nSavïoöt
(
pBt
->
pPagî
, 
p
->
db
->
nSavïoöt
);

52767 
	`båìI¡egrôy
(
p
);

52768 
	`sqlôe3BåìLóve
(
p
);

52769  
rc
;

52772 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


52779 
	`£tChûdPåm≠s
(
MemPage
 *
pPage
){

52780 
i
;

52781 
nCñl
;

52782 
rc
;

52783 
BtSh¨ed
 *
pBt
 = 
pPage
->pBt;

52784 
u8
 
isInôOrig
 = 
pPage
->
isInô
;

52785 
Pgno
 
pgno
 = 
pPage
->pgno;

52787 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pPage
->
pBt
->
muãx
) );

52788 
rc
 = 
	`båìInôPage
(
pPage
);

52789 if–
rc
!=
SQLITE_OK
 ){

52790 
£t_chûd_±rm≠s_out
;

52792 
nCñl
 = 
pPage
->nCell;

52794 
i
=0; i<
nCñl
; i++){

52795 
u8
 *
pCñl
 = 
	`födCñl
(
pPage
, 
i
);

52797 
	`±rm≠PutOvÊPå
(
pPage
, 
pCñl
, &
rc
);

52799 if–!
pPage
->
Àaf
 ){

52800 
Pgno
 
chûdPgno
 = 
	`gë4byã
(
pCñl
);

52801 
	`±rm≠Put
(
pBt
, 
chûdPgno
, 
PTRMAP_BTREE
, 
pgno
, &
rc
);

52805 if–!
pPage
->
Àaf
 ){

52806 
Pgno
 
chûdPgno
 = 
	`gë4byã
(&
pPage
->
aD©a
[pPage->
hdrOff£t
+8]);

52807 
	`±rm≠Put
(
pBt
, 
chûdPgno
, 
PTRMAP_BTREE
, 
pgno
, &
rc
);

52810 
£t_chûd_±rm≠s_out
:

52811 
pPage
->
isInô
 = 
isInôOrig
;

52812  
rc
;

52829 
	`modifyPagePoöãr
(
MemPage
 *
pPage
, 
Pgno
 
iFrom
, Pgnÿ
iTo
, 
u8
 
eTy≥
){

52830 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pPage
->
pBt
->
muãx
) );

52831 
	`as£π
–
	`sqlôe3PagîIswrôóbÀ
(
pPage
->
pDbPage
) );

52832 if–
eTy≥
==
PTRMAP_OVERFLOW2
 ){

52834 if–
	`gë4byã
(
pPage
->
aD©a
)!=
iFrom
 ){

52835  
SQLITE_CORRUPT_BKPT
;

52837 
	`put4byã
(
pPage
->
aD©a
, 
iTo
);

52839 
u8
 
isInôOrig
 = 
pPage
->
isInô
;

52840 
i
;

52841 
nCñl
;

52843 
	`båìInôPage
(
pPage
);

52844 
nCñl
 = 
pPage
->nCell;

52846 
i
=0; i<
nCñl
; i++){

52847 
u8
 *
pCñl
 = 
	`födCñl
(
pPage
, 
i
);

52848 if–
eTy≥
==
PTRMAP_OVERFLOW1
 ){

52849 
CñlInfo
 
öfo
;

52850 
	`båìP¨£CñlPå
(
pPage
, 
pCñl
, &
öfo
);

52851 if–
öfo
.
iOvîÊow


52852 && 
pCñl
+
öfo
.
iOvîÊow
+3<=
pPage
->
aD©a
+pPage->
maskPage


52853 && 
iFrom
==
	`gë4byã
(&
pCñl
[
öfo
.
iOvîÊow
])

52855 
	`put4byã
(&
pCñl
[
öfo
.
iOvîÊow
], 
iTo
);

52859 if–
	`gë4byã
(
pCñl
)==
iFrom
 ){

52860 
	`put4byã
(
pCñl
, 
iTo
);

52866 if–
i
==
nCñl
 ){

52867 if–
eTy≥
!=
PTRMAP_BTREE
 ||

52868 
	`gë4byã
(&
pPage
->
aD©a
[pPage->
hdrOff£t
+8])!=
iFrom
 ){

52869  
SQLITE_CORRUPT_BKPT
;

52871 
	`put4byã
(&
pPage
->
aD©a
[pPage->
hdrOff£t
+8], 
iTo
);

52874 
pPage
->
isInô
 = 
isInôOrig
;

52876  
SQLITE_OK
;

52889 
	`ªloˇãPage
(

52890 
BtSh¨ed
 *
pBt
,

52891 
MemPage
 *
pDbPage
,

52892 
u8
 
eTy≥
,

52893 
Pgno
 
iPåPage
,

52894 
Pgno
 
iFªePage
,

52895 
isCommô


52897 
MemPage
 *
pPåPage
;

52898 
Pgno
 
iDbPage
 = 
pDbPage
->
pgno
;

52899 
Pagî
 *
pPagî
 = 
pBt
->pPager;

52900 
rc
;

52902 
	`as£π
–
eTy≥
==
PTRMAP_OVERFLOW2
 ||ÉTy≥==
PTRMAP_OVERFLOW1
 ||

52903 
eTy≥
==
PTRMAP_BTREE
 ||ÉTy≥==
PTRMAP_ROOTPAGE
 );

52904 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pBt
->
muãx
) );

52905 
	`as£π
–
pDbPage
->
pBt
==pBt );

52908 
	`TRACE
(("AUTOVACUUM: Moving %dÅo freeÖage %d (ptrÖage %dÅype %d)\n",

52909 
iDbPage
, 
iFªePage
, 
iPåPage
, 
eTy≥
));

52910 
rc
 = 
	`sqlôe3PagîMovïage
(
pPagî
, 
pDbPage
->pDbPage, 
iFªePage
, 
isCommô
);

52911 if–
rc
!=
SQLITE_OK
 ){

52912  
rc
;

52914 
pDbPage
->
pgno
 = 
iFªePage
;

52924 if–
eTy≥
==
PTRMAP_BTREE
 ||ÉTy≥==
PTRMAP_ROOTPAGE
 ){

52925 
rc
 = 
	`£tChûdPåm≠s
(
pDbPage
);

52926 if–
rc
!=
SQLITE_OK
 ){

52927  
rc
;

52930 
Pgno
 
√xtOvÊ
 = 
	`gë4byã
(
pDbPage
->
aD©a
);

52931 if–
√xtOvÊ
!=0 ){

52932 
	`±rm≠Put
(
pBt
, 
√xtOvÊ
, 
PTRMAP_OVERFLOW2
, 
iFªePage
, &
rc
);

52933 if–
rc
!=
SQLITE_OK
 ){

52934  
rc
;

52943 if–
eTy≥
!=
PTRMAP_ROOTPAGE
 ){

52944 
rc
 = 
	`båìGëPage
(
pBt
, 
iPåPage
, &
pPåPage
, 0);

52945 if–
rc
!=
SQLITE_OK
 ){

52946  
rc
;

52948 
rc
 = 
	`sqlôe3PagîWrôe
(
pPåPage
->
pDbPage
);

52949 if–
rc
!=
SQLITE_OK
 ){

52950 
	`ªÀa£Page
(
pPåPage
);

52951  
rc
;

52953 
rc
 = 
	`modifyPagePoöãr
(
pPåPage
, 
iDbPage
, 
iFªePage
, 
eTy≥
);

52954 
	`ªÀa£Page
(
pPåPage
);

52955 if–
rc
==
SQLITE_OK
 ){

52956 
	`±rm≠Put
(
pBt
, 
iFªePage
, 
eTy≥
, 
iPåPage
, &
rc
);

52959  
rc
;

52963 
	`ÆloˇãBåìPage
(
BtSh¨ed
 *, 
MemPage
 **, 
Pgno
 *, Pgno, 
u8
);

52982 
	`ö¸VacuumSãp
(
BtSh¨ed
 *
pBt
, 
Pgno
 
nFö
, Pgnÿ
iLa°Pg
, 
bCommô
){

52983 
Pgno
 
nFªeLi°
;

52984 
rc
;

52986 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pBt
->
muãx
) );

52987 
	`as£π
–
iLa°Pg
>
nFö
 );

52989 if–!
	`PTRMAP_ISPAGE
(
pBt
, 
iLa°Pg
Ë&& iLa°Pg!=
	`PENDING_BYTE_PAGE
(pBt) ){

52990 
u8
 
eTy≥
;

52991 
Pgno
 
iPåPage
;

52993 
nFªeLi°
 = 
	`gë4byã
(&
pBt
->
pPage1
->
aD©a
[36]);

52994 if–
nFªeLi°
==0 ){

52995  
SQLITE_DONE
;

52998 
rc
 = 
	`±rm≠Gë
(
pBt
, 
iLa°Pg
, &
eTy≥
, &
iPåPage
);

52999 if–
rc
!=
SQLITE_OK
 ){

53000  
rc
;

53002 if–
eTy≥
==
PTRMAP_ROOTPAGE
 ){

53003  
SQLITE_CORRUPT_BKPT
;

53006 if–
eTy≥
==
PTRMAP_FREEPAGE
 ){

53007 if–
bCommô
==0 ){

53013 
Pgno
 
iFªePg
;

53014 
MemPage
 *
pFªePg
;

53015 
rc
 = 
	`ÆloˇãBåìPage
(
pBt
, &
pFªePg
, &
iFªePg
, 
iLa°Pg
, 
BTALLOC_EXACT
);

53016 if–
rc
!=
SQLITE_OK
 ){

53017  
rc
;

53019 
	`as£π
–
iFªePg
==
iLa°Pg
 );

53020 
	`ªÀa£Page
(
pFªePg
);

53023 
Pgno
 
iFªePg
;

53024 
MemPage
 *
pLa°Pg
;

53025 
u8
 
eMode
 = 
BTALLOC_ANY
;

53026 
Pgno
 
iNór
 = 0;

53028 
rc
 = 
	`båìGëPage
(
pBt
, 
iLa°Pg
, &
pLa°Pg
, 0);

53029 if–
rc
!=
SQLITE_OK
 ){

53030  
rc
;

53040 if–
bCommô
==0 ){

53041 
eMode
 = 
BTALLOC_LE
;

53042 
iNór
 = 
nFö
;

53045 
MemPage
 *
pFªePg
;

53046 
rc
 = 
	`ÆloˇãBåìPage
(
pBt
, &
pFªePg
, &
iFªePg
, 
iNór
, 
eMode
);

53047 if–
rc
!=
SQLITE_OK
 ){

53048 
	`ªÀa£Page
(
pLa°Pg
);

53049  
rc
;

53051 
	`ªÀa£Page
(
pFªePg
);

53052 } 
bCommô
 && 
iFªePg
>
nFö
 );

53053 
	`as£π
–
iFªePg
<
iLa°Pg
 );

53055 
rc
 = 
	`ªloˇãPage
(
pBt
, 
pLa°Pg
, 
eTy≥
, 
iPåPage
, 
iFªePg
, 
bCommô
);

53056 
	`ªÀa£Page
(
pLa°Pg
);

53057 if–
rc
!=
SQLITE_OK
 ){

53058  
rc
;

53063 if–
bCommô
==0 ){

53065 
iLa°Pg
--;

53066 } 
iLa°Pg
==
	`PENDING_BYTE_PAGE
(
pBt
Ë|| 
	`PTRMAP_ISPAGE
(pBt, iLastPg) );

53067 
pBt
->
bDoTrunˇã
 = 1;

53068 
pBt
->
nPage
 = 
iLa°Pg
;

53070  
SQLITE_OK
;

53078 
Pgno
 
	`föÆDbSize
(
BtSh¨ed
 *
pBt
, Pgnÿ
nOrig
, Pgnÿ
nFªe
){

53079 
nE¡ry
;

53080 
Pgno
 
nPåm≠
;

53081 
Pgno
 
nFö
;

53083 
nE¡ry
 = 
pBt
->
ußbÀSize
/5;

53084 
nPåm≠
 = (
nFªe
-
nOrig
+
	`PTRMAP_PAGENO
(
pBt
,ÇOrig)+
nE¡ry
)/nEntry;

53085 
nFö
 = 
nOrig
 - 
nFªe
 - 
nPåm≠
;

53086 if–
nOrig
>
	`PENDING_BYTE_PAGE
(
pBt
Ë&& 
nFö
<PENDING_BYTE_PAGE(pBt) ){

53087 
nFö
--;

53089  
	`PTRMAP_ISPAGE
(
pBt
, 
nFö
Ë||ÇFö==
	`PENDING_BYTE_PAGE
(pBt) ){

53090 
nFö
--;

53093  
nFö
;

53104 
SQLITE_PRIVATE
 
	`sqlôe3BåìIn¸Vacuum
(
Båì
 *
p
){

53105 
rc
;

53106 
BtSh¨ed
 *
pBt
 = 
p
->pBt;

53108 
	`sqlôe3BåìE¡î
(
p
);

53109 
	`as£π
–
pBt
->
öTønß˘i⁄
==
TRANS_WRITE
 && 
p
->
öTøns
==TRANS_WRITE );

53110 if–!
pBt
->
autoVacuum
 ){

53111 
rc
 = 
SQLITE_DONE
;

53113 
Pgno
 
nOrig
 = 
	`båìPagecou¡
(
pBt
);

53114 
Pgno
 
nFªe
 = 
	`gë4byã
(&
pBt
->
pPage1
->
aD©a
[36]);

53115 
Pgno
 
nFö
 = 
	`föÆDbSize
(
pBt
, 
nOrig
, 
nFªe
);

53117 if–
nOrig
<
nFö
 ){

53118 
rc
 = 
SQLITE_CORRUPT_BKPT
;

53119 }if–
nFªe
>0 ){

53120 
rc
 = 
	`ßveAŒCurs‹s
(
pBt
, 0, 0);

53121 if–
rc
==
SQLITE_OK
 ){

53122 
	`övÆid©eAŒOvîÊowCache
(
pBt
);

53123 
rc
 = 
	`ö¸VacuumSãp
(
pBt
, 
nFö
, 
nOrig
, 0);

53125 if–
rc
==
SQLITE_OK
 ){

53126 
rc
 = 
	`sqlôe3PagîWrôe
(
pBt
->
pPage1
->
pDbPage
);

53127 
	`put4byã
(&
pBt
->
pPage1
->
aD©a
[28],ÖBt->
nPage
);

53130 
rc
 = 
SQLITE_DONE
;

53133 
	`sqlôe3BåìLóve
(
p
);

53134  
rc
;

53146 
	`autoVacuumCommô
(
BtSh¨ed
 *
pBt
){

53147 
rc
 = 
SQLITE_OK
;

53148 
Pagî
 *
pPagî
 = 
pBt
->pPager;

53149 
	`VVA_ONLY
–
nRef
 = 
	`sqlôe3PagîRefcou¡
(
pPagî
) );

53151 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pBt
->
muãx
) );

53152 
	`övÆid©eAŒOvîÊowCache
(
pBt
);

53153 
	`as£π
(
pBt
->
autoVacuum
);

53154 if–!
pBt
->
ö¸Vacuum
 ){

53155 
Pgno
 
nFö
;

53156 
Pgno
 
nFªe
;

53157 
Pgno
 
iFªe
;

53158 
Pgno
 
nOrig
;

53160 
nOrig
 = 
	`båìPagecou¡
(
pBt
);

53161 if–
	`PTRMAP_ISPAGE
(
pBt
, 
nOrig
Ë||ÇOrig==
	`PENDING_BYTE_PAGE
(pBt) ){

53166  
SQLITE_CORRUPT_BKPT
;

53169 
nFªe
 = 
	`gë4byã
(&
pBt
->
pPage1
->
aD©a
[36]);

53170 
nFö
 = 
	`föÆDbSize
(
pBt
, 
nOrig
, 
nFªe
);

53171 if–
nFö
>
nOrig
 )  
SQLITE_CORRUPT_BKPT
;

53172 if–
nFö
<
nOrig
 ){

53173 
rc
 = 
	`ßveAŒCurs‹s
(
pBt
, 0, 0);

53175 
iFªe
=
nOrig
; iFªe>
nFö
 && 
rc
==
SQLITE_OK
; iFree--){

53176 
rc
 = 
	`ö¸VacuumSãp
(
pBt
, 
nFö
, 
iFªe
, 1);

53178 if–(
rc
==
SQLITE_DONE
 ||Ñc==
SQLITE_OK
Ë&& 
nFªe
>0 ){

53179 
rc
 = 
	`sqlôe3PagîWrôe
(
pBt
->
pPage1
->
pDbPage
);

53180 
	`put4byã
(&
pBt
->
pPage1
->
aD©a
[32], 0);

53181 
	`put4byã
(&
pBt
->
pPage1
->
aD©a
[36], 0);

53182 
	`put4byã
(&
pBt
->
pPage1
->
aD©a
[28], 
nFö
);

53183 
pBt
->
bDoTrunˇã
 = 1;

53184 
pBt
->
nPage
 = 
nFö
;

53186 if–
rc
!=
SQLITE_OK
 ){

53187 
	`sqlôe3PagîRﬁlback
(
pPagî
);

53191 
	`as£π
–
nRef
>=
	`sqlôe3PagîRefcou¡
(
pPagî
) );

53192  
rc
;

53196 
	#£tChûdPåm≠s
(
x
Ë
SQLITE_OK


	)

53225 
SQLITE_PRIVATE
 
	`sqlôe3BåìCommôPha£O√
(
Båì
 *
p
, c⁄° *
zMa°î
){

53226 
rc
 = 
SQLITE_OK
;

53227 if–
p
->
öTøns
==
TRANS_WRITE
 ){

53228 
BtSh¨ed
 *
pBt
 = 
p
->pBt;

53229 
	`sqlôe3BåìE¡î
(
p
);

53230 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


53231 if–
pBt
->
autoVacuum
 ){

53232 
rc
 = 
	`autoVacuumCommô
(
pBt
);

53233 if–
rc
!=
SQLITE_OK
 ){

53234 
	`sqlôe3BåìLóve
(
p
);

53235  
rc
;

53238 if–
pBt
->
bDoTrunˇã
 ){

53239 
	`sqlôe3PagîTrunˇãImage
(
pBt
->
pPagî
,ÖBt->
nPage
);

53242 
rc
 = 
	`sqlôe3PagîCommôPha£O√
(
pBt
->
pPagî
, 
zMa°î
, 0);

53243 
	`sqlôe3BåìLóve
(
p
);

53245  
rc
;

53252 
	`båìEndTønß˘i⁄
(
Båì
 *
p
){

53253 
BtSh¨ed
 *
pBt
 = 
p
->pBt;

53254 
sqlôe3
 *
db
 = 
p
->db;

53255 
	`as£π
–
	`sqlôe3BåìHﬁdsMuãx
(
p
) );

53257 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


53258 
pBt
->
bDoTrunˇã
 = 0;

53260 if–
p
->
öTøns
>
TRANS_NONE
 && 
db
->
nVdbeRód
>1 ){

53264 
	`downgødeAŒSh¨edCacheTabÀLocks
(
p
);

53265 
p
->
öTøns
 = 
TRANS_READ
;

53271 if–
p
->
öTøns
!=
TRANS_NONE
 ){

53272 
	`˛órAŒSh¨edCacheTabÀLocks
(
p
);

53273 
pBt
->
nTønß˘i⁄
--;

53274 if–0==
pBt
->
nTønß˘i⁄
 ){

53275 
pBt
->
öTønß˘i⁄
 = 
TRANS_NONE
;

53281 
p
->
öTøns
 = 
TRANS_NONE
;

53282 
	`u∆ockBåìIfUnu£d
(
pBt
);

53285 
	`båìI¡egrôy
(
p
);

53314 
SQLITE_PRIVATE
 
	`sqlôe3BåìCommôPha£Two
(
Båì
 *
p
, 
bCÀ™up
){

53316 if–
p
->
öTøns
==
TRANS_NONE
 )  
SQLITE_OK
;

53317 
	`sqlôe3BåìE¡î
(
p
);

53318 
	`båìI¡egrôy
(
p
);

53323 if–
p
->
öTøns
==
TRANS_WRITE
 ){

53324 
rc
;

53325 
BtSh¨ed
 *
pBt
 = 
p
->pBt;

53326 
	`as£π
–
pBt
->
öTønß˘i⁄
==
TRANS_WRITE
 );

53327 
	`as£π
–
pBt
->
nTønß˘i⁄
>0 );

53328 
rc
 = 
	`sqlôe3PagîCommôPha£Two
(
pBt
->
pPagî
);

53329 if–
rc
!=
SQLITE_OK
 && 
bCÀ™up
==0 ){

53330 
	`sqlôe3BåìLóve
(
p
);

53331  
rc
;

53333 
pBt
->
öTønß˘i⁄
 = 
TRANS_READ
;

53334 
	`båìCÀ¨HasC⁄ã¡
(
pBt
);

53337 
	`båìEndTønß˘i⁄
(
p
);

53338 
	`sqlôe3BåìLóve
(
p
);

53339  
SQLITE_OK
;

53345 
SQLITE_PRIVATE
 
	`sqlôe3BåìCommô
(
Båì
 *
p
){

53346 
rc
;

53347 
	`sqlôe3BåìE¡î
(
p
);

53348 
rc
 = 
	`sqlôe3BåìCommôPha£O√
(
p
, 0);

53349 if–
rc
==
SQLITE_OK
 ){

53350 
rc
 = 
	`sqlôe3BåìCommôPha£Two
(
p
, 0);

53352 
	`sqlôe3BåìLóve
(
p
);

53353  
rc
;

53373 
SQLITE_PRIVATE
 
	`sqlôe3BåìTrùAŒCurs‹s
(
Båì
 *
pBåì
, 
îrCode
){

53374 
BtCurs‹
 *
p
;

53375 if–
pBåì
==0 ) ;

53376 
	`sqlôe3BåìE¡î
(
pBåì
);

53377 
p
=
pBåì
->
pBt
->
pCurs‹
;Ö;Öı->
pNext
){

53378 
i
;

53379 
	`sqlôe3BåìCÀ¨Curs‹
(
p
);

53380 
p
->
eSèã
 = 
CURSOR_FAULT
;

53381 
p
->
skùNext
 = 
îrCode
;

53382 
i
=0; i<=
p
->
iPage
; i++){

53383 
	`ªÀa£Page
(
p
->
≠Page
[
i
]);

53384 
p
->
≠Page
[
i
] = 0;

53387 
	`sqlôe3BåìLóve
(
pBåì
);

53399 
SQLITE_PRIVATE
 
	`sqlôe3BåìRﬁlback
(
Båì
 *
p
, 
åùCode
){

53400 
rc
;

53401 
BtSh¨ed
 *
pBt
 = 
p
->pBt;

53402 
MemPage
 *
pPage1
;

53404 
	`sqlôe3BåìE¡î
(
p
);

53405 if–
åùCode
==
SQLITE_OK
 ){

53406 
rc
 = 
åùCode
 = 
	`ßveAŒCurs‹s
(
pBt
, 0, 0);

53408 
rc
 = 
SQLITE_OK
;

53410 if–
åùCode
 ){

53411 
	`sqlôe3BåìTrùAŒCurs‹s
(
p
, 
åùCode
);

53413 
	`båìI¡egrôy
(
p
);

53415 if–
p
->
öTøns
==
TRANS_WRITE
 ){

53416 
rc2
;

53418 
	`as£π
–
TRANS_WRITE
==
pBt
->
öTønß˘i⁄
 );

53419 
rc2
 = 
	`sqlôe3PagîRﬁlback
(
pBt
->
pPagî
);

53420 if–
rc2
!=
SQLITE_OK
 ){

53421 
rc
 = 
rc2
;

53427 if–
	`båìGëPage
(
pBt
, 1, &
pPage1
, 0)==
SQLITE_OK
 ){

53428 
nPage
 = 
	`gë4byã
(28+(
u8
*)
pPage1
->
aD©a
);

53429 
	`ã°ˇ£
–
nPage
==0 );

53430 if–
nPage
==0 ) 
	`sqlôe3PagîPagecou¡
(
pBt
->
pPagî
, &nPage);

53431 
	`ã°ˇ£
–
pBt
->
nPage
!=nPage );

53432 
pBt
->
nPage
 =ÇPage;

53433 
	`ªÀa£Page
(
pPage1
);

53435 
	`as£π
–
	`cou¡VÆidCurs‹s
(
pBt
, 1)==0 );

53436 
pBt
->
öTønß˘i⁄
 = 
TRANS_READ
;

53437 
	`båìCÀ¨HasC⁄ã¡
(
pBt
);

53440 
	`båìEndTønß˘i⁄
(
p
);

53441 
	`sqlôe3BåìLóve
(
p
);

53442  
rc
;

53463 
SQLITE_PRIVATE
 
	`sqlôe3BåìBegöStmt
(
Båì
 *
p
, 
iSèãmít
){

53464 
rc
;

53465 
BtSh¨ed
 *
pBt
 = 
p
->pBt;

53466 
	`sqlôe3BåìE¡î
(
p
);

53467 
	`as£π
–
p
->
öTøns
==
TRANS_WRITE
 );

53468 
	`as£π
–(
pBt
->
btsFœgs
 & 
BTS_READ_ONLY
)==0 );

53469 
	`as£π
–
iSèãmít
>0 );

53470 
	`as£π
–
iSèãmít
>
p
->
db
->
nSavïoöt
 );

53471 
	`as£π
–
pBt
->
öTønß˘i⁄
==
TRANS_WRITE
 );

53477 
rc
 = 
	`sqlôe3PagîO≥nSavïoöt
(
pBt
->
pPagî
, 
iSèãmít
);

53478 
	`sqlôe3BåìLóve
(
p
);

53479  
rc
;

53494 
SQLITE_PRIVATE
 
	`sqlôe3BåìSavïoöt
(
Båì
 *
p
, 
›
, 
iSavïoöt
){

53495 
rc
 = 
SQLITE_OK
;

53496 if–
p
 &&Ö->
öTøns
==
TRANS_WRITE
 ){

53497 
BtSh¨ed
 *
pBt
 = 
p
->pBt;

53498 
	`as£π
–
›
==
SAVEPOINT_RELEASE
 || op==
SAVEPOINT_ROLLBACK
 );

53499 
	`as£π
–
iSavïoöt
>=0 || (iSavïoöt==-1 && 
›
==
SAVEPOINT_ROLLBACK
) );

53500 
	`sqlôe3BåìE¡î
(
p
);

53501 
rc
 = 
	`sqlôe3PagîSavïoöt
(
pBt
->
pPagî
, 
›
, 
iSavïoöt
);

53502 if–
rc
==
SQLITE_OK
 ){

53503 if–
iSavïoöt
<0 && (
pBt
->
btsFœgs
 & 
BTS_INITIALLY_EMPTY
)!=0 ){

53504 
pBt
->
nPage
 = 0;

53506 
rc
 = 
	`√wD©aba£
(
pBt
);

53507 
pBt
->
nPage
 = 
	`gë4byã
(28 +ÖBt->
pPage1
->
aD©a
);

53512 
	`as£π
–
pBt
->
nPage
>0 );

53514 
	`sqlôe3BåìLóve
(
p
);

53516  
rc
;

53551 
	`båìCurs‹
(

53552 
Båì
 *
p
,

53553 
iTabÀ
,

53554 
wrFœg
,

53555 
KeyInfo
 *
pKeyInfo
,

53556 
BtCurs‹
 *
pCur


53558 
BtSh¨ed
 *
pBt
 = 
p
->pBt;

53560 
	`as£π
–
	`sqlôe3BåìHﬁdsMuãx
(
p
) );

53561 
	`as£π
–
wrFœg
==0 || wrFlag==1 );

53567 
	`as£π
–
	`hasSh¨edCacheTabÀLock
(
p
, 
iTabÀ
, 
pKeyInfo
!=0, 
wrFœg
+1) );

53568 
	`as£π
–
wrFœg
==0 || !
	`hasRódC⁄Êi˘s
(
p
, 
iTabÀ
) );

53571 
	`as£π
–
p
->
öTøns
>
TRANS_NONE
 );

53572 
	`as£π
–
wrFœg
==0 || 
p
->
öTøns
==
TRANS_WRITE
 );

53573 
	`as£π
–
pBt
->
pPage1
 &&ÖBt->pPage1->
aD©a
 );

53575 if–
	`NEVER
(
wrFœg
 && (
pBt
->
btsFœgs
 & 
BTS_READ_ONLY
)!=0) ){

53576  
SQLITE_READONLY
;

53578 if–
iTabÀ
==1 && 
	`båìPagecou¡
(
pBt
)==0 ){

53579 
	`as£π
–
wrFœg
==0 );

53580 
iTabÀ
 = 0;

53585 
pCur
->
pgnoRoŸ
 = (
Pgno
)
iTabÀ
;

53586 
pCur
->
iPage
 = -1;

53587 
pCur
->
pKeyInfo
 =ÖKeyInfo;

53588 
pCur
->
pBåì
 = 
p
;

53589 
pCur
->
pBt
 =ÖBt;

53590 
pCur
->
wrFœg
 = (
u8
)wrFlag;

53591 
pCur
->
pNext
 = 
pBt
->
pCurs‹
;

53592 if–
pCur
->
pNext
 ){

53593 
pCur
->
pNext
->
pPªv
 =ÖCur;

53595 
pBt
->
pCurs‹
 = 
pCur
;

53596 
pCur
->
eSèã
 = 
CURSOR_INVALID
;

53597 
pCur
->
ˇchedRowid
 = 0;

53598  
SQLITE_OK
;

53600 
SQLITE_PRIVATE
 
	`sqlôe3BåìCurs‹
(

53601 
Båì
 *
p
,

53602 
iTabÀ
,

53603 
wrFœg
,

53604 
KeyInfo
 *
pKeyInfo
,

53605 
BtCurs‹
 *
pCur


53607 
rc
;

53608 
	`sqlôe3BåìE¡î
(
p
);

53609 
rc
 = 
	`båìCurs‹
(
p
, 
iTabÀ
, 
wrFœg
, 
pKeyInfo
, 
pCur
);

53610 
	`sqlôe3BåìLóve
(
p
);

53611  
rc
;

53622 
SQLITE_PRIVATE
 
	`sqlôe3BåìCurs‹Size
(){

53623  
	`ROUND8
((
BtCurs‹
));

53634 
SQLITE_PRIVATE
 
	`sqlôe3BåìCurs‹Zîo
(
BtCurs‹
 *
p
){

53635 
	`mem£t
(
p
, 0, 
	`off£tof
(
BtCurs‹
, 
iPage
));

53650 
SQLITE_PRIVATE
 
	`sqlôe3BåìSëCachedRowid
(
BtCurs‹
 *
pCur
, 
sqlôe3_öt64
 
iRowid
){

53651 
BtCurs‹
 *
p
;

53652 
p
=
pCur
->
pBt
->
pCurs‹
;Ö;Öı->
pNext
){

53653 if–
p
->
pgnoRoŸ
==
pCur
->pgnoRoŸ )Ö->
ˇchedRowid
 = 
iRowid
;

53655 
	`as£π
–
pCur
->
ˇchedRowid
==
iRowid
 );

53664 
SQLITE_PRIVATE
 
sqlôe3_öt64
 
	`sqlôe3BåìGëCachedRowid
(
BtCurs‹
 *
pCur
){

53665  
pCur
->
ˇchedRowid
;

53672 
SQLITE_PRIVATE
 
	`sqlôe3BåìClo£Curs‹
(
BtCurs‹
 *
pCur
){

53673 
Båì
 *
pBåì
 = 
pCur
->pBtree;

53674 if–
pBåì
 ){

53675 
i
;

53676 
BtSh¨ed
 *
pBt
 = 
pCur
->pBt;

53677 
	`sqlôe3BåìE¡î
(
pBåì
);

53678 
	`sqlôe3BåìCÀ¨Curs‹
(
pCur
);

53679 if–
pCur
->
pPªv
 ){

53680 
pCur
->
pPªv
->
pNext
 =ÖCur->pNext;

53682 
pBt
->
pCurs‹
 = 
pCur
->
pNext
;

53684 if–
pCur
->
pNext
 ){

53685 
pCur
->
pNext
->
pPªv
 =ÖCur->pPrev;

53687 
i
=0; i<=
pCur
->
iPage
; i++){

53688 
	`ªÀa£Page
(
pCur
->
≠Page
[
i
]);

53690 
	`u∆ockBåìIfUnu£d
(
pBt
);

53691 
	`övÆid©eOvîÊowCache
(
pCur
);

53693 
	`sqlôe3BåìLóve
(
pBåì
);

53695  
SQLITE_OK
;

53713 #i‚de‡
NDEBUG


53714 
	`as£πCñlInfo
(
BtCurs‹
 *
pCur
){

53715 
CñlInfo
 
öfo
;

53716 
iPage
 = 
pCur
->iPage;

53717 
	`mem£t
(&
öfo
, 0, (info));

53718 
	`båìP¨£Cñl
(
pCur
->
≠Page
[
iPage
],ÖCur->
aiIdx
[iPage], &
öfo
);

53719 
	`as£π
–
	`memcmp
(&
öfo
, &
pCur
->info, (info))==0 );

53722 
	#as£πCñlInfo
(
x
)

	)

53724 #ifde‡
_MSC_VER


53726 
	`gëCñlInfo
(
BtCurs‹
 *
pCur
){

53727 if–
pCur
->
öfo
.
nSize
==0 ){

53728 
iPage
 = 
pCur
->iPage;

53729 
	`båìP¨£Cñl
(
pCur
->
≠Page
[
iPage
],pCur->
aiIdx
[iPage],&pCur->
öfo
);

53730 
pCur
->
vÆidNKey
 = 1;

53732 
	`as£πCñlInfo
(
pCur
);

53737 
	#gëCñlInfo
(
pCur
) \

53738 if–
pCur
->
öfo
.
nSize
==0 ){ \

53739 
iPage
 = 
pCur
->iPage; \

53740 
	`båìP¨£Cñl
(
pCur
->
≠Page
[
iPage
],pCur->
aiIdx
[iPage],&pCur->
öfo
); \

53741 
pCur
->
vÆidNKey
 = 1; \

53743 
	`as£πCñlInfo
(
pCur
); \

53744 }

	)

53747 #i‚de‡
NDEBUG


53753 
SQLITE_PRIVATE
 
	`sqlôe3BåìCurs‹IsVÆid
(
BtCurs‹
 *
pCur
){

53754  
pCur
 &&ÖCur->
eSèã
==
CURSOR_VALID
;

53770 
SQLITE_PRIVATE
 
	`sqlôe3BåìKeySize
(
BtCurs‹
 *
pCur
, 
i64
 *
pSize
){

53771 
	`as£π
–
	`curs‹HﬁdsMuãx
(
pCur
) );

53772 
	`as£π
–
pCur
->
eSèã
==
CURSOR_INVALID
 ||ÖCur->eSèã==
CURSOR_VALID
 );

53773 if–
pCur
->
eSèã
!=
CURSOR_VALID
 ){

53774 *
pSize
 = 0;

53776 
	`gëCñlInfo
(
pCur
);

53777 *
pSize
 = 
pCur
->
öfo
.
nKey
;

53779  
SQLITE_OK
;

53794 
SQLITE_PRIVATE
 
	`sqlôe3BåìD©aSize
(
BtCurs‹
 *
pCur
, 
u32
 *
pSize
){

53795 
	`as£π
–
	`curs‹HﬁdsMuãx
(
pCur
) );

53796 
	`as£π
–
pCur
->
eSèã
==
CURSOR_VALID
 );

53797 
	`gëCñlInfo
(
pCur
);

53798 *
pSize
 = 
pCur
->
öfo
.
nD©a
;

53799  
SQLITE_OK
;

53821 
	`gëOvîÊowPage
(

53822 
BtSh¨ed
 *
pBt
,

53823 
Pgno
 
ovÊ
,

53824 
MemPage
 **
µPage
,

53825 
Pgno
 *
pPgnoNext


53827 
Pgno
 
√xt
 = 0;

53828 
MemPage
 *
pPage
 = 0;

53829 
rc
 = 
SQLITE_OK
;

53831 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pBt
->
muãx
) );

53832 
	`as£π
(
pPgnoNext
);

53834 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


53841 if–
pBt
->
autoVacuum
 ){

53842 
Pgno
 
pgno
;

53843 
Pgno
 
iGuess
 = 
ovÊ
+1;

53844 
u8
 
eTy≥
;

53846  
	`PTRMAP_ISPAGE
(
pBt
, 
iGuess
Ë|| iGuess==
	`PENDING_BYTE_PAGE
(pBt) ){

53847 
iGuess
++;

53850 if–
iGuess
<=
	`båìPagecou¡
(
pBt
) ){

53851 
rc
 = 
	`±rm≠Gë
(
pBt
, 
iGuess
, &
eTy≥
, &
pgno
);

53852 if–
rc
==
SQLITE_OK
 && 
eTy≥
==
PTRMAP_OVERFLOW2
 && 
pgno
==
ovÊ
 ){

53853 
√xt
 = 
iGuess
;

53854 
rc
 = 
SQLITE_DONE
;

53860 
	`as£π
–
√xt
==0 || 
rc
==
SQLITE_DONE
 );

53861 if–
rc
==
SQLITE_OK
 ){

53862 
rc
 = 
	`båìGëPage
(
pBt
, 
ovÊ
, &
pPage
, (
µPage
==0Ë? 
PAGER_GET_READONLY
 : 0);

53863 
	`as£π
–
rc
==
SQLITE_OK
 || 
pPage
==0 );

53864 if–
rc
==
SQLITE_OK
 ){

53865 
√xt
 = 
	`gë4byã
(
pPage
->
aD©a
);

53869 *
pPgnoNext
 = 
√xt
;

53870 if–
µPage
 ){

53871 *
µPage
 = 
pPage
;

53873 
	`ªÀa£Page
(
pPage
);

53875  (
rc
==
SQLITE_DONE
 ? 
SQLITE_OK
 :Ñc);

53889 
	`c›yPaylﬂd
(

53890 *
pPaylﬂd
,

53891 *
pBuf
,

53892 
nByã
,

53893 
eOp
,

53894 
DbPage
 *
pDbPage


53896 if–
eOp
 ){

53898 
rc
 = 
	`sqlôe3PagîWrôe
(
pDbPage
);

53899 if–
rc
!=
SQLITE_OK
 ){

53900  
rc
;

53902 
	`mem˝y
(
pPaylﬂd
, 
pBuf
, 
nByã
);

53905 
	`mem˝y
(
pBuf
, 
pPaylﬂd
, 
nByã
);

53907  
SQLITE_OK
;

53938 
	`ac˚ssPaylﬂd
(

53939 
BtCurs‹
 *
pCur
,

53940 
u32
 
off£t
,

53941 
u32
 
amt
,

53942 *
pBuf
,

53943 
eOp


53945 *
aPaylﬂd
;

53946 
rc
 = 
SQLITE_OK
;

53947 
u32
 
nKey
;

53948 
iIdx
 = 0;

53949 
MemPage
 *
pPage
 = 
pCur
->
≠Page
[pCur->
iPage
];

53950 
BtSh¨ed
 *
pBt
 = 
pCur
->pBt;

53952 
	`as£π
–
pPage
 );

53953 
	`as£π
–
pCur
->
eSèã
==
CURSOR_VALID
 );

53954 
	`as£π
–
pCur
->
aiIdx
[pCur->
iPage
]<
pPage
->
nCñl
 );

53955 
	`as£π
–
	`curs‹HﬁdsMuãx
(
pCur
) );

53957 
	`gëCñlInfo
(
pCur
);

53958 
aPaylﬂd
 = 
pCur
->
öfo
.
pCñl
 +ÖCur->öfo.
nHódî
;

53959 
nKey
 = (
pPage
->
ötKey
 ? 0 : ()
pCur
->
öfo
.nKey);

53961 if–
	`NEVER
(
off£t
+
amt
 > 
nKey
+
pCur
->
öfo
.
nD©a
)

53962 || &
aPaylﬂd
[
pCur
->
öfo
.
nLoˇl
] > &
pPage
->
aD©a
[
pBt
->
ußbÀSize
]

53965  
SQLITE_CORRUPT_BKPT
;

53969 if–
off£t
<
pCur
->
öfo
.
nLoˇl
 ){

53970 
a
 = 
amt
;

53971 if–
a
+
off£t
>
pCur
->
öfo
.
nLoˇl
 ){

53972 
a
 = 
pCur
->
öfo
.
nLoˇl
 - 
off£t
;

53974 
rc
 = 
	`c›yPaylﬂd
(&
aPaylﬂd
[
off£t
], 
pBuf
, 
a
, 
eOp
, 
pPage
->
pDbPage
);

53975 
off£t
 = 0;

53976 
pBuf
 +
a
;

53977 
amt
 -
a
;

53979 
off£t
 -
pCur
->
öfo
.
nLoˇl
;

53982 if–
rc
==
SQLITE_OK
 && 
amt
>0 ){

53983 c⁄° 
u32
 
ovÊSize
 = 
pBt
->
ußbÀSize
 - 4;

53984 
Pgno
 
√xtPage
;

53986 
√xtPage
 = 
	`gë4byã
(&
aPaylﬂd
[
pCur
->
öfo
.
nLoˇl
]);

53988 #i‚de‡
SQLITE_OMIT_INCRBLOB


53996 if–
pCur
->
isIn¸blobH™dÀ
 && !pCur->
aOvîÊow
 ){

53997 
nOvÊ
 = (
pCur
->
öfo
.
nPaylﬂd
-pCur->öfo.
nLoˇl
+
ovÊSize
-1)/ovflSize;

53998 
pCur
->
aOvîÊow
 = (
Pgno
 *)
	`sqlôe3MÆlocZîo
((Pgno)*
nOvÊ
);

54001 if–
	`ALWAYS
(
nOvÊ
Ë&& !
pCur
->
aOvîÊow
 ){

54002 
rc
 = 
SQLITE_NOMEM
;

54010 if–
pCur
->
aOvîÊow
 &&ÖCur->aOvîÊow[
off£t
/
ovÊSize
] ){

54011 
iIdx
 = (
off£t
/
ovÊSize
);

54012 
√xtPage
 = 
pCur
->
aOvîÊow
[
iIdx
];

54013 
off£t
 = (off£t%
ovÊSize
);

54017  ; 
rc
==
SQLITE_OK
 && 
amt
>0 && 
√xtPage
; 
iIdx
++){

54019 #i‚de‡
SQLITE_OMIT_INCRBLOB


54021 if–
pCur
->
aOvîÊow
 ){

54022 
	`as£π
(!
pCur
->
aOvîÊow
[
iIdx
] ||ÖCur->aOvîÊow[iIdx]==
√xtPage
);

54023 
pCur
->
aOvîÊow
[
iIdx
] = 
√xtPage
;

54027 if–
off£t
>=
ovÊSize
 ){

54034 #i‚de‡
SQLITE_OMIT_INCRBLOB


54035 if–
pCur
->
aOvîÊow
 &&ÖCur->aOvîÊow[
iIdx
+1] ){

54036 
√xtPage
 = 
pCur
->
aOvîÊow
[
iIdx
+1];

54039 
rc
 = 
	`gëOvîÊowPage
(
pBt
, 
√xtPage
, 0, &nextPage);

54040 
off£t
 -
ovÊSize
;

54045 #ifde‡
SQLITE_DIRECT_OVERFLOW_READ


54046 
sqlôe3_fûe
 *
fd
;

54048 
a
 = 
amt
;

54049 if–
a
 + 
off£t
 > 
ovÊSize
 ){

54050 
a
 = 
ovÊSize
 - 
off£t
;

54053 #ifde‡
SQLITE_DIRECT_OVERFLOW_READ


54066 if–
eOp
==0

54067 && 
off£t
==0

54068 && 
pBt
->
öTønß˘i⁄
==
TRANS_READ


54069 && (
fd
 = 
	`sqlôe3PagîFûe
(
pBt
->
pPagî
))->
pMëhods


54070 && 
pBt
->
pPage1
->
aD©a
[19]==0x01

54072 
u8
 
aSave
[4];

54073 
u8
 *
aWrôe
 = &
pBuf
[-4];

54074 
	`mem˝y
(
aSave
, 
aWrôe
, 4);

54075 
rc
 = 
	`sqlôe3OsRód
(
fd
, 
aWrôe
, 
a
+4, (
i64
)
pBt
->
∑geSize
*(
√xtPage
-1));

54076 
√xtPage
 = 
	`gë4byã
(
aWrôe
);

54077 
	`mem˝y
(
aWrôe
, 
aSave
, 4);

54082 
DbPage
 *
pDbPage
;

54083 
rc
 = 
	`sqlôe3PagîAcquúe
(
pBt
->
pPagî
, 
√xtPage
, &
pDbPage
,

54084 (
eOp
==0 ? 
PAGER_GET_READONLY
 : 0)

54086 if–
rc
==
SQLITE_OK
 ){

54087 
aPaylﬂd
 = 
	`sqlôe3PagîGëD©a
(
pDbPage
);

54088 
√xtPage
 = 
	`gë4byã
(
aPaylﬂd
);

54089 
rc
 = 
	`c›yPaylﬂd
(&
aPaylﬂd
[
off£t
+4], 
pBuf
, 
a
, 
eOp
, 
pDbPage
);

54090 
	`sqlôe3PagîUƒef
(
pDbPage
);

54091 
off£t
 = 0;

54094 
amt
 -
a
;

54095 
pBuf
 +
a
;

54100 if–
rc
==
SQLITE_OK
 && 
amt
>0 ){

54101  
SQLITE_CORRUPT_BKPT
;

54103  
rc
;

54118 
SQLITE_PRIVATE
 
	`sqlôe3BåìKey
(
BtCurs‹
 *
pCur
, 
u32
 
off£t
, u32 
amt
, *
pBuf
){

54119 
	`as£π
–
	`curs‹HﬁdsMuãx
(
pCur
) );

54120 
	`as£π
–
pCur
->
eSèã
==
CURSOR_VALID
 );

54121 
	`as£π
–
pCur
->
iPage
>=0 &&ÖCur->
≠Page
[pCur->iPage] );

54122 
	`as£π
–
pCur
->
aiIdx
[pCur->
iPage
]<pCur->
≠Page
[pCur->iPage]->
nCñl
 );

54123  
	`ac˚ssPaylﬂd
(
pCur
, 
off£t
, 
amt
, (*)
pBuf
, 0);

54135 
SQLITE_PRIVATE
 
	`sqlôe3BåìD©a
(
BtCurs‹
 *
pCur
, 
u32
 
off£t
, u32 
amt
, *
pBuf
){

54136 
rc
;

54138 #i‚de‡
SQLITE_OMIT_INCRBLOB


54139 i‡–
pCur
->
eSèã
==
CURSOR_INVALID
 ){

54140  
SQLITE_ABORT
;

54144 
	`as£π
–
	`curs‹HﬁdsMuãx
(
pCur
) );

54145 
rc
 = 
	`ª°‹eCurs‹Posôi⁄
(
pCur
);

54146 if–
rc
==
SQLITE_OK
 ){

54147 
	`as£π
–
pCur
->
eSèã
==
CURSOR_VALID
 );

54148 
	`as£π
–
pCur
->
iPage
>=0 &&ÖCur->
≠Page
[pCur->iPage] );

54149 
	`as£π
–
pCur
->
aiIdx
[pCur->
iPage
]<pCur->
≠Page
[pCur->iPage]->
nCñl
 );

54150 
rc
 = 
	`ac˚ssPaylﬂd
(
pCur
, 
off£t
, 
amt
, 
pBuf
, 0);

54152  
rc
;

54174 c⁄° *
	`„tchPaylﬂd
(

54175 
BtCurs‹
 *
pCur
,

54176 *
pAmt
,

54177 
skùKey


54179 *
aPaylﬂd
;

54180 
MemPage
 *
pPage
;

54181 
u32
 
nKey
;

54182 
u32
 
nLoˇl
;

54184 
	`as£π
–
pCur
!=0 &&ÖCur->
iPage
>=0 &&ÖCur->
≠Page
[pCur->iPage]);

54185 
	`as£π
–
pCur
->
eSèã
==
CURSOR_VALID
 );

54186 
	`as£π
–
	`curs‹HﬁdsMuãx
(
pCur
) );

54187 
pPage
 = 
pCur
->
≠Page
[pCur->
iPage
];

54188 
	`as£π
–
pCur
->
aiIdx
[pCur->
iPage
]<
pPage
->
nCñl
 );

54189 if–
	`NEVER
(
pCur
->
öfo
.
nSize
==0) ){

54190 
	`båìP¨£Cñl
(
pCur
->
≠Page
[pCur->
iPage
],ÖCur->
aiIdx
[pCur->iPage],

54191 &
pCur
->
öfo
);

54193 
aPaylﬂd
 = 
pCur
->
öfo
.
pCñl
;

54194 
aPaylﬂd
 +
pCur
->
öfo
.
nHódî
;

54195 if–
pPage
->
ötKey
 ){

54196 
nKey
 = 0;

54198 
nKey
 = ()
pCur
->
öfo
.nKey;

54200 if–
skùKey
 ){

54201 
aPaylﬂd
 +
nKey
;

54202 
nLoˇl
 = 
pCur
->
öfo
.nLoˇ»- 
nKey
;

54204 
nLoˇl
 = 
pCur
->
öfo
.nLocal;

54205 
	`as£π
–
nLoˇl
<=
nKey
 );

54207 *
pAmt
 = 
nLoˇl
;

54208  
aPaylﬂd
;

54226 
SQLITE_PRIVATE
 c⁄° *
	`sqlôe3BåìKeyFëch
(
BtCurs‹
 *
pCur
, *
pAmt
){

54227 c⁄° *
p
 = 0;

54228 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pCur
->
pBåì
->
db
->
muãx
) );

54229 
	`as£π
–
	`curs‹HﬁdsMuãx
(
pCur
) );

54230 if–
	`ALWAYS
(
pCur
->
eSèã
==
CURSOR_VALID
) ){

54231 
p
 = (c⁄° *)
	`„tchPaylﬂd
(
pCur
, 
pAmt
, 0);

54233  
p
;

54235 
SQLITE_PRIVATE
 c⁄° *
	`sqlôe3BåìD©aFëch
(
BtCurs‹
 *
pCur
, *
pAmt
){

54236 c⁄° *
p
 = 0;

54237 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pCur
->
pBåì
->
db
->
muãx
) );

54238 
	`as£π
–
	`curs‹HﬁdsMuãx
(
pCur
) );

54239 if–
	`ALWAYS
(
pCur
->
eSèã
==
CURSOR_VALID
) ){

54240 
p
 = (c⁄° *)
	`„tchPaylﬂd
(
pCur
, 
pAmt
, 1);

54242  
p
;

54255 
	`moveToChûd
(
BtCurs‹
 *
pCur
, 
u32
 
√wPgno
){

54256 
rc
;

54257 
i
 = 
pCur
->
iPage
;

54258 
MemPage
 *
pNewPage
;

54259 
BtSh¨ed
 *
pBt
 = 
pCur
->pBt;

54261 
	`as£π
–
	`curs‹HﬁdsMuãx
(
pCur
) );

54262 
	`as£π
–
pCur
->
eSèã
==
CURSOR_VALID
 );

54263 
	`as£π
–
pCur
->
iPage
<
BTCURSOR_MAX_DEPTH
 );

54264 
	`as£π
–
pCur
->
iPage
>=0 );

54265 if–
pCur
->
iPage
>=(
BTCURSOR_MAX_DEPTH
-1) ){

54266  
SQLITE_CORRUPT_BKPT
;

54268 
rc
 = 
	`gëAndInôPage
(
pBt
, 
√wPgno
, &
pNewPage
,

54269 
pCur
->
wrFœg
==0 ? 
PAGER_GET_READONLY
 : 0);

54270 if–
rc
 ) Ñc;

54271 
pCur
->
≠Page
[
i
+1] = 
pNewPage
;

54272 
pCur
->
aiIdx
[
i
+1] = 0;

54273 
pCur
->
iPage
++;

54275 
pCur
->
öfo
.
nSize
 = 0;

54276 
pCur
->
vÆidNKey
 = 0;

54277 if–
pNewPage
->
nCñl
<1 ||ÖNewPage->
ötKey
!=
pCur
->
≠Page
[
i
]->intKey ){

54278  
SQLITE_CORRUPT_BKPT
;

54280  
SQLITE_OK
;

54291 
	`as£πP¨ítIndex
(
MemPage
 *
pP¨ít
, 
iIdx
, 
Pgno
 
iChûd
){

54292 
	`as£π
–
iIdx
<=
pP¨ít
->
nCñl
 );

54293 if–
iIdx
==
pP¨ít
->
nCñl
 ){

54294 
	`as£π
–
	`gë4byã
(&
pP¨ít
->
aD©a
[pP¨ít->
hdrOff£t
+8])==
iChûd
 );

54296 
	`as£π
–
	`gë4byã
(
	`födCñl
(
pP¨ít
, 
iIdx
))==
iChûd
 );

54300 
	#as£πP¨ítIndex
(
x
,
y
,
z
)

	)

54311 
	`moveToP¨ít
(
BtCurs‹
 *
pCur
){

54312 
	`as£π
–
	`curs‹HﬁdsMuãx
(
pCur
) );

54313 
	`as£π
–
pCur
->
eSèã
==
CURSOR_VALID
 );

54314 
	`as£π
–
pCur
->
iPage
>0 );

54315 
	`as£π
–
pCur
->
≠Page
[pCur->
iPage
] );

54323 
	`as£πP¨ítIndex
(

54324 
pCur
->
≠Page
[pCur->
iPage
-1],

54325 
pCur
->
aiIdx
[pCur->
iPage
-1],

54326 
pCur
->
≠Page
[pCur->
iPage
]->
pgno


54329 
	`ã°ˇ£
–
pCur
->
aiIdx
[pCur->
iPage
-1] >ÖCur->
≠Page
[pCur->iPage-1]->
nCñl
 );

54331 
	`ªÀa£Page
(
pCur
->
≠Page
[pCur->
iPage
]);

54332 
pCur
->
iPage
--;

54333 
pCur
->
öfo
.
nSize
 = 0;

54334 
pCur
->
vÆidNKey
 = 0;

54358 
	`moveToRoŸ
(
BtCurs‹
 *
pCur
){

54359 
MemPage
 *
pRoŸ
;

54360 
rc
 = 
SQLITE_OK
;

54361 
Båì
 *
p
 = 
pCur
->
pBåì
;

54362 
BtSh¨ed
 *
pBt
 = 
p
->pBt;

54364 
	`as£π
–
	`curs‹HﬁdsMuãx
(
pCur
) );

54365 
	`as£π
–
CURSOR_INVALID
 < 
CURSOR_REQUIRESEEK
 );

54366 
	`as£π
–
CURSOR_VALID
 < 
CURSOR_REQUIRESEEK
 );

54367 
	`as£π
–
CURSOR_FAULT
 > 
CURSOR_REQUIRESEEK
 );

54368 if–
pCur
->
eSèã
>=
CURSOR_REQUIRESEEK
 ){

54369 if–
pCur
->
eSèã
==
CURSOR_FAULT
 ){

54370 
	`as£π
–
pCur
->
skùNext
!=
SQLITE_OK
 );

54371  
pCur
->
skùNext
;

54373 
	`sqlôe3BåìCÀ¨Curs‹
(
pCur
);

54376 if–
pCur
->
iPage
>=0 ){

54377 
i
;

54378 
i
=1; i<=
pCur
->
iPage
; i++){

54379 
	`ªÀa£Page
(
pCur
->
≠Page
[
i
]);

54381 
pCur
->
iPage
 = 0;

54382 }if–
pCur
->
pgnoRoŸ
==0 ){

54383 
pCur
->
eSèã
 = 
CURSOR_INVALID
;

54384  
SQLITE_OK
;

54386 
rc
 = 
	`gëAndInôPage
(
pBt
, 
pCur
->
pgnoRoŸ
, &pCur->
≠Page
[0],

54387 
pCur
->
wrFœg
==0 ? 
PAGER_GET_READONLY
 : 0);

54388 if–
rc
!=
SQLITE_OK
 ){

54389 
pCur
->
eSèã
 = 
CURSOR_INVALID
;

54390  
rc
;

54392 
pCur
->
iPage
 = 0;

54398 
	`as£π
–
pCur
->
≠Page
[0]->
ötKey
==1 ||ÖCur->apPage[0]->intKey==0 );

54399 if–(
pCur
->
pKeyInfo
==0)!ıCur->
≠Page
[0]->
ötKey
 ){

54400  
SQLITE_CORRUPT_BKPT
;

54410 
pRoŸ
 = 
pCur
->
≠Page
[0];

54411 
	`as£π
–
pRoŸ
->
pgno
==
pCur
->
pgnoRoŸ
 );

54412 
	`as£π
–
pRoŸ
->
isInô
 && (
pCur
->
pKeyInfo
==0)=ıRoŸ->
ötKey
 );

54414 
pCur
->
aiIdx
[0] = 0;

54415 
pCur
->
öfo
.
nSize
 = 0;

54416 
pCur
->
©La°
 = 0;

54417 
pCur
->
vÆidNKey
 = 0;

54419 if–
pRoŸ
->
nCñl
==0 && !pRoŸ->
Àaf
 ){

54420 
Pgno
 
sub∑ge
;

54421 if–
pRoŸ
->
pgno
!=1 )  
SQLITE_CORRUPT_BKPT
;

54422 
sub∑ge
 = 
	`gë4byã
(&
pRoŸ
->
aD©a
[pRoŸ->
hdrOff£t
+8]);

54423 
pCur
->
eSèã
 = 
CURSOR_VALID
;

54424 
rc
 = 
	`moveToChûd
(
pCur
, 
sub∑ge
);

54426 
pCur
->
eSèã
 = ((
pRoŸ
->
nCñl
>0)?
CURSOR_VALID
:
CURSOR_INVALID
);

54428  
rc
;

54438 
	`moveToLe·mo°
(
BtCurs‹
 *
pCur
){

54439 
Pgno
 
pgno
;

54440 
rc
 = 
SQLITE_OK
;

54441 
MemPage
 *
pPage
;

54443 
	`as£π
–
	`curs‹HﬁdsMuãx
(
pCur
) );

54444 
	`as£π
–
pCur
->
eSèã
==
CURSOR_VALID
 );

54445  
rc
==
SQLITE_OK
 && !(
pPage
 = 
pCur
->
≠Page
[pCur->
iPage
])->
Àaf
 ){

54446 
	`as£π
–
pCur
->
aiIdx
[pCur->
iPage
]<
pPage
->
nCñl
 );

54447 
pgno
 = 
	`gë4byã
(
	`födCñl
(
pPage
, 
pCur
->
aiIdx
[pCur->
iPage
]));

54448 
rc
 = 
	`moveToChûd
(
pCur
, 
pgno
);

54450  
rc
;

54463 
	`moveToRightmo°
(
BtCurs‹
 *
pCur
){

54464 
Pgno
 
pgno
;

54465 
rc
 = 
SQLITE_OK
;

54466 
MemPage
 *
pPage
 = 0;

54468 
	`as£π
–
	`curs‹HﬁdsMuãx
(
pCur
) );

54469 
	`as£π
–
pCur
->
eSèã
==
CURSOR_VALID
 );

54470  
rc
==
SQLITE_OK
 && !(
pPage
 = 
pCur
->
≠Page
[pCur->
iPage
])->
Àaf
 ){

54471 
pgno
 = 
	`gë4byã
(&
pPage
->
aD©a
[pPage->
hdrOff£t
+8]);

54472 
pCur
->
aiIdx
[pCur->
iPage
] = 
pPage
->
nCñl
;

54473 
rc
 = 
	`moveToChûd
(
pCur
, 
pgno
);

54475 if–
rc
==
SQLITE_OK
 ){

54476 
pCur
->
aiIdx
[pCur->
iPage
] = 
pPage
->
nCñl
-1;

54477 
pCur
->
öfo
.
nSize
 = 0;

54478 
pCur
->
vÆidNKey
 = 0;

54480  
rc
;

54487 
SQLITE_PRIVATE
 
	`sqlôe3BåìFú°
(
BtCurs‹
 *
pCur
, *
pRes
){

54488 
rc
;

54490 
	`as£π
–
	`curs‹HﬁdsMuãx
(
pCur
) );

54491 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pCur
->
pBåì
->
db
->
muãx
) );

54492 
rc
 = 
	`moveToRoŸ
(
pCur
);

54493 if–
rc
==
SQLITE_OK
 ){

54494 if–
pCur
->
eSèã
==
CURSOR_INVALID
 ){

54495 
	`as£π
–
pCur
->
pgnoRoŸ
==0 ||ÖCur->
≠Page
[pCur->
iPage
]->
nCñl
==0 );

54496 *
pRes
 = 1;

54498 
	`as£π
–
pCur
->
≠Page
[pCur->
iPage
]->
nCñl
>0 );

54499 *
pRes
 = 0;

54500 
rc
 = 
	`moveToLe·mo°
(
pCur
);

54503  
rc
;

54510 
SQLITE_PRIVATE
 
	`sqlôe3BåìLa°
(
BtCurs‹
 *
pCur
, *
pRes
){

54511 
rc
;

54513 
	`as£π
–
	`curs‹HﬁdsMuãx
(
pCur
) );

54514 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pCur
->
pBåì
->
db
->
muãx
) );

54517 if–
CURSOR_VALID
==
pCur
->
eSèã
 &&ÖCur->
©La°
 ){

54518 #ifde‡
SQLITE_DEBUG


54521 
ii
;

54522 
ii
=0; ii<
pCur
->
iPage
; ii++){

54523 
	`as£π
–
pCur
->
aiIdx
[
ii
]=ıCur->
≠Page
[ii]->
nCñl
 );

54525 
	`as£π
–
pCur
->
aiIdx
[pCur->
iPage
]=ıCur->
≠Page
[pCur->iPage]->
nCñl
-1 );

54526 
	`as£π
–
pCur
->
≠Page
[pCur->
iPage
]->
Àaf
 );

54528  
SQLITE_OK
;

54531 
rc
 = 
	`moveToRoŸ
(
pCur
);

54532 if–
rc
==
SQLITE_OK
 ){

54533 if–
CURSOR_INVALID
==
pCur
->
eSèã
 ){

54534 
	`as£π
–
pCur
->
pgnoRoŸ
==0 ||ÖCur->
≠Page
[pCur->
iPage
]->
nCñl
==0 );

54535 *
pRes
 = 1;

54537 
	`as£π
–
pCur
->
eSèã
==
CURSOR_VALID
 );

54538 *
pRes
 = 0;

54539 
rc
 = 
	`moveToRightmo°
(
pCur
);

54540 
pCur
->
©La°
 = 
rc
==
SQLITE_OK
 ?1:0;

54543  
rc
;

54574 
SQLITE_PRIVATE
 
	`sqlôe3BåìMovëoU≈acked
(

54575 
BtCurs‹
 *
pCur
,

54576 
U≈ackedRec‹d
 *
pIdxKey
,

54577 
i64
 
ötKey
,

54578 
büsRight
,

54579 *
pRes


54581 
rc
;

54583 
	`as£π
–
	`curs‹HﬁdsMuãx
(
pCur
) );

54584 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pCur
->
pBåì
->
db
->
muãx
) );

54585 
	`as£π
–
pRes
 );

54586 
	`as£π
–(
pIdxKey
==0)==(
pCur
->
pKeyInfo
==0) );

54590 if–
pCur
->
eSèã
==
CURSOR_VALID
 &&ÖCur->
vÆidNKey


54591 && 
pCur
->
≠Page
[0]->
ötKey


54593 if–
pCur
->
öfo
.
nKey
==
ötKey
 ){

54594 *
pRes
 = 0;

54595  
SQLITE_OK
;

54597 if–
pCur
->
©La°
 &&ÖCur->
öfo
.
nKey
<
ötKey
 ){

54598 *
pRes
 = -1;

54599  
SQLITE_OK
;

54603 
rc
 = 
	`moveToRoŸ
(
pCur
);

54604 if–
rc
 ){

54605  
rc
;

54607 
	`as£π
–
pCur
->
pgnoRoŸ
==0 ||ÖCur->
≠Page
[pCur->
iPage
] );

54608 
	`as£π
–
pCur
->
pgnoRoŸ
==0 ||ÖCur->
≠Page
[pCur->
iPage
]->
isInô
 );

54609 
	`as£π
–
pCur
->
eSèã
==
CURSOR_INVALID
 ||ÖCur->
≠Page
[pCur->
iPage
]->
nCñl
>0 );

54610 if–
pCur
->
eSèã
==
CURSOR_INVALID
 ){

54611 *
pRes
 = -1;

54612 
	`as£π
–
pCur
->
pgnoRoŸ
==0 ||ÖCur->
≠Page
[pCur->
iPage
]->
nCñl
==0 );

54613  
SQLITE_OK
;

54615 
	`as£π
–
pCur
->
≠Page
[0]->
ötKey
 || 
pIdxKey
 );

54617 
lwr
, 
u¥
, 
idx
;

54618 
Pgno
 
chldPg
;

54619 
MemPage
 *
pPage
 = 
pCur
->
≠Page
[pCur->
iPage
];

54620 
c
;

54628 
	`as£π
–
pPage
->
nCñl
>0 );

54629 
	`as£π
–
pPage
->
ötKey
==(
pIdxKey
==0) );

54630 
lwr
 = 0;

54631 
u¥
 = 
pPage
->
nCñl
-1;

54632 if–
büsRight
 ){

54633 
pCur
->
aiIdx
[pCur->
iPage
] = (
u16
)(
idx
 = 
u¥
);

54635 
pCur
->
aiIdx
[pCur->
iPage
] = (
u16
)(
idx
 = (
u¥
+
lwr
)/2);

54638 
u8
 *
pCñl
;

54640 
	`as£π
–
idx
==
pCur
->
aiIdx
[pCur->
iPage
] );

54641 
pCur
->
öfo
.
nSize
 = 0;

54642 
pCñl
 = 
	`födCñl
(
pPage
, 
idx
Ë+ÖPage->
chûdPåSize
;

54643 if–
pPage
->
ötKey
 ){

54644 
i64
 
nCñlKey
;

54645 if–
pPage
->
hasD©a
 ){

54646 
u32
 
dummy
;

54647 
pCñl
 +
	`gëV¨öt32
’Cñl, 
dummy
);

54649 
	`gëV¨öt
(
pCñl
, (
u64
*)&
nCñlKey
);

54650 if–
nCñlKey
==
ötKey
 ){

54651 
c
 = 0;

54652 }if–
nCñlKey
<
ötKey
 ){

54653 
c
 = -1;

54655 
	`as£π
–
nCñlKey
>
ötKey
 );

54656 
c
 = +1;

54658 
pCur
->
vÆidNKey
 = 1;

54659 
pCur
->
öfo
.
nKey
 = 
nCñlKey
;

54669 
nCñl
 = 
pCñl
[0];

54670 if–
nCñl
<=
pPage
->
max1byãPaylﬂd


54676 
	`ã°ˇ£
–
pCñl
+
nCñl
+1==
pPage
->
aD©aEnd
 );

54677 
c
 = 
	`sqlôe3VdbeRec‹dCom∑ª
(
nCñl
, (*)&
pCñl
[1], 
pIdxKey
);

54678 }if–!(
pCñl
[1] & 0x80)

54679 && (
nCñl
 = (“Cñl&0x7f)<<7Ë+ 
pCñl
[1])<=
pPage
->
maxLoˇl


54684 
	`ã°ˇ£
–
pCñl
+
nCñl
+2==
pPage
->
aD©aEnd
 );

54685 
c
 = 
	`sqlôe3VdbeRec‹dCom∑ª
(
nCñl
, (*)&
pCñl
[2], 
pIdxKey
);

54691 *
pCñlKey
;

54692 
u8
 * c⁄° 
pCñlBody
 = 
pCñl
 - 
pPage
->
chûdPåSize
;

54693 
	`båìP¨£CñlPå
(
pPage
, 
pCñlBody
, &
pCur
->
öfo
);

54694 
nCñl
 = ()
pCur
->
öfo
.
nKey
;

54695 
pCñlKey
 = 
	`sqlôe3MÆloc
–
nCñl
 );

54696 if–
pCñlKey
==0 ){

54697 
rc
 = 
SQLITE_NOMEM
;

54698 
movëo_föish
;

54700 
rc
 = 
	`ac˚ssPaylﬂd
(
pCur
, 0, 
nCñl
, (*)
pCñlKey
, 0);

54701 if–
rc
 ){

54702 
	`sqlôe3_‰ì
(
pCñlKey
);

54703 
movëo_föish
;

54705 
c
 = 
	`sqlôe3VdbeRec‹dCom∑ª
(
nCñl
, 
pCñlKey
, 
pIdxKey
);

54706 
	`sqlôe3_‰ì
(
pCñlKey
);

54709 if–
c
==0 ){

54710 if–
pPage
->
ötKey
 && !pPage->
Àaf
 ){

54711 
lwr
 = 
idx
;

54714 *
pRes
 = 0;

54715 
rc
 = 
SQLITE_OK
;

54716 
movëo_föish
;

54719 if–
c
<0 ){

54720 
lwr
 = 
idx
+1;

54722 
u¥
 = 
idx
-1;

54724 if–
lwr
>
u¥
 ){

54727 
pCur
->
aiIdx
[pCur->
iPage
] = (
u16
)(
idx
 = (
lwr
+
u¥
)/2);

54729 
	`as£π
–
lwr
==
u¥
+1 || (
pPage
->
ötKey
 && !pPage->
Àaf
) );

54730 
	`as£π
–
pPage
->
isInô
 );

54731 if–
pPage
->
Àaf
 ){

54732 
chldPg
 = 0;

54733 }if–
lwr
>=
pPage
->
nCñl
 ){

54734 
chldPg
 = 
	`gë4byã
(&
pPage
->
aD©a
[pPage->
hdrOff£t
+8]);

54736 
chldPg
 = 
	`gë4byã
(
	`födCñl
(
pPage
, 
lwr
));

54738 if–
chldPg
==0 ){

54739 
	`as£π
–
pCur
->
aiIdx
[pCur->
iPage
]<pCur->
≠Page
[pCur->iPage]->
nCñl
 );

54740 *
pRes
 = 
c
;

54741 
rc
 = 
SQLITE_OK
;

54742 
movëo_föish
;

54744 
pCur
->
aiIdx
[pCur->
iPage
] = (
u16
)
lwr
;

54745 
pCur
->
öfo
.
nSize
 = 0;

54746 
pCur
->
vÆidNKey
 = 0;

54747 
rc
 = 
	`moveToChûd
(
pCur
, 
chldPg
);

54748 if–
rc
 ) 
movëo_föish
;

54750 
movëo_föish
:

54751  
rc
;

54762 
SQLITE_PRIVATE
 
	`sqlôe3BåìEof
(
BtCurs‹
 *
pCur
){

54767  (
CURSOR_VALID
!=
pCur
->
eSèã
);

54776 
SQLITE_PRIVATE
 
	`sqlôe3BåìNext
(
BtCurs‹
 *
pCur
, *
pRes
){

54777 
rc
;

54778 
idx
;

54779 
MemPage
 *
pPage
;

54781 
	`as£π
–
	`curs‹HﬁdsMuãx
(
pCur
) );

54782 
	`as£π
–
pRes
!=0 );

54783 
	`as£π
–
pCur
->
skùNext
==0 ||ÖCur->
eSèã
!=
CURSOR_VALID
 );

54784 if–
pCur
->
eSèã
!=
CURSOR_VALID
 ){

54785 
rc
 = 
	`ª°‹eCurs‹Posôi⁄
(
pCur
);

54786 if–
rc
!=
SQLITE_OK
 ){

54787 *
pRes
 = 0;

54788  
rc
;

54790 if–
CURSOR_INVALID
==
pCur
->
eSèã
 ){

54791 *
pRes
 = 1;

54792  
SQLITE_OK
;

54794 if–
pCur
->
skùNext
 ){

54795 
	`as£π
–
pCur
->
eSèã
==
CURSOR_VALID
 ||ÖCur->eSèã==
CURSOR_SKIPNEXT
 );

54796 
pCur
->
eSèã
 = 
CURSOR_VALID
;

54797 if–
pCur
->
skùNext
>0 ){

54798 
pCur
->
skùNext
 = 0;

54799 *
pRes
 = 0;

54800  
SQLITE_OK
;

54802 
pCur
->
skùNext
 = 0;

54806 
pPage
 = 
pCur
->
≠Page
[pCur->
iPage
];

54807 
idx
 = ++
pCur
->
aiIdx
[pCur->
iPage
];

54808 
	`as£π
–
pPage
->
isInô
 );

54815 
	`ã°ˇ£
–
idx
>
pPage
->
nCñl
 );

54817 
pCur
->
öfo
.
nSize
 = 0;

54818 
pCur
->
vÆidNKey
 = 0;

54819 if–
idx
>=
pPage
->
nCñl
 ){

54820 if–!
pPage
->
Àaf
 ){

54821 
rc
 = 
	`moveToChûd
(
pCur
, 
	`gë4byã
(&
pPage
->
aD©a
[pPage->
hdrOff£t
+8]));

54822 if–
rc
 ){

54823 *
pRes
 = 0;

54824  
rc
;

54826 
rc
 = 
	`moveToLe·mo°
(
pCur
);

54827 *
pRes
 = 0;

54828  
rc
;

54831 if–
pCur
->
iPage
==0 ){

54832 *
pRes
 = 1;

54833 
pCur
->
eSèã
 = 
CURSOR_INVALID
;

54834  
SQLITE_OK
;

54836 
	`moveToP¨ít
(
pCur
);

54837 
pPage
 = 
pCur
->
≠Page
[pCur->
iPage
];

54838 } 
pCur
->
aiIdx
[pCur->
iPage
]>=
pPage
->
nCñl
 );

54839 *
pRes
 = 0;

54840 if–
pPage
->
ötKey
 ){

54841 
rc
 = 
	`sqlôe3BåìNext
(
pCur
, 
pRes
);

54843 
rc
 = 
SQLITE_OK
;

54845  
rc
;

54847 *
pRes
 = 0;

54848 if–
pPage
->
Àaf
 ){

54849  
SQLITE_OK
;

54851 
rc
 = 
	`moveToLe·mo°
(
pCur
);

54852  
rc
;

54862 
SQLITE_PRIVATE
 
	`sqlôe3BåìPªvious
(
BtCurs‹
 *
pCur
, *
pRes
){

54863 
rc
;

54864 
MemPage
 *
pPage
;

54866 
	`as£π
–
	`curs‹HﬁdsMuãx
(
pCur
) );

54867 
	`as£π
–
pRes
!=0 );

54868 
	`as£π
–
pCur
->
skùNext
==0 ||ÖCur->
eSèã
!=
CURSOR_VALID
 );

54869 
pCur
->
©La°
 = 0;

54870 if–
pCur
->
eSèã
!=
CURSOR_VALID
 ){

54871 if–
	`ALWAYS
(
pCur
->
eSèã
>=
CURSOR_REQUIRESEEK
) ){

54872 
rc
 = 
	`båìRe°‹eCurs‹Posôi⁄
(
pCur
);

54873 if–
rc
!=
SQLITE_OK
 ){

54874 *
pRes
 = 0;

54875  
rc
;

54878 if–
CURSOR_INVALID
==
pCur
->
eSèã
 ){

54879 *
pRes
 = 1;

54880  
SQLITE_OK
;

54882 if–
pCur
->
skùNext
 ){

54883 
	`as£π
–
pCur
->
eSèã
==
CURSOR_VALID
 ||ÖCur->eSèã==
CURSOR_SKIPNEXT
 );

54884 
pCur
->
eSèã
 = 
CURSOR_VALID
;

54885 if–
pCur
->
skùNext
<0 ){

54886 
pCur
->
skùNext
 = 0;

54887 *
pRes
 = 0;

54888  
SQLITE_OK
;

54890 
pCur
->
skùNext
 = 0;

54894 
pPage
 = 
pCur
->
≠Page
[pCur->
iPage
];

54895 
	`as£π
–
pPage
->
isInô
 );

54896 if–!
pPage
->
Àaf
 ){

54897 
idx
 = 
pCur
->
aiIdx
[pCur->
iPage
];

54898 
rc
 = 
	`moveToChûd
(
pCur
, 
	`gë4byã
(
	`födCñl
(
pPage
, 
idx
)));

54899 if–
rc
 ){

54900 *
pRes
 = 0;

54901  
rc
;

54903 
rc
 = 
	`moveToRightmo°
(
pCur
);

54905  
pCur
->
aiIdx
[pCur->
iPage
]==0 ){

54906 if–
pCur
->
iPage
==0 ){

54907 
pCur
->
eSèã
 = 
CURSOR_INVALID
;

54908 *
pRes
 = 1;

54909  
SQLITE_OK
;

54911 
	`moveToP¨ít
(
pCur
);

54913 
pCur
->
öfo
.
nSize
 = 0;

54914 
pCur
->
vÆidNKey
 = 0;

54916 
pCur
->
aiIdx
[pCur->
iPage
]--;

54917 
pPage
 = 
pCur
->
≠Page
[pCur->
iPage
];

54918 if–
pPage
->
ötKey
 && !pPage->
Àaf
 ){

54919 
rc
 = 
	`sqlôe3BåìPªvious
(
pCur
, 
pRes
);

54921 
rc
 = 
SQLITE_OK
;

54924 *
pRes
 = 0;

54925  
rc
;

54951 
	`ÆloˇãBåìPage
(

54952 
BtSh¨ed
 *
pBt
,

54953 
MemPage
 **
µPage
,

54954 
Pgno
 *
pPgno
,

54955 
Pgno
 
√¨by
,

54956 
u8
 
eMode


54958 
MemPage
 *
pPage1
;

54959 
rc
;

54960 
u32
 
n
;

54961 
u32
 
k
;

54962 
MemPage
 *
pTrunk
 = 0;

54963 
MemPage
 *
pPªvTrunk
 = 0;

54964 
Pgno
 
mxPage
;

54966 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pBt
->
muãx
) );

54967 
	`as£π
–
eMode
==
BTALLOC_ANY
 || (
√¨by
>0 && 
	`IfNŸOmôAV
(
pBt
->
autoVacuum
)) );

54968 
pPage1
 = 
pBt
->pPage1;

54969 
mxPage
 = 
	`båìPagecou¡
(
pBt
);

54970 
n
 = 
	`gë4byã
(&
pPage1
->
aD©a
[36]);

54971 
	`ã°ˇ£
–
n
==
mxPage
-1 );

54972 if–
n
>=
mxPage
 ){

54973  
SQLITE_CORRUPT_BKPT
;

54975 if–
n
>0 ){

54977 
Pgno
 
iTrunk
;

54978 
u8
 
£¨chLi°
 = 0;

54984 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


54985 if–
eMode
==
BTALLOC_EXACT
 ){

54986 if–
√¨by
<=
mxPage
 ){

54987 
u8
 
eTy≥
;

54988 
	`as£π
–
√¨by
>0 );

54989 
	`as£π
–
pBt
->
autoVacuum
 );

54990 
rc
 = 
	`±rm≠Gë
(
pBt
, 
√¨by
, &
eTy≥
, 0);

54991 if–
rc
 ) Ñc;

54992 if–
eTy≥
==
PTRMAP_FREEPAGE
 ){

54993 
£¨chLi°
 = 1;

54996 }if–
eMode
==
BTALLOC_LE
 ){

54997 
£¨chLi°
 = 1;

55004 
rc
 = 
	`sqlôe3PagîWrôe
(
pPage1
->
pDbPage
);

55005 if–
rc
 ) Ñc;

55006 
	`put4byã
(&
pPage1
->
aD©a
[36], 
n
-1);

55014 
pPªvTrunk
 = 
pTrunk
;

55015 if–
pPªvTrunk
 ){

55016 
iTrunk
 = 
	`gë4byã
(&
pPªvTrunk
->
aD©a
[0]);

55018 
iTrunk
 = 
	`gë4byã
(&
pPage1
->
aD©a
[32]);

55020 
	`ã°ˇ£
–
iTrunk
==
mxPage
 );

55021 if–
iTrunk
>
mxPage
 ){

55022 
rc
 = 
SQLITE_CORRUPT_BKPT
;

55024 
rc
 = 
	`båìGëPage
(
pBt
, 
iTrunk
, &
pTrunk
, 0);

55026 if–
rc
 ){

55027 
pTrunk
 = 0;

55028 
íd_Æloˇã_∑ge
;

55030 
	`as£π
–
pTrunk
!=0 );

55031 
	`as£π
–
pTrunk
->
aD©a
!=0 );

55033 
k
 = 
	`gë4byã
(&
pTrunk
->
aD©a
[4]);

55034 if–
k
==0 && !
£¨chLi°
 ){

55038 
	`as£π
–
pPªvTrunk
==0 );

55039 
rc
 = 
	`sqlôe3PagîWrôe
(
pTrunk
->
pDbPage
);

55040 if–
rc
 ){

55041 
íd_Æloˇã_∑ge
;

55043 *
pPgno
 = 
iTrunk
;

55044 
	`mem˝y
(&
pPage1
->
aD©a
[32], &
pTrunk
->aData[0], 4);

55045 *
µPage
 = 
pTrunk
;

55046 
pTrunk
 = 0;

55047 
	`TRACE
(("ALLOCATE: %dÅrunk - %d fªê∑ge†À·\n", *
pPgno
, 
n
-1));

55048 }if–
k
>(
u32
)(
pBt
->
ußbÀSize
/4 - 2) ){

55050 
rc
 = 
SQLITE_CORRUPT_BKPT
;

55051 
íd_Æloˇã_∑ge
;

55052 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


55053 }if–
£¨chLi°


55054 && (
√¨by
==
iTrunk
 || (iTrunk<√¨by && 
eMode
==
BTALLOC_LE
))

55059 *
pPgno
 = 
iTrunk
;

55060 *
µPage
 = 
pTrunk
;

55061 
£¨chLi°
 = 0;

55062 
rc
 = 
	`sqlôe3PagîWrôe
(
pTrunk
->
pDbPage
);

55063 if–
rc
 ){

55064 
íd_Æloˇã_∑ge
;

55066 if–
k
==0 ){

55067 if–!
pPªvTrunk
 ){

55068 
	`mem˝y
(&
pPage1
->
aD©a
[32], &
pTrunk
->aData[0], 4);

55070 
rc
 = 
	`sqlôe3PagîWrôe
(
pPªvTrunk
->
pDbPage
);

55071 if–
rc
!=
SQLITE_OK
 ){

55072 
íd_Æloˇã_∑ge
;

55074 
	`mem˝y
(&
pPªvTrunk
->
aD©a
[0], &
pTrunk
->aData[0], 4);

55081 
MemPage
 *
pNewTrunk
;

55082 
Pgno
 
iNewTrunk
 = 
	`gë4byã
(&
pTrunk
->
aD©a
[8]);

55083 if–
iNewTrunk
>
mxPage
 ){

55084 
rc
 = 
SQLITE_CORRUPT_BKPT
;

55085 
íd_Æloˇã_∑ge
;

55087 
	`ã°ˇ£
–
iNewTrunk
==
mxPage
 );

55088 
rc
 = 
	`båìGëPage
(
pBt
, 
iNewTrunk
, &
pNewTrunk
, 0);

55089 if–
rc
!=
SQLITE_OK
 ){

55090 
íd_Æloˇã_∑ge
;

55092 
rc
 = 
	`sqlôe3PagîWrôe
(
pNewTrunk
->
pDbPage
);

55093 if–
rc
!=
SQLITE_OK
 ){

55094 
	`ªÀa£Page
(
pNewTrunk
);

55095 
íd_Æloˇã_∑ge
;

55097 
	`mem˝y
(&
pNewTrunk
->
aD©a
[0], &
pTrunk
->aData[0], 4);

55098 
	`put4byã
(&
pNewTrunk
->
aD©a
[4], 
k
-1);

55099 
	`mem˝y
(&
pNewTrunk
->
aD©a
[8], &
pTrunk
->aD©a[12], (
k
-1)*4);

55100 
	`ªÀa£Page
(
pNewTrunk
);

55101 if–!
pPªvTrunk
 ){

55102 
	`as£π
–
	`sqlôe3PagîIswrôóbÀ
(
pPage1
->
pDbPage
) );

55103 
	`put4byã
(&
pPage1
->
aD©a
[32], 
iNewTrunk
);

55105 
rc
 = 
	`sqlôe3PagîWrôe
(
pPªvTrunk
->
pDbPage
);

55106 if–
rc
 ){

55107 
íd_Æloˇã_∑ge
;

55109 
	`put4byã
(&
pPªvTrunk
->
aD©a
[0], 
iNewTrunk
);

55112 
pTrunk
 = 0;

55113 
	`TRACE
(("ALLOCATE: %dÅrunk - %d fªê∑ge†À·\n", *
pPgno
, 
n
-1));

55115 }if–
k
>0 ){

55117 
u32
 
˛o£°
;

55118 
Pgno
 
iPage
;

55119 *
aD©a
 = 
pTrunk
->aData;

55120 if–
√¨by
>0 ){

55121 
u32
 
i
;

55122 
˛o£°
 = 0;

55123 if–
eMode
==
BTALLOC_LE
 ){

55124 
i
=0; i<
k
; i++){

55125 
iPage
 = 
	`gë4byã
(&
aD©a
[8+
i
*4]);

55126 if–
iPage
<=
√¨by
 ){

55127 
˛o£°
 = 
i
;

55132 
di°
;

55133 
di°
 = 
	`sqlôe3AbsI¡32
(
	`gë4byã
(&
aD©a
[8]Ë- 
√¨by
);

55134 
i
=1; i<
k
; i++){

55135 
d2
 = 
	`sqlôe3AbsI¡32
(
	`gë4byã
(&
aD©a
[8+
i
*4]Ë- 
√¨by
);

55136 if–
d2
<
di°
 ){

55137 
˛o£°
 = 
i
;

55138 
di°
 = 
d2
;

55143 
˛o£°
 = 0;

55146 
iPage
 = 
	`gë4byã
(&
aD©a
[8+
˛o£°
*4]);

55147 
	`ã°ˇ£
–
iPage
==
mxPage
 );

55148 if–
iPage
>
mxPage
 ){

55149 
rc
 = 
SQLITE_CORRUPT_BKPT
;

55150 
íd_Æloˇã_∑ge
;

55152 
	`ã°ˇ£
–
iPage
==
mxPage
 );

55153 if–!
£¨chLi°


55154 || (
iPage
==
√¨by
 || (iPage<√¨by && 
eMode
==
BTALLOC_LE
))

55156 
noC⁄ã¡
;

55157 *
pPgno
 = 
iPage
;

55158 
	`TRACE
(("ALLOCATE: %d wasÜeaf %d of %d onÅrunk %d"

55160 *
pPgno
, 
˛o£°
+1, 
k
, 
pTrunk
->
pgno
, 
n
-1));

55161 
rc
 = 
	`sqlôe3PagîWrôe
(
pTrunk
->
pDbPage
);

55162 if–
rc
 ) 
íd_Æloˇã_∑ge
;

55163 if–
˛o£°
<
k
-1 ){

55164 
	`mem˝y
(&
aD©a
[8+
˛o£°
*4], &aD©a[4+
k
*4], 4);

55166 
	`put4byã
(&
aD©a
[4], 
k
-1);

55167 
noC⁄ã¡
 = !
	`båìGëHasC⁄ã¡
(
pBt
, *
pPgno
Ë? 
PAGER_GET_NOCONTENT
 : 0;

55168 
rc
 = 
	`båìGëPage
(
pBt
, *
pPgno
, 
µPage
, 
noC⁄ã¡
);

55169 if–
rc
==
SQLITE_OK
 ){

55170 
rc
 = 
	`sqlôe3PagîWrôe
((*
µPage
)->
pDbPage
);

55171 if–
rc
!=
SQLITE_OK
 ){

55172 
	`ªÀa£Page
(*
µPage
);

55175 
£¨chLi°
 = 0;

55178 
	`ªÀa£Page
(
pPªvTrunk
);

55179 
pPªvTrunk
 = 0;

55180 } 
£¨chLi°
 );

55200 
bNoC⁄ã¡
 = (0==
	`IfNŸOmôAV
(
pBt
->
bDoTrunˇã
)Ë? 
PAGER_GET_NOCONTENT
 : 0;

55202 
rc
 = 
	`sqlôe3PagîWrôe
(
pBt
->
pPage1
->
pDbPage
);

55203 if–
rc
 ) Ñc;

55204 
pBt
->
nPage
++;

55205 if–
pBt
->
nPage
==
	`PENDING_BYTE_PAGE
(pBt) )ÖBt->nPage++;

55207 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


55208 if–
pBt
->
autoVacuum
 && 
	`PTRMAP_ISPAGE
’Bt,ÖBt->
nPage
) ){

55213 
MemPage
 *
pPg
 = 0;

55214 
	`TRACE
(("ALLOCATE: %d fromÉnd o‡fûê’oöãr-m≠Öage)\n", 
pBt
->
nPage
));

55215 
	`as£π
–
pBt
->
nPage
!=
	`PENDING_BYTE_PAGE
(pBt) );

55216 
rc
 = 
	`båìGëPage
(
pBt
,ÖBt->
nPage
, &
pPg
, 
bNoC⁄ã¡
);

55217 if–
rc
==
SQLITE_OK
 ){

55218 
rc
 = 
	`sqlôe3PagîWrôe
(
pPg
->
pDbPage
);

55219 
	`ªÀa£Page
(
pPg
);

55221 if–
rc
 ) Ñc;

55222 
pBt
->
nPage
++;

55223 if–
pBt
->
nPage
==
	`PENDING_BYTE_PAGE
(pBt) ){ÖBt->nPage++; }

55226 
	`put4byã
(28 + (
u8
*)
pBt
->
pPage1
->
aD©a
,ÖBt->
nPage
);

55227 *
pPgno
 = 
pBt
->
nPage
;

55229 
	`as£π
–*
pPgno
!=
	`PENDING_BYTE_PAGE
(
pBt
) );

55230 
rc
 = 
	`båìGëPage
(
pBt
, *
pPgno
, 
µPage
, 
bNoC⁄ã¡
);

55231 if–
rc
 ) Ñc;

55232 
rc
 = 
	`sqlôe3PagîWrôe
((*
µPage
)->
pDbPage
);

55233 if–
rc
!=
SQLITE_OK
 ){

55234 
	`ªÀa£Page
(*
µPage
);

55236 
	`TRACE
(("ALLOCATE: %d fromÉnd o‡fûe\n", *
pPgno
));

55239 
	`as£π
–*
pPgno
!=
	`PENDING_BYTE_PAGE
(
pBt
) );

55241 
íd_Æloˇã_∑ge
:

55242 
	`ªÀa£Page
(
pTrunk
);

55243 
	`ªÀa£Page
(
pPªvTrunk
);

55244 if–
rc
==
SQLITE_OK
 ){

55245 if–
	`sqlôe3PagîPageRefcou¡
((*
µPage
)->
pDbPage
)>1 ){

55246 
	`ªÀa£Page
(*
µPage
);

55247  
SQLITE_CORRUPT_BKPT
;

55249 (*
µPage
)->
isInô
 = 0;

55251 *
µPage
 = 0;

55253 
	`as£π
–
rc
!=
SQLITE_OK
 || 
	`sqlôe3PagîIswrôóbÀ
((*
µPage
)->
pDbPage
) );

55254  
rc
;

55269 
	`‰ìPage2
(
BtSh¨ed
 *
pBt
, 
MemPage
 *
pMemPage
, 
Pgno
 
iPage
){

55270 
MemPage
 *
pTrunk
 = 0;

55271 
Pgno
 
iTrunk
 = 0;

55272 
MemPage
 *
pPage1
 = 
pBt
->pPage1;

55273 
MemPage
 *
pPage
;

55274 
rc
;

55275 
nFªe
;

55277 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pBt
->
muãx
) );

55278 
	`as£π
–
iPage
>1 );

55279 
	`as£π
–!
pMemPage
 ||ÖMemPage->
pgno
==
iPage
 );

55281 if–
pMemPage
 ){

55282 
pPage
 = 
pMemPage
;

55283 
	`sqlôe3PagîRef
(
pPage
->
pDbPage
);

55285 
pPage
 = 
	`båìPageLookup
(
pBt
, 
iPage
);

55289 
rc
 = 
	`sqlôe3PagîWrôe
(
pPage1
->
pDbPage
);

55290 if–
rc
 ) 
‰ì∑ge_out
;

55291 
nFªe
 = 
	`gë4byã
(&
pPage1
->
aD©a
[36]);

55292 
	`put4byã
(&
pPage1
->
aD©a
[36], 
nFªe
+1);

55294 if–
pBt
->
btsFœgs
 & 
BTS_SECURE_DELETE
 ){

55298 if–(!
pPage
 && ((
rc
 = 
	`båìGëPage
(
pBt
, 
iPage
, &pPage, 0))!=0) )

55299 || ((
rc
 = 
	`sqlôe3PagîWrôe
(
pPage
->
pDbPage
))!=0)

55301 
‰ì∑ge_out
;

55303 
	`mem£t
(
pPage
->
aD©a
, 0,ÖPage->
pBt
->
∑geSize
);

55309 if–
ISAUTOVACUUM
 ){

55310 
	`±rm≠Put
(
pBt
, 
iPage
, 
PTRMAP_FREEPAGE
, 0, &
rc
);

55311 if–
rc
 ) 
‰ì∑ge_out
;

55321 if–
nFªe
!=0 ){

55322 
u32
 
nLóf
;

55324 
iTrunk
 = 
	`gë4byã
(&
pPage1
->
aD©a
[32]);

55325 
rc
 = 
	`båìGëPage
(
pBt
, 
iTrunk
, &
pTrunk
, 0);

55326 if–
rc
!=
SQLITE_OK
 ){

55327 
‰ì∑ge_out
;

55330 
nLóf
 = 
	`gë4byã
(&
pTrunk
->
aD©a
[4]);

55331 
	`as£π
–
pBt
->
ußbÀSize
>32 );

55332 if–
nLóf
 > (
u32
)
pBt
->
ußbÀSize
/4 - 2 ){

55333 
rc
 = 
SQLITE_CORRUPT_BKPT
;

55334 
‰ì∑ge_out
;

55336 if–
nLóf
 < (
u32
)
pBt
->
ußbÀSize
/4 - 8 ){

55351 
rc
 = 
	`sqlôe3PagîWrôe
(
pTrunk
->
pDbPage
);

55352 if–
rc
==
SQLITE_OK
 ){

55353 
	`put4byã
(&
pTrunk
->
aD©a
[4], 
nLóf
+1);

55354 
	`put4byã
(&
pTrunk
->
aD©a
[8+
nLóf
*4], 
iPage
);

55355 if–
pPage
 && (
pBt
->
btsFœgs
 & 
BTS_SECURE_DELETE
)==0 ){

55356 
	`sqlôe3PagîD⁄tWrôe
(
pPage
->
pDbPage
);

55358 
rc
 = 
	`båìSëHasC⁄ã¡
(
pBt
, 
iPage
);

55360 
	`TRACE
(("FREE-PAGE: %dÜó‡⁄ÅrunkÖagê%d\n",
pPage
->
pgno
,
pTrunk
->pgno));

55361 
‰ì∑ge_out
;

55371 if–
pPage
==0 && 
SQLITE_OK
!=(
rc
 = 
	`båìGëPage
(
pBt
, 
iPage
, &pPage, 0)) ){

55372 
‰ì∑ge_out
;

55374 
rc
 = 
	`sqlôe3PagîWrôe
(
pPage
->
pDbPage
);

55375 if–
rc
!=
SQLITE_OK
 ){

55376 
‰ì∑ge_out
;

55378 
	`put4byã
(
pPage
->
aD©a
, 
iTrunk
);

55379 
	`put4byã
(&
pPage
->
aD©a
[4], 0);

55380 
	`put4byã
(&
pPage1
->
aD©a
[32], 
iPage
);

55381 
	`TRACE
(("FREE-PAGE: %dÇewÅrunkÖagêª∂acög %d\n", 
pPage
->
pgno
, 
iTrunk
));

55383 
‰ì∑ge_out
:

55384 if–
pPage
 ){

55385 
pPage
->
isInô
 = 0;

55387 
	`ªÀa£Page
(
pPage
);

55388 
	`ªÀa£Page
(
pTrunk
);

55389  
rc
;

55391 
	`‰ìPage
(
MemPage
 *
pPage
, *
pRC
){

55392 if–(*
pRC
)==
SQLITE_OK
 ){

55393 *
pRC
 = 
	`‰ìPage2
(
pPage
->
pBt
,ÖPage,ÖPage->
pgno
);

55400 
	`˛órCñl
(
MemPage
 *
pPage
, *
pCñl
){

55401 
BtSh¨ed
 *
pBt
 = 
pPage
->pBt;

55402 
CñlInfo
 
öfo
;

55403 
Pgno
 
ovÊPgno
;

55404 
rc
;

55405 
nOvÊ
;

55406 
u32
 
ovÊPageSize
;

55408 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pPage
->
pBt
->
muãx
) );

55409 
	`båìP¨£CñlPå
(
pPage
, 
pCñl
, &
öfo
);

55410 if–
öfo
.
iOvîÊow
==0 ){

55411  
SQLITE_OK
;

55413 if–
pCñl
+
öfo
.
iOvîÊow
+3 > 
pPage
->
aD©a
+pPage->
maskPage
 ){

55414  
SQLITE_CORRUPT_BKPT
;

55416 
ovÊPgno
 = 
	`gë4byã
(&
pCñl
[
öfo
.
iOvîÊow
]);

55417 
	`as£π
–
pBt
->
ußbÀSize
 > 4 );

55418 
ovÊPageSize
 = 
pBt
->
ußbÀSize
 - 4;

55419 
nOvÊ
 = (
öfo
.
nPaylﬂd
 - info.
nLoˇl
 + 
ovÊPageSize
 - 1)/ovflPageSize;

55420 
	`as£π
–
ovÊPgno
==0 || 
nOvÊ
>0 );

55421  
nOvÊ
-- ){

55422 
Pgno
 
iNext
 = 0;

55423 
MemPage
 *
pOvÊ
 = 0;

55424 if–
ovÊPgno
<2 || ovÊPgno>
	`båìPagecou¡
(
pBt
) ){

55428  
SQLITE_CORRUPT_BKPT
;

55430 if–
nOvÊ
 ){

55431 
rc
 = 
	`gëOvîÊowPage
(
pBt
, 
ovÊPgno
, &
pOvÊ
, &
iNext
);

55432 if–
rc
 ) Ñc;

55435 if––
pOvÊ
 || (’OvÊ = 
	`båìPageLookup
(
pBt
, 
ovÊPgno
))!=0) )

55436 && 
	`sqlôe3PagîPageRefcou¡
(
pOvÊ
->
pDbPage
)!=1

55448 
rc
 = 
SQLITE_CORRUPT_BKPT
;

55450 
rc
 = 
	`‰ìPage2
(
pBt
, 
pOvÊ
, 
ovÊPgno
);

55453 if–
pOvÊ
 ){

55454 
	`sqlôe3PagîUƒef
(
pOvÊ
->
pDbPage
);

55456 if–
rc
 ) Ñc;

55457 
ovÊPgno
 = 
iNext
;

55459  
SQLITE_OK
;

55474 
	`fûlInCñl
(

55475 
MemPage
 *
pPage
,

55476 *
pCñl
,

55477 c⁄° *
pKey
, 
i64
 
nKey
,

55478 c⁄° *
pD©a
,
nD©a
,

55479 
nZîo
,

55480 *
≤Size


55482 
nPaylﬂd
;

55483 c⁄° 
u8
 *
pSrc
;

55484 
nSrc
, 
n
, 
rc
;

55485 
•a˚Le·
;

55486 
MemPage
 *
pOvÊ
 = 0;

55487 
MemPage
 *
pToRñó£
 = 0;

55488 *
pPri‹
;

55489 *
pPaylﬂd
;

55490 
BtSh¨ed
 *
pBt
 = 
pPage
->pBt;

55491 
Pgno
 
pgnoOvÊ
 = 0;

55492 
nHódî
;

55493 
CñlInfo
 
öfo
;

55495 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pPage
->
pBt
->
muãx
) );

55499 
	`as£π
–
pCñl
<
pPage
->
aD©a
 ||ÖCñl>=&pPage->aD©a[
pBt
->
∑geSize
]

55500 || 
	`sqlôe3PagîIswrôóbÀ
(
pPage
->
pDbPage
) );

55503 
nHódî
 = 0;

55504 if–!
pPage
->
Àaf
 ){

55505 
nHódî
 += 4;

55507 if–
pPage
->
hasD©a
 ){

55508 
nHódî
 +
	`putV¨öt
(&
pCñl
[nHódî], 
nD©a
+
nZîo
);

55510 
nD©a
 = 
nZîo
 = 0;

55512 
nHódî
 +
	`putV¨öt
(&
pCñl
[nHódî], *(
u64
*)&
nKey
);

55513 
	`båìP¨£CñlPå
(
pPage
, 
pCñl
, &
öfo
);

55514 
	`as£π
–
öfo
.
nHódî
==nHeader );

55515 
	`as£π
–
öfo
.
nKey
==nKey );

55516 
	`as£π
–
öfo
.
nD©a
==(
u32
)“D©a+
nZîo
) );

55519 
nPaylﬂd
 = 
nD©a
 + 
nZîo
;

55520 if–
pPage
->
ötKey
 ){

55521 
pSrc
 = 
pD©a
;

55522 
nSrc
 = 
nD©a
;

55523 
nD©a
 = 0;

55525 if–
	`NEVER
(
nKey
>0x7ffffff‡|| 
pKey
==0) ){

55526  
SQLITE_CORRUPT_BKPT
;

55528 
nPaylﬂd
 +()
nKey
;

55529 
pSrc
 = 
pKey
;

55530 
nSrc
 = ()
nKey
;

55532 *
≤Size
 = 
öfo
.
nSize
;

55533 
•a˚Le·
 = 
öfo
.
nLoˇl
;

55534 
pPaylﬂd
 = &
pCñl
[
nHódî
];

55535 
pPri‹
 = &
pCñl
[
öfo
.
iOvîÊow
];

55537  
nPaylﬂd
>0 ){

55538 if–
•a˚Le·
==0 ){

55539 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


55540 
Pgno
 
pgnoPåm≠
 = 
pgnoOvÊ
;

55541 if–
pBt
->
autoVacuum
 ){

55543 
pgnoOvÊ
++;

55545 
	`PTRMAP_ISPAGE
(
pBt
, 
pgnoOvÊ
Ë||ÖgnoOvÊ==
	`PENDING_BYTE_PAGE
(pBt)

55549 
rc
 = 
	`ÆloˇãBåìPage
(
pBt
, &
pOvÊ
, &
pgnoOvÊ
,ÖgnoOvfl, 0);

55550 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


55561 if–
pBt
->
autoVacuum
 && 
rc
==
SQLITE_OK
 ){

55562 
u8
 
eTy≥
 = (
pgnoPåm≠
?
PTRMAP_OVERFLOW2
:
PTRMAP_OVERFLOW1
);

55563 
	`±rm≠Put
(
pBt
, 
pgnoOvÊ
, 
eTy≥
, 
pgnoPåm≠
, &
rc
);

55564 if–
rc
 ){

55565 
	`ªÀa£Page
(
pOvÊ
);

55569 if–
rc
 ){

55570 
	`ªÀa£Page
(
pToRñó£
);

55571  
rc
;

55576 
	`as£π
–
pToRñó£
==0 || 
	`sqlôe3PagîIswrôóbÀ
’ToRñó£->
pDbPage
) );

55580 
	`as£π
–
pPri‹
<
pPage
->
aD©a
 ||ÖPri‹>=&pPage->aD©a[
pBt
->
∑geSize
]

55581 || 
	`sqlôe3PagîIswrôóbÀ
(
pPage
->
pDbPage
) );

55583 
	`put4byã
(
pPri‹
, 
pgnoOvÊ
);

55584 
	`ªÀa£Page
(
pToRñó£
);

55585 
pToRñó£
 = 
pOvÊ
;

55586 
pPri‹
 = 
pOvÊ
->
aD©a
;

55587 
	`put4byã
(
pPri‹
, 0);

55588 
pPaylﬂd
 = &
pOvÊ
->
aD©a
[4];

55589 
•a˚Le·
 = 
pBt
->
ußbÀSize
 - 4;

55591 
n
 = 
nPaylﬂd
;

55592 if–
n
>
•a˚Le·
 )Ç = spaceLeft;

55596 
	`as£π
–
pToRñó£
==0 || 
	`sqlôe3PagîIswrôóbÀ
’ToRñó£->
pDbPage
) );

55600 
	`as£π
–
pPaylﬂd
<
pPage
->
aD©a
 ||ÖPaylﬂd>=&pPage->aD©a[
pBt
->
∑geSize
]

55601 || 
	`sqlôe3PagîIswrôóbÀ
(
pPage
->
pDbPage
) );

55603 if–
nSrc
>0 ){

55604 if–
n
>
nSrc
 )Ç =ÇSrc;

55605 
	`as£π
–
pSrc
 );

55606 
	`mem˝y
(
pPaylﬂd
, 
pSrc
, 
n
);

55608 
	`mem£t
(
pPaylﬂd
, 0, 
n
);

55610 
nPaylﬂd
 -
n
;

55611 
pPaylﬂd
 +
n
;

55612 
pSrc
 +
n
;

55613 
nSrc
 -
n
;

55614 
•a˚Le·
 -
n
;

55615 if–
nSrc
==0 ){

55616 
nSrc
 = 
nD©a
;

55617 
pSrc
 = 
pD©a
;

55620 
	`ªÀa£Page
(
pToRñó£
);

55621  
SQLITE_OK
;

55632 
	`dr›Cñl
(
MemPage
 *
pPage
, 
idx
, 
sz
, *
pRC
){

55633 
u32
 
pc
;

55634 
u8
 *
d©a
;

55635 
u8
 *
±r
;

55636 
u8
 *
ídPå
;

55637 
rc
;

55638 
hdr
;

55640 if–*
pRC
 ) ;

55642 
	`as£π
–
idx
>=0 && idx<
pPage
->
nCñl
 );

55643 
	`as£π
–
sz
==
	`˚ŒSize
(
pPage
, 
idx
) );

55644 
	`as£π
–
	`sqlôe3PagîIswrôóbÀ
(
pPage
->
pDbPage
) );

55645 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pPage
->
pBt
->
muãx
) );

55646 
d©a
 = 
pPage
->
aD©a
;

55647 
±r
 = &
pPage
->
aCñlIdx
[2*
idx
];

55648 
pc
 = 
	`gë2byã
(
±r
);

55649 
hdr
 = 
pPage
->
hdrOff£t
;

55650 
	`ã°ˇ£
–
pc
==
	`gë2byã
(&
d©a
[
hdr
+5]) );

55651 
	`ã°ˇ£
–
pc
+
sz
==
pPage
->
pBt
->
ußbÀSize
 );

55652 if–
pc
 < (
u32
)
	`gë2byã
(&
d©a
[
hdr
+5]Ë||Öc+
sz
 > 
pPage
->
pBt
->
ußbÀSize
 ){

55653 *
pRC
 = 
SQLITE_CORRUPT_BKPT
;

55656 
rc
 = 
	`‰ìS∑˚
(
pPage
, 
pc
, 
sz
);

55657 if–
rc
 ){

55658 *
pRC
 = 
rc
;

55661 
ídPå
 = &
pPage
->
aCñlIdx
[2*pPage->
nCñl
 - 2];

55662 
	`as£π
–(
	`SQLITE_PTR_TO_INT
(
±r
)&1)==0 );

55663  
±r
<
ídPå
 ){

55664 *(
u16
*)
±r
 = *(u16*)&ptr[2];

55665 
±r
 += 2;

55667 
pPage
->
nCñl
--;

55668 
	`put2byã
(&
d©a
[
hdr
+3], 
pPage
->
nCñl
);

55669 
pPage
->
nFªe
 += 2;

55689 
	`ö£πCñl
(

55690 
MemPage
 *
pPage
,

55691 
i
,

55692 
u8
 *
pCñl
,

55693 
sz
,

55694 
u8
 *
pTemp
,

55695 
Pgno
 
iChûd
,

55696 *
pRC


55698 
idx
 = 0;

55699 
j
;

55700 
íd
;

55701 
ös
;

55702 
˚ŒOff£t
;

55703 
u8
 *
d©a
;

55704 
u8
 *
±r
;

55705 
u8
 *
ídPå
;

55707 
nSkù
 = (
iChûd
 ? 4 : 0);

55709 if–*
pRC
 ) ;

55711 
	`as£π
–
i
>=0 && i<=
pPage
->
nCñl
+pPage->
nOvîÊow
 );

55712 
	`as£π
–
pPage
->
nCñl
<=
	`MX_CELL
’Page->
pBt
) && MX_CELL(pPage->pBt)<=10921 );

55713 
	`as£π
–
pPage
->
nOvîÊow
<=
	`AºaySize
’Page->
≠OvÊ
) );

55714 
	`as£π
–
	`AºaySize
(
pPage
->
≠OvÊ
)==AºaySize’Page->
aiOvÊ
) );

55715 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pPage
->
pBt
->
muãx
) );

55721 
	`as£π
–
sz
==
	`˚ŒSizePå
(
pPage
, 
pCñl
Ë|| (sz==8 && 
iChûd
>0) );

55722 if–
pPage
->
nOvîÊow
 || 
sz
+2>pPage->
nFªe
 ){

55723 if–
pTemp
 ){

55724 
	`mem˝y
(
pTemp
+
nSkù
, 
pCñl
+nSkù, 
sz
-nSkip);

55725 
pCñl
 = 
pTemp
;

55727 if–
iChûd
 ){

55728 
	`put4byã
(
pCñl
, 
iChûd
);

55730 
j
 = 
pPage
->
nOvîÊow
++;

55731 
	`as£π
–
j
<()((
pPage
->
≠OvÊ
)/(pPage->apOvfl[0])) );

55732 
pPage
->
≠OvÊ
[
j
] = 
pCñl
;

55733 
pPage
->
aiOvÊ
[
j
] = (
u16
)
i
;

55735 
rc
 = 
	`sqlôe3PagîWrôe
(
pPage
->
pDbPage
);

55736 if–
rc
!=
SQLITE_OK
 ){

55737 *
pRC
 = 
rc
;

55740 
	`as£π
–
	`sqlôe3PagîIswrôóbÀ
(
pPage
->
pDbPage
) );

55741 
d©a
 = 
pPage
->
aD©a
;

55742 
˚ŒOff£t
 = 
pPage
->cellOffset;

55743 
íd
 = 
˚ŒOff£t
 + 2*
pPage
->
nCñl
;

55744 
ös
 = 
˚ŒOff£t
 + 2*
i
;

55745 
rc
 = 
	`ÆloˇãS∑˚
(
pPage
, 
sz
, &
idx
);

55746 if–
rc
 ){ *
pRC
 =Ñc; ; }

55749 
	`as£π
–
idx
 >
íd
+2 );

55750 
	`as£π
–
idx
+
sz
 <()
pPage
->
pBt
->
ußbÀSize
 );

55751 
pPage
->
nCñl
++;

55752 
pPage
->
nFªe
 -(
u16
)(2 + 
sz
);

55753 
	`mem˝y
(&
d©a
[
idx
+
nSkù
], 
pCñl
+nSkù, 
sz
-nSkip);

55754 if–
iChûd
 ){

55755 
	`put4byã
(&
d©a
[
idx
], 
iChûd
);

55757 
±r
 = &
d©a
[
íd
];

55758 
ídPå
 = &
d©a
[
ös
];

55759 
	`as£π
–(
	`SQLITE_PTR_TO_INT
(
±r
)&1)==0 );

55760  
±r
>
ídPå
 ){

55761 *(
u16
*)
±r
 = *(u16*)&ptr[-2];

55762 
±r
 -= 2;

55764 
	`put2byã
(&
d©a
[
ös
], 
idx
);

55765 
	`put2byã
(&
d©a
[
pPage
->
hdrOff£t
+3],ÖPage->
nCñl
);

55766 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


55767 if–
pPage
->
pBt
->
autoVacuum
 ){

55771 
	`±rm≠PutOvÊPå
(
pPage
, 
pCñl
, 
pRC
);

55781 
	`as£mbÀPage
(

55782 
MemPage
 *
pPage
,

55783 
nCñl
,

55784 
u8
 **
≠Cñl
,

55785 
u16
 *
aSize


55787 
i
;

55788 
u8
 *
pCñÕå
;

55789 
˚Œbody
;

55790 
u8
 * c⁄° 
d©a
 = 
pPage
->
aD©a
;

55791 c⁄° 
hdr
 = 
pPage
->
hdrOff£t
;

55792 c⁄° 
nUßbÀ
 = 
pPage
->
pBt
->
ußbÀSize
;

55794 
	`as£π
–
pPage
->
nOvîÊow
==0 );

55795 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pPage
->
pBt
->
muãx
) );

55796 
	`as£π
–
nCñl
>=0 &&ÇCñl<=()
	`MX_CELL
(
pPage
->
pBt
)

55797 && ()
	`MX_CELL
(
pPage
->
pBt
)<=10921);

55798 
	`as£π
–
	`sqlôe3PagîIswrôóbÀ
(
pPage
->
pDbPage
) );

55801 
	`as£π
–
pPage
->
nCñl
==0 );

55802 
	`as£π
–
	`gë2byãNŸZîo
(&
d©a
[
hdr
+5])==
nUßbÀ
 );

55804 
pCñÕå
 = &
pPage
->
aCñlIdx
[
nCñl
*2];

55805 
˚Œbody
 = 
nUßbÀ
;

55806 
i
=
nCñl
-1; i>=0; i--){

55807 
u16
 
sz
 = 
aSize
[
i
];

55808 
pCñÕå
 -= 2;

55809 
˚Œbody
 -
sz
;

55810 
	`put2byã
(
pCñÕå
, 
˚Œbody
);

55811 
	`mem˝y
(&
d©a
[
˚Œbody
], 
≠Cñl
[
i
], 
sz
);

55813 
	`put2byã
(&
d©a
[
hdr
+3], 
nCñl
);

55814 
	`put2byã
(&
d©a
[
hdr
+5], 
˚Œbody
);

55815 
pPage
->
nFªe
 -(
nCñl
*2 + 
nUßbÀ
 - 
˚Œbody
);

55816 
pPage
->
nCñl
 = (
u16
)nCell;

55831 
	#NN
 1

	)

55832 
	#NB
 (
NN
*2+1Ë

	)

55835 #i‚de‡
SQLITE_OMIT_QUICKBALANCE


55859 
	`bÆ™˚_quick
(
MemPage
 *
pP¨ít
, MemPagê*
pPage
, 
u8
 *
pS∑˚
){

55860 
BtSh¨ed
 *c⁄° 
pBt
 = 
pPage
->pBt;

55861 
MemPage
 *
pNew
;

55862 
rc
;

55863 
Pgno
 
pgnoNew
;

55865 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pPage
->
pBt
->
muãx
) );

55866 
	`as£π
–
	`sqlôe3PagîIswrôóbÀ
(
pP¨ít
->
pDbPage
) );

55867 
	`as£π
–
pPage
->
nOvîÊow
==1 );

55870 if–
pPage
->
nCñl
==0 )  
SQLITE_CORRUPT_BKPT
;

55876 
rc
 = 
	`ÆloˇãBåìPage
(
pBt
, &
pNew
, &
pgnoNew
, 0, 0);

55878 if–
rc
==
SQLITE_OK
 ){

55880 
u8
 *
pOut
 = &
pS∑˚
[4];

55881 
u8
 *
pCñl
 = 
pPage
->
≠OvÊ
[0];

55882 
u16
 
szCñl
 = 
	`˚ŒSizePå
(
pPage
, 
pCñl
);

55883 
u8
 *
pSt›
;

55885 
	`as£π
–
	`sqlôe3PagîIswrôóbÀ
(
pNew
->
pDbPage
) );

55886 
	`as£π
–
pPage
->
aD©a
[0]==(
PTF_INTKEY
|
PTF_LEAFDATA
|
PTF_LEAF
) );

55887 
	`zîoPage
(
pNew
, 
PTF_INTKEY
|
PTF_LEAFDATA
|
PTF_LEAF
);

55888 
	`as£mbÀPage
(
pNew
, 1, &
pCñl
, &
szCñl
);

55899 if–
ISAUTOVACUUM
 ){

55900 
	`±rm≠Put
(
pBt
, 
pgnoNew
, 
PTRMAP_BTREE
, 
pP¨ít
->
pgno
, &
rc
);

55901 if–
szCñl
>
pNew
->
möLoˇl
 ){

55902 
	`±rm≠PutOvÊPå
(
pNew
, 
pCñl
, &
rc
);

55919 
pCñl
 = 
	`födCñl
(
pPage
,ÖPage->
nCñl
-1);

55920 
pSt›
 = &
pCñl
[9];

55921  (*(
pCñl
++)&0x80Ë&&ÖCñl<
pSt›
 );

55922 
pSt›
 = &
pCñl
[9];

55923  ((*(
pOut
++Ë*(
pCñl
++))&0x80Ë&&ÖCñl<
pSt›
 );

55926 
	`ö£πCñl
(
pP¨ít
,ÖP¨ít->
nCñl
, 
pS∑˚
, ()(
pOut
-pSpace),

55927 0, 
pPage
->
pgno
, &
rc
);

55930 
	`put4byã
(&
pP¨ít
->
aD©a
[pP¨ít->
hdrOff£t
+8], 
pgnoNew
);

55933 
	`ªÀa£Page
(
pNew
);

55936  
rc
;

55946 
	`±rm≠CheckPages
(
MemPage
 **
≠Page
, 
nPage
){

55947 
i
, 
j
;

55948 
i
=0; i<
nPage
; i++){

55949 
Pgno
 
n
;

55950 
u8
 
e
;

55951 
MemPage
 *
pPage
 = 
≠Page
[
i
];

55952 
BtSh¨ed
 *
pBt
 = 
pPage
->pBt;

55953 
	`as£π
–
pPage
->
isInô
 );

55955 
j
=0; j<
pPage
->
nCñl
; j++){

55956 
CñlInfo
 
öfo
;

55957 
u8
 *
z
;

55959 
z
 = 
	`födCñl
(
pPage
, 
j
);

55960 
	`båìP¨£CñlPå
(
pPage
, 
z
, &
öfo
);

55961 if–
öfo
.
iOvîÊow
 ){

55962 
Pgno
 
ovÊ
 = 
	`gë4byã
(&
z
[
öfo
.
iOvîÊow
]);

55963 
	`±rm≠Gë
(
pBt
, 
ovÊ
, &
e
, &
n
);

55964 
	`as£π
–
n
==
pPage
->
pgno
 && 
e
==
PTRMAP_OVERFLOW1
 );

55966 if–!
pPage
->
Àaf
 ){

55967 
Pgno
 
chûd
 = 
	`gë4byã
(
z
);

55968 
	`±rm≠Gë
(
pBt
, 
chûd
, &
e
, &
n
);

55969 
	`as£π
–
n
==
pPage
->
pgno
 && 
e
==
PTRMAP_BTREE
 );

55972 if–!
pPage
->
Àaf
 ){

55973 
Pgno
 
chûd
 = 
	`gë4byã
(&
pPage
->
aD©a
[pPage->
hdrOff£t
+8]);

55974 
	`±rm≠Gë
(
pBt
, 
chûd
, &
e
, &
n
);

55975 
	`as£π
–
n
==
pPage
->
pgno
 && 
e
==
PTRMAP_BTREE
 );

55999 
	`c›yNodeC⁄ã¡
(
MemPage
 *
pFrom
, MemPagê*
pTo
, *
pRC
){

56000 if–(*
pRC
)==
SQLITE_OK
 ){

56001 
BtSh¨ed
 * c⁄° 
pBt
 = 
pFrom
->pBt;

56002 
u8
 * c⁄° 
aFrom
 = 
pFrom
->
aD©a
;

56003 
u8
 * c⁄° 
aTo
 = 
pTo
->
aD©a
;

56004 c⁄° 
iFromHdr
 = 
pFrom
->
hdrOff£t
;

56005 c⁄° 
iToHdr
 = ((
pTo
->
pgno
==1) ? 100 : 0);

56006 
rc
;

56007 
iD©a
;

56010 
	`as£π
–
pFrom
->
isInô
 );

56011 
	`as£π
–
pFrom
->
nFªe
>=
iToHdr
 );

56012 
	`as£π
–
	`gë2byã
(&
aFrom
[
iFromHdr
+5]Ë<()
pBt
->
ußbÀSize
 );

56015 
iD©a
 = 
	`gë2byã
(&
aFrom
[
iFromHdr
+5]);

56016 
	`mem˝y
(&
aTo
[
iD©a
], &
aFrom
[iD©a], 
pBt
->
ußbÀSize
-iData);

56017 
	`mem˝y
(&
aTo
[
iToHdr
], &
aFrom
[
iFromHdr
], 
pFrom
->
˚ŒOff£t
 + 2*pFrom->
nCñl
);

56024 
pTo
->
isInô
 = 0;

56025 
rc
 = 
	`båìInôPage
(
pTo
);

56026 if–
rc
!=
SQLITE_OK
 ){

56027 *
pRC
 = 
rc
;

56034 if–
ISAUTOVACUUM
 ){

56035 *
pRC
 = 
	`£tChûdPåm≠s
(
pTo
);

56080 #i‡
	`deföed
(
_MSC_VER
Ë&& _MSC_VER >1700 && deföed(
_M_ARM
)

56081 #¥agm®
	`›timize
("", 
off
)

56083 
	`bÆ™˚_n⁄roŸ
(

56084 
MemPage
 *
pP¨ít
,

56085 
iP¨ítIdx
,

56086 
u8
 *
aOvÊS∑˚
,

56087 
isRoŸ
,

56088 
bBulk


56090 
BtSh¨ed
 *
pBt
;

56091 
nCñl
 = 0;

56092 
nMaxCñls
 = 0;

56093 
nNew
 = 0;

56094 
nOld
;

56095 
i
, 
j
, 
k
;

56096 
nxDiv
;

56097 
rc
 = 
SQLITE_OK
;

56098 
u16
 
ÀafC‹ª˘i⁄
;

56099 
ÀafD©a
;

56100 
ußbÀS∑˚
;

56101 
∑geFœgs
;

56102 
subtŸÆ
;

56103 
iS∑˚1
 = 0;

56104 
iOvÊS∑˚
 = 0;

56105 
szS¸©ch
;

56106 
MemPage
 *
≠Old
[
NB
];

56107 
MemPage
 *
≠C›y
[
NB
];

56108 
MemPage
 *
≠New
[
NB
+2];

56109 
u8
 *
pRight
;

56110 
u8
 *
≠Div
[
NB
-1];

56111 
˙tNew
[
NB
+2];

56112 
szNew
[
NB
+2];

56113 
u8
 **
≠Cñl
 = 0;

56114 
u16
 *
szCñl
;

56115 
u8
 *
aS∑˚1
;

56116 
Pgno
 
pgno
;

56118 
pBt
 = 
pP¨ít
->pBt;

56119 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pBt
->
muãx
) );

56120 
	`as£π
–
	`sqlôe3PagîIswrôóbÀ
(
pP¨ít
->
pDbPage
) );

56123 
	`TRACE
(("BALANCE: begöÖagê%d chûd o‡%d\n", 
pPage
->
pgno
, 
pP¨ít
->pgno));

56131 
	`as£π
–
pP¨ít
->
nOvîÊow
==0 ||ÖParent->nOverflow==1 );

56132 
	`as£π
–
pP¨ít
->
nOvîÊow
==0 ||ÖP¨ít->
aiOvÊ
[0]==
iP¨ítIdx
 );

56134 if–!
aOvÊS∑˚
 ){

56135  
SQLITE_NOMEM
;

56149 
i
 = 
pP¨ít
->
nOvîÊow
 +ÖP¨ít->
nCñl
;

56150 if–
i
<2 ){

56151 
nxDiv
 = 0;

56153 
	`as£π
–
bBulk
==0 || bBulk==1 );

56154 if–
iP¨ítIdx
==0 ){

56155 
nxDiv
 = 0;

56156 }if–
iP¨ítIdx
==
i
 ){

56157 
nxDiv
 = 
i
-2+
bBulk
;

56159 
	`as£π
–
bBulk
==0 );

56160 
nxDiv
 = 
iP¨ítIdx
-1;

56162 
i
 = 2-
bBulk
;

56164 
nOld
 = 
i
+1;

56165 if–(
i
+
nxDiv
-
pP¨ít
->
nOvîÊow
)=ıP¨ít->
nCñl
 ){

56166 
pRight
 = &
pP¨ít
->
aD©a
[pP¨ít->
hdrOff£t
+8];

56168 
pRight
 = 
	`födCñl
(
pP¨ít
, 
i
+
nxDiv
-pP¨ít->
nOvîÊow
);

56170 
pgno
 = 
	`gë4byã
(
pRight
);

56172 
rc
 = 
	`gëAndInôPage
(
pBt
, 
pgno
, &
≠Old
[
i
], 0);

56173 if–
rc
 ){

56174 
	`mem£t
(
≠Old
, 0, (
i
+1)*(
MemPage
*));

56175 
bÆ™˚_˛ónup
;

56177 
nMaxCñls
 +1+
≠Old
[
i
]->
nCñl
+≠Old[i]->
nOvîÊow
;

56178 if–(
i
--)==0 ) ;

56180 if–
i
+
nxDiv
==
pP¨ít
->
aiOvÊ
[0] &&ÖP¨ít->
nOvîÊow
 ){

56181 
≠Div
[
i
] = 
pP¨ít
->
≠OvÊ
[0];

56182 
pgno
 = 
	`gë4byã
(
≠Div
[
i
]);

56183 
szNew
[
i
] = 
	`˚ŒSizePå
(
pP¨ít
, 
≠Div
[i]);

56184 
pP¨ít
->
nOvîÊow
 = 0;

56186 
≠Div
[
i
] = 
	`födCñl
(
pP¨ít
, i+
nxDiv
-pP¨ít->
nOvîÊow
);

56187 
pgno
 = 
	`gë4byã
(
≠Div
[
i
]);

56188 
szNew
[
i
] = 
	`˚ŒSizePå
(
pP¨ít
, 
≠Div
[i]);

56202 if–
pBt
->
btsFœgs
 & 
BTS_SECURE_DELETE
 ){

56203 
iOff
;

56205 
iOff
 = 
	`SQLITE_PTR_TO_INT
(
≠Div
[
i
]Ë- SQLITE_PTR_TO_INT(
pP¨ít
->
aD©a
);

56206 if–(
iOff
+
szNew
[
i
])>()
pBt
->
ußbÀSize
 ){

56207 
rc
 = 
SQLITE_CORRUPT_BKPT
;

56208 
	`mem£t
(
≠Old
, 0, (
i
+1)*(
MemPage
*));

56209 
bÆ™˚_˛ónup
;

56211 
	`mem˝y
(&
aOvÊS∑˚
[
iOff
], 
≠Div
[
i
], 
szNew
[i]);

56212 
≠Div
[
i
] = &
aOvÊS∑˚
[≠Div[i]-
pP¨ít
->
aD©a
];

56215 
	`dr›Cñl
(
pP¨ít
, 
i
+
nxDiv
-pP¨ít->
nOvîÊow
, 
szNew
[i], &
rc
);

56221 
nMaxCñls
 = (nMaxCells + 3)&~3;

56226 
k
 = 
pBt
->
∑geSize
 + 
	`ROUND8
((
MemPage
));

56227 
szS¸©ch
 =

56228 
nMaxCñls
*(
u8
*)

56229 + 
nMaxCñls
*(
u16
)

56230 + 
pBt
->
∑geSize


56231 + 
k
*
nOld
;

56232 
≠Cñl
 = 
	`sqlôe3S¸©chMÆloc
–
szS¸©ch
 );

56233 if–
≠Cñl
==0 ){

56234 
rc
 = 
SQLITE_NOMEM
;

56235 
bÆ™˚_˛ónup
;

56237 
szCñl
 = (
u16
*)&
≠Cñl
[
nMaxCñls
];

56238 
aS∑˚1
 = (
u8
*)&
szCñl
[
nMaxCñls
];

56239 
	`as£π
–
	`EIGHT_BYTE_ALIGNMENT
(
aS∑˚1
) );

56257 
ÀafC‹ª˘i⁄
 = 
≠Old
[0]->
Àaf
*4;

56258 
ÀafD©a
 = 
≠Old
[0]->
hasD©a
;

56259 
i
=0; i<
nOld
; i++){

56260 
limô
;

56266 
MemPage
 *
pOld
 = 
≠C›y
[
i
] = (MemPage*)&
aS∑˚1
[
pBt
->
∑geSize
 + 
k
*i];

56267 
	`mem˝y
(
pOld
, 
≠Old
[
i
], (
MemPage
));

56268 
pOld
->
aD©a
 = (*)&pOld[1];

56269 
	`mem˝y
(
pOld
->
aD©a
, 
≠Old
[
i
]->aD©a, 
pBt
->
∑geSize
);

56271 
limô
 = 
pOld
->
nCñl
+pOld->
nOvîÊow
;

56272 if–
pOld
->
nOvîÊow
>0 ){

56273 
j
=0; j<
limô
; j++){

56274 
	`as£π
–
nCñl
<
nMaxCñls
 );

56275 
≠Cñl
[
nCñl
] = 
	`födOvîÊowCñl
(
pOld
, 
j
);

56276 
szCñl
[
nCñl
] = 
	`˚ŒSizePå
(
pOld
, 
≠Cñl
[nCell]);

56277 
nCñl
++;

56280 
u8
 *
aD©a
 = 
pOld
->aData;

56281 
u16
 
maskPage
 = 
pOld
->maskPage;

56282 
u16
 
˚ŒOff£t
 = 
pOld
->cellOffset;

56283 
j
=0; j<
limô
; j++){

56284 
	`as£π
–
nCñl
<
nMaxCñls
 );

56285 
≠Cñl
[
nCñl
] = 
	`födCñlv2
(
aD©a
, 
maskPage
, 
˚ŒOff£t
, 
j
);

56286 
szCñl
[
nCñl
] = 
	`˚ŒSizePå
(
pOld
, 
≠Cñl
[nCell]);

56287 
nCñl
++;

56290 if–
i
<
nOld
-1 && !
ÀafD©a
){

56291 
u16
 
sz
 = (u16)
szNew
[
i
];

56292 
u8
 *
pTemp
;

56293 
	`as£π
–
nCñl
<
nMaxCñls
 );

56294 
szCñl
[
nCñl
] = 
sz
;

56295 
pTemp
 = &
aS∑˚1
[
iS∑˚1
];

56296 
iS∑˚1
 +
sz
;

56297 
	`as£π
–
sz
<=
pBt
->
maxLoˇl
+23 );

56298 
	`as£π
–
iS∑˚1
 <()
pBt
->
∑geSize
 );

56299 
	`mem˝y
(
pTemp
, 
≠Div
[
i
], 
sz
);

56300 
≠Cñl
[
nCñl
] = 
pTemp
+
ÀafC‹ª˘i⁄
;

56301 
	`as£π
–
ÀafC‹ª˘i⁄
==0 ||ÜeafCorrection==4 );

56302 
szCñl
[
nCñl
] = szCñl[nCñl] - 
ÀafC‹ª˘i⁄
;

56303 if–!
pOld
->
Àaf
 ){

56304 
	`as£π
–
ÀafC‹ª˘i⁄
==0 );

56305 
	`as£π
–
pOld
->
hdrOff£t
==0 );

56308 
	`mem˝y
(
≠Cñl
[
nCñl
], &
pOld
->
aD©a
[8], 4);

56310 
	`as£π
–
ÀafC‹ª˘i⁄
==4 );

56311 if–
szCñl
[
nCñl
]<4 ){

56313 
szCñl
[
nCñl
] = 4;

56316 
nCñl
++;

56336 
ußbÀS∑˚
 = 
pBt
->
ußbÀSize
 - 12 + 
ÀafC‹ª˘i⁄
;

56337 
subtŸÆ
=
k
=
i
=0; i<
nCñl
; i++){

56338 
	`as£π
–
i
<
nMaxCñls
 );

56339 
subtŸÆ
 +
szCñl
[
i
] + 2;

56340 if–
subtŸÆ
 > 
ußbÀS∑˚
 ){

56341 
szNew
[
k
] = 
subtŸÆ
 - 
szCñl
[
i
];

56342 
˙tNew
[
k
] = 
i
;

56343 if–
ÀafD©a
 ){ 
i
--; }

56344 
subtŸÆ
 = 0;

56345 
k
++;

56346 if–
k
>
NB
+1 ){ 
rc
 = 
SQLITE_CORRUPT_BKPT
; 
bÆ™˚_˛ónup
; }

56349 
szNew
[
k
] = 
subtŸÆ
;

56350 
˙tNew
[
k
] = 
nCñl
;

56351 
k
++;

56363 
i
=
k
-1; i>0; i--){

56364 
szRight
 = 
szNew
[
i
];

56365 
szLe·
 = 
szNew
[
i
-1];

56366 
r
;

56367 
d
;

56369 
r
 = 
˙tNew
[
i
-1] - 1;

56370 
d
 = 
r
 + 1 - 
ÀafD©a
;

56371 
	`as£π
–
d
<
nMaxCñls
 );

56372 
	`as£π
–
r
<
nMaxCñls
 );

56373  
szRight
==0

56374 || (!
bBulk
 && 
szRight
+
szCñl
[
d
]+2<=
szLe·
-(szCñl[
r
]+2))

56376 
szRight
 +
szCñl
[
d
] + 2;

56377 
szLe·
 -
szCñl
[
r
] + 2;

56378 
˙tNew
[
i
-1]--;

56379 
r
 = 
˙tNew
[
i
-1] - 1;

56380 
d
 = 
r
 + 1 - 
ÀafD©a
;

56382 
szNew
[
i
] = 
szRight
;

56383 
szNew
[
i
-1] = 
szLe·
;

56395 
	`as£π
–
˙tNew
[0]>0 || (
pP¨ít
->
pgno
==1 &&ÖP¨ít->
nCñl
==0) );

56398 
	`TRACE
(("BALANCE: old: %d %d %d ",

56399 
≠Old
[0]->
pgno
,

56400 
nOld
>=2 ? 
≠Old
[1]->
pgno
 : 0,

56401 
nOld
>=3 ? 
≠Old
[2]->
pgno
 : 0

56407 if–
≠Old
[0]->
pgno
<=1 ){

56408 
rc
 = 
SQLITE_CORRUPT_BKPT
;

56409 
bÆ™˚_˛ónup
;

56411 
∑geFœgs
 = 
≠Old
[0]->
aD©a
[0];

56412 
i
=0; i<
k
; i++){

56413 
MemPage
 *
pNew
;

56414 if–
i
<
nOld
 ){

56415 
pNew
 = 
≠New
[
i
] = 
≠Old
[i];

56416 
≠Old
[
i
] = 0;

56417 
rc
 = 
	`sqlôe3PagîWrôe
(
pNew
->
pDbPage
);

56418 
nNew
++;

56419 if–
rc
 ) 
bÆ™˚_˛ónup
;

56421 
	`as£π
–
i
>0 );

56422 
rc
 = 
	`ÆloˇãBåìPage
(
pBt
, &
pNew
, &
pgno
, (
bBulk
 ? 1 :Ögno), 0);

56423 if–
rc
 ) 
bÆ™˚_˛ónup
;

56424 
≠New
[
i
] = 
pNew
;

56425 
nNew
++;

56428 if–
ISAUTOVACUUM
 ){

56429 
	`±rm≠Put
(
pBt
, 
pNew
->
pgno
, 
PTRMAP_BTREE
, 
pP¨ít
->pgno, &
rc
);

56430 if–
rc
!=
SQLITE_OK
 ){

56431 
bÆ™˚_˛ónup
;

56439  
i
<
nOld
 ){

56440 
	`‰ìPage
(
≠Old
[
i
], &
rc
);

56441 if–
rc
 ) 
bÆ™˚_˛ónup
;

56442 
	`ªÀa£Page
(
≠Old
[
i
]);

56443 
≠Old
[
i
] = 0;

56444 
i
++;

56461 
i
=0; i<
k
-1; i++){

56462 
möV
 = 
≠New
[
i
]->
pgno
;

56463 
möI
 = 
i
;

56464 
j
=
i
+1; j<
k
; j++){

56465 if–
≠New
[
j
]->
pgno
<()
möV
 ){

56466 
möI
 = 
j
;

56467 
möV
 = 
≠New
[
j
]->
pgno
;

56470 if–
möI
>
i
 ){

56471 
MemPage
 *
pT
;

56472 
pT
 = 
≠New
[
i
];

56473 
≠New
[
i
] =ápNew[
möI
];

56474 
≠New
[
möI
] = 
pT
;

56477 
	`TRACE
(("new: %d(%d) %d(%d) %d(%d) %d(%d) %d(%d)\n",

56478 
≠New
[0]->
pgno
, 
szNew
[0],

56479 
nNew
>=2 ? 
≠New
[1]->
pgno
 : 0,ÇNew>=2 ? 
szNew
[1] : 0,

56480 
nNew
>=3 ? 
≠New
[2]->
pgno
 : 0,ÇNew>=3 ? 
szNew
[2] : 0,

56481 
nNew
>=4 ? 
≠New
[3]->
pgno
 : 0,ÇNew>=4 ? 
szNew
[3] : 0,

56482 
nNew
>=5 ? 
≠New
[4]->
pgno
 : 0,ÇNew>=5 ? 
szNew
[4] : 0));

56484 
	`as£π
–
	`sqlôe3PagîIswrôóbÀ
(
pP¨ít
->
pDbPage
) );

56485 
	`put4byã
(
pRight
, 
≠New
[
nNew
-1]->
pgno
);

56491 
j
 = 0;

56492 
i
=0; i<
nNew
; i++){

56494 
MemPage
 *
pNew
 = 
≠New
[
i
];

56495 
	`as£π
–
j
<
nMaxCñls
 );

56496 
	`zîoPage
(
pNew
, 
∑geFœgs
);

56497 
	`as£mbÀPage
(
pNew
, 
˙tNew
[
i
]-
j
, &
≠Cñl
[j], &
szCñl
[j]);

56498 
	`as£π
–
pNew
->
nCñl
>0 || (
nNew
==1 && 
˙tNew
[0]==0) );

56499 
	`as£π
–
pNew
->
nOvîÊow
==0 );

56501 
j
 = 
˙tNew
[
i
];

56506 
	`as£π
–
i
<
nNew
-1 || 
j
==
nCñl
 );

56507 if–
j
<
nCñl
 ){

56508 
u8
 *
pCñl
;

56509 
u8
 *
pTemp
;

56510 
sz
;

56512 
	`as£π
–
j
<
nMaxCñls
 );

56513 
pCñl
 = 
≠Cñl
[
j
];

56514 
sz
 = 
szCñl
[
j
] + 
ÀafC‹ª˘i⁄
;

56515 
pTemp
 = &
aOvÊS∑˚
[
iOvÊS∑˚
];

56516 if–!
pNew
->
Àaf
 ){

56517 
	`mem˝y
(&
pNew
->
aD©a
[8], 
pCñl
, 4);

56518 }if–
ÀafD©a
 ){

56524 
CñlInfo
 
öfo
;

56525 
j
--;

56526 
	`båìP¨£CñlPå
(
pNew
, 
≠Cñl
[
j
], &
öfo
);

56527 
pCñl
 = 
pTemp
;

56528 
sz
 = 4 + 
	`putV¨öt
(&
pCñl
[4], 
öfo
.
nKey
);

56529 
pTemp
 = 0;

56531 
pCñl
 -= 4;

56543 if–
szCñl
[
j
]==4 ){

56544 
	`as£π
(
ÀafC‹ª˘i⁄
==4);

56545 
sz
 = 
	`˚ŒSizePå
(
pP¨ít
, 
pCñl
);

56548 
iOvÊS∑˚
 +
sz
;

56549 
	`as£π
–
sz
<=
pBt
->
maxLoˇl
+23 );

56550 
	`as£π
–
iOvÊS∑˚
 <()
pBt
->
∑geSize
 );

56551 
	`ö£πCñl
(
pP¨ít
, 
nxDiv
, 
pCñl
, 
sz
, 
pTemp
, 
pNew
->
pgno
, &
rc
);

56552 if–
rc
!=
SQLITE_OK
 ) 
bÆ™˚_˛ónup
;

56553 
	`as£π
–
	`sqlôe3PagîIswrôóbÀ
(
pP¨ít
->
pDbPage
) );

56555 
j
++;

56556 
nxDiv
++;

56559 
	`as£π
–
j
==
nCñl
 );

56560 
	`as£π
–
nOld
>0 );

56561 
	`as£π
–
nNew
>0 );

56562 if–(
∑geFœgs
 & 
PTF_LEAF
)==0 ){

56563 
u8
 *
zChûd
 = &
≠C›y
[
nOld
-1]->
aD©a
[8];

56564 
	`mem˝y
(&
≠New
[
nNew
-1]->
aD©a
[8], 
zChûd
, 4);

56567 if–
isRoŸ
 && 
pP¨ít
->
nCñl
==0 &&ÖP¨ít->
hdrOff£t
<=
≠New
[0]->
nFªe
 ){

56582 
	`as£π
–
nNew
==1 );

56583 
	`as£π
–
≠New
[0]->
nFªe
 ==

56584 (
	`gë2byã
(&
≠New
[0]->
aD©a
[5])-≠New[0]->
˚ŒOff£t
-≠New[0]->
nCñl
*2)

56586 
	`c›yNodeC⁄ã¡
(
≠New
[0], 
pP¨ít
, &
rc
);

56587 
	`‰ìPage
(
≠New
[0], &
rc
);

56588 }if–
ISAUTOVACUUM
 ){

56620 
MemPage
 *
pNew
 = 
≠New
[0];

56621 
MemPage
 *
pOld
 = 
≠C›y
[0];

56622 
nOvîÊow
 = 
pOld
->nOverflow;

56623 
iNextOld
 = 
pOld
->
nCñl
 + 
nOvîÊow
;

56624 
iOvîÊow
 = (
nOvîÊow
 ? 
pOld
->
aiOvÊ
[0] : -1);

56625 
j
 = 0;

56626 
k
 = 0;

56627 
i
=0; i<
nCñl
; i++){

56628 
isDividî
 = 0;

56629  
i
==
iNextOld
 ){

56633 
	`as£π
–
j
+1 < 
	`AºaySize
(
≠C›y
) );

56634 
	`as£π
–
j
+1 < 
nOld
 );

56635 
pOld
 = 
≠C›y
[++
j
];

56636 
iNextOld
 = 
i
 + !
ÀafD©a
 + 
pOld
->
nCñl
 +ÖOld->
nOvîÊow
;

56637 if–
pOld
->
nOvîÊow
 ){

56638 
nOvîÊow
 = 
pOld
->nOverflow;

56639 
iOvîÊow
 = 
i
 + !
ÀafD©a
 + 
pOld
->
aiOvÊ
[0];

56641 
isDividî
 = !
ÀafD©a
;

56644 
	`as£π
(
nOvîÊow
>0 || 
iOvîÊow
<
i
 );

56645 
	`as£π
(
nOvîÊow
<2 || 
pOld
->
aiOvÊ
[0]==pOld->aiOvfl[1]-1);

56646 
	`as£π
(
nOvîÊow
<3 || 
pOld
->
aiOvÊ
[1]==pOld->aiOvfl[2]-1);

56647 if–
i
==
iOvîÊow
 ){

56648 
isDividî
 = 1;

56649 if–(--
nOvîÊow
)>0 ){

56650 
iOvîÊow
++;

56654 if–
i
==
˙tNew
[
k
] ){

56658 
pNew
 = 
≠New
[++
k
];

56659 if–!
ÀafD©a
 ) ;

56661 
	`as£π
–
j
<
nOld
 );

56662 
	`as£π
–
k
<
nNew
 );

56668 if–
isDividî
 || 
pOld
->
pgno
!=
pNew
->pgno ){

56669 if–!
ÀafC‹ª˘i⁄
 ){

56670 
	`±rm≠Put
(
pBt
, 
	`gë4byã
(
≠Cñl
[
i
]), 
PTRMAP_BTREE
, 
pNew
->
pgno
, &
rc
);

56672 if–
szCñl
[
i
]>
pNew
->
möLoˇl
 ){

56673 
	`±rm≠PutOvÊPå
(
pNew
, 
≠Cñl
[
i
], &
rc
);

56678 if–!
ÀafC‹ª˘i⁄
 ){

56679 
i
=0; i<
nNew
; i++){

56680 
u32
 
key
 = 
	`gë4byã
(&
≠New
[
i
]->
aD©a
[8]);

56681 
	`±rm≠Put
(
pBt
, 
key
, 
PTRMAP_BTREE
, 
≠New
[
i
]->
pgno
, &
rc
);

56690 
	`±rm≠CheckPages
(
≠New
, 
nNew
);

56691 
	`±rm≠CheckPages
(&
pP¨ít
, 1);

56695 
	`as£π
–
pP¨ít
->
isInô
 );

56696 
	`TRACE
(("BALANCE: finished: old=%dÇew=%d cells=%d\n",

56697 
nOld
, 
nNew
, 
nCñl
));

56702 
bÆ™˚_˛ónup
:

56703 
	`sqlôe3S¸©chFªe
(
≠Cñl
);

56704 
i
=0; i<
nOld
; i++){

56705 
	`ªÀa£Page
(
≠Old
[
i
]);

56707 
i
=0; i<
nNew
; i++){

56708 
	`ªÀa£Page
(
≠New
[
i
]);

56711  
rc
;

56713 #i‡
	`deföed
(
_MSC_VER
Ë&& _MSC_VER >1700 && deföed(
_M_ARM
)

56714 #¥agm®
	`›timize
("", 
⁄
)

56737 
	`bÆ™˚_dì≥r
(
MemPage
 *
pRoŸ
, MemPagê**
µChûd
){

56738 
rc
;

56739 
MemPage
 *
pChûd
 = 0;

56740 
Pgno
 
pgnoChûd
 = 0;

56741 
BtSh¨ed
 *
pBt
 = 
pRoŸ
->pBt;

56743 
	`as£π
–
pRoŸ
->
nOvîÊow
>0 );

56744 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pBt
->
muãx
) );

56750 
rc
 = 
	`sqlôe3PagîWrôe
(
pRoŸ
->
pDbPage
);

56751 if–
rc
==
SQLITE_OK
 ){

56752 
rc
 = 
	`ÆloˇãBåìPage
(
pBt
,&
pChûd
,&
pgnoChûd
,
pRoŸ
->
pgno
,0);

56753 
	`c›yNodeC⁄ã¡
(
pRoŸ
, 
pChûd
, &
rc
);

56754 if–
ISAUTOVACUUM
 ){

56755 
	`±rm≠Put
(
pBt
, 
pgnoChûd
, 
PTRMAP_BTREE
, 
pRoŸ
->
pgno
, &
rc
);

56758 if–
rc
 ){

56759 *
µChûd
 = 0;

56760 
	`ªÀa£Page
(
pChûd
);

56761  
rc
;

56763 
	`as£π
–
	`sqlôe3PagîIswrôóbÀ
(
pChûd
->
pDbPage
) );

56764 
	`as£π
–
	`sqlôe3PagîIswrôóbÀ
(
pRoŸ
->
pDbPage
) );

56765 
	`as£π
–
pChûd
->
nCñl
==
pRoŸ
->nCell );

56767 
	`TRACE
(("BALANCE: c›yÑoŸ %d i¡ÿ%d\n", 
pRoŸ
->
pgno
, 
pChûd
->pgno));

56770 
	`mem˝y
(
pChûd
->
aiOvÊ
, 
pRoŸ
->aiOvfl,

56771 
pRoŸ
->
nOvîÊow
*’RoŸ->
aiOvÊ
[0]));

56772 
	`mem˝y
(
pChûd
->
≠OvÊ
, 
pRoŸ
->apOvfl,

56773 
pRoŸ
->
nOvîÊow
*’RoŸ->
≠OvÊ
[0]));

56774 
pChûd
->
nOvîÊow
 = 
pRoŸ
->nOverflow;

56777 
	`zîoPage
(
pRoŸ
, 
pChûd
->
aD©a
[0] & ~
PTF_LEAF
);

56778 
	`put4byã
(&
pRoŸ
->
aD©a
[pRoŸ->
hdrOff£t
+8], 
pgnoChûd
);

56780 *
µChûd
 = 
pChûd
;

56781  
SQLITE_OK
;

56794 
	`bÆ™˚
(
BtCurs‹
 *
pCur
){

56795 
rc
 = 
SQLITE_OK
;

56796 c⁄° 
nMö
 = 
pCur
->
pBt
->
ußbÀSize
 * 2 / 3;

56797 
u8
 
aBÆ™˚QuickS∑˚
[13];

56798 
u8
 *
pFªe
 = 0;

56800 
	`TESTONLY
–
bÆ™˚_quick_ˇŒed
 = 0 );

56801 
	`TESTONLY
–
bÆ™˚_dì≥r_ˇŒed
 = 0 );

56804 
iPage
 = 
pCur
->iPage;

56805 
MemPage
 *
pPage
 = 
pCur
->
≠Page
[
iPage
];

56807 if–
iPage
==0 ){

56808 if–
pPage
->
nOvîÊow
 ){

56814 
	`as£π
–(
bÆ™˚_dì≥r_ˇŒed
++)==0 );

56815 
rc
 = 
	`bÆ™˚_dì≥r
(
pPage
, &
pCur
->
≠Page
[1]);

56816 if–
rc
==
SQLITE_OK
 ){

56817 
pCur
->
iPage
 = 1;

56818 
pCur
->
aiIdx
[0] = 0;

56819 
pCur
->
aiIdx
[1] = 0;

56820 
	`as£π
–
pCur
->
≠Page
[1]->
nOvîÊow
 );

56825 }if–
pPage
->
nOvîÊow
==0 &&ÖPage->
nFªe
<=
nMö
 ){

56828 
MemPage
 * c⁄° 
pP¨ít
 = 
pCur
->
≠Page
[
iPage
-1];

56829 c⁄° 
iIdx
 = 
pCur
->
aiIdx
[
iPage
-1];

56831 
rc
 = 
	`sqlôe3PagîWrôe
(
pP¨ít
->
pDbPage
);

56832 if–
rc
==
SQLITE_OK
 ){

56833 #i‚de‡
SQLITE_OMIT_QUICKBALANCE


56834 if–
pPage
->
hasD©a


56835 && 
pPage
->
nOvîÊow
==1

56836 && 
pPage
->
aiOvÊ
[0]=ıPage->
nCñl


56837 && 
pP¨ít
->
pgno
!=1

56838 && 
pP¨ít
->
nCñl
==
iIdx


56853 
	`as£π
–(
bÆ™˚_quick_ˇŒed
++)==0 );

56854 
rc
 = 
	`bÆ™˚_quick
(
pP¨ít
, 
pPage
, 
aBÆ™˚QuickS∑˚
);

56875 
u8
 *
pS∑˚
 = 
	`sqlôe3PageMÆloc
(
pCur
->
pBt
->
∑geSize
);

56876 
rc
 = 
	`bÆ™˚_n⁄roŸ
(
pP¨ít
, 
iIdx
, 
pS∑˚
, 
iPage
==1, 
pCur
->
höts
);

56877 if–
pFªe
 ){

56882 
	`sqlôe3PageFªe
(
pFªe
);

56888 
pFªe
 = 
pS∑˚
;

56892 
pPage
->
nOvîÊow
 = 0;

56895 
	`ªÀa£Page
(
pPage
);

56896 
pCur
->
iPage
--;

56898 } 
rc
==
SQLITE_OK
 );

56900 if–
pFªe
 ){

56901 
	`sqlôe3PageFªe
(
pFªe
);

56903  
rc
;

56929 
SQLITE_PRIVATE
 
	`sqlôe3BåìIn£π
(

56930 
BtCurs‹
 *
pCur
,

56931 c⁄° *
pKey
, 
i64
 
nKey
,

56932 c⁄° *
pD©a
, 
nD©a
,

56933 
nZîo
,

56934 
≠≥ndBüs
,

56935 
£ekResu…


56937 
rc
;

56938 
loc
 = 
£ekResu…
;

56939 
szNew
 = 0;

56940 
idx
;

56941 
MemPage
 *
pPage
;

56942 
Båì
 *
p
 = 
pCur
->
pBåì
;

56943 
BtSh¨ed
 *
pBt
 = 
p
->pBt;

56944 *
ﬁdCñl
;

56945 *
√wCñl
 = 0;

56947 if–
pCur
->
eSèã
==
CURSOR_FAULT
 ){

56948 
	`as£π
–
pCur
->
skùNext
!=
SQLITE_OK
 );

56949  
pCur
->
skùNext
;

56952 
	`as£π
–
	`curs‹HﬁdsMuãx
(
pCur
) );

56953 
	`as£π
–
pCur
->
wrFœg
 && 
pBt
->
öTønß˘i⁄
==
TRANS_WRITE


56954 && (
pBt
->
btsFœgs
 & 
BTS_READ_ONLY
)==0 );

56955 
	`as£π
–
	`hasSh¨edCacheTabÀLock
(
p
, 
pCur
->
pgnoRoŸ
,ÖCur->
pKeyInfo
!=0, 2) );

56962 
	`as£π
–(
pKey
==0)==(
pCur
->
pKeyInfo
==0) );

56975 
rc
 = 
	`ßveAŒCurs‹s
(
pBt
, 
pCur
->
pgnoRoŸ
,ÖCur);

56976 if–
rc
 ) Ñc;

56981 if–
pCur
->
pKeyInfo
==0 ){

56982 
	`övÆid©eIn¸blobCurs‹s
(
p
, 
nKey
, 0);

56985 if–!
loc
 ){

56986 
rc
 = 
	`båìMovëo
(
pCur
, 
pKey
, 
nKey
, 
≠≥ndBüs
, &
loc
);

56987 if–
rc
 ) Ñc;

56989 
	`as£π
–
pCur
->
eSèã
==
CURSOR_VALID
 || (pCur->eSèã==
CURSOR_INVALID
 && 
loc
) );

56991 
pPage
 = 
pCur
->
≠Page
[pCur->
iPage
];

56992 
	`as£π
–
pPage
->
ötKey
 || 
nKey
>=0 );

56993 
	`as£π
–
pPage
->
Àaf
 || !pPage->
ötKey
 );

56995 
	`TRACE
(("INSERT:Åable=%dÇkey=%lldÇdata=%dÖage=%d %s\n",

56996 
pCur
->
pgnoRoŸ
, 
nKey
, 
nD©a
, 
pPage
->
pgno
,

56997 
loc
==0 ? "overwrite" : "newÉntry"));

56998 
	`as£π
–
pPage
->
isInô
 );

56999 
	`ÆloˇãTempS∑˚
(
pBt
);

57000 
√wCñl
 = 
pBt
->
pTmpS∑˚
;

57001 if–
√wCñl
==0 )  
SQLITE_NOMEM
;

57002 
rc
 = 
	`fûlInCñl
(
pPage
, 
√wCñl
, 
pKey
, 
nKey
, 
pD©a
, 
nD©a
, 
nZîo
, &
szNew
);

57003 if–
rc
 ) 
íd_ö£π
;

57004 
	`as£π
–
szNew
==
	`˚ŒSizePå
(
pPage
, 
√wCñl
) );

57005 
	`as£π
–
szNew
 <
	`MX_CELL_SIZE
(
pBt
) );

57006 
idx
 = 
pCur
->
aiIdx
[pCur->
iPage
];

57007 if–
loc
==0 ){

57008 
u16
 
szOld
;

57009 
	`as£π
–
idx
<
pPage
->
nCñl
 );

57010 
rc
 = 
	`sqlôe3PagîWrôe
(
pPage
->
pDbPage
);

57011 if–
rc
 ){

57012 
íd_ö£π
;

57014 
ﬁdCñl
 = 
	`födCñl
(
pPage
, 
idx
);

57015 if–!
pPage
->
Àaf
 ){

57016 
	`mem˝y
(
√wCñl
, 
ﬁdCñl
, 4);

57018 
szOld
 = 
	`˚ŒSizePå
(
pPage
, 
ﬁdCñl
);

57019 
rc
 = 
	`˛órCñl
(
pPage
, 
ﬁdCñl
);

57020 
	`dr›Cñl
(
pPage
, 
idx
, 
szOld
, &
rc
);

57021 if–
rc
 ) 
íd_ö£π
;

57022 }if–
loc
<0 && 
pPage
->
nCñl
>0 ){

57023 
	`as£π
–
pPage
->
Àaf
 );

57024 
idx
 = ++
pCur
->
aiIdx
[pCur->
iPage
];

57026 
	`as£π
–
pPage
->
Àaf
 );

57028 
	`ö£πCñl
(
pPage
, 
idx
, 
√wCñl
, 
szNew
, 0, 0, &
rc
);

57029 
	`as£π
–
rc
!=
SQLITE_OK
 || 
pPage
->
nCñl
>0 ||ÖPage->
nOvîÊow
>0 );

57051 
pCur
->
öfo
.
nSize
 = 0;

57052 
pCur
->
vÆidNKey
 = 0;

57053 if–
rc
==
SQLITE_OK
 && 
pPage
->
nOvîÊow
 ){

57054 
rc
 = 
	`bÆ™˚
(
pCur
);

57060 
pCur
->
≠Page
[pCur->
iPage
]->
nOvîÊow
 = 0;

57061 
pCur
->
eSèã
 = 
CURSOR_INVALID
;

57063 
	`as£π
–
pCur
->
≠Page
[pCur->
iPage
]->
nOvîÊow
==0 );

57065 
íd_ö£π
:

57066  
rc
;

57073 
SQLITE_PRIVATE
 
	`sqlôe3BåìDñëe
(
BtCurs‹
 *
pCur
){

57074 
Båì
 *
p
 = 
pCur
->
pBåì
;

57075 
BtSh¨ed
 *
pBt
 = 
p
->pBt;

57076 
rc
;

57077 
MemPage
 *
pPage
;

57078 *
pCñl
;

57079 
iCñlIdx
;

57080 
iCñlDïth
;

57082 
	`as£π
–
	`curs‹HﬁdsMuãx
(
pCur
) );

57083 
	`as£π
–
pBt
->
öTønß˘i⁄
==
TRANS_WRITE
 );

57084 
	`as£π
–(
pBt
->
btsFœgs
 & 
BTS_READ_ONLY
)==0 );

57085 
	`as£π
–
pCur
->
wrFœg
 );

57086 
	`as£π
–
	`hasSh¨edCacheTabÀLock
(
p
, 
pCur
->
pgnoRoŸ
,ÖCur->
pKeyInfo
!=0, 2) );

57087 
	`as£π
–!
	`hasRódC⁄Êi˘s
(
p
, 
pCur
->
pgnoRoŸ
) );

57089 if–
	`NEVER
(
pCur
->
aiIdx
[pCur->
iPage
]>ıCur->
≠Page
[pCur->iPage]->
nCñl
)

57090 || 
	`NEVER
(
pCur
->
eSèã
!=
CURSOR_VALID
)

57092  
SQLITE_ERROR
;

57095 
iCñlDïth
 = 
pCur
->
iPage
;

57096 
iCñlIdx
 = 
pCur
->
aiIdx
[
iCñlDïth
];

57097 
pPage
 = 
pCur
->
≠Page
[
iCñlDïth
];

57098 
pCñl
 = 
	`födCñl
(
pPage
, 
iCñlIdx
);

57107 if–!
pPage
->
Àaf
 ){

57108 
nŸU£d
;

57109 
rc
 = 
	`sqlôe3BåìPªvious
(
pCur
, &
nŸU£d
);

57110 if–
rc
 ) Ñc;

57118 
rc
 = 
	`ßveAŒCurs‹s
(
pBt
, 
pCur
->
pgnoRoŸ
,ÖCur);

57119 if–
rc
 ) Ñc;

57123 if–
pCur
->
pKeyInfo
==0 ){

57124 
	`övÆid©eIn¸blobCurs‹s
(
p
, 
pCur
->
öfo
.
nKey
, 0);

57127 
rc
 = 
	`sqlôe3PagîWrôe
(
pPage
->
pDbPage
);

57128 if–
rc
 ) Ñc;

57129 
rc
 = 
	`˛órCñl
(
pPage
, 
pCñl
);

57130 
	`dr›Cñl
(
pPage
, 
iCñlIdx
, 
	`˚ŒSizePå
’Page, 
pCñl
), &
rc
);

57131 if–
rc
 ) Ñc;

57138 if–!
pPage
->
Àaf
 ){

57139 
MemPage
 *
pLóf
 = 
pCur
->
≠Page
[pCur->
iPage
];

57140 
nCñl
;

57141 
Pgno
 
n
 = 
pCur
->
≠Page
[
iCñlDïth
+1]->
pgno
;

57142 *
pTmp
;

57144 
pCñl
 = 
	`födCñl
(
pLóf
,ÖLóf->
nCñl
-1);

57145 
nCñl
 = 
	`˚ŒSizePå
(
pLóf
, 
pCñl
);

57146 
	`as£π
–
	`MX_CELL_SIZE
(
pBt
Ë>
nCñl
 );

57148 
	`ÆloˇãTempS∑˚
(
pBt
);

57149 
pTmp
 = 
pBt
->
pTmpS∑˚
;

57151 
rc
 = 
	`sqlôe3PagîWrôe
(
pLóf
->
pDbPage
);

57152 
	`ö£πCñl
(
pPage
, 
iCñlIdx
, 
pCñl
-4, 
nCñl
+4, 
pTmp
, 
n
, &
rc
);

57153 
	`dr›Cñl
(
pLóf
,ÖLóf->
nCñl
-1,ÇCñl, &
rc
);

57154 if–
rc
 ) Ñc;

57172 
rc
 = 
	`bÆ™˚
(
pCur
);

57173 if–
rc
==
SQLITE_OK
 && 
pCur
->
iPage
>
iCñlDïth
 ){

57174  
pCur
->
iPage
>
iCñlDïth
 ){

57175 
	`ªÀa£Page
(
pCur
->
≠Page
[pCur->
iPage
--]);

57177 
rc
 = 
	`bÆ™˚
(
pCur
);

57180 if–
rc
==
SQLITE_OK
 ){

57181 
	`moveToRoŸ
(
pCur
);

57183  
rc
;

57197 
	`båìCª©eTabÀ
(
Båì
 *
p
, *
piTabÀ
, 
¸óãTabFœgs
){

57198 
BtSh¨ed
 *
pBt
 = 
p
->pBt;

57199 
MemPage
 *
pRoŸ
;

57200 
Pgno
 
pgnoRoŸ
;

57201 
rc
;

57202 
±fFœgs
;

57204 
	`as£π
–
	`sqlôe3BåìHﬁdsMuãx
(
p
) );

57205 
	`as£π
–
pBt
->
öTønß˘i⁄
==
TRANS_WRITE
 );

57206 
	`as£π
–(
pBt
->
btsFœgs
 & 
BTS_READ_ONLY
)==0 );

57208 #ifde‡
SQLITE_OMIT_AUTOVACUUM


57209 
rc
 = 
	`ÆloˇãBåìPage
(
pBt
, &
pRoŸ
, &
pgnoRoŸ
, 1, 0);

57210 if–
rc
 ){

57211  
rc
;

57214 if–
pBt
->
autoVacuum
 ){

57215 
Pgno
 
pgnoMove
;

57216 
MemPage
 *
pPageMove
;

57223 
	`övÆid©eAŒOvîÊowCache
(
pBt
);

57229 
	`sqlôe3BåìGëMëa
(
p
, 
BTREE_LARGEST_ROOT_PAGE
, &
pgnoRoŸ
);

57230 
pgnoRoŸ
++;

57235  
pgnoRoŸ
==
	`PTRMAP_PAGENO
(
pBt
,ÖgnoRoot) ||

57236 
pgnoRoŸ
==
	`PENDING_BYTE_PAGE
(
pBt
) ){

57237 
pgnoRoŸ
++;

57239 
	`as£π
–
pgnoRoŸ
>=3 );

57245 
rc
 = 
	`ÆloˇãBåìPage
(
pBt
, &
pPageMove
, &
pgnoMove
, 
pgnoRoŸ
, 
BTALLOC_EXACT
);

57246 if–
rc
!=
SQLITE_OK
 ){

57247  
rc
;

57250 if–
pgnoMove
!=
pgnoRoŸ
 ){

57257 
u8
 
eTy≥
 = 0;

57258 
Pgno
 
iPåPage
 = 0;

57263 
rc
 = 
	`ßveAŒCurs‹s
(
pBt
, 0, 0);

57264 
	`ªÀa£Page
(
pPageMove
);

57265 if–
rc
!=
SQLITE_OK
 ){

57266  
rc
;

57270 
rc
 = 
	`båìGëPage
(
pBt
, 
pgnoRoŸ
, &
pRoŸ
, 0);

57271 if–
rc
!=
SQLITE_OK
 ){

57272  
rc
;

57274 
rc
 = 
	`±rm≠Gë
(
pBt
, 
pgnoRoŸ
, &
eTy≥
, &
iPåPage
);

57275 if–
eTy≥
==
PTRMAP_ROOTPAGE
 ||ÉTy≥==
PTRMAP_FREEPAGE
 ){

57276 
rc
 = 
SQLITE_CORRUPT_BKPT
;

57278 if–
rc
!=
SQLITE_OK
 ){

57279 
	`ªÀa£Page
(
pRoŸ
);

57280  
rc
;

57282 
	`as£π
–
eTy≥
!=
PTRMAP_ROOTPAGE
 );

57283 
	`as£π
–
eTy≥
!=
PTRMAP_FREEPAGE
 );

57284 
rc
 = 
	`ªloˇãPage
(
pBt
, 
pRoŸ
, 
eTy≥
, 
iPåPage
, 
pgnoMove
, 0);

57285 
	`ªÀa£Page
(
pRoŸ
);

57288 if–
rc
!=
SQLITE_OK
 ){

57289  
rc
;

57291 
rc
 = 
	`båìGëPage
(
pBt
, 
pgnoRoŸ
, &
pRoŸ
, 0);

57292 if–
rc
!=
SQLITE_OK
 ){

57293  
rc
;

57295 
rc
 = 
	`sqlôe3PagîWrôe
(
pRoŸ
->
pDbPage
);

57296 if–
rc
!=
SQLITE_OK
 ){

57297 
	`ªÀa£Page
(
pRoŸ
);

57298  
rc
;

57301 
pRoŸ
 = 
pPageMove
;

57305 
	`±rm≠Put
(
pBt
, 
pgnoRoŸ
, 
PTRMAP_ROOTPAGE
, 0, &
rc
);

57306 if–
rc
 ){

57307 
	`ªÀa£Page
(
pRoŸ
);

57308  
rc
;

57315 
	`as£π
–
	`sqlôe3PagîIswrôóbÀ
(
pBt
->
pPage1
->
pDbPage
) );

57316 
rc
 = 
	`sqlôe3BåìUpd©eMëa
(
p
, 4, 
pgnoRoŸ
);

57317 if–
	`NEVER
(
rc
) ){

57318 
	`ªÀa£Page
(
pRoŸ
);

57319  
rc
;

57323 
rc
 = 
	`ÆloˇãBåìPage
(
pBt
, &
pRoŸ
, &
pgnoRoŸ
, 1, 0);

57324 if–
rc
 ) Ñc;

57327 
	`as£π
–
	`sqlôe3PagîIswrôóbÀ
(
pRoŸ
->
pDbPage
) );

57328 if–
¸óãTabFœgs
 & 
BTREE_INTKEY
 ){

57329 
±fFœgs
 = 
PTF_INTKEY
 | 
PTF_LEAFDATA
 | 
PTF_LEAF
;

57331 
±fFœgs
 = 
PTF_ZERODATA
 | 
PTF_LEAF
;

57333 
	`zîoPage
(
pRoŸ
, 
±fFœgs
);

57334 
	`sqlôe3PagîUƒef
(
pRoŸ
->
pDbPage
);

57335 
	`as£π
–(
pBt
->
›íFœgs
 & 
BTREE_SINGLE
)==0 || 
pgnoRoŸ
==2 );

57336 *
piTabÀ
 = ()
pgnoRoŸ
;

57337  
SQLITE_OK
;

57339 
SQLITE_PRIVATE
 
	`sqlôe3BåìCª©eTabÀ
(
Båì
 *
p
, *
piTabÀ
, 
Êags
){

57340 
rc
;

57341 
	`sqlôe3BåìE¡î
(
p
);

57342 
rc
 = 
	`båìCª©eTabÀ
(
p
, 
piTabÀ
, 
Êags
);

57343 
	`sqlôe3BåìLóve
(
p
);

57344  
rc
;

57351 
	`˛órD©aba£Page
(

57352 
BtSh¨ed
 *
pBt
,

57353 
Pgno
 
pgno
,

57354 
‰ìPageFœg
,

57355 *
≤Ch™ge


57357 
MemPage
 *
pPage
;

57358 
rc
;

57359 *
pCñl
;

57360 
i
;

57362 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pBt
->
muãx
) );

57363 if–
pgno
>
	`båìPagecou¡
(
pBt
) ){

57364  
SQLITE_CORRUPT_BKPT
;

57367 
rc
 = 
	`gëAndInôPage
(
pBt
, 
pgno
, &
pPage
, 0);

57368 if–
rc
 ) Ñc;

57369 
i
=0; i<
pPage
->
nCñl
; i++){

57370 
pCñl
 = 
	`födCñl
(
pPage
, 
i
);

57371 if–!
pPage
->
Àaf
 ){

57372 
rc
 = 
	`˛órD©aba£Page
(
pBt
, 
	`gë4byã
(
pCñl
), 1, 
≤Ch™ge
);

57373 if–
rc
 ) 
˛órd©aba£∑ge_out
;

57375 
rc
 = 
	`˛órCñl
(
pPage
, 
pCñl
);

57376 if–
rc
 ) 
˛órd©aba£∑ge_out
;

57378 if–!
pPage
->
Àaf
 ){

57379 
rc
 = 
	`˛órD©aba£Page
(
pBt
, 
	`gë4byã
(&
pPage
->
aD©a
[8]), 1, 
≤Ch™ge
);

57380 if–
rc
 ) 
˛órd©aba£∑ge_out
;

57381 }if–
≤Ch™ge
 ){

57382 
	`as£π
–
pPage
->
ötKey
 );

57383 *
≤Ch™ge
 +
pPage
->
nCñl
;

57385 if–
‰ìPageFœg
 ){

57386 
	`‰ìPage
(
pPage
, &
rc
);

57387 }if–(
rc
 = 
	`sqlôe3PagîWrôe
(
pPage
->
pDbPage
))==0 ){

57388 
	`zîoPage
(
pPage
,ÖPage->
aD©a
[0] | 
PTF_LEAF
);

57391 
˛órd©aba£∑ge_out
:

57392 
	`ªÀa£Page
(
pPage
);

57393  
rc
;

57409 
SQLITE_PRIVATE
 
	`sqlôe3BåìCÀ¨TabÀ
(
Båì
 *
p
, 
iTabÀ
, *
≤Ch™ge
){

57410 
rc
;

57411 
BtSh¨ed
 *
pBt
 = 
p
->pBt;

57412 
	`sqlôe3BåìE¡î
(
p
);

57413 
	`as£π
–
p
->
öTøns
==
TRANS_WRITE
 );

57415 
rc
 = 
	`ßveAŒCurs‹s
(
pBt
, (
Pgno
)
iTabÀ
, 0);

57417 if–
SQLITE_OK
==
rc
 ){

57421 
	`övÆid©eIn¸blobCurs‹s
(
p
, 0, 1);

57422 
rc
 = 
	`˛órD©aba£Page
(
pBt
, (
Pgno
)
iTabÀ
, 0, 
≤Ch™ge
);

57424 
	`sqlôe3BåìLóve
(
p
);

57425  
rc
;

57448 
	`båìDr›TabÀ
(
Båì
 *
p
, 
Pgno
 
iTabÀ
, *
piMoved
){

57449 
rc
;

57450 
MemPage
 *
pPage
 = 0;

57451 
BtSh¨ed
 *
pBt
 = 
p
->pBt;

57453 
	`as£π
–
	`sqlôe3BåìHﬁdsMuãx
(
p
) );

57454 
	`as£π
–
p
->
öTøns
==
TRANS_WRITE
 );

57464 if–
	`NEVER
(
pBt
->
pCurs‹
) ){

57465 
	`sqlôe3C⁄√˘i⁄Blocked
(
p
->
db
, 
pBt
->
pCurs‹
->
pBåì
->db);

57466  
SQLITE_LOCKED_SHAREDCACHE
;

57469 
rc
 = 
	`båìGëPage
(
pBt
, (
Pgno
)
iTabÀ
, &
pPage
, 0);

57470 if–
rc
 ) Ñc;

57471 
rc
 = 
	`sqlôe3BåìCÀ¨TabÀ
(
p
, 
iTabÀ
, 0);

57472 if–
rc
 ){

57473 
	`ªÀa£Page
(
pPage
);

57474  
rc
;

57477 *
piMoved
 = 0;

57479 if–
iTabÀ
>1 ){

57480 #ifde‡
SQLITE_OMIT_AUTOVACUUM


57481 
	`‰ìPage
(
pPage
, &
rc
);

57482 
	`ªÀa£Page
(
pPage
);

57484 if–
pBt
->
autoVacuum
 ){

57485 
Pgno
 
maxRoŸPgno
;

57486 
	`sqlôe3BåìGëMëa
(
p
, 
BTREE_LARGEST_ROOT_PAGE
, &
maxRoŸPgno
);

57488 if–
iTabÀ
==
maxRoŸPgno
 ){

57492 
	`‰ìPage
(
pPage
, &
rc
);

57493 
	`ªÀa£Page
(
pPage
);

57494 if–
rc
!=
SQLITE_OK
 ){

57495  
rc
;

57502 
MemPage
 *
pMove
;

57503 
	`ªÀa£Page
(
pPage
);

57504 
rc
 = 
	`båìGëPage
(
pBt
, 
maxRoŸPgno
, &
pMove
, 0);

57505 if–
rc
!=
SQLITE_OK
 ){

57506  
rc
;

57508 
rc
 = 
	`ªloˇãPage
(
pBt
, 
pMove
, 
PTRMAP_ROOTPAGE
, 0, 
iTabÀ
, 0);

57509 
	`ªÀa£Page
(
pMove
);

57510 if–
rc
!=
SQLITE_OK
 ){

57511  
rc
;

57513 
pMove
 = 0;

57514 
rc
 = 
	`båìGëPage
(
pBt
, 
maxRoŸPgno
, &
pMove
, 0);

57515 
	`‰ìPage
(
pMove
, &
rc
);

57516 
	`ªÀa£Page
(
pMove
);

57517 if–
rc
!=
SQLITE_OK
 ){

57518  
rc
;

57520 *
piMoved
 = 
maxRoŸPgno
;

57528 
maxRoŸPgno
--;

57529  
maxRoŸPgno
==
	`PENDING_BYTE_PAGE
(
pBt
)

57530 || 
	`PTRMAP_ISPAGE
(
pBt
, 
maxRoŸPgno
) ){

57531 
maxRoŸPgno
--;

57533 
	`as£π
–
maxRoŸPgno
!=
	`PENDING_BYTE_PAGE
(
pBt
) );

57535 
rc
 = 
	`sqlôe3BåìUpd©eMëa
(
p
, 4, 
maxRoŸPgno
);

57537 
	`‰ìPage
(
pPage
, &
rc
);

57538 
	`ªÀa£Page
(
pPage
);

57546 
	`zîoPage
(
pPage
, 
PTF_INTKEY
|
PTF_LEAF
 );

57547 
	`ªÀa£Page
(
pPage
);

57549  
rc
;

57551 
SQLITE_PRIVATE
 
	`sqlôe3BåìDr›TabÀ
(
Båì
 *
p
, 
iTabÀ
, *
piMoved
){

57552 
rc
;

57553 
	`sqlôe3BåìE¡î
(
p
);

57554 
rc
 = 
	`båìDr›TabÀ
(
p
, 
iTabÀ
, 
piMoved
);

57555 
	`sqlôe3BåìLóve
(
p
);

57556  
rc
;

57573 
SQLITE_PRIVATE
 
	`sqlôe3BåìGëMëa
(
Båì
 *
p
, 
idx
, 
u32
 *
pMëa
){

57574 
BtSh¨ed
 *
pBt
 = 
p
->pBt;

57576 
	`sqlôe3BåìE¡î
(
p
);

57577 
	`as£π
–
p
->
öTøns
>
TRANS_NONE
 );

57578 
	`as£π
–
SQLITE_OK
==
	`quîySh¨edCacheTabÀLock
(
p
, 
MASTER_ROOT
, 
READ_LOCK
) );

57579 
	`as£π
–
pBt
->
pPage1
 );

57580 
	`as£π
–
idx
>=0 && idx<=15 );

57582 *
pMëa
 = 
	`gë4byã
(&
pBt
->
pPage1
->
aD©a
[36 + 
idx
*4]);

57586 #ifde‡
SQLITE_OMIT_AUTOVACUUM


57587 if–
idx
==
BTREE_LARGEST_ROOT_PAGE
 && *
pMëa
>0 ){

57588 
pBt
->
btsFœgs
 |
BTS_READ_ONLY
;

57592 
	`sqlôe3BåìLóve
(
p
);

57599 
SQLITE_PRIVATE
 
	`sqlôe3BåìUpd©eMëa
(
Båì
 *
p
, 
idx
, 
u32
 
iMëa
){

57600 
BtSh¨ed
 *
pBt
 = 
p
->pBt;

57601 *
pP1
;

57602 
rc
;

57603 
	`as£π
–
idx
>=1 && idx<=15 );

57604 
	`sqlôe3BåìE¡î
(
p
);

57605 
	`as£π
–
p
->
öTøns
==
TRANS_WRITE
 );

57606 
	`as£π
–
pBt
->
pPage1
!=0 );

57607 
pP1
 = 
pBt
->
pPage1
->
aD©a
;

57608 
rc
 = 
	`sqlôe3PagîWrôe
(
pBt
->
pPage1
->
pDbPage
);

57609 if–
rc
==
SQLITE_OK
 ){

57610 
	`put4byã
(&
pP1
[36 + 
idx
*4], 
iMëa
);

57611 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


57612 if–
idx
==
BTREE_INCR_VACUUM
 ){

57613 
	`as£π
–
pBt
->
autoVacuum
 || 
iMëa
==0 );

57614 
	`as£π
–
iMëa
==0 || iMeta==1 );

57615 
pBt
->
ö¸Vacuum
 = (
u8
)
iMëa
;

57619 
	`sqlôe3BåìLóve
(
p
);

57620  
rc
;

57623 #i‚de‡
SQLITE_OMIT_BTREECOUNT


57632 
SQLITE_PRIVATE
 
	`sqlôe3BåìCou¡
(
BtCurs‹
 *
pCur
, 
i64
 *
≤E¡ry
){

57633 
i64
 
nE¡ry
 = 0;

57634 
rc
;

57636 if–
pCur
->
pgnoRoŸ
==0 ){

57637 *
≤E¡ry
 = 0;

57638  
SQLITE_OK
;

57640 
rc
 = 
	`moveToRoŸ
(
pCur
);

57645  
rc
==
SQLITE_OK
 ){

57646 
iIdx
;

57647 
MemPage
 *
pPage
;

57653 
pPage
 = 
pCur
->
≠Page
[pCur->
iPage
];

57654 if–
pPage
->
Àaf
 || !pPage->
ötKey
 ){

57655 
nE¡ry
 +
pPage
->
nCñl
;

57668 if–
pPage
->
Àaf
 ){

57670 if–
pCur
->
iPage
==0 ){

57672 *
≤E¡ry
 = 
nE¡ry
;

57673  
SQLITE_OK
;

57675 
	`moveToP¨ít
(
pCur
);

57676 } 
pCur
->
aiIdx
[pCur->
iPage
]>ıCur->
≠Page
[pCur->iPage]->
nCñl
 );

57678 
pCur
->
aiIdx
[pCur->
iPage
]++;

57679 
pPage
 = 
pCur
->
≠Page
[pCur->
iPage
];

57685 
iIdx
 = 
pCur
->
aiIdx
[pCur->
iPage
];

57686 if–
iIdx
==
pPage
->
nCñl
 ){

57687 
rc
 = 
	`moveToChûd
(
pCur
, 
	`gë4byã
(&
pPage
->
aD©a
[pPage->
hdrOff£t
+8]));

57689 
rc
 = 
	`moveToChûd
(
pCur
, 
	`gë4byã
(
	`födCñl
(
pPage
, 
iIdx
)));

57694  
rc
;

57702 
SQLITE_PRIVATE
 
Pagî
 *
	`sqlôe3BåìPagî
(
Båì
 *
p
){

57703  
p
->
pBt
->
pPagî
;

57706 #i‚de‡
SQLITE_OMIT_INTEGRITY_CHECK


57710 
	`checkAµídMsg
(

57711 
I¡egrôyCk
 *
pCheck
,

57712 *
zMsg1
,

57713 c⁄° *
zF‹m©
,

57716 
va_li°
 
≠
;

57717 if–!
pCheck
->
mxEº
 ) ;

57718 
pCheck
->
mxEº
--;

57719 
pCheck
->
nEº
++;

57720 
	`va_°¨t
(
≠
, 
zF‹m©
);

57721 if–
pCheck
->
îrMsg
.
nCh¨
 ){

57722 
	`sqlôe3SåAccumAµíd
(&
pCheck
->
îrMsg
, "\n", 1);

57724 if–
zMsg1
 ){

57725 
	`sqlôe3SåAccumAµíd
(&
pCheck
->
îrMsg
, 
zMsg1
, -1);

57727 
	`sqlôe3VXPrötf
(&
pCheck
->
îrMsg
, 1, 
zF‹m©
, 
≠
);

57728 
	`va_íd
(
≠
);

57729 if–
pCheck
->
îrMsg
.
accEº‹
==
STRACCUM_NOMEM
 ){

57730 
pCheck
->
mÆlocFaûed
 = 1;

57735 #i‚de‡
SQLITE_OMIT_INTEGRITY_CHECK


57741 
	`gëPageRe„ªn˚d
(
I¡egrôyCk
 *
pCheck
, 
Pgno
 
iPg
){

57742 
	`as£π
–
iPg
<=
pCheck
->
nPage
 && ’Check->
aPgRef
[0])==1 );

57743  (
pCheck
->
aPgRef
[
iPg
/8] & (1 << (iPg & 0x07)));

57749 
	`£tPageRe„ªn˚d
(
I¡egrôyCk
 *
pCheck
, 
Pgno
 
iPg
){

57750 
	`as£π
–
iPg
<=
pCheck
->
nPage
 && ’Check->
aPgRef
[0])==1 );

57751 
pCheck
->
aPgRef
[
iPg
/8] |= (1 << (iPg & 0x07));

57763 
	`checkRef
(
I¡egrôyCk
 *
pCheck
, 
Pgno
 
iPage
, *
zC⁄ãxt
){

57764 if–
iPage
==0 )  1;

57765 if–
iPage
>
pCheck
->
nPage
 ){

57766 
	`checkAµídMsg
(
pCheck
, 
zC⁄ãxt
, "övÆidÖagênumbî %d", 
iPage
);

57769 if–
	`gëPageRe„ªn˚d
(
pCheck
, 
iPage
) ){

57770 
	`checkAµídMsg
(
pCheck
, 
zC⁄ãxt
, "2ndÑe„ªn˚Åÿ∑gê%d", 
iPage
);

57773 
	`£tPageRe„ªn˚d
(
pCheck
, 
iPage
);

57777 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


57783 
	`checkPåm≠
(

57784 
I¡egrôyCk
 *
pCheck
,

57785 
Pgno
 
iChûd
,

57786 
u8
 
eTy≥
,

57787 
Pgno
 
iP¨ít
,

57788 *
zC⁄ãxt


57790 
rc
;

57791 
u8
 
ePåm≠Ty≥
;

57792 
Pgno
 
iPåm≠P¨ít
;

57794 
rc
 = 
	`±rm≠Gë
(
pCheck
->
pBt
, 
iChûd
, &
ePåm≠Ty≥
, &
iPåm≠P¨ít
);

57795 if–
rc
!=
SQLITE_OK
 ){

57796 if–
rc
==
SQLITE_NOMEM
 ||Ñc==
SQLITE_IOERR_NOMEM
 ) 
pCheck
->
mÆlocFaûed
 = 1;

57797 
	`checkAµídMsg
(
pCheck
, 
zC⁄ãxt
, "FaûedÅÿªadÖåm≠ key=%d", 
iChûd
);

57801 if–
ePåm≠Ty≥
!=
eTy≥
 || 
iPåm≠P¨ít
!=
iP¨ít
 ){

57802 
	`checkAµídMsg
(
pCheck
, 
zC⁄ãxt
,

57804 
iChûd
, 
eTy≥
, 
iP¨ít
, 
ePåm≠Ty≥
, 
iPåm≠P¨ít
);

57813 
	`checkLi°
(

57814 
I¡egrôyCk
 *
pCheck
,

57815 
isFªeLi°
,

57816 
iPage
,

57817 
N
,

57818 *
zC⁄ãxt


57820 
i
;

57821 
ex≥˘ed
 = 
N
;

57822 
iFú°
 = 
iPage
;

57823  
N
-- > 0 && 
pCheck
->
mxEº
 ){

57824 
DbPage
 *
pOvÊPage
;

57825 *
pOvÊD©a
;

57826 if–
iPage
<1 ){

57827 
	`checkAµídMsg
(
pCheck
, 
zC⁄ãxt
,

57829 
N
+1, 
ex≥˘ed
, 
iFú°
);

57832 if–
	`checkRef
(
pCheck
, 
iPage
, 
zC⁄ãxt
) ) ;

57833 if–
	`sqlôe3PagîGë
(
pCheck
->
pPagî
, (
Pgno
)
iPage
, &
pOvÊPage
) ){

57834 
	`checkAµídMsg
(
pCheck
, 
zC⁄ãxt
, "ÁûedÅÿgëÖagê%d", 
iPage
);

57837 
pOvÊD©a
 = (*)
	`sqlôe3PagîGëD©a
(
pOvÊPage
);

57838 if–
isFªeLi°
 ){

57839 
n
 = 
	`gë4byã
(&
pOvÊD©a
[4]);

57840 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


57841 if–
pCheck
->
pBt
->
autoVacuum
 ){

57842 
	`checkPåm≠
(
pCheck
, 
iPage
, 
PTRMAP_FREEPAGE
, 0, 
zC⁄ãxt
);

57845 if–
n
>()
pCheck
->
pBt
->
ußbÀSize
/4-2 ){

57846 
	`checkAµídMsg
(
pCheck
, 
zC⁄ãxt
,

57847 "‰ìli°Üó‡cou¡Åoÿbig o¿∑gê%d", 
iPage
);

57848 
N
--;

57850 
i
=0; i<
n
; i++){

57851 
Pgno
 
iFªePage
 = 
	`gë4byã
(&
pOvÊD©a
[8+
i
*4]);

57852 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


57853 if–
pCheck
->
pBt
->
autoVacuum
 ){

57854 
	`checkPåm≠
(
pCheck
, 
iFªePage
, 
PTRMAP_FREEPAGE
, 0, 
zC⁄ãxt
);

57857 
	`checkRef
(
pCheck
, 
iFªePage
, 
zC⁄ãxt
);

57859 
N
 -
n
;

57862 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


57868 if–
pCheck
->
pBt
->
autoVacuum
 && 
N
>0 ){

57869 
i
 = 
	`gë4byã
(
pOvÊD©a
);

57870 
	`checkPåm≠
(
pCheck
, 
i
, 
PTRMAP_OVERFLOW2
, 
iPage
, 
zC⁄ãxt
);

57874 
iPage
 = 
	`gë4byã
(
pOvÊD©a
);

57875 
	`sqlôe3PagîUƒef
(
pOvÊPage
);

57880 #i‚de‡
SQLITE_OMIT_INTEGRITY_CHECK


57899 
	`checkTªePage
(

57900 
I¡egrôyCk
 *
pCheck
,

57901 
iPage
,

57902 *
zP¨ítC⁄ãxt
,

57903 
i64
 *
≤P¨ítMöKey
,

57904 
i64
 *
≤P¨ítMaxKey


57906 
MemPage
 *
pPage
;

57907 
i
, 
rc
, 
dïth
, 
d2
, 
pgno
, 
˙t
;

57908 
hdr
, 
˚ŒSèπ
;

57909 
nCñl
;

57910 
u8
 *
d©a
;

57911 
BtSh¨ed
 *
pBt
;

57912 
ußbÀSize
;

57913 
zC⁄ãxt
[100];

57914 *
hô
 = 0;

57915 
i64
 
nMöKey
 = 0;

57916 
i64
 
nMaxKey
 = 0;

57918 
	`sqlôe3_¢¥ötf
((
zC⁄ãxt
), zC⁄ãxt, "Pagê%d: ", 
iPage
);

57922 
pBt
 = 
pCheck
->pBt;

57923 
ußbÀSize
 = 
pBt
->usableSize;

57924 if–
iPage
==0 )  0;

57925 if–
	`checkRef
(
pCheck
, 
iPage
, 
zP¨ítC⁄ãxt
) )  0;

57926 if–(
rc
 = 
	`båìGëPage
(
pBt
, (
Pgno
)
iPage
, &
pPage
, 0))!=0 ){

57927 
	`checkAµídMsg
(
pCheck
, 
zC⁄ãxt
,

57928 "u«bÀÅÿgëÅhê∑ge.Éº‹ code=%d", 
rc
);

57934 
pPage
->
isInô
 = 0;

57935 if–(
rc
 = 
	`båìInôPage
(
pPage
))!=0 ){

57936 
	`as£π
–
rc
==
SQLITE_CORRUPT
 );

57937 
	`checkAµídMsg
(
pCheck
, 
zC⁄ãxt
,

57938 "båìInôPage(Ëªtu∫†îr‹ codê%d", 
rc
);

57939 
	`ªÀa£Page
(
pPage
);

57945 
dïth
 = 0;

57946 
i
=0; i<
pPage
->
nCñl
 && 
pCheck
->
mxEº
; i++){

57947 
u8
 *
pCñl
;

57948 
u32
 
sz
;

57949 
CñlInfo
 
öfo
;

57953 
	`sqlôe3_¢¥ötf
((
zC⁄ãxt
), zContext,

57954 "O¿åìÖagê%d cñ»%d: ", 
iPage
, 
i
);

57955 
pCñl
 = 
	`födCñl
(
pPage
,
i
);

57956 
	`båìP¨£CñlPå
(
pPage
, 
pCñl
, &
öfo
);

57957 
sz
 = 
öfo
.
nD©a
;

57958 if–!
pPage
->
ötKey
 ) 
sz
 +()
öfo
.
nKey
;

57961 if–
i
==0 ) 
nMöKey
 = 
nMaxKey
 = 
öfo
.
nKey
;

57963 if–
öfo
.
nKey
 <
nMaxKey
 ){

57964 
	`checkAµídMsg
(
pCheck
, 
zC⁄ãxt
,

57965 "Rowid %Œd ouào‡‹dî (¥eviou†wa†%Œd)", 
öfo
.
nKey
, 
nMaxKey
);

57967 
nMaxKey
 = 
öfo
.
nKey
;

57969 
	`as£π
–
sz
==
öfo
.
nPaylﬂd
 );

57970 if–(
sz
>
öfo
.
nLoˇl
)

57971 && (&
pCñl
[
öfo
.
iOvîÊow
]<=&
pPage
->
aD©a
[
pBt
->
ußbÀSize
])

57973 
nPage
 = (
sz
 - 
öfo
.
nLoˇl
 + 
ußbÀSize
 - 5)/(usableSize - 4);

57974 
Pgno
 
pgnoOvÊ
 = 
	`gë4byã
(&
pCñl
[
öfo
.
iOvîÊow
]);

57975 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


57976 if–
pBt
->
autoVacuum
 ){

57977 
	`checkPåm≠
(
pCheck
, 
pgnoOvÊ
, 
PTRMAP_OVERFLOW1
, 
iPage
, 
zC⁄ãxt
);

57980 
	`checkLi°
(
pCheck
, 0, 
pgnoOvÊ
, 
nPage
, 
zC⁄ãxt
);

57985 if–!
pPage
->
Àaf
 ){

57986 
pgno
 = 
	`gë4byã
(
pCñl
);

57987 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


57988 if–
pBt
->
autoVacuum
 ){

57989 
	`checkPåm≠
(
pCheck
, 
pgno
, 
PTRMAP_BTREE
, 
iPage
, 
zC⁄ãxt
);

57992 
d2
 = 
	`checkTªePage
(
pCheck
, 
pgno
, 
zC⁄ãxt
, &
nMöKey
, 
i
==0 ? 
NULL
 : &
nMaxKey
);

57993 if–
i
>0 && 
d2
!=
dïth
 ){

57994 
	`checkAµídMsg
(
pCheck
, 
zC⁄ãxt
, "ChildÖage depth differs");

57996 
dïth
 = 
d2
;

58000 if–!
pPage
->
Àaf
 ){

58001 
pgno
 = 
	`gë4byã
(&
pPage
->
aD©a
[pPage->
hdrOff£t
+8]);

58002 
	`sqlôe3_¢¥ötf
((
zC⁄ãxt
), zContext,

58003 "O¿∑gê%dáàrighàchûd: ", 
iPage
);

58004 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


58005 if–
pBt
->
autoVacuum
 ){

58006 
	`checkPåm≠
(
pCheck
, 
pgno
, 
PTRMAP_BTREE
, 
iPage
, 
zC⁄ãxt
);

58009 
	`checkTªePage
(
pCheck
, 
pgno
, 
zC⁄ãxt
, 
NULL
, !
pPage
->
nCñl
 ? NULL : &
nMaxKey
);

58015 if–
pPage
->
Àaf
 &&ÖPage->
ötKey
 ){

58017 if–
≤P¨ítMöKey
 ){

58019 if–!
≤P¨ítMaxKey
 ){

58020 if–
nMaxKey
 > *
≤P¨ítMöKey
 ){

58021 
	`checkAµídMsg
(
pCheck
, 
zC⁄ãxt
,

58023 
nMaxKey
, *
≤P¨ítMöKey
);

58026 if–
nMöKey
 <*
≤P¨ítMöKey
 ){

58027 
	`checkAµídMsg
(
pCheck
, 
zC⁄ãxt
,

58029 
nMöKey
, *
≤P¨ítMöKey
);

58031 if–
nMaxKey
 > *
≤P¨ítMaxKey
 ){

58032 
	`checkAµídMsg
(
pCheck
, 
zC⁄ãxt
,

58034 
nMaxKey
, *
≤P¨ítMaxKey
);

58036 *
≤P¨ítMöKey
 = 
nMaxKey
;

58039 } if–
≤P¨ítMaxKey
 ){

58040 if–
nMöKey
 <*
≤P¨ítMaxKey
 ){

58041 
	`checkAµídMsg
(
pCheck
, 
zC⁄ãxt
,

58043 
nMöKey
, *
≤P¨ítMaxKey
);

58050 
d©a
 = 
pPage
->
aD©a
;

58051 
hdr
 = 
pPage
->
hdrOff£t
;

58052 
hô
 = 
	`sqlôe3PageMÆloc
–
pBt
->
∑geSize
 );

58053 if–
hô
==0 ){

58054 
pCheck
->
mÆlocFaûed
 = 1;

58056 
c⁄ã¡Off£t
 = 
	`gë2byãNŸZîo
(&
d©a
[
hdr
+5]);

58057 
	`as£π
–
c⁄ã¡Off£t
<=
ußbÀSize
 );

58058 
	`mem£t
(
hô
+
c⁄ã¡Off£t
, 0, 
ußbÀSize
-contentOffset);

58059 
	`mem£t
(
hô
, 1, 
c⁄ã¡Off£t
);

58060 
nCñl
 = 
	`gë2byã
(&
d©a
[
hdr
+3]);

58061 
˚ŒSèπ
 = 
hdr
 + 12 - 4*
pPage
->
Àaf
;

58062 
i
=0; i<
nCñl
; i++){

58063 
pc
 = 
	`gë2byã
(&
d©a
[
˚ŒSèπ
+
i
*2]);

58064 
u32
 
size
 = 65536;

58065 
j
;

58066 if–
pc
<=
ußbÀSize
-4 ){

58067 
size
 = 
	`˚ŒSizePå
(
pPage
, &
d©a
[
pc
]);

58069 if–()(
pc
+
size
-1)>=
ußbÀSize
 ){

58070 
	`checkAµídMsg
(
pCheck
, 0,

58071 "C‹ru±i⁄ dëe˘ed i¿˚Œ %d o¿∑gê%d",
i
,
iPage
);

58073 
j
=
pc
+
size
-1; j>ıc; j--Ë
hô
[j]++;

58076 
i
 = 
	`gë2byã
(&
d©a
[
hdr
+1]);

58077  
i
>0 ){

58078 
size
, 
j
;

58079 
	`as£π
–
i
<=
ußbÀSize
-4 );

58080 
size
 = 
	`gë2byã
(&
d©a
[
i
+2]);

58081 
	`as£π
–
i
+
size
<=
ußbÀSize
 );

58082 
j
=
i
+
size
-1; j>=i; j--Ë
hô
[j]++;

58083 
j
 = 
	`gë2byã
(&
d©a
[
i
]);

58084 
	`as£π
–
j
==0 || j>
i
+
size
 );

58085 
	`as£π
–
j
<=
ußbÀSize
-4 );

58086 
i
 = 
j
;

58088 
i
=
˙t
=0; i<
ußbÀSize
; i++){

58089 if–
hô
[
i
]==0 ){

58090 
˙t
++;

58091 }if–
hô
[
i
]>1 ){

58092 
	`checkAµídMsg
(
pCheck
, 0,

58093 "Mu…ùÀ u£†f‹ byã %d o‡∑gê%d", 
i
, 
iPage
);

58097 if–
˙t
!=
d©a
[
hdr
+7] ){

58098 
	`checkAµídMsg
(
pCheck
, 0,

58100 
˙t
, 
d©a
[
hdr
+7], 
iPage
);

58103 
	`sqlôe3PageFªe
(
hô
);

58104 
	`ªÀa£Page
(
pPage
);

58105  
dïth
+1;

58109 #i‚de‡
SQLITE_OMIT_INTEGRITY_CHECK


58123 
SQLITE_PRIVATE
 *
	`sqlôe3BåìI¡egrôyCheck
(

58124 
Båì
 *
p
,

58125 *
aRoŸ
,

58126 
nRoŸ
,

58127 
mxEº
,

58128 *
≤Eº


58130 
Pgno
 
i
;

58131 
nRef
;

58132 
I¡egrôyCk
 
sCheck
;

58133 
BtSh¨ed
 *
pBt
 = 
p
->pBt;

58134 
zEº
[100];

58136 
	`sqlôe3BåìE¡î
(
p
);

58137 
	`as£π
–
p
->
öTøns
>
TRANS_NONE
 && 
pBt
->
öTønß˘i⁄
>TRANS_NONE );

58138 
nRef
 = 
	`sqlôe3PagîRefcou¡
(
pBt
->
pPagî
);

58139 
sCheck
.
pBt
 =ÖBt;

58140 
sCheck
.
pPagî
 = 
pBt
->pPager;

58141 
sCheck
.
nPage
 = 
	`båìPagecou¡
(sCheck.
pBt
);

58142 
sCheck
.
mxEº
 = mxErr;

58143 
sCheck
.
nEº
 = 0;

58144 
sCheck
.
mÆlocFaûed
 = 0;

58145 *
≤Eº
 = 0;

58146 if–
sCheck
.
nPage
==0 ){

58147 
	`sqlôe3BåìLóve
(
p
);

58151 
sCheck
.
aPgRef
 = 
	`sqlôe3MÆlocZîo
((sCheck.
nPage
 / 8)+ 1);

58152 if–!
sCheck
.
aPgRef
 ){

58153 *
≤Eº
 = 1;

58154 
	`sqlôe3BåìLóve
(
p
);

58157 
i
 = 
	`PENDING_BYTE_PAGE
(
pBt
);

58158 if–
i
<=
sCheck
.
nPage
 ) 
	`£tPageRe„ªn˚d
(&sCheck, i);

58159 
	`sqlôe3SåAccumInô
(&
sCheck
.
îrMsg
, 
zEº
, (zEº), 
SQLITE_MAX_LENGTH
);

58160 
sCheck
.
îrMsg
.
u£MÆloc
 = 2;

58164 
	`checkLi°
(&
sCheck
, 1, 
	`gë4byã
(&
pBt
->
pPage1
->
aD©a
[32]),

58165 
	`gë4byã
(&
pBt
->
pPage1
->
aD©a
[36]), "Main freelist: ");

58169 
i
=0; ()i<
nRoŸ
 && 
sCheck
.
mxEº
; i++){

58170 if–
aRoŸ
[
i
]==0 ) ;

58171 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


58172 if–
pBt
->
autoVacuum
 && 
aRoŸ
[
i
]>1 ){

58173 
	`checkPåm≠
(&
sCheck
, 
aRoŸ
[
i
], 
PTRMAP_ROOTPAGE
, 0, 0);

58176 
	`checkTªePage
(&
sCheck
, 
aRoŸ
[
i
], "Li° o‡åìÑoŸs: ", 
NULL
, NULL);

58181 
i
=1; i<=
sCheck
.
nPage
 && sCheck.
mxEº
; i++){

58182 #ifde‡
SQLITE_OMIT_AUTOVACUUM


58183 if–
	`gëPageRe„ªn˚d
(&
sCheck
, 
i
)==0 ){

58184 
	`checkAµídMsg
(&
sCheck
, 0, "Pagê%d i†√vî u£d", 
i
);

58190 if–
	`gëPageRe„ªn˚d
(&
sCheck
, 
i
)==0 &&

58191 (
	`PTRMAP_PAGENO
(
pBt
, 
i
)!=ò|| !pBt->
autoVacuum
) ){

58192 
	`checkAµídMsg
(&
sCheck
, 0, "Pagê%d i†√vî u£d", 
i
);

58194 if–
	`gëPageRe„ªn˚d
(&
sCheck
, 
i
)!=0 &&

58195 (
	`PTRMAP_PAGENO
(
pBt
, 
i
)==ò&&ÖBt->
autoVacuum
) ){

58196 
	`checkAµídMsg
(&
sCheck
, 0, "Poöã∏m≠Öagê%d i†ª„ªn˚d", 
i
);

58205 if–
	`NEVER
(
nRef
 !
	`sqlôe3PagîRefcou¡
(
pBt
->
pPagî
)) ){

58206 
	`checkAµídMsg
(&
sCheck
, 0,

58208 
nRef
, 
	`sqlôe3PagîRefcou¡
(
pBt
->
pPagî
)

58214 
	`sqlôe3BåìLóve
(
p
);

58215 
	`sqlôe3_‰ì
(
sCheck
.
aPgRef
);

58216 if–
sCheck
.
mÆlocFaûed
 ){

58217 
	`sqlôe3SåAccumRe£t
(&
sCheck
.
îrMsg
);

58218 *
≤Eº
 = 
sCheck
.
nEº
+1;

58221 *
≤Eº
 = 
sCheck
.
nEº
;

58222 if–
sCheck
.
nEº
==0 ) 
	`sqlôe3SåAccumRe£t
(&sCheck.
îrMsg
);

58223  
	`sqlôe3SåAccumFöish
(&
sCheck
.
îrMsg
);

58234 
SQLITE_PRIVATE
 c⁄° *
	`sqlôe3BåìGëFûíame
(
Båì
 *
p
){

58235 
	`as£π
–
p
->
pBt
->
pPagî
!=0 );

58236  
	`sqlôe3PagîFûíame
(
p
->
pBt
->
pPagî
, 1);

58247 
SQLITE_PRIVATE
 c⁄° *
	`sqlôe3BåìGëJou∫Æ«me
(
Båì
 *
p
){

58248 
	`as£π
–
p
->
pBt
->
pPagî
!=0 );

58249  
	`sqlôe3PagîJou∫Æ«me
(
p
->
pBt
->
pPagî
);

58255 
SQLITE_PRIVATE
 
	`sqlôe3BåìIsInTøns
(
Båì
 *
p
){

58256 
	`as£π
–
p
==0 || 
	`sqlôe3_muãx_hñd
’->
db
->
muãx
) );

58257  (
p
 && (p->
öTøns
==
TRANS_WRITE
));

58260 #i‚de‡
SQLITE_OMIT_WAL


58269 
SQLITE_PRIVATE
 
	`sqlôe3BåìCheckpoöt
(
Båì
 *
p
, 
eMode
, *
≤Log
, *
≤Ck±
){

58270 
rc
 = 
SQLITE_OK
;

58271 if–
p
 ){

58272 
BtSh¨ed
 *
pBt
 = 
p
->pBt;

58273 
	`sqlôe3BåìE¡î
(
p
);

58274 if–
pBt
->
öTønß˘i⁄
!=
TRANS_NONE
 ){

58275 
rc
 = 
SQLITE_LOCKED
;

58277 
rc
 = 
	`sqlôe3PagîCheckpoöt
(
pBt
->
pPagî
, 
eMode
, 
≤Log
, 
≤Ck±
);

58279 
	`sqlôe3BåìLóve
(
p
);

58281  
rc
;

58288 
SQLITE_PRIVATE
 
	`sqlôe3BåìIsInRódTøns
(
Båì
 *
p
){

58289 
	`as£π
–
p
 );

58290 
	`as£π
–
	`sqlôe3_muãx_hñd
(
p
->
db
->
muãx
) );

58291  
p
->
öTøns
!=
TRANS_NONE
;

58294 
SQLITE_PRIVATE
 
	`sqlôe3BåìIsInBackup
(
Båì
 *
p
){

58295 
	`as£π
–
p
 );

58296 
	`as£π
–
	`sqlôe3_muãx_hñd
(
p
->
db
->
muãx
) );

58297  
p
->
nBackup
!=0;

58320 
SQLITE_PRIVATE
 *
	`sqlôe3BåìSchema
(
Båì
 *
p
, 
nByãs
, (*
xFªe
)(*)){

58321 
BtSh¨ed
 *
pBt
 = 
p
->pBt;

58322 
	`sqlôe3BåìE¡î
(
p
);

58323 if–!
pBt
->
pSchema
 && 
nByãs
 ){

58324 
pBt
->
pSchema
 = 
	`sqlôe3DbMÆlocZîo
(0, 
nByãs
);

58325 
pBt
->
xFªeSchema
 = 
xFªe
;

58327 
	`sqlôe3BåìLóve
(
p
);

58328  
pBt
->
pSchema
;

58336 
SQLITE_PRIVATE
 
	`sqlôe3BåìSchemaLocked
(
Båì
 *
p
){

58337 
rc
;

58338 
	`as£π
–
	`sqlôe3_muãx_hñd
(
p
->
db
->
muãx
) );

58339 
	`sqlôe3BåìE¡î
(
p
);

58340 
rc
 = 
	`quîySh¨edCacheTabÀLock
(
p
, 
MASTER_ROOT
, 
READ_LOCK
);

58341 
	`as£π
–
rc
==
SQLITE_OK
 ||Ñc==
SQLITE_LOCKED_SHAREDCACHE
 );

58342 
	`sqlôe3BåìLóve
(
p
);

58343  
rc
;

58347 #i‚de‡
SQLITE_OMIT_SHARED_CACHE


58353 
SQLITE_PRIVATE
 
	`sqlôe3BåìLockTabÀ
(
Båì
 *
p
, 
iTab
, 
u8
 
isWrôeLock
){

58354 
rc
 = 
SQLITE_OK
;

58355 
	`as£π
–
p
->
öTøns
!=
TRANS_NONE
 );

58356 if–
p
->
sh¨abÀ
 ){

58357 
u8
 
lockTy≥
 = 
READ_LOCK
 + 
isWrôeLock
;

58358 
	`as£π
–
READ_LOCK
+1==
WRITE_LOCK
 );

58359 
	`as£π
–
isWrôeLock
==0 || isWriteLock==1 );

58361 
	`sqlôe3BåìE¡î
(
p
);

58362 
rc
 = 
	`quîySh¨edCacheTabÀLock
(
p
, 
iTab
, 
lockTy≥
);

58363 if–
rc
==
SQLITE_OK
 ){

58364 
rc
 = 
	`£tSh¨edCacheTabÀLock
(
p
, 
iTab
, 
lockTy≥
);

58366 
	`sqlôe3BåìLóve
(
p
);

58368  
rc
;

58372 #i‚de‡
SQLITE_OMIT_INCRBLOB


58383 
SQLITE_PRIVATE
 
	`sqlôe3BåìPutD©a
(
BtCurs‹
 *
pC§
, 
u32
 
off£t
, u32 
amt
, *
z
){

58384 
rc
;

58385 
	`as£π
–
	`curs‹HﬁdsMuãx
(
pC§
) );

58386 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pC§
->
pBåì
->
db
->
muãx
) );

58387 
	`as£π
–
pC§
->
isIn¸blobH™dÀ
 );

58389 
rc
 = 
	`ª°‹eCurs‹Posôi⁄
(
pC§
);

58390 if–
rc
!=
SQLITE_OK
 ){

58391  
rc
;

58393 
	`as£π
–
pC§
->
eSèã
!=
CURSOR_REQUIRESEEK
 );

58394 if–
pC§
->
eSèã
!=
CURSOR_VALID
 ){

58395  
SQLITE_ABORT
;

58406 
	`VVA_ONLY
(
rc
 =Ë
	`ßveAŒCurs‹s
(
pC§
->
pBt
,ÖC§->
pgnoRoŸ
,ÖCsr);

58407 
	`as£π
–
rc
==
SQLITE_OK
 );

58416 if–!
pC§
->
wrFœg
 ){

58417  
SQLITE_READONLY
;

58419 
	`as£π
–(
pC§
->
pBt
->
btsFœgs
 & 
BTS_READ_ONLY
)==0

58420 && 
pC§
->
pBt
->
öTønß˘i⁄
==
TRANS_WRITE
 );

58421 
	`as£π
–
	`hasSh¨edCacheTabÀLock
(
pC§
->
pBåì
,ÖC§->
pgnoRoŸ
, 0, 2) );

58422 
	`as£π
–!
	`hasRódC⁄Êi˘s
(
pC§
->
pBåì
,ÖC§->
pgnoRoŸ
) );

58423 
	`as£π
–
pC§
->
≠Page
[pC§->
iPage
]->
ötKey
 );

58425  
	`ac˚ssPaylﬂd
(
pC§
, 
off£t
, 
amt
, (*)
z
, 1);

58438 
SQLITE_PRIVATE
 
	`sqlôe3BåìCacheOvîÊow
(
BtCurs‹
 *
pCur
){

58439 
	`as£π
–
	`curs‹HﬁdsMuãx
(
pCur
) );

58440 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pCur
->
pBåì
->
db
->
muãx
) );

58441 
	`övÆid©eOvîÊowCache
(
pCur
);

58442 
pCur
->
isIn¸blobH™dÀ
 = 1;

58451 
SQLITE_PRIVATE
 
	`sqlôe3BåìSëVîsi⁄
(
Båì
 *
pBåì
, 
iVîsi⁄
){

58452 
BtSh¨ed
 *
pBt
 = 
pBåì
->pBt;

58453 
rc
;

58455 
	`as£π
–
iVîsi⁄
==1 || iVersion==2 );

58460 
pBt
->
btsFœgs
 &~
BTS_NO_WAL
;

58461 if–
iVîsi⁄
==1 ) 
pBt
->
btsFœgs
 |
BTS_NO_WAL
;

58463 
rc
 = 
	`sqlôe3BåìBegöTøns
(
pBåì
, 0);

58464 if–
rc
==
SQLITE_OK
 ){

58465 
u8
 *
aD©a
 = 
pBt
->
pPage1
->aData;

58466 if–
aD©a
[18]!=(
u8
)
iVîsi⁄
 ||áData[19]!=(u8)iVersion ){

58467 
rc
 = 
	`sqlôe3BåìBegöTøns
(
pBåì
, 2);

58468 if–
rc
==
SQLITE_OK
 ){

58469 
rc
 = 
	`sqlôe3PagîWrôe
(
pBt
->
pPage1
->
pDbPage
);

58470 if–
rc
==
SQLITE_OK
 ){

58471 
aD©a
[18] = (
u8
)
iVîsi⁄
;

58472 
aD©a
[19] = (
u8
)
iVîsi⁄
;

58478 
pBt
->
btsFœgs
 &~
BTS_NO_WAL
;

58479  
rc
;

58486 
SQLITE_PRIVATE
 
	`sqlôe3BåìCurs‹Höts
(
BtCurs‹
 *
pC§
, 
mask
){

58487 
	`as£π
–
mask
==
BTREE_BULKLOAD
 || mask==0 );

58488 
pC§
->
höts
 = 
mask
;

58511 
	ssqlôe3_backup
 {

58512 
sqlôe3
* 
pDe°Db
;

58513 
Båì
 *
pDe°
;

58514 
u32
 
iDe°Schema
;

58515 
bDe°Locked
;

58517 
Pgno
 
iNext
;

58518 
sqlôe3
* 
pSrcDb
;

58519 
Båì
 *
pSrc
;

58521 
rc
;

58526 
Pgno
 
nRemaöög
;

58527 
Pgno
 
nPagecou¡
;

58529 
isAâached
;

58530 
sqlôe3_backup
 *
pNext
;

58572 
Båì
 *
	`födBåì
(
sqlôe3
 *
pEº‹Db
, sqlôe3 *
pDb
, c⁄° *
zDb
){

58573 
i
 = 
	`sqlôe3FödDbName
(
pDb
, 
zDb
);

58575 if–
i
==1 ){

58576 
P¨£
 *
pP¨£
;

58577 
rc
 = 0;

58578 
pP¨£
 = 
	`sqlôe3SèckAŒocZîo
(
pEº‹Db
, (*pParse));

58579 if–
pP¨£
==0 ){

58580 
	`sqlôe3Eº‹
(
pEº‹Db
, 
SQLITE_NOMEM
, "out of memory");

58581 
rc
 = 
SQLITE_NOMEM
;

58583 
pP¨£
->
db
 = 
pDb
;

58584 if–
	`sqlôe3O≥nTempD©aba£
(
pP¨£
) ){

58585 
	`sqlôe3Eº‹
(
pEº‹Db
, 
pP¨£
->
rc
, "%s",ÖP¨£->
zEºMsg
);

58586 
rc
 = 
SQLITE_ERROR
;

58588 
	`sqlôe3DbFªe
(
pEº‹Db
, 
pP¨£
->
zEºMsg
);

58589 
	`sqlôe3SèckFªe
(
pEº‹Db
, 
pP¨£
);

58591 if–
rc
 ){

58596 if–
i
<0 ){

58597 
	`sqlôe3Eº‹
(
pEº‹Db
, 
SQLITE_ERROR
, "unknow¿d©aba£ %s", 
zDb
);

58601  
pDb
->
aDb
[
i
].
pBt
;

58608 
	`£tDe°Pgsz
(
sqlôe3_backup
 *
p
){

58609 
rc
;

58610 
rc
 = 
	`sqlôe3BåìSëPageSize
(
p
->
pDe°
,
	`sqlôe3BåìGëPageSize
’->
pSrc
),-1,0);

58611  
rc
;

58622 
SQLITE_API
 
sqlôe3_backup
 *
	`sqlôe3_backup_öô
(

58623 
sqlôe3
* 
pDe°Db
,

58624 c⁄° *
zDe°Db
,

58625 
sqlôe3
* 
pSrcDb
,

58626 c⁄° *
zSrcDb


58628 
sqlôe3_backup
 *
p
;

58638 
	`sqlôe3_muãx_íãr
(
pSrcDb
->
muãx
);

58639 
	`sqlôe3_muãx_íãr
(
pDe°Db
->
muãx
);

58641 if–
pSrcDb
==
pDe°Db
 ){

58642 
	`sqlôe3Eº‹
(

58643 
pDe°Db
, 
SQLITE_ERROR
, "sourceánd destination must be distinct"

58645 
p
 = 0;

58651 
p
 = (
sqlôe3_backup
 *)
	`sqlôe3MÆlocZîo
((sqlite3_backup));

58652 if–!
p
 ){

58653 
	`sqlôe3Eº‹
(
pDe°Db
, 
SQLITE_NOMEM
, 0);

58658 if–
p
 ){

58659 
p
->
pSrc
 = 
	`födBåì
(
pDe°Db
, 
pSrcDb
, 
zSrcDb
);

58660 
p
->
pDe°
 = 
	`födBåì
(
pDe°Db
,ÖDe°Db, 
zDe°Db
);

58661 
p
->
pDe°Db
 =ÖDestDb;

58662 
p
->
pSrcDb
 =ÖSrcDb;

58663 
p
->
iNext
 = 1;

58664 
p
->
isAâached
 = 0;

58666 if–0==
p
->
pSrc
 || 0=ı->
pDe°
 || 
	`£tDe°Pgsz
’)==
SQLITE_NOMEM
 ){

58672 
	`sqlôe3_‰ì
(
p
);

58673 
p
 = 0;

58676 if–
p
 ){

58677 
p
->
pSrc
->
nBackup
++;

58680 
	`sqlôe3_muãx_Àave
(
pDe°Db
->
muãx
);

58681 
	`sqlôe3_muãx_Àave
(
pSrcDb
->
muãx
);

58682  
p
;

58690 
	`isF©ÆEº‹
(
rc
){

58691  (
rc
!=
SQLITE_OK
 &&Ñc!=
SQLITE_BUSY
 && 
	`ALWAYS
‘c!=
SQLITE_LOCKED
));

58699 
	`backupO√Page
(

58700 
sqlôe3_backup
 *
p
,

58701 
Pgno
 
iSrcPg
,

58702 c⁄° 
u8
 *
zSrcD©a
,

58703 
bUpd©e


58705 
Pagî
 * c⁄° 
pDe°Pagî
 = 
	`sqlôe3BåìPagî
(
p
->
pDe°
);

58706 c⁄° 
nSrcPgsz
 = 
	`sqlôe3BåìGëPageSize
(
p
->
pSrc
);

58707 
nDe°Pgsz
 = 
	`sqlôe3BåìGëPageSize
(
p
->
pDe°
);

58708 c⁄° 
nC›y
 = 
	`MIN
(
nSrcPgsz
, 
nDe°Pgsz
);

58709 c⁄° 
i64
 
iEnd
 = (i64)
iSrcPg
*(i64)
nSrcPgsz
;

58710 #ifde‡
SQLITE_HAS_CODEC


58714 
nSrcRe£rve
 = 
	`sqlôe3BåìGëRe£rveNoMuãx
(
p
->
pSrc
);

58715 
nDe°Re£rve
 = 
	`sqlôe3BåìGëRe£rve
(
p
->
pDe°
);

58717 
rc
 = 
SQLITE_OK
;

58718 
i64
 
iOff
;

58720 
	`as£π
–
	`sqlôe3BåìGëRe£rveNoMuãx
(
p
->
pSrc
)>=0 );

58721 
	`as£π
–
p
->
bDe°Locked
 );

58722 
	`as£π
–!
	`isF©ÆEº‹
(
p
->
rc
) );

58723 
	`as£π
–
iSrcPg
!=
	`PENDING_BYTE_PAGE
(
p
->
pSrc
->
pBt
) );

58724 
	`as£π
–
zSrcD©a
 );

58729 if–
nSrcPgsz
!=
nDe°Pgsz
 && 
	`sqlôe3PagîIsMemdb
(
pDe°Pagî
) ){

58730 
rc
 = 
SQLITE_READONLY
;

58733 #ifde‡
SQLITE_HAS_CODEC


58737 if–
nSrcPgsz
!=
nDe°Pgsz
 && 
	`sqlôe3PagîGëCodec
(
pDe°Pagî
)!=0 ){

58738 
rc
 = 
SQLITE_READONLY
;

58746 if–
nSrcRe£rve
!=
nDe°Re£rve
 ){

58747 
u32
 
√wPgsz
 = 
nSrcPgsz
;

58748 
rc
 = 
	`sqlôe3PagîSëPagesize
(
pDe°Pagî
, &
√wPgsz
, 
nSrcRe£rve
);

58749 if–
rc
==
SQLITE_OK
 && 
√wPgsz
!=
nSrcPgsz
 )Ñ¯
SQLITE_READONLY
;

58757 
iOff
=
iEnd
-(
i64
)
nSrcPgsz
; 
rc
==
SQLITE_OK
 && iOff<iEnd; iOff+=
nDe°Pgsz
){

58758 
DbPage
 *
pDe°Pg
 = 0;

58759 
Pgno
 
iDe°
 = (Pgno)(
iOff
/
nDe°Pgsz
)+1;

58760 if–
iDe°
==
	`PENDING_BYTE_PAGE
(
p
->
pDe°
->
pBt
) ) ;

58761 if–
SQLITE_OK
==(
rc
 = 
	`sqlôe3PagîGë
(
pDe°Pagî
, 
iDe°
, &
pDe°Pg
))

58762 && 
SQLITE_OK
==(
rc
 = 
	`sqlôe3PagîWrôe
(
pDe°Pg
))

58764 c⁄° 
u8
 *
zIn
 = &
zSrcD©a
[
iOff
%
nSrcPgsz
];

58765 
u8
 *
zDe°D©a
 = 
	`sqlôe3PagîGëD©a
(
pDe°Pg
);

58766 
u8
 *
zOut
 = &
zDe°D©a
[
iOff
%
nDe°Pgsz
];

58775 
	`mem˝y
(
zOut
, 
zIn
, 
nC›y
);

58776 ((
u8
 *)
	`sqlôe3PagîGëExåa
(
pDe°Pg
))[0] = 0;

58777 if–
iOff
==0 && 
bUpd©e
==0 ){

58778 
	`sqlôe3Put4byã
(&
zOut
[28], 
	`sqlôe3BåìLa°Page
(
p
->
pSrc
));

58781 
	`sqlôe3PagîUƒef
(
pDe°Pg
);

58784  
rc
;

58795 
	`backupTrunˇãFûe
(
sqlôe3_fûe
 *
pFûe
, 
i64
 
iSize
){

58796 
i64
 
iCuºít
;

58797 
rc
 = 
	`sqlôe3OsFûeSize
(
pFûe
, &
iCuºít
);

58798 if–
rc
==
SQLITE_OK
 && 
iCuºít
>
iSize
 ){

58799 
rc
 = 
	`sqlôe3OsTrunˇã
(
pFûe
, 
iSize
);

58801  
rc
;

58808 
	`©èchBackupObje˘
(
sqlôe3_backup
 *
p
){

58809 
sqlôe3_backup
 **
µ
;

58810 
	`as£π
–
	`sqlôe3BåìHﬁdsMuãx
(
p
->
pSrc
) );

58811 
µ
 = 
	`sqlôe3PagîBackupPå
(
	`sqlôe3BåìPagî
(
p
->
pSrc
));

58812 
p
->
pNext
 = *
µ
;

58813 *
µ
 = 
p
;

58814 
p
->
isAâached
 = 1;

58820 
SQLITE_API
 
	`sqlôe3_backup_°ï
(
sqlôe3_backup
 *
p
, 
nPage
){

58821 
rc
;

58822 
de°Mode
;

58823 
pgszSrc
 = 0;

58824 
pgszDe°
 = 0;

58826 
	`sqlôe3_muãx_íãr
(
p
->
pSrcDb
->
muãx
);

58827 
	`sqlôe3BåìE¡î
(
p
->
pSrc
);

58828 if–
p
->
pDe°Db
 ){

58829 
	`sqlôe3_muãx_íãr
(
p
->
pDe°Db
->
muãx
);

58832 
rc
 = 
p
->rc;

58833 if–!
	`isF©ÆEº‹
(
rc
) ){

58834 
Pagî
 * c⁄° 
pSrcPagî
 = 
	`sqlôe3BåìPagî
(
p
->
pSrc
);

58835 
Pagî
 * c⁄° 
pDe°Pagî
 = 
	`sqlôe3BåìPagî
(
p
->
pDe°
);

58836 
ii
;

58837 
nSrcPage
 = -1;

58838 
bClo£Tøns
 = 0;

58843 if–
p
->
pDe°Db
 &&Ö->
pSrc
->
pBt
->
öTønß˘i⁄
==
TRANS_WRITE
 ){

58844 
rc
 = 
SQLITE_BUSY
;

58846 
rc
 = 
SQLITE_OK
;

58850 if–
SQLITE_OK
==
rc
 && 
p
->
bDe°Locked
==0

58851 && 
SQLITE_OK
==(
rc
 = 
	`sqlôe3BåìBegöTøns
(
p
->
pDe°
, 2))

58853 
p
->
bDe°Locked
 = 1;

58854 
	`sqlôe3BåìGëMëa
(
p
->
pDe°
, 
BTREE_SCHEMA_VERSION
, &p->
iDe°Schema
);

58861 if–
rc
==
SQLITE_OK
 && 0==
	`sqlôe3BåìIsInRódTøns
(
p
->
pSrc
) ){

58862 
rc
 = 
	`sqlôe3BåìBegöTøns
(
p
->
pSrc
, 0);

58863 
bClo£Tøns
 = 1;

58868 
pgszSrc
 = 
	`sqlôe3BåìGëPageSize
(
p
->
pSrc
);

58869 
pgszDe°
 = 
	`sqlôe3BåìGëPageSize
(
p
->
pDe°
);

58870 
de°Mode
 = 
	`sqlôe3PagîGëJou∫ÆMode
(
	`sqlôe3BåìPagî
(
p
->
pDe°
));

58871 if–
SQLITE_OK
==
rc
 && 
de°Mode
==
PAGER_JOURNALMODE_WAL
 && 
pgszSrc
!=
pgszDe°
 ){

58872 
rc
 = 
SQLITE_READONLY
;

58878 
nSrcPage
 = ()
	`sqlôe3BåìLa°Page
(
p
->
pSrc
);

58879 
	`as£π
–
nSrcPage
>=0 );

58880 
ii
=0; (
nPage
<0 || ii<nPageË&& 
p
->
iNext
<=(
Pgno
)
nSrcPage
 && !
rc
; ii++){

58881 c⁄° 
Pgno
 
iSrcPg
 = 
p
->
iNext
;

58882 if–
iSrcPg
!=
	`PENDING_BYTE_PAGE
(
p
->
pSrc
->
pBt
) ){

58883 
DbPage
 *
pSrcPg
;

58884 
rc
 = 
	`sqlôe3PagîAcquúe
(
pSrcPagî
, 
iSrcPg
, &
pSrcPg
,

58885 
PAGER_GET_READONLY
);

58886 if–
rc
==
SQLITE_OK
 ){

58887 
rc
 = 
	`backupO√Page
(
p
, 
iSrcPg
, 
	`sqlôe3PagîGëD©a
(
pSrcPg
), 0);

58888 
	`sqlôe3PagîUƒef
(
pSrcPg
);

58891 
p
->
iNext
++;

58893 if–
rc
==
SQLITE_OK
 ){

58894 
p
->
nPagecou¡
 = 
nSrcPage
;

58895 
p
->
nRemaöög
 = 
nSrcPage
+1-p->
iNext
;

58896 if–
p
->
iNext
>(
Pgno
)
nSrcPage
 ){

58897 
rc
 = 
SQLITE_DONE
;

58898 }if–!
p
->
isAâached
 ){

58899 
	`©èchBackupObje˘
(
p
);

58908 if–
rc
==
SQLITE_DONE
 ){

58909 if–
nSrcPage
==0 ){

58910 
rc
 = 
	`sqlôe3BåìNewDb
(
p
->
pDe°
);

58911 
nSrcPage
 = 1;

58913 if–
rc
==
SQLITE_OK
 ||Ñc==
SQLITE_DONE
 ){

58914 
rc
 = 
	`sqlôe3BåìUpd©eMëa
(
p
->
pDe°
,1,p->
iDe°Schema
+1);

58916 if–
rc
==
SQLITE_OK
 ){

58917 if–
p
->
pDe°Db
 ){

58918 
	`sqlôe3Re£tAŒSchemasOfC⁄√˘i⁄
(
p
->
pDe°Db
);

58920 if–
de°Mode
==
PAGER_JOURNALMODE_WAL
 ){

58921 
rc
 = 
	`sqlôe3BåìSëVîsi⁄
(
p
->
pDe°
, 2);

58924 if–
rc
==
SQLITE_OK
 ){

58925 
nDe°Trunˇã
;

58938 
	`as£π
–
pgszSrc
==
	`sqlôe3BåìGëPageSize
(
p
->
pSrc
) );

58939 
	`as£π
–
pgszDe°
==
	`sqlôe3BåìGëPageSize
(
p
->
pDe°
) );

58940 if–
pgszSrc
<
pgszDe°
 ){

58941 
øtio
 = 
pgszDe°
/
pgszSrc
;

58942 
nDe°Trunˇã
 = (
nSrcPage
+
øtio
-1)/ratio;

58943 if–
nDe°Trunˇã
==()
	`PENDING_BYTE_PAGE
(
p
->
pDe°
->
pBt
) ){

58944 
nDe°Trunˇã
--;

58947 
nDe°Trunˇã
 = 
nSrcPage
 * (
pgszSrc
/
pgszDe°
);

58949 
	`as£π
–
nDe°Trunˇã
>0 );

58951 if–
pgszSrc
<
pgszDe°
 ){

58961 c⁄° 
i64
 
iSize
 = (i64)
pgszSrc
 * (i64)
nSrcPage
;

58962 
sqlôe3_fûe
 * c⁄° 
pFûe
 = 
	`sqlôe3PagîFûe
(
pDe°Pagî
);

58963 
Pgno
 
iPg
;

58964 
nD°Page
;

58965 
i64
 
iOff
;

58966 
i64
 
iEnd
;

58968 
	`as£π
–
pFûe
 );

58969 
	`as£π
–
nDe°Trunˇã
==0

58970 || (
i64
)
nDe°Trunˇã
*(i64)
pgszDe°
 >
iSize
 || (

58971 
nDe°Trunˇã
==()(
	`PENDING_BYTE_PAGE
(
p
->
pDe°
->
pBt
)-1)

58972 && 
iSize
>=
PENDING_BYTE
 && iSize<=PENDING_BYTE+
pgszDe°


58981 
	`sqlôe3PagîPagecou¡
(
pDe°Pagî
, &
nD°Page
);

58982 
iPg
=
nDe°Trunˇã
; 
rc
==
SQLITE_OK
 && iPg<=(
Pgno
)
nD°Page
; iPg++){

58983 if–
iPg
!=
	`PENDING_BYTE_PAGE
(
p
->
pDe°
->
pBt
) ){

58984 
DbPage
 *
pPg
;

58985 
rc
 = 
	`sqlôe3PagîGë
(
pDe°Pagî
, 
iPg
, &
pPg
);

58986 if–
rc
==
SQLITE_OK
 ){

58987 
rc
 = 
	`sqlôe3PagîWrôe
(
pPg
);

58988 
	`sqlôe3PagîUƒef
(
pPg
);

58992 if–
rc
==
SQLITE_OK
 ){

58993 
rc
 = 
	`sqlôe3PagîCommôPha£O√
(
pDe°Pagî
, 0, 1);

58997 
iEnd
 = 
	`MIN
(
PENDING_BYTE
 + 
pgszDe°
, 
iSize
);

58999 
iOff
=
PENDING_BYTE
+
pgszSrc
;

59000 
rc
==
SQLITE_OK
 && 
iOff
<
iEnd
;

59001 
iOff
+=
pgszSrc


59003 
PgHdr
 *
pSrcPg
 = 0;

59004 c⁄° 
Pgno
 
iSrcPg
 = (Pgno)((
iOff
/
pgszSrc
)+1);

59005 
rc
 = 
	`sqlôe3PagîGë
(
pSrcPagî
, 
iSrcPg
, &
pSrcPg
);

59006 if–
rc
==
SQLITE_OK
 ){

59007 
u8
 *
zD©a
 = 
	`sqlôe3PagîGëD©a
(
pSrcPg
);

59008 
rc
 = 
	`sqlôe3OsWrôe
(
pFûe
, 
zD©a
, 
pgszSrc
, 
iOff
);

59010 
	`sqlôe3PagîUƒef
(
pSrcPg
);

59012 if–
rc
==
SQLITE_OK
 ){

59013 
rc
 = 
	`backupTrunˇãFûe
(
pFûe
, 
iSize
);

59017 if–
rc
==
SQLITE_OK
 ){

59018 
rc
 = 
	`sqlôe3PagîSync
(
pDe°Pagî
);

59021 
	`sqlôe3PagîTrunˇãImage
(
pDe°Pagî
, 
nDe°Trunˇã
);

59022 
rc
 = 
	`sqlôe3PagîCommôPha£O√
(
pDe°Pagî
, 0, 0);

59026 if–
SQLITE_OK
==
rc


59027 && 
SQLITE_OK
==(
rc
 = 
	`sqlôe3BåìCommôPha£Two
(
p
->
pDe°
, 0))

59029 
rc
 = 
SQLITE_DONE
;

59039 if–
bClo£Tøns
 ){

59040 
	`TESTONLY
–
rc2
 );

59041 
	`TESTONLY
–
rc2
 = ) 
	`sqlôe3BåìCommôPha£O√
(
p
->
pSrc
, 0);

59042 
	`TESTONLY
–
rc2
 |Ë
	`sqlôe3BåìCommôPha£Two
(
p
->
pSrc
, 0);

59043 
	`as£π
–
rc2
==
SQLITE_OK
 );

59046 if–
rc
==
SQLITE_IOERR_NOMEM
 ){

59047 
rc
 = 
SQLITE_NOMEM
;

59049 
p
->
rc
 =Ñc;

59051 if–
p
->
pDe°Db
 ){

59052 
	`sqlôe3_muãx_Àave
(
p
->
pDe°Db
->
muãx
);

59054 
	`sqlôe3BåìLóve
(
p
->
pSrc
);

59055 
	`sqlôe3_muãx_Àave
(
p
->
pSrcDb
->
muãx
);

59056  
rc
;

59062 
SQLITE_API
 
	`sqlôe3_backup_föish
(
sqlôe3_backup
 *
p
){

59063 
sqlôe3_backup
 **
µ
;

59064 
sqlôe3
 *
pSrcDb
;

59065 
rc
;

59068 if–
p
==0 )  
SQLITE_OK
;

59069 
pSrcDb
 = 
p
->pSrcDb;

59070 
	`sqlôe3_muãx_íãr
(
pSrcDb
->
muãx
);

59071 
	`sqlôe3BåìE¡î
(
p
->
pSrc
);

59072 if–
p
->
pDe°Db
 ){

59073 
	`sqlôe3_muãx_íãr
(
p
->
pDe°Db
->
muãx
);

59077 if–
p
->
pDe°Db
 ){

59078 
p
->
pSrc
->
nBackup
--;

59080 if–
p
->
isAâached
 ){

59081 
µ
 = 
	`sqlôe3PagîBackupPå
(
	`sqlôe3BåìPagî
(
p
->
pSrc
));

59082  *
µ
!=
p
 ){

59083 
µ
 = &(*µ)->
pNext
;

59085 *
µ
 = 
p
->
pNext
;

59089 
	`sqlôe3BåìRﬁlback
(
p
->
pDe°
, 
SQLITE_OK
);

59092 
rc
 = (
p
->rc==
SQLITE_DONE
Ë? 
SQLITE_OK
 :Ö->rc;

59093 
	`sqlôe3Eº‹
(
p
->
pDe°Db
, 
rc
, 0);

59096 if–
p
->
pDe°Db
 ){

59097 
	`sqlôe3LóveMuãxAndClo£Zombõ
(
p
->
pDe°Db
);

59099 
	`sqlôe3BåìLóve
(
p
->
pSrc
);

59100 if–
p
->
pDe°Db
 ){

59104 
	`sqlôe3_‰ì
(
p
);

59106 
	`sqlôe3LóveMuãxAndClo£Zombõ
(
pSrcDb
);

59107  
rc
;

59114 
SQLITE_API
 
	`sqlôe3_backup_ªmaöög
(
sqlôe3_backup
 *
p
){

59115  
p
->
nRemaöög
;

59122 
SQLITE_API
 
	`sqlôe3_backup_∑gecou¡
(
sqlôe3_backup
 *
p
){

59123  
p
->
nPagecou¡
;

59138 
SQLITE_PRIVATE
 
	`sqlôe3BackupUpd©e
(
sqlôe3_backup
 *
pBackup
, 
Pgno
 
iPage
, c⁄° 
u8
 *
aD©a
){

59139 
sqlôe3_backup
 *
p
;

59140 
p
=
pBackup
;Ö;Öı->
pNext
){

59141 
	`as£π
–
	`sqlôe3_muãx_hñd
(
p
->
pSrc
->
pBt
->
muãx
) );

59142 if–!
	`isF©ÆEº‹
(
p
->
rc
Ë&& 
iPage
<p->
iNext
 ){

59147 
rc
;

59148 
	`as£π
–
p
->
pDe°Db
 );

59149 
	`sqlôe3_muãx_íãr
(
p
->
pDe°Db
->
muãx
);

59150 
rc
 = 
	`backupO√Page
(
p
, 
iPage
, 
aD©a
, 1);

59151 
	`sqlôe3_muãx_Àave
(
p
->
pDe°Db
->
muãx
);

59152 
	`as£π
–
rc
!=
SQLITE_BUSY
 &&Ñc!=
SQLITE_LOCKED
 );

59153 if–
rc
!=
SQLITE_OK
 ){

59154 
p
->
rc
 =Ñc;

59171 
SQLITE_PRIVATE
 
	`sqlôe3BackupRe°¨t
(
sqlôe3_backup
 *
pBackup
){

59172 
sqlôe3_backup
 *
p
;

59173 
p
=
pBackup
;Ö;Öı->
pNext
){

59174 
	`as£π
–
	`sqlôe3_muãx_hñd
(
p
->
pSrc
->
pBt
->
muãx
) );

59175 
p
->
iNext
 = 1;

59179 #i‚de‡
SQLITE_OMIT_VACUUM


59188 
SQLITE_PRIVATE
 
	`sqlôe3BåìC›yFûe
(
Båì
 *
pTo
, Båì *
pFrom
){

59189 
rc
;

59190 
sqlôe3_fûe
 *
pFd
;

59191 
sqlôe3_backup
 
b
;

59192 
	`sqlôe3BåìE¡î
(
pTo
);

59193 
	`sqlôe3BåìE¡î
(
pFrom
);

59195 
	`as£π
–
	`sqlôe3BåìIsInTøns
(
pTo
) );

59196 
pFd
 = 
	`sqlôe3PagîFûe
(
	`sqlôe3BåìPagî
(
pTo
));

59197 if–
pFd
->
pMëhods
 ){

59198 
i64
 
nByã
 = 
	`sqlôe3BåìGëPageSize
(
pFrom
)*(i64)
	`sqlôe3BåìLa°Page
(pFrom);

59199 
rc
 = 
	`sqlôe3OsFûeC⁄åﬁ
(
pFd
, 
SQLITE_FCNTL_OVERWRITE
, &
nByã
);

59200 if–
rc
==
SQLITE_NOTFOUND
 )Ñ¯
SQLITE_OK
;

59201 if–
rc
 ) 
c›y_föished
;

59209 
	`mem£t
(&
b
, 0, (b));

59210 
b
.
pSrcDb
 = 
pFrom
->
db
;

59211 
b
.
pSrc
 = 
pFrom
;

59212 
b
.
pDe°
 = 
pTo
;

59213 
b
.
iNext
 = 1;

59222 
	`sqlôe3_backup_°ï
(&
b
, 0x7FFFFFFF);

59223 
	`as£π
–
b
.
rc
!=
SQLITE_OK
 );

59224 
rc
 = 
	`sqlôe3_backup_föish
(&
b
);

59225 if–
rc
==
SQLITE_OK
 ){

59226 
pTo
->
pBt
->
btsFœgs
 &~
BTS_PAGESIZE_FIXED
;

59228 
	`sqlôe3PagîCÀ¨Cache
(
	`sqlôe3BåìPagî
(
b
.
pDe°
));

59231 
	`as£π
–
	`sqlôe3BåìIsInTøns
(
pTo
)==0 );

59232 
c›y_föished
:

59233 
	`sqlôe3BåìLóve
(
pFrom
);

59234 
	`sqlôe3BåìLóve
(
pTo
);

59235  
rc
;

59272 
SQLITE_PRIVATE
 
	`sqlôe3VdbeCh™geEncodög
(
Mem
 *
pMem
, 
desúedEnc
){

59273 #i‚de‡
SQLITE_OMIT_UTF16


59274 
rc
;

59276 
	`as£π
–(
pMem
->
Êags
&
MEM_RowSë
)==0 );

59277 
	`as£π
–
desúedEnc
==
SQLITE_UTF8
 || desúedEnc==
SQLITE_UTF16LE


59278 || 
desúedEnc
==
SQLITE_UTF16BE
 );

59279 if–!(
pMem
->
Êags
&
MEM_Så
Ë||ÖMem->
íc
==
desúedEnc
 ){

59280  
SQLITE_OK
;

59282 
	`as£π
–
pMem
->
db
==0 || 
	`sqlôe3_muãx_hñd
’Mem->db->
muãx
) );

59283 #ifde‡
SQLITE_OMIT_UTF16


59284  
SQLITE_ERROR
;

59290 
rc
 = 
	`sqlôe3VdbeMemTøn¶©e
(
pMem
, (
u8
)
desúedEnc
);

59291 
	`as£π
(
rc
==
SQLITE_OK
 ||Ñc==
SQLITE_NOMEM
);

59292 
	`as£π
(
rc
==
SQLITE_OK
 || 
pMem
->
íc
!=
desúedEnc
);

59293 
	`as£π
(
rc
==
SQLITE_NOMEM
 || 
pMem
->
íc
==
desúedEnc
);

59294  
rc
;

59311 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemGrow
(
Mem
 *
pMem
, 
n
, 
¥e£rve
){

59312 
	`as£π
( 1 >=

59313 ((
pMem
->
zMÆloc
 &&ÖMem->zMÆloc=ıMem->
z
) ? 1 : 0) +

59314 (((
pMem
->
Êags
&
MEM_Dyn
)&&pMem->
xDñ
) ? 1 : 0) +

59315 ((
pMem
->
Êags
&
MEM_Ephem
) ? 1 : 0) +

59316 ((
pMem
->
Êags
&
MEM_Sètic
) ? 1 : 0)

59318 
	`as£π
–(
pMem
->
Êags
&
MEM_RowSë
)==0 );

59322 
	`as£π
–
¥e£rve
==0 || 
pMem
->
Êags
&(
MEM_Blob
|
MEM_Så
) );

59324 if–
n
<32 )Ç = 32;

59325 if–
	`sqlôe3DbMÆlocSize
(
pMem
->
db
,ÖMem->
zMÆloc
)<
n
 ){

59326 if–
¥e£rve
 && 
pMem
->
z
=ıMem->
zMÆloc
 ){

59327 
pMem
->
z
 =ÖMem->
zMÆloc
 = 
	`sqlôe3DbRóŒocOrFªe
’Mem->
db
,ÖMem->z, 
n
);

59328 
¥e£rve
 = 0;

59330 
	`sqlôe3DbFªe
(
pMem
->
db
,ÖMem->
zMÆloc
);

59331 
pMem
->
zMÆloc
 = 
	`sqlôe3DbMÆlocRaw
’Mem->
db
, 
n
);

59335 if–
pMem
->
z
 && 
¥e£rve
 &&ÖMem->
zMÆloc
 &&ÖMem->z!=pMem->zMalloc ){

59336 
	`mem˝y
(
pMem
->
zMÆloc
,ÖMem->
z
,ÖMem->
n
);

59338 if–
pMem
->
Êags
&
MEM_Dyn
 &&ÖMem->
xDñ
 ){

59339 
	`as£π
–
pMem
->
xDñ
!=
SQLITE_DYNAMIC
 );

59340 
pMem
->
	`xDñ
((*)’Mem->
z
));

59343 
pMem
->
z
 =ÖMem->
zMÆloc
;

59344 if–
pMem
->
z
==0 ){

59345 
pMem
->
Êags
 = 
MEM_NuŒ
;

59347 
pMem
->
Êags
 &~(
MEM_Ephem
|
MEM_Sètic
);

59349 
pMem
->
xDñ
 = 0;

59350  (
pMem
->
z
 ? 
SQLITE_OK
 : 
SQLITE_NOMEM
);

59361 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemMakeWrôóbÀ
(
Mem
 *
pMem
){

59362 
f
;

59363 
	`as£π
–
pMem
->
db
==0 || 
	`sqlôe3_muãx_hñd
’Mem->db->
muãx
) );

59364 
	`as£π
–(
pMem
->
Êags
&
MEM_RowSë
)==0 );

59365 
	`Ex∑ndBlob
(
pMem
);

59366 
f
 = 
pMem
->
Êags
;

59367 if–(
f
&(
MEM_Så
|
MEM_Blob
)Ë&& 
pMem
->
z
!ıMem->
zMÆloc
 ){

59368 if–
	`sqlôe3VdbeMemGrow
(
pMem
,ÖMem->
n
 + 2, 1) ){

59369  
SQLITE_NOMEM
;

59371 
pMem
->
z
[pMem->
n
] = 0;

59372 
pMem
->
z
[pMem->
n
+1] = 0;

59373 
pMem
->
Êags
 |
MEM_Tîm
;

59374 #ifde‡
SQLITE_DEBUG


59375 
pMem
->
pSc›yFrom
 = 0;

59379  
SQLITE_OK
;

59386 #i‚de‡
SQLITE_OMIT_INCRBLOB


59387 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemEx∑ndBlob
(
Mem
 *
pMem
){

59388 if–
pMem
->
Êags
 & 
MEM_Zîo
 ){

59389 
nByã
;

59390 
	`as£π
–
pMem
->
Êags
&
MEM_Blob
 );

59391 
	`as£π
–(
pMem
->
Êags
&
MEM_RowSë
)==0 );

59392 
	`as£π
–
pMem
->
db
==0 || 
	`sqlôe3_muãx_hñd
’Mem->db->
muãx
) );

59395 
nByã
 = 
pMem
->
n
 +ÖMem->
u
.
nZîo
;

59396 if–
nByã
<=0 ){

59397 
nByã
 = 1;

59399 if–
	`sqlôe3VdbeMemGrow
(
pMem
, 
nByã
, 1) ){

59400  
SQLITE_NOMEM
;

59403 
	`mem£t
(&
pMem
->
z
[pMem->
n
], 0,ÖMem->
u
.
nZîo
);

59404 
pMem
->
n
 +pMem->
u
.
nZîo
;

59405 
pMem
->
Êags
 &~(
MEM_Zîo
|
MEM_Tîm
);

59407  
SQLITE_OK
;

59415 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemNulTîmö©e
(
Mem
 *
pMem
){

59416 
	`as£π
–
pMem
->
db
==0 || 
	`sqlôe3_muãx_hñd
’Mem->db->
muãx
) );

59417 if–(
pMem
->
Êags
 & 
MEM_Tîm
)!=0 || (pMem->Êag†& 
MEM_Så
)==0 ){

59418  
SQLITE_OK
;

59420 if–
	`sqlôe3VdbeMemGrow
(
pMem
,ÖMem->
n
+2, 1) ){

59421  
SQLITE_NOMEM
;

59423 
pMem
->
z
[pMem->
n
] = 0;

59424 
pMem
->
z
[pMem->
n
+1] = 0;

59425 
pMem
->
Êags
 |
MEM_Tîm
;

59426  
SQLITE_OK
;

59442 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemSåögify
(
Mem
 *
pMem
, 
íc
){

59443 
rc
 = 
SQLITE_OK
;

59444 
fg
 = 
pMem
->
Êags
;

59445 c⁄° 
nByã
 = 32;

59447 
	`as£π
–
pMem
->
db
==0 || 
	`sqlôe3_muãx_hñd
’Mem->db->
muãx
) );

59448 
	`as£π
–!(
fg
&
MEM_Zîo
) );

59449 
	`as£π
–!(
fg
&(
MEM_Så
|
MEM_Blob
)) );

59450 
	`as£π
–
fg
&(
MEM_I¡
|
MEM_Ról
) );

59451 
	`as£π
–(
pMem
->
Êags
&
MEM_RowSë
)==0 );

59452 
	`as£π
–
	`EIGHT_BYTE_ALIGNMENT
(
pMem
) );

59455 if–
	`sqlôe3VdbeMemGrow
(
pMem
, 
nByã
, 0) ){

59456  
SQLITE_NOMEM
;

59465 if–
fg
 & 
MEM_I¡
 ){

59466 
	`sqlôe3_¢¥ötf
(
nByã
, 
pMem
->
z
, "%Œd",ÖMem->
u
.
i
);

59468 
	`as£π
–
fg
 & 
MEM_Ról
 );

59469 
	`sqlôe3_¢¥ötf
(
nByã
, 
pMem
->
z
, "%!.15g",ÖMem->
r
);

59471 
pMem
->
n
 = 
	`sqlôe3SåÀn30
’Mem->
z
);

59472 
pMem
->
íc
 = 
SQLITE_UTF8
;

59473 
pMem
->
Êags
 |
MEM_Så
|
MEM_Tîm
;

59474 
	`sqlôe3VdbeCh™geEncodög
(
pMem
, 
íc
);

59475  
rc
;

59486 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemFöÆize
(
Mem
 *
pMem
, 
FuncDef
 *
pFunc
){

59487 
rc
 = 
SQLITE_OK
;

59488 if–
	`ALWAYS
(
pFunc
 &&ÖFunc->
xFöÆize
) ){

59489 
sqlôe3_c⁄ãxt
 
˘x
;

59490 
	`as£π
–(
pMem
->
Êags
 & 
MEM_NuŒ
)!=0 || 
pFunc
=ıMem->
u
.
pDef
 );

59491 
	`as£π
–
pMem
->
db
==0 || 
	`sqlôe3_muãx_hñd
’Mem->db->
muãx
) );

59492 
	`mem£t
(&
˘x
, 0, (ctx));

59493 
˘x
.
s
.
Êags
 = 
MEM_NuŒ
;

59494 
˘x
.
s
.
db
 = 
pMem
->db;

59495 
˘x
.
pMem
 =ÖMem;

59496 
˘x
.
pFunc
 =ÖFunc;

59497 
pFunc
->
	`xFöÆize
(&
˘x
);

59498 
	`as£π
–0==(
pMem
->
Êags
&
MEM_Dyn
Ë&& !pMem->
xDñ
 );

59499 
	`sqlôe3DbFªe
(
pMem
->
db
,ÖMem->
zMÆloc
);

59500 
	`mem˝y
(
pMem
, &
˘x
.
s
, (ctx.s));

59501 
rc
 = 
˘x
.
isEº‹
;

59503  
rc
;

59511 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemRñó£Exã∫Æ
(
Mem
 *
p
){

59512 
	`as£π
–
p
->
db
==0 || 
	`sqlôe3_muãx_hñd
’->db->
muãx
) );

59513 if–
p
->
Êags
&
MEM_Agg
 ){

59514 
	`sqlôe3VdbeMemFöÆize
(
p
,Ö->
u
.
pDef
);

59515 
	`as£π
–(
p
->
Êags
 & 
MEM_Agg
)==0 );

59516 
	`sqlôe3VdbeMemRñó£
(
p
);

59517 }if–
p
->
Êags
&
MEM_Dyn
 &&Ö->
xDñ
 ){

59518 
	`as£π
–(
p
->
Êags
&
MEM_RowSë
)==0 );

59519 
	`as£π
–
p
->
xDñ
!=
SQLITE_DYNAMIC
 );

59520 
p
->
	`xDñ
((*Ì->
z
);

59521 
p
->
xDñ
 = 0;

59522 }if–
p
->
Êags
&
MEM_RowSë
 ){

59523 
	`sqlôe3RowSëCÀ¨
(
p
->
u
.
pRowSë
);

59524 }if–
p
->
Êags
&
MEM_Føme
 ){

59525 
	`sqlôe3VdbeMemSëNuŒ
(
p
);

59534 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemRñó£
(
Mem
 *
p
){

59535 
	`VdbeMemRñó£
(
p
);

59536 
	`sqlôe3DbFªe
(
p
->
db
,Ö->
zMÆloc
);

59537 
p
->
z
 = 0;

59538 
p
->
zMÆloc
 = 0;

59539 
p
->
xDñ
 = 0;

59554 
i64
 
	`doubÀToI¡64
(
r
){

59555 #ifde‡
SQLITE_OMIT_FLOATING_POINT


59557  
r
;

59566 c⁄° 
i64
 
maxI¡
 = 
LARGEST_INT64
;

59567 c⁄° 
i64
 
möI¡
 = 
SMALLEST_INT64
;

59569 if–
r
<()
möI¡
 ){

59570  
möI¡
;

59571 }if–
r
>()
maxI¡
 ){

59576  
möI¡
;

59578  (
i64
)
r
;

59594 
SQLITE_PRIVATE
 
i64
 
	`sqlôe3VdbeI¡VÆue
(
Mem
 *
pMem
){

59595 
Êags
;

59596 
	`as£π
–
pMem
->
db
==0 || 
	`sqlôe3_muãx_hñd
’Mem->db->
muãx
) );

59597 
	`as£π
–
	`EIGHT_BYTE_ALIGNMENT
(
pMem
) );

59598 
Êags
 = 
pMem
->flags;

59599 if–
Êags
 & 
MEM_I¡
 ){

59600  
pMem
->
u
.
i
;

59601 }if–
Êags
 & 
MEM_Ról
 ){

59602  
	`doubÀToI¡64
(
pMem
->
r
);

59603 }if–
Êags
 & (
MEM_Så
|
MEM_Blob
) ){

59604 
i64
 
vÆue
 = 0;

59605 
	`as£π
–
pMem
->
z
 ||ÖMem->
n
==0 );

59606 
	`ã°ˇ£
–
pMem
->
z
==0 );

59607 
	`sqlôe3Atoi64
(
pMem
->
z
, &
vÆue
,ÖMem->
n
,ÖMem->
íc
);

59608  
vÆue
;

59620 
SQLITE_PRIVATE
 
	`sqlôe3VdbeRólVÆue
(
Mem
 *
pMem
){

59621 
	`as£π
–
pMem
->
db
==0 || 
	`sqlôe3_muãx_hñd
’Mem->db->
muãx
) );

59622 
	`as£π
–
	`EIGHT_BYTE_ALIGNMENT
(
pMem
) );

59623 if–
pMem
->
Êags
 & 
MEM_Ról
 ){

59624  
pMem
->
r
;

59625 }if–
pMem
->
Êags
 & 
MEM_I¡
 ){

59626  ()
pMem
->
u
.
i
;

59627 }if–
pMem
->
Êags
 & (
MEM_Så
|
MEM_Blob
) ){

59629 
vÆ
 = ()0;

59630 
	`sqlôe3AtoF
(
pMem
->
z
, &
vÆ
,ÖMem->
n
,ÖMem->
íc
);

59631  
vÆ
;

59642 
SQLITE_PRIVATE
 
	`sqlôe3VdbeI¡egîAfföôy
(
Mem
 *
pMem
){

59643 
	`as£π
–
pMem
->
Êags
 & 
MEM_Ról
 );

59644 
	`as£π
–(
pMem
->
Êags
 & 
MEM_RowSë
)==0 );

59645 
	`as£π
–
pMem
->
db
==0 || 
	`sqlôe3_muãx_hñd
’Mem->db->
muãx
) );

59646 
	`as£π
–
	`EIGHT_BYTE_ALIGNMENT
(
pMem
) );

59648 
pMem
->
u
.
i
 = 
	`doubÀToI¡64
’Mem->
r
);

59662 if–
pMem
->
r
==(ÌMem->
u
.
i


59663 && 
pMem
->
u
.
i
>
SMALLEST_INT64


59664 #i‡
	`deföed
(
__i486__
Ë|| deföed(
__x86_64__
)

59665 && 
	`ALWAYS
(
pMem
->
u
.
i
<
LARGEST_INT64
)

59667 && 
pMem
->
u
.
i
<
LARGEST_INT64


59670 
pMem
->
Êags
 |
MEM_I¡
;

59677 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemI¡egîify
(
Mem
 *
pMem
){

59678 
	`as£π
–
pMem
->
db
==0 || 
	`sqlôe3_muãx_hñd
’Mem->db->
muãx
) );

59679 
	`as£π
–(
pMem
->
Êags
 & 
MEM_RowSë
)==0 );

59680 
	`as£π
–
	`EIGHT_BYTE_ALIGNMENT
(
pMem
) );

59682 
pMem
->
u
.
i
 = 
	`sqlôe3VdbeI¡VÆue
(pMem);

59683 
	`MemSëTy≥Fœg
(
pMem
, 
MEM_I¡
);

59684  
SQLITE_OK
;

59691 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemRólify
(
Mem
 *
pMem
){

59692 
	`as£π
–
pMem
->
db
==0 || 
	`sqlôe3_muãx_hñd
’Mem->db->
muãx
) );

59693 
	`as£π
–
	`EIGHT_BYTE_ALIGNMENT
(
pMem
) );

59695 
pMem
->
r
 = 
	`sqlôe3VdbeRólVÆue
(pMem);

59696 
	`MemSëTy≥Fœg
(
pMem
, 
MEM_Ról
);

59697  
SQLITE_OK
;

59708 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemNumîify
(
Mem
 *
pMem
){

59709 if–(
pMem
->
Êags
 & (
MEM_I¡
|
MEM_Ról
|
MEM_NuŒ
))==0 ){

59710 
	`as£π
–(
pMem
->
Êags
 & (
MEM_Blob
|
MEM_Så
))!=0 );

59711 
	`as£π
–
pMem
->
db
==0 || 
	`sqlôe3_muãx_hñd
’Mem->db->
muãx
) );

59712 if–0==
	`sqlôe3Atoi64
(
pMem
->
z
, &pMem->
u
.
i
,ÖMem->
n
,ÖMem->
íc
) ){

59713 
	`MemSëTy≥Fœg
(
pMem
, 
MEM_I¡
);

59715 
pMem
->
r
 = 
	`sqlôe3VdbeRólVÆue
(pMem);

59716 
	`MemSëTy≥Fœg
(
pMem
, 
MEM_Ról
);

59717 
	`sqlôe3VdbeI¡egîAfföôy
(
pMem
);

59720 
	`as£π
–(
pMem
->
Êags
 & (
MEM_I¡
|
MEM_Ról
|
MEM_NuŒ
))!=0 );

59721 
pMem
->
Êags
 &~(
MEM_Så
|
MEM_Blob
);

59722  
SQLITE_OK
;

59728 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemSëNuŒ
(
Mem
 *
pMem
){

59729 if–
pMem
->
Êags
 & 
MEM_Føme
 ){

59730 
VdbeFøme
 *
pFøme
 = 
pMem
->
u
.pFrame;

59731 
pFøme
->
pP¨ít
 =ÖFøme->
v
->
pDñFøme
;

59732 
pFøme
->
v
->
pDñFøme
 =ÖFrame;

59734 if–
pMem
->
Êags
 & 
MEM_RowSë
 ){

59735 
	`sqlôe3RowSëCÀ¨
(
pMem
->
u
.
pRowSë
);

59737 
	`MemSëTy≥Fœg
(
pMem
, 
MEM_NuŒ
);

59738 
pMem
->
ty≥
 = 
SQLITE_NULL
;

59745 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemSëZîoBlob
(
Mem
 *
pMem
, 
n
){

59746 
	`sqlôe3VdbeMemRñó£
(
pMem
);

59747 
pMem
->
Êags
 = 
MEM_Blob
|
MEM_Zîo
;

59748 
pMem
->
ty≥
 = 
SQLITE_BLOB
;

59749 
pMem
->
n
 = 0;

59750 if–
n
<0 )Ç = 0;

59751 
pMem
->
u
.
nZîo
 = 
n
;

59752 
pMem
->
íc
 = 
SQLITE_UTF8
;

59754 #ifde‡
SQLITE_OMIT_INCRBLOB


59755 
	`sqlôe3VdbeMemGrow
(
pMem
, 
n
, 0);

59756 if–
pMem
->
z
 ){

59757 
pMem
->
n
 =Ç;

59758 
	`mem£t
(
pMem
->
z
, 0, 
n
);

59767 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemSëI¡64
(
Mem
 *
pMem
, 
i64
 
vÆ
){

59768 
	`sqlôe3VdbeMemRñó£
(
pMem
);

59769 
pMem
->
u
.
i
 = 
vÆ
;

59770 
pMem
->
Êags
 = 
MEM_I¡
;

59771 
pMem
->
ty≥
 = 
SQLITE_INTEGER
;

59774 #i‚de‡
SQLITE_OMIT_FLOATING_POINT


59779 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemSëDoubÀ
(
Mem
 *
pMem
, 
vÆ
){

59780 if–
	`sqlôe3IsNaN
(
vÆ
) ){

59781 
	`sqlôe3VdbeMemSëNuŒ
(
pMem
);

59783 
	`sqlôe3VdbeMemRñó£
(
pMem
);

59784 
pMem
->
r
 = 
vÆ
;

59785 
pMem
->
Êags
 = 
MEM_Ról
;

59786 
pMem
->
ty≥
 = 
SQLITE_FLOAT
;

59795 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemSëRowSë
(
Mem
 *
pMem
){

59796 
sqlôe3
 *
db
 = 
pMem
->db;

59797 
	`as£π
–
db
!=0 );

59798 
	`as£π
–(
pMem
->
Êags
 & 
MEM_RowSë
)==0 );

59799 
	`sqlôe3VdbeMemRñó£
(
pMem
);

59800 
pMem
->
zMÆloc
 = 
	`sqlôe3DbMÆlocRaw
(
db
, 64);

59801 if–
db
->
mÆlocFaûed
 ){

59802 
pMem
->
Êags
 = 
MEM_NuŒ
;

59804 
	`as£π
–
pMem
->
zMÆloc
 );

59805 
pMem
->
u
.
pRowSë
 = 
	`sqlôe3RowSëInô
(
db
,ÖMem->
zMÆloc
,

59806 
	`sqlôe3DbMÆlocSize
(
db
, 
pMem
->
zMÆloc
));

59807 
	`as£π
–
pMem
->
u
.
pRowSë
!=0 );

59808 
pMem
->
Êags
 = 
MEM_RowSë
;

59816 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemTooBig
(
Mem
 *
p
){

59817 
	`as£π
–
p
->
db
!=0 );

59818 if–
p
->
Êags
 & (
MEM_Så
|
MEM_Blob
) ){

59819 
n
 = 
p
->n;

59820 if–
p
->
Êags
 & 
MEM_Zîo
 ){

59821 
n
 +
p
->
u
.
nZîo
;

59823  
n
>
p
->
db
->
aLimô
[
SQLITE_LIMIT_LENGTH
];

59828 #ifde‡
SQLITE_DEBUG


59837 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemAboutToCh™ge
(
Vdbe
 *
pVdbe
, 
Mem
 *
pMem
){

59838 
i
;

59839 
Mem
 *
pX
;

59840 
i
=1, 
pX
=&
pVdbe
->
aMem
[1]; i<ıVdbe->
nMem
; i++,ÖX++){

59841 if–
pX
->
pSc›yFrom
==
pMem
 ){

59842 
pX
->
Êags
 |
MEM_InvÆid
;

59843 
pX
->
pSc›yFrom
 = 0;

59846 
pMem
->
pSc›yFrom
 = 0;

59853 
	#MEMCELLSIZE
 (
size_t
)(&(((
Mem
 *)0)->
zMÆloc
))

	)

59861 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemShÆlowC›y
(
Mem
 *
pTo
, c⁄° Mem *
pFrom
, 
§cTy≥
){

59862 
	`as£π
–(
pFrom
->
Êags
 & 
MEM_RowSë
)==0 );

59863 
	`VdbeMemRñó£
(
pTo
);

59864 
	`mem˝y
(
pTo
, 
pFrom
, 
MEMCELLSIZE
);

59865 
pTo
->
xDñ
 = 0;

59866 if–(
pFrom
->
Êags
&
MEM_Sètic
)==0 ){

59867 
pTo
->
Êags
 &~(
MEM_Dyn
|
MEM_Sètic
|
MEM_Ephem
);

59868 
	`as£π
–
§cTy≥
==
MEM_Ephem
 || srcTy≥==
MEM_Sètic
 );

59869 
pTo
->
Êags
 |
§cTy≥
;

59877 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemC›y
(
Mem
 *
pTo
, c⁄° Mem *
pFrom
){

59878 
rc
 = 
SQLITE_OK
;

59880 
	`as£π
–(
pFrom
->
Êags
 & 
MEM_RowSë
)==0 );

59881 
	`VdbeMemRñó£
(
pTo
);

59882 
	`mem˝y
(
pTo
, 
pFrom
, 
MEMCELLSIZE
);

59883 
pTo
->
Êags
 &~
MEM_Dyn
;

59885 if–
pTo
->
Êags
&(
MEM_Så
|
MEM_Blob
) ){

59886 if–0==(
pFrom
->
Êags
&
MEM_Sètic
) ){

59887 
pTo
->
Êags
 |
MEM_Ephem
;

59888 
rc
 = 
	`sqlôe3VdbeMemMakeWrôóbÀ
(
pTo
);

59892  
rc
;

59901 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemMove
(
Mem
 *
pTo
, Mem *
pFrom
){

59902 
	`as£π
–
pFrom
->
db
==0 || 
	`sqlôe3_muãx_hñd
’From->db->
muãx
) );

59903 
	`as£π
–
pTo
->
db
==0 || 
	`sqlôe3_muãx_hñd
’To->db->
muãx
) );

59904 
	`as£π
–
pFrom
->
db
==0 || 
pTo
->db==0 ||ÖFrom->db==pTo->db );

59906 
	`sqlôe3VdbeMemRñó£
(
pTo
);

59907 
	`mem˝y
(
pTo
, 
pFrom
, (
Mem
));

59908 
pFrom
->
Êags
 = 
MEM_NuŒ
;

59909 
pFrom
->
xDñ
 = 0;

59910 
pFrom
->
zMÆloc
 = 0;

59928 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemSëSå
(

59929 
Mem
 *
pMem
,

59930 c⁄° *
z
,

59931 
n
,

59932 
u8
 
íc
,

59933 (*
xDñ
)(*)

59935 
nByã
 = 
n
;

59936 
iLimô
;

59937 
u16
 
Êags
 = 0;

59939 
	`as£π
–
pMem
->
db
==0 || 
	`sqlôe3_muãx_hñd
’Mem->db->
muãx
) );

59940 
	`as£π
–(
pMem
->
Êags
 & 
MEM_RowSë
)==0 );

59943 if–!
z
 ){

59944 
	`sqlôe3VdbeMemSëNuŒ
(
pMem
);

59945  
SQLITE_OK
;

59948 if–
pMem
->
db
 ){

59949 
iLimô
 = 
pMem
->
db
->
aLimô
[
SQLITE_LIMIT_LENGTH
];

59951 
iLimô
 = 
SQLITE_MAX_LENGTH
;

59953 
Êags
 = (
íc
==0?
MEM_Blob
:
MEM_Så
);

59954 if–
nByã
<0 ){

59955 
	`as£π
–
íc
!=0 );

59956 if–
íc
==
SQLITE_UTF8
 ){

59957 
nByã
=0;ÇByã<=
iLimô
 && 
z
[nByte];ÇByte++){}

59959 
nByã
=0;ÇByã<=
iLimô
 && (
z
[nByte] | z[nByte+1]);ÇByte+=2){}

59961 
Êags
 |
MEM_Tîm
;

59968 if–
xDñ
==
SQLITE_TRANSIENT
 ){

59969 
nAŒoc
 = 
nByã
;

59970 if–
Êags
&
MEM_Tîm
 ){

59971 
nAŒoc
 +(
íc
==
SQLITE_UTF8
?1:2);

59973 if–
nByã
>
iLimô
 ){

59974  
SQLITE_TOOBIG
;

59976 if–
	`sqlôe3VdbeMemGrow
(
pMem
, 
nAŒoc
, 0) ){

59977  
SQLITE_NOMEM
;

59979 
	`mem˝y
(
pMem
->
z
, z, 
nAŒoc
);

59980 }if–
xDñ
==
SQLITE_DYNAMIC
 ){

59981 
	`sqlôe3VdbeMemRñó£
(
pMem
);

59982 
pMem
->
zMÆloc
 =ÖMem->
z
 = (*)z;

59983 
pMem
->
xDñ
 = 0;

59985 
	`sqlôe3VdbeMemRñó£
(
pMem
);

59986 
pMem
->
z
 = (*)z;

59987 
pMem
->
xDñ
 = xDel;

59988 
Êags
 |((
xDñ
==
SQLITE_STATIC
)?
MEM_Sètic
:
MEM_Dyn
);

59991 
pMem
->
n
 = 
nByã
;

59992 
pMem
->
Êags
 = flags;

59993 
pMem
->
íc
 = (íc==0 ? 
SQLITE_UTF8
 :Énc);

59994 
pMem
->
ty≥
 = (
íc
==0 ? 
SQLITE_BLOB
 : 
SQLITE_TEXT
);

59996 #i‚de‡
SQLITE_OMIT_UTF16


59997 if–
pMem
->
íc
!=
SQLITE_UTF8
 && 
	`sqlôe3VdbeMemH™dÀBom
(pMem) ){

59998  
SQLITE_NOMEM
;

60002 if–
nByã
>
iLimô
 ){

60003  
SQLITE_TOOBIG
;

60006  
SQLITE_OK
;

60018 
SQLITE_PRIVATE
 
	`sqlôe3MemCom∑ª
(c⁄° 
Mem
 *
pMem1
, c⁄° Mem *
pMem2
, c⁄° 
CﬁlSeq
 *
pCﬁl
){

60019 
rc
;

60020 
f1
, 
f2
;

60021 
comböed_Êags
;

60023 
f1
 = 
pMem1
->
Êags
;

60024 
f2
 = 
pMem2
->
Êags
;

60025 
comböed_Êags
 = 
f1
|
f2
;

60026 
	`as£π
–(
comböed_Êags
 & 
MEM_RowSë
)==0 );

60031 if–
comböed_Êags
&
MEM_NuŒ
 ){

60032  (
f2
&
MEM_NuŒ
Ë- (
f1
&MEM_Null);

60039 if–
comböed_Êags
&(
MEM_I¡
|
MEM_Ról
) ){

60040 
r1
, 
r2
;

60041 if–(
f1
 & 
f2
 & 
MEM_I¡
)!=0 ){

60042 if–
pMem1
->
u
.
i
 < 
pMem2
->u.i )  -1;

60043 if–
pMem1
->
u
.
i
 > 
pMem2
->u.i )  1;

60046 if–(
f1
&
MEM_Ról
)!=0 ){

60047 
r1
 = 
pMem1
->
r
;

60048 }if–(
f1
&
MEM_I¡
)!=0 ){

60049 
r1
 = ()
pMem1
->
u
.
i
;

60053 if–(
f2
&
MEM_Ról
)!=0 ){

60054 
r2
 = 
pMem2
->
r
;

60055 }if–(
f2
&
MEM_I¡
)!=0 ){

60056 
r2
 = ()
pMem2
->
u
.
i
;

60060 if–
r1
<
r2
 )  -1;

60061 if–
r1
>
r2
 )  1;

60068 if–
comböed_Êags
&
MEM_Så
 ){

60069 if–(
f1
 & 
MEM_Så
)==0 ){

60072 if–(
f2
 & 
MEM_Så
)==0 ){

60076 
	`as£π
–
pMem1
->
íc
==
pMem2
->enc );

60077 
	`as£π
–
pMem1
->
íc
==
SQLITE_UTF8
 ||

60078 
pMem1
->
íc
==
SQLITE_UTF16LE
 ||ÖMem1->íc==
SQLITE_UTF16BE
 );

60084 
	`as£π
–!
pCﬁl
 ||ÖCﬁl->
xCmp
 );

60086 if–
pCﬁl
 ){

60087 if–
pMem1
->
íc
==
pCﬁl
->enc ){

60090  
pCﬁl
->
	`xCmp
’Cﬁl->
pU£r
,
pMem1
->
n
,pMem1->
z
,
pMem2
->n,pMem2->z);

60092 c⁄° *
v1
, *
v2
;

60093 
n1
, 
n2
;

60094 
Mem
 
c1
;

60095 
Mem
 
c2
;

60096 
	`mem£t
(&
c1
, 0, (c1));

60097 
	`mem£t
(&
c2
, 0, (c2));

60098 
	`sqlôe3VdbeMemShÆlowC›y
(&
c1
, 
pMem1
, 
MEM_Ephem
);

60099 
	`sqlôe3VdbeMemShÆlowC›y
(&
c2
, 
pMem2
, 
MEM_Ephem
);

60100 
v1
 = 
	`sqlôe3VÆueText
((
sqlôe3_vÆue
*)&
c1
, 
pCﬁl
->
íc
);

60101 
n1
 = 
v1
==0 ? 0 : 
c1
.
n
;

60102 
v2
 = 
	`sqlôe3VÆueText
((
sqlôe3_vÆue
*)&
c2
, 
pCﬁl
->
íc
);

60103 
n2
 = 
v2
==0 ? 0 : 
c2
.
n
;

60104 
rc
 = 
pCﬁl
->
	`xCmp
’Cﬁl->
pU£r
, 
n1
, 
v1
, 
n2
, 
v2
);

60105 
	`sqlôe3VdbeMemRñó£
(&
c1
);

60106 
	`sqlôe3VdbeMemRñó£
(&
c2
);

60107  
rc
;

60115 
rc
 = 
	`memcmp
(
pMem1
->
z
, 
pMem2
->z, (pMem1->
n
>pMem2->n)?pMem2->n:pMem1->n);

60116 if–
rc
==0 ){

60117 
rc
 = 
pMem1
->
n
 - 
pMem2
->n;

60119  
rc
;

60135 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemFromBåì
(

60136 
BtCurs‹
 *
pCur
,

60137 
off£t
,

60138 
amt
,

60139 
key
,

60140 
Mem
 *
pMem


60142 *
zD©a
;

60143 
avaûabÀ
 = 0;

60144 
rc
 = 
SQLITE_OK
;

60146 
	`as£π
–
	`sqlôe3BåìCurs‹IsVÆid
(
pCur
) );

60150 
	`as£π
–(
pMem
->
Êags
 & 
MEM_RowSë
)==0 );

60151 if–
key
 ){

60152 
zD©a
 = (*)
	`sqlôe3BåìKeyFëch
(
pCur
, &
avaûabÀ
);

60154 
zD©a
 = (*)
	`sqlôe3BåìD©aFëch
(
pCur
, &
avaûabÀ
);

60156 
	`as£π
–
zD©a
!=0 );

60158 if–
off£t
+
amt
<=
avaûabÀ
 && (
pMem
->
Êags
&
MEM_Dyn
)==0 ){

60159 
	`sqlôe3VdbeMemRñó£
(
pMem
);

60160 
pMem
->
z
 = &
zD©a
[
off£t
];

60161 
pMem
->
Êags
 = 
MEM_Blob
|
MEM_Ephem
;

60162 }if–
SQLITE_OK
==(
rc
 = 
	`sqlôe3VdbeMemGrow
(
pMem
, 
amt
+2, 0)) ){

60163 
pMem
->
Êags
 = 
MEM_Blob
|
MEM_Dyn
|
MEM_Tîm
;

60164 
pMem
->
íc
 = 0;

60165 
pMem
->
ty≥
 = 
SQLITE_BLOB
;

60166 if–
key
 ){

60167 
rc
 = 
	`sqlôe3BåìKey
(
pCur
, 
off£t
, 
amt
, 
pMem
->
z
);

60169 
rc
 = 
	`sqlôe3BåìD©a
(
pCur
, 
off£t
, 
amt
, 
pMem
->
z
);

60171 
pMem
->
z
[
amt
] = 0;

60172 
pMem
->
z
[
amt
+1] = 0;

60173 if–
rc
!=
SQLITE_OK
 ){

60174 
	`sqlôe3VdbeMemRñó£
(
pMem
);

60177 
pMem
->
n
 = 
amt
;

60179  
rc
;

60192 
SQLITE_PRIVATE
 c⁄° *
	`sqlôe3VÆueText
(
sqlôe3_vÆue
* 
pVÆ
, 
u8
 
íc
){

60193 if–!
pVÆ
 )  0;

60195 
	`as£π
–
pVÆ
->
db
==0 || 
	`sqlôe3_muãx_hñd
’VÆ->db->
muãx
) );

60196 
	`as£π
–(
íc
&3)==”nc&~
SQLITE_UTF16_ALIGNED
) );

60197 
	`as£π
–(
pVÆ
->
Êags
 & 
MEM_RowSë
)==0 );

60199 if–
pVÆ
->
Êags
&
MEM_NuŒ
 ){

60202 
	`as£π
–(
MEM_Blob
>>3Ë=
MEM_Så
 );

60203 
pVÆ
->
Êags
 |’VÆ->Êag†& 
MEM_Blob
)>>3;

60204 
	`Ex∑ndBlob
(
pVÆ
);

60205 if–
pVÆ
->
Êags
&
MEM_Så
 ){

60206 
	`sqlôe3VdbeCh™geEncodög
(
pVÆ
, 
íc
 & ~
SQLITE_UTF16_ALIGNED
);

60207 if–(
íc
 & 
SQLITE_UTF16_ALIGNED
)!=0 && 1==(1&
	`SQLITE_PTR_TO_INT
(
pVÆ
->
z
)) ){

60208 
	`as£π
–(
pVÆ
->
Êags
 & (
MEM_Ephem
|
MEM_Sètic
))!=0 );

60209 if–
	`sqlôe3VdbeMemMakeWrôóbÀ
(
pVÆ
)!=
SQLITE_OK
 ){

60213 
	`sqlôe3VdbeMemNulTîmö©e
(
pVÆ
);

60215 
	`as£π
–(
pVÆ
->
Êags
&
MEM_Blob
)==0 );

60216 
	`sqlôe3VdbeMemSåögify
(
pVÆ
, 
íc
);

60217 
	`as£π
–0==(1&
	`SQLITE_PTR_TO_INT
(
pVÆ
->
z
)) );

60219 
	`as£π
(
pVÆ
->
íc
==”n¯& ~
SQLITE_UTF16_ALIGNED
Ë||ÖVÆ->
db
==0

60220 || 
pVÆ
->
db
->
mÆlocFaûed
 );

60221 if–
pVÆ
->
íc
==”n¯& ~
SQLITE_UTF16_ALIGNED
) ){

60222  
pVÆ
->
z
;

60231 
SQLITE_PRIVATE
 
sqlôe3_vÆue
 *
	`sqlôe3VÆueNew
(
sqlôe3
 *
db
){

60232 
Mem
 *
p
 = 
	`sqlôe3DbMÆlocZîo
(
db
, (*p));

60233 if–
p
 ){

60234 
p
->
Êags
 = 
MEM_NuŒ
;

60235 
p
->
ty≥
 = 
SQLITE_NULL
;

60236 
p
->
db
 = db;

60238  
p
;

60245 
	sVÆueNewSèt4Ctx
 {

60246 
P¨£
 *
pP¨£
;

60247 
Index
 *
pIdx
;

60248 
U≈ackedRec‹d
 **
µRec
;

60249 
iVÆ
;

60263 
sqlôe3_vÆue
 *
	`vÆueNew
(
sqlôe3
 *
db
, 
VÆueNewSèt4Ctx
 *
p
){

60264 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


60265 if–
p
 ){

60266 
U≈ackedRec‹d
 *
pRec
 = 
p
->
µRec
[0];

60268 if–
pRec
==0 ){

60269 
Index
 *
pIdx
 = 
p
->pIdx;

60270 
nByã
;

60271 
i
;

60272 
nCﬁ
 = 
pIdx
->
nCﬁumn
+1;

60274 
nByã
 = (
Mem
Ë* 
nCﬁ
 + (
U≈ackedRec‹d
);

60275 
pRec
 = (
U≈ackedRec‹d
*)
	`sqlôe3DbMÆlocZîo
(
db
, 
nByã
);

60276 if–
pRec
 ){

60277 
pRec
->
pKeyInfo
 = 
	`sqlôe3IndexKeyöfo
(
p
->
pP¨£
, 
pIdx
);

60278 if–
pRec
->
pKeyInfo
 ){

60279 
	`as£π
–
pRec
->
pKeyInfo
->
nFõld
+1==
nCﬁ
 );

60280 
pRec
->
pKeyInfo
->
íc
 = 
	`ENC
(
db
);

60281 
pRec
->
Êags
 = 
UNPACKED_PREFIX_MATCH
;

60282 
pRec
->
aMem
 = (
Mem
 *)&pRec[1];

60283 
i
=0; i<
nCﬁ
; i++){

60284 
pRec
->
aMem
[
i
].
Êags
 = 
MEM_NuŒ
;

60285 
pRec
->
aMem
[
i
].
ty≥
 = 
SQLITE_NULL
;

60286 
pRec
->
aMem
[
i
].
db
 = db;

60289 
	`sqlôe3DbFªe
(
db
, 
pRec
);

60290 
pRec
 = 0;

60293 if–
pRec
==0 )  0;

60294 
p
->
µRec
[0] = 
pRec
;

60297 
pRec
->
nFõld
 = 
p
->
iVÆ
+1;

60298  &
pRec
->
aMem
[
p
->
iVÆ
];

60301 
	`UNUSED_PARAMETER
(
p
);

60303  
	`sqlôe3VÆueNew
(
db
);

60316 
	`vÆueFromEx¥
(

60317 
sqlôe3
 *
db
,

60318 
Ex¥
 *
pEx¥
,

60319 
u8
 
íc
,

60320 
u8
 
afföôy
,

60321 
sqlôe3_vÆue
 **
µVÆ
,

60322 
VÆueNewSèt4Ctx
 *
pCtx


60324 
›
;

60325 *
zVÆ
 = 0;

60326 
sqlôe3_vÆue
 *
pVÆ
 = 0;

60327 
√gI¡
 = 1;

60328 c⁄° *
zNeg
 = "";

60329 
rc
 = 
SQLITE_OK
;

60331 if–!
pEx¥
 ){

60332 *
µVÆ
 = 0;

60333  
SQLITE_OK
;

60335 
›
 = 
pEx¥
->op;

60341 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


60342 if–
›
==
TK_REGISTER
 ) o∞
pEx¥
->
›2
;

60344 if–
	`NEVER
(
›
==
TK_REGISTER
ËË› = 
pEx¥
->
›2
;

60350 if–
›
==
TK_UMINUS


60351 && (
pEx¥
->
pLe·
->
›
==
TK_INTEGER
 ||ÖEx¥->pLe·->›==
TK_FLOAT
) ){

60352 
pEx¥
 =ÖEx¥->
pLe·
;

60353 
›
 = 
pEx¥
->op;

60354 
√gI¡
 = -1;

60355 
zNeg
 = "-";

60358 if–
›
==
TK_STRING
 || op==
TK_FLOAT
 || op==
TK_INTEGER
 ){

60359 
pVÆ
 = 
	`vÆueNew
(
db
, 
pCtx
);

60360 if–
pVÆ
==0 ) 
no_mem
;

60361 if–
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_I¡VÆue
) ){

60362 
	`sqlôe3VdbeMemSëI¡64
(
pVÆ
, (
i64
)
pEx¥
->
u
.
iVÆue
*
√gI¡
);

60364 
zVÆ
 = 
	`sqlôe3MPrötf
(
db
, "%s%s", 
zNeg
, 
pEx¥
->
u
.
zTokí
);

60365 if–
zVÆ
==0 ) 
no_mem
;

60366 
	`sqlôe3VÆueSëSå
(
pVÆ
, -1, 
zVÆ
, 
SQLITE_UTF8
, 
SQLITE_DYNAMIC
);

60367 if–
›
==
TK_FLOAT
 ) 
pVÆ
->
ty≥
 = 
SQLITE_FLOAT
;

60369 if–(
›
==
TK_INTEGER
 || op==
TK_FLOAT
 ) && 
afföôy
==
SQLITE_AFF_NONE
 ){

60370 
	`sqlôe3VÆueAµlyAfföôy
(
pVÆ
, 
SQLITE_AFF_NUMERIC
, 
SQLITE_UTF8
);

60372 
	`sqlôe3VÆueAµlyAfföôy
(
pVÆ
, 
afföôy
, 
SQLITE_UTF8
);

60374 if–
pVÆ
->
Êags
 & (
MEM_I¡
|
MEM_Ról
ËËpVÆ->Êag†&~
MEM_Så
;

60375 if–
íc
!=
SQLITE_UTF8
 ){

60376 
rc
 = 
	`sqlôe3VdbeCh™geEncodög
(
pVÆ
, 
íc
);

60378 }if–
›
==
TK_UMINUS
 ) {

60380 if–
SQLITE_OK
==
	`sqlôe3VÆueFromEx¥
(
db
,
pEx¥
->
pLe·
,
íc
,
afföôy
,&
pVÆ
)

60381 && 
pVÆ
!=0

60383 
	`sqlôe3VdbeMemNumîify
(
pVÆ
);

60384 if–
pVÆ
->
u
.
i
==
SMALLEST_INT64
 ){

60385 
pVÆ
->
Êags
 &
MEM_I¡
;

60386 
pVÆ
->
Êags
 |
MEM_Ról
;

60387 
pVÆ
->
r
 = ()
LARGEST_INT64
;

60389 
pVÆ
->
u
.
i
 = -pVal->u.i;

60391 
pVÆ
->
r
 = -pVal->r;

60392 
	`sqlôe3VÆueAµlyAfföôy
(
pVÆ
, 
afföôy
, 
íc
);

60394 }if–
›
==
TK_NULL
 ){

60395 
pVÆ
 = 
	`vÆueNew
(
db
, 
pCtx
);

60396 if–
pVÆ
==0 ) 
no_mem
;

60398 #i‚de‡
SQLITE_OMIT_BLOB_LITERAL


60399 if–
›
==
TK_BLOB
 ){

60400 
nVÆ
;

60401 
	`as£π
–
pEx¥
->
u
.
zTokí
[0]=='x' ||ÖExpr->u.zToken[0]=='X' );

60402 
	`as£π
–
pEx¥
->
u
.
zTokí
[1]=='\'' );

60403 
pVÆ
 = 
	`vÆueNew
(
db
, 
pCtx
);

60404 if–!
pVÆ
 ) 
no_mem
;

60405 
zVÆ
 = &
pEx¥
->
u
.
zTokí
[2];

60406 
nVÆ
 = 
	`sqlôe3SåÀn30
(
zVÆ
)-1;

60407 
	`as£π
–
zVÆ
[
nVÆ
]=='\'' );

60408 
	`sqlôe3VdbeMemSëSå
(
pVÆ
, 
	`sqlôe3HexToBlob
(
db
, 
zVÆ
, 
nVÆ
),ÇVal/2,

60409 0, 
SQLITE_DYNAMIC
);

60413 if–
pVÆ
 ){

60414 
	`sqlôe3VdbeMemSt‹eTy≥
(
pVÆ
);

60416 *
µVÆ
 = 
pVÆ
;

60417  
rc
;

60419 
no_mem
:

60420 
db
->
mÆlocFaûed
 = 1;

60421 
	`sqlôe3DbFªe
(
db
, 
zVÆ
);

60422 
	`as£π
–*
µVÆ
==0 );

60423 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


60424 if–
pCtx
==0 ) 
	`sqlôe3VÆueFªe
(
pVÆ
);

60426 
	`as£π
–
pCtx
==0 ); 
	`sqlôe3VÆueFªe
(
pVÆ
);

60428  
SQLITE_NOMEM
;

60441 
SQLITE_PRIVATE
 
	`sqlôe3VÆueFromEx¥
(

60442 
sqlôe3
 *
db
,

60443 
Ex¥
 *
pEx¥
,

60444 
u8
 
íc
,

60445 
u8
 
afföôy
,

60446 
sqlôe3_vÆue
 **
µVÆ


60448  
	`vÆueFromEx¥
(
db
, 
pEx¥
, 
íc
, 
afföôy
, 
µVÆ
, 0);

60451 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


60460 
	`ªc‹dFunc
(

60461 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

60462 
¨gc
,

60463 
sqlôe3_vÆue
 **
¨gv


60465 c⁄° 
fûe_f‹m©
 = 1;

60466 
iSîül
;

60467 
nSîül
;

60468 
nVÆ
;

60469 
nRë
;

60470 
sqlôe3
 *
db
;

60471 
u8
 *
aRë
;

60473 
	`UNUSED_PARAMETER
–
¨gc
 );

60474 
iSîül
 = 
	`sqlôe3VdbeSîülTy≥
(
¨gv
[0], 
fûe_f‹m©
);

60475 
nSîül
 = 
	`sqlôe3V¨ötLí
(
iSîül
);

60476 
nVÆ
 = 
	`sqlôe3VdbeSîülTy≥Lí
(
iSîül
);

60477 
db
 = 
	`sqlôe3_c⁄ãxt_db_h™dÀ
(
c⁄ãxt
);

60479 
nRë
 = 1 + 
nSîül
 + 
nVÆ
;

60480 
aRë
 = 
	`sqlôe3DbMÆlocRaw
(
db
, 
nRë
);

60481 if–
aRë
==0 ){

60482 
	`sqlôe3_ªsu…_îr‹_nomem
(
c⁄ãxt
);

60484 
aRë
[0] = 
nSîül
+1;

60485 
	`sqlôe3PutV¨öt
(&
aRë
[1], 
iSîül
);

60486 
	`sqlôe3VdbeSîülPut
(&
aRë
[1+
nSîül
], 
nVÆ
, 
¨gv
[0], 
fûe_f‹m©
);

60487 
	`sqlôe3_ªsu…_blob
(
c⁄ãxt
, 
aRë
, 
nRë
, 
SQLITE_TRANSIENT
);

60488 
	`sqlôe3DbFªe
(
db
, 
aRë
);

60495 
SQLITE_PRIVATE
 
	`sqlôe3A«lyzeFun˘i⁄s
(){

60496 
SQLITE_WSD
 
FuncDef
 
aA«lyzeTabÀFuncs
[] = {

60497 
	`FUNCTION
(
sqlôe_ªc‹d
, 1, 0, 0, 
ªc‹dFunc
),

60499 
i
;

60500 
FuncDefHash
 *
pHash
 = &
	`GLOBAL
(FuncDefHash, 
sqlôe3GlobÆFun˘i⁄s
);

60501 
FuncDef
 *
aFunc
 = (FuncDef*)&
	`GLOBAL
(FuncDef, 
aA«lyzeTabÀFuncs
);

60502 
i
=0; i<
	`AºaySize
(
aA«lyzeTabÀFuncs
); i++){

60503 
	`sqlôe3FuncDefIn£π
(
pHash
, &
aFunc
[
i
]);

60537 
SQLITE_PRIVATE
 
	`sqlôe3Sèt4ProbeSëVÆue
(

60538 
P¨£
 *
pP¨£
,

60539 
Index
 *
pIdx
,

60540 
U≈ackedRec‹d
 **
µRec
,

60541 
Ex¥
 *
pEx¥
,

60542 
u8
 
afföôy
,

60543 
iVÆ
,

60544 *
pbOk


60546 
rc
 = 
SQLITE_OK
;

60547 
sqlôe3_vÆue
 *
pVÆ
 = 0;

60548 
sqlôe3
 *
db
 = 
pP¨£
->db;

60551 
VÆueNewSèt4Ctx
 
Æloc
;

60552 
Æloc
.
pP¨£
 =ÖParse;

60553 
Æloc
.
pIdx
 =ÖIdx;

60554 
Æloc
.
µRec
 =ÖpRec;

60555 
Æloc
.
iVÆ
 = iVal;

60558 
pEx¥
 = 
	`sqlôe3Ex¥SkùCﬁœã
(pExpr);

60560 if–!
pEx¥
 ){

60561 
pVÆ
 = 
	`vÆueNew
(
db
, &
Æloc
);

60562 if–
pVÆ
 ){

60563 
	`sqlôe3VdbeMemSëNuŒ
((
Mem
*)
pVÆ
);

60564 *
pbOk
 = 1;

60566 }if–
pEx¥
->
›
==
TK_VARIABLE


60567 || (
pEx¥
->
›
==
TK_REGISTER
 &&ÖEx¥->
›2
==
TK_VARIABLE
)

60569 
Vdbe
 *
v
;

60570 
iBödV¨
 = 
pEx¥
->
iCﬁumn
;

60571 
	`sqlôe3VdbeSëV¨mask
(
pP¨£
->
pVdbe
, 
iBödV¨
);

60572 if–(
v
 = 
pP¨£
->
pRïª∑ª
)!=0 ){

60573 
pVÆ
 = 
	`vÆueNew
(
db
, &
Æloc
);

60574 if–
pVÆ
 ){

60575 
rc
 = 
	`sqlôe3VdbeMemC›y
((
Mem
*)
pVÆ
, &
v
->
aV¨
[
iBödV¨
-1]);

60576 if–
rc
==
SQLITE_OK
 ){

60577 
	`sqlôe3VÆueAµlyAfföôy
(
pVÆ
, 
afföôy
, 
	`ENC
(
db
));

60579 
pVÆ
->
db
 = 
pP¨£
->db;

60580 *
pbOk
 = 1;

60581 
	`sqlôe3VdbeMemSt‹eTy≥
((
Mem
*)
pVÆ
);

60584 *
pbOk
 = 0;

60587 
rc
 = 
	`vÆueFromEx¥
(
db
, 
pEx¥
, 
	`ENC
(db), 
afföôy
, &
pVÆ
, &
Æloc
);

60588 *
pbOk
 = (
pVÆ
!=0);

60591 
	`as£π
–
pVÆ
==0 ||ÖVÆ->
db
==db );

60592  
rc
;

60600 
SQLITE_PRIVATE
 
	`sqlôe3Sèt4ProbeFªe
(
U≈ackedRec‹d
 *
pRec
){

60601 if–
pRec
 ){

60602 
i
;

60603 
nCﬁ
 = 
pRec
->
pKeyInfo
->
nFõld
+1;

60604 
Mem
 *
aMem
 = 
pRec
->aMem;

60605 
sqlôe3
 *
db
 = 
aMem
[0].db;

60606 
i
=0; i<
nCﬁ
; i++){

60607 
	`sqlôe3DbFªe
(
db
, 
aMem
[
i
].
zMÆloc
);

60609 
	`sqlôe3DbFªe
(
db
, 
pRec
->
pKeyInfo
);

60610 
	`sqlôe3DbFªe
(
db
, 
pRec
);

60618 
SQLITE_PRIVATE
 
	`sqlôe3VÆueSëSå
(

60619 
sqlôe3_vÆue
 *
v
,

60620 
n
,

60621 c⁄° *
z
,

60622 
u8
 
íc
,

60623 (*
xDñ
)(*)

60625 if–
v
 ) 
	`sqlôe3VdbeMemSëSå
((
Mem
 *)v, 
z
, 
n
, 
íc
, 
xDñ
);

60631 
SQLITE_PRIVATE
 
	`sqlôe3VÆueFªe
(
sqlôe3_vÆue
 *
v
){

60632 if–!
v
 ) ;

60633 
	`sqlôe3VdbeMemRñó£
((
Mem
 *)
v
);

60634 
	`sqlôe3DbFªe
(((
Mem
*)
v
)->
db
, v);

60641 
SQLITE_PRIVATE
 
	`sqlôe3VÆueByãs
(
sqlôe3_vÆue
 *
pVÆ
, 
u8
 
íc
){

60642 
Mem
 *
p
 = (Mem*)
pVÆ
;

60643 if–(
p
->
Êags
 & 
MEM_Blob
)!=0 || 
	`sqlôe3VÆueText
(
pVÆ
, 
íc
) ){

60644 if–
p
->
Êags
 & 
MEM_Zîo
 ){

60645  
p
->
n
 +Ö->
u
.
nZîo
;

60647  
p
->
n
;

60675 
SQLITE_PRIVATE
 
Vdbe
 *
	`sqlôe3VdbeCª©e
(
sqlôe3
 *
db
){

60676 
Vdbe
 *
p
;

60677 
p
 = 
	`sqlôe3DbMÆlocZîo
(
db
, (
Vdbe
) );

60678 if–
p
==0 )  0;

60679 
p
->
db
 = db;

60680 if–
db
->
pVdbe
 ){

60681 
db
->
pVdbe
->
pPªv
 = 
p
;

60683 
p
->
pNext
 = 
db
->
pVdbe
;

60684 
p
->
pPªv
 = 0;

60685 
db
->
pVdbe
 = 
p
;

60686 
p
->
magic
 = 
VDBE_MAGIC_INIT
;

60687  
p
;

60693 
SQLITE_PRIVATE
 
	`sqlôe3VdbeSëSql
(
Vdbe
 *
p
, c⁄° *
z
, 
n
, 
isPª∑ªV2
){

60694 
	`as£π
–
isPª∑ªV2
==1 || isPrepareV2==0 );

60695 if–
p
==0 ) ;

60696 #i‡
	`deföed
(
SQLITE_OMIT_TRACE
Ë&& !deföed(
SQLITE_ENABLE_SQLLOG
)

60697 if–!
isPª∑ªV2
 ) ;

60699 
	`as£π
–
p
->
zSql
==0 );

60700 
p
->
zSql
 = 
	`sqlôe3DbSåNDup
’->
db
, 
z
, 
n
);

60701 
p
->
isPª∑ªV2
 = (
u8
)isPrepareV2;

60707 
SQLITE_API
 c⁄° *
	`sqlôe3_sql
(
sqlôe3_°mt
 *
pStmt
){

60708 
Vdbe
 *
p
 = (Vdbê*)
pStmt
;

60709  (
p
 &&Ö->
isPª∑ªV2
Ë?Ö->
zSql
 : 0;

60715 
SQLITE_PRIVATE
 
	`sqlôe3VdbeSw≠
(
Vdbe
 *
pA
, Vdbê*
pB
){

60716 
Vdbe
 
tmp
, *
pTmp
;

60717 *
zTmp
;

60718 
tmp
 = *
pA
;

60719 *
pA
 = *
pB
;

60720 *
pB
 = 
tmp
;

60721 
pTmp
 = 
pA
->
pNext
;

60722 
pA
->
pNext
 = 
pB
->pNext;

60723 
pB
->
pNext
 = 
pTmp
;

60724 
pTmp
 = 
pA
->
pPªv
;

60725 
pA
->
pPªv
 = 
pB
->pPrev;

60726 
pB
->
pPªv
 = 
pTmp
;

60727 
zTmp
 = 
pA
->
zSql
;

60728 
pA
->
zSql
 = 
pB
->zSql;

60729 
pB
->
zSql
 = 
zTmp
;

60730 
pB
->
isPª∑ªV2
 = 
pA
->isPrepareV2;

60733 #ifde‡
SQLITE_DEBUG


60737 
SQLITE_PRIVATE
 
	`sqlôe3VdbeTø˚
(
Vdbe
 *
p
, 
FILE
 *
åa˚
){

60738 
p
->
åa˚
 =Årace;

60751 
	`growOpAºay
(
Vdbe
 *
p
){

60752 
VdbeOp
 *
pNew
;

60753 
nNew
 = (
p
->
nOpAŒoc
 ?Ö->nOpAŒoc*2 : ()(1024/(
Op
)));

60754 
pNew
 = 
	`sqlôe3DbRóŒoc
(
p
->
db
,Ö->
aOp
, 
nNew
*(
Op
));

60755 if–
pNew
 ){

60756 
p
->
nOpAŒoc
 = 
	`sqlôe3DbMÆlocSize
’->
db
, 
pNew
)/(
Op
);

60757 
p
->
aOp
 = 
pNew
;

60759  (
pNew
 ? 
SQLITE_OK
 : 
SQLITE_NOMEM
);

60778 
SQLITE_PRIVATE
 
	`sqlôe3VdbeAddOp3
(
Vdbe
 *
p
, 
›
, 
p1
, 
p2
, 
p3
){

60779 
i
;

60780 
VdbeOp
 *
pOp
;

60782 
i
 = 
p
->
nOp
;

60783 
	`as£π
–
p
->
magic
==
VDBE_MAGIC_INIT
 );

60784 
	`as£π
–
›
>0 && op<0xff );

60785 if–
p
->
nOpAŒoc
<=
i
 ){

60786 if–
	`growOpAºay
(
p
) ){

60790 
p
->
nOp
++;

60791 
pOp
 = &
p
->
aOp
[
i
];

60792 
pOp
->
›code
 = (
u8
)
›
;

60793 
pOp
->
p5
 = 0;

60794 
pOp
->
p1
 =Ö1;

60795 
pOp
->
p2
 =Ö2;

60796 
pOp
->
p3
 =Ö3;

60797 
pOp
->
p4
.
p
 = 0;

60798 
pOp
->
p4ty≥
 = 
P4_NOTUSED
;

60799 #ifde‡
SQLITE_DEBUG


60800 
pOp
->
zCommít
 = 0;

60801 if–
p
->
db
->
Êags
 & 
SQLITE_VdbeAdd›Tø˚
 ){

60802 
	`sqlôe3VdbePrötOp
(0, 
i
, &
p
->
aOp
[i]);

60805 #ifde‡
VDBE_PROFILE


60806 
pOp
->
cy˛es
 = 0;

60807 
pOp
->
˙t
 = 0;

60809  
i
;

60811 
SQLITE_PRIVATE
 
	`sqlôe3VdbeAddOp0
(
Vdbe
 *
p
, 
›
){

60812  
	`sqlôe3VdbeAddOp3
(
p
, 
›
, 0, 0, 0);

60814 
SQLITE_PRIVATE
 
	`sqlôe3VdbeAddOp1
(
Vdbe
 *
p
, 
›
, 
p1
){

60815  
	`sqlôe3VdbeAddOp3
(
p
, 
›
, 
p1
, 0, 0);

60817 
SQLITE_PRIVATE
 
	`sqlôe3VdbeAddOp2
(
Vdbe
 *
p
, 
›
, 
p1
, 
p2
){

60818  
	`sqlôe3VdbeAddOp3
(
p
, 
›
, 
p1
, 
p2
, 0);

60825 
SQLITE_PRIVATE
 
	`sqlôe3VdbeAddOp4
(

60826 
Vdbe
 *
p
,

60827 
›
,

60828 
p1
,

60829 
p2
,

60830 
p3
,

60831 c⁄° *
zP4
,

60832 
p4ty≥


60834 
addr
 = 
	`sqlôe3VdbeAddOp3
(
p
, 
›
, 
p1
, 
p2
, 
p3
);

60835 
	`sqlôe3VdbeCh™geP4
(
p
, 
addr
, 
zP4
, 
p4ty≥
);

60836  
addr
;

60847 
SQLITE_PRIVATE
 
	`sqlôe3VdbeAddP¨£SchemaOp
(
Vdbe
 *
p
, 
iDb
, *
zWhîe
){

60848 
j
;

60849 
addr
 = 
	`sqlôe3VdbeAddOp3
(
p
, 
OP_P¨£Schema
, 
iDb
, 0, 0);

60850 
	`sqlôe3VdbeCh™geP4
(
p
, 
addr
, 
zWhîe
, 
P4_DYNAMIC
);

60851 
j
=0; j<
p
->
db
->
nDb
; j++Ë
	`sqlôe3VdbeU£sBåì
(p, j);

60857 
SQLITE_PRIVATE
 
	`sqlôe3VdbeAddOp4I¡
(

60858 
Vdbe
 *
p
,

60859 
›
,

60860 
p1
,

60861 
p2
,

60862 
p3
,

60863 
p4


60865 
addr
 = 
	`sqlôe3VdbeAddOp3
(
p
, 
›
, 
p1
, 
p2
, 
p3
);

60866 
	`sqlôe3VdbeCh™geP4
(
p
, 
addr
, 
	`SQLITE_INT_TO_PTR
(
p4
), 
P4_INT32
);

60867  
addr
;

60884 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMakeLabñ
(
Vdbe
 *
p
){

60885 
i
 = 
p
->
nLabñ
++;

60886 
	`as£π
–
p
->
magic
==
VDBE_MAGIC_INIT
 );

60887 if–(
i
 & (i-1))==0 ){

60888 
p
->
aLabñ
 = 
	`sqlôe3DbRóŒocOrFªe
’->
db
,Ö->aLabel,

60889 (
i
*2+1)*(
p
->
aLabñ
[0]));

60891 if–
p
->
aLabñ
 ){

60892 
p
->
aLabñ
[
i
] = -1;

60894  -1-
i
;

60902 
SQLITE_PRIVATE
 
	`sqlôe3VdbeResﬁveLabñ
(
Vdbe
 *
p
, 
x
){

60903 
j
 = -1-
x
;

60904 
	`as£π
–
p
->
magic
==
VDBE_MAGIC_INIT
 );

60905 
	`as£π
–
j
<
p
->
nLabñ
 );

60906 if–
j
>=0 && 
p
->
aLabñ
 ){

60907 
p
->
aLabñ
[
j
] =Ö->
nOp
;

60914 
SQLITE_PRIVATE
 
	`sqlôe3VdbeRunO∆yOn˚
(
Vdbe
 *
p
){

60915 
p
->
runO∆yOn˚
 = 1;

60918 #ifde‡
SQLITE_DEBUG


60936 
VdbeOpIãr
 
	tVdbeOpIãr
;

60937 
	sVdbeOpIãr
 {

60938 
Vdbe
 *
v
;

60939 
SubProgøm
 **
≠Sub
;

60940 
nSub
;

60941 
iAddr
;

60942 
iSub
;

60944 
Op
 *
	`›IãrNext
(
VdbeOpIãr
 *
p
){

60945 
Vdbe
 *
v
 = 
p
->v;

60946 
Op
 *
pRë
 = 0;

60947 
Op
 *
aOp
;

60948 
nOp
;

60950 if–
p
->
iSub
<ı->
nSub
 ){

60952 if–
p
->
iSub
==0 ){

60953 
aOp
 = 
v
->aOp;

60954 
nOp
 = 
v
->nOp;

60956 
aOp
 = 
p
->
≠Sub
[p->
iSub
-1]->aOp;

60957 
nOp
 = 
p
->
≠Sub
[p->
iSub
-1]->nOp;

60959 
	`as£π
–
p
->
iAddr
<
nOp
 );

60961 
pRë
 = &
aOp
[
p
->
iAddr
];

60962 
p
->
iAddr
++;

60963 if–
p
->
iAddr
==
nOp
 ){

60964 
p
->
iSub
++;

60965 
p
->
iAddr
 = 0;

60968 if–
pRë
->
p4ty≥
==
P4_SUBPROGRAM
 ){

60969 
nByã
 = (
p
->
nSub
+1)*(
SubProgøm
*);

60970 
j
;

60971 
j
=0; j<
p
->
nSub
; j++){

60972 if–
p
->
≠Sub
[
j
]==
pRë
->
p4
.
pProgøm
 ) ;

60974 if–
j
==
p
->
nSub
 ){

60975 
p
->
≠Sub
 = 
	`sqlôe3DbRóŒocOrFªe
(
v
->
db
,Ö->≠Sub, 
nByã
);

60976 if–!
p
->
≠Sub
 ){

60977 
pRë
 = 0;

60979 
p
->
≠Sub
[p->
nSub
++] = 
pRë
->
p4
.
pProgøm
;

60985  
pRë
;

61008 
SQLITE_PRIVATE
 
	`sqlôe3VdbeAs£πMayAb‹t
(
Vdbe
 *
v
, 
mayAb‹t
){

61009 
hasAb‹t
 = 0;

61010 
Op
 *
pOp
;

61011 
VdbeOpIãr
 
sIãr
;

61012 
	`mem£t
(&
sIãr
, 0, (sIter));

61013 
sIãr
.
v
 = v;

61015  (
pOp
 = 
	`›IãrNext
(&
sIãr
))!=0 ){

61016 
›code
 = 
pOp
->opcode;

61017 if–
›code
==
OP_De°roy
 || opcode==
OP_VUpd©e
 || opcode==
OP_VRíame


61018 #i‚de‡
SQLITE_OMIT_FOREIGN_KEY


61019 || (
›code
==
OP_FkCou¡î
 && 
pOp
->
p1
==0 &&ÖOp->
p2
==1)

61021 || ((
›code
==
OP_HÆt
 || opcode==
OP_HÆtIfNuŒ
)

61022 && ((
pOp
->
p1
&0xff)==
SQLITE_CONSTRAINT
 &&ÖOp->
p2
==
OE_Ab‹t
))

61024 
hasAb‹t
 = 1;

61028 
	`sqlôe3DbFªe
(
v
->
db
, 
sIãr
.
≠Sub
);

61035  ( 
v
->
db
->
mÆlocFaûed
 || 
hasAb‹t
==
mayAb‹t
 );

61052 
	`ªsﬁveP2VÆues
(
Vdbe
 *
p
, *
pMaxFuncArgs
){

61053 
i
;

61054 
nMaxArgs
 = *
pMaxFuncArgs
;

61055 
Op
 *
pOp
;

61056 *
aLabñ
 = 
p
->aLabel;

61057 
p
->
ªadO∆y
 = 1;

61058 
p
->
bIsRódî
 = 0;

61059 
pOp
=
p
->
aOp
, 
i
ı->
nOp
-1; i>=0; i--,ÖOp++){

61060 
u8
 
›code
 = 
pOp
->opcode;

61064  
›code
 ){

61065 
OP_Fun˘i⁄
:

61066 
OP_AggSãp
: {

61067 if–
pOp
->
p5
>
nMaxArgs
 )ÇMaxArgs =ÖOp->p5;

61070 
OP_Tønß˘i⁄
: {

61071 if–
pOp
->
p2
!=0 ) 
p
->
ªadO∆y
 = 0;

61074 
OP_AutoCommô
:

61075 
OP_Savïoöt
: {

61076 
p
->
bIsRódî
 = 1;

61079 #i‚de‡
SQLITE_OMIT_WAL


61080 
OP_Checkpoöt
:

61082 
OP_Vacuum
:

61083 
OP_Jou∫ÆMode
: {

61084 
p
->
ªadO∆y
 = 0;

61085 
p
->
bIsRódî
 = 1;

61088 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


61089 
OP_VUpd©e
: {

61090 if–
pOp
->
p2
>
nMaxArgs
 )ÇMaxArgs =ÖOp->p2;

61093 
OP_VFûãr
: {

61094 
n
;

61095 
	`as£π
–
p
->
nOp
 - 
i
 >= 3 );

61096 
	`as£π
–
pOp
[-1].
›code
==
OP_I¡egî
 );

61097 
n
 = 
pOp
[-1].
p1
;

61098 if–
n
>
nMaxArgs
 )ÇMaxArgs =Ç;

61102 
OP_Next
:

61103 
OP_S‹ãrNext
: {

61104 
pOp
->
p4
.
xAdv™˚
 = 
sqlôe3BåìNext
;

61105 
pOp
->
p4ty≥
 = 
P4_ADVANCE
;

61108 
OP_Pªv
: {

61109 
pOp
->
p4
.
xAdv™˚
 = 
sqlôe3BåìPªvious
;

61110 
pOp
->
p4ty≥
 = 
P4_ADVANCE
;

61115 
pOp
->
›Êags
 = 
sqlôe3OpcodePr›îty
[
›code
];

61116 if–(
pOp
->
›Êags
 & 
OPFLG_JUMP
)!=0 &&ÖOp->
p2
<0 ){

61117 
	`as£π
–-1-
pOp
->
p2
<
p
->
nLabñ
 );

61118 
pOp
->
p2
 = 
aLabñ
[-1-pOp->p2];

61121 
	`sqlôe3DbFªe
(
p
->
db
,Ö->
aLabñ
);

61122 
p
->
aLabñ
 = 0;

61123 *
pMaxFuncArgs
 = 
nMaxArgs
;

61124 
	`as£π
–
p
->
bIsRódî
!=0 ||Ö->
båìMask
==0 );

61130 
SQLITE_PRIVATE
 
	`sqlôe3VdbeCuºítAddr
(
Vdbe
 *
p
){

61131 
	`as£π
–
p
->
magic
==
VDBE_MAGIC_INIT
 );

61132  
p
->
nOp
;

61146 
SQLITE_PRIVATE
 
VdbeOp
 *
	`sqlôe3VdbeTakeOpAºay
(
Vdbe
 *
p
, *
≤Op
, *
≤MaxArg
){

61147 
VdbeOp
 *
aOp
 = 
p
->aOp;

61148 
	`as£π
–
aOp
 && !
p
->
db
->
mÆlocFaûed
 );

61151 
	`as£π
–
p
->
båìMask
==0 );

61153 
	`ªsﬁveP2VÆues
(
p
, 
≤MaxArg
);

61154 *
≤Op
 = 
p
->
nOp
;

61155 
p
->
aOp
 = 0;

61156  
aOp
;

61163 
SQLITE_PRIVATE
 
	`sqlôe3VdbeAddOpLi°
(
Vdbe
 *
p
, 
nOp
, 
VdbeOpLi°
 c⁄° *
aOp
){

61164 
addr
;

61165 
	`as£π
–
p
->
magic
==
VDBE_MAGIC_INIT
 );

61166 if–
p
->
nOp
 +ÇO∞>Ö->
nOpAŒoc
 && 
	`growOpAºay
(p) ){

61169 
addr
 = 
p
->
nOp
;

61170 if–
	`ALWAYS
(
nOp
>0) ){

61171 
i
;

61172 
VdbeOpLi°
 c⁄° *
pIn
 = 
aOp
;

61173 
i
=0; i<
nOp
; i++, 
pIn
++){

61174 
p2
 = 
pIn
->p2;

61175 
VdbeOp
 *
pOut
 = &
p
->
aOp
[
i
+
addr
];

61176 
pOut
->
›code
 = 
pIn
->opcode;

61177 
pOut
->
p1
 = 
pIn
->p1;

61178 if–
p2
<0 && (
sqlôe3OpcodePr›îty
[
pOut
->
›code
] & 
OPFLG_JUMP
)!=0 ){

61179 
pOut
->
p2
 = 
addr
 + 
	`ADDR
(p2);

61181 
pOut
->
p2
 =Ö2;

61183 
pOut
->
p3
 = 
pIn
->p3;

61184 
pOut
->
p4ty≥
 = 
P4_NOTUSED
;

61185 
pOut
->
p4
.
p
 = 0;

61186 
pOut
->
p5
 = 0;

61187 #ifde‡
SQLITE_DEBUG


61188 
pOut
->
zCommít
 = 0;

61189 if–
p
->
db
->
Êags
 & 
SQLITE_VdbeAdd›Tø˚
 ){

61190 
	`sqlôe3VdbePrötOp
(0, 
i
+
addr
, &
p
->
aOp
[i+addr]);

61194 
p
->
nOp
 +=ÇOp;

61196  
addr
;

61205 
SQLITE_PRIVATE
 
	`sqlôe3VdbeCh™geP1
(
Vdbe
 *
p
, 
u32
 
addr
, 
vÆ
){

61206 
	`as£π
–
p
!=0 );

61207 if–((
u32
)
p
->
nOp
)>
addr
 ){

61208 
p
->
aOp
[
addr
].
p1
 = 
vÆ
;

61216 
SQLITE_PRIVATE
 
	`sqlôe3VdbeCh™geP2
(
Vdbe
 *
p
, 
u32
 
addr
, 
vÆ
){

61217 
	`as£π
–
p
!=0 );

61218 if–((
u32
)
p
->
nOp
)>
addr
 ){

61219 
p
->
aOp
[
addr
].
p2
 = 
vÆ
;

61226 
SQLITE_PRIVATE
 
	`sqlôe3VdbeCh™geP3
(
Vdbe
 *
p
, 
u32
 
addr
, 
vÆ
){

61227 
	`as£π
–
p
!=0 );

61228 if–((
u32
)
p
->
nOp
)>
addr
 ){

61229 
p
->
aOp
[
addr
].
p3
 = 
vÆ
;

61237 
SQLITE_PRIVATE
 
	`sqlôe3VdbeCh™geP5
(
Vdbe
 *
p
, 
u8
 
vÆ
){

61238 
	`as£π
–
p
!=0 );

61239 if–
p
->
aOp
 ){

61240 
	`as£π
–
p
->
nOp
>0 );

61241 
p
->
aOp
[p->
nOp
-1].
p5
 = 
vÆ
;

61249 
SQLITE_PRIVATE
 
	`sqlôe3VdbeJumpHîe
(
Vdbe
 *
p
, 
addr
){

61250 if–
	`ALWAYS
(
addr
>=0ËË
	`sqlôe3VdbeCh™geP2
(
p
,áddr,Ö->
nOp
);

61258 
	`‰ìEphemîÆFun˘i⁄
(
sqlôe3
 *
db
, 
FuncDef
 *
pDef
){

61259 if–
	`ALWAYS
(
pDef
Ë&& (pDef->
funcFœgs
 & 
SQLITE_FUNC_EPHEM
)!=0 ){

61260 
	`sqlôe3DbFªe
(
db
, 
pDef
);

61264 
	`vdbeFªeOpAºay
(
sqlôe3
 *, 
Op
 *, );

61269 
	`‰ìP4
(
sqlôe3
 *
db
, 
p4ty≥
, *
p4
){

61270 if–
p4
 ){

61271 
	`as£π
–
db
 );

61272  
p4ty≥
 ){

61273 
P4_REAL
:

61274 
P4_INT64
:

61275 
P4_DYNAMIC
:

61276 
P4_KEYINFO
:

61277 
P4_INTARRAY
:

61278 
P4_KEYINFO_HANDOFF
: {

61279 
	`sqlôe3DbFªe
(
db
, 
p4
);

61282 
P4_MPRINTF
: {

61283 if–
db
->
≤ByãsFªed
==0 ) 
	`sqlôe3_‰ì
(
p4
);

61286 
P4_FUNCDEF
: {

61287 
	`‰ìEphemîÆFun˘i⁄
(
db
, (
FuncDef
*)
p4
);

61290 
P4_MEM
: {

61291 if–
db
->
≤ByãsFªed
==0 ){

61292 
	`sqlôe3VÆueFªe
((
sqlôe3_vÆue
*)
p4
);

61294 
Mem
 *
p
 = (Mem*)
p4
;

61295 
	`sqlôe3DbFªe
(
db
, 
p
->
zMÆloc
);

61296 
	`sqlôe3DbFªe
(
db
, 
p
);

61300 
P4_VTAB
 : {

61301 if–
db
->
≤ByãsFªed
==0 ) 
	`sqlôe3VèbU∆ock
((
VTabÀ
 *)
p4
);

61313 
	`vdbeFªeOpAºay
(
sqlôe3
 *
db
, 
Op
 *
aOp
, 
nOp
){

61314 if–
aOp
 ){

61315 
Op
 *
pOp
;

61316 
pOp
=
aOp
;ÖOp<&aOp[
nOp
];ÖOp++){

61317 
	`‰ìP4
(
db
, 
pOp
->
p4ty≥
,ÖOp->
p4
.
p
);

61318 #ifde‡
SQLITE_DEBUG


61319 
	`sqlôe3DbFªe
(
db
, 
pOp
->
zCommít
);

61323 
	`sqlôe3DbFªe
(
db
, 
aOp
);

61331 
SQLITE_PRIVATE
 
	`sqlôe3VdbeLökSubProgøm
(
Vdbe
 *
pVdbe
, 
SubProgøm
 *
p
){

61332 
p
->
pNext
 = 
pVdbe
->
pProgøm
;

61333 
pVdbe
->
pProgøm
 = 
p
;

61339 
SQLITE_PRIVATE
 
	`sqlôe3VdbeCh™geToNo›
(
Vdbe
 *
p
, 
addr
){

61340 if–
p
->
aOp
 ){

61341 
VdbeOp
 *
pOp
 = &
p
->
aOp
[
addr
];

61342 
sqlôe3
 *
db
 = 
p
->db;

61343 
	`‰ìP4
(
db
, 
pOp
->
p4ty≥
,ÖOp->
p4
.
p
);

61344 
	`mem£t
(
pOp
, 0, (pOp[0]));

61345 
pOp
->
›code
 = 
OP_No›
;

61374 
SQLITE_PRIVATE
 
	`sqlôe3VdbeCh™geP4
(
Vdbe
 *
p
, 
addr
, c⁄° *
zP4
, 
n
){

61375 
Op
 *
pOp
;

61376 
sqlôe3
 *
db
;

61377 
	`as£π
–
p
!=0 );

61378 
db
 = 
p
->db;

61379 
	`as£π
–
p
->
magic
==
VDBE_MAGIC_INIT
 );

61380 if–
p
->
aOp
==0 || 
db
->
mÆlocFaûed
 ){

61381 i‡–
n
!=
P4_KEYINFO
 &&Ç!=
P4_VTAB
 ) {

61382 
	`‰ìP4
(
db
, 
n
, (*)*(**)&
zP4
);

61386 
	`as£π
–
p
->
nOp
>0 );

61387 
	`as£π
–
addr
<
p
->
nOp
 );

61388 if–
addr
<0 ){

61389 
addr
 = 
p
->
nOp
 - 1;

61391 
pOp
 = &
p
->
aOp
[
addr
];

61392 
	`as£π
–
pOp
->
p4ty≥
==
P4_NOTUSED
 ||ÖOp->p4ty≥==
P4_INT32
 );

61393 
	`‰ìP4
(
db
, 
pOp
->
p4ty≥
,ÖOp->
p4
.
p
);

61394 
pOp
->
p4
.
p
 = 0;

61395 if–
n
==
P4_INT32
 ){

61398 
pOp
->
p4
.
i
 = 
	`SQLITE_PTR_TO_INT
(
zP4
);

61399 
pOp
->
p4ty≥
 = 
P4_INT32
;

61400 }if–
zP4
==0 ){

61401 
pOp
->
p4
.
p
 = 0;

61402 
pOp
->
p4ty≥
 = 
P4_NOTUSED
;

61403 }if–
n
==
P4_KEYINFO
 ){

61404 
KeyInfo
 *
pOrig
, *
pNew
;

61406 
pOrig
 = (
KeyInfo
*)
zP4
;

61407 
pOp
->
p4
.
pKeyInfo
 = 
pNew
 = 
	`sqlôe3KeyInfoAŒoc
(
db
, 
pOrig
->
nFõld
);

61408 if–
pNew
 ){

61409 
	`mem˝y
(
pNew
->
aCﬁl
, 
pOrig
->aCﬁl,ÖOrig->
nFõld
*(pNew->aColl[0]));

61410 
	`mem˝y
(
pNew
->
aS‹tOrdî
, 
pOrig
->aS‹tOrdî,ÖOrig->
nFõld
);

61411 
pOp
->
p4ty≥
 = 
P4_KEYINFO
;

61413 
p
->
db
->
mÆlocFaûed
 = 1;

61414 
pOp
->
p4ty≥
 = 
P4_NOTUSED
;

61416 }if–
n
==
P4_KEYINFO_HANDOFF
 ){

61417 
pOp
->
p4
.
p
 = (*)
zP4
;

61418 
pOp
->
p4ty≥
 = 
P4_KEYINFO
;

61419 }if–
n
==
P4_VTAB
 ){

61420 
pOp
->
p4
.
p
 = (*)
zP4
;

61421 
pOp
->
p4ty≥
 = 
P4_VTAB
;

61422 
	`sqlôe3VèbLock
((
VTabÀ
 *)
zP4
);

61423 
	`as£π
–((
VTabÀ
 *)
zP4
)->
db
==
p
->db );

61424 }if–
n
<0 ){

61425 
pOp
->
p4
.
p
 = (*)
zP4
;

61426 
pOp
->
p4ty≥
 = (sig√d )
n
;

61428 if–
n
==0 )Ç = 
	`sqlôe3SåÀn30
(
zP4
);

61429 
pOp
->
p4
.
z
 = 
	`sqlôe3DbSåNDup
(
p
->
db
, 
zP4
, 
n
);

61430 
pOp
->
p4ty≥
 = 
P4_DYNAMIC
;

61434 #i‚de‡
NDEBUG


61441 
	`vdbeVCommít
(
Vdbe
 *
p
, c⁄° *
zF‹m©
, 
va_li°
 
≠
){

61442 
	`as£π
–
p
->
nOp
>0 ||Ö->
aOp
==0 );

61443 
	`as£π
–
p
->
aOp
==0 ||Ö->aOp[p->
nOp
-1].
zCommít
==0 ||Ö->
db
->
mÆlocFaûed
 );

61444 if–
p
->
nOp
 ){

61445 
	`as£π
–
p
->
aOp
 );

61446 
	`sqlôe3DbFªe
(
p
->
db
,Ö->
aOp
[p->
nOp
-1].
zCommít
);

61447 
p
->
aOp
[p->
nOp
-1].
zCommít
 = 
	`sqlôe3VMPrötf
’->
db
, 
zF‹m©
, 
≠
);

61450 
SQLITE_PRIVATE
 
	`sqlôe3VdbeCommít
(
Vdbe
 *
p
, c⁄° *
zF‹m©
, ...){

61451 
va_li°
 
≠
;

61452 if–
p
 ){

61453 
	`va_°¨t
(
≠
, 
zF‹m©
);

61454 
	`vdbeVCommít
(
p
, 
zF‹m©
, 
≠
);

61455 
	`va_íd
(
≠
);

61458 
SQLITE_PRIVATE
 
	`sqlôe3VdbeNo›Commít
(
Vdbe
 *
p
, c⁄° *
zF‹m©
, ...){

61459 
va_li°
 
≠
;

61460 if–
p
 ){

61461 
	`sqlôe3VdbeAddOp0
(
p
, 
OP_No›
);

61462 
	`va_°¨t
(
≠
, 
zF‹m©
);

61463 
	`vdbeVCommít
(
p
, 
zF‹m©
, 
≠
);

61464 
	`va_íd
(
≠
);

61490 
SQLITE_PRIVATE
 
VdbeOp
 *
	`sqlôe3VdbeGëOp
(
Vdbe
 *
p
, 
addr
){

61493 
VdbeOp
 
dummy
;

61494 
	`as£π
–
p
->
magic
==
VDBE_MAGIC_INIT
 );

61495 if–
addr
<0 ){

61496 #ifde‡
SQLITE_OMIT_TRACE


61497 if–
p
->
nOp
==0 )  (
VdbeOp
*)&
dummy
;

61499 
addr
 = 
p
->
nOp
 - 1;

61501 
	`as£π
–(
addr
>=0 &&áddr<
p
->
nOp
Ë||Ö->
db
->
mÆlocFaûed
 );

61502 if–
p
->
db
->
mÆlocFaûed
 ){

61503  (
VdbeOp
*)&
dummy
;

61505  &
p
->
aOp
[
addr
];

61509 #i‡!
	`deföed
(
SQLITE_OMIT_EXPLAIN
Ë|| !deföed(
NDEBUG
) \

61510 || 
	`deföed
(
VDBE_PROFILE
Ë|| deföed(
SQLITE_DEBUG
)

61515 *
	`di•œyP4
(
Op
 *
pOp
, *
zTemp
, 
nTemp
){

61516 *
zP4
 = 
zTemp
;

61517 
	`as£π
–
nTemp
>=20 );

61518  
pOp
->
p4ty≥
 ){

61519 
P4_KEYINFO_STATIC
:

61520 
P4_KEYINFO
: {

61521 
i
, 
j
;

61522 
KeyInfo
 *
pKeyInfo
 = 
pOp
->
p4
.pKeyInfo;

61523 
	`as£π
–
pKeyInfo
->
aS‹tOrdî
!=0 );

61524 
	`sqlôe3_¢¥ötf
(
nTemp
, 
zTemp
, "keyöfo(%d", 
pKeyInfo
->
nFõld
);

61525 
i
 = 
	`sqlôe3SåÀn30
(
zTemp
);

61526 
j
=0; j<
pKeyInfo
->
nFõld
; j++){

61527 
CﬁlSeq
 *
pCﬁl
 = 
pKeyInfo
->
aCﬁl
[
j
];

61528 c⁄° *
zCﬁl
 = 
pCﬁl
 ?ÖCﬁl->
zName
 : "nil";

61529 
n
 = 
	`sqlôe3SåÀn30
(
zCﬁl
);

61530 if–
i
+
n
>
nTemp
-6 ){

61531 
	`mem˝y
(&
zTemp
[
i
],",...",4);

61534 
zTemp
[
i
++] = ',';

61535 if–
pKeyInfo
->
aS‹tOrdî
[
j
] ){

61536 
zTemp
[
i
++] = '-';

61538 
	`mem˝y
(&
zTemp
[
i
], 
zCﬁl
, 
n
+1);

61539 
i
 +
n
;

61541 
zTemp
[
i
++] = ')';

61542 
zTemp
[
i
] = 0;

61543 
	`as£π
–
i
<
nTemp
 );

61546 
P4_COLLSEQ
: {

61547 
CﬁlSeq
 *
pCﬁl
 = 
pOp
->
p4
.pColl;

61548 
	`sqlôe3_¢¥ötf
(
nTemp
, 
zTemp
, "cﬁl£q(%.20s)", 
pCﬁl
->
zName
);

61551 
P4_FUNCDEF
: {

61552 
FuncDef
 *
pDef
 = 
pOp
->
p4
.
pFunc
;

61553 
	`sqlôe3_¢¥ötf
(
nTemp
, 
zTemp
, "%s(%d)", 
pDef
->
zName
,ÖDef->
nArg
);

61556 
P4_INT64
: {

61557 
	`sqlôe3_¢¥ötf
(
nTemp
, 
zTemp
, "%Œd", *
pOp
->
p4
.
pI64
);

61560 
P4_INT32
: {

61561 
	`sqlôe3_¢¥ötf
(
nTemp
, 
zTemp
, "%d", 
pOp
->
p4
.
i
);

61564 
P4_REAL
: {

61565 
	`sqlôe3_¢¥ötf
(
nTemp
, 
zTemp
, "%.16g", *
pOp
->
p4
.
pRól
);

61568 
P4_MEM
: {

61569 
Mem
 *
pMem
 = 
pOp
->
p4
.pMem;

61570 if–
pMem
->
Êags
 & 
MEM_Så
 ){

61571 
zP4
 = 
pMem
->
z
;

61572 }if–
pMem
->
Êags
 & 
MEM_I¡
 ){

61573 
	`sqlôe3_¢¥ötf
(
nTemp
, 
zTemp
, "%Œd", 
pMem
->
u
.
i
);

61574 }if–
pMem
->
Êags
 & 
MEM_Ról
 ){

61575 
	`sqlôe3_¢¥ötf
(
nTemp
, 
zTemp
, "%.16g", 
pMem
->
r
);

61576 }if–
pMem
->
Êags
 & 
MEM_NuŒ
 ){

61577 
	`sqlôe3_¢¥ötf
(
nTemp
, 
zTemp
, "NULL");

61579 
	`as£π
–
pMem
->
Êags
 & 
MEM_Blob
 );

61580 
zP4
 = "(blob)";

61584 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


61585 
P4_VTAB
: {

61586 
sqlôe3_vèb
 *
pVèb
 = 
pOp
->
p4
.pVtab->pVtab;

61587 
	`sqlôe3_¢¥ötf
(
nTemp
, 
zTemp
, "vèb:%p:%p", 
pVèb
,ÖVèb->
pModuÀ
);

61591 
P4_INTARRAY
: {

61592 
	`sqlôe3_¢¥ötf
(
nTemp
, 
zTemp
, "intarray");

61595 
P4_SUBPROGRAM
: {

61596 
	`sqlôe3_¢¥ötf
(
nTemp
, 
zTemp
, "program");

61599 
P4_ADVANCE
: {

61600 
zTemp
[0] = 0;

61604 
zP4
 = 
pOp
->
p4
.
z
;

61605 if–
zP4
==0 ){

61606 
zP4
 = 
zTemp
;

61607 
zTemp
[0] = 0;

61611 
	`as£π
–
zP4
!=0 );

61612  
zP4
;

61624 
SQLITE_PRIVATE
 
	`sqlôe3VdbeU£sBåì
(
Vdbe
 *
p
, 
i
){

61625 
	`as£π
–
i
>=0 && i<
p
->
db
->
nDb
 && i<()(
yDbMask
)*8 );

61626 
	`as£π
–
i
<()(
p
->
båìMask
)*8 );

61627 
p
->
båìMask
 |((
yDbMask
)1)<<
i
;

61628 if–
i
!=1 && 
	`sqlôe3BåìSh¨abÀ
(
p
->
db
->
aDb
[i].
pBt
) ){

61629 
p
->
lockMask
 |((
yDbMask
)1)<<
i
;

61633 #i‡!
	`deföed
(
SQLITE_OMIT_SHARED_CACHE
Ë&& 
SQLITE_THREADSAFE
>0

61655 
SQLITE_PRIVATE
 
	`sqlôe3VdbeE¡î
(
Vdbe
 *
p
){

61656 
i
;

61657 
yDbMask
 
mask
;

61658 
sqlôe3
 *
db
;

61659 
Db
 *
aDb
;

61660 
nDb
;

61661 if–
p
->
lockMask
==0 ) ;

61662 
db
 = 
p
->db;

61663 
aDb
 = 
db
->aDb;

61664 
nDb
 = 
db
->nDb;

61665 
i
=0, 
mask
=1; i<
nDb
; i++, mask += mask){

61666 if–
i
!=1 && (
mask
 & 
p
->
lockMask
)!=0 && 
	`ALWAYS
(
aDb
[i].
pBt
!=0) ){

61667 
	`sqlôe3BåìE¡î
(
aDb
[
i
].
pBt
);

61673 #i‡!
	`deföed
(
SQLITE_OMIT_SHARED_CACHE
Ë&& 
SQLITE_THREADSAFE
>0

61677 
SQLITE_PRIVATE
 
	`sqlôe3VdbeLóve
(
Vdbe
 *
p
){

61678 
i
;

61679 
yDbMask
 
mask
;

61680 
sqlôe3
 *
db
;

61681 
Db
 *
aDb
;

61682 
nDb
;

61683 if–
p
->
lockMask
==0 ) ;

61684 
db
 = 
p
->db;

61685 
aDb
 = 
db
->aDb;

61686 
nDb
 = 
db
->nDb;

61687 
i
=0, 
mask
=1; i<
nDb
; i++, mask += mask){

61688 if–
i
!=1 && (
mask
 & 
p
->
lockMask
)!=0 && 
	`ALWAYS
(
aDb
[i].
pBt
!=0) ){

61689 
	`sqlôe3BåìLóve
(
aDb
[
i
].
pBt
);

61695 #i‡
	`deföed
(
VDBE_PROFILE
Ë|| deföed(
SQLITE_DEBUG
)

61699 
SQLITE_PRIVATE
 
	`sqlôe3VdbePrötOp
(
FILE
 *
pOut
, 
pc
, 
Op
 *
pOp
){

61700 *
zP4
;

61701 
zPå
[50];

61702 c⁄° *
zF‹m©1
 = "%4d %-13s %4d %4d %4d %-4s %.2X %s\n";

61703 if–
pOut
==0 )ÖOuà
°dout
;

61704 
zP4
 = 
	`di•œyP4
(
pOp
, 
zPå
, (zPtr));

61705 
	`Ârötf
(
pOut
, 
zF‹m©1
, 
pc
,

61706 
	`sqlôe3OpcodeName
(
pOp
->
›code
),ÖOp->
p1
,ÖOp->
p2
,ÖOp->
p3
, 
zP4
,ÖOp->
p5
,

61707 #ifde‡
SQLITE_DEBUG


61708 
pOp
->
zCommít
 ?ÖOp->zComment : ""

61713 
	`fÊush
(
pOut
);

61720 
	`ªÀa£MemAºay
(
Mem
 *
p
, 
N
){

61721 if–
p
 && 
N
 ){

61722 
Mem
 *
pEnd
;

61723 
sqlôe3
 *
db
 = 
p
->db;

61724 
u8
 
mÆloc_Áûed
 = 
db
->
mÆlocFaûed
;

61725 if–
db
->
≤ByãsFªed
 ){

61726 
pEnd
=&
p
[
N
];Ö<pEnd;Ö++){

61727 
	`sqlôe3DbFªe
(
db
, 
p
->
zMÆloc
);

61731 
pEnd
=&
p
[
N
];Ö<pEnd;Ö++){

61732 
	`as£π
–(&
p
[1])==
pEnd
 ||Ö[0].
db
==p[1].db );

61746 if–
p
->
Êags
&(
MEM_Agg
|
MEM_Dyn
|
MEM_Føme
|
MEM_RowSë
) ){

61747 
	`sqlôe3VdbeMemRñó£
(
p
);

61748 }if–
p
->
zMÆloc
 ){

61749 
	`sqlôe3DbFªe
(
db
, 
p
->
zMÆloc
);

61750 
p
->
zMÆloc
 = 0;

61753 
p
->
Êags
 = 
MEM_InvÆid
;

61755 
db
->
mÆlocFaûed
 = 
mÆloc_Áûed
;

61763 
SQLITE_PRIVATE
 
	`sqlôe3VdbeFømeDñëe
(
VdbeFøme
 *
p
){

61764 
i
;

61765 
Mem
 *
aMem
 = 
	`VdbeFømeMem
(
p
);

61766 
VdbeCurs‹
 **
≠C§
 = (VdbeCurs‹ **)&
aMem
[
p
->
nChûdMem
];

61767 
i
=0; i<
p
->
nChûdC§
; i++){

61768 
	`sqlôe3VdbeFªeCurs‹
(
p
->
v
, 
≠C§
[
i
]);

61770 
	`ªÀa£MemAºay
(
aMem
, 
p
->
nChûdMem
);

61771 
	`sqlôe3DbFªe
(
p
->
v
->
db
,Ö);

61774 #i‚de‡
SQLITE_OMIT_EXPLAIN


61790 
SQLITE_PRIVATE
 
	`sqlôe3VdbeLi°
(

61791 
Vdbe
 *
p


61793 
nRow
;

61794 
nSub
 = 0;

61795 
SubProgøm
 **
≠Sub
 = 0;

61796 
Mem
 *
pSub
 = 0;

61797 
sqlôe3
 *
db
 = 
p
->db;

61798 
i
;

61799 
rc
 = 
SQLITE_OK
;

61800 
Mem
 *
pMem
 = &
p
->
aMem
[1];

61802 
	`as£π
–
p
->
ex∂aö
 );

61803 
	`as£π
–
p
->
magic
==
VDBE_MAGIC_RUN
 );

61804 
	`as£π
–
p
->
rc
==
SQLITE_OK
 ||Ö->rc==
SQLITE_BUSY
 ||Ö->rc==
SQLITE_NOMEM
 );

61810 
	`ªÀa£MemAºay
(
pMem
, 8);

61811 
p
->
pResu…Së
 = 0;

61813 if–
p
->
rc
==
SQLITE_NOMEM
 ){

61816 
db
->
mÆlocFaûed
 = 1;

61817  
SQLITE_ERROR
;

61827 
nRow
 = 
p
->
nOp
;

61828 if–
p
->
ex∂aö
==1 ){

61833 
	`as£π
–
p
->
nMem
>9 );

61834 
pSub
 = &
p
->
aMem
[9];

61835 if–
pSub
->
Êags
&
MEM_Blob
 ){

61838 
nSub
 = 
pSub
->
n
/(
Vdbe
*);

61839 
≠Sub
 = (
SubProgøm
 **)
pSub
->
z
;

61841 
i
=0; i<
nSub
; i++){

61842 
nRow
 +
≠Sub
[
i
]->
nOp
;

61847 
i
 = 
p
->
pc
++;

61848 } 
i
<
nRow
 && 
p
->
ex∂aö
==2 &&Ö->
aOp
[i].
›code
!=
OP_Ex∂aö
 );

61849 if–
i
>=
nRow
 ){

61850 
p
->
rc
 = 
SQLITE_OK
;

61851 
rc
 = 
SQLITE_DONE
;

61852 }if–
db
->
u1
.
isI¡îru±ed
 ){

61853 
p
->
rc
 = 
SQLITE_INTERRUPT
;

61854 
rc
 = 
SQLITE_ERROR
;

61855 
	`sqlôe3SëSåög
(&
p
->
zEºMsg
, 
db
, "%s", 
	`sqlôe3EºSå
’->
rc
));

61857 *
z
;

61858 
Op
 *
pOp
;

61859 if–
i
<
p
->
nOp
 ){

61862 
pOp
 = &
p
->
aOp
[
i
];

61866 
j
;

61867 
i
 -
p
->
nOp
;

61868 
j
=0; 
i
>=
≠Sub
[j]->
nOp
; j++){

61869 
i
 -
≠Sub
[
j
]->
nOp
;

61871 
pOp
 = &
≠Sub
[
j
]->
aOp
[
i
];

61873 if–
p
->
ex∂aö
==1 ){

61874 
pMem
->
Êags
 = 
MEM_I¡
;

61875 
pMem
->
ty≥
 = 
SQLITE_INTEGER
;

61876 
pMem
->
u
.
i
 = i;

61877 
pMem
++;

61879 
pMem
->
Êags
 = 
MEM_Sètic
|
MEM_Så
|
MEM_Tîm
;

61880 
pMem
->
z
 = (*)
	`sqlôe3OpcodeName
(
pOp
->
›code
);

61881 
	`as£π
–
pMem
->
z
!=0 );

61882 
pMem
->
n
 = 
	`sqlôe3SåÀn30
’Mem->
z
);

61883 
pMem
->
ty≥
 = 
SQLITE_TEXT
;

61884 
pMem
->
íc
 = 
SQLITE_UTF8
;

61885 
pMem
++;

61892 if–
pOp
->
p4ty≥
==
P4_SUBPROGRAM
 ){

61893 
nByã
 = (
nSub
+1)*(
SubProgøm
*);

61894 
j
;

61895 
j
=0; j<
nSub
; j++){

61896 if–
≠Sub
[
j
]==
pOp
->
p4
.
pProgøm
 ) ;

61898 if–
j
==
nSub
 && 
SQLITE_OK
==
	`sqlôe3VdbeMemGrow
(
pSub
, 
nByã
,ÇSub!=0) ){

61899 
≠Sub
 = (
SubProgøm
 **)
pSub
->
z
;

61900 
≠Sub
[
nSub
++] = 
pOp
->
p4
.
pProgøm
;

61901 
pSub
->
Êags
 |
MEM_Blob
;

61902 
pSub
->
n
 = 
nSub
*(
SubProgøm
*);

61907 
pMem
->
Êags
 = 
MEM_I¡
;

61908 
pMem
->
u
.
i
 = 
pOp
->
p1
;

61909 
pMem
->
ty≥
 = 
SQLITE_INTEGER
;

61910 
pMem
++;

61912 
pMem
->
Êags
 = 
MEM_I¡
;

61913 
pMem
->
u
.
i
 = 
pOp
->
p2
;

61914 
pMem
->
ty≥
 = 
SQLITE_INTEGER
;

61915 
pMem
++;

61917 
pMem
->
Êags
 = 
MEM_I¡
;

61918 
pMem
->
u
.
i
 = 
pOp
->
p3
;

61919 
pMem
->
ty≥
 = 
SQLITE_INTEGER
;

61920 
pMem
++;

61922 if–
	`sqlôe3VdbeMemGrow
(
pMem
, 32, 0) ){

61923 
	`as£π
–
p
->
db
->
mÆlocFaûed
 );

61924  
SQLITE_ERROR
;

61926 
pMem
->
Êags
 = 
MEM_Dyn
|
MEM_Så
|
MEM_Tîm
;

61927 
z
 = 
	`di•œyP4
(
pOp
, 
pMem
->z, 32);

61928 if–
z
!=
pMem
->z ){

61929 
	`sqlôe3VdbeMemSëSå
(
pMem
, 
z
, -1, 
SQLITE_UTF8
, 0);

61931 
	`as£π
–
pMem
->
z
!=0 );

61932 
pMem
->
n
 = 
	`sqlôe3SåÀn30
’Mem->
z
);

61933 
pMem
->
íc
 = 
SQLITE_UTF8
;

61935 
pMem
->
ty≥
 = 
SQLITE_TEXT
;

61936 
pMem
++;

61938 if–
p
->
ex∂aö
==1 ){

61939 if–
	`sqlôe3VdbeMemGrow
(
pMem
, 4, 0) ){

61940 
	`as£π
–
p
->
db
->
mÆlocFaûed
 );

61941  
SQLITE_ERROR
;

61943 
pMem
->
Êags
 = 
MEM_Dyn
|
MEM_Så
|
MEM_Tîm
;

61944 
pMem
->
n
 = 2;

61945 
	`sqlôe3_¢¥ötf
(3, 
pMem
->
z
, "%.2x", 
pOp
->
p5
);

61946 
pMem
->
ty≥
 = 
SQLITE_TEXT
;

61947 
pMem
->
íc
 = 
SQLITE_UTF8
;

61948 
pMem
++;

61950 #ifde‡
SQLITE_DEBUG


61951 if–
pOp
->
zCommít
 ){

61952 
pMem
->
Êags
 = 
MEM_Så
|
MEM_Tîm
;

61953 
pMem
->
z
 = 
pOp
->
zCommít
;

61954 
pMem
->
n
 = 
	`sqlôe3SåÀn30
’Mem->
z
);

61955 
pMem
->
íc
 = 
SQLITE_UTF8
;

61956 
pMem
->
ty≥
 = 
SQLITE_TEXT
;

61960 
pMem
->
Êags
 = 
MEM_NuŒ
;

61961 
pMem
->
ty≥
 = 
SQLITE_NULL
;

61965 
p
->
nResCﬁumn
 = 8 - 4*’->
ex∂aö
-1);

61966 
p
->
pResu…Së
 = &p->
aMem
[1];

61967 
p
->
rc
 = 
SQLITE_OK
;

61968 
rc
 = 
SQLITE_ROW
;

61970  
rc
;

61974 #ifde‡
SQLITE_DEBUG


61978 
SQLITE_PRIVATE
 
	`sqlôe3VdbePrötSql
(
Vdbe
 *
p
){

61979 
nOp
 = 
p
->nOp;

61980 
VdbeOp
 *
pOp
;

61981 if–
nOp
<1 ) ;

61982 
pOp
 = &
p
->
aOp
[0];

61983 if–
pOp
->
›code
==
OP_Tø˚
 &&ÖOp->
p4
.
z
!=0 ){

61984 c⁄° *
z
 = 
pOp
->
p4
.z;

61985  
	`sqlôe3Is•a˚
(*
z
) ) z++;

61986 
	`¥ötf
("SQL: [%s]\n", 
z
);

61991 #i‡!
	`deföed
(
SQLITE_OMIT_TRACE
Ë&& deföed(
SQLITE_ENABLE_IOTRACE
)

61995 
SQLITE_PRIVATE
 
	`sqlôe3VdbeIOTø˚Sql
(
Vdbe
 *
p
){

61996 
nOp
 = 
p
->nOp;

61997 
VdbeOp
 *
pOp
;

61998 if–
sqlôe3IoTø˚
==0 ) ;

61999 if–
nOp
<1 ) ;

62000 
pOp
 = &
p
->
aOp
[0];

62001 if–
pOp
->
›code
==
OP_Tø˚
 &&ÖOp->
p4
.
z
!=0 ){

62002 
i
, 
j
;

62003 
z
[1000];

62004 
	`sqlôe3_¢¥ötf
((
z
), z, "%s", 
pOp
->
p4
.z);

62005 
i
=0; 
	`sqlôe3Is•a˚
(
z
[i]); i++){}

62006 
j
=0; 
z
[
i
]; i++){

62007 if–
	`sqlôe3Is•a˚
(
z
[
i
]) ){

62008 if–
z
[
i
-1]!=' ' ){

62009 
z
[
j
++] = ' ';

62012 
z
[
j
++] = z[
i
];

62015 
z
[
j
] = 0;

62016 
	`sqlôe3IoTø˚
("SQL %s\n", 
z
);

62042 *
	`ÆlocS∑˚
(

62043 *
pBuf
,

62044 
nByã
,

62045 
u8
 **
µFrom
,

62046 
u8
 *
pEnd
,

62047 *
≤Byã


62049 
	`as£π
–
	`EIGHT_BYTE_ALIGNMENT
(*
µFrom
) );

62050 if–
pBuf
 ) ÖBuf;

62051 
nByã
 = 
	`ROUND8
(nByte);

62052 if–&(*
µFrom
)[
nByã
] <
pEnd
 ){

62053 
pBuf
 = (*)*
µFrom
;

62054 *
µFrom
 +
nByã
;

62056 *
≤Byã
 +
nByã
;

62058  
pBuf
;

62065 
SQLITE_PRIVATE
 
	`sqlôe3VdbeRewöd
(
Vdbe
 *
p
){

62066 #i‡
	`deföed
(
SQLITE_DEBUG
Ë|| deföed(
VDBE_PROFILE
)

62067 
i
;

62069 
	`as£π
–
p
!=0 );

62070 
	`as£π
–
p
->
magic
==
VDBE_MAGIC_INIT
 );

62074 
	`as£π
–
p
->
nOp
>0 );

62077 
p
->
magic
 = 
VDBE_MAGIC_RUN
;

62079 #ifde‡
SQLITE_DEBUG


62080 
i
=1; i<
p
->
nMem
; i++){

62081 
	`as£π
–
p
->
aMem
[
i
].
db
==p->db );

62084 
p
->
pc
 = -1;

62085 
p
->
rc
 = 
SQLITE_OK
;

62086 
p
->
îr‹A˘i⁄
 = 
OE_Ab‹t
;

62087 
p
->
magic
 = 
VDBE_MAGIC_RUN
;

62088 
p
->
nCh™ge
 = 0;

62089 
p
->
ˇcheCå
 = 1;

62090 
p
->
möWrôeFûeF‹m©
 = 255;

62091 
p
->
iSèãmít
 = 0;

62092 
p
->
nFkC⁄°øöt
 = 0;

62093 #ifde‡
VDBE_PROFILE


62094 
i
=0; i<
p
->
nOp
; i++){

62095 
p
->
aOp
[
i
].
˙t
 = 0;

62096 
p
->
aOp
[
i
].
cy˛es
 = 0;

62119 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMakeRódy
(

62120 
Vdbe
 *
p
,

62121 
P¨£
 *
pP¨£


62123 
sqlôe3
 *
db
;

62124 
nV¨
;

62125 
nMem
;

62126 
nCurs‹
;

62127 
nArg
;

62128 
nOn˚
;

62129 
n
;

62130 
u8
 *
zC§
;

62131 
u8
 *
zEnd
;

62132 
nByã
;

62134 
	`as£π
–
p
!=0 );

62135 
	`as£π
–
p
->
nOp
>0 );

62136 
	`as£π
–
pP¨£
!=0 );

62137 
	`as£π
–
p
->
magic
==
VDBE_MAGIC_INIT
 );

62138 
db
 = 
p
->db;

62139 
	`as£π
–
db
->
mÆlocFaûed
==0 );

62140 
nV¨
 = 
pP¨£
->nVar;

62141 
nMem
 = 
pP¨£
->nMem;

62142 
nCurs‹
 = 
pP¨£
->
nTab
;

62143 
nArg
 = 
pP¨£
->
nMaxArg
;

62144 
nOn˚
 = 
pP¨£
->nOnce;

62145 if–
nOn˚
==0 )ÇOnce = 1;

62156 
nMem
 +
nCurs‹
;

62161 
zC§
 = (
u8
*)&
p
->
aOp
[p->
nOp
];

62162 
zEnd
 = (
u8
*)&
p
->
aOp
[p->
nOpAŒoc
];

62164 
	`ªsﬁveP2VÆues
(
p
, &
nArg
);

62165 
p
->
u£sStmtJou∫Æ
 = (
u8
)(
pP¨£
->
isMu…iWrôe
 &&ÖP¨£->
mayAb‹t
);

62166 if–
pP¨£
->
ex∂aö
 && 
nMem
<10 ){

62167 
nMem
 = 10;

62169 
	`mem£t
(
zC§
, 0, 
zEnd
-zCsr);

62170 
zC§
 +(zC§ - (
u8
*)0)&7;

62171 
	`as£π
–
	`EIGHT_BYTE_ALIGNMENT
(
zC§
) );

62172 
p
->
expúed
 = 0;

62185 
nByã
 = 0;

62186 
p
->
aMem
 = 
	`ÆlocS∑˚
’->aMem, 
nMem
*(
Mem
), &
zC§
, 
zEnd
, &
nByã
);

62187 
p
->
aV¨
 = 
	`ÆlocS∑˚
’->aV¨, 
nV¨
*(
Mem
), &
zC§
, 
zEnd
, &
nByã
);

62188 
p
->
≠Arg
 = 
	`ÆlocS∑˚
’->≠Arg, 
nArg
*(
Mem
*), &
zC§
, 
zEnd
, &
nByã
);

62189 
p
->
azV¨
 = 
	`ÆlocS∑˚
’->azV¨, 
nV¨
*(*), &
zC§
, 
zEnd
, &
nByã
);

62190 
p
->
≠C§
 = 
	`ÆlocS∑˚
’->≠C§, 
nCurs‹
*(
VdbeCurs‹
*),

62191 &
zC§
, 
zEnd
, &
nByã
);

62192 
p
->
aOn˚Fœg
 = 
	`ÆlocS∑˚
’->aOn˚Fœg, 
nOn˚
, &
zC§
, 
zEnd
, &
nByã
);

62193 if–
nByã
 ){

62194 
p
->
pFªe
 = 
	`sqlôe3DbMÆlocZîo
(
db
, 
nByã
);

62196 
zC§
 = 
p
->
pFªe
;

62197 
zEnd
 = &
zC§
[
nByã
];

62198 } 
nByã
 && !
db
->
mÆlocFaûed
 );

62200 
p
->
nCurs‹
 =ÇCursor;

62201 
p
->
nOn˚Fœg
 = 
nOn˚
;

62202 if–
p
->
aV¨
 ){

62203 
p
->
nV¨
 = (
ynV¨
)nVar;

62204 
n
=0;Ç<
nV¨
;Ç++){

62205 
p
->
aV¨
[
n
].
Êags
 = 
MEM_NuŒ
;

62206 
p
->
aV¨
[
n
].
db
 = db;

62209 if–
p
->
azV¨
 ){

62210 
p
->
nzV¨
 = 
pP¨£
->nzVar;

62211 
	`mem˝y
(
p
->
azV¨
, 
pP¨£
->azV¨,Ö->
nzV¨
*(p->azVar[0]));

62212 
	`mem£t
(
pP¨£
->
azV¨
, 0,ÖP¨£->
nzV¨
*(pParse->azVar[0]));

62214 if–
p
->
aMem
 ){

62215 
p
->
aMem
--;

62216 
p
->
nMem
 =ÇMem;

62217 
n
=1;Ç<=
nMem
;Ç++){

62218 
p
->
aMem
[
n
].
Êags
 = 
MEM_InvÆid
;

62219 
p
->
aMem
[
n
].
db
 = db;

62222 
p
->
ex∂aö
 = 
pP¨£
->explain;

62223 
	`sqlôe3VdbeRewöd
(
p
);

62230 
SQLITE_PRIVATE
 
	`sqlôe3VdbeFªeCurs‹
(
Vdbe
 *
p
, 
VdbeCurs‹
 *
pCx
){

62231 if–
pCx
==0 ){

62234 
	`sqlôe3VdbeS‹ãrClo£
(
p
->
db
, 
pCx
);

62235 if–
pCx
->
pBt
 ){

62236 
	`sqlôe3BåìClo£
(
pCx
->
pBt
);

62239 }if–
pCx
->
pCurs‹
 ){

62240 
	`sqlôe3BåìClo£Curs‹
(
pCx
->
pCurs‹
);

62242 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


62243 if–
pCx
->
pVèbCurs‹
 ){

62244 
sqlôe3_vèb_curs‹
 *
pVèbCurs‹
 = 
pCx
->pVtabCursor;

62245 c⁄° 
sqlôe3_moduÀ
 *
pModuÀ
 = 
pCx
->pModule;

62246 
p
->
öVèbMëhod
 = 1;

62247 
pModuÀ
->
	`xClo£
(
pVèbCurs‹
);

62248 
p
->
öVèbMëhod
 = 0;

62258 
SQLITE_PRIVATE
 
	`sqlôe3VdbeFømeRe°‹e
(
VdbeFøme
 *
pFøme
){

62259 
Vdbe
 *
v
 = 
pFøme
->v;

62260 
v
->
aOn˚Fœg
 = 
pFøme
->aOnceFlag;

62261 
v
->
nOn˚Fœg
 = 
pFøme
->nOnceFlag;

62262 
v
->
aOp
 = 
pFøme
->aOp;

62263 
v
->
nOp
 = 
pFøme
->nOp;

62264 
v
->
aMem
 = 
pFøme
->aMem;

62265 
v
->
nMem
 = 
pFøme
->nMem;

62266 
v
->
≠C§
 = 
pFøme
->apCsr;

62267 
v
->
nCurs‹
 = 
pFøme
->nCursor;

62268 
v
->
db
->
œ°Rowid
 = 
pFøme
->lastRowid;

62269 
v
->
nCh™ge
 = 
pFøme
->nChange;

62270  
pFøme
->
pc
;

62281 
	`˛o£AŒCurs‹s
(
Vdbe
 *
p
){

62282 if–
p
->
pFøme
 ){

62283 
VdbeFøme
 *
pFøme
;

62284 
pFøme
=
p
->pFøme;ÖFøme->
pP¨ít
;ÖFrame=pFrame->pParent);

62285 
	`sqlôe3VdbeFømeRe°‹e
(
pFøme
);

62287 
p
->
pFøme
 = 0;

62288 
p
->
nFøme
 = 0;

62290 if–
p
->
≠C§
 ){

62291 
i
;

62292 
i
=0; i<
p
->
nCurs‹
; i++){

62293 
VdbeCurs‹
 *
pC
 = 
p
->
≠C§
[
i
];

62294 if–
pC
 ){

62295 
	`sqlôe3VdbeFªeCurs‹
(
p
, 
pC
);

62296 
p
->
≠C§
[
i
] = 0;

62300 if–
p
->
aMem
 ){

62301 
	`ªÀa£MemAºay
(&
p
->
aMem
[1],Ö->
nMem
);

62303  
p
->
pDñFøme
 ){

62304 
VdbeFøme
 *
pDñ
 = 
p
->
pDñFøme
;

62305 
p
->
pDñFøme
 = 
pDñ
->
pP¨ít
;

62306 
	`sqlôe3VdbeFømeDñëe
(
pDñ
);

62310 
	`sqlôe3VdbeDñëeAuxD©a
(
p
, -1, 0);

62311 
	`as£π
–
p
->
pAuxD©a
==0 );

62321 
	`CÀ™up
(
Vdbe
 *
p
){

62322 
sqlôe3
 *
db
 = 
p
->db;

62324 #ifde‡
SQLITE_DEBUG


62327 
i
;

62328 if–
p
->
≠C§
 ) 
i
=0; i<p->
nCurs‹
; i++Ë
	`as£π
(Ö->apCsr[i]==0 );

62329 if–
p
->
aMem
 ){

62330 
i
=1; i<=
p
->
nMem
; i++Ë
	`as£π
–p->
aMem
[i].
Êags
==
MEM_InvÆid
 );

62334 
	`sqlôe3DbFªe
(
db
, 
p
->
zEºMsg
);

62335 
p
->
zEºMsg
 = 0;

62336 
p
->
pResu…Së
 = 0;

62345 
SQLITE_PRIVATE
 
	`sqlôe3VdbeSëNumCﬁs
(
Vdbe
 *
p
, 
nResCﬁumn
){

62346 
Mem
 *
pCﬁName
;

62347 
n
;

62348 
sqlôe3
 *
db
 = 
p
->db;

62350 
	`ªÀa£MemAºay
(
p
->
aCﬁName
,Ö->
nResCﬁumn
*
COLNAME_N
);

62351 
	`sqlôe3DbFªe
(
db
, 
p
->
aCﬁName
);

62352 
n
 = 
nResCﬁumn
*
COLNAME_N
;

62353 
p
->
nResCﬁumn
 = (
u16
)nResColumn;

62354 
p
->
aCﬁName
 = 
pCﬁName
 = (
Mem
*)
	`sqlôe3DbMÆlocZîo
(
db
, (Mem)*
n
 );

62355 if–
p
->
aCﬁName
==0 ) ;

62356  
n
-- > 0 ){

62357 
pCﬁName
->
Êags
 = 
MEM_NuŒ
;

62358 
pCﬁName
->
db
 = 
p
->db;

62359 
pCﬁName
++;

62373 
SQLITE_PRIVATE
 
	`sqlôe3VdbeSëCﬁName
(

62374 
Vdbe
 *
p
,

62375 
idx
,

62376 
v¨
,

62377 c⁄° *
zName
,

62378 (*
xDñ
)(*)

62380 
rc
;

62381 
Mem
 *
pCﬁName
;

62382 
	`as£π
–
idx
<
p
->
nResCﬁumn
 );

62383 
	`as£π
–
v¨
<
COLNAME_N
 );

62384 if–
p
->
db
->
mÆlocFaûed
 ){

62385 
	`as£π
–!
zName
 || 
xDñ
!=
SQLITE_DYNAMIC
 );

62386  
SQLITE_NOMEM
;

62388 
	`as£π
–
p
->
aCﬁName
!=0 );

62389 
pCﬁName
 = &(
p
->
aCﬁName
[
idx
+
v¨
*p->
nResCﬁumn
]);

62390 
rc
 = 
	`sqlôe3VdbeMemSëSå
(
pCﬁName
, 
zName
, -1, 
SQLITE_UTF8
, 
xDñ
);

62391 
	`as£π
–
rc
!=0 || !
zName
 || (
pCﬁName
->
Êags
&
MEM_Tîm
)!=0 );

62392  
rc
;

62401 
	`vdbeCommô
(
sqlôe3
 *
db
, 
Vdbe
 *
p
){

62402 
i
;

62403 
nTøns
 = 0;

62404 
rc
 = 
SQLITE_OK
;

62405 
√edXcommô
 = 0;

62407 #ifde‡
SQLITE_OMIT_VIRTUALTABLE


62411 
	`UNUSED_PARAMETER
(
p
);

62420 
rc
 = 
	`sqlôe3VèbSync
(
db
, 
p
);

62428 
i
=0; 
rc
==
SQLITE_OK
 && i<
db
->
nDb
; i++){

62429 
Båì
 *
pBt
 = 
db
->
aDb
[
i
].pBt;

62430 if–
	`sqlôe3BåìIsInTøns
(
pBt
) ){

62431 
√edXcommô
 = 1;

62432 if–
i
!=1 ) 
nTøns
++;

62433 
	`sqlôe3BåìE¡î
(
pBt
);

62434 
rc
 = 
	`sqlôe3PagîEx˛usiveLock
(
	`sqlôe3BåìPagî
(
pBt
));

62435 
	`sqlôe3BåìLóve
(
pBt
);

62438 if–
rc
!=
SQLITE_OK
 ){

62439  
rc
;

62443 if–
√edXcommô
 && 
db
->
xCommôCÆlback
 ){

62444 
rc
 = 
db
->
	`xCommôCÆlback
(db->
pCommôArg
);

62445 if–
rc
 ){

62446  
SQLITE_CONSTRAINT_COMMITHOOK
;

62459 if–0==
	`sqlôe3SåÀn30
(
	`sqlôe3BåìGëFûíame
(
db
->
aDb
[0].
pBt
))

62460 || 
nTøns
<=1

62462 
i
=0; 
rc
==
SQLITE_OK
 && i<
db
->
nDb
; i++){

62463 
Båì
 *
pBt
 = 
db
->
aDb
[
i
].pBt;

62464 if–
pBt
 ){

62465 
rc
 = 
	`sqlôe3BåìCommôPha£O√
(
pBt
, 0);

62474 
i
=0; 
rc
==
SQLITE_OK
 && i<
db
->
nDb
; i++){

62475 
Båì
 *
pBt
 = 
db
->
aDb
[
i
].pBt;

62476 if–
pBt
 ){

62477 
rc
 = 
	`sqlôe3BåìCommôPha£Two
(
pBt
, 0);

62480 if–
rc
==
SQLITE_OK
 ){

62481 
	`sqlôe3VèbCommô
(
db
);

62489 #i‚de‡
SQLITE_OMIT_DISKIO


62491 
sqlôe3_vfs
 *
pVfs
 = 
db
->pVfs;

62492 
√edSync
 = 0;

62493 *
zMa°î
 = 0;

62494 c⁄° *
zMaöFûe
 = 
	`sqlôe3BåìGëFûíame
(
db
->
aDb
[0].
pBt
);

62495 
sqlôe3_fûe
 *
pMa°î
 = 0;

62496 
i64
 
off£t
 = 0;

62497 
ªs
;

62498 
ªåyCou¡
 = 0;

62499 
nMaöFûe
;

62502 
nMaöFûe
 = 
	`sqlôe3SåÀn30
(
zMaöFûe
);

62503 
zMa°î
 = 
	`sqlôe3MPrötf
(
db
, "%s-mjXXXXXX9XXz", 
zMaöFûe
);

62504 if–
zMa°î
==0 )  
SQLITE_NOMEM
;

62506 
u32
 
iR™dom
;

62507 if–
ªåyCou¡
 ){

62508 if–
ªåyCou¡
>100 ){

62509 
	`sqlôe3_log
(
SQLITE_FULL
, "MJ dñëe: %s", 
zMa°î
);

62510 
	`sqlôe3OsDñëe
(
pVfs
, 
zMa°î
, 0);

62512 }if–
ªåyCou¡
==1 ){

62513 
	`sqlôe3_log
(
SQLITE_FULL
, "MJ cﬁlide: %s", 
zMa°î
);

62516 
ªåyCou¡
++;

62517 
	`sqlôe3_øndom√ss
((
iR™dom
), &iRandom);

62518 
	`sqlôe3_¢¥ötf
(13, &
zMa°î
[
nMaöFûe
], "-mj%06X9%02X",

62519 (
iR™dom
>>8)&0xffffff, iRandom&0xff);

62522 
	`as£π
–
zMa°î
[
	`sqlôe3SåÀn30
(zMaster)-3]=='9' );

62523 
	`sqlôe3FûeSuffix3
(
zMaöFûe
, 
zMa°î
);

62524 
rc
 = 
	`sqlôe3OsAc˚ss
(
pVfs
, 
zMa°î
, 
SQLITE_ACCESS_EXISTS
, &
ªs
);

62525 } 
rc
==
SQLITE_OK
 && 
ªs
 );

62526 if–
rc
==
SQLITE_OK
 ){

62528 
rc
 = 
	`sqlôe3OsO≥nMÆloc
(
pVfs
, 
zMa°î
, &
pMa°î
,

62529 
SQLITE_OPEN_READWRITE
|
SQLITE_OPEN_CREATE
|

62530 
SQLITE_OPEN_EXCLUSIVE
|
SQLITE_OPEN_MASTER_JOURNAL
, 0

62533 if–
rc
!=
SQLITE_OK
 ){

62534 
	`sqlôe3DbFªe
(
db
, 
zMa°î
);

62535  
rc
;

62544 
i
=0; i<
db
->
nDb
; i++){

62545 
Båì
 *
pBt
 = 
db
->
aDb
[
i
].pBt;

62546 if–
	`sqlôe3BåìIsInTøns
(
pBt
) ){

62547 c⁄° *
zFûe
 = 
	`sqlôe3BåìGëJou∫Æ«me
(
pBt
);

62548 if–
zFûe
==0 ){

62551 
	`as£π
–
zFûe
[0]!=0 );

62552 if–!
√edSync
 && !
	`sqlôe3BåìSyncDißbÀd
(
pBt
) ){

62553 
√edSync
 = 1;

62555 
rc
 = 
	`sqlôe3OsWrôe
(
pMa°î
, 
zFûe
, 
	`sqlôe3SåÀn30
(zFûe)+1, 
off£t
);

62556 
off£t
 +
	`sqlôe3SåÀn30
(
zFûe
)+1;

62557 if–
rc
!=
SQLITE_OK
 ){

62558 
	`sqlôe3OsClo£Fªe
(
pMa°î
);

62559 
	`sqlôe3OsDñëe
(
pVfs
, 
zMa°î
, 0);

62560 
	`sqlôe3DbFªe
(
db
, 
zMa°î
);

62561  
rc
;

62569 if–
√edSync


62570 && 0==(
	`sqlôe3OsDevi˚Ch¨a˘îi°ics
(
pMa°î
)&
SQLITE_IOCAP_SEQUENTIAL
)

62571 && 
SQLITE_OK
!=(
rc
 = 
	`sqlôe3OsSync
(
pMa°î
, 
SQLITE_SYNC_NORMAL
))

62573 
	`sqlôe3OsClo£Fªe
(
pMa°î
);

62574 
	`sqlôe3OsDñëe
(
pVfs
, 
zMa°î
, 0);

62575 
	`sqlôe3DbFªe
(
db
, 
zMa°î
);

62576  
rc
;

62589 
i
=0; 
rc
==
SQLITE_OK
 && i<
db
->
nDb
; i++){

62590 
Båì
 *
pBt
 = 
db
->
aDb
[
i
].pBt;

62591 if–
pBt
 ){

62592 
rc
 = 
	`sqlôe3BåìCommôPha£O√
(
pBt
, 
zMa°î
);

62595 
	`sqlôe3OsClo£Fªe
(
pMa°î
);

62596 
	`as£π
–
rc
!=
SQLITE_BUSY
 );

62597 if–
rc
!=
SQLITE_OK
 ){

62598 
	`sqlôe3DbFªe
(
db
, 
zMa°î
);

62599  
rc
;

62606 
rc
 = 
	`sqlôe3OsDñëe
(
pVfs
, 
zMa°î
, 1);

62607 
	`sqlôe3DbFªe
(
db
, 
zMa°î
);

62608 
zMa°î
 = 0;

62609 if–
rc
 ){

62610  
rc
;

62620 
	`dißbÀ_simuœãd_io_îr‹s
();

62621 
	`sqlôe3BegöBíignMÆloc
();

62622 
i
=0; i<
db
->
nDb
; i++){

62623 
Båì
 *
pBt
 = 
db
->
aDb
[
i
].pBt;

62624 if–
pBt
 ){

62625 
	`sqlôe3BåìCommôPha£Two
(
pBt
, 1);

62628 
	`sqlôe3EndBíignMÆloc
();

62629 
	`íabÀ_simuœãd_io_îr‹s
();

62631 
	`sqlôe3VèbCommô
(
db
);

62635  
rc
;

62647 #i‚de‡
NDEBUG


62648 
	`checkA˘iveVdbeC¡
(
sqlôe3
 *
db
){

62649 
Vdbe
 *
p
;

62650 
˙t
 = 0;

62651 
nWrôe
 = 0;

62652 
nRód
 = 0;

62653 
p
 = 
db
->
pVdbe
;

62654  
p
 ){

62655 if–
p
->
magic
==
VDBE_MAGIC_RUN
 &&Ö->
pc
>=0 ){

62656 
˙t
++;

62657 if–
p
->
ªadO∆y
==0 ) 
nWrôe
++;

62658 if–
p
->
bIsRódî
 ) 
nRód
++;

62660 
p
 =Ö->
pNext
;

62662 
	`as£π
–
˙t
==
db
->
nVdbeA˘ive
 );

62663 
	`as£π
–
nWrôe
==
db
->
nVdbeWrôe
 );

62664 
	`as£π
–
nRód
==
db
->
nVdbeRód
 );

62667 
	#checkA˘iveVdbeC¡
(
x
)

	)

62680 
SQLITE_PRIVATE
 
	`sqlôe3VdbeClo£Sèãmít
(
Vdbe
 *
p
, 
eOp
){

62681 
sqlôe3
 *c⁄° 
db
 = 
p
->db;

62682 
rc
 = 
SQLITE_OK
;

62689 if–
db
->
nSèãmít
 && 
p
->
iSèãmít
 ){

62690 
i
;

62691 c⁄° 
iSavïoöt
 = 
p
->
iSèãmít
-1;

62693 
	`as£π
–
eOp
==
SAVEPOINT_ROLLBACK
 ||ÉOp==
SAVEPOINT_RELEASE
);

62694 
	`as£π
–
db
->
nSèãmít
>0 );

62695 
	`as£π
–
p
->
iSèãmít
==(
db
->
nSèãmít
+db->
nSavïoöt
) );

62697 
i
=0; i<
db
->
nDb
; i++){

62698 
rc2
 = 
SQLITE_OK
;

62699 
Båì
 *
pBt
 = 
db
->
aDb
[
i
].pBt;

62700 if–
pBt
 ){

62701 if–
eOp
==
SAVEPOINT_ROLLBACK
 ){

62702 
rc2
 = 
	`sqlôe3BåìSavïoöt
(
pBt
, 
SAVEPOINT_ROLLBACK
, 
iSavïoöt
);

62704 if–
rc2
==
SQLITE_OK
 ){

62705 
rc2
 = 
	`sqlôe3BåìSavïoöt
(
pBt
, 
SAVEPOINT_RELEASE
, 
iSavïoöt
);

62707 if–
rc
==
SQLITE_OK
 ){

62708 
rc
 = 
rc2
;

62712 
db
->
nSèãmít
--;

62713 
p
->
iSèãmít
 = 0;

62715 if–
rc
==
SQLITE_OK
 ){

62716 if–
eOp
==
SAVEPOINT_ROLLBACK
 ){

62717 
rc
 = 
	`sqlôe3VèbSavïoöt
(
db
, 
SAVEPOINT_ROLLBACK
, 
iSavïoöt
);

62719 if–
rc
==
SQLITE_OK
 ){

62720 
rc
 = 
	`sqlôe3VèbSavïoöt
(
db
, 
SAVEPOINT_RELEASE
, 
iSavïoöt
);

62727 if–
eOp
==
SAVEPOINT_ROLLBACK
 ){

62728 
db
->
nDe„ºedC⁄s
 = 
p
->
nStmtDefC⁄s
;

62729 
db
->
nDe„ºedImmC⁄s
 = 
p
->
nStmtDefImmC⁄s
;

62732  
rc
;

62745 #i‚de‡
SQLITE_OMIT_FOREIGN_KEY


62746 
SQLITE_PRIVATE
 
	`sqlôe3VdbeCheckFk
(
Vdbe
 *
p
, 
de„ºed
){

62747 
sqlôe3
 *
db
 = 
p
->db;

62748 if–(
de„ºed
 && (
db
->
nDe„ºedC⁄s
+db->
nDe„ºedImmC⁄s
)>0)

62749 || (!
de„ºed
 && 
p
->
nFkC⁄°øöt
>0)

62751 
p
->
rc
 = 
SQLITE_CONSTRAINT_FOREIGNKEY
;

62752 
p
->
îr‹A˘i⁄
 = 
OE_Ab‹t
;

62753 
	`sqlôe3SëSåög
(&
p
->
zEºMsg
, 
db
, "foreign key constraint failed");

62754  
SQLITE_ERROR
;

62756  
SQLITE_OK
;

62773 
SQLITE_PRIVATE
 
	`sqlôe3VdbeHÆt
(
Vdbe
 *
p
){

62774 
rc
;

62775 
sqlôe3
 *
db
 = 
p
->db;

62793 if–
p
->
db
->
mÆlocFaûed
 ){

62794 
p
->
rc
 = 
SQLITE_NOMEM
;

62796 if–
p
->
aOn˚Fœg
 ) 
	`mem£t
’->aOn˚Fœg, 0,Ö->
nOn˚Fœg
);

62797 
	`˛o£AŒCurs‹s
(
p
);

62798 if–
p
->
magic
!=
VDBE_MAGIC_RUN
 ){

62799  
SQLITE_OK
;

62801 
	`checkA˘iveVdbeC¡
(
db
);

62805 if–
p
->
pc
>=0 &&Ö->
bIsRódî
 ){

62806 
mrc
;

62807 
eSèãmítOp
 = 0;

62808 
isS≥cülEº‹
;

62811 
	`sqlôe3VdbeE¡î
(
p
);

62814 
mrc
 = 
p
->
rc
 & 0xff;

62815 
	`as£π
–
p
->
rc
!=
SQLITE_IOERR_BLOCKED
 );

62816 
isS≥cülEº‹
 = 
mrc
==
SQLITE_NOMEM
 || mrc==
SQLITE_IOERR


62817 || 
mrc
==
SQLITE_INTERRUPT
 || mrc==
SQLITE_FULL
;

62818 if–
isS≥cülEº‹
 ){

62831 if–!
p
->
ªadO∆y
 || 
mrc
!=
SQLITE_INTERRUPT
 ){

62832 if–(
mrc
==
SQLITE_NOMEM
 || mrc==
SQLITE_FULL
Ë&& 
p
->
u£sStmtJou∫Æ
 ){

62833 
eSèãmítOp
 = 
SAVEPOINT_ROLLBACK
;

62838 
	`sqlôe3RﬁlbackAŒ
(
db
, 
SQLITE_ABORT_ROLLBACK
);

62839 
	`sqlôe3Clo£Savïoöts
(
db
);

62840 
db
->
autoCommô
 = 1;

62846 if–
p
->
rc
==
SQLITE_OK
 ){

62847 
	`sqlôe3VdbeCheckFk
(
p
, 0);

62856 if–!
	`sqlôe3VèbInSync
(
db
)

62857 && 
db
->
autoCommô


62858 && 
db
->
nVdbeWrôe
==(
p
->
ªadO∆y
==0)

62860 if–
p
->
rc
==
SQLITE_OK
 || (p->
îr‹A˘i⁄
==
OE_Faû
 && !
isS≥cülEº‹
) ){

62861 
rc
 = 
	`sqlôe3VdbeCheckFk
(
p
, 1);

62862 if–
rc
!=
SQLITE_OK
 ){

62863 if–
	`NEVER
(
p
->
ªadO∆y
) ){

62864 
	`sqlôe3VdbeLóve
(
p
);

62865  
SQLITE_ERROR
;

62867 
rc
 = 
SQLITE_CONSTRAINT_FOREIGNKEY
;

62873 
rc
 = 
	`vdbeCommô
(
db
, 
p
);

62875 if–
rc
==
SQLITE_BUSY
 && 
p
->
ªadO∆y
 ){

62876 
	`sqlôe3VdbeLóve
(
p
);

62877  
SQLITE_BUSY
;

62878 }if–
rc
!=
SQLITE_OK
 ){

62879 
p
->
rc
 =Ñc;

62880 
	`sqlôe3RﬁlbackAŒ
(
db
, 
SQLITE_OK
);

62882 
db
->
nDe„ºedC⁄s
 = 0;

62883 
db
->
nDe„ºedImmC⁄s
 = 0;

62884 
db
->
Êags
 &~
SQLITE_De„rFKs
;

62885 
	`sqlôe3CommôI¡î«lCh™ges
(
db
);

62888 
	`sqlôe3RﬁlbackAŒ
(
db
, 
SQLITE_OK
);

62890 
db
->
nSèãmít
 = 0;

62891 }if–
eSèãmítOp
==0 ){

62892 if–
p
->
rc
==
SQLITE_OK
 ||Ö->
îr‹A˘i⁄
==
OE_Faû
 ){

62893 
eSèãmítOp
 = 
SAVEPOINT_RELEASE
;

62894 }if–
p
->
îr‹A˘i⁄
==
OE_Ab‹t
 ){

62895 
eSèãmítOp
 = 
SAVEPOINT_ROLLBACK
;

62897 
	`sqlôe3RﬁlbackAŒ
(
db
, 
SQLITE_ABORT_ROLLBACK
);

62898 
	`sqlôe3Clo£Savïoöts
(
db
);

62899 
db
->
autoCommô
 = 1;

62909 if–
eSèãmítOp
 ){

62910 
rc
 = 
	`sqlôe3VdbeClo£Sèãmít
(
p
, 
eSèãmítOp
);

62911 if–
rc
 ){

62912 if–
p
->
rc
==
SQLITE_OK
 || (p->rc&0xff)==
SQLITE_CONSTRAINT
 ){

62913 
p
->
rc
 =Ñc;

62914 
	`sqlôe3DbFªe
(
db
, 
p
->
zEºMsg
);

62915 
p
->
zEºMsg
 = 0;

62917 
	`sqlôe3RﬁlbackAŒ
(
db
, 
SQLITE_ABORT_ROLLBACK
);

62918 
	`sqlôe3Clo£Savïoöts
(
db
);

62919 
db
->
autoCommô
 = 1;

62926 if–
p
->
ch™geC¡On
 ){

62927 if–
eSèãmítOp
!=
SAVEPOINT_ROLLBACK
 ){

62928 
	`sqlôe3VdbeSëCh™ges
(
db
, 
p
->
nCh™ge
);

62930 
	`sqlôe3VdbeSëCh™ges
(
db
, 0);

62932 
p
->
nCh™ge
 = 0;

62936 
	`sqlôe3VdbeLóve
(
p
);

62940 if–
p
->
pc
>=0 ){

62941 
db
->
nVdbeA˘ive
--;

62942 if–!
p
->
ªadO∆y
 ) 
db
->
nVdbeWrôe
--;

62943 if–
p
->
bIsRódî
 ) 
db
->
nVdbeRód
--;

62944 
	`as£π
–
db
->
nVdbeA˘ive
>=db->
nVdbeRód
 );

62945 
	`as£π
–
db
->
nVdbeRód
>=db->
nVdbeWrôe
 );

62946 
	`as£π
–
db
->
nVdbeWrôe
>=0 );

62948 
p
->
magic
 = 
VDBE_MAGIC_HALT
;

62949 
	`checkA˘iveVdbeC¡
(
db
);

62950 if–
p
->
db
->
mÆlocFaûed
 ){

62951 
p
->
rc
 = 
SQLITE_NOMEM
;

62958 if–
db
->
autoCommô
 ){

62959 
	`sqlôe3C⁄√˘i⁄U∆ocked
(
db
);

62962 
	`as£π
–
db
->
nVdbeA˘ive
>0 || db->
autoCommô
==0 || db->
nSèãmít
==0 );

62963  (
p
->
rc
==
SQLITE_BUSY
 ? SQLITE_BUSY : 
SQLITE_OK
);

62971 
SQLITE_PRIVATE
 
	`sqlôe3VdbeRe£tSãpResu…
(
Vdbe
 *
p
){

62972 
p
->
rc
 = 
SQLITE_OK
;

62983 
SQLITE_PRIVATE
 
	`sqlôe3VdbeTøns„rEº‹
(
Vdbe
 *
p
){

62984 
sqlôe3
 *
db
 = 
p
->db;

62985 
rc
 = 
p
->rc;

62986 if–
p
->
zEºMsg
 ){

62987 
u8
 
mÆlocFaûed
 = 
db
->mallocFailed;

62988 
	`sqlôe3BegöBíignMÆloc
();

62989 
	`sqlôe3VÆueSëSå
(
db
->
pEº
, -1, 
p
->
zEºMsg
, 
SQLITE_UTF8
, 
SQLITE_TRANSIENT
);

62990 
	`sqlôe3EndBíignMÆloc
();

62991 
db
->
mÆlocFaûed
 = mallocFailed;

62992 
db
->
îrCode
 = 
rc
;

62994 
	`sqlôe3Eº‹
(
db
, 
rc
, 0);

62996  
rc
;

62999 #ifde‡
SQLITE_ENABLE_SQLLOG


63004 
	`vdbeInvokeSqŒog
(
Vdbe
 *
v
){

63005 if–
sqlôe3GlobÆC⁄fig
.
xSqŒog
 && 
v
->
rc
==
SQLITE_OK
 && v->
zSql
 && v->
pc
>=0 ){

63006 *
zEx∑nded
 = 
	`sqlôe3VdbeEx∑ndSql
(
v
, v->
zSql
);

63007 
	`as£π
–
v
->
db
->
öô
.
busy
==0 );

63008 if–
zEx∑nded
 ){

63009 
sqlôe3GlobÆC⁄fig
.
	`xSqŒog
(

63010 
sqlôe3GlobÆC⁄fig
.
pSqŒogArg
, 
v
->
db
, 
zEx∑nded
, 1

63012 
	`sqlôe3DbFªe
(
v
->
db
, 
zEx∑nded
);

63017 
	#vdbeInvokeSqŒog
(
x
)

	)

63031 
SQLITE_PRIVATE
 
	`sqlôe3VdbeRe£t
(
Vdbe
 *
p
){

63032 
sqlôe3
 *
db
;

63033 
db
 = 
p
->db;

63039 
	`sqlôe3VdbeHÆt
(
p
);

63046 if–
p
->
pc
>=0 ){

63047 
	`vdbeInvokeSqŒog
(
p
);

63048 
	`sqlôe3VdbeTøns„rEº‹
(
p
);

63049 
	`sqlôe3DbFªe
(
db
, 
p
->
zEºMsg
);

63050 
p
->
zEºMsg
 = 0;

63051 if–
p
->
runO∆yOn˚
 )Ö->
expúed
 = 1;

63052 }if–
p
->
rc
 &&Ö->
expúed
 ){

63057 
	`sqlôe3Eº‹
(
db
, 
p
->
rc
, 0);

63058 
	`sqlôe3VÆueSëSå
(
db
->
pEº
, -1, 
p
->
zEºMsg
, 
SQLITE_UTF8
, 
SQLITE_TRANSIENT
);

63059 
	`sqlôe3DbFªe
(
db
, 
p
->
zEºMsg
);

63060 
p
->
zEºMsg
 = 0;

63065 
	`CÀ™up
(
p
);

63069 #ifde‡
VDBE_PROFILE


63071 
FILE
 *
out
 = 
	`f›í
("vdbe_profile.out", "a");

63072 if–
out
 ){

63073 
i
;

63074 
	`Ârötf
(
out
, "---- ");

63075 
i
=0; i<
p
->
nOp
; i++){

63076 
	`Ârötf
(
out
, "%02x", 
p
->
aOp
[
i
].
›code
);

63078 
	`Ârötf
(
out
, "\n");

63079 
i
=0; i<
p
->
nOp
; i++){

63080 
	`Ârötf
(
out
, "%6d %10lld %8lld ",

63081 
p
->
aOp
[
i
].
˙t
,

63082 
p
->
aOp
[
i
].
cy˛es
,

63083 
p
->
aOp
[
i
].
˙t
>0 ?Ö->aOp[i].
cy˛es
/p->aOp[i].cnt : 0

63085 
	`sqlôe3VdbePrötOp
(
out
, 
i
, &
p
->
aOp
[i]);

63087 
	`f˛o£
(
out
);

63091 
p
->
iCuºítTime
 = 0;

63092 
p
->
magic
 = 
VDBE_MAGIC_INIT
;

63093  
p
->
rc
 & 
db
->
îrMask
;

63100 
SQLITE_PRIVATE
 
	`sqlôe3VdbeFöÆize
(
Vdbe
 *
p
){

63101 
rc
 = 
SQLITE_OK
;

63102 if–
p
->
magic
==
VDBE_MAGIC_RUN
 ||Ö->magic==
VDBE_MAGIC_HALT
 ){

63103 
rc
 = 
	`sqlôe3VdbeRe£t
(
p
);

63104 
	`as£π
–(
rc
 & 
p
->
db
->
îrMask
)==rc );

63106 
	`sqlôe3VdbeDñëe
(
p
);

63107  
rc
;

63126 
SQLITE_PRIVATE
 
	`sqlôe3VdbeDñëeAuxD©a
(
Vdbe
 *
pVdbe
, 
iOp
, 
mask
){

63127 
AuxD©a
 **
µ
 = &
pVdbe
->
pAuxD©a
;

63128  *
µ
 ){

63129 
AuxD©a
 *
pAux
 = *
µ
;

63130 if–(
iOp
<0)

63131 || (
pAux
->
iOp
==iO∞&& (pAux->
iArg
>31 || !(
mask
 & ((
u32
)1<<pAux->iArg))))

63133 if–
pAux
->
xDñëe
 ){

63134 
pAux
->
	`xDñëe
(pAux->pAux);

63136 *
µ
 = 
pAux
->
pNext
;

63137 
	`sqlôe3DbFªe
(
pVdbe
->
db
, 
pAux
);

63139 
µ
&
pAux
->
pNext
;

63152 
SQLITE_PRIVATE
 
	`sqlôe3VdbeCÀ¨Obje˘
(
sqlôe3
 *
db
, 
Vdbe
 *
p
){

63153 
SubProgøm
 *
pSub
, *
pNext
;

63154 
i
;

63155 
	`as£π
–
p
->
db
==0 ||Ö->db==db );

63156 
	`ªÀa£MemAºay
(
p
->
aV¨
,Ö->
nV¨
);

63157 
	`ªÀa£MemAºay
(
p
->
aCﬁName
,Ö->
nResCﬁumn
*
COLNAME_N
);

63158 
pSub
=
p
->
pProgøm
;ÖSub;ÖSub=
pNext
){

63159 
pNext
 = 
pSub
->pNext;

63160 
	`vdbeFªeOpAºay
(
db
, 
pSub
->
aOp
,ÖSub->
nOp
);

63161 
	`sqlôe3DbFªe
(
db
, 
pSub
);

63163 
i
=
p
->
nzV¨
-1; i>=0; i--Ë
	`sqlôe3DbFªe
(
db
,Ö->
azV¨
[i]);

63164 
	`vdbeFªeOpAºay
(
db
, 
p
->
aOp
,Ö->
nOp
);

63165 
	`sqlôe3DbFªe
(
db
, 
p
->
aLabñ
);

63166 
	`sqlôe3DbFªe
(
db
, 
p
->
aCﬁName
);

63167 
	`sqlôe3DbFªe
(
db
, 
p
->
zSql
);

63168 
	`sqlôe3DbFªe
(
db
, 
p
->
pFªe
);

63169 #i‡
	`deföed
(
SQLITE_ENABLE_TREE_EXPLAIN
)

63170 
	`sqlôe3DbFªe
(
db
, 
p
->
zEx∂aö
);

63171 
	`sqlôe3DbFªe
(
db
, 
p
->
pEx∂aö
);

63178 
SQLITE_PRIVATE
 
	`sqlôe3VdbeDñëe
(
Vdbe
 *
p
){

63179 
sqlôe3
 *
db
;

63181 if–
	`NEVER
(
p
==0) ) ;

63182 
db
 = 
p
->db;

63183 
	`as£π
–
	`sqlôe3_muãx_hñd
(
db
->
muãx
) );

63184 
	`sqlôe3VdbeCÀ¨Obje˘
(
db
, 
p
);

63185 if–
p
->
pPªv
 ){

63186 
p
->
pPªv
->
pNext
 =Ö->pNext;

63188 
	`as£π
–
db
->
pVdbe
==
p
 );

63189 
db
->
pVdbe
 = 
p
->
pNext
;

63191 if–
p
->
pNext
 ){

63192 
p
->
pNext
->
pPªv
 =Ö->pPrev;

63194 
p
->
magic
 = 
VDBE_MAGIC_DEAD
;

63195 
p
->
db
 = 0;

63196 
	`sqlôe3DbFªe
(
db
, 
p
);

63212 
SQLITE_PRIVATE
 
	`sqlôe3VdbeCurs‹Movëo
(
VdbeCurs‹
 *
p
){

63213 if–
p
->
de„ºedMovëo
 ){

63214 
ªs
, 
rc
;

63215 #ifde‡
SQLITE_TEST


63216 
sqlôe3_£¨ch_cou¡
;

63218 
	`as£π
–
p
->
isTabÀ
 );

63219 
rc
 = 
	`sqlôe3BåìMovëoU≈acked
(
p
->
pCurs‹
, 0,Ö->
movëoT¨gë
, 0, &
ªs
);

63220 if–
rc
 ) Ñc;

63221 
p
->
œ°Rowid
 =Ö->
movëoT¨gë
;

63222 if–
ªs
!=0 )  
SQLITE_CORRUPT_BKPT
;

63223 
p
->
rowidIsVÆid
 = 1;

63224 #ifde‡
SQLITE_TEST


63225 
sqlôe3_£¨ch_cou¡
++;

63227 
p
->
de„ºedMovëo
 = 0;

63228 
p
->
ˇcheSètus
 = 
CACHE_STALE
;

63229 }if–
	`ALWAYS
(
p
->
pCurs‹
) ){

63230 
hasMoved
;

63231 
rc
 = 
	`sqlôe3BåìCurs‹HasMoved
(
p
->
pCurs‹
, &
hasMoved
);

63232 if–
rc
 ) Ñc;

63233 if–
hasMoved
 ){

63234 
p
->
ˇcheSètus
 = 
CACHE_STALE
;

63235 
p
->
nuŒRow
 = 1;

63238  
SQLITE_OK
;

63286 
SQLITE_PRIVATE
 
u32
 
	`sqlôe3VdbeSîülTy≥
(
Mem
 *
pMem
, 
fûe_f‹m©
){

63287 
Êags
 = 
pMem
->flags;

63288 
n
;

63290 if–
Êags
&
MEM_NuŒ
 ){

63293 if–
Êags
&
MEM_I¡
 ){

63295 
	#MAX_6BYTE
 ((((
i64
)0x00008000)<<32)-1)

	)

63296 
i64
 
i
 = 
pMem
->
u
.i;

63297 
u64
 
u
;

63298 if–
i
<0 ){

63299 if–
i
<(-
MAX_6BYTE
) )  6;

63301 
u
 = -
i
;

63303 
u
 = 
i
;

63305 if–
u
<=127 ){

63306  ((
i
&1)==ò&& 
fûe_f‹m©
>=4Ë? 8+(
u32
)
u
 : 1;

63308 if–
u
<=32767 )  2;

63309 if–
u
<=8388607 )  3;

63310 if–
u
<=2147483647 )  4;

63311 if–
u
<=
MAX_6BYTE
 )  5;

63314 if–
Êags
&
MEM_Ról
 ){

63317 
	`as£π
–
pMem
->
db
->
mÆlocFaûed
 || 
Êags
&(
MEM_Så
|
MEM_Blob
) );

63318 
n
 = 
pMem
->n;

63319 if–
Êags
 & 
MEM_Zîo
 ){

63320 
n
 +
pMem
->
u
.
nZîo
;

63322 
	`as£π
–
n
>=0 );

63323  ((
n
*2Ë+ 12 + ((
Êags
&
MEM_Så
)!=0));

63329 
SQLITE_PRIVATE
 
u32
 
	`sqlôe3VdbeSîülTy≥Lí
(u32 
£rül_ty≥
){

63330 if–
£rül_ty≥
>=12 ){

63331  (
£rül_ty≥
-12)/2;

63333 c⁄° 
u8
 
aSize
[] = { 0, 1, 2, 3, 4, 6, 8, 8, 0, 0, 0, 0 };

63334  
aSize
[
£rül_ty≥
];

63372 #ifde‡
SQLITE_MIXED_ENDIAN_64BIT_FLOAT


63373 
u64
 
	`ÊﬂtSw≠
(u64 
ö
){

63375 
u64
 
r
;

63376 
u32
 
i
[2];

63377 } 
u
;

63378 
u32
 
t
;

63380 
u
.
r
 = 
ö
;

63381 
t
 = 
u
.
i
[0];

63382 
u
.
i
[0] = u.i[1];

63383 
u
.
i
[1] = 
t
;

63384  
u
.
r
;

63386 
	#sw≠MixedEndünFlﬂt
(
X
ËX = 
	`ÊﬂtSw≠
(X)

	)

63388 
	#sw≠MixedEndünFlﬂt
(
X
)

	)

63409 
SQLITE_PRIVATE
 
u32
 
	`sqlôe3VdbeSîülPut
(
u8
 *
buf
, 
nBuf
, 
Mem
 *
pMem
, 
fûe_f‹m©
){

63410 
u32
 
£rül_ty≥
 = 
	`sqlôe3VdbeSîülTy≥
(
pMem
, 
fûe_f‹m©
);

63411 
u32
 
Àn
;

63414 if–
£rül_ty≥
<=7 && serial_type>0 ){

63415 
u64
 
v
;

63416 
u32
 
i
;

63417 if–
£rül_ty≥
==7 ){

63418 
	`as£π
–(
v
)==(
pMem
->
r
) );

63419 
	`mem˝y
(&
v
, &
pMem
->
r
, (v));

63420 
	`sw≠MixedEndünFlﬂt
(
v
);

63422 
v
 = 
pMem
->
u
.
i
;

63424 
Àn
 = 
i
 = 
	`sqlôe3VdbeSîülTy≥Lí
(
£rül_ty≥
);

63425 
	`as£π
–
Àn
<=(
u32
)
nBuf
 );

63426  
i
-- ){

63427 
buf
[
i
] = (
u8
)(
v
&0xFF);

63428 
v
 >>= 8;

63430  
Àn
;

63434 if–
£rül_ty≥
>=12 ){

63435 
	`as£π
–
pMem
->
n
 + (’Mem->
Êags
 & 
MEM_Zîo
)?pMem->
u
.
nZîo
:0)

63436 =()
	`sqlôe3VdbeSîülTy≥Lí
(
£rül_ty≥
) );

63437 
	`as£π
–
pMem
->
n
<=
nBuf
 );

63438 
Àn
 = 
pMem
->
n
;

63439 
	`mem˝y
(
buf
, 
pMem
->
z
, 
Àn
);

63440 if–
pMem
->
Êags
 & 
MEM_Zîo
 ){

63441 
Àn
 +
pMem
->
u
.
nZîo
;

63442 
	`as£π
–
nBuf
>=0 );

63443 if–
Àn
 > (
u32
)
nBuf
 ){

63444 
Àn
 = (
u32
)
nBuf
;

63446 
	`mem£t
(&
buf
[
pMem
->
n
], 0, 
Àn
-pMem->n);

63448  
Àn
;

63459 
SQLITE_PRIVATE
 
u32
 
	`sqlôe3VdbeSîülGë
(

63460 c⁄° *
buf
,

63461 
u32
 
£rül_ty≥
,

63462 
Mem
 *
pMem


63464  
£rül_ty≥
 ){

63468 
pMem
->
Êags
 = 
MEM_NuŒ
;

63472 
pMem
->
u
.
i
 = (sig√d )
buf
[0];

63473 
pMem
->
Êags
 = 
MEM_I¡
;

63477 
pMem
->
u
.
i
 = (((sig√d )
buf
[0])<<8) | buf[1];

63478 
pMem
->
Êags
 = 
MEM_I¡
;

63482 
pMem
->
u
.
i
 = (((sig√d )
buf
[0])<<16) | (buf[1]<<8) | buf[2];

63483 
pMem
->
Êags
 = 
MEM_I¡
;

63487 
pMem
->
u
.
i
 = (
buf
[0]<<24) | (buf[1]<<16) | (buf[2]<<8) | buf[3];

63488 
pMem
->
Êags
 = 
MEM_I¡
;

63492 
u64
 
x
 = (((sig√d )
buf
[0])<<8) | buf[1];

63493 
u32
 
y
 = (
buf
[2]<<24) | (buf[3]<<16) | (buf[4]<<8) | buf[5];

63494 
x
 = (x<<32Ë| 
y
;

63495 
pMem
->
u
.
i
 = *(
i64
*)&
x
;

63496 
pMem
->
Êags
 = 
MEM_I¡
;

63501 
u64
 
x
;

63502 
u32
 
y
;

63503 #i‡!
	`deföed
(
NDEBUG
Ë&& !deföed(
SQLITE_OMIT_FLOATING_POINT
)

63509 c⁄° 
u64
 
t1
 = ((u64)0x3ff00000)<<32;

63510 c⁄° 
r1
 = 1.0;

63511 
u64
 
t2
 = 
t1
;

63512 
	`sw≠MixedEndünFlﬂt
(
t2
);

63513 
	`as£π
–(
r1
)==(
t2
Ë&& 
	`memcmp
(&r1, &t2, (r1))==0 );

63516 
x
 = (
buf
[0]<<24) | (buf[1]<<16) | (buf[2]<<8) | buf[3];

63517 
y
 = (
buf
[4]<<24) | (buf[5]<<16) | (buf[6]<<8) | buf[7];

63518 
x
 = (x<<32Ë| 
y
;

63519 if–
£rül_ty≥
==6 ){

63520 
pMem
->
u
.
i
 = *(
i64
*)&
x
;

63521 
pMem
->
Êags
 = 
MEM_I¡
;

63523 
	`as£π
–(
x
)==8 && (
pMem
->
r
)==8 );

63524 
	`sw≠MixedEndünFlﬂt
(
x
);

63525 
	`mem˝y
(&
pMem
->
r
, &
x
, (x));

63526 
pMem
->
Êags
 = 
	`sqlôe3IsNaN
’Mem->
r
Ë? 
MEM_NuŒ
 : 
MEM_Ról
;

63532 
pMem
->
u
.
i
 = 
£rül_ty≥
-8;

63533 
pMem
->
Êags
 = 
MEM_I¡
;

63537 
u32
 
Àn
 = (
£rül_ty≥
-12)/2;

63538 
pMem
->
z
 = (*)
buf
;

63539 
pMem
->
n
 = 
Àn
;

63540 
pMem
->
xDñ
 = 0;

63541 if–
£rül_ty≥
&0x01 ){

63542 
pMem
->
Êags
 = 
MEM_Så
 | 
MEM_Ephem
;

63544 
pMem
->
Êags
 = 
MEM_Blob
 | 
MEM_Ephem
;

63546  
Àn
;

63566 
SQLITE_PRIVATE
 
U≈ackedRec‹d
 *
	`sqlôe3VdbeAŒocU≈ackedRec‹d
(

63567 
KeyInfo
 *
pKeyInfo
,

63568 *
pS∑˚
,

63569 
szS∑˚
,

63570 **
µFªe


63572 
U≈ackedRec‹d
 *
p
;

63573 
nOff
;

63574 
nByã
;

63580 
nOff
 = (8 - (
	`SQLITE_PTR_TO_INT
(
pS∑˚
) & 7)) & 7;

63581 
nByã
 = 
	`ROUND8
((
U≈ackedRec‹d
)Ë+ (
Mem
)*(
pKeyInfo
->
nFõld
+1);

63582 if–
nByã
>
szS∑˚
+
nOff
 ){

63583 
p
 = (
U≈ackedRec‹d
 *)
	`sqlôe3DbMÆlocRaw
(
pKeyInfo
->
db
, 
nByã
);

63584 *
µFªe
 = (*)
p
;

63585 if–!
p
 )  0;

63587 
p
 = (
U≈ackedRec‹d
*)&
pS∑˚
[
nOff
];

63588 *
µFªe
 = 0;

63591 
p
->
aMem
 = (
Mem
*)&((*Ì)[
	`ROUND8
((
U≈ackedRec‹d
))];

63592 
	`as£π
–
pKeyInfo
->
aS‹tOrdî
!=0 );

63593 
p
->
pKeyInfo
 =ÖKeyInfo;

63594 
p
->
nFõld
 = 
pKeyInfo
->nField + 1;

63595  
p
;

63603 
SQLITE_PRIVATE
 
	`sqlôe3VdbeRec‹dU≈ack
(

63604 
KeyInfo
 *
pKeyInfo
,

63605 
nKey
,

63606 c⁄° *
pKey
,

63607 
U≈ackedRec‹d
 *
p


63609 c⁄° *
aKey
 = (c⁄° *)
pKey
;

63610 
d
;

63611 
u32
 
idx
;

63612 
u16
 
u
;

63613 
u32
 
szHdr
;

63614 
Mem
 *
pMem
 = 
p
->
aMem
;

63616 
p
->
Êags
 = 0;

63617 
	`as£π
–
	`EIGHT_BYTE_ALIGNMENT
(
pMem
) );

63618 
idx
 = 
	`gëV¨öt32
(
aKey
, 
szHdr
);

63619 
d
 = 
szHdr
;

63620 
u
 = 0;

63621  
idx
<
szHdr
 && 
u
<
p
->
nFõld
 && 
d
<=
nKey
 ){

63622 
u32
 
£rül_ty≥
;

63624 
idx
 +
	`gëV¨öt32
(&
aKey
[idx], 
£rül_ty≥
);

63625 
pMem
->
íc
 = 
pKeyInfo
->enc;

63626 
pMem
->
db
 = 
pKeyInfo
->db;

63628 
pMem
->
zMÆloc
 = 0;

63629 
d
 +
	`sqlôe3VdbeSîülGë
(&
aKey
[d], 
£rül_ty≥
, 
pMem
);

63630 
pMem
++;

63631 
u
++;

63633 
	`as£π
–
u
<=
pKeyInfo
->
nFõld
 + 1 );

63634 
p
->
nFõld
 = 
u
;

63654 
SQLITE_PRIVATE
 
	`sqlôe3VdbeRec‹dCom∑ª
(

63655 
nKey1
, c⁄° *
pKey1
,

63656 
U≈ackedRec‹d
 *
pPKey2


63658 
u32
 
d1
;

63659 
u32
 
idx1
;

63660 
u32
 
szHdr1
;

63661 
i
 = 0;

63662 
rc
 = 0;

63663 c⁄° *
aKey1
 = (c⁄° *)
pKey1
;

63664 
KeyInfo
 *
pKeyInfo
;

63665 
Mem
 
mem1
;

63667 
pKeyInfo
 = 
pPKey2
->pKeyInfo;

63668 
mem1
.
íc
 = 
pKeyInfo
->enc;

63669 
mem1
.
db
 = 
pKeyInfo
->db;

63671 
	`VVA_ONLY
–
mem1
.
zMÆloc
 = 0; )

63682 
idx1
 = 
	`gëV¨öt32
(
aKey1
, 
szHdr1
);

63683 
d1
 = 
szHdr1
;

63684 
	`as£π
–
pKeyInfo
->
nFõld
+1>=
pPKey2
->nField );

63685 
	`as£π
–
pKeyInfo
->
aS‹tOrdî
!=0 );

63686  
idx1
<
szHdr1
 && 
i
<
pPKey2
->
nFõld
 ){

63687 
u32
 
£rül_ty≥1
;

63690 
idx1
 +
	`gëV¨öt32
–
aKey1
+idx1, 
£rül_ty≥1
 );

63698 if–
d1
+
£rül_ty≥1
+2>(
u32
)
nKey1


63699 && 
d1
+
	`sqlôe3VdbeSîülTy≥Lí
(
£rül_ty≥1
)>(
u32
)
nKey1


63706 
d1
 +
	`sqlôe3VdbeSîülGë
(&
aKey1
[d1], 
£rül_ty≥1
, &
mem1
);

63710 
rc
 = 
	`sqlôe3MemCom∑ª
(&
mem1
, &
pPKey2
->
aMem
[
i
], 
pKeyInfo
->
aCﬁl
[i]);

63711 if–
rc
!=0 ){

63712 
	`as£π
–
mem1
.
zMÆloc
==0 );

63715 if–
pKeyInfo
->
aS‹tOrdî
[
i
] ){

63716 
rc
 = -rc;

63724 if–(
pPKey2
->
Êags
 & 
UNPACKED_PREFIX_SEARCH
Ë&& 
i
==’PKey2->
nFõld
-1) ){

63725 
	`as£π
–
idx1
==
szHdr1
 && 
rc
 );

63726 
	`as£π
–
mem1
.
Êags
 & 
MEM_I¡
 );

63727 
pPKey2
->
Êags
 &~
UNPACKED_PREFIX_SEARCH
;

63728 
pPKey2
->
rowid
 = 
mem1
.
u
.
i
;

63731  
rc
;

63733 
i
++;

63740 
	`as£π
–
mem1
.
zMÆloc
==0 );

63750 
	`as£π
–
rc
==0 );

63751 if–
pPKey2
->
Êags
 & 
UNPACKED_INCRKEY
 ){

63752 
rc
 = -1;

63753 }if–
pPKey2
->
Êags
 & 
UNPACKED_PREFIX_MATCH
 ){

63755 }if–
idx1
<
szHdr1
 ){

63756 
rc
 = 1;

63758  
rc
;

63770 
SQLITE_PRIVATE
 
	`sqlôe3VdbeIdxRowid
(
sqlôe3
 *
db
, 
BtCurs‹
 *
pCur
, 
i64
 *
rowid
){

63771 
i64
 
nCñlKey
 = 0;

63772 
rc
;

63773 
u32
 
szHdr
;

63774 
u32
 
ty≥Rowid
;

63775 
u32
 
ÀnRowid
;

63776 
Mem
 
m
, 
v
;

63778 
	`UNUSED_PARAMETER
(
db
);

63785 
	`as£π
–
	`sqlôe3BåìCurs‹IsVÆid
(
pCur
) );

63786 
	`VVA_ONLY
(
rc
 =Ë
	`sqlôe3BåìKeySize
(
pCur
, &
nCñlKey
);

63787 
	`as£π
–
rc
==
SQLITE_OK
 );

63788 
	`as£π
–(
nCñlKey
 & 
SQLITE_MAX_U32
)==(
u64
)nCellKey );

63791 
	`mem£t
(&
m
, 0, (m));

63792 
rc
 = 
	`sqlôe3VdbeMemFromBåì
(
pCur
, 0, ()
nCñlKey
, 1, &
m
);

63793 if–
rc
 ){

63794  
rc
;

63798 ()
	`gëV¨öt32
((
u8
*)
m
.
z
, 
szHdr
);

63799 
	`ã°ˇ£
–
szHdr
==3 );

63800 
	`ã°ˇ£
–
szHdr
==
m
.
n
 );

63801 if–
	`u∆ikñy
(
szHdr
<3 || ()szHdr>
m
.
n
) ){

63802 
idx_rowid_c‹ru±i⁄
;

63807 ()
	`gëV¨öt32
((
u8
*)&
m
.
z
[
szHdr
-1], 
ty≥Rowid
);

63808 
	`ã°ˇ£
–
ty≥Rowid
==1 );

63809 
	`ã°ˇ£
–
ty≥Rowid
==2 );

63810 
	`ã°ˇ£
–
ty≥Rowid
==3 );

63811 
	`ã°ˇ£
–
ty≥Rowid
==4 );

63812 
	`ã°ˇ£
–
ty≥Rowid
==5 );

63813 
	`ã°ˇ£
–
ty≥Rowid
==6 );

63814 
	`ã°ˇ£
–
ty≥Rowid
==8 );

63815 
	`ã°ˇ£
–
ty≥Rowid
==9 );

63816 if–
	`u∆ikñy
(
ty≥Rowid
<1 ||ÅypeRowid>9 ||ÅypeRowid==7) ){

63817 
idx_rowid_c‹ru±i⁄
;

63819 
ÀnRowid
 = 
	`sqlôe3VdbeSîülTy≥Lí
(
ty≥Rowid
);

63820 
	`ã°ˇ£
–(
u32
)
m
.
n
==
szHdr
+
ÀnRowid
 );

63821 if–
	`u∆ikñy
((
u32
)
m
.
n
<
szHdr
+
ÀnRowid
) ){

63822 
idx_rowid_c‹ru±i⁄
;

63826 
	`sqlôe3VdbeSîülGë
((
u8
*)&
m
.
z
[m.
n
-
ÀnRowid
], 
ty≥Rowid
, &
v
);

63827 *
rowid
 = 
v
.
u
.
i
;

63828 
	`sqlôe3VdbeMemRñó£
(&
m
);

63829  
SQLITE_OK
;

63833 
idx_rowid_c‹ru±i⁄
:

63834 
	`ã°ˇ£
–
m
.
zMÆloc
!=0 );

63835 
	`sqlôe3VdbeMemRñó£
(&
m
);

63836  
SQLITE_CORRUPT_BKPT
;

63850 
SQLITE_PRIVATE
 
	`sqlôe3VdbeIdxKeyCom∑ª
(

63851 
VdbeCurs‹
 *
pC
,

63852 
U≈ackedRec‹d
 *
pU≈acked
,

63853 *
ªs


63855 
i64
 
nCñlKey
 = 0;

63856 
rc
;

63857 
BtCurs‹
 *
pCur
 = 
pC
->
pCurs‹
;

63858 
Mem
 
m
;

63860 
	`as£π
–
	`sqlôe3BåìCurs‹IsVÆid
(
pCur
) );

63861 
	`VVA_ONLY
(
rc
 =Ë
	`sqlôe3BåìKeySize
(
pCur
, &
nCñlKey
);

63862 
	`as£π
–
rc
==
SQLITE_OK
 );

63865 if–
nCñlKey
<=0 ||ÇCellKey>0x7fffffff ){

63866 *
ªs
 = 0;

63867  
SQLITE_CORRUPT_BKPT
;

63869 
	`mem£t
(&
m
, 0, (m));

63870 
rc
 = 
	`sqlôe3VdbeMemFromBåì
(
pC
->
pCurs‹
, 0, ()
nCñlKey
, 1, &
m
);

63871 if–
rc
 ){

63872  
rc
;

63874 
	`as£π
–
pU≈acked
->
Êags
 & 
UNPACKED_PREFIX_MATCH
 );

63875 *
ªs
 = 
	`sqlôe3VdbeRec‹dCom∑ª
(
m
.
n
, m.
z
, 
pU≈acked
);

63876 
	`sqlôe3VdbeMemRñó£
(&
m
);

63877  
SQLITE_OK
;

63884 
SQLITE_PRIVATE
 
	`sqlôe3VdbeSëCh™ges
(
sqlôe3
 *
db
, 
nCh™ge
){

63885 
	`as£π
–
	`sqlôe3_muãx_hñd
(
db
->
muãx
) );

63886 
db
->
nCh™ge
 =ÇChange;

63887 
db
->
nTŸÆCh™ge
 +
nCh™ge
;

63894 
SQLITE_PRIVATE
 
	`sqlôe3VdbeCou¡Ch™ges
(
Vdbe
 *
v
){

63895 
v
->
ch™geC¡On
 = 1;

63908 
SQLITE_PRIVATE
 
	`sqlôe3ExpúePª∑ªdSèãmíts
(
sqlôe3
 *
db
){

63909 
Vdbe
 *
p
;

63910 
p
 = 
db
->
pVdbe
;Ö;Öı->
pNext
){

63911 
p
->
expúed
 = 1;

63918 
SQLITE_PRIVATE
 
sqlôe3
 *
	`sqlôe3VdbeDb
(
Vdbe
 *
v
){

63919  
v
->
db
;

63930 
SQLITE_PRIVATE
 
sqlôe3_vÆue
 *
	`sqlôe3VdbeGëBoundVÆue
(
Vdbe
 *
v
, 
iV¨
, 
u8
 
aff
){

63931 
	`as£π
–
iV¨
>0 );

63932 if–
v
 ){

63933 
Mem
 *
pMem
 = &
v
->
aV¨
[
iV¨
-1];

63934 if–0==(
pMem
->
Êags
 & 
MEM_NuŒ
) ){

63935 
sqlôe3_vÆue
 *
pRë
 = 
	`sqlôe3VÆueNew
(
v
->
db
);

63936 if–
pRë
 ){

63937 
	`sqlôe3VdbeMemC›y
((
Mem
 *)
pRë
, 
pMem
);

63938 
	`sqlôe3VÆueAµlyAfföôy
(
pRë
, 
aff
, 
SQLITE_UTF8
);

63939 
	`sqlôe3VdbeMemSt‹eTy≥
((
Mem
 *)
pRë
);

63941  
pRë
;

63952 
SQLITE_PRIVATE
 
	`sqlôe3VdbeSëV¨mask
(
Vdbe
 *
v
, 
iV¨
){

63953 
	`as£π
–
iV¨
>0 );

63954 if–
iV¨
>32 ){

63955 
v
->
expmask
 = 0xffffffff;

63957 
v
->
expmask
 |((
u32
)1 << (
iV¨
-1));

63961 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


63967 
SQLITE_PRIVATE
 
	`sqlôe3VèbImp‹tEºmsg
(
Vdbe
 *
p
, 
sqlôe3_vèb
 *
pVèb
){

63968 
sqlôe3
 *
db
 = 
p
->db;

63969 
	`sqlôe3DbFªe
(
db
, 
p
->
zEºMsg
);

63970 
p
->
zEºMsg
 = 
	`sqlôe3DbSåDup
(
db
, 
pVèb
->zErrMsg);

63971 
	`sqlôe3_‰ì
(
pVèb
->
zEºMsg
);

63972 
pVèb
->
zEºMsg
 = 0;

63994 #i‚de‡
SQLITE_OMIT_DEPRECATED


64003 
SQLITE_API
 
	`sqlôe3_expúed
(
sqlôe3_°mt
 *
pStmt
){

64004 
Vdbe
 *
p
 = (Vdbe*)
pStmt
;

64005  
p
==0 ||Ö->
expúed
;

64014 
	`vdbeSa„ty
(
Vdbe
 *
p
){

64015 if–
p
->
db
==0 ){

64016 
	`sqlôe3_log
(
SQLITE_MISUSE
, "API called with finalizedÖrepared statement");

64022 
	`vdbeSa„tyNŸNuŒ
(
Vdbe
 *
p
){

64023 if–
p
==0 ){

64024 
	`sqlôe3_log
(
SQLITE_MISUSE
, "API called with NULLÖrepared statement");

64027  
	`vdbeSa„ty
(
p
);

64040 
SQLITE_API
 
	`sqlôe3_föÆize
(
sqlôe3_°mt
 *
pStmt
){

64041 
rc
;

64042 if–
pStmt
==0 ){

64045 
rc
 = 
SQLITE_OK
;

64047 
Vdbe
 *
v
 = (Vdbe*)
pStmt
;

64048 
sqlôe3
 *
db
 = 
v
->db;

64049 if–
	`vdbeSa„ty
(
v
ËË 
SQLITE_MISUSE_BKPT
;

64050 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

64051 
rc
 = 
	`sqlôe3VdbeFöÆize
(
v
);

64052 
rc
 = 
	`sqlôe3ApiExô
(
db
,Ñc);

64053 
	`sqlôe3LóveMuãxAndClo£Zombõ
(
db
);

64055  
rc
;

64066 
SQLITE_API
 
	`sqlôe3_ª£t
(
sqlôe3_°mt
 *
pStmt
){

64067 
rc
;

64068 if–
pStmt
==0 ){

64069 
rc
 = 
SQLITE_OK
;

64071 
Vdbe
 *
v
 = (Vdbe*)
pStmt
;

64072 
	`sqlôe3_muãx_íãr
(
v
->
db
->
muãx
);

64073 
rc
 = 
	`sqlôe3VdbeRe£t
(
v
);

64074 
	`sqlôe3VdbeRewöd
(
v
);

64075 
	`as£π
–(
rc
 & (
v
->
db
->
îrMask
))==rc );

64076 
rc
 = 
	`sqlôe3ApiExô
(
v
->
db
,Ñc);

64077 
	`sqlôe3_muãx_Àave
(
v
->
db
->
muãx
);

64079  
rc
;

64085 
SQLITE_API
 
	`sqlôe3_˛ór_bödögs
(
sqlôe3_°mt
 *
pStmt
){

64086 
i
;

64087 
rc
 = 
SQLITE_OK
;

64088 
Vdbe
 *
p
 = (Vdbe*)
pStmt
;

64089 #i‡
SQLITE_THREADSAFE


64090 
sqlôe3_muãx
 *
muãx
 = ((
Vdbe
*)
pStmt
)->
db
->mutex;

64092 
	`sqlôe3_muãx_íãr
(
muãx
);

64093 
i
=0; i<
p
->
nV¨
; i++){

64094 
	`sqlôe3VdbeMemRñó£
(&
p
->
aV¨
[
i
]);

64095 
p
->
aV¨
[
i
].
Êags
 = 
MEM_NuŒ
;

64097 if–
p
->
isPª∑ªV2
 &&Ö->
expmask
 ){

64098 
p
->
expúed
 = 1;

64100 
	`sqlôe3_muãx_Àave
(
muãx
);

64101  
rc
;

64109 
SQLITE_API
 c⁄° *
	`sqlôe3_vÆue_blob
(
sqlôe3_vÆue
 *
pVÆ
){

64110 
Mem
 *
p
 = (Mem*)
pVÆ
;

64111 if–
p
->
Êags
 & (
MEM_Blob
|
MEM_Så
) ){

64112 
	`sqlôe3VdbeMemEx∑ndBlob
(
p
);

64113 
p
->
Êags
 &~
MEM_Så
;

64114 
p
->
Êags
 |
MEM_Blob
;

64115  
p
->
n
 ?Ö->
z
 : 0;

64117  
	`sqlôe3_vÆue_ãxt
(
pVÆ
);

64120 
SQLITE_API
 
	`sqlôe3_vÆue_byãs
(
sqlôe3_vÆue
 *
pVÆ
){

64121  
	`sqlôe3VÆueByãs
(
pVÆ
, 
SQLITE_UTF8
);

64123 
SQLITE_API
 
	`sqlôe3_vÆue_byãs16
(
sqlôe3_vÆue
 *
pVÆ
){

64124  
	`sqlôe3VÆueByãs
(
pVÆ
, 
SQLITE_UTF16NATIVE
);

64126 
SQLITE_API
 
	`sqlôe3_vÆue_doubÀ
(
sqlôe3_vÆue
 *
pVÆ
){

64127  
	`sqlôe3VdbeRólVÆue
((
Mem
*)
pVÆ
);

64129 
SQLITE_API
 
	`sqlôe3_vÆue_öt
(
sqlôe3_vÆue
 *
pVÆ
){

64130  ()
	`sqlôe3VdbeI¡VÆue
((
Mem
*)
pVÆ
);

64132 
SQLITE_API
 
sqlôe_öt64
 
	`sqlôe3_vÆue_öt64
(
sqlôe3_vÆue
 *
pVÆ
){

64133  
	`sqlôe3VdbeI¡VÆue
((
Mem
*)
pVÆ
);

64135 
SQLITE_API
 c⁄° *
	`sqlôe3_vÆue_ãxt
(
sqlôe3_vÆue
 *
pVÆ
){

64136  (c⁄° *)
	`sqlôe3VÆueText
(
pVÆ
, 
SQLITE_UTF8
);

64138 #i‚de‡
SQLITE_OMIT_UTF16


64139 
SQLITE_API
 c⁄° *
	`sqlôe3_vÆue_ãxt16
(
sqlôe3_vÆue
* 
pVÆ
){

64140  
	`sqlôe3VÆueText
(
pVÆ
, 
SQLITE_UTF16NATIVE
);

64142 
SQLITE_API
 c⁄° *
	`sqlôe3_vÆue_ãxt16be
(
sqlôe3_vÆue
 *
pVÆ
){

64143  
	`sqlôe3VÆueText
(
pVÆ
, 
SQLITE_UTF16BE
);

64145 
SQLITE_API
 c⁄° *
	`sqlôe3_vÆue_ãxt16À
(
sqlôe3_vÆue
 *
pVÆ
){

64146  
	`sqlôe3VÆueText
(
pVÆ
, 
SQLITE_UTF16LE
);

64149 
SQLITE_API
 
	`sqlôe3_vÆue_ty≥
(
sqlôe3_vÆue
* 
pVÆ
){

64150  
pVÆ
->
ty≥
;

64161 
	`£tResu…SåOrEº‹
(

64162 
sqlôe3_c⁄ãxt
 *
pCtx
,

64163 c⁄° *
z
,

64164 
n
,

64165 
u8
 
íc
,

64166 (*
xDñ
)(*)

64168 if–
	`sqlôe3VdbeMemSëSå
(&
pCtx
->
s
, 
z
, 
n
, 
íc
, 
xDñ
)==
SQLITE_TOOBIG
 ){

64169 
	`sqlôe3_ªsu…_îr‹_toobig
(
pCtx
);

64172 
SQLITE_API
 
	`sqlôe3_ªsu…_blob
(

64173 
sqlôe3_c⁄ãxt
 *
pCtx
,

64174 c⁄° *
z
,

64175 
n
,

64176 (*
xDñ
)(*)

64178 
	`as£π
–
n
>=0 );

64179 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pCtx
->
s
.
db
->
muãx
) );

64180 
	`£tResu…SåOrEº‹
(
pCtx
, 
z
, 
n
, 0, 
xDñ
);

64182 
SQLITE_API
 
	`sqlôe3_ªsu…_doubÀ
(
sqlôe3_c⁄ãxt
 *
pCtx
, 
rVÆ
){

64183 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pCtx
->
s
.
db
->
muãx
) );

64184 
	`sqlôe3VdbeMemSëDoubÀ
(&
pCtx
->
s
, 
rVÆ
);

64186 
SQLITE_API
 
	`sqlôe3_ªsu…_îr‹
(
sqlôe3_c⁄ãxt
 *
pCtx
, c⁄° *
z
, 
n
){

64187 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pCtx
->
s
.
db
->
muãx
) );

64188 
pCtx
->
isEº‹
 = 
SQLITE_ERROR
;

64189 
pCtx
->
fEº‹OrAux
 = 1;

64190 
	`sqlôe3VdbeMemSëSå
(&
pCtx
->
s
, 
z
, 
n
, 
SQLITE_UTF8
, 
SQLITE_TRANSIENT
);

64192 #i‚de‡
SQLITE_OMIT_UTF16


64193 
SQLITE_API
 
	`sqlôe3_ªsu…_îr‹16
(
sqlôe3_c⁄ãxt
 *
pCtx
, c⁄° *
z
, 
n
){

64194 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pCtx
->
s
.
db
->
muãx
) );

64195 
pCtx
->
isEº‹
 = 
SQLITE_ERROR
;

64196 
pCtx
->
fEº‹OrAux
 = 1;

64197 
	`sqlôe3VdbeMemSëSå
(&
pCtx
->
s
, 
z
, 
n
, 
SQLITE_UTF16NATIVE
, 
SQLITE_TRANSIENT
);

64200 
SQLITE_API
 
	`sqlôe3_ªsu…_öt
(
sqlôe3_c⁄ãxt
 *
pCtx
, 
iVÆ
){

64201 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pCtx
->
s
.
db
->
muãx
) );

64202 
	`sqlôe3VdbeMemSëI¡64
(&
pCtx
->
s
, (
i64
)
iVÆ
);

64204 
SQLITE_API
 
	`sqlôe3_ªsu…_öt64
(
sqlôe3_c⁄ãxt
 *
pCtx
, 
i64
 
iVÆ
){

64205 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pCtx
->
s
.
db
->
muãx
) );

64206 
	`sqlôe3VdbeMemSëI¡64
(&
pCtx
->
s
, 
iVÆ
);

64208 
SQLITE_API
 
	`sqlôe3_ªsu…_nuŒ
(
sqlôe3_c⁄ãxt
 *
pCtx
){

64209 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pCtx
->
s
.
db
->
muãx
) );

64210 
	`sqlôe3VdbeMemSëNuŒ
(&
pCtx
->
s
);

64212 
SQLITE_API
 
	`sqlôe3_ªsu…_ãxt
(

64213 
sqlôe3_c⁄ãxt
 *
pCtx
,

64214 c⁄° *
z
,

64215 
n
,

64216 (*
xDñ
)(*)

64218 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pCtx
->
s
.
db
->
muãx
) );

64219 
	`£tResu…SåOrEº‹
(
pCtx
, 
z
, 
n
, 
SQLITE_UTF8
, 
xDñ
);

64221 #i‚de‡
SQLITE_OMIT_UTF16


64222 
SQLITE_API
 
	`sqlôe3_ªsu…_ãxt16
(

64223 
sqlôe3_c⁄ãxt
 *
pCtx
,

64224 c⁄° *
z
,

64225 
n
,

64226 (*
xDñ
)(*)

64228 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pCtx
->
s
.
db
->
muãx
) );

64229 
	`£tResu…SåOrEº‹
(
pCtx
, 
z
, 
n
, 
SQLITE_UTF16NATIVE
, 
xDñ
);

64231 
SQLITE_API
 
	`sqlôe3_ªsu…_ãxt16be
(

64232 
sqlôe3_c⁄ãxt
 *
pCtx
,

64233 c⁄° *
z
,

64234 
n
,

64235 (*
xDñ
)(*)

64237 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pCtx
->
s
.
db
->
muãx
) );

64238 
	`£tResu…SåOrEº‹
(
pCtx
, 
z
, 
n
, 
SQLITE_UTF16BE
, 
xDñ
);

64240 
SQLITE_API
 
	`sqlôe3_ªsu…_ãxt16À
(

64241 
sqlôe3_c⁄ãxt
 *
pCtx
,

64242 c⁄° *
z
,

64243 
n
,

64244 (*
xDñ
)(*)

64246 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pCtx
->
s
.
db
->
muãx
) );

64247 
	`£tResu…SåOrEº‹
(
pCtx
, 
z
, 
n
, 
SQLITE_UTF16LE
, 
xDñ
);

64250 
SQLITE_API
 
	`sqlôe3_ªsu…_vÆue
(
sqlôe3_c⁄ãxt
 *
pCtx
, 
sqlôe3_vÆue
 *
pVÆue
){

64251 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pCtx
->
s
.
db
->
muãx
) );

64252 
	`sqlôe3VdbeMemC›y
(&
pCtx
->
s
, 
pVÆue
);

64254 
SQLITE_API
 
	`sqlôe3_ªsu…_zîoblob
(
sqlôe3_c⁄ãxt
 *
pCtx
, 
n
){

64255 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pCtx
->
s
.
db
->
muãx
) );

64256 
	`sqlôe3VdbeMemSëZîoBlob
(&
pCtx
->
s
, 
n
);

64258 
SQLITE_API
 
	`sqlôe3_ªsu…_îr‹_code
(
sqlôe3_c⁄ãxt
 *
pCtx
, 
îrCode
){

64259 
pCtx
->
isEº‹
 = 
îrCode
;

64260 
pCtx
->
fEº‹OrAux
 = 1;

64261 if–
pCtx
->
s
.
Êags
 & 
MEM_NuŒ
 ){

64262 
	`sqlôe3VdbeMemSëSå
(&
pCtx
->
s
, 
	`sqlôe3EºSå
(
îrCode
), -1,

64263 
SQLITE_UTF8
, 
SQLITE_STATIC
);

64268 
SQLITE_API
 
	`sqlôe3_ªsu…_îr‹_toobig
(
sqlôe3_c⁄ãxt
 *
pCtx
){

64269 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pCtx
->
s
.
db
->
muãx
) );

64270 
pCtx
->
isEº‹
 = 
SQLITE_TOOBIG
;

64271 
pCtx
->
fEº‹OrAux
 = 1;

64272 
	`sqlôe3VdbeMemSëSå
(&
pCtx
->
s
, "string or blobÅoo big", -1,

64273 
SQLITE_UTF8
, 
SQLITE_STATIC
);

64277 
SQLITE_API
 
	`sqlôe3_ªsu…_îr‹_nomem
(
sqlôe3_c⁄ãxt
 *
pCtx
){

64278 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pCtx
->
s
.
db
->
muãx
) );

64279 
	`sqlôe3VdbeMemSëNuŒ
(&
pCtx
->
s
);

64280 
pCtx
->
isEº‹
 = 
SQLITE_NOMEM
;

64281 
pCtx
->
fEº‹OrAux
 = 1;

64282 
pCtx
->
s
.
db
->
mÆlocFaûed
 = 1;

64289 
	`doWÆCÆlbacks
(
sqlôe3
 *
db
){

64290 
rc
 = 
SQLITE_OK
;

64291 #i‚de‡
SQLITE_OMIT_WAL


64292 
i
;

64293 
i
=0; i<
db
->
nDb
; i++){

64294 
Båì
 *
pBt
 = 
db
->
aDb
[
i
].pBt;

64295 if–
pBt
 ){

64296 
nE¡ry
 = 
	`sqlôe3PagîWÆCÆlback
(
	`sqlôe3BåìPagî
(
pBt
));

64297 if–
db
->
xWÆCÆlback
 && 
nE¡ry
>0 && 
rc
==
SQLITE_OK
 ){

64298 
rc
 = 
db
->
	`xWÆCÆlback
(db->
pWÆArg
, db, db->
aDb
[
i
].
zName
, 
nE¡ry
);

64303  
rc
;

64315 
	`sqlôe3Sãp
(
Vdbe
 *
p
){

64316 
sqlôe3
 *
db
;

64317 
rc
;

64319 
	`as£π
(
p
);

64320 if–
p
->
magic
!=
VDBE_MAGIC_RUN
 ){

64337 #ifde‡
SQLITE_OMIT_AUTORESET


64338 if–
p
->
rc
==
SQLITE_BUSY
 ||Ö->rc==
SQLITE_LOCKED
 ){

64339 
	`sqlôe3_ª£t
((
sqlôe3_°mt
*)
p
);

64341  
SQLITE_MISUSE_BKPT
;

64344 
	`sqlôe3_ª£t
((
sqlôe3_°mt
*)
p
);

64349 
db
 = 
p
->db;

64350 if–
db
->
mÆlocFaûed
 ){

64351 
p
->
rc
 = 
SQLITE_NOMEM
;

64352  
SQLITE_NOMEM
;

64355 if–
p
->
pc
<=0 &&Ö->
expúed
 ){

64356 
p
->
rc
 = 
SQLITE_SCHEMA
;

64357 
rc
 = 
SQLITE_ERROR
;

64358 
íd_of_°ï
;

64360 if–
p
->
pc
<0 ){

64365 if–
db
->
nVdbeA˘ive
==0 ){

64366 
db
->
u1
.
isI¡îru±ed
 = 0;

64369 
	`as£π
–
db
->
nVdbeWrôe
>0 || db->
autoCommô
==0

64370 || (
db
->
nDe„ºedC⁄s
==0 && db->
nDe„ºedImmC⁄s
==0)

64373 #i‚de‡
SQLITE_OMIT_TRACE


64374 if–
db
->
xProfûe
 && !db->
öô
.
busy
 ){

64375 
	`sqlôe3OsCuºítTimeI¡64
(
db
->
pVfs
, &
p
->
°¨tTime
);

64379 
db
->
nVdbeA˘ive
++;

64380 if–
p
->
ªadO∆y
==0 ) 
db
->
nVdbeWrôe
++;

64381 if–
p
->
bIsRódî
 ) 
db
->
nVdbeRód
++;

64382 
p
->
pc
 = 0;

64384 #i‚de‡
SQLITE_OMIT_EXPLAIN


64385 if–
p
->
ex∂aö
 ){

64386 
rc
 = 
	`sqlôe3VdbeLi°
(
p
);

64390 
db
->
nVdbeExec
++;

64391 
rc
 = 
	`sqlôe3VdbeExec
(
p
);

64392 
db
->
nVdbeExec
--;

64395 #i‚de‡
SQLITE_OMIT_TRACE


64398 if–
rc
!=
SQLITE_ROW
 && 
db
->
xProfûe
 && !db->
öô
.
busy
 && 
p
->
zSql
 ){

64399 
sqlôe3_öt64
 
iNow
;

64400 
	`sqlôe3OsCuºítTimeI¡64
(
db
->
pVfs
, &
iNow
);

64401 
db
->
	`xProfûe
(db->
pProfûeArg
, 
p
->
zSql
, (
iNow
 -Ö->
°¨tTime
)*1000000);

64405 if–
rc
==
SQLITE_DONE
 ){

64406 
	`as£π
–
p
->
rc
==
SQLITE_OK
 );

64407 
p
->
rc
 = 
	`doWÆCÆlbacks
(
db
);

64408 if–
p
->
rc
!=
SQLITE_OK
 ){

64409 
rc
 = 
SQLITE_ERROR
;

64413 
db
->
îrCode
 = 
rc
;

64414 if–
SQLITE_NOMEM
==
	`sqlôe3ApiExô
(
p
->
db
,Ö->
rc
) ){

64415 
p
->
rc
 = 
SQLITE_NOMEM
;

64417 
íd_of_°ï
:

64425 
	`as£π
–
rc
==
SQLITE_ROW
 ||Ñc==
SQLITE_DONE
 ||Ñc==
SQLITE_ERROR


64426 || 
rc
==
SQLITE_BUSY
 ||Ñc==
SQLITE_MISUSE


64428 
	`as£π
–
p
->
rc
!=
SQLITE_ROW
 &&Ö->rc!=
SQLITE_DONE
 );

64429 if–
p
->
isPª∑ªV2
 && 
rc
!=
SQLITE_ROW
 &&Ñc!=
SQLITE_DONE
 ){

64434 
rc
 = 
	`sqlôe3VdbeTøns„rEº‹
(
p
);

64436  (
rc
&
db
->
îrMask
);

64444 
SQLITE_API
 
	`sqlôe3_°ï
(
sqlôe3_°mt
 *
pStmt
){

64445 
rc
 = 
SQLITE_OK
;

64446 
rc2
 = 
SQLITE_OK
;

64447 
Vdbe
 *
v
 = (Vdbe*)
pStmt
;

64448 
˙t
 = 0;

64449 
sqlôe3
 *
db
;

64451 if–
	`vdbeSa„tyNŸNuŒ
(
v
) ){

64452  
SQLITE_MISUSE_BKPT
;

64454 
db
 = 
v
->db;

64455 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

64456 
v
->
doögRîun
 = 0;

64457  (
rc
 = 
	`sqlôe3Sãp
(
v
))==
SQLITE_SCHEMA


64458 && 
˙t
++ < 
SQLITE_MAX_SCHEMA_RETRY


64459 && (
rc2
 = 
rc
 = 
	`sqlôe3Rïª∑ª
(
v
))==
SQLITE_OK
 ){

64460 
	`sqlôe3_ª£t
(
pStmt
);

64461 
v
->
doögRîun
 = 1;

64462 
	`as£π
–
v
->
expúed
==0 );

64464 if–
rc2
!=
SQLITE_OK
 && 
	`ALWAYS
(
v
->
isPª∑ªV2
Ë&& ALWAYS(
db
->
pEº
) ){

64473 c⁄° *
zEº
 = (c⁄° *)
	`sqlôe3_vÆue_ãxt
(
db
->
pEº
);

64474 
	`sqlôe3DbFªe
(
db
, 
v
->
zEºMsg
);

64475 if–!
db
->
mÆlocFaûed
 ){

64476 
v
->
zEºMsg
 = 
	`sqlôe3DbSåDup
(
db
, 
zEº
);

64477 
v
->
rc
 = 
rc2
;

64479 
v
->
zEºMsg
 = 0;

64480 
v
->
rc
 =Ñ¯
SQLITE_NOMEM
;

64483 
rc
 = 
	`sqlôe3ApiExô
(
db
,Ñc);

64484 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

64485  
rc
;

64493 
SQLITE_API
 *
	`sqlôe3_u£r_d©a
(
sqlôe3_c⁄ãxt
 *
p
){

64494 
	`as£π
–
p
 &&Ö->
pFunc
 );

64495  
p
->
pFunc
->
pU£rD©a
;

64508 
SQLITE_API
 
sqlôe3
 *
	`sqlôe3_c⁄ãxt_db_h™dÀ
(
sqlôe3_c⁄ãxt
 *
p
){

64509 
	`as£π
–
p
 &&Ö->
pFunc
 );

64510  
p
->
s
.
db
;

64516 
SQLITE_PRIVATE
 
sqlôe3_öt64
 
	`sqlôe3StmtCuºítTime
(
sqlôe3_c⁄ãxt
 *
p
){

64517 
Vdbe
 *
v
 = 
p
->
pVdbe
;

64518 
rc
;

64519 if–
v
->
iCuºítTime
==0 ){

64520 
rc
 = 
	`sqlôe3OsCuºítTimeI¡64
(
p
->
s
.
db
->
pVfs
, &
v
->
iCuºítTime
);

64521 if–
rc
 ) 
v
->
iCuºítTime
 = 0;

64523  
v
->
iCuºítTime
;

64534 
SQLITE_PRIVATE
 
	`sqlôe3InvÆidFun˘i⁄
(

64535 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

64536 
NŸU£d
,

64537 
sqlôe3_vÆue
 **
NŸU£d2


64539 c⁄° *
zName
 = 
c⁄ãxt
->
pFunc
->zName;

64540 *
zEº
;

64541 
	`UNUSED_PARAMETER2
(
NŸU£d
, 
NŸU£d2
);

64542 
zEº
 = 
	`sqlôe3_m¥ötf
(

64543 "u«bÀÅÿu£ fun˘i⁄ %†öÅhêªque°ed c⁄ãxt", 
zName
);

64544 
	`sqlôe3_ªsu…_îr‹
(
c⁄ãxt
, 
zEº
, -1);

64545 
	`sqlôe3_‰ì
(
zEº
);

64553 
SQLITE_API
 *
	`sqlôe3_aggªg©e_c⁄ãxt
(
sqlôe3_c⁄ãxt
 *
p
, 
nByã
){

64554 
Mem
 *
pMem
;

64555 
	`as£π
–
p
 &&Ö->
pFunc
 &&Ö->pFunc->
xSãp
 );

64556 
	`as£π
–
	`sqlôe3_muãx_hñd
(
p
->
s
.
db
->
muãx
) );

64557 
pMem
 = 
p
->pMem;

64558 
	`ã°ˇ£
–
nByã
<0 );

64559 if–(
pMem
->
Êags
 & 
MEM_Agg
)==0 ){

64560 if–
nByã
<=0 ){

64561 
	`sqlôe3VdbeMemRñó£Exã∫Æ
(
pMem
);

64562 
pMem
->
Êags
 = 
MEM_NuŒ
;

64563 
pMem
->
z
 = 0;

64565 
	`sqlôe3VdbeMemGrow
(
pMem
, 
nByã
, 0);

64566 
pMem
->
Êags
 = 
MEM_Agg
;

64567 
pMem
->
u
.
pDef
 = 
p
->
pFunc
;

64568 if–
pMem
->
z
 ){

64569 
	`mem£t
(
pMem
->
z
, 0, 
nByã
);

64573  (*)
pMem
->
z
;

64580 
SQLITE_API
 *
	`sqlôe3_gë_auxd©a
(
sqlôe3_c⁄ãxt
 *
pCtx
, 
iArg
){

64581 
AuxD©a
 *
pAuxD©a
;

64583 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pCtx
->
s
.
db
->
muãx
) );

64584 
pAuxD©a
=
pCtx
->
pVdbe
->pAuxD©a;ÖAuxD©a;ÖAuxD©aıAuxD©a->
pNext
){

64585 if–
pAuxD©a
->
iOp
==
pCtx
->iO∞&&ÖAuxD©a->
iArg
==iArg ) ;

64588  (
pAuxD©a
 ?ÖAuxD©a->
pAux
 : 0);

64596 
SQLITE_API
 
	`sqlôe3_£t_auxd©a
(

64597 
sqlôe3_c⁄ãxt
 *
pCtx
,

64598 
iArg
,

64599 *
pAux
,

64600 (*
xDñëe
)(*)

64602 
AuxD©a
 *
pAuxD©a
;

64603 
Vdbe
 *
pVdbe
 = 
pCtx
->pVdbe;

64605 
	`as£π
–
	`sqlôe3_muãx_hñd
(
pCtx
->
s
.
db
->
muãx
) );

64606 if–
iArg
<0 ) 
Áûed
;

64608 
pAuxD©a
=
pVdbe
->pAuxD©a;ÖAuxD©a;ÖAuxD©aıAuxD©a->
pNext
){

64609 if–
pAuxD©a
->
iOp
==
pCtx
->iO∞&&ÖAuxD©a->
iArg
==iArg ) ;

64611 if–
pAuxD©a
==0 ){

64612 
pAuxD©a
 = 
	`sqlôe3DbMÆlocZîo
(
pVdbe
->
db
, (
AuxD©a
));

64613 if–!
pAuxD©a
 ) 
Áûed
;

64614 
pAuxD©a
->
iOp
 = 
pCtx
->iOp;

64615 
pAuxD©a
->
iArg
 = iArg;

64616 
pAuxD©a
->
pNext
 = 
pVdbe
->pAuxData;

64617 
pVdbe
->
pAuxD©a
 =ÖAuxData;

64618 if–
pCtx
->
fEº‹OrAux
==0 ){

64619 
pCtx
->
isEº‹
 = 0;

64620 
pCtx
->
fEº‹OrAux
 = 1;

64622 }if–
pAuxD©a
->
xDñëe
 ){

64623 
pAuxD©a
->
	`xDñëe
’AuxD©a->
pAux
);

64626 
pAuxD©a
->
pAux
 =ÖAux;

64627 
pAuxD©a
->
xDñëe
 = xDelete;

64630 
Áûed
:

64631 if–
xDñëe
 ){

64632 
	`xDñëe
(
pAux
);

64636 #i‚de‡
SQLITE_OMIT_DEPRECATED


64646 
SQLITE_API
 
	`sqlôe3_aggªg©e_cou¡
(
sqlôe3_c⁄ãxt
 *
p
){

64647 
	`as£π
–
p
 &&Ö->
pMem
 &&Ö->
pFunc
 &&Ö->pFunc->
xSãp
 );

64648  
p
->
pMem
->
n
;

64655 
SQLITE_API
 
	`sqlôe3_cﬁumn_cou¡
(
sqlôe3_°mt
 *
pStmt
){

64656 
Vdbe
 *
pVm
 = (Vdbê*)
pStmt
;

64657  
pVm
 ?ÖVm->
nResCﬁumn
 : 0;

64664 
SQLITE_API
 
	`sqlôe3_d©a_cou¡
(
sqlôe3_°mt
 *
pStmt
){

64665 
Vdbe
 *
pVm
 = (Vdbê*)
pStmt
;

64666 if–
pVm
==0 ||ÖVm->
pResu…Së
==0 )  0;

64667  
pVm
->
nResCﬁumn
;

64677 
Mem
 *
	`cﬁumnMem
(
sqlôe3_°mt
 *
pStmt
, 
i
){

64678 
Vdbe
 *
pVm
;

64679 
Mem
 *
pOut
;

64681 
pVm
 = (
Vdbe
 *)
pStmt
;

64682 if–
pVm
 &&ÖVm->
pResu…Së
!=0 && 
i
<pVm->
nResCﬁumn
 && i>=0 ){

64683 
	`sqlôe3_muãx_íãr
(
pVm
->
db
->
muãx
);

64684 
pOut
 = &
pVm
->
pResu…Së
[
i
];

64697 c⁄° 
Mem
 
nuŒMem


64698 #i‡
	`deföed
(
SQLITE_DEBUG
Ë&& deföed(
__GNUC__
)

64699 
	`__©åibuã__
((
	`Æig√d
(8)))

64701 {0, "", ()0, {0}, 0, 
MEM_NuŒ
, 
SQLITE_NULL
, 0,

64702 #ifde‡
SQLITE_DEBUG


64707 if–
pVm
 && 
	`ALWAYS
’Vm->
db
) ){

64708 
	`sqlôe3_muãx_íãr
(
pVm
->
db
->
muãx
);

64709 
	`sqlôe3Eº‹
(
pVm
->
db
, 
SQLITE_RANGE
, 0);

64711 
pOut
 = (
Mem
*)&
nuŒMem
;

64713  
pOut
;

64734 
	`cﬁumnMÆlocFaûuª
(
sqlôe3_°mt
 *
pStmt
)

64741 
Vdbe
 *
p
 = (Vdbê*)
pStmt
;

64742 if–
p
 ){

64743 
p
->
rc
 = 
	`sqlôe3ApiExô
’->
db
,Ö->rc);

64744 
	`sqlôe3_muãx_Àave
(
p
->
db
->
muãx
);

64752 
SQLITE_API
 c⁄° *
	`sqlôe3_cﬁumn_blob
(
sqlôe3_°mt
 *
pStmt
, 
i
){

64753 c⁄° *
vÆ
;

64754 
vÆ
 = 
	`sqlôe3_vÆue_blob
–
	`cﬁumnMem
(
pStmt
,
i
) );

64759 
	`cﬁumnMÆlocFaûuª
(
pStmt
);

64760  
vÆ
;

64762 
SQLITE_API
 
	`sqlôe3_cﬁumn_byãs
(
sqlôe3_°mt
 *
pStmt
, 
i
){

64763 
vÆ
 = 
	`sqlôe3_vÆue_byãs
–
	`cﬁumnMem
(
pStmt
,
i
) );

64764 
	`cﬁumnMÆlocFaûuª
(
pStmt
);

64765  
vÆ
;

64767 
SQLITE_API
 
	`sqlôe3_cﬁumn_byãs16
(
sqlôe3_°mt
 *
pStmt
, 
i
){

64768 
vÆ
 = 
	`sqlôe3_vÆue_byãs16
–
	`cﬁumnMem
(
pStmt
,
i
) );

64769 
	`cﬁumnMÆlocFaûuª
(
pStmt
);

64770  
vÆ
;

64772 
SQLITE_API
 
	`sqlôe3_cﬁumn_doubÀ
(
sqlôe3_°mt
 *
pStmt
, 
i
){

64773 
vÆ
 = 
	`sqlôe3_vÆue_doubÀ
–
	`cﬁumnMem
(
pStmt
,
i
) );

64774 
	`cﬁumnMÆlocFaûuª
(
pStmt
);

64775  
vÆ
;

64777 
SQLITE_API
 
	`sqlôe3_cﬁumn_öt
(
sqlôe3_°mt
 *
pStmt
, 
i
){

64778 
vÆ
 = 
	`sqlôe3_vÆue_öt
–
	`cﬁumnMem
(
pStmt
,
i
) );

64779 
	`cﬁumnMÆlocFaûuª
(
pStmt
);

64780  
vÆ
;

64782 
SQLITE_API
 
sqlôe_öt64
 
	`sqlôe3_cﬁumn_öt64
(
sqlôe3_°mt
 *
pStmt
, 
i
){

64783 
sqlôe_öt64
 
vÆ
 = 
	`sqlôe3_vÆue_öt64
–
	`cﬁumnMem
(
pStmt
,
i
) );

64784 
	`cﬁumnMÆlocFaûuª
(
pStmt
);

64785  
vÆ
;

64787 
SQLITE_API
 c⁄° *
	`sqlôe3_cﬁumn_ãxt
(
sqlôe3_°mt
 *
pStmt
, 
i
){

64788 c⁄° *
vÆ
 = 
	`sqlôe3_vÆue_ãxt
–
	`cﬁumnMem
(
pStmt
,
i
) );

64789 
	`cﬁumnMÆlocFaûuª
(
pStmt
);

64790  
vÆ
;

64792 
SQLITE_API
 
sqlôe3_vÆue
 *
	`sqlôe3_cﬁumn_vÆue
(
sqlôe3_°mt
 *
pStmt
, 
i
){

64793 
Mem
 *
pOut
 = 
	`cﬁumnMem
(
pStmt
, 
i
);

64794 if–
pOut
->
Êags
&
MEM_Sètic
 ){

64795 
pOut
->
Êags
 &~
MEM_Sètic
;

64796 
pOut
->
Êags
 |
MEM_Ephem
;

64798 
	`cﬁumnMÆlocFaûuª
(
pStmt
);

64799  (
sqlôe3_vÆue
 *)
pOut
;

64801 #i‚de‡
SQLITE_OMIT_UTF16


64802 
SQLITE_API
 c⁄° *
	`sqlôe3_cﬁumn_ãxt16
(
sqlôe3_°mt
 *
pStmt
, 
i
){

64803 c⁄° *
vÆ
 = 
	`sqlôe3_vÆue_ãxt16
–
	`cﬁumnMem
(
pStmt
,
i
) );

64804 
	`cﬁumnMÆlocFaûuª
(
pStmt
);

64805  
vÆ
;

64808 
SQLITE_API
 
	`sqlôe3_cﬁumn_ty≥
(
sqlôe3_°mt
 *
pStmt
, 
i
){

64809 
iTy≥
 = 
	`sqlôe3_vÆue_ty≥
–
	`cﬁumnMem
(
pStmt
,
i
) );

64810 
	`cﬁumnMÆlocFaûuª
(
pStmt
);

64811  
iTy≥
;

64830 c⁄° *
	`cﬁumnName
(

64831 
sqlôe3_°mt
 *
pStmt
,

64832 
N
,

64833 c⁄° *(*
xFunc
)(
Mem
*),

64834 
u£Ty≥


64836 c⁄° *
ªt
 = 0;

64837 
Vdbe
 *
p
 = (Vdbê*)
pStmt
;

64838 
n
;

64839 
sqlôe3
 *
db
 = 
p
->db;

64841 
	`as£π
–
db
!=0 );

64842 
n
 = 
	`sqlôe3_cﬁumn_cou¡
(
pStmt
);

64843 if–
N
<
n
 && N>=0 ){

64844 
N
 +
u£Ty≥
*
n
;

64845 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

64846 
	`as£π
–
db
->
mÆlocFaûed
==0 );

64847 
ªt
 = 
	`xFunc
(&
p
->
aCﬁName
[
N
]);

64851 if–
db
->
mÆlocFaûed
 ){

64852 
db
->
mÆlocFaûed
 = 0;

64853 
ªt
 = 0;

64855 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

64857  
ªt
;

64864 
SQLITE_API
 c⁄° *
	`sqlôe3_cﬁumn_«me
(
sqlôe3_°mt
 *
pStmt
, 
N
){

64865  
	`cﬁumnName
(

64866 
pStmt
, 
N
, (c⁄° *(*)(
Mem
*))
sqlôe3_vÆue_ãxt
, 
COLNAME_NAME
);

64868 #i‚de‡
SQLITE_OMIT_UTF16


64869 
SQLITE_API
 c⁄° *
	`sqlôe3_cﬁumn_«me16
(
sqlôe3_°mt
 *
pStmt
, 
N
){

64870  
	`cﬁumnName
(

64871 
pStmt
, 
N
, (c⁄° *(*)(
Mem
*))
sqlôe3_vÆue_ãxt16
, 
COLNAME_NAME
);

64879 #i‡
	`deföed
(
SQLITE_OMIT_DECLTYPE
Ë&& deföed(
SQLITE_ENABLE_COLUMN_METADATA
)

64884 #i‚de‡
SQLITE_OMIT_DECLTYPE


64889 
SQLITE_API
 c⁄° *
	`sqlôe3_cﬁumn_de˛ty≥
(
sqlôe3_°mt
 *
pStmt
, 
N
){

64890  
	`cﬁumnName
(

64891 
pStmt
, 
N
, (c⁄° *(*)(
Mem
*))
sqlôe3_vÆue_ãxt
, 
COLNAME_DECLTYPE
);

64893 #i‚de‡
SQLITE_OMIT_UTF16


64894 
SQLITE_API
 c⁄° *
	`sqlôe3_cﬁumn_de˛ty≥16
(
sqlôe3_°mt
 *
pStmt
, 
N
){

64895  
	`cﬁumnName
(

64896 
pStmt
, 
N
, (c⁄° *(*)(
Mem
*))
sqlôe3_vÆue_ãxt16
, 
COLNAME_DECLTYPE
);

64901 #ifde‡
SQLITE_ENABLE_COLUMN_METADATA


64907 
SQLITE_API
 c⁄° *
	`sqlôe3_cﬁumn_d©aba£_«me
(
sqlôe3_°mt
 *
pStmt
, 
N
){

64908  
	`cﬁumnName
(

64909 
pStmt
, 
N
, (c⁄° *(*)(
Mem
*))
sqlôe3_vÆue_ãxt
, 
COLNAME_DATABASE
);

64911 #i‚de‡
SQLITE_OMIT_UTF16


64912 
SQLITE_API
 c⁄° *
	`sqlôe3_cﬁumn_d©aba£_«me16
(
sqlôe3_°mt
 *
pStmt
, 
N
){

64913  
	`cﬁumnName
(

64914 
pStmt
, 
N
, (c⁄° *(*)(
Mem
*))
sqlôe3_vÆue_ãxt16
, 
COLNAME_DATABASE
);

64923 
SQLITE_API
 c⁄° *
	`sqlôe3_cﬁumn_èbÀ_«me
(
sqlôe3_°mt
 *
pStmt
, 
N
){

64924  
	`cﬁumnName
(

64925 
pStmt
, 
N
, (c⁄° *(*)(
Mem
*))
sqlôe3_vÆue_ãxt
, 
COLNAME_TABLE
);

64927 #i‚de‡
SQLITE_OMIT_UTF16


64928 
SQLITE_API
 c⁄° *
	`sqlôe3_cﬁumn_èbÀ_«me16
(
sqlôe3_°mt
 *
pStmt
, 
N
){

64929  
	`cﬁumnName
(

64930 
pStmt
, 
N
, (c⁄° *(*)(
Mem
*))
sqlôe3_vÆue_ãxt16
, 
COLNAME_TABLE
);

64939 
SQLITE_API
 c⁄° *
	`sqlôe3_cﬁumn_‹igö_«me
(
sqlôe3_°mt
 *
pStmt
, 
N
){

64940  
	`cﬁumnName
(

64941 
pStmt
, 
N
, (c⁄° *(*)(
Mem
*))
sqlôe3_vÆue_ãxt
, 
COLNAME_COLUMN
);

64943 #i‚de‡
SQLITE_OMIT_UTF16


64944 
SQLITE_API
 c⁄° *
	`sqlôe3_cﬁumn_‹igö_«me16
(
sqlôe3_°mt
 *
pStmt
, 
N
){

64945  
	`cﬁumnName
(

64946 
pStmt
, 
N
, (c⁄° *(*)(
Mem
*))
sqlôe3_vÆue_ãxt16
, 
COLNAME_COLUMN
);

64967 
	`vdbeUnböd
(
Vdbe
 *
p
, 
i
){

64968 
Mem
 *
pV¨
;

64969 if–
	`vdbeSa„tyNŸNuŒ
(
p
) ){

64970  
SQLITE_MISUSE_BKPT
;

64972 
	`sqlôe3_muãx_íãr
(
p
->
db
->
muãx
);

64973 if–
p
->
magic
!=
VDBE_MAGIC_RUN
 ||Ö->
pc
>=0 ){

64974 
	`sqlôe3Eº‹
(
p
->
db
, 
SQLITE_MISUSE
, 0);

64975 
	`sqlôe3_muãx_Àave
(
p
->
db
->
muãx
);

64976 
	`sqlôe3_log
(
SQLITE_MISUSE
,

64977 "böd o¿®busyÖª∑ªd sèãmít: [%s]", 
p
->
zSql
);

64978  
SQLITE_MISUSE_BKPT
;

64980 if–
i
<1 || i>
p
->
nV¨
 ){

64981 
	`sqlôe3Eº‹
(
p
->
db
, 
SQLITE_RANGE
, 0);

64982 
	`sqlôe3_muãx_Àave
(
p
->
db
->
muãx
);

64983  
SQLITE_RANGE
;

64985 
i
--;

64986 
pV¨
 = &
p
->
aV¨
[
i
];

64987 
	`sqlôe3VdbeMemRñó£
(
pV¨
);

64988 
pV¨
->
Êags
 = 
MEM_NuŒ
;

64989 
	`sqlôe3Eº‹
(
p
->
db
, 
SQLITE_OK
, 0);

65000 if–
p
->
isPª∑ªV2
 &&

65001 ((
i
<32 && 
p
->
expmask
 & ((
u32
)1 << i)) ||Ö->expmask==0xffffffff)

65003 
p
->
expúed
 = 1;

65005  
SQLITE_OK
;

65011 
	`bödText
(

65012 
sqlôe3_°mt
 *
pStmt
,

65013 
i
,

65014 c⁄° *
zD©a
,

65015 
nD©a
,

65016 (*
xDñ
)(*),

65017 
u8
 
ícodög


65019 
Vdbe
 *
p
 = (Vdbê*)
pStmt
;

65020 
Mem
 *
pV¨
;

65021 
rc
;

65023 
rc
 = 
	`vdbeUnböd
(
p
, 
i
);

65024 if–
rc
==
SQLITE_OK
 ){

65025 if–
zD©a
!=0 ){

65026 
pV¨
 = &
p
->
aV¨
[
i
-1];

65027 
rc
 = 
	`sqlôe3VdbeMemSëSå
(
pV¨
, 
zD©a
, 
nD©a
, 
ícodög
, 
xDñ
);

65028 if–
rc
==
SQLITE_OK
 && 
ícodög
!=0 ){

65029 
rc
 = 
	`sqlôe3VdbeCh™geEncodög
(
pV¨
, 
	`ENC
(
p
->
db
));

65031 
	`sqlôe3Eº‹
(
p
->
db
, 
rc
, 0);

65032 
rc
 = 
	`sqlôe3ApiExô
(
p
->
db
,Ñc);

65034 
	`sqlôe3_muãx_Àave
(
p
->
db
->
muãx
);

65035 }if–
xDñ
!=
SQLITE_STATIC
 && xDñ!=
SQLITE_TRANSIENT
 ){

65036 
	`xDñ
((*)
zD©a
);

65038  
rc
;

65045 
SQLITE_API
 
	`sqlôe3_böd_blob
(

65046 
sqlôe3_°mt
 *
pStmt
,

65047 
i
,

65048 c⁄° *
zD©a
,

65049 
nD©a
,

65050 (*
xDñ
)(*)

65052  
	`bödText
(
pStmt
, 
i
, 
zD©a
, 
nD©a
, 
xDñ
, 0);

65054 
SQLITE_API
 
	`sqlôe3_böd_doubÀ
(
sqlôe3_°mt
 *
pStmt
, 
i
, 
rVÆue
){

65055 
rc
;

65056 
Vdbe
 *
p
 = (Vdbê*)
pStmt
;

65057 
rc
 = 
	`vdbeUnböd
(
p
, 
i
);

65058 if–
rc
==
SQLITE_OK
 ){

65059 
	`sqlôe3VdbeMemSëDoubÀ
(&
p
->
aV¨
[
i
-1], 
rVÆue
);

65060 
	`sqlôe3_muãx_Àave
(
p
->
db
->
muãx
);

65062  
rc
;

65064 
SQLITE_API
 
	`sqlôe3_böd_öt
(
sqlôe3_°mt
 *
p
, 
i
, 
iVÆue
){

65065  
	`sqlôe3_böd_öt64
(
p
, 
i
, (
i64
)
iVÆue
);

65067 
SQLITE_API
 
	`sqlôe3_böd_öt64
(
sqlôe3_°mt
 *
pStmt
, 
i
, 
sqlôe_öt64
 
iVÆue
){

65068 
rc
;

65069 
Vdbe
 *
p
 = (Vdbê*)
pStmt
;

65070 
rc
 = 
	`vdbeUnböd
(
p
, 
i
);

65071 if–
rc
==
SQLITE_OK
 ){

65072 
	`sqlôe3VdbeMemSëI¡64
(&
p
->
aV¨
[
i
-1], 
iVÆue
);

65073 
	`sqlôe3_muãx_Àave
(
p
->
db
->
muãx
);

65075  
rc
;

65077 
SQLITE_API
 
	`sqlôe3_böd_nuŒ
(
sqlôe3_°mt
 *
pStmt
, 
i
){

65078 
rc
;

65079 
Vdbe
 *
p
 = (Vdbe*)
pStmt
;

65080 
rc
 = 
	`vdbeUnböd
(
p
, 
i
);

65081 if–
rc
==
SQLITE_OK
 ){

65082 
	`sqlôe3_muãx_Àave
(
p
->
db
->
muãx
);

65084  
rc
;

65086 
SQLITE_API
 
	`sqlôe3_böd_ãxt
(

65087 
sqlôe3_°mt
 *
pStmt
,

65088 
i
,

65089 c⁄° *
zD©a
,

65090 
nD©a
,

65091 (*
xDñ
)(*)

65093  
	`bödText
(
pStmt
, 
i
, 
zD©a
, 
nD©a
, 
xDñ
, 
SQLITE_UTF8
);

65095 #i‚de‡
SQLITE_OMIT_UTF16


65096 
SQLITE_API
 
	`sqlôe3_böd_ãxt16
(

65097 
sqlôe3_°mt
 *
pStmt
,

65098 
i
,

65099 c⁄° *
zD©a
,

65100 
nD©a
,

65101 (*
xDñ
)(*)

65103  
	`bödText
(
pStmt
, 
i
, 
zD©a
, 
nD©a
, 
xDñ
, 
SQLITE_UTF16NATIVE
);

65106 
SQLITE_API
 
	`sqlôe3_böd_vÆue
(
sqlôe3_°mt
 *
pStmt
, 
i
, c⁄° 
sqlôe3_vÆue
 *
pVÆue
){

65107 
rc
;

65108  
pVÆue
->
ty≥
 ){

65109 
SQLITE_INTEGER
: {

65110 
rc
 = 
	`sqlôe3_böd_öt64
(
pStmt
, 
i
, 
pVÆue
->
u
.i);

65113 
SQLITE_FLOAT
: {

65114 
rc
 = 
	`sqlôe3_böd_doubÀ
(
pStmt
, 
i
, 
pVÆue
->
r
);

65117 
SQLITE_BLOB
: {

65118 if–
pVÆue
->
Êags
 & 
MEM_Zîo
 ){

65119 
rc
 = 
	`sqlôe3_böd_zîoblob
(
pStmt
, 
i
, 
pVÆue
->
u
.
nZîo
);

65121 
rc
 = 
	`sqlôe3_böd_blob
(
pStmt
, 
i
, 
pVÆue
->
z
,ÖVÆue->
n
,
SQLITE_TRANSIENT
);

65125 
SQLITE_TEXT
: {

65126 
rc
 = 
	`bödText
(
pStmt
,
i
, 
pVÆue
->
z
,ÖVÆue->
n
, 
SQLITE_TRANSIENT
,

65127 
pVÆue
->
íc
);

65131 
rc
 = 
	`sqlôe3_böd_nuŒ
(
pStmt
, 
i
);

65135  
rc
;

65137 
SQLITE_API
 
	`sqlôe3_böd_zîoblob
(
sqlôe3_°mt
 *
pStmt
, 
i
, 
n
){

65138 
rc
;

65139 
Vdbe
 *
p
 = (Vdbê*)
pStmt
;

65140 
rc
 = 
	`vdbeUnböd
(
p
, 
i
);

65141 if–
rc
==
SQLITE_OK
 ){

65142 
	`sqlôe3VdbeMemSëZîoBlob
(&
p
->
aV¨
[
i
-1], 
n
);

65143 
	`sqlôe3_muãx_Àave
(
p
->
db
->
muãx
);

65145  
rc
;

65152 
SQLITE_API
 
	`sqlôe3_böd_∑ømëî_cou¡
(
sqlôe3_°mt
 *
pStmt
){

65153 
Vdbe
 *
p
 = (Vdbe*)
pStmt
;

65154  
p
 ?Ö->
nV¨
 : 0;

65163 
SQLITE_API
 c⁄° *
	`sqlôe3_böd_∑ømëî_«me
(
sqlôe3_°mt
 *
pStmt
, 
i
){

65164 
Vdbe
 *
p
 = (Vdbe*)
pStmt
;

65165 if–
p
==0 || 
i
<1 || i>p->
nzV¨
 ){

65168  
p
->
azV¨
[
i
-1];

65176 
SQLITE_PRIVATE
 
	`sqlôe3VdbeP¨amëîIndex
(
Vdbe
 *
p
, c⁄° *
zName
, 
nName
){

65177 
i
;

65178 if–
p
==0 ){

65181 if–
zName
 ){

65182 
i
=0; i<
p
->
nzV¨
; i++){

65183 c⁄° *
z
 = 
p
->
azV¨
[
i
];

65184 if–
z
 && 
	`°∫cmp
(z,
zName
,
nName
)==0 && z[nName]==0 ){

65185  
i
+1;

65191 
SQLITE_API
 
	`sqlôe3_böd_∑ømëî_ödex
(
sqlôe3_°mt
 *
pStmt
, c⁄° *
zName
){

65192  
	`sqlôe3VdbeP¨amëîIndex
((
Vdbe
*)
pStmt
, 
zName
, 
	`sqlôe3SåÀn30
(zName));

65198 
SQLITE_PRIVATE
 
	`sqlôe3Tøns„rBödögs
(
sqlôe3_°mt
 *
pFromStmt
, sqlôe3_°mà*
pToStmt
){

65199 
Vdbe
 *
pFrom
 = (Vdbe*)
pFromStmt
;

65200 
Vdbe
 *
pTo
 = (Vdbe*)
pToStmt
;

65201 
i
;

65202 
	`as£π
–
pTo
->
db
==
pFrom
->db );

65203 
	`as£π
–
pTo
->
nV¨
==
pFrom
->nVar );

65204 
	`sqlôe3_muãx_íãr
(
pTo
->
db
->
muãx
);

65205 
i
=0; i<
pFrom
->
nV¨
; i++){

65206 
	`sqlôe3VdbeMemMove
(&
pTo
->
aV¨
[
i
], &
pFrom
->aVar[i]);

65208 
	`sqlôe3_muãx_Àave
(
pTo
->
db
->
muãx
);

65209  
SQLITE_OK
;

65212 #i‚de‡
SQLITE_OMIT_DEPRECATED


65225 
SQLITE_API
 
	`sqlôe3_å™s„r_bödögs
(
sqlôe3_°mt
 *
pFromStmt
, sqlôe3_°mà*
pToStmt
){

65226 
Vdbe
 *
pFrom
 = (Vdbe*)
pFromStmt
;

65227 
Vdbe
 *
pTo
 = (Vdbe*)
pToStmt
;

65228 if–
pFrom
->
nV¨
!=
pTo
->nVar ){

65229  
SQLITE_ERROR
;

65231 if–
pTo
->
isPª∑ªV2
 &&ÖTo->
expmask
 ){

65232 
pTo
->
expúed
 = 1;

65234 if–
pFrom
->
isPª∑ªV2
 &&ÖFrom->
expmask
 ){

65235 
pFrom
->
expúed
 = 1;

65237  
	`sqlôe3Tøns„rBödögs
(
pFromStmt
, 
pToStmt
);

65247 
SQLITE_API
 
sqlôe3
 *
	`sqlôe3_db_h™dÀ
(
sqlôe3_°mt
 *
pStmt
){

65248  
pStmt
 ? ((
Vdbe
*ÌStmt)->
db
 : 0;

65255 
SQLITE_API
 
	`sqlôe3_°mt_ªad⁄ly
(
sqlôe3_°mt
 *
pStmt
){

65256  
pStmt
 ? ((
Vdbe
*ÌStmt)->
ªadO∆y
 : 1;

65262 
SQLITE_API
 
	`sqlôe3_°mt_busy
(
sqlôe3_°mt
 *
pStmt
){

65263 
Vdbe
 *
v
 = (Vdbe*)
pStmt
;

65264  
v
!=0 && v->
pc
>0 && v->
magic
==
VDBE_MAGIC_RUN
;

65273 
SQLITE_API
 
sqlôe3_°mt
 *
	`sqlôe3_√xt_°mt
(
sqlôe3
 *
pDb
, sqlôe3_°mà*
pStmt
){

65274 
sqlôe3_°mt
 *
pNext
;

65275 
	`sqlôe3_muãx_íãr
(
pDb
->
muãx
);

65276 if–
pStmt
==0 ){

65277 
pNext
 = (
sqlôe3_°mt
*)
pDb
->
pVdbe
;

65279 
pNext
 = (
sqlôe3_°mt
*)((
Vdbe
*)
pStmt
)->pNext;

65281 
	`sqlôe3_muãx_Àave
(
pDb
->
muãx
);

65282  
pNext
;

65288 
SQLITE_API
 
	`sqlôe3_°mt_°©us
(
sqlôe3_°mt
 *
pStmt
, 
›
, 
ª£tFœg
){

65289 
Vdbe
 *
pVdbe
 = (Vdbe*)
pStmt
;

65290 
u32
 
v
 = 
pVdbe
->
aCou¡î
[
›
];

65291 if–
ª£tFœg
 ) 
pVdbe
->
aCou¡î
[
›
] = 0;

65292  ()
v
;

65315 #i‚de‡
SQLITE_OMIT_TRACE


65323 
	`födNextHo°P¨amëî
(c⁄° *
zSql
, *
≤Tokí
){

65324 
tokíTy≥
;

65325 
nTŸÆ
 = 0;

65326 
n
;

65328 *
≤Tokí
 = 0;

65329  
zSql
[0] ){

65330 
n
 = 
	`sqlôe3GëTokí
((
u8
*)
zSql
, &
tokíTy≥
);

65331 
	`as£π
–
n
>0 && 
tokíTy≥
!=
TK_ILLEGAL
 );

65332 if–
tokíTy≥
==
TK_VARIABLE
 ){

65333 *
≤Tokí
 = 
n
;

65336 
nTŸÆ
 +
n
;

65337 
zSql
 +
n
;

65339  
nTŸÆ
;

65366 
SQLITE_PRIVATE
 *
	`sqlôe3VdbeEx∑ndSql
(

65367 
Vdbe
 *
p
,

65368 c⁄° *
zRawSql


65370 
sqlôe3
 *
db
;

65371 
idx
 = 0;

65372 
√xtIndex
 = 1;

65373 
n
;

65374 
nTokí
;

65375 
i
;

65376 
Mem
 *
pV¨
;

65377 
SåAccum
 
out
;

65378 
zBa£
[100];

65380 
db
 = 
p
->db;

65381 
	`sqlôe3SåAccumInô
(&
out
, 
zBa£
, (zBase),

65382 
db
->
aLimô
[
SQLITE_LIMIT_LENGTH
]);

65383 
out
.
db
 = db;

65384 if–
db
->
nVdbeExec
>1 ){

65385  *
zRawSql
 ){

65386 c⁄° *
zSèπ
 = 
zRawSql
;

65387  *(
zRawSql
++)!='\n' && *zRawSql );

65388 
	`sqlôe3SåAccumAµíd
(&
out
, "-- ", 3);

65389 
	`sqlôe3SåAccumAµíd
(&
out
, 
zSèπ
, ()(
zRawSql
-zStart));

65392  
zRawSql
[0] ){

65393 
n
 = 
	`födNextHo°P¨amëî
(
zRawSql
, &
nTokí
);

65394 
	`as£π
–
n
>0 );

65395 
	`sqlôe3SåAccumAµíd
(&
out
, 
zRawSql
, 
n
);

65396 
zRawSql
 +
n
;

65397 
	`as£π
–
zRawSql
[0] || 
nTokí
==0 );

65398 if–
nTokí
==0 ) ;

65399 if–
zRawSql
[0]=='?' ){

65400 if–
nTokí
>1 ){

65401 
	`as£π
–
	`sqlôe3Isdigô
(
zRawSql
[1]) );

65402 
	`sqlôe3GëI¡32
(&
zRawSql
[1], &
idx
);

65404 
idx
 = 
√xtIndex
;

65407 
	`as£π
–
zRawSql
[0]==':' || zRawSql[0]=='$' || zRawSql[0]=='@' );

65408 
	`ã°ˇ£
–
zRawSql
[0]==':' );

65409 
	`ã°ˇ£
–
zRawSql
[0]=='$' );

65410 
	`ã°ˇ£
–
zRawSql
[0]=='@' );

65411 
idx
 = 
	`sqlôe3VdbeP¨amëîIndex
(
p
, 
zRawSql
, 
nTokí
);

65412 
	`as£π
–
idx
>0 );

65414 
zRawSql
 +
nTokí
;

65415 
√xtIndex
 = 
idx
 + 1;

65416 
	`as£π
–
idx
>0 && idx<=
p
->
nV¨
 );

65417 
pV¨
 = &
p
->
aV¨
[
idx
-1];

65418 if–
pV¨
->
Êags
 & 
MEM_NuŒ
 ){

65419 
	`sqlôe3SåAccumAµíd
(&
out
, "NULL", 4);

65420 }if–
pV¨
->
Êags
 & 
MEM_I¡
 ){

65421 
	`sqlôe3XPrötf
(&
out
, "%Œd", 
pV¨
->
u
.
i
);

65422 }if–
pV¨
->
Êags
 & 
MEM_Ról
 ){

65423 
	`sqlôe3XPrötf
(&
out
, "%!.15g", 
pV¨
->
r
);

65424 }if–
pV¨
->
Êags
 & 
MEM_Så
 ){

65425 
nOut
;

65426 #i‚de‡
SQLITE_OMIT_UTF16


65427 
u8
 
íc
 = 
	`ENC
(
db
);

65428 
Mem
 
utf8
;

65429 if–
íc
!=
SQLITE_UTF8
 ){

65430 
	`mem£t
(&
utf8
, 0, (utf8));

65431 
utf8
.
db
 = db;

65432 
	`sqlôe3VdbeMemSëSå
(&
utf8
, 
pV¨
->
z
,ÖV¨->
n
, 
íc
, 
SQLITE_STATIC
);

65433 
	`sqlôe3VdbeCh™geEncodög
(&
utf8
, 
SQLITE_UTF8
);

65434 
pV¨
 = &
utf8
;

65437 
nOut
 = 
pV¨
->
n
;

65438 #ifde‡
SQLITE_TRACE_SIZE_LIMIT


65439 if–
nOut
>
SQLITE_TRACE_SIZE_LIMIT
 ){

65440 
nOut
 = 
SQLITE_TRACE_SIZE_LIMIT
;

65441  
nOut
<
pV¨
->
n
 && (pV¨->
z
[nOut]&0xc0)==0x80 ){ÇOut++; }

65444 
	`sqlôe3XPrötf
(&
out
, "'%.*q'", 
nOut
, 
pV¨
->
z
);

65445 #ifde‡
SQLITE_TRACE_SIZE_LIMIT


65446 if–
nOut
<
pV¨
->
n
 ) 
	`sqlôe3XPrötf
(&
out
, "/*+%d bytes*/",ÖVar->n-nOut);

65448 #i‚de‡
SQLITE_OMIT_UTF16


65449 if–
íc
!=
SQLITE_UTF8
 ) 
	`sqlôe3VdbeMemRñó£
(&
utf8
);

65451 }if–
pV¨
->
Êags
 & 
MEM_Zîo
 ){

65452 
	`sqlôe3XPrötf
(&
out
, "zîoblob(%d)", 
pV¨
->
u
.
nZîo
);

65454 
nOut
;

65455 
	`as£π
–
pV¨
->
Êags
 & 
MEM_Blob
 );

65456 
	`sqlôe3SåAccumAµíd
(&
out
, "x'", 2);

65457 
nOut
 = 
pV¨
->
n
;

65458 #ifde‡
SQLITE_TRACE_SIZE_LIMIT


65459 if–
nOut
>
SQLITE_TRACE_SIZE_LIMIT
 )ÇOut = SQLITE_TRACE_SIZE_LIMIT;

65461 
i
=0; i<
nOut
; i++){

65462 
	`sqlôe3XPrötf
(&
out
, "%02x", 
pV¨
->
z
[
i
]&0xff);

65464 
	`sqlôe3SåAccumAµíd
(&
out
, "'", 1);

65465 #ifde‡
SQLITE_TRACE_SIZE_LIMIT


65466 if–
nOut
<
pV¨
->
n
 ) 
	`sqlôe3XPrötf
(&
out
, "/*+%d bytes*/",ÖVar->n-nOut);

65471  
	`sqlôe3SåAccumFöish
(&
out
);

65481 #i‡
	`deföed
(
SQLITE_ENABLE_TREE_EXPLAIN
)

65486 
SQLITE_PRIVATE
 
	`sqlôe3Ex∂aöBegö
(
Vdbe
 *
pVdbe
){

65487 if–
pVdbe
 ){

65488 
Ex∂aö
 *
p
;

65489 
	`sqlôe3BegöBíignMÆloc
();

65490 
p
 = (
Ex∂aö
 *)
	`sqlôe3MÆlocZîo
( (Explain) );

65491 if–
p
 ){

65492 
p
->
pVdbe
 =ÖVdbe;

65493 
	`sqlôe3_‰ì
(
pVdbe
->
pEx∂aö
);

65494 
pVdbe
->
pEx∂aö
 = 
p
;

65495 
	`sqlôe3SåAccumInô
(&
p
->
°r
,Ö->
zBa£
, (p->zBase),

65496 
SQLITE_MAX_LENGTH
);

65497 
p
->
°r
.
u£MÆloc
 = 2;

65499 
	`sqlôe3EndBíignMÆloc
();

65507 
	`ídsWôhNL
(
Ex∂aö
 *
p
){

65508  
p
 &&Ö->
°r
.
zText
 &&Ö->°r.
nCh¨


65509 && 
p
->
°r
.
zText
[p->°r.
nCh¨
-1]=='\n';

65515 
SQLITE_PRIVATE
 
	`sqlôe3Ex∂aöPrötf
(
Vdbe
 *
pVdbe
, c⁄° *
zF‹m©
, ...){

65516 
Ex∂aö
 *
p
;

65517 if–
pVdbe
 && (
p
 =ÖVdbe->
pEx∂aö
)!=0 ){

65518 
va_li°
 
≠
;

65519 if–
p
->
nIndít
 && 
	`ídsWôhNL
(p) ){

65520 
n
 = 
p
->
nIndít
;

65521 if–
n
>
	`AºaySize
(
p
->
aIndít
) )Ç = ArraySize(p->aIndent);

65522 
	`sqlôe3AµídS∑˚
(&
p
->
°r
,Ö->
aIndít
[
n
-1]);

65524 
	`va_°¨t
(
≠
, 
zF‹m©
);

65525 
	`sqlôe3VXPrötf
(&
p
->
°r
, 1, 
zF‹m©
, 
≠
);

65526 
	`va_íd
(
≠
);

65533 
SQLITE_PRIVATE
 
	`sqlôe3Ex∂aöNL
(
Vdbe
 *
pVdbe
){

65534 
Ex∂aö
 *
p
;

65535 if–
pVdbe
 && (
p
 =ÖVdbe->
pEx∂aö
)!=0 && !
	`ídsWôhNL
(p) ){

65536 
	`sqlôe3SåAccumAµíd
(&
p
->
°r
, "\n", 1);

65544 
SQLITE_PRIVATE
 
	`sqlôe3Ex∂aöPush
(
Vdbe
 *
pVdbe
){

65545 
Ex∂aö
 *
p
;

65546 if–
pVdbe
 && (
p
 =ÖVdbe->
pEx∂aö
)!=0 ){

65547 if–
p
->
°r
.
zText
 &&Ö->
nIndít
<
	`AºaySize
’->
aIndít
) ){

65548 c⁄° *
z
 = 
p
->
°r
.
zText
;

65549 
i
 = 
p
->
°r
.
nCh¨
-1;

65550 
x
;

65551  
i
>=0 && 
z
[i]!='\n' ){ i--; }

65552 
x
 = (
p
->
°r
.
nCh¨
 - 1Ë- 
i
;

65553 if–
p
->
nIndít
 && 
x
<p->
aIndít
[p->nIndent-1] ){

65554 
x
 = 
p
->
aIndít
[p->
nIndít
-1];

65556 
p
->
aIndít
[p->
nIndít
] = 
x
;

65558 
p
->
nIndít
++;

65565 
SQLITE_PRIVATE
 
	`sqlôe3Ex∂aöP›
(
Vdbe
 *
p
){

65566 if–
p
 &&Ö->
pEx∂aö
 )Ö->pEx∂aö->
nIndít
--;

65572 
SQLITE_PRIVATE
 
	`sqlôe3Ex∂aöFöish
(
Vdbe
 *
pVdbe
){

65573 if–
pVdbe
 &&ÖVdbe->
pEx∂aö
 ){

65574 
	`sqlôe3_‰ì
(
pVdbe
->
zEx∂aö
);

65575 
	`sqlôe3Ex∂aöNL
(
pVdbe
);

65576 
pVdbe
->
zEx∂aö
 = 
	`sqlôe3SåAccumFöish
(&pVdbe->
pEx∂aö
->
°r
);

65577 
	`sqlôe3_‰ì
(
pVdbe
->
pEx∂aö
);

65578 
pVdbe
->
pEx∂aö
 = 0;

65579 
	`sqlôe3EndBíignMÆloc
();

65586 
SQLITE_PRIVATE
 c⁄° *
	`sqlôe3VdbeEx∂™©i⁄
(
Vdbe
 *
pVdbe
){

65587  (
pVdbe
 &&ÖVdbe->
zEx∂aö
) ?ÖVdbe->zExplain : 0;

65644 #ifde‡
SQLITE_DEBUG


65645 
	#memAboutToCh™ge
(
P
,
M
Ë
	`sqlôe3VdbeMemAboutToCh™ge
(P,M)

	)

65647 
	#memAboutToCh™ge
(
P
,
M
)

	)

65657 #ifde‡
SQLITE_TEST


65658 
SQLITE_API
 
sqlôe3_£¨ch_cou¡
 = 0;

65669 #ifde‡
SQLITE_TEST


65670 
SQLITE_API
 
sqlôe3_öãºu±_cou¡
 = 0;

65680 #ifde‡
SQLITE_TEST


65681 
SQLITE_API
 
sqlôe3_s‹t_cou¡
 = 0;

65691 #ifde‡
SQLITE_TEST


65692 
SQLITE_API
 
sqlôe3_max_blobsize
 = 0;

65693 
	`upd©eMaxBlobsize
(
Mem
 *
p
){

65694 if–(
p
->
Êags
 & (
MEM_Så
|
MEM_Blob
))!=0 &&Ö->
n
>
sqlôe3_max_blobsize
 ){

65695 
sqlôe3_max_blobsize
 = 
p
->
n
;

65707 #ifde‡
SQLITE_TEST


65708 
SQLITE_API
 
sqlôe3_found_cou¡
 = 0;

65715 #i‡
	`deföed
(
SQLITE_TEST
Ë&& !deföed(
SQLITE_OMIT_BUILTIN_TEST
)

65716 
	#UPDATE_MAX_BLOBSIZE
(
P
Ë
	`upd©eMaxBlobsize
(P)

	)

65718 
	#UPDATE_MAX_BLOBSIZE
(
P
)

	)

65725 
	#Såögify
(
P
, 
íc
) \

65726 if(((
P
)->
Êags
&(
MEM_Så
|
MEM_Blob
))==0 && 
	`sqlôe3VdbeMemSåögify
(P,
íc
)) \

65727 { 
no_mem
; }

	)

65740 
	#DìphemîÆize
(
P
) \

65741 if–((
P
)->
Êags
&
MEM_Ephem
)!=0 \

65742 && 
	`sqlôe3VdbeMemMakeWrôóbÀ
(
P
Ë){ 
no_mem
;}

	)

65745 
	#isS‹ãr
(
x
Ë((x)->
pS‹ãr
!=0)

	)

65753 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemSt‹eTy≥
(
Mem
 *
pMem
){

65754 
Êags
 = 
pMem
->flags;

65755 if–
Êags
 & 
MEM_NuŒ
 ){

65756 
pMem
->
ty≥
 = 
SQLITE_NULL
;

65758 if–
Êags
 & 
MEM_I¡
 ){

65759 
pMem
->
ty≥
 = 
SQLITE_INTEGER
;

65761 if–
Êags
 & 
MEM_Ról
 ){

65762 
pMem
->
ty≥
 = 
SQLITE_FLOAT
;

65764 if–
Êags
 & 
MEM_Så
 ){

65765 
pMem
->
ty≥
 = 
SQLITE_TEXT
;

65767 
pMem
->
ty≥
 = 
SQLITE_BLOB
;

65775 
VdbeCurs‹
 *
	`ÆloˇãCurs‹
(

65776 
Vdbe
 *
p
,

65777 
iCur
,

65778 
nFõld
,

65779 
iDb
,

65780 
isBåìCurs‹


65800 
Mem
 *
pMem
 = &
p
->
aMem
[p->
nMem
-
iCur
];

65802 
nByã
;

65803 
VdbeCurs‹
 *
pCx
 = 0;

65804 
nByã
 =

65805 
	`ROUND8
((
VdbeCurs‹
)) +

65806 (
isBåìCurs‹
?
	`sqlôe3BåìCurs‹Size
():0) +

65807 2*
nFõld
*(
u32
);

65809 
	`as£π
–
iCur
<
p
->
nCurs‹
 );

65810 if–
p
->
≠C§
[
iCur
] ){

65811 
	`sqlôe3VdbeFªeCurs‹
(
p
,Ö->
≠C§
[
iCur
]);

65812 
p
->
≠C§
[
iCur
] = 0;

65814 if–
SQLITE_OK
==
	`sqlôe3VdbeMemGrow
(
pMem
, 
nByã
, 0) ){

65815 
p
->
≠C§
[
iCur
] = 
pCx
 = (
VdbeCurs‹
*)
pMem
->
z
;

65816 
	`mem£t
(
pCx
, 0, (
VdbeCurs‹
));

65817 
pCx
->
iDb
 = iDb;

65818 
pCx
->
nFõld
 =ÇField;

65819 if–
nFõld
 ){

65820 
pCx
->
aTy≥
 = (
u32
 *)&
pMem
->
z
[
	`ROUND8
((
VdbeCurs‹
))];

65822 if–
isBåìCurs‹
 ){

65823 
pCx
->
pCurs‹
 = (
BtCurs‹
*)

65824 &
pMem
->
z
[
	`ROUND8
((
VdbeCurs‹
))+2*
nFõld
*(
u32
)];

65825 
	`sqlôe3BåìCurs‹Zîo
(
pCx
->
pCurs‹
);

65828  
pCx
;

65837 
	`≠∂yNumîicAfföôy
(
Mem
 *
pRec
){

65838 if–(
pRec
->
Êags
 & (
MEM_Ról
|
MEM_I¡
))==0 ){

65839 
rVÆue
;

65840 
i64
 
iVÆue
;

65841 
u8
 
íc
 = 
pRec
->enc;

65842 if–(
pRec
->
Êags
&
MEM_Så
)==0 ) ;

65843 if–
	`sqlôe3AtoF
(
pRec
->
z
, &
rVÆue
,ÖRec->
n
, 
íc
)==0 ) ;

65844 if–0==
	`sqlôe3Atoi64
(
pRec
->
z
, &
iVÆue
,ÖRec->
n
, 
íc
) ){

65845 
pRec
->
u
.
i
 = 
iVÆue
;

65846 
pRec
->
Êags
 |
MEM_I¡
;

65848 
pRec
->
r
 = 
rVÆue
;

65849 
pRec
->
Êags
 |
MEM_Ról
;

65872 
	`≠∂yAfföôy
(

65873 
Mem
 *
pRec
,

65874 
afföôy
,

65875 
u8
 
íc


65877 if–
afföôy
==
SQLITE_AFF_TEXT
 ){

65882 if–0==(
pRec
->
Êags
&
MEM_Så
Ë&& (pRec->Êags&(
MEM_Ról
|
MEM_I¡
)) ){

65883 
	`sqlôe3VdbeMemSåögify
(
pRec
, 
íc
);

65885 
pRec
->
Êags
 &~(
MEM_Ról
|
MEM_I¡
);

65886 }if–
afföôy
!=
SQLITE_AFF_NONE
 ){

65887 
	`as£π
–
afföôy
==
SQLITE_AFF_INTEGER
 ||áfföôy==
SQLITE_AFF_REAL


65888 || 
afföôy
==
SQLITE_AFF_NUMERIC
 );

65889 
	`≠∂yNumîicAfföôy
(
pRec
);

65890 if–
pRec
->
Êags
 & 
MEM_Ról
 ){

65891 
	`sqlôe3VdbeI¡egîAfföôy
(
pRec
);

65902 
SQLITE_API
 
	`sqlôe3_vÆue_numîic_ty≥
(
sqlôe3_vÆue
 *
pVÆ
){

65903 
Mem
 *
pMem
 = (Mem*)
pVÆ
;

65904 if–
pMem
->
ty≥
==
SQLITE_TEXT
 ){

65905 
	`≠∂yNumîicAfföôy
(
pMem
);

65906 
	`sqlôe3VdbeMemSt‹eTy≥
(
pMem
);

65908  
pMem
->
ty≥
;

65915 
SQLITE_PRIVATE
 
	`sqlôe3VÆueAµlyAfföôy
(

65916 
sqlôe3_vÆue
 *
pVÆ
,

65917 
u8
 
afföôy
,

65918 
u8
 
íc


65920 
	`≠∂yAfföôy
((
Mem
 *)
pVÆ
, 
afföôy
, 
íc
);

65923 #ifde‡
SQLITE_DEBUG


65928 
SQLITE_PRIVATE
 
	`sqlôe3VdbeMemPªâyPröt
(
Mem
 *
pMem
, *
zBuf
){

65929 *
zC§
 = 
zBuf
;

65930 
f
 = 
pMem
->
Êags
;

65932 c⁄° *c⁄° 
í˙ames
[] = {"(X)", "(8)", "(16LE)", "(16BE)"};

65934 if–
f
&
MEM_Blob
 ){

65935 
i
;

65936 
c
;

65937 if–
f
 & 
MEM_Dyn
 ){

65938 
c
 = 'z';

65939 
	`as£π
–(
f
 & (
MEM_Sètic
|
MEM_Ephem
))==0 );

65940 }if–
f
 & 
MEM_Sètic
 ){

65941 
c
 = 't';

65942 
	`as£π
–(
f
 & (
MEM_Dyn
|
MEM_Ephem
))==0 );

65943 }if–
f
 & 
MEM_Ephem
 ){

65944 
c
 = 'e';

65945 
	`as£π
–(
f
 & (
MEM_Sètic
|
MEM_Dyn
))==0 );

65947 
c
 = 's';

65950 
	`sqlôe3_¢¥ötf
(100, 
zC§
, "%c", 
c
);

65951 
zC§
 +
	`sqlôe3SåÀn30
(zCsr);

65952 
	`sqlôe3_¢¥ötf
(100, 
zC§
, "%d[", 
pMem
->
n
);

65953 
zC§
 +
	`sqlôe3SåÀn30
(zCsr);

65954 
i
=0; i<16 && i<
pMem
->
n
; i++){

65955 
	`sqlôe3_¢¥ötf
(100, 
zC§
, "%02X", (()
pMem
->
z
[
i
] & 0xFF));

65956 
zC§
 +
	`sqlôe3SåÀn30
(zCsr);

65958 
i
=0; i<16 && i<
pMem
->
n
; i++){

65959 
z
 = 
pMem
->z[
i
];

65960 if–
z
<32 || z>126 ) *
zC§
++ = '.';

65961 *
zC§
++ = 
z
;

65964 
	`sqlôe3_¢¥ötf
(100, 
zC§
, "]%s", 
í˙ames
[
pMem
->
íc
]);

65965 
zC§
 +
	`sqlôe3SåÀn30
(zCsr);

65966 if–
f
 & 
MEM_Zîo
 ){

65967 
	`sqlôe3_¢¥ötf
(100, 
zC§
,"+%dz",
pMem
->
u
.
nZîo
);

65968 
zC§
 +
	`sqlôe3SåÀn30
(zCsr);

65970 *
zC§
 = '\0';

65971 }if–
f
 & 
MEM_Så
 ){

65972 
j
, 
k
;

65973 
zBuf
[0] = ' ';

65974 if–
f
 & 
MEM_Dyn
 ){

65975 
zBuf
[1] = 'z';

65976 
	`as£π
–(
f
 & (
MEM_Sètic
|
MEM_Ephem
))==0 );

65977 }if–
f
 & 
MEM_Sètic
 ){

65978 
zBuf
[1] = 't';

65979 
	`as£π
–(
f
 & (
MEM_Dyn
|
MEM_Ephem
))==0 );

65980 }if–
f
 & 
MEM_Ephem
 ){

65981 
zBuf
[1] = 'e';

65982 
	`as£π
–(
f
 & (
MEM_Sètic
|
MEM_Dyn
))==0 );

65984 
zBuf
[1] = 's';

65986 
k
 = 2;

65987 
	`sqlôe3_¢¥ötf
(100, &
zBuf
[
k
], "%d", 
pMem
->
n
);

65988 
k
 +
	`sqlôe3SåÀn30
(&
zBuf
[k]);

65989 
zBuf
[
k
++] = '[';

65990 
j
=0; j<15 && j<
pMem
->
n
; j++){

65991 
u8
 
c
 = 
pMem
->
z
[
j
];

65992 if–
c
>=0x20 && c<0x7f ){

65993 
zBuf
[
k
++] = 
c
;

65995 
zBuf
[
k
++] = '.';

65998 
zBuf
[
k
++] = ']';

65999 
	`sqlôe3_¢¥ötf
(100,&
zBuf
[
k
], 
í˙ames
[
pMem
->
íc
]);

66000 
k
 +
	`sqlôe3SåÀn30
(&
zBuf
[k]);

66001 
zBuf
[
k
++] = 0;

66006 #ifde‡
SQLITE_DEBUG


66010 
	`memTø˚Pröt
(
FILE
 *
out
, 
Mem
 *
p
){

66011 if–
p
->
Êags
 & 
MEM_InvÆid
 ){

66012 
	`Ârötf
(
out
, " undefined");

66013 }if–
p
->
Êags
 & 
MEM_NuŒ
 ){

66014 
	`Ârötf
(
out
, " NULL");

66015 }if–(
p
->
Êags
 & (
MEM_I¡
|
MEM_Så
))==(MEM_Int|MEM_Str) ){

66016 
	`Ârötf
(
out
, " si:%Œd", 
p
->
u
.
i
);

66017 }if–
p
->
Êags
 & 
MEM_I¡
 ){

66018 
	`Ârötf
(
out
, " i:%Œd", 
p
->
u
.
i
);

66019 #i‚de‡
SQLITE_OMIT_FLOATING_POINT


66020 }if–
p
->
Êags
 & 
MEM_Ról
 ){

66021 
	`Ârötf
(
out
, "Ñ:%g", 
p
->
r
);

66023 }if–
p
->
Êags
 & 
MEM_RowSë
 ){

66024 
	`Ârötf
(
out
, " (rowset)");

66026 
zBuf
[200];

66027 
	`sqlôe3VdbeMemPªâyPröt
(
p
, 
zBuf
);

66028 
	`Ârötf
(
out
, " ");

66029 
	`Ârötf
(
out
, "%s", 
zBuf
);

66032 
	`ªgi°îTø˚
(
FILE
 *
out
, 
iReg
, 
Mem
 *
p
){

66033 
	`Ârötf
(
out
, "REG[%d] = ", 
iReg
);

66034 
	`memTø˚Pröt
(
out
, 
p
);

66035 
	`Ârötf
(
out
, "\n");

66039 #ifde‡
SQLITE_DEBUG


66040 
	#REGISTER_TRACE
(
R
,
M
Ëif(
p
->
åa˚
)
	`ªgi°îTø˚
’->åa˚,R,M)

	)

66042 
	#REGISTER_TRACE
(
R
,
M
)

	)

66046 #ifde‡
VDBE_PROFILE


66069 #i‚de‡
_HWTIME_H_


66070 
	#_HWTIME_H_


	)

66078 #i‡(
	`deföed
(
__GNUC__
Ë|| deföed(
_MSC_VER
)) && \

66079 (
	`deföed
(
i386
Ë|| deföed(
__i386__
Ë|| deföed(
_M_IX86
))

66081 #i‡
	`deföed
(
__GNUC__
)

66083 
__ölöe__
 
sqlôe_uöt64
 
	`sqlôe3Hwtime
(){

66084 
lo
, 
hi
;

66085 
__asm__
 
	`__vﬁ©ûe__
 ("rdtsc" : "˜" (
lo
), "=d" (
hi
));

66086  (
sqlôe_uöt64
)
hi
 << 32 | 
lo
;

66089 #ñi‡
	`deföed
(
_MSC_VER
)

66091 
	`__de˛•ec
(
«ked
Ë
__ölöe
 
sqlôe_uöt64
 
__cde˛
 
	`sqlôe3Hwtime
(){

66092 
__asm
 {

66093 
rdtsc


66094 
ªt
 ;  
vÆue
 
©
 
EDX
:
EAX


66100 #ñi‡(
	`deföed
(
__GNUC__
Ë&& deföed(
__x86_64__
))

66102 
__ölöe__
 
sqlôe_uöt64
 
	`sqlôe3Hwtime
(){

66103 
vÆ
;

66104 
__asm__
 
	`__vﬁ©ûe__
 ("rdtsc" : "=A" (
vÆ
));

66105  
vÆ
;

66108 #ñi‡(
	`deföed
(
__GNUC__
Ë&& deföed(
__µc__
))

66110 
__ölöe__
 
sqlôe_uöt64
 
	`sqlôe3Hwtime
(){

66111 
ªtvÆ
;

66112 
junk
;

66113 
__asm__
 
	`__vﬁ©ûe__
 ("\n\
1: mftbu %1\n\
 %L0\n\
 %0\n\
 %0,%1\n\
 1b"

66119 : "Ù" (
ªtvÆ
), "Ù" (
junk
));

66120  
ªtvÆ
;

66125 #îr‹ 
Nìd
 
im∂emíèti⁄
 
of
 
	`sqlôe3Hwtime
(Ë
your
 
∂©f‹m
.

66134 
SQLITE_PRIVATE
 
sqlôe_uöt64
 
	`sqlôe3Hwtime
(){  ((sqlite_uint64)0); }

66155 
	#CHECK_FOR_INTERRUPT
 \

66156 if–
db
->
u1
.
isI¡îru±ed
 ) 
ab‹t_due_to_öãºu±
;

	)

66159 #i‚de‡
NDEBUG


66170 
	`checkSavïoötCou¡
(
sqlôe3
 *
db
){

66171 
n
 = 0;

66172 
Savïoöt
 *
p
;

66173 
p
=
db
->
pSavïoöt
;Ö;Öı->
pNext
Ë
n
++;

66174 
	`as£π
–
n
==(
db
->
nSavïoöt
 + db->
isTønß˘i⁄Savïoöt
) );

66211 
SQLITE_PRIVATE
 
	`sqlôe3VdbeExec
(

66212 
Vdbe
 *
p


66214 
pc
=0;

66215 
Op
 *
aOp
 = 
p
->aOp;

66216 
Op
 *
pOp
;

66217 
rc
 = 
SQLITE_OK
;

66218 
sqlôe3
 *
db
 = 
p
->db;

66219 
u8
 
ª£tSchemaOnFau…
 = 0;

66220 
u8
 
ícodög
 = 
	`ENC
(
db
);

66221 
iCom∑ª
 = 0;

66222 
nVmSãp
 = 0;

66223 #i‚de‡
SQLITE_OMIT_PROGRESS_CALLBACK


66224 
nProgªssLimô
 = 0;

66226 
Mem
 *
aMem
 = 
p
->aMem;

66227 
Mem
 *
pIn1
 = 0;

66228 
Mem
 *
pIn2
 = 0;

66229 
Mem
 *
pIn3
 = 0;

66230 
Mem
 *
pOut
 = 0;

66231 *
aPîmuã
 = 0;

66232 
i64
 
œ°Rowid
 = 
db
->lastRowid;

66233 #ifde‡
VDBE_PROFILE


66234 
u64
 
°¨t
;

66235 
‹igPc
;

66245 
	uvdbeExecUni⁄
 {

66246 
	sOP_Yõld_°ack_v¨s
 {

66247 
pcDe°
;

66248 } 
Ø
;

66249 
	sOP_NuŒ_°ack_v¨s
 {

66250 
˙t
;

66251 
u16
 
nuŒFœg
;

66252 } 
ab
;

66253 
	sOP_V¨übÀ_°ack_v¨s
 {

66254 
Mem
 *
pV¨
;

66255 } 
ac
;

66256 
	sOP_Move_°ack_v¨s
 {

66257 *
zMÆloc
;

66258 
n
;

66259 
p1
;

66260 
p2
;

66261 } 
ad
;

66262 
	sOP_C›y_°ack_v¨s
 {

66263 
n
;

66264 } 
´
;

66265 
	sOP_Resu…Row_°ack_v¨s
 {

66266 
Mem
 *
pMem
;

66267 
i
;

66268 } 
af
;

66269 
	sOP_C⁄ˇt_°ack_v¨s
 {

66270 
i64
 
nByã
;

66271 } 
ag
;

66272 
	sOP_Remaödî_°ack_v¨s
 {

66273 
bI¡öt
;

66274 
Êags
;

66275 
i64
 
iA
;

66276 
i64
 
iB
;

66277 
rA
;

66278 
rB
;

66279 } 
ah
;

66280 
	sOP_Fun˘i⁄_°ack_v¨s
 {

66281 
i
;

66282 
Mem
 *
pArg
;

66283 
sqlôe3_c⁄ãxt
 
˘x
;

66284 
sqlôe3_vÆue
 **
≠VÆ
;

66285 
n
;

66286 } 
ai
;

66287 
	sOP_Shi·Right_°ack_v¨s
 {

66288 
i64
 
iA
;

66289 
u64
 
uA
;

66290 
i64
 
iB
;

66291 
u8
 
›
;

66292 } 
aj
;

66293 
	sOP_Ge_°ack_v¨s
 {

66294 
ªs
;

66295 
afföôy
;

66296 
u16
 
Êags1
;

66297 
u16
 
Êags3
;

66298 } 
ak
;

66299 
	sOP_Com∑ª_°ack_v¨s
 {

66300 
n
;

66301 
i
;

66302 
p1
;

66303 
p2
;

66304 c⁄° 
KeyInfo
 *
pKeyInfo
;

66305 
idx
;

66306 
CﬁlSeq
 *
pCﬁl
;

66307 
bRev
;

66308 } 
Æ
;

66309 
	sOP_Or_°ack_v¨s
 {

66310 
v1
;

66311 
v2
;

66312 } 
am
;

66313 
	sOP_IfNŸ_°ack_v¨s
 {

66314 
c
;

66315 } 
™
;

66316 
	sOP_Cﬁumn_°ack_v¨s
 {

66317 
u32
 
∑ylﬂdSize
;

66318 
i64
 
∑ylﬂdSize64
;

66319 
p1
;

66320 
p2
;

66321 
VdbeCurs‹
 *
pC
;

66322 *
zRec
;

66323 
BtCurs‹
 *
pCr§
;

66324 
u32
 *
aTy≥
;

66325 
u32
 *
aOff£t
;

66326 
nFõld
;

66327 
Àn
;

66328 
i
;

66329 *
zD©a
;

66330 
Mem
 *
pDe°
;

66331 
Mem
 
sMem
;

66332 
u8
 *
zIdx
;

66333 
u8
 *
zEndHdr
;

66334 
u32
 
off£t
;

66335 
u32
 
szFõld
;

66336 
szHdr
;

66337 
avaû
;

66338 
u32
 
t
;

66339 
Mem
 *
pReg
;

66340 } 
ao
;

66341 
	sOP_Afföôy_°ack_v¨s
 {

66342 c⁄° *
zAfföôy
;

66343 
cAff
;

66344 } 
≠
;

66345 
	sOP_MakeRec‹d_°ack_v¨s
 {

66346 
u8
 *
zNewRec‹d
;

66347 
Mem
 *
pRec
;

66348 
u64
 
nD©a
;

66349 
nHdr
;

66350 
i64
 
nByã
;

66351 
nZîo
;

66352 
nV¨öt
;

66353 
u32
 
£rül_ty≥
;

66354 
Mem
 *
pD©a0
;

66355 
Mem
 *
pLa°
;

66356 
nFõld
;

66357 *
zAfföôy
;

66358 
fûe_f‹m©
;

66359 
i
;

66360 
Àn
;

66361 } 
aq
;

66362 
	sOP_Cou¡_°ack_v¨s
 {

66363 
i64
 
nE¡ry
;

66364 
BtCurs‹
 *
pCr§
;

66365 } 
¨
;

66366 
	sOP_Savïoöt_°ack_v¨s
 {

66367 
p1
;

66368 *
zName
;

66369 
nName
;

66370 
Savïoöt
 *
pNew
;

66371 
Savïoöt
 *
pSavïoöt
;

66372 
Savïoöt
 *
pTmp
;

66373 
iSavïoöt
;

66374 
ii
;

66375 } 
as
;

66376 
	sOP_AutoCommô_°ack_v¨s
 {

66377 
desúedAutoCommô
;

66378 
iRﬁlback
;

66379 
tu∫OnAC
;

66380 } 
©
;

66381 
	sOP_Tønß˘i⁄_°ack_v¨s
 {

66382 
Båì
 *
pBt
;

66383 } 
au
;

66384 
	sOP_RódCookõ_°ack_v¨s
 {

66385 
iMëa
;

66386 
iDb
;

66387 
iCookõ
;

66388 } 
av
;

66389 
	sOP_SëCookõ_°ack_v¨s
 {

66390 
Db
 *
pDb
;

66391 } 
aw
;

66392 
	sOP_VîifyCookõ_°ack_v¨s
 {

66393 
iMëa
;

66394 
iGí
;

66395 
Båì
 *
pBt
;

66396 } 
ax
;

66397 
	sOP_O≥nWrôe_°ack_v¨s
 {

66398 
nFõld
;

66399 
KeyInfo
 *
pKeyInfo
;

66400 
p2
;

66401 
iDb
;

66402 
wrFœg
;

66403 
Båì
 *
pX
;

66404 
VdbeCurs‹
 *
pCur
;

66405 
Db
 *
pDb
;

66406 } 
ay
;

66407 
	sOP_O≥nEphemîÆ_°ack_v¨s
 {

66408 
VdbeCurs‹
 *
pCx
;

66409 } 
az
;

66410 
	sOP_S‹ãrO≥n_°ack_v¨s
 {

66411 
VdbeCurs‹
 *
pCx
;

66412 } 
ba
;

66413 
	sOP_O≥nP£udo_°ack_v¨s
 {

66414 
VdbeCurs‹
 *
pCx
;

66415 } 
bb
;

66416 
	sOP_SìkGt_°ack_v¨s
 {

66417 
ªs
;

66418 
oc
;

66419 
VdbeCurs‹
 *
pC
;

66420 
U≈ackedRec‹d
 
r
;

66421 
nFõld
;

66422 
i64
 
iKey
;

66423 } 
bc
;

66424 
	sOP_Sìk_°ack_v¨s
 {

66425 
VdbeCurs‹
 *
pC
;

66426 } 
bd
;

66427 
	sOP_Found_°ack_v¨s
 {

66428 
ÆªadyExi°s
;

66429 
VdbeCurs‹
 *
pC
;

66430 
ªs
;

66431 *
pFªe
;

66432 
U≈ackedRec‹d
 *
pIdxKey
;

66433 
U≈ackedRec‹d
 
r
;

66434 
aTempRec
[
	`ROUND8
((
U≈ackedRec‹d
)Ë+ (
Mem
)*3 + 7];

66435 } 
be
;

66436 
	sOP_IsUnique_°ack_v¨s
 {

66437 
u16
 
ii
;

66438 
VdbeCurs‹
 *
pCx
;

66439 
BtCurs‹
 *
pCr§
;

66440 
u16
 
nFõld
;

66441 
Mem
 *
aMx
;

66442 
U≈ackedRec‹d
 
r
;

66443 
i64
 
R
;

66444 } 
bf
;

66445 
	sOP_NŸExi°s_°ack_v¨s
 {

66446 
VdbeCurs‹
 *
pC
;

66447 
BtCurs‹
 *
pCr§
;

66448 
ªs
;

66449 
u64
 
iKey
;

66450 } 
bg
;

66451 
	sOP_NewRowid_°ack_v¨s
 {

66452 
i64
 
v
;

66453 
VdbeCurs‹
 *
pC
;

66454 
ªs
;

66455 
˙t
;

66456 
Mem
 *
pMem
;

66457 
VdbeFøme
 *
pFøme
;

66458 } 
bh
;

66459 
	sOP_In£πI¡_°ack_v¨s
 {

66460 
Mem
 *
pD©a
;

66461 
Mem
 *
pKey
;

66462 
i64
 
iKey
;

66463 
VdbeCurs‹
 *
pC
;

66464 
nZîo
;

66465 
£ekResu…
;

66466 c⁄° *
zDb
;

66467 c⁄° *
zTbl
;

66468 
›
;

66469 } 
bi
;

66470 
	sOP_Dñëe_°ack_v¨s
 {

66471 
i64
 
iKey
;

66472 
VdbeCurs‹
 *
pC
;

66473 } 
bj
;

66474 
	sOP_S‹ãrCom∑ª_°ack_v¨s
 {

66475 
VdbeCurs‹
 *
pC
;

66476 
ªs
;

66477 } 
bk
;

66478 
	sOP_S‹ãrD©a_°ack_v¨s
 {

66479 
VdbeCurs‹
 *
pC
;

66480 } 
bl
;

66481 
	sOP_RowD©a_°ack_v¨s
 {

66482 
VdbeCurs‹
 *
pC
;

66483 
BtCurs‹
 *
pCr§
;

66484 
u32
 
n
;

66485 
i64
 
n64
;

66486 } 
bm
;

66487 
	sOP_Rowid_°ack_v¨s
 {

66488 
VdbeCurs‹
 *
pC
;

66489 
i64
 
v
;

66490 
sqlôe3_vèb
 *
pVèb
;

66491 c⁄° 
sqlôe3_moduÀ
 *
pModuÀ
;

66492 } 
bn
;

66493 
	sOP_NuŒRow_°ack_v¨s
 {

66494 
VdbeCurs‹
 *
pC
;

66495 } 
bo
;

66496 
	sOP_La°_°ack_v¨s
 {

66497 
VdbeCurs‹
 *
pC
;

66498 
BtCurs‹
 *
pCr§
;

66499 
ªs
;

66500 } 
bp
;

66501 
	sOP_Rewöd_°ack_v¨s
 {

66502 
VdbeCurs‹
 *
pC
;

66503 
BtCurs‹
 *
pCr§
;

66504 
ªs
;

66505 } 
bq
;

66506 
	sOP_Next_°ack_v¨s
 {

66507 
VdbeCurs‹
 *
pC
;

66508 
ªs
;

66509 } 
br
;

66510 
	sOP_IdxIn£π_°ack_v¨s
 {

66511 
VdbeCurs‹
 *
pC
;

66512 
BtCurs‹
 *
pCr§
;

66513 
nKey
;

66514 c⁄° *
zKey
;

66515 } 
bs
;

66516 
	sOP_IdxDñëe_°ack_v¨s
 {

66517 
VdbeCurs‹
 *
pC
;

66518 
BtCurs‹
 *
pCr§
;

66519 
ªs
;

66520 
U≈ackedRec‹d
 
r
;

66521 } 
bt
;

66522 
	sOP_IdxRowid_°ack_v¨s
 {

66523 
BtCurs‹
 *
pCr§
;

66524 
VdbeCurs‹
 *
pC
;

66525 
i64
 
rowid
;

66526 } 
bu
;

66527 
	sOP_IdxGE_°ack_v¨s
 {

66528 
VdbeCurs‹
 *
pC
;

66529 
ªs
;

66530 
U≈ackedRec‹d
 
r
;

66531 } 
bv
;

66532 
	sOP_De°roy_°ack_v¨s
 {

66533 
iMoved
;

66534 
iC¡
;

66535 
Vdbe
 *
pVdbe
;

66536 
iDb
;

66537 } 
bw
;

66538 
	sOP_CÀ¨_°ack_v¨s
 {

66539 
nCh™ge
;

66540 } 
bx
;

66541 
	sOP_Cª©eTabÀ_°ack_v¨s
 {

66542 
pgno
;

66543 
Êags
;

66544 
Db
 *
pDb
;

66545 } 
by
;

66546 
	sOP_P¨£Schema_°ack_v¨s
 {

66547 
iDb
;

66548 c⁄° *
zMa°î
;

66549 *
zSql
;

66550 
InôD©a
 
öôD©a
;

66551 } 
bz
;

66552 
	sOP_I¡egrôyCk_°ack_v¨s
 {

66553 
nRoŸ
;

66554 *
aRoŸ
;

66555 
j
;

66556 
nEº
;

66557 *
z
;

66558 
Mem
 *
≤Eº
;

66559 } 
ˇ
;

66560 
	sOP_RowSëRód_°ack_v¨s
 {

66561 
i64
 
vÆ
;

66562 } 
cb
;

66563 
	sOP_RowSëTe°_°ack_v¨s
 {

66564 
iSë
;

66565 
exi°s
;

66566 } 
cc
;

66567 
	sOP_Progøm_°ack_v¨s
 {

66568 
nMem
;

66569 
nByã
;

66570 
Mem
 *
pRt
;

66571 
Mem
 *
pMem
;

66572 
Mem
 *
pEnd
;

66573 
VdbeFøme
 *
pFøme
;

66574 
SubProgøm
 *
pProgøm
;

66575 *
t
;

66576 } 
cd
;

66577 
	sOP_P¨am_°ack_v¨s
 {

66578 
VdbeFøme
 *
pFøme
;

66579 
Mem
 *
pIn
;

66580 } 
˚
;

66581 
	sOP_MemMax_°ack_v¨s
 {

66582 
Mem
 *
pIn1
;

66583 
VdbeFøme
 *
pFøme
;

66584 } 
cf
;

66585 
	sOP_AggSãp_°ack_v¨s
 {

66586 
n
;

66587 
i
;

66588 
Mem
 *
pMem
;

66589 
Mem
 *
pRec
;

66590 
sqlôe3_c⁄ãxt
 
˘x
;

66591 
sqlôe3_vÆue
 **
≠VÆ
;

66592 } 
cg
;

66593 
	sOP_AggFöÆ_°ack_v¨s
 {

66594 
Mem
 *
pMem
;

66595 } 
ch
;

66596 
	sOP_Checkpoöt_°ack_v¨s
 {

66597 
i
;

66598 
aRes
[3];

66599 
Mem
 *
pMem
;

66600 } 
ci
;

66601 
	sOP_Jou∫ÆMode_°ack_v¨s
 {

66602 
Båì
 *
pBt
;

66603 
Pagî
 *
pPagî
;

66604 
eNew
;

66605 
eOld
;

66606 #i‚de‡
SQLITE_OMIT_WAL


66607 c⁄° *
zFûíame
;

66609 } 
cj
;

66610 
	sOP_In¸Vacuum_°ack_v¨s
 {

66611 
Båì
 *
pBt
;

66612 } 
ck
;

66613 
	sOP_VBegö_°ack_v¨s
 {

66614 
VTabÀ
 *
pVTab
;

66615 } 
˛
;

66616 
	sOP_VO≥n_°ack_v¨s
 {

66617 
VdbeCurs‹
 *
pCur
;

66618 
sqlôe3_vèb_curs‹
 *
pVèbCurs‹
;

66619 
sqlôe3_vèb
 *
pVèb
;

66620 
sqlôe3_moduÀ
 *
pModuÀ
;

66621 } 
cm
;

66622 
	sOP_VFûãr_°ack_v¨s
 {

66623 
nArg
;

66624 
iQuîy
;

66625 c⁄° 
sqlôe3_moduÀ
 *
pModuÀ
;

66626 
Mem
 *
pQuîy
;

66627 
Mem
 *
pArgc
;

66628 
sqlôe3_vèb_curs‹
 *
pVèbCurs‹
;

66629 
sqlôe3_vèb
 *
pVèb
;

66630 
VdbeCurs‹
 *
pCur
;

66631 
ªs
;

66632 
i
;

66633 
Mem
 **
≠Arg
;

66634 } 
˙
;

66635 
	sOP_VCﬁumn_°ack_v¨s
 {

66636 
sqlôe3_vèb
 *
pVèb
;

66637 c⁄° 
sqlôe3_moduÀ
 *
pModuÀ
;

66638 
Mem
 *
pDe°
;

66639 
sqlôe3_c⁄ãxt
 
sC⁄ãxt
;

66640 } 
co
;

66641 
	sOP_VNext_°ack_v¨s
 {

66642 
sqlôe3_vèb
 *
pVèb
;

66643 c⁄° 
sqlôe3_moduÀ
 *
pModuÀ
;

66644 
ªs
;

66645 
VdbeCurs‹
 *
pCur
;

66646 } 
˝
;

66647 
	sOP_VRíame_°ack_v¨s
 {

66648 
sqlôe3_vèb
 *
pVèb
;

66649 
Mem
 *
pName
;

66650 } 
cq
;

66651 
	sOP_VUpd©e_°ack_v¨s
 {

66652 
sqlôe3_vèb
 *
pVèb
;

66653 
sqlôe3_moduÀ
 *
pModuÀ
;

66654 
nArg
;

66655 
i
;

66656 
sqlôe_öt64
 
rowid
;

66657 
Mem
 **
≠Arg
;

66658 
Mem
 *
pX
;

66659 } 
¸
;

66660 
	sOP_Tø˚_°ack_v¨s
 {

66661 *
zTø˚
;

66662 *
z
;

66663 } 
cs
;

66664 } 
u
;

66668 
	`as£π
–
p
->
magic
==
VDBE_MAGIC_RUN
 );

66669 
	`sqlôe3VdbeE¡î
(
p
);

66670 if–
p
->
rc
==
SQLITE_NOMEM
 ){

66673 
no_mem
;

66675 
	`as£π
–
p
->
rc
==
SQLITE_OK
 ||Ö->rc==
SQLITE_BUSY
 );

66676 
	`as£π
–
p
->
bIsRódî
 ||Ö->
ªadO∆y
!=0 );

66677 
p
->
rc
 = 
SQLITE_OK
;

66678 
p
->
iCuºítTime
 = 0;

66679 
	`as£π
–
p
->
ex∂aö
==0 );

66680 
p
->
pResu…Së
 = 0;

66681 
db
->
busyH™dÀr
.
nBusy
 = 0;

66682 
CHECK_FOR_INTERRUPT
;

66683 
	`sqlôe3VdbeIOTø˚Sql
(
p
);

66684 #i‚de‡
SQLITE_OMIT_PROGRESS_CALLBACK


66685 if–
db
->
xProgªss
 ){

66686 
	`as£π
–0 < 
db
->
nProgªssOps
 );

66687 
nProgªssLimô
 = ()
p
->
aCou¡î
[
SQLITE_STMTSTATUS_VM_STEP
];

66688 if–
nProgªssLimô
==0 ){

66689 
nProgªssLimô
 = 
db
->
nProgªssOps
;

66691 
nProgªssLimô
 %()
db
->
nProgªssOps
;

66695 #ifde‡
SQLITE_DEBUG


66696 
	`sqlôe3BegöBíignMÆloc
();

66697 if–
p
->
pc
==0 && (p->
db
->
Êags
 & 
SQLITE_VdbeLi°ög
)!=0 ){

66698 
i
;

66699 
	`¥ötf
("VDBE Program Listing:\n");

66700 
	`sqlôe3VdbePrötSql
(
p
);

66701 
i
=0; i<
p
->
nOp
; i++){

66702 
	`sqlôe3VdbePrötOp
(
°dout
, 
i
, &
aOp
[i]);

66705 
	`sqlôe3EndBíignMÆloc
();

66707 
pc
=
p
->pc; 
rc
==
SQLITE_OK
;Öc++){

66708 
	`as£π
–
pc
>=0 &&Öc<
p
->
nOp
 );

66709 if–
db
->
mÆlocFaûed
 ) 
no_mem
;

66710 #ifde‡
VDBE_PROFILE


66711 
‹igPc
 = 
pc
;

66712 
°¨t
 = 
	`sqlôe3Hwtime
();

66714 
nVmSãp
++;

66715 
pOp
 = &
aOp
[
pc
];

66719 #ifde‡
SQLITE_DEBUG


66720 if–
p
->
åa˚
 ){

66721 if–
pc
==0 ){

66722 
	`¥ötf
("VDBE Execution Trace:\n");

66723 
	`sqlôe3VdbePrötSql
(
p
);

66725 
	`sqlôe3VdbePrötOp
(
p
->
åa˚
, 
pc
, 
pOp
);

66733 #ifde‡
SQLITE_TEST


66734 if–
sqlôe3_öãºu±_cou¡
>0 ){

66735 
sqlôe3_öãºu±_cou¡
--;

66736 if–
sqlôe3_öãºu±_cou¡
==0 ){

66737 
	`sqlôe3_öãºu±
(
db
);

66747 
	`as£π
–
pOp
->
›Êags
==
sqlôe3OpcodePr›îty
[pOp->
›code
] );

66748 if–
pOp
->
›Êags
 & 
OPFLG_OUT2_PRERELEASE
 ){

66749 
	`as£π
–
pOp
->
p2
>0 );

66750 
	`as£π
–
pOp
->
p2
<=(
p
->
nMem
-p->
nCurs‹
) );

66751 
pOut
 = &
aMem
[
pOp
->
p2
];

66752 
	`memAboutToCh™ge
(
p
, 
pOut
);

66753 
	`VdbeMemRñó£
(
pOut
);

66754 
pOut
->
Êags
 = 
MEM_I¡
;

66758 #ifde‡
SQLITE_DEBUG


66759 if–(
pOp
->
›Êags
 & 
OPFLG_IN1
)!=0 ){

66760 
	`as£π
–
pOp
->
p1
>0 );

66761 
	`as£π
–
pOp
->
p1
<=(
p
->
nMem
-p->
nCurs‹
) );

66762 
	`as£π
–
	`memIsVÆid
(&
aMem
[
pOp
->
p1
]) );

66763 
	`REGISTER_TRACE
(
pOp
->
p1
, &
aMem
[pOp->p1]);

66765 if–(
pOp
->
›Êags
 & 
OPFLG_IN2
)!=0 ){

66766 
	`as£π
–
pOp
->
p2
>0 );

66767 
	`as£π
–
pOp
->
p2
<=(
p
->
nMem
-p->
nCurs‹
) );

66768 
	`as£π
–
	`memIsVÆid
(&
aMem
[
pOp
->
p2
]) );

66769 
	`REGISTER_TRACE
(
pOp
->
p2
, &
aMem
[pOp->p2]);

66771 if–(
pOp
->
›Êags
 & 
OPFLG_IN3
)!=0 ){

66772 
	`as£π
–
pOp
->
p3
>0 );

66773 
	`as£π
–
pOp
->
p3
<=(
p
->
nMem
-p->
nCurs‹
) );

66774 
	`as£π
–
	`memIsVÆid
(&
aMem
[
pOp
->
p3
]) );

66775 
	`REGISTER_TRACE
(
pOp
->
p3
, &
aMem
[pOp->p3]);

66777 if–(
pOp
->
›Êags
 & 
OPFLG_OUT2
)!=0 ){

66778 
	`as£π
–
pOp
->
p2
>0 );

66779 
	`as£π
–
pOp
->
p2
<=(
p
->
nMem
-p->
nCurs‹
) );

66780 
	`memAboutToCh™ge
(
p
, &
aMem
[
pOp
->
p2
]);

66782 if–(
pOp
->
›Êags
 & 
OPFLG_OUT3
)!=0 ){

66783 
	`as£π
–
pOp
->
p3
>0 );

66784 
	`as£π
–
pOp
->
p3
<=(
p
->
nMem
-p->
nCurs‹
) );

66785 
	`memAboutToCh™ge
(
p
, &
aMem
[
pOp
->
p3
]);

66789  
pOp
->
›code
 ){

66833 
OP_GŸo
: {

66834 
pc
 = 
pOp
->
p2
 - 1;

66846 
check_f‹_öãºu±
:

66847 
CHECK_FOR_INTERRUPT
;

66848 #i‚de‡
SQLITE_OMIT_PROGRESS_CALLBACK


66855 if–
db
->
xProgªss
!=0 && 
nVmSãp
>=
nProgªssLimô
 ){

66856 
¥c
;

66857 
¥c
 = 
db
->
	`xProgªss
(db->
pProgªssArg
);

66858 if–
¥c
!=0 ){

66859 
rc
 = 
SQLITE_INTERRUPT
;

66860 
vdbe_îr‹_hÆt
;

66862 if–
db
->
xProgªss
!=0 ){

66863 
nProgªssLimô
 = 
nVmSãp
 + 
db
->
nProgªssOps
 - (nVmStep%db->nProgressOps);

66876 
OP_Gosub
: {

66877 
	`as£π
–
pOp
->
p1
>0 &&ÖOp->p1<=(
p
->
nMem
-p->
nCurs‹
) );

66878 
pIn1
 = &
aMem
[
pOp
->
p1
];

66879 
	`as£π
–(
pIn1
->
Êags
 & 
MEM_Dyn
)==0 );

66880 
	`memAboutToCh™ge
(
p
, 
pIn1
);

66881 
pIn1
->
Êags
 = 
MEM_I¡
;

66882 
pIn1
->
u
.
i
 = 
pc
;

66883 
	`REGISTER_TRACE
(
pOp
->
p1
, 
pIn1
);

66884 
pc
 = 
pOp
->
p2
 - 1;

66892 
OP_Rëu∫
: {

66893 
pIn1
 = &
aMem
[
pOp
->
p1
];

66894 
	`as£π
–
pIn1
->
Êags
 & 
MEM_I¡
 );

66895 
pc
 = ()
pIn1
->
u
.
i
;

66903 
OP_Yõld
: {

66905 
pcDe°
;

66907 
pIn1
 = &
aMem
[
pOp
->
p1
];

66908 
	`as£π
–(
pIn1
->
Êags
 & 
MEM_Dyn
)==0 );

66909 
pIn1
->
Êags
 = 
MEM_I¡
;

66910 
u
.
Ø
.
pcDe°
 = ()
pIn1
->u.
i
;

66911 
pIn1
->
u
.
i
 = 
pc
;

66912 
	`REGISTER_TRACE
(
pOp
->
p1
, 
pIn1
);

66913 
pc
 = 
u
.
Ø
.
pcDe°
;

66923 
OP_HÆtIfNuŒ
: {

66924 
pIn3
 = &
aMem
[
pOp
->
p3
];

66925 if–(
pIn3
->
Êags
 & 
MEM_NuŒ
)==0 ) ;

66948 
OP_HÆt
: {

66949 if–
pOp
->
p1
==
SQLITE_OK
 && 
p
->
pFøme
 ){

66951 
VdbeFøme
 *
pFøme
 = 
p
->pFrame;

66952 
p
->
pFøme
 =ÖFøme->
pP¨ít
;

66953 
p
->
nFøme
--;

66954 
	`sqlôe3VdbeSëCh™ges
(
db
, 
p
->
nCh™ge
);

66955 
pc
 = 
	`sqlôe3VdbeFømeRe°‹e
(
pFøme
);

66956 
œ°Rowid
 = 
db
->lastRowid;

66957 if–
pOp
->
p2
==
OE_Ign‹e
 ){

66963 
pc
 = 
p
->
aOp
[pc].
p2
-1;

66965 
aOp
 = 
p
->aOp;

66966 
aMem
 = 
p
->aMem;

66970 
p
->
rc
 = 
pOp
->
p1
;

66971 
p
->
îr‹A˘i⁄
 = (
u8
)
pOp
->
p2
;

66972 
p
->
pc
 =Öc;

66973 if–
pOp
->
p4
.
z
 ){

66974 
	`as£π
–
p
->
rc
!=
SQLITE_OK
 );

66975 
	`sqlôe3SëSåög
(&
p
->
zEºMsg
, 
db
, "%s", 
pOp
->
p4
.
z
);

66976 
	`ã°ˇ£
–
sqlôe3GlobÆC⁄fig
.
xLog
!=0 );

66977 
	`sqlôe3_log
(
pOp
->
p1
, "ab‹à© %d i¿[%s]: %s", 
pc
, 
p
->
zSql
,ÖOp->
p4
.
z
);

66978 }if–
p
->
rc
 ){

66979 
	`ã°ˇ£
–
sqlôe3GlobÆC⁄fig
.
xLog
!=0 );

66980 
	`sqlôe3_log
(
pOp
->
p1
, "c⁄°øöàÁûedáà%d i¿[%s]", 
pc
, 
p
->
zSql
);

66982 
rc
 = 
	`sqlôe3VdbeHÆt
(
p
);

66983 
	`as£π
–
rc
==
SQLITE_BUSY
 ||Ñc==
SQLITE_OK
 ||Ñc==
SQLITE_ERROR
 );

66984 if–
rc
==
SQLITE_BUSY
 ){

66985 
p
->
rc
 =Ñ¯
SQLITE_BUSY
;

66987 
	`as£π
–
rc
==
SQLITE_OK
 || (
p
->rc&0xff)==
SQLITE_CONSTRAINT
 );

66988 
	`as£π
–
rc
==
SQLITE_OK
 || 
db
->
nDe„ºedC⁄s
>0 || db->
nDe„ºedImmC⁄s
>0 );

66989 
rc
 = 
p
->r¯? 
SQLITE_ERROR
 : 
SQLITE_DONE
;

66991 
vdbe_ªtu∫
;

66998 
OP_I¡egî
: {

66999 
pOut
->
u
.
i
 = 
pOp
->
p1
;

67008 
OP_I¡64
: {

67009 
	`as£π
–
pOp
->
p4
.
pI64
!=0 );

67010 
pOut
->
u
.
i
 = *
pOp
->
p4
.
pI64
;

67014 #i‚de‡
SQLITE_OMIT_FLOATING_POINT


67020 
OP_Ról
: {

67021 
pOut
->
Êags
 = 
MEM_Ról
;

67022 
	`as£π
–!
	`sqlôe3IsNaN
(*
pOp
->
p4
.
pRól
) );

67023 
pOut
->
r
 = *
pOp
->
p4
.
pRól
;

67033 
OP_Såög8
: {

67034 
	`as£π
–
pOp
->
p4
.
z
!=0 );

67035 
pOp
->
›code
 = 
OP_Såög
;

67036 
pOp
->
p1
 = 
	`sqlôe3SåÀn30
’Op->
p4
.
z
);

67038 #i‚de‡
SQLITE_OMIT_UTF16


67039 if–
ícodög
!=
SQLITE_UTF8
 ){

67040 
rc
 = 
	`sqlôe3VdbeMemSëSå
(
pOut
, 
pOp
->
p4
.
z
, -1, 
SQLITE_UTF8
, 
SQLITE_STATIC
);

67041 if–
rc
==
SQLITE_TOOBIG
 ) 
too_big
;

67042 if–
SQLITE_OK
!=
	`sqlôe3VdbeCh™geEncodög
(
pOut
, 
ícodög
ËË
no_mem
;

67043 
	`as£π
–
pOut
->
zMÆloc
=ıOut->
z
 );

67044 
	`as£π
–
pOut
->
Êags
 & 
MEM_Dyn
 );

67045 
pOut
->
zMÆloc
 = 0;

67046 
pOut
->
Êags
 |
MEM_Sètic
;

67047 
pOut
->
Êags
 &~
MEM_Dyn
;

67048 if–
pOp
->
p4ty≥
==
P4_DYNAMIC
 ){

67049 
	`sqlôe3DbFªe
(
db
, 
pOp
->
p4
.
z
);

67051 
pOp
->
p4ty≥
 = 
P4_DYNAMIC
;

67052 
pOp
->
p4
.
z
 = 
pOut
->z;

67053 
pOp
->
p1
 = 
pOut
->
n
;

67056 if–
pOp
->
p1
>
db
->
aLimô
[
SQLITE_LIMIT_LENGTH
] ){

67057 
too_big
;

67066 
OP_Såög
: {

67067 
	`as£π
–
pOp
->
p4
.
z
!=0 );

67068 
pOut
->
Êags
 = 
MEM_Så
|
MEM_Sètic
|
MEM_Tîm
;

67069 
pOut
->
z
 = 
pOp
->
p4
.z;

67070 
pOut
->
n
 = 
pOp
->
p1
;

67071 
pOut
->
íc
 = 
ícodög
;

67072 
	`UPDATE_MAX_BLOBSIZE
(
pOut
);

67087 
OP_NuŒ
: {

67089 
˙t
;

67090 
u16
 
nuŒFœg
;

67092 
u
.
ab
.
˙t
 = 
pOp
->
p3
-pOp->
p2
;

67093 
	`as£π
–
pOp
->
p3
<=(
p
->
nMem
-p->
nCurs‹
) );

67094 
pOut
->
Êags
 = 
u
.
ab
.
nuŒFœg
 = 
pOp
->
p1
 ? (
MEM_NuŒ
|
MEM_CÀ¨ed
) : MEM_Null;

67095  
u
.
ab
.
˙t
>0 ){

67096 
pOut
++;

67097 
	`memAboutToCh™ge
(
p
, 
pOut
);

67098 
	`VdbeMemRñó£
(
pOut
);

67099 
pOut
->
Êags
 = 
u
.
ab
.
nuŒFœg
;

67100 
u
.
ab
.
˙t
--;

67111 
OP_Blob
: {

67112 
	`as£π
–
pOp
->
p1
 <
SQLITE_MAX_LENGTH
 );

67113 
	`sqlôe3VdbeMemSëSå
(
pOut
, 
pOp
->
p4
.
z
,ÖOp->
p1
, 0, 0);

67114 
pOut
->
íc
 = 
ícodög
;

67115 
	`UPDATE_MAX_BLOBSIZE
(
pOut
);

67126 
OP_V¨übÀ
: {

67128 
Mem
 *
pV¨
;

67131 
	`as£π
–
pOp
->
p1
>0 &&ÖOp->p1<=
p
->
nV¨
 );

67132 
	`as£π
–
pOp
->
p4
.
z
==0 ||ÖOp->p4.z==
p
->
azV¨
[pOp->
p1
-1] );

67133 
u
.
ac
.
pV¨
 = &
p
->
aV¨
[
pOp
->
p1
 - 1];

67134 if–
	`sqlôe3VdbeMemTooBig
(
u
.
ac
.
pV¨
) ){

67135 
too_big
;

67137 
	`sqlôe3VdbeMemShÆlowC›y
(
pOut
, 
u
.
ac
.
pV¨
, 
MEM_Sètic
);

67138 
	`UPDATE_MAX_BLOBSIZE
(
pOut
);

67149 
OP_Move
: {

67151 *
zMÆloc
;

67152 
n
;

67153 
p1
;

67154 
p2
;

67157 
u
.
ad
.
n
 = 
pOp
->
p3
 + 1;

67158 
u
.
ad
.
p1
 = 
pOp
->p1;

67159 
u
.
ad
.
p2
 = 
pOp
->p2;

67160 
	`as£π
–
u
.
ad
.
n
>0 && u.ad.
p1
>0 && u.ad.
p2
>0 );

67161 
	`as£π
–
u
.
ad
.
p1
+u.ad.
n
<=u.ad.
p2
 || u.ad.p2+u.ad.n<=u.ad.p1 );

67163 
pIn1
 = &
aMem
[
u
.
ad
.
p1
];

67164 
pOut
 = &
aMem
[
u
.
ad
.
p2
];

67165  
u
.
ad
.
n
-- ){

67166 
	`as£π
–
pOut
<=&
aMem
[(
p
->
nMem
-p->
nCurs‹
)] );

67167 
	`as£π
–
pIn1
<=&
aMem
[(
p
->
nMem
-p->
nCurs‹
)] );

67168 
	`as£π
–
	`memIsVÆid
(
pIn1
) );

67169 
	`memAboutToCh™ge
(
p
, 
pOut
);

67170 
u
.
ad
.
zMÆloc
 = 
pOut
->zMalloc;

67171 
pOut
->
zMÆloc
 = 0;

67172 
	`sqlôe3VdbeMemMove
(
pOut
, 
pIn1
);

67173 #ifde‡
SQLITE_DEBUG


67174 if–
pOut
->
pSc›yFrom
>=&
aMem
[
u
.
ad
.
p1
] &&ÖOut->pSc›yFrom<&aMem[u.ad.p1+
pOp
->
p3
] ){

67175 
pOut
->
pSc›yFrom
 +
u
.
ad
.
p1
 - 
pOp
->
p2
;

67178 
pIn1
->
zMÆloc
 = 
u
.
ad
.zMalloc;

67179 
	`REGISTER_TRACE
(
u
.
ad
.
p2
++, 
pOut
);

67180 
pIn1
++;

67181 
pOut
++;

67193 
OP_C›y
: {

67195 
n
;

67198 
u
.
´
.
n
 = 
pOp
->
p3
;

67199 
pIn1
 = &
aMem
[
pOp
->
p1
];

67200 
pOut
 = &
aMem
[
pOp
->
p2
];

67201 
	`as£π
–
pOut
!=
pIn1
 );

67203 
	`sqlôe3VdbeMemShÆlowC›y
(
pOut
, 
pIn1
, 
MEM_Ephem
);

67204 
	`DìphemîÆize
(
pOut
);

67205 #ifde‡
SQLITE_DEBUG


67206 
pOut
->
pSc›yFrom
 = 0;

67208 
	`REGISTER_TRACE
(
pOp
->
p2
+pOp->
p3
-
u
.
´
.
n
, 
pOut
);

67209 if–(
u
.
´
.
n
--)==0 ) ;

67210 
pOut
++;

67211 
pIn1
++;

67228 
OP_SC›y
: {

67229 
pIn1
 = &
aMem
[
pOp
->
p1
];

67230 
pOut
 = &
aMem
[
pOp
->
p2
];

67231 
	`as£π
–
pOut
!=
pIn1
 );

67232 
	`sqlôe3VdbeMemShÆlowC›y
(
pOut
, 
pIn1
, 
MEM_Ephem
);

67233 #ifde‡
SQLITE_DEBUG


67234 if–
pOut
->
pSc›yFrom
==0 )ÖOut->pSc›yFrom = 
pIn1
;

67236 
	`REGISTER_TRACE
(
pOp
->
p2
, 
pOut
);

67248 
OP_Resu…Row
: {

67250 
Mem
 *
pMem
;

67251 
i
;

67253 
	`as£π
–
p
->
nResCﬁumn
==
pOp
->
p2
 );

67254 
	`as£π
–
pOp
->
p1
>0 );

67255 
	`as£π
–
pOp
->
p1
+pOp->
p2
<=(
p
->
nMem
-p->
nCurs‹
)+1 );

67260 if–
SQLITE_OK
!=(
rc
 = 
	`sqlôe3VdbeCheckFk
(
p
, 0)) ){

67261 
	`as£π
–
db
->
Êags
&
SQLITE_Cou¡Rows
 );

67262 
	`as£π
–
p
->
u£sStmtJou∫Æ
 );

67281 
	`as£π
–
p
->
iSèãmít
==0 || 
db
->
Êags
&
SQLITE_Cou¡Rows
 );

67282 
rc
 = 
	`sqlôe3VdbeClo£Sèãmít
(
p
, 
SAVEPOINT_RELEASE
);

67283 if–
	`NEVER
(
rc
!=
SQLITE_OK
) ){

67288 
p
->
ˇcheCå
 = (p->cacheCtr + 2)|1;

67294 
u
.
af
.
pMem
 = 
p
->
pResu…Së
 = &
aMem
[
pOp
->
p1
];

67295 
u
.
af
.
i
=0; u.af.i<
pOp
->
p2
; u.af.i++){

67296 
	`as£π
–
	`memIsVÆid
(&
u
.
af
.
pMem
[u.af.
i
]) );

67297 
	`DìphemîÆize
(&
u
.
af
.
pMem
[u.af.
i
]);

67298 
	`as£π
–(
u
.
af
.
pMem
[u.af.
i
].
Êags
 & 
MEM_Ephem
)==0

67299 || (
u
.
af
.
pMem
[u.af.
i
].
Êags
 & (
MEM_Så
|
MEM_Blob
))==0 );

67300 
	`sqlôe3VdbeMemNulTîmö©e
(&
u
.
af
.
pMem
[u.af.
i
]);

67301 
	`sqlôe3VdbeMemSt‹eTy≥
(&
u
.
af
.
pMem
[u.af.
i
]);

67302 
	`REGISTER_TRACE
(
pOp
->
p1
+
u
.
af
.
i
, &u.af.
pMem
[u.af.i]);

67304 if–
db
->
mÆlocFaûed
 ) 
no_mem
;

67308 
p
->
pc
 =Öc + 1;

67309 
rc
 = 
SQLITE_ROW
;

67310 
vdbe_ªtu∫
;

67325 
OP_C⁄ˇt
: {

67327 
i64
 
nByã
;

67330 
pIn1
 = &
aMem
[
pOp
->
p1
];

67331 
pIn2
 = &
aMem
[
pOp
->
p2
];

67332 
pOut
 = &
aMem
[
pOp
->
p3
];

67333 
	`as£π
–
pIn1
!=
pOut
 );

67334 if–(
pIn1
->
Êags
 | 
pIn2
->ÊagsË& 
MEM_NuŒ
 ){

67335 
	`sqlôe3VdbeMemSëNuŒ
(
pOut
);

67338 if–
	`Ex∑ndBlob
(
pIn1
Ë|| Ex∑ndBlob(
pIn2
ËË
no_mem
;

67339 
	`Såögify
(
pIn1
, 
ícodög
);

67340 
	`Såögify
(
pIn2
, 
ícodög
);

67341 
u
.
ag
.
nByã
 = 
pIn1
->
n
 + 
pIn2
->n;

67342 if–
u
.
ag
.
nByã
>
db
->
aLimô
[
SQLITE_LIMIT_LENGTH
] ){

67343 
too_big
;

67345 
	`MemSëTy≥Fœg
(
pOut
, 
MEM_Så
);

67346 if–
	`sqlôe3VdbeMemGrow
(
pOut
, ()
u
.
ag
.
nByã
+2,ÖOut==
pIn2
) ){

67347 
no_mem
;

67349 if–
pOut
!=
pIn2
 ){

67350 
	`mem˝y
(
pOut
->
z
, 
pIn2
->z,ÖIn2->
n
);

67352 
	`mem˝y
(&
pOut
->
z
[
pIn2
->
n
], 
pIn1
->z,ÖIn1->n);

67353 
pOut
->
z
[
u
.
ag
.
nByã
] = 0;

67354 
pOut
->
z
[
u
.
ag
.
nByã
+1] = 0;

67355 
pOut
->
Êags
 |
MEM_Tîm
;

67356 
pOut
->
n
 = ()
u
.
ag
.
nByã
;

67357 
pOut
->
íc
 = 
ícodög
;

67358 
	`UPDATE_MAX_BLOBSIZE
(
pOut
);

67395 
OP_Add
:

67396 
OP_Subåa˘
:

67397 
OP_Mu…ùly
:

67398 
OP_Divide
:

67399 
OP_Remaödî
: {

67401 
bI¡öt
;

67402 
Êags
;

67403 
i64
 
iA
;

67404 
i64
 
iB
;

67405 
rA
;

67406 
rB
;

67409 
pIn1
 = &
aMem
[
pOp
->
p1
];

67410 
	`≠∂yNumîicAfföôy
(
pIn1
);

67411 
pIn2
 = &
aMem
[
pOp
->
p2
];

67412 
	`≠∂yNumîicAfföôy
(
pIn2
);

67413 
pOut
 = &
aMem
[
pOp
->
p3
];

67414 
u
.
ah
.
Êags
 = 
pIn1
->Êag†| 
pIn2
->flags;

67415 if–(
u
.
ah
.
Êags
 & 
MEM_NuŒ
)!=0 ) 
¨ôhmëic_ªsu…_is_nuŒ
;

67416 if–(
pIn1
->
Êags
 & 
pIn2
->Êag†& 
MEM_I¡
)==MEM_Int ){

67417 
u
.
ah
.
iA
 = 
pIn1
->u.
i
;

67418 
u
.
ah
.
iB
 = 
pIn2
->u.
i
;

67419 
u
.
ah
.
bI¡öt
 = 1;

67420  
pOp
->
›code
 ){

67421 
OP_Add
: if–
	`sqlôe3AddI¡64
(&
u
.
ah
.
iB
,u.ah.
iA
ËË
Â_m©h
; ;

67422 
OP_Subåa˘
: if–
	`sqlôe3SubI¡64
(&
u
.
ah
.
iB
,u.ah.
iA
ËË
Â_m©h
; ;

67423 
OP_Mu…ùly
: if–
	`sqlôe3MulI¡64
(&
u
.
ah
.
iB
,u.ah.
iA
ËË
Â_m©h
; ;

67424 
OP_Divide
: {

67425 if–
u
.
ah
.
iA
==0 ) 
¨ôhmëic_ªsu…_is_nuŒ
;

67426 if–
u
.
ah
.
iA
==-1 && u.ah.
iB
==
SMALLEST_INT64
 ) 
Â_m©h
;

67427 
u
.
ah
.
iB
 /u.ah.
iA
;

67431 if–
u
.
ah
.
iA
==0 ) 
¨ôhmëic_ªsu…_is_nuŒ
;

67432 if–
u
.
ah
.
iA
==-1 ) u.ah.iA = 1;

67433 
u
.
ah
.
iB
 %u.ah.
iA
;

67437 
pOut
->
u
.
i
 = u.
ah
.
iB
;

67438 
	`MemSëTy≥Fœg
(
pOut
, 
MEM_I¡
);

67440 
u
.
ah
.
bI¡öt
 = 0;

67441 
Â_m©h
:

67442 
u
.
ah
.
rA
 = 
	`sqlôe3VdbeRólVÆue
(
pIn1
);

67443 
u
.
ah
.
rB
 = 
	`sqlôe3VdbeRólVÆue
(
pIn2
);

67444  
pOp
->
›code
 ){

67445 
OP_Add
: 
u
.
ah
.
rB
 +u.ah.
rA
; ;

67446 
OP_Subåa˘
: 
u
.
ah
.
rB
 -u.ah.
rA
; ;

67447 
OP_Mu…ùly
: 
u
.
ah
.
rB
 *u.ah.
rA
; ;

67448 
OP_Divide
: {

67450 if–
u
.
ah
.
rA
==()0 ) 
¨ôhmëic_ªsu…_is_nuŒ
;

67451 
u
.
ah
.
rB
 /u.ah.
rA
;

67455 
u
.
ah
.
iA
 = (
i64
)u.ah.
rA
;

67456 
u
.
ah
.
iB
 = (
i64
)u.ah.
rB
;

67457 if–
u
.
ah
.
iA
==0 ) 
¨ôhmëic_ªsu…_is_nuŒ
;

67458 if–
u
.
ah
.
iA
==-1 ) u.ah.iA = 1;

67459 
u
.
ah
.
rB
 = ()(u.ah.
iB
 % u.ah.
iA
);

67463 #ifde‡
SQLITE_OMIT_FLOATING_POINT


67464 
pOut
->
u
.
i
 = u.
ah
.
rB
;

67465 
	`MemSëTy≥Fœg
(
pOut
, 
MEM_I¡
);

67467 if–
	`sqlôe3IsNaN
(
u
.
ah
.
rB
) ){

67468 
¨ôhmëic_ªsu…_is_nuŒ
;

67470 
pOut
->
r
 = 
u
.
ah
.
rB
;

67471 
	`MemSëTy≥Fœg
(
pOut
, 
MEM_Ról
);

67472 if–(
u
.
ah
.
Êags
 & 
MEM_Ról
)==0 && !u.ah.
bI¡öt
 ){

67473 
	`sqlôe3VdbeI¡egîAfföôy
(
pOut
);

67479 
¨ôhmëic_ªsu…_is_nuŒ
:

67480 
	`sqlôe3VdbeMemSëNuŒ
(
pOut
);

67499 
OP_CﬁlSeq
: {

67500 
	`as£π
–
pOp
->
p4ty≥
==
P4_COLLSEQ
 );

67501 if–
pOp
->
p1
 ){

67502 
	`sqlôe3VdbeMemSëI¡64
(&
aMem
[
pOp
->
p1
], 0);

67523 
OP_Fun˘i⁄
: {

67525 
i
;

67526 
Mem
 *
pArg
;

67527 
sqlôe3_c⁄ãxt
 
˘x
;

67528 
sqlôe3_vÆue
 **
≠VÆ
;

67529 
n
;

67532 
u
.
ai
.
n
 = 
pOp
->
p5
;

67533 
u
.
ai
.
≠VÆ
 = 
p
->
≠Arg
;

67534 
	`as£π
–
u
.
ai
.
≠VÆ
 || u.ai.
n
==0 );

67535 
	`as£π
–
pOp
->
p3
>0 &&ÖOp->p3<=(
p
->
nMem
-p->
nCurs‹
) );

67536 
pOut
 = &
aMem
[
pOp
->
p3
];

67537 
	`memAboutToCh™ge
(
p
, 
pOut
);

67539 
	`as£π
–
u
.
ai
.
n
==0 || (
pOp
->
p2
>0 &&ÖOp->p2+u.ai.n<=(
p
->
nMem
-p->
nCurs‹
)+1) );

67540 
	`as£π
–
pOp
->
p3
<pOp->
p2
 ||ÖOp->p3>ıOp->p2+
u
.
ai
.
n
 );

67541 
u
.
ai
.
pArg
 = &
aMem
[
pOp
->
p2
];

67542 
u
.
ai
.
i
=0; u.ai.i<u.ai.
n
; u.ai.i++, u.ai.
pArg
++){

67543 
	`as£π
–
	`memIsVÆid
(
u
.
ai
.
pArg
) );

67544 
u
.
ai
.
≠VÆ
[u.ai.
i
] = u.ai.
pArg
;

67545 
	`DìphemîÆize
(
u
.
ai
.
pArg
);

67546 
	`sqlôe3VdbeMemSt‹eTy≥
(
u
.
ai
.
pArg
);

67547 
	`REGISTER_TRACE
(
pOp
->
p2
+
u
.
ai
.
i
, u.ai.
pArg
);

67550 
	`as£π
–
pOp
->
p4ty≥
==
P4_FUNCDEF
 );

67551 
u
.
ai
.
˘x
.
pFunc
 = 
pOp
->
p4
.pFunc;

67552 
u
.
ai
.
˘x
.
s
.
Êags
 = 
MEM_NuŒ
;

67553 
u
.
ai
.
˘x
.
s
.
db
 = db;

67554 
u
.
ai
.
˘x
.
s
.
xDñ
 = 0;

67555 
u
.
ai
.
˘x
.
s
.
zMÆloc
 = 0;

67556 
u
.
ai
.
˘x
.
iOp
 = 
pc
;

67557 
u
.
ai
.
˘x
.
pVdbe
 = 
p
;

67563 
	`sqlôe3VdbeMemMove
(&
u
.
ai
.
˘x
.
s
, 
pOut
);

67564 
	`MemSëTy≥Fœg
(&
u
.
ai
.
˘x
.
s
, 
MEM_NuŒ
);

67566 
u
.
ai
.
˘x
.
fEº‹OrAux
 = 0;

67567 if–
u
.
ai
.
˘x
.
pFunc
->
funcFœgs
 & 
SQLITE_FUNC_NEEDCOLL
 ){

67568 
	`as£π
–
pOp
>
aOp
 );

67569 
	`as£π
–
pOp
[-1].
p4ty≥
==
P4_COLLSEQ
 );

67570 
	`as£π
–
pOp
[-1].
›code
==
OP_CﬁlSeq
 );

67571 
u
.
ai
.
˘x
.
pCﬁl
 = 
pOp
[-1].
p4
.pColl;

67573 
db
->
œ°Rowid
 =ÜastRowid;

67574 (*
u
.
ai
.
˘x
.
pFunc
->
xFunc
)(&u.ai.˘x, u.ai.
n
, u.ai.
≠VÆ
);

67575 
œ°Rowid
 = 
db
->lastRowid;

67577 if–
db
->
mÆlocFaûed
 ){

67583 
	`sqlôe3VdbeMemRñó£
(&
u
.
ai
.
˘x
.
s
);

67584 
no_mem
;

67588 if–
u
.
ai
.
˘x
.
fEº‹OrAux
 ){

67589 if–
u
.
ai
.
˘x
.
isEº‹
 ){

67590 
	`sqlôe3SëSåög
(&
p
->
zEºMsg
, 
db
, "%s", 
	`sqlôe3_vÆue_ãxt
(&
u
.
ai
.
˘x
.
s
));

67591 
rc
 = 
u
.
ai
.
˘x
.
isEº‹
;

67593 
	`sqlôe3VdbeDñëeAuxD©a
(
p
, 
pc
, 
pOp
->
p1
);

67597 
	`sqlôe3VdbeCh™geEncodög
(&
u
.
ai
.
˘x
.
s
, 
ícodög
);

67598 
	`sqlôe3VdbeMemMove
(
pOut
, &
u
.
ai
.
˘x
.
s
);

67599 if–
	`sqlôe3VdbeMemTooBig
(
pOut
) ){

67600 
too_big
;

67608 if–
p
->
expúed
 ) 
rc
 = 
SQLITE_ABORT
;

67611 
	`REGISTER_TRACE
(
pOp
->
p3
, 
pOut
);

67612 
	`UPDATE_MAX_BLOBSIZE
(
pOut
);

67642 
OP_BôAnd
:

67643 
OP_BôOr
:

67644 
OP_Shi·Le·
:

67645 
OP_Shi·Right
: {

67647 
i64
 
iA
;

67648 
u64
 
uA
;

67649 
i64
 
iB
;

67650 
u8
 
›
;

67653 
pIn1
 = &
aMem
[
pOp
->
p1
];

67654 
pIn2
 = &
aMem
[
pOp
->
p2
];

67655 
pOut
 = &
aMem
[
pOp
->
p3
];

67656 if–(
pIn1
->
Êags
 | 
pIn2
->ÊagsË& 
MEM_NuŒ
 ){

67657 
	`sqlôe3VdbeMemSëNuŒ
(
pOut
);

67660 
u
.
aj
.
iA
 = 
	`sqlôe3VdbeI¡VÆue
(
pIn2
);

67661 
u
.
aj
.
iB
 = 
	`sqlôe3VdbeI¡VÆue
(
pIn1
);

67662 
u
.
aj
.
›
 = 
pOp
->
›code
;

67663 if–
u
.
aj
.
›
==
OP_BôAnd
 ){

67664 
u
.
aj
.
iA
 &u.aj.
iB
;

67665 }if–
u
.
aj
.
›
==
OP_BôOr
 ){

67666 
u
.
aj
.
iA
 |u.aj.
iB
;

67667 }if–
u
.
aj
.
iB
!=0 ){

67668 
	`as£π
–
u
.
aj
.
›
==
OP_Shi·Right
 || u.aj.›==
OP_Shi·Le·
 );

67671 if–
u
.
aj
.
iB
<0 ){

67672 
	`as£π
–
OP_Shi·Right
==
OP_Shi·Le·
+1 );

67673 
u
.
aj
.
›
 = 2*
OP_Shi·Le·
 + 1 - u.aj.op;

67674 
u
.
aj
.
iB
 = u.aj.iB>(-64) ? -u.aj.iB : 64;

67677 if–
u
.
aj
.
iB
>=64 ){

67678 
u
.
aj
.
iA
 = (u.aj.iA>=0 || u.aj.
›
==
OP_Shi·Le·
) ? 0 : -1;

67680 
	`mem˝y
(&
u
.
aj
.
uA
, &u.aj.
iA
, (u.aj.uA));

67681 if–
u
.
aj
.
›
==
OP_Shi·Le·
 ){

67682 
u
.
aj
.
uA
 <<u.aj.
iB
;

67684 
u
.
aj
.
uA
 >>u.aj.
iB
;

67686 if–
u
.
aj
.
iA
<0 ) u.aj.
uA
 |((((
u64
)0xffffffff)<<32)|0xffffffffË<< (64-u.aj.
iB
);

67688 
	`mem˝y
(&
u
.
aj
.
iA
, &u.aj.
uA
, (u.aj.iA));

67691 
pOut
->
u
.
i
 = u.
aj
.
iA
;

67692 
	`MemSëTy≥Fœg
(
pOut
, 
MEM_I¡
);

67703 
OP_AddImm
: {

67704 
pIn1
 = &
aMem
[
pOp
->
p1
];

67705 
	`memAboutToCh™ge
(
p
, 
pIn1
);

67706 
	`sqlôe3VdbeMemI¡egîify
(
pIn1
);

67707 
pIn1
->
u
.
i
 +
pOp
->
p2
;

67718 
OP_Mu°BeI¡
: {

67719 
pIn1
 = &
aMem
[
pOp
->
p1
];

67720 
	`≠∂yAfföôy
(
pIn1
, 
SQLITE_AFF_NUMERIC
, 
ícodög
);

67721 if–(
pIn1
->
Êags
 & 
MEM_I¡
)==0 ){

67722 if–
pOp
->
p2
==0 ){

67723 
rc
 = 
SQLITE_MISMATCH
;

67724 
ab‹t_due_to_îr‹
;

67726 
pc
 = 
pOp
->
p2
 - 1;

67729 
	`MemSëTy≥Fœg
(
pIn1
, 
MEM_I¡
);

67734 #i‚de‡
SQLITE_OMIT_FLOATING_POINT


67744 
OP_RólAfföôy
: {

67745 
pIn1
 = &
aMem
[
pOp
->
p1
];

67746 if–
pIn1
->
Êags
 & 
MEM_I¡
 ){

67747 
	`sqlôe3VdbeMemRólify
(
pIn1
);

67753 #i‚de‡
SQLITE_OMIT_CAST


67763 
OP_ToText
: {

67764 
pIn1
 = &
aMem
[
pOp
->
p1
];

67765 
	`memAboutToCh™ge
(
p
, 
pIn1
);

67766 if–
pIn1
->
Êags
 & 
MEM_NuŒ
 ) ;

67767 
	`as£π
–
MEM_Så
==(
MEM_Blob
>>3) );

67768 
pIn1
->
Êags
 |’In1->Êags&
MEM_Blob
)>>3;

67769 
	`≠∂yAfföôy
(
pIn1
, 
SQLITE_AFF_TEXT
, 
ícodög
);

67770 
rc
 = 
	`Ex∑ndBlob
(
pIn1
);

67771 
	`as£π
–
pIn1
->
Êags
 & 
MEM_Så
 || 
db
->
mÆlocFaûed
 );

67772 
pIn1
->
Êags
 &~(
MEM_I¡
|
MEM_Ról
|
MEM_Blob
|
MEM_Zîo
);

67773 
	`UPDATE_MAX_BLOBSIZE
(
pIn1
);

67786 
OP_ToBlob
: {

67787 
pIn1
 = &
aMem
[
pOp
->
p1
];

67788 if–
pIn1
->
Êags
 & 
MEM_NuŒ
 ) ;

67789 if–(
pIn1
->
Êags
 & 
MEM_Blob
)==0 ){

67790 
	`≠∂yAfföôy
(
pIn1
, 
SQLITE_AFF_TEXT
, 
ícodög
);

67791 
	`as£π
–
pIn1
->
Êags
 & 
MEM_Så
 || 
db
->
mÆlocFaûed
 );

67792 
	`MemSëTy≥Fœg
(
pIn1
, 
MEM_Blob
);

67794 
pIn1
->
Êags
 &~(
MEM_Ty≥Mask
&~
MEM_Blob
);

67796 
	`UPDATE_MAX_BLOBSIZE
(
pIn1
);

67810 
OP_ToNumîic
: {

67811 
pIn1
 = &
aMem
[
pOp
->
p1
];

67812 
	`sqlôe3VdbeMemNumîify
(
pIn1
);

67826 
OP_ToI¡
: {

67827 
pIn1
 = &
aMem
[
pOp
->
p1
];

67828 if–(
pIn1
->
Êags
 & 
MEM_NuŒ
)==0 ){

67829 
	`sqlôe3VdbeMemI¡egîify
(
pIn1
);

67834 #i‡!
	`deföed
(
SQLITE_OMIT_CAST
Ë&& !deföed(
SQLITE_OMIT_FLOATING_POINT
)

67844 
OP_ToRól
: {

67845 
pIn1
 = &
aMem
[
pOp
->
p1
];

67846 
	`memAboutToCh™ge
(
p
, 
pIn1
);

67847 if–(
pIn1
->
Êags
 & 
MEM_NuŒ
)==0 ){

67848 
	`sqlôe3VdbeMemRólify
(
pIn1
);

67930 
OP_Eq
:

67931 
OP_Ne
:

67932 
OP_Lt
:

67933 
OP_Le
:

67934 
OP_Gt
:

67935 
OP_Ge
: {

67937 
ªs
;

67938 
afföôy
;

67939 
u16
 
Êags1
;

67940 
u16
 
Êags3
;

67943 
pIn1
 = &
aMem
[
pOp
->
p1
];

67944 
pIn3
 = &
aMem
[
pOp
->
p3
];

67945 
u
.
ak
.
Êags1
 = 
pIn1
->
Êags
;

67946 
u
.
ak
.
Êags3
 = 
pIn3
->
Êags
;

67947 if–(
u
.
ak
.
Êags1
 | u.ak.
Êags3
)&
MEM_NuŒ
 ){

67949 if–
pOp
->
p5
 & 
SQLITE_NULLEQ
 ){

67954 
	`as£π
–
pOp
->
›code
==
OP_Eq
 ||ÖOp->›code==
OP_Ne
 );

67955 
	`as£π
–(
u
.
ak
.
Êags1
 & 
MEM_CÀ¨ed
)==0 );

67956 if–(
u
.
ak
.
Êags1
&
MEM_NuŒ
)!=0

67957 && (
u
.
ak
.
Êags3
&
MEM_NuŒ
)!=0

67958 && (
u
.
ak
.
Êags3
&
MEM_CÀ¨ed
)==0

67960 
u
.
ak
.
ªs
 = 0;

67962 
u
.
ak
.
ªs
 = 1;

67969 if–
pOp
->
p5
 & 
SQLITE_JUMPIFNULL
 ){

67970 
pc
 = 
pOp
->
p2
-1;

67971 }if–
pOp
->
p5
 & 
SQLITE_STOREP2
 ){

67972 
pOut
 = &
aMem
[
pOp
->
p2
];

67973 
	`MemSëTy≥Fœg
(
pOut
, 
MEM_NuŒ
);

67974 
	`REGISTER_TRACE
(
pOp
->
p2
, 
pOut
);

67980 
u
.
ak
.
afföôy
 = 
pOp
->
p5
 & 
SQLITE_AFF_MASK
;

67981 if–
u
.
ak
.
afföôy
 ){

67982 
	`≠∂yAfföôy
(
pIn1
, 
u
.
ak
.
afföôy
, 
ícodög
);

67983 
	`≠∂yAfföôy
(
pIn3
, 
u
.
ak
.
afföôy
, 
ícodög
);

67984 if–
db
->
mÆlocFaûed
 ) 
no_mem
;

67987 
	`as£π
–
pOp
->
p4ty≥
==
P4_COLLSEQ
 ||ÖOp->
p4
.
pCﬁl
==0 );

67988 
	`Ex∑ndBlob
(
pIn1
);

67989 
	`Ex∑ndBlob
(
pIn3
);

67990 
u
.
ak
.
ªs
 = 
	`sqlôe3MemCom∑ª
(
pIn3
, 
pIn1
, 
pOp
->
p4
.
pCﬁl
);

67992  
pOp
->
›code
 ){

67993 
OP_Eq
: 
u
.
ak
.
ªs
 = u.ak.res==0; ;

67994 
OP_Ne
: 
u
.
ak
.
ªs
 = u.ak.res!=0; ;

67995 
OP_Lt
: 
u
.
ak
.
ªs
 = u.ak.res<0; ;

67996 
OP_Le
: 
u
.
ak
.
ªs
 = u.ak.res<=0; ;

67997 
OP_Gt
: 
u
.
ak
.
ªs
 = u.ak.res>0; ;

67998 : 
u
.
ak
.
ªs
 = u.ak.res>=0; ;

68001 if–
pOp
->
p5
 & 
SQLITE_STOREP2
 ){

68002 
pOut
 = &
aMem
[
pOp
->
p2
];

68003 
	`memAboutToCh™ge
(
p
, 
pOut
);

68004 
	`MemSëTy≥Fœg
(
pOut
, 
MEM_I¡
);

68005 
pOut
->
u
.
i
 = u.
ak
.
ªs
;

68006 
	`REGISTER_TRACE
(
pOp
->
p2
, 
pOut
);

68007 }if–
u
.
ak
.
ªs
 ){

68008 
pc
 = 
pOp
->
p2
-1;

68012 
pIn1
->
Êags
 = (pIn1->Êags&~
MEM_Ty≥Mask
Ë| (
u
.
ak
.
Êags1
&MEM_TypeMask);

68013 
pIn3
->
Êags
 = (pIn3->Êags&~
MEM_Ty≥Mask
Ë| (
u
.
ak
.
Êags3
&MEM_TypeMask);

68026 
OP_Pîmuèti⁄
: {

68027 
	`as£π
–
pOp
->
p4ty≥
==
P4_INTARRAY
 );

68028 
	`as£π
–
pOp
->
p4
.
ai
 );

68029 
aPîmuã
 = 
pOp
->
p4
.
ai
;

68052 
OP_Com∑ª
: {

68054 
n
;

68055 
i
;

68056 
p1
;

68057 
p2
;

68058 c⁄° 
KeyInfo
 *
pKeyInfo
;

68059 
idx
;

68060 
CﬁlSeq
 *
pCﬁl
;

68061 
bRev
;

68064 if–(
pOp
->
p5
 & 
OPFLAG_PERMUTE
)==0 ) 
aPîmuã
 = 0;

68065 
u
.
Æ
.
n
 = 
pOp
->
p3
;

68066 
u
.
Æ
.
pKeyInfo
 = 
pOp
->
p4
.pKeyInfo;

68067 
	`as£π
–
u
.
Æ
.
n
>0 );

68068 
	`as£π
–
u
.
Æ
.
pKeyInfo
!=0 );

68069 
u
.
Æ
.
p1
 = 
pOp
->p1;

68070 
u
.
Æ
.
p2
 = 
pOp
->p2;

68071 #i‡
SQLITE_DEBUG


68072 if–
aPîmuã
 ){

68073 
k
, 
mx
 = 0;

68074 
k
=0; k<
u
.
Æ
.
n
; k++Ëif–
aPîmuã
[k]>
mx
 ) mx =áPermute[k];

68075 
	`as£π
–
u
.
Æ
.
p1
>0 && u.Æ.p1+
mx
<=(
p
->
nMem
-p->
nCurs‹
)+1 );

68076 
	`as£π
–
u
.
Æ
.
p2
>0 && u.Æ.p2+
mx
<=(
p
->
nMem
-p->
nCurs‹
)+1 );

68078 
	`as£π
–
u
.
Æ
.
p1
>0 && u.Æ.p1+u.Æ.
n
<=(
p
->
nMem
-p->
nCurs‹
)+1 );

68079 
	`as£π
–
u
.
Æ
.
p2
>0 && u.Æ.p2+u.Æ.
n
<=(
p
->
nMem
-p->
nCurs‹
)+1 );

68082 
u
.
Æ
.
i
=0; u.Æ.i<u.Æ.
n
; u.al.i++){

68083 
u
.
Æ
.
idx
 = 
aPîmuã
 ?áPîmuã[u.Æ.
i
] : u.al.i;

68084 
	`as£π
–
	`memIsVÆid
(&
aMem
[
u
.
Æ
.
p1
+u.Æ.
idx
]) );

68085 
	`as£π
–
	`memIsVÆid
(&
aMem
[
u
.
Æ
.
p2
+u.Æ.
idx
]) );

68086 
	`REGISTER_TRACE
(
u
.
Æ
.
p1
+u.Æ.
idx
, &
aMem
[u.al.p1+u.al.idx]);

68087 
	`REGISTER_TRACE
(
u
.
Æ
.
p2
+u.Æ.
idx
, &
aMem
[u.al.p2+u.al.idx]);

68088 
	`as£π
–
u
.
Æ
.
i
<u.Æ.
pKeyInfo
->
nFõld
 );

68089 
u
.
Æ
.
pCﬁl
 = u.Æ.
pKeyInfo
->
aCﬁl
[u.Æ.
i
];

68090 
u
.
Æ
.
bRev
 = u.Æ.
pKeyInfo
->
aS‹tOrdî
[u.Æ.
i
];

68091 
iCom∑ª
 = 
	`sqlôe3MemCom∑ª
(&
aMem
[
u
.
Æ
.
p1
+u.Æ.
idx
], &aMem[u.Æ.
p2
+u.Æ.idx], u.Æ.
pCﬁl
);

68092 if–
iCom∑ª
 ){

68093 if–
u
.
Æ
.
bRev
 ) 
iCom∑ª
 = -iCompare;

68097 
aPîmuã
 = 0;

68107 
OP_Jump
: {

68108 if–
iCom∑ª
<0 ){

68109 
pc
 = 
pOp
->
p1
 - 1;

68110 }if–
iCom∑ª
==0 ){

68111 
pc
 = 
pOp
->
p2
 - 1;

68113 
pc
 = 
pOp
->
p3
 - 1;

68136 
OP_And
:

68137 
OP_Or
: {

68139 
v1
;

68140 
v2
;

68143 
pIn1
 = &
aMem
[
pOp
->
p1
];

68144 if–
pIn1
->
Êags
 & 
MEM_NuŒ
 ){

68145 
u
.
am
.
v1
 = 2;

68147 
u
.
am
.
v1
 = 
	`sqlôe3VdbeI¡VÆue
(
pIn1
)!=0;

68149 
pIn2
 = &
aMem
[
pOp
->
p2
];

68150 if–
pIn2
->
Êags
 & 
MEM_NuŒ
 ){

68151 
u
.
am
.
v2
 = 2;

68153 
u
.
am
.
v2
 = 
	`sqlôe3VdbeI¡VÆue
(
pIn2
)!=0;

68155 if–
pOp
->
›code
==
OP_And
 ){

68156 c⁄° 
™d_logic
[] = { 0, 0, 0, 0, 1, 2, 0, 2, 2 };

68157 
u
.
am
.
v1
 = 
™d_logic
[u.am.v1*3+u.am.
v2
];

68159 c⁄° 
‹_logic
[] = { 0, 1, 2, 1, 1, 1, 2, 1, 2 };

68160 
u
.
am
.
v1
 = 
‹_logic
[u.am.v1*3+u.am.
v2
];

68162 
pOut
 = &
aMem
[
pOp
->
p3
];

68163 if–
u
.
am
.
v1
==2 ){

68164 
	`MemSëTy≥Fœg
(
pOut
, 
MEM_NuŒ
);

68166 
pOut
->
u
.
i
 = u.
am
.
v1
;

68167 
	`MemSëTy≥Fœg
(
pOut
, 
MEM_I¡
);

68178 
OP_NŸ
: {

68179 
pIn1
 = &
aMem
[
pOp
->
p1
];

68180 
pOut
 = &
aMem
[
pOp
->
p2
];

68181 if–
pIn1
->
Êags
 & 
MEM_NuŒ
 ){

68182 
	`sqlôe3VdbeMemSëNuŒ
(
pOut
);

68184 
	`sqlôe3VdbeMemSëI¡64
(
pOut
, !
	`sqlôe3VdbeI¡VÆue
(
pIn1
));

68195 
OP_BôNŸ
: {

68196 
pIn1
 = &
aMem
[
pOp
->
p1
];

68197 
pOut
 = &
aMem
[
pOp
->
p2
];

68198 if–
pIn1
->
Êags
 & 
MEM_NuŒ
 ){

68199 
	`sqlôe3VdbeMemSëNuŒ
(
pOut
);

68201 
	`sqlôe3VdbeMemSëI¡64
(
pOut
, ~
	`sqlôe3VdbeI¡VÆue
(
pIn1
));

68211 
OP_On˚
: {

68212 
	`as£π
–
pOp
->
p1
<
p
->
nOn˚Fœg
 );

68213 if–
p
->
aOn˚Fœg
[
pOp
->
p1
] ){

68214 
pc
 = 
pOp
->
p2
-1;

68216 
p
->
aOn˚Fœg
[
pOp
->
p1
] = 1;

68233 
OP_If
:

68234 
OP_IfNŸ
: {

68236 
c
;

68238 
pIn1
 = &
aMem
[
pOp
->
p1
];

68239 if–
pIn1
->
Êags
 & 
MEM_NuŒ
 ){

68240 
u
.
™
.
c
 = 
pOp
->
p3
;

68242 #ifde‡
SQLITE_OMIT_FLOATING_POINT


68243 
u
.
™
.
c
 = 
	`sqlôe3VdbeI¡VÆue
(
pIn1
)!=0;

68245 
u
.
™
.
c
 = 
	`sqlôe3VdbeRólVÆue
(
pIn1
)!=0.0;

68247 if–
pOp
->
›code
==
OP_IfNŸ
 ) 
u
.
™
.
c
 = !u.an.c;

68249 if–
u
.
™
.
c
 ){

68250 
pc
 = 
pOp
->
p2
-1;

68259 
OP_IsNuŒ
: {

68260 
pIn1
 = &
aMem
[
pOp
->
p1
];

68261 if–(
pIn1
->
Êags
 & 
MEM_NuŒ
)!=0 ){

68262 
pc
 = 
pOp
->
p2
 - 1;

68271 
OP_NŸNuŒ
: {

68272 
pIn1
 = &
aMem
[
pOp
->
p1
];

68273 if–(
pIn1
->
Êags
 & 
MEM_NuŒ
)==0 ){

68274 
pc
 = 
pOp
->
p2
 - 1;

68303 
OP_Cﬁumn
: {

68305 
u32
 
∑ylﬂdSize
;

68306 
i64
 
∑ylﬂdSize64
;

68307 
p1
;

68308 
p2
;

68309 
VdbeCurs‹
 *
pC
;

68310 *
zRec
;

68311 
BtCurs‹
 *
pCr§
;

68312 
u32
 *
aTy≥
;

68313 
u32
 *
aOff£t
;

68314 
nFõld
;

68315 
Àn
;

68316 
i
;

68317 *
zD©a
;

68318 
Mem
 *
pDe°
;

68319 
Mem
 
sMem
;

68320 
u8
 *
zIdx
;

68321 
u8
 *
zEndHdr
;

68322 
u32
 
off£t
;

68323 
u32
 
szFõld
;

68324 
szHdr
;

68325 
avaû
;

68326 
u32
 
t
;

68327 
Mem
 *
pReg
;

68331 
u
.
ao
.
p1
 = 
pOp
->p1;

68332 
u
.
ao
.
p2
 = 
pOp
->p2;

68333 
u
.
ao
.
pC
 = 0;

68334 
	`mem£t
(&
u
.
ao
.
sMem
, 0, (u.ao.sMem));

68335 
	`as£π
–
u
.
ao
.
p1
<
p
->
nCurs‹
 );

68336 
	`as£π
–
pOp
->
p3
>0 &&ÖOp->p3<=(
p
->
nMem
-p->
nCurs‹
) );

68337 
u
.
ao
.
pDe°
 = &
aMem
[
pOp
->
p3
];

68338 
	`memAboutToCh™ge
(
p
, 
u
.
ao
.
pDe°
);

68339 
u
.
ao
.
zRec
 = 0;

68353 
u
.
ao
.
pC
 = 
p
->
≠C§
[u.ao.
p1
];

68354 
	`as£π
–
u
.
ao
.
pC
!=0 );

68355 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


68356 
	`as£π
–
u
.
ao
.
pC
->
pVèbCurs‹
==0 );

68358 
u
.
ao
.
pCr§
 = u.ao.
pC
->
pCurs‹
;

68359 if–
u
.
ao
.
pCr§
!=0 ){

68361 
rc
 = 
	`sqlôe3VdbeCurs‹Movëo
(
u
.
ao
.
pC
);

68362 if–
rc
 ) 
ab‹t_due_to_îr‹
;

68363 if–
u
.
ao
.
pC
->
nuŒRow
 ){

68364 
u
.
ao
.
∑ylﬂdSize
 = 0;

68365 }if–
u
.
ao
.
pC
->
ˇcheSètus
==
p
->
ˇcheCå
 ){

68366 
u
.
ao
.
∑ylﬂdSize
 = u.ao.
pC
->payloadSize;

68367 
u
.
ao
.
zRec
 = (*)u.ao.
pC
->
aRow
;

68368 }if–
u
.
ao
.
pC
->
isIndex
 ){

68369 
	`as£π
–
	`sqlôe3BåìCurs‹IsVÆid
(
u
.
ao
.
pCr§
) );

68370 
	`VVA_ONLY
(
rc
 =Ë
	`sqlôe3BåìKeySize
(
u
.
ao
.
pCr§
, &u.ao.
∑ylﬂdSize64
);

68371 
	`as£π
–
rc
==
SQLITE_OK
 );

68375 
	`as£π
–(
u
.
ao
.
∑ylﬂdSize64
 & 
SQLITE_MAX_U32
)==(
u64
)u.ao.payloadSize64 );

68376 
u
.
ao
.
∑ylﬂdSize
 = (
u32
)u.ao.
∑ylﬂdSize64
;

68378 
	`as£π
–
	`sqlôe3BåìCurs‹IsVÆid
(
u
.
ao
.
pCr§
) );

68379 
	`VVA_ONLY
(
rc
 =Ë
	`sqlôe3BåìD©aSize
(
u
.
ao
.
pCr§
, &u.ao.
∑ylﬂdSize
);

68380 
	`as£π
–
rc
==
SQLITE_OK
 );

68382 }if–
	`ALWAYS
(
u
.
ao
.
pC
->
p£udoTabÀReg
>0) ){

68383 
u
.
ao
.
pReg
 = &
aMem
[u.ao.
pC
->
p£udoTabÀReg
];

68384 if–
u
.
ao
.
pC
->
mu…iP£udo
 ){

68385 
	`sqlôe3VdbeMemShÆlowC›y
(
u
.
ao
.
pDe°
, u.ao.
pReg
+u.ao.
p2
, 
MEM_Ephem
);

68386 
	`DìphemîÆize
(
u
.
ao
.
pDe°
);

68387 
›_cﬁumn_out
;

68389 
	`as£π
–
u
.
ao
.
pReg
->
Êags
 & 
MEM_Blob
 );

68390 
	`as£π
–
	`memIsVÆid
(
u
.
ao
.
pReg
) );

68391 
u
.
ao
.
∑ylﬂdSize
 = u.ao.
pReg
->
n
;

68392 
u
.
ao
.
zRec
 = u.ao.
pReg
->
z
;

68393 
u
.
ao
.
pC
->
ˇcheSètus
 = (
pOp
->
p5
&
OPFLAG_CLEARCACHE
Ë? 
CACHE_STALE
 : 
p
->
ˇcheCå
;

68394 
	`as£π
–
u
.
ao
.
∑ylﬂdSize
==0 || u.ao.
zRec
!=0 );

68397 
u
.
ao
.
∑ylﬂdSize
 = 0;

68402 if–
u
.
ao
.
∑ylﬂdSize
==0 ){

68403 
	`MemSëTy≥Fœg
(
u
.
ao
.
pDe°
, 
MEM_NuŒ
);

68404 
›_cﬁumn_out
;

68406 
	`as£π
–
db
->
aLimô
[
SQLITE_LIMIT_LENGTH
]>=0 );

68407 if–
u
.
ao
.
∑ylﬂdSize
 > (
u32
)
db
->
aLimô
[
SQLITE_LIMIT_LENGTH
] ){

68408 
too_big
;

68411 
u
.
ao
.
nFõld
 = u.ao.
pC
->nField;

68412 
	`as£π
–
u
.
ao
.
p2
<u.ao.
nFõld
 );

68417 
u
.
ao
.
aTy≥
 = u.ao.
pC
->aType;

68418 if–
u
.
ao
.
pC
->
ˇcheSètus
==
p
->
ˇcheCå
 ){

68419 
u
.
ao
.
aOff£t
 = u.ao.
pC
->aOffset;

68421 
	`as£π
(
u
.
ao
.
aTy≥
);

68422 
u
.
ao
.
avaû
 = 0;

68423 
u
.
ao
.
pC
->
aOff£t
 = u.ao.aOff£à&u.ao.
aTy≥
[u.ao.
nFõld
];

68424 
u
.
ao
.
pC
->
∑ylﬂdSize
 = u.ao.payloadSize;

68425 
u
.
ao
.
pC
->
ˇcheSètus
 = 
p
->
ˇcheCå
;

68428 if–
u
.
ao
.
zRec
 ){

68429 
u
.
ao
.
zD©a
 = u.ao.
zRec
;

68431 if–
u
.
ao
.
pC
->
isIndex
 ){

68432 
u
.
ao
.
zD©a
 = (*)
	`sqlôe3BåìKeyFëch
(u.ao.
pCr§
, &u.ao.
avaû
);

68434 
u
.
ao
.
zD©a
 = (*)
	`sqlôe3BåìD©aFëch
(u.ao.
pCr§
, &u.ao.
avaû
);

68441 
	`as£π
–
u
.
ao
.
avaû
>=0 );

68442 if–
u
.
ao
.
∑ylﬂdSize
 <(
u32
)u.ao.
avaû
 ){

68443 
u
.
ao
.
zRec
 = u.ao.
zD©a
;

68444 
u
.
ao
.
pC
->
aRow
 = (
u8
*)u.ao.
zD©a
;

68446 
u
.
ao
.
pC
->
aRow
 = 0;

68452 
u
.
ao
.
szHdr
 = 
	`gëV¨öt32
((
u8
*)u.ao.
zD©a
, u.ao.
off£t
);

68463 if–
u
.
ao
.
off£t
 > 98307 ){

68464 
rc
 = 
SQLITE_CORRUPT_BKPT
;

68465 
›_cﬁumn_out
;

68481 
u
.
ao
.
Àn
 = u.ao.
nFõld
*5 + 3;

68482 if–
u
.
ao
.
Àn
 > ()u.ao.
off£t
 ) u.ao.len = ()u.ao.offset;

68490 if–!
u
.
ao
.
zRec
 && u.ao.
avaû
<u.ao.
Àn
 ){

68491 
u
.
ao
.
sMem
.
Êags
 = 0;

68492 
u
.
ao
.
sMem
.
db
 = 0;

68493 
rc
 = 
	`sqlôe3VdbeMemFromBåì
(
u
.
ao
.
pCr§
, 0, u.ao.
Àn
, u.ao.
pC
->
isIndex
, &u.ao.
sMem
);

68494 if–
rc
!=
SQLITE_OK
 ){

68495 
›_cﬁumn_out
;

68497 
u
.
ao
.
zD©a
 = u.ao.
sMem
.
z
;

68499 
u
.
ao
.
zEndHdr
 = (
u8
 *)&u.ao.
zD©a
[u.ao.
Àn
];

68500 
u
.
ao
.
zIdx
 = (
u8
 *)&u.ao.
zD©a
[u.ao.
szHdr
];

68507 
u
.
ao
.
i
=0; u.ao.i<u.ao.
nFõld
; u.ao.i++){

68508 if–
u
.
ao
.
zIdx
<u.ao.
zEndHdr
 ){

68509 
u
.
ao
.
aOff£t
[u.ao.
i
] = u.ao.
off£t
;

68510 if–
u
.
ao
.
zIdx
[0]<0x80 ){

68511 
u
.
ao
.
t
 = u.ao.
zIdx
[0];

68512 
u
.
ao
.
zIdx
++;

68514 
u
.
ao
.
zIdx
 +
	`sqlôe3GëV¨öt32
(u.ao.zIdx, &u.ao.
t
);

68516 
u
.
ao
.
aTy≥
[u.ao.
i
] = u.ao.
t
;

68517 
u
.
ao
.
szFõld
 = 
	`sqlôe3VdbeSîülTy≥Lí
(u.ao.
t
);

68518 
u
.
ao
.
off£t
 +u.ao.
szFõld
;

68519 if–
u
.
ao
.
off£t
<u.ao.
szFõld
 ){

68520 
u
.
ao
.
zIdx
 = &u.ao.
zEndHdr
[1];

68530 
u
.
ao
.
aOff£t
[u.ao.
i
] = 0;

68533 
	`sqlôe3VdbeMemRñó£
(&
u
.
ao
.
sMem
);

68534 
u
.
ao
.
sMem
.
Êags
 = 
MEM_NuŒ
;

68542 if–(
u
.
ao
.
zIdx
 > u.ao.
zEndHdr
Ë|| (u.ao.
off£t
 > u.ao.
∑ylﬂdSize
)

68543 || (
u
.
ao
.
zIdx
==u.ao.
zEndHdr
 && u.ao.
off£t
!=u.ao.
∑ylﬂdSize
) ){

68544 
rc
 = 
SQLITE_CORRUPT_BKPT
;

68545 
›_cﬁumn_out
;

68555 if–
u
.
ao
.
aOff£t
[u.ao.
p2
] ){

68556 
	`as£π
–
rc
==
SQLITE_OK
 );

68557 if–
u
.
ao
.
zRec
 ){

68559 
	`VdbeMemRñó£
(
u
.
ao
.
pDe°
);

68560 
	`sqlôe3VdbeSîülGë
((
u8
 *)&
u
.
ao
.
zRec
[u.ao.
aOff£t
[u.ao.
p2
]], u.ao.
aTy≥
[u.ao.p2], u.ao.
pDe°
);

68563 
u
.
ao
.
t
 = u.ao.
aTy≥
[u.ao.
p2
];

68564 if–(
pOp
->
p5
 & (
OPFLAG_LENGTHARG
|
OPFLAG_TYPEOFARG
))!=0

68565 && ((
u
.
ao
.
t
>=12 && (u.ao.t&1)==0Ë|| (
pOp
->
p5
 & 
OPFLAG_TYPEOFARG
)!=0)

68572 
u
.
ao
.
zD©a
 = u.ao.
t
<12 ? (*)&u.ao.
∑ylﬂdSize64
 : 0;

68574 
u
.
ao
.
Àn
 = 
	`sqlôe3VdbeSîülTy≥Lí
(u.ao.
t
);

68575 
	`sqlôe3VdbeMemMove
(&
u
.
ao
.
sMem
, u.ao.
pDe°
);

68576 
rc
 = 
	`sqlôe3VdbeMemFromBåì
(
u
.
ao
.
pCr§
, u.ao.
aOff£t
[u.ao.
p2
], u.ao.
Àn
, u.ao.
pC
->
isIndex
,

68577 &
u
.
ao
.
sMem
);

68578 if–
rc
!=
SQLITE_OK
 ){

68579 
›_cﬁumn_out
;

68581 
u
.
ao
.
zD©a
 = u.ao.
sMem
.
z
;

68583 
	`sqlôe3VdbeSîülGë
((
u8
*)
u
.
ao
.
zD©a
, u.ao.
t
, u.ao.
pDe°
);

68585 
u
.
ao
.
pDe°
->
íc
 = 
ícodög
;

68587 if–
pOp
->
p4ty≥
==
P4_MEM
 ){

68588 
	`sqlôe3VdbeMemShÆlowC›y
(
u
.
ao
.
pDe°
, 
pOp
->
p4
.
pMem
, 
MEM_Sètic
);

68590 
	`MemSëTy≥Fœg
(
u
.
ao
.
pDe°
, 
MEM_NuŒ
);

68599 if–
u
.
ao
.
sMem
.
zMÆloc
 ){

68600 
	`as£π
–
u
.
ao
.
sMem
.
z
==u.ao.sMem.
zMÆloc
 );

68601 
	`as£π
–!(
u
.
ao
.
pDe°
->
Êags
 & 
MEM_Dyn
) );

68602 
	`as£π
–!(
u
.
ao
.
pDe°
->
Êags
 & (
MEM_Blob
|
MEM_Så
)Ë|| u.ao.pDe°->
z
==u.ao.
sMem
.z );

68603 
u
.
ao
.
pDe°
->
Êags
 &~(
MEM_Ephem
|
MEM_Sètic
);

68604 
u
.
ao
.
pDe°
->
Êags
 |
MEM_Tîm
;

68605 
u
.
ao
.
pDe°
->
z
 = u.ao.
sMem
.z;

68606 
u
.
ao
.
pDe°
->
zMÆloc
 = u.ao.
sMem
.zMalloc;

68609 
rc
 = 
	`sqlôe3VdbeMemMakeWrôóbÀ
(
u
.
ao
.
pDe°
);

68611 
›_cﬁumn_out
:

68612 
	`UPDATE_MAX_BLOBSIZE
(
u
.
ao
.
pDe°
);

68613 
	`REGISTER_TRACE
(
pOp
->
p3
, 
u
.
ao
.
pDe°
);

68625 
OP_Afföôy
: {

68627 c⁄° *
zAfföôy
;

68628 
cAff
;

68631 
u
.
≠
.
zAfföôy
 = 
pOp
->
p4
.
z
;

68632 
	`as£π
–
u
.
≠
.
zAfföôy
!=0 );

68633 
	`as£π
–
u
.
≠
.
zAfföôy
[
pOp
->
p2
]==0 );

68634 
pIn1
 = &
aMem
[
pOp
->
p1
];

68635  (
u
.
≠
.
cAff
 = *(u.≠.
zAfföôy
++))!=0 ){

68636 
	`as£π
–
pIn1
 <&
p
->
aMem
[’->
nMem
-p->
nCurs‹
)] );

68637 
	`as£π
–
	`memIsVÆid
(
pIn1
) );

68638 
	`Ex∑ndBlob
(
pIn1
);

68639 
	`≠∂yAfföôy
(
pIn1
, 
u
.
≠
.
cAff
, 
ícodög
);

68640 
pIn1
++;

68660 
OP_MakeRec‹d
: {

68662 
u8
 *
zNewRec‹d
;

68663 
Mem
 *
pRec
;

68664 
u64
 
nD©a
;

68665 
nHdr
;

68666 
i64
 
nByã
;

68667 
nZîo
;

68668 
nV¨öt
;

68669 
u32
 
£rül_ty≥
;

68670 
Mem
 *
pD©a0
;

68671 
Mem
 *
pLa°
;

68672 
nFõld
;

68673 *
zAfföôy
;

68674 
fûe_f‹m©
;

68675 
i
;

68676 
Àn
;

68694 
u
.
aq
.
nD©a
 = 0;

68695 
u
.
aq
.
nHdr
 = 0;

68696 
u
.
aq
.
nZîo
 = 0;

68697 
u
.
aq
.
nFõld
 = 
pOp
->
p1
;

68698 
u
.
aq
.
zAfföôy
 = 
pOp
->
p4
.
z
;

68699 
	`as£π
–
u
.
aq
.
nFõld
>0 && 
pOp
->
p2
>0 &&ÖOp->p2+u.aq.nFõld<=(
p
->
nMem
-p->
nCurs‹
)+1 );

68700 
u
.
aq
.
pD©a0
 = &
aMem
[u.aq.
nFõld
];

68701 
u
.
aq
.
nFõld
 = 
pOp
->
p2
;

68702 
u
.
aq
.
pLa°
 = &u.aq.
pD©a0
[u.aq.
nFõld
-1];

68703 
u
.
aq
.
fûe_f‹m©
 = 
p
->
möWrôeFûeF‹m©
;

68706 
	`as£π
–
pOp
->
p3
<pOp->
p1
 ||ÖOp->p3>ıOp->p1+pOp->
p2
 );

68707 
pOut
 = &
aMem
[
pOp
->
p3
];

68708 
	`memAboutToCh™ge
(
p
, 
pOut
);

68713 
u
.
aq
.
pRec
=u.aq.
pD©a0
; u.aq.pRec<=u.aq.
pLa°
; u.aq.pRec++){

68714 
	`as£π
–
	`memIsVÆid
(
u
.
aq
.
pRec
) );

68715 if–
u
.
aq
.
zAfföôy
 ){

68716 
	`≠∂yAfföôy
(
u
.
aq
.
pRec
, u.aq.
zAfföôy
[u.aq.pRec-u.aq.
pD©a0
], 
ícodög
);

68718 if–
u
.
aq
.
pRec
->
Êags
&
MEM_Zîo
 && u.aq.pRec->
n
>0 ){

68719 
	`sqlôe3VdbeMemEx∑ndBlob
(
u
.
aq
.
pRec
);

68721 
u
.
aq
.
£rül_ty≥
 = 
	`sqlôe3VdbeSîülTy≥
(u.aq.
pRec
, u.aq.
fûe_f‹m©
);

68722 
u
.
aq
.
Àn
 = 
	`sqlôe3VdbeSîülTy≥Lí
(u.aq.
£rül_ty≥
);

68723 
u
.
aq
.
nD©a
 +u.aq.
Àn
;

68724 
u
.
aq
.
nHdr
 +
	`sqlôe3V¨ötLí
(u.aq.
£rül_ty≥
);

68725 if–
u
.
aq
.
pRec
->
Êags
 & 
MEM_Zîo
 ){

68728 
u
.
aq
.
nZîo
 +u.aq.
pRec
->u.nZero;

68729 }if–
u
.
aq
.
Àn
 ){

68730 
u
.
aq
.
nZîo
 = 0;

68735 
u
.
aq
.
nHdr
 +u.aq.
nV¨öt
 = 
	`sqlôe3V¨ötLí
(u.aq.nHdr);

68736 if–
u
.
aq
.
nV¨öt
<
	`sqlôe3V¨ötLí
(u.aq.
nHdr
) ){

68737 
u
.
aq
.
nHdr
++;

68739 
u
.
aq
.
nByã
 = u.aq.
nHdr
+u.aq.
nD©a
-u.aq.
nZîo
;

68740 if–
u
.
aq
.
nByã
>
db
->
aLimô
[
SQLITE_LIMIT_LENGTH
] ){

68741 
too_big
;

68749 if–
	`sqlôe3VdbeMemGrow
(
pOut
, ()
u
.
aq
.
nByã
, 0) ){

68750 
no_mem
;

68752 
u
.
aq
.
zNewRec‹d
 = (
u8
 *)
pOut
->
z
;

68755 
u
.
aq
.
i
 = 
	`putV¨öt32
(u.aq.
zNewRec‹d
, u.aq.
nHdr
);

68756 
u
.
aq
.
pRec
=u.aq.
pD©a0
; u.aq.pRec<=u.aq.
pLa°
; u.aq.pRec++){

68757 
u
.
aq
.
£rül_ty≥
 = 
	`sqlôe3VdbeSîülTy≥
(u.aq.
pRec
, u.aq.
fûe_f‹m©
);

68758 
u
.
aq
.
i
 +
	`putV¨öt32
(&u.aq.
zNewRec‹d
[u.aq.i], u.aq.
£rül_ty≥
);

68760 
u
.
aq
.
pRec
=u.aq.
pD©a0
; u.aq.pRec<=u.aq.
pLa°
; u.aq.pRec++){

68761 
u
.
aq
.
i
 +
	`sqlôe3VdbeSîülPut
(&u.aq.
zNewRec‹d
[u.aq.i], ()(u.aq.
nByã
-u.aq.i), u.aq.
pRec
,u.aq.
fûe_f‹m©
);

68763 
	`as£π
–
u
.
aq
.
i
==u.aq.
nByã
 );

68765 
	`as£π
–
pOp
->
p3
>0 &&ÖOp->p3<=(
p
->
nMem
-p->
nCurs‹
) );

68766 
pOut
->
n
 = ()
u
.
aq
.
nByã
;

68767 
pOut
->
Êags
 = 
MEM_Blob
 | 
MEM_Dyn
;

68768 
pOut
->
xDñ
 = 0;

68769 if–
u
.
aq
.
nZîo
 ){

68770 
pOut
->
u
.
nZîo
 = u.
aq
.nZero;

68771 
pOut
->
Êags
 |
MEM_Zîo
;

68773 
pOut
->
íc
 = 
SQLITE_UTF8
;

68774 
	`REGISTER_TRACE
(
pOp
->
p3
, 
pOut
);

68775 
	`UPDATE_MAX_BLOBSIZE
(
pOut
);

68784 #i‚de‡
SQLITE_OMIT_BTREECOUNT


68785 
OP_Cou¡
: {

68787 
i64
 
nE¡ry
;

68788 
BtCurs‹
 *
pCr§
;

68791 
u
.
¨
.
pCr§
 = 
p
->
≠C§
[
pOp
->
p1
]->
pCurs‹
;

68792 if–
	`ALWAYS
(
u
.
¨
.
pCr§
) ){

68793 
rc
 = 
	`sqlôe3BåìCou¡
(
u
.
¨
.
pCr§
, &u.¨.
nE¡ry
);

68795 
u
.
¨
.
nE¡ry
 = 0;

68797 
pOut
->
u
.
i
 = u.
¨
.
nE¡ry
;

68808 
OP_Savïoöt
: {

68810 
p1
;

68811 *
zName
;

68812 
nName
;

68813 
Savïoöt
 *
pNew
;

68814 
Savïoöt
 *
pSavïoöt
;

68815 
Savïoöt
 *
pTmp
;

68816 
iSavïoöt
;

68817 
ii
;

68820 
u
.
as
.
p1
 = 
pOp
->p1;

68821 
u
.
as
.
zName
 = 
pOp
->
p4
.
z
;

68826 
	`as£π
–
db
->
pSavïoöt
==0 || db->
autoCommô
==0 );

68827 
	`as£π
–
u
.
as
.
p1
==
SAVEPOINT_BEGIN
||u.as.p1==
SAVEPOINT_RELEASE
||u.as.p1==
SAVEPOINT_ROLLBACK
 );

68828 
	`as£π
–
db
->
pSavïoöt
 || db->
isTønß˘i⁄Savïoöt
==0 );

68829 
	`as£π
–
	`checkSavïoötCou¡
(
db
) );

68830 
	`as£π
–
p
->
bIsRódî
 );

68832 if–
u
.
as
.
p1
==
SAVEPOINT_BEGIN
 ){

68833 if–
db
->
nVdbeWrôe
>0 ){

68837 
	`sqlôe3SëSåög
(&
p
->
zEºMsg
, 
db
, "cannot open savepoint - "

68839 
rc
 = 
SQLITE_BUSY
;

68841 
u
.
as
.
nName
 = 
	`sqlôe3SåÀn30
(u.as.
zName
);

68843 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


68848 
	`as£π
–
db
->
autoCommô
==0 || db->
nVTøns
==0 );

68849 
rc
 = 
	`sqlôe3VèbSavïoöt
(
db
, 
SAVEPOINT_BEGIN
,

68850 
db
->
nSèãmít
+db->
nSavïoöt
);

68851 if–
rc
!=
SQLITE_OK
 ) 
ab‹t_due_to_îr‹
;

68855 
u
.
as
.
pNew
 = 
	`sqlôe3DbMÆlocRaw
(
db
, (
Savïoöt
)+u.as.
nName
+1);

68856 if–
u
.
as
.
pNew
 ){

68857 
u
.
as
.
pNew
->
zName
 = (*)&u.as.pNew[1];

68858 
	`mem˝y
(
u
.
as
.
pNew
->
zName
, u.as.zName, u.as.
nName
+1);

68862 if–
db
->
autoCommô
 ){

68863 
db
->
autoCommô
 = 0;

68864 
db
->
isTønß˘i⁄Savïoöt
 = 1;

68866 
db
->
nSavïoöt
++;

68870 
u
.
as
.
pNew
->
pNext
 = 
db
->
pSavïoöt
;

68871 
db
->
pSavïoöt
 = 
u
.
as
.
pNew
;

68872 
u
.
as
.
pNew
->
nDe„ºedC⁄s
 = 
db
->nDeferredCons;

68873 
u
.
as
.
pNew
->
nDe„ºedImmC⁄s
 = 
db
->nDeferredImmCons;

68877 
u
.
as
.
iSavïoöt
 = 0;

68882 
u
.
as
.
pSavïoöt
 = 
db
->pSavepoint;

68883 
u
.
as
.
pSavïoöt
 && 
	`sqlôe3SåICmp
(u.as.pSavïoöt->
zName
, u.as.zName);

68884 
u
.
as
.
pSavïoöt
 = u.as.pSavïoöt->
pNext


68886 
u
.
as
.
iSavïoöt
++;

68888 if–!
u
.
as
.
pSavïoöt
 ){

68889 
	`sqlôe3SëSåög
(&
p
->
zEºMsg
, 
db
, "nÿsuch savïoöt: %s", 
u
.
as
.
zName
);

68890 
rc
 = 
SQLITE_ERROR
;

68891 }if–
db
->
nVdbeWrôe
>0 && 
u
.
as
.
p1
==
SAVEPOINT_RELEASE
 ){

68895 
	`sqlôe3SëSåög
(&
p
->
zEºMsg
, 
db
,

68898 
rc
 = 
SQLITE_BUSY
;

68905 
isTønß˘i⁄
 = 
u
.
as
.
pSavïoöt
->
pNext
==0 && 
db
->
isTønß˘i⁄Savïoöt
;

68906 if–
isTønß˘i⁄
 && 
u
.
as
.
p1
==
SAVEPOINT_RELEASE
 ){

68907 if–(
rc
 = 
	`sqlôe3VdbeCheckFk
(
p
, 1))!=
SQLITE_OK
 ){

68908 
vdbe_ªtu∫
;

68910 
db
->
autoCommô
 = 1;

68911 if–
	`sqlôe3VdbeHÆt
(
p
)==
SQLITE_BUSY
 ){

68912 
p
->
pc
 =Öc;

68913 
db
->
autoCommô
 = 0;

68914 
p
->
rc
 =Ñ¯
SQLITE_BUSY
;

68915 
vdbe_ªtu∫
;

68917 
db
->
isTønß˘i⁄Savïoöt
 = 0;

68918 
rc
 = 
p
->rc;

68920 
u
.
as
.
iSavïoöt
 = 
db
->
nSavïoöt
 - u.as.iSavepoint - 1;

68921 if–
u
.
as
.
p1
==
SAVEPOINT_ROLLBACK
 ){

68922 
u
.
as
.
ii
=0; u.as.ii<
db
->
nDb
; u.as.ii++){

68923 
	`sqlôe3BåìTrùAŒCurs‹s
(
db
->
aDb
[
u
.
as
.
ii
].
pBt
, 
SQLITE_ABORT
);

68926 
u
.
as
.
ii
=0; u.as.ii<
db
->
nDb
; u.as.ii++){

68927 
rc
 = 
	`sqlôe3BåìSavïoöt
(
db
->
aDb
[
u
.
as
.
ii
].
pBt
, u.as.
p1
, u.as.
iSavïoöt
);

68928 if–
rc
!=
SQLITE_OK
 ){

68929 
ab‹t_due_to_îr‹
;

68932 if–
u
.
as
.
p1
==
SAVEPOINT_ROLLBACK
 && (
db
->
Êags
&
SQLITE_I¡înCh™ges
)!=0 ){

68933 
	`sqlôe3ExpúePª∑ªdSèãmíts
(
db
);

68934 
	`sqlôe3Re£tAŒSchemasOfC⁄√˘i⁄
(
db
);

68935 
db
->
Êags
 = (db->Êag†| 
SQLITE_I¡înCh™ges
);

68941  
db
->
pSavïoöt
!=
u
.
as
.pSavepoint ){

68942 
u
.
as
.
pTmp
 = 
db
->
pSavïoöt
;

68943 
db
->
pSavïoöt
 = 
u
.
as
.
pTmp
->
pNext
;

68944 
	`sqlôe3DbFªe
(
db
, 
u
.
as
.
pTmp
);

68945 
db
->
nSavïoöt
--;

68952 if–
u
.
as
.
p1
==
SAVEPOINT_RELEASE
 ){

68953 
	`as£π
–
u
.
as
.
pSavïoöt
==
db
->pSavepoint );

68954 
db
->
pSavïoöt
 = 
u
.
as
.pSavïoöt->
pNext
;

68955 
	`sqlôe3DbFªe
(
db
, 
u
.
as
.
pSavïoöt
);

68956 if–!
isTønß˘i⁄
 ){

68957 
db
->
nSavïoöt
--;

68960 
db
->
nDe„ºedC⁄s
 = 
u
.
as
.
pSavïoöt
->nDeferredCons;

68961 
db
->
nDe„ºedImmC⁄s
 = 
u
.
as
.
pSavïoöt
->nDeferredImmCons;

68964 if–!
isTønß˘i⁄
 ){

68965 
rc
 = 
	`sqlôe3VèbSavïoöt
(
db
, 
u
.
as
.
p1
, u.as.
iSavïoöt
);

68966 if–
rc
!=
SQLITE_OK
 ) 
ab‹t_due_to_îr‹
;

68983 
OP_AutoCommô
: {

68985 
desúedAutoCommô
;

68986 
iRﬁlback
;

68987 
tu∫OnAC
;

68990 
u
.
©
.
desúedAutoCommô
 = 
pOp
->
p1
;

68991 
u
.
©
.
iRﬁlback
 = 
pOp
->
p2
;

68992 
u
.
©
.
tu∫OnAC
 = u.©.
desúedAutoCommô
 && !
db
->
autoCommô
;

68993 
	`as£π
–
u
.
©
.
desúedAutoCommô
==1 || u.at.desiredAutoCommit==0 );

68994 
	`as£π
–
u
.
©
.
desúedAutoCommô
==1 || u.©.
iRﬁlback
==0 );

68995 
	`as£π
–
db
->
nVdbeA˘ive
>0 );

68996 
	`as£π
–
p
->
bIsRódî
 );

68999 if–
u
.
©
.
tu∫OnAC
 && u.©.
iRﬁlback
 && 
db
->
nVdbeA˘ive
>1 ){

69004 
	`sqlôe3SëSåög
(&
p
->
zEºMsg
, 
db
, "cannotÑollbackÅransaction - "

69006 
rc
 = 
SQLITE_BUSY
;

69009 if–
u
.
©
.
tu∫OnAC
 && !u.©.
iRﬁlback
 && 
db
->
nVdbeWrôe
>0 ){

69013 
	`sqlôe3SëSåög
(&
p
->
zEºMsg
, 
db
, "cannot commitÅransaction - "

69015 
rc
 = 
SQLITE_BUSY
;

69016 }if–
u
.
©
.
desúedAutoCommô
!=
db
->
autoCommô
 ){

69017 if–
u
.
©
.
iRﬁlback
 ){

69018 
	`as£π
–
u
.
©
.
desúedAutoCommô
==1 );

69019 
	`sqlôe3RﬁlbackAŒ
(
db
, 
SQLITE_ABORT_ROLLBACK
);

69020 
db
->
autoCommô
 = 1;

69021 }if–(
rc
 = 
	`sqlôe3VdbeCheckFk
(
p
, 1))!=
SQLITE_OK
 ){

69022 
vdbe_ªtu∫
;

69024 
db
->
autoCommô
 = (
u8
)
u
.
©
.
desúedAutoCommô
;

69025 if–
	`sqlôe3VdbeHÆt
(
p
)==
SQLITE_BUSY
 ){

69026 
p
->
pc
 =Öc;

69027 
db
->
autoCommô
 = (
u8
)(1-
u
.
©
.
desúedAutoCommô
);

69028 
p
->
rc
 =Ñ¯
SQLITE_BUSY
;

69029 
vdbe_ªtu∫
;

69032 
	`as£π
–
db
->
nSèãmít
==0 );

69033 
	`sqlôe3Clo£Savïoöts
(
db
);

69034 if–
p
->
rc
==
SQLITE_OK
 ){

69035 
rc
 = 
SQLITE_DONE
;

69037 
rc
 = 
SQLITE_ERROR
;

69039 
vdbe_ªtu∫
;

69041 
	`sqlôe3SëSåög
(&
p
->
zEºMsg
, 
db
,

69042 (!
u
.
©
.
desúedAutoCommô
)?"cannot startáÅransaction withináÅransaction":(

69043 (
u
.
©
.
iRﬁlback
)?"cannotÑollback -ÇoÅransaction isáctive":

69046 
rc
 = 
SQLITE_ERROR
;

69082 
OP_Tønß˘i⁄
: {

69084 
Båì
 *
pBt
;

69087 
	`as£π
–
p
->
bIsRódî
 );

69088 
	`as£π
–
p
->
ªadO∆y
==0 || 
pOp
->
p2
==0 );

69089 
	`as£π
–
pOp
->
p1
>=0 &&ÖOp->p1<
db
->
nDb
 );

69090 
	`as£π
–(
p
->
båìMask
 & (((
yDbMask
)1)<<
pOp
->
p1
))!=0 );

69091 if–
pOp
->
p2
 && (
db
->
Êags
 & 
SQLITE_QuîyO∆y
)!=0 ){

69092 
rc
 = 
SQLITE_READONLY
;

69093 
ab‹t_due_to_îr‹
;

69095 
u
.
au
.
pBt
 = 
db
->
aDb
[
pOp
->
p1
].pBt;

69097 if–
u
.
au
.
pBt
 ){

69098 
rc
 = 
	`sqlôe3BåìBegöTøns
(
u
.
au
.
pBt
, 
pOp
->
p2
);

69099 if–
rc
==
SQLITE_BUSY
 ){

69100 
p
->
pc
 =Öc;

69101 
p
->
rc
 =Ñ¯
SQLITE_BUSY
;

69102 
vdbe_ªtu∫
;

69104 if–
rc
!=
SQLITE_OK
 ){

69105 
ab‹t_due_to_îr‹
;

69108 if–
pOp
->
p2
 && 
p
->
u£sStmtJou∫Æ


69109 && (
db
->
autoCommô
==0 || db->
nVdbeRód
>1)

69111 
	`as£π
–
	`sqlôe3BåìIsInTøns
(
u
.
au
.
pBt
) );

69112 if–
p
->
iSèãmít
==0 ){

69113 
	`as£π
–
db
->
nSèãmít
>=0 && db->
nSavïoöt
>=0 );

69114 
db
->
nSèãmít
++;

69115 
p
->
iSèãmít
 = 
db
->
nSavïoöt
 + db->
nSèãmít
;

69118 
rc
 = 
	`sqlôe3VèbSavïoöt
(
db
, 
SAVEPOINT_BEGIN
, 
p
->
iSèãmít
-1);

69119 if–
rc
==
SQLITE_OK
 ){

69120 
rc
 = 
	`sqlôe3BåìBegöStmt
(
u
.
au
.
pBt
, 
p
->
iSèãmít
);

69126 
p
->
nStmtDefC⁄s
 = 
db
->
nDe„ºedC⁄s
;

69127 
p
->
nStmtDefImmC⁄s
 = 
db
->
nDe„ºedImmC⁄s
;

69145 
OP_RódCookõ
: {

69147 
iMëa
;

69148 
iDb
;

69149 
iCookõ
;

69152 
	`as£π
–
p
->
bIsRódî
 );

69153 
u
.
av
.
iDb
 = 
pOp
->
p1
;

69154 
u
.
av
.
iCookõ
 = 
pOp
->
p3
;

69155 
	`as£π
–
pOp
->
p3
<
SQLITE_N_BTREE_META
 );

69156 
	`as£π
–
u
.
av
.
iDb
>=0 && u.av.iDb<
db
->
nDb
 );

69157 
	`as£π
–
db
->
aDb
[
u
.
av
.
iDb
].
pBt
!=0 );

69158 
	`as£π
–(
p
->
båìMask
 & (((
yDbMask
)1)<<
u
.
av
.
iDb
))!=0 );

69160 
	`sqlôe3BåìGëMëa
(
db
->
aDb
[
u
.
av
.
iDb
].
pBt
, u.av.
iCookõ
, (
u32
 *)&u.av.
iMëa
);

69161 
pOut
->
u
.
i
 = u.
av
.
iMëa
;

69175 
OP_SëCookõ
: {

69177 
Db
 *
pDb
;

69179 
	`as£π
–
pOp
->
p2
<
SQLITE_N_BTREE_META
 );

69180 
	`as£π
–
pOp
->
p1
>=0 &&ÖOp->p1<
db
->
nDb
 );

69181 
	`as£π
–(
p
->
båìMask
 & (((
yDbMask
)1)<<
pOp
->
p1
))!=0 );

69182 
	`as£π
–
p
->
ªadO∆y
==0 );

69183 
u
.
aw
.
pDb
 = &
db
->
aDb
[
pOp
->
p1
];

69184 
	`as£π
–
u
.
aw
.
pDb
->
pBt
!=0 );

69185 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 
pOp
->
p1
, 0) );

69186 
pIn3
 = &
aMem
[
pOp
->
p3
];

69187 
	`sqlôe3VdbeMemI¡egîify
(
pIn3
);

69189 
rc
 = 
	`sqlôe3BåìUpd©eMëa
(
u
.
aw
.
pDb
->
pBt
, 
pOp
->
p2
, ()
pIn3
->u.
i
);

69190 if–
pOp
->
p2
==
BTREE_SCHEMA_VERSION
 ){

69192 
u
.
aw
.
pDb
->
pSchema
->
schema_cookõ
 = ()
pIn3
->u.
i
;

69193 
db
->
Êags
 |
SQLITE_I¡înCh™ges
;

69194 }if–
pOp
->
p2
==
BTREE_FILE_FORMAT
 ){

69196 
u
.
aw
.
pDb
->
pSchema
->
fûe_f‹m©
 = (
u8
)
pIn3
->u.
i
;

69198 if–
pOp
->
p1
==1 ){

69201 
	`sqlôe3ExpúePª∑ªdSèãmíts
(
db
);

69202 
p
->
expúed
 = 0;

69225 
OP_VîifyCookõ
: {

69227 
iMëa
;

69228 
iGí
;

69229 
Båì
 *
pBt
;

69232 
	`as£π
–
pOp
->
p1
>=0 &&ÖOp->p1<
db
->
nDb
 );

69233 
	`as£π
–(
p
->
båìMask
 & (((
yDbMask
)1)<<
pOp
->
p1
))!=0 );

69234 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 
pOp
->
p1
, 0) );

69235 
	`as£π
–
p
->
bIsRódî
 );

69236 
u
.
ax
.
pBt
 = 
db
->
aDb
[
pOp
->
p1
].pBt;

69237 if–
u
.
ax
.
pBt
 ){

69238 
	`sqlôe3BåìGëMëa
(
u
.
ax
.
pBt
, 
BTREE_SCHEMA_VERSION
, (
u32
 *)&u.ax.
iMëa
);

69239 
u
.
ax
.
iGí
 = 
db
->
aDb
[
pOp
->
p1
].
pSchema
->
iGíî©i⁄
;

69241 
u
.
ax
.
iGí
 = u.ax.
iMëa
 = 0;

69243 if–
u
.
ax
.
iMëa
!=
pOp
->
p2
 || u.ax.
iGí
!ıOp->
p3
 ){

69244 
	`sqlôe3DbFªe
(
db
, 
p
->
zEºMsg
);

69245 
p
->
zEºMsg
 = 
	`sqlôe3DbSåDup
(
db
, "database schema has changed");

69259 if–
db
->
aDb
[
pOp
->
p1
].
pSchema
->
schema_cookõ
!=
u
.
ax
.
iMëa
 ){

69260 
	`sqlôe3Re£tO√Schema
(
db
, 
pOp
->
p1
);

69263 
p
->
expúed
 = 1;

69264 
rc
 = 
SQLITE_SCHEMA
;

69318 
OP_O≥nRód
:

69319 
OP_O≥nWrôe
: {

69321 
nFõld
;

69322 
KeyInfo
 *
pKeyInfo
;

69323 
p2
;

69324 
iDb
;

69325 
wrFœg
;

69326 
Båì
 *
pX
;

69327 
VdbeCurs‹
 *
pCur
;

69328 
Db
 *
pDb
;

69331 
	`as£π
–(
pOp
->
p5
&(
OPFLAG_P2ISREG
|
OPFLAG_BULKCSR
))==pOp->p5 );

69332 
	`as£π
–
pOp
->
›code
==
OP_O≥nWrôe
 ||ÖOp->
p5
==0 );

69333 
	`as£π
–
p
->
bIsRódî
 );

69334 
	`as£π
–
pOp
->
›code
==
OP_O≥nRód
 || 
p
->
ªadO∆y
==0 );

69336 if–
p
->
expúed
 ){

69337 
rc
 = 
SQLITE_ABORT
;

69341 
u
.
ay
.
nFõld
 = 0;

69342 
u
.
ay
.
pKeyInfo
 = 0;

69343 
u
.
ay
.
p2
 = 
pOp
->p2;

69344 
u
.
ay
.
iDb
 = 
pOp
->
p3
;

69345 
	`as£π
–
u
.
ay
.
iDb
>=0 && u.ay.iDb<
db
->
nDb
 );

69346 
	`as£π
–(
p
->
båìMask
 & (((
yDbMask
)1)<<
u
.
ay
.
iDb
))!=0 );

69347 
u
.
ay
.
pDb
 = &
db
->
aDb
[u.ay.
iDb
];

69348 
u
.
ay
.
pX
 = u.ay.
pDb
->
pBt
;

69349 
	`as£π
–
u
.
ay
.
pX
!=0 );

69350 if–
pOp
->
›code
==
OP_O≥nWrôe
 ){

69351 
u
.
ay
.
wrFœg
 = 1;

69352 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 
u
.
ay
.
iDb
, 0) );

69353 if–
u
.
ay
.
pDb
->
pSchema
->
fûe_f‹m©
 < 
p
->
möWrôeFûeF‹m©
 ){

69354 
p
->
möWrôeFûeF‹m©
 = 
u
.
ay
.
pDb
->
pSchema
->
fûe_f‹m©
;

69357 
u
.
ay
.
wrFœg
 = 0;

69359 if–
pOp
->
p5
 & 
OPFLAG_P2ISREG
 ){

69360 
	`as£π
–
u
.
ay
.
p2
>0 );

69361 
	`as£π
–
u
.
ay
.
p2
<=(
p
->
nMem
-p->
nCurs‹
) );

69362 
pIn2
 = &
aMem
[
u
.
ay
.
p2
];

69363 
	`as£π
–
	`memIsVÆid
(
pIn2
) );

69364 
	`as£π
–(
pIn2
->
Êags
 & 
MEM_I¡
)!=0 );

69365 
	`sqlôe3VdbeMemI¡egîify
(
pIn2
);

69366 
u
.
ay
.
p2
 = ()
pIn2
->u.
i
;

69371 if–
	`NEVER
(
u
.
ay
.
p2
<2) ) {

69372 
rc
 = 
SQLITE_CORRUPT_BKPT
;

69373 
ab‹t_due_to_îr‹
;

69376 if–
pOp
->
p4ty≥
==
P4_KEYINFO
 ){

69377 
u
.
ay
.
pKeyInfo
 = 
pOp
->
p4
.pKeyInfo;

69378 
u
.
ay
.
pKeyInfo
->
íc
 = 
	`ENC
(
p
->
db
);

69379 
u
.
ay
.
nFõld
 = u.ay.
pKeyInfo
->nField+1;

69380 }if–
pOp
->
p4ty≥
==
P4_INT32
 ){

69381 
u
.
ay
.
nFõld
 = 
pOp
->
p4
.
i
;

69383 
	`as£π
–
pOp
->
p1
>=0 );

69384 
u
.
ay
.
pCur
 = 
	`ÆloˇãCurs‹
(
p
, 
pOp
->
p1
, u.ay.
nFõld
, u.ay.
iDb
, 1);

69385 if–
u
.
ay
.
pCur
==0 ) 
no_mem
;

69386 
u
.
ay
.
pCur
->
nuŒRow
 = 1;

69387 
u
.
ay
.
pCur
->
isOrdîed
 = 1;

69388 
rc
 = 
	`sqlôe3BåìCurs‹
(
u
.
ay
.
pX
, u.ay.
p2
, u.ay.
wrFœg
, u.ay.
pKeyInfo
, u.ay.
pCur
->
pCurs‹
);

69389 
u
.
ay
.
pCur
->
pKeyInfo
 = u.ay.pKeyInfo;

69390 
	`as£π
–
OPFLAG_BULKCSR
==
BTREE_BULKLOAD
 );

69391 
	`sqlôe3BåìCurs‹Höts
(
u
.
ay
.
pCur
->
pCurs‹
, (
pOp
->
p5
 & 
OPFLAG_BULKCSR
));

69395 
	`as£π
–
rc
==
SQLITE_OK
 );

69401 
u
.
ay
.
pCur
->
isTabÀ
 = 
pOp
->
p4ty≥
!=
P4_KEYINFO
;

69402 
u
.
ay
.
pCur
->
isIndex
 = !u.ay.pCur->
isTabÀ
;

69436 
OP_O≥nAutoödex
:

69437 
OP_O≥nEphemîÆ
: {

69439 
VdbeCurs‹
 *
pCx
;

69441 c⁄° 
vfsFœgs
 =

69442 
SQLITE_OPEN_READWRITE
 |

69443 
SQLITE_OPEN_CREATE
 |

69444 
SQLITE_OPEN_EXCLUSIVE
 |

69445 
SQLITE_OPEN_DELETEONCLOSE
 |

69446 
SQLITE_OPEN_TRANSIENT_DB
;

69448 
	`as£π
–
pOp
->
p1
>=0 );

69449 
u
.
az
.
pCx
 = 
	`ÆloˇãCurs‹
(
p
, 
pOp
->
p1
,ÖOp->
p2
, -1, 1);

69450 if–
u
.
az
.
pCx
==0 ) 
no_mem
;

69451 
u
.
az
.
pCx
->
nuŒRow
 = 1;

69452 
rc
 = 
	`sqlôe3BåìO≥n
(
db
->
pVfs
, 0, db, &
u
.
az
.
pCx
->
pBt
,

69453 
BTREE_OMIT_JOURNAL
 | 
BTREE_SINGLE
 | 
pOp
->
p5
, 
vfsFœgs
);

69454 if–
rc
==
SQLITE_OK
 ){

69455 
rc
 = 
	`sqlôe3BåìBegöTøns
(
u
.
az
.
pCx
->
pBt
, 1);

69457 if–
rc
==
SQLITE_OK
 ){

69463 if–
pOp
->
p4
.
pKeyInfo
 ){

69464 
pgno
;

69465 
	`as£π
–
pOp
->
p4ty≥
==
P4_KEYINFO
 );

69466 
rc
 = 
	`sqlôe3BåìCª©eTabÀ
(
u
.
az
.
pCx
->
pBt
, &
pgno
, 
BTREE_BLOBKEY
 | 
pOp
->
p5
);

69467 if–
rc
==
SQLITE_OK
 ){

69468 
	`as£π
–
pgno
==
MASTER_ROOT
+1 );

69469 
rc
 = 
	`sqlôe3BåìCurs‹
(
u
.
az
.
pCx
->
pBt
, 
pgno
, 1,

69470 (
KeyInfo
*)
pOp
->
p4
.
z
, 
u
.
az
.
pCx
->
pCurs‹
);

69471 
u
.
az
.
pCx
->
pKeyInfo
 = 
pOp
->
p4
.pKeyInfo;

69472 
u
.
az
.
pCx
->
pKeyInfo
->
íc
 = 
	`ENC
(
p
->
db
);

69474 
u
.
az
.
pCx
->
isTabÀ
 = 0;

69476 
rc
 = 
	`sqlôe3BåìCurs‹
(
u
.
az
.
pCx
->
pBt
, 
MASTER_ROOT
, 1, 0, u.az.pCx->
pCurs‹
);

69477 
u
.
az
.
pCx
->
isTabÀ
 = 1;

69480 
u
.
az
.
pCx
->
isOrdîed
 = (
pOp
->
p5
!=
BTREE_UNORDERED
);

69481 
u
.
az
.
pCx
->
isIndex
 = !u.az.pCx->
isTabÀ
;

69491 
OP_S‹ãrO≥n
: {

69493 
VdbeCurs‹
 *
pCx
;

69496 
u
.
ba
.
pCx
 = 
	`ÆloˇãCurs‹
(
p
, 
pOp
->
p1
,ÖOp->
p2
, -1, 1);

69497 if–
u
.
ba
.
pCx
==0 ) 
no_mem
;

69498 
u
.
ba
.
pCx
->
pKeyInfo
 = 
pOp
->
p4
.pKeyInfo;

69499 
u
.
ba
.
pCx
->
pKeyInfo
->
íc
 = 
	`ENC
(
p
->
db
);

69500 
u
.
ba
.
pCx
->
isS‹ãr
 = 1;

69501 
rc
 = 
	`sqlôe3VdbeS‹ãrInô
(
db
, 
u
.
ba
.
pCx
);

69521 
OP_O≥nP£udo
: {

69523 
VdbeCurs‹
 *
pCx
;

69526 
	`as£π
–
pOp
->
p1
>=0 );

69527 
u
.
bb
.
pCx
 = 
	`ÆloˇãCurs‹
(
p
, 
pOp
->
p1
,ÖOp->
p3
, -1, 0);

69528 if–
u
.
bb
.
pCx
==0 ) 
no_mem
;

69529 
u
.
bb
.
pCx
->
nuŒRow
 = 1;

69530 
u
.
bb
.
pCx
->
p£udoTabÀReg
 = 
pOp
->
p2
;

69531 
u
.
bb
.
pCx
->
isTabÀ
 = 1;

69532 
u
.
bb
.
pCx
->
isIndex
 = 0;

69533 
u
.
bb
.
pCx
->
mu…iP£udo
 = 
pOp
->
p5
;

69542 
OP_Clo£
: {

69543 
	`as£π
–
pOp
->
p1
>=0 &&ÖOp->p1<
p
->
nCurs‹
 );

69544 
	`sqlôe3VdbeFªeCurs‹
(
p
,Ö->
≠C§
[
pOp
->
p1
]);

69545 
p
->
≠C§
[
pOp
->
p1
] = 0;

69601 
OP_SìkLt
:

69602 
OP_SìkLe
:

69603 
OP_SìkGe
:

69604 
OP_SìkGt
: {

69606 
ªs
;

69607 
oc
;

69608 
VdbeCurs‹
 *
pC
;

69609 
U≈ackedRec‹d
 
r
;

69610 
nFõld
;

69611 
i64
 
iKey
;

69614 
	`as£π
–
pOp
->
p1
>=0 &&ÖOp->p1<
p
->
nCurs‹
 );

69615 
	`as£π
–
pOp
->
p2
!=0 );

69616 
u
.
bc
.
pC
 = 
p
->
≠C§
[
pOp
->
p1
];

69617 
	`as£π
–
u
.
bc
.
pC
!=0 );

69618 
	`as£π
–
u
.
bc
.
pC
->
p£udoTabÀReg
==0 );

69619 
	`as£π
–
OP_SìkLe
 =
OP_SìkLt
+1 );

69620 
	`as£π
–
OP_SìkGe
 =
OP_SìkLt
+2 );

69621 
	`as£π
–
OP_SìkGt
 =
OP_SìkLt
+3 );

69622 
	`as£π
–
u
.
bc
.
pC
->
isOrdîed
 );

69623 if–
	`ALWAYS
(
u
.
bc
.
pC
->
pCurs‹
!=0) ){

69624 
u
.
bc
.
oc
 = 
pOp
->
›code
;

69625 
u
.
bc
.
pC
->
nuŒRow
 = 0;

69626 if–
u
.
bc
.
pC
->
isTabÀ
 ){

69630 
pIn3
 = &
aMem
[
pOp
->
p3
];

69631 
	`≠∂yNumîicAfföôy
(
pIn3
);

69632 
u
.
bc
.
iKey
 = 
	`sqlôe3VdbeI¡VÆue
(
pIn3
);

69633 
u
.
bc
.
pC
->
rowidIsVÆid
 = 0;

69637 if–(
pIn3
->
Êags
 & 
MEM_I¡
)==0 ){

69638 if–(
pIn3
->
Êags
 & 
MEM_Ról
)==0 ){

69641 
pc
 = 
pOp
->
p2
 - 1;

69646 
	`as£π
–(
pIn3
->
Êags
 & 
MEM_Ról
)!=0 );

69648 if–
u
.
bc
.
iKey
==
SMALLEST_INT64
 && (
pIn3
->
r
<()u.bc.iKey ||ÖIn3->r>0) ){

69651 
u
.
bc
.
ªs
 = 1;

69652 if–
pIn3
->
r
<0 ){

69653 if–
u
.
bc
.
oc
>=
OP_SìkGe
 ){ 
	`as£π
–u.bc.oc==OP_SìkGê|| u.bc.oc==
OP_SìkGt
 );

69654 
rc
 = 
	`sqlôe3BåìFú°
(
u
.
bc
.
pC
->
pCurs‹
, &u.bc.
ªs
);

69655 if–
rc
!=
SQLITE_OK
 ) 
ab‹t_due_to_îr‹
;

69658 if–
u
.
bc
.
oc
<=
OP_SìkLe
 ){ 
	`as£π
–u.bc.oc==
OP_SìkLt
 || u.bc.oc==OP_SeekLe );

69659 
rc
 = 
	`sqlôe3BåìLa°
(
u
.
bc
.
pC
->
pCurs‹
, &u.bc.
ªs
);

69660 if–
rc
!=
SQLITE_OK
 ) 
ab‹t_due_to_îr‹
;

69663 if–
u
.
bc
.
ªs
 ){

69664 
pc
 = 
pOp
->
p2
 - 1;

69667 }if–
u
.
bc
.
oc
==
OP_SìkLt
 || u.bc.oc==
OP_SìkGe
 ){

69669 if–
pIn3
->
r
 > ()
u
.
bc
.
iKey
 ) u.bc.iKey++;

69672 
	`as£π
–
u
.
bc
.
oc
==
OP_SìkLe
 || u.bc.oc==
OP_SìkGt
 );

69673 if–
pIn3
->
r
 < ()
u
.
bc
.
iKey
 ) u.bc.iKey--;

69676 
rc
 = 
	`sqlôe3BåìMovëoU≈acked
(
u
.
bc
.
pC
->
pCurs‹
, 0, (
u64
)u.bc.
iKey
, 0, &u.bc.
ªs
);

69677 if–
rc
!=
SQLITE_OK
 ){

69678 
ab‹t_due_to_îr‹
;

69680 if–
u
.
bc
.
ªs
==0 ){

69681 
u
.
bc
.
pC
->
rowidIsVÆid
 = 1;

69682 
u
.
bc
.
pC
->
œ°Rowid
 = u.bc.
iKey
;

69685 
u
.
bc
.
nFõld
 = 
pOp
->
p4
.
i
;

69686 
	`as£π
–
pOp
->
p4ty≥
==
P4_INT32
 );

69687 
	`as£π
–
u
.
bc
.
nFõld
>0 );

69688 
u
.
bc
.
r
.
pKeyInfo
 = u.bc.
pC
->pKeyInfo;

69689 
u
.
bc
.
r
.
nFõld
 = (
u16
)u.bc.nField;

69698 
u
.
bc
.
r
.
Êags
 = (
u8
)(
UNPACKED_INCRKEY
 * (1 & (u.bc.
oc
 - 
OP_SìkLt
)));

69699 
	`as£π
–
u
.
bc
.
oc
!=
OP_SìkGt
 || u.bc.
r
.
Êags
==
UNPACKED_INCRKEY
 );

69700 
	`as£π
–
u
.
bc
.
oc
!=
OP_SìkLe
 || u.bc.
r
.
Êags
==
UNPACKED_INCRKEY
 );

69701 
	`as£π
–
u
.
bc
.
oc
!=
OP_SìkGe
 || u.bc.
r
.
Êags
==0 );

69702 
	`as£π
–
u
.
bc
.
oc
!=
OP_SìkLt
 || u.bc.
r
.
Êags
==0 );

69704 
u
.
bc
.
r
.
aMem
 = &aMem[
pOp
->
p3
];

69705 #ifde‡
SQLITE_DEBUG


69706 { 
i
; i=0; i<
u
.
bc
.
r
.
nFõld
; i++Ë
	`as£π
–
	`memIsVÆid
(&u.bc.r.
aMem
[i]) ); }

69708 
	`Ex∑ndBlob
(
u
.
bc
.
r
.
aMem
);

69709 
rc
 = 
	`sqlôe3BåìMovëoU≈acked
(
u
.
bc
.
pC
->
pCurs‹
, &u.bc.
r
, 0, 0, &u.bc.
ªs
);

69710 if–
rc
!=
SQLITE_OK
 ){

69711 
ab‹t_due_to_îr‹
;

69713 
u
.
bc
.
pC
->
rowidIsVÆid
 = 0;

69715 
u
.
bc
.
pC
->
de„ºedMovëo
 = 0;

69716 
u
.
bc
.
pC
->
ˇcheSètus
 = 
CACHE_STALE
;

69717 #ifde‡
SQLITE_TEST


69718 
sqlôe3_£¨ch_cou¡
++;

69720 if–
u
.
bc
.
oc
>=
OP_SìkGe
 ){ 
	`as£π
–u.bc.oc==OP_SìkGê|| u.bc.oc==
OP_SìkGt
 );

69721 if–
u
.
bc
.
ªs
<0 || (u.bc.ªs==0 && u.bc.
oc
==
OP_SìkGt
) ){

69722 
rc
 = 
	`sqlôe3BåìNext
(
u
.
bc
.
pC
->
pCurs‹
, &u.bc.
ªs
);

69723 if–
rc
!=
SQLITE_OK
 ) 
ab‹t_due_to_îr‹
;

69724 
u
.
bc
.
pC
->
rowidIsVÆid
 = 0;

69726 
u
.
bc
.
ªs
 = 0;

69729 
	`as£π
–
u
.
bc
.
oc
==
OP_SìkLt
 || u.bc.oc==
OP_SìkLe
 );

69730 if–
u
.
bc
.
ªs
>0 || (u.bc.ªs==0 && u.bc.
oc
==
OP_SìkLt
) ){

69731 
rc
 = 
	`sqlôe3BåìPªvious
(
u
.
bc
.
pC
->
pCurs‹
, &u.bc.
ªs
);

69732 if–
rc
!=
SQLITE_OK
 ) 
ab‹t_due_to_îr‹
;

69733 
u
.
bc
.
pC
->
rowidIsVÆid
 = 0;

69738 
u
.
bc
.
ªs
 = 
	`sqlôe3BåìEof
(u.bc.
pC
->
pCurs‹
);

69741 
	`as£π
–
pOp
->
p2
>0 );

69742 if–
u
.
bc
.
ªs
 ){

69743 
pc
 = 
pOp
->
p2
 - 1;

69750 
pc
 = 
pOp
->
p2
 - 1;

69764 
OP_Sìk
: {

69766 
VdbeCurs‹
 *
pC
;

69769 
	`as£π
–
pOp
->
p1
>=0 &&ÖOp->p1<
p
->
nCurs‹
 );

69770 
u
.
bd
.
pC
 = 
p
->
≠C§
[
pOp
->
p1
];

69771 
	`as£π
–
u
.
bd
.
pC
!=0 );

69772 if–
	`ALWAYS
(
u
.
bd
.
pC
->
pCurs‹
!=0) ){

69773 
	`as£π
–
u
.
bd
.
pC
->
isTabÀ
 );

69774 
u
.
bd
.
pC
->
nuŒRow
 = 0;

69775 
pIn2
 = &
aMem
[
pOp
->
p2
];

69776 
u
.
bd
.
pC
->
movëoT¨gë
 = 
	`sqlôe3VdbeI¡VÆue
(
pIn2
);

69777 
u
.
bd
.
pC
->
rowidIsVÆid
 = 0;

69778 
u
.
bd
.
pC
->
de„ºedMovëo
 = 1;

69808 
OP_NŸFound
:

69809 
OP_Found
: {

69811 
ÆªadyExi°s
;

69812 
VdbeCurs‹
 *
pC
;

69813 
ªs
;

69814 *
pFªe
;

69815 
U≈ackedRec‹d
 *
pIdxKey
;

69816 
U≈ackedRec‹d
 
r
;

69817 
aTempRec
[
	`ROUND8
((
U≈ackedRec‹d
)Ë+ (
Mem
)*3 + 7];

69820 #ifde‡
SQLITE_TEST


69821 
sqlôe3_found_cou¡
++;

69824 
u
.
be
.
ÆªadyExi°s
 = 0;

69825 
	`as£π
–
pOp
->
p1
>=0 &&ÖOp->p1<
p
->
nCurs‹
 );

69826 
	`as£π
–
pOp
->
p4ty≥
==
P4_INT32
 );

69827 
u
.
be
.
pC
 = 
p
->
≠C§
[
pOp
->
p1
];

69828 
	`as£π
–
u
.
be
.
pC
!=0 );

69829 
pIn3
 = &
aMem
[
pOp
->
p3
];

69830 if–
	`ALWAYS
(
u
.
be
.
pC
->
pCurs‹
!=0) ){

69832 
	`as£π
–
u
.
be
.
pC
->
isTabÀ
==0 );

69833 if–
pOp
->
p4
.
i
>0 ){

69834 
u
.
be
.
r
.
pKeyInfo
 = u.be.
pC
->pKeyInfo;

69835 
u
.
be
.
r
.
nFõld
 = (
u16
)
pOp
->
p4
.
i
;

69836 
u
.
be
.
r
.
aMem
 = 
pIn3
;

69837 #ifde‡
SQLITE_DEBUG


69838 { 
i
; i=0; i<
u
.
be
.
r
.
nFõld
; i++Ë
	`as£π
–
	`memIsVÆid
(&u.be.r.
aMem
[i]) ); }

69840 
u
.
be
.
r
.
Êags
 = 
UNPACKED_PREFIX_MATCH
;

69841 
u
.
be
.
pIdxKey
 = &u.be.
r
;

69843 
u
.
be
.
pIdxKey
 = 
	`sqlôe3VdbeAŒocU≈ackedRec‹d
(

69844 
u
.
be
.
pC
->
pKeyInfo
, u.be.
aTempRec
, (u.be.aTempRec), &u.be.
pFªe


69846 if–
u
.
be
.
pIdxKey
==0 ) 
no_mem
;

69847 
	`as£π
–
pIn3
->
Êags
 & 
MEM_Blob
 );

69848 
	`as£π
–(
pIn3
->
Êags
 & 
MEM_Zîo
)==0 );

69849 
	`sqlôe3VdbeRec‹dU≈ack
(
u
.
be
.
pC
->
pKeyInfo
, 
pIn3
->
n
,ÖIn3->
z
, u.be.
pIdxKey
);

69850 
u
.
be
.
pIdxKey
->
Êags
 |
UNPACKED_PREFIX_MATCH
;

69852 
rc
 = 
	`sqlôe3BåìMovëoU≈acked
(
u
.
be
.
pC
->
pCurs‹
, u.be.
pIdxKey
, 0, 0, &u.be.
ªs
);

69853 if–
pOp
->
p4
.
i
==0 ){

69854 
	`sqlôe3DbFªe
(
db
, 
u
.
be
.
pFªe
);

69856 if–
rc
!=
SQLITE_OK
 ){

69859 
u
.
be
.
ÆªadyExi°s
 = (u.be.
ªs
==0);

69860 
u
.
be
.
pC
->
de„ºedMovëo
 = 0;

69861 
u
.
be
.
pC
->
ˇcheSètus
 = 
CACHE_STALE
;

69863 if–
pOp
->
›code
==
OP_Found
 ){

69864 if–
u
.
be
.
ÆªadyExi°s
 ) 
pc
 = 
pOp
->
p2
 - 1;

69866 if–!
u
.
be
.
ÆªadyExi°s
 ) 
pc
 = 
pOp
->
p2
 - 1;

69897 
OP_IsUnique
: {

69899 
u16
 
ii
;

69900 
VdbeCurs‹
 *
pCx
;

69901 
BtCurs‹
 *
pCr§
;

69902 
u16
 
nFõld
;

69903 
Mem
 *
aMx
;

69904 
U≈ackedRec‹d
 
r
;

69905 
i64
 
R
;

69908 
pIn3
 = &
aMem
[
pOp
->
p3
];

69909 
u
.
bf
.
aMx
 = &
aMem
[
pOp
->
p4
.
i
];

69911 
	`as£π
–
pOp
->
p4ty≥
==
P4_INT32
 );

69912 
	`as£π
–
pOp
->
p4
.
i
>0 &&ÖOp->p4.i<=(
p
->
nMem
-p->
nCurs‹
) );

69913 
	`as£π
–
pOp
->
p1
>=0 &&ÖOp->p1<
p
->
nCurs‹
 );

69916 
u
.
bf
.
pCx
 = 
p
->
≠C§
[
pOp
->
p1
];

69917 
	`as£π
–
u
.
bf
.
pCx
->
de„ºedMovëo
==0 );

69918 
u
.
bf
.
pCx
->
£ekResu…
 = 0;

69919 
u
.
bf
.
pCx
->
ˇcheSètus
 = 
CACHE_STALE
;

69920 
u
.
bf
.
pCr§
 = u.bf.
pCx
->
pCurs‹
;

69923 
u
.
bf
.
nFõld
 = u.bf.
pCx
->
pKeyInfo
->nField;

69924 
u
.
bf
.
ii
=0; u.bf.ii<u.bf.
nFõld
; u.bf.ii++){

69925 if–
u
.
bf
.
aMx
[u.bf.
ii
].
Êags
 & 
MEM_NuŒ
 ){

69926 
pc
 = 
pOp
->
p2
 - 1;

69927 
u
.
bf
.
pCr§
 = 0;

69931 
	`as£π
–(
u
.
bf
.
aMx
[u.bf.
nFõld
].
Êags
 & 
MEM_NuŒ
)==0 );

69933 if–
u
.
bf
.
pCr§
!=0 ){

69935 
u
.
bf
.
r
.
pKeyInfo
 = u.bf.
pCx
->pKeyInfo;

69936 
u
.
bf
.
r
.
nFõld
 = u.bf.nField + 1;

69937 
u
.
bf
.
r
.
Êags
 = 
UNPACKED_PREFIX_SEARCH
;

69938 
u
.
bf
.
r
.
aMem
 = u.bf.
aMx
;

69939 #ifde‡
SQLITE_DEBUG


69940 { 
i
; i=0; i<
u
.
bf
.
r
.
nFõld
; i++Ë
	`as£π
–
	`memIsVÆid
(&u.bf.r.
aMem
[i]) ); }

69944 
	`sqlôe3VdbeMemI¡egîify
(
pIn3
);

69945 
u
.
bf
.
R
 = 
pIn3
->u.
i
;

69950 
rc
 = 
	`sqlôe3BåìMovëoU≈acked
(
u
.
bf
.
pCr§
, &u.bf.
r
, 0, 0, &u.bf.
pCx
->
£ekResu…
);

69951 if–(
u
.
bf
.
r
.
Êags
 & 
UNPACKED_PREFIX_SEARCH
Ë|| u.bf.r.
rowid
==u.bf.
R
 ){

69952 
pc
 = 
pOp
->
p2
 - 1;

69954 
pIn3
->
u
.
i
 = u.
bf
.
r
.
rowid
;

69974 
OP_NŸExi°s
: {

69976 
VdbeCurs‹
 *
pC
;

69977 
BtCurs‹
 *
pCr§
;

69978 
ªs
;

69979 
u64
 
iKey
;

69982 
pIn3
 = &
aMem
[
pOp
->
p3
];

69983 
	`as£π
–
pIn3
->
Êags
 & 
MEM_I¡
 );

69984 
	`as£π
–
pOp
->
p1
>=0 &&ÖOp->p1<
p
->
nCurs‹
 );

69985 
u
.
bg
.
pC
 = 
p
->
≠C§
[
pOp
->
p1
];

69986 
	`as£π
–
u
.
bg
.
pC
!=0 );

69987 
	`as£π
–
u
.
bg
.
pC
->
isTabÀ
 );

69988 
	`as£π
–
u
.
bg
.
pC
->
p£udoTabÀReg
==0 );

69989 
u
.
bg
.
pCr§
 = u.bg.
pC
->
pCurs‹
;

69990 if–
	`ALWAYS
(
u
.
bg
.
pCr§
!=0) ){

69991 
u
.
bg
.
ªs
 = 0;

69992 
u
.
bg
.
iKey
 = 
pIn3
->u.
i
;

69993 
rc
 = 
	`sqlôe3BåìMovëoU≈acked
(
u
.
bg
.
pCr§
, 0, u.bg.
iKey
, 0, &u.bg.
ªs
);

69994 
u
.
bg
.
pC
->
œ°Rowid
 = 
pIn3
->u.
i
;

69995 
u
.
bg
.
pC
->
rowidIsVÆid
 = u.bg.
ªs
==0 ?1:0;

69996 
u
.
bg
.
pC
->
nuŒRow
 = 0;

69997 
u
.
bg
.
pC
->
ˇcheSètus
 = 
CACHE_STALE
;

69998 
u
.
bg
.
pC
->
de„ºedMovëo
 = 0;

69999 if–
u
.
bg
.
ªs
!=0 ){

70000 
pc
 = 
pOp
->
p2
 - 1;

70001 
	`as£π
–
u
.
bg
.
pC
->
rowidIsVÆid
==0 );

70003 
u
.
bg
.
pC
->
£ekResu…
 = u.bg.
ªs
;

70008 
pc
 = 
pOp
->
p2
 - 1;

70009 
	`as£π
–
u
.
bg
.
pC
->
rowidIsVÆid
==0 );

70010 
u
.
bg
.
pC
->
£ekResu…
 = 0;

70022 
OP_Sequí˚
: {

70023 
	`as£π
–
pOp
->
p1
>=0 &&ÖOp->p1<
p
->
nCurs‹
 );

70024 
	`as£π
–
p
->
≠C§
[
pOp
->
p1
]!=0 );

70025 
pOut
->
u
.
i
 = 
p
->
≠C§
[
pOp
->
p1
]->
£qCou¡
++;

70044 
OP_NewRowid
: {

70046 
i64
 
v
;

70047 
VdbeCurs‹
 *
pC
;

70048 
ªs
;

70049 
˙t
;

70050 
Mem
 *
pMem
;

70051 
VdbeFøme
 *
pFøme
;

70054 
u
.
bh
.
v
 = 0;

70055 
u
.
bh
.
ªs
 = 0;

70056 
	`as£π
–
pOp
->
p1
>=0 &&ÖOp->p1<
p
->
nCurs‹
 );

70057 
u
.
bh
.
pC
 = 
p
->
≠C§
[
pOp
->
p1
];

70058 
	`as£π
–
u
.
bh
.
pC
!=0 );

70059 if–
	`NEVER
(
u
.
bh
.
pC
->
pCurs‹
==0) ){

70075 
	`as£π
–
u
.
bh
.
pC
->
isTabÀ
 );

70077 #ifde‡
SQLITE_32BIT_ROWID


70078 
	#MAX_ROWID
 0x7fffffff

	)

70084 
	#MAX_ROWID
 (
i64
)–(((
u64
)0x7fffffff)<<32Ë| (u64)0xfffffff‡)

	)

70087 if–!
u
.
bh
.
pC
->
u£R™domRowid
 ){

70088 
u
.
bh
.
v
 = 
	`sqlôe3BåìGëCachedRowid
(u.bh.
pC
->
pCurs‹
);

70089 if–
u
.
bh
.
v
==0 ){

70090 
rc
 = 
	`sqlôe3BåìLa°
(
u
.
bh
.
pC
->
pCurs‹
, &u.bh.
ªs
);

70091 if–
rc
!=
SQLITE_OK
 ){

70092 
ab‹t_due_to_îr‹
;

70094 if–
u
.
bh
.
ªs
 ){

70095 
u
.
bh
.
v
 = 1;

70097 
	`as£π
–
	`sqlôe3BåìCurs‹IsVÆid
(
u
.
bh
.
pC
->
pCurs‹
) );

70098 
rc
 = 
	`sqlôe3BåìKeySize
(
u
.
bh
.
pC
->
pCurs‹
, &u.bh.
v
);

70099 
	`as£π
–
rc
==
SQLITE_OK
 );

70100 if–
u
.
bh
.
v
>=
MAX_ROWID
 ){

70101 
u
.
bh
.
pC
->
u£R™domRowid
 = 1;

70103 
u
.
bh
.
v
++;

70108 #i‚de‡
SQLITE_OMIT_AUTOINCREMENT


70109 if–
pOp
->
p3
 ){

70111 
	`as£π
–
pOp
->
p3
>0 );

70112 if–
p
->
pFøme
 ){

70113 
u
.
bh
.
pFøme
=
p
->pFøme; u.bh.pFøme->
pP¨ít
; u.bh.pFrame=u.bh.pFrame->pParent);

70115 
	`as£π
–
pOp
->
p3
<=
u
.
bh
.
pFøme
->
nMem
 );

70116 
u
.
bh
.
pMem
 = &u.bh.
pFøme
->
aMem
[
pOp
->
p3
];

70119 
	`as£π
–
pOp
->
p3
<=(
p
->
nMem
-p->
nCurs‹
) );

70120 
u
.
bh
.
pMem
 = &
aMem
[
pOp
->
p3
];

70121 
	`memAboutToCh™ge
(
p
, 
u
.
bh
.
pMem
);

70123 
	`as£π
–
	`memIsVÆid
(
u
.
bh
.
pMem
) );

70125 
	`REGISTER_TRACE
(
pOp
->
p3
, 
u
.
bh
.
pMem
);

70126 
	`sqlôe3VdbeMemI¡egîify
(
u
.
bh
.
pMem
);

70127 
	`as£π
–(
u
.
bh
.
pMem
->
Êags
 & 
MEM_I¡
)!=0 );

70128 if–
u
.
bh
.
pMem
->u.
i
==
MAX_ROWID
 || u.bh.
pC
->
u£R™domRowid
 ){

70129 
rc
 = 
SQLITE_FULL
;

70130 
ab‹t_due_to_îr‹
;

70132 if–
u
.
bh
.
v
<u.bh.
pMem
->u.
i
+1 ){

70133 
u
.
bh
.
v
 = u.bh.
pMem
->u.
i
 + 1;

70135 
u
.
bh
.
pMem
->u.
i
 = u.bh.
v
;

70139 
	`sqlôe3BåìSëCachedRowid
(
u
.
bh
.
pC
->
pCurs‹
, u.bh.
v
<
MAX_ROWID
 ? u.bh.v+1 : 0);

70141 if–
u
.
bh
.
pC
->
u£R™domRowid
 ){

70146 
	`as£π
–
pOp
->
p3
==0 );

70149 
u
.
bh
.
v
 = 
œ°Rowid
;

70150 
u
.
bh
.
v
 &(
MAX_ROWID
>>1);

70151 
u
.
bh
.
v
++;

70152 
u
.
bh
.
˙t
 = 0;

70153  ((
rc
 = 
	`sqlôe3BåìMovëoU≈acked
(
u
.
bh
.
pC
->
pCurs‹
, 0, (
u64
)u.bh.
v
,

70154 0, &
u
.
bh
.
ªs
))==
SQLITE_OK
)

70155 && (
u
.
bh
.
ªs
==0)

70156 && (++
u
.
bh
.
˙t
<100)){

70158 
	`sqlôe3_øndom√ss
((
u
.
bh
.
v
), &u.bh.v);

70159 if–
u
.
bh
.
˙t
<5 ){

70161 
u
.
bh
.
v
 &= 0xffffff;

70163 
u
.
bh
.
v
 &(
MAX_ROWID
>>1);

70165 
u
.
bh
.
v
++;

70167 if–
rc
==
SQLITE_OK
 && 
u
.
bh
.
ªs
==0 ){

70168 
rc
 = 
SQLITE_FULL
;

70169 
ab‹t_due_to_îr‹
;

70171 
	`as£π
–
u
.
bh
.
v
>0 );

70173 
u
.
bh
.
pC
->
rowidIsVÆid
 = 0;

70174 
u
.
bh
.
pC
->
de„ºedMovëo
 = 0;

70175 
u
.
bh
.
pC
->
ˇcheSètus
 = 
CACHE_STALE
;

70177 
pOut
->
u
.
i
 = u.
bh
.
v
;

70225 
OP_In£π
:

70226 
OP_In£πI¡
: {

70228 
Mem
 *
pD©a
;

70229 
Mem
 *
pKey
;

70230 
i64
 
iKey
;

70231 
VdbeCurs‹
 *
pC
;

70232 
nZîo
;

70233 
£ekResu…
;

70234 c⁄° *
zDb
;

70235 c⁄° *
zTbl
;

70236 
›
;

70239 
u
.
bi
.
pD©a
 = &
aMem
[
pOp
->
p2
];

70240 
	`as£π
–
pOp
->
p1
>=0 &&ÖOp->p1<
p
->
nCurs‹
 );

70241 
	`as£π
–
	`memIsVÆid
(
u
.
bi
.
pD©a
) );

70242 
u
.
bi
.
pC
 = 
p
->
≠C§
[
pOp
->
p1
];

70243 
	`as£π
–
u
.
bi
.
pC
!=0 );

70244 
	`as£π
–
u
.
bi
.
pC
->
pCurs‹
!=0 );

70245 
	`as£π
–
u
.
bi
.
pC
->
p£udoTabÀReg
==0 );

70246 
	`as£π
–
u
.
bi
.
pC
->
isTabÀ
 );

70247 
	`REGISTER_TRACE
(
pOp
->
p2
, 
u
.
bi
.
pD©a
);

70249 if–
pOp
->
›code
==
OP_In£π
 ){

70250 
u
.
bi
.
pKey
 = &
aMem
[
pOp
->
p3
];

70251 
	`as£π
–
u
.
bi
.
pKey
->
Êags
 & 
MEM_I¡
 );

70252 
	`as£π
–
	`memIsVÆid
(
u
.
bi
.
pKey
) );

70253 
	`REGISTER_TRACE
(
pOp
->
p3
, 
u
.
bi
.
pKey
);

70254 
u
.
bi
.
iKey
 = u.bi.
pKey
->u.
i
;

70256 
	`as£π
–
pOp
->
›code
==
OP_In£πI¡
 );

70257 
u
.
bi
.
iKey
 = 
pOp
->
p3
;

70260 if–
pOp
->
p5
 & 
OPFLAG_NCHANGE
 ) 
p
->
nCh™ge
++;

70261 if–
pOp
->
p5
 & 
OPFLAG_LASTROWID
 ) 
db
->
œ°Rowid
 =Üa°Rowid = 
u
.
bi
.
iKey
;

70262 if–
u
.
bi
.
pD©a
->
Êags
 & 
MEM_NuŒ
 ){

70263 
u
.
bi
.
pD©a
->
z
 = 0;

70264 
u
.
bi
.
pD©a
->
n
 = 0;

70266 
	`as£π
–
u
.
bi
.
pD©a
->
Êags
 & (
MEM_Blob
|
MEM_Så
) );

70268 
u
.
bi
.
£ekResu…
 = ((
pOp
->
p5
 & 
OPFLAG_USESEEKRESULT
Ë? u.bi.
pC
->seekResult : 0);

70269 if–
u
.
bi
.
pD©a
->
Êags
 & 
MEM_Zîo
 ){

70270 
u
.
bi
.
nZîo
 = u.bi.
pD©a
->u.nZero;

70272 
u
.
bi
.
nZîo
 = 0;

70274 
	`sqlôe3BåìSëCachedRowid
(
u
.
bi
.
pC
->
pCurs‹
, 0);

70275 
rc
 = 
	`sqlôe3BåìIn£π
(
u
.
bi
.
pC
->
pCurs‹
, 0, u.bi.
iKey
,

70276 
u
.
bi
.
pD©a
->
z
, u.bi.pD©a->
n
, u.bi.
nZîo
,

70277 
pOp
->
p5
 & 
OPFLAG_APPEND
, 
u
.
bi
.
£ekResu…


70279 
u
.
bi
.
pC
->
rowidIsVÆid
 = 0;

70280 
u
.
bi
.
pC
->
de„ºedMovëo
 = 0;

70281 
u
.
bi
.
pC
->
ˇcheSètus
 = 
CACHE_STALE
;

70284 if–
rc
==
SQLITE_OK
 && 
db
->
xUpd©eCÆlback
 && 
pOp
->
p4
.
z
 ){

70285 
u
.
bi
.
zDb
 = 
db
->
aDb
[u.bi.
pC
->
iDb
].
zName
;

70286 
u
.
bi
.
zTbl
 = 
pOp
->
p4
.
z
;

70287 
u
.
bi
.
›
 = ((
pOp
->
p5
 & 
OPFLAG_ISUPDATE
Ë? 
SQLITE_UPDATE
 : 
SQLITE_INSERT
);

70288 
	`as£π
–
u
.
bi
.
pC
->
isTabÀ
 );

70289 
db
->
	`xUpd©eCÆlback
(db->
pUpd©eArg
, 
u
.
bi
.
›
, u.bi.
zDb
, u.bi.
zTbl
, u.bi.
iKey
);

70290 
	`as£π
–
u
.
bi
.
pC
->
iDb
>=0 );

70315 
OP_Dñëe
: {

70317 
i64
 
iKey
;

70318 
VdbeCurs‹
 *
pC
;

70321 
u
.
bj
.
iKey
 = 0;

70322 
	`as£π
–
pOp
->
p1
>=0 &&ÖOp->p1<
p
->
nCurs‹
 );

70323 
u
.
bj
.
pC
 = 
p
->
≠C§
[
pOp
->
p1
];

70324 
	`as£π
–
u
.
bj
.
pC
!=0 );

70325 
	`as£π
–
u
.
bj
.
pC
->
pCurs‹
!=0 );

70330 if–
db
->
xUpd©eCÆlback
 && 
pOp
->
p4
.
z
 ){

70331 
	`as£π
–
u
.
bj
.
pC
->
isTabÀ
 );

70332 
	`as£π
–
u
.
bj
.
pC
->
rowidIsVÆid
 );

70333 
u
.
bj
.
iKey
 = u.bj.
pC
->
œ°Rowid
;

70343 
	`as£π
–
u
.
bj
.
pC
->
de„ºedMovëo
==0 );

70344 
rc
 = 
	`sqlôe3VdbeCurs‹Movëo
(
u
.
bj
.
pC
);

70345 if–
	`NEVER
(
rc
!=
SQLITE_OK
ËË
ab‹t_due_to_îr‹
;

70347 
	`sqlôe3BåìSëCachedRowid
(
u
.
bj
.
pC
->
pCurs‹
, 0);

70348 
rc
 = 
	`sqlôe3BåìDñëe
(
u
.
bj
.
pC
->
pCurs‹
);

70349 
u
.
bj
.
pC
->
ˇcheSètus
 = 
CACHE_STALE
;

70352 if–
rc
==
SQLITE_OK
 && 
db
->
xUpd©eCÆlback
 && 
pOp
->
p4
.
z
 ){

70353 c⁄° *
zDb
 = 
db
->
aDb
[
u
.
bj
.
pC
->
iDb
].
zName
;

70354 c⁄° *
zTbl
 = 
pOp
->
p4
.
z
;

70355 
db
->
	`xUpd©eCÆlback
(db->
pUpd©eArg
, 
SQLITE_DELETE
, 
zDb
, 
zTbl
, 
u
.
bj
.
iKey
);

70356 
	`as£π
–
u
.
bj
.
pC
->
iDb
>=0 );

70358 if–
pOp
->
p2
 & 
OPFLAG_NCHANGE
 ) 
p
->
nCh™ge
++;

70368 
OP_Re£tCou¡
: {

70369 
	`sqlôe3VdbeSëCh™ges
(
db
, 
p
->
nCh™ge
);

70370 
p
->
nCh™ge
 = 0;

70381 
OP_S‹ãrCom∑ª
: {

70383 
VdbeCurs‹
 *
pC
;

70384 
ªs
;

70387 
u
.
bk
.
pC
 = 
p
->
≠C§
[
pOp
->
p1
];

70388 
	`as£π
–
	`isS‹ãr
(
u
.
bk
.
pC
) );

70389 
pIn3
 = &
aMem
[
pOp
->
p3
];

70390 
rc
 = 
	`sqlôe3VdbeS‹ãrCom∑ª
(
u
.
bk
.
pC
, 
pIn3
, &u.bk.
ªs
);

70391 if–
u
.
bk
.
ªs
 ){

70392 
pc
 = 
pOp
->
p2
-1;

70401 
OP_S‹ãrD©a
: {

70403 
VdbeCurs‹
 *
pC
;

70406 
pOut
 = &
aMem
[
pOp
->
p2
];

70407 
u
.
bl
.
pC
 = 
p
->
≠C§
[
pOp
->
p1
];

70408 
	`as£π
–
u
.
bl
.
pC
->
isS‹ãr
 );

70409 
rc
 = 
	`sqlôe3VdbeS‹ãrRowkey
(
u
.
bl
.
pC
, 
pOut
);

70433 
OP_RowKey
:

70434 
OP_RowD©a
: {

70436 
VdbeCurs‹
 *
pC
;

70437 
BtCurs‹
 *
pCr§
;

70438 
u32
 
n
;

70439 
i64
 
n64
;

70442 
pOut
 = &
aMem
[
pOp
->
p2
];

70443 
	`memAboutToCh™ge
(
p
, 
pOut
);

70446 
	`as£π
–
pOp
->
p1
>=0 &&ÖOp->p1<
p
->
nCurs‹
 );

70447 
u
.
bm
.
pC
 = 
p
->
≠C§
[
pOp
->
p1
];

70448 
	`as£π
–
u
.
bm
.
pC
->
isS‹ãr
==0 );

70449 
	`as£π
–
u
.
bm
.
pC
->
isTabÀ
 || 
pOp
->
›code
!=
OP_RowD©a
 );

70450 
	`as£π
–
u
.
bm
.
pC
->
isIndex
 || 
pOp
->
›code
==
OP_RowD©a
 );

70451 
	`as£π
–
u
.
bm
.
pC
!=0 );

70452 
	`as£π
–
u
.
bm
.
pC
->
nuŒRow
==0 );

70453 
	`as£π
–
u
.
bm
.
pC
->
p£udoTabÀReg
==0 );

70454 
	`as£π
–
u
.
bm
.
pC
->
pCurs‹
!=0 );

70455 
u
.
bm
.
pCr§
 = u.bm.
pC
->
pCurs‹
;

70456 
	`as£π
–
	`sqlôe3BåìCurs‹IsVÆid
(
u
.
bm
.
pCr§
) );

70463 
	`as£π
–
u
.
bm
.
pC
->
de„ºedMovëo
==0 );

70464 
rc
 = 
	`sqlôe3VdbeCurs‹Movëo
(
u
.
bm
.
pC
);

70465 if–
	`NEVER
(
rc
!=
SQLITE_OK
ËË
ab‹t_due_to_îr‹
;

70467 if–
u
.
bm
.
pC
->
isIndex
 ){

70468 
	`as£π
–!
u
.
bm
.
pC
->
isTabÀ
 );

70469 
	`VVA_ONLY
(
rc
 =Ë
	`sqlôe3BåìKeySize
(
u
.
bm
.
pCr§
, &u.bm.
n64
);

70470 
	`as£π
–
rc
==
SQLITE_OK
 );

70471 if–
u
.
bm
.
n64
>
db
->
aLimô
[
SQLITE_LIMIT_LENGTH
] ){

70472 
too_big
;

70474 
u
.
bm
.
n
 = (
u32
)u.bm.
n64
;

70476 
	`VVA_ONLY
(
rc
 =Ë
	`sqlôe3BåìD©aSize
(
u
.
bm
.
pCr§
, &u.bm.
n
);

70477 
	`as£π
–
rc
==
SQLITE_OK
 );

70478 if–
u
.
bm
.
n
>(
u32
)
db
->
aLimô
[
SQLITE_LIMIT_LENGTH
] ){

70479 
too_big
;

70482 if–
	`sqlôe3VdbeMemGrow
(
pOut
, 
u
.
bm
.
n
, 0) ){

70483 
no_mem
;

70485 
pOut
->
n
 = 
u
.
bm
.n;

70486 
	`MemSëTy≥Fœg
(
pOut
, 
MEM_Blob
);

70487 if–
u
.
bm
.
pC
->
isIndex
 ){

70488 
rc
 = 
	`sqlôe3BåìKey
(
u
.
bm
.
pCr§
, 0, u.bm.
n
, 
pOut
->
z
);

70490 
rc
 = 
	`sqlôe3BåìD©a
(
u
.
bm
.
pCr§
, 0, u.bm.
n
, 
pOut
->
z
);

70492 
pOut
->
íc
 = 
SQLITE_UTF8
;

70493 
	`UPDATE_MAX_BLOBSIZE
(
pOut
);

70506 
OP_Rowid
: {

70508 
VdbeCurs‹
 *
pC
;

70509 
i64
 
v
;

70510 
sqlôe3_vèb
 *
pVèb
;

70511 c⁄° 
sqlôe3_moduÀ
 *
pModuÀ
;

70514 
	`as£π
–
pOp
->
p1
>=0 &&ÖOp->p1<
p
->
nCurs‹
 );

70515 
u
.
bn
.
pC
 = 
p
->
≠C§
[
pOp
->
p1
];

70516 
	`as£π
–
u
.
bn
.
pC
!=0 );

70517 
	`as£π
–
u
.
bn
.
pC
->
p£udoTabÀReg
==0 || u.bn.pC->
nuŒRow
 );

70518 if–
u
.
bn
.
pC
->
nuŒRow
 ){

70519 
pOut
->
Êags
 = 
MEM_NuŒ
;

70521 }if–
u
.
bn
.
pC
->
de„ºedMovëo
 ){

70522 
u
.
bn
.
v
 = u.bn.
pC
->
movëoT¨gë
;

70523 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


70524 }if–
u
.
bn
.
pC
->
pVèbCurs‹
 ){

70525 
u
.
bn
.
pVèb
 = u.bn.
pC
->
pVèbCurs‹
->pVtab;

70526 
u
.
bn
.
pModuÀ
 = u.bn.
pVèb
->pModule;

70527 
	`as£π
–
u
.
bn
.
pModuÀ
->
xRowid
 );

70528 
rc
 = 
u
.
bn
.
pModuÀ
->
	`xRowid
(u.bn.
pC
->
pVèbCurs‹
, &u.bn.
v
);

70529 
	`sqlôe3VèbImp‹tEºmsg
(
p
, 
u
.
bn
.
pVèb
);

70532 
	`as£π
–
u
.
bn
.
pC
->
pCurs‹
!=0 );

70533 
rc
 = 
	`sqlôe3VdbeCurs‹Movëo
(
u
.
bn
.
pC
);

70534 if–
rc
 ) 
ab‹t_due_to_îr‹
;

70535 if–
u
.
bn
.
pC
->
rowidIsVÆid
 ){

70536 
u
.
bn
.
v
 = u.bn.
pC
->
œ°Rowid
;

70538 
rc
 = 
	`sqlôe3BåìKeySize
(
u
.
bn
.
pC
->
pCurs‹
, &u.bn.
v
);

70539 
	`as£π
–
rc
==
SQLITE_OK
 );

70542 
pOut
->
u
.
i
 = u.
bn
.
v
;

70552 
OP_NuŒRow
: {

70554 
VdbeCurs‹
 *
pC
;

70557 
	`as£π
–
pOp
->
p1
>=0 &&ÖOp->p1<
p
->
nCurs‹
 );

70558 
u
.
bo
.
pC
 = 
p
->
≠C§
[
pOp
->
p1
];

70559 
	`as£π
–
u
.
bo
.
pC
!=0 );

70560 
u
.
bo
.
pC
->
nuŒRow
 = 1;

70561 
u
.
bo
.
pC
->
rowidIsVÆid
 = 0;

70562 
	`as£π
–
u
.
bo
.
pC
->
pCurs‹
 || u.bo.pC->
pVèbCurs‹
 );

70563 if–
u
.
bo
.
pC
->
pCurs‹
 ){

70564 
	`sqlôe3BåìCÀ¨Curs‹
(
u
.
bo
.
pC
->
pCurs‹
);

70577 
OP_La°
: {

70579 
VdbeCurs‹
 *
pC
;

70580 
BtCurs‹
 *
pCr§
;

70581 
ªs
;

70584 
	`as£π
–
pOp
->
p1
>=0 &&ÖOp->p1<
p
->
nCurs‹
 );

70585 
u
.
bp
.
pC
 = 
p
->
≠C§
[
pOp
->
p1
];

70586 
	`as£π
–
u
.
bp
.
pC
!=0 );

70587 
u
.
bp
.
pCr§
 = u.bp.
pC
->
pCurs‹
;

70588 
u
.
bp
.
ªs
 = 0;

70589 if–
	`ALWAYS
(
u
.
bp
.
pCr§
!=0) ){

70590 
rc
 = 
	`sqlôe3BåìLa°
(
u
.
bp
.
pCr§
, &u.bp.
ªs
);

70592 
u
.
bp
.
pC
->
nuŒRow
 = (
u8
)u.bp.
ªs
;

70593 
u
.
bp
.
pC
->
de„ºedMovëo
 = 0;

70594 
u
.
bp
.
pC
->
rowidIsVÆid
 = 0;

70595 
u
.
bp
.
pC
->
ˇcheSètus
 = 
CACHE_STALE
;

70596 if–
pOp
->
p2
>0 && 
u
.
bp
.
ªs
 ){

70597 
pc
 = 
pOp
->
p2
 - 1;

70615 
OP_S‹ãrS‹t
:

70616 
OP_S‹t
: {

70617 #ifde‡
SQLITE_TEST


70618 
sqlôe3_s‹t_cou¡
++;

70619 
sqlôe3_£¨ch_cou¡
--;

70621 
p
->
aCou¡î
[
SQLITE_STMTSTATUS_SORT
]++;

70632 
OP_Rewöd
: {

70634 
VdbeCurs‹
 *
pC
;

70635 
BtCurs‹
 *
pCr§
;

70636 
ªs
;

70639 
	`as£π
–
pOp
->
p1
>=0 &&ÖOp->p1<
p
->
nCurs‹
 );

70640 
u
.
bq
.
pC
 = 
p
->
≠C§
[
pOp
->
p1
];

70641 
	`as£π
–
u
.
bq
.
pC
!=0 );

70642 
	`as£π
–
u
.
bq
.
pC
->
isS‹ãr
==(
pOp
->
›code
==
OP_S‹ãrS‹t
) );

70643 
u
.
bq
.
ªs
 = 1;

70644 if–
	`isS‹ãr
(
u
.
bq
.
pC
) ){

70645 
rc
 = 
	`sqlôe3VdbeS‹ãrRewöd
(
db
, 
u
.
bq
.
pC
, &u.bq.
ªs
);

70647 
u
.
bq
.
pCr§
 = u.bq.
pC
->
pCurs‹
;

70648 
	`as£π
–
u
.
bq
.
pCr§
 );

70649 
rc
 = 
	`sqlôe3BåìFú°
(
u
.
bq
.
pCr§
, &u.bq.
ªs
);

70650 
u
.
bq
.
pC
->
©Fú°
 = u.bq.
ªs
==0 ?1:0;

70651 
u
.
bq
.
pC
->
de„ºedMovëo
 = 0;

70652 
u
.
bq
.
pC
->
ˇcheSètus
 = 
CACHE_STALE
;

70653 
u
.
bq
.
pC
->
rowidIsVÆid
 = 0;

70655 
u
.
bq
.
pC
->
nuŒRow
 = (
u8
)u.bq.
ªs
;

70656 
	`as£π
–
pOp
->
p2
>0 &&ÖOp->p2<
p
->
nOp
 );

70657 if–
u
.
bq
.
ªs
 ){

70658 
pc
 = 
pOp
->
p2
 - 1;

70695 
OP_S‹ãrNext
:

70696 
OP_Pªv
:

70697 
OP_Next
: {

70699 
VdbeCurs‹
 *
pC
;

70700 
ªs
;

70703 
	`as£π
–
pOp
->
p1
>=0 &&ÖOp->p1<
p
->
nCurs‹
 );

70704 
	`as£π
–
pOp
->
p5
<
	`AºaySize
(
p
->
aCou¡î
) );

70705 
u
.
br
.
pC
 = 
p
->
≠C§
[
pOp
->
p1
];

70706 if–
u
.
br
.
pC
==0 ){

70709 
	`as£π
–
u
.
br
.
pC
->
isS‹ãr
==(
pOp
->
›code
==
OP_S‹ãrNext
) );

70710 if–
	`isS‹ãr
(
u
.
br
.
pC
) ){

70711 
	`as£π
–
pOp
->
›code
==
OP_S‹ãrNext
 );

70712 
rc
 = 
	`sqlôe3VdbeS‹ãrNext
(
db
, 
u
.
br
.
pC
, &u.br.
ªs
);

70715 
	`as£π
–
u
.
br
.
pC
->
de„ºedMovëo
==0 );

70716 
	`as£π
–
u
.
br
.
pC
->
pCurs‹
 );

70717 
	`as£π
–
pOp
->
›code
!=
OP_Next
 ||ÖOp->
p4
.
xAdv™˚
==
sqlôe3BåìNext
 );

70718 
	`as£π
–
pOp
->
›code
!=
OP_Pªv
 ||ÖOp->
p4
.
xAdv™˚
==
sqlôe3BåìPªvious
 );

70719 
rc
 = 
pOp
->
p4
.
	`xAdv™˚
(
u
.
br
.
pC
->
pCurs‹
, &u.br.
ªs
);

70721 
u
.
br
.
pC
->
nuŒRow
 = (
u8
)u.br.
ªs
;

70722 
u
.
br
.
pC
->
ˇcheSètus
 = 
CACHE_STALE
;

70723 if–
u
.
br
.
ªs
==0 ){

70724 
pc
 = 
pOp
->
p2
 - 1;

70725 
p
->
aCou¡î
[
pOp
->
p5
]++;

70726 #ifde‡
SQLITE_TEST


70727 
sqlôe3_£¨ch_cou¡
++;

70730 
u
.
br
.
pC
->
rowidIsVÆid
 = 0;

70731 
check_f‹_öãºu±
;

70746 
OP_S‹ãrIn£π
:

70747 
OP_IdxIn£π
: {

70749 
VdbeCurs‹
 *
pC
;

70750 
BtCurs‹
 *
pCr§
;

70751 
nKey
;

70752 c⁄° *
zKey
;

70755 
	`as£π
–
pOp
->
p1
>=0 &&ÖOp->p1<
p
->
nCurs‹
 );

70756 
u
.
bs
.
pC
 = 
p
->
≠C§
[
pOp
->
p1
];

70757 
	`as£π
–
u
.
bs
.
pC
!=0 );

70758 
	`as£π
–
u
.
bs
.
pC
->
isS‹ãr
==(
pOp
->
›code
==
OP_S‹ãrIn£π
) );

70759 
pIn2
 = &
aMem
[
pOp
->
p2
];

70760 
	`as£π
–
pIn2
->
Êags
 & 
MEM_Blob
 );

70761 
u
.
bs
.
pCr§
 = u.bs.
pC
->
pCurs‹
;

70762 if–
	`ALWAYS
(
u
.
bs
.
pCr§
!=0) ){

70763 
	`as£π
–
u
.
bs
.
pC
->
isTabÀ
==0 );

70764 
rc
 = 
	`Ex∑ndBlob
(
pIn2
);

70765 if–
rc
==
SQLITE_OK
 ){

70766 if–
	`isS‹ãr
(
u
.
bs
.
pC
) ){

70767 
rc
 = 
	`sqlôe3VdbeS‹ãrWrôe
(
db
, 
u
.
bs
.
pC
, 
pIn2
);

70769 
u
.
bs
.
nKey
 = 
pIn2
->
n
;

70770 
u
.
bs
.
zKey
 = 
pIn2
->
z
;

70771 
rc
 = 
	`sqlôe3BåìIn£π
(
u
.
bs
.
pCr§
, u.bs.
zKey
, u.bs.
nKey
, "", 0, 0, 
pOp
->
p3
,

70772 ((
pOp
->
p5
 & 
OPFLAG_USESEEKRESULT
Ë? 
u
.
bs
.
pC
->
£ekResu…
 : 0)

70774 
	`as£π
–
u
.
bs
.
pC
->
de„ºedMovëo
==0 );

70775 
u
.
bs
.
pC
->
ˇcheSètus
 = 
CACHE_STALE
;

70788 
OP_IdxDñëe
: {

70790 
VdbeCurs‹
 *
pC
;

70791 
BtCurs‹
 *
pCr§
;

70792 
ªs
;

70793 
U≈ackedRec‹d
 
r
;

70796 
	`as£π
–
pOp
->
p3
>0 );

70797 
	`as£π
–
pOp
->
p2
>0 &&ÖOp->p2+pOp->
p3
<=(
p
->
nMem
-p->
nCurs‹
)+1 );

70798 
	`as£π
–
pOp
->
p1
>=0 &&ÖOp->p1<
p
->
nCurs‹
 );

70799 
u
.
bt
.
pC
 = 
p
->
≠C§
[
pOp
->
p1
];

70800 
	`as£π
–
u
.
bt
.
pC
!=0 );

70801 
u
.
bt
.
pCr§
 = u.bt.
pC
->
pCurs‹
;

70802 if–
	`ALWAYS
(
u
.
bt
.
pCr§
!=0) ){

70803 
u
.
bt
.
r
.
pKeyInfo
 = u.bt.
pC
->pKeyInfo;

70804 
u
.
bt
.
r
.
nFõld
 = (
u16
)
pOp
->
p3
;

70805 
u
.
bt
.
r
.
Êags
 = 0;

70806 
u
.
bt
.
r
.
aMem
 = &aMem[
pOp
->
p2
];

70807 #ifde‡
SQLITE_DEBUG


70808 { 
i
; i=0; i<
u
.
bt
.
r
.
nFõld
; i++Ë
	`as£π
–
	`memIsVÆid
(&u.bt.r.
aMem
[i]) ); }

70810 
rc
 = 
	`sqlôe3BåìMovëoU≈acked
(
u
.
bt
.
pCr§
, &u.bt.
r
, 0, 0, &u.bt.
ªs
);

70811 if–
rc
==
SQLITE_OK
 && 
u
.
bt
.
ªs
==0 ){

70812 
rc
 = 
	`sqlôe3BåìDñëe
(
u
.
bt
.
pCr§
);

70814 
	`as£π
–
u
.
bt
.
pC
->
de„ºedMovëo
==0 );

70815 
u
.
bt
.
pC
->
ˇcheSètus
 = 
CACHE_STALE
;

70828 
OP_IdxRowid
: {

70830 
BtCurs‹
 *
pCr§
;

70831 
VdbeCurs‹
 *
pC
;

70832 
i64
 
rowid
;

70835 
	`as£π
–
pOp
->
p1
>=0 &&ÖOp->p1<
p
->
nCurs‹
 );

70836 
u
.
bu
.
pC
 = 
p
->
≠C§
[
pOp
->
p1
];

70837 
	`as£π
–
u
.
bu
.
pC
!=0 );

70838 
u
.
bu
.
pCr§
 = u.bu.
pC
->
pCurs‹
;

70839 
pOut
->
Êags
 = 
MEM_NuŒ
;

70840 if–
	`ALWAYS
(
u
.
bu
.
pCr§
!=0) ){

70841 
rc
 = 
	`sqlôe3VdbeCurs‹Movëo
(
u
.
bu
.
pC
);

70842 if–
	`NEVER
(
rc
ËË
ab‹t_due_to_îr‹
;

70843 
	`as£π
–
u
.
bu
.
pC
->
de„ºedMovëo
==0 );

70844 
	`as£π
–
u
.
bu
.
pC
->
isTabÀ
==0 );

70845 if–!
u
.
bu
.
pC
->
nuŒRow
 ){

70846 
rc
 = 
	`sqlôe3VdbeIdxRowid
(
db
, 
u
.
bu
.
pCr§
, &u.bu.
rowid
);

70847 if–
rc
!=
SQLITE_OK
 ){

70848 
ab‹t_due_to_îr‹
;

70850 
pOut
->
u
.
i
 = u.
bu
.
rowid
;

70851 
pOut
->
Êags
 = 
MEM_I¡
;

70883 
OP_IdxLT
:

70884 
OP_IdxGE
: {

70886 
VdbeCurs‹
 *
pC
;

70887 
ªs
;

70888 
U≈ackedRec‹d
 
r
;

70891 
	`as£π
–
pOp
->
p1
>=0 &&ÖOp->p1<
p
->
nCurs‹
 );

70892 
u
.
bv
.
pC
 = 
p
->
≠C§
[
pOp
->
p1
];

70893 
	`as£π
–
u
.
bv
.
pC
!=0 );

70894 
	`as£π
–
u
.
bv
.
pC
->
isOrdîed
 );

70895 if–
	`ALWAYS
(
u
.
bv
.
pC
->
pCurs‹
!=0) ){

70896 
	`as£π
–
u
.
bv
.
pC
->
de„ºedMovëo
==0 );

70897 
	`as£π
–
pOp
->
p5
==0 ||ÖOp->p5==1 );

70898 
	`as£π
–
pOp
->
p4ty≥
==
P4_INT32
 );

70899 
u
.
bv
.
r
.
pKeyInfo
 = u.bv.
pC
->pKeyInfo;

70900 
u
.
bv
.
r
.
nFõld
 = (
u16
)
pOp
->
p4
.
i
;

70901 if–
pOp
->
p5
 ){

70902 
u
.
bv
.
r
.
Êags
 = 
UNPACKED_INCRKEY
 | 
UNPACKED_PREFIX_MATCH
;

70904 
u
.
bv
.
r
.
Êags
 = 
UNPACKED_PREFIX_MATCH
;

70906 
u
.
bv
.
r
.
aMem
 = &aMem[
pOp
->
p3
];

70907 #ifde‡
SQLITE_DEBUG


70908 { 
i
; i=0; i<
u
.
bv
.
r
.
nFõld
; i++Ë
	`as£π
–
	`memIsVÆid
(&u.bv.r.
aMem
[i]) ); }

70910 
rc
 = 
	`sqlôe3VdbeIdxKeyCom∑ª
(
u
.
bv
.
pC
, &u.bv.
r
, &u.bv.
ªs
);

70911 if–
pOp
->
›code
==
OP_IdxLT
 ){

70912 
u
.
bv
.
ªs
 = -u.bv.res;

70914 
	`as£π
–
pOp
->
›code
==
OP_IdxGE
 );

70915 
u
.
bv
.
ªs
++;

70917 if–
u
.
bv
.
ªs
>0 ){

70918 
pc
 = 
pOp
->
p2
 - 1 ;

70944 
OP_De°roy
: {

70946 
iMoved
;

70947 
iC¡
;

70948 
Vdbe
 *
pVdbe
;

70949 
iDb
;

70952 
	`as£π
–
p
->
ªadO∆y
==0 );

70953 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


70954 
u
.
bw
.
iC¡
 = 0;

70955 
u
.
bw
.
pVdbe
=
db
->pVdbe; u.bw.pVdbe; u.bw.pVdbêu.bw.pVdbe->
pNext
){

70956 if–
u
.
bw
.
pVdbe
->
magic
==
VDBE_MAGIC_RUN
 && u.bw.pVdbe->
bIsRódî


70957 && 
u
.
bw
.
pVdbe
->
öVèbMëhod
<2 && u.bw.pVdbe->
pc
>=0

70959 
u
.
bw
.
iC¡
++;

70963 
u
.
bw
.
iC¡
 = 
db
->
nVdbeRód
;

70965 
pOut
->
Êags
 = 
MEM_NuŒ
;

70966 if–
u
.
bw
.
iC¡
>1 ){

70967 
rc
 = 
SQLITE_LOCKED
;

70968 
p
->
îr‹A˘i⁄
 = 
OE_Ab‹t
;

70970 
u
.
bw
.
iDb
 = 
pOp
->
p3
;

70971 
	`as£π
–
u
.
bw
.
iC¡
==1 );

70972 
	`as£π
–(
p
->
båìMask
 & (((
yDbMask
)1)<<
u
.
bw
.
iDb
))!=0 );

70973 
rc
 = 
	`sqlôe3BåìDr›TabÀ
(
db
->
aDb
[
u
.
bw
.
iDb
].
pBt
, 
pOp
->
p1
, &u.bw.
iMoved
);

70974 
pOut
->
Êags
 = 
MEM_I¡
;

70975 
pOut
->
u
.
i
 = u.
bw
.
iMoved
;

70976 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


70977 if–
rc
==
SQLITE_OK
 && 
u
.
bw
.
iMoved
!=0 ){

70978 
	`sqlôe3RoŸPageMoved
(
db
, 
u
.
bw
.
iDb
, u.bw.
iMoved
, 
pOp
->
p1
);

70980 
	`as£π
–
ª£tSchemaOnFau…
==0 ||Ñe£tSchemaOnFau…==
u
.
bw
.
iDb
+1 );

70981 
ª£tSchemaOnFau…
 = 
u
.
bw
.
iDb
+1;

71006 
OP_CÀ¨
: {

71008 
nCh™ge
;

71011 
u
.
bx
.
nCh™ge
 = 0;

71012 
	`as£π
–
p
->
ªadO∆y
==0 );

71013 
	`as£π
–
pOp
->
p1
!=1 );

71014 
	`as£π
–(
p
->
båìMask
 & (((
yDbMask
)1)<<
pOp
->
p2
))!=0 );

71015 
rc
 = 
	`sqlôe3BåìCÀ¨TabÀ
(

71016 
db
->
aDb
[
pOp
->
p2
].
pBt
,ÖOp->
p1
, (pOp->
p3
 ? &
u
.
bx
.
nCh™ge
 : 0)

71018 if–
pOp
->
p3
 ){

71019 
p
->
nCh™ge
 +
u
.
bx
.nChange;

71020 if–
pOp
->
p3
>0 ){

71021 
	`as£π
–
	`memIsVÆid
(&
aMem
[
pOp
->
p3
]) );

71022 
	`memAboutToCh™ge
(
p
, &
aMem
[
pOp
->
p3
]);

71023 
aMem
[
pOp
->
p3
].
u
.
i
 +u.
bx
.
nCh™ge
;

71051 
OP_Cª©eIndex
:

71052 
OP_Cª©eTabÀ
: {

71054 
pgno
;

71055 
Êags
;

71056 
Db
 *
pDb
;

71059 
u
.
by
.
pgno
 = 0;

71060 
	`as£π
–
pOp
->
p1
>=0 &&ÖOp->p1<
db
->
nDb
 );

71061 
	`as£π
–(
p
->
båìMask
 & (((
yDbMask
)1)<<
pOp
->
p1
))!=0 );

71062 
	`as£π
–
p
->
ªadO∆y
==0 );

71063 
u
.
by
.
pDb
 = &
db
->
aDb
[
pOp
->
p1
];

71064 
	`as£π
–
u
.
by
.
pDb
->
pBt
!=0 );

71065 if–
pOp
->
›code
==
OP_Cª©eTabÀ
 ){

71067 
u
.
by
.
Êags
 = 
BTREE_INTKEY
;

71069 
u
.
by
.
Êags
 = 
BTREE_BLOBKEY
;

71071 
rc
 = 
	`sqlôe3BåìCª©eTabÀ
(
u
.
by
.
pDb
->
pBt
, &u.by.
pgno
, u.by.
Êags
);

71072 
pOut
->
u
.
i
 = u.
by
.
pgno
;

71084 
OP_P¨£Schema
: {

71086 
iDb
;

71087 c⁄° *
zMa°î
;

71088 *
zSql
;

71089 
InôD©a
 
öôD©a
;

71096 #ifde‡
SQLITE_DEBUG


71097 
u
.
bz
.
iDb
=0; u.bz.iDb<
db
->
nDb
; u.bz.iDb++){

71098 
	`as£π
–
u
.
bz
.
iDb
==1 || 
	`sqlôe3BåìHﬁdsMuãx
(
db
->
aDb
[u.bz.iDb].
pBt
) );

71102 
u
.
bz
.
iDb
 = 
pOp
->
p1
;

71103 
	`as£π
–
u
.
bz
.
iDb
>=0 && u.bz.iDb<
db
->
nDb
 );

71104 
	`as£π
–
	`DbHasPr›îty
(
db
, 
u
.
bz
.
iDb
, 
DB_SchemaLﬂded
) );

71106 
u
.
bz
.
zMa°î
 = 
	`SCHEMA_TABLE
(u.bz.
iDb
);

71107 
u
.
bz
.
öôD©a
.
db
 = db;

71108 
u
.
bz
.
öôD©a
.
iDb
 = 
pOp
->
p1
;

71109 
u
.
bz
.
öôD©a
.
pzEºMsg
 = &
p
->
zEºMsg
;

71110 
u
.
bz
.
zSql
 = 
	`sqlôe3MPrötf
(
db
,

71112 
db
->
aDb
[
u
.
bz
.
iDb
].
zName
, u.bz.
zMa°î
, 
pOp
->
p4
.
z
);

71113 if–
u
.
bz
.
zSql
==0 ){

71114 
rc
 = 
SQLITE_NOMEM
;

71116 
	`as£π
–
db
->
öô
.
busy
==0 );

71117 
db
->
öô
.
busy
 = 1;

71118 
u
.
bz
.
öôD©a
.
rc
 = 
SQLITE_OK
;

71119 
	`as£π
–!
db
->
mÆlocFaûed
 );

71120 
rc
 = 
	`sqlôe3_exec
(
db
, 
u
.
bz
.
zSql
, 
sqlôe3InôCÆlback
, &u.bz.
öôD©a
, 0);

71121 if–
rc
==
SQLITE_OK
 )Ñ¯
u
.
bz
.
öôD©a
.rc;

71122 
	`sqlôe3DbFªe
(
db
, 
u
.
bz
.
zSql
);

71123 
db
->
öô
.
busy
 = 0;

71126 if–
rc
 ) 
	`sqlôe3Re£tAŒSchemasOfC⁄√˘i⁄
(
db
);

71127 if–
rc
==
SQLITE_NOMEM
 ){

71128 
no_mem
;

71133 #i‡!
	`deföed
(
SQLITE_OMIT_ANALYZE
)

71140 
OP_LﬂdA«lysis
: {

71141 
	`as£π
–
pOp
->
p1
>=0 &&ÖOp->p1<
db
->
nDb
 );

71142 
rc
 = 
	`sqlôe3A«lysisLﬂd
(
db
, 
pOp
->
p1
);

71154 
OP_Dr›TabÀ
: {

71155 
	`sqlôe3U∆ökAndDñëeTabÀ
(
db
, 
pOp
->
p1
,ÖOp->
p4
.
z
);

71166 
OP_Dr›Index
: {

71167 
	`sqlôe3U∆ökAndDñëeIndex
(
db
, 
pOp
->
p1
,ÖOp->
p4
.
z
);

71178 
OP_Dr›Triggî
: {

71179 
	`sqlôe3U∆ökAndDñëeTriggî
(
db
, 
pOp
->
p1
,ÖOp->
p4
.
z
);

71184 #i‚de‡
SQLITE_OMIT_INTEGRITY_CHECK


71205 
OP_I¡egrôyCk
: {

71207 
nRoŸ
;

71208 *
aRoŸ
;

71209 
j
;

71210 
nEº
;

71211 *
z
;

71212 
Mem
 *
≤Eº
;

71215 
	`as£π
–
p
->
bIsRódî
 );

71216 
u
.
ˇ
.
nRoŸ
 = 
pOp
->
p2
;

71217 
	`as£π
–
u
.
ˇ
.
nRoŸ
>0 );

71218 
u
.
ˇ
.
aRoŸ
 = 
	`sqlôe3DbMÆlocRaw
(
db
, ()*(u.ˇ.
nRoŸ
+1) );

71219 if–
u
.
ˇ
.
aRoŸ
==0 ) 
no_mem
;

71220 
	`as£π
–
pOp
->
p3
>0 &&ÖOp->p3<=(
p
->
nMem
-p->
nCurs‹
) );

71221 
u
.
ˇ
.
≤Eº
 = &
aMem
[
pOp
->
p3
];

71222 
	`as£π
–(
u
.
ˇ
.
≤Eº
->
Êags
 & 
MEM_I¡
)!=0 );

71223 
	`as£π
–(
u
.
ˇ
.
≤Eº
->
Êags
 & (
MEM_Så
|
MEM_Blob
))==0 );

71224 
pIn1
 = &
aMem
[
pOp
->
p1
];

71225 
u
.
ˇ
.
j
=0; u.ˇ.j<u.ˇ.
nRoŸ
; u.ca.j++){

71226 
u
.
ˇ
.
aRoŸ
[u.ˇ.
j
] = ()
	`sqlôe3VdbeI¡VÆue
(&
pIn1
[u.ca.j]);

71228 
u
.
ˇ
.
aRoŸ
[u.ˇ.
j
] = 0;

71229 
	`as£π
–
pOp
->
p5
<
db
->
nDb
 );

71230 
	`as£π
–(
p
->
båìMask
 & (((
yDbMask
)1)<<
pOp
->
p5
))!=0 );

71231 
u
.
ˇ
.
z
 = 
	`sqlôe3BåìI¡egrôyCheck
(
db
->
aDb
[
pOp
->
p5
].
pBt
, u.ˇ.
aRoŸ
, u.ˇ.
nRoŸ
,

71232 ()
u
.
ˇ
.
≤Eº
->u.
i
, &u.ˇ.
nEº
);

71233 
	`sqlôe3DbFªe
(
db
, 
u
.
ˇ
.
aRoŸ
);

71234 
u
.
ˇ
.
≤Eº
->u.
i
 -u.ˇ.
nEº
;

71235 
	`sqlôe3VdbeMemSëNuŒ
(
pIn1
);

71236 if–
u
.
ˇ
.
nEº
==0 ){

71237 
	`as£π
–
u
.
ˇ
.
z
==0 );

71238 }if–
u
.
ˇ
.
z
==0 ){

71239 
no_mem
;

71241 
	`sqlôe3VdbeMemSëSå
(
pIn1
, 
u
.
ˇ
.
z
, -1, 
SQLITE_UTF8
, 
sqlôe3_‰ì
);

71243 
	`UPDATE_MAX_BLOBSIZE
(
pIn1
);

71244 
	`sqlôe3VdbeCh™geEncodög
(
pIn1
, 
ícodög
);

71256 
OP_RowSëAdd
: {

71257 
pIn1
 = &
aMem
[
pOp
->
p1
];

71258 
pIn2
 = &
aMem
[
pOp
->
p2
];

71259 
	`as£π
–(
pIn2
->
Êags
 & 
MEM_I¡
)!=0 );

71260 if–(
pIn1
->
Êags
 & 
MEM_RowSë
)==0 ){

71261 
	`sqlôe3VdbeMemSëRowSë
(
pIn1
);

71262 if–(
pIn1
->
Êags
 & 
MEM_RowSë
)==0 ) 
no_mem
;

71264 
	`sqlôe3RowSëIn£π
(
pIn1
->
u
.
pRowSë
, 
pIn2
->u.
i
);

71274 
OP_RowSëRód
: {

71276 
i64
 
vÆ
;

71279 
pIn1
 = &
aMem
[
pOp
->
p1
];

71280 if–(
pIn1
->
Êags
 & 
MEM_RowSë
)==0

71281 || 
	`sqlôe3RowSëNext
(
pIn1
->
u
.
pRowSë
, &u.
cb
.
vÆ
)==0

71284 
	`sqlôe3VdbeMemSëNuŒ
(
pIn1
);

71285 
pc
 = 
pOp
->
p2
 - 1;

71288 
	`sqlôe3VdbeMemSëI¡64
(&
aMem
[
pOp
->
p3
], 
u
.
cb
.
vÆ
);

71290 
check_f‹_öãºu±
;

71316 
OP_RowSëTe°
: {

71318 
iSë
;

71319 
exi°s
;

71322 
pIn1
 = &
aMem
[
pOp
->
p1
];

71323 
pIn3
 = &
aMem
[
pOp
->
p3
];

71324 
u
.
cc
.
iSë
 = 
pOp
->
p4
.
i
;

71325 
	`as£π
–
pIn3
->
Êags
&
MEM_I¡
 );

71330 if–(
pIn1
->
Êags
 & 
MEM_RowSë
)==0 ){

71331 
	`sqlôe3VdbeMemSëRowSë
(
pIn1
);

71332 if–(
pIn1
->
Êags
 & 
MEM_RowSë
)==0 ) 
no_mem
;

71335 
	`as£π
–
pOp
->
p4ty≥
==
P4_INT32
 );

71336 
	`as£π
–
u
.
cc
.
iSë
==-1 || u.cc.iSet>=0 );

71337 if–
u
.
cc
.
iSë
 ){

71338 
u
.
cc
.
exi°s
 = 
	`sqlôe3RowSëTe°
(
pIn1
->u.
pRowSë
,

71339 (
u8
)(
u
.
cc
.
iSë
>=0 ? u.cc.iSet & 0xf : 0xff),

71340 
pIn3
->
u
.
i
);

71341 if–
u
.
cc
.
exi°s
 ){

71342 
pc
 = 
pOp
->
p2
 - 1;

71346 if–
u
.
cc
.
iSë
>=0 ){

71347 
	`sqlôe3RowSëIn£π
(
pIn1
->
u
.
pRowSë
, 
pIn3
->u.
i
);

71353 #i‚de‡
SQLITE_OMIT_TRIGGER


71368 
OP_Progøm
: {

71370 
nMem
;

71371 
nByã
;

71372 
Mem
 *
pRt
;

71373 
Mem
 *
pMem
;

71374 
Mem
 *
pEnd
;

71375 
VdbeFøme
 *
pFøme
;

71376 
SubProgøm
 *
pProgøm
;

71377 *
t
;

71380 
u
.
cd
.
pProgøm
 = 
pOp
->
p4
.pProgram;

71381 
u
.
cd
.
pRt
 = &
aMem
[
pOp
->
p3
];

71382 
	`as£π
–
u
.
cd
.
pProgøm
->
nOp
>0 );

71395 if–
pOp
->
p5
 ){

71396 
u
.
cd
.
t
 = u.cd.
pProgøm
->
tokí
;

71397 
u
.
cd
.
pFøme
=
p
->pFøme; u.cd.pFømê&& u.cd.pFøme->
tokí
!=u.cd.
t
; u.cd.pFøme=u.cd.pFøme->
pP¨ít
);

71398 if–
u
.
cd
.
pFøme
 ) ;

71401 if–
p
->
nFøme
>=
db
->
aLimô
[
SQLITE_LIMIT_TRIGGER_DEPTH
] ){

71402 
rc
 = 
SQLITE_ERROR
;

71403 
	`sqlôe3SëSåög
(&
p
->
zEºMsg
, 
db
, "too manyÜevels ofÅriggerÑecursion");

71411 if–(
u
.
cd
.
pRt
->
Êags
&
MEM_Føme
)==0 ){

71417 
u
.
cd
.
nMem
 = u.cd.
pProgøm
->nMem + u.cd.pProgøm->
nC§
;

71418 
u
.
cd
.
nByã
 = 
	`ROUND8
((
VdbeFøme
))

71419 + 
u
.
cd
.
nMem
 * (
Mem
)

71420 + 
u
.
cd
.
pProgøm
->
nC§
 * (
VdbeCurs‹
 *)

71421 + 
u
.
cd
.
pProgøm
->
nOn˚
 * (
u8
);

71422 
u
.
cd
.
pFøme
 = 
	`sqlôe3DbMÆlocZîo
(
db
, u.cd.
nByã
);

71423 if–!
u
.
cd
.
pFøme
 ){

71424 
no_mem
;

71426 
	`sqlôe3VdbeMemRñó£
(
u
.
cd
.
pRt
);

71427 
u
.
cd
.
pRt
->
Êags
 = 
MEM_Føme
;

71428 
u
.
cd
.
pRt
->u.
pFøme
 = u.cd.pFrame;

71430 
u
.
cd
.
pFøme
->
v
 = 
p
;

71431 
u
.
cd
.
pFøme
->
nChûdMem
 = u.cd.
nMem
;

71432 
u
.
cd
.
pFøme
->
nChûdC§
 = u.cd.
pProgøm
->
nC§
;

71433 
u
.
cd
.
pFøme
->
pc
 =Öc;

71434 
u
.
cd
.
pFøme
->
aMem
 = 
p
->aMem;

71435 
u
.
cd
.
pFøme
->
nMem
 = 
p
->nMem;

71436 
u
.
cd
.
pFøme
->
≠C§
 = 
p
->apCsr;

71437 
u
.
cd
.
pFøme
->
nCurs‹
 = 
p
->nCursor;

71438 
u
.
cd
.
pFøme
->
aOp
 = 
p
->aOp;

71439 
u
.
cd
.
pFøme
->
nOp
 = 
p
->nOp;

71440 
u
.
cd
.
pFøme
->
tokí
 = u.cd.
pProgøm
->token;

71441 
u
.
cd
.
pFøme
->
aOn˚Fœg
 = 
p
->aOnceFlag;

71442 
u
.
cd
.
pFøme
->
nOn˚Fœg
 = 
p
->nOnceFlag;

71444 
u
.
cd
.
pEnd
 = &
	`VdbeFømeMem
(u.cd.
pFøme
)[u.cd.pFøme->
nChûdMem
];

71445 
u
.
cd
.
pMem
=
	`VdbeFømeMem
(u.cd.
pFøme
); u.cd.pMem!=u.cd.
pEnd
; u.cd.pMem++){

71446 
u
.
cd
.
pMem
->
Êags
 = 
MEM_InvÆid
;

71447 
u
.
cd
.
pMem
->
db
 = db;

71450 
u
.
cd
.
pFøme
 = u.cd.
pRt
->u.pFrame;

71451 
	`as£π
–
u
.
cd
.
pProgøm
->
nMem
+u.cd.pProgøm->
nC§
==u.cd.
pFøme
->
nChûdMem
 );

71452 
	`as£π
–
u
.
cd
.
pProgøm
->
nC§
==u.cd.
pFøme
->
nChûdC§
 );

71453 
	`as£π
–
pc
==
u
.
cd
.
pFøme
->pc );

71456 
p
->
nFøme
++;

71457 
u
.
cd
.
pFøme
->
pP¨ít
 = 
p
->pFrame;

71458 
u
.
cd
.
pFøme
->
œ°Rowid
 =ÜastRowid;

71459 
u
.
cd
.
pFøme
->
nCh™ge
 = 
p
->nChange;

71460 
p
->
nCh™ge
 = 0;

71461 
p
->
pFøme
 = 
u
.
cd
.pFrame;

71462 
p
->
aMem
 =áMem = &
	`VdbeFømeMem
(
u
.
cd
.
pFøme
)[-1];

71463 
p
->
nMem
 = 
u
.
cd
.
pFøme
->
nChûdMem
;

71464 
p
->
nCurs‹
 = (
u16
)
u
.
cd
.
pFøme
->
nChûdC§
;

71465 
p
->
≠C§
 = (
VdbeCurs‹
 **)&
aMem
[p->
nMem
+1];

71466 
p
->
aOp
 =áO∞
u
.
cd
.
pProgøm
->aOp;

71467 
p
->
nOp
 = 
u
.
cd
.
pProgøm
->nOp;

71468 
p
->
aOn˚Fœg
 = (
u8
 *)&p->
≠C§
[p->
nCurs‹
];

71469 
p
->
nOn˚Fœg
 = 
u
.
cd
.
pProgøm
->
nOn˚
;

71470 
pc
 = -1;

71471 
	`mem£t
(
p
->
aOn˚Fœg
, 0,Ö->
nOn˚Fœg
);

71488 
OP_P¨am
: {

71490 
VdbeFøme
 *
pFøme
;

71491 
Mem
 *
pIn
;

71493 
u
.
˚
.
pFøme
 = 
p
->pFrame;

71494 
u
.
˚
.
pIn
 = &u.˚.
pFøme
->
aMem
[
pOp
->
p1
 + u.˚.pFøme->
aOp
[u.˚.pFøme->
pc
].p1];

71495 
	`sqlôe3VdbeMemShÆlowC›y
(
pOut
, 
u
.
˚
.
pIn
, 
MEM_Ephem
);

71501 #i‚de‡
SQLITE_OMIT_FOREIGN_KEY


71509 
OP_FkCou¡î
: {

71510 if–
db
->
Êags
 & 
SQLITE_De„rFKs
 ){

71511 
db
->
nDe„ºedImmC⁄s
 +
pOp
->
p2
;

71512 }if–
pOp
->
p1
 ){

71513 
db
->
nDe„ºedC⁄s
 +
pOp
->
p2
;

71515 
p
->
nFkC⁄°øöt
 +
pOp
->
p2
;

71531 
OP_FkIfZîo
: {

71532 if–
pOp
->
p1
 ){

71533 if–
db
->
nDe„ºedC⁄s
==0 && db->
nDe„ºedImmC⁄s
==0 ) 
pc
 = 
pOp
->
p2
-1;

71535 if–
p
->
nFkC⁄°øöt
==0 && 
db
->
nDe„ºedImmC⁄s
==0 ) 
pc
 = 
pOp
->
p2
-1;

71541 #i‚de‡
SQLITE_OMIT_AUTOINCREMENT


71552 
OP_MemMax
: {

71554 
Mem
 *
pIn1
;

71555 
VdbeFøme
 *
pFøme
;

71557 if–
p
->
pFøme
 ){

71558 
u
.
cf
.
pFøme
=
p
->pFøme; u.cf.pFøme->
pP¨ít
; u.cf.pFrame=u.cf.pFrame->pParent);

71559 
u
.
cf
.
pIn1
 = &u.cf.
pFøme
->
aMem
[
pOp
->
p1
];

71561 
u
.
cf
.
pIn1
 = &
aMem
[
pOp
->
p1
];

71563 
	`as£π
–
	`memIsVÆid
(
u
.
cf
.
pIn1
) );

71564 
	`sqlôe3VdbeMemI¡egîify
(
u
.
cf
.
pIn1
);

71565 
pIn2
 = &
aMem
[
pOp
->
p2
];

71566 
	`sqlôe3VdbeMemI¡egîify
(
pIn2
);

71567 if–
u
.
cf
.
pIn1
->u.
i
<
pIn2
->u.i){

71568 
u
.
cf
.
pIn1
->u.
i
 = 
pIn2
->u.i;

71581 
OP_IfPos
: {

71582 
pIn1
 = &
aMem
[
pOp
->
p1
];

71583 
	`as£π
–
pIn1
->
Êags
&
MEM_I¡
 );

71584 if–
pIn1
->
u
.
i
>0 ){

71585 
pc
 = 
pOp
->
p2
 - 1;

71597 
OP_IfNeg
: {

71598 
pIn1
 = &
aMem
[
pOp
->
p1
];

71599 
	`as£π
–
pIn1
->
Êags
&
MEM_I¡
 );

71600 if–
pIn1
->
u
.
i
<0 ){

71601 
pc
 = 
pOp
->
p2
 - 1;

71614 
OP_IfZîo
: {

71615 
pIn1
 = &
aMem
[
pOp
->
p1
];

71616 
	`as£π
–
pIn1
->
Êags
&
MEM_I¡
 );

71617 
pIn1
->
u
.
i
 +
pOp
->
p3
;

71618 if–
pIn1
->
u
.
i
==0 ){

71619 
pc
 = 
pOp
->
p2
 - 1;

71634 
OP_AggSãp
: {

71636 
n
;

71637 
i
;

71638 
Mem
 *
pMem
;

71639 
Mem
 *
pRec
;

71640 
sqlôe3_c⁄ãxt
 
˘x
;

71641 
sqlôe3_vÆue
 **
≠VÆ
;

71644 
u
.
cg
.
n
 = 
pOp
->
p5
;

71645 
	`as£π
–
u
.
cg
.
n
>=0 );

71646 
u
.
cg
.
pRec
 = &
aMem
[
pOp
->
p2
];

71647 
u
.
cg
.
≠VÆ
 = 
p
->
≠Arg
;

71648 
	`as£π
–
u
.
cg
.
≠VÆ
 || u.cg.
n
==0 );

71649 
u
.
cg
.
i
=0; u.cg.i<u.cg.
n
; u.cg.i++, u.cg.
pRec
++){

71650 
	`as£π
–
	`memIsVÆid
(
u
.
cg
.
pRec
) );

71651 
u
.
cg
.
≠VÆ
[u.cg.
i
] = u.cg.
pRec
;

71652 
	`memAboutToCh™ge
(
p
, 
u
.
cg
.
pRec
);

71653 
	`sqlôe3VdbeMemSt‹eTy≥
(
u
.
cg
.
pRec
);

71655 
u
.
cg
.
˘x
.
pFunc
 = 
pOp
->
p4
.pFunc;

71656 
	`as£π
–
pOp
->
p3
>0 &&ÖOp->p3<=(
p
->
nMem
-p->
nCurs‹
) );

71657 
u
.
cg
.
˘x
.
pMem
 = u.cg.pMem = &
aMem
[
pOp
->
p3
];

71658 
u
.
cg
.
pMem
->
n
++;

71659 
u
.
cg
.
˘x
.
s
.
Êags
 = 
MEM_NuŒ
;

71660 
u
.
cg
.
˘x
.
s
.
z
 = 0;

71661 
u
.
cg
.
˘x
.
s
.
zMÆloc
 = 0;

71662 
u
.
cg
.
˘x
.
s
.
xDñ
 = 0;

71663 
u
.
cg
.
˘x
.
s
.
db
 = db;

71664 
u
.
cg
.
˘x
.
isEº‹
 = 0;

71665 
u
.
cg
.
˘x
.
pCﬁl
 = 0;

71666 
u
.
cg
.
˘x
.
skùFœg
 = 0;

71667 if–
u
.
cg
.
˘x
.
pFunc
->
funcFœgs
 & 
SQLITE_FUNC_NEEDCOLL
 ){

71668 
	`as£π
–
pOp
>
p
->
aOp
 );

71669 
	`as£π
–
pOp
[-1].
p4ty≥
==
P4_COLLSEQ
 );

71670 
	`as£π
–
pOp
[-1].
›code
==
OP_CﬁlSeq
 );

71671 
u
.
cg
.
˘x
.
pCﬁl
 = 
pOp
[-1].
p4
.pColl;

71673 (
u
.
cg
.
˘x
.
pFunc
->
xSãp
)(&u.cg.˘x, u.cg.
n
, u.cg.
≠VÆ
);

71674 if–
u
.
cg
.
˘x
.
isEº‹
 ){

71675 
	`sqlôe3SëSåög
(&
p
->
zEºMsg
, 
db
, "%s", 
	`sqlôe3_vÆue_ãxt
(&
u
.
cg
.
˘x
.
s
));

71676 
rc
 = 
u
.
cg
.
˘x
.
isEº‹
;

71678 if–
u
.
cg
.
˘x
.
skùFœg
 ){

71679 
	`as£π
–
pOp
[-1].
›code
==
OP_CﬁlSeq
 );

71680 
u
.
cg
.
i
 = 
pOp
[-1].
p1
;

71681 if–
u
.
cg
.
i
 ) 
	`sqlôe3VdbeMemSëI¡64
(&
aMem
[u.cg.i], 1);

71684 
	`sqlôe3VdbeMemRñó£
(&
u
.
cg
.
˘x
.
s
);

71701 
OP_AggFöÆ
: {

71703 
Mem
 *
pMem
;

71705 
	`as£π
–
pOp
->
p1
>0 &&ÖOp->p1<=(
p
->
nMem
-p->
nCurs‹
) );

71706 
u
.
ch
.
pMem
 = &
aMem
[
pOp
->
p1
];

71707 
	`as£π
–(
u
.
ch
.
pMem
->
Êags
 & ~(
MEM_NuŒ
|
MEM_Agg
))==0 );

71708 
rc
 = 
	`sqlôe3VdbeMemFöÆize
(
u
.
ch
.
pMem
, 
pOp
->
p4
.
pFunc
);

71709 if–
rc
 ){

71710 
	`sqlôe3SëSåög
(&
p
->
zEºMsg
, 
db
, "%s", 
	`sqlôe3_vÆue_ãxt
(
u
.
ch
.
pMem
));

71712 
	`sqlôe3VdbeCh™geEncodög
(
u
.
ch
.
pMem
, 
ícodög
);

71713 
	`UPDATE_MAX_BLOBSIZE
(
u
.
ch
.
pMem
);

71714 if–
	`sqlôe3VdbeMemTooBig
(
u
.
ch
.
pMem
) ){

71715 
too_big
;

71720 #i‚de‡
SQLITE_OMIT_WAL


71732 
OP_Checkpoöt
: {

71734 
i
;

71735 
aRes
[3];

71736 
Mem
 *
pMem
;

71739 
	`as£π
–
p
->
ªadO∆y
==0 );

71740 
u
.
ci
.
aRes
[0] = 0;

71741 
u
.
ci
.
aRes
[1] = u.ci.aRes[2] = -1;

71742 
	`as£π
–
pOp
->
p2
==
SQLITE_CHECKPOINT_PASSIVE


71743 || 
pOp
->
p2
==
SQLITE_CHECKPOINT_FULL


71744 || 
pOp
->
p2
==
SQLITE_CHECKPOINT_RESTART


71746 
rc
 = 
	`sqlôe3Checkpoöt
(
db
, 
pOp
->
p1
,ÖOp->
p2
, &
u
.
ci
.
aRes
[1], &u.ci.aRes[2]);

71747 if–
rc
==
SQLITE_BUSY
 ){

71748 
rc
 = 
SQLITE_OK
;

71749 
u
.
ci
.
aRes
[0] = 1;

71751 
u
.
ci
.
i
=0, u.ci.
pMem
 = &
aMem
[
pOp
->
p3
]; u.ci.i<3; u.ci.i++, u.ci.pMem++){

71752 
	`sqlôe3VdbeMemSëI¡64
(
u
.
ci
.
pMem
, (
i64
)u.ci.
aRes
[u.ci.
i
]);

71758 #i‚de‡
SQLITE_OMIT_PRAGMA


71770 
OP_Jou∫ÆMode
: {

71772 
Båì
 *
pBt
;

71773 
Pagî
 *
pPagî
;

71774 
eNew
;

71775 
eOld
;

71776 #i‚de‡
SQLITE_OMIT_WAL


71777 c⁄° *
zFûíame
;

71781 
u
.
cj
.
eNew
 = 
pOp
->
p3
;

71782 
	`as£π
–
u
.
cj
.
eNew
==
PAGER_JOURNALMODE_DELETE


71783 || 
u
.
cj
.
eNew
==
PAGER_JOURNALMODE_TRUNCATE


71784 || 
u
.
cj
.
eNew
==
PAGER_JOURNALMODE_PERSIST


71785 || 
u
.
cj
.
eNew
==
PAGER_JOURNALMODE_OFF


71786 || 
u
.
cj
.
eNew
==
PAGER_JOURNALMODE_MEMORY


71787 || 
u
.
cj
.
eNew
==
PAGER_JOURNALMODE_WAL


71788 || 
u
.
cj
.
eNew
==
PAGER_JOURNALMODE_QUERY


71790 
	`as£π
–
pOp
->
p1
>=0 &&ÖOp->p1<
db
->
nDb
 );

71791 
	`as£π
–
p
->
ªadO∆y
==0 );

71793 
u
.
cj
.
pBt
 = 
db
->
aDb
[
pOp
->
p1
].pBt;

71794 
u
.
cj
.
pPagî
 = 
	`sqlôe3BåìPagî
(u.cj.
pBt
);

71795 
u
.
cj
.
eOld
 = 
	`sqlôe3PagîGëJou∫ÆMode
(u.cj.
pPagî
);

71796 if–
u
.
cj
.
eNew
==
PAGER_JOURNALMODE_QUERY
 ) u.cj.eNew = u.cj.
eOld
;

71797 if–!
	`sqlôe3PagîOkToCh™geJou∫ÆMode
(
u
.
cj
.
pPagî
ËËu.cj.
eNew
 = u.cj.
eOld
;

71799 #i‚de‡
SQLITE_OMIT_WAL


71800 
u
.
cj
.
zFûíame
 = 
	`sqlôe3PagîFûíame
(u.cj.
pPagî
, 1);

71805 if–
u
.
cj
.
eNew
==
PAGER_JOURNALMODE_WAL


71806 && (
	`sqlôe3SåÀn30
(
u
.
cj
.
zFûíame
)==0

71807 || !
	`sqlôe3PagîWÆSuµ‹ãd
(
u
.
cj
.
pPagî
))

71809 
u
.
cj
.
eNew
 = u.cj.
eOld
;

71812 if–(
u
.
cj
.
eNew
!=u.cj.
eOld
)

71813 && (
u
.
cj
.
eOld
==
PAGER_JOURNALMODE_WAL
 || u.cj.
eNew
==PAGER_JOURNALMODE_WAL)

71815 if–!
db
->
autoCommô
 || db->
nVdbeRód
>1 ){

71816 
rc
 = 
SQLITE_ERROR
;

71817 
	`sqlôe3SëSåög
(&
p
->
zEºMsg
, 
db
,

71819 (
u
.
cj
.
eNew
==
PAGER_JOURNALMODE_WAL
 ? "into" : "out of")

71824 if–
u
.
cj
.
eOld
==
PAGER_JOURNALMODE_WAL
 ){

71830 
rc
 = 
	`sqlôe3PagîClo£WÆ
(
u
.
cj
.
pPagî
);

71831 if–
rc
==
SQLITE_OK
 ){

71832 
	`sqlôe3PagîSëJou∫ÆMode
(
u
.
cj
.
pPagî
, u.cj.
eNew
);

71834 }if–
u
.
cj
.
eOld
==
PAGER_JOURNALMODE_MEMORY
 ){

71837 
	`sqlôe3PagîSëJou∫ÆMode
(
u
.
cj
.
pPagî
, 
PAGER_JOURNALMODE_OFF
);

71843 
	`as£π
–
	`sqlôe3BåìIsInTøns
(
u
.
cj
.
pBt
)==0 );

71844 if–
rc
==
SQLITE_OK
 ){

71845 
rc
 = 
	`sqlôe3BåìSëVîsi⁄
(
u
.
cj
.
pBt
, (u.cj.
eNew
==
PAGER_JOURNALMODE_WAL
 ? 2 : 1));

71851 if–
rc
 ){

71852 
u
.
cj
.
eNew
 = u.cj.
eOld
;

71854 
u
.
cj
.
eNew
 = 
	`sqlôe3PagîSëJou∫ÆMode
(u.cj.
pPagî
, u.cj.eNew);

71856 
pOut
 = &
aMem
[
pOp
->
p2
];

71857 
pOut
->
Êags
 = 
MEM_Så
|
MEM_Sètic
|
MEM_Tîm
;

71858 
pOut
->
z
 = (*)
	`sqlôe3Jou∫ÆModíame
(
u
.
cj
.
eNew
);

71859 
pOut
->
n
 = 
	`sqlôe3SåÀn30
’Out->
z
);

71860 
pOut
->
íc
 = 
SQLITE_UTF8
;

71861 
	`sqlôe3VdbeCh™geEncodög
(
pOut
, 
ícodög
);

71866 #i‡!
	`deföed
(
SQLITE_OMIT_VACUUM
Ë&& !deföed(
SQLITE_OMIT_ATTACH
)

71873 
OP_Vacuum
: {

71874 
	`as£π
–
p
->
ªadO∆y
==0 );

71875 
rc
 = 
	`sqlôe3RunVacuum
(&
p
->
zEºMsg
, 
db
);

71880 #i‡!
	`deföed
(
SQLITE_OMIT_AUTOVACUUM
)

71887 
OP_In¸Vacuum
: {

71889 
Båì
 *
pBt
;

71892 
	`as£π
–
pOp
->
p1
>=0 &&ÖOp->p1<
db
->
nDb
 );

71893 
	`as£π
–(
p
->
båìMask
 & (((
yDbMask
)1)<<
pOp
->
p1
))!=0 );

71894 
	`as£π
–
p
->
ªadO∆y
==0 );

71895 
u
.
ck
.
pBt
 = 
db
->
aDb
[
pOp
->
p1
].pBt;

71896 
rc
 = 
	`sqlôe3BåìIn¸Vacuum
(
u
.
ck
.
pBt
);

71897 if–
rc
==
SQLITE_DONE
 ){

71898 
pc
 = 
pOp
->
p2
 - 1;

71899 
rc
 = 
SQLITE_OK
;

71914 
OP_Expúe
: {

71915 if–!
pOp
->
p1
 ){

71916 
	`sqlôe3ExpúePª∑ªdSèãmíts
(
db
);

71918 
p
->
expúed
 = 1;

71923 #i‚de‡
SQLITE_OMIT_SHARED_CACHE


71938 
OP_TabÀLock
: {

71939 
u8
 
isWrôeLock
 = (u8)
pOp
->
p3
;

71940 if–
isWrôeLock
 || 0==(
db
->
Êags
&
SQLITE_RódUncommôãd
) ){

71941 
p1
 = 
pOp
->p1;

71942 
	`as£π
–
p1
>=0 &&Ö1<
db
->
nDb
 );

71943 
	`as£π
–(
p
->
båìMask
 & (((
yDbMask
)1)<<
p1
))!=0 );

71944 
	`as£π
–
isWrôeLock
==0 || isWriteLock==1 );

71945 
rc
 = 
	`sqlôe3BåìLockTabÀ
(
db
->
aDb
[
p1
].
pBt
, 
pOp
->
p2
, 
isWrôeLock
);

71946 if–(
rc
&0xFF)==
SQLITE_LOCKED
 ){

71947 c⁄° *
z
 = 
pOp
->
p4
.z;

71948 
	`sqlôe3SëSåög
(&
p
->
zEºMsg
, 
db
, "d©aba£ÅabÀ i†locked: %s", 
z
);

71955 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


71965 
OP_VBegö
: {

71967 
VTabÀ
 *
pVTab
;

71969 
u
.
˛
.
pVTab
 = 
pOp
->
p4
.
pVèb
;

71970 
rc
 = 
	`sqlôe3VèbBegö
(
db
, 
u
.
˛
.
pVTab
);

71971 if–
u
.
˛
.
pVTab
 ) 
	`sqlôe3VèbImp‹tEºmsg
(
p
, u.˛.pVTab->
pVèb
);

71976 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


71982 
OP_VCª©e
: {

71983 
rc
 = 
	`sqlôe3VèbCÆlCª©e
(
db
, 
pOp
->
p1
,ÖOp->
p4
.
z
, &
p
->
zEºMsg
);

71988 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


71994 
OP_VDe°roy
: {

71995 
p
->
öVèbMëhod
 = 2;

71996 
rc
 = 
	`sqlôe3VèbCÆlDe°roy
(
db
, 
pOp
->
p1
,ÖOp->
p4
.
z
);

71997 
p
->
öVèbMëhod
 = 0;

72002 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


72009 
OP_VO≥n
: {

72011 
VdbeCurs‹
 *
pCur
;

72012 
sqlôe3_vèb_curs‹
 *
pVèbCurs‹
;

72013 
sqlôe3_vèb
 *
pVèb
;

72014 
sqlôe3_moduÀ
 *
pModuÀ
;

72017 
	`as£π
–
p
->
bIsRódî
 );

72018 
u
.
cm
.
pCur
 = 0;

72019 
u
.
cm
.
pVèbCurs‹
 = 0;

72020 
u
.
cm
.
pVèb
 = 
pOp
->
p4
.pVtab->pVtab;

72021 
u
.
cm
.
pModuÀ
 = (
sqlôe3_moduÀ
 *)u.cm.
pVèb
->pModule;

72022 
	`as£π
(
u
.
cm
.
pVèb
 && u.cm.
pModuÀ
);

72023 
rc
 = 
u
.
cm
.
pModuÀ
->
	`xO≥n
(u.cm.
pVèb
, &u.cm.
pVèbCurs‹
);

72024 
	`sqlôe3VèbImp‹tEºmsg
(
p
, 
u
.
cm
.
pVèb
);

72025 if–
SQLITE_OK
==
rc
 ){

72027 
u
.
cm
.
pVèbCurs‹
->
pVèb
 = u.cm.pVtab;

72030 
u
.
cm
.
pCur
 = 
	`ÆloˇãCurs‹
(
p
, 
pOp
->
p1
, 0, -1, 0);

72031 if–
u
.
cm
.
pCur
 ){

72032 
u
.
cm
.
pCur
->
pVèbCurs‹
 = u.cm.pVtabCursor;

72033 
u
.
cm
.
pCur
->
pModuÀ
 = u.cm.
pVèbCurs‹
->
pVèb
->pModule;

72035 
db
->
mÆlocFaûed
 = 1;

72036 
u
.
cm
.
pModuÀ
->
	`xClo£
(u.cm.
pVèbCurs‹
);

72043 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


72062 
OP_VFûãr
: {

72064 
nArg
;

72065 
iQuîy
;

72066 c⁄° 
sqlôe3_moduÀ
 *
pModuÀ
;

72067 
Mem
 *
pQuîy
;

72068 
Mem
 *
pArgc
;

72069 
sqlôe3_vèb_curs‹
 *
pVèbCurs‹
;

72070 
sqlôe3_vèb
 *
pVèb
;

72071 
VdbeCurs‹
 *
pCur
;

72072 
ªs
;

72073 
i
;

72074 
Mem
 **
≠Arg
;

72077 
u
.
˙
.
pQuîy
 = &
aMem
[
pOp
->
p3
];

72078 
u
.
˙
.
pArgc
 = &u.˙.
pQuîy
[1];

72079 
u
.
˙
.
pCur
 = 
p
->
≠C§
[
pOp
->
p1
];

72080 
	`as£π
–
	`memIsVÆid
(
u
.
˙
.
pQuîy
) );

72081 
	`REGISTER_TRACE
(
pOp
->
p3
, 
u
.
˙
.
pQuîy
);

72082 
	`as£π
–
u
.
˙
.
pCur
->
pVèbCurs‹
 );

72083 
u
.
˙
.
pVèbCurs‹
 = u.˙.
pCur
->pVtabCursor;

72084 
u
.
˙
.
pVèb
 = u.˙.
pVèbCurs‹
->pVtab;

72085 
u
.
˙
.
pModuÀ
 = u.˙.
pVèb
->pModule;

72088 
	`as£π
–(
u
.
˙
.
pQuîy
->
Êags
&
MEM_I¡
)!=0 && u.˙.
pArgc
->flags==MEM_Int );

72089 
u
.
˙
.
nArg
 = ()u.˙.
pArgc
->u.
i
;

72090 
u
.
˙
.
iQuîy
 = ()u.˙.
pQuîy
->u.
i
;

72094 
u
.
˙
.
ªs
 = 0;

72095 
u
.
˙
.
≠Arg
 = 
p
->apArg;

72096 
u
.
˙
.
i
 = 0; u.˙.i<u.˙.
nArg
; u.cn.i++){

72097 
u
.
˙
.
≠Arg
[u.˙.
i
] = &u.˙.
pArgc
[u.cn.i+1];

72098 
	`sqlôe3VdbeMemSt‹eTy≥
(
u
.
˙
.
≠Arg
[u.˙.
i
]);

72101 
p
->
öVèbMëhod
 = 1;

72102 
rc
 = 
u
.
˙
.
pModuÀ
->
	`xFûãr
(u.˙.
pVèbCurs‹
, u.˙.
iQuîy
, 
pOp
->
p4
.
z
, u.˙.
nArg
, u.˙.
≠Arg
);

72103 
p
->
öVèbMëhod
 = 0;

72104 
	`sqlôe3VèbImp‹tEºmsg
(
p
, 
u
.
˙
.
pVèb
);

72105 if–
rc
==
SQLITE_OK
 ){

72106 
u
.
˙
.
ªs
 = u.˙.
pModuÀ
->
	`xEof
(u.˙.
pVèbCurs‹
);

72109 if–
u
.
˙
.
ªs
 ){

72110 
pc
 = 
pOp
->
p2
 - 1;

72113 
u
.
˙
.
pCur
->
nuŒRow
 = 0;

72119 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


72126 
OP_VCﬁumn
: {

72128 
sqlôe3_vèb
 *
pVèb
;

72129 c⁄° 
sqlôe3_moduÀ
 *
pModuÀ
;

72130 
Mem
 *
pDe°
;

72131 
sqlôe3_c⁄ãxt
 
sC⁄ãxt
;

72134 
VdbeCurs‹
 *
pCur
 = 
p
->
≠C§
[
pOp
->
p1
];

72135 
	`as£π
–
pCur
->
pVèbCurs‹
 );

72136 
	`as£π
–
pOp
->
p3
>0 &&ÖOp->p3<=(
p
->
nMem
-p->
nCurs‹
) );

72137 
u
.
co
.
pDe°
 = &
aMem
[
pOp
->
p3
];

72138 
	`memAboutToCh™ge
(
p
, 
u
.
co
.
pDe°
);

72139 if–
pCur
->
nuŒRow
 ){

72140 
	`sqlôe3VdbeMemSëNuŒ
(
u
.
co
.
pDe°
);

72143 
u
.
co
.
pVèb
 = 
pCur
->
pVèbCurs‹
->pVtab;

72144 
u
.
co
.
pModuÀ
 = u.co.
pVèb
->pModule;

72145 
	`as£π
–
u
.
co
.
pModuÀ
->
xCﬁumn
 );

72146 
	`mem£t
(&
u
.
co
.
sC⁄ãxt
, 0, (u.co.sContext));

72153 
	`sqlôe3VdbeMemMove
(&
u
.
co
.
sC⁄ãxt
.
s
, u.co.
pDe°
);

72154 
	`MemSëTy≥Fœg
(&
u
.
co
.
sC⁄ãxt
.
s
, 
MEM_NuŒ
);

72156 
rc
 = 
u
.
co
.
pModuÀ
->
	`xCﬁumn
(
pCur
->
pVèbCurs‹
, &u.co.
sC⁄ãxt
, 
pOp
->
p2
);

72157 
	`sqlôe3VèbImp‹tEºmsg
(
p
, 
u
.
co
.
pVèb
);

72158 if–
u
.
co
.
sC⁄ãxt
.
isEº‹
 ){

72159 
rc
 = 
u
.
co
.
sC⁄ãxt
.
isEº‹
;

72166 
	`sqlôe3VdbeCh™geEncodög
(&
u
.
co
.
sC⁄ãxt
.
s
, 
ícodög
);

72167 
	`sqlôe3VdbeMemMove
(
u
.
co
.
pDe°
, &u.co.
sC⁄ãxt
.
s
);

72168 
	`REGISTER_TRACE
(
pOp
->
p3
, 
u
.
co
.
pDe°
);

72169 
	`UPDATE_MAX_BLOBSIZE
(
u
.
co
.
pDe°
);

72171 if–
	`sqlôe3VdbeMemTooBig
(
u
.
co
.
pDe°
) ){

72172 
too_big
;

72178 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


72185 
OP_VNext
: {

72187 
sqlôe3_vèb
 *
pVèb
;

72188 c⁄° 
sqlôe3_moduÀ
 *
pModuÀ
;

72189 
ªs
;

72190 
VdbeCurs‹
 *
pCur
;

72193 
u
.
˝
.
ªs
 = 0;

72194 
u
.
˝
.
pCur
 = 
p
->
≠C§
[
pOp
->
p1
];

72195 
	`as£π
–
u
.
˝
.
pCur
->
pVèbCurs‹
 );

72196 if–
u
.
˝
.
pCur
->
nuŒRow
 ){

72199 
u
.
˝
.
pVèb
 = u.˝.
pCur
->
pVèbCurs‹
->pVtab;

72200 
u
.
˝
.
pModuÀ
 = u.˝.
pVèb
->pModule;

72201 
	`as£π
–
u
.
˝
.
pModuÀ
->
xNext
 );

72209 
p
->
öVèbMëhod
 = 1;

72210 
rc
 = 
u
.
˝
.
pModuÀ
->
	`xNext
(u.˝.
pCur
->
pVèbCurs‹
);

72211 
p
->
öVèbMëhod
 = 0;

72212 
	`sqlôe3VèbImp‹tEºmsg
(
p
, 
u
.
˝
.
pVèb
);

72213 if–
rc
==
SQLITE_OK
 ){

72214 
u
.
˝
.
ªs
 = u.˝.
pModuÀ
->
	`xEof
(u.˝.
pCur
->
pVèbCurs‹
);

72217 if–!
u
.
˝
.
ªs
 ){

72219 
pc
 = 
pOp
->
p2
 - 1;

72221 
check_f‹_öãºu±
;

72225 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


72232 
OP_VRíame
: {

72234 
sqlôe3_vèb
 *
pVèb
;

72235 
Mem
 *
pName
;

72238 
u
.
cq
.
pVèb
 = 
pOp
->
p4
.pVtab->pVtab;

72239 
u
.
cq
.
pName
 = &
aMem
[
pOp
->
p1
];

72240 
	`as£π
–
u
.
cq
.
pVèb
->
pModuÀ
->
xRíame
 );

72241 
	`as£π
–
	`memIsVÆid
(
u
.
cq
.
pName
) );

72242 
	`as£π
–
p
->
ªadO∆y
==0 );

72243 
	`REGISTER_TRACE
(
pOp
->
p1
, 
u
.
cq
.
pName
);

72244 
	`as£π
–
u
.
cq
.
pName
->
Êags
 & 
MEM_Så
 );

72245 
	`ã°ˇ£
–
u
.
cq
.
pName
->
íc
==
SQLITE_UTF8
 );

72246 
	`ã°ˇ£
–
u
.
cq
.
pName
->
íc
==
SQLITE_UTF16BE
 );

72247 
	`ã°ˇ£
–
u
.
cq
.
pName
->
íc
==
SQLITE_UTF16LE
 );

72248 
rc
 = 
	`sqlôe3VdbeCh™geEncodög
(
u
.
cq
.
pName
, 
SQLITE_UTF8
);

72249 if–
rc
==
SQLITE_OK
 ){

72250 
rc
 = 
u
.
cq
.
pVèb
->
pModuÀ
->
	`xRíame
(u.cq.pVèb, u.cq.
pName
->
z
);

72251 
	`sqlôe3VèbImp‹tEºmsg
(
p
, 
u
.
cq
.
pVèb
);

72252 
p
->
expúed
 = 0;

72258 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


72282 
OP_VUpd©e
: {

72284 
sqlôe3_vèb
 *
pVèb
;

72285 
sqlôe3_moduÀ
 *
pModuÀ
;

72286 
nArg
;

72287 
i
;

72288 
sqlôe_öt64
 
rowid
;

72289 
Mem
 **
≠Arg
;

72290 
Mem
 *
pX
;

72293 
	`as£π
–
pOp
->
p2
==1 ||ÖOp->
p5
==
OE_Faû
 ||ÖOp->p5==
OE_Rﬁlback


72294 || 
pOp
->
p5
==
OE_Ab‹t
 ||ÖOp->p5==
OE_Ign‹e
 ||ÖOp->p5==
OE_Rïœ˚


72296 
	`as£π
–
p
->
ªadO∆y
==0 );

72297 
u
.
¸
.
pVèb
 = 
pOp
->
p4
.pVtab->pVtab;

72298 
u
.
¸
.
pModuÀ
 = (
sqlôe3_moduÀ
 *)u.¸.
pVèb
->pModule;

72299 
u
.
¸
.
nArg
 = 
pOp
->
p2
;

72300 
	`as£π
–
pOp
->
p4ty≥
==
P4_VTAB
 );

72301 if–
	`ALWAYS
(
u
.
¸
.
pModuÀ
->
xUpd©e
) ){

72302 
u8
 
vèbOnC⁄Êi˘
 = 
db
->vtabOnConflict;

72303 
u
.
¸
.
≠Arg
 = 
p
->apArg;

72304 
u
.
¸
.
pX
 = &
aMem
[
pOp
->
p3
];

72305 
u
.
¸
.
i
=0; u.¸.i<u.¸.
nArg
; u.cr.i++){

72306 
	`as£π
–
	`memIsVÆid
(
u
.
¸
.
pX
) );

72307 
	`memAboutToCh™ge
(
p
, 
u
.
¸
.
pX
);

72308 
	`sqlôe3VdbeMemSt‹eTy≥
(
u
.
¸
.
pX
);

72309 
u
.
¸
.
≠Arg
[u.¸.
i
] = u.¸.
pX
;

72310 
u
.
¸
.
pX
++;

72312 
db
->
vèbOnC⁄Êi˘
 = 
pOp
->
p5
;

72313 
rc
 = 
u
.
¸
.
pModuÀ
->
	`xUpd©e
(u.¸.
pVèb
, u.¸.
nArg
, u.¸.
≠Arg
, &u.¸.
rowid
);

72314 
db
->
vèbOnC⁄Êi˘
 = vtabOnConflict;

72315 
	`sqlôe3VèbImp‹tEºmsg
(
p
, 
u
.
¸
.
pVèb
);

72316 if–
rc
==
SQLITE_OK
 && 
pOp
->
p1
 ){

72317 
	`as£π
–
u
.
¸
.
nArg
>1 && u.¸.
≠Arg
[0] && (u.¸.≠Arg[0]->
Êags
&
MEM_NuŒ
) );

72318 
db
->
œ°Rowid
 =Üa°Rowid = 
u
.
¸
.
rowid
;

72320 if–(
rc
&0xff)==
SQLITE_CONSTRAINT
 && 
pOp
->
p4
.
pVèb
->
bC⁄°øöt
 ){

72321 if–
pOp
->
p5
==
OE_Ign‹e
 ){

72322 
rc
 = 
SQLITE_OK
;

72324 
p
->
îr‹A˘i⁄
 = ((
pOp
->
p5
==
OE_Rïœ˚
Ë? 
OE_Ab‹t
 :ÖOp->p5);

72327 
p
->
nCh™ge
++;

72334 #i‚de‡ 
SQLITE_OMIT_PAGER_PRAGMAS


72339 
OP_Pagecou¡
: {

72340 
pOut
->
u
.
i
 = 
	`sqlôe3BåìLa°Page
(
db
->
aDb
[
pOp
->
p1
].
pBt
);

72346 #i‚de‡ 
SQLITE_OMIT_PAGER_PRAGMAS


72355 
OP_MaxPg˙t
: {

72356 
√wMax
;

72357 
Båì
 *
pBt
;

72359 
pBt
 = 
db
->
aDb
[
pOp
->
p1
].pBt;

72360 
√wMax
 = 0;

72361 if–
pOp
->
p3
 ){

72362 
√wMax
 = 
	`sqlôe3BåìLa°Page
(
pBt
);

72363 if–
√wMax
 < ()
pOp
->
p3
 )ÇewMax = ()pOp->p3;

72365 
pOut
->
u
.
i
 = 
	`sqlôe3BåìMaxPageCou¡
(
pBt
, 
√wMax
);

72371 #i‚de‡
SQLITE_OMIT_TRACE


72377 
OP_Tø˚
: {

72379 *
zTø˚
;

72380 *
z
;

72383 if–
db
->
xTø˚


72384 && !
p
->
doögRîun


72385 && (
u
.
cs
.
zTø˚
 = (
pOp
->
p4
.
z
 ?ÖOp->p4.z : 
p
->
zSql
))!=0

72387 
u
.
cs
.
z
 = 
	`sqlôe3VdbeEx∑ndSql
(
p
, u.cs.
zTø˚
);

72388 
db
->
	`xTø˚
(db->
pTø˚Arg
, 
u
.
cs
.
z
);

72389 
	`sqlôe3DbFªe
(
db
, 
u
.
cs
.
z
);

72391 #ifde‡
SQLITE_DEBUG


72392 if–(
db
->
Êags
 & 
SQLITE_SqlTø˚
)!=0

72393 && (
u
.
cs
.
zTø˚
 = (
pOp
->
p4
.
z
 ?ÖOp->p4.z : 
p
->
zSql
))!=0

72395 
	`sqlôe3DebugPrötf
("SQL-åa˚: %s\n", 
u
.
cs
.
zTø˚
);

72415 
	`as£π
–
pOp
->
›code
==
OP_No›
 ||ÖOp->›code==
OP_Ex∂aö
 );

72427 #ifde‡
VDBE_PROFILE


72429 
u64
 
ñ≠£d
 = 
	`sqlôe3Hwtime
(Ë- 
°¨t
;

72430 
pOp
->
cy˛es
 +
ñ≠£d
;

72431 
pOp
->
˙t
++;

72433 
	`Ârötf
(
°dout
, "%10Œu ", 
ñ≠£d
);

72434 
	`sqlôe3VdbePrötOp
(
°dout
, 
‹igPc
, &
aOp
[origPc]);

72444 #i‚de‡
NDEBUG


72445 
	`as£π
–
pc
>=-1 &&Öc<
p
->
nOp
 );

72447 #ifde‡
SQLITE_DEBUG


72448 if–
p
->
åa˚
 ){

72449 if–
rc
!=0 ) 
	`Ârötf
(
p
->
åa˚
,"rc=%d\n",rc);

72450 if–
pOp
->
›Êags
 & (
OPFLG_OUT2_PRERELEASE
|
OPFLG_OUT2
) ){

72451 
	`ªgi°îTø˚
(
p
->
åa˚
, 
pOp
->
p2
, &
aMem
[pOp->p2]);

72453 if–
pOp
->
›Êags
 & 
OPFLG_OUT3
 ){

72454 
	`ªgi°îTø˚
(
p
->
åa˚
, 
pOp
->
p3
, &
aMem
[pOp->p3]);

72464 
vdbe_îr‹_hÆt
:

72465 
	`as£π
–
rc
 );

72466 
p
->
rc
 =Ñc;

72467 
	`ã°ˇ£
–
sqlôe3GlobÆC⁄fig
.
xLog
!=0 );

72468 
	`sqlôe3_log
(
rc
, "statementábortsát %d: [%s] %s",

72469 
pc
, 
p
->
zSql
,Ö->
zEºMsg
);

72470 
	`sqlôe3VdbeHÆt
(
p
);

72471 if–
rc
==
SQLITE_IOERR_NOMEM
 ) 
db
->
mÆlocFaûed
 = 1;

72472 
rc
 = 
SQLITE_ERROR
;

72473 if–
ª£tSchemaOnFau…
>0 ){

72474 
	`sqlôe3Re£tO√Schema
(
db
, 
ª£tSchemaOnFau…
-1);

72480 
vdbe_ªtu∫
:

72481 
db
->
œ°Rowid
 =ÜastRowid;

72482 
	`ã°ˇ£
–
nVmSãp
>0 );

72483 
p
->
aCou¡î
[
SQLITE_STMTSTATUS_VM_STEP
] +()
nVmSãp
;

72484 
	`sqlôe3VdbeLóve
(
p
);

72485  
rc
;

72490 
too_big
:

72491 
	`sqlôe3SëSåög
(&
p
->
zEºMsg
, 
db
, "string or blobÅoo big");

72492 
rc
 = 
SQLITE_TOOBIG
;

72493 
vdbe_îr‹_hÆt
;

72497 
no_mem
:

72498 
db
->
mÆlocFaûed
 = 1;

72499 
	`sqlôe3SëSåög
(&
p
->
zEºMsg
, 
db
, "out of memory");

72500 
rc
 = 
SQLITE_NOMEM
;

72501 
vdbe_îr‹_hÆt
;

72506 
ab‹t_due_to_îr‹
:

72507 
	`as£π
–
p
->
zEºMsg
==0 );

72508 if–
db
->
mÆlocFaûed
 ) 
rc
 = 
SQLITE_NOMEM
;

72509 if–
rc
!=
SQLITE_IOERR_NOMEM
 ){

72510 
	`sqlôe3SëSåög
(&
p
->
zEºMsg
, 
db
, "%s", 
	`sqlôe3EºSå
(
rc
));

72512 
vdbe_îr‹_hÆt
;

72517 
ab‹t_due_to_öãºu±
:

72518 
	`as£π
–
db
->
u1
.
isI¡îru±ed
 );

72519 
rc
 = 
SQLITE_INTERRUPT
;

72520 
p
->
rc
 =Ñc;

72521 
	`sqlôe3SëSåög
(&
p
->
zEºMsg
, 
db
, "%s", 
	`sqlôe3EºSå
(
rc
));

72522 
vdbe_îr‹_hÆt
;

72543 #i‚de‡
SQLITE_OMIT_INCRBLOB


72548 
In¸blob
 
	tIn¸blob
;

72549 
	sIn¸blob
 {

72550 
Êags
;

72551 
nByã
;

72552 
iOff£t
;

72553 
iCﬁ
;

72554 
BtCurs‹
 *
pC§
;

72555 
sqlôe3_°mt
 *
pStmt
;

72556 
sqlôe3
 *
db
;

72577 
	`blobSìkToRow
(
In¸blob
 *
p
, 
sqlôe3_öt64
 
iRow
, **
pzEº
){

72578 
rc
;

72579 *
zEº
 = 0;

72580 
Vdbe
 *
v
 = (Vdbê*)
p
->
pStmt
;

72586 
	`as£π
–
v
->
aV¨
[0].
Êags
&
MEM_I¡
 );

72587 
v
->
aV¨
[0].
u
.
i
 = 
iRow
;

72589 
rc
 = 
	`sqlôe3_°ï
(
p
->
pStmt
);

72590 if–
rc
==
SQLITE_ROW
 ){

72591 
u32
 
ty≥
 = 
v
->
≠C§
[0]->
aTy≥
[
p
->
iCﬁ
];

72592 if–
ty≥
<12 ){

72593 
zEº
 = 
	`sqlôe3MPrötf
(
p
->
db
, "cannot open value ofÅype %s",

72594 
ty≥
==0?"null":Åype==7?"real": "integer"

72596 
rc
 = 
SQLITE_ERROR
;

72597 
	`sqlôe3_föÆize
(
p
->
pStmt
);

72598 
p
->
pStmt
 = 0;

72600 
p
->
iOff£t
 = 
v
->
≠C§
[0]->
aOff£t
[p->
iCﬁ
];

72601 
p
->
nByã
 = 
	`sqlôe3VdbeSîülTy≥Lí
(
ty≥
);

72602 
p
->
pC§
 = 
v
->
≠C§
[0]->
pCurs‹
;

72603 
	`sqlôe3BåìE¡îCurs‹
(
p
->
pC§
);

72604 
	`sqlôe3BåìCacheOvîÊow
(
p
->
pC§
);

72605 
	`sqlôe3BåìLóveCurs‹
(
p
->
pC§
);

72609 if–
rc
==
SQLITE_ROW
 ){

72610 
rc
 = 
SQLITE_OK
;

72611 }if–
p
->
pStmt
 ){

72612 
rc
 = 
	`sqlôe3_föÆize
(
p
->
pStmt
);

72613 
p
->
pStmt
 = 0;

72614 if–
rc
==
SQLITE_OK
 ){

72615 
zEº
 = 
	`sqlôe3MPrötf
(
p
->
db
, "nÿsuchÑowid: %Œd", 
iRow
);

72616 
rc
 = 
SQLITE_ERROR
;

72618 
zEº
 = 
	`sqlôe3MPrötf
(
p
->
db
, "%s", 
	`sqlôe3_îrmsg
(p->db));

72622 
	`as£π
–
rc
!=
SQLITE_OK
 || 
zEº
==0 );

72623 
	`as£π
–
rc
!=
SQLITE_ROW
 &&Ñc!=
SQLITE_DONE
 );

72625 *
pzEº
 = 
zEº
;

72626  
rc
;

72632 
SQLITE_API
 
	`sqlôe3_blob_›í
(

72633 
sqlôe3
* 
db
,

72634 c⁄° *
zDb
,

72635 c⁄° *
zTabÀ
,

72636 c⁄° *
zCﬁumn
,

72637 
sqlôe_öt64
 
iRow
,

72638 
Êags
,

72639 
sqlôe3_blob
 **
µBlob


72641 
nAâem±
 = 0;

72642 
iCﬁ
;

72659 c⁄° 
VdbeOpLi°
 
›íBlob
[] = {

72660 {
OP_Tønß˘i⁄
, 0, 0, 0},

72661 {
OP_VîifyCookõ
, 0, 0, 0},

72662 {
OP_TabÀLock
, 0, 0, 0},

72665 {
OP_O≥nRód
, 0, 0, 0},

72666 {
OP_O≥nWrôe
, 0, 0, 0},

72668 {
OP_V¨übÀ
, 1, 1, 1},

72669 {
OP_NŸExi°s
, 0, 10, 1},

72670 {
OP_Cﬁumn
, 0, 0, 1},

72671 {
OP_Resu…Row
, 1, 0, 0},

72672 {
OP_GŸo
, 0, 5, 0},

72673 {
OP_Clo£
, 0, 0, 0},

72674 {
OP_HÆt
, 0, 0, 0},

72677 
rc
 = 
SQLITE_OK
;

72678 *
zEº
 = 0;

72679 
TabÀ
 *
pTab
;

72680 
P¨£
 *
pP¨£
 = 0;

72681 
In¸blob
 *
pBlob
 = 0;

72683 
Êags
 = !!flags;

72684 *
µBlob
 = 0;

72686 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

72688 
pBlob
 = (
In¸blob
 *)
	`sqlôe3DbMÆlocZîo
(
db
, (Incrblob));

72689 if–!
pBlob
 ) 
blob_›í_out
;

72690 
pP¨£
 = 
	`sqlôe3SèckAŒocRaw
(
db
, (*pParse));

72691 if–!
pP¨£
 ) 
blob_›í_out
;

72694 
	`mem£t
(
pP¨£
, 0, (
P¨£
));

72695 
pP¨£
->
db
 = db;

72696 
	`sqlôe3DbFªe
(
db
, 
zEº
);

72697 
zEº
 = 0;

72699 
	`sqlôe3BåìE¡îAŒ
(
db
);

72700 
pTab
 = 
	`sqlôe3LoˇãTabÀ
(
pP¨£
, 0, 
zTabÀ
, 
zDb
);

72701 if–
pTab
 && 
	`IsVútuÆ
(pTab) ){

72702 
pTab
 = 0;

72703 
	`sqlôe3Eº‹Msg
(
pP¨£
, "ˇ¬Ÿ o≥¿vútuÆÅabÀ: %s", 
zTabÀ
);

72705 #i‚de‡
SQLITE_OMIT_VIEW


72706 if–
pTab
 &&ÖTab->
pSñe˘
 ){

72707 
pTab
 = 0;

72708 
	`sqlôe3Eº‹Msg
(
pP¨£
, "ˇ¬Ÿ o≥¿võw: %s", 
zTabÀ
);

72711 if–!
pTab
 ){

72712 if–
pP¨£
->
zEºMsg
 ){

72713 
	`sqlôe3DbFªe
(
db
, 
zEº
);

72714 
zEº
 = 
pP¨£
->
zEºMsg
;

72715 
pP¨£
->
zEºMsg
 = 0;

72717 
rc
 = 
SQLITE_ERROR
;

72718 
	`sqlôe3BåìLóveAŒ
(
db
);

72719 
blob_›í_out
;

72723 
iCﬁ
=0; iCﬁ<
pTab
->
nCﬁ
; iCol++) {

72724 if–
	`sqlôe3SåICmp
(
pTab
->
aCﬁ
[
iCﬁ
].
zName
, 
zCﬁumn
)==0 ){

72728 if–
iCﬁ
==
pTab
->
nCﬁ
 ){

72729 
	`sqlôe3DbFªe
(
db
, 
zEº
);

72730 
zEº
 = 
	`sqlôe3MPrötf
(
db
, "nÿsuch cﬁumn: \"%s\"", 
zCﬁumn
);

72731 
rc
 = 
SQLITE_ERROR
;

72732 
	`sqlôe3BåìLóveAŒ
(
db
);

72733 
blob_›í_out
;

72740 if–
Êags
 ){

72741 c⁄° *
zFau…
 = 0;

72742 
Index
 *
pIdx
;

72743 #i‚de‡
SQLITE_OMIT_FOREIGN_KEY


72744 if–
db
->
Êags
&
SQLITE_F‹eignKeys
 ){

72749 
FKey
 *
pFKey
;

72750 
pFKey
=
pTab
->pFKey;ÖFKey;ÖFKeyıFKey->
pNextFrom
){

72751 
j
;

72752 
j
=0; j<
pFKey
->
nCﬁ
; j++){

72753 if–
pFKey
->
aCﬁ
[
j
].
iFrom
==
iCﬁ
 ){

72754 
zFau…
 = "foreign key";

72760 
pIdx
=
pTab
->
pIndex
;ÖIdx;ÖIdxıIdx->
pNext
){

72761 
j
;

72762 
j
=0; j<
pIdx
->
nCﬁumn
; j++){

72763 if–
pIdx
->
aiCﬁumn
[
j
]==
iCﬁ
 ){

72764 
zFau…
 = "indexed";

72768 if–
zFau…
 ){

72769 
	`sqlôe3DbFªe
(
db
, 
zEº
);

72770 
zEº
 = 
	`sqlôe3MPrötf
(
db
, "ˇ¬Ÿ o≥¿%†cﬁum¿f‹ wrôög", 
zFau…
);

72771 
rc
 = 
SQLITE_ERROR
;

72772 
	`sqlôe3BåìLóveAŒ
(
db
);

72773 
blob_›í_out
;

72777 
pBlob
->
pStmt
 = (
sqlôe3_°mt
 *)
	`sqlôe3VdbeCª©e
(
db
);

72778 
	`as£π
–
pBlob
->
pStmt
 || 
db
->
mÆlocFaûed
 );

72779 if–
pBlob
->
pStmt
 ){

72780 
Vdbe
 *
v
 = (Vdbê*)
pBlob
->
pStmt
;

72781 
iDb
 = 
	`sqlôe3SchemaToIndex
(
db
, 
pTab
->
pSchema
);

72783 
	`sqlôe3VdbeAddOpLi°
(
v
, (
›íBlob
)/(
VdbeOpLi°
), openBlob);

72787 
	`sqlôe3VdbeCh™geP1
(
v
, 0, 
iDb
);

72788 
	`sqlôe3VdbeCh™geP2
(
v
, 0, 
Êags
);

72791 
	`sqlôe3VdbeCh™geP1
(
v
, 1, 
iDb
);

72792 
	`sqlôe3VdbeCh™geP2
(
v
, 1, 
pTab
->
pSchema
->
schema_cookõ
);

72793 
	`sqlôe3VdbeCh™geP3
(
v
, 1, 
pTab
->
pSchema
->
iGíî©i⁄
);

72796 
	`sqlôe3VdbeU£sBåì
(
v
, 
iDb
);

72799 #ifde‡
SQLITE_OMIT_SHARED_CACHE


72800 
	`sqlôe3VdbeCh™geToNo›
(
v
, 2);

72802 
	`sqlôe3VdbeCh™geP1
(
v
, 2, 
iDb
);

72803 
	`sqlôe3VdbeCh™geP2
(
v
, 2, 
pTab
->
äum
);

72804 
	`sqlôe3VdbeCh™geP3
(
v
, 2, 
Êags
);

72805 
	`sqlôe3VdbeCh™geP4
(
v
, 2, 
pTab
->
zName
, 
P4_TRANSIENT
);

72810 
	`sqlôe3VdbeCh™geToNo›
(
v
, 4 - 
Êags
);

72811 
	`sqlôe3VdbeCh™geP2
(
v
, 3 + 
Êags
, 
pTab
->
äum
);

72812 
	`sqlôe3VdbeCh™geP3
(
v
, 3 + 
Êags
, 
iDb
);

72821 
	`sqlôe3VdbeCh™geP4
(
v
, 3+
Êags
, 
	`SQLITE_INT_TO_PTR
(
pTab
->
nCﬁ
+1),
P4_INT32
);

72822 
	`sqlôe3VdbeCh™geP2
(
v
, 7, 
pTab
->
nCﬁ
);

72823 if–!
db
->
mÆlocFaûed
 ){

72824 
pP¨£
->
nV¨
 = 1;

72825 
pP¨£
->
nMem
 = 1;

72826 
pP¨£
->
nTab
 = 1;

72827 
	`sqlôe3VdbeMakeRódy
(
v
, 
pP¨£
);

72831 
pBlob
->
Êags
 = flags;

72832 
pBlob
->
iCﬁ
 = iCol;

72833 
pBlob
->
db
 = db;

72834 
	`sqlôe3BåìLóveAŒ
(
db
);

72835 if–
db
->
mÆlocFaûed
 ){

72836 
blob_›í_out
;

72838 
	`sqlôe3_böd_öt64
(
pBlob
->
pStmt
, 1, 
iRow
);

72839 
rc
 = 
	`blobSìkToRow
(
pBlob
, 
iRow
, &
zEº
);

72840 }  (++
nAâem±
)<
SQLITE_MAX_SCHEMA_RETRY
 && 
rc
==
SQLITE_SCHEMA
 );

72842 
blob_›í_out
:

72843 if–
rc
==
SQLITE_OK
 && 
db
->
mÆlocFaûed
==0 ){

72844 *
µBlob
 = (
sqlôe3_blob
 *)
pBlob
;

72846 if–
pBlob
 &&ÖBlob->
pStmt
 ) 
	`sqlôe3VdbeFöÆize
((
Vdbe
 *)pBlob->pStmt);

72847 
	`sqlôe3DbFªe
(
db
, 
pBlob
);

72849 
	`sqlôe3Eº‹
(
db
, 
rc
, (
zEº
 ? "%s" : 0), zErr);

72850 
	`sqlôe3DbFªe
(
db
, 
zEº
);

72851 
	`sqlôe3SèckFªe
(
db
, 
pP¨£
);

72852 
rc
 = 
	`sqlôe3ApiExô
(
db
,Ñc);

72853 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

72854  
rc
;

72861 
SQLITE_API
 
	`sqlôe3_blob_˛o£
(
sqlôe3_blob
 *
pBlob
){

72862 
In¸blob
 *
p
 = (In¸blob *)
pBlob
;

72863 
rc
;

72864 
sqlôe3
 *
db
;

72866 if–
p
 ){

72867 
db
 = 
p
->db;

72868 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

72869 
rc
 = 
	`sqlôe3_föÆize
(
p
->
pStmt
);

72870 
	`sqlôe3DbFªe
(
db
, 
p
);

72871 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

72873 
rc
 = 
SQLITE_OK
;

72875  
rc
;

72881 
	`blobRódWrôe
(

72882 
sqlôe3_blob
 *
pBlob
,

72883 *
z
,

72884 
n
,

72885 
iOff£t
,

72886 (*
xCÆl
)(
BtCurs‹
*, 
u32
, u32, *)

72888 
rc
;

72889 
In¸blob
 *
p
 = (In¸blob *)
pBlob
;

72890 
Vdbe
 *
v
;

72891 
sqlôe3
 *
db
;

72893 if–
p
==0 )  
SQLITE_MISUSE_BKPT
;

72894 
db
 = 
p
->db;

72895 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

72896 
v
 = (
Vdbe
*)
p
->
pStmt
;

72898 if–
n
<0 || 
iOff£t
<0 || (iOff£t+n)>
p
->
nByã
 ){

72900 
rc
 = 
SQLITE_ERROR
;

72901 
	`sqlôe3Eº‹
(
db
, 
SQLITE_ERROR
, 0);

72902 }if–
v
==0 ){

72906 
rc
 = 
SQLITE_ABORT
;

72911 
	`as£π
–
db
 =
v
->db );

72912 
	`sqlôe3BåìE¡îCurs‹
(
p
->
pC§
);

72913 
rc
 = 
	`xCÆl
(
p
->
pC§
, 
iOff£t
+p->iOff£t, 
n
, 
z
);

72914 
	`sqlôe3BåìLóveCurs‹
(
p
->
pC§
);

72915 if–
rc
==
SQLITE_ABORT
 ){

72916 
	`sqlôe3VdbeFöÆize
(
v
);

72917 
p
->
pStmt
 = 0;

72919 
db
->
îrCode
 = 
rc
;

72920 
v
->
rc
 =Ñc;

72923 
rc
 = 
	`sqlôe3ApiExô
(
db
,Ñc);

72924 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

72925  
rc
;

72931 
SQLITE_API
 
	`sqlôe3_blob_ªad
(
sqlôe3_blob
 *
pBlob
, *
z
, 
n
, 
iOff£t
){

72932  
	`blobRódWrôe
(
pBlob
, 
z
, 
n
, 
iOff£t
, 
sqlôe3BåìD©a
);

72938 
SQLITE_API
 
	`sqlôe3_blob_wrôe
(
sqlôe3_blob
 *
pBlob
, c⁄° *
z
, 
n
, 
iOff£t
){

72939  
	`blobRódWrôe
(
pBlob
, (*)
z
, 
n
, 
iOff£t
, 
sqlôe3BåìPutD©a
);

72948 
SQLITE_API
 
	`sqlôe3_blob_byãs
(
sqlôe3_blob
 *
pBlob
){

72949 
In¸blob
 *
p
 = (In¸blob *)
pBlob
;

72950  (
p
 &&Ö->
pStmt
Ë?Ö->
nByã
 : 0;

72963 
SQLITE_API
 
	`sqlôe3_blob_ª›í
(
sqlôe3_blob
 *
pBlob
, 
sqlôe3_öt64
 
iRow
){

72964 
rc
;

72965 
In¸blob
 *
p
 = (In¸blob *)
pBlob
;

72966 
sqlôe3
 *
db
;

72968 if–
p
==0 )  
SQLITE_MISUSE_BKPT
;

72969 
db
 = 
p
->db;

72970 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

72972 if–
p
->
pStmt
==0 ){

72976 
rc
 = 
SQLITE_ABORT
;

72978 *
zEº
;

72979 
rc
 = 
	`blobSìkToRow
(
p
, 
iRow
, &
zEº
);

72980 if–
rc
!=
SQLITE_OK
 ){

72981 
	`sqlôe3Eº‹
(
db
, 
rc
, (
zEº
 ? "%s" : 0), zErr);

72982 
	`sqlôe3DbFªe
(
db
, 
zEº
);

72984 
	`as£π
–
rc
!=
SQLITE_SCHEMA
 );

72987 
rc
 = 
	`sqlôe3ApiExô
(
db
,Ñc);

72988 
	`as£π
–
rc
==
SQLITE_OK
 || 
p
->
pStmt
==0 );

72989 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

72990  
rc
;

73016 
VdbeS‹ãrIãr
 
	tVdbeS‹ãrIãr
;

73017 
S‹ãrRec‹d
 
	tS‹ãrRec‹d
;

73018 
FûeWrôî
 
	tFûeWrôî
;

73089 
	sVdbeS‹ãr
 {

73090 
i64
 
iWrôeOff
;

73091 
i64
 
iRódOff
;

73092 
nInMem‹y
;

73093 
nTªe
;

73094 
nPMA
;

73095 
mnPmaSize
;

73096 
mxPmaSize
;

73097 
VdbeS‹ãrIãr
 *
aIãr
;

73098 *
aTªe
;

73099 
sqlôe3_fûe
 *
pTemp1
;

73100 
S‹ãrRec‹d
 *
pRec‹d
;

73101 
U≈ackedRec‹d
 *
pU≈acked
;

73108 
	sVdbeS‹ãrIãr
 {

73109 
i64
 
iRódOff
;

73110 
i64
 
iEof
;

73111 
nAŒoc
;

73112 
nKey
;

73113 
sqlôe3_fûe
 *
pFûe
;

73114 
u8
 *
aAŒoc
;

73115 
u8
 *
aKey
;

73116 
u8
 *
aBuf„r
;

73117 
nBuf„r
;

73126 
	sFûeWrôî
 {

73127 
eFWEº
;

73128 
u8
 *
aBuf„r
;

73129 
nBuf„r
;

73130 
iBufSèπ
;

73131 
iBufEnd
;

73132 
i64
 
iWrôeOff
;

73133 
sqlôe3_fûe
 *
pFûe
;

73141 
	sS‹ãrRec‹d
 {

73142 *
pVÆ
;

73143 
nVÆ
;

73144 
S‹ãrRec‹d
 *
pNext
;

73148 
	#SORTER_MIN_WORKING
 10

	)

73151 
	#SORTER_MAX_MERGE_COUNT
 16

	)

73157 
	`vdbeS‹ãrIãrZîo
(
sqlôe3
 *
db
, 
VdbeS‹ãrIãr
 *
pIãr
){

73158 
	`sqlôe3DbFªe
(
db
, 
pIãr
->
aAŒoc
);

73159 
	`sqlôe3DbFªe
(
db
, 
pIãr
->
aBuf„r
);

73160 
	`mem£t
(
pIãr
, 0, (
VdbeS‹ãrIãr
));

73172 
	`vdbeS‹ãrIãrRód
(

73173 
sqlôe3
 *
db
,

73174 
VdbeS‹ãrIãr
 *
p
,

73175 
nByã
,

73176 
u8
 **
µOut


73178 
iBuf
;

73179 
nAvaû
;

73180 
	`as£π
–
p
->
aBuf„r
 );

73185 
iBuf
 = 
p
->
iRódOff
 %Ö->
nBuf„r
;

73186 if–
iBuf
==0 ){

73187 
nRód
;

73188 
rc
;

73191 if–(
p
->
iEof
 -Ö->
iRódOff
Ë> (
i64
Ì->
nBuf„r
 ){

73192 
nRód
 = 
p
->
nBuf„r
;

73194 
nRód
 = ()(
p
->
iEof
 -Ö->
iRódOff
);

73196 
	`as£π
–
nRód
>0 );

73199 
rc
 = 
	`sqlôe3OsRód
(
p
->
pFûe
,Ö->
aBuf„r
, 
nRód
,Ö->
iRódOff
);

73200 
	`as£π
–
rc
!=
SQLITE_IOERR_SHORT_READ
 );

73201 if–
rc
!=
SQLITE_OK
 ) Ñc;

73203 
nAvaû
 = 
p
->
nBuf„r
 - 
iBuf
;

73205 if–
nByã
<=
nAvaû
 ){

73209 *
µOut
 = &
p
->
aBuf„r
[
iBuf
];

73210 
p
->
iRódOff
 +
nByã
;

73215 
nRem
;

73218 if–
p
->
nAŒoc
<
nByã
 ){

73219 
nNew
 = 
p
->
nAŒoc
*2;

73220  
nByã
>
nNew
 )ÇNew =ÇNew*2;

73221 
p
->
aAŒoc
 = 
	`sqlôe3DbRóŒocOrFªe
(
db
,Ö->aAŒoc, 
nNew
);

73222 if–!
p
->
aAŒoc
 )  
SQLITE_NOMEM
;

73223 
p
->
nAŒoc
 = 
nNew
;

73228 
	`mem˝y
(
p
->
aAŒoc
, &p->
aBuf„r
[
iBuf
], 
nAvaû
);

73229 
p
->
iRódOff
 +
nAvaû
;

73230 
nRem
 = 
nByã
 - 
nAvaû
;

73234  
nRem
>0 ){

73235 
rc
;

73236 
nC›y
;

73237 
u8
 *
aNext
;

73239 
nC›y
 = 
nRem
;

73240 if–
nRem
>
p
->
nBuf„r
 ) 
nC›y
 =Ö->nBuffer;

73241 
rc
 = 
	`vdbeS‹ãrIãrRód
(
db
, 
p
, 
nC›y
, &
aNext
);

73242 if–
rc
!=
SQLITE_OK
 ) Ñc;

73243 
	`as£π
–
aNext
!=
p
->
aAŒoc
 );

73244 
	`mem˝y
(&
p
->
aAŒoc
[
nByã
 - 
nRem
], 
aNext
, 
nC›y
);

73245 
nRem
 -
nC›y
;

73248 *
µOut
 = 
p
->
aAŒoc
;

73251  
SQLITE_OK
;

73258 
	`vdbeS‹ãrIãrV¨öt
(
sqlôe3
 *
db
, 
VdbeS‹ãrIãr
 *
p
, 
u64
 *
≤Out
){

73259 
iBuf
;

73261 
iBuf
 = 
p
->
iRódOff
 %Ö->
nBuf„r
;

73262 if–
iBuf
 && (
p
->
nBuf„r
-iBuf)>=9 ){

73263 
p
->
iRódOff
 +
	`sqlôe3GëV¨öt
(&p->
aBuf„r
[
iBuf
], 
≤Out
);

73265 
u8
 
aV¨öt
[16], *
a
;

73266 
i
 = 0, 
rc
;

73268 
rc
 = 
	`vdbeS‹ãrIãrRód
(
db
, 
p
, 1, &
a
);

73269 if–
rc
 ) Ñc;

73270 
aV¨öt
[(
i
++)&0xf] = 
a
[0];

73271 } (
a
[0]&0x80)!=0 );

73272 
	`sqlôe3GëV¨öt
(
aV¨öt
, 
≤Out
);

73275  
SQLITE_OK
;

73283 
	`vdbeS‹ãrIãrNext
(

73284 
sqlôe3
 *
db
,

73285 
VdbeS‹ãrIãr
 *
pIãr


73287 
rc
;

73288 
u64
 
nRec
 = 0;

73290 if–
pIãr
->
iRódOff
>ıIãr->
iEof
 ){

73292 
	`vdbeS‹ãrIãrZîo
(
db
, 
pIãr
);

73293  
SQLITE_OK
;

73296 
rc
 = 
	`vdbeS‹ãrIãrV¨öt
(
db
, 
pIãr
, &
nRec
);

73297 if–
rc
==
SQLITE_OK
 ){

73298 
pIãr
->
nKey
 = ()
nRec
;

73299 
rc
 = 
	`vdbeS‹ãrIãrRód
(
db
, 
pIãr
, ()
nRec
, &pIãr->
aKey
);

73302  
rc
;

73311 
	`vdbeS‹ãrIãrInô
(

73312 
sqlôe3
 *
db
,

73313 c⁄° 
VdbeS‹ãr
 *
pS‹ãr
,

73314 
i64
 
iSèπ
,

73315 
VdbeS‹ãrIãr
 *
pIãr
,

73316 
i64
 *
≤Byã


73318 
rc
 = 
SQLITE_OK
;

73319 
nBuf
;

73321 
nBuf
 = 
	`sqlôe3BåìGëPageSize
(
db
->
aDb
[0].
pBt
);

73323 
	`as£π
–
pS‹ãr
->
iWrôeOff
>
iSèπ
 );

73324 
	`as£π
–
pIãr
->
aAŒoc
==0 );

73325 
	`as£π
–
pIãr
->
aBuf„r
==0 );

73326 
pIãr
->
pFûe
 = 
pS‹ãr
->
pTemp1
;

73327 
pIãr
->
iRódOff
 = 
iSèπ
;

73328 
pIãr
->
nAŒoc
 = 128;

73329 
pIãr
->
aAŒoc
 = (
u8
 *)
	`sqlôe3DbMÆlocRaw
(
db
,ÖIãr->
nAŒoc
);

73330 
pIãr
->
nBuf„r
 = 
nBuf
;

73331 
pIãr
->
aBuf„r
 = (
u8
 *)
	`sqlôe3DbMÆlocRaw
(
db
, 
nBuf
);

73333 if–!
pIãr
->
aBuf„r
 ){

73334 
rc
 = 
SQLITE_NOMEM
;

73336 
iBuf
;

73338 
iBuf
 = 
iSèπ
 % 
nBuf
;

73339 if–
iBuf
 ){

73340 
nRód
 = 
nBuf
 - 
iBuf
;

73341 if–(
iSèπ
 + 
nRód
Ë> 
pS‹ãr
->
iWrôeOff
 ){

73342 
nRód
 = ()(
pS‹ãr
->
iWrôeOff
 - 
iSèπ
);

73344 
rc
 = 
	`sqlôe3OsRód
(

73345 
pS‹ãr
->
pTemp1
, &
pIãr
->
aBuf„r
[
iBuf
], 
nRód
, 
iSèπ


73347 
	`as£π
–
rc
!=
SQLITE_IOERR_SHORT_READ
 );

73350 if–
rc
==
SQLITE_OK
 ){

73351 
u64
 
nByã
;

73352 
pIãr
->
iEof
 = 
pS‹ãr
->
iWrôeOff
;

73353 
rc
 = 
	`vdbeS‹ãrIãrV¨öt
(
db
, 
pIãr
, &
nByã
);

73354 
pIãr
->
iEof
 =ÖIãr->
iRódOff
 + 
nByã
;

73355 *
≤Byã
 +
nByã
;

73359 if–
rc
==
SQLITE_OK
 ){

73360 
rc
 = 
	`vdbeS‹ãrIãrNext
(
db
, 
pIãr
);

73362  
rc
;

73381 
	`vdbeS‹ãrCom∑ª
(

73382 c⁄° 
VdbeCurs‹
 *
pC§
,

73383 
bOmôRowid
,

73384 c⁄° *
pKey1
, 
nKey1
,

73385 c⁄° *
pKey2
, 
nKey2
,

73386 *
pRes


73388 
KeyInfo
 *
pKeyInfo
 = 
pC§
->pKeyInfo;

73389 
VdbeS‹ãr
 *
pS‹ãr
 = 
pC§
->pSorter;

73390 
U≈ackedRec‹d
 *
r2
 = 
pS‹ãr
->
pU≈acked
;

73391 
i
;

73393 if–
pKey2
 ){

73394 
	`sqlôe3VdbeRec‹dU≈ack
(
pKeyInfo
, 
nKey2
, 
pKey2
, 
r2
);

73397 if–
bOmôRowid
 ){

73398 
r2
->
nFõld
 = 
pKeyInfo
->nField;

73399 
	`as£π
–
r2
->
nFõld
>0 );

73400 
i
=0; i<
r2
->
nFõld
; i++){

73401 if–
r2
->
aMem
[
i
].
Êags
 & 
MEM_NuŒ
 ){

73402 *
pRes
 = -1;

73406 
r2
->
Êags
 |
UNPACKED_PREFIX_MATCH
;

73409 *
pRes
 = 
	`sqlôe3VdbeRec‹dCom∑ª
(
nKey1
, 
pKey1
, 
r2
);

73417 
	`vdbeS‹ãrDoCom∑ª
(c⁄° 
VdbeCurs‹
 *
pC§
, 
iOut
){

73418 
VdbeS‹ãr
 *
pS‹ãr
 = 
pC§
->pSorter;

73419 
i1
;

73420 
i2
;

73421 
iRes
;

73422 
VdbeS‹ãrIãr
 *
p1
;

73423 
VdbeS‹ãrIãr
 *
p2
;

73425 
	`as£π
–
iOut
<
pS‹ãr
->
nTªe
 && iOut>0 );

73427 if–
iOut
>=(
pS‹ãr
->
nTªe
/2) ){

73428 
i1
 = (
iOut
 - 
pS‹ãr
->
nTªe
/2) * 2;

73429 
i2
 = 
i1
 + 1;

73431 
i1
 = 
pS‹ãr
->
aTªe
[
iOut
*2];

73432 
i2
 = 
pS‹ãr
->
aTªe
[
iOut
*2+1];

73435 
p1
 = &
pS‹ãr
->
aIãr
[
i1
];

73436 
p2
 = &
pS‹ãr
->
aIãr
[
i2
];

73438 if–
p1
->
pFûe
==0 ){

73439 
iRes
 = 
i2
;

73440 }if–
p2
->
pFûe
==0 ){

73441 
iRes
 = 
i1
;

73443 
ªs
;

73444 
	`as£π
–
pC§
->
pS‹ãr
->
pU≈acked
!=0 );

73445 
	`vdbeS‹ãrCom∑ª
(

73446 
pC§
, 0, 
p1
->
aKey
,Ö1->
nKey
, 
p2
->aKey,Ö2->nKey, &
ªs


73448 if–
ªs
<=0 ){

73449 
iRes
 = 
i1
;

73451 
iRes
 = 
i2
;

73455 
pS‹ãr
->
aTªe
[
iOut
] = 
iRes
;

73456  
SQLITE_OK
;

73462 
SQLITE_PRIVATE
 
	`sqlôe3VdbeS‹ãrInô
(
sqlôe3
 *
db
, 
VdbeCurs‹
 *
pC§
){

73463 
pgsz
;

73464 
mxCache
;

73465 
VdbeS‹ãr
 *
pS‹ãr
;

73466 *
d
;

73468 
	`as£π
–
pC§
->
pKeyInfo
 &&ÖC§->
pBt
==0 );

73469 
pC§
->
pS‹ãr
 =ÖS‹ã∏
	`sqlôe3DbMÆlocZîo
(
db
, (
VdbeS‹ãr
));

73470 if–
pS‹ãr
==0 ){

73471  
SQLITE_NOMEM
;

73474 
pS‹ãr
->
pU≈acked
 = 
	`sqlôe3VdbeAŒocU≈ackedRec‹d
(
pC§
->
pKeyInfo
, 0, 0, &
d
);

73475 if–
pS‹ãr
->
pU≈acked
==0 )  
SQLITE_NOMEM
;

73476 
	`as£π
–
pS‹ãr
->
pU≈acked
==(
U≈ackedRec‹d
 *)
d
 );

73478 if–!
	`sqlôe3TempInMem‹y
(
db
) ){

73479 
pgsz
 = 
	`sqlôe3BåìGëPageSize
(
db
->
aDb
[0].
pBt
);

73480 
pS‹ãr
->
mnPmaSize
 = 
SORTER_MIN_WORKING
 * 
pgsz
;

73481 
mxCache
 = 
db
->
aDb
[0].
pSchema
->
ˇche_size
;

73482 if–
mxCache
<
SORTER_MIN_WORKING
 ) mxCache = SORTER_MIN_WORKING;

73483 
pS‹ãr
->
mxPmaSize
 = 
mxCache
 * 
pgsz
;

73486  
SQLITE_OK
;

73492 
	`vdbeS‹ãrRec‹dFªe
(
sqlôe3
 *
db
, 
S‹ãrRec‹d
 *
pRec‹d
){

73493 
S‹ãrRec‹d
 *
p
;

73494 
S‹ãrRec‹d
 *
pNext
;

73495 
p
=
pRec‹d
;Ö;Ö=
pNext
){

73496 
pNext
 = 
p
->pNext;

73497 
	`sqlôe3DbFªe
(
db
, 
p
);

73504 
SQLITE_PRIVATE
 
	`sqlôe3VdbeS‹ãrClo£
(
sqlôe3
 *
db
, 
VdbeCurs‹
 *
pC§
){

73505 
VdbeS‹ãr
 *
pS‹ãr
 = 
pC§
->pSorter;

73506 if–
pS‹ãr
 ){

73507 if–
pS‹ãr
->
aIãr
 ){

73508 
i
;

73509 
i
=0; i<
pS‹ãr
->
nTªe
; i++){

73510 
	`vdbeS‹ãrIãrZîo
(
db
, &
pS‹ãr
->
aIãr
[
i
]);

73512 
	`sqlôe3DbFªe
(
db
, 
pS‹ãr
->
aIãr
);

73514 if–
pS‹ãr
->
pTemp1
 ){

73515 
	`sqlôe3OsClo£Fªe
(
pS‹ãr
->
pTemp1
);

73517 
	`vdbeS‹ãrRec‹dFªe
(
db
, 
pS‹ãr
->
pRec‹d
);

73518 
	`sqlôe3DbFªe
(
db
, 
pS‹ãr
->
pU≈acked
);

73519 
	`sqlôe3DbFªe
(
db
, 
pS‹ãr
);

73520 
pC§
->
pS‹ãr
 = 0;

73529 
	`vdbeS‹ãrO≥nTempFûe
(
sqlôe3
 *
db
, 
sqlôe3_fûe
 **
µFûe
){

73530 
dummy
;

73531  
	`sqlôe3OsO≥nMÆloc
(
db
->
pVfs
, 0, 
µFûe
,

73532 
SQLITE_OPEN_TEMP_JOURNAL
 |

73533 
SQLITE_OPEN_READWRITE
 | 
SQLITE_OPEN_CREATE
 |

73534 
SQLITE_OPEN_EXCLUSIVE
 | 
SQLITE_OPEN_DELETEONCLOSE
, &
dummy


73542 
	`vdbeS‹ãrMîge
(

73543 c⁄° 
VdbeCurs‹
 *
pC§
,

73544 
S‹ãrRec‹d
 *
p1
,

73545 
S‹ãrRec‹d
 *
p2
,

73546 
S‹ãrRec‹d
 **
µOut


73548 
S‹ãrRec‹d
 *
pFöÆ
 = 0;

73549 
S‹ãrRec‹d
 **
µ
 = &
pFöÆ
;

73550 *
pVÆ2
 = 
p2
 ?Ö2->
pVÆ
 : 0;

73552  
p1
 && 
p2
 ){

73553 
ªs
;

73554 
	`vdbeS‹ãrCom∑ª
(
pC§
, 0, 
p1
->
pVÆ
,Ö1->
nVÆ
, 
pVÆ2
, 
p2
->nVÆ, &
ªs
);

73555 if–
ªs
<=0 ){

73556 *
µ
 = 
p1
;

73557 
µ
 = &
p1
->
pNext
;

73558 
p1
 =Ö1->
pNext
;

73559 
pVÆ2
 = 0;

73561 *
µ
 = 
p2
;

73562 
µ
 = &
p2
->
pNext
;

73563 
p2
 =Ö2->
pNext
;

73564 if–
p2
==0 ) ;

73565 
pVÆ2
 = 
p2
->
pVÆ
;

73568 *
µ
 = 
p1
 ?Ö1 : 
p2
;

73569 *
µOut
 = 
pFöÆ
;

73577 
	`vdbeS‹ãrS‹t
(c⁄° 
VdbeCurs‹
 *
pC§
){

73578 
i
;

73579 
S‹ãrRec‹d
 **
aSlŸ
;

73580 
S‹ãrRec‹d
 *
p
;

73581 
VdbeS‹ãr
 *
pS‹ãr
 = 
pC§
->pSorter;

73583 
aSlŸ
 = (
S‹ãrRec‹d
 **)
	`sqlôe3MÆlocZîo
(64 * (SorterRecord *));

73584 if–!
aSlŸ
 ){

73585  
SQLITE_NOMEM
;

73588 
p
 = 
pS‹ãr
->
pRec‹d
;

73589  
p
 ){

73590 
S‹ãrRec‹d
 *
pNext
 = 
p
->pNext;

73591 
p
->
pNext
 = 0;

73592 
i
=0; 
aSlŸ
[i]; i++){

73593 
	`vdbeS‹ãrMîge
(
pC§
, 
p
, 
aSlŸ
[
i
], &p);

73594 
aSlŸ
[
i
] = 0;

73596 
aSlŸ
[
i
] = 
p
;

73597 
p
 = 
pNext
;

73600 
p
 = 0;

73601 
i
=0; i<64; i++){

73602 
	`vdbeS‹ãrMîge
(
pC§
, 
p
, 
aSlŸ
[
i
], &p);

73604 
pS‹ãr
->
pRec‹d
 = 
p
;

73606 
	`sqlôe3_‰ì
(
aSlŸ
);

73607  
SQLITE_OK
;

73613 
	`fûeWrôîInô
(

73614 
sqlôe3
 *
db
,

73615 
sqlôe3_fûe
 *
pFûe
,

73616 
FûeWrôî
 *
p
,

73617 
i64
 
iSèπ


73619 
nBuf
 = 
	`sqlôe3BåìGëPageSize
(
db
->
aDb
[0].
pBt
);

73621 
	`mem£t
(
p
, 0, (
FûeWrôî
));

73622 
p
->
aBuf„r
 = (
u8
 *)
	`sqlôe3DbMÆlocRaw
(
db
, 
nBuf
);

73623 if–!
p
->
aBuf„r
 ){

73624 
p
->
eFWEº
 = 
SQLITE_NOMEM
;

73626 
p
->
iBufEnd
 =Ö->
iBufSèπ
 = (
iSèπ
 % 
nBuf
);

73627 
p
->
iWrôeOff
 = 
iSèπ
 -Ö->
iBufSèπ
;

73628 
p
->
nBuf„r
 = 
nBuf
;

73629 
p
->
pFûe
 =ÖFile;

73637 
	`fûeWrôîWrôe
(
FûeWrôî
 *
p
, 
u8
 *
pD©a
, 
nD©a
){

73638 
nRem
 = 
nD©a
;

73639  
nRem
>0 && 
p
->
eFWEº
==0 ){

73640 
nC›y
 = 
nRem
;

73641 if–
nC›y
>(
p
->
nBuf„r
 -Ö->
iBufEnd
) ){

73642 
nC›y
 = 
p
->
nBuf„r
 -Ö->
iBufEnd
;

73645 
	`mem˝y
(&
p
->
aBuf„r
[p->
iBufEnd
], &
pD©a
[
nD©a
-
nRem
], 
nC›y
);

73646 
p
->
iBufEnd
 +
nC›y
;

73647 if–
p
->
iBufEnd
=ı->
nBuf„r
 ){

73648 
p
->
eFWEº
 = 
	`sqlôe3OsWrôe
’->
pFûe
,

73649 &
p
->
aBuf„r
[p->
iBufSèπ
],Ö->
iBufEnd
 -Ö->iBufStart,

73650 
p
->
iWrôeOff
 +Ö->
iBufSèπ


73652 
p
->
iBufSèπ
 =Ö->
iBufEnd
 = 0;

73653 
p
->
iWrôeOff
 +p->
nBuf„r
;

73655 
	`as£π
–
p
->
iBufEnd
<p->
nBuf„r
 );

73657 
nRem
 -
nC›y
;

73670 
	`fûeWrôîFöish
(
sqlôe3
 *
db
, 
FûeWrôî
 *
p
, 
i64
 *
piEof
){

73671 
rc
;

73672 if–
p
->
eFWEº
==0 && 
	`ALWAYS
’->
aBuf„r
Ë&&Ö->
iBufEnd
>p->
iBufSèπ
 ){

73673 
p
->
eFWEº
 = 
	`sqlôe3OsWrôe
’->
pFûe
,

73674 &
p
->
aBuf„r
[p->
iBufSèπ
],Ö->
iBufEnd
 -Ö->iBufStart,

73675 
p
->
iWrôeOff
 +Ö->
iBufSèπ


73678 *
piEof
 = (
p
->
iWrôeOff
 +Ö->
iBufEnd
);

73679 
	`sqlôe3DbFªe
(
db
, 
p
->
aBuf„r
);

73680 
rc
 = 
p
->
eFWEº
;

73681 
	`mem£t
(
p
, 0, (
FûeWrôî
));

73682  
rc
;

73689 
	`fûeWrôîWrôeV¨öt
(
FûeWrôî
 *
p
, 
u64
 
iVÆ
){

73690 
nByã
;

73691 
u8
 
aByã
[10];

73692 
nByã
 = 
	`sqlôe3PutV¨öt
(
aByã
, 
iVÆ
);

73693 
	`fûeWrôîWrôe
(
p
, 
aByã
, 
nByã
);

73709 
	`vdbeS‹ãrLi°ToPMA
(
sqlôe3
 *
db
, c⁄° 
VdbeCurs‹
 *
pC§
){

73710 
rc
 = 
SQLITE_OK
;

73711 
VdbeS‹ãr
 *
pS‹ãr
 = 
pC§
->pSorter;

73712 
FûeWrôî
 
wrôî
;

73714 
	`mem£t
(&
wrôî
, 0, (
FûeWrôî
));

73716 if–
pS‹ãr
->
nInMem‹y
==0 ){

73717 
	`as£π
–
pS‹ãr
->
pRec‹d
==0 );

73718  
rc
;

73721 
rc
 = 
	`vdbeS‹ãrS‹t
(
pC§
);

73724 if–
rc
==
SQLITE_OK
 && 
pS‹ãr
->
pTemp1
==0 ){

73725 
rc
 = 
	`vdbeS‹ãrO≥nTempFûe
(
db
, &
pS‹ãr
->
pTemp1
);

73726 
	`as£π
–
rc
!=
SQLITE_OK
 || 
pS‹ãr
->
pTemp1
 );

73727 
	`as£π
–
pS‹ãr
->
iWrôeOff
==0 );

73728 
	`as£π
–
pS‹ãr
->
nPMA
==0 );

73731 if–
rc
==
SQLITE_OK
 ){

73732 
S‹ãrRec‹d
 *
p
;

73733 
S‹ãrRec‹d
 *
pNext
 = 0;

73735 
	`fûeWrôîInô
(
db
, 
pS‹ãr
->
pTemp1
, &
wrôî
,ÖS‹ãr->
iWrôeOff
);

73736 
pS‹ãr
->
nPMA
++;

73737 
	`fûeWrôîWrôeV¨öt
(&
wrôî
, 
pS‹ãr
->
nInMem‹y
);

73738 
p
=
pS‹ãr
->
pRec‹d
;Ö;Ö=
pNext
){

73739 
pNext
 = 
p
->pNext;

73740 
	`fûeWrôîWrôeV¨öt
(&
wrôî
, 
p
->
nVÆ
);

73741 
	`fûeWrôîWrôe
(&
wrôî
, 
p
->
pVÆ
,Ö->
nVÆ
);

73742 
	`sqlôe3DbFªe
(
db
, 
p
);

73744 
pS‹ãr
->
pRec‹d
 = 
p
;

73745 
rc
 = 
	`fûeWrôîFöish
(
db
, &
wrôî
, &
pS‹ãr
->
iWrôeOff
);

73748  
rc
;

73754 
SQLITE_PRIVATE
 
	`sqlôe3VdbeS‹ãrWrôe
(

73755 
sqlôe3
 *
db
,

73756 c⁄° 
VdbeCurs‹
 *
pC§
,

73757 
Mem
 *
pVÆ


73759 
VdbeS‹ãr
 *
pS‹ãr
 = 
pC§
->pSorter;

73760 
rc
 = 
SQLITE_OK
;

73761 
S‹ãrRec‹d
 *
pNew
;

73763 
	`as£π
–
pS‹ãr
 );

73764 
pS‹ãr
->
nInMem‹y
 +
	`sqlôe3V¨ötLí
(
pVÆ
->
n
) +ÖVal->n;

73766 
pNew
 = (
S‹ãrRec‹d
 *)
	`sqlôe3DbMÆlocRaw
(
db
, 
pVÆ
->
n
 + (SorterRecord));

73767 if–
pNew
==0 ){

73768 
rc
 = 
SQLITE_NOMEM
;

73770 
pNew
->
pVÆ
 = (*)&pNew[1];

73771 
	`mem˝y
(
pNew
->
pVÆ
,ÖVÆ->
z
,ÖVÆ->
n
);

73772 
pNew
->
nVÆ
 = 
pVÆ
->
n
;

73773 
pNew
->
pNext
 = 
pS‹ãr
->
pRec‹d
;

73774 
pS‹ãr
->
pRec‹d
 = 
pNew
;

73786 if–
rc
==
SQLITE_OK
 && 
pS‹ãr
->
mxPmaSize
>0 && (

73787 (
pS‹ãr
->
nInMem‹y
>pS‹ãr->
mxPmaSize
)

73788 || (
pS‹ãr
->
nInMem‹y
>pS‹ãr->
mnPmaSize
 && 
	`sqlôe3HópNóæyFuŒ
())

73790 #ifde‡
SQLITE_DEBUG


73791 
i64
 
nEx≥˘
 = 
pS‹ãr
->
iWrôeOff


73792 + 
	`sqlôe3V¨ötLí
(
pS‹ãr
->
nInMem‹y
)

73793 + 
pS‹ãr
->
nInMem‹y
;

73795 
rc
 = 
	`vdbeS‹ãrLi°ToPMA
(
db
, 
pC§
);

73796 
pS‹ãr
->
nInMem‹y
 = 0;

73797 
	`as£π
–
rc
!=
SQLITE_OK
 || (
nEx≥˘
==
pS‹ãr
->
iWrôeOff
) );

73800  
rc
;

73806 
	`vdbeS‹ãrInôMîge
(

73807 
sqlôe3
 *
db
,

73808 c⁄° 
VdbeCurs‹
 *
pC§
,

73809 
i64
 *
≤Byã


73811 
VdbeS‹ãr
 *
pS‹ãr
 = 
pC§
->pSorter;

73812 
rc
 = 
SQLITE_OK
;

73813 
i
;

73814 
i64
 
nByã
 = 0;

73817 
i
=0; i<
SORTER_MAX_MERGE_COUNT
; i++){

73818 
VdbeS‹ãrIãr
 *
pIãr
 = &
pS‹ãr
->
aIãr
[
i
];

73819 
rc
 = 
	`vdbeS‹ãrIãrInô
(
db
, 
pS‹ãr
,ÖS‹ãr->
iRódOff
, 
pIãr
, &
nByã
);

73820 
pS‹ãr
->
iRódOff
 = 
pIãr
->
iEof
;

73821 
	`as£π
–
rc
!=
SQLITE_OK
 || 
pS‹ãr
->
iRódOff
<ıS‹ãr->
iWrôeOff
 );

73822 if–
rc
!=
SQLITE_OK
 || 
pS‹ãr
->
iRódOff
>ıS‹ãr->
iWrôeOff
 ) ;

73826 
i
=
pS‹ãr
->
nTªe
-1; 
rc
==
SQLITE_OK
 && i>0; i--){

73827 
rc
 = 
	`vdbeS‹ãrDoCom∑ª
(
pC§
, 
i
);

73830 *
≤Byã
 = 
nByã
;

73831  
rc
;

73838 
SQLITE_PRIVATE
 
	`sqlôe3VdbeS‹ãrRewöd
(
sqlôe3
 *
db
, c⁄° 
VdbeCurs‹
 *
pC§
, *
pbEof
){

73839 
VdbeS‹ãr
 *
pS‹ãr
 = 
pC§
->pSorter;

73840 
rc
;

73841 
sqlôe3_fûe
 *
pTemp2
 = 0;

73842 
i64
 
iWrôe2
 = 0;

73843 
nIãr
;

73844 
nByã
;

73845 
N
 = 2;

73847 
	`as£π
–
pS‹ãr
 );

73852 if–
pS‹ãr
->
nPMA
==0 ){

73853 *
pbEof
 = !
pS‹ãr
->
pRec‹d
;

73854 
	`as£π
–
pS‹ãr
->
aTªe
==0 );

73855  
	`vdbeS‹ãrS‹t
(
pC§
);

73859 
rc
 = 
	`vdbeS‹ãrLi°ToPMA
(
db
, 
pC§
);

73860 if–
rc
!=
SQLITE_OK
 ) Ñc;

73863 
nIãr
 = 
pS‹ãr
->
nPMA
;

73864 if–
nIãr
>
SORTER_MAX_MERGE_COUNT
 )ÇIter = SORTER_MAX_MERGE_COUNT;

73865 
	`as£π
–
nIãr
>0 );

73866  
N
<
nIãr
 ) N += N;

73867 
nByã
 = 
N
 * ((Ë+ (
VdbeS‹ãrIãr
));

73868 
pS‹ãr
->
aIãr
 = (
VdbeS‹ãrIãr
 *)
	`sqlôe3DbMÆlocZîo
(
db
, 
nByã
);

73869 if–!
pS‹ãr
->
aIãr
 )  
SQLITE_NOMEM
;

73870 
pS‹ãr
->
aTªe
 = (*)&pS‹ãr->
aIãr
[
N
];

73871 
pS‹ãr
->
nTªe
 = 
N
;

73874 
iNew
;

73876 
iNew
=0;

73877 
rc
==
SQLITE_OK
 && 
iNew
*
SORTER_MAX_MERGE_COUNT
<
pS‹ãr
->
nPMA
;

73878 
iNew
++

73880 
rc2
;

73881 
FûeWrôî
 
wrôî
;

73882 
i64
 
nWrôe
;

73884 
	`mem£t
(&
wrôî
, 0, (
FûeWrôî
));

73895 
rc
 = 
	`vdbeS‹ãrInôMîge
(
db
, 
pC§
, &
nWrôe
);

73896 
	`as£π
–
rc
!=
SQLITE_OK
 || 
pS‹ãr
->
aIãr
[ÖS‹ãr->
aTªe
[1] ].
pFûe
 );

73897 if–
rc
!=
SQLITE_OK
 || 
pS‹ãr
->
nPMA
<=
SORTER_MAX_MERGE_COUNT
 ){

73902 if–
pTemp2
==0 ){

73903 
	`as£π
–
iWrôe2
==0 );

73904 
rc
 = 
	`vdbeS‹ãrO≥nTempFûe
(
db
, &
pTemp2
);

73907 if–
rc
==
SQLITE_OK
 ){

73908 
bEof
 = 0;

73909 
	`fûeWrôîInô
(
db
, 
pTemp2
, &
wrôî
, 
iWrôe2
);

73910 
	`fûeWrôîWrôeV¨öt
(&
wrôî
, 
nWrôe
);

73911  
rc
==
SQLITE_OK
 && 
bEof
==0 ){

73912 
VdbeS‹ãrIãr
 *
pIãr
 = &
pS‹ãr
->
aIãr
[ÖS‹ãr->
aTªe
[1] ];

73913 
	`as£π
–
pIãr
->
pFûe
 );

73915 
	`fûeWrôîWrôeV¨öt
(&
wrôî
, 
pIãr
->
nKey
);

73916 
	`fûeWrôîWrôe
(&
wrôî
, 
pIãr
->
aKey
,ÖIãr->
nKey
);

73917 
rc
 = 
	`sqlôe3VdbeS‹ãrNext
(
db
, 
pC§
, &
bEof
);

73919 
rc2
 = 
	`fûeWrôîFöish
(
db
, &
wrôî
, &
iWrôe2
);

73920 if–
rc
==
SQLITE_OK
 )Ñ¯
rc2
;

73924 if–
pS‹ãr
->
nPMA
<=
SORTER_MAX_MERGE_COUNT
 ){

73927 
sqlôe3_fûe
 *
pTmp
 = 
pS‹ãr
->
pTemp1
;

73928 
pS‹ãr
->
nPMA
 = 
iNew
;

73929 
pS‹ãr
->
pTemp1
 = 
pTemp2
;

73930 
pTemp2
 = 
pTmp
;

73931 
pS‹ãr
->
iWrôeOff
 = 
iWrôe2
;

73932 
pS‹ãr
->
iRódOff
 = 0;

73933 
iWrôe2
 = 0;

73935 } 
rc
==
SQLITE_OK
 );

73937 if–
pTemp2
 ){

73938 
	`sqlôe3OsClo£Fªe
(
pTemp2
);

73940 *
pbEof
 = (
pS‹ãr
->
aIãr
[pS‹ãr->
aTªe
[1]].
pFûe
==0);

73941  
rc
;

73947 
SQLITE_PRIVATE
 
	`sqlôe3VdbeS‹ãrNext
(
sqlôe3
 *
db
, c⁄° 
VdbeCurs‹
 *
pC§
, *
pbEof
){

73948 
VdbeS‹ãr
 *
pS‹ãr
 = 
pC§
->pSorter;

73949 
rc
;

73951 if–
pS‹ãr
->
aTªe
 ){

73952 
iPªv
 = 
pS‹ãr
->
aTªe
[1];

73953 
i
;

73955 
rc
 = 
	`vdbeS‹ãrIãrNext
(
db
, &
pS‹ãr
->
aIãr
[
iPªv
]);

73956 
i
=(
pS‹ãr
->
nTªe
+
iPªv
)/2; 
rc
==
SQLITE_OK
 && i>0; i=i/2){

73957 
rc
 = 
	`vdbeS‹ãrDoCom∑ª
(
pC§
, 
i
);

73960 *
pbEof
 = (
pS‹ãr
->
aIãr
[pS‹ãr->
aTªe
[1]].
pFûe
==0);

73962 
S‹ãrRec‹d
 *
pFªe
 = 
pS‹ãr
->
pRec‹d
;

73963 
pS‹ãr
->
pRec‹d
 = 
pFªe
->
pNext
;

73964 
pFªe
->
pNext
 = 0;

73965 
	`vdbeS‹ãrRec‹dFªe
(
db
, 
pFªe
);

73966 *
pbEof
 = !
pS‹ãr
->
pRec‹d
;

73967 
rc
 = 
SQLITE_OK
;

73969  
rc
;

73976 *
	`vdbeS‹ãrRowkey
(

73977 c⁄° 
VdbeS‹ãr
 *
pS‹ãr
,

73978 *
≤Key


73980 *
pKey
;

73981 if–
pS‹ãr
->
aTªe
 ){

73982 
VdbeS‹ãrIãr
 *
pIãr
;

73983 
pIãr
 = &
pS‹ãr
->
aIãr
[ÖS‹ãr->
aTªe
[1] ];

73984 *
≤Key
 = 
pIãr
->
nKey
;

73985 
pKey
 = 
pIãr
->
aKey
;

73987 *
≤Key
 = 
pS‹ãr
->
pRec‹d
->
nVÆ
;

73988 
pKey
 = 
pS‹ãr
->
pRec‹d
->
pVÆ
;

73990  
pKey
;

73996 
SQLITE_PRIVATE
 
	`sqlôe3VdbeS‹ãrRowkey
(c⁄° 
VdbeCurs‹
 *
pC§
, 
Mem
 *
pOut
){

73997 
VdbeS‹ãr
 *
pS‹ãr
 = 
pC§
->pSorter;

73998 *
pKey
; 
nKey
;

74000 
pKey
 = 
	`vdbeS‹ãrRowkey
(
pS‹ãr
, &
nKey
);

74001 if–
	`sqlôe3VdbeMemGrow
(
pOut
, 
nKey
, 0) ){

74002  
SQLITE_NOMEM
;

74004 
pOut
->
n
 = 
nKey
;

74005 
	`MemSëTy≥Fœg
(
pOut
, 
MEM_Blob
);

74006 
	`mem˝y
(
pOut
->
z
, 
pKey
, 
nKey
);

74008  
SQLITE_OK
;

74021 
SQLITE_PRIVATE
 
	`sqlôe3VdbeS‹ãrCom∑ª
(

74022 c⁄° 
VdbeCurs‹
 *
pC§
,

74023 
Mem
 *
pVÆ
,

74024 *
pRes


74026 
VdbeS‹ãr
 *
pS‹ãr
 = 
pC§
->pSorter;

74027 *
pKey
; 
nKey
;

74029 
pKey
 = 
	`vdbeS‹ãrRowkey
(
pS‹ãr
, &
nKey
);

74030 
	`vdbeS‹ãrCom∑ª
(
pC§
, 1, 
pVÆ
->
z
,ÖVÆ->
n
, 
pKey
, 
nKey
, 
pRes
);

74031  
SQLITE_OK
;

74062 #ifde‡
SQLITE_ENABLE_ATOMIC_WRITE


74069 
	sJou∫ÆFûe
 {

74070 
sqlôe3_io_mëhods
 *
pMëhod
;

74071 
nBuf
;

74072 *
zBuf
;

74073 
iSize
;

74074 
Êags
;

74075 
sqlôe3_vfs
 *
pVfs
;

74076 
sqlôe3_fûe
 *
pRól
;

74077 c⁄° *
zJou∫Æ
;

74079 
Jou∫ÆFûe
 
	tJou∫ÆFûe
;

74085 
	`¸óãFûe
(
Jou∫ÆFûe
 *
p
){

74086 
rc
 = 
SQLITE_OK
;

74087 if–!
p
->
pRól
 ){

74088 
sqlôe3_fûe
 *
pRól
 = (sqlôe3_fûê*)&
p
[1];

74089 
rc
 = 
	`sqlôe3OsO≥n
(
p
->
pVfs
,Ö->
zJou∫Æ
, 
pRól
,Ö->
Êags
, 0);

74090 if–
rc
==
SQLITE_OK
 ){

74091 
p
->
pRól
 =ÖReal;

74092 if–
p
->
iSize
>0 ){

74093 
	`as£π
(
p
->
iSize
<ı->
nBuf
);

74094 
rc
 = 
	`sqlôe3OsWrôe
(
p
->
pRól
,Ö->
zBuf
,Ö->
iSize
, 0);

74096 if–
rc
!=
SQLITE_OK
 ){

74101 
	`sqlôe3OsClo£
(
pRól
);

74102 
p
->
pRól
 = 0;

74106  
rc
;

74112 
	`j∫lClo£
(
sqlôe3_fûe
 *
pJfd
){

74113 
Jou∫ÆFûe
 *
p
 = (Jou∫ÆFûê*)
pJfd
;

74114 if–
p
->
pRól
 ){

74115 
	`sqlôe3OsClo£
(
p
->
pRól
);

74117 
	`sqlôe3_‰ì
(
p
->
zBuf
);

74118  
SQLITE_OK
;

74124 
	`j∫lRód
(

74125 
sqlôe3_fûe
 *
pJfd
,

74126 *
zBuf
,

74127 
iAmt
,

74128 
sqlôe_öt64
 
iOf°


74130 
rc
 = 
SQLITE_OK
;

74131 
Jou∫ÆFûe
 *
p
 = (Jou∫ÆFûê*)
pJfd
;

74132 if–
p
->
pRól
 ){

74133 
rc
 = 
	`sqlôe3OsRód
(
p
->
pRól
, 
zBuf
, 
iAmt
, 
iOf°
);

74134 }if–(
iAmt
+
iOf°
)>
p
->
iSize
 ){

74135 
rc
 = 
SQLITE_IOERR_SHORT_READ
;

74137 
	`mem˝y
(
zBuf
, &
p
->zBuf[
iOf°
], 
iAmt
);

74139  
rc
;

74145 
	`j∫lWrôe
(

74146 
sqlôe3_fûe
 *
pJfd
,

74147 c⁄° *
zBuf
,

74148 
iAmt
,

74149 
sqlôe_öt64
 
iOf°


74151 
rc
 = 
SQLITE_OK
;

74152 
Jou∫ÆFûe
 *
p
 = (Jou∫ÆFûê*)
pJfd
;

74153 if–!
p
->
pRól
 && (
iOf°
+
iAmt
)>p->
nBuf
 ){

74154 
rc
 = 
	`¸óãFûe
(
p
);

74156 if–
rc
==
SQLITE_OK
 ){

74157 if–
p
->
pRól
 ){

74158 
rc
 = 
	`sqlôe3OsWrôe
(
p
->
pRól
, 
zBuf
, 
iAmt
, 
iOf°
);

74160 
	`mem˝y
(&
p
->
zBuf
[
iOf°
], zBuf, 
iAmt
);

74161 if–
p
->
iSize
<(
iOf°
+
iAmt
) ){

74162 
p
->
iSize
 = (
iOf°
+
iAmt
);

74166  
rc
;

74172 
	`j∫lTrunˇã
(
sqlôe3_fûe
 *
pJfd
, 
sqlôe_öt64
 
size
){

74173 
rc
 = 
SQLITE_OK
;

74174 
Jou∫ÆFûe
 *
p
 = (Jou∫ÆFûê*)
pJfd
;

74175 if–
p
->
pRól
 ){

74176 
rc
 = 
	`sqlôe3OsTrunˇã
(
p
->
pRól
, 
size
);

74177 }if–
size
<
p
->
iSize
 ){

74178 
p
->
iSize
 = 
size
;

74180  
rc
;

74186 
	`j∫lSync
(
sqlôe3_fûe
 *
pJfd
, 
Êags
){

74187 
rc
;

74188 
Jou∫ÆFûe
 *
p
 = (Jou∫ÆFûê*)
pJfd
;

74189 if–
p
->
pRól
 ){

74190 
rc
 = 
	`sqlôe3OsSync
(
p
->
pRól
, 
Êags
);

74192 
rc
 = 
SQLITE_OK
;

74194  
rc
;

74200 
	`j∫lFûeSize
(
sqlôe3_fûe
 *
pJfd
, 
sqlôe_öt64
 *
pSize
){

74201 
rc
 = 
SQLITE_OK
;

74202 
Jou∫ÆFûe
 *
p
 = (Jou∫ÆFûê*)
pJfd
;

74203 if–
p
->
pRól
 ){

74204 
rc
 = 
	`sqlôe3OsFûeSize
(
p
->
pRól
, 
pSize
);

74206 *
pSize
 = (
sqlôe_öt64
Ë
p
->
iSize
;

74208  
rc
;

74214 
sqlôe3_io_mëhods
 
Jou∫ÆFûeMëhods
 = {

74216 
j∫lClo£
,

74217 
j∫lRód
,

74218 
j∫lWrôe
,

74219 
j∫lTrunˇã
,

74220 
j∫lSync
,

74221 
j∫lFûeSize
,

74237 
SQLITE_PRIVATE
 
	`sqlôe3Jou∫ÆO≥n
(

74238 
sqlôe3_vfs
 *
pVfs
,

74239 c⁄° *
zName
,

74240 
sqlôe3_fûe
 *
pJfd
,

74241 
Êags
,

74242 
nBuf


74244 
Jou∫ÆFûe
 *
p
 = (Jou∫ÆFûê*)
pJfd
;

74245 
	`mem£t
(
p
, 0, 
	`sqlôe3Jou∫ÆSize
(
pVfs
));

74246 if–
nBuf
>0 ){

74247 
p
->
zBuf
 = 
	`sqlôe3MÆlocZîo
(
nBuf
);

74248 if–!
p
->
zBuf
 ){

74249  
SQLITE_NOMEM
;

74252  
	`sqlôe3OsO≥n
(
pVfs
, 
zName
, 
pJfd
, 
Êags
, 0);

74254 
p
->
pMëhod
 = &
Jou∫ÆFûeMëhods
;

74255 
p
->
nBuf
 =ÇBuf;

74256 
p
->
Êags
 = flags;

74257 
p
->
zJou∫Æ
 = 
zName
;

74258 
p
->
pVfs
 =ÖVfs;

74259  
SQLITE_OK
;

74266 
SQLITE_PRIVATE
 
	`sqlôe3Jou∫ÆCª©e
(
sqlôe3_fûe
 *
p
){

74267 if–
p
->
pMëhods
!=&
Jou∫ÆFûeMëhods
 ){

74268  
SQLITE_OK
;

74270  
	`¸óãFûe
((
Jou∫ÆFûe
 *)
p
);

74279 
SQLITE_PRIVATE
 
	`sqlôe3Jou∫ÆExi°s
(
sqlôe3_fûe
 *
p
){

74280  (
p
->
pMëhods
!=&
Jou∫ÆFûeMëhods
 || ((
Jou∫ÆFûe
 *Ì)->
pRól
!=0);

74287 
SQLITE_PRIVATE
 
	`sqlôe3Jou∫ÆSize
(
sqlôe3_vfs
 *
pVfs
){

74288  (
pVfs
->
szOsFûe
+(
Jou∫ÆFûe
));

74312 
MemJou∫Æ
 
	tMemJou∫Æ
;

74313 
FûePoöt
 
	tFûePoöt
;

74314 
FûeChunk
 
	tFûeChunk
;

74324 
	#JOURNAL_CHUNKSIZE
 (()(1024-(
FûeChunk
*)))

	)

74329 
	sFûeChunk
 {

74330 
FûeChunk
 *
pNext
;

74331 
u8
 
zChunk
[
JOURNAL_CHUNKSIZE
];

74338 
	sFûePoöt
 {

74339 
sqlôe3_öt64
 
iOff£t
;

74340 
FûeChunk
 *
pChunk
;

74347 
	sMemJou∫Æ
 {

74348 
sqlôe3_io_mëhods
 *
pMëhod
;

74349 
FûeChunk
 *
pFú°
;

74350 
FûePoöt
 
ídpoöt
;

74351 
FûePoöt
 
ªadpoöt
;

74358 
	`memj∫lRód
(

74359 
sqlôe3_fûe
 *
pJfd
,

74360 *
zBuf
,

74361 
iAmt
,

74362 
sqlôe_öt64
 
iOf°


74364 
MemJou∫Æ
 *
p
 = (MemJou∫Æ *)
pJfd
;

74365 
u8
 *
zOut
 = 
zBuf
;

74366 
nRód
 = 
iAmt
;

74367 
iChunkOff£t
;

74368 
FûeChunk
 *
pChunk
;

74371 
	`as£π
–
iOf°
+
iAmt
<=
p
->
ídpoöt
.
iOff£t
 );

74373 if–
p
->
ªadpoöt
.
iOff£t
!=
iOf°
 || iOfst==0 ){

74374 
sqlôe3_öt64
 
iOff
 = 0;

74375 
pChunk
=
p
->
pFú°
;

74376 
	`ALWAYS
(
pChunk
Ë&& (
iOff
+
JOURNAL_CHUNKSIZE
)<=
iOf°
;

74377 
pChunk
ıChunk->
pNext


74379 
iOff
 +
JOURNAL_CHUNKSIZE
;

74382 
pChunk
 = 
p
->
ªadpoöt
.pChunk;

74385 
iChunkOff£t
 = ()(
iOf°
%
JOURNAL_CHUNKSIZE
);

74387 
iS∑˚
 = 
JOURNAL_CHUNKSIZE
 - 
iChunkOff£t
;

74388 
nC›y
 = 
	`MIN
(
nRód
, (
JOURNAL_CHUNKSIZE
 - 
iChunkOff£t
));

74389 
	`mem˝y
(
zOut
, &
pChunk
->
zChunk
[
iChunkOff£t
], 
nC›y
);

74390 
zOut
 +
nC›y
;

74391 
nRód
 -
iS∑˚
;

74392 
iChunkOff£t
 = 0;

74393 }  
nRód
>=0 && (
pChunk
ıChunk->
pNext
)!=0 &&ÇRead>0 );

74394 
p
->
ªadpoöt
.
iOff£t
 = 
iOf°
+
iAmt
;

74395 
p
->
ªadpoöt
.
pChunk
 =ÖChunk;

74397  
SQLITE_OK
;

74403 
	`memj∫lWrôe
(

74404 
sqlôe3_fûe
 *
pJfd
,

74405 c⁄° *
zBuf
,

74406 
iAmt
,

74407 
sqlôe_öt64
 
iOf°


74409 
MemJou∫Æ
 *
p
 = (MemJou∫Æ *)
pJfd
;

74410 
nWrôe
 = 
iAmt
;

74411 
u8
 *
zWrôe
 = (u8 *)
zBuf
;

74416 
	`as£π
–
iOf°
==
p
->
ídpoöt
.
iOff£t
 );

74417 
	`UNUSED_PARAMETER
(
iOf°
);

74419  
nWrôe
>0 ){

74420 
FûeChunk
 *
pChunk
 = 
p
->
ídpoöt
.pChunk;

74421 
iChunkOff£t
 = ()(
p
->
ídpoöt
.
iOff£t
%
JOURNAL_CHUNKSIZE
);

74422 
iS∑˚
 = 
	`MIN
(
nWrôe
, 
JOURNAL_CHUNKSIZE
 - 
iChunkOff£t
);

74424 if–
iChunkOff£t
==0 ){

74426 
FûeChunk
 *
pNew
 = 
	`sqlôe3_mÆloc
((FileChunk));

74427 if–!
pNew
 ){

74428  
SQLITE_IOERR_NOMEM
;

74430 
pNew
->
pNext
 = 0;

74431 if–
pChunk
 ){

74432 
	`as£π
–
p
->
pFú°
 );

74433 
pChunk
->
pNext
 = 
pNew
;

74435 
	`as£π
–!
p
->
pFú°
 );

74436 
p
->
pFú°
 = 
pNew
;

74438 
p
->
ídpoöt
.
pChunk
 = 
pNew
;

74441 
	`mem˝y
(&
p
->
ídpoöt
.
pChunk
->
zChunk
[
iChunkOff£t
], 
zWrôe
, 
iS∑˚
);

74442 
zWrôe
 +
iS∑˚
;

74443 
nWrôe
 -
iS∑˚
;

74444 
p
->
ídpoöt
.
iOff£t
 +
iS∑˚
;

74447  
SQLITE_OK
;

74453 
	`memj∫lTrunˇã
(
sqlôe3_fûe
 *
pJfd
, 
sqlôe_öt64
 
size
){

74454 
MemJou∫Æ
 *
p
 = (MemJou∫Æ *)
pJfd
;

74455 
FûeChunk
 *
pChunk
;

74456 
	`as£π
(
size
==0);

74457 
	`UNUSED_PARAMETER
(
size
);

74458 
pChunk
 = 
p
->
pFú°
;

74459  
pChunk
 ){

74460 
FûeChunk
 *
pTmp
 = 
pChunk
;

74461 
pChunk
 =ÖChunk->
pNext
;

74462 
	`sqlôe3_‰ì
(
pTmp
);

74464 
	`sqlôe3MemJou∫ÆO≥n
(
pJfd
);

74465  
SQLITE_OK
;

74471 
	`memj∫lClo£
(
sqlôe3_fûe
 *
pJfd
){

74472 
	`memj∫lTrunˇã
(
pJfd
, 0);

74473  
SQLITE_OK
;

74485 
	`memj∫lSync
(
sqlôe3_fûe
 *
NŸU£d
, 
NŸU£d2
){

74486 
	`UNUSED_PARAMETER2
(
NŸU£d
, 
NŸU£d2
);

74487  
SQLITE_OK
;

74493 
	`memj∫lFûeSize
(
sqlôe3_fûe
 *
pJfd
, 
sqlôe_öt64
 *
pSize
){

74494 
MemJou∫Æ
 *
p
 = (MemJou∫Æ *)
pJfd
;

74495 *
pSize
 = (
sqlôe_öt64
Ë
p
->
ídpoöt
.
iOff£t
;

74496  
SQLITE_OK
;

74502 c⁄° 
sqlôe3_io_mëhods
 
MemJou∫ÆMëhods
 = {

74504 
memj∫lClo£
,

74505 
memj∫lRód
,

74506 
memj∫lWrôe
,

74507 
memj∫lTrunˇã
,

74508 
memj∫lSync
,

74509 
memj∫lFûeSize
,

74527 
SQLITE_PRIVATE
 
	`sqlôe3MemJou∫ÆO≥n
(
sqlôe3_fûe
 *
pJfd
){

74528 
MemJou∫Æ
 *
p
 = (MemJou∫Æ *)
pJfd
;

74529 
	`as£π
–
	`EIGHT_BYTE_ALIGNMENT
(
p
) );

74530 
	`mem£t
(
p
, 0, 
	`sqlôe3MemJou∫ÆSize
());

74531 
p
->
pMëhod
 = (
sqlôe3_io_mëhods
*)&
MemJou∫ÆMëhods
;

74538 
SQLITE_PRIVATE
 
	`sqlôe3IsMemJou∫Æ
(
sqlôe3_fûe
 *
pJfd
){

74539  
pJfd
->
pMëhods
==&
MemJou∫ÆMëhods
;

74545 
SQLITE_PRIVATE
 
	`sqlôe3MemJou∫ÆSize
(){

74546  (
MemJou∫Æ
);

74588 
SQLITE_PRIVATE
 
	`sqlôe3WÆkEx¥
(
WÆkî
 *
pWÆkî
, 
Ex¥
 *
pEx¥
){

74589 
rc
;

74590 if–
pEx¥
==0 )  
WRC_C⁄töue
;

74591 
	`ã°ˇ£
–
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_TokíO∆y
) );

74592 
	`ã°ˇ£
–
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_Redu˚d
) );

74593 
rc
 = 
pWÆkî
->
	`xEx¥CÆlback
’WÆkî, 
pEx¥
);

74594 if–
rc
==
WRC_C⁄töue


74595 && !
	`Ex¥HasPr›îty
(
pEx¥
,
EP_TokíO∆y
) ){

74596 if–
	`sqlôe3WÆkEx¥
(
pWÆkî
, 
pEx¥
->
pLe·
ËË 
WRC_Ab‹t
;

74597 if–
	`sqlôe3WÆkEx¥
(
pWÆkî
, 
pEx¥
->
pRight
ËË 
WRC_Ab‹t
;

74598 if–
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_xIsSñe˘
) ){

74599 if–
	`sqlôe3WÆkSñe˘
(
pWÆkî
, 
pEx¥
->
x
.
pSñe˘
ËË 
WRC_Ab‹t
;

74601 if–
	`sqlôe3WÆkEx¥Li°
(
pWÆkî
, 
pEx¥
->
x
.
pLi°
ËË 
WRC_Ab‹t
;

74604  
rc
 & 
WRC_Ab‹t
;

74611 
SQLITE_PRIVATE
 
	`sqlôe3WÆkEx¥Li°
(
WÆkî
 *
pWÆkî
, 
Ex¥Li°
 *
p
){

74612 
i
;

74613 
Ex¥Li°_ôem
 *
pIãm
;

74614 if–
p
 ){

74615 
i
=
p
->
nEx¥
, 
pIãm
ı->
a
; i>0; i--,ÖItem++){

74616 if–
	`sqlôe3WÆkEx¥
(
pWÆkî
, 
pIãm
->
pEx¥
ËË 
WRC_Ab‹t
;

74619  
WRC_C⁄töue
;

74628 
SQLITE_PRIVATE
 
	`sqlôe3WÆkSñe˘Ex¥
(
WÆkî
 *
pWÆkî
, 
Sñe˘
 *
p
){

74629 if–
	`sqlôe3WÆkEx¥Li°
(
pWÆkî
, 
p
->
pELi°
ËË 
WRC_Ab‹t
;

74630 if–
	`sqlôe3WÆkEx¥
(
pWÆkî
, 
p
->
pWhîe
ËË 
WRC_Ab‹t
;

74631 if–
	`sqlôe3WÆkEx¥Li°
(
pWÆkî
, 
p
->
pGroupBy
ËË 
WRC_Ab‹t
;

74632 if–
	`sqlôe3WÆkEx¥
(
pWÆkî
, 
p
->
pHavög
ËË 
WRC_Ab‹t
;

74633 if–
	`sqlôe3WÆkEx¥Li°
(
pWÆkî
, 
p
->
pOrdîBy
ËË 
WRC_Ab‹t
;

74634 if–
	`sqlôe3WÆkEx¥
(
pWÆkî
, 
p
->
pLimô
ËË 
WRC_Ab‹t
;

74635 if–
	`sqlôe3WÆkEx¥
(
pWÆkî
, 
p
->
pOff£t
ËË 
WRC_Ab‹t
;

74636  
WRC_C⁄töue
;

74646 
SQLITE_PRIVATE
 
	`sqlôe3WÆkSñe˘From
(
WÆkî
 *
pWÆkî
, 
Sñe˘
 *
p
){

74647 
SrcLi°
 *
pSrc
;

74648 
i
;

74649 
SrcLi°_ôem
 *
pIãm
;

74651 
pSrc
 = 
p
->pSrc;

74652 if–
	`ALWAYS
(
pSrc
) ){

74653 
i
=
pSrc
->
nSrc
, 
pIãm
ıSrc->
a
; i>0; i--,ÖItem++){

74654 if–
	`sqlôe3WÆkSñe˘
(
pWÆkî
, 
pIãm
->
pSñe˘
) ){

74655  
WRC_Ab‹t
;

74659  
WRC_C⁄töue
;

74675 
SQLITE_PRIVATE
 
	`sqlôe3WÆkSñe˘
(
WÆkî
 *
pWÆkî
, 
Sñe˘
 *
p
){

74676 
rc
;

74677 if–
p
==0 || 
pWÆkî
->
xSñe˘CÆlback
==0 )  
WRC_C⁄töue
;

74678 
rc
 = 
WRC_C⁄töue
;

74679 
pWÆkî
->
wÆkîDïth
++;

74680  
p
 ){

74681 if–!
pWÆkî
->
bSñe˘DïthFú°
 ){

74682 
rc
 = 
pWÆkî
->
	`xSñe˘CÆlback
’WÆkî, 
p
);

74683 if–
rc
 ) ;

74685 if–
	`sqlôe3WÆkSñe˘Ex¥
(
pWÆkî
, 
p
)

74686 || 
	`sqlôe3WÆkSñe˘From
(
pWÆkî
, 
p
)

74688 
pWÆkî
->
wÆkîDïth
--;

74689  
WRC_Ab‹t
;

74691 if–
pWÆkî
->
bSñe˘DïthFú°
 ){

74692 
rc
 = 
pWÆkî
->
	`xSñe˘CÆlback
’WÆkî, 
p
);

74696 if–
	`NEVER
(
rc
) ) ;

74698 
p
 =Ö->
pPri‹
;

74700 
pWÆkî
->
wÆkîDïth
--;

74701  
rc
 & 
WRC_Ab‹t
;

74734 
	`ö¸AggDïth
(
WÆkî
 *
pWÆkî
, 
Ex¥
 *
pEx¥
){

74735 if–
pEx¥
->
›
==
TK_AGG_FUNCTION
 )ÖEx¥->
›2
 +
pWÆkî
->
u
.
i
;

74736  
WRC_C⁄töue
;

74738 
	`ö¸AggFun˘i⁄Dïth
(
Ex¥
 *
pEx¥
, 
N
){

74739 if–
N
>0 ){

74740 
WÆkî
 
w
;

74741 
	`mem£t
(&
w
, 0, (w));

74742 
w
.
xEx¥CÆlback
 = 
ö¸AggDïth
;

74743 
w
.
u
.
i
 = 
N
;

74744 
	`sqlôe3WÆkEx¥
(&
w
, 
pEx¥
);

74791 
	`ªsﬁveAlüs
(

74792 
P¨£
 *
pP¨£
,

74793 
Ex¥Li°
 *
pELi°
,

74794 
iCﬁ
,

74795 
Ex¥
 *
pEx¥
,

74796 c⁄° *
zTy≥
,

74797 
nSubquîy


74799 
Ex¥
 *
pOrig
;

74800 
Ex¥
 *
pDup
;

74801 
sqlôe3
 *
db
;

74803 
	`as£π
–
iCﬁ
>=0 && iCﬁ<
pELi°
->
nEx¥
 );

74804 
pOrig
 = 
pELi°
->
a
[
iCﬁ
].
pEx¥
;

74805 
	`as£π
–
pOrig
!=0 );

74806 
	`as£π
–
pOrig
->
Êags
 & 
EP_Resﬁved
 );

74807 
db
 = 
pP¨£
->db;

74808 
pDup
 = 
	`sqlôe3Ex¥Dup
(
db
, 
pOrig
, 0);

74809 if–
pDup
==0 ) ;

74810 if–
pOrig
->
›
!=
TK_COLUMN
 && 
zTy≥
[0]!='G' ){

74811 
	`ö¸AggFun˘i⁄Dïth
(
pDup
, 
nSubquîy
);

74812 
pDup
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_AS
,ÖDup, 0, 0);

74813 if–
pDup
==0 ) ;

74814 
	`Ex¥SëPr›îty
(
pDup
, 
EP_Skù
);

74815 if–
pELi°
->
a
[
iCﬁ
].
iAlüs
==0 ){

74816 
pELi°
->
a
[
iCﬁ
].
iAlüs
 = (
u16
)(++
pP¨£
->
nAlüs
);

74818 
pDup
->
iTabÀ
 = 
pELi°
->
a
[
iCﬁ
].
iAlüs
;

74820 if–
pEx¥
->
›
==
TK_COLLATE
 ){

74821 
pDup
 = 
	`sqlôe3Ex¥AddCﬁœãSåög
(
pP¨£
,ÖDup, 
pEx¥
->
u
.
zTokí
);

74831 
	`Ex¥SëPr›îty
(
pEx¥
, 
EP_Sètic
);

74832 
	`sqlôe3Ex¥Dñëe
(
db
, 
pEx¥
);

74833 
	`mem˝y
(
pEx¥
, 
pDup
, (*pExpr));

74834 if–!
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_I¡VÆue
Ë&&ÖEx¥->
u
.
zTokí
!=0 ){

74835 
	`as£π
–(
pEx¥
->
Êags
 & (
EP_Redu˚d
|
EP_TokíO∆y
))==0 );

74836 
pEx¥
->
u
.
zTokí
 = 
	`sqlôe3DbSåDup
(
db
,ÖExpr->u.zToken);

74837 
pEx¥
->
Êags
 |
EP_MemTokí
;

74839 
	`sqlôe3DbFªe
(
db
, 
pDup
);

74849 
	`«meInUsögCœu£
(
IdLi°
 *
pUsög
, c⁄° *
zCﬁ
){

74850 if–
pUsög
 ){

74851 
k
;

74852 
k
=0; k<
pUsög
->
nId
; k++){

74853 if–
	`sqlôe3SåICmp
(
pUsög
->
a
[
k
].
zName
, 
zCﬁ
)==0 )  1;

74866 
SQLITE_PRIVATE
 
	`sqlôe3M©chS∑nName
(

74867 c⁄° *
zS∑n
,

74868 c⁄° *
zCﬁ
,

74869 c⁄° *
zTab
,

74870 c⁄° *
zDb


74872 
n
;

74873 
n
=0; 
	`ALWAYS
(
zS∑n
[n]) && zSpan[n]!='.';Ç++){}

74874 if–
zDb
 && (
	`sqlôe3SåNICmp
(
zS∑n
, zDb, 
n
)!=0 || zDb[n]!=0) ){

74877 
zS∑n
 +
n
+1;

74878 
n
=0; 
	`ALWAYS
(
zS∑n
[n]) && zSpan[n]!='.';Ç++){}

74879 if–
zTab
 && (
	`sqlôe3SåNICmp
(
zS∑n
, zTab, 
n
)!=0 || zTab[n]!=0) ){

74882 
zS∑n
 +
n
+1;

74883 if–
zCﬁ
 && 
	`sqlôe3SåICmp
(
zS∑n
, zCol)!=0 ){

74916 
	`lookupName
(

74917 
P¨£
 *
pP¨£
,

74918 c⁄° *
zDb
,

74919 c⁄° *
zTab
,

74920 c⁄° *
zCﬁ
,

74921 
NameC⁄ãxt
 *
pNC
,

74922 
Ex¥
 *
pEx¥


74924 
i
, 
j
;

74925 
˙t
 = 0;

74926 
˙tTab
 = 0;

74927 
nSubquîy
 = 0;

74928 
sqlôe3
 *
db
 = 
pP¨£
->db;

74929 
SrcLi°_ôem
 *
pIãm
;

74930 
SrcLi°_ôem
 *
pM©ch
 = 0;

74931 
NameC⁄ãxt
 *
pT›NC
 = 
pNC
;

74932 
Schema
 *
pSchema
 = 0;

74933 
isTriggî
 = 0;

74935 
	`as£π
–
pNC
 );

74936 
	`as£π
–
zCﬁ
 );

74937 
	`as£π
–!
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_TokíO∆y
|
EP_Redu˚d
) );

74940 
pEx¥
->
iTabÀ
 = -1;

74941 
pEx¥
->
pTab
 = 0;

74942 
	`Ex¥SëVVAPr›îty
(
pEx¥
, 
EP_NoRedu˚
);

74948 if–
zDb
 ){

74949 
	`ã°ˇ£
–
pNC
->
ncFœgs
 & 
NC_P¨tIdx
 );

74950 
	`ã°ˇ£
–
pNC
->
ncFœgs
 & 
NC_IsCheck
 );

74951 if–(
pNC
->
ncFœgs
 & (
NC_P¨tIdx
|
NC_IsCheck
))!=0 ){

74955 
zDb
 = 0;

74957 
i
=0; i<
db
->
nDb
; i++){

74958 
	`as£π
–
db
->
aDb
[
i
].
zName
 );

74959 if–
	`sqlôe3SåICmp
(
db
->
aDb
[
i
].
zName
,
zDb
)==0 ){

74960 
pSchema
 = 
db
->
aDb
[
i
].pSchema;

74968  
pNC
 && 
˙t
==0 ){

74969 
Ex¥Li°
 *
pELi°
;

74970 
SrcLi°
 *
pSrcLi°
 = 
pNC
->pSrcList;

74972 if–
pSrcLi°
 ){

74973 
i
=0, 
pIãm
=
pSrcLi°
->
a
; i<pSrcLi°->
nSrc
; i++,ÖItem++){

74974 
TabÀ
 *
pTab
;

74975 
Cﬁumn
 *
pCﬁ
;

74977 
pTab
 = 
pIãm
->pTab;

74978 
	`as£π
–
pTab
!=0 &&ÖTab->
zName
!=0 );

74979 
	`as£π
–
pTab
->
nCﬁ
>0 );

74980 if–
pIãm
->
pSñe˘
 && (pIãm->pSñe˘->
£lFœgs
 & 
SF_Ne°edFrom
)!=0 ){

74981 
hô
 = 0;

74982 
pELi°
 = 
pIãm
->
pSñe˘
->pEList;

74983 
j
=0; j<
pELi°
->
nEx¥
; j++){

74984 if–
	`sqlôe3M©chS∑nName
(
pELi°
->
a
[
j
].
zS∑n
, 
zCﬁ
, 
zTab
, 
zDb
) ){

74985 
˙t
++;

74986 
˙tTab
 = 2;

74987 
pM©ch
 = 
pIãm
;

74988 
pEx¥
->
iCﬁumn
 = 
j
;

74989 
hô
 = 1;

74992 if–
hô
 || 
zTab
==0 ) ;

74994 if–
zDb
 && 
pTab
->
pSchema
!=pSchema ){

74997 if–
zTab
 ){

74998 c⁄° *
zTabName
 = 
pIãm
->
zAlüs
 ?ÖIãm->zAlü†: 
pTab
->
zName
;

74999 
	`as£π
–
zTabName
!=0 );

75000 if–
	`sqlôe3SåICmp
(
zTabName
, 
zTab
)!=0 ){

75004 if–0==(
˙tTab
++) ){

75005 
pM©ch
 = 
pIãm
;

75007 
j
=0, 
pCﬁ
=
pTab
->
aCﬁ
; j<pTab->
nCﬁ
; j++,ÖCol++){

75008 if–
	`sqlôe3SåICmp
(
pCﬁ
->
zName
, 
zCﬁ
)==0 ){

75013 if–
˙t
==1 ){

75014 if–
pIãm
->
joöty≥
 & 
JT_NATURAL
 ) ;

75015 if–
	`«meInUsögCœu£
(
pIãm
->
pUsög
, 
zCﬁ
) ) ;

75017 
˙t
++;

75018 
pM©ch
 = 
pIãm
;

75020 
pEx¥
->
iCﬁumn
 = 
j
==
pTab
->
iPKey
 ? -1 : (
i16
)j;

75025 if–
pM©ch
 ){

75026 
pEx¥
->
iTabÀ
 = 
pM©ch
->
iCurs‹
;

75027 
pEx¥
->
pTab
 = 
pM©ch
->pTab;

75028 
pSchema
 = 
pEx¥
->
pTab
->pSchema;

75032 #i‚de‡
SQLITE_OMIT_TRIGGER


75036 if–
zDb
==0 && 
zTab
!=0 && 
˙t
==0 && 
pP¨£
->
pTriggîTab
!=0 ){

75037 
›
 = 
pP¨£
->
eTriggîOp
;

75038 
TabÀ
 *
pTab
 = 0;

75039 
	`as£π
–
›
==
TK_DELETE
 || op==
TK_UPDATE
 || op==
TK_INSERT
 );

75040 if–
›
!=
TK_DELETE
 && 
	`sqlôe3SåICmp
("√w",
zTab
) == 0 ){

75041 
pEx¥
->
iTabÀ
 = 1;

75042 
pTab
 = 
pP¨£
->
pTriggîTab
;

75043 }if–
›
!=
TK_INSERT
 && 
	`sqlôe3SåICmp
("ﬁd",
zTab
)==0 ){

75044 
pEx¥
->
iTabÀ
 = 0;

75045 
pTab
 = 
pP¨£
->
pTriggîTab
;

75048 if–
pTab
 ){

75049 
iCﬁ
;

75050 
pSchema
 = 
pTab
->pSchema;

75051 
˙tTab
++;

75052 
iCﬁ
=0; iCﬁ<
pTab
->
nCﬁ
; iCol++){

75053 
Cﬁumn
 *
pCﬁ
 = &
pTab
->
aCﬁ
[
iCﬁ
];

75054 if–
	`sqlôe3SåICmp
(
pCﬁ
->
zName
, 
zCﬁ
)==0 ){

75055 if–
iCﬁ
==
pTab
->
iPKey
 ){

75056 
iCﬁ
 = -1;

75061 if–
iCﬁ
>=
pTab
->
nCﬁ
 && 
	`sqlôe3IsRowid
(
zCﬁ
) ){

75062 
iCﬁ
 = -1;

75064 if–
iCﬁ
<
pTab
->
nCﬁ
 ){

75065 
˙t
++;

75066 if–
iCﬁ
<0 ){

75067 
pEx¥
->
afföôy
 = 
SQLITE_AFF_INTEGER
;

75068 }if–
pEx¥
->
iTabÀ
==0 ){

75069 
	`ã°ˇ£
–
iCﬁ
==31 );

75070 
	`ã°ˇ£
–
iCﬁ
==32 );

75071 
pP¨£
->
ﬁdmask
 |(
iCﬁ
>=32 ? 0xfffffff‡: (((
u32
)1)<<iCol));

75073 
	`ã°ˇ£
–
iCﬁ
==31 );

75074 
	`ã°ˇ£
–
iCﬁ
==32 );

75075 
pP¨£
->
√wmask
 |(
iCﬁ
>=32 ? 0xfffffff‡: (((
u32
)1)<<iCol));

75077 
pEx¥
->
iCﬁumn
 = (
i16
)
iCﬁ
;

75078 
pEx¥
->
pTab
 =ÖTab;

75079 
isTriggî
 = 1;

75088 if–
˙t
==0 && 
˙tTab
==1 && 
	`sqlôe3IsRowid
(
zCﬁ
) ){

75089 
˙t
 = 1;

75090 
pEx¥
->
iCﬁumn
 = -1;

75091 
pEx¥
->
afföôy
 = 
SQLITE_AFF_INTEGER
;

75112 if–(
pELi°
 = 
pNC
->pEList)!=0

75113 && 
zTab
==0

75114 && 
˙t
==0

75116 
j
=0; j<
pELi°
->
nEx¥
; j++){

75117 *
zAs
 = 
pELi°
->
a
[
j
].
zName
;

75118 if–
zAs
!=0 && 
	`sqlôe3SåICmp
(zAs, 
zCﬁ
)==0 ){

75119 
Ex¥
 *
pOrig
;

75120 
	`as£π
–
pEx¥
->
pLe·
==0 &&ÖEx¥->
pRight
==0 );

75121 
	`as£π
–
pEx¥
->
x
.
pLi°
==0 );

75122 
	`as£π
–
pEx¥
->
x
.
pSñe˘
==0 );

75123 
pOrig
 = 
pELi°
->
a
[
j
].
pEx¥
;

75124 if–(
pNC
->
ncFœgs
&
NC_AŒowAgg
)==0 && 
	`Ex¥HasPr›îty
(
pOrig
, 
EP_Agg
) ){

75125 
	`sqlôe3Eº‹Msg
(
pP¨£
, "misu£ o‡Æü£dággªg©ê%s", 
zAs
);

75126  
WRC_Ab‹t
;

75128 
	`ªsﬁveAlüs
(
pP¨£
, 
pELi°
, 
j
, 
pEx¥
, "", 
nSubquîy
);

75129 
˙t
 = 1;

75130 
pM©ch
 = 0;

75131 
	`as£π
–
zTab
==0 && 
zDb
==0 );

75132 
looku≤ame_íd
;

75140 if–
˙t
==0 ){

75141 
pNC
 =ÖNC->
pNext
;

75142 
nSubquîy
++;

75156 if–
˙t
==0 && 
zTab
==0 && 
	`Ex¥HasPr›îty
(
pEx¥
,
EP_DblQuŸed
) ){

75157 
pEx¥
->
›
 = 
TK_STRING
;

75158 
pEx¥
->
pTab
 = 0;

75159  
WRC_Pru√
;

75166 if–
˙t
!=1 ){

75167 c⁄° *
zEº
;

75168 
zEº
 = 
˙t
==0 ? "no such column" : "ambiguous columnÇame";

75169 if–
zDb
 ){

75170 
	`sqlôe3Eº‹Msg
(
pP¨£
, "%s: %s.%s.%s", 
zEº
, 
zDb
, 
zTab
, 
zCﬁ
);

75171 }if–
zTab
 ){

75172 
	`sqlôe3Eº‹Msg
(
pP¨£
, "%s: %s.%s", 
zEº
, 
zTab
, 
zCﬁ
);

75174 
	`sqlôe3Eº‹Msg
(
pP¨£
, "%s: %s", 
zEº
, 
zCﬁ
);

75176 
pP¨£
->
checkSchema
 = 1;

75177 
pT›NC
->
nEº
++;

75186 if–
pEx¥
->
iCﬁumn
>=0 && 
pM©ch
!=0 ){

75187 
n
 = 
pEx¥
->
iCﬁumn
;

75188 
	`ã°ˇ£
–
n
==
BMS
-1 );

75189 if–
n
>=
BMS
 ){

75190 
n
 = 
BMS
-1;

75192 
	`as£π
–
pM©ch
->
iCurs‹
==
pEx¥
->
iTabÀ
 );

75193 
pM©ch
->
cﬁU£d
 |((
Bômask
)1)<<
n
;

75198 
	`sqlôe3Ex¥Dñëe
(
db
, 
pEx¥
->
pLe·
);

75199 
pEx¥
->
pLe·
 = 0;

75200 
	`sqlôe3Ex¥Dñëe
(
db
, 
pEx¥
->
pRight
);

75201 
pEx¥
->
pRight
 = 0;

75202 
pEx¥
->
›
 = (
isTriggî
 ? 
TK_TRIGGER
 : 
TK_COLUMN
);

75203 
looku≤ame_íd
:

75204 if–
˙t
==1 ){

75205 
	`as£π
–
pNC
!=0 );

75206 if–
pEx¥
->
›
!=
TK_AS
 ){

75207 
	`sqlôe3AuthRód
(
pP¨£
, 
pEx¥
, 
pSchema
, 
pNC
->
pSrcLi°
);

75212 
	`as£π
–
pT›NC
!=0 );

75213 
pT›NC
->
nRef
++;

75214 if–
pT›NC
==
pNC
 ) ;

75215 
pT›NC
 =ÖT›NC->
pNext
;

75217  
WRC_Pru√
;

75219  
WRC_Ab‹t
;

75227 
SQLITE_PRIVATE
 
Ex¥
 *
	`sqlôe3Cª©eCﬁumnEx¥
(
sqlôe3
 *
db
, 
SrcLi°
 *
pSrc
, 
iSrc
, 
iCﬁ
){

75228 
Ex¥
 *
p
 = 
	`sqlôe3Ex¥AŒoc
(
db
, 
TK_COLUMN
, 0, 0);

75229 if–
p
 ){

75230 
SrcLi°_ôem
 *
pIãm
 = &
pSrc
->
a
[
iSrc
];

75231 
p
->
pTab
 = 
pIãm
->pTab;

75232 
p
->
iTabÀ
 = 
pIãm
->
iCurs‹
;

75233 if–
p
->
pTab
->
iPKey
==
iCﬁ
 ){

75234 
p
->
iCﬁumn
 = -1;

75236 
p
->
iCﬁumn
 = (
ynV¨
)
iCﬁ
;

75237 
	`ã°ˇ£
–
iCﬁ
==
BMS
 );

75238 
	`ã°ˇ£
–
iCﬁ
==
BMS
-1 );

75239 
pIãm
->
cﬁU£d
 |((
Bômask
)1)<<(
iCﬁ
>=
BMS
 ? BMS-1 : iCol);

75241 
	`Ex¥SëPr›îty
(
p
, 
EP_Resﬁved
);

75243  
p
;

75250 
	`nŸVÆidP¨tIdxWhîe
(

75251 
P¨£
 *
pP¨£
,

75252 
NameC⁄ãxt
 *
pNC
,

75253 c⁄° *
zMsg


75255 if–(
pNC
->
ncFœgs
 & 
NC_P¨tIdx
)!=0 ){

75256 
	`sqlôe3Eº‹Msg
(
pP¨£
, "%sÖrohibited inÖartial index WHERE clauses",

75257 
zMsg
);

75261 #i‚de‡
SQLITE_OMIT_CHECK


75265 
	`nŸVÆidCheckC⁄°øöt
(

75266 
P¨£
 *
pP¨£
,

75267 
NameC⁄ãxt
 *
pNC
,

75268 c⁄° *
zMsg


75270 if–(
pNC
->
ncFœgs
 & 
NC_IsCheck
)!=0 ){

75271 
	`sqlôe3Eº‹Msg
(
pP¨£
,"%†¥ohibôed i¿CHECK c⁄°øöts", 
zMsg
);

75275 
	#nŸVÆidCheckC⁄°øöt
(
P
,
N
,
M
)

	)

75283 
	`ex¥Probabûôy
(
Ex¥
 *
p
){

75284 
r
 = -1.0;

75285 if–
p
->
›
!=
TK_FLOAT
 )  -1;

75286 
	`sqlôe3AtoF
(
p
->
u
.
zTokí
, &
r
, 
	`sqlôe3SåÀn30
’->u.zTokí), 
SQLITE_UTF8
);

75287 
	`as£π
–
r
>=0.0 );

75288 if–
r
>1.0 )  -1;

75289  ()(
r
*1000.0);

75303 
	`ªsﬁveEx¥Sãp
(
WÆkî
 *
pWÆkî
, 
Ex¥
 *
pEx¥
){

75304 
NameC⁄ãxt
 *
pNC
;

75305 
P¨£
 *
pP¨£
;

75307 
pNC
 = 
pWÆkî
->
u
.pNC;

75308 
	`as£π
–
pNC
!=0 );

75309 
pP¨£
 = 
pNC
->pParse;

75310 
	`as£π
–
pP¨£
==
pWÆkî
->pParse );

75312 if–
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_Resﬁved
ËË 
WRC_Pru√
;

75313 
	`Ex¥SëPr›îty
(
pEx¥
, 
EP_Resﬁved
);

75314 #i‚de‡
NDEBUG


75315 if–
pNC
->
pSrcLi°
 &&ÖNC->pSrcLi°->
nAŒoc
>0 ){

75316 
SrcLi°
 *
pSrcLi°
 = 
pNC
->pSrcList;

75317 
i
;

75318 
i
=0; i<
pNC
->
pSrcLi°
->
nSrc
; i++){

75319 
	`as£π
–
pSrcLi°
->
a
[
i
].
iCurs‹
>=0 &&ÖSrcLi°->a[i].iCurs‹<
pP¨£
->
nTab
);

75323  
pEx¥
->
›
 ){

75325 #i‡
	`deföed
(
SQLITE_ENABLE_UPDATE_DELETE_LIMIT
Ë&& !deföed(
SQLITE_OMIT_SUBQUERY
)

75330 
TK_ROW
: {

75331 
SrcLi°
 *
pSrcLi°
 = 
pNC
->pSrcList;

75332 
SrcLi°_ôem
 *
pIãm
;

75333 
	`as£π
–
pSrcLi°
 &&ÖSrcLi°->
nSrc
==1 );

75334 
pIãm
 = 
pSrcLi°
->
a
;

75335 
pEx¥
->
›
 = 
TK_COLUMN
;

75336 
pEx¥
->
pTab
 = 
pIãm
->pTab;

75337 
pEx¥
->
iTabÀ
 = 
pIãm
->
iCurs‹
;

75338 
pEx¥
->
iCﬁumn
 = -1;

75339 
pEx¥
->
afföôy
 = 
SQLITE_AFF_INTEGER
;

75346 
TK_ID
: {

75347  
	`lookupName
(
pP¨£
, 0, 0, 
pEx¥
->
u
.
zTokí
, 
pNC
,ÖExpr);

75353 
TK_DOT
: {

75354 c⁄° *
zCﬁumn
;

75355 c⁄° *
zTabÀ
;

75356 c⁄° *
zDb
;

75357 
Ex¥
 *
pRight
;

75360 
pRight
 = 
pEx¥
->pRight;

75361 if–
pRight
->
›
==
TK_ID
 ){

75362 
zDb
 = 0;

75363 
zTabÀ
 = 
pEx¥
->
pLe·
->
u
.
zTokí
;

75364 
zCﬁumn
 = 
pRight
->
u
.
zTokí
;

75366 
	`as£π
–
pRight
->
›
==
TK_DOT
 );

75367 
zDb
 = 
pEx¥
->
pLe·
->
u
.
zTokí
;

75368 
zTabÀ
 = 
pRight
->
pLe·
->
u
.
zTokí
;

75369 
zCﬁumn
 = 
pRight
->pRight->
u
.
zTokí
;

75371  
	`lookupName
(
pP¨£
, 
zDb
, 
zTabÀ
, 
zCﬁumn
, 
pNC
, 
pEx¥
);

75376 
TK_CONST_FUNC
:

75377 
TK_FUNCTION
: {

75378 
Ex¥Li°
 *
pLi°
 = 
pEx¥
->
x
.pList;

75379 
n
 = 
pLi°
 ?ÖLi°->
nEx¥
 : 0;

75380 
no_such_func
 = 0;

75381 
wr⁄g_num_¨gs
 = 0;

75382 
is_agg
 = 0;

75383 
auth
;

75384 
nId
;

75385 c⁄° *
zId
;

75386 
FuncDef
 *
pDef
;

75387 
u8
 
íc
 = 
	`ENC
(
pP¨£
->
db
);

75389 
	`ã°ˇ£
–
pEx¥
->
›
==
TK_CONST_FUNC
 );

75390 
	`as£π
–!
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_xIsSñe˘
) );

75391 
	`nŸVÆidP¨tIdxWhîe
(
pP¨£
, 
pNC
, "functions");

75392 
zId
 = 
pEx¥
->
u
.
zTokí
;

75393 
nId
 = 
	`sqlôe3SåÀn30
(
zId
);

75394 
pDef
 = 
	`sqlôe3FödFun˘i⁄
(
pP¨£
->
db
, 
zId
, 
nId
, 
n
, 
íc
, 0);

75395 if–
pDef
==0 ){

75396 
pDef
 = 
	`sqlôe3FödFun˘i⁄
(
pP¨£
->
db
, 
zId
, 
nId
, -2, 
íc
, 0);

75397 if–
pDef
==0 ){

75398 
no_such_func
 = 1;

75400 
wr⁄g_num_¨gs
 = 1;

75403 
is_agg
 = 
pDef
->
xFunc
==0;

75404 if–
pDef
->
funcFœgs
 & 
SQLITE_FUNC_UNLIKELY
 ){

75405 
	`Ex¥SëPr›îty
(
pEx¥
, 
EP_U∆ikñy
|
EP_Skù
);

75406 if–
n
==2 ){

75407 
pEx¥
->
iTabÀ
 = 
	`ex¥Probabûôy
(
pLi°
->
a
[1].pExpr);

75408 if–
pEx¥
->
iTabÀ
<0 ){

75409 
	`sqlôe3Eº‹Msg
(
pP¨£
, "secondárgumentÅoÜikelihood() must beá "

75411 
pNC
->
nEº
++;

75418 
pEx¥
->
iTabÀ
 = 62;

75422 #i‚de‡
SQLITE_OMIT_AUTHORIZATION


75423 if–
pDef
 ){

75424 
auth
 = 
	`sqlôe3AuthCheck
(
pP¨£
, 
SQLITE_FUNCTION
, 0, 
pDef
->
zName
, 0);

75425 if–
auth
!=
SQLITE_OK
 ){

75426 if–
auth
==
SQLITE_DENY
 ){

75427 
	`sqlôe3Eº‹Msg
(
pP¨£
, "notáuthorizedÅo use function: %s",

75428 
pDef
->
zName
);

75429 
pNC
->
nEº
++;

75431 
pEx¥
->
›
 = 
TK_NULL
;

75432  
WRC_Pru√
;

75436 if–
is_agg
 && (
pNC
->
ncFœgs
 & 
NC_AŒowAgg
)==0 ){

75437 
	`sqlôe3Eº‹Msg
(
pP¨£
, "misu£ o‡aggªg©êfun˘i⁄ %.*s()", 
nId
,
zId
);

75438 
pNC
->
nEº
++;

75439 
is_agg
 = 0;

75440 }if–
no_such_func
 && 
pP¨£
->
db
->
öô
.
busy
==0 ){

75441 
	`sqlôe3Eº‹Msg
(
pP¨£
, "nÿsuch fun˘i⁄: %.*s", 
nId
, 
zId
);

75442 
pNC
->
nEº
++;

75443 }if–
wr⁄g_num_¨gs
 ){

75444 
	`sqlôe3Eº‹Msg
(
pP¨£
,"wrongÇumber ofárgumentsÅo function %.*s()",

75445 
nId
, 
zId
);

75446 
pNC
->
nEº
++;

75448 if–
is_agg
 ) 
pNC
->
ncFœgs
 &~
NC_AŒowAgg
;

75449 
	`sqlôe3WÆkEx¥Li°
(
pWÆkî
, 
pLi°
);

75450 if–
is_agg
 ){

75451 
NameC⁄ãxt
 *
pNC2
 = 
pNC
;

75452 
pEx¥
->
›
 = 
TK_AGG_FUNCTION
;

75453 
pEx¥
->
›2
 = 0;

75454  
pNC2
 && !
	`sqlôe3Fun˘i⁄U£sThisSrc
(
pEx¥
,ÖNC2->
pSrcLi°
) ){

75455 
pEx¥
->
›2
++;

75456 
pNC2
 =ÖNC2->
pNext
;

75458 if–
pNC2
 )ÖNC2->
ncFœgs
 |
NC_HasAgg
;

75459 
pNC
->
ncFœgs
 |
NC_AŒowAgg
;

75464  
WRC_Pru√
;

75466 #i‚de‡
SQLITE_OMIT_SUBQUERY


75467 
TK_SELECT
:

75468 
TK_EXISTS
: 
	`ã°ˇ£
–
pEx¥
->
›
==TK_EXISTS );

75470 
TK_IN
: {

75471 
	`ã°ˇ£
–
pEx¥
->
›
==
TK_IN
 );

75472 if–
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_xIsSñe˘
) ){

75473 
nRef
 = 
pNC
->nRef;

75474 
	`nŸVÆidCheckC⁄°øöt
(
pP¨£
, 
pNC
, "subqueries");

75475 
	`nŸVÆidP¨tIdxWhîe
(
pP¨£
, 
pNC
, "subqueries");

75476 
	`sqlôe3WÆkSñe˘
(
pWÆkî
, 
pEx¥
->
x
.
pSñe˘
);

75477 
	`as£π
–
pNC
->
nRef
>=nRef );

75478 if–
nRef
!=
pNC
->nRef ){

75479 
	`Ex¥SëPr›îty
(
pEx¥
, 
EP_V¨Sñe˘
);

75484 
TK_VARIABLE
: {

75485 
	`nŸVÆidCheckC⁄°øöt
(
pP¨£
, 
pNC
, "parameters");

75486 
	`nŸVÆidP¨tIdxWhîe
(
pP¨£
, 
pNC
, "parameters");

75490  (
pP¨£
->
nEº
 ||ÖP¨£->
db
->
mÆlocFaûed
Ë? 
WRC_Ab‹t
 : 
WRC_C⁄töue
;

75505 
	`ªsﬁveAsName
(

75506 
P¨£
 *
pP¨£
,

75507 
Ex¥Li°
 *
pELi°
,

75508 
Ex¥
 *
pE


75510 
i
;

75512 
	`UNUSED_PARAMETER
(
pP¨£
);

75514 if–
pE
->
›
==
TK_ID
 ){

75515 *
zCﬁ
 = 
pE
->
u
.
zTokí
;

75516 
i
=0; i<
pELi°
->
nEx¥
; i++){

75517 *
zAs
 = 
pELi°
->
a
[
i
].
zName
;

75518 if–
zAs
!=0 && 
	`sqlôe3SåICmp
(zAs, 
zCﬁ
)==0 ){

75519  
i
+1;

75544 
	`ªsﬁveOrdîByTîmToEx¥Li°
(

75545 
P¨£
 *
pP¨£
,

75546 
Sñe˘
 *
pSñe˘
,

75547 
Ex¥
 *
pE


75549 
i
;

75550 
Ex¥Li°
 *
pELi°
;

75551 
NameC⁄ãxt
 
nc
;

75552 
sqlôe3
 *
db
;

75553 
rc
;

75554 
u8
 
ßvedSuµEº
;

75556 
	`as£π
–
	`sqlôe3Ex¥IsI¡egî
(
pE
, &
i
)==0 );

75557 
pELi°
 = 
pSñe˘
->pEList;

75561 
	`mem£t
(&
nc
, 0, (nc));

75562 
nc
.
pP¨£
 =ÖParse;

75563 
nc
.
pSrcLi°
 = 
pSñe˘
->
pSrc
;

75564 
nc
.
pELi°
 =ÖEList;

75565 
nc
.
ncFœgs
 = 
NC_AŒowAgg
;

75566 
nc
.
nEº
 = 0;

75567 
db
 = 
pP¨£
->db;

75568 
ßvedSuµEº
 = 
db
->
suµªssEº
;

75569 
db
->
suµªssEº
 = 1;

75570 
rc
 = 
	`sqlôe3ResﬁveEx¥Names
(&
nc
, 
pE
);

75571 
db
->
suµªssEº
 = 
ßvedSuµEº
;

75572 if–
rc
 )  0;

75578 
i
=0; i<
pELi°
->
nEx¥
; i++){

75579 if–
	`sqlôe3Ex¥Com∑ª
(
pELi°
->
a
[
i
].
pEx¥
, 
pE
, -1)<2 ){

75580  
i
+1;

75591 
	`ªsﬁveOutOfR™geEº‹
(

75592 
P¨£
 *
pP¨£
,

75593 c⁄° *
zTy≥
,

75594 
i
,

75595 
mx


75597 
	`sqlôe3Eº‹Msg
(
pP¨£
,

75599 "bëwì¿1ánd %d", 
i
, 
zTy≥
, 
mx
);

75617 
	`ªsﬁveCompoundOrdîBy
(

75618 
P¨£
 *
pP¨£
,

75619 
Sñe˘
 *
pSñe˘


75621 
i
;

75622 
Ex¥Li°
 *
pOrdîBy
;

75623 
Ex¥Li°
 *
pELi°
;

75624 
sqlôe3
 *
db
;

75625 
m‹eToDo
 = 1;

75627 
pOrdîBy
 = 
pSñe˘
->pOrderBy;

75628 if–
pOrdîBy
==0 )  0;

75629 
db
 = 
pP¨£
->db;

75630 #i‡
SQLITE_MAX_COLUMN


75631 if–
pOrdîBy
->
nEx¥
>
db
->
aLimô
[
SQLITE_LIMIT_COLUMN
] ){

75632 
	`sqlôe3Eº‹Msg
(
pP¨£
, "too manyÅerms in ORDER BY clause");

75636 
i
=0; i<
pOrdîBy
->
nEx¥
; i++){

75637 
pOrdîBy
->
a
[
i
].
d⁄e
 = 0;

75639 
pSñe˘
->
pNext
 = 0;

75640  
pSñe˘
->
pPri‹
 ){

75641 
pSñe˘
->
pPri‹
->
pNext
 =ÖSelect;

75642 
pSñe˘
 =ÖSñe˘->
pPri‹
;

75644  
pSñe˘
 && 
m‹eToDo
 ){

75645 
Ex¥Li°_ôem
 *
pIãm
;

75646 
m‹eToDo
 = 0;

75647 
pELi°
 = 
pSñe˘
->pEList;

75648 
	`as£π
–
pELi°
!=0 );

75649 
i
=0, 
pIãm
=
pOrdîBy
->
a
; i<pOrdîBy->
nEx¥
; i++,ÖItem++){

75650 
iCﬁ
 = -1;

75651 
Ex¥
 *
pE
, *
pDup
;

75652 if–
pIãm
->
d⁄e
 ) ;

75653 
pE
 = 
	`sqlôe3Ex¥SkùCﬁœã
(
pIãm
->
pEx¥
);

75654 if–
	`sqlôe3Ex¥IsI¡egî
(
pE
, &
iCﬁ
) ){

75655 if–
iCﬁ
<=0 || iCﬁ>
pELi°
->
nEx¥
 ){

75656 
	`ªsﬁveOutOfR™geEº‹
(
pP¨£
, "ORDER", 
i
+1, 
pELi°
->
nEx¥
);

75660 
iCﬁ
 = 
	`ªsﬁveAsName
(
pP¨£
, 
pELi°
, 
pE
);

75661 if–
iCﬁ
==0 ){

75662 
pDup
 = 
	`sqlôe3Ex¥Dup
(
db
, 
pE
, 0);

75663 if–!
db
->
mÆlocFaûed
 ){

75664 
	`as£π
(
pDup
);

75665 
iCﬁ
 = 
	`ªsﬁveOrdîByTîmToEx¥Li°
(
pP¨£
, 
pSñe˘
, 
pDup
);

75667 
	`sqlôe3Ex¥Dñëe
(
db
, 
pDup
);

75670 if–
iCﬁ
>0 ){

75673 
Ex¥
 *
pNew
 = 
	`sqlôe3Ex¥
(
db
, 
TK_INTEGER
, 0);

75674 if–
pNew
==0 )  1;

75675 
pNew
->
Êags
 |
EP_I¡VÆue
;

75676 
pNew
->
u
.
iVÆue
 = 
iCﬁ
;

75677 if–
pIãm
->
pEx¥
==
pE
 ){

75678 
pIãm
->
pEx¥
 = 
pNew
;

75680 
	`as£π
–
pIãm
->
pEx¥
->
›
==
TK_COLLATE
 );

75681 
	`as£π
–
pIãm
->
pEx¥
->
pLe·
==
pE
 );

75682 
pIãm
->
pEx¥
->
pLe·
 = 
pNew
;

75684 
	`sqlôe3Ex¥Dñëe
(
db
, 
pE
);

75685 
pIãm
->
iOrdîByCﬁ
 = (
u16
)
iCﬁ
;

75686 
pIãm
->
d⁄e
 = 1;

75688 
m‹eToDo
 = 1;

75691 
pSñe˘
 =ÖSñe˘->
pNext
;

75693 
i
=0; i<
pOrdîBy
->
nEx¥
; i++){

75694 if–
pOrdîBy
->
a
[
i
].
d⁄e
==0 ){

75695 
	`sqlôe3Eº‹Msg
(
pP¨£
, "%r ORDER BYÅerm doesÇot matchány "

75696 "cﬁum¿öÅhêªsu… së", 
i
+1);

75713 
SQLITE_PRIVATE
 
	`sqlôe3ResﬁveOrdîGroupBy
(

75714 
P¨£
 *
pP¨£
,

75715 
Sñe˘
 *
pSñe˘
,

75716 
Ex¥Li°
 *
pOrdîBy
,

75717 c⁄° *
zTy≥


75719 
i
;

75720 
sqlôe3
 *
db
 = 
pP¨£
->db;

75721 
Ex¥Li°
 *
pELi°
;

75722 
Ex¥Li°_ôem
 *
pIãm
;

75724 if–
pOrdîBy
==0 || 
pP¨£
->
db
->
mÆlocFaûed
 )  0;

75725 #i‡
SQLITE_MAX_COLUMN


75726 if–
pOrdîBy
->
nEx¥
>
db
->
aLimô
[
SQLITE_LIMIT_COLUMN
] ){

75727 
	`sqlôe3Eº‹Msg
(
pP¨£
, "toÿm™yÅîm†ö %†BY cœu£", 
zTy≥
);

75731 
pELi°
 = 
pSñe˘
->pEList;

75732 
	`as£π
–
pELi°
!=0 );

75733 
i
=0, 
pIãm
=
pOrdîBy
->
a
; i<pOrdîBy->
nEx¥
; i++,ÖItem++){

75734 if–
pIãm
->
iOrdîByCﬁ
 ){

75735 if–
pIãm
->
iOrdîByCﬁ
>
pELi°
->
nEx¥
 ){

75736 
	`ªsﬁveOutOfR™geEº‹
(
pP¨£
, 
zTy≥
, 
i
+1, 
pELi°
->
nEx¥
);

75739 
	`ªsﬁveAlüs
(
pP¨£
, 
pELi°
, 
pIãm
->
iOrdîByCﬁ
-1,ÖIãm->
pEx¥
, 
zTy≥
,0);

75763 
	`ªsﬁveOrdîGroupBy
(

75764 
NameC⁄ãxt
 *
pNC
,

75765 
Sñe˘
 *
pSñe˘
,

75766 
Ex¥Li°
 *
pOrdîBy
,

75767 c⁄° *
zTy≥


75769 
i
, 
j
;

75770 
iCﬁ
;

75771 
Ex¥Li°_ôem
 *
pIãm
;

75772 
P¨£
 *
pP¨£
;

75773 
nResu…
;

75775 if–
pOrdîBy
==0 )  0;

75776 
nResu…
 = 
pSñe˘
->
pELi°
->
nEx¥
;

75777 
pP¨£
 = 
pNC
->pParse;

75778 
i
=0, 
pIãm
=
pOrdîBy
->
a
; i<pOrdîBy->
nEx¥
; i++,ÖItem++){

75779 
Ex¥
 *
pE
 = 
pIãm
->
pEx¥
;

75780 
Ex¥
 *
pE2
 = 
	`sqlôe3Ex¥SkùCﬁœã
(
pE
);

75781 if–
zTy≥
[0]!='G' ){

75782 
iCﬁ
 = 
	`ªsﬁveAsName
(
pP¨£
, 
pSñe˘
->
pELi°
, 
pE2
);

75783 if–
iCﬁ
>0 ){

75788 
pIãm
->
iOrdîByCﬁ
 = (
u16
)
iCﬁ
;

75792 if–
	`sqlôe3Ex¥IsI¡egî
(
pE2
, &
iCﬁ
) ){

75796 if–
iCﬁ
<1 || iCol>0xffff ){

75797 
	`ªsﬁveOutOfR™geEº‹
(
pP¨£
, 
zTy≥
, 
i
+1, 
nResu…
);

75800 
pIãm
->
iOrdîByCﬁ
 = (
u16
)
iCﬁ
;

75805 
pIãm
->
iOrdîByCﬁ
 = 0;

75806 if–
	`sqlôe3ResﬁveEx¥Names
(
pNC
, 
pE
) ){

75809 
j
=0; j<
pSñe˘
->
pELi°
->
nEx¥
; j++){

75810 if–
	`sqlôe3Ex¥Com∑ª
(
pE
, 
pSñe˘
->
pELi°
->
a
[
j
].
pEx¥
, -1)==0 ){

75811 
pIãm
->
iOrdîByCﬁ
 = 
j
+1;

75815  
	`sqlôe3ResﬁveOrdîGroupBy
(
pP¨£
, 
pSñe˘
, 
pOrdîBy
, 
zTy≥
);

75821 
	`ªsﬁveSñe˘Sãp
(
WÆkî
 *
pWÆkî
, 
Sñe˘
 *
p
){

75822 
NameC⁄ãxt
 *
pOuãrNC
;

75823 
NameC⁄ãxt
 
sNC
;

75824 
isCompound
;

75825 
nCompound
;

75826 
P¨£
 *
pP¨£
;

75827 
Ex¥Li°
 *
pELi°
;

75828 
i
;

75829 
Ex¥Li°
 *
pGroupBy
;

75830 
Sñe˘
 *
pLe·mo°
;

75831 
sqlôe3
 *
db
;

75834 
	`as£π
–
p
!=0 );

75835 if–
p
->
£lFœgs
 & 
SF_Resﬁved
 ){

75836  
WRC_Pru√
;

75838 
pOuãrNC
 = 
pWÆkî
->
u
.
pNC
;

75839 
pP¨£
 = 
pWÆkî
->pParse;

75840 
db
 = 
pP¨£
->db;

75850 if–(
p
->
£lFœgs
 & 
SF_Ex∑nded
)==0 ){

75851 
	`sqlôe3Sñe˘Pªp
(
pP¨£
, 
p
, 
pOuãrNC
);

75852  (
pP¨£
->
nEº
 || 
db
->
mÆlocFaûed
Ë? 
WRC_Ab‹t
 : 
WRC_Pru√
;

75855 
isCompound
 = 
p
->
pPri‹
!=0;

75856 
nCompound
 = 0;

75857 
pLe·mo°
 = 
p
;

75858  
p
 ){

75859 
	`as£π
–(
p
->
£lFœgs
 & 
SF_Ex∑nded
)!=0 );

75860 
	`as£π
–(
p
->
£lFœgs
 & 
SF_Resﬁved
)==0 );

75861 
p
->
£lFœgs
 |
SF_Resﬁved
;

75866 
	`mem£t
(&
sNC
, 0, (sNC));

75867 
sNC
.
pP¨£
 =ÖParse;

75868 if–
	`sqlôe3ResﬁveEx¥Names
(&
sNC
, 
p
->
pLimô
) ||

75869 
	`sqlôe3ResﬁveEx¥Names
(&
sNC
, 
p
->
pOff£t
) ){

75870  
WRC_Ab‹t
;

75875 
i
=0; i<
p
->
pSrc
->
nSrc
; i++){

75876 
SrcLi°_ôem
 *
pIãm
 = &
p
->
pSrc
->
a
[
i
];

75877 if–
pIãm
->
pSñe˘
 ){

75878 
NameC⁄ãxt
 *
pNC
;

75879 
nRef
 = 0;

75880 c⁄° *
zSavedC⁄ãxt
 = 
pP¨£
->
zAuthC⁄ãxt
;

75887 
pNC
=
pOuãrNC
;ÖNC;ÖNCıNC->
pNext
Ë
nRef
 +=ÖNC->nRef;

75889 if–
pIãm
->
zName
 ) 
pP¨£
->
zAuthC⁄ãxt
 =ÖItem->zName;

75890 
	`sqlôe3ResﬁveSñe˘Names
(
pP¨£
, 
pIãm
->
pSñe˘
, 
pOuãrNC
);

75891 
pP¨£
->
zAuthC⁄ãxt
 = 
zSavedC⁄ãxt
;

75892 if–
pP¨£
->
nEº
 || 
db
->
mÆlocFaûed
 )  
WRC_Ab‹t
;

75894 
pNC
=
pOuãrNC
;ÖNC;ÖNCıNC->
pNext
Ë
nRef
 -=ÖNC->nRef;

75895 
	`as£π
–
pIãm
->
isC‹ªœãd
==0 && 
nRef
<=0 );

75896 
pIãm
->
isC‹ªœãd
 = (
nRef
!=0);

75903 
sNC
.
ncFœgs
 = 
NC_AŒowAgg
;

75904 
sNC
.
pSrcLi°
 = 
p
->
pSrc
;

75905 
sNC
.
pNext
 = 
pOuãrNC
;

75908 
pELi°
 = 
p
->pEList;

75909 
	`as£π
–
pELi°
!=0 );

75910 
i
=0; i<
pELi°
->
nEx¥
; i++){

75911 
Ex¥
 *
pX
 = 
pELi°
->
a
[
i
].
pEx¥
;

75912 if–
	`sqlôe3ResﬁveEx¥Names
(&
sNC
, 
pX
) ){

75913  
WRC_Ab‹t
;

75920 
	`as£π
–(
p
->
£lFœgs
 & 
SF_Aggªg©e
)==0 );

75921 
pGroupBy
 = 
p
->pGroupBy;

75922 if–
pGroupBy
 || (
sNC
.
ncFœgs
 & 
NC_HasAgg
)!=0 ){

75923 
p
->
£lFœgs
 |
SF_Aggªg©e
;

75925 
sNC
.
ncFœgs
 &~
NC_AŒowAgg
;

75930 if–
p
->
pHavög
 && !
pGroupBy
 ){

75931 
	`sqlôe3Eº‹Msg
(
pP¨£
, "a GROUP BY clause isÑequired before HAVING");

75932  
WRC_Ab‹t
;

75943 
sNC
.
pELi°
 = 
p
->pEList;

75944 if–
	`sqlôe3ResﬁveEx¥Names
(&
sNC
, 
p
->
pHavög
ËË 
WRC_Ab‹t
;

75945 if–
	`sqlôe3ResﬁveEx¥Names
(&
sNC
, 
p
->
pWhîe
ËË 
WRC_Ab‹t
;

75950 
sNC
.
pNext
 = 0;

75951 
sNC
.
ncFœgs
 |
NC_AŒowAgg
;

75958 if–!
isCompound
 && 
	`ªsﬁveOrdîGroupBy
(&
sNC
, 
p
,Ö->
pOrdîBy
, "ORDER") ){

75959  
WRC_Ab‹t
;

75961 if–
db
->
mÆlocFaûed
 ){

75962  
WRC_Ab‹t
;

75968 if–
pGroupBy
 ){

75969 
Ex¥Li°_ôem
 *
pIãm
;

75971 if–
	`ªsﬁveOrdîGroupBy
(&
sNC
, 
p
, 
pGroupBy
, "GROUP"Ë|| 
db
->
mÆlocFaûed
 ){

75972  
WRC_Ab‹t
;

75974 
i
=0, 
pIãm
=
pGroupBy
->
a
; i<pGroupBy->
nEx¥
; i++,ÖItem++){

75975 if–
	`Ex¥HasPr›îty
(
pIãm
->
pEx¥
, 
EP_Agg
) ){

75976 
	`sqlôe3Eº‹Msg
(
pP¨£
, "aggregate functionsáreÇotállowed in "

75978  
WRC_Ab‹t
;

75985 
p
 =Ö->
pPri‹
;

75986 
nCompound
++;

75992 if–
isCompound
 && 
	`ªsﬁveCompoundOrdîBy
(
pP¨£
, 
pLe·mo°
) ){

75993  
WRC_Ab‹t
;

75996  
WRC_Pru√
;

76047 
SQLITE_PRIVATE
 
	`sqlôe3ResﬁveEx¥Names
(

76048 
NameC⁄ãxt
 *
pNC
,

76049 
Ex¥
 *
pEx¥


76051 
u8
 
ßvedHasAgg
;

76052 
WÆkî
 
w
;

76054 if–
pEx¥
==0 )  0;

76055 #i‡
SQLITE_MAX_EXPR_DEPTH
>0

76057 
P¨£
 *
pP¨£
 = 
pNC
->pParse;

76058 if–
	`sqlôe3Ex¥CheckHeight
(
pP¨£
, 
pEx¥
->
nHeight
+
pNC
->pParse->nHeight) ){

76061 
pP¨£
->
nHeight
 +
pEx¥
->nHeight;

76064 
ßvedHasAgg
 = 
pNC
->
ncFœgs
 & 
NC_HasAgg
;

76065 
pNC
->
ncFœgs
 &~
NC_HasAgg
;

76066 
	`mem£t
(&
w
, 0, (w));

76067 
w
.
xEx¥CÆlback
 = 
ªsﬁveEx¥Sãp
;

76068 
w
.
xSñe˘CÆlback
 = 
ªsﬁveSñe˘Sãp
;

76069 
w
.
pP¨£
 = 
pNC
->pParse;

76070 
w
.
u
.
pNC
 =ÖNC;

76071 
	`sqlôe3WÆkEx¥
(&
w
, 
pEx¥
);

76072 #i‡
SQLITE_MAX_EXPR_DEPTH
>0

76073 
pNC
->
pP¨£
->
nHeight
 -
pEx¥
->nHeight;

76075 if–
pNC
->
nEº
>0 || 
w
.
pP¨£
->nErr>0 ){

76076 
	`Ex¥SëPr›îty
(
pEx¥
, 
EP_Eº‹
);

76078 if–
pNC
->
ncFœgs
 & 
NC_HasAgg
 ){

76079 
	`Ex¥SëPr›îty
(
pEx¥
, 
EP_Agg
);

76080 }if–
ßvedHasAgg
 ){

76081 
pNC
->
ncFœgs
 |
NC_HasAgg
;

76083  
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_Eº‹
);

76099 
SQLITE_PRIVATE
 
	`sqlôe3ResﬁveSñe˘Names
(

76100 
P¨£
 *
pP¨£
,

76101 
Sñe˘
 *
p
,

76102 
NameC⁄ãxt
 *
pOuãrNC


76104 
WÆkî
 
w
;

76106 
	`as£π
–
p
!=0 );

76107 
	`mem£t
(&
w
, 0, (w));

76108 
w
.
xEx¥CÆlback
 = 
ªsﬁveEx¥Sãp
;

76109 
w
.
xSñe˘CÆlback
 = 
ªsﬁveSñe˘Sãp
;

76110 
w
.
pP¨£
 =ÖParse;

76111 
w
.
u
.
pNC
 = 
pOuãrNC
;

76112 
	`sqlôe3WÆkSñe˘
(&
w
, 
p
);

76126 
SQLITE_PRIVATE
 
	`sqlôe3ResﬁveSñfRe„ªn˚
(

76127 
P¨£
 *
pP¨£
,

76128 
TabÀ
 *
pTab
,

76129 
ty≥
,

76130 
Ex¥
 *
pEx¥
,

76131 
Ex¥Li°
 *
pLi°


76133 
SrcLi°
 
sSrc
;

76134 
NameC⁄ãxt
 
sNC
;

76135 
i
;

76137 
	`as£π
–
ty≥
==
NC_IsCheck
 ||Åy≥==
NC_P¨tIdx
 );

76138 
	`mem£t
(&
sNC
, 0, (sNC));

76139 
	`mem£t
(&
sSrc
, 0, (sSrc));

76140 
sSrc
.
nSrc
 = 1;

76141 
sSrc
.
a
[0].
zName
 = 
pTab
->zName;

76142 
sSrc
.
a
[0].
pTab
 =ÖTab;

76143 
sSrc
.
a
[0].
iCurs‹
 = -1;

76144 
sNC
.
pP¨£
 =ÖParse;

76145 
sNC
.
pSrcLi°
 = &
sSrc
;

76146 
sNC
.
ncFœgs
 = 
ty≥
;

76147 if–
	`sqlôe3ResﬁveEx¥Names
(&
sNC
, 
pEx¥
) ) ;

76148 if–
pLi°
 ){

76149 
i
=0; i<
pLi°
->
nEx¥
; i++){

76150 if–
	`sqlôe3ResﬁveEx¥Names
(&
sNC
, 
pLi°
->
a
[
i
].
pEx¥
) ){

76190 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥Afföôy
(
Ex¥
 *
pEx¥
){

76191 
›
;

76192 
pEx¥
 = 
	`sqlôe3Ex¥SkùCﬁœã
(pExpr);

76193 
›
 = 
pEx¥
->op;

76194 if–
›
==
TK_SELECT
 ){

76195 
	`as£π
–
pEx¥
->
Êags
&
EP_xIsSñe˘
 );

76196  
	`sqlôe3Ex¥Afföôy
(
pEx¥
->
x
.
pSñe˘
->
pELi°
->
a
[0].pExpr);

76198 #i‚de‡
SQLITE_OMIT_CAST


76199 if–
›
==
TK_CAST
 ){

76200 
	`as£π
–!
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_I¡VÆue
) );

76201  
	`sqlôe3AfföôyTy≥
(
pEx¥
->
u
.
zTokí
, 0);

76204 if–(
›
==
TK_AGG_COLUMN
 || op==
TK_COLUMN
 || op==
TK_REGISTER
)

76205 && 
pEx¥
->
pTab
!=0

76209 
j
 = 
pEx¥
->
iCﬁumn
;

76210 if–
j
<0 )  
SQLITE_AFF_INTEGER
;

76211 
	`as£π
–
pEx¥
->
pTab
 && 
j
<pEx¥->pTab->
nCﬁ
 );

76212  
pEx¥
->
pTab
->
aCﬁ
[
j
].
afföôy
;

76214  
pEx¥
->
afföôy
;

76225 
SQLITE_PRIVATE
 
Ex¥
 *
	`sqlôe3Ex¥AddCﬁœãTokí
(
P¨£
 *
pP¨£
, Ex¥ *
pEx¥
, 
Tokí
 *
pCﬁlName
){

76226 if–
pCﬁlName
->
n
>0 ){

76227 
Ex¥
 *
pNew
 = 
	`sqlôe3Ex¥AŒoc
(
pP¨£
->
db
, 
TK_COLLATE
, 
pCﬁlName
, 1);

76228 if–
pNew
 ){

76229 
pNew
->
pLe·
 = 
pEx¥
;

76230 
pNew
->
Êags
 |
EP_Cﬁœã
|
EP_Skù
;

76231 
pEx¥
 = 
pNew
;

76234  
pEx¥
;

76236 
SQLITE_PRIVATE
 
Ex¥
 *
	`sqlôe3Ex¥AddCﬁœãSåög
(
P¨£
 *
pP¨£
, Ex¥ *
pEx¥
, c⁄° *
zC
){

76237 
Tokí
 
s
;

76238 
	`as£π
–
zC
!=0 );

76239 
s
.
z
 = 
zC
;

76240 
s
.
n
 = 
	`sqlôe3SåÀn30
(s.
z
);

76241  
	`sqlôe3Ex¥AddCﬁœãTokí
(
pP¨£
, 
pEx¥
, &
s
);

76248 
SQLITE_PRIVATE
 
Ex¥
 *
	`sqlôe3Ex¥SkùCﬁœã
(Ex¥ *
pEx¥
){

76249  
pEx¥
 && 
	`Ex¥HasPr›îty
’Ex¥, 
EP_Skù
) ){

76250 if–
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_U∆ikñy
) ){

76251 
	`as£π
–!
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_xIsSñe˘
) );

76252 
	`as£π
–
pEx¥
->
x
.
pLi°
->
nEx¥
>0 );

76253 
	`as£π
–
pEx¥
->
›
==
TK_FUNCTION
 );

76254 
pEx¥
 =ÖEx¥->
x
.
pLi°
->
a
[0].pExpr;

76256 
	`as£π
–
pEx¥
->
›
==
TK_COLLATE
 ||ÖEx¥->›==
TK_AS
 );

76257 
pEx¥
 =ÖEx¥->
pLe·
;

76260  
pEx¥
;

76272 
SQLITE_PRIVATE
 
CﬁlSeq
 *
	`sqlôe3Ex¥CﬁlSeq
(
P¨£
 *
pP¨£
, 
Ex¥
 *
pEx¥
){

76273 
sqlôe3
 *
db
 = 
pP¨£
->db;

76274 
CﬁlSeq
 *
pCﬁl
 = 0;

76275 
Ex¥
 *
p
 = 
pEx¥
;

76276  
p
 ){

76277 
›
 = 
p
->op;

76278 if–
›
==
TK_CAST
 || op==
TK_UPLUS
 ){

76279 
p
 =Ö->
pLe·
;

76282 if–
›
==
TK_COLLATE
 || (›==
TK_REGISTER
 && 
p
->
›2
==TK_COLLATE) ){

76283 
pCﬁl
 = 
	`sqlôe3GëCﬁlSeq
(
pP¨£
, 
	`ENC
(
db
), 0, 
p
->
u
.
zTokí
);

76286 if–
p
->
pTab
!=0

76287 && (
›
==
TK_AGG_COLUMN
 || op==
TK_COLUMN


76288 || 
›
==
TK_REGISTER
 || op==
TK_TRIGGER
)

76292 
j
 = 
p
->
iCﬁumn
;

76293 if–
j
>=0 ){

76294 c⁄° *
zCﬁl
 = 
p
->
pTab
->
aCﬁ
[
j
].zColl;

76295 
pCﬁl
 = 
	`sqlôe3FödCﬁlSeq
(
db
, 
	`ENC
(db), 
zCﬁl
, 0);

76299 if–
p
->
Êags
 & 
EP_Cﬁœã
 ){

76300 if–
	`ALWAYS
(
p
->
pLe·
Ë&& (p->pLe·->
Êags
 & 
EP_Cﬁœã
)!=0 ){

76301 
p
 =Ö->
pLe·
;

76303 
p
 =Ö->
pRight
;

76309 if–
	`sqlôe3CheckCﬁlSeq
(
pP¨£
, 
pCﬁl
) ){

76310 
pCﬁl
 = 0;

76312  
pCﬁl
;

76320 
SQLITE_PRIVATE
 
	`sqlôe3Com∑ªAfföôy
(
Ex¥
 *
pEx¥
, 
aff2
){

76321 
aff1
 = 
	`sqlôe3Ex¥Afföôy
(
pEx¥
);

76322 if–
aff1
 && 
aff2
 ){

76326 if–
	`sqlôe3IsNumîicAfföôy
(
aff1
Ë|| sqlôe3IsNumîicAfföôy(
aff2
) ){

76327  
SQLITE_AFF_NUMERIC
;

76329  
SQLITE_AFF_NONE
;

76331 }if–!
aff1
 && !
aff2
 ){

76335  
SQLITE_AFF_NONE
;

76338 
	`as£π
–
aff1
==0 || 
aff2
==0 );

76339  (
aff1
 + 
aff2
);

76347 
	`com∑ris⁄Afföôy
(
Ex¥
 *
pEx¥
){

76348 
aff
;

76349 
	`as£π
–
pEx¥
->
›
==
TK_EQ
 ||ÖEx¥->›==
TK_IN
 ||ÖEx¥->›==
TK_LT
 ||

76350 
pEx¥
->
›
==
TK_GT
 ||ÖEx¥->›==
TK_GE
 ||ÖEx¥->›==
TK_LE
 ||

76351 
pEx¥
->
›
==
TK_NE
 ||ÖEx¥->›==
TK_IS
 ||ÖEx¥->›==
TK_ISNOT
 );

76352 
	`as£π
–
pEx¥
->
pLe·
 );

76353 
aff
 = 
	`sqlôe3Ex¥Afföôy
(
pEx¥
->
pLe·
);

76354 if–
pEx¥
->
pRight
 ){

76355 
aff
 = 
	`sqlôe3Com∑ªAfföôy
(
pEx¥
->
pRight
,áff);

76356 }if–
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_xIsSñe˘
) ){

76357 
aff
 = 
	`sqlôe3Com∑ªAfföôy
(
pEx¥
->
x
.
pSñe˘
->
pELi°
->
a
[0].pExpr,áff);

76358 }if–!
aff
 ){

76359 
aff
 = 
SQLITE_AFF_NONE
;

76361  
aff
;

76370 
SQLITE_PRIVATE
 
	`sqlôe3IndexAfföôyOk
(
Ex¥
 *
pEx¥
, 
idx_afföôy
){

76371 
aff
 = 
	`com∑ris⁄Afföôy
(
pEx¥
);

76372  
aff
 ){

76373 
SQLITE_AFF_NONE
:

76375 
SQLITE_AFF_TEXT
:

76376  
idx_afföôy
==
SQLITE_AFF_TEXT
;

76378  
	`sqlôe3IsNumîicAfföôy
(
idx_afföôy
);

76386 
u8
 
	`bö¨yCom∑ªP5
(
Ex¥
 *
pEx¥1
, Ex¥ *
pEx¥2
, 
jumpIfNuŒ
){

76387 
u8
 
aff
 = ()
	`sqlôe3Ex¥Afföôy
(
pEx¥2
);

76388 
aff
 = (
u8
)
	`sqlôe3Com∑ªAfföôy
(
pEx¥1
,áffË| (u8)
jumpIfNuŒ
;

76389  
aff
;

76404 
SQLITE_PRIVATE
 
CﬁlSeq
 *
	`sqlôe3Bö¨yCom∑ªCﬁlSeq
(

76405 
P¨£
 *
pP¨£
,

76406 
Ex¥
 *
pLe·
,

76407 
Ex¥
 *
pRight


76409 
CﬁlSeq
 *
pCﬁl
;

76410 
	`as£π
–
pLe·
 );

76411 if–
pLe·
->
Êags
 & 
EP_Cﬁœã
 ){

76412 
pCﬁl
 = 
	`sqlôe3Ex¥CﬁlSeq
(
pP¨£
, 
pLe·
);

76413 }if–
pRight
 && (pRight->
Êags
 & 
EP_Cﬁœã
)!=0 ){

76414 
pCﬁl
 = 
	`sqlôe3Ex¥CﬁlSeq
(
pP¨£
, 
pRight
);

76416 
pCﬁl
 = 
	`sqlôe3Ex¥CﬁlSeq
(
pP¨£
, 
pLe·
);

76417 if–!
pCﬁl
 ){

76418 
pCﬁl
 = 
	`sqlôe3Ex¥CﬁlSeq
(
pP¨£
, 
pRight
);

76421  
pCﬁl
;

76427 
	`codeCom∑ª
(

76428 
P¨£
 *
pP¨£
,

76429 
Ex¥
 *
pLe·
,

76430 
Ex¥
 *
pRight
,

76431 
›code
,

76432 
ö1
, 
ö2
,

76433 
de°
,

76434 
jumpIfNuŒ


76436 
p5
;

76437 
addr
;

76438 
CﬁlSeq
 *
p4
;

76440 
p4
 = 
	`sqlôe3Bö¨yCom∑ªCﬁlSeq
(
pP¨£
, 
pLe·
, 
pRight
);

76441 
p5
 = 
	`bö¨yCom∑ªP5
(
pLe·
, 
pRight
, 
jumpIfNuŒ
);

76442 
addr
 = 
	`sqlôe3VdbeAddOp4
(
pP¨£
->
pVdbe
, 
›code
, 
ö2
, 
de°
, 
ö1
,

76443 (*)
p4
, 
P4_COLLSEQ
);

76444 
	`sqlôe3VdbeCh™geP5
(
pP¨£
->
pVdbe
, (
u8
)
p5
);

76445  
addr
;

76448 #i‡
SQLITE_MAX_EXPR_DEPTH
>0

76454 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥CheckHeight
(
P¨£
 *
pP¨£
, 
nHeight
){

76455 
rc
 = 
SQLITE_OK
;

76456 
mxHeight
 = 
pP¨£
->
db
->
aLimô
[
SQLITE_LIMIT_EXPR_DEPTH
];

76457 if–
nHeight
>
mxHeight
 ){

76458 
	`sqlôe3Eº‹Msg
(
pP¨£
,

76459 "Ex¥essi⁄Åªêi†toÿœrgê(maximum dïth %d)", 
mxHeight


76461 
rc
 = 
SQLITE_ERROR
;

76463  
rc
;

76475 
	`heightOfEx¥
(
Ex¥
 *
p
, *
≤Height
){

76476 if–
p
 ){

76477 if–
p
->
nHeight
>*
≤Height
 ){

76478 *
≤Height
 = 
p
->
nHeight
;

76482 
	`heightOfEx¥Li°
(
Ex¥Li°
 *
p
, *
≤Height
){

76483 if–
p
 ){

76484 
i
;

76485 
i
=0; i<
p
->
nEx¥
; i++){

76486 
	`heightOfEx¥
(
p
->
a
[
i
].
pEx¥
, 
≤Height
);

76490 
	`heightOfSñe˘
(
Sñe˘
 *
p
, *
≤Height
){

76491 if–
p
 ){

76492 
	`heightOfEx¥
(
p
->
pWhîe
, 
≤Height
);

76493 
	`heightOfEx¥
(
p
->
pHavög
, 
≤Height
);

76494 
	`heightOfEx¥
(
p
->
pLimô
, 
≤Height
);

76495 
	`heightOfEx¥
(
p
->
pOff£t
, 
≤Height
);

76496 
	`heightOfEx¥Li°
(
p
->
pELi°
, 
≤Height
);

76497 
	`heightOfEx¥Li°
(
p
->
pGroupBy
, 
≤Height
);

76498 
	`heightOfEx¥Li°
(
p
->
pOrdîBy
, 
≤Height
);

76499 
	`heightOfSñe˘
(
p
->
pPri‹
, 
≤Height
);

76510 
	`ex¥SëHeight
(
Ex¥
 *
p
){

76511 
nHeight
 = 0;

76512 
	`heightOfEx¥
(
p
->
pLe·
, &
nHeight
);

76513 
	`heightOfEx¥
(
p
->
pRight
, &
nHeight
);

76514 if–
	`Ex¥HasPr›îty
(
p
, 
EP_xIsSñe˘
) ){

76515 
	`heightOfSñe˘
(
p
->
x
.
pSñe˘
, &
nHeight
);

76517 
	`heightOfEx¥Li°
(
p
->
x
.
pLi°
, &
nHeight
);

76519 
p
->
nHeight
 =ÇHeight + 1;

76527 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥SëHeight
(
P¨£
 *
pP¨£
, 
Ex¥
 *
p
){

76528 
	`ex¥SëHeight
(
p
);

76529 
	`sqlôe3Ex¥CheckHeight
(
pP¨£
, 
p
->
nHeight
);

76536 
SQLITE_PRIVATE
 
	`sqlôe3Sñe˘Ex¥Height
(
Sñe˘
 *
p
){

76537 
nHeight
 = 0;

76538 
	`heightOfSñe˘
(
p
, &
nHeight
);

76539  
nHeight
;

76542 
	#ex¥SëHeight
(
y
)

	)

76565 
SQLITE_PRIVATE
 
Ex¥
 *
	`sqlôe3Ex¥AŒoc
(

76566 
sqlôe3
 *
db
,

76567 
›
,

76568 c⁄° 
Tokí
 *
pTokí
,

76569 
dequŸe


76571 
Ex¥
 *
pNew
;

76572 
nExåa
 = 0;

76573 
iVÆue
 = 0;

76575 if–
pTokí
 ){

76576 if–
›
!=
TK_INTEGER
 || 
pTokí
->
z
==0

76577 || 
	`sqlôe3GëI¡32
(
pTokí
->
z
, &
iVÆue
)==0 ){

76578 
nExåa
 = 
pTokí
->
n
+1;

76579 
	`as£π
–
iVÆue
>=0 );

76582 
pNew
 = 
	`sqlôe3DbMÆlocZîo
(
db
, (
Ex¥
)+
nExåa
);

76583 if–
pNew
 ){

76584 
pNew
->
›
 = (
u8
)op;

76585 
pNew
->
iAgg
 = -1;

76586 if–
pTokí
 ){

76587 if–
nExåa
==0 ){

76588 
pNew
->
Êags
 |
EP_I¡VÆue
;

76589 
pNew
->
u
.
iVÆue
 = iValue;

76591 
c
;

76592 
pNew
->
u
.
zTokí
 = (*)&pNew[1];

76593 
	`as£π
–
pTokí
->
z
!=0 ||ÖTokí->
n
==0 );

76594 if–
pTokí
->
n
 ) 
	`mem˝y
(
pNew
->
u
.
zTokí
,ÖTokí->
z
,ÖToken->n);

76595 
pNew
->
u
.
zTokí
[
pTokí
->
n
] = 0;

76596 if–
dequŸe
 && 
nExåa
>=3

76597 && ((
c
 = 
pTokí
->
z
[0])=='\'' || c=='"' || c=='[' || c=='`') ){

76598 
	`sqlôe3DequŸe
(
pNew
->
u
.
zTokí
);

76599 if–
c
=='"' ) 
pNew
->
Êags
 |
EP_DblQuŸed
;

76603 #i‡
SQLITE_MAX_EXPR_DEPTH
>0

76604 
pNew
->
nHeight
 = 1;

76607  
pNew
;

76614 
SQLITE_PRIVATE
 
Ex¥
 *
	`sqlôe3Ex¥
(

76615 
sqlôe3
 *
db
,

76616 
›
,

76617 c⁄° *
zTokí


76619 
Tokí
 
x
;

76620 
x
.
z
 = 
zTokí
;

76621 
x
.
n
 = 
zTokí
 ? 
	`sqlôe3SåÀn30
(zToken) : 0;

76622  
	`sqlôe3Ex¥AŒoc
(
db
, 
›
, &
x
, 0);

76631 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥AâachSubåìs
(

76632 
sqlôe3
 *
db
,

76633 
Ex¥
 *
pRoŸ
,

76634 
Ex¥
 *
pLe·
,

76635 
Ex¥
 *
pRight


76637 if–
pRoŸ
==0 ){

76638 
	`as£π
–
db
->
mÆlocFaûed
 );

76639 
	`sqlôe3Ex¥Dñëe
(
db
, 
pLe·
);

76640 
	`sqlôe3Ex¥Dñëe
(
db
, 
pRight
);

76642 if–
pRight
 ){

76643 
pRoŸ
->
pRight
 =ÖRight;

76644 
pRoŸ
->
Êags
 |
EP_Cﬁœã
 & 
pRight
->flags;

76646 if–
pLe·
 ){

76647 
pRoŸ
->
pLe·
 =ÖLeft;

76648 
pRoŸ
->
Êags
 |
EP_Cﬁœã
 & 
pLe·
->flags;

76650 
	`ex¥SëHeight
(
pRoŸ
);

76661 
SQLITE_PRIVATE
 
Ex¥
 *
	`sqlôe3PEx¥
(

76662 
P¨£
 *
pP¨£
,

76663 
›
,

76664 
Ex¥
 *
pLe·
,

76665 
Ex¥
 *
pRight
,

76666 c⁄° 
Tokí
 *
pTokí


76668 
Ex¥
 *
p
;

76669 if–
›
==
TK_AND
 && 
pLe·
 && 
pRight
 ){

76671 
p
 = 
	`sqlôe3Ex¥And
(
pP¨£
->
db
, 
pLe·
, 
pRight
);

76673 
p
 = 
	`sqlôe3Ex¥AŒoc
(
pP¨£
->
db
, 
›
, 
pTokí
, 1);

76674 
	`sqlôe3Ex¥AâachSubåìs
(
pP¨£
->
db
, 
p
, 
pLe·
, 
pRight
);

76676 if–
p
 ) {

76677 
	`sqlôe3Ex¥CheckHeight
(
pP¨£
, 
p
->
nHeight
);

76679  
p
;

76693 
	`ex¥AlwaysFÆ£
(
Ex¥
 *
p
){

76694 
v
 = 0;

76695 if–
	`Ex¥HasPr›îty
(
p
, 
EP_FromJoö
) )  0;

76696 if–!
	`sqlôe3Ex¥IsI¡egî
(
p
, &
v
) )  0;

76697  
v
==0;

76708 
SQLITE_PRIVATE
 
Ex¥
 *
	`sqlôe3Ex¥And
(
sqlôe3
 *
db
, Ex¥ *
pLe·
, Ex¥ *
pRight
){

76709 if–
pLe·
==0 ){

76710  
pRight
;

76711 }if–
pRight
==0 ){

76712  
pLe·
;

76713 }if–
	`ex¥AlwaysFÆ£
(
pLe·
Ë||Éx¥AlwaysFÆ£(
pRight
) ){

76714 
	`sqlôe3Ex¥Dñëe
(
db
, 
pLe·
);

76715 
	`sqlôe3Ex¥Dñëe
(
db
, 
pRight
);

76716  
	`sqlôe3Ex¥AŒoc
(
db
, 
TK_INTEGER
, &
sqlôe3I¡Tokís
[0], 0);

76718 
Ex¥
 *
pNew
 = 
	`sqlôe3Ex¥AŒoc
(
db
, 
TK_AND
, 0, 0);

76719 
	`sqlôe3Ex¥AâachSubåìs
(
db
, 
pNew
, 
pLe·
, 
pRight
);

76720  
pNew
;

76728 
SQLITE_PRIVATE
 
Ex¥
 *
	`sqlôe3Ex¥Fun˘i⁄
(
P¨£
 *
pP¨£
, 
Ex¥Li°
 *
pLi°
, 
Tokí
 *
pTokí
){

76729 
Ex¥
 *
pNew
;

76730 
sqlôe3
 *
db
 = 
pP¨£
->db;

76731 
	`as£π
–
pTokí
 );

76732 
pNew
 = 
	`sqlôe3Ex¥AŒoc
(
db
, 
TK_FUNCTION
, 
pTokí
, 1);

76733 if–
pNew
==0 ){

76734 
	`sqlôe3Ex¥Li°Dñëe
(
db
, 
pLi°
);

76737 
pNew
->
x
.
pLi°
 =ÖList;

76738 
	`as£π
–!
	`Ex¥HasPr›îty
(
pNew
, 
EP_xIsSñe˘
) );

76739 
	`sqlôe3Ex¥SëHeight
(
pP¨£
, 
pNew
);

76740  
pNew
;

76759 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥AssignV¨Numbî
(
P¨£
 *
pP¨£
, 
Ex¥
 *
pEx¥
){

76760 
sqlôe3
 *
db
 = 
pP¨£
->db;

76761 c⁄° *
z
;

76763 if–
pEx¥
==0 ) ;

76764 
	`as£π
–!
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_I¡VÆue
|
EP_Redu˚d
|
EP_TokíO∆y
) );

76765 
z
 = 
pEx¥
->
u
.
zTokí
;

76766 
	`as£π
–
z
!=0 );

76767 
	`as£π
–
z
[0]!=0 );

76768 if–
z
[1]==0 ){

76770 
	`as£π
–
z
[0]=='?' );

76771 
pEx¥
->
iCﬁumn
 = (
ynV¨
)(++
pP¨£
->
nV¨
);

76773 
ynV¨
 
x
 = 0;

76774 
u32
 
n
 = 
	`sqlôe3SåÀn30
(
z
);

76775 if–
z
[0]=='?' ){

76778 
i64
 
i
;

76779 
bOk
 = 0==
	`sqlôe3Atoi64
(&
z
[1], &
i
, 
n
-1, 
SQLITE_UTF8
);

76780 
pEx¥
->
iCﬁumn
 = 
x
 = (
ynV¨
)
i
;

76781 
	`ã°ˇ£
–
i
==0 );

76782 
	`ã°ˇ£
–
i
==1 );

76783 
	`ã°ˇ£
–
i
==
db
->
aLimô
[
SQLITE_LIMIT_VARIABLE_NUMBER
]-1 );

76784 
	`ã°ˇ£
–
i
==
db
->
aLimô
[
SQLITE_LIMIT_VARIABLE_NUMBER
] );

76785 if–
bOk
==0 || 
i
<1 || i>
db
->
aLimô
[
SQLITE_LIMIT_VARIABLE_NUMBER
] ){

76786 
	`sqlôe3Eº‹Msg
(
pP¨£
, "variableÇumber must be between ?1ánd ?%d",

76787 
db
->
aLimô
[
SQLITE_LIMIT_VARIABLE_NUMBER
]);

76788 
x
 = 0;

76790 if–
i
>
pP¨£
->
nV¨
 ){

76791 
pP¨£
->
nV¨
 = ()
i
;

76798 
ynV¨
 
i
;

76799 
i
=0; i<
pP¨£
->
nzV¨
; i++){

76800 if–
pP¨£
->
azV¨
[
i
] && 
	`°rcmp
’P¨£->azV¨[i],
z
)==0 ){

76801 
pEx¥
->
iCﬁumn
 = 
x
 = (
ynV¨
)
i
+1;

76805 if–
x
==0 ) x = 
pEx¥
->
iCﬁumn
 = (
ynV¨
)(++
pP¨£
->
nV¨
);

76807 if–
x
>0 ){

76808 if–
x
>
pP¨£
->
nzV¨
 ){

76809 **
a
;

76810 
a
 = 
	`sqlôe3DbRóŒoc
(
db
, 
pP¨£
->
azV¨
, 
x
*(a[0]));

76811 if–
a
==0 ) ;

76812 
pP¨£
->
azV¨
 = 
a
;

76813 
	`mem£t
(&
a
[
pP¨£
->
nzV¨
], 0, (
x
-pParse->nzVar)*(a[0]));

76814 
pP¨£
->
nzV¨
 = 
x
;

76816 if–
z
[0]!='?' || 
pP¨£
->
azV¨
[
x
-1]==0 ){

76817 
	`sqlôe3DbFªe
(
db
, 
pP¨£
->
azV¨
[
x
-1]);

76818 
pP¨£
->
azV¨
[
x
-1] = 
	`sqlôe3DbSåNDup
(
db
, 
z
, 
n
);

76822 if–!
pP¨£
->
nEº
 &&ÖP¨£->
nV¨
>
db
->
aLimô
[
SQLITE_LIMIT_VARIABLE_NUMBER
] ){

76823 
	`sqlôe3Eº‹Msg
(
pP¨£
, "too many SQL variables");

76830 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥Dñëe
(
sqlôe3
 *
db
, 
Ex¥
 *
p
){

76831 if–
p
==0 ) ;

76833 
	`as£π
–!
	`Ex¥HasPr›îty
(
p
, 
EP_I¡VÆue
Ë||Ö->
u
.
iVÆue
>=0 );

76834 if–!
	`Ex¥HasPr›îty
(
p
, 
EP_TokíO∆y
) ){

76836 
	`as£π
–
p
->
x
.
pLi°
==0 ||Ö->
pRight
==0 );

76837 
	`sqlôe3Ex¥Dñëe
(
db
, 
p
->
pLe·
);

76838 
	`sqlôe3Ex¥Dñëe
(
db
, 
p
->
pRight
);

76839 if–
	`Ex¥HasPr›îty
(
p
, 
EP_MemTokí
ËË
	`sqlôe3DbFªe
(
db
,Ö->
u
.
zTokí
);

76840 if–
	`Ex¥HasPr›îty
(
p
, 
EP_xIsSñe˘
) ){

76841 
	`sqlôe3Sñe˘Dñëe
(
db
, 
p
->
x
.
pSñe˘
);

76843 
	`sqlôe3Ex¥Li°Dñëe
(
db
, 
p
->
x
.
pLi°
);

76846 if–!
	`Ex¥HasPr›îty
(
p
, 
EP_Sètic
) ){

76847 
	`sqlôe3DbFªe
(
db
, 
p
);

76856 
	`ex¥Såu˘Size
(
Ex¥
 *
p
){

76857 if–
	`Ex¥HasPr›îty
(
p
, 
EP_TokíO∆y
ËË 
EXPR_TOKENONLYSIZE
;

76858 if–
	`Ex¥HasPr›îty
(
p
, 
EP_Redu˚d
ËË 
EXPR_REDUCEDSIZE
;

76859  
EXPR_FULLSIZE
;

76896 
	`du≥dEx¥Såu˘Size
(
Ex¥
 *
p
, 
Êags
){

76897 
nSize
;

76898 
	`as£π
–
Êags
==
EXPRDUP_REDUCE
 || flags==0 );

76899 
	`as£π
–
EXPR_FULLSIZE
<=0xfff );

76900 
	`as£π
–(0xff‡& (
EP_Redu˚d
|
EP_TokíO∆y
))==0 );

76901 if–0==(
Êags
&
EXPRDUP_REDUCE
) ){

76902 
nSize
 = 
EXPR_FULLSIZE
;

76904 
	`as£π
–!
	`Ex¥HasPr›îty
(
p
, 
EP_TokíO∆y
|
EP_Redu˚d
) );

76905 
	`as£π
–!
	`Ex¥HasPr›îty
(
p
, 
EP_FromJoö
) );

76906 
	`as£π
–!
	`Ex¥HasPr›îty
(
p
, 
EP_MemTokí
) );

76907 
	`as£π
–!
	`Ex¥HasPr›îty
(
p
, 
EP_NoRedu˚
) );

76908 if–
p
->
pLe·
 ||Ö->
x
.
pLi°
 ){

76909 
nSize
 = 
EXPR_REDUCEDSIZE
 | 
EP_Redu˚d
;

76911 
	`as£π
–
p
->
pRight
==0 );

76912 
nSize
 = 
EXPR_TOKENONLYSIZE
 | 
EP_TokíO∆y
;

76915  
nSize
;

76923 
	`du≥dEx¥NodeSize
(
Ex¥
 *
p
, 
Êags
){

76924 
nByã
 = 
	`du≥dEx¥Såu˘Size
(
p
, 
Êags
) & 0xfff;

76925 if–!
	`Ex¥HasPr›îty
(
p
, 
EP_I¡VÆue
Ë&&Ö->
u
.
zTokí
 ){

76926 
nByã
 +
	`sqlôe3SåÀn30
(
p
->
u
.
zTokí
)+1;

76928  
	`ROUND8
(
nByã
);

76944 
	`du≥dEx¥Size
(
Ex¥
 *
p
, 
Êags
){

76945 
nByã
 = 0;

76946 if–
p
 ){

76947 
nByã
 = 
	`du≥dEx¥NodeSize
(
p
, 
Êags
);

76948 if–
Êags
&
EXPRDUP_REDUCE
 ){

76949 
nByã
 +
	`du≥dEx¥Size
(
p
->
pLe·
, 
Êags
Ë+ du≥dEx¥Size’->
pRight
, flags);

76952  
nByã
;

76963 
Ex¥
 *
	`ex¥Dup
(
sqlôe3
 *
db
, Ex¥ *
p
, 
Êags
, 
u8
 **
pzBuf„r
){

76964 
Ex¥
 *
pNew
 = 0;

76965 if–
p
 ){

76966 c⁄° 
isRedu˚d
 = (
Êags
&
EXPRDUP_REDUCE
);

76967 
u8
 *
zAŒoc
;

76968 
u32
 
°©icFœg
 = 0;

76970 
	`as£π
–
pzBuf„r
==0 || 
isRedu˚d
 );

76973 if–
pzBuf„r
 ){

76974 
zAŒoc
 = *
pzBuf„r
;

76975 
°©icFœg
 = 
EP_Sètic
;

76977 
zAŒoc
 = 
	`sqlôe3DbMÆlocRaw
(
db
, 
	`du≥dEx¥Size
(
p
, 
Êags
));

76979 
pNew
 = (
Ex¥
 *)
zAŒoc
;

76981 if–
pNew
 ){

76987 c⁄° 
nSåu˘Size
 = 
	`du≥dEx¥Såu˘Size
(
p
, 
Êags
);

76988 c⁄° 
nNewSize
 = 
nSåu˘Size
 & 0xfff;

76989 
nTokí
;

76990 if–!
	`Ex¥HasPr›îty
(
p
, 
EP_I¡VÆue
Ë&&Ö->
u
.
zTokí
 ){

76991 
nTokí
 = 
	`sqlôe3SåÀn30
(
p
->
u
.
zTokí
) + 1;

76993 
nTokí
 = 0;

76995 if–
isRedu˚d
 ){

76996 
	`as£π
–
	`Ex¥HasPr›îty
(
p
, 
EP_Redu˚d
)==0 );

76997 
	`mem˝y
(
zAŒoc
, 
p
, 
nNewSize
);

76999 
nSize
 = 
	`ex¥Såu˘Size
(
p
);

77000 
	`mem˝y
(
zAŒoc
, 
p
, 
nSize
);

77001 
	`mem£t
(&
zAŒoc
[
nSize
], 0, 
EXPR_FULLSIZE
-nSize);

77005 
pNew
->
Êags
 &~(
EP_Redu˚d
|
EP_TokíO∆y
|
EP_Sètic
|
EP_MemTokí
);

77006 
pNew
->
Êags
 |
nSåu˘Size
 & (
EP_Redu˚d
|
EP_TokíO∆y
);

77007 
pNew
->
Êags
 |
°©icFœg
;

77010 if–
nTokí
 ){

77011 *
zTokí
 = 
pNew
->
u
.zTokí = (*)&
zAŒoc
[
nNewSize
];

77012 
	`mem˝y
(
zTokí
, 
p
->
u
.zTokí, 
nTokí
);

77015 if–0==((
p
->
Êags
|
pNew
->ÊagsË& 
EP_TokíO∆y
) ){

77017 if–
	`Ex¥HasPr›îty
(
p
, 
EP_xIsSñe˘
) ){

77018 
pNew
->
x
.
pSñe˘
 = 
	`sqlôe3Sñe˘Dup
(
db
, 
p
->x.pSñe˘, 
isRedu˚d
);

77020 
pNew
->
x
.
pLi°
 = 
	`sqlôe3Ex¥Li°Dup
(
db
, 
p
->x.pLi°, 
isRedu˚d
);

77025 if–
	`Ex¥HasPr›îty
(
pNew
, 
EP_Redu˚d
|
EP_TokíO∆y
) ){

77026 
zAŒoc
 +
	`du≥dEx¥NodeSize
(
p
, 
Êags
);

77027 if–
	`Ex¥HasPr›îty
(
pNew
, 
EP_Redu˚d
) ){

77028 
pNew
->
pLe·
 = 
	`ex¥Dup
(
db
, 
p
->pLe·, 
EXPRDUP_REDUCE
, &
zAŒoc
);

77029 
pNew
->
pRight
 = 
	`ex¥Dup
(
db
, 
p
->pRight, 
EXPRDUP_REDUCE
, &
zAŒoc
);

77031 if–
pzBuf„r
 ){

77032 *
pzBuf„r
 = 
zAŒoc
;

77035 if–!
	`Ex¥HasPr›îty
(
p
, 
EP_TokíO∆y
) ){

77036 
pNew
->
pLe·
 = 
	`sqlôe3Ex¥Dup
(
db
, 
p
->pLeft, 0);

77037 
pNew
->
pRight
 = 
	`sqlôe3Ex¥Dup
(
db
, 
p
->pRight, 0);

77043  
pNew
;

77063 
SQLITE_PRIVATE
 
Ex¥
 *
	`sqlôe3Ex¥Dup
(
sqlôe3
 *
db
, Ex¥ *
p
, 
Êags
){

77064  
	`ex¥Dup
(
db
, 
p
, 
Êags
, 0);

77066 
SQLITE_PRIVATE
 
Ex¥Li°
 *
	`sqlôe3Ex¥Li°Dup
(
sqlôe3
 *
db
, Ex¥Li° *
p
, 
Êags
){

77067 
Ex¥Li°
 *
pNew
;

77068 
Ex¥Li°_ôem
 *
pIãm
, *
pOldIãm
;

77069 
i
;

77070 if–
p
==0 )  0;

77071 
pNew
 = 
	`sqlôe3DbMÆlocRaw
(
db
, (*pNew) );

77072 if–
pNew
==0 )  0;

77073 
pNew
->
iECurs‹
 = 0;

77074 
pNew
->
nEx¥
 = 
i
 = 
p
->nExpr;

77075 if–(
Êags
 & 
EXPRDUP_REDUCE
)==0 ) 
i
=1; i<
p
->
nEx¥
; i+=i){}

77076 
pNew
->
a
 = 
pIãm
 = 
	`sqlôe3DbMÆlocRaw
(
db
, 
i
*(
p
->a[0]) );

77077 if–
pIãm
==0 ){

77078 
	`sqlôe3DbFªe
(
db
, 
pNew
);

77081 
pOldIãm
 = 
p
->
a
;

77082 
i
=0; i<
p
->
nEx¥
; i++, 
pIãm
++, 
pOldIãm
++){

77083 
Ex¥
 *
pOldEx¥
 = 
pOldIãm
->
pEx¥
;

77084 
pIãm
->
pEx¥
 = 
	`sqlôe3Ex¥Dup
(
db
, 
pOldEx¥
, 
Êags
);

77085 
pIãm
->
zName
 = 
	`sqlôe3DbSåDup
(
db
, 
pOldIãm
->zName);

77086 
pIãm
->
zS∑n
 = 
	`sqlôe3DbSåDup
(
db
, 
pOldIãm
->zSpan);

77087 
pIãm
->
s‹tOrdî
 = 
pOldIãm
->sortOrder;

77088 
pIãm
->
d⁄e
 = 0;

77089 
pIãm
->
bS∑nIsTab
 = 
pOldIãm
->bSpanIsTab;

77090 
pIãm
->
iOrdîByCﬁ
 = 
pOldIãm
->iOrderByCol;

77091 
pIãm
->
iAlüs
 = 
pOldIãm
->iAlias;

77093  
pNew
;

77102 #i‡!
	`deföed
(
SQLITE_OMIT_VIEW
Ë|| !deföed(
SQLITE_OMIT_TRIGGER
) \

77103 || !
	`deföed
(
SQLITE_OMIT_SUBQUERY
)

77104 
SQLITE_PRIVATE
 
SrcLi°
 *
	`sqlôe3SrcLi°Dup
(
sqlôe3
 *
db
, SrcLi° *
p
, 
Êags
){

77105 
SrcLi°
 *
pNew
;

77106 
i
;

77107 
nByã
;

77108 if–
p
==0 )  0;

77109 
nByã
 = (*
p
Ë+ (p->
nSrc
>0 ? ’->
a
[0]) * (p->nSrc-1) : 0);

77110 
pNew
 = 
	`sqlôe3DbMÆlocRaw
(
db
, 
nByã
 );

77111 if–
pNew
==0 )  0;

77112 
pNew
->
nSrc
 =ÖNew->
nAŒoc
 = 
p
->nSrc;

77113 
i
=0; i<
p
->
nSrc
; i++){

77114 
SrcLi°_ôem
 *
pNewIãm
 = &
pNew
->
a
[
i
];

77115 
SrcLi°_ôem
 *
pOldIãm
 = &
p
->
a
[
i
];

77116 
TabÀ
 *
pTab
;

77117 
pNewIãm
->
pSchema
 = 
pOldIãm
->pSchema;

77118 
pNewIãm
->
zD©aba£
 = 
	`sqlôe3DbSåDup
(
db
, 
pOldIãm
->zDatabase);

77119 
pNewIãm
->
zName
 = 
	`sqlôe3DbSåDup
(
db
, 
pOldIãm
->zName);

77120 
pNewIãm
->
zAlüs
 = 
	`sqlôe3DbSåDup
(
db
, 
pOldIãm
->zAlias);

77121 
pNewIãm
->
joöty≥
 = 
pOldIãm
->jointype;

77122 
pNewIãm
->
iCurs‹
 = 
pOldIãm
->iCursor;

77123 
pNewIãm
->
addrFûlSub
 = 
pOldIãm
->addrFillSub;

77124 
pNewIãm
->
ªgRëu∫
 = 
pOldIãm
->regReturn;

77125 
pNewIãm
->
isC‹ªœãd
 = 
pOldIãm
->isCorrelated;

77126 
pNewIãm
->
vüC‹outöe
 = 
pOldIãm
->viaCoroutine;

77127 
pNewIãm
->
zIndex
 = 
	`sqlôe3DbSåDup
(
db
, 
pOldIãm
->zIndex);

77128 
pNewIãm
->
nŸIndexed
 = 
pOldIãm
->notIndexed;

77129 
pNewIãm
->
pIndex
 = 
pOldIãm
->pIndex;

77130 
pTab
 = 
pNewIãm
->pTab = 
pOldIãm
->pTab;

77131 if–
pTab
 ){

77132 
pTab
->
nRef
++;

77134 
pNewIãm
->
pSñe˘
 = 
	`sqlôe3Sñe˘Dup
(
db
, 
pOldIãm
->pSñe˘, 
Êags
);

77135 
pNewIãm
->
pOn
 = 
	`sqlôe3Ex¥Dup
(
db
, 
pOldIãm
->pOn, 
Êags
);

77136 
pNewIãm
->
pUsög
 = 
	`sqlôe3IdLi°Dup
(
db
, 
pOldIãm
->pUsing);

77137 
pNewIãm
->
cﬁU£d
 = 
pOldIãm
->colUsed;

77139  
pNew
;

77141 
SQLITE_PRIVATE
 
IdLi°
 *
	`sqlôe3IdLi°Dup
(
sqlôe3
 *
db
, IdLi° *
p
){

77142 
IdLi°
 *
pNew
;

77143 
i
;

77144 if–
p
==0 )  0;

77145 
pNew
 = 
	`sqlôe3DbMÆlocRaw
(
db
, (*pNew) );

77146 if–
pNew
==0 )  0;

77147 
pNew
->
nId
 = 
p
->nId;

77148 
pNew
->
a
 = 
	`sqlôe3DbMÆlocRaw
(
db
, 
p
->
nId
*(p->a[0]) );

77149 if–
pNew
->
a
==0 ){

77150 
	`sqlôe3DbFªe
(
db
, 
pNew
);

77156 
i
=0; i<
p
->
nId
; i++){

77157 
IdLi°_ôem
 *
pNewIãm
 = &
pNew
->
a
[
i
];

77158 
IdLi°_ôem
 *
pOldIãm
 = &
p
->
a
[
i
];

77159 
pNewIãm
->
zName
 = 
	`sqlôe3DbSåDup
(
db
, 
pOldIãm
->zName);

77160 
pNewIãm
->
idx
 = 
pOldIãm
->idx;

77162  
pNew
;

77164 
SQLITE_PRIVATE
 
Sñe˘
 *
	`sqlôe3Sñe˘Dup
(
sqlôe3
 *
db
, Sñe˘ *
p
, 
Êags
){

77165 
Sñe˘
 *
pNew
, *
pPri‹
;

77166 if–
p
==0 )  0;

77167 
pNew
 = 
	`sqlôe3DbMÆlocRaw
(
db
, (*
p
) );

77168 if–
pNew
==0 )  0;

77169 
pNew
->
pELi°
 = 
	`sqlôe3Ex¥Li°Dup
(
db
, 
p
->pELi°, 
Êags
);

77170 
pNew
->
pSrc
 = 
	`sqlôe3SrcLi°Dup
(
db
, 
p
->pSrc, 
Êags
);

77171 
pNew
->
pWhîe
 = 
	`sqlôe3Ex¥Dup
(
db
, 
p
->pWhîe, 
Êags
);

77172 
pNew
->
pGroupBy
 = 
	`sqlôe3Ex¥Li°Dup
(
db
, 
p
->pGroupBy, 
Êags
);

77173 
pNew
->
pHavög
 = 
	`sqlôe3Ex¥Dup
(
db
, 
p
->pHavög, 
Êags
);

77174 
pNew
->
pOrdîBy
 = 
	`sqlôe3Ex¥Li°Dup
(
db
, 
p
->pOrdîBy, 
Êags
);

77175 
pNew
->
›
 = 
p
->op;

77176 
pNew
->
pPri‹
 =ÖPri‹ = 
	`sqlôe3Sñe˘Dup
(
db
, 
p
->pPri‹, 
Êags
);

77177 if–
pPri‹
 )ÖPri‹->
pNext
 = 
pNew
;

77178 
pNew
->
pNext
 = 0;

77179 
pNew
->
pLimô
 = 
	`sqlôe3Ex¥Dup
(
db
, 
p
->pLimô, 
Êags
);

77180 
pNew
->
pOff£t
 = 
	`sqlôe3Ex¥Dup
(
db
, 
p
->pOff£t, 
Êags
);

77181 
pNew
->
iLimô
 = 0;

77182 
pNew
->
iOff£t
 = 0;

77183 
pNew
->
£lFœgs
 = 
p
->£lFœg†& ~
SF_U£sEphemîÆ
;

77184 
pNew
->
pRightmo°
 = 0;

77185 
pNew
->
addrO≥nEphm
[0] = -1;

77186 
pNew
->
addrO≥nEphm
[1] = -1;

77187 
pNew
->
addrO≥nEphm
[2] = -1;

77188  
pNew
;

77191 
SQLITE_PRIVATE
 
Sñe˘
 *
	`sqlôe3Sñe˘Dup
(
sqlôe3
 *
db
, Sñe˘ *
p
, 
Êags
){

77192 
	`as£π
–
p
==0 );

77206 
SQLITE_PRIVATE
 
Ex¥Li°
 *
	`sqlôe3Ex¥Li°Aµíd
(

77207 
P¨£
 *
pP¨£
,

77208 
Ex¥Li°
 *
pLi°
,

77209 
Ex¥
 *
pEx¥


77211 
sqlôe3
 *
db
 = 
pP¨£
->db;

77212 if–
pLi°
==0 ){

77213 
pLi°
 = 
	`sqlôe3DbMÆlocZîo
(
db
, (
Ex¥Li°
) );

77214 if–
pLi°
==0 ){

77215 
no_mem
;

77217 
pLi°
->
a
 = 
	`sqlôe3DbMÆlocRaw
(
db
, (pList->a[0]));

77218 if–
pLi°
->
a
==0 ) 
no_mem
;

77219 }if–(
pLi°
->
nEx¥
 & (pList->nExpr-1))==0 ){

77220 
Ex¥Li°_ôem
 *
a
;

77221 
	`as£π
–
pLi°
->
nEx¥
>0 );

77222 
a
 = 
	`sqlôe3DbRóŒoc
(
db
, 
pLi°
->a,ÖLi°->
nEx¥
*2*(pList->a[0]));

77223 if–
a
==0 ){

77224 
no_mem
;

77226 
pLi°
->
a
 =á;

77228 
	`as£π
–
pLi°
->
a
!=0 );

77230 
Ex¥Li°_ôem
 *
pIãm
 = &
pLi°
->
a
[pLi°->
nEx¥
++];

77231 
	`mem£t
(
pIãm
, 0, (*pItem));

77232 
pIãm
->
pEx¥
 =ÖExpr;

77234  
pLi°
;

77236 
no_mem
:

77238 
	`sqlôe3Ex¥Dñëe
(
db
, 
pEx¥
);

77239 
	`sqlôe3Ex¥Li°Dñëe
(
db
, 
pLi°
);

77251 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥Li°SëName
(

77252 
P¨£
 *
pP¨£
,

77253 
Ex¥Li°
 *
pLi°
,

77254 
Tokí
 *
pName
,

77255 
dequŸe


77257 
	`as£π
–
pLi°
!=0 || 
pP¨£
->
db
->
mÆlocFaûed
!=0 );

77258 if–
pLi°
 ){

77259 
Ex¥Li°_ôem
 *
pIãm
;

77260 
	`as£π
–
pLi°
->
nEx¥
>0 );

77261 
pIãm
 = &
pLi°
->
a
[pLi°->
nEx¥
-1];

77262 
	`as£π
–
pIãm
->
zName
==0 );

77263 
pIãm
->
zName
 = 
	`sqlôe3DbSåNDup
(
pP¨£
->
db
, 
pName
->
z
,ÖName->
n
);

77264 if–
dequŸe
 && 
pIãm
->
zName
 ) 
	`sqlôe3DequŸe
(pItem->zName);

77276 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥Li°SëS∑n
(

77277 
P¨£
 *
pP¨£
,

77278 
Ex¥Li°
 *
pLi°
,

77279 
Ex¥S∑n
 *
pS∑n


77281 
sqlôe3
 *
db
 = 
pP¨£
->db;

77282 
	`as£π
–
pLi°
!=0 || 
db
->
mÆlocFaûed
!=0 );

77283 if–
pLi°
 ){

77284 
Ex¥Li°_ôem
 *
pIãm
 = &
pLi°
->
a
[pLi°->
nEx¥
-1];

77285 
	`as£π
–
pLi°
->
nEx¥
>0 );

77286 
	`as£π
–
db
->
mÆlocFaûed
 || 
pIãm
->
pEx¥
==
pS∑n
->pExpr );

77287 
	`sqlôe3DbFªe
(
db
, 
pIãm
->
zS∑n
);

77288 
pIãm
->
zS∑n
 = 
	`sqlôe3DbSåNDup
(
db
, (*)
pS∑n
->
zSèπ
,

77289 ()(
pS∑n
->
zEnd
 -ÖS∑n->
zSèπ
));

77297 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥Li°CheckLígth
(

77298 
P¨£
 *
pP¨£
,

77299 
Ex¥Li°
 *
pELi°
,

77300 c⁄° *
zObje˘


77302 
mx
 = 
pP¨£
->
db
->
aLimô
[
SQLITE_LIMIT_COLUMN
];

77303 
	`ã°ˇ£
–
pELi°
 &&ÖELi°->
nEx¥
==
mx
 );

77304 
	`ã°ˇ£
–
pELi°
 &&ÖELi°->
nEx¥
==
mx
+1 );

77305 if–
pELi°
 &&ÖELi°->
nEx¥
>
mx
 ){

77306 
	`sqlôe3Eº‹Msg
(
pP¨£
, "toÿm™y cﬁumn†ö %s", 
zObje˘
);

77313 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥Li°Dñëe
(
sqlôe3
 *
db
, 
Ex¥Li°
 *
pLi°
){

77314 
i
;

77315 
Ex¥Li°_ôem
 *
pIãm
;

77316 if–
pLi°
==0 ) ;

77317 
	`as£π
–
pLi°
->
a
!=0 ||ÖLi°->
nEx¥
==0 );

77318 
pIãm
=
pLi°
->
a
, 
i
=0; i<pLi°->
nEx¥
; i++,ÖItem++){

77319 
	`sqlôe3Ex¥Dñëe
(
db
, 
pIãm
->
pEx¥
);

77320 
	`sqlôe3DbFªe
(
db
, 
pIãm
->
zName
);

77321 
	`sqlôe3DbFªe
(
db
, 
pIãm
->
zS∑n
);

77323 
	`sqlôe3DbFªe
(
db
, 
pLi°
->
a
);

77324 
	`sqlôe3DbFªe
(
db
, 
pLi°
);

77340 
	`ex¥NodeIsC⁄°™t
(
WÆkî
 *
pWÆkî
, 
Ex¥
 *
pEx¥
){

77345 if–
pWÆkî
->
u
.
i
==3 && 
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_FromJoö
) ){

77346 
pWÆkî
->
u
.
i
 = 0;

77347  
WRC_Ab‹t
;

77350  
pEx¥
->
›
 ){

77353 
TK_FUNCTION
:

77354 if–
pWÆkî
->
u
.
i
==2 )  0;

77356 
TK_ID
:

77357 
TK_COLUMN
:

77358 
TK_AGG_FUNCTION
:

77359 
TK_AGG_COLUMN
:

77360 
	`ã°ˇ£
–
pEx¥
->
›
==
TK_ID
 );

77361 
	`ã°ˇ£
–
pEx¥
->
›
==
TK_COLUMN
 );

77362 
	`ã°ˇ£
–
pEx¥
->
›
==
TK_AGG_FUNCTION
 );

77363 
	`ã°ˇ£
–
pEx¥
->
›
==
TK_AGG_COLUMN
 );

77364 
pWÆkî
->
u
.
i
 = 0;

77365  
WRC_Ab‹t
;

77367 
	`ã°ˇ£
–
pEx¥
->
›
==
TK_SELECT
 );

77368 
	`ã°ˇ£
–
pEx¥
->
›
==
TK_EXISTS
 );

77369  
WRC_C⁄töue
;

77372 
	`£À˘NodeIsC⁄°™t
(
WÆkî
 *
pWÆkî
, 
Sñe˘
 *
NŸU£d
){

77373 
	`UNUSED_PARAMETER
(
NŸU£d
);

77374 
pWÆkî
->
u
.
i
 = 0;

77375  
WRC_Ab‹t
;

77377 
	`ex¥IsC⁄°
(
Ex¥
 *
p
, 
öôFœg
){

77378 
WÆkî
 
w
;

77379 
	`mem£t
(&
w
, 0, (w));

77380 
w
.
u
.
i
 = 
öôFœg
;

77381 
w
.
xEx¥CÆlback
 = 
ex¥NodeIsC⁄°™t
;

77382 
w
.
xSñe˘CÆlback
 = 
£À˘NodeIsC⁄°™t
;

77383 
	`sqlôe3WÆkEx¥
(&
w
, 
p
);

77384  
w
.
u
.
i
;

77395 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥IsC⁄°™t
(
Ex¥
 *
p
){

77396  
	`ex¥IsC⁄°
(
p
, 1);

77405 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥IsC⁄°™tNŸJoö
(
Ex¥
 *
p
){

77406  
	`ex¥IsC⁄°
(
p
, 3);

77418 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥IsC⁄°™tOrFun˘i⁄
(
Ex¥
 *
p
){

77419  
	`ex¥IsC⁄°
(
p
, 2);

77428 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥IsI¡egî
(
Ex¥
 *
p
, *
pVÆue
){

77429 
rc
 = 0;

77433 
	`as£π
–
p
->
›
!=
TK_INTEGER
 || (p->
Êags
 & 
EP_I¡VÆue
)!=0

77434 || 
	`sqlôe3GëI¡32
(
p
->
u
.
zTokí
, &
rc
)==0 );

77436 if–
p
->
Êags
 & 
EP_I¡VÆue
 ){

77437 *
pVÆue
 = 
p
->
u
.
iVÆue
;

77440  
p
->
›
 ){

77441 
TK_UPLUS
: {

77442 
rc
 = 
	`sqlôe3Ex¥IsI¡egî
(
p
->
pLe·
, 
pVÆue
);

77445 
TK_UMINUS
: {

77446 
v
;

77447 if–
	`sqlôe3Ex¥IsI¡egî
(
p
->
pLe·
, &
v
) ){

77448 
	`as£π
–
v
!=(-2147483647-1) );

77449 *
pVÆue
 = -
v
;

77450 
rc
 = 1;

77456  
rc
;

77473 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥C™BeNuŒ
(c⁄° 
Ex¥
 *
p
){

77474 
u8
 
›
;

77475  
p
->
›
==
TK_UPLUS
 ||Ö->›==
TK_UMINUS
 ){Ö =Ö->
pLe·
; }

77476 
›
 = 
p
->op;

77477 if–
›
==
TK_REGISTER
 ) o∞
p
->
›2
;

77478  
›
 ){

77479 
TK_INTEGER
:

77480 
TK_STRING
:

77481 
TK_FLOAT
:

77482 
TK_BLOB
:

77496 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥CodeIsNuŒJump
(

77497 
Vdbe
 *
v
,

77498 c⁄° 
Ex¥
 *
pEx¥
,

77499 
iReg
,

77500 
iDe°


77502 if–
	`sqlôe3Ex¥C™BeNuŒ
(
pEx¥
) ){

77503 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_IsNuŒ
, 
iReg
, 
iDe°
);

77517 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥NìdsNoAfföôyCh™ge
(c⁄° 
Ex¥
 *
p
, 
aff
){

77518 
u8
 
›
;

77519 if–
aff
==
SQLITE_AFF_NONE
 )  1;

77520  
p
->
›
==
TK_UPLUS
 ||Ö->›==
TK_UMINUS
 ){Ö =Ö->
pLe·
; }

77521 
›
 = 
p
->op;

77522 if–
›
==
TK_REGISTER
 ) o∞
p
->
›2
;

77523  
›
 ){

77524 
TK_INTEGER
: {

77525  
aff
==
SQLITE_AFF_INTEGER
 ||áff==
SQLITE_AFF_NUMERIC
;

77527 
TK_FLOAT
: {

77528  
aff
==
SQLITE_AFF_REAL
 ||áff==
SQLITE_AFF_NUMERIC
;

77530 
TK_STRING
: {

77531  
aff
==
SQLITE_AFF_TEXT
;

77533 
TK_BLOB
: {

77536 
TK_COLUMN
: {

77537 
	`as£π
–
p
->
iTabÀ
>=0 );

77538  
p
->
iCﬁumn
<0

77539 && (
aff
==
SQLITE_AFF_INTEGER
 ||áff==
SQLITE_AFF_NUMERIC
);

77550 
SQLITE_PRIVATE
 
	`sqlôe3IsRowid
(c⁄° *
z
){

77551 if–
	`sqlôe3SåICmp
(
z
, "_ROWID_")==0 )  1;

77552 if–
	`sqlôe3SåICmp
(
z
, "ROWID")==0 )  1;

77553 if–
	`sqlôe3SåICmp
(
z
, "OID")==0 )  1;

77569 #i‚de‡
SQLITE_OMIT_SUBQUERY


77570 
	`isC™did©eF‹InO±
(
Sñe˘
 *
p
){

77571 
SrcLi°
 *
pSrc
;

77572 
Ex¥Li°
 *
pELi°
;

77573 
TabÀ
 *
pTab
;

77574 if–
p
==0 )  0;

77575 if–
p
->
pPri‹
 )  0;

77576 if–
p
->
£lFœgs
 & (
SF_Di°ö˘
|
SF_Aggªg©e
) ){

77577 
	`ã°ˇ£
–(
p
->
£lFœgs
 & (
SF_Di°ö˘
|
SF_Aggªg©e
))==SF_Distinct );

77578 
	`ã°ˇ£
–(
p
->
£lFœgs
 & (
SF_Di°ö˘
|
SF_Aggªg©e
))==SF_Aggregate );

77581 
	`as£π
–
p
->
pGroupBy
==0 );

77582 if–
p
->
pLimô
 )  0;

77583 
	`as£π
–
p
->
pOff£t
==0 );

77584 if–
p
->
pWhîe
 )  0;

77585 
pSrc
 = 
p
->pSrc;

77586 
	`as£π
–
pSrc
!=0 );

77587 if–
pSrc
->
nSrc
!=1 )  0;

77588 if–
pSrc
->
a
[0].
pSñe˘
 )  0;

77589 
pTab
 = 
pSrc
->
a
[0].pTab;

77590 if–
	`NEVER
(
pTab
==0) )  0;

77591 
	`as£π
–
pTab
->
pSñe˘
==0 );

77592 if–
	`IsVútuÆ
(
pTab
) )  0;

77593 
pELi°
 = 
p
->pEList;

77594 if–
pELi°
->
nEx¥
!=1 )  0;

77595 if–
pELi°
->
a
[0].
pEx¥
->
›
!=
TK_COLUMN
 )  0;

77604 
SQLITE_PRIVATE
 
	`sqlôe3CodeOn˚
(
P¨£
 *
pP¨£
){

77605 
Vdbe
 *
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

77606  
	`sqlôe3VdbeAddOp1
(
v
, 
OP_On˚
, 
pP¨£
->
nOn˚
++);

77673 #i‚de‡
SQLITE_OMIT_SUBQUERY


77674 
SQLITE_PRIVATE
 
	`sqlôe3FödInIndex
(
P¨£
 *
pP¨£
, 
Ex¥
 *
pX
, *
¥NŸFound
){

77675 
Sñe˘
 *
p
;

77676 
eTy≥
 = 0;

77677 
iTab
 = 
pP¨£
->
nTab
++;

77678 
mu°BeUnique
 = (
¥NŸFound
==0);

77679 
Vdbe
 *
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

77681 
	`as£π
–
pX
->
›
==
TK_IN
 );

77687 
p
 = (
	`Ex¥HasPr›îty
(
pX
, 
EP_xIsSñe˘
Ë?ÖX->
x
.
pSñe˘
 : 0);

77688 if–
	`ALWAYS
(
pP¨£
->
nEº
==0Ë&& 
	`isC™did©eF‹InO±
(
p
) ){

77689 
sqlôe3
 *
db
 = 
pP¨£
->db;

77690 
TabÀ
 *
pTab
;

77691 
Ex¥
 *
pEx¥
;

77692 
iCﬁ
;

77693 
iDb
;

77695 
	`as£π
–
p
 );

77696 
	`as£π
–
p
->
pELi°
!=0 );

77697 
	`as£π
–
p
->
pELi°
->
a
[0].
pEx¥
!=0 );

77698 
	`as£π
–
p
->
pSrc
!=0 );

77699 
pTab
 = 
p
->
pSrc
->
a
[0].pTab;

77700 
pEx¥
 = 
p
->
pELi°
->
a
[0].pExpr;

77701 
iCﬁ
 = 
pEx¥
->
iCﬁumn
;

77704 
iDb
 = 
	`sqlôe3SchemaToIndex
(
db
, 
pTab
->
pSchema
);

77705 
	`sqlôe3CodeVîifySchema
(
pP¨£
, 
iDb
);

77706 
	`sqlôe3TabÀLock
(
pP¨£
, 
iDb
, 
pTab
->
äum
, 0,ÖTab->
zName
);

77712 
	`as£π
(
v
);

77713 if–
iCﬁ
<0 ){

77714 
iAddr
;

77716 
iAddr
 = 
	`sqlôe3CodeOn˚
(
pP¨£
);

77718 
	`sqlôe3O≥nTabÀ
(
pP¨£
, 
iTab
, 
iDb
, 
pTab
, 
OP_O≥nRód
);

77719 
eTy≥
 = 
IN_INDEX_ROWID
;

77721 
	`sqlôe3VdbeJumpHîe
(
v
, 
iAddr
);

77723 
Index
 *
pIdx
;

77728 
CﬁlSeq
 *
pReq
 = 
	`sqlôe3Bö¨yCom∑ªCﬁlSeq
(
pP¨£
, 
pX
->
pLe·
, 
pEx¥
);

77734 
afföôy_ok
 = 
	`sqlôe3IndexAfföôyOk
(
pX
, 
pTab
->
aCﬁ
[
iCﬁ
].
afföôy
);

77736 
pIdx
=
pTab
->
pIndex
;ÖIdx && 
eTy≥
==0 && 
afföôy_ok
;ÖIdxıIdx->
pNext
){

77737 if–(
pIdx
->
aiCﬁumn
[0]==
iCﬁ
)

77738 && 
	`sqlôe3FödCﬁlSeq
(
db
, 
	`ENC
(db), 
pIdx
->
azCﬁl
[0], 0)==
pReq


77739 && (!
mu°BeUnique
 || (
pIdx
->
nCﬁumn
==1 &&ÖIdx->
⁄Eº‹
!=
OE_N⁄e
))

77741 
iAddr
;

77742 *
pKey
;

77744 
pKey
 = (*)
	`sqlôe3IndexKeyöfo
(
pP¨£
, 
pIdx
);

77745 
iAddr
 = 
	`sqlôe3CodeOn˚
(
pP¨£
);

77747 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_O≥nRód
, 
iTab
, 
pIdx
->
äum
, 
iDb
,

77748 
pKey
,
P4_KEYINFO_HANDOFF
);

77749 
	`VdbeCommít
((
v
, "%s", 
pIdx
->
zName
));

77750 
	`as£π
–
IN_INDEX_INDEX_DESC
 =
IN_INDEX_INDEX_ASC
+1 );

77751 
eTy≥
 = 
IN_INDEX_INDEX_ASC
 + 
pIdx
->
aS‹tOrdî
[0];

77753 
	`sqlôe3VdbeJumpHîe
(
v
, 
iAddr
);

77754 if–
¥NŸFound
 && !
pTab
->
aCﬁ
[
iCﬁ
].
nŸNuŒ
 ){

77755 *
¥NŸFound
 = ++
pP¨£
->
nMem
;

77756 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NuŒ
, 0, *
¥NŸFound
);

77763 if–
eTy≥
==0 ){

77767 
u32
 
ßvedNQuîyLo›
 = 
pP¨£
->
nQuîyLo›
;

77768 
rMayHaveNuŒ
 = 0;

77769 
eTy≥
 = 
IN_INDEX_EPH
;

77770 if–
¥NŸFound
 ){

77771 *
¥NŸFound
 = 
rMayHaveNuŒ
 = ++
pP¨£
->
nMem
;

77772 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NuŒ
, 0, *
¥NŸFound
);

77774 
	`ã°ˇ£
–
pP¨£
->
nQuîyLo›
>0 );

77775 
pP¨£
->
nQuîyLo›
 = 0;

77776 if–
pX
->
pLe·
->
iCﬁumn
<0 && !
	`Ex¥HasPr›îty
’X, 
EP_xIsSñe˘
) ){

77777 
eTy≥
 = 
IN_INDEX_ROWID
;

77780 
	`sqlôe3CodeSub£À˘
(
pP¨£
, 
pX
, 
rMayHaveNuŒ
, 
eTy≥
==
IN_INDEX_ROWID
);

77781 
pP¨£
->
nQuîyLo›
 = 
ßvedNQuîyLo›
;

77783 
pX
->
iTabÀ
 = 
iTab
;

77785  
eTy≥
;

77822 #i‚de‡
SQLITE_OMIT_SUBQUERY


77823 
SQLITE_PRIVATE
 
	`sqlôe3CodeSub£À˘
(

77824 
P¨£
 *
pP¨£
,

77825 
Ex¥
 *
pEx¥
,

77826 
rMayHaveNuŒ
,

77827 
isRowid


77829 
ã°Addr
 = -1;

77830 
rReg
 = 0;

77831 
Vdbe
 *
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

77832 if–
	`NEVER
(
v
==0) )  0;

77833 
	`sqlôe3Ex¥CachePush
(
pP¨£
);

77845 if–!
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_V¨Sñe˘
) ){

77846 
ã°Addr
 = 
	`sqlôe3CodeOn˚
(
pP¨£
);

77849 #i‚de‡
SQLITE_OMIT_EXPLAIN


77850 if–
pP¨£
->
ex∂aö
==2 ){

77851 *
zMsg
 = 
	`sqlôe3MPrötf
(

77852 
pP¨£
->
db
, "EXECUTE %s%†SUBQUERY %d", 
ã°Addr
>=0?"":"CORRELATED ",

77853 
pEx¥
->
›
==
TK_IN
?"LIST":"SCALAR", 
pP¨£
->
iNextSñe˘Id


77855 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Ex∂aö
, 
pP¨£
->
iSñe˘Id
, 0, 0, 
zMsg
, 
P4_DYNAMIC
);

77859  
pEx¥
->
›
 ){

77860 
TK_IN
: {

77861 
afföôy
;

77862 
addr
;

77863 
Ex¥
 *
pLe·
 = 
pEx¥
->pLeft;

77864 
KeyInfo
 *
pKeyInfo
 = 0;

77866 if–
rMayHaveNuŒ
 ){

77867 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NuŒ
, 0, 
rMayHaveNuŒ
);

77870 
afföôy
 = 
	`sqlôe3Ex¥Afföôy
(
pLe·
);

77885 
pEx¥
->
iTabÀ
 = 
pP¨£
->
nTab
++;

77886 
addr
 = 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_O≥nEphemîÆ
, 
pEx¥
->
iTabÀ
, !
isRowid
);

77887 if–
rMayHaveNuŒ
==0 ) 
	`sqlôe3VdbeCh™geP5
(
v
, 
BTREE_UNORDERED
);

77888 
pKeyInfo
 = 
isRowid
 ? 0 : 
	`sqlôe3KeyInfoAŒoc
(
pP¨£
->
db
, 1);

77890 if–
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_xIsSñe˘
) ){

77896 
Sñe˘De°
 
de°
;

77897 
Ex¥Li°
 *
pELi°
;

77899 
	`as£π
–!
isRowid
 );

77900 
	`sqlôe3Sñe˘De°Inô
(&
de°
, 
SRT_Së
, 
pEx¥
->
iTabÀ
);

77901 
de°
.
affSd°
 = (
u8
)
afföôy
;

77902 
	`as£π
–(
pEx¥
->
iTabÀ
&0x0000FFFF)==pExpr->iTable );

77903 
pEx¥
->
x
.
pSñe˘
->
iLimô
 = 0;

77904 
	`ã°ˇ£
–
pKeyInfo
==0 );

77905 if–
	`sqlôe3Sñe˘
(
pP¨£
, 
pEx¥
->
x
.
pSñe˘
, &
de°
) ){

77906 
	`sqlôe3DbFªe
(
pP¨£
->
db
, 
pKeyInfo
);

77909 
pELi°
 = 
pEx¥
->
x
.
pSñe˘
->pEList;

77910 
	`as£π
–
pKeyInfo
!=0 );

77911 
	`as£π
–
pELi°
!=0 );

77912 
	`as£π
–
pELi°
->
nEx¥
>0 );

77913 
pKeyInfo
->
aCﬁl
[0] = 
	`sqlôe3Bö¨yCom∑ªCﬁlSeq
(
pP¨£
, 
pEx¥
->
pLe·
,

77914 
pELi°
->
a
[0].
pEx¥
);

77915 }if–
	`ALWAYS
(
pEx¥
->
x
.
pLi°
!=0) ){

77923 
i
;

77924 
Ex¥Li°
 *
pLi°
 = 
pEx¥
->
x
.pList;

77925 
Ex¥Li°_ôem
 *
pIãm
;

77926 
r1
, 
r2
, 
r3
;

77928 if–!
afföôy
 ){

77929 
afföôy
 = 
SQLITE_AFF_NONE
;

77931 if–
pKeyInfo
 ){

77932 
pKeyInfo
->
aCﬁl
[0] = 
	`sqlôe3Ex¥CﬁlSeq
(
pP¨£
, 
pEx¥
->
pLe·
);

77936 
r1
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

77937 
r2
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

77938 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NuŒ
, 0, 
r2
);

77939 
i
=
pLi°
->
nEx¥
, 
pIãm
ıLi°->
a
; i>0; i--,ÖItem++){

77940 
Ex¥
 *
pE2
 = 
pIãm
->
pEx¥
;

77941 
iVÆToIns
;

77948 if–
ã°Addr
>=0 && !
	`sqlôe3Ex¥IsC⁄°™t
(
pE2
) ){

77949 
	`sqlôe3VdbeCh™geToNo›
(
v
, 
ã°Addr
);

77950 
ã°Addr
 = -1;

77954 if–
isRowid
 && 
	`sqlôe3Ex¥IsI¡egî
(
pE2
, &
iVÆToIns
) ){

77955 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_In£πI¡
, 
pEx¥
->
iTabÀ
, 
r2
, 
iVÆToIns
);

77957 
r3
 = 
	`sqlôe3Ex¥CodeT¨gë
(
pP¨£
, 
pE2
, 
r1
);

77958 if–
isRowid
 ){

77959 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Mu°BeI¡
, 
r3
,

77960 
	`sqlôe3VdbeCuºítAddr
(
v
)+2);

77961 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_In£π
, 
pEx¥
->
iTabÀ
, 
r2
, 
r3
);

77963 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_MakeRec‹d
, 
r3
, 1, 
r2
, &
afföôy
, 1);

77964 
	`sqlôe3Ex¥CacheAfföôyCh™ge
(
pP¨£
, 
r3
, 1);

77965 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_IdxIn£π
, 
pEx¥
->
iTabÀ
, 
r2
);

77969 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
r1
);

77970 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
r2
);

77972 if–
pKeyInfo
 ){

77973 
	`sqlôe3VdbeCh™geP4
(
v
, 
addr
, (*)
pKeyInfo
, 
P4_KEYINFO_HANDOFF
);

77978 
TK_EXISTS
:

77979 
TK_SELECT
:

77987 
Sñe˘
 *
pSñ
;

77988 
Sñe˘De°
 
de°
;

77990 
	`ã°ˇ£
–
pEx¥
->
›
==
TK_EXISTS
 );

77991 
	`ã°ˇ£
–
pEx¥
->
›
==
TK_SELECT
 );

77992 
	`as£π
–
pEx¥
->
›
==
TK_EXISTS
 ||ÖEx¥->›==
TK_SELECT
 );

77994 
	`as£π
–
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_xIsSñe˘
) );

77995 
pSñ
 = 
pEx¥
->
x
.
pSñe˘
;

77996 
	`sqlôe3Sñe˘De°Inô
(&
de°
, 0, ++
pP¨£
->
nMem
);

77997 if–
pEx¥
->
›
==
TK_SELECT
 ){

77998 
de°
.
eDe°
 = 
SRT_Mem
;

77999 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NuŒ
, 0, 
de°
.
iSDP¨m
);

78000 
	`VdbeCommít
((
v
, "Init subqueryÑesult"));

78002 
de°
.
eDe°
 = 
SRT_Exi°s
;

78003 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 0, 
de°
.
iSDP¨m
);

78004 
	`VdbeCommít
((
v
, "Init EXISTSÑesult"));

78006 
	`sqlôe3Ex¥Dñëe
(
pP¨£
->
db
, 
pSñ
->
pLimô
);

78007 
pSñ
->
pLimô
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_INTEGER
, 0, 0,

78008 &
sqlôe3I¡Tokís
[1]);

78009 
pSñ
->
iLimô
 = 0;

78010 if–
	`sqlôe3Sñe˘
(
pP¨£
, 
pSñ
, &
de°
) ){

78013 
rReg
 = 
de°
.
iSDP¨m
;

78014 
	`Ex¥SëVVAPr›îty
(
pEx¥
, 
EP_NoRedu˚
);

78019 if–
ã°Addr
>=0 ){

78020 
	`sqlôe3VdbeJumpHîe
(
v
, 
ã°Addr
);

78022 
	`sqlôe3Ex¥CacheP›
(
pP¨£
, 1);

78024  
rReg
;

78028 #i‚de‡
SQLITE_OMIT_SUBQUERY


78046 
	`sqlôe3Ex¥CodeIN
(

78047 
P¨£
 *
pP¨£
,

78048 
Ex¥
 *
pEx¥
,

78049 
de°IfFÆ£
,

78050 
de°IfNuŒ


78052 
rRhsHasNuŒ
 = 0;

78053 
afföôy
;

78054 
eTy≥
;

78055 
r1
;

78056 
Vdbe
 *
v
;

78061 
v
 = 
pP¨£
->
pVdbe
;

78062 
	`as£π
–
v
!=0 );

78063 
	`VdbeNo›Commít
((
v
, "begin INÉxpr"));

78064 
eTy≥
 = 
	`sqlôe3FödInIndex
(
pP¨£
, 
pEx¥
, &
rRhsHasNuŒ
);

78070 
afföôy
 = 
	`com∑ris⁄Afföôy
(
pEx¥
);

78074 
	`sqlôe3Ex¥CachePush
(
pP¨£
);

78075 
r1
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

78076 
	`sqlôe3Ex¥Code
(
pP¨£
, 
pEx¥
->
pLe·
, 
r1
);

78081 if–
de°IfNuŒ
==
de°IfFÆ£
 ){

78084 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_IsNuŒ
, 
r1
, 
de°IfNuŒ
);

78086 
addr1
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_NŸNuŒ
, 
r1
);

78087 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Rewöd
, 
pEx¥
->
iTabÀ
, 
de°IfFÆ£
);

78088 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_GŸo
, 0, 
de°IfNuŒ
);

78089 
	`sqlôe3VdbeJumpHîe
(
v
, 
addr1
);

78092 if–
eTy≥
==
IN_INDEX_ROWID
 ){

78095 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Mu°BeI¡
, 
r1
, 
de°IfFÆ£
);

78096 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_NŸExi°s
, 
pEx¥
->
iTabÀ
, 
de°IfFÆ£
, 
r1
);

78100 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Afföôy
, 
r1
, 1, 0, &
afföôy
, 1);

78108 if–
rRhsHasNuŒ
==0 || 
de°IfFÆ£
==
de°IfNuŒ
 ){

78116 
	`sqlôe3VdbeAddOp4I¡
(
v
, 
OP_NŸFound
, 
pEx¥
->
iTabÀ
, 
de°IfFÆ£
, 
r1
, 1);

78123 
j1
, 
j2
, 
j3
;

78129 
j1
 = 
	`sqlôe3VdbeAddOp4I¡
(
v
, 
OP_Found
, 
pEx¥
->
iTabÀ
, 0, 
r1
, 1);

78137 
j2
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_NŸNuŒ
, 
rRhsHasNuŒ
);

78138 
j3
 = 
	`sqlôe3VdbeAddOp4I¡
(
v
, 
OP_Found
, 
pEx¥
->
iTabÀ
, 0, 
rRhsHasNuŒ
, 1);

78139 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, -1, 
rRhsHasNuŒ
);

78140 
	`sqlôe3VdbeJumpHîe
(
v
, 
j3
);

78141 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_AddImm
, 
rRhsHasNuŒ
, 1);

78142 
	`sqlôe3VdbeJumpHîe
(
v
, 
j2
);

78147 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_If
, 
rRhsHasNuŒ
, 
de°IfNuŒ
);

78148 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_GŸo
, 0, 
de°IfFÆ£
);

78153 
	`sqlôe3VdbeJumpHîe
(
v
, 
j1
);

78156 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
r1
);

78157 
	`sqlôe3Ex¥CacheP›
(
pP¨£
, 1);

78158 
	`VdbeCommít
((
v
, "end INÉxpr"));

78165 *
	`dup8byãs
(
Vdbe
 *
v
, c⁄° *
ö
){

78166 *
out
 = 
	`sqlôe3DbMÆlocRaw
(
	`sqlôe3VdbeDb
(
v
), 8);

78167 if–
out
 ){

78168 
	`mem˝y
(
out
, 
ö
, 8);

78170  
out
;

78173 #i‚de‡
SQLITE_OMIT_FLOATING_POINT


78182 
	`codeRól
(
Vdbe
 *
v
, c⁄° *
z
, 
√g©eFœg
, 
iMem
){

78183 if–
	`ALWAYS
(
z
!=0) ){

78184 
vÆue
;

78185 *
zV
;

78186 
	`sqlôe3AtoF
(
z
, &
vÆue
, 
	`sqlôe3SåÀn30
(z), 
SQLITE_UTF8
);

78187 
	`as£π
–!
	`sqlôe3IsNaN
(
vÆue
) );

78188 if–
√g©eFœg
 ) 
vÆue
 = -value;

78189 
zV
 = 
	`dup8byãs
(
v
, (*)&
vÆue
);

78190 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Ról
, 0, 
iMem
, 0, 
zV
, 
P4_REAL
);

78202 
	`codeI¡egî
(
P¨£
 *
pP¨£
, 
Ex¥
 *
pEx¥
, 
√gFœg
, 
iMem
){

78203 
Vdbe
 *
v
 = 
pP¨£
->
pVdbe
;

78204 if–
pEx¥
->
Êags
 & 
EP_I¡VÆue
 ){

78205 
i
 = 
pEx¥
->
u
.
iVÆue
;

78206 
	`as£π
–
i
>=0 );

78207 if–
√gFœg
 ) 
i
 = -i;

78208 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 
i
, 
iMem
);

78210 
c
;

78211 
i64
 
vÆue
;

78212 c⁄° *
z
 = 
pEx¥
->
u
.
zTokí
;

78213 
	`as£π
–
z
!=0 );

78214 
c
 = 
	`sqlôe3Atoi64
(
z
, &
vÆue
, 
	`sqlôe3SåÀn30
(z), 
SQLITE_UTF8
);

78215 if–
c
==0 || (c==2 && 
√gFœg
) ){

78216 *
zV
;

78217 if–
√gFœg
 ){ 
vÆue
 = 
c
==2 ? 
SMALLEST_INT64
 : -value; }

78218 
zV
 = 
	`dup8byãs
(
v
, (*)&
vÆue
);

78219 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_I¡64
, 0, 
iMem
, 0, 
zV
, 
P4_INT64
);

78221 #ifde‡
SQLITE_OMIT_FLOATING_POINT


78222 
	`sqlôe3Eº‹Msg
(
pP¨£
, "ovîsized i¡egî: %s%s", 
√gFœg
 ? "-" : "", 
z
);

78224 
	`codeRól
(
v
, 
z
, 
√gFœg
, 
iMem
);

78233 
	`ˇcheE¡ryCÀ¨
(
P¨£
 *
pP¨£
, 
yCﬁCache
 *
p
){

78234 if–
p
->
ãmpReg
 ){

78235 if–
pP¨£
->
nTempReg
<
	`AºaySize
’P¨£->
aTempReg
) ){

78236 
pP¨£
->
aTempReg
[pP¨£->
nTempReg
++] = 
p
->
iReg
;

78238 
p
->
ãmpReg
 = 0;

78247 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥CacheSt‹e
(
P¨£
 *
pP¨£
, 
iTab
, 
iCﬁ
, 
iReg
){

78248 
i
;

78249 
möLru
;

78250 
idxLru
;

78251 
yCﬁCache
 *
p
;

78253 
	`as£π
–
iReg
>0 );

78254 
	`as£π
–
iCﬁ
>=-1 && iCol<32768 );

78260 if–
	`O±imiz©i⁄DißbÀd
(
pP¨£
->
db
, 
SQLITE_CﬁumnCache
) ) ;

78267 #i‚de‡
NDEBUG


78268 
i
=0, 
p
=
pP¨£
->
aCﬁCache
; i<
SQLITE_N_COLCACHE
; i++,Ö++){

78269 
	`as£π
–
p
->
iReg
==0 ||Ö->
iTabÀ
!=
iTab
 ||Ö->
iCﬁumn
!=
iCﬁ
 );

78274 
i
=0, 
p
=
pP¨£
->
aCﬁCache
; i<
SQLITE_N_COLCACHE
; i++,Ö++){

78275 if–
p
->
iReg
==0 ){

78276 
p
->
iLevñ
 = 
pP¨£
->
iCacheLevñ
;

78277 
p
->
iTabÀ
 = 
iTab
;

78278 
p
->
iCﬁumn
 = 
iCﬁ
;

78279 
p
->
iReg
 = iReg;

78280 
p
->
ãmpReg
 = 0;

78281 
p
->
Ãu
 = 
pP¨£
->
iCacheC¡
++;

78287 
möLru
 = 0x7fffffff;

78288 
idxLru
 = -1;

78289 
i
=0, 
p
=
pP¨£
->
aCﬁCache
; i<
SQLITE_N_COLCACHE
; i++,Ö++){

78290 if–
p
->
Ãu
<
möLru
 ){

78291 
idxLru
 = 
i
;

78292 
möLru
 = 
p
->
Ãu
;

78295 if–
	`ALWAYS
(
idxLru
>=0) ){

78296 
p
 = &
pP¨£
->
aCﬁCache
[
idxLru
];

78297 
p
->
iLevñ
 = 
pP¨£
->
iCacheLevñ
;

78298 
p
->
iTabÀ
 = 
iTab
;

78299 
p
->
iCﬁumn
 = 
iCﬁ
;

78300 
p
->
iReg
 = iReg;

78301 
p
->
ãmpReg
 = 0;

78302 
p
->
Ãu
 = 
pP¨£
->
iCacheC¡
++;

78311 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥CacheRemove
(
P¨£
 *
pP¨£
, 
iReg
, 
nReg
){

78312 
i
;

78313 
iLa°
 = 
iReg
 + 
nReg
 - 1;

78314 
yCﬁCache
 *
p
;

78315 
i
=0, 
p
=
pP¨£
->
aCﬁCache
; i<
SQLITE_N_COLCACHE
; i++,Ö++){

78316 
r
 = 
p
->
iReg
;

78317 if–
r
>=
iReg
 &&Ñ<=
iLa°
 ){

78318 
	`ˇcheE¡ryCÀ¨
(
pP¨£
, 
p
);

78319 
p
->
iReg
 = 0;

78329 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥CachePush
(
P¨£
 *
pP¨£
){

78330 
pP¨£
->
iCacheLevñ
++;

78338 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥CacheP›
(
P¨£
 *
pP¨£
, 
N
){

78339 
i
;

78340 
yCﬁCache
 *
p
;

78341 
	`as£π
–
N
>0 );

78342 
	`as£π
–
pP¨£
->
iCacheLevñ
>=
N
 );

78343 
pP¨£
->
iCacheLevñ
 -
N
;

78344 
i
=0, 
p
=
pP¨£
->
aCﬁCache
; i<
SQLITE_N_COLCACHE
; i++,Ö++){

78345 if–
p
->
iReg
 &&Ö->
iLevñ
>
pP¨£
->
iCacheLevñ
 ){

78346 
	`ˇcheE¡ryCÀ¨
(
pP¨£
, 
p
);

78347 
p
->
iReg
 = 0;

78358 
	`sqlôe3Ex¥CachePöRegi°î
(
P¨£
 *
pP¨£
, 
iReg
){

78359 
i
;

78360 
yCﬁCache
 *
p
;

78361 
i
=0, 
p
=
pP¨£
->
aCﬁCache
; i<
SQLITE_N_COLCACHE
; i++,Ö++){

78362 if–
p
->
iReg
==iReg ){

78363 
p
->
ãmpReg
 = 0;

78371 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥CodeGëCﬁumnOfTabÀ
(

78372 
Vdbe
 *
v
,

78373 
TabÀ
 *
pTab
,

78374 
iTabCur
,

78375 
iCﬁ
,

78376 
ªgOut


78378 if–
iCﬁ
<0 || iCﬁ==
pTab
->
iPKey
 ){

78379 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Rowid
, 
iTabCur
, 
ªgOut
);

78381 
›
 = 
	`IsVútuÆ
(
pTab
Ë? 
OP_VCﬁumn
 : 
OP_Cﬁumn
;

78382 
	`sqlôe3VdbeAddOp3
(
v
, 
›
, 
iTabCur
, 
iCﬁ
, 
ªgOut
);

78384 if–
iCﬁ
>=0 ){

78385 
	`sqlôe3CﬁumnDeÁu…
(
v
, 
pTab
, 
iCﬁ
, 
ªgOut
);

78398 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥CodeGëCﬁumn
(

78399 
P¨£
 *
pP¨£
,

78400 
TabÀ
 *
pTab
,

78401 
iCﬁumn
,

78402 
iTabÀ
,

78403 
iReg
,

78404 
u8
 
p5


78406 
Vdbe
 *
v
 = 
pP¨£
->
pVdbe
;

78407 
i
;

78408 
yCﬁCache
 *
p
;

78410 
i
=0, 
p
=
pP¨£
->
aCﬁCache
; i<
SQLITE_N_COLCACHE
; i++,Ö++){

78411 if–
p
->
iReg
>0 &&Ö->
iTabÀ
==iTabÀ &&Ö->
iCﬁumn
==iColumn ){

78412 
p
->
Ãu
 = 
pP¨£
->
iCacheC¡
++;

78413 
	`sqlôe3Ex¥CachePöRegi°î
(
pP¨£
, 
p
->
iReg
);

78414  
p
->
iReg
;

78417 
	`as£π
–
v
!=0 );

78418 
	`sqlôe3Ex¥CodeGëCﬁumnOfTabÀ
(
v
, 
pTab
, 
iTabÀ
, 
iCﬁumn
, 
iReg
);

78419 if–
p5
 ){

78420 
	`sqlôe3VdbeCh™geP5
(
v
, 
p5
);

78422 
	`sqlôe3Ex¥CacheSt‹e
(
pP¨£
, 
iTabÀ
, 
iCﬁumn
, 
iReg
);

78424  
iReg
;

78430 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥CacheCÀ¨
(
P¨£
 *
pP¨£
){

78431 
i
;

78432 
yCﬁCache
 *
p
;

78434 
i
=0, 
p
=
pP¨£
->
aCﬁCache
; i<
SQLITE_N_COLCACHE
; i++,Ö++){

78435 if–
p
->
iReg
 ){

78436 
	`ˇcheE¡ryCÀ¨
(
pP¨£
, 
p
);

78437 
p
->
iReg
 = 0;

78446 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥CacheAfföôyCh™ge
(
P¨£
 *
pP¨£
, 
iSèπ
, 
iCou¡
){

78447 
	`sqlôe3Ex¥CacheRemove
(
pP¨£
, 
iSèπ
, 
iCou¡
);

78454 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥CodeMove
(
P¨£
 *
pP¨£
, 
iFrom
, 
iTo
, 
nReg
){

78455 
i
;

78456 
yCﬁCache
 *
p
;

78457 
	`as£π
–
iFrom
>=
iTo
+
nReg
 || iFrom+nReg<=iTo );

78458 
	`sqlôe3VdbeAddOp3
(
pP¨£
->
pVdbe
, 
OP_Move
, 
iFrom
, 
iTo
, 
nReg
-1);

78459 
i
=0, 
p
=
pP¨£
->
aCﬁCache
; i<
SQLITE_N_COLCACHE
; i++,Ö++){

78460 
x
 = 
p
->
iReg
;

78461 if–
x
>=
iFrom
 && x<iFrom+
nReg
 ){

78462 
p
->
iReg
 +
iTo
-
iFrom
;

78467 #i‡
	`deföed
(
SQLITE_DEBUG
Ë|| deföed(
SQLITE_COVERAGE_TEST
)

78475 
	`u£dAsCﬁumnCache
(
P¨£
 *
pP¨£
, 
iFrom
, 
iTo
){

78476 
i
;

78477 
yCﬁCache
 *
p
;

78478 
i
=0, 
p
=
pP¨£
->
aCﬁCache
; i<
SQLITE_N_COLCACHE
; i++,Ö++){

78479 
r
 = 
p
->
iReg
;

78480 if–
r
>=
iFrom
 &&Ñ<=
iTo
 )  1;

78489 
	`ex¥ToRegi°î
(
Ex¥
 *
p
, 
iReg
){

78490 
p
->
›2
 =Ö->
›
;

78491 
p
->
›
 = 
TK_REGISTER
;

78492 
p
->
iTabÀ
 = 
iReg
;

78493 
	`Ex¥CÀ¨Pr›îty
(
p
, 
EP_Skù
);

78507 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥CodeT¨gë
(
P¨£
 *
pP¨£
, 
Ex¥
 *
pEx¥
, 
èrgë
){

78508 
Vdbe
 *
v
 = 
pP¨£
->
pVdbe
;

78509 
›
;

78510 
öReg
 = 
èrgë
;

78511 
ªgFªe1
 = 0;

78512 
ªgFªe2
 = 0;

78513 
r1
, 
r2
, 
r3
, 
r4
;

78514 
sqlôe3
 *
db
 = 
pP¨£
->db;

78516 
	`as£π
–
èrgë
>0 &&Å¨gë<=
pP¨£
->
nMem
 );

78517 if–
v
==0 ){

78518 
	`as£π
–
pP¨£
->
db
->
mÆlocFaûed
 );

78522 if–
pEx¥
==0 ){

78523 
›
 = 
TK_NULL
;

78525 
›
 = 
pEx¥
->op;

78527  
›
 ){

78528 
TK_AGG_COLUMN
: {

78529 
AggInfo
 *
pAggInfo
 = 
pEx¥
->pAggInfo;

78530 
AggInfo_cﬁ
 *
pCﬁ
 = &
pAggInfo
->
aCﬁ
[
pEx¥
->
iAgg
];

78531 if–!
pAggInfo
->
dúe˘Mode
 ){

78532 
	`as£π
–
pCﬁ
->
iMem
>0 );

78533 
öReg
 = 
pCﬁ
->
iMem
;

78535 }if–
pAggInfo
->
u£S‹tögIdx
 ){

78536 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Cﬁumn
, 
pAggInfo
->
s‹tögIdxPTab
,

78537 
pCﬁ
->
iS‹ãrCﬁumn
, 
èrgë
);

78542 
TK_COLUMN
: {

78543 
iTab
 = 
pEx¥
->
iTabÀ
;

78544 if–
iTab
<0 ){

78545 if–
pP¨£
->
ckBa£
>0 ){

78547 
öReg
 = 
pEx¥
->
iCﬁumn
 + 
pP¨£
->
ckBa£
;

78551 
iTab
 = 
pP¨£
->
iP¨tIdxTab
;

78554 
öReg
 = 
	`sqlôe3Ex¥CodeGëCﬁumn
(
pP¨£
, 
pEx¥
->
pTab
,

78555 
pEx¥
->
iCﬁumn
, 
iTab
, 
èrgë
,

78556 
pEx¥
->
›2
);

78559 
TK_INTEGER
: {

78560 
	`codeI¡egî
(
pP¨£
, 
pEx¥
, 0, 
èrgë
);

78563 #i‚de‡
SQLITE_OMIT_FLOATING_POINT


78564 
TK_FLOAT
: {

78565 
	`as£π
–!
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_I¡VÆue
) );

78566 
	`codeRól
(
v
, 
pEx¥
->
u
.
zTokí
, 0, 
èrgë
);

78570 
TK_STRING
: {

78571 
	`as£π
–!
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_I¡VÆue
) );

78572 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Såög8
, 0, 
èrgë
, 0, 
pEx¥
->
u
.
zTokí
, 0);

78575 
TK_NULL
: {

78576 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NuŒ
, 0, 
èrgë
);

78579 #i‚de‡
SQLITE_OMIT_BLOB_LITERAL


78580 
TK_BLOB
: {

78581 
n
;

78582 c⁄° *
z
;

78583 *
zBlob
;

78584 
	`as£π
–!
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_I¡VÆue
) );

78585 
	`as£π
–
pEx¥
->
u
.
zTokí
[0]=='x' ||ÖExpr->u.zToken[0]=='X' );

78586 
	`as£π
–
pEx¥
->
u
.
zTokí
[1]=='\'' );

78587 
z
 = &
pEx¥
->
u
.
zTokí
[2];

78588 
n
 = 
	`sqlôe3SåÀn30
(
z
) - 1;

78589 
	`as£π
–
z
[
n
]=='\'' );

78590 
zBlob
 = 
	`sqlôe3HexToBlob
(
	`sqlôe3VdbeDb
(
v
), 
z
, 
n
);

78591 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Blob
, 
n
/2, 
èrgë
, 0, 
zBlob
, 
P4_DYNAMIC
);

78595 
TK_VARIABLE
: {

78596 
	`as£π
–!
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_I¡VÆue
) );

78597 
	`as£π
–
pEx¥
->
u
.
zTokí
!=0 );

78598 
	`as£π
–
pEx¥
->
u
.
zTokí
[0]!=0 );

78599 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_V¨übÀ
, 
pEx¥
->
iCﬁumn
, 
èrgë
);

78600 if–
pEx¥
->
u
.
zTokí
[1]!=0 ){

78601 
	`as£π
–
pEx¥
->
u
.
zTokí
[0]=='?'

78602 || 
	`°rcmp
(
pEx¥
->
u
.
zTokí
, 
pP¨£
->
azV¨
[pEx¥->
iCﬁumn
-1])==0 );

78603 
	`sqlôe3VdbeCh™geP4
(
v
, -1, 
pP¨£
->
azV¨
[
pEx¥
->
iCﬁumn
-1], 
P4_STATIC
);

78607 
TK_REGISTER
: {

78608 
öReg
 = 
pEx¥
->
iTabÀ
;

78611 
TK_AS
: {

78612 
öReg
 = 
	`sqlôe3Ex¥CodeT¨gë
(
pP¨£
, 
pEx¥
->
pLe·
, 
èrgë
);

78615 #i‚de‡
SQLITE_OMIT_CAST


78616 
TK_CAST
: {

78618 
aff
, 
to_›
;

78619 
öReg
 = 
	`sqlôe3Ex¥CodeT¨gë
(
pP¨£
, 
pEx¥
->
pLe·
, 
èrgë
);

78620 
	`as£π
–!
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_I¡VÆue
) );

78621 
aff
 = 
	`sqlôe3AfföôyTy≥
(
pEx¥
->
u
.
zTokí
, 0);

78622 
to_›
 = 
aff
 - 
SQLITE_AFF_TEXT
 + 
OP_ToText
;

78623 
	`as£π
–
to_›
==
OP_ToText
 || 
aff
!=
SQLITE_AFF_TEXT
 );

78624 
	`as£π
–
to_›
==
OP_ToBlob
 || 
aff
!=
SQLITE_AFF_NONE
 );

78625 
	`as£π
–
to_›
==
OP_ToNumîic
 || 
aff
!=
SQLITE_AFF_NUMERIC
 );

78626 
	`as£π
–
to_›
==
OP_ToI¡
 || 
aff
!=
SQLITE_AFF_INTEGER
 );

78627 
	`as£π
–
to_›
==
OP_ToRól
 || 
aff
!=
SQLITE_AFF_REAL
 );

78628 
	`ã°ˇ£
–
to_›
==
OP_ToText
 );

78629 
	`ã°ˇ£
–
to_›
==
OP_ToBlob
 );

78630 
	`ã°ˇ£
–
to_›
==
OP_ToNumîic
 );

78631 
	`ã°ˇ£
–
to_›
==
OP_ToI¡
 );

78632 
	`ã°ˇ£
–
to_›
==
OP_ToRól
 );

78633 if–
öReg
!=
èrgë
 ){

78634 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_SC›y
, 
öReg
, 
èrgë
);

78635 
öReg
 = 
èrgë
;

78637 
	`sqlôe3VdbeAddOp1
(
v
, 
to_›
, 
öReg
);

78638 
	`ã°ˇ£
–
	`u£dAsCﬁumnCache
(
pP¨£
, 
öReg
, inReg) );

78639 
	`sqlôe3Ex¥CacheAfföôyCh™ge
(
pP¨£
, 
öReg
, 1);

78643 
TK_LT
:

78644 
TK_LE
:

78645 
TK_GT
:

78646 
TK_GE
:

78647 
TK_NE
:

78648 
TK_EQ
: {

78649 
	`as£π
–
TK_LT
==
OP_Lt
 );

78650 
	`as£π
–
TK_LE
==
OP_Le
 );

78651 
	`as£π
–
TK_GT
==
OP_Gt
 );

78652 
	`as£π
–
TK_GE
==
OP_Ge
 );

78653 
	`as£π
–
TK_EQ
==
OP_Eq
 );

78654 
	`as£π
–
TK_NE
==
OP_Ne
 );

78655 
	`ã°ˇ£
–
›
==
TK_LT
 );

78656 
	`ã°ˇ£
–
›
==
TK_LE
 );

78657 
	`ã°ˇ£
–
›
==
TK_GT
 );

78658 
	`ã°ˇ£
–
›
==
TK_GE
 );

78659 
	`ã°ˇ£
–
›
==
TK_EQ
 );

78660 
	`ã°ˇ£
–
›
==
TK_NE
 );

78661 
r1
 = 
	`sqlôe3Ex¥CodeTemp
(
pP¨£
, 
pEx¥
->
pLe·
, &
ªgFªe1
);

78662 
r2
 = 
	`sqlôe3Ex¥CodeTemp
(
pP¨£
, 
pEx¥
->
pRight
, &
ªgFªe2
);

78663 
	`codeCom∑ª
(
pP¨£
, 
pEx¥
->
pLe·
,ÖEx¥->
pRight
, 
›
,

78664 
r1
, 
r2
, 
öReg
, 
SQLITE_STOREP2
);

78665 
	`ã°ˇ£
–
ªgFªe1
==0 );

78666 
	`ã°ˇ£
–
ªgFªe2
==0 );

78669 
TK_IS
:

78670 
TK_ISNOT
: {

78671 
	`ã°ˇ£
–
›
==
TK_IS
 );

78672 
	`ã°ˇ£
–
›
==
TK_ISNOT
 );

78673 
r1
 = 
	`sqlôe3Ex¥CodeTemp
(
pP¨£
, 
pEx¥
->
pLe·
, &
ªgFªe1
);

78674 
r2
 = 
	`sqlôe3Ex¥CodeTemp
(
pP¨£
, 
pEx¥
->
pRight
, &
ªgFªe2
);

78675 
›
 = (›==
TK_IS
Ë? 
TK_EQ
 : 
TK_NE
;

78676 
	`codeCom∑ª
(
pP¨£
, 
pEx¥
->
pLe·
,ÖEx¥->
pRight
, 
›
,

78677 
r1
, 
r2
, 
öReg
, 
SQLITE_STOREP2
 | 
SQLITE_NULLEQ
);

78678 
	`ã°ˇ£
–
ªgFªe1
==0 );

78679 
	`ã°ˇ£
–
ªgFªe2
==0 );

78682 
TK_AND
:

78683 
TK_OR
:

78684 
TK_PLUS
:

78685 
TK_STAR
:

78686 
TK_MINUS
:

78687 
TK_REM
:

78688 
TK_BITAND
:

78689 
TK_BITOR
:

78690 
TK_SLASH
:

78691 
TK_LSHIFT
:

78692 
TK_RSHIFT
:

78693 
TK_CONCAT
: {

78694 
	`as£π
–
TK_AND
==
OP_And
 );

78695 
	`as£π
–
TK_OR
==
OP_Or
 );

78696 
	`as£π
–
TK_PLUS
==
OP_Add
 );

78697 
	`as£π
–
TK_MINUS
==
OP_Subåa˘
 );

78698 
	`as£π
–
TK_REM
==
OP_Remaödî
 );

78699 
	`as£π
–
TK_BITAND
==
OP_BôAnd
 );

78700 
	`as£π
–
TK_BITOR
==
OP_BôOr
 );

78701 
	`as£π
–
TK_SLASH
==
OP_Divide
 );

78702 
	`as£π
–
TK_LSHIFT
==
OP_Shi·Le·
 );

78703 
	`as£π
–
TK_RSHIFT
==
OP_Shi·Right
 );

78704 
	`as£π
–
TK_CONCAT
==
OP_C⁄ˇt
 );

78705 
	`ã°ˇ£
–
›
==
TK_AND
 );

78706 
	`ã°ˇ£
–
›
==
TK_OR
 );

78707 
	`ã°ˇ£
–
›
==
TK_PLUS
 );

78708 
	`ã°ˇ£
–
›
==
TK_MINUS
 );

78709 
	`ã°ˇ£
–
›
==
TK_REM
 );

78710 
	`ã°ˇ£
–
›
==
TK_BITAND
 );

78711 
	`ã°ˇ£
–
›
==
TK_BITOR
 );

78712 
	`ã°ˇ£
–
›
==
TK_SLASH
 );

78713 
	`ã°ˇ£
–
›
==
TK_LSHIFT
 );

78714 
	`ã°ˇ£
–
›
==
TK_RSHIFT
 );

78715 
	`ã°ˇ£
–
›
==
TK_CONCAT
 );

78716 
r1
 = 
	`sqlôe3Ex¥CodeTemp
(
pP¨£
, 
pEx¥
->
pLe·
, &
ªgFªe1
);

78717 
r2
 = 
	`sqlôe3Ex¥CodeTemp
(
pP¨£
, 
pEx¥
->
pRight
, &
ªgFªe2
);

78718 
	`sqlôe3VdbeAddOp3
(
v
, 
›
, 
r2
, 
r1
, 
èrgë
);

78719 
	`ã°ˇ£
–
ªgFªe1
==0 );

78720 
	`ã°ˇ£
–
ªgFªe2
==0 );

78723 
TK_UMINUS
: {

78724 
Ex¥
 *
pLe·
 = 
pEx¥
->pLeft;

78725 
	`as£π
–
pLe·
 );

78726 if–
pLe·
->
›
==
TK_INTEGER
 ){

78727 
	`codeI¡egî
(
pP¨£
, 
pLe·
, 1, 
èrgë
);

78728 #i‚de‡
SQLITE_OMIT_FLOATING_POINT


78729 }if–
pLe·
->
›
==
TK_FLOAT
 ){

78730 
	`as£π
–!
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_I¡VÆue
) );

78731 
	`codeRól
(
v
, 
pLe·
->
u
.
zTokí
, 1, 
èrgë
);

78734 
ªgFªe1
 = 
r1
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

78735 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 0, 
r1
);

78736 
r2
 = 
	`sqlôe3Ex¥CodeTemp
(
pP¨£
, 
pEx¥
->
pLe·
, &
ªgFªe2
);

78737 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Subåa˘
, 
r2
, 
r1
, 
èrgë
);

78738 
	`ã°ˇ£
–
ªgFªe2
==0 );

78740 
öReg
 = 
èrgë
;

78743 
TK_BITNOT
:

78744 
TK_NOT
: {

78745 
	`as£π
–
TK_BITNOT
==
OP_BôNŸ
 );

78746 
	`as£π
–
TK_NOT
==
OP_NŸ
 );

78747 
	`ã°ˇ£
–
›
==
TK_BITNOT
 );

78748 
	`ã°ˇ£
–
›
==
TK_NOT
 );

78749 
r1
 = 
	`sqlôe3Ex¥CodeTemp
(
pP¨£
, 
pEx¥
->
pLe·
, &
ªgFªe1
);

78750 
	`ã°ˇ£
–
ªgFªe1
==0 );

78751 
öReg
 = 
èrgë
;

78752 
	`sqlôe3VdbeAddOp2
(
v
, 
›
, 
r1
, 
öReg
);

78755 
TK_ISNULL
:

78756 
TK_NOTNULL
: {

78757 
addr
;

78758 
	`as£π
–
TK_ISNULL
==
OP_IsNuŒ
 );

78759 
	`as£π
–
TK_NOTNULL
==
OP_NŸNuŒ
 );

78760 
	`ã°ˇ£
–
›
==
TK_ISNULL
 );

78761 
	`ã°ˇ£
–
›
==
TK_NOTNULL
 );

78762 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 1, 
èrgë
);

78763 
r1
 = 
	`sqlôe3Ex¥CodeTemp
(
pP¨£
, 
pEx¥
->
pLe·
, &
ªgFªe1
);

78764 
	`ã°ˇ£
–
ªgFªe1
==0 );

78765 
addr
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
›
, 
r1
);

78766 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_AddImm
, 
èrgë
, -1);

78767 
	`sqlôe3VdbeJumpHîe
(
v
, 
addr
);

78770 
TK_AGG_FUNCTION
: {

78771 
AggInfo
 *
pInfo
 = 
pEx¥
->
pAggInfo
;

78772 if–
pInfo
==0 ){

78773 
	`as£π
–!
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_I¡VÆue
) );

78774 
	`sqlôe3Eº‹Msg
(
pP¨£
, "misu£ o‡aggªg©e: %s()", 
pEx¥
->
u
.
zTokí
);

78776 
öReg
 = 
pInfo
->
aFunc
[
pEx¥
->
iAgg
].
iMem
;

78780 
TK_CONST_FUNC
:

78781 
TK_FUNCTION
: {

78782 
Ex¥Li°
 *
pF¨g
;

78783 
nF¨g
;

78784 
FuncDef
 *
pDef
;

78785 
nId
;

78786 c⁄° *
zId
;

78787 
c⁄°Mask
 = 0;

78788 
i
;

78789 
u8
 
íc
 = 
	`ENC
(
db
);

78790 
CﬁlSeq
 *
pCﬁl
 = 0;

78792 
	`as£π
–!
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_xIsSñe˘
) );

78793 
	`ã°ˇ£
–
›
==
TK_CONST_FUNC
 );

78794 
	`ã°ˇ£
–
›
==
TK_FUNCTION
 );

78795 if–
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_TokíO∆y
) ){

78796 
pF¨g
 = 0;

78798 
pF¨g
 = 
pEx¥
->
x
.
pLi°
;

78800 
nF¨g
 = 
pF¨g
 ?ÖF¨g->
nEx¥
 : 0;

78801 
	`as£π
–!
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_I¡VÆue
) );

78802 
zId
 = 
pEx¥
->
u
.
zTokí
;

78803 
nId
 = 
	`sqlôe3SåÀn30
(
zId
);

78804 
pDef
 = 
	`sqlôe3FödFun˘i⁄
(
db
, 
zId
, 
nId
, 
nF¨g
, 
íc
, 0);

78805 if–
pDef
==0 ){

78806 
	`sqlôe3Eº‹Msg
(
pP¨£
, "unknow¿fun˘i⁄: %.*s()", 
nId
, 
zId
);

78814 if–
pDef
->
funcFœgs
 & 
SQLITE_FUNC_COALESCE
 ){

78815 
ídCﬂÀs˚
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

78816 
	`as£π
–
nF¨g
>=2 );

78817 
	`sqlôe3Ex¥Code
(
pP¨£
, 
pF¨g
->
a
[0].
pEx¥
, 
èrgë
);

78818 
i
=1; i<
nF¨g
; i++){

78819 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NŸNuŒ
, 
èrgë
, 
ídCﬂÀs˚
);

78820 
	`sqlôe3Ex¥CacheRemove
(
pP¨£
, 
èrgë
, 1);

78821 
	`sqlôe3Ex¥CachePush
(
pP¨£
);

78822 
	`sqlôe3Ex¥Code
(
pP¨£
, 
pF¨g
->
a
[
i
].
pEx¥
, 
èrgë
);

78823 
	`sqlôe3Ex¥CacheP›
(
pP¨£
, 1);

78825 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
ídCﬂÀs˚
);

78832 if–
pDef
->
funcFœgs
 & 
SQLITE_FUNC_UNLIKELY
 ){

78833 
	`as£π
–
nF¨g
>=1 );

78834 
	`sqlôe3Ex¥Code
(
pP¨£
, 
pF¨g
->
a
[0].
pEx¥
, 
èrgë
);

78838 if–
pF¨g
 ){

78839 
r1
 = 
	`sqlôe3GëTempR™ge
(
pP¨£
, 
nF¨g
);

78846 if–(
pDef
->
funcFœgs
 & (
SQLITE_FUNC_LENGTH
|
SQLITE_FUNC_TYPEOF
))!=0 ){

78847 
u8
 
ex¥Op
;

78848 
	`as£π
–
nF¨g
==1 );

78849 
	`as£π
–
pF¨g
->
a
[0].
pEx¥
!=0 );

78850 
ex¥Op
 = 
pF¨g
->
a
[0].
pEx¥
->
›
;

78851 if–
ex¥Op
==
TK_COLUMN
 ||Éx¥Op==
TK_AGG_COLUMN
 ){

78852 
	`as£π
–
SQLITE_FUNC_LENGTH
==
OPFLAG_LENGTHARG
 );

78853 
	`as£π
–
SQLITE_FUNC_TYPEOF
==
OPFLAG_TYPEOFARG
 );

78854 
	`ã°ˇ£
–(
pDef
->
funcFœgs
&~
SQLITE_FUNC_ENCMASK
)

78855 ==
SQLITE_FUNC_LENGTH
 );

78856 
pF¨g
->
a
[0].
pEx¥
->
›2
 = 
pDef
->
funcFœgs
&~
SQLITE_FUNC_ENCMASK
;

78860 
	`sqlôe3Ex¥CachePush
(
pP¨£
);

78861 
	`sqlôe3Ex¥CodeEx¥Li°
(
pP¨£
, 
pF¨g
, 
r1
, 1);

78862 
	`sqlôe3Ex¥CacheP›
(
pP¨£
, 1);

78864 
r1
 = 0;

78866 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


78879 if–
nF¨g
>=2 && (
pEx¥
->
Êags
 & 
EP_InfixFunc
) ){

78880 
pDef
 = 
	`sqlôe3VèbOvîlﬂdFun˘i⁄
(
db
,ÖDef, 
nF¨g
, 
pF¨g
->
a
[1].
pEx¥
);

78881 }if–
nF¨g
>0 ){

78882 
pDef
 = 
	`sqlôe3VèbOvîlﬂdFun˘i⁄
(
db
,ÖDef, 
nF¨g
, 
pF¨g
->
a
[0].
pEx¥
);

78885 
i
=0; i<
nF¨g
; i++){

78886 if–
i
<32 && 
	`sqlôe3Ex¥IsC⁄°™t
(
pF¨g
->
a
[i].
pEx¥
) ){

78887 
c⁄°Mask
 |(1<<
i
);

78889 if–(
pDef
->
funcFœgs
 & 
SQLITE_FUNC_NEEDCOLL
)!=0 && !
pCﬁl
 ){

78890 
pCﬁl
 = 
	`sqlôe3Ex¥CﬁlSeq
(
pP¨£
, 
pF¨g
->
a
[
i
].
pEx¥
);

78893 if–
pDef
->
funcFœgs
 & 
SQLITE_FUNC_NEEDCOLL
 ){

78894 if–!
pCﬁl
 )ÖCﬁ»
db
->
pDÊtCﬁl
;

78895 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_CﬁlSeq
, 0, 0, 0, (*)
pCﬁl
, 
P4_COLLSEQ
);

78897 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Fun˘i⁄
, 
c⁄°Mask
, 
r1
, 
èrgë
,

78898 (*)
pDef
, 
P4_FUNCDEF
);

78899 
	`sqlôe3VdbeCh™geP5
(
v
, (
u8
)
nF¨g
);

78900 if–
nF¨g
 ){

78901 
	`sqlôe3Rñó£TempR™ge
(
pP¨£
, 
r1
, 
nF¨g
);

78905 #i‚de‡
SQLITE_OMIT_SUBQUERY


78906 
TK_EXISTS
:

78907 
TK_SELECT
: {

78908 
	`ã°ˇ£
–
›
==
TK_EXISTS
 );

78909 
	`ã°ˇ£
–
›
==
TK_SELECT
 );

78910 
öReg
 = 
	`sqlôe3CodeSub£À˘
(
pP¨£
, 
pEx¥
, 0, 0);

78913 
TK_IN
: {

78914 
de°IfFÆ£
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

78915 
de°IfNuŒ
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

78916 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NuŒ
, 0, 
èrgë
);

78917 
	`sqlôe3Ex¥CodeIN
(
pP¨£
, 
pEx¥
, 
de°IfFÆ£
, 
de°IfNuŒ
);

78918 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 1, 
èrgë
);

78919 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
de°IfFÆ£
);

78920 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_AddImm
, 
èrgë
, 0);

78921 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
de°IfNuŒ
);

78938 
TK_BETWEEN
: {

78939 
Ex¥
 *
pLe·
 = 
pEx¥
->pLeft;

78940 
Ex¥Li°_ôem
 *
pLIãm
 = 
pEx¥
->
x
.
pLi°
->
a
;

78941 
Ex¥
 *
pRight
 = 
pLIãm
->
pEx¥
;

78943 
r1
 = 
	`sqlôe3Ex¥CodeTemp
(
pP¨£
, 
pLe·
, &
ªgFªe1
);

78944 
r2
 = 
	`sqlôe3Ex¥CodeTemp
(
pP¨£
, 
pRight
, &
ªgFªe2
);

78945 
	`ã°ˇ£
–
ªgFªe1
==0 );

78946 
	`ã°ˇ£
–
ªgFªe2
==0 );

78947 
r3
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

78948 
r4
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

78949 
	`codeCom∑ª
(
pP¨£
, 
pLe·
, 
pRight
, 
OP_Ge
,

78950 
r1
, 
r2
, 
r3
, 
SQLITE_STOREP2
);

78951 
pLIãm
++;

78952 
pRight
 = 
pLIãm
->
pEx¥
;

78953 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
ªgFªe2
);

78954 
r2
 = 
	`sqlôe3Ex¥CodeTemp
(
pP¨£
, 
pRight
, &
ªgFªe2
);

78955 
	`ã°ˇ£
–
ªgFªe2
==0 );

78956 
	`codeCom∑ª
(
pP¨£
, 
pLe·
, 
pRight
, 
OP_Le
, 
r1
, 
r2
, 
r4
, 
SQLITE_STOREP2
);

78957 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_And
, 
r3
, 
r4
, 
èrgë
);

78958 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
r3
);

78959 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
r4
);

78962 
TK_COLLATE
:

78963 
TK_UPLUS
: {

78964 
öReg
 = 
	`sqlôe3Ex¥CodeT¨gë
(
pP¨£
, 
pEx¥
->
pLe·
, 
èrgë
);

78968 
TK_TRIGGER
: {

78994 
TabÀ
 *
pTab
 = 
pEx¥
->pTab;

78995 
p1
 = 
pEx¥
->
iTabÀ
 * (
pTab
->
nCﬁ
+1Ë+ 1 +ÖEx¥->
iCﬁumn
;

78997 
	`as£π
–
pEx¥
->
iTabÀ
==0 ||ÖExpr->iTable==1 );

78998 
	`as£π
–
pEx¥
->
iCﬁumn
>=-1 &&ÖEx¥->iCﬁumn<
pTab
->
nCﬁ
 );

78999 
	`as£π
–
pTab
->
iPKey
<0 || 
pEx¥
->
iCﬁumn
!=pTab->iPKey );

79000 
	`as£π
–
p1
>=0 &&Ö1<(
pTab
->
nCﬁ
*2+2) );

79002 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_P¨am
, 
p1
, 
èrgë
);

79003 
	`VdbeCommít
((
v
, "%s.%s -> $%d",

79004 (
pEx¥
->
iTabÀ
 ? "new" : "old"),

79005 (
pEx¥
->
iCﬁumn
<0 ? "rowid" :ÖEx¥->
pTab
->
aCﬁ
[pEx¥->iCﬁumn].
zName
),

79006 
èrgë


79009 #i‚de‡
SQLITE_OMIT_FLOATING_POINT


79012 if–
pEx¥
->
iCﬁumn
>=0

79013 && 
pTab
->
aCﬁ
[
pEx¥
->
iCﬁumn
].
afföôy
==
SQLITE_AFF_REAL


79015 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_RólAfföôy
, 
èrgë
);

79043 : 
	`as£π
–
›
==
TK_CASE
 ); {

79044 
ídLabñ
;

79045 
√xtCa£
;

79046 
nEx¥
;

79047 
i
;

79048 
Ex¥Li°
 *
pELi°
;

79049 
Ex¥Li°_ôem
 *
aLi°ñem
;

79050 
Ex¥
 
›Com∑ª
;

79051 
Ex¥
 
ˇcheX
;

79052 
Ex¥
 *
pX
;

79053 
Ex¥
 *
pTe°
 = 0;

79054 
	`VVA_ONLY
–
iCacheLevñ
 = 
pP¨£
->iCacheLevel; )

79056 
	`as£π
–!
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_xIsSñe˘
Ë&&ÖEx¥->
x
.
pLi°
 );

79057 
	`as£π
(
pEx¥
->
x
.
pLi°
->
nEx¥
 > 0);

79058 
pELi°
 = 
pEx¥
->
x
.
pLi°
;

79059 
aLi°ñem
 = 
pELi°
->
a
;

79060 
nEx¥
 = 
pELi°
->nExpr;

79061 
ídLabñ
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

79062 if–(
pX
 = 
pEx¥
->
pLe·
)!=0 ){

79063 
ˇcheX
 = *
pX
;

79064 
	`ã°ˇ£
–
pX
->
›
==
TK_COLUMN
 );

79065 
	`ã°ˇ£
–
pX
->
›
==
TK_REGISTER
 );

79066 
	`ex¥ToRegi°î
(&
ˇcheX
, 
	`sqlôe3Ex¥CodeTemp
(
pP¨£
, 
pX
, &
ªgFªe1
));

79067 
	`ã°ˇ£
–
ªgFªe1
==0 );

79068 
›Com∑ª
.
›
 = 
TK_EQ
;

79069 
›Com∑ª
.
pLe·
 = &
ˇcheX
;

79070 
pTe°
 = &
›Com∑ª
;

79075 
ªgFªe1
 = 0;

79077 
i
=0; i<
nEx¥
-1; i=i+2){

79078 
	`sqlôe3Ex¥CachePush
(
pP¨£
);

79079 if–
pX
 ){

79080 
	`as£π
–
pTe°
!=0 );

79081 
›Com∑ª
.
pRight
 = 
aLi°ñem
[
i
].
pEx¥
;

79083 
pTe°
 = 
aLi°ñem
[
i
].
pEx¥
;

79085 
√xtCa£
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

79086 
	`ã°ˇ£
–
pTe°
->
›
==
TK_COLUMN
 );

79087 
	`sqlôe3Ex¥IfFÆ£
(
pP¨£
, 
pTe°
, 
√xtCa£
, 
SQLITE_JUMPIFNULL
);

79088 
	`ã°ˇ£
–
aLi°ñem
[
i
+1].
pEx¥
->
›
==
TK_COLUMN
 );

79089 
	`ã°ˇ£
–
aLi°ñem
[
i
+1].
pEx¥
->
›
==
TK_REGISTER
 );

79090 
	`sqlôe3Ex¥Code
(
pP¨£
, 
aLi°ñem
[
i
+1].
pEx¥
, 
èrgë
);

79091 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_GŸo
, 0, 
ídLabñ
);

79092 
	`sqlôe3Ex¥CacheP›
(
pP¨£
, 1);

79093 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
√xtCa£
);

79095 if–(
nEx¥
&1)!=0 ){

79096 
	`sqlôe3Ex¥CachePush
(
pP¨£
);

79097 
	`sqlôe3Ex¥Code
(
pP¨£
, 
pELi°
->
a
[
nEx¥
-1].
pEx¥
, 
èrgë
);

79098 
	`sqlôe3Ex¥CacheP›
(
pP¨£
, 1);

79100 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NuŒ
, 0, 
èrgë
);

79102 
	`as£π
–
db
->
mÆlocFaûed
 || 
pP¨£
->
nEº
>0

79103 || 
pP¨£
->
iCacheLevñ
==iCacheLevel );

79104 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
ídLabñ
);

79107 #i‚de‡
SQLITE_OMIT_TRIGGER


79108 
TK_RAISE
: {

79109 
	`as£π
–
pEx¥
->
afföôy
==
OE_Rﬁlback


79110 || 
pEx¥
->
afföôy
==
OE_Ab‹t


79111 || 
pEx¥
->
afföôy
==
OE_Faû


79112 || 
pEx¥
->
afföôy
==
OE_Ign‹e


79114 if–!
pP¨£
->
pTriggîTab
 ){

79115 
	`sqlôe3Eº‹Msg
(
pP¨£
,

79119 if–
pEx¥
->
afföôy
==
OE_Ab‹t
 ){

79120 
	`sqlôe3MayAb‹t
(
pP¨£
);

79122 
	`as£π
–!
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_I¡VÆue
) );

79123 if–
pEx¥
->
afföôy
==
OE_Ign‹e
 ){

79124 
	`sqlôe3VdbeAddOp4
(

79125 
v
, 
OP_HÆt
, 
SQLITE_OK
, 
OE_Ign‹e
, 0, 
pEx¥
->
u
.
zTokí
,0);

79127 
	`sqlôe3HÆtC⁄°øöt
(
pP¨£
, 
SQLITE_CONSTRAINT_TRIGGER
,

79128 
pEx¥
->
afföôy
,ÖEx¥->
u
.
zTokí
, 0);

79135 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
ªgFªe1
);

79136 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
ªgFªe2
);

79137  
öReg
;

79149 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥CodeTemp
(
P¨£
 *
pP¨£
, 
Ex¥
 *
pEx¥
, *
pReg
){

79150 
r1
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

79151 
r2
 = 
	`sqlôe3Ex¥CodeT¨gë
(
pP¨£
, 
pEx¥
, 
r1
);

79152 if–
r2
==
r1
 ){

79153 *
pReg
 = 
r1
;

79155 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
r1
);

79156 *
pReg
 = 0;

79158  
r2
;

79166 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥Code
(
P¨£
 *
pP¨£
, 
Ex¥
 *
pEx¥
, 
èrgë
){

79167 
öReg
;

79169 
	`as£π
–
èrgë
>0 &&Å¨gë<=
pP¨£
->
nMem
 );

79170 if–
pEx¥
 &&ÖEx¥->
›
==
TK_REGISTER
 ){

79171 
	`sqlôe3VdbeAddOp2
(
pP¨£
->
pVdbe
, 
OP_C›y
, 
pEx¥
->
iTabÀ
, 
èrgë
);

79173 
öReg
 = 
	`sqlôe3Ex¥CodeT¨gë
(
pP¨£
, 
pEx¥
, 
èrgë
);

79174 
	`as£π
–
pP¨£
->
pVdbe
 ||ÖP¨£->
db
->
mÆlocFaûed
 );

79175 if–
öReg
!=
èrgë
 && 
pP¨£
->
pVdbe
 ){

79176 
	`sqlôe3VdbeAddOp2
(
pP¨£
->
pVdbe
, 
OP_SC›y
, 
öReg
, 
èrgë
);

79179  
èrgë
;

79194 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥CodeAndCache
(
P¨£
 *
pP¨£
, 
Ex¥
 *
pEx¥
, 
èrgë
){

79195 
Vdbe
 *
v
 = 
pP¨£
->
pVdbe
;

79196 
öReg
;

79197 
öReg
 = 
	`sqlôe3Ex¥Code
(
pP¨£
, 
pEx¥
, 
èrgë
);

79198 
	`as£π
–
èrgë
>0 );

79205 if–
	`ALWAYS
(
pEx¥
->
›
!=
TK_REGISTER
) ){

79206 
iMem
;

79207 
iMem
 = ++
pP¨£
->
nMem
;

79208 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_C›y
, 
öReg
, 
iMem
);

79209 
	`ex¥ToRegi°î
(
pEx¥
, 
iMem
);

79211  
öReg
;

79214 #i‡
	`deföed
(
SQLITE_ENABLE_TREE_EXPLAIN
)

79218 
SQLITE_PRIVATE
 
	`sqlôe3Ex∂aöEx¥
(
Vdbe
 *
pOut
, 
Ex¥
 *
pEx¥
){

79219 
›
;

79220 c⁄° *
zBöOp
 = 0;

79221 c⁄° *
zUniOp
 = 0;

79222 if–
pEx¥
==0 ){

79223 
›
 = 
TK_NULL
;

79225 
›
 = 
pEx¥
->op;

79227  
›
 ){

79228 
TK_AGG_COLUMN
: {

79229 
	`sqlôe3Ex∂aöPrötf
(
pOut
, "AGG{%d:%d}",

79230 
pEx¥
->
iTabÀ
,ÖEx¥->
iCﬁumn
);

79233 
TK_COLUMN
: {

79234 if–
pEx¥
->
iTabÀ
<0 ){

79236 
	`sqlôe3Ex∂aöPrötf
(
pOut
, "COLUMN(%d)", 
pEx¥
->
iCﬁumn
);

79238 
	`sqlôe3Ex∂aöPrötf
(
pOut
, "{%d:%d}",

79239 
pEx¥
->
iTabÀ
,ÖEx¥->
iCﬁumn
);

79243 
TK_INTEGER
: {

79244 if–
pEx¥
->
Êags
 & 
EP_I¡VÆue
 ){

79245 
	`sqlôe3Ex∂aöPrötf
(
pOut
, "%d", 
pEx¥
->
u
.
iVÆue
);

79247 
	`sqlôe3Ex∂aöPrötf
(
pOut
, "%s", 
pEx¥
->
u
.
zTokí
);

79251 #i‚de‡
SQLITE_OMIT_FLOATING_POINT


79252 
TK_FLOAT
: {

79253 
	`sqlôe3Ex∂aöPrötf
(
pOut
,"%s", 
pEx¥
->
u
.
zTokí
);

79257 
TK_STRING
: {

79258 
	`sqlôe3Ex∂aöPrötf
(
pOut
,"%Q", 
pEx¥
->
u
.
zTokí
);

79261 
TK_NULL
: {

79262 
	`sqlôe3Ex∂aöPrötf
(
pOut
,"NULL");

79265 #i‚de‡
SQLITE_OMIT_BLOB_LITERAL


79266 
TK_BLOB
: {

79267 
	`sqlôe3Ex∂aöPrötf
(
pOut
,"%s", 
pEx¥
->
u
.
zTokí
);

79271 
TK_VARIABLE
: {

79272 
	`sqlôe3Ex∂aöPrötf
(
pOut
,"VARIABLE(%s,%d)",

79273 
pEx¥
->
u
.
zTokí
,ÖEx¥->
iCﬁumn
);

79276 
TK_REGISTER
: {

79277 
	`sqlôe3Ex∂aöPrötf
(
pOut
,"REGISTER(%d)", 
pEx¥
->
iTabÀ
);

79280 
TK_AS
: {

79281 
	`sqlôe3Ex∂aöEx¥
(
pOut
, 
pEx¥
->
pLe·
);

79284 #i‚de‡
SQLITE_OMIT_CAST


79285 
TK_CAST
: {

79287 c⁄° *
zAff
 = "unk";

79288  
	`sqlôe3AfföôyTy≥
(
pEx¥
->
u
.
zTokí
, 0) ){

79289 
SQLITE_AFF_TEXT
: 
zAff
 = "TEXT"; ;

79290 
SQLITE_AFF_NONE
: 
zAff
 = "NONE"; ;

79291 
SQLITE_AFF_NUMERIC
: 
zAff
 = "NUMERIC"; ;

79292 
SQLITE_AFF_INTEGER
: 
zAff
 = "INTEGER"; ;

79293 
SQLITE_AFF_REAL
: 
zAff
 = "REAL"; ;

79295 
	`sqlôe3Ex∂aöPrötf
(
pOut
, "CAST-%s(", 
zAff
);

79296 
	`sqlôe3Ex∂aöEx¥
(
pOut
, 
pEx¥
->
pLe·
);

79297 
	`sqlôe3Ex∂aöPrötf
(
pOut
, ")");

79301 
TK_LT
: 
zBöOp
 = "LT"; ;

79302 
TK_LE
: 
zBöOp
 = "LE"; ;

79303 
TK_GT
: 
zBöOp
 = "GT"; ;

79304 
TK_GE
: 
zBöOp
 = "GE"; ;

79305 
TK_NE
: 
zBöOp
 = "NE"; ;

79306 
TK_EQ
: 
zBöOp
 = "EQ"; ;

79307 
TK_IS
: 
zBöOp
 = "IS"; ;

79308 
TK_ISNOT
: 
zBöOp
 = "ISNOT"; ;

79309 
TK_AND
: 
zBöOp
 = "AND"; ;

79310 
TK_OR
: 
zBöOp
 = "OR"; ;

79311 
TK_PLUS
: 
zBöOp
 = "ADD"; ;

79312 
TK_STAR
: 
zBöOp
 = "MUL"; ;

79313 
TK_MINUS
: 
zBöOp
 = "SUB"; ;

79314 
TK_REM
: 
zBöOp
 = "REM"; ;

79315 
TK_BITAND
: 
zBöOp
 = "BITAND"; ;

79316 
TK_BITOR
: 
zBöOp
 = "BITOR"; ;

79317 
TK_SLASH
: 
zBöOp
 = "DIV"; ;

79318 
TK_LSHIFT
: 
zBöOp
 = "LSHIFT"; ;

79319 
TK_RSHIFT
: 
zBöOp
 = "RSHIFT"; ;

79320 
TK_CONCAT
: 
zBöOp
 = "CONCAT"; ;

79322 
TK_UMINUS
: 
zUniOp
 = "UMINUS"; ;

79323 
TK_UPLUS
: 
zUniOp
 = "UPLUS"; ;

79324 
TK_BITNOT
: 
zUniOp
 = "BITNOT"; ;

79325 
TK_NOT
: 
zUniOp
 = "NOT"; ;

79326 
TK_ISNULL
: 
zUniOp
 = "ISNULL"; ;

79327 
TK_NOTNULL
: 
zUniOp
 = "NOTNULL"; ;

79329 
TK_COLLATE
: {

79330 
	`sqlôe3Ex∂aöEx¥
(
pOut
, 
pEx¥
->
pLe·
);

79331 
	`sqlôe3Ex∂aöPrötf
(
pOut
,".COLLATE(%s)",
pEx¥
->
u
.
zTokí
);

79335 
TK_AGG_FUNCTION
:

79336 
TK_CONST_FUNC
:

79337 
TK_FUNCTION
: {

79338 
Ex¥Li°
 *
pF¨g
;

79339 if–
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_TokíO∆y
) ){

79340 
pF¨g
 = 0;

79342 
pF¨g
 = 
pEx¥
->
x
.
pLi°
;

79344 if–
›
==
TK_AGG_FUNCTION
 ){

79345 
	`sqlôe3Ex∂aöPrötf
(
pOut
, "AGG_FUNCTION%d:%s(",

79346 
pEx¥
->
›2
,ÖEx¥->
u
.
zTokí
);

79348 
	`sqlôe3Ex∂aöPrötf
(
pOut
, "FUNCTION:%s(", 
pEx¥
->
u
.
zTokí
);

79350 if–
pF¨g
 ){

79351 
	`sqlôe3Ex∂aöEx¥Li°
(
pOut
, 
pF¨g
);

79353 
	`sqlôe3Ex∂aöPrötf
(
pOut
, ")");

79356 #i‚de‡
SQLITE_OMIT_SUBQUERY


79357 
TK_EXISTS
: {

79358 
	`sqlôe3Ex∂aöPrötf
(
pOut
, "EXISTS(");

79359 
	`sqlôe3Ex∂aöSñe˘
(
pOut
, 
pEx¥
->
x
.
pSñe˘
);

79360 
	`sqlôe3Ex∂aöPrötf
(
pOut
,")");

79363 
TK_SELECT
: {

79364 
	`sqlôe3Ex∂aöPrötf
(
pOut
, "(");

79365 
	`sqlôe3Ex∂aöSñe˘
(
pOut
, 
pEx¥
->
x
.
pSñe˘
);

79366 
	`sqlôe3Ex∂aöPrötf
(
pOut
, ")");

79369 
TK_IN
: {

79370 
	`sqlôe3Ex∂aöPrötf
(
pOut
, "IN(");

79371 
	`sqlôe3Ex∂aöEx¥
(
pOut
, 
pEx¥
->
pLe·
);

79372 
	`sqlôe3Ex∂aöPrötf
(
pOut
, ",");

79373 if–
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_xIsSñe˘
) ){

79374 
	`sqlôe3Ex∂aöSñe˘
(
pOut
, 
pEx¥
->
x
.
pSñe˘
);

79376 
	`sqlôe3Ex∂aöEx¥Li°
(
pOut
, 
pEx¥
->
x
.
pLi°
);

79378 
	`sqlôe3Ex∂aöPrötf
(
pOut
, ")");

79394 
TK_BETWEEN
: {

79395 
Ex¥
 *
pX
 = 
pEx¥
->
pLe·
;

79396 
Ex¥
 *
pY
 = 
pEx¥
->
x
.
pLi°
->
a
[0].pExpr;

79397 
Ex¥
 *
pZ
 = 
pEx¥
->
x
.
pLi°
->
a
[1].pExpr;

79398 
	`sqlôe3Ex∂aöPrötf
(
pOut
, "BETWEEN(");

79399 
	`sqlôe3Ex∂aöEx¥
(
pOut
, 
pX
);

79400 
	`sqlôe3Ex∂aöPrötf
(
pOut
, ",");

79401 
	`sqlôe3Ex∂aöEx¥
(
pOut
, 
pY
);

79402 
	`sqlôe3Ex∂aöPrötf
(
pOut
, ",");

79403 
	`sqlôe3Ex∂aöEx¥
(
pOut
, 
pZ
);

79404 
	`sqlôe3Ex∂aöPrötf
(
pOut
, ")");

79407 
TK_TRIGGER
: {

79415 
	`sqlôe3Ex∂aöPrötf
(
pOut
, "%s(%d)",

79416 
pEx¥
->
iTabÀ
 ? "NEW" : "OLD",ÖEx¥->
iCﬁumn
);

79419 
TK_CASE
: {

79420 
	`sqlôe3Ex∂aöPrötf
(
pOut
, "CASE(");

79421 
	`sqlôe3Ex∂aöEx¥
(
pOut
, 
pEx¥
->
pLe·
);

79422 
	`sqlôe3Ex∂aöPrötf
(
pOut
, ",");

79423 
	`sqlôe3Ex∂aöEx¥Li°
(
pOut
, 
pEx¥
->
x
.
pLi°
);

79426 #i‚de‡
SQLITE_OMIT_TRIGGER


79427 
TK_RAISE
: {

79428 c⁄° *
zTy≥
 = "unk";

79429  
pEx¥
->
afföôy
 ){

79430 
OE_Rﬁlback
: 
zTy≥
 = "rollback"; ;

79431 
OE_Ab‹t
: 
zTy≥
 = "abort"; ;

79432 
OE_Faû
: 
zTy≥
 = "fail"; ;

79433 
OE_Ign‹e
: 
zTy≥
 = "ignore"; ;

79435 
	`sqlôe3Ex∂aöPrötf
(
pOut
, "RAISE-%s(%s)", 
zTy≥
, 
pEx¥
->
u
.
zTokí
);

79440 if–
zBöOp
 ){

79441 
	`sqlôe3Ex∂aöPrötf
(
pOut
,"%s(", 
zBöOp
);

79442 
	`sqlôe3Ex∂aöEx¥
(
pOut
, 
pEx¥
->
pLe·
);

79443 
	`sqlôe3Ex∂aöPrötf
(
pOut
,",");

79444 
	`sqlôe3Ex∂aöEx¥
(
pOut
, 
pEx¥
->
pRight
);

79445 
	`sqlôe3Ex∂aöPrötf
(
pOut
,")");

79446 }if–
zUniOp
 ){

79447 
	`sqlôe3Ex∂aöPrötf
(
pOut
,"%s(", 
zUniOp
);

79448 
	`sqlôe3Ex∂aöEx¥
(
pOut
, 
pEx¥
->
pLe·
);

79449 
	`sqlôe3Ex∂aöPrötf
(
pOut
,")");

79454 #i‡
	`deföed
(
SQLITE_ENABLE_TREE_EXPLAIN
)

79458 
SQLITE_PRIVATE
 
	`sqlôe3Ex∂aöEx¥Li°
(
Vdbe
 *
pOut
, 
Ex¥Li°
 *
pLi°
){

79459 
i
;

79460 if–
pLi°
==0 ||ÖLi°->
nEx¥
==0 ){

79461 
	`sqlôe3Ex∂aöPrötf
(
pOut
, "(empty-list)");

79463 }if–
pLi°
->
nEx¥
==1 ){

79464 
	`sqlôe3Ex∂aöEx¥
(
pOut
, 
pLi°
->
a
[0].
pEx¥
);

79466 
	`sqlôe3Ex∂aöPush
(
pOut
);

79467 
i
=0; i<
pLi°
->
nEx¥
; i++){

79468 
	`sqlôe3Ex∂aöPrötf
(
pOut
, "ôem[%d] = ", 
i
);

79469 
	`sqlôe3Ex∂aöPush
(
pOut
);

79470 
	`sqlôe3Ex∂aöEx¥
(
pOut
, 
pLi°
->
a
[
i
].
pEx¥
);

79471 
	`sqlôe3Ex∂aöP›
(
pOut
);

79472 if–
pLi°
->
a
[
i
].
zName
 ){

79473 
	`sqlôe3Ex∂aöPrötf
(
pOut
, " AS %s", 
pLi°
->
a
[
i
].
zName
);

79475 if–
pLi°
->
a
[
i
].
bS∑nIsTab
 ){

79476 
	`sqlôe3Ex∂aöPrötf
(
pOut
, " (%s)", 
pLi°
->
a
[
i
].
zS∑n
);

79478 if–
i
<
pLi°
->
nEx¥
-1 ){

79479 
	`sqlôe3Ex∂aöNL
(
pOut
);

79482 
	`sqlôe3Ex∂aöP›
(
pOut
);

79504 
	`isAµr›rüãF‹Fa˘‹ög
(
Ex¥
 *
p
){

79505 if–!
	`sqlôe3Ex¥IsC⁄°™tNŸJoö
(
p
) ){

79508 if–(
p
->
Êags
 & 
EP_FixedDe°
)==0 ){

79511  
p
->
›
==
TK_UPLUS
 )Ö =Ö->
pLe·
;

79512  
p
->
›
 ){

79513 #i‚de‡
SQLITE_OMIT_BLOB_LITERAL


79514 
TK_BLOB
:

79516 
TK_VARIABLE
:

79517 
TK_INTEGER
:

79518 
TK_FLOAT
:

79519 
TK_NULL
:

79520 
TK_STRING
: {

79521 
	`ã°ˇ£
–
p
->
›
==
TK_BLOB
 );

79522 
	`ã°ˇ£
–
p
->
›
==
TK_VARIABLE
 );

79523 
	`ã°ˇ£
–
p
->
›
==
TK_INTEGER
 );

79524 
	`ã°ˇ£
–
p
->
›
==
TK_FLOAT
 );

79525 
	`ã°ˇ£
–
p
->
›
==
TK_NULL
 );

79526 
	`ã°ˇ£
–
p
->
›
==
TK_STRING
 );

79533 
TK_UMINUS
: {

79534 if–
p
->
pLe·
->
›
==
TK_FLOAT
 ||Ö->pLe·->›==
TK_INTEGER
 ){

79552 
	`evÆC⁄°Ex¥
(
WÆkî
 *
pWÆkî
, 
Ex¥
 *
pEx¥
){

79553 
P¨£
 *
pP¨£
 = 
pWÆkî
->pParse;

79554  
pEx¥
->
›
 ){

79555 
TK_IN
:

79556 
TK_REGISTER
: {

79557  
WRC_Pru√
;

79559 
TK_COLLATE
: {

79560  
WRC_C⁄töue
;

79562 
TK_FUNCTION
:

79563 
TK_AGG_FUNCTION
:

79564 
TK_CONST_FUNC
: {

79569 
Ex¥Li°
 *
pLi°
 = 
pEx¥
->
x
.pList;

79570 
	`as£π
–!
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_xIsSñe˘
) );

79571 if–
pLi°
 ){

79572 
i
 = 
pLi°
->
nEx¥
;

79573 
Ex¥Li°_ôem
 *
pIãm
 = 
pLi°
->
a
;

79574 ; 
i
>0; i--, 
pIãm
++){

79575 if–
	`ALWAYS
(
pIãm
->
pEx¥
ËËpIãm->pEx¥->
Êags
 |
EP_FixedDe°
;

79581 if–
	`isAµr›rüãF‹Fa˘‹ög
(
pEx¥
) ){

79582 
r1
 = ++
pP¨£
->
nMem
;

79583 
r2
 = 
	`sqlôe3Ex¥CodeT¨gë
(
pP¨£
, 
pEx¥
, 
r1
);

79587 
	`as£π
–
r2
==
r1
 );

79588 
	`ex¥ToRegi°î
(
pEx¥
, 
r2
);

79589  
WRC_Pru√
;

79591  
WRC_C⁄töue
;

79610 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥CodeC⁄°™ts
(
P¨£
 *
pP¨£
, 
Ex¥
 *
pEx¥
){

79611 
WÆkî
 
w
;

79612 if–
pP¨£
->
cookõGŸo
 ) ;

79613 if–
	`O±imiz©i⁄DißbÀd
(
pP¨£
->
db
, 
SQLITE_Fa˘‹OutC⁄°
) ) ;

79614 
	`mem£t
(&
w
, 0, (w));

79615 
w
.
xEx¥CÆlback
 = 
evÆC⁄°Ex¥
;

79616 
w
.
pP¨£
 =ÖParse;

79617 
	`sqlôe3WÆkEx¥
(&
w
, 
pEx¥
);

79627 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥CodeEx¥Li°
(

79628 
P¨£
 *
pP¨£
,

79629 
Ex¥Li°
 *
pLi°
,

79630 
èrgë
,

79631 
doH¨dC›y


79633 
Ex¥Li°_ôem
 *
pIãm
;

79634 
i
, 
n
;

79635 
	`as£π
–
pLi°
!=0 );

79636 
	`as£π
–
èrgë
>0 );

79637 
	`as£π
–
pP¨£
->
pVdbe
!=0 );

79638 
n
 = 
pLi°
->
nEx¥
;

79639 
pIãm
=
pLi°
->
a
, 
i
=0; i<
n
; i++,ÖItem++){

79640 
Ex¥
 *
pEx¥
 = 
pIãm
->pExpr;

79641 
öReg
 = 
	`sqlôe3Ex¥CodeT¨gë
(
pP¨£
, 
pEx¥
, 
èrgë
+
i
);

79642 if–
öReg
!=
èrgë
+
i
 ){

79643 
	`sqlôe3VdbeAddOp2
(
pP¨£
->
pVdbe
, 
doH¨dC›y
 ? 
OP_C›y
 : 
OP_SC›y
,

79644 
öReg
, 
èrgë
+
i
);

79647  
n
;

79662 
	`ex¥CodeBëwìn
(

79663 
P¨£
 *
pP¨£
,

79664 
Ex¥
 *
pEx¥
,

79665 
de°
,

79666 
jumpIfTrue
,

79667 
jumpIfNuŒ


79669 
Ex¥
 
ex¥And
;

79670 
Ex¥
 
compLe·
;

79671 
Ex¥
 
compRight
;

79672 
Ex¥
 
ex¥X
;

79673 
ªgFªe1
 = 0;

79675 
	`as£π
–!
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_xIsSñe˘
) );

79676 
ex¥X
 = *
pEx¥
->
pLe·
;

79677 
ex¥And
.
›
 = 
TK_AND
;

79678 
ex¥And
.
pLe·
 = &
compLe·
;

79679 
ex¥And
.
pRight
 = &
compRight
;

79680 
compLe·
.
›
 = 
TK_GE
;

79681 
compLe·
.
pLe·
 = &
ex¥X
;

79682 
compLe·
.
pRight
 = 
pEx¥
->
x
.
pLi°
->
a
[0].pExpr;

79683 
compRight
.
›
 = 
TK_LE
;

79684 
compRight
.
pLe·
 = &
ex¥X
;

79685 
compRight
.
pRight
 = 
pEx¥
->
x
.
pLi°
->
a
[1].pExpr;

79686 
	`ex¥ToRegi°î
(&
ex¥X
, 
	`sqlôe3Ex¥CodeTemp
(
pP¨£
, &ex¥X, &
ªgFªe1
));

79687 if–
jumpIfTrue
 ){

79688 
	`sqlôe3Ex¥IfTrue
(
pP¨£
, &
ex¥And
, 
de°
, 
jumpIfNuŒ
);

79690 
	`sqlôe3Ex¥IfFÆ£
(
pP¨£
, &
ex¥And
, 
de°
, 
jumpIfNuŒ
);

79692 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
ªgFªe1
);

79695 
	`ã°ˇ£
–
jumpIfTrue
==0 && 
jumpIfNuŒ
==0 && 
ªgFªe1
==0 );

79696 
	`ã°ˇ£
–
jumpIfTrue
==0 && 
jumpIfNuŒ
==0 && 
ªgFªe1
!=0 );

79697 
	`ã°ˇ£
–
jumpIfTrue
==0 && 
jumpIfNuŒ
!=0 && 
ªgFªe1
==0 );

79698 
	`ã°ˇ£
–
jumpIfTrue
==0 && 
jumpIfNuŒ
!=0 && 
ªgFªe1
!=0 );

79699 
	`ã°ˇ£
–
jumpIfTrue
!=0 && 
jumpIfNuŒ
==0 && 
ªgFªe1
==0 );

79700 
	`ã°ˇ£
–
jumpIfTrue
!=0 && 
jumpIfNuŒ
==0 && 
ªgFªe1
!=0 );

79701 
	`ã°ˇ£
–
jumpIfTrue
!=0 && 
jumpIfNuŒ
!=0 && 
ªgFªe1
==0 );

79702 
	`ã°ˇ£
–
jumpIfTrue
!=0 && 
jumpIfNuŒ
!=0 && 
ªgFªe1
!=0 );

79719 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥IfTrue
(
P¨£
 *
pP¨£
, 
Ex¥
 *
pEx¥
, 
de°
, 
jumpIfNuŒ
){

79720 
Vdbe
 *
v
 = 
pP¨£
->
pVdbe
;

79721 
›
 = 0;

79722 
ªgFªe1
 = 0;

79723 
ªgFªe2
 = 0;

79724 
r1
, 
r2
;

79726 
	`as£π
–
jumpIfNuŒ
==
SQLITE_JUMPIFNULL
 || jumpIfNull==0 );

79727 if–
	`NEVER
(
v
==0) ) ;

79728 if–
	`NEVER
(
pEx¥
==0) ) ;

79729 
›
 = 
pEx¥
->op;

79730  
›
 ){

79731 
TK_AND
: {

79732 
d2
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

79733 
	`ã°ˇ£
–
jumpIfNuŒ
==0 );

79734 
	`sqlôe3Ex¥CachePush
(
pP¨£
);

79735 
	`sqlôe3Ex¥IfFÆ£
(
pP¨£
, 
pEx¥
->
pLe·
, 
d2
,
jumpIfNuŒ
^
SQLITE_JUMPIFNULL
);

79736 
	`sqlôe3Ex¥IfTrue
(
pP¨£
, 
pEx¥
->
pRight
, 
de°
, 
jumpIfNuŒ
);

79737 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
d2
);

79738 
	`sqlôe3Ex¥CacheP›
(
pP¨£
, 1);

79741 
TK_OR
: {

79742 
	`ã°ˇ£
–
jumpIfNuŒ
==0 );

79743 
	`sqlôe3Ex¥IfTrue
(
pP¨£
, 
pEx¥
->
pLe·
, 
de°
, 
jumpIfNuŒ
);

79744 
	`sqlôe3Ex¥IfTrue
(
pP¨£
, 
pEx¥
->
pRight
, 
de°
, 
jumpIfNuŒ
);

79747 
TK_NOT
: {

79748 
	`ã°ˇ£
–
jumpIfNuŒ
==0 );

79749 
	`sqlôe3Ex¥IfFÆ£
(
pP¨£
, 
pEx¥
->
pLe·
, 
de°
, 
jumpIfNuŒ
);

79752 
TK_LT
:

79753 
TK_LE
:

79754 
TK_GT
:

79755 
TK_GE
:

79756 
TK_NE
:

79757 
TK_EQ
: {

79758 
	`as£π
–
TK_LT
==
OP_Lt
 );

79759 
	`as£π
–
TK_LE
==
OP_Le
 );

79760 
	`as£π
–
TK_GT
==
OP_Gt
 );

79761 
	`as£π
–
TK_GE
==
OP_Ge
 );

79762 
	`as£π
–
TK_EQ
==
OP_Eq
 );

79763 
	`as£π
–
TK_NE
==
OP_Ne
 );

79764 
	`ã°ˇ£
–
›
==
TK_LT
 );

79765 
	`ã°ˇ£
–
›
==
TK_LE
 );

79766 
	`ã°ˇ£
–
›
==
TK_GT
 );

79767 
	`ã°ˇ£
–
›
==
TK_GE
 );

79768 
	`ã°ˇ£
–
›
==
TK_EQ
 );

79769 
	`ã°ˇ£
–
›
==
TK_NE
 );

79770 
	`ã°ˇ£
–
jumpIfNuŒ
==0 );

79771 
r1
 = 
	`sqlôe3Ex¥CodeTemp
(
pP¨£
, 
pEx¥
->
pLe·
, &
ªgFªe1
);

79772 
r2
 = 
	`sqlôe3Ex¥CodeTemp
(
pP¨£
, 
pEx¥
->
pRight
, &
ªgFªe2
);

79773 
	`codeCom∑ª
(
pP¨£
, 
pEx¥
->
pLe·
,ÖEx¥->
pRight
, 
›
,

79774 
r1
, 
r2
, 
de°
, 
jumpIfNuŒ
);

79775 
	`ã°ˇ£
–
ªgFªe1
==0 );

79776 
	`ã°ˇ£
–
ªgFªe2
==0 );

79779 
TK_IS
:

79780 
TK_ISNOT
: {

79781 
	`ã°ˇ£
–
›
==
TK_IS
 );

79782 
	`ã°ˇ£
–
›
==
TK_ISNOT
 );

79783 
r1
 = 
	`sqlôe3Ex¥CodeTemp
(
pP¨£
, 
pEx¥
->
pLe·
, &
ªgFªe1
);

79784 
r2
 = 
	`sqlôe3Ex¥CodeTemp
(
pP¨£
, 
pEx¥
->
pRight
, &
ªgFªe2
);

79785 
›
 = (›==
TK_IS
Ë? 
TK_EQ
 : 
TK_NE
;

79786 
	`codeCom∑ª
(
pP¨£
, 
pEx¥
->
pLe·
,ÖEx¥->
pRight
, 
›
,

79787 
r1
, 
r2
, 
de°
, 
SQLITE_NULLEQ
);

79788 
	`ã°ˇ£
–
ªgFªe1
==0 );

79789 
	`ã°ˇ£
–
ªgFªe2
==0 );

79792 
TK_ISNULL
:

79793 
TK_NOTNULL
: {

79794 
	`as£π
–
TK_ISNULL
==
OP_IsNuŒ
 );

79795 
	`as£π
–
TK_NOTNULL
==
OP_NŸNuŒ
 );

79796 
	`ã°ˇ£
–
›
==
TK_ISNULL
 );

79797 
	`ã°ˇ£
–
›
==
TK_NOTNULL
 );

79798 
r1
 = 
	`sqlôe3Ex¥CodeTemp
(
pP¨£
, 
pEx¥
->
pLe·
, &
ªgFªe1
);

79799 
	`sqlôe3VdbeAddOp2
(
v
, 
›
, 
r1
, 
de°
);

79800 
	`ã°ˇ£
–
ªgFªe1
==0 );

79803 
TK_BETWEEN
: {

79804 
	`ã°ˇ£
–
jumpIfNuŒ
==0 );

79805 
	`ex¥CodeBëwìn
(
pP¨£
, 
pEx¥
, 
de°
, 1, 
jumpIfNuŒ
);

79808 #i‚de‡
SQLITE_OMIT_SUBQUERY


79809 
TK_IN
: {

79810 
de°IfFÆ£
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

79811 
de°IfNuŒ
 = 
jumpIfNuŒ
 ? 
de°
 : 
de°IfFÆ£
;

79812 
	`sqlôe3Ex¥CodeIN
(
pP¨£
, 
pEx¥
, 
de°IfFÆ£
, 
de°IfNuŒ
);

79813 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_GŸo
, 0, 
de°
);

79814 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
de°IfFÆ£
);

79819 
r1
 = 
	`sqlôe3Ex¥CodeTemp
(
pP¨£
, 
pEx¥
, &
ªgFªe1
);

79820 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_If
, 
r1
, 
de°
, 
jumpIfNuŒ
!=0);

79821 
	`ã°ˇ£
–
ªgFªe1
==0 );

79822 
	`ã°ˇ£
–
jumpIfNuŒ
==0 );

79826 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
ªgFªe1
);

79827 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
ªgFªe2
);

79839 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥IfFÆ£
(
P¨£
 *
pP¨£
, 
Ex¥
 *
pEx¥
, 
de°
, 
jumpIfNuŒ
){

79840 
Vdbe
 *
v
 = 
pP¨£
->
pVdbe
;

79841 
›
 = 0;

79842 
ªgFªe1
 = 0;

79843 
ªgFªe2
 = 0;

79844 
r1
, 
r2
;

79846 
	`as£π
–
jumpIfNuŒ
==
SQLITE_JUMPIFNULL
 || jumpIfNull==0 );

79847 if–
	`NEVER
(
v
==0) ) ;

79848 if–
pEx¥
==0 ) ;

79868 
›
 = ((
pEx¥
->›+(
TK_ISNULL
&1))^1)-(TK_ISNULL&1);

79872 
	`as£π
–
pEx¥
->
›
!=
TK_ISNULL
 || op==
OP_NŸNuŒ
 );

79873 
	`as£π
–
pEx¥
->
›
!=
TK_NOTNULL
 || op==
OP_IsNuŒ
 );

79874 
	`as£π
–
pEx¥
->
›
!=
TK_NE
 || op==
OP_Eq
 );

79875 
	`as£π
–
pEx¥
->
›
!=
TK_EQ
 || op==
OP_Ne
 );

79876 
	`as£π
–
pEx¥
->
›
!=
TK_LT
 || op==
OP_Ge
 );

79877 
	`as£π
–
pEx¥
->
›
!=
TK_LE
 || op==
OP_Gt
 );

79878 
	`as£π
–
pEx¥
->
›
!=
TK_GT
 || op==
OP_Le
 );

79879 
	`as£π
–
pEx¥
->
›
!=
TK_GE
 || op==
OP_Lt
 );

79881  
pEx¥
->
›
 ){

79882 
TK_AND
: {

79883 
	`ã°ˇ£
–
jumpIfNuŒ
==0 );

79884 
	`sqlôe3Ex¥IfFÆ£
(
pP¨£
, 
pEx¥
->
pLe·
, 
de°
, 
jumpIfNuŒ
);

79885 
	`sqlôe3Ex¥IfFÆ£
(
pP¨£
, 
pEx¥
->
pRight
, 
de°
, 
jumpIfNuŒ
);

79888 
TK_OR
: {

79889 
d2
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

79890 
	`ã°ˇ£
–
jumpIfNuŒ
==0 );

79891 
	`sqlôe3Ex¥CachePush
(
pP¨£
);

79892 
	`sqlôe3Ex¥IfTrue
(
pP¨£
, 
pEx¥
->
pLe·
, 
d2
, 
jumpIfNuŒ
^
SQLITE_JUMPIFNULL
);

79893 
	`sqlôe3Ex¥IfFÆ£
(
pP¨£
, 
pEx¥
->
pRight
, 
de°
, 
jumpIfNuŒ
);

79894 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
d2
);

79895 
	`sqlôe3Ex¥CacheP›
(
pP¨£
, 1);

79898 
TK_NOT
: {

79899 
	`ã°ˇ£
–
jumpIfNuŒ
==0 );

79900 
	`sqlôe3Ex¥IfTrue
(
pP¨£
, 
pEx¥
->
pLe·
, 
de°
, 
jumpIfNuŒ
);

79903 
TK_LT
:

79904 
TK_LE
:

79905 
TK_GT
:

79906 
TK_GE
:

79907 
TK_NE
:

79908 
TK_EQ
: {

79909 
	`ã°ˇ£
–
›
==
TK_LT
 );

79910 
	`ã°ˇ£
–
›
==
TK_LE
 );

79911 
	`ã°ˇ£
–
›
==
TK_GT
 );

79912 
	`ã°ˇ£
–
›
==
TK_GE
 );

79913 
	`ã°ˇ£
–
›
==
TK_EQ
 );

79914 
	`ã°ˇ£
–
›
==
TK_NE
 );

79915 
	`ã°ˇ£
–
jumpIfNuŒ
==0 );

79916 
r1
 = 
	`sqlôe3Ex¥CodeTemp
(
pP¨£
, 
pEx¥
->
pLe·
, &
ªgFªe1
);

79917 
r2
 = 
	`sqlôe3Ex¥CodeTemp
(
pP¨£
, 
pEx¥
->
pRight
, &
ªgFªe2
);

79918 
	`codeCom∑ª
(
pP¨£
, 
pEx¥
->
pLe·
,ÖEx¥->
pRight
, 
›
,

79919 
r1
, 
r2
, 
de°
, 
jumpIfNuŒ
);

79920 
	`ã°ˇ£
–
ªgFªe1
==0 );

79921 
	`ã°ˇ£
–
ªgFªe2
==0 );

79924 
TK_IS
:

79925 
TK_ISNOT
: {

79926 
	`ã°ˇ£
–
pEx¥
->
›
==
TK_IS
 );

79927 
	`ã°ˇ£
–
pEx¥
->
›
==
TK_ISNOT
 );

79928 
r1
 = 
	`sqlôe3Ex¥CodeTemp
(
pP¨£
, 
pEx¥
->
pLe·
, &
ªgFªe1
);

79929 
r2
 = 
	`sqlôe3Ex¥CodeTemp
(
pP¨£
, 
pEx¥
->
pRight
, &
ªgFªe2
);

79930 
›
 = (
pEx¥
->›==
TK_IS
Ë? 
TK_NE
 : 
TK_EQ
;

79931 
	`codeCom∑ª
(
pP¨£
, 
pEx¥
->
pLe·
,ÖEx¥->
pRight
, 
›
,

79932 
r1
, 
r2
, 
de°
, 
SQLITE_NULLEQ
);

79933 
	`ã°ˇ£
–
ªgFªe1
==0 );

79934 
	`ã°ˇ£
–
ªgFªe2
==0 );

79937 
TK_ISNULL
:

79938 
TK_NOTNULL
: {

79939 
	`ã°ˇ£
–
›
==
TK_ISNULL
 );

79940 
	`ã°ˇ£
–
›
==
TK_NOTNULL
 );

79941 
r1
 = 
	`sqlôe3Ex¥CodeTemp
(
pP¨£
, 
pEx¥
->
pLe·
, &
ªgFªe1
);

79942 
	`sqlôe3VdbeAddOp2
(
v
, 
›
, 
r1
, 
de°
);

79943 
	`ã°ˇ£
–
ªgFªe1
==0 );

79946 
TK_BETWEEN
: {

79947 
	`ã°ˇ£
–
jumpIfNuŒ
==0 );

79948 
	`ex¥CodeBëwìn
(
pP¨£
, 
pEx¥
, 
de°
, 0, 
jumpIfNuŒ
);

79951 #i‚de‡
SQLITE_OMIT_SUBQUERY


79952 
TK_IN
: {

79953 if–
jumpIfNuŒ
 ){

79954 
	`sqlôe3Ex¥CodeIN
(
pP¨£
, 
pEx¥
, 
de°
, dest);

79956 
de°IfNuŒ
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

79957 
	`sqlôe3Ex¥CodeIN
(
pP¨£
, 
pEx¥
, 
de°
, 
de°IfNuŒ
);

79958 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
de°IfNuŒ
);

79964 
r1
 = 
	`sqlôe3Ex¥CodeTemp
(
pP¨£
, 
pEx¥
, &
ªgFªe1
);

79965 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_IfNŸ
, 
r1
, 
de°
, 
jumpIfNuŒ
!=0);

79966 
	`ã°ˇ£
–
ªgFªe1
==0 );

79967 
	`ã°ˇ£
–
jumpIfNuŒ
==0 );

79971 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
ªgFªe1
);

79972 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
ªgFªe2
);

79997 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥Com∑ª
(
Ex¥
 *
pA
, Ex¥ *
pB
, 
iTab
){

79998 if–
pA
==0||
pB
==0 ){

79999  
pB
==
pA
 ? 0 : 2;

80001 
	`as£π
–!
	`Ex¥HasPr›îty
(
pA
, 
EP_TokíO∆y
|
EP_Redu˚d
) );

80002 
	`as£π
–!
	`Ex¥HasPr›îty
(
pB
, 
EP_TokíO∆y
|
EP_Redu˚d
) );

80003 if–
	`Ex¥HasPr›îty
(
pA
, 
EP_xIsSñe˘
Ë|| Ex¥HasPr›îty(
pB
, EP_xIsSelect) ){

80006 if–(
pA
->
Êags
 & 
EP_Di°ö˘
)!=(
pB
->flags & EP_Distinct) )  2;

80007 if–
pA
->
›
!=
pB
->› && (pA->›!=
TK_REGISTER
 ||ÖA->
›2
!=pB->op) ){

80008 if–
pA
->
›
==
TK_COLLATE
 && 
	`sqlôe3Ex¥Com∑ª
’A->
pLe·
, 
pB
, 
iTab
)<2 ){

80011 if–
pB
->
›
==
TK_COLLATE
 && 
	`sqlôe3Ex¥Com∑ª
(
pA
,ÖB->
pLe·
, 
iTab
)<2 ){

80016 if–
	`sqlôe3Ex¥Com∑ª
(
pA
->
pLe·
, 
pB
->pLe·, 
iTab
) )  2;

80017 if–
	`sqlôe3Ex¥Com∑ª
(
pA
->
pRight
, 
pB
->pRight, 
iTab
) )  2;

80018 if–
	`sqlôe3Ex¥Li°Com∑ª
(
pA
->
x
.
pLi°
, 
pB
->x.pLi°, 
iTab
) )  2;

80019 if–
pA
->
iCﬁumn
!=
pB
->iColumn )  2;

80020 if–
pA
->
iTabÀ
!=
pB
->iTable

80021 && 
pA
->
›
!=
TK_REGISTER


80022 && (
pA
->
iTabÀ
!=
iTab
 || 
	`NEVER
(
pB
->iTable>=0)) )  2;

80023 if–
	`Ex¥HasPr›îty
(
pA
, 
EP_I¡VÆue
) ){

80024 if–!
	`Ex¥HasPr›îty
(
pB
, 
EP_I¡VÆue
Ë|| 
pA
->
u
.
iVÆue
!=pB->u.iValue ){

80027 }if–
pA
->
›
!=
TK_COLUMN
 && 
	`ALWAYS
’A->›!=
TK_AGG_COLUMN
Ë&&ÖA->
u
.
zTokí
){

80028 if–
	`Ex¥HasPr›îty
(
pB
, 
EP_I¡VÆue
Ë|| 
	`NEVER
’B->
u
.
zTokí
==0) )  2;

80029 if–
	`°rcmp
(
pA
->
u
.
zTokí
,
pB
->u.zToken)!=0 ){

80030  
pA
->
›
==
TK_COLLATE
 ? 1 : 2;

80051 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥Li°Com∑ª
(
Ex¥Li°
 *
pA
, Ex¥Li° *
pB
, 
iTab
){

80052 
i
;

80053 if–
pA
==0 && 
pB
==0 )  0;

80054 if–
pA
==0 || 
pB
==0 )  1;

80055 if–
pA
->
nEx¥
!=
pB
->nExpr )  1;

80056 
i
=0; i<
pA
->
nEx¥
; i++){

80057 
Ex¥
 *
pEx¥A
 = 
pA
->
a
[
i
].
pEx¥
;

80058 
Ex¥
 *
pEx¥B
 = 
pB
->
a
[
i
].
pEx¥
;

80059 if–
pA
->
a
[
i
].
s‹tOrdî
!=
pB
->a[i].sortOrder )  1;

80060 if–
	`sqlôe3Ex¥Com∑ª
(
pEx¥A
, 
pEx¥B
, 
iTab
) )  1;

80085 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥Im∂õsEx¥
(
Ex¥
 *
pE1
, Ex¥ *
pE2
, 
iTab
){

80086 if–
	`sqlôe3Ex¥Com∑ª
(
pE1
, 
pE2
, 
iTab
)==0 ){

80089 if–
pE2
->
›
==
TK_OR


80090 && (
	`sqlôe3Ex¥Im∂õsEx¥
(
pE1
, 
pE2
->
pLe·
, 
iTab
)

80091 || 
	`sqlôe3Ex¥Im∂õsEx¥
(
pE1
, 
pE2
->
pRight
, 
iTab
) )

80095 if–
pE2
->
›
==
TK_NOTNULL


80096 && 
	`sqlôe3Ex¥Com∑ª
(
pE1
->
pLe·
, 
pE2
->pLe·, 
iTab
)==0

80097 && (
pE1
->
›
!=
TK_ISNULL
 &&ÖE1->›!=
TK_IS
)

80110 
	sSrcCou¡
 {

80111 
SrcLi°
 *
pSrc
;

80112 
nThis
;

80113 
nOthî
;

80119 
	`ex¥SrcCou¡
(
WÆkî
 *
pWÆkî
, 
Ex¥
 *
pEx¥
){

80125 if–
pEx¥
->
›
==
TK_COLUMN
 || 
	`NEVER
’Ex¥->›==
TK_AGG_COLUMN
) ){

80126 
i
;

80127 
SrcCou¡
 *
p
 = 
pWÆkî
->
u
.
pSrcCou¡
;

80128 
SrcLi°
 *
pSrc
 = 
p
->pSrc;

80129 
i
=0; i<
pSrc
->
nSrc
; i++){

80130 if–
pEx¥
->
iTabÀ
==
pSrc
->
a
[
i
].
iCurs‹
 ) ;

80132 if–
i
<
pSrc
->
nSrc
 ){

80133 
p
->
nThis
++;

80135 
p
->
nOthî
++;

80138  
WRC_C⁄töue
;

80147 
SQLITE_PRIVATE
 
	`sqlôe3Fun˘i⁄U£sThisSrc
(
Ex¥
 *
pEx¥
, 
SrcLi°
 *
pSrcLi°
){

80148 
WÆkî
 
w
;

80149 
SrcCou¡
 
˙t
;

80150 
	`as£π
–
pEx¥
->
›
==
TK_AGG_FUNCTION
 );

80151 
	`mem£t
(&
w
, 0, (w));

80152 
w
.
xEx¥CÆlback
 = 
ex¥SrcCou¡
;

80153 
w
.
u
.
pSrcCou¡
 = &
˙t
;

80154 
˙t
.
pSrc
 = 
pSrcLi°
;

80155 
˙t
.
nThis
 = 0;

80156 
˙t
.
nOthî
 = 0;

80157 
	`sqlôe3WÆkEx¥Li°
(&
w
, 
pEx¥
->
x
.
pLi°
);

80158  
˙t
.
nThis
>0 || c¡.
nOthî
==0;

80165 
	`addAggInfoCﬁumn
(
sqlôe3
 *
db
, 
AggInfo
 *
pInfo
){

80166 
i
;

80167 
pInfo
->
aCﬁ
 = 
	`sqlôe3AºayAŒoˇã
(

80168 
db
,

80169 
pInfo
->
aCﬁ
,

80170 (
pInfo
->
aCﬁ
[0]),

80171 &
pInfo
->
nCﬁumn
,

80172 &
i


80174  
i
;

80181 
	`addAggInfoFunc
(
sqlôe3
 *
db
, 
AggInfo
 *
pInfo
){

80182 
i
;

80183 
pInfo
->
aFunc
 = 
	`sqlôe3AºayAŒoˇã
(

80184 
db
,

80185 
pInfo
->
aFunc
,

80186 (
pInfo
->
aFunc
[0]),

80187 &
pInfo
->
nFunc
,

80188 &
i


80190  
i
;

80198 
	`™ÆyzeAggªg©e
(
WÆkî
 *
pWÆkî
, 
Ex¥
 *
pEx¥
){

80199 
i
;

80200 
NameC⁄ãxt
 *
pNC
 = 
pWÆkî
->
u
.pNC;

80201 
P¨£
 *
pP¨£
 = 
pNC
->pParse;

80202 
SrcLi°
 *
pSrcLi°
 = 
pNC
->pSrcList;

80203 
AggInfo
 *
pAggInfo
 = 
pNC
->pAggInfo;

80205  
pEx¥
->
›
 ){

80206 
TK_AGG_COLUMN
:

80207 
TK_COLUMN
: {

80208 
	`ã°ˇ£
–
pEx¥
->
›
==
TK_AGG_COLUMN
 );

80209 
	`ã°ˇ£
–
pEx¥
->
›
==
TK_COLUMN
 );

80212 if–
	`ALWAYS
(
pSrcLi°
!=0) ){

80213 
SrcLi°_ôem
 *
pIãm
 = 
pSrcLi°
->
a
;

80214 
i
=0; i<
pSrcLi°
->
nSrc
; i++, 
pIãm
++){

80215 
AggInfo_cﬁ
 *
pCﬁ
;

80216 
	`as£π
–!
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_TokíO∆y
|
EP_Redu˚d
) );

80217 if–
pEx¥
->
iTabÀ
==
pIãm
->
iCurs‹
 ){

80224 
k
;

80225 
pCﬁ
 = 
pAggInfo
->
aCﬁ
;

80226 
k
=0; k<
pAggInfo
->
nCﬁumn
; k++, 
pCﬁ
++){

80227 if–
pCﬁ
->
iTabÀ
==
pEx¥
->iTable &&

80228 
pCﬁ
->
iCﬁumn
==
pEx¥
->iColumn ){

80232 if–(
k
>=
pAggInfo
->
nCﬁumn
)

80233 && (
k
 = 
	`addAggInfoCﬁumn
(
pP¨£
->
db
, 
pAggInfo
))>=0

80235 
pCﬁ
 = &
pAggInfo
->
aCﬁ
[
k
];

80236 
pCﬁ
->
pTab
 = 
pEx¥
->pTab;

80237 
pCﬁ
->
iTabÀ
 = 
pEx¥
->iTable;

80238 
pCﬁ
->
iCﬁumn
 = 
pEx¥
->iColumn;

80239 
pCﬁ
->
iMem
 = ++
pP¨£
->
nMem
;

80240 
pCﬁ
->
iS‹ãrCﬁumn
 = -1;

80241 
pCﬁ
->
pEx¥
 =ÖExpr;

80242 if–
pAggInfo
->
pGroupBy
 ){

80243 
j
, 
n
;

80244 
Ex¥Li°
 *
pGB
 = 
pAggInfo
->
pGroupBy
;

80245 
Ex¥Li°_ôem
 *
pTîm
 = 
pGB
->
a
;

80246 
n
 = 
pGB
->
nEx¥
;

80247 
j
=0; j<
n
; j++, 
pTîm
++){

80248 
Ex¥
 *
pE
 = 
pTîm
->
pEx¥
;

80249 if–
pE
->
›
==
TK_COLUMN
 &&ÖE->
iTabÀ
==
pEx¥
->iTable &&

80250 
pE
->
iCﬁumn
==
pEx¥
->iColumn ){

80251 
pCﬁ
->
iS‹ãrCﬁumn
 = 
j
;

80256 if–
pCﬁ
->
iS‹ãrCﬁumn
<0 ){

80257 
pCﬁ
->
iS‹ãrCﬁumn
 = 
pAggInfo
->
nS‹tögCﬁumn
++;

80265 
	`Ex¥SëVVAPr›îty
(
pEx¥
, 
EP_NoRedu˚
);

80266 
pEx¥
->
pAggInfo
 =ÖAggInfo;

80267 
pEx¥
->
›
 = 
TK_AGG_COLUMN
;

80268 
pEx¥
->
iAgg
 = (
i16
)
k
;

80273  
WRC_Pru√
;

80275 
TK_AGG_FUNCTION
: {

80276 if–(
pNC
->
ncFœgs
 & 
NC_InAggFunc
)==0

80277 && 
pWÆkî
->
wÆkîDïth
==
pEx¥
->
›2


80282 
AggInfo_func
 *
pIãm
 = 
pAggInfo
->
aFunc
;

80283 
i
=0; i<
pAggInfo
->
nFunc
; i++, 
pIãm
++){

80284 if–
	`sqlôe3Ex¥Com∑ª
(
pIãm
->
pEx¥
,ÖExpr, -1)==0 ){

80288 if–
i
>=
pAggInfo
->
nFunc
 ){

80291 
u8
 
íc
 = 
	`ENC
(
pP¨£
->
db
);

80292 
i
 = 
	`addAggInfoFunc
(
pP¨£
->
db
, 
pAggInfo
);

80293 if–
i
>=0 ){

80294 
	`as£π
–!
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_xIsSñe˘
) );

80295 
pIãm
 = &
pAggInfo
->
aFunc
[
i
];

80296 
pIãm
->
pEx¥
 =ÖExpr;

80297 
pIãm
->
iMem
 = ++
pP¨£
->
nMem
;

80298 
	`as£π
–!
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_I¡VÆue
) );

80299 
pIãm
->
pFunc
 = 
	`sqlôe3FödFun˘i⁄
(
pP¨£
->
db
,

80300 
pEx¥
->
u
.
zTokí
, 
	`sqlôe3SåÀn30
(pExpr->u.zToken),

80301 
pEx¥
->
x
.
pLi°
 ?ÖEx¥->x.pLi°->
nEx¥
 : 0, 
íc
, 0);

80302 if–
pEx¥
->
Êags
 & 
EP_Di°ö˘
 ){

80303 
pIãm
->
iDi°ö˘
 = 
pP¨£
->
nTab
++;

80305 
pIãm
->
iDi°ö˘
 = -1;

80311 
	`as£π
–!
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_TokíO∆y
|
EP_Redu˚d
) );

80312 
	`Ex¥SëVVAPr›îty
(
pEx¥
, 
EP_NoRedu˚
);

80313 
pEx¥
->
iAgg
 = (
i16
)
i
;

80314 
pEx¥
->
pAggInfo
 =ÖAggInfo;

80315  
WRC_Pru√
;

80317  
WRC_C⁄töue
;

80321  
WRC_C⁄töue
;

80323 
	`™ÆyzeAggªg©esInSñe˘
(
WÆkî
 *
pWÆkî
, 
Sñe˘
 *
pSñe˘
){

80324 
	`UNUSED_PARAMETER
(
pWÆkî
);

80325 
	`UNUSED_PARAMETER
(
pSñe˘
);

80326  
WRC_C⁄töue
;

80338 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥A«lyzeAggªg©es
(
NameC⁄ãxt
 *
pNC
, 
Ex¥
 *
pEx¥
){

80339 
WÆkî
 
w
;

80340 
	`mem£t
(&
w
, 0, (w));

80341 
w
.
xEx¥CÆlback
 = 
™ÆyzeAggªg©e
;

80342 
w
.
xSñe˘CÆlback
 = 
™ÆyzeAggªg©esInSñe˘
;

80343 
w
.
u
.
pNC
 =ÖNC;

80344 
	`as£π
–
pNC
->
pSrcLi°
!=0 );

80345 
	`sqlôe3WÆkEx¥
(&
w
, 
pEx¥
);

80354 
SQLITE_PRIVATE
 
	`sqlôe3Ex¥A«lyzeAggLi°
(
NameC⁄ãxt
 *
pNC
, 
Ex¥Li°
 *
pLi°
){

80355 
Ex¥Li°_ôem
 *
pIãm
;

80356 
i
;

80357 if–
pLi°
 ){

80358 
pIãm
=
pLi°
->
a
, 
i
=0; i<pLi°->
nEx¥
; i++,ÖItem++){

80359 
	`sqlôe3Ex¥A«lyzeAggªg©es
(
pNC
, 
pIãm
->
pEx¥
);

80367 
SQLITE_PRIVATE
 
	`sqlôe3GëTempReg
(
P¨£
 *
pP¨£
){

80368 if–
pP¨£
->
nTempReg
==0 ){

80369  ++
pP¨£
->
nMem
;

80371  
pP¨£
->
aTempReg
[--pP¨£->
nTempReg
];

80382 
SQLITE_PRIVATE
 
	`sqlôe3Rñó£TempReg
(
P¨£
 *
pP¨£
, 
iReg
){

80383 if–
iReg
 && 
pP¨£
->
nTempReg
<
	`AºaySize
’P¨£->
aTempReg
) ){

80384 
i
;

80385 
yCﬁCache
 *
p
;

80386 
i
=0, 
p
=
pP¨£
->
aCﬁCache
; i<
SQLITE_N_COLCACHE
; i++,Ö++){

80387 if–
p
->
iReg
==iReg ){

80388 
p
->
ãmpReg
 = 1;

80392 
pP¨£
->
aTempReg
[pP¨£->
nTempReg
++] = 
iReg
;

80399 
SQLITE_PRIVATE
 
	`sqlôe3GëTempR™ge
(
P¨£
 *
pP¨£
, 
nReg
){

80400 
i
, 
n
;

80401 
i
 = 
pP¨£
->
iR™geReg
;

80402 
n
 = 
pP¨£
->
nR™geReg
;

80403 if–
nReg
<=
n
 ){

80404 
	`as£π
–!
	`u£dAsCﬁumnCache
(
pP¨£
, 
i
, i+
n
-1) );

80405 
pP¨£
->
iR™geReg
 +
nReg
;

80406 
pP¨£
->
nR™geReg
 -
nReg
;

80408 
i
 = 
pP¨£
->
nMem
+1;

80409 
pP¨£
->
nMem
 +
nReg
;

80411  
i
;

80413 
SQLITE_PRIVATE
 
	`sqlôe3Rñó£TempR™ge
(
P¨£
 *
pP¨£
, 
iReg
, 
nReg
){

80414 
	`sqlôe3Ex¥CacheRemove
(
pP¨£
, 
iReg
, 
nReg
);

80415 if–
nReg
>
pP¨£
->
nR™geReg
 ){

80416 
pP¨£
->
nR™geReg
 = 
nReg
;

80417 
pP¨£
->
iR™geReg
 = 
iReg
;

80424 
SQLITE_PRIVATE
 
	`sqlôe3CÀ¨TempRegCache
(
P¨£
 *
pP¨£
){

80425 
pP¨£
->
nTempReg
 = 0;

80426 
pP¨£
->
nR™geReg
 = 0;

80450 #i‚de‡
SQLITE_OMIT_ALTERTABLE


80466 
	`ª«meTabÀFunc
(

80467 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

80468 
NŸU£d
,

80469 
sqlôe3_vÆue
 **
¨gv


80471 c⁄° *
zSql
 = 
	`sqlôe3_vÆue_ãxt
(
¨gv
[0]);

80472 c⁄° *
zTabÀName
 = 
	`sqlôe3_vÆue_ãxt
(
¨gv
[1]);

80474 
tokí
;

80475 
Tokí
 
äame
;

80476 c⁄° *
zC§
 = 
zSql
;

80477 
Àn
 = 0;

80478 *
zRë
;

80480 
sqlôe3
 *
db
 = 
	`sqlôe3_c⁄ãxt_db_h™dÀ
(
c⁄ãxt
);

80482 
	`UNUSED_PARAMETER
(
NŸU£d
);

80488 if–
zSql
 ){

80490 if–!*
zC§
 ){

80496 
äame
.
z
 = (*)
zC§
;

80497 
äame
.
n
 = 
Àn
;

80503 
zC§
 +
Àn
;

80504 
Àn
 = 
	`sqlôe3GëTokí
(
zC§
, &
tokí
);

80505 }  
tokí
==
TK_SPACE
 );

80506 
	`as£π
–
Àn
>0 );

80507 }  
tokí
!=
TK_LP
 &&Åokí!=
TK_USING
 );

80509 
zRë
 = 
	`sqlôe3MPrötf
(
db
, "%.*s\"%w\"%s", ((
u8
*)
äame
.
z
Ë- 
zSql
, zSql,

80510 
zTabÀName
, 
äame
.
z
+äame.
n
);

80511 
	`sqlôe3_ªsu…_ãxt
(
c⁄ãxt
, 
zRë
, -1, 
SQLITE_DYNAMIC
);

80530 #i‚de‡
SQLITE_OMIT_FOREIGN_KEY


80531 
	`ª«meP¨ítFunc
(

80532 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

80533 
NŸU£d
,

80534 
sqlôe3_vÆue
 **
¨gv


80536 
sqlôe3
 *
db
 = 
	`sqlôe3_c⁄ãxt_db_h™dÀ
(
c⁄ãxt
);

80537 *
zOuçut
 = 0;

80538 *
zResu…
;

80539 c⁄° *
zI≈ut
 = 
	`sqlôe3_vÆue_ãxt
(
¨gv
[0]);

80540 c⁄° *
zOld
 = 
	`sqlôe3_vÆue_ãxt
(
¨gv
[1]);

80541 c⁄° *
zNew
 = 
	`sqlôe3_vÆue_ãxt
(
¨gv
[2]);

80543 c⁄° *
z
;

80544 
n
;

80545 
tokí
;

80547 
	`UNUSED_PARAMETER
(
NŸU£d
);

80548 
z
=
zI≈ut
; *z; z=z+
n
){

80549 
n
 = 
	`sqlôe3GëTokí
(
z
, &
tokí
);

80550 if–
tokí
==
TK_REFERENCES
 ){

80551 *
zP¨ít
;

80553 
z
 +
n
;

80554 
n
 = 
	`sqlôe3GëTokí
(
z
, &
tokí
);

80555 } 
tokí
==
TK_SPACE
 );

80557 
zP¨ít
 = 
	`sqlôe3DbSåNDup
(
db
, (c⁄° *)
z
, 
n
);

80558 if–
zP¨ít
==0 ) ;

80559 
	`sqlôe3DequŸe
(
zP¨ít
);

80560 if–0==
	`sqlôe3SåICmp
((c⁄° *)
zOld
, 
zP¨ít
) ){

80561 *
zOut
 = 
	`sqlôe3MPrötf
(
db
, "%s%.*s\"%w\"",

80562 (
zOuçut
?zOuçut:""), 
z
-
zI≈ut
, zI≈ut, (c⁄° *)
zNew


80564 
	`sqlôe3DbFªe
(
db
, 
zOuçut
);

80565 
zOuçut
 = 
zOut
;

80566 
zI≈ut
 = &
z
[
n
];

80568 
	`sqlôe3DbFªe
(
db
, 
zP¨ít
);

80572 
zResu…
 = 
	`sqlôe3MPrötf
(
db
, "%s%s", (
zOuçut
?zOuçut:""), 
zI≈ut
),

80573 
	`sqlôe3_ªsu…_ãxt
(
c⁄ãxt
, 
zResu…
, -1, 
SQLITE_DYNAMIC
);

80574 
	`sqlôe3DbFªe
(
db
, 
zOuçut
);

80578 #i‚de‡
SQLITE_OMIT_TRIGGER


80586 
	`ª«meTriggîFunc
(

80587 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

80588 
NŸU£d
,

80589 
sqlôe3_vÆue
 **
¨gv


80591 c⁄° *
zSql
 = 
	`sqlôe3_vÆue_ãxt
(
¨gv
[0]);

80592 c⁄° *
zTabÀName
 = 
	`sqlôe3_vÆue_ãxt
(
¨gv
[1]);

80594 
tokí
;

80595 
Tokí
 
äame
;

80596 
di°
 = 3;

80597 c⁄° *
zC§
 = 
zSql
;

80598 
Àn
 = 0;

80599 *
zRë
;

80600 
sqlôe3
 *
db
 = 
	`sqlôe3_c⁄ãxt_db_h™dÀ
(
c⁄ãxt
);

80602 
	`UNUSED_PARAMETER
(
NŸU£d
);

80609 if–
zSql
 ){

80612 if–!*
zC§
 ){

80618 
äame
.
z
 = (*)
zC§
;

80619 
äame
.
n
 = 
Àn
;

80625 
zC§
 +
Àn
;

80626 
Àn
 = 
	`sqlôe3GëTokí
(
zC§
, &
tokí
);

80627 } 
tokí
==
TK_SPACE
 );

80628 
	`as£π
–
Àn
>0 );

80639 
di°
++;

80640 if–
tokí
==
TK_DOT
 ||Åokí==
TK_ON
 ){

80641 
di°
 = 0;

80643 }  
di°
!=2 || (
tokí
!=
TK_WHEN
 &&Åokí!=
TK_FOR
 &&Åokí!=
TK_BEGIN
) );

80648 
zRë
 = 
	`sqlôe3MPrötf
(
db
, "%.*s\"%w\"%s", ((
u8
*)
äame
.
z
Ë- 
zSql
, zSql,

80649 
zTabÀName
, 
äame
.
z
+äame.
n
);

80650 
	`sqlôe3_ªsu…_ãxt
(
c⁄ãxt
, 
zRë
, -1, 
SQLITE_DYNAMIC
);

80658 
SQLITE_PRIVATE
 
	`sqlôe3A…îFun˘i⁄s
(){

80659 
SQLITE_WSD
 
FuncDef
 
aA…îTabÀFuncs
[] = {

80660 
	`FUNCTION
(
sqlôe_ª«me_èbÀ
, 2, 0, 0, 
ª«meTabÀFunc
),

80661 #i‚de‡
SQLITE_OMIT_TRIGGER


80662 
	`FUNCTION
(
sqlôe_ª«me_åiggî
, 2, 0, 0, 
ª«meTriggîFunc
),

80664 #i‚de‡
SQLITE_OMIT_FOREIGN_KEY


80665 
	`FUNCTION
(
sqlôe_ª«me_∑ª¡
, 3, 0, 0, 
ª«meP¨ítFunc
),

80668 
i
;

80669 
FuncDefHash
 *
pHash
 = &
	`GLOBAL
(FuncDefHash, 
sqlôe3GlobÆFun˘i⁄s
);

80670 
FuncDef
 *
aFunc
 = (FuncDef*)&
	`GLOBAL
(FuncDef, 
aA…îTabÀFuncs
);

80672 
i
=0; i<
	`AºaySize
(
aA…îTabÀFuncs
); i++){

80673 
	`sqlôe3FuncDefIn£π
(
pHash
, &
aFunc
[
i
]);

80693 *
	`whîeOrName
(
sqlôe3
 *
db
, *
zWhîe
, *
zC⁄°™t
){

80694 *
zNew
;

80695 if–!
zWhîe
 ){

80696 
zNew
 = 
	`sqlôe3MPrötf
(
db
, "«me=%Q", 
zC⁄°™t
);

80698 
zNew
 = 
	`sqlôe3MPrötf
(
db
, "%†ORÇame=%Q", 
zWhîe
, 
zC⁄°™t
);

80699 
	`sqlôe3DbFªe
(
db
, 
zWhîe
);

80701  
zNew
;

80704 #i‡!
	`deföed
(
SQLITE_OMIT_FOREIGN_KEY
Ë&& !deföed(
SQLITE_OMIT_TRIGGER
)

80711 *
	`whîeF‹eignKeys
(
P¨£
 *
pP¨£
, 
TabÀ
 *
pTab
){

80712 
FKey
 *
p
;

80713 *
zWhîe
 = 0;

80714 
p
=
	`sqlôe3FkRe„ªn˚s
(
pTab
);Ö;Öı->
pNextTo
){

80715 
zWhîe
 = 
	`whîeOrName
(
pP¨£
->
db
, zWhîe, 
p
->
pFrom
->
zName
);

80717  
zWhîe
;

80727 *
	`whîeTempTriggîs
(
P¨£
 *
pP¨£
, 
TabÀ
 *
pTab
){

80728 
Triggî
 *
pTrig
;

80729 *
zWhîe
 = 0;

80730 c⁄° 
Schema
 *
pTempSchema
 = 
pP¨£
->
db
->
aDb
[1].
pSchema
;

80737 if–
pTab
->
pSchema
!=
pTempSchema
 ){

80738 
sqlôe3
 *
db
 = 
pP¨£
->db;

80739 
pTrig
=
	`sqlôe3TriggîLi°
(
pP¨£
, 
pTab
);ÖTrig;ÖTrigıTrig->
pNext
){

80740 if–
pTrig
->
pSchema
==
pTempSchema
 ){

80741 
zWhîe
 = 
	`whîeOrName
(
db
, zWhîe, 
pTrig
->
zName
);

80745 if–
zWhîe
 ){

80746 *
zNew
 = 
	`sqlôe3MPrötf
(
pP¨£
->
db
, "ty≥='åiggî' AND (%s)", 
zWhîe
);

80747 
	`sqlôe3DbFªe
(
pP¨£
->
db
, 
zWhîe
);

80748 
zWhîe
 = 
zNew
;

80750  
zWhîe
;

80761 
	`ªlﬂdTabÀSchema
(
P¨£
 *
pP¨£
, 
TabÀ
 *
pTab
, c⁄° *
zName
){

80762 
Vdbe
 *
v
;

80763 *
zWhîe
;

80764 
iDb
;

80765 #i‚de‡
SQLITE_OMIT_TRIGGER


80766 
Triggî
 *
pTrig
;

80769 
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

80770 if–
	`NEVER
(
v
==0) ) ;

80771 
	`as£π
–
	`sqlôe3BåìHﬁdsAŒMuãxes
(
pP¨£
->
db
) );

80772 
iDb
 = 
	`sqlôe3SchemaToIndex
(
pP¨£
->
db
, 
pTab
->
pSchema
);

80773 
	`as£π
–
iDb
>=0 );

80775 #i‚de‡
SQLITE_OMIT_TRIGGER


80777 
pTrig
=
	`sqlôe3TriggîLi°
(
pP¨£
, 
pTab
);ÖTrig;ÖTrigıTrig->
pNext
){

80778 
iTrigDb
 = 
	`sqlôe3SchemaToIndex
(
pP¨£
->
db
, 
pTrig
->
pSchema
);

80779 
	`as£π
–
iTrigDb
==
iDb
 || iTrigDb==1 );

80780 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Dr›Triggî
, 
iTrigDb
, 0, 0, 
pTrig
->
zName
, 0);

80785 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Dr›TabÀ
, 
iDb
, 0, 0, 
pTab
->
zName
, 0);

80788 
zWhîe
 = 
	`sqlôe3MPrötf
(
pP¨£
->
db
, "tbl_«me=%Q", 
zName
);

80789 if–!
zWhîe
 ) ;

80790 
	`sqlôe3VdbeAddP¨£SchemaOp
(
v
, 
iDb
, 
zWhîe
);

80792 #i‚de‡
SQLITE_OMIT_TRIGGER


80796 if–(
zWhîe
=
	`whîeTempTriggîs
(
pP¨£
, 
pTab
))!=0 ){

80797 
	`sqlôe3VdbeAddP¨£SchemaOp
(
v
, 1, 
zWhîe
);

80810 
	`isSy°emTabÀ
(
P¨£
 *
pP¨£
, c⁄° *
zName
){

80811 if–
	`sqlôe3SåÀn30
(
zName
)>6 && 0==
	`sqlôe3SåNICmp
(zName, "sqlite_", 7) ){

80812 
	`sqlôe3Eº‹Msg
(
pP¨£
, "èbÀ %†mayÇŸ bêÆãªd", 
zName
);

80822 
SQLITE_PRIVATE
 
	`sqlôe3A…îRíameTabÀ
(

80823 
P¨£
 *
pP¨£
,

80824 
SrcLi°
 *
pSrc
,

80825 
Tokí
 *
pName


80827 
iDb
;

80828 *
zDb
;

80829 
TabÀ
 *
pTab
;

80830 *
zName
 = 0;

80831 
sqlôe3
 *
db
 = 
pP¨£
->db;

80832 
nTabName
;

80833 c⁄° *
zTabName
;

80834 
Vdbe
 *
v
;

80835 #i‚de‡
SQLITE_OMIT_TRIGGER


80836 *
zWhîe
 = 0;

80838 
VTabÀ
 *
pVTab
 = 0;

80839 
ßvedDbFœgs
;

80841 
ßvedDbFœgs
 = 
db
->
Êags
;

80842 if–
	`NEVER
(
db
->
mÆlocFaûed
ËË
exô_ª«me_èbÀ
;

80843 
	`as£π
–
pSrc
->
nSrc
==1 );

80844 
	`as£π
–
	`sqlôe3BåìHﬁdsAŒMuãxes
(
pP¨£
->
db
) );

80846 
pTab
 = 
	`sqlôe3LoˇãTabÀIãm
(
pP¨£
, 0, &
pSrc
->
a
[0]);

80847 if–!
pTab
 ) 
exô_ª«me_èbÀ
;

80848 
iDb
 = 
	`sqlôe3SchemaToIndex
(
pP¨£
->
db
, 
pTab
->
pSchema
);

80849 
zDb
 = 
db
->
aDb
[
iDb
].
zName
;

80850 
db
->
Êags
 |
SQLITE_Pª„rBuûtö
;

80853 
zName
 = 
	`sqlôe3NameFromTokí
(
db
, 
pName
);

80854 if–!
zName
 ) 
exô_ª«me_èbÀ
;

80859 if–
	`sqlôe3FödTabÀ
(
db
, 
zName
, 
zDb
Ë|| 
	`sqlôe3FödIndex
(db, zName, zDb) ){

80860 
	`sqlôe3Eº‹Msg
(
pP¨£
,

80861 "thîêi†ÆªadyánŸhîÅabÀ o∏ödex wôhÅhi†«me: %s", 
zName
);

80862 
exô_ª«me_èbÀ
;

80868 if–
SQLITE_OK
!=
	`isSy°emTabÀ
(
pP¨£
, 
pTab
->
zName
) ){

80869 
exô_ª«me_èbÀ
;

80871 if–
SQLITE_OK
!=
	`sqlôe3CheckObje˘Name
(
pP¨£
, 
zName
) ){ 

80872 
exô_ª«me_èbÀ
;

80875 #i‚de‡
SQLITE_OMIT_VIEW


80876 if–
pTab
->
pSñe˘
 ){

80877 
	`sqlôe3Eº‹Msg
(
pP¨£
, "võw %†mayÇŸ bêÆãªd", 
pTab
->
zName
);

80878 
exô_ª«me_èbÀ
;

80882 #i‚de‡
SQLITE_OMIT_AUTHORIZATION


80884 if–
	`sqlôe3AuthCheck
(
pP¨£
, 
SQLITE_ALTER_TABLE
, 
zDb
, 
pTab
->
zName
, 0) ){

80885 
exô_ª«me_èbÀ
;

80889 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


80890 if–
	`sqlôe3VõwGëCﬁumnNames
(
pP¨£
, 
pTab
) ){

80891 
exô_ª«me_èbÀ
;

80893 if–
	`IsVútuÆ
(
pTab
) ){

80894 
pVTab
 = 
	`sqlôe3GëVTabÀ
(
db
, 
pTab
);

80895 if–
pVTab
->
pVèb
->
pModuÀ
->
xRíame
==0 ){

80896 
pVTab
 = 0;

80906 
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

80907 if–
v
==0 ){

80908 
exô_ª«me_èbÀ
;

80910 
	`sqlôe3BegöWrôeO≥øti⁄
(
pP¨£
, 
pVTab
!=0, 
iDb
);

80911 
	`sqlôe3Ch™geCookõ
(
pP¨£
, 
iDb
);

80918 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


80919 if–
pVTab
 ){

80920 
i
 = ++
pP¨£
->
nMem
;

80921 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Såög8
, 0, 
i
, 0, 
zName
, 0);

80922 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_VRíame
, 
i
, 0, 0,(c⁄° *)
pVTab
, 
P4_VTAB
);

80923 
	`sqlôe3MayAb‹t
(
pP¨£
);

80928 
zTabName
 = 
pTab
->
zName
;

80929 
nTabName
 = 
	`sqlôe3Utf8Ch¨Lí
(
zTabName
, -1);

80931 #i‡!
	`deföed
(
SQLITE_OMIT_FOREIGN_KEY
Ë&& !deföed(
SQLITE_OMIT_TRIGGER
)

80932 if–
db
->
Êags
&
SQLITE_F‹eignKeys
 ){

80936 if–(
zWhîe
=
	`whîeF‹eignKeys
(
pP¨£
, 
pTab
))!=0 ){

80937 
	`sqlôe3Ne°edP¨£
(
pP¨£
,

80940 "WHERE %s;", 
zDb
, 
	`SCHEMA_TABLE
(
iDb
), 
zTabName
, 
zName
, 
zWhîe
);

80941 
	`sqlôe3DbFªe
(
db
, 
zWhîe
);

80947 
	`sqlôe3Ne°edP¨£
(
pP¨£
,

80949 #ifde‡
SQLITE_OMIT_TRIGGER


80964 
zDb
, 
	`SCHEMA_TABLE
(
iDb
), 
zName
, zName, zName,

80965 #i‚de‡
SQLITE_OMIT_TRIGGER


80966 
zName
,

80968 
zName
, 
nTabName
, 
zTabName


80971 #i‚de‡
SQLITE_OMIT_AUTOINCREMENT


80975 if–
	`sqlôe3FödTabÀ
(
db
, "sqlôe_£quí˚", 
zDb
) ){

80976 
	`sqlôe3Ne°edP¨£
(
pP¨£
,

80978 
zDb
, 
zName
, 
pTab
->zName);

80982 #i‚de‡
SQLITE_OMIT_TRIGGER


80987 if–(
zWhîe
=
	`whîeTempTriggîs
(
pP¨£
, 
pTab
))!=0 ){

80988 
	`sqlôe3Ne°edP¨£
(
pP¨£
,

80992 "WHERE %s;", 
zName
, zName, 
zWhîe
);

80993 
	`sqlôe3DbFªe
(
db
, 
zWhîe
);

80997 #i‡!
	`deföed
(
SQLITE_OMIT_FOREIGN_KEY
Ë&& !deföed(
SQLITE_OMIT_TRIGGER
)

80998 if–
db
->
Êags
&
SQLITE_F‹eignKeys
 ){

80999 
FKey
 *
p
;

81000 
p
=
	`sqlôe3FkRe„ªn˚s
(
pTab
);Ö;Öı->
pNextTo
){

81001 
TabÀ
 *
pFrom
 = 
p
->pFrom;

81002 if–
pFrom
!=
pTab
 ){

81003 
	`ªlﬂdTabÀSchema
(
pP¨£
, 
p
->
pFrom
,ÖFrom->
zName
);

81010 
	`ªlﬂdTabÀSchema
(
pP¨£
, 
pTab
, 
zName
);

81012 
exô_ª«me_èbÀ
:

81013 
	`sqlôe3SrcLi°Dñëe
(
db
, 
pSrc
);

81014 
	`sqlôe3DbFªe
(
db
, 
zName
);

81015 
db
->
Êags
 = 
ßvedDbFœgs
;

81023 
SQLITE_PRIVATE
 
	`sqlôe3MöimumFûeF‹m©
(
P¨£
 *
pP¨£
, 
iDb
, 
möF‹m©
){

81024 
Vdbe
 *
v
;

81025 
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

81029 if–
	`ALWAYS
(
v
) ){

81030 
r1
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

81031 
r2
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

81032 
j1
;

81033 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_RódCookõ
, 
iDb
, 
r1
, 
BTREE_FILE_FORMAT
);

81034 
	`sqlôe3VdbeU£sBåì
(
v
, 
iDb
);

81035 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 
möF‹m©
, 
r2
);

81036 
j1
 = 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Ge
, 
r2
, 0, 
r1
);

81037 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_SëCookõ
, 
iDb
, 
BTREE_FILE_FORMAT
, 
r2
);

81038 
	`sqlôe3VdbeJumpHîe
(
v
, 
j1
);

81039 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
r1
);

81040 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
r2
);

81052 
SQLITE_PRIVATE
 
	`sqlôe3A…îFöishAddCﬁumn
(
P¨£
 *
pP¨£
, 
Tokí
 *
pCﬁDef
){

81053 
TabÀ
 *
pNew
;

81054 
TabÀ
 *
pTab
;

81055 
iDb
;

81056 c⁄° *
zDb
;

81057 c⁄° *
zTab
;

81058 *
zCﬁ
;

81059 
Cﬁumn
 *
pCﬁ
;

81060 
Ex¥
 *
pDÊt
;

81061 
sqlôe3
 *
db
;

81063 
db
 = 
pP¨£
->db;

81064 if–
pP¨£
->
nEº
 || 
db
->
mÆlocFaûed
 ) ;

81065 
pNew
 = 
pP¨£
->
pNewTabÀ
;

81066 
	`as£π
–
pNew
 );

81068 
	`as£π
–
	`sqlôe3BåìHﬁdsAŒMuãxes
(
db
) );

81069 
iDb
 = 
	`sqlôe3SchemaToIndex
(
db
, 
pNew
->
pSchema
);

81070 
zDb
 = 
db
->
aDb
[
iDb
].
zName
;

81071 
zTab
 = &
pNew
->
zName
[16];

81072 
pCﬁ
 = &
pNew
->
aCﬁ
[pNew->
nCﬁ
-1];

81073 
pDÊt
 = 
pCﬁ
->pDflt;

81074 
pTab
 = 
	`sqlôe3FödTabÀ
(
db
, 
zTab
, 
zDb
);

81075 
	`as£π
–
pTab
 );

81077 #i‚de‡
SQLITE_OMIT_AUTHORIZATION


81079 if–
	`sqlôe3AuthCheck
(
pP¨£
, 
SQLITE_ALTER_TABLE
, 
zDb
, 
pTab
->
zName
, 0) ){

81088 if–
pDÊt
 &&ÖDÊt->
›
==
TK_NULL
 ){

81089 
pDÊt
 = 0;

81096 if–
pCﬁ
->
cﬁFœgs
 & 
COLFLAG_PRIMKEY
 ){

81097 
	`sqlôe3Eº‹Msg
(
pP¨£
, "Cannotáddá PRIMARY KEY column");

81100 if–
pNew
->
pIndex
 ){

81101 
	`sqlôe3Eº‹Msg
(
pP¨£
, "Cannotáddá UNIQUE column");

81104 if–(
db
->
Êags
&
SQLITE_F‹eignKeys
Ë&& 
pNew
->
pFKey
 && 
pDÊt
 ){

81105 
	`sqlôe3Eº‹Msg
(
pP¨£
,

81109 if–
pCﬁ
->
nŸNuŒ
 && !
pDÊt
 ){

81110 
	`sqlôe3Eº‹Msg
(
pP¨£
,

81118 if–
pDÊt
 ){

81119 
sqlôe3_vÆue
 *
pVÆ
 = 0;

81120 if–
	`sqlôe3VÆueFromEx¥
(
db
, 
pDÊt
, 
SQLITE_UTF8
, 
SQLITE_AFF_NONE
, &
pVÆ
) ){

81121 
db
->
mÆlocFaûed
 = 1;

81124 if–!
pVÆ
 ){

81125 
	`sqlôe3Eº‹Msg
(
pP¨£
, "Cannotáddá column withÇon-constant default");

81128 
	`sqlôe3VÆueFªe
(
pVÆ
);

81132 
zCﬁ
 = 
	`sqlôe3DbSåNDup
(
db
, (*)
pCﬁDef
->
z
,ÖCﬁDef->
n
);

81133 if–
zCﬁ
 ){

81134 *
zEnd
 = &
zCﬁ
[
pCﬁDef
->
n
-1];

81135 
ßvedDbFœgs
 = 
db
->
Êags
;

81136  
zEnd
>
zCﬁ
 && (*zEnd==';' || 
	`sqlôe3Is•a˚
(*zEnd)) ){

81137 *
zEnd
-- = '\0';

81139 
db
->
Êags
 |
SQLITE_Pª„rBuûtö
;

81140 
	`sqlôe3Ne°edP¨£
(
pP¨£
,

81144 
zDb
, 
	`SCHEMA_TABLE
(
iDb
), 
pNew
->
addCﬁOff£t
, 
zCﬁ
,ÖNew->addColOffset+1,

81145 
zTab


81147 
	`sqlôe3DbFªe
(
db
, 
zCﬁ
);

81148 
db
->
Êags
 = 
ßvedDbFœgs
;

81155 
	`sqlôe3MöimumFûeF‹m©
(
pP¨£
, 
iDb
, 
pDÊt
 ? 3 : 2);

81158 
	`ªlﬂdTabÀSchema
(
pP¨£
, 
pTab
,ÖTab->
zName
);

81176 
SQLITE_PRIVATE
 
	`sqlôe3A…îBegöAddCﬁumn
(
P¨£
 *
pP¨£
, 
SrcLi°
 *
pSrc
){

81177 
TabÀ
 *
pNew
;

81178 
TabÀ
 *
pTab
;

81179 
Vdbe
 *
v
;

81180 
iDb
;

81181 
i
;

81182 
nAŒoc
;

81183 
sqlôe3
 *
db
 = 
pP¨£
->db;

81186 
	`as£π
–
pP¨£
->
pNewTabÀ
==0 );

81187 
	`as£π
–
	`sqlôe3BåìHﬁdsAŒMuãxes
(
db
) );

81188 if–
db
->
mÆlocFaûed
 ) 
exô_begö_add_cﬁumn
;

81189 
pTab
 = 
	`sqlôe3LoˇãTabÀIãm
(
pP¨£
, 0, &
pSrc
->
a
[0]);

81190 if–!
pTab
 ) 
exô_begö_add_cﬁumn
;

81192 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


81193 if–
	`IsVútuÆ
(
pTab
) ){

81194 
	`sqlôe3Eº‹Msg
(
pP¨£
, "virtualÅables mayÇot beáltered");

81195 
exô_begö_add_cﬁumn
;

81200 if–
pTab
->
pSñe˘
 ){

81201 
	`sqlôe3Eº‹Msg
(
pP¨£
, "Cannotáddá columnÅoá view");

81202 
exô_begö_add_cﬁumn
;

81204 if–
SQLITE_OK
!=
	`isSy°emTabÀ
(
pP¨£
, 
pTab
->
zName
) ){

81205 
exô_begö_add_cﬁumn
;

81208 
	`as£π
–
pTab
->
addCﬁOff£t
>0 );

81209 
iDb
 = 
	`sqlôe3SchemaToIndex
(
db
, 
pTab
->
pSchema
);

81218 
pNew
 = (
TabÀ
*)
	`sqlôe3DbMÆlocZîo
(
db
, (Table));

81219 if–!
pNew
 ) 
exô_begö_add_cﬁumn
;

81220 
pP¨£
->
pNewTabÀ
 = 
pNew
;

81221 
pNew
->
nRef
 = 1;

81222 
pNew
->
nCﬁ
 = 
pTab
->nCol;

81223 
	`as£π
–
pNew
->
nCﬁ
>0 );

81224 
nAŒoc
 = (((
pNew
->
nCﬁ
-1)/8)*8)+8;

81225 
	`as£π
–
nAŒoc
>=
pNew
->
nCﬁ
 &&ÇAlloc%8==0 &&ÇAlloc-pNew->nCol<8 );

81226 
pNew
->
aCﬁ
 = (
Cﬁumn
*)
	`sqlôe3DbMÆlocZîo
(
db
, (Cﬁumn)*
nAŒoc
);

81227 
pNew
->
zName
 = 
	`sqlôe3MPrötf
(
db
, "sqlôe_Æãπab_%s", 
pTab
->zName);

81228 if–!
pNew
->
aCﬁ
 || !pNew->
zName
 ){

81229 
db
->
mÆlocFaûed
 = 1;

81230 
exô_begö_add_cﬁumn
;

81232 
	`mem˝y
(
pNew
->
aCﬁ
, 
pTab
->aCﬁ, (
Cﬁumn
)*pNew->
nCﬁ
);

81233 
i
=0; i<
pNew
->
nCﬁ
; i++){

81234 
Cﬁumn
 *
pCﬁ
 = &
pNew
->
aCﬁ
[
i
];

81235 
pCﬁ
->
zName
 = 
	`sqlôe3DbSåDup
(
db
,ÖCol->zName);

81236 
pCﬁ
->
zCﬁl
 = 0;

81237 
pCﬁ
->
zTy≥
 = 0;

81238 
pCﬁ
->
pDÊt
 = 0;

81239 
pCﬁ
->
zDÊt
 = 0;

81241 
pNew
->
pSchema
 = 
db
->
aDb
[
iDb
].pSchema;

81242 
pNew
->
addCﬁOff£t
 = 
pTab
->addColOffset;

81243 
pNew
->
nRef
 = 1;

81246 
	`sqlôe3BegöWrôeO≥øti⁄
(
pP¨£
, 0, 
iDb
);

81247 
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

81248 if–!
v
 ) 
exô_begö_add_cﬁumn
;

81249 
	`sqlôe3Ch™geCookõ
(
pP¨£
, 
iDb
);

81251 
exô_begö_add_cﬁumn
:

81252 
	`sqlôe3SrcLi°Dñëe
(
db
, 
pSrc
);

81400 #i‚de‡
SQLITE_OMIT_ANALYZE


81402 #i‡
	`deföed
(
SQLITE_ENABLE_STAT4
)

81403 
	#IsSèt4
 1

	)

81404 
	#IsSèt3
 0

	)

81405 #ñi‡
	`deföed
(
SQLITE_ENABLE_STAT3
)

81406 
	#IsSèt4
 0

	)

81407 
	#IsSèt3
 1

	)

81409 
	#IsSèt4
 0

	)

81410 
	#IsSèt3
 0

	)

81411 #unde‡
SQLITE_STAT4_SAMPLES


81412 
	#SQLITE_STAT4_SAMPLES
 1

	)

81414 
	#IsSèt34
 (
IsSèt3
+
IsSèt4
Ë

	)

81429 
	`›íSètTabÀ
(

81430 
P¨£
 *
pP¨£
,

81431 
iDb
,

81432 
iSètCur
,

81433 c⁄° *
zWhîe
,

81434 c⁄° *
zWhîeTy≥


81437 c⁄° *
zName
;

81438 c⁄° *
zCﬁs
;

81439 } 
aTabÀ
[] = {

81441 #i‡
	`deföed
(
SQLITE_ENABLE_STAT4
)

81444 #ñi‡
	`deföed
(
SQLITE_ENABLE_STAT3
)

81452 
i
;

81453 
sqlôe3
 *
db
 = 
pP¨£
->db;

81454 
Db
 *
pDb
;

81455 
Vdbe
 *
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

81456 
aRoŸ
[
	`AºaySize
(
aTabÀ
)];

81457 
u8
 
aCª©eTbl
[
	`AºaySize
(
aTabÀ
)];

81459 if–
v
==0 ) ;

81460 
	`as£π
–
	`sqlôe3BåìHﬁdsAŒMuãxes
(
db
) );

81461 
	`as£π
–
	`sqlôe3VdbeDb
(
v
)==
db
 );

81462 
pDb
 = &
db
->
aDb
[
iDb
];

81467 
i
=0; i<
	`AºaySize
(
aTabÀ
); i++){

81468 c⁄° *
zTab
 = 
aTabÀ
[
i
].
zName
;

81469 
TabÀ
 *
pSèt
;

81470 if–(
pSèt
 = 
	`sqlôe3FödTabÀ
(
db
, 
zTab
, 
pDb
->
zName
))==0 ){

81471 if–
aTabÀ
[
i
].
zCﬁs
 ){

81476 
	`sqlôe3Ne°edP¨£
(
pP¨£
,

81477 "CREATE TABLE %Q.%s(%s)", 
pDb
->
zName
, 
zTab
, 
aTabÀ
[
i
].
zCﬁs


81479 
aRoŸ
[
i
] = 
pP¨£
->
ªgRoŸ
;

81480 
aCª©eTbl
[
i
] = 
OPFLAG_P2ISREG
;

81486 
aRoŸ
[
i
] = 
pSèt
->
äum
;

81487 
aCª©eTbl
[
i
] = 0;

81488 
	`sqlôe3TabÀLock
(
pP¨£
, 
iDb
, 
aRoŸ
[
i
], 1, 
zTab
);

81489 if–
zWhîe
 ){

81490 
	`sqlôe3Ne°edP¨£
(
pP¨£
,

81492 
pDb
->
zName
, 
zTab
, 
zWhîeTy≥
, 
zWhîe


81496 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_CÀ¨
, 
aRoŸ
[
i
], 
iDb
);

81502 
i
=0; 
aTabÀ
[i].
zCﬁs
; i++){

81503 
	`as£π
–
i
<
	`AºaySize
(
aTabÀ
) );

81504 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_O≥nWrôe
, 
iSètCur
+
i
, 
aRoŸ
[i], 
iDb
);

81505 
	`sqlôe3VdbeCh™geP4
(
v
, -1, (*)3, 
P4_INT32
);

81506 
	`sqlôe3VdbeCh™geP5
(
v
, 
aCª©eTbl
[
i
]);

81513 #i‚de‡
SQLITE_STAT4_SAMPLES


81514 
	#SQLITE_STAT4_SAMPLES
 24

	)

81522 
Sèt4Accum
 
	tSèt4Accum
;

81523 
Sèt4Sam∂e
 
	tSèt4Sam∂e
;

81524 
	sSèt4Sam∂e
 {

81525 
tRow˙t
 *
™Eq
;

81526 
tRow˙t
 *
™DLt
;

81527 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


81528 
tRow˙t
 *
™Lt
;

81529 
i64
 
iRowid
;

81530 
u8
 
isPSam∂e
;

81531 
iCﬁ
;

81532 
u32
 
iHash
;

81535 
	sSèt4Accum
 {

81536 
tRow˙t
 
nRow
;

81537 
tRow˙t
 
nPSam∂e
;

81538 
nCﬁ
;

81539 
mxSam∂e
;

81540 
Sèt4Sam∂e
 
cuºít
;

81541 
u32
 
iP∫
;

81542 
Sèt4Sam∂e
 *
aBe°
;

81543 
iMö
;

81544 
nSam∂e
;

81545 
iGë
;

81546 
Sèt4Sam∂e
 *
a
;

81558 
	`°©Inô
(

81559 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

81560 
¨gc
,

81561 
sqlôe3_vÆue
 **
¨gv


81563 
Sèt4Accum
 *
p
;

81564 
nCﬁ
;

81565 
nCﬁUp
;

81566 
n
;

81567 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


81568 
mxSam∂e
 = 
SQLITE_STAT4_SAMPLES
;

81572 
	`UNUSED_PARAMETER
(
¨gc
);

81573 
nCﬁ
 = 
	`sqlôe3_vÆue_öt
(
¨gv
[0]);

81574 
	`as£π
–
nCﬁ
>1 );

81575 
nCﬁUp
 = (
tRow˙t
)<8 ? (
nCﬁ
+1)&~1 :ÇCol;

81578 
n
 = (*
p
)

81579 + (
tRow˙t
)*
nCﬁUp


81580 + (
tRow˙t
)*
nCﬁUp


81581 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


81582 + (
tRow˙t
)*
nCﬁUp


81583 + (
Sèt4Sam∂e
)*(
nCﬁ
+
mxSam∂e
)

81584 + (
tRow˙t
)*3*
nCﬁUp
*(
nCﬁ
+
mxSam∂e
)

81587 
p
 = 
	`sqlôe3MÆlocZîo
(
n
);

81588 if–
p
==0 ){

81589 
	`sqlôe3_ªsu…_îr‹_nomem
(
c⁄ãxt
);

81593 
p
->
nRow
 = 0;

81594 
p
->
nCﬁ
 =ÇCol;

81595 
p
->
cuºít
.
™DLt
 = (
tRow˙t
*)&p[1];

81596 
p
->
cuºít
.
™Eq
 = &p->cuºít.
™DLt
[
nCﬁUp
];

81598 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


81600 
u8
 *
pS∑˚
;

81601 
i
;

81603 
p
->
iGë
 = -1;

81604 
p
->
mxSam∂e
 = mxSample;

81605 
p
->
nPSam∂e
 = (
tRow˙t
)(
	`sqlôe3_vÆue_öt64
(
¨gv
[1])/(
mxSam∂e
/3+1) + 1);

81606 
p
->
cuºít
.
™Lt
 = &p->cuºít.
™Eq
[
nCﬁUp
];

81607 
p
->
iP∫
 = 
nCﬁ
*0x689e962d ^ 
	`sqlôe3_vÆue_öt
(
¨gv
[1])*0xd0944565;

81610 
p
->
a
 = (
Sèt4Sam∂e
*)&p->
cuºít
.
™Lt
[
nCﬁUp
];

81611 
p
->
aBe°
 = &p->
a
[
mxSam∂e
];

81612 
pS∑˚
 = (
u8
*)(&
p
->
a
[
mxSam∂e
+
nCﬁ
]);

81613 
i
=0; i<(
mxSam∂e
+
nCﬁ
); i++){

81614 
p
->
a
[
i
].
™Eq
 = (
tRow˙t
 *)
pS∑˚
;ÖS∑˚ +(—Row˙tË* 
nCﬁUp
);

81615 
p
->
a
[
i
].
™Lt
 = (
tRow˙t
 *)
pS∑˚
;ÖS∑˚ +(—Row˙tË* 
nCﬁUp
);

81616 
p
->
a
[
i
].
™DLt
 = (
tRow˙t
 *)
pS∑˚
;ÖS∑˚ +(—Row˙tË* 
nCﬁUp
);

81618 
	`as£π
–(
pS∑˚
 - (
u8
*)
p
)==
n
 );

81620 
i
=0; i<
nCﬁ
; i++){

81621 
p
->
aBe°
[
i
].
iCﬁ
 = i;

81627 
	`sqlôe3_ªsu…_blob
(
c⁄ãxt
, 
p
, ’), 
sqlôe3_‰ì
);

81629 c⁄° 
FuncDef
 
°©InôFuncdef
 = {

81630 1+
IsSèt34
,

81631 
SQLITE_UTF8
,

81634 
°©Inô
,

81642 #ifde‡
SQLITE_ENABLE_STAT4


81654 
	`ßm∂eIsBëãrPo°
(

81655 
Sèt4Accum
 *
pAccum
,

81656 
Sèt4Sam∂e
 *
pNew
,

81657 
Sèt4Sam∂e
 *
pOld


81659 
nCﬁ
 = 
pAccum
->nCol;

81660 
i
;

81661 
	`as£π
–
pNew
->
iCﬁ
==
pOld
->iCol );

81662 
i
=
pNew
->
iCﬁ
+1; i<
nCﬁ
; i++){

81663 if–
pNew
->
™Eq
[
i
]>
pOld
->anEq[i] )  1;

81664 if–
pNew
->
™Eq
[
i
]<
pOld
->anEq[i] )  0;

81666 if–
pNew
->
iHash
>
pOld
->iHash )  1;

81671 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


81678 
	`ßm∂eIsBëãr
(

81679 
Sèt4Accum
 *
pAccum
,

81680 
Sèt4Sam∂e
 *
pNew
,

81681 
Sèt4Sam∂e
 *
pOld


81683 
tRow˙t
 
nEqNew
 = 
pNew
->
™Eq
[pNew->
iCﬁ
];

81684 
tRow˙t
 
nEqOld
 = 
pOld
->
™Eq
[pOld->
iCﬁ
];

81686 
	`as£π
–
pOld
->
isPSam∂e
==0 && 
pNew
->isPSample==0 );

81687 
	`as£π
–
IsSèt4
 || (
pNew
->
iCﬁ
==0 && 
pOld
->iCol==0) );

81689 if–(
nEqNew
>
nEqOld
) )  1;

81690 #ifde‡
SQLITE_ENABLE_STAT4


81691 if–
nEqNew
==
nEqOld
 ){

81692 if–
pNew
->
iCﬁ
<
pOld
->iCol )  1;

81693  (
pNew
->
iCﬁ
==
pOld
->iCﬁ && 
	`ßm∂eIsBëãrPo°
(
pAccum
,ÖNew,ÖOld));

81697  (
nEqNew
==
nEqOld
 && 
pNew
->
iHash
>
pOld
->iHash);

81704 
	`ßm∂eC›y
(
Sèt4Accum
 *
p
, 
Sèt4Sam∂e
 *
pTo
, Sèt4Sam∂ê*
pFrom
){

81705 
pTo
->
iRowid
 = 
pFrom
->iRowid;

81706 
pTo
->
isPSam∂e
 = 
pFrom
->isPSample;

81707 
pTo
->
iCﬁ
 = 
pFrom
->iCol;

81708 
pTo
->
iHash
 = 
pFrom
->iHash;

81709 
	`mem˝y
(
pTo
->
™Eq
, 
pFrom
->™Eq, (
tRow˙t
)*
p
->
nCﬁ
);

81710 
	`mem˝y
(
pTo
->
™Lt
, 
pFrom
->™Lt, (
tRow˙t
)*
p
->
nCﬁ
);

81711 
	`mem˝y
(
pTo
->
™DLt
, 
pFrom
->™DLt, (
tRow˙t
)*
p
->
nCﬁ
);

81718 
	`ßm∂eIn£π
(
Sèt4Accum
 *
p
, 
Sèt4Sam∂e
 *
pNew
, 
nEqZîo
){

81719 
Sèt4Sam∂e
 *
pSam∂e
;

81720 
i
;

81722 
	`as£π
–
IsSèt4
 || 
nEqZîo
==0 );

81724 #ifde‡
SQLITE_ENABLE_STAT4


81725 if–
pNew
->
isPSam∂e
==0 ){

81726 
Sèt4Sam∂e
 *
pUpgøde
 = 0;

81727 
	`as£π
–
pNew
->
™Eq
[pNew->
iCﬁ
]>0 );

81734 
i
=
p
->
nSam∂e
-1; i>=0; i--){

81735 
Sèt4Sam∂e
 *
pOld
 = &
p
->
a
[
i
];

81736 if–
pOld
->
™Eq
[
pNew
->
iCﬁ
]==0 ){

81737 if–
pOld
->
isPSam∂e
 ) ;

81738 
	`as£π
–
pOld
->
iCﬁ
>
pNew
->iCol );

81739 
	`as£π
–
	`ßm∂eIsBëãr
(
p
, 
pNew
, 
pOld
) );

81740 if–
pUpgøde
==0 || 
	`ßm∂eIsBëãr
(
p
, 
pOld
,ÖUpgrade) ){

81741 
pUpgøde
 = 
pOld
;

81745 if–
pUpgøde
 ){

81746 
pUpgøde
->
iCﬁ
 = 
pNew
->iCol;

81747 
pUpgøde
->
™Eq
[pUpgøde->
iCﬁ
] = 
pNew
->anEq[pUpgrade->iCol];

81748 
föd_√w_mö
;

81754 if–
p
->
nSam∂e
>ı->
mxSam∂e
 ){

81755 
Sèt4Sam∂e
 *
pMö
 = &
p
->
a
[p->
iMö
];

81756 
tRow˙t
 *
™Eq
 = 
pMö
->anEq;

81757 
tRow˙t
 *
™Lt
 = 
pMö
->anLt;

81758 
tRow˙t
 *
™DLt
 = 
pMö
->anDLt;

81759 
	`memmove
(
pMö
, &pMö[1], (
p
->
a
[0])*’->
nSam∂e
-p->
iMö
-1));

81760 
pSam∂e
 = &
p
->
a
[p->
nSam∂e
-1];

81761 
pSam∂e
->
™Eq
 =ánEq;

81762 
pSam∂e
->
™DLt
 =ánDLt;

81763 
pSam∂e
->
™Lt
 =ánLt;

81764 
p
->
nSam∂e
 =Ö->
mxSam∂e
-1;

81770 #ifde‡
SQLITE_ENABLE_STAT4


81771 
	`as£π
–
p
->
nSam∂e
==0

81772 || 
pNew
->
™Lt
[
p
->
nCﬁ
-1] >Ö->
a
[p->
nSam∂e
-1].anLt[p->nCol-1] );

81776 
pSam∂e
 = &
p
->
a
[p->
nSam∂e
];

81777 
	`ßm∂eC›y
(
p
, 
pSam∂e
, 
pNew
);

81778 
p
->
nSam∂e
++;

81781 
	`mem£t
(
pSam∂e
->
™Eq
, 0, (
tRow˙t
)*
nEqZîo
);

81783 #ifde‡
SQLITE_ENABLE_STAT4


81784 
föd_√w_mö
:

81786 if–
p
->
nSam∂e
>ı->
mxSam∂e
 ){

81787 
iMö
 = -1;

81788 
i
=0; i<
p
->
mxSam∂e
; i++){

81789 if–
p
->
a
[
i
].
isPSam∂e
 ) ;

81790 if–
iMö
<0 || 
	`ßm∂eIsBëãr
(
p
, &p->
a
[iMö], &p->a[
i
]) ){

81791 
iMö
 = 
i
;

81794 
	`as£π
–
iMö
>=0 );

81795 
p
->
iMö
 = iMin;

81806 
	`ßm∂ePushPªvious
(
Sèt4Accum
 *
p
, 
iChng
){

81807 #ifde‡
SQLITE_ENABLE_STAT4


81808 
i
;

81812 
i
=(
p
->
nCﬁ
-2); i>=
iChng
; i--){

81813 
Sèt4Sam∂e
 *
pBe°
 = &
p
->
aBe°
[
i
];

81814 
pBe°
->
™Eq
[
i
] = 
p
->
cuºít
.anEq[i];

81815 if–
p
->
nSam∂e
<p->
mxSam∂e
 || 
	`ßm∂eIsBëãr
’, 
pBe°
, &p->
a
[p->
iMö
]) ){

81816 
	`ßm∂eIn£π
(
p
, 
pBe°
, 
i
);

81821 
i
=
p
->
nSam∂e
-1; i>=0; i--){

81822 
j
;

81823 
j
=
iChng
; j<
p
->
nCﬁ
; j++){

81824 if–
p
->
a
[
i
].
™Eq
[
j
]==0 )Ö->a[i].™Eq[j] =Ö->
cuºít
.anEq[j];

81829 #i‡
	`deföed
(
SQLITE_ENABLE_STAT3
Ë&& !deföed(
SQLITE_ENABLE_STAT4
)

81830 if–
iChng
==0 ){

81831 
tRow˙t
 
nLt
 = 
p
->
cuºít
.
™Lt
[0];

81832 
tRow˙t
 
nEq
 = 
p
->
cuºít
.
™Eq
[0];

81835 if–(
nLt
/
p
->
nPSam∂e
)!=“Lt+
nEq
)/p->nPSample ){

81836 
p
->
cuºít
.
isPSam∂e
 = 1;

81837 
	`ßm∂eIn£π
(
p
, &p->
cuºít
, 0);

81838 
p
->
cuºít
.
isPSam∂e
 = 0;

81842 if–
p
->
nSam∂e
<p->
mxSam∂e


81843 || 
	`ßm∂eIsBëãr
(
p
, &p->
cuºít
, &p->
a
[p->
iMö
])

81845 
	`ßm∂eIn£π
(
p
, &p->
cuºít
, 0);

81850 #i‚de‡
SQLITE_ENABLE_STAT3_OR_STAT4


81851 
	`UNUSED_PARAMETER
–
p
 );

81852 
	`UNUSED_PARAMETER
–
iChng
 );

81868 
	`°©Push
(

81869 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

81870 
¨gc
,

81871 
sqlôe3_vÆue
 **
¨gv


81873 
i
;

81876 
Sèt4Accum
 *
p
 = (Sèt4Accum*)
	`sqlôe3_vÆue_blob
(
¨gv
[0]);

81877 
iChng
 = 
	`sqlôe3_vÆue_öt
(
¨gv
[1]);

81879 
	`UNUSED_PARAMETER
–
¨gc
 );

81880 
	`UNUSED_PARAMETER
–
c⁄ãxt
 );

81881 
	`as£π
–
p
->
nCﬁ
>1 );

81882 
	`as£π
–
iChng
<
p
->
nCﬁ
 );

81884 if–
p
->
nRow
==0 ){

81886 
i
=0; i<
p
->
nCﬁ
; i++Ëp->
cuºít
.
™Eq
[i] = 1;

81889 
	`ßm∂ePushPªvious
(
p
, 
iChng
);

81893 
i
=0; i<
iChng
; i++){

81894 
p
->
cuºít
.
™Eq
[
i
]++;

81896 
i
=
iChng
; i<
p
->
nCﬁ
; i++){

81897 
p
->
cuºít
.
™DLt
[
i
]++;

81898 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


81899 
p
->
cuºít
.
™Lt
[
i
] +p->cuºít.
™Eq
[i];

81901 
p
->
cuºít
.
™Eq
[
i
] = 1;

81904 
p
->
nRow
++;

81905 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


81906 
p
->
cuºít
.
iRowid
 = 
	`sqlôe3_vÆue_öt64
(
¨gv
[2]);

81907 
p
->
cuºít
.
iHash
 =Ö->
iP∫
 =Ö->iPrn*1103515245 + 12345;

81910 #ifde‡
SQLITE_ENABLE_STAT4


81912 
tRow˙t
 
nLt
 = 
p
->
cuºít
.
™Lt
[p->
nCﬁ
-1];

81915 if–(
nLt
/
p
->
nPSam∂e
)!=(nLt+1)/p->nPSample ){

81916 
p
->
cuºít
.
isPSam∂e
 = 1;

81917 
p
->
cuºít
.
iCﬁ
 = 0;

81918 
	`ßm∂eIn£π
(
p
, &p->
cuºít
,Ö->
nCﬁ
-1);

81919 
p
->
cuºít
.
isPSam∂e
 = 0;

81923 
i
=0; i<(
p
->
nCﬁ
-1); i++){

81924 
p
->
cuºít
.
iCﬁ
 = 
i
;

81925 if–
i
>=
iChng
 || 
	`ßm∂eIsBëãrPo°
(
p
, &p->
cuºít
, &p->
aBe°
[i]) ){

81926 
	`ßm∂eC›y
(
p
, &p->
aBe°
[
i
], &p->
cuºít
);

81932 c⁄° 
FuncDef
 
°©PushFuncdef
 = {

81933 2+
IsSèt34
,

81934 
SQLITE_UTF8
,

81937 
°©Push
,

81945 
	#STAT_GET_STAT1
 0

	)

81946 
	#STAT_GET_ROWID
 1

	)

81947 
	#STAT_GET_NEQ
 2

	)

81948 
	#STAT_GET_NLT
 3

	)

81949 
	#STAT_GET_NDLT
 4

	)

81961 
	`°©Gë
(

81962 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

81963 
¨gc
,

81964 
sqlôe3_vÆue
 **
¨gv


81966 
Sèt4Accum
 *
p
 = (Sèt4Accum*)
	`sqlôe3_vÆue_blob
(
¨gv
[0]);

81967 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


81969 
eCÆl
 = 
	`sqlôe3_vÆue_öt
(
¨gv
[1]);

81970 
	`as£π
–
¨gc
==2 );

81971 
	`as£π
–
eCÆl
==
STAT_GET_STAT1
 ||ÉCÆl==
STAT_GET_NEQ


81972 || 
eCÆl
==
STAT_GET_ROWID
 ||ÉCÆl==
STAT_GET_NLT


81973 || 
eCÆl
==
STAT_GET_NDLT


81975 if–
eCÆl
==
STAT_GET_STAT1
 )

81977 
	`as£π
–
¨gc
==1 );

82001 *
z
;

82002 
i
;

82004 *
zRë
 = 
	`sqlôe3MÆlocZîo
(
p
->
nCﬁ
 * 25);

82005 if–
zRë
==0 ){

82006 
	`sqlôe3_ªsu…_îr‹_nomem
(
c⁄ãxt
);

82010 
	`sqlôe3_¢¥ötf
(24, 
zRë
, "%Œu", (
u64
)
p
->
nRow
);

82011 
z
 = 
zRë
 + 
	`sqlôe3SåÀn30
(zRet);

82012 
i
=0; i<(
p
->
nCﬁ
-1); i++){

82013 
u64
 
nDi°ö˘
 = 
p
->
cuºít
.
™DLt
[
i
] + 1;

82014 
u64
 
iVÆ
 = (
p
->
nRow
 + 
nDi°ö˘
 - 1) /ÇDistinct;

82015 
	`sqlôe3_¢¥ötf
(24, 
z
, " %Œu", 
iVÆ
);

82016 
z
 +
	`sqlôe3SåÀn30
(z);

82017 
	`as£π
–
p
->
cuºít
.
™Eq
[
i
] );

82019 
	`as£π
–
z
[0]=='\0' && z>
zRë
 );

82021 
	`sqlôe3_ªsu…_ãxt
(
c⁄ãxt
, 
zRë
, -1, 
sqlôe3_‰ì
);

82023 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


82024 if–
eCÆl
==
STAT_GET_ROWID
 ){

82025 if–
p
->
iGë
<0 ){

82026 
	`ßm∂ePushPªvious
(
p
, 0);

82027 
p
->
iGë
 = 0;

82029 if–
p
->
iGë
<p->
nSam∂e
 ){

82030 
	`sqlôe3_ªsu…_öt64
(
c⁄ãxt
, 
p
->
a
[p->
iGë
].
iRowid
);

82033 
tRow˙t
 *
aC¡
 = 0;

82035 
	`as£π
–
p
->
iGë
<p->
nSam∂e
 );

82036  
eCÆl
 ){

82037 
STAT_GET_NEQ
: 
aC¡
 = 
p
->
a
[p->
iGë
].
™Eq
; ;

82038 
STAT_GET_NLT
: 
aC¡
 = 
p
->
a
[p->
iGë
].
™Lt
; ;

82040 
aC¡
 = 
p
->
a
[p->
iGë
].
™DLt
;

82041 
p
->
iGë
++;

82046 if–
IsSèt3
 ){

82047 
	`sqlôe3_ªsu…_öt64
(
c⁄ãxt
, (
i64
)
aC¡
[0]);

82049 *
zRë
 = 
	`sqlôe3MÆlocZîo
(
p
->
nCﬁ
 * 25);

82050 if–
zRë
==0 ){

82051 
	`sqlôe3_ªsu…_îr‹_nomem
(
c⁄ãxt
);

82053 
i
;

82054 *
z
 = 
zRë
;

82055 
i
=0; i<
p
->
nCﬁ
; i++){

82056 
	`sqlôe3_¢¥ötf
(24, 
z
, "%Œu ", (
u64
)
aC¡
[
i
]);

82057 
z
 +
	`sqlôe3SåÀn30
(z);

82059 
	`as£π
–
z
[0]=='\0' && z>
zRë
 );

82060 
z
[-1] = '\0';

82061 
	`sqlôe3_ªsu…_ãxt
(
c⁄ãxt
, 
zRë
, -1, 
sqlôe3_‰ì
);

82066 #i‚de‡
SQLITE_DEBUG


82067 
	`UNUSED_PARAMETER
–
¨gc
 );

82070 c⁄° 
FuncDef
 
°©GëFuncdef
 = {

82071 1+
IsSèt34
,

82072 
SQLITE_UTF8
,

82075 
°©Gë
,

82083 
	`ˇŒSètGë
(
Vdbe
 *
v
, 
ªgSèt4
, 
iP¨am
, 
ªgOut
){

82084 
	`as£π
–
ªgOut
!=
ªgSèt4
 &&ÑegOut!=regStat4+1 );

82085 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


82086 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 
iP¨am
, 
ªgSèt4
+1);

82087 #ñi‡
SQLITE_DEBUG


82088 
	`as£π
–
iP¨am
==
STAT_GET_STAT1
 );

82090 
	`UNUSED_PARAMETER
–
iP¨am
 );

82092 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Fun˘i⁄
, 0, 
ªgSèt4
, 
ªgOut
);

82093 
	`sqlôe3VdbeCh™geP4
(
v
, -1, (*)&
°©GëFuncdef
, 
P4_FUNCDEF
);

82094 
	`sqlôe3VdbeCh™geP5
(
v
, 1 + 
IsSèt34
);

82101 
	`™ÆyzeO√TabÀ
(

82102 
P¨£
 *
pP¨£
,

82103 
TabÀ
 *
pTab
,

82104 
Index
 *
pO∆yIdx
,

82105 
iSètCur
,

82106 
iMem
,

82107 
iTab


82109 
sqlôe3
 *
db
 = 
pP¨£
->db;

82110 
Index
 *
pIdx
;

82111 
iIdxCur
;

82112 
iTabCur
;

82113 
Vdbe
 *
v
;

82114 
i
;

82115 
jZîoRows
 = -1;

82116 
iDb
;

82117 
u8
 
√edTabÀC¡
 = 1;

82118 
ªgNewRowid
 = 
iMem
++;

82119 
ªgSèt4
 = 
iMem
++;

82120 
ªgChng
 = 
iMem
++;

82121 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


82122 
ªgRowid
 = 
iMem
++;

82124 
ªgTemp
 = 
iMem
++;

82125 
ªgTab«me
 = 
iMem
++;

82126 
ªgIdx«me
 = 
iMem
++;

82127 
ªgSèt1
 = 
iMem
++;

82128 
ªgPªv
 = 
iMem
;

82130 
pP¨£
->
nMem
 = 
	`MAX
’P¨£->nMem, 
iMem
);

82131 
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

82132 if–
v
==0 || 
	`NEVER
(
pTab
==0) ){

82135 if–
pTab
->
äum
==0 ){

82139 if–
	`sqlôe3_°∫icmp
(
pTab
->
zName
, "sqlite_", 7)==0 ){

82143 
	`as£π
–
	`sqlôe3BåìHﬁdsAŒMuãxes
(
db
) );

82144 
iDb
 = 
	`sqlôe3SchemaToIndex
(
db
, 
pTab
->
pSchema
);

82145 
	`as£π
–
iDb
>=0 );

82146 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 
iDb
, 0) );

82147 #i‚de‡
SQLITE_OMIT_AUTHORIZATION


82148 if–
	`sqlôe3AuthCheck
(
pP¨£
, 
SQLITE_ANALYZE
, 
pTab
->
zName
, 0,

82149 
db
->
aDb
[
iDb
].
zName
 ) ){

82158 
	`sqlôe3TabÀLock
(
pP¨£
, 
iDb
, 
pTab
->
äum
, 0,ÖTab->
zName
);

82159 
iTabCur
 = 
iTab
++;

82160 
iIdxCur
 = 
iTab
++;

82161 
pP¨£
->
nTab
 = 
	`MAX
’P¨£->nTab, 
iTab
);

82162 
	`sqlôe3O≥nTabÀ
(
pP¨£
, 
iTabCur
, 
iDb
, 
pTab
, 
OP_O≥nRód
);

82163 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Såög8
, 0, 
ªgTab«me
, 0, 
pTab
->
zName
, 0);

82165 
pIdx
=
pTab
->
pIndex
;ÖIdx;ÖIdxıIdx->
pNext
){

82166 
nCﬁ
;

82167 
KeyInfo
 *
pKey
;

82168 *
aGŸoChng
;

82169 
addrRewöd
;

82170 
addrGŸoChng0
;

82171 
addrNextRow
;

82173 if–
pO∆yIdx
 &&ÖO∆yIdx!=
pIdx
 ) ;

82174 if–
pIdx
->
pP¨tIdxWhîe
==0 ) 
√edTabÀC¡
 = 0;

82175 
	`VdbeNo›Commít
((
v
, "Begöá«lysi†o‡%s", 
pIdx
->
zName
));

82176 
nCﬁ
 = 
pIdx
->
nCﬁumn
;

82177 
aGŸoChng
 = 
	`sqlôe3DbMÆlocRaw
(
db
, ()*(
nCﬁ
+1));

82178 if–
aGŸoChng
==0 ) ;

82179 
pKey
 = 
	`sqlôe3IndexKeyöfo
(
pP¨£
, 
pIdx
);

82182 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Såög8
, 0, 
ªgIdx«me
, 0, 
pIdx
->
zName
, 0);

82220 
pP¨£
->
nMem
 = 
	`MAX
’P¨£->nMem, 
ªgPªv
+
nCﬁ
);

82223 
	`as£π
–
iDb
==
	`sqlôe3SchemaToIndex
(
db
, 
pIdx
->
pSchema
) );

82224 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_O≥nRód
, 
iIdxCur
, 
pIdx
->
äum
, 
iDb
);

82225 
	`sqlôe3VdbeCh™geP4
(
v
, -1, (*)
pKey
, 
P4_KEYINFO_HANDOFF
);

82226 
	`VdbeCommít
((
v
, "%s", 
pIdx
->
zName
));

82235 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


82236 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Cou¡
, 
iIdxCur
, 
ªgSèt4
+2);

82238 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 
nCﬁ
+1, 
ªgSèt4
+1);

82239 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Fun˘i⁄
, 0, 
ªgSèt4
+1,ÑegStat4);

82240 
	`sqlôe3VdbeCh™geP4
(
v
, -1, (*)&
°©InôFuncdef
, 
P4_FUNCDEF
);

82241 
	`sqlôe3VdbeCh™geP5
(
v
, 1+
IsSèt34
);

82251 
addrRewöd
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Rewöd
, 
iIdxCur
);

82252 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 0, 
ªgChng
);

82253 
addrGŸoChng0
 = 
	`sqlôe3VdbeAddOp0
(
v
, 
OP_GŸo
);

82265 
addrNextRow
 = 
	`sqlôe3VdbeCuºítAddr
(
v
);

82266 
i
=0; i<
nCﬁ
; i++){

82267 *
pCﬁl
 = (*)
	`sqlôe3LoˇãCﬁlSeq
(
pP¨£
, 
pIdx
->
azCﬁl
[
i
]);

82268 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 
i
, 
ªgChng
);

82269 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Cﬁumn
, 
iIdxCur
, 
i
, 
ªgTemp
);

82270 
aGŸoChng
[
i
] =

82271 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Ne
, 
ªgTemp
, 0, 
ªgPªv
+
i
, 
pCﬁl
, 
P4_COLLSEQ
);

82272 
	`sqlôe3VdbeCh™geP5
(
v
, 
SQLITE_NULLEQ
);

82274 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 
nCﬁ
, 
ªgChng
);

82275 
aGŸoChng
[
nCﬁ
] = 
	`sqlôe3VdbeAddOp0
(
v
, 
OP_GŸo
);

82284 
	`sqlôe3VdbeJumpHîe
(
v
, 
addrGŸoChng0
);

82285 
i
=0; i<
nCﬁ
; i++){

82286 
	`sqlôe3VdbeJumpHîe
(
v
, 
aGŸoChng
[
i
]);

82287 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Cﬁumn
, 
iIdxCur
, 
i
, 
ªgPªv
+i);

82297 
	`sqlôe3VdbeJumpHîe
(
v
, 
aGŸoChng
[
nCﬁ
]);

82298 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


82299 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_IdxRowid
, 
iIdxCur
, 
ªgRowid
);

82300 
	`as£π
–
ªgRowid
==(
ªgSèt4
+2) );

82302 
	`as£π
–
ªgChng
==(
ªgSèt4
+1) );

82303 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Fun˘i⁄
, 1, 
ªgSèt4
, 
ªgTemp
);

82304 
	`sqlôe3VdbeCh™geP4
(
v
, -1, (*)&
°©PushFuncdef
, 
P4_FUNCDEF
);

82305 
	`sqlôe3VdbeCh™geP5
(
v
, 2+
IsSèt34
);

82306 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Next
, 
iIdxCur
, 
addrNextRow
);

82309 
	`ˇŒSètGë
(
v
, 
ªgSèt4
, 
STAT_GET_STAT1
, 
ªgSèt1
);

82310 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_MakeRec‹d
, 
ªgTab«me
, 3, 
ªgTemp
, "aaa", 0);

82311 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NewRowid
, 
iSètCur
, 
ªgNewRowid
);

82312 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_In£π
, 
iSètCur
, 
ªgTemp
, 
ªgNewRowid
);

82313 
	`sqlôe3VdbeCh™geP5
(
v
, 
OPFLAG_APPEND
);

82316 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


82318 
ªgEq
 = 
ªgSèt1
;

82319 
ªgLt
 = 
ªgSèt1
+1;

82320 
ªgDLt
 = 
ªgSèt1
+2;

82321 
ªgSam∂e
 = 
ªgSèt1
+3;

82322 
ªgCﬁ
 = 
ªgSèt1
+4;

82323 
ªgSam∂eRowid
 = 
ªgCﬁ
 + 
nCﬁ
;

82324 
addrNext
;

82325 
addrIsNuŒ
;

82327 
pP¨£
->
nMem
 = 
	`MAX
’P¨£->nMem, 
ªgCﬁ
+
nCﬁ
+1);

82329 
addrNext
 = 
	`sqlôe3VdbeCuºítAddr
(
v
);

82330 
	`ˇŒSètGë
(
v
, 
ªgSèt4
, 
STAT_GET_ROWID
, 
ªgSam∂eRowid
);

82331 
addrIsNuŒ
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_IsNuŒ
, 
ªgSam∂eRowid
);

82332 
	`ˇŒSètGë
(
v
, 
ªgSèt4
, 
STAT_GET_NEQ
, 
ªgEq
);

82333 
	`ˇŒSètGë
(
v
, 
ªgSèt4
, 
STAT_GET_NLT
, 
ªgLt
);

82334 
	`ˇŒSètGë
(
v
, 
ªgSèt4
, 
STAT_GET_NDLT
, 
ªgDLt
);

82335 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_NŸExi°s
, 
iTabCur
, 
addrNext
, 
ªgSam∂eRowid
);

82336 #ifde‡
SQLITE_ENABLE_STAT3


82337 
	`sqlôe3Ex¥CodeGëCﬁumnOfTabÀ
(
v
, 
pTab
, 
iTabCur
,

82338 
pIdx
->
aiCﬁumn
[0], 
ªgSam∂e
);

82340 
i
=0; i<
nCﬁ
; i++){

82341 
iCﬁ
 = 
pIdx
->
aiCﬁumn
[
i
];

82342 
	`sqlôe3Ex¥CodeGëCﬁumnOfTabÀ
(
v
, 
pTab
, 
iTabCur
, 
iCﬁ
, 
ªgCﬁ
+
i
);

82344 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_MakeRec‹d
, 
ªgCﬁ
, 
nCﬁ
+1, 
ªgSam∂e
);

82346 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_MakeRec‹d
, 
ªgTab«me
, 6, 
ªgTemp
, "bbbbbb", 0);

82347 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NewRowid
, 
iSètCur
+1, 
ªgNewRowid
);

82348 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_In£π
, 
iSètCur
+1, 
ªgTemp
, 
ªgNewRowid
);

82349 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_GŸo
, 0, 
addrNext
);

82350 
	`sqlôe3VdbeJumpHîe
(
v
, 
addrIsNuŒ
);

82355 
	`sqlôe3VdbeJumpHîe
(
v
, 
addrRewöd
);

82356 
	`sqlôe3DbFªe
(
db
, 
aGŸoChng
);

82363 if–
pO∆yIdx
==0 && 
√edTabÀC¡
 ){

82364 
	`VdbeCommít
((
v
, "%s", 
pTab
->
zName
));

82365 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Cou¡
, 
iTabCur
, 
ªgSèt1
);

82366 
jZîoRows
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_IfNŸ
, 
ªgSèt1
);

82367 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NuŒ
, 0, 
ªgIdx«me
);

82368 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_MakeRec‹d
, 
ªgTab«me
, 3, 
ªgTemp
, "aaa", 0);

82369 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NewRowid
, 
iSètCur
, 
ªgNewRowid
);

82370 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_In£π
, 
iSètCur
, 
ªgTemp
, 
ªgNewRowid
);

82371 
	`sqlôe3VdbeCh™geP5
(
v
, 
OPFLAG_APPEND
);

82372 
	`sqlôe3VdbeJumpHîe
(
v
, 
jZîoRows
);

82381 
	`lﬂdA«lysis
(
P¨£
 *
pP¨£
, 
iDb
){

82382 
Vdbe
 *
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

82383 if–
v
 ){

82384 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_LﬂdA«lysis
, 
iDb
);

82391 
	`™ÆyzeD©aba£
(
P¨£
 *
pP¨£
, 
iDb
){

82392 
sqlôe3
 *
db
 = 
pP¨£
->db;

82393 
Schema
 *
pSchema
 = 
db
->
aDb
[
iDb
].pSchema;

82394 
HashEÀm
 *
k
;

82395 
iSètCur
;

82396 
iMem
;

82397 
iTab
;

82399 
	`sqlôe3BegöWrôeO≥øti⁄
(
pP¨£
, 0, 
iDb
);

82400 
iSètCur
 = 
pP¨£
->
nTab
;

82401 
pP¨£
->
nTab
 += 3;

82402 
	`›íSètTabÀ
(
pP¨£
, 
iDb
, 
iSètCur
, 0, 0);

82403 
iMem
 = 
pP¨£
->
nMem
+1;

82404 
iTab
 = 
pP¨£
->
nTab
;

82405 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 
iDb
, 0) );

82406 
k
=
	`sqlôeHashFú°
(&
pSchema
->
tblHash
); k; k=
	`sqlôeHashNext
(k)){

82407 
TabÀ
 *
pTab
 = (TabÀ*)
	`sqlôeHashD©a
(
k
);

82408 
	`™ÆyzeO√TabÀ
(
pP¨£
, 
pTab
, 0, 
iSètCur
, 
iMem
, 
iTab
);

82410 
	`lﬂdA«lysis
(
pP¨£
, 
iDb
);

82418 
	`™ÆyzeTabÀ
(
P¨£
 *
pP¨£
, 
TabÀ
 *
pTab
, 
Index
 *
pO∆yIdx
){

82419 
iDb
;

82420 
iSètCur
;

82422 
	`as£π
–
pTab
!=0 );

82423 
	`as£π
–
	`sqlôe3BåìHﬁdsAŒMuãxes
(
pP¨£
->
db
) );

82424 
iDb
 = 
	`sqlôe3SchemaToIndex
(
pP¨£
->
db
, 
pTab
->
pSchema
);

82425 
	`sqlôe3BegöWrôeO≥øti⁄
(
pP¨£
, 0, 
iDb
);

82426 
iSètCur
 = 
pP¨£
->
nTab
;

82427 
pP¨£
->
nTab
 += 3;

82428 if–
pO∆yIdx
 ){

82429 
	`›íSètTabÀ
(
pP¨£
, 
iDb
, 
iSètCur
, 
pO∆yIdx
->
zName
, "idx");

82431 
	`›íSètTabÀ
(
pP¨£
, 
iDb
, 
iSètCur
, 
pTab
->
zName
, "tbl");

82433 
	`™ÆyzeO√TabÀ
(
pP¨£
, 
pTab
, 
pO∆yIdx
, 
iSètCur
,pP¨£->
nMem
+1,pP¨£->
nTab
);

82434 
	`lﬂdA«lysis
(
pP¨£
, 
iDb
);

82449 
SQLITE_PRIVATE
 
	`sqlôe3A«lyze
(
P¨£
 *
pP¨£
, 
Tokí
 *
pName1
, Tokí *
pName2
){

82450 
sqlôe3
 *
db
 = 
pP¨£
->db;

82451 
iDb
;

82452 
i
;

82453 *
z
, *
zDb
;

82454 
TabÀ
 *
pTab
;

82455 
Index
 *
pIdx
;

82456 
Tokí
 *
pTabÀName
;

82460 
	`as£π
–
	`sqlôe3BåìHﬁdsAŒMuãxes
(
pP¨£
->
db
) );

82461 if–
SQLITE_OK
!=
	`sqlôe3RódSchema
(
pP¨£
) ){

82465 
	`as£π
–
pName2
!=0 || 
pName1
==0 );

82466 if–
pName1
==0 ){

82468 
i
=0; i<
db
->
nDb
; i++){

82469 if–
i
==1 ) ;

82470 
	`™ÆyzeD©aba£
(
pP¨£
, 
i
);

82472 }if–
pName2
->
n
==0 ){

82474 
iDb
 = 
	`sqlôe3FödDb
(
db
, 
pName1
);

82475 if–
iDb
>=0 ){

82476 
	`™ÆyzeD©aba£
(
pP¨£
, 
iDb
);

82478 
z
 = 
	`sqlôe3NameFromTokí
(
db
, 
pName1
);

82479 if–
z
 ){

82480 if–(
pIdx
 = 
	`sqlôe3FödIndex
(
db
, 
z
, 0))!=0 ){

82481 
	`™ÆyzeTabÀ
(
pP¨£
, 
pIdx
->
pTabÀ
,ÖIdx);

82482 }if–(
pTab
 = 
	`sqlôe3LoˇãTabÀ
(
pP¨£
, 0, 
z
, 0))!=0 ){

82483 
	`™ÆyzeTabÀ
(
pP¨£
, 
pTab
, 0);

82485 
	`sqlôe3DbFªe
(
db
, 
z
);

82490 
iDb
 = 
	`sqlôe3TwoP¨tName
(
pP¨£
, 
pName1
, 
pName2
, &
pTabÀName
);

82491 if–
iDb
>=0 ){

82492 
zDb
 = 
db
->
aDb
[
iDb
].
zName
;

82493 
z
 = 
	`sqlôe3NameFromTokí
(
db
, 
pTabÀName
);

82494 if–
z
 ){

82495 if–(
pIdx
 = 
	`sqlôe3FödIndex
(
db
, 
z
, 
zDb
))!=0 ){

82496 
	`™ÆyzeTabÀ
(
pP¨£
, 
pIdx
->
pTabÀ
,ÖIdx);

82497 }if–(
pTab
 = 
	`sqlôe3LoˇãTabÀ
(
pP¨£
, 0, 
z
, 
zDb
))!=0 ){

82498 
	`™ÆyzeTabÀ
(
pP¨£
, 
pTab
, 0);

82500 
	`sqlôe3DbFªe
(
db
, 
z
);

82510 
™ÆysisInfo
 
	t™ÆysisInfo
;

82511 
	s™ÆysisInfo
 {

82512 
sqlôe3
 *
db
;

82513 c⁄° *
zD©aba£
;

82521 
	`decodeI¡Aºay
(

82522 *
zI¡Aºay
,

82523 
nOut
,

82524 
tRow˙t
 *
aOut
,

82525 
Index
 *
pIndex


82527 *
z
 = 
zI¡Aºay
;

82528 
c
;

82529 
i
;

82530 
tRow˙t
 
v
;

82532 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


82533 if–
z
==0 ) z = "";

82535 if–
	`NEVER
(
z
==0) ) z = "";

82537 
i
=0; *
z
 && i<
nOut
; i++){

82538 
v
 = 0;

82539  (
c
=
z
[0])>='0' && c<='9' ){

82540 
v
 = v*10 + 
c
 - '0';

82541 
z
++;

82543 
aOut
[
i
] = 
v
;

82544 if–*
z
==' ' ) z++;

82546 #i‚de‡
SQLITE_ENABLE_STAT3_OR_STAT4


82547 
	`as£π
–
pIndex
!=0 );

82549 if–
pIndex
 )

82552 if–
	`°rcmp
(
z
, "unordered")==0 ){

82553 
pIndex
->
bUn‹dîed
 = 1;

82554 }if–
	`sqlôe3_°rglob
("sz=[0-9]*", 
z
)==0 ){

82555 
v32
 = 0;

82556 
	`sqlôe3GëI¡32
(
z
+3, &
v32
);

82557 
pIndex
->
szIdxRow
 = 
	`sqlôe3LogE°
(
v32
);

82573 
	`™ÆysisLﬂdî
(*
pD©a
, 
¨gc
, **
¨gv
, **
NŸU£d
){

82574 
™ÆysisInfo
 *
pInfo
 = (™ÆysisInfo*)
pD©a
;

82575 
Index
 *
pIndex
;

82576 
TabÀ
 *
pTabÀ
;

82577 c⁄° *
z
;

82579 
	`as£π
–
¨gc
==3 );

82580 
	`UNUSED_PARAMETER2
(
NŸU£d
, 
¨gc
);

82582 if–
¨gv
==0 ||árgv[0]==0 ||árgv[2]==0 ){

82585 
pTabÀ
 = 
	`sqlôe3FödTabÀ
(
pInfo
->
db
, 
¨gv
[0],ÖInfo->
zD©aba£
);

82586 if–
pTabÀ
==0 ){

82589 if–
¨gv
[1] ){

82590 
pIndex
 = 
	`sqlôe3FödIndex
(
pInfo
->
db
, 
¨gv
[1],ÖInfo->
zD©aba£
);

82592 
pIndex
 = 0;

82594 
z
 = 
¨gv
[2];

82596 if–
pIndex
 ){

82597 
	`decodeI¡Aºay
((*)
z
, 
pIndex
->
nCﬁumn
+1,ÖIndex->
aiRowE°
,ÖIndex);

82598 if–
pIndex
->
pP¨tIdxWhîe
==0 ) 
pTabÀ
->
nRowE°
 =ÖIndex->
aiRowE°
[0];

82600 
Index
 
ÁkeIdx
;

82601 
ÁkeIdx
.
szIdxRow
 = 
pTabÀ
->
szTabRow
;

82602 
	`decodeI¡Aºay
((*)
z
, 1, &
pTabÀ
->
nRowE°
, &
ÁkeIdx
);

82603 
pTabÀ
->
szTabRow
 = 
ÁkeIdx
.
szIdxRow
;

82613 
SQLITE_PRIVATE
 
	`sqlôe3DñëeIndexSam∂es
(
sqlôe3
 *
db
, 
Index
 *
pIdx
){

82614 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


82615 if–
pIdx
->
aSam∂e
 ){

82616 
j
;

82617 
j
=0; j<
pIdx
->
nSam∂e
; j++){

82618 
IndexSam∂e
 *
p
 = &
pIdx
->
aSam∂e
[
j
];

82619 
	`sqlôe3DbFªe
(
db
, 
p
->p);

82621 
	`sqlôe3DbFªe
(
db
, 
pIdx
->
aSam∂e
);

82623 if–
db
 && db->
≤ByãsFªed
==0 ){

82624 
pIdx
->
nSam∂e
 = 0;

82625 
pIdx
->
aSam∂e
 = 0;

82628 
	`UNUSED_PARAMETER
(
db
);

82629 
	`UNUSED_PARAMETER
(
pIdx
);

82633 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


82638 
	`öôAvgEq
(
Index
 *
pIdx
){

82639 if–
pIdx
 ){

82640 
IndexSam∂e
 *
aSam∂e
 = 
pIdx
->aSample;

82641 
IndexSam∂e
 *
pFöÆ
 = &
aSam∂e
[
pIdx
->
nSam∂e
-1];

82642 
iCﬁ
;

82643 
iCﬁ
=0; iCﬁ<
pIdx
->
nCﬁumn
; iCol++){

82644 
i
;

82645 
tRow˙t
 
sumEq
 = 0;

82646 
tRow˙t
 
nSum
 = 0;

82647 
tRow˙t
 
avgEq
 = 0;

82648 
tRow˙t
 
nDLt
 = 
pFöÆ
->
™DLt
[
iCﬁ
];

82655 
i
=0; i<(
pIdx
->
nSam∂e
-1); i++){

82656 if–
aSam∂e
[
i
].
™DLt
[
iCﬁ
]!=aSample[i+1].anDLt[iCol] ){

82657 
sumEq
 +
aSam∂e
[
i
].
™Eq
[
iCﬁ
];

82658 
nSum
++;

82661 if–
nDLt
>
nSum
 ){

82662 
avgEq
 = (
pFöÆ
->
™Lt
[
iCﬁ
] - 
sumEq
)/(
nDLt
 - 
nSum
);

82664 if–
avgEq
==0 )ávgEq = 1;

82665 
pIdx
->
aAvgEq
[
iCﬁ
] = 
avgEq
;

82666 if–
pIdx
->
nSam∂eCﬁ
==1 ) ;

82684 
	`lﬂdSètTbl
(

82685 
sqlôe3
 *
db
,

82686 
bSèt3
,

82687 c⁄° *
zSql1
,

82688 c⁄° *
zSql2
,

82689 c⁄° *
zDb


82691 
rc
;

82692 
sqlôe3_°mt
 *
pStmt
 = 0;

82693 *
zSql
;

82694 
Index
 *
pPªvIdx
 = 0;

82695 
IndexSam∂e
 *
pSam∂e
;

82697 
	`as£π
–
db
->
lookaside
.
bE«bÀd
==0 );

82698 
zSql
 = 
	`sqlôe3MPrötf
(
db
, 
zSql1
, 
zDb
);

82699 if–!
zSql
 ){

82700  
SQLITE_NOMEM
;

82702 
rc
 = 
	`sqlôe3_¥ï¨e
(
db
, 
zSql
, -1, &
pStmt
, 0);

82703 
	`sqlôe3DbFªe
(
db
, 
zSql
);

82704 if–
rc
 ) Ñc;

82706  
	`sqlôe3_°ï
(
pStmt
)==
SQLITE_ROW
 ){

82707 
nIdxCﬁ
 = 1;

82708 
nAvgCﬁ
 = 1;

82710 *
zIndex
;

82711 
Index
 *
pIdx
;

82712 
nSam∂e
;

82713 
nByã
;

82714 
i
;

82715 
tRow˙t
 *
pS∑˚
;

82717 
zIndex
 = (*)
	`sqlôe3_cﬁumn_ãxt
(
pStmt
, 0);

82718 if–
zIndex
==0 ) ;

82719 
nSam∂e
 = 
	`sqlôe3_cﬁumn_öt
(
pStmt
, 1);

82720 
pIdx
 = 
	`sqlôe3FödIndex
(
db
, 
zIndex
, 
zDb
);

82721 
	`as£π
–
pIdx
==0 || 
bSèt3
 ||ÖIdx->
nSam∂e
==0 );

82724 if–
pIdx
==0 ||ÖIdx->
nSam∂e
 ) ;

82725 if–
bSèt3
==0 ){

82726 
nIdxCﬁ
 = 
pIdx
->
nCﬁumn
+1;

82727 
nAvgCﬁ
 = 
pIdx
->
nCﬁumn
;

82729 
pIdx
->
nSam∂eCﬁ
 = 
nIdxCﬁ
;

82730 
nByã
 = (
IndexSam∂e
Ë* 
nSam∂e
;

82731 
nByã
 +(
tRow˙t
Ë* 
nIdxCﬁ
 * 3 * 
nSam∂e
;

82732 
nByã
 +
nAvgCﬁ
 * (
tRow˙t
);

82734 
pIdx
->
aSam∂e
 = 
	`sqlôe3DbMÆlocZîo
(
db
, 
nByã
);

82735 if–
pIdx
->
aSam∂e
==0 ){

82736 
	`sqlôe3_föÆize
(
pStmt
);

82737  
SQLITE_NOMEM
;

82739 
pS∑˚
 = (
tRow˙t
*)&
pIdx
->
aSam∂e
[
nSam∂e
];

82740 
pIdx
->
aAvgEq
 = 
pS∑˚
;ÖS∑˚ +
nAvgCﬁ
;

82741 
i
=0; i<
nSam∂e
; i++){

82742 
pIdx
->
aSam∂e
[
i
].
™Eq
 = 
pS∑˚
;ÖS∑˚ +
nIdxCﬁ
;

82743 
pIdx
->
aSam∂e
[
i
].
™Lt
 = 
pS∑˚
;ÖS∑˚ +
nIdxCﬁ
;

82744 
pIdx
->
aSam∂e
[
i
].
™DLt
 = 
pS∑˚
;ÖS∑˚ +
nIdxCﬁ
;

82746 
	`as£π
–((
u8
*)
pS∑˚
)-
nByã
==(u8*)(
pIdx
->
aSam∂e
) );

82748 
rc
 = 
	`sqlôe3_föÆize
(
pStmt
);

82749 if–
rc
 ) Ñc;

82751 
zSql
 = 
	`sqlôe3MPrötf
(
db
, 
zSql2
, 
zDb
);

82752 if–!
zSql
 ){

82753  
SQLITE_NOMEM
;

82755 
rc
 = 
	`sqlôe3_¥ï¨e
(
db
, 
zSql
, -1, &
pStmt
, 0);

82756 
	`sqlôe3DbFªe
(
db
, 
zSql
);

82757 if–
rc
 ) Ñc;

82759  
	`sqlôe3_°ï
(
pStmt
)==
SQLITE_ROW
 ){

82760 *
zIndex
;

82761 
Index
 *
pIdx
;

82762 
nCﬁ
 = 1;

82764 
zIndex
 = (*)
	`sqlôe3_cﬁumn_ãxt
(
pStmt
, 0);

82765 if–
zIndex
==0 ) ;

82766 
pIdx
 = 
	`sqlôe3FödIndex
(
db
, 
zIndex
, 
zDb
);

82767 if–
pIdx
==0 ) ;

82770 
nCﬁ
 = 
pIdx
->
nSam∂eCﬁ
;

82771 if–
bSèt3
 && 
nCﬁ
>1 ) ;

82772 if–
pIdx
!=
pPªvIdx
 ){

82773 
	`öôAvgEq
(
pPªvIdx
);

82774 
pPªvIdx
 = 
pIdx
;

82776 
pSam∂e
 = &
pIdx
->
aSam∂e
[pIdx->
nSam∂e
];

82777 
	`decodeI¡Aºay
((*)
	`sqlôe3_cﬁumn_ãxt
(
pStmt
,1), 
nCﬁ
, 
pSam∂e
->
™Eq
, 0);

82778 
	`decodeI¡Aºay
((*)
	`sqlôe3_cﬁumn_ãxt
(
pStmt
,2), 
nCﬁ
, 
pSam∂e
->
™Lt
, 0);

82779 
	`decodeI¡Aºay
((*)
	`sqlôe3_cﬁumn_ãxt
(
pStmt
,3), 
nCﬁ
, 
pSam∂e
->
™DLt
,0);

82787 
pSam∂e
->
n
 = 
	`sqlôe3_cﬁumn_byãs
(
pStmt
, 4);

82788 
pSam∂e
->
p
 = 
	`sqlôe3DbMÆlocZîo
(
db
,ÖSam∂e->
n
 + 2);

82789 if–
pSam∂e
->
p
==0 ){

82790 
	`sqlôe3_föÆize
(
pStmt
);

82791  
SQLITE_NOMEM
;

82793 
	`mem˝y
(
pSam∂e
->
p
, 
	`sqlôe3_cﬁumn_blob
(
pStmt
, 4),ÖSam∂e->
n
);

82794 
pIdx
->
nSam∂e
++;

82796 
rc
 = 
	`sqlôe3_föÆize
(
pStmt
);

82797 if–
rc
==
SQLITE_OK
 ) 
	`öôAvgEq
(
pPªvIdx
);

82798  
rc
;

82805 
	`lﬂdSèt4
(
sqlôe3
 *
db
, c⁄° *
zDb
){

82806 
rc
 = 
SQLITE_OK
;

82808 
	`as£π
–
db
->
lookaside
.
bE«bÀd
==0 );

82809 if–
	`sqlôe3FödTabÀ
(
db
, "sqlôe_°©4", 
zDb
) ){

82810 
rc
 = 
	`lﬂdSètTbl
(
db
, 0,

82813 
zDb


82817 if–
rc
==
SQLITE_OK
 && 
	`sqlôe3FödTabÀ
(
db
, "sqlôe_°©3", 
zDb
) ){

82818 
rc
 = 
	`lﬂdSètTbl
(
db
, 1,

82821 
zDb


82825  
rc
;

82849 
SQLITE_PRIVATE
 
	`sqlôe3A«lysisLﬂd
(
sqlôe3
 *
db
, 
iDb
){

82850 
™ÆysisInfo
 
sInfo
;

82851 
HashEÀm
 *
i
;

82852 *
zSql
;

82853 
rc
;

82855 
	`as£π
–
iDb
>=0 && iDb<
db
->
nDb
 );

82856 
	`as£π
–
db
->
aDb
[
iDb
].
pBt
!=0 );

82859 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 
iDb
, 0) );

82860 
i
=
	`sqlôeHashFú°
(&
db
->
aDb
[
iDb
].
pSchema
->
idxHash
);i;i=
	`sqlôeHashNext
(i)){

82861 
Index
 *
pIdx
 = 
	`sqlôeHashD©a
(
i
);

82862 
	`sqlôe3DeÁu…RowE°
(
pIdx
);

82863 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


82864 
	`sqlôe3DñëeIndexSam∂es
(
db
, 
pIdx
);

82865 
pIdx
->
aSam∂e
 = 0;

82870 
sInfo
.
db
 = db;

82871 
sInfo
.
zD©aba£
 = 
db
->
aDb
[
iDb
].
zName
;

82872 if–
	`sqlôe3FödTabÀ
(
db
, "sqlôe_°©1", 
sInfo
.
zD©aba£
)==0 ){

82873  
SQLITE_ERROR
;

82877 
zSql
 = 
	`sqlôe3MPrötf
(
db
,

82878 "SELECTÅbl,idx,°© FROM %Q.sqlôe_°©1", 
sInfo
.
zD©aba£
);

82879 if–
zSql
==0 ){

82880 
rc
 = 
SQLITE_NOMEM
;

82882 
rc
 = 
	`sqlôe3_exec
(
db
, 
zSql
, 
™ÆysisLﬂdî
, &
sInfo
, 0);

82883 
	`sqlôe3DbFªe
(
db
, 
zSql
);

82888 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


82889 if–
rc
==
SQLITE_OK
 ){

82890 
lookasideE«bÀd
 = 
db
->
lookaside
.
bE«bÀd
;

82891 
db
->
lookaside
.
bE«bÀd
 = 0;

82892 
rc
 = 
	`lﬂdSèt4
(
db
, 
sInfo
.
zD©aba£
);

82893 
db
->
lookaside
.
bE«bÀd
 = 
lookasideE«bÀd
;

82897 if–
rc
==
SQLITE_NOMEM
 ){

82898 
db
->
mÆlocFaûed
 = 1;

82900  
rc
;

82922 #i‚de‡
SQLITE_OMIT_ATTACH


82941 
	`ªsﬁveAâachEx¥
(
NameC⁄ãxt
 *
pName
, 
Ex¥
 *
pEx¥
)

82943 
rc
 = 
SQLITE_OK
;

82944 if–
pEx¥
 ){

82945 if–
pEx¥
->
›
!=
TK_ID
 ){

82946 
rc
 = 
	`sqlôe3ResﬁveEx¥Names
(
pName
, 
pEx¥
);

82947 if–
rc
==
SQLITE_OK
 && !
	`sqlôe3Ex¥IsC⁄°™t
(
pEx¥
) ){

82948 
	`sqlôe3Eº‹Msg
(
pName
->
pP¨£
, "övÆidÇame: \"%s\"", 
pEx¥
->
u
.
zTokí
);

82949  
SQLITE_ERROR
;

82952 
pEx¥
->
›
 = 
TK_STRING
;

82955  
rc
;

82969 
	`©èchFunc
(

82970 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

82971 
NŸU£d
,

82972 
sqlôe3_vÆue
 **
¨gv


82974 
i
;

82975 
rc
 = 0;

82976 
sqlôe3
 *
db
 = 
	`sqlôe3_c⁄ãxt_db_h™dÀ
(
c⁄ãxt
);

82977 c⁄° *
zName
;

82978 c⁄° *
zFûe
;

82979 *
zP©h
 = 0;

82980 *
zEº
 = 0;

82981 
Êags
;

82982 
Db
 *
aNew
;

82983 *
zEºDyn
 = 0;

82984 
sqlôe3_vfs
 *
pVfs
;

82986 
	`UNUSED_PARAMETER
(
NŸU£d
);

82988 
zFûe
 = (c⁄° *)
	`sqlôe3_vÆue_ãxt
(
¨gv
[0]);

82989 
zName
 = (c⁄° *)
	`sqlôe3_vÆue_ãxt
(
¨gv
[1]);

82990 if–
zFûe
==0 ) zFile = "";

82991 if–
zName
==0 ) zName = "";

82999 if–
db
->
nDb
>=db->
aLimô
[
SQLITE_LIMIT_ATTACHED
]+2 ){

83000 
zEºDyn
 = 
	`sqlôe3MPrötf
(
db
, "too manyáttached databases - max %d",

83001 
db
->
aLimô
[
SQLITE_LIMIT_ATTACHED
]

83003 
©èch_îr‹
;

83005 if–!
db
->
autoCommô
 ){

83006 
zEºDyn
 = 
	`sqlôe3MPrötf
(
db
, "cannot ATTACH database withinÅransaction");

83007 
©èch_îr‹
;

83009 
i
=0; i<
db
->
nDb
; i++){

83010 *
z
 = 
db
->
aDb
[
i
].
zName
;

83011 
	`as£π
–
z
 && 
zName
 );

83012 if–
	`sqlôe3SåICmp
(
z
, 
zName
)==0 ){

83013 
zEºDyn
 = 
	`sqlôe3MPrötf
(
db
, "d©aba£ %†i†Æªady i¿u£", 
zName
);

83014 
©èch_îr‹
;

83021 if–
db
->
aDb
==db->
aDbSètic
 ){

83022 
aNew
 = 
	`sqlôe3DbMÆlocRaw
(
db
, (db->
aDb
[0])*3 );

83023 if–
aNew
==0 ) ;

83024 
	`mem˝y
(
aNew
, 
db
->
aDb
, (db->aDb[0])*2);

83026 
aNew
 = 
	`sqlôe3DbRóŒoc
(
db
, db->
aDb
, (db->aDb[0])*(db->
nDb
+1) );

83027 if–
aNew
==0 ) ;

83029 
db
->
aDb
 = 
aNew
;

83030 
aNew
 = &
db
->
aDb
[db->
nDb
];

83031 
	`mem£t
(
aNew
, 0, (*aNew));

83037 
Êags
 = 
db
->
›íFœgs
;

83038 
rc
 = 
	`sqlôe3P¨£Uri
(
db
->
pVfs
->
zName
, 
zFûe
, &
Êags
, &pVfs, &
zP©h
, &
zEº
);

83039 if–
rc
!=
SQLITE_OK
 ){

83040 if–
rc
==
SQLITE_NOMEM
 ) 
db
->
mÆlocFaûed
 = 1;

83041 
	`sqlôe3_ªsu…_îr‹
(
c⁄ãxt
, 
zEº
, -1);

83042 
	`sqlôe3_‰ì
(
zEº
);

83045 
	`as£π
–
pVfs
 );

83046 
Êags
 |
SQLITE_OPEN_MAIN_DB
;

83047 
rc
 = 
	`sqlôe3BåìO≥n
(
pVfs
, 
zP©h
, 
db
, &
aNew
->
pBt
, 0, 
Êags
);

83048 
	`sqlôe3_‰ì
–
zP©h
 );

83049 
db
->
nDb
++;

83050 if–
rc
==
SQLITE_CONSTRAINT
 ){

83051 
rc
 = 
SQLITE_ERROR
;

83052 
zEºDyn
 = 
	`sqlôe3MPrötf
(
db
, "database isálreadyáttached");

83053 }if–
rc
==
SQLITE_OK
 ){

83054 
Pagî
 *
pPagî
;

83055 
aNew
->
pSchema
 = 
	`sqlôe3SchemaGë
(
db
,áNew->
pBt
);

83056 if–!
aNew
->
pSchema
 ){

83057 
rc
 = 
SQLITE_NOMEM
;

83058 }if–
aNew
->
pSchema
->
fûe_f‹m©
 &&áNew->pSchema->
íc
!=
	`ENC
(
db
) ){

83059 
zEºDyn
 = 
	`sqlôe3MPrötf
(
db
,

83061 
rc
 = 
SQLITE_ERROR
;

83063 
pPagî
 = 
	`sqlôe3BåìPagî
(
aNew
->
pBt
);

83064 
	`sqlôe3PagîLockögMode
(
pPagî
, 
db
->
dÊtLockMode
);

83065 
	`sqlôe3BåìSecuªDñëe
(
aNew
->
pBt
,

83066 
	`sqlôe3BåìSecuªDñëe
(
db
->
aDb
[0].
pBt
,-1) );

83067 #i‚de‡
SQLITE_OMIT_PAGER_PRAGMAS


83068 
	`sqlôe3BåìSëPagîFœgs
(
aNew
->
pBt
, 3 | (
db
->
Êags
 & 
PAGER_FLAGS_MASK
));

83071 
aNew
->
ß„ty_Àvñ
 = 3;

83072 
aNew
->
zName
 = 
	`sqlôe3DbSåDup
(
db
, zName);

83073 if–
rc
==
SQLITE_OK
 && 
aNew
->
zName
==0 ){

83074 
rc
 = 
SQLITE_NOMEM
;

83078 #ifde‡
SQLITE_HAS_CODEC


83079 if–
rc
==
SQLITE_OK
 ){

83080 
	`sqlôe3CodecAâach
(
sqlôe3
*, , const *, );

83081 
	`sqlôe3CodecGëKey
(
sqlôe3
*, , **, *);

83082 
nKey
;

83083 *
zKey
;

83084 
t
 = 
	`sqlôe3_vÆue_ty≥
(
¨gv
[2]);

83085  
t
 ){

83086 
SQLITE_INTEGER
:

83087 
SQLITE_FLOAT
:

83088 
zEºDyn
 = 
	`sqlôe3DbSåDup
(
db
, "Invalid key value");

83089 
rc
 = 
SQLITE_ERROR
;

83092 
SQLITE_TEXT
:

83093 
SQLITE_BLOB
:

83094 
nKey
 = 
	`sqlôe3_vÆue_byãs
(
¨gv
[2]);

83095 
zKey
 = (*)
	`sqlôe3_vÆue_blob
(
¨gv
[2]);

83096 
rc
 = 
	`sqlôe3CodecAâach
(
db
, db->
nDb
-1, 
zKey
, 
nKey
);

83099 
SQLITE_NULL
:

83101 
	`sqlôe3CodecGëKey
(
db
, 0, (**)&
zKey
, &
nKey
);

83102 if–
nKey
>0 || 
	`sqlôe3BåìGëRe£rve
(
db
->
aDb
[0].
pBt
)>0 ){

83103 
rc
 = 
	`sqlôe3CodecAâach
(
db
, db->
nDb
-1, 
zKey
, 
nKey
);

83115 if–
rc
==
SQLITE_OK
 ){

83116 
	`sqlôe3BåìE¡îAŒ
(
db
);

83117 
rc
 = 
	`sqlôe3Inô
(
db
, &
zEºDyn
);

83118 
	`sqlôe3BåìLóveAŒ
(
db
);

83120 if–
rc
 ){

83121 
iDb
 = 
db
->
nDb
 - 1;

83122 
	`as£π
–
iDb
>=2 );

83123 if–
db
->
aDb
[
iDb
].
pBt
 ){

83124 
	`sqlôe3BåìClo£
(
db
->
aDb
[
iDb
].
pBt
);

83125 
db
->
aDb
[
iDb
].
pBt
 = 0;

83126 
db
->
aDb
[
iDb
].
pSchema
 = 0;

83128 
	`sqlôe3Re£tAŒSchemasOfC⁄√˘i⁄
(
db
);

83129 
db
->
nDb
 = 
iDb
;

83130 if–
rc
==
SQLITE_NOMEM
 ||Ñc==
SQLITE_IOERR_NOMEM
 ){

83131 
db
->
mÆlocFaûed
 = 1;

83132 
	`sqlôe3DbFªe
(
db
, 
zEºDyn
);

83133 
zEºDyn
 = 
	`sqlôe3MPrötf
(
db
, "out of memory");

83134 }if–
zEºDyn
==0 ){

83135 
zEºDyn
 = 
	`sqlôe3MPrötf
(
db
, "u«bÀÅÿ›í d©aba£: %s", 
zFûe
);

83137 
©èch_îr‹
;

83142 
©èch_îr‹
:

83144 if–
zEºDyn
 ){

83145 
	`sqlôe3_ªsu…_îr‹
(
c⁄ãxt
, 
zEºDyn
, -1);

83146 
	`sqlôe3DbFªe
(
db
, 
zEºDyn
);

83148 if–
rc
 ) 
	`sqlôe3_ªsu…_îr‹_code
(
c⁄ãxt
,Ñc);

83159 
	`dëachFunc
(

83160 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

83161 
NŸU£d
,

83162 
sqlôe3_vÆue
 **
¨gv


83164 c⁄° *
zName
 = (c⁄° *)
	`sqlôe3_vÆue_ãxt
(
¨gv
[0]);

83165 
sqlôe3
 *
db
 = 
	`sqlôe3_c⁄ãxt_db_h™dÀ
(
c⁄ãxt
);

83166 
i
;

83167 
Db
 *
pDb
 = 0;

83168 
zEº
[128];

83170 
	`UNUSED_PARAMETER
(
NŸU£d
);

83172 if–
zName
==0 ) zName = "";

83173 
i
=0; i<
db
->
nDb
; i++){

83174 
pDb
 = &
db
->
aDb
[
i
];

83175 if–
pDb
->
pBt
==0 ) ;

83176 if–
	`sqlôe3SåICmp
(
pDb
->
zName
, zName)==0 ) ;

83179 if–
i
>=
db
->
nDb
 ){

83180 
	`sqlôe3_¢¥ötf
((
zEº
),zEº, "nÿsuch d©aba£: %s", 
zName
);

83181 
dëach_îr‹
;

83183 if–
i
<2 ){

83184 
	`sqlôe3_¢¥ötf
((
zEº
),zEº, "ˇ¬Ÿ dëach d©aba£ %s", 
zName
);

83185 
dëach_îr‹
;

83187 if–!
db
->
autoCommô
 ){

83188 
	`sqlôe3_¢¥ötf
((
zEº
), zErr,

83190 
dëach_îr‹
;

83192 if–
	`sqlôe3BåìIsInRódTøns
(
pDb
->
pBt
Ë|| 
	`sqlôe3BåìIsInBackup
(pDb->pBt) ){

83193 
	`sqlôe3_¢¥ötf
((
zEº
),zEº, "d©aba£ %†i†locked", 
zName
);

83194 
dëach_îr‹
;

83197 
	`sqlôe3BåìClo£
(
pDb
->
pBt
);

83198 
pDb
->
pBt
 = 0;

83199 
pDb
->
pSchema
 = 0;

83200 
	`sqlôe3Re£tAŒSchemasOfC⁄√˘i⁄
(
db
);

83203 
dëach_îr‹
:

83204 
	`sqlôe3_ªsu…_îr‹
(
c⁄ãxt
, 
zEº
, -1);

83211 
	`codeAâach
(

83212 
P¨£
 *
pP¨£
,

83213 
ty≥
,

83214 
FuncDef
 c⁄° *
pFunc
,

83215 
Ex¥
 *
pAuthArg
,

83216 
Ex¥
 *
pFûíame
,

83217 
Ex¥
 *
pDb«me
,

83218 
Ex¥
 *
pKey


83220 
rc
;

83221 
NameC⁄ãxt
 
sName
;

83222 
Vdbe
 *
v
;

83223 
sqlôe3
* 
db
 = 
pP¨£
->db;

83224 
ªgArgs
;

83226 
	`mem£t
(&
sName
, 0, (
NameC⁄ãxt
));

83227 
sName
.
pP¨£
 =ÖParse;

83230 
SQLITE_OK
!=(
rc
 = 
	`ªsﬁveAâachEx¥
(&
sName
, 
pFûíame
)) ||

83231 
SQLITE_OK
!=(
rc
 = 
	`ªsﬁveAâachEx¥
(&
sName
, 
pDb«me
)) ||

83232 
SQLITE_OK
!=(
rc
 = 
	`ªsﬁveAâachEx¥
(&
sName
, 
pKey
))

83234 
pP¨£
->
nEº
++;

83235 
©èch_íd
;

83238 #i‚de‡
SQLITE_OMIT_AUTHORIZATION


83239 if–
pAuthArg
 ){

83240 *
zAuthArg
;

83241 if–
pAuthArg
->
›
==
TK_STRING
 ){

83242 
zAuthArg
 = 
pAuthArg
->
u
.
zTokí
;

83244 
zAuthArg
 = 0;

83246 
rc
 = 
	`sqlôe3AuthCheck
(
pP¨£
, 
ty≥
, 
zAuthArg
, 0, 0);

83247 if(
rc
!=
SQLITE_OK
 ){

83248 
©èch_íd
;

83254 
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

83255 
ªgArgs
 = 
	`sqlôe3GëTempR™ge
(
pP¨£
, 4);

83256 
	`sqlôe3Ex¥Code
(
pP¨£
, 
pFûíame
, 
ªgArgs
);

83257 
	`sqlôe3Ex¥Code
(
pP¨£
, 
pDb«me
, 
ªgArgs
+1);

83258 
	`sqlôe3Ex¥Code
(
pP¨£
, 
pKey
, 
ªgArgs
+2);

83260 
	`as£π
–
v
 || 
db
->
mÆlocFaûed
 );

83261 if–
v
 ){

83262 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Fun˘i⁄
, 0, 
ªgArgs
+3-
pFunc
->
nArg
,ÑegArgs+3);

83263 
	`as£π
–
pFunc
->
nArg
==-1 || (pFunc->nArg&0xff)==pFunc->nArg );

83264 
	`sqlôe3VdbeCh™geP5
(
v
, (
u8
)(
pFunc
->
nArg
));

83265 
	`sqlôe3VdbeCh™geP4
(
v
, -1, (*)
pFunc
, 
P4_FUNCDEF
);

83271 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Expúe
, (
ty≥
==
SQLITE_ATTACH
));

83274 
©èch_íd
:

83275 
	`sqlôe3Ex¥Dñëe
(
db
, 
pFûíame
);

83276 
	`sqlôe3Ex¥Dñëe
(
db
, 
pDb«me
);

83277 
	`sqlôe3Ex¥Dñëe
(
db
, 
pKey
);

83285 
SQLITE_PRIVATE
 
	`sqlôe3Dëach
(
P¨£
 *
pP¨£
, 
Ex¥
 *
pDb«me
){

83286 c⁄° 
FuncDef
 
dëach_func
 = {

83288 
SQLITE_UTF8
,

83291 
dëachFunc
,

83298 
	`codeAâach
(
pP¨£
, 
SQLITE_DETACH
, &
dëach_func
, 
pDb«me
, 0, 0,ÖDbname);

83306 
SQLITE_PRIVATE
 
	`sqlôe3Aâach
(
P¨£
 *
pP¨£
, 
Ex¥
 *
p
, Ex¥ *
pDb«me
, Ex¥ *
pKey
){

83307 c⁄° 
FuncDef
 
©èch_func
 = {

83309 
SQLITE_UTF8
,

83312 
©èchFunc
,

83319 
	`codeAâach
(
pP¨£
, 
SQLITE_ATTACH
, &
©èch_func
, 
p
,Ö, 
pDb«me
, 
pKey
);

83327 
SQLITE_PRIVATE
 
	`sqlôe3FixInô
(

83328 
DbFixî
 *
pFix
,

83329 
P¨£
 *
pP¨£
,

83330 
iDb
,

83331 c⁄° *
zTy≥
,

83332 c⁄° 
Tokí
 *
pName


83334 
sqlôe3
 *
db
;

83336 
db
 = 
pP¨£
->db;

83337 
	`as£π
–
db
->
nDb
>
iDb
 );

83338 
pFix
->
pP¨£
 =ÖParse;

83339 
pFix
->
zDb
 = 
db
->
aDb
[
iDb
].
zName
;

83340 
pFix
->
pSchema
 = 
db
->
aDb
[
iDb
].pSchema;

83341 
pFix
->
zTy≥
 = zType;

83342 
pFix
->
pName
 =ÖName;

83343 
pFix
->
bV¨O∆y
 = (
iDb
==1);

83360 
SQLITE_PRIVATE
 
	`sqlôe3FixSrcLi°
(

83361 
DbFixî
 *
pFix
,

83362 
SrcLi°
 *
pLi°


83364 
i
;

83365 c⁄° *
zDb
;

83366 
SrcLi°_ôem
 *
pIãm
;

83368 if–
	`NEVER
(
pLi°
==0) )  0;

83369 
zDb
 = 
pFix
->zDb;

83370 
i
=0, 
pIãm
=
pLi°
->
a
; i<pLi°->
nSrc
; i++,ÖItem++){

83371 if–
pFix
->
bV¨O∆y
==0 ){

83372 if–
pIãm
->
zD©aba£
 && 
	`sqlôe3SåICmp
’Iãm->zD©aba£, 
zDb
) ){

83373 
	`sqlôe3Eº‹Msg
(
pFix
->
pP¨£
,

83375 
pFix
->
zTy≥
,ÖFix->
pName
, 
pIãm
->
zD©aba£
);

83378 
	`sqlôe3DbFªe
(
pFix
->
pP¨£
->
db
, 
pIãm
->
zD©aba£
);

83379 
pIãm
->
zD©aba£
 = 0;

83380 
pIãm
->
pSchema
 = 
pFix
->pSchema;

83382 #i‡!
	`deföed
(
SQLITE_OMIT_VIEW
Ë|| !deföed(
SQLITE_OMIT_TRIGGER
)

83383 if–
	`sqlôe3FixSñe˘
(
pFix
, 
pIãm
->
pSñe˘
) )  1;

83384 if–
	`sqlôe3FixEx¥
(
pFix
, 
pIãm
->
pOn
) )  1;

83389 #i‡!
	`deföed
(
SQLITE_OMIT_VIEW
Ë|| !deföed(
SQLITE_OMIT_TRIGGER
)

83390 
SQLITE_PRIVATE
 
	`sqlôe3FixSñe˘
(

83391 
DbFixî
 *
pFix
,

83392 
Sñe˘
 *
pSñe˘


83394  
pSñe˘
 ){

83395 if–
	`sqlôe3FixEx¥Li°
(
pFix
, 
pSñe˘
->
pELi°
) ){

83398 if–
	`sqlôe3FixSrcLi°
(
pFix
, 
pSñe˘
->
pSrc
) ){

83401 if–
	`sqlôe3FixEx¥
(
pFix
, 
pSñe˘
->
pWhîe
) ){

83404 if–
	`sqlôe3FixEx¥Li°
(
pFix
, 
pSñe˘
->
pGroupBy
) ){

83407 if–
	`sqlôe3FixEx¥
(
pFix
, 
pSñe˘
->
pHavög
) ){

83410 if–
	`sqlôe3FixEx¥Li°
(
pFix
, 
pSñe˘
->
pOrdîBy
) ){

83413 if–
	`sqlôe3FixEx¥
(
pFix
, 
pSñe˘
->
pLimô
) ){

83416 if–
	`sqlôe3FixEx¥
(
pFix
, 
pSñe˘
->
pOff£t
) ){

83419 
pSñe˘
 =ÖSñe˘->
pPri‹
;

83423 
SQLITE_PRIVATE
 
	`sqlôe3FixEx¥
(

83424 
DbFixî
 *
pFix
,

83425 
Ex¥
 *
pEx¥


83427  
pEx¥
 ){

83428 if–
pEx¥
->
›
==
TK_VARIABLE
 ){

83429 if–
pFix
->
pP¨£
->
db
->
öô
.
busy
 ){

83430 
pEx¥
->
›
 = 
TK_NULL
;

83432 
	`sqlôe3Eº‹Msg
(
pFix
->
pP¨£
, "%†ˇ¬Ÿ u£ v¨übÀs",ÖFix->
zTy≥
);

83436 if–
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_TokíO∆y
) ) ;

83437 if–
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_xIsSñe˘
) ){

83438 if–
	`sqlôe3FixSñe˘
(
pFix
, 
pEx¥
->
x
.
pSñe˘
) )  1;

83440 if–
	`sqlôe3FixEx¥Li°
(
pFix
, 
pEx¥
->
x
.
pLi°
) )  1;

83442 if–
	`sqlôe3FixEx¥
(
pFix
, 
pEx¥
->
pRight
) ){

83445 
pEx¥
 =ÖEx¥->
pLe·
;

83449 
SQLITE_PRIVATE
 
	`sqlôe3FixEx¥Li°
(

83450 
DbFixî
 *
pFix
,

83451 
Ex¥Li°
 *
pLi°


83453 
i
;

83454 
Ex¥Li°_ôem
 *
pIãm
;

83455 if–
pLi°
==0 )  0;

83456 
i
=0, 
pIãm
=
pLi°
->
a
; i<pLi°->
nEx¥
; i++,ÖItem++){

83457 if–
	`sqlôe3FixEx¥
(
pFix
, 
pIãm
->
pEx¥
) ){

83465 #i‚de‡
SQLITE_OMIT_TRIGGER


83466 
SQLITE_PRIVATE
 
	`sqlôe3FixTriggîSãp
(

83467 
DbFixî
 *
pFix
,

83468 
TriggîSãp
 *
pSãp


83470  
pSãp
 ){

83471 if–
	`sqlôe3FixSñe˘
(
pFix
, 
pSãp
->
pSñe˘
) ){

83474 if–
	`sqlôe3FixEx¥
(
pFix
, 
pSãp
->
pWhîe
) ){

83477 if–
	`sqlôe3FixEx¥Li°
(
pFix
, 
pSãp
->
pEx¥Li°
) ){

83480 
pSãp
 =ÖSãp->
pNext
;

83509 #i‚de‡
SQLITE_OMIT_AUTHORIZATION


83556 
SQLITE_API
 
	`sqlôe3_£t_auth‹izî
(

83557 
sqlôe3
 *
db
,

83558 (*
xAuth
)(*,,const *,const *,const *,const *),

83559 *
pArg


83561 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

83562 
db
->
xAuth
 = xAuth;

83563 
db
->
pAuthArg
 = 
pArg
;

83564 
	`sqlôe3ExpúePª∑ªdSèãmíts
(
db
);

83565 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

83566  
SQLITE_OK
;

83573 
	`sqlôeAuthBadRëu∫Code
(
P¨£
 *
pP¨£
){

83574 
	`sqlôe3Eº‹Msg
(
pP¨£
, "authorizer malfunction");

83575 
pP¨£
->
rc
 = 
SQLITE_ERROR
;

83587 
SQLITE_PRIVATE
 
	`sqlôe3AuthRódCﬁ
(

83588 
P¨£
 *
pP¨£
,

83589 c⁄° *
zTab
,

83590 c⁄° *
zCﬁ
,

83591 
iDb


83593 
sqlôe3
 *
db
 = 
pP¨£
->db;

83594 *
zDb
 = 
db
->
aDb
[
iDb
].
zName
;

83595 
rc
;

83597 
rc
 = 
db
->
	`xAuth
(db->
pAuthArg
, 
SQLITE_READ
, 
zTab
,
zCﬁ
,
zDb
,
pP¨£
->
zAuthC⁄ãxt
);

83598 if–
rc
==
SQLITE_DENY
 ){

83599 if–
db
->
nDb
>2 || 
iDb
!=0 ){

83600 
	`sqlôe3Eº‹Msg
(
pP¨£
, "ac˚s†tÿ%s.%s.%†i†¥ohibôed",
zDb
,
zTab
,
zCﬁ
);

83602 
	`sqlôe3Eº‹Msg
(
pP¨£
, "ac˚s†tÿ%s.%†i†¥ohibôed", 
zTab
, 
zCﬁ
);

83604 
pP¨£
->
rc
 = 
SQLITE_AUTH
;

83605 }if–
rc
!=
SQLITE_IGNORE
 &&Ñc!=
SQLITE_OK
 ){

83606 
	`sqlôeAuthBadRëu∫Code
(
pP¨£
);

83608  
rc
;

83620 
SQLITE_PRIVATE
 
	`sqlôe3AuthRód
(

83621 
P¨£
 *
pP¨£
,

83622 
Ex¥
 *
pEx¥
,

83623 
Schema
 *
pSchema
,

83624 
SrcLi°
 *
pTabLi°


83626 
sqlôe3
 *
db
 = 
pP¨£
->db;

83627 
TabÀ
 *
pTab
 = 0;

83628 c⁄° *
zCﬁ
;

83629 
iSrc
;

83630 
iDb
;

83631 
iCﬁ
;

83633 if–
db
->
xAuth
==0 ) ;

83634 
iDb
 = 
	`sqlôe3SchemaToIndex
(
pP¨£
->
db
, 
pSchema
);

83635 if–
iDb
<0 ){

83641 
	`as£π
–
pEx¥
->
›
==
TK_COLUMN
 ||ÖEx¥->›==
TK_TRIGGER
 );

83642 if–
pEx¥
->
›
==
TK_TRIGGER
 ){

83643 
pTab
 = 
pP¨£
->
pTriggîTab
;

83645 
	`as£π
–
pTabLi°
 );

83646 
iSrc
=0; 
	`ALWAYS
(iSrc<
pTabLi°
->
nSrc
); iSrc++){

83647 if–
pEx¥
->
iTabÀ
==
pTabLi°
->
a
[
iSrc
].
iCurs‹
 ){

83648 
pTab
 = 
pTabLi°
->
a
[
iSrc
].pTab;

83653 
iCﬁ
 = 
pEx¥
->
iCﬁumn
;

83654 if–
	`NEVER
(
pTab
==0) ) ;

83656 if–
iCﬁ
>=0 ){

83657 
	`as£π
–
iCﬁ
<
pTab
->
nCﬁ
 );

83658 
zCﬁ
 = 
pTab
->
aCﬁ
[
iCﬁ
].
zName
;

83659 }if–
pTab
->
iPKey
>=0 ){

83660 
	`as£π
–
pTab
->
iPKey
<pTab->
nCﬁ
 );

83661 
zCﬁ
 = 
pTab
->
aCﬁ
[pTab->
iPKey
].
zName
;

83663 
zCﬁ
 = "ROWID";

83665 
	`as£π
–
iDb
>=0 && iDb<
db
->
nDb
 );

83666 if–
SQLITE_IGNORE
==
	`sqlôe3AuthRódCﬁ
(
pP¨£
, 
pTab
->
zName
, 
zCﬁ
, 
iDb
) ){

83667 
pEx¥
->
›
 = 
TK_NULL
;

83677 
SQLITE_PRIVATE
 
	`sqlôe3AuthCheck
(

83678 
P¨£
 *
pP¨£
,

83679 
code
,

83680 c⁄° *
zArg1
,

83681 c⁄° *
zArg2
,

83682 c⁄° *
zArg3


83684 
sqlôe3
 *
db
 = 
pP¨£
->db;

83685 
rc
;

83690 if–
db
->
öô
.
busy
 || 
IN_DECLARE_VTAB
 ){

83691  
SQLITE_OK
;

83694 if–
db
->
xAuth
==0 ){

83695  
SQLITE_OK
;

83697 
rc
 = 
db
->
	`xAuth
(db->
pAuthArg
, 
code
, 
zArg1
, 
zArg2
, 
zArg3
, 
pP¨£
->
zAuthC⁄ãxt
);

83698 if–
rc
==
SQLITE_DENY
 ){

83699 
	`sqlôe3Eº‹Msg
(
pP¨£
, "notáuthorized");

83700 
pP¨£
->
rc
 = 
SQLITE_AUTH
;

83701 }if–
rc
!=
SQLITE_OK
 &&Ñc!=
SQLITE_IGNORE
 ){

83702 
rc
 = 
SQLITE_DENY
;

83703 
	`sqlôeAuthBadRëu∫Code
(
pP¨£
);

83705  
rc
;

83713 
SQLITE_PRIVATE
 
	`sqlôe3AuthC⁄ãxtPush
(

83714 
P¨£
 *
pP¨£
,

83715 
AuthC⁄ãxt
 *
pC⁄ãxt
,

83716 c⁄° *
zC⁄ãxt


83718 
	`as£π
–
pP¨£
 );

83719 
pC⁄ãxt
->
pP¨£
 =ÖParse;

83720 
pC⁄ãxt
->
zAuthC⁄ãxt
 = 
pP¨£
->zAuthContext;

83721 
pP¨£
->
zAuthC⁄ãxt
 = 
zC⁄ãxt
;

83728 
SQLITE_PRIVATE
 
	`sqlôe3AuthC⁄ãxtP›
(
AuthC⁄ãxt
 *
pC⁄ãxt
){

83729 if–
pC⁄ãxt
->
pP¨£
 ){

83730 
pC⁄ãxt
->
pP¨£
->
zAuthC⁄ãxt
 =ÖContext->zAuthContext;

83731 
pC⁄ãxt
->
pP¨£
 = 0;

83768 
SQLITE_PRIVATE
 
	`sqlôe3BegöP¨£
(
P¨£
 *
pP¨£
, 
ex∂aöFœg
){

83769 
pP¨£
->
ex∂aö
 = (
u8
)
ex∂aöFœg
;

83770 
pP¨£
->
nV¨
 = 0;

83773 #i‚de‡
SQLITE_OMIT_SHARED_CACHE


83778 
	sTabÀLock
 {

83779 
iDb
;

83780 
iTab
;

83781 
u8
 
isWrôeLock
;

83782 c⁄° *
zName
;

83795 
SQLITE_PRIVATE
 
	`sqlôe3TabÀLock
(

83796 
P¨£
 *
pP¨£
,

83797 
iDb
,

83798 
iTab
,

83799 
u8
 
isWrôeLock
,

83800 c⁄° *
zName


83802 
P¨£
 *
pT›Àvñ
 = 
	`sqlôe3P¨£T›Àvñ
(
pP¨£
);

83803 
i
;

83804 
nByãs
;

83805 
TabÀLock
 *
p
;

83806 
	`as£π
–
iDb
>=0 );

83808 
i
=0; i<
pT›Àvñ
->
nTabÀLock
; i++){

83809 
p
 = &
pT›Àvñ
->
aTabÀLock
[
i
];

83810 if–
p
->
iDb
==iDb &&Ö->
iTab
==iTab ){

83811 
p
->
isWrôeLock
 = (p->isWriteLock || isWriteLock);

83816 
nByãs
 = (
TabÀLock
Ë* (
pT›Àvñ
->
nTabÀLock
+1);

83817 
pT›Àvñ
->
aTabÀLock
 =

83818 
	`sqlôe3DbRóŒocOrFªe
(
pT›Àvñ
->
db
,ÖT›Àvñ->
aTabÀLock
, 
nByãs
);

83819 if–
pT›Àvñ
->
aTabÀLock
 ){

83820 
p
 = &
pT›Àvñ
->
aTabÀLock
[pT›Àvñ->
nTabÀLock
++];

83821 
p
->
iDb
 = iDb;

83822 
p
->
iTab
 = iTab;

83823 
p
->
isWrôeLock
 = isWriteLock;

83824 
p
->
zName
 = zName;

83826 
pT›Àvñ
->
nTabÀLock
 = 0;

83827 
pT›Àvñ
->
db
->
mÆlocFaûed
 = 1;

83835 
	`codeTabÀLocks
(
P¨£
 *
pP¨£
){

83836 
i
;

83837 
Vdbe
 *
pVdbe
;

83839 
pVdbe
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

83840 
	`as£π
–
pVdbe
!=0 );

83842 
i
=0; i<
pP¨£
->
nTabÀLock
; i++){

83843 
TabÀLock
 *
p
 = &
pP¨£
->
aTabÀLock
[
i
];

83844 
p1
 = 
p
->
iDb
;

83845 
	`sqlôe3VdbeAddOp4
(
pVdbe
, 
OP_TabÀLock
, 
p1
, 
p
->
iTab
,Ö->
isWrôeLock
,

83846 
p
->
zName
, 
P4_STATIC
);

83850 
	#codeTabÀLocks
(
x
)

	)

83863 
SQLITE_PRIVATE
 
	`sqlôe3FöishCodög
(
P¨£
 *
pP¨£
){

83864 
sqlôe3
 *
db
;

83865 
Vdbe
 *
v
;

83867 
	`as£π
–
pP¨£
->
pT›Àvñ
==0 );

83868 
db
 = 
pP¨£
->db;

83869 if–
db
->
mÆlocFaûed
 ) ;

83870 if–
pP¨£
->
√°ed
 ) ;

83871 if–
pP¨£
->
nEº
 ) ;

83876 
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

83877 
	`as£π
–!
pP¨£
->
isMu…iWrôe


83878 || 
	`sqlôe3VdbeAs£πMayAb‹t
(
v
, 
pP¨£
->
mayAb‹t
));

83879 if–
v
 ){

83880 
	`sqlôe3VdbeAddOp0
(
v
, 
OP_HÆt
);

83888 if–
pP¨£
->
cookõGŸo
>0 ){

83889 
yDbMask
 
mask
;

83890 
iDb
;

83891 
	`sqlôe3VdbeJumpHîe
(
v
, 
pP¨£
->
cookõGŸo
-1);

83892 
iDb
=0, 
mask
=1; iDb<
db
->
nDb
; mask<<=1, iDb++){

83893 if–(
mask
 & 
pP¨£
->
cookõMask
)==0 ) ;

83894 
	`sqlôe3VdbeU£sBåì
(
v
, 
iDb
);

83895 
	`sqlôe3VdbeAddOp2
(
v
,
OP_Tønß˘i⁄
, 
iDb
, (
mask
 & 
pP¨£
->
wrôeMask
)!=0);

83896 if–
db
->
öô
.
busy
==0 ){

83897 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 
iDb
, 0) );

83898 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_VîifyCookõ
,

83899 
iDb
, 
pP¨£
->
cookõVÆue
[iDb],

83900 
db
->
aDb
[
iDb
].
pSchema
->
iGíî©i⁄
);

83903 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


83905 
i
;

83906 
i
=0; i<
pP¨£
->
nVèbLock
; i++){

83907 *
vèb
 = (*)
	`sqlôe3GëVTabÀ
(
db
, 
pP¨£
->
≠VèbLock
[
i
]);

83908 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_VBegö
, 0, 0, 0, 
vèb
, 
P4_VTAB
);

83910 
pP¨£
->
nVèbLock
 = 0;

83918 
	`codeTabÀLocks
(
pP¨£
);

83922 
	`sqlôe3Autoö¸emítBegö
(
pP¨£
);

83925 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_GŸo
, 0, 
pP¨£
->
cookõGŸo
);

83932 if–
v
 && 
	`ALWAYS
(
pP¨£
->
nEº
==0Ë&& !
db
->
mÆlocFaûed
 ){

83933 #ifde‡
SQLITE_DEBUG


83934 
FILE
 *
åa˚
 = (
db
->
Êags
 & 
SQLITE_VdbeTø˚
)!=0 ? 
°dout
 : 0;

83935 
	`sqlôe3VdbeTø˚
(
v
, 
åa˚
);

83937 
	`as£π
–
pP¨£
->
iCacheLevñ
==0 );

83940 if–
pP¨£
->
pAöc
!=0 &&ÖP¨£->
nTab
==0 )ÖParse->nTab = 1;

83941 
	`sqlôe3VdbeMakeRódy
(
v
, 
pP¨£
);

83942 
pP¨£
->
rc
 = 
SQLITE_DONE
;

83943 
pP¨£
->
cﬁNamesSë
 = 0;

83945 
pP¨£
->
rc
 = 
SQLITE_ERROR
;

83947 
pP¨£
->
nTab
 = 0;

83948 
pP¨£
->
nMem
 = 0;

83949 
pP¨£
->
nSë
 = 0;

83950 
pP¨£
->
nV¨
 = 0;

83951 
pP¨£
->
cookõMask
 = 0;

83952 
pP¨£
->
cookõGŸo
 = 0;

83967 
SQLITE_PRIVATE
 
	`sqlôe3Ne°edP¨£
(
P¨£
 *
pP¨£
, c⁄° *
zF‹m©
, ...){

83968 
va_li°
 
≠
;

83969 *
zSql
;

83970 *
zEºMsg
 = 0;

83971 
sqlôe3
 *
db
 = 
pP¨£
->db;

83972 
	#SAVE_SZ
 ((
P¨£
Ë- 
	`off£tof
(P¨£,
nV¨
))

	)

83973 
ßveBuf
[
SAVE_SZ
];

83975 if–
pP¨£
->
nEº
 ) ;

83976 
	`as£π
–
pP¨£
->
√°ed
<10 );

83977 
	`va_°¨t
(
≠
, 
zF‹m©
);

83978 
zSql
 = 
	`sqlôe3VMPrötf
(
db
, 
zF‹m©
, 
≠
);

83979 
	`va_íd
(
≠
);

83980 if–
zSql
==0 ){

83983 
pP¨£
->
√°ed
++;

83984 
	`mem˝y
(
ßveBuf
, &
pP¨£
->
nV¨
, 
SAVE_SZ
);

83985 
	`mem£t
(&
pP¨£
->
nV¨
, 0, 
SAVE_SZ
);

83986 
	`sqlôe3RunP¨£r
(
pP¨£
, 
zSql
, &
zEºMsg
);

83987 
	`sqlôe3DbFªe
(
db
, 
zEºMsg
);

83988 
	`sqlôe3DbFªe
(
db
, 
zSql
);

83989 
	`mem˝y
(&
pP¨£
->
nV¨
, 
ßveBuf
, 
SAVE_SZ
);

83990 
pP¨£
->
√°ed
--;

84005 
SQLITE_PRIVATE
 
TabÀ
 *
	`sqlôe3FödTabÀ
(
sqlôe3
 *
db
, c⁄° *
zName
, c⁄° *
zD©aba£
){

84006 
TabÀ
 *
p
 = 0;

84007 
i
;

84008 
nName
;

84009 
	`as£π
–
zName
!=0 );

84010 
nName
 = 
	`sqlôe3SåÀn30
(
zName
);

84012 
	`as£π
–
zD©aba£
!=0 || 
	`sqlôe3BåìHﬁdsAŒMuãxes
(
db
) );

84013 
i
=
OMIT_TEMPDB
; i<
db
->
nDb
; i++){

84014 
j
 = (
i
<2) ? i^1 : i;

84015 if–
zD©aba£
!=0 && 
	`sqlôe3SåICmp
(zD©aba£, 
db
->
aDb
[
j
].
zName
) ) ;

84016 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 
j
, 0) );

84017 
p
 = 
	`sqlôe3HashFöd
(&
db
->
aDb
[
j
].
pSchema
->
tblHash
, 
zName
, 
nName
);

84018 if–
p
 ) ;

84020  
p
;

84033 
SQLITE_PRIVATE
 
TabÀ
 *
	`sqlôe3LoˇãTabÀ
(

84034 
P¨£
 *
pP¨£
,

84035 
isVõw
,

84036 c⁄° *
zName
,

84037 c⁄° *
zDba£


84039 
TabÀ
 *
p
;

84043 if–
SQLITE_OK
!=
	`sqlôe3RódSchema
(
pP¨£
) ){

84047 
p
 = 
	`sqlôe3FödTabÀ
(
pP¨£
->
db
, 
zName
, 
zDba£
);

84048 if–
p
==0 ){

84049 c⁄° *
zMsg
 = 
isVõw
 ? "no such view" : "no suchÅable";

84050 if–
zDba£
 ){

84051 
	`sqlôe3Eº‹Msg
(
pP¨£
, "%s: %s.%s", 
zMsg
, 
zDba£
, 
zName
);

84053 
	`sqlôe3Eº‹Msg
(
pP¨£
, "%s: %s", 
zMsg
, 
zName
);

84055 
pP¨£
->
checkSchema
 = 1;

84057  
p
;

84069 
SQLITE_PRIVATE
 
TabÀ
 *
	`sqlôe3LoˇãTabÀIãm
(

84070 
P¨£
 *
pP¨£
,

84071 
isVõw
,

84072 
SrcLi°_ôem
 *
p


84074 c⁄° *
zDb
;

84075 
	`as£π
–
p
->
pSchema
==0 ||Ö->
zD©aba£
==0 );

84076 if–
p
->
pSchema
 ){

84077 
iDb
 = 
	`sqlôe3SchemaToIndex
(
pP¨£
->
db
, 
p
->
pSchema
);

84078 
zDb
 = 
pP¨£
->
db
->
aDb
[
iDb
].
zName
;

84080 
zDb
 = 
p
->
zD©aba£
;

84082  
	`sqlôe3LoˇãTabÀ
(
pP¨£
, 
isVõw
, 
p
->
zName
, 
zDb
);

84097 
SQLITE_PRIVATE
 
Index
 *
	`sqlôe3FödIndex
(
sqlôe3
 *
db
, c⁄° *
zName
, c⁄° *
zDb
){

84098 
Index
 *
p
 = 0;

84099 
i
;

84100 
nName
 = 
	`sqlôe3SåÀn30
(
zName
);

84102 
	`as£π
–
zDb
!=0 || 
	`sqlôe3BåìHﬁdsAŒMuãxes
(
db
) );

84103 
i
=
OMIT_TEMPDB
; i<
db
->
nDb
; i++){

84104 
j
 = (
i
<2) ? i^1 : i;

84105 
Schema
 *
pSchema
 = 
db
->
aDb
[
j
].pSchema;

84106 
	`as£π
–
pSchema
 );

84107 if–
zDb
 && 
	`sqlôe3SåICmp
(zDb, 
db
->
aDb
[
j
].
zName
) ) ;

84108 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 
j
, 0) );

84109 
p
 = 
	`sqlôe3HashFöd
(&
pSchema
->
idxHash
, 
zName
, 
nName
);

84110 if–
p
 ) ;

84112  
p
;

84118 
	`‰ìIndex
(
sqlôe3
 *
db
, 
Index
 *
p
){

84119 #i‚de‡
SQLITE_OMIT_ANALYZE


84120 
	`sqlôe3DñëeIndexSam∂es
(
db
, 
p
);

84122 
	`sqlôe3Ex¥Dñëe
(
db
, 
p
->
pP¨tIdxWhîe
);

84123 
	`sqlôe3DbFªe
(
db
, 
p
->
zCﬁAff
);

84124 
	`sqlôe3DbFªe
(
db
, 
p
);

84133 
SQLITE_PRIVATE
 
	`sqlôe3U∆ökAndDñëeIndex
(
sqlôe3
 *
db
, 
iDb
, c⁄° *
zIdxName
){

84134 
Index
 *
pIndex
;

84135 
Àn
;

84136 
Hash
 *
pHash
;

84138 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 
iDb
, 0) );

84139 
pHash
 = &
db
->
aDb
[
iDb
].
pSchema
->
idxHash
;

84140 
Àn
 = 
	`sqlôe3SåÀn30
(
zIdxName
);

84141 
pIndex
 = 
	`sqlôe3HashIn£π
(
pHash
, 
zIdxName
, 
Àn
, 0);

84142 if–
	`ALWAYS
(
pIndex
) ){

84143 if–
pIndex
->
pTabÀ
->pIndex==pIndex ){

84144 
pIndex
->
pTabÀ
->pIndex =ÖIndex->
pNext
;

84146 
Index
 *
p
;

84149 
p
 = 
pIndex
->
pTabÀ
->pIndex;

84150  
	`ALWAYS
(
p
Ë&&Ö->
pNext
!=
pIndex
 ){Ö =Ö->pNext; }

84151 if–
	`ALWAYS
(
p
 &&Ö->
pNext
==
pIndex
) ){

84152 
p
->
pNext
 = 
pIndex
->pNext;

84155 
	`‰ìIndex
(
db
, 
pIndex
);

84157 
db
->
Êags
 |
SQLITE_I¡înCh™ges
;

84168 
SQLITE_PRIVATE
 
	`sqlôe3Cﬁœp£D©aba£Aºay
(
sqlôe3
 *
db
){

84169 
i
, 
j
;

84170 
i
=
j
=2; i<
db
->
nDb
; i++){

84171 
Db
 *
pDb
 = &
db
->
aDb
[
i
];

84172 if–
pDb
->
pBt
==0 ){

84173 
	`sqlôe3DbFªe
(
db
, 
pDb
->
zName
);

84174 
pDb
->
zName
 = 0;

84177 if–
j
<
i
 ){

84178 
db
->
aDb
[
j
] = db->aDb[
i
];

84180 
j
++;

84182 
	`mem£t
(&
db
->
aDb
[
j
], 0, (db->
nDb
-j)*(db->aDb[j]));

84183 
db
->
nDb
 = 
j
;

84184 if–
db
->
nDb
<=2 && db->
aDb
!=db->
aDbSètic
 ){

84185 
	`mem˝y
(
db
->
aDbSètic
, db->
aDb
, 2*(db->aDb[0]));

84186 
	`sqlôe3DbFªe
(
db
, db->
aDb
);

84187 
db
->
aDb
 = db->
aDbSètic
;

84195 
SQLITE_PRIVATE
 
	`sqlôe3Re£tO√Schema
(
sqlôe3
 *
db
, 
iDb
){

84196 
Db
 *
pDb
;

84197 
	`as£π
–
iDb
<
db
->
nDb
 );

84200 
pDb
 = &
db
->
aDb
[
iDb
];

84201 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 
iDb
, 0) );

84202 
	`as£π
–
pDb
->
pSchema
!=0 );

84203 
	`sqlôe3SchemaCÀ¨
(
pDb
->
pSchema
);

84209 if–
iDb
!=1 ){

84210 
pDb
 = &
db
->
aDb
[1];

84211 
	`as£π
–
pDb
->
pSchema
!=0 );

84212 
	`sqlôe3SchemaCÀ¨
(
pDb
->
pSchema
);

84221 
SQLITE_PRIVATE
 
	`sqlôe3Re£tAŒSchemasOfC⁄√˘i⁄
(
sqlôe3
 *
db
){

84222 
i
;

84223 
	`sqlôe3BåìE¡îAŒ
(
db
);

84224 
i
=0; i<
db
->
nDb
; i++){

84225 
Db
 *
pDb
 = &
db
->
aDb
[
i
];

84226 if–
pDb
->
pSchema
 ){

84227 
	`sqlôe3SchemaCÀ¨
(
pDb
->
pSchema
);

84230 
db
->
Êags
 &~
SQLITE_I¡înCh™ges
;

84231 
	`sqlôe3VèbU∆ockLi°
(
db
);

84232 
	`sqlôe3BåìLóveAŒ
(
db
);

84233 
	`sqlôe3Cﬁœp£D©aba£Aºay
(
db
);

84239 
SQLITE_PRIVATE
 
	`sqlôe3CommôI¡î«lCh™ges
(
sqlôe3
 *
db
){

84240 
db
->
Êags
 &~
SQLITE_I¡înCh™ges
;

84247 
	`sqlôeDñëeCﬁumnNames
(
sqlôe3
 *
db
, 
TabÀ
 *
pTabÀ
){

84248 
i
;

84249 
Cﬁumn
 *
pCﬁ
;

84250 
	`as£π
–
pTabÀ
!=0 );

84251 if–(
pCﬁ
 = 
pTabÀ
->
aCﬁ
)!=0 ){

84252 
i
=0; i<
pTabÀ
->
nCﬁ
; i++, 
pCﬁ
++){

84253 
	`sqlôe3DbFªe
(
db
, 
pCﬁ
->
zName
);

84254 
	`sqlôe3Ex¥Dñëe
(
db
, 
pCﬁ
->
pDÊt
);

84255 
	`sqlôe3DbFªe
(
db
, 
pCﬁ
->
zDÊt
);

84256 
	`sqlôe3DbFªe
(
db
, 
pCﬁ
->
zTy≥
);

84257 
	`sqlôe3DbFªe
(
db
, 
pCﬁ
->
zCﬁl
);

84259 
	`sqlôe3DbFªe
(
db
, 
pTabÀ
->
aCﬁ
);

84278 
SQLITE_PRIVATE
 
	`sqlôe3DñëeTabÀ
(
sqlôe3
 *
db
, 
TabÀ
 *
pTabÀ
){

84279 
Index
 *
pIndex
, *
pNext
;

84280 
	`TESTONLY
–
nLookaside
; )

84282 
	`as£π
–!
pTabÀ
 ||ÖTabÀ->
nRef
>0 );

84285 if–!
pTabÀ
 ) ;

84286 if–((!
db
 || db->
≤ByãsFªed
==0Ë&& (--
pTabÀ
->
nRef
)>0) ) ;

84291 
	`TESTONLY
–
nLookaside
 = (
db
 && (
pTabÀ
->
èbFœgs
 & 
TF_EphemîÆ
)==0) ?

84292 
db
->
lookaside
.
nOut
 : 0 );

84295 
pIndex
 = 
pTabÀ
->pIndex;ÖIndex;ÖIndex=
pNext
){

84296 
pNext
 = 
pIndex
->pNext;

84297 
	`as£π
–
pIndex
->
pSchema
==
pTabÀ
->pSchema );

84298 if–!
db
 || db->
≤ByãsFªed
==0 ){

84299 *
zName
 = 
pIndex
->zName;

84300 
	`TESTONLY
 ( 
Index
 *
pOld
 = ) 
	`sqlôe3HashIn£π
(

84301 &
pIndex
->
pSchema
->
idxHash
, 
zName
, 
	`sqlôe3SåÀn30
(zName), 0

84303 
	`as£π
–
db
==0 || 
	`sqlôe3SchemaMuãxHñd
(db, 0, 
pIndex
->
pSchema
) );

84304 
	`as£π
–
pOld
==
pIndex
 ||ÖOld==0 );

84306 
	`‰ìIndex
(
db
, 
pIndex
);

84310 
	`sqlôe3FkDñëe
(
db
, 
pTabÀ
);

84314 
	`sqlôeDñëeCﬁumnNames
(
db
, 
pTabÀ
);

84315 
	`sqlôe3DbFªe
(
db
, 
pTabÀ
->
zName
);

84316 
	`sqlôe3DbFªe
(
db
, 
pTabÀ
->
zCﬁAff
);

84317 
	`sqlôe3Sñe˘Dñëe
(
db
, 
pTabÀ
->
pSñe˘
);

84318 #i‚de‡
SQLITE_OMIT_CHECK


84319 
	`sqlôe3Ex¥Li°Dñëe
(
db
, 
pTabÀ
->
pCheck
);

84321 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


84322 
	`sqlôe3VèbCÀ¨
(
db
, 
pTabÀ
);

84324 
	`sqlôe3DbFªe
(
db
, 
pTabÀ
);

84327 
	`as£π
–
nLookaside
==0 ||ÇLookaside==
db
->
lookaside
.
nOut
 );

84334 
SQLITE_PRIVATE
 
	`sqlôe3U∆ökAndDñëeTabÀ
(
sqlôe3
 *
db
, 
iDb
, c⁄° *
zTabName
){

84335 
TabÀ
 *
p
;

84336 
Db
 *
pDb
;

84338 
	`as£π
–
db
!=0 );

84339 
	`as£π
–
iDb
>=0 && iDb<
db
->
nDb
 );

84340 
	`as£π
–
zTabName
 );

84341 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 
iDb
, 0) );

84342 
	`ã°ˇ£
–
zTabName
[0]==0 );

84343 
pDb
 = &
db
->
aDb
[
iDb
];

84344 
p
 = 
	`sqlôe3HashIn£π
(&
pDb
->
pSchema
->
tblHash
, 
zTabName
,

84345 
	`sqlôe3SåÀn30
(
zTabName
),0);

84346 
	`sqlôe3DñëeTabÀ
(
db
, 
p
);

84347 
db
->
Êags
 |
SQLITE_I¡înCh™ges
;

84363 
SQLITE_PRIVATE
 *
	`sqlôe3NameFromTokí
(
sqlôe3
 *
db
, 
Tokí
 *
pName
){

84364 *
zName
;

84365 if–
pName
 ){

84366 
zName
 = 
	`sqlôe3DbSåNDup
(
db
, (*)
pName
->
z
,ÖName->
n
);

84367 
	`sqlôe3DequŸe
(
zName
);

84369 
zName
 = 0;

84371  
zName
;

84378 
SQLITE_PRIVATE
 
	`sqlôe3O≥nMa°îTabÀ
(
P¨£
 *
p
, 
iDb
){

84379 
Vdbe
 *
v
 = 
	`sqlôe3GëVdbe
(
p
);

84380 
	`sqlôe3TabÀLock
(
p
, 
iDb
, 
MASTER_ROOT
, 1, 
	`SCHEMA_TABLE
(iDb));

84381 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_O≥nWrôe
, 0, 
MASTER_ROOT
, 
iDb
);

84382 
	`sqlôe3VdbeCh™geP4
(
v
, -1, (*)5, 
P4_INT32
);

84383 if–
p
->
nTab
==0 ){

84384 
p
->
nTab
 = 1;

84394 
SQLITE_PRIVATE
 
	`sqlôe3FödDbName
(
sqlôe3
 *
db
, c⁄° *
zName
){

84395 
i
 = -1;

84396 if–
zName
 ){

84397 
Db
 *
pDb
;

84398 
n
 = 
	`sqlôe3SåÀn30
(
zName
);

84399 
i
=(
db
->
nDb
-1), 
pDb
=&db->
aDb
[i]; i>=0; i--,ÖDb--){

84400 if–(!
OMIT_TEMPDB
 || 
i
!=1 ) && 
n
==
	`sqlôe3SåÀn30
(
pDb
->
zName
) &&

84401 0==
	`sqlôe3SåICmp
(
pDb
->
zName
, zName) ){

84406  
i
;

84415 
SQLITE_PRIVATE
 
	`sqlôe3FödDb
(
sqlôe3
 *
db
, 
Tokí
 *
pName
){

84416 
i
;

84417 *
zName
;

84418 
zName
 = 
	`sqlôe3NameFromTokí
(
db
, 
pName
);

84419 
i
 = 
	`sqlôe3FödDbName
(
db
, 
zName
);

84420 
	`sqlôe3DbFªe
(
db
, 
zName
);

84421  
i
;

84440 
SQLITE_PRIVATE
 
	`sqlôe3TwoP¨tName
(

84441 
P¨£
 *
pP¨£
,

84442 
Tokí
 *
pName1
,

84443 
Tokí
 *
pName2
,

84444 
Tokí
 **
pUnquÆ


84446 
iDb
;

84447 
sqlôe3
 *
db
 = 
pP¨£
->db;

84449 if–
	`ALWAYS
(
pName2
!=0Ë&&ÖName2->
n
>0 ){

84450 if–
db
->
öô
.
busy
 ) {

84451 
	`sqlôe3Eº‹Msg
(
pP¨£
, "corrupt database");

84452 
pP¨£
->
nEº
++;

84455 *
pUnquÆ
 = 
pName2
;

84456 
iDb
 = 
	`sqlôe3FödDb
(
db
, 
pName1
);

84457 if–
iDb
<0 ){

84458 
	`sqlôe3Eº‹Msg
(
pP¨£
, "unknow¿d©aba£ %T", 
pName1
);

84459 
pP¨£
->
nEº
++;

84463 
	`as£π
–
db
->
öô
.
iDb
==0 || db->öô.
busy
 );

84464 
iDb
 = 
db
->
öô
.iDb;

84465 *
pUnquÆ
 = 
pName1
;

84467  
iDb
;

84477 
SQLITE_PRIVATE
 
	`sqlôe3CheckObje˘Name
(
P¨£
 *
pP¨£
, c⁄° *
zName
){

84478 if–!
pP¨£
->
db
->
öô
.
busy
 &&ÖP¨£->
√°ed
==0

84479 && (
pP¨£
->
db
->
Êags
 & 
SQLITE_WrôeSchema
)==0

84480 && 0==
	`sqlôe3SåNICmp
(
zName
, "sqlite_", 7) ){

84481 
	`sqlôe3Eº‹Msg
(
pP¨£
, "obje˘Çamêª£rved f‹ i¡î«»u£: %s", 
zName
);

84482  
SQLITE_ERROR
;

84484  
SQLITE_OK
;

84503 
SQLITE_PRIVATE
 
	`sqlôe3SèπTabÀ
(

84504 
P¨£
 *
pP¨£
,

84505 
Tokí
 *
pName1
,

84506 
Tokí
 *
pName2
,

84507 
isTemp
,

84508 
isVõw
,

84509 
isVútuÆ
,

84510 
noEº


84512 
TabÀ
 *
pTabÀ
;

84513 *
zName
 = 0;

84514 
sqlôe3
 *
db
 = 
pP¨£
->db;

84515 
Vdbe
 *
v
;

84516 
iDb
;

84517 
Tokí
 *
pName
;

84536 
iDb
 = 
	`sqlôe3TwoP¨tName
(
pP¨£
, 
pName1
, 
pName2
, &
pName
);

84537 if–
iDb
<0 ) ;

84538 if–!
OMIT_TEMPDB
 && 
isTemp
 && 
pName2
->
n
>0 && 
iDb
!=1 ){

84541 
	`sqlôe3Eº‹Msg
(
pP¨£
, "temporaryÅableÇame must be unqualified");

84544 if–!
OMIT_TEMPDB
 && 
isTemp
 ) 
iDb
 = 1;

84546 
pP¨£
->
sNameTokí
 = *
pName
;

84547 
zName
 = 
	`sqlôe3NameFromTokí
(
db
, 
pName
);

84548 if–
zName
==0 ) ;

84549 if–
SQLITE_OK
!=
	`sqlôe3CheckObje˘Name
(
pP¨£
, 
zName
) ){

84550 
begö_èbÀ_îr‹
;

84552 if–
db
->
öô
.
iDb
==1 ) 
isTemp
 = 1;

84553 #i‚de‡
SQLITE_OMIT_AUTHORIZATION


84554 
	`as£π
–(
isTemp
 & 1)==isTemp );

84556 
code
;

84557 *
zDb
 = 
db
->
aDb
[
iDb
].
zName
;

84558 if–
	`sqlôe3AuthCheck
(
pP¨£
, 
SQLITE_INSERT
, 
	`SCHEMA_TABLE
(
isTemp
), 0, 
zDb
) ){

84559 
begö_èbÀ_îr‹
;

84561 if–
isVõw
 ){

84562 if–!
OMIT_TEMPDB
 && 
isTemp
 ){

84563 
code
 = 
SQLITE_CREATE_TEMP_VIEW
;

84565 
code
 = 
SQLITE_CREATE_VIEW
;

84568 if–!
OMIT_TEMPDB
 && 
isTemp
 ){

84569 
code
 = 
SQLITE_CREATE_TEMP_TABLE
;

84571 
code
 = 
SQLITE_CREATE_TABLE
;

84574 if–!
isVútuÆ
 && 
	`sqlôe3AuthCheck
(
pP¨£
, 
code
, 
zName
, 0, 
zDb
) ){

84575 
begö_èbÀ_îr‹
;

84587 if–!
IN_DECLARE_VTAB
 ){

84588 *
zDb
 = 
db
->
aDb
[
iDb
].
zName
;

84589 if–
SQLITE_OK
!=
	`sqlôe3RódSchema
(
pP¨£
) ){

84590 
begö_èbÀ_îr‹
;

84592 
pTabÀ
 = 
	`sqlôe3FödTabÀ
(
db
, 
zName
, 
zDb
);

84593 if–
pTabÀ
 ){

84594 if–!
noEº
 ){

84595 
	`sqlôe3Eº‹Msg
(
pP¨£
, "èbÀ %TáÃódyÉxi°s", 
pName
);

84597 
	`as£π
–!
db
->
öô
.
busy
 );

84598 
	`sqlôe3CodeVîifySchema
(
pP¨£
, 
iDb
);

84600 
begö_èbÀ_îr‹
;

84602 if–
	`sqlôe3FödIndex
(
db
, 
zName
, 
zDb
)!=0 ){

84603 
	`sqlôe3Eº‹Msg
(
pP¨£
, "thîêi†Æªadyá¿ödexÇamed %s", 
zName
);

84604 
begö_èbÀ_îr‹
;

84608 
pTabÀ
 = 
	`sqlôe3DbMÆlocZîo
(
db
, (
TabÀ
));

84609 if–
pTabÀ
==0 ){

84610 
db
->
mÆlocFaûed
 = 1;

84611 
pP¨£
->
rc
 = 
SQLITE_NOMEM
;

84612 
pP¨£
->
nEº
++;

84613 
begö_èbÀ_îr‹
;

84615 
pTabÀ
->
zName
 = zName;

84616 
pTabÀ
->
iPKey
 = -1;

84617 
pTabÀ
->
pSchema
 = 
db
->
aDb
[
iDb
].pSchema;

84618 
pTabÀ
->
nRef
 = 1;

84619 
pTabÀ
->
nRowE°
 = 1048576;

84620 
	`as£π
–
pP¨£
->
pNewTabÀ
==0 );

84621 
pP¨£
->
pNewTabÀ
 = 
pTabÀ
;

84627 #i‚de‡
SQLITE_OMIT_AUTOINCREMENT


84628 if–!
pP¨£
->
√°ed
 && 
	`°rcmp
(
zName
, "sqlite_sequence")==0 ){

84629 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 
iDb
, 0) );

84630 
pTabÀ
->
pSchema
->
pSeqTab
 =ÖTable;

84642 if–!
db
->
öô
.
busy
 && (
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
))!=0 ){

84643 
j1
;

84644 
fûeF‹m©
;

84645 
ªg1
, 
ªg2
, 
ªg3
;

84646 
	`sqlôe3BegöWrôeO≥øti⁄
(
pP¨£
, 0, 
iDb
);

84648 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


84649 if–
isVútuÆ
 ){

84650 
	`sqlôe3VdbeAddOp0
(
v
, 
OP_VBegö
);

84657 
ªg1
 = 
pP¨£
->
ªgRowid
 = ++pP¨£->
nMem
;

84658 
ªg2
 = 
pP¨£
->
ªgRoŸ
 = ++pP¨£->
nMem
;

84659 
ªg3
 = ++
pP¨£
->
nMem
;

84660 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_RódCookõ
, 
iDb
, 
ªg3
, 
BTREE_FILE_FORMAT
);

84661 
	`sqlôe3VdbeU£sBåì
(
v
, 
iDb
);

84662 
j1
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_If
, 
ªg3
);

84663 
fûeF‹m©
 = (
db
->
Êags
 & 
SQLITE_LegacyFûeFmt
)!=0 ?

84664 1 : 
SQLITE_MAX_FILE_FORMAT
;

84665 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 
fûeF‹m©
, 
ªg3
);

84666 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_SëCookõ
, 
iDb
, 
BTREE_FILE_FORMAT
, 
ªg3
);

84667 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 
	`ENC
(
db
), 
ªg3
);

84668 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_SëCookõ
, 
iDb
, 
BTREE_TEXT_ENCODING
, 
ªg3
);

84669 
	`sqlôe3VdbeJumpHîe
(
v
, 
j1
);

84680 #i‡!
	`deföed
(
SQLITE_OMIT_VIEW
Ë|| !deföed(
SQLITE_OMIT_VIRTUALTABLE
)

84681 if–
isVõw
 || 
isVútuÆ
 ){

84682 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 0, 
ªg2
);

84686 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Cª©eTabÀ
, 
iDb
, 
ªg2
);

84688 
	`sqlôe3O≥nMa°îTabÀ
(
pP¨£
, 
iDb
);

84689 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NewRowid
, 0, 
ªg1
);

84690 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NuŒ
, 0, 
ªg3
);

84691 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_In£π
, 0, 
ªg3
, 
ªg1
);

84692 
	`sqlôe3VdbeCh™geP5
(
v
, 
OPFLAG_APPEND
);

84693 
	`sqlôe3VdbeAddOp0
(
v
, 
OP_Clo£
);

84700 
begö_èbÀ_îr‹
:

84701 
	`sqlôe3DbFªe
(
db
, 
zName
);

84713 
	#STRICMP
(
x
, 
y
) (\

84714 
sqlôe3UµîToLowî
[*(*)(
x
)]== \

84715 
sqlôe3UµîToLowî
[*(*)(
y
)] \

84716 && 
	`sqlôe3SåICmp
((
x
)+1,(
y
)+1)==0 )

	)

84726 
SQLITE_PRIVATE
 
	`sqlôe3AddCﬁumn
(
P¨£
 *
pP¨£
, 
Tokí
 *
pName
){

84727 
TabÀ
 *
p
;

84728 
i
;

84729 *
z
;

84730 
Cﬁumn
 *
pCﬁ
;

84731 
sqlôe3
 *
db
 = 
pP¨£
->db;

84732 if–(
p
 = 
pP¨£
->
pNewTabÀ
)==0 ) ;

84733 #i‡
SQLITE_MAX_COLUMN


84734 if–
p
->
nCﬁ
+1>
db
->
aLimô
[
SQLITE_LIMIT_COLUMN
] ){

84735 
	`sqlôe3Eº‹Msg
(
pP¨£
, "toÿm™y cﬁumn†⁄ %s", 
p
->
zName
);

84739 
z
 = 
	`sqlôe3NameFromTokí
(
db
, 
pName
);

84740 if–
z
==0 ) ;

84741 
i
=0; i<
p
->
nCﬁ
; i++){

84742 if–
	`STRICMP
(
z
, 
p
->
aCﬁ
[
i
].
zName
) ){

84743 
	`sqlôe3Eº‹Msg
(
pP¨£
, "du∂iˇã cﬁum¿«me: %s", 
z
);

84744 
	`sqlôe3DbFªe
(
db
, 
z
);

84748 if–(
p
->
nCﬁ
 & 0x7)==0 ){

84749 
Cﬁumn
 *
aNew
;

84750 
aNew
 = 
	`sqlôe3DbRóŒoc
(
db
,
p
->
aCﬁ
,’->
nCﬁ
+8)*(p->aCol[0]));

84751 if–
aNew
==0 ){

84752 
	`sqlôe3DbFªe
(
db
, 
z
);

84755 
p
->
aCﬁ
 = 
aNew
;

84757 
pCﬁ
 = &
p
->
aCﬁ
[p->
nCﬁ
];

84758 
	`mem£t
(
pCﬁ
, 0, (
p
->
aCﬁ
[0]));

84759 
pCﬁ
->
zName
 = 
z
;

84765 
pCﬁ
->
afföôy
 = 
SQLITE_AFF_NONE
;

84766 
pCﬁ
->
szE°
 = 1;

84767 
p
->
nCﬁ
++;

84776 
SQLITE_PRIVATE
 
	`sqlôe3AddNŸNuŒ
(
P¨£
 *
pP¨£
, 
⁄Eº‹
){

84777 
TabÀ
 *
p
;

84778 
p
 = 
pP¨£
->
pNewTabÀ
;

84779 if–
p
==0 || 
	`NEVER
’->
nCﬁ
<1) ) ;

84780 
p
->
aCﬁ
[p->
nCﬁ
-1].
nŸNuŒ
 = (
u8
)
⁄Eº‹
;

84808 
SQLITE_PRIVATE
 
	`sqlôe3AfföôyTy≥
(c⁄° *
zIn
, 
u8
 *
pszE°
){

84809 
u32
 
h
 = 0;

84810 
aff
 = 
SQLITE_AFF_NUMERIC
;

84811 c⁄° *
zCh¨
 = 0;

84813 if–
zIn
==0 )  
aff
;

84814  
zIn
[0] ){

84815 
h
 = (h<<8Ë+ 
sqlôe3UµîToLowî
[(*
zIn
)&0xff];

84816 
zIn
++;

84817 if–
h
==(('c'<<24)+('h'<<16)+('a'<<8)+'r') ){

84818 
aff
 = 
SQLITE_AFF_TEXT
;

84819 
zCh¨
 = 
zIn
;

84820 }if–
h
==(('c'<<24)+('l'<<16)+('o'<<8)+'b') ){

84821 
aff
 = 
SQLITE_AFF_TEXT
;

84822 }if–
h
==(('t'<<24)+('e'<<16)+('x'<<8)+'t') ){

84823 
aff
 = 
SQLITE_AFF_TEXT
;

84824 }if–
h
==(('b'<<24)+('l'<<16)+('o'<<8)+'b')

84825 && (
aff
==
SQLITE_AFF_NUMERIC
 ||áff==
SQLITE_AFF_REAL
) ){

84826 
aff
 = 
SQLITE_AFF_NONE
;

84827 if–
zIn
[0]=='(' ) 
zCh¨
 = zIn;

84828 #i‚de‡
SQLITE_OMIT_FLOATING_POINT


84829 }if–
h
==(('r'<<24)+('e'<<16)+('a'<<8)+'l')

84830 && 
aff
==
SQLITE_AFF_NUMERIC
 ){

84831 
aff
 = 
SQLITE_AFF_REAL
;

84832 }if–
h
==(('f'<<24)+('l'<<16)+('o'<<8)+'a')

84833 && 
aff
==
SQLITE_AFF_NUMERIC
 ){

84834 
aff
 = 
SQLITE_AFF_REAL
;

84835 }if–
h
==(('d'<<24)+('o'<<16)+('u'<<8)+'b')

84836 && 
aff
==
SQLITE_AFF_NUMERIC
 ){

84837 
aff
 = 
SQLITE_AFF_REAL
;

84839 }if–(
h
&0x00FFFFFF)==(('i'<<16)+('n'<<8)+'t') ){

84840 
aff
 = 
SQLITE_AFF_INTEGER
;

84847 if–
pszE°
 ){

84848 *
pszE°
 = 1;

84849 if–
aff
<=
SQLITE_AFF_NONE
 ){

84850 if–
zCh¨
 ){

84851  
zCh¨
[0] ){

84852 if–
	`sqlôe3Isdigô
(
zCh¨
[0]) ){

84853 
v
 = 0;

84854 
	`sqlôe3GëI¡32
(
zCh¨
, &
v
);

84855 
v
 = v/4 + 1;

84856 if–
v
>255 ) v = 255;

84857 *
pszE°
 = 
v
;

84860 
zCh¨
++;

84863 *
pszE°
 = 5;

84867  
aff
;

84879 
SQLITE_PRIVATE
 
	`sqlôe3AddCﬁumnTy≥
(
P¨£
 *
pP¨£
, 
Tokí
 *
pTy≥
){

84880 
TabÀ
 *
p
;

84881 
Cﬁumn
 *
pCﬁ
;

84883 
p
 = 
pP¨£
->
pNewTabÀ
;

84884 if–
p
==0 || 
	`NEVER
’->
nCﬁ
<1) ) ;

84885 
pCﬁ
 = &
p
->
aCﬁ
[p->
nCﬁ
-1];

84886 
	`as£π
–
pCﬁ
->
zTy≥
==0 );

84887 
pCﬁ
->
zTy≥
 = 
	`sqlôe3NameFromTokí
(
pP¨£
->
db
, 
pTy≥
);

84888 
pCﬁ
->
afföôy
 = 
	`sqlôe3AfföôyTy≥
’Cﬁ->
zTy≥
, &pCﬁ->
szE°
);

84901 
SQLITE_PRIVATE
 
	`sqlôe3AddDeÁu…VÆue
(
P¨£
 *
pP¨£
, 
Ex¥S∑n
 *
pS∑n
){

84902 
TabÀ
 *
p
;

84903 
Cﬁumn
 *
pCﬁ
;

84904 
sqlôe3
 *
db
 = 
pP¨£
->db;

84905 
p
 = 
pP¨£
->
pNewTabÀ
;

84906 if–
p
!=0 ){

84907 
pCﬁ
 = &(
p
->
aCﬁ
[p->
nCﬁ
-1]);

84908 if–!
	`sqlôe3Ex¥IsC⁄°™tOrFun˘i⁄
(
pS∑n
->
pEx¥
) ){

84909 
	`sqlôe3Eº‹Msg
(
pP¨£
, "default value of column [%s] isÇot constant",

84910 
pCﬁ
->
zName
);

84916 
	`sqlôe3Ex¥Dñëe
(
db
, 
pCﬁ
->
pDÊt
);

84917 
pCﬁ
->
pDÊt
 = 
	`sqlôe3Ex¥Dup
(
db
, 
pS∑n
->
pEx¥
, 
EXPRDUP_REDUCE
);

84918 
	`sqlôe3DbFªe
(
db
, 
pCﬁ
->
zDÊt
);

84919 
pCﬁ
->
zDÊt
 = 
	`sqlôe3DbSåNDup
(
db
, (*)
pS∑n
->
zSèπ
,

84920 ()(
pS∑n
->
zEnd
 -ÖS∑n->
zSèπ
));

84923 
	`sqlôe3Ex¥Dñëe
(
db
, 
pS∑n
->
pEx¥
);

84944 
SQLITE_PRIVATE
 
	`sqlôe3AddPrim¨yKey
(

84945 
P¨£
 *
pP¨£
,

84946 
Ex¥Li°
 *
pLi°
,

84947 
⁄Eº‹
,

84948 
autoInc
,

84949 
s‹tOrdî


84951 
TabÀ
 *
pTab
 = 
pP¨£
->
pNewTabÀ
;

84952 *
zTy≥
 = 0;

84953 
iCﬁ
 = -1, 
i
;

84954 if–
pTab
==0 || 
IN_DECLARE_VTAB
 ) 
¥im¨y_key_exô
;

84955 if–
pTab
->
èbFœgs
 & 
TF_HasPrim¨yKey
 ){

84956 
	`sqlôe3Eº‹Msg
(
pP¨£
,

84957 "èbÀ \"%s\" ha†m‹êth™ o√Örim¨y key", 
pTab
->
zName
);

84958 
¥im¨y_key_exô
;

84960 
pTab
->
èbFœgs
 |
TF_HasPrim¨yKey
;

84961 if–
pLi°
==0 ){

84962 
iCﬁ
 = 
pTab
->
nCﬁ
 - 1;

84963 
pTab
->
aCﬁ
[
iCﬁ
].
cﬁFœgs
 |
COLFLAG_PRIMKEY
;

84965 
i
=0; i<
pLi°
->
nEx¥
; i++){

84966 
iCﬁ
=0; iCﬁ<
pTab
->
nCﬁ
; iCol++){

84967 if–
	`sqlôe3SåICmp
(
pLi°
->
a
[
i
].
zName
, 
pTab
->
aCﬁ
[
iCﬁ
].zName)==0 ){

84971 if–
iCﬁ
<
pTab
->
nCﬁ
 ){

84972 
pTab
->
aCﬁ
[
iCﬁ
].
cﬁFœgs
 |
COLFLAG_PRIMKEY
;

84975 if–
pLi°
->
nEx¥
>1 ) 
iCﬁ
 = -1;

84977 if–
iCﬁ
>=0 && iCﬁ<
pTab
->
nCﬁ
 ){

84978 
zTy≥
 = 
pTab
->
aCﬁ
[
iCﬁ
].zType;

84980 if–
zTy≥
 && 
	`sqlôe3SåICmp
(zType, "INTEGER")==0

84981 && 
s‹tOrdî
==
SQLITE_SO_ASC
 ){

84982 
pTab
->
iPKey
 = 
iCﬁ
;

84983 
pTab
->
keyC⁄f
 = (
u8
)
⁄Eº‹
;

84984 
	`as£π
–
autoInc
==0 ||áutoInc==1 );

84985 
pTab
->
èbFœgs
 |
autoInc
*
TF_Autoö¸emít
;

84986 }if–
autoInc
 ){

84987 #i‚de‡
SQLITE_OMIT_AUTOINCREMENT


84988 
	`sqlôe3Eº‹Msg
(
pP¨£
, "AUTOINCREMENT is onlyállowed onán "

84992 
Index
 *
p
;

84993 
p
 = 
	`sqlôe3Cª©eIndex
(
pP¨£
, 0, 0, 0, 
pLi°
, 
⁄Eº‹
, 0,

84994 0, 
s‹tOrdî
, 0);

84995 if–
p
 ){

84996 
p
->
autoIndex
 = 2;

84998 
pLi°
 = 0;

85001 
¥im¨y_key_exô
:

85002 
	`sqlôe3Ex¥Li°Dñëe
(
pP¨£
->
db
, 
pLi°
);

85009 
SQLITE_PRIVATE
 
	`sqlôe3AddCheckC⁄°øöt
(

85010 
P¨£
 *
pP¨£
,

85011 
Ex¥
 *
pCheckEx¥


85013 #i‚de‡
SQLITE_OMIT_CHECK


85014 
TabÀ
 *
pTab
 = 
pP¨£
->
pNewTabÀ
;

85015 if–
pTab
 && !
IN_DECLARE_VTAB
 ){

85016 
pTab
->
pCheck
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,ÖTab->pCheck, 
pCheckEx¥
);

85017 if–
pP¨£
->
c⁄°øötName
.
n
 ){

85018 
	`sqlôe3Ex¥Li°SëName
(
pP¨£
, 
pTab
->
pCheck
, &pP¨£->
c⁄°øötName
, 1);

85023 
	`sqlôe3Ex¥Dñëe
(
pP¨£
->
db
, 
pCheckEx¥
);

85031 
SQLITE_PRIVATE
 
	`sqlôe3AddCﬁœãTy≥
(
P¨£
 *
pP¨£
, 
Tokí
 *
pTokí
){

85032 
TabÀ
 *
p
;

85033 
i
;

85034 *
zCﬁl
;

85035 
sqlôe3
 *
db
;

85037 if–(
p
 = 
pP¨£
->
pNewTabÀ
)==0 ) ;

85038 
i
 = 
p
->
nCﬁ
-1;

85039 
db
 = 
pP¨£
->db;

85040 
zCﬁl
 = 
	`sqlôe3NameFromTokí
(
db
, 
pTokí
);

85041 if–!
zCﬁl
 ) ;

85043 if–
	`sqlôe3LoˇãCﬁlSeq
(
pP¨£
, 
zCﬁl
) ){

85044 
Index
 *
pIdx
;

85045 
	`sqlôe3DbFªe
(
db
, 
p
->
aCﬁ
[
i
].
zCﬁl
);

85046 
p
->
aCﬁ
[
i
].
zCﬁl
 = zColl;

85052 
pIdx
=
p
->
pIndex
;ÖIdx;ÖIdxıIdx->
pNext
){

85053 
	`as£π
–
pIdx
->
nCﬁumn
==1 );

85054 if–
pIdx
->
aiCﬁumn
[0]==
i
 ){

85055 
pIdx
->
azCﬁl
[0] = 
p
->
aCﬁ
[
i
].
zCﬁl
;

85059 
	`sqlôe3DbFªe
(
db
, 
zCﬁl
);

85083 
SQLITE_PRIVATE
 
CﬁlSeq
 *
	`sqlôe3LoˇãCﬁlSeq
(
P¨£
 *
pP¨£
, c⁄° *
zName
){

85084 
sqlôe3
 *
db
 = 
pP¨£
->db;

85085 
u8
 
íc
 = 
	`ENC
(
db
);

85086 
u8
 
öôbusy
 = 
db
->
öô
.
busy
;

85087 
CﬁlSeq
 *
pCﬁl
;

85089 
pCﬁl
 = 
	`sqlôe3FödCﬁlSeq
(
db
, 
íc
, 
zName
, 
öôbusy
);

85090 if–!
öôbusy
 && (!
pCﬁl
 || !pCﬁl->
xCmp
) ){

85091 
pCﬁl
 = 
	`sqlôe3GëCﬁlSeq
(
pP¨£
, 
íc
,ÖCﬁl, 
zName
);

85094  
pCﬁl
;

85114 
SQLITE_PRIVATE
 
	`sqlôe3Ch™geCookõ
(
P¨£
 *
pP¨£
, 
iDb
){

85115 
r1
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

85116 
sqlôe3
 *
db
 = 
pP¨£
->db;

85117 
Vdbe
 *
v
 = 
pP¨£
->
pVdbe
;

85118 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 
iDb
, 0) );

85119 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 
db
->
aDb
[
iDb
].
pSchema
->
schema_cookõ
+1, 
r1
);

85120 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_SëCookõ
, 
iDb
, 
BTREE_SCHEMA_VERSION
, 
r1
);

85121 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
r1
);

85132 
	`idítLígth
(c⁄° *
z
){

85133 
n
;

85134 
n
=0; *
z
;Ç++, z++){

85135 if–*
z
=='"' ){ 
n
++; }

85137  
n
 + 2;

85153 
	`idítPut
(*
z
, *
pIdx
, *
zSig√dIdít
){

85154 *
zIdít
 = (*)
zSig√dIdít
;

85155 
i
, 
j
, 
√edQuŸe
;

85156 
i
 = *
pIdx
;

85158 
j
=0; 
zIdít
[j]; j++){

85159 if–!
	`sqlôe3Iß um
(
zIdít
[
j
]) && zIdent[j]!='_' ) ;

85161 
√edQuŸe
 = 
	`sqlôe3Isdigô
(
zIdít
[0]Ë|| 
	`sqlôe3Keyw‹dCode
(zIdít, 
j
)!=
TK_ID
;

85162 if–!
√edQuŸe
 ){

85163 
√edQuŸe
 = 
zIdít
[
j
];

85166 if–
√edQuŸe
 ) 
z
[
i
++] = '"';

85167 
j
=0; 
zIdít
[j]; j++){

85168 
z
[
i
++] = 
zIdít
[
j
];

85169 if–
zIdít
[
j
]=='"' ) 
z
[
i
++] = '"';

85171 if–
√edQuŸe
 ) 
z
[
i
++] = '"';

85172 
z
[
i
] = 0;

85173 *
pIdx
 = 
i
;

85181 *
	`¸óãTabÀStmt
(
sqlôe3
 *
db
, 
TabÀ
 *
p
){

85182 
i
, 
k
, 
n
;

85183 *
zStmt
;

85184 *
zSï
, *
zSï2
, *
zEnd
;

85185 
Cﬁumn
 *
pCﬁ
;

85186 
n
 = 0;

85187 
pCﬁ
 = 
p
->
aCﬁ
, 
i
=0; i<p->
nCﬁ
; i++,ÖCol++){

85188 
n
 +
	`idítLígth
(
pCﬁ
->
zName
) + 5;

85190 
n
 +
	`idítLígth
(
p
->
zName
);

85191 if–
n
<50 ){

85192 
zSï
 = "";

85193 
zSï2
 = ",";

85194 
zEnd
 = ")";

85196 
zSï
 = "\n ";

85197 
zSï2
 = ",\n ";

85198 
zEnd
 = "\n)";

85200 
n
 +35 + 6*
p
->
nCﬁ
;

85201 
zStmt
 = 
	`sqlôe3DbMÆlocRaw
(0, 
n
);

85202 if–
zStmt
==0 ){

85203 
db
->
mÆlocFaûed
 = 1;

85206 
	`sqlôe3_¢¥ötf
(
n
, 
zStmt
, "CREATE TABLE ");

85207 
k
 = 
	`sqlôe3SåÀn30
(
zStmt
);

85208 
	`idítPut
(
zStmt
, &
k
, 
p
->
zName
);

85209 
zStmt
[
k
++] = '(';

85210 
pCﬁ
=
p
->
aCﬁ
, 
i
=0; i<p->
nCﬁ
; i++,ÖCol++){

85211 c⁄° * c⁄° 
azTy≥
[] = {

85218 
Àn
;

85219 c⁄° *
zTy≥
;

85221 
	`sqlôe3_¢¥ötf
(
n
-
k
, &
zStmt
[k], 
zSï
);

85222 
k
 +
	`sqlôe3SåÀn30
(&
zStmt
[k]);

85223 
zSï
 = 
zSï2
;

85224 
	`idítPut
(
zStmt
, &
k
, 
pCﬁ
->
zName
);

85225 
	`as£π
–
pCﬁ
->
afföôy
-
SQLITE_AFF_TEXT
 >= 0 );

85226 
	`as£π
–
pCﬁ
->
afföôy
-
SQLITE_AFF_TEXT
 < 
	`AºaySize
(
azTy≥
) );

85227 
	`ã°ˇ£
–
pCﬁ
->
afföôy
==
SQLITE_AFF_TEXT
 );

85228 
	`ã°ˇ£
–
pCﬁ
->
afföôy
==
SQLITE_AFF_NONE
 );

85229 
	`ã°ˇ£
–
pCﬁ
->
afföôy
==
SQLITE_AFF_NUMERIC
 );

85230 
	`ã°ˇ£
–
pCﬁ
->
afföôy
==
SQLITE_AFF_INTEGER
 );

85231 
	`ã°ˇ£
–
pCﬁ
->
afföôy
==
SQLITE_AFF_REAL
 );

85233 
zTy≥
 = 
azTy≥
[
pCﬁ
->
afföôy
 - 
SQLITE_AFF_TEXT
];

85234 
Àn
 = 
	`sqlôe3SåÀn30
(
zTy≥
);

85235 
	`as£π
–
pCﬁ
->
afföôy
==
SQLITE_AFF_NONE


85236 || 
pCﬁ
->
afföôy
==
	`sqlôe3AfföôyTy≥
(
zTy≥
, 0) );

85237 
	`mem˝y
(&
zStmt
[
k
], 
zTy≥
, 
Àn
);

85238 
k
 +
Àn
;

85239 
	`as£π
–
k
<=
n
 );

85241 
	`sqlôe3_¢¥ötf
(
n
-
k
, &
zStmt
[k], "%s", 
zEnd
);

85242  
zStmt
;

85248 
	`e°im©eTabÀWidth
(
TabÀ
 *
pTab
){

85249 
wTabÀ
 = 0;

85250 c⁄° 
Cﬁumn
 *
pTabCﬁ
;

85251 
i
;

85252 
i
=
pTab
->
nCﬁ
, 
pTabCﬁ
ıTab->
aCﬁ
; i>0; i--,ÖTabCol++){

85253 
wTabÀ
 +
pTabCﬁ
->
szE°
;

85255 if–
pTab
->
iPKey
<0 ) 
wTabÀ
++;

85256 
pTab
->
szTabRow
 = 
	`sqlôe3LogE°
(
wTabÀ
*4);

85262 
	`e°im©eIndexWidth
(
Index
 *
pIdx
){

85263 
wIndex
 = 1;

85264 
i
;

85265 c⁄° 
Cﬁumn
 *
aCﬁ
 = 
pIdx
->
pTabÀ
->aCol;

85266 
i
=0; i<
pIdx
->
nCﬁumn
; i++){

85267 
	`as£π
–
pIdx
->
aiCﬁumn
[
i
]>=0 &&ÖIdx->aiCﬁumn[i]<pIdx->
pTabÀ
->
nCﬁ
 );

85268 
wIndex
 +
aCﬁ
[
pIdx
->
aiCﬁumn
[
i
]].
szE°
;

85270 
pIdx
->
szIdxRow
 = 
	`sqlôe3LogE°
(
wIndex
*4);

85293 
SQLITE_PRIVATE
 
	`sqlôe3EndTabÀ
(

85294 
P¨£
 *
pP¨£
,

85295 
Tokí
 *
pC⁄s
,

85296 
Tokí
 *
pEnd
,

85297 
Sñe˘
 *
pSñe˘


85299 
TabÀ
 *
p
;

85300 
sqlôe3
 *
db
 = 
pP¨£
->db;

85301 
iDb
;

85302 
Index
 *
pIdx
;

85304 if–(
pEnd
==0 && 
pSñe˘
==0Ë|| 
db
->
mÆlocFaûed
 ){

85307 
p
 = 
pP¨£
->
pNewTabÀ
;

85308 if–
p
==0 ) ;

85310 
	`as£π
–!
db
->
öô
.
busy
 || !
pSñe˘
 );

85312 
iDb
 = 
	`sqlôe3SchemaToIndex
(
db
, 
p
->
pSchema
);

85314 #i‚de‡
SQLITE_OMIT_CHECK


85317 if–
p
->
pCheck
 ){

85318 
	`sqlôe3ResﬁveSñfRe„ªn˚
(
pP¨£
, 
p
, 
NC_IsCheck
, 0,Ö->
pCheck
);

85323 
	`e°im©eTabÀWidth
(
p
);

85324 
pIdx
=
p
->
pIndex
;ÖIdx;ÖIdxıIdx->
pNext
){

85325 
	`e°im©eIndexWidth
(
pIdx
);

85334 if–
db
->
öô
.
busy
 ){

85335 
p
->
äum
 = 
db
->
öô
.
√wTnum
;

85344 if–!
db
->
öô
.
busy
 ){

85345 
n
;

85346 
Vdbe
 *
v
;

85347 *
zTy≥
;

85348 *
zTy≥2
;

85349 *
zStmt
;

85351 
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

85352 if–
	`NEVER
(
v
==0) ) ;

85354 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Clo£
, 0);

85359 if–
p
->
pSñe˘
==0 ){

85361 
zTy≥
 = "table";

85362 
zTy≥2
 = "TABLE";

85363 #i‚de‡
SQLITE_OMIT_VIEW


85366 
zTy≥
 = "view";

85367 
zTy≥2
 = "VIEW";

85384 if–
pSñe˘
 ){

85385 
Sñe˘De°
 
de°
;

85386 
TabÀ
 *
pSñTab
;

85388 
	`as£π
(
pP¨£
->
nTab
==1);

85389 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_O≥nWrôe
, 1, 
pP¨£
->
ªgRoŸ
, 
iDb
);

85390 
	`sqlôe3VdbeCh™geP5
(
v
, 
OPFLAG_P2ISREG
);

85391 
pP¨£
->
nTab
 = 2;

85392 
	`sqlôe3Sñe˘De°Inô
(&
de°
, 
SRT_TabÀ
, 1);

85393 
	`sqlôe3Sñe˘
(
pP¨£
, 
pSñe˘
, &
de°
);

85394 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Clo£
, 1);

85395 if–
pP¨£
->
nEº
==0 ){

85396 
pSñTab
 = 
	`sqlôe3Resu…SëOfSñe˘
(
pP¨£
, 
pSñe˘
);

85397 if–
pSñTab
==0 ) ;

85398 
	`as£π
–
p
->
aCﬁ
==0 );

85399 
p
->
nCﬁ
 = 
pSñTab
->nCol;

85400 
p
->
aCﬁ
 = 
pSñTab
->aCol;

85401 
pSñTab
->
nCﬁ
 = 0;

85402 
pSñTab
->
aCﬁ
 = 0;

85403 
	`sqlôe3DñëeTabÀ
(
db
, 
pSñTab
);

85408 if–
pSñe˘
 ){

85409 
zStmt
 = 
	`¸óãTabÀStmt
(
db
, 
p
);

85411 
n
 = ()(
pEnd
->
z
 - 
pP¨£
->
sNameTokí
.z) + 1;

85412 
zStmt
 = 
	`sqlôe3MPrötf
(
db
,

85413 "CREATE %†%.*s", 
zTy≥2
, 
n
, 
pP¨£
->
sNameTokí
.
z


85421 
	`sqlôe3Ne°edP¨£
(
pP¨£
,

85425 
db
->
aDb
[
iDb
].
zName
, 
	`SCHEMA_TABLE
(iDb),

85426 
zTy≥
,

85427 
p
->
zName
,

85428 
p
->
zName
,

85429 
pP¨£
->
ªgRoŸ
,

85430 
zStmt
,

85431 
pP¨£
->
ªgRowid


85433 
	`sqlôe3DbFªe
(
db
, 
zStmt
);

85434 
	`sqlôe3Ch™geCookõ
(
pP¨£
, 
iDb
);

85436 #i‚de‡
SQLITE_OMIT_AUTOINCREMENT


85440 if–
p
->
èbFœgs
 & 
TF_Autoö¸emít
 ){

85441 
Db
 *
pDb
 = &
db
->
aDb
[
iDb
];

85442 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 
iDb
, 0) );

85443 if–
pDb
->
pSchema
->
pSeqTab
==0 ){

85444 
	`sqlôe3Ne°edP¨£
(
pP¨£
,

85446 
pDb
->
zName


85453 
	`sqlôe3VdbeAddP¨£SchemaOp
(
v
, 
iDb
,

85454 
	`sqlôe3MPrötf
(
db
, "tbl_«me='%q'", 
p
->
zName
));

85460 if–
db
->
öô
.
busy
 ){

85461 
TabÀ
 *
pOld
;

85462 
Schema
 *
pSchema
 = 
p
->pSchema;

85463 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 
iDb
, 0) );

85464 
pOld
 = 
	`sqlôe3HashIn£π
(&
pSchema
->
tblHash
, 
p
->
zName
,

85465 
	`sqlôe3SåÀn30
(
p
->
zName
),p);

85466 if–
pOld
 ){

85467 
	`as£π
–
p
==
pOld
 );

85468 
db
->
mÆlocFaûed
 = 1;

85471 
pP¨£
->
pNewTabÀ
 = 0;

85472 
db
->
Êags
 |
SQLITE_I¡înCh™ges
;

85474 #i‚de‡
SQLITE_OMIT_ALTERTABLE


85475 if–!
p
->
pSñe˘
 ){

85476 c⁄° *
zName
 = (c⁄° *)
pP¨£
->
sNameTokí
.
z
;

85477 
nName
;

85478 
	`as£π
–!
pSñe˘
 && 
pC⁄s
 && 
pEnd
 );

85479 if–
pC⁄s
->
z
==0 ){

85480 
pC⁄s
 = 
pEnd
;

85482 
nName
 = ()((c⁄° *)
pC⁄s
->
z
 - 
zName
);

85483 
p
->
addCﬁOff£t
 = 13 + 
	`sqlôe3Utf8Ch¨Lí
(
zName
, 
nName
);

85489 #i‚de‡
SQLITE_OMIT_VIEW


85493 
SQLITE_PRIVATE
 
	`sqlôe3Cª©eVõw
(

85494 
P¨£
 *
pP¨£
,

85495 
Tokí
 *
pBegö
,

85496 
Tokí
 *
pName1
,

85497 
Tokí
 *
pName2
,

85498 
Sñe˘
 *
pSñe˘
,

85499 
isTemp
,

85500 
noEº


85502 
TabÀ
 *
p
;

85503 
n
;

85504 c⁄° *
z
;

85505 
Tokí
 
sEnd
;

85506 
DbFixî
 
sFix
;

85507 
Tokí
 *
pName
 = 0;

85508 
iDb
;

85509 
sqlôe3
 *
db
 = 
pP¨£
->db;

85511 if–
pP¨£
->
nV¨
>0 ){

85512 
	`sqlôe3Eº‹Msg
(
pP¨£
, "parametersáreÇotállowed in views");

85513 
	`sqlôe3Sñe˘Dñëe
(
db
, 
pSñe˘
);

85516 
	`sqlôe3SèπTabÀ
(
pP¨£
, 
pName1
, 
pName2
, 
isTemp
, 1, 0, 
noEº
);

85517 
p
 = 
pP¨£
->
pNewTabÀ
;

85518 if–
p
==0 || 
pP¨£
->
nEº
 ){

85519 
	`sqlôe3Sñe˘Dñëe
(
db
, 
pSñe˘
);

85522 
	`sqlôe3TwoP¨tName
(
pP¨£
, 
pName1
, 
pName2
, &
pName
);

85523 
iDb
 = 
	`sqlôe3SchemaToIndex
(
db
, 
p
->
pSchema
);

85524 
	`sqlôe3FixInô
(&
sFix
, 
pP¨£
, 
iDb
, "võw", 
pName
);

85525 if–
	`sqlôe3FixSñe˘
(&
sFix
, 
pSñe˘
) ){

85526 
	`sqlôe3Sñe˘Dñëe
(
db
, 
pSñe˘
);

85535 
p
->
pSñe˘
 = 
	`sqlôe3Sñe˘Dup
(
db
,ÖSñe˘, 
EXPRDUP_REDUCE
);

85536 
	`sqlôe3Sñe˘Dñëe
(
db
, 
pSñe˘
);

85537 if–
db
->
mÆlocFaûed
 ){

85540 if–!
db
->
öô
.
busy
 ){

85541 
	`sqlôe3VõwGëCﬁumnNames
(
pP¨£
, 
p
);

85547 
sEnd
 = 
pP¨£
->
sLa°Tokí
;

85548 if–
	`ALWAYS
(
sEnd
.
z
[0]!=0) && sEnd.z[0]!=';' ){

85549 
sEnd
.
z
 +sEnd.
n
;

85551 
sEnd
.
n
 = 0;

85552 
n
 = ()(
sEnd
.
z
 - 
pBegö
->z);

85553 
z
 = 
pBegö
->z;

85554  
	`ALWAYS
(
n
>0Ë&& 
	`sqlôe3Is•a˚
(
z
[n-1]) ){Ç--; }

85555 
sEnd
.
z
 = &z[
n
-1];

85556 
sEnd
.
n
 = 1;

85559 
	`sqlôe3EndTabÀ
(
pP¨£
, 0, &
sEnd
, 0);

85564 #i‡!
	`deföed
(
SQLITE_OMIT_VIEW
Ë|| !deföed(
SQLITE_OMIT_VIRTUALTABLE
)

85570 
SQLITE_PRIVATE
 
	`sqlôe3VõwGëCﬁumnNames
(
P¨£
 *
pP¨£
, 
TabÀ
 *
pTabÀ
){

85571 
TabÀ
 *
pSñTab
;

85572 
Sñe˘
 *
pSñ
;

85573 
nEº
 = 0;

85574 
n
;

85575 
sqlôe3
 *
db
 = 
pP¨£
->db;

85576 (*
xAuth
)(*,,const *,const *,const *,const *);

85578 
	`as£π
–
pTabÀ
 );

85580 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


85581 if–
	`sqlôe3VèbCÆlC⁄√˘
(
pP¨£
, 
pTabÀ
) ){

85582  
SQLITE_ERROR
;

85584 if–
	`IsVútuÆ
(
pTabÀ
) )  0;

85587 #i‚de‡
SQLITE_OMIT_VIEW


85591 if–
pTabÀ
->
nCﬁ
>0 )  0;

85608 if–
pTabÀ
->
nCﬁ
<0 ){

85609 
	`sqlôe3Eº‹Msg
(
pP¨£
, "võw %†i†cúcuœæy deföed", 
pTabÀ
->
zName
);

85612 
	`as£π
–
pTabÀ
->
nCﬁ
>=0 );

85621 
	`as£π
–
pTabÀ
->
pSñe˘
 );

85622 
pSñ
 = 
	`sqlôe3Sñe˘Dup
(
db
, 
pTabÀ
->
pSñe˘
, 0);

85623 if–
pSñ
 ){

85624 
u8
 
íabÀLookaside
 = 
db
->
lookaside
.
bE«bÀd
;

85625 
n
 = 
pP¨£
->
nTab
;

85626 
	`sqlôe3SrcLi°AssignCurs‹s
(
pP¨£
, 
pSñ
->
pSrc
);

85627 
pTabÀ
->
nCﬁ
 = -1;

85628 
db
->
lookaside
.
bE«bÀd
 = 0;

85629 #i‚de‡
SQLITE_OMIT_AUTHORIZATION


85630 
xAuth
 = 
db
->xAuth;

85631 
db
->
xAuth
 = 0;

85632 
pSñTab
 = 
	`sqlôe3Resu…SëOfSñe˘
(
pP¨£
, 
pSñ
);

85633 
db
->
xAuth
 = xAuth;

85635 
pSñTab
 = 
	`sqlôe3Resu…SëOfSñe˘
(
pP¨£
, 
pSñ
);

85637 
db
->
lookaside
.
bE«bÀd
 = 
íabÀLookaside
;

85638 
pP¨£
->
nTab
 = 
n
;

85639 if–
pSñTab
 ){

85640 
	`as£π
–
pTabÀ
->
aCﬁ
==0 );

85641 
pTabÀ
->
nCﬁ
 = 
pSñTab
->nCol;

85642 
pTabÀ
->
aCﬁ
 = 
pSñTab
->aCol;

85643 
pSñTab
->
nCﬁ
 = 0;

85644 
pSñTab
->
aCﬁ
 = 0;

85645 
	`sqlôe3DñëeTabÀ
(
db
, 
pSñTab
);

85646 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 0, 
pTabÀ
->
pSchema
) );

85647 
pTabÀ
->
pSchema
->
Êags
 |
DB_Uƒe£tVõws
;

85649 
pTabÀ
->
nCﬁ
 = 0;

85650 
nEº
++;

85652 
	`sqlôe3Sñe˘Dñëe
(
db
, 
pSñ
);

85654 
nEº
++;

85657  
nEº
;

85661 #i‚de‡
SQLITE_OMIT_VIEW


85665 
	`sqlôeVõwRe£tAŒ
(
sqlôe3
 *
db
, 
idx
){

85666 
HashEÀm
 *
i
;

85667 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 
idx
, 0) );

85668 if–!
	`DbHasPr›îty
(
db
, 
idx
, 
DB_Uƒe£tVõws
) ) ;

85669 
i
=
	`sqlôeHashFú°
(&
db
->
aDb
[
idx
].
pSchema
->
tblHash
); i;i=
	`sqlôeHashNext
(i)){

85670 
TabÀ
 *
pTab
 = 
	`sqlôeHashD©a
(
i
);

85671 if–
pTab
->
pSñe˘
 ){

85672 
	`sqlôeDñëeCﬁumnNames
(
db
, 
pTab
);

85673 
pTab
->
aCﬁ
 = 0;

85674 
pTab
->
nCﬁ
 = 0;

85677 
	`DbCÀ¨Pr›îty
(
db
, 
idx
, 
DB_Uƒe£tVõws
);

85680 
	#sqlôeVõwRe£tAŒ
(
A
,
B
)

	)

85700 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


85701 
SQLITE_PRIVATE
 
	`sqlôe3RoŸPageMoved
(
sqlôe3
 *
db
, 
iDb
, 
iFrom
, 
iTo
){

85702 
HashEÀm
 *
pEÀm
;

85703 
Hash
 *
pHash
;

85704 
Db
 *
pDb
;

85706 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 
iDb
, 0) );

85707 
pDb
 = &
db
->
aDb
[
iDb
];

85708 
pHash
 = &
pDb
->
pSchema
->
tblHash
;

85709 
pEÀm
=
	`sqlôeHashFú°
(
pHash
);ÖEÀm;ÖEÀm=
	`sqlôeHashNext
(pElem)){

85710 
TabÀ
 *
pTab
 = 
	`sqlôeHashD©a
(
pEÀm
);

85711 if–
pTab
->
äum
==
iFrom
 ){

85712 
pTab
->
äum
 = 
iTo
;

85715 
pHash
 = &
pDb
->
pSchema
->
idxHash
;

85716 
pEÀm
=
	`sqlôeHashFú°
(
pHash
);ÖEÀm;ÖEÀm=
	`sqlôeHashNext
(pElem)){

85717 
Index
 *
pIdx
 = 
	`sqlôeHashD©a
(
pEÀm
);

85718 if–
pIdx
->
äum
==
iFrom
 ){

85719 
pIdx
->
äum
 = 
iTo
;

85731 
	`de°royRoŸPage
(
P¨£
 *
pP¨£
, 
iTabÀ
, 
iDb
){

85732 
Vdbe
 *
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

85733 
r1
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

85734 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_De°roy
, 
iTabÀ
, 
r1
, 
iDb
);

85735 
	`sqlôe3MayAb‹t
(
pP¨£
);

85736 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


85746 
	`sqlôe3Ne°edP¨£
(
pP¨£
,

85748 
pP¨£
->
db
->
aDb
[
iDb
].
zName
, 
	`SCHEMA_TABLE
(iDb), 
iTabÀ
, 
r1
,Ñ1);

85750 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
r1
);

85759 
	`de°royTabÀ
(
P¨£
 *
pP¨£
, 
TabÀ
 *
pTab
){

85760 #ifde‡
SQLITE_OMIT_AUTOVACUUM


85761 
Index
 *
pIdx
;

85762 
iDb
 = 
	`sqlôe3SchemaToIndex
(
pP¨£
->
db
, 
pTab
->
pSchema
);

85763 
	`de°royRoŸPage
(
pP¨£
, 
pTab
->
äum
, 
iDb
);

85764 
pIdx
=
pTab
->
pIndex
;ÖIdx;ÖIdxıIdx->
pNext
){

85765 
	`de°royRoŸPage
(
pP¨£
, 
pIdx
->
äum
, 
iDb
);

85784 
iTab
 = 
pTab
->
äum
;

85785 
iDe°royed
 = 0;

85788 
Index
 *
pIdx
;

85789 
iL¨ge°
 = 0;

85791 if–
iDe°royed
==0 || 
iTab
<iDestroyed ){

85792 
iL¨ge°
 = 
iTab
;

85794 
pIdx
=
pTab
->
pIndex
;ÖIdx;ÖIdxıIdx->
pNext
){

85795 
iIdx
 = 
pIdx
->
äum
;

85796 
	`as£π
–
pIdx
->
pSchema
==
pTab
->pSchema );

85797 if–(
iDe°royed
==0 || (
iIdx
<iDe°royed)Ë&& iIdx>
iL¨ge°
 ){

85798 
iL¨ge°
 = 
iIdx
;

85801 if–
iL¨ge°
==0 ){

85804 
iDb
 = 
	`sqlôe3SchemaToIndex
(
pP¨£
->
db
, 
pTab
->
pSchema
);

85805 
	`as£π
–
iDb
>=0 && iDb<
pP¨£
->
db
->
nDb
 );

85806 
	`de°royRoŸPage
(
pP¨£
, 
iL¨ge°
, 
iDb
);

85807 
iDe°royed
 = 
iL¨ge°
;

85817 
	`sqlôe3CÀ¨SètTabÀs
(

85818 
P¨£
 *
pP¨£
,

85819 
iDb
,

85820 c⁄° *
zTy≥
,

85821 c⁄° *
zName


85823 
i
;

85824 c⁄° *
zDbName
 = 
pP¨£
->
db
->
aDb
[
iDb
].
zName
;

85825 
i
=1; i<=4; i++){

85826 
zTab
[24];

85827 
	`sqlôe3_¢¥ötf
((
zTab
),zTab,"sqlôe_°©%d",
i
);

85828 if–
	`sqlôe3FödTabÀ
(
pP¨£
->
db
, 
zTab
, 
zDbName
) ){

85829 
	`sqlôe3Ne°edP¨£
(
pP¨£
,

85831 
zDbName
, 
zTab
, 
zTy≥
, 
zName


85840 
SQLITE_PRIVATE
 
	`sqlôe3CodeDr›TabÀ
(
P¨£
 *
pP¨£
, 
TabÀ
 *
pTab
, 
iDb
, 
isVõw
){

85841 
Vdbe
 *
v
;

85842 
sqlôe3
 *
db
 = 
pP¨£
->db;

85843 
Triggî
 *
pTriggî
;

85844 
Db
 *
pDb
 = &
db
->
aDb
[
iDb
];

85846 
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

85847 
	`as£π
–
v
!=0 );

85848 
	`sqlôe3BegöWrôeO≥øti⁄
(
pP¨£
, 1, 
iDb
);

85850 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


85851 if–
	`IsVútuÆ
(
pTab
) ){

85852 
	`sqlôe3VdbeAddOp0
(
v
, 
OP_VBegö
);

85860 
pTriggî
 = 
	`sqlôe3TriggîLi°
(
pP¨£
, 
pTab
);

85861  
pTriggî
 ){

85862 
	`as£π
–
pTriggî
->
pSchema
==
pTab
->pSchema ||

85863 
pTriggî
->
pSchema
==
db
->
aDb
[1].pSchema );

85864 
	`sqlôe3Dr›TriggîPå
(
pP¨£
, 
pTriggî
);

85865 
pTriggî
 =ÖTriggî->
pNext
;

85868 #i‚de‡
SQLITE_OMIT_AUTOINCREMENT


85874 if–
pTab
->
èbFœgs
 & 
TF_Autoö¸emít
 ){

85875 
	`sqlôe3Ne°edP¨£
(
pP¨£
,

85877 
pDb
->
zName
, 
pTab
->zName

85889 
	`sqlôe3Ne°edP¨£
(
pP¨£
,

85891 
pDb
->
zName
, 
	`SCHEMA_TABLE
(
iDb
), 
pTab
->zName);

85892 if–!
isVõw
 && !
	`IsVútuÆ
(
pTab
) ){

85893 
	`de°royTabÀ
(
pP¨£
, 
pTab
);

85899 if–
	`IsVútuÆ
(
pTab
) ){

85900 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_VDe°roy
, 
iDb
, 0, 0, 
pTab
->
zName
, 0);

85902 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Dr›TabÀ
, 
iDb
, 0, 0, 
pTab
->
zName
, 0);

85903 
	`sqlôe3Ch™geCookõ
(
pP¨£
, 
iDb
);

85904 
	`sqlôeVõwRe£tAŒ
(
db
, 
iDb
);

85911 
SQLITE_PRIVATE
 
	`sqlôe3Dr›TabÀ
(
P¨£
 *
pP¨£
, 
SrcLi°
 *
pName
, 
isVõw
, 
noEº
){

85912 
TabÀ
 *
pTab
;

85913 
Vdbe
 *
v
;

85914 
sqlôe3
 *
db
 = 
pP¨£
->db;

85915 
iDb
;

85917 if–
db
->
mÆlocFaûed
 ){

85918 
exô_dr›_èbÀ
;

85920 
	`as£π
–
pP¨£
->
nEº
==0 );

85921 
	`as£π
–
pName
->
nSrc
==1 );

85922 if–
noEº
 ) 
db
->
suµªssEº
++;

85923 
pTab
 = 
	`sqlôe3LoˇãTabÀIãm
(
pP¨£
, 
isVõw
, &
pName
->
a
[0]);

85924 if–
noEº
 ) 
db
->
suµªssEº
--;

85926 if–
pTab
==0 ){

85927 if–
noEº
 ) 
	`sqlôe3CodeVîifyNamedSchema
(
pP¨£
, 
pName
->
a
[0].
zD©aba£
);

85928 
exô_dr›_èbÀ
;

85930 
iDb
 = 
	`sqlôe3SchemaToIndex
(
db
, 
pTab
->
pSchema
);

85931 
	`as£π
–
iDb
>=0 && iDb<
db
->
nDb
 );

85936 if–
	`IsVútuÆ
(
pTab
Ë&& 
	`sqlôe3VõwGëCﬁumnNames
(
pP¨£
,ÖTab) ){

85937 
exô_dr›_èbÀ
;

85939 #i‚de‡
SQLITE_OMIT_AUTHORIZATION


85941 
code
;

85942 c⁄° *
zTab
 = 
	`SCHEMA_TABLE
(
iDb
);

85943 c⁄° *
zDb
 = 
db
->
aDb
[
iDb
].
zName
;

85944 c⁄° *
zArg2
 = 0;

85945 if–
	`sqlôe3AuthCheck
(
pP¨£
, 
SQLITE_DELETE
, 
zTab
, 0, 
zDb
)){

85946 
exô_dr›_èbÀ
;

85948 if–
isVõw
 ){

85949 if–!
OMIT_TEMPDB
 && 
iDb
==1 ){

85950 
code
 = 
SQLITE_DROP_TEMP_VIEW
;

85952 
code
 = 
SQLITE_DROP_VIEW
;

85954 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


85955 }if–
	`IsVútuÆ
(
pTab
) ){

85956 
code
 = 
SQLITE_DROP_VTABLE
;

85957 
zArg2
 = 
	`sqlôe3GëVTabÀ
(
db
, 
pTab
)->
pMod
->
zName
;

85960 if–!
OMIT_TEMPDB
 && 
iDb
==1 ){

85961 
code
 = 
SQLITE_DROP_TEMP_TABLE
;

85963 
code
 = 
SQLITE_DROP_TABLE
;

85966 if–
	`sqlôe3AuthCheck
(
pP¨£
, 
code
, 
pTab
->
zName
, 
zArg2
, 
zDb
) ){

85967 
exô_dr›_èbÀ
;

85969 if–
	`sqlôe3AuthCheck
(
pP¨£
, 
SQLITE_DELETE
, 
pTab
->
zName
, 0, 
zDb
) ){

85970 
exô_dr›_èbÀ
;

85974 if–
	`sqlôe3SåNICmp
(
pTab
->
zName
, "sqlite_", 7)==0

85975 && 
	`sqlôe3SåNICmp
(
pTab
->
zName
, "sqlite_stat", 11)!=0 ){

85976 
	`sqlôe3Eº‹Msg
(
pP¨£
, "èbÀ %†mayÇŸ bêdr›≥d", 
pTab
->
zName
);

85977 
exô_dr›_èbÀ
;

85980 #i‚de‡
SQLITE_OMIT_VIEW


85984 if–
isVõw
 && 
pTab
->
pSñe˘
==0 ){

85985 
	`sqlôe3Eº‹Msg
(
pP¨£
, "u£ DROP TABLEÅÿdñëêèbÀ %s", 
pTab
->
zName
);

85986 
exô_dr›_èbÀ
;

85988 if–!
isVõw
 && 
pTab
->
pSñe˘
 ){

85989 
	`sqlôe3Eº‹Msg
(
pP¨£
, "u£ DROP VIEWÅÿdñëêvõw %s", 
pTab
->
zName
);

85990 
exô_dr›_èbÀ
;

85997 
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

85998 if–
v
 ){

85999 
	`sqlôe3BegöWrôeO≥øti⁄
(
pP¨£
, 1, 
iDb
);

86000 
	`sqlôe3CÀ¨SètTabÀs
(
pP¨£
, 
iDb
, "tbl", 
pTab
->
zName
);

86001 
	`sqlôe3FkDr›TabÀ
(
pP¨£
, 
pName
, 
pTab
);

86002 
	`sqlôe3CodeDr›TabÀ
(
pP¨£
, 
pTab
, 
iDb
, 
isVõw
);

86005 
exô_dr›_èbÀ
:

86006 
	`sqlôe3SrcLi°Dñëe
(
db
, 
pName
);

86025 
SQLITE_PRIVATE
 
	`sqlôe3Cª©eF‹eignKey
(

86026 
P¨£
 *
pP¨£
,

86027 
Ex¥Li°
 *
pFromCﬁ
,

86028 
Tokí
 *
pTo
,

86029 
Ex¥Li°
 *
pToCﬁ
,

86030 
Êags


86032 
sqlôe3
 *
db
 = 
pP¨£
->db;

86033 #i‚de‡
SQLITE_OMIT_FOREIGN_KEY


86034 
FKey
 *
pFKey
 = 0;

86035 
FKey
 *
pNextTo
;

86036 
TabÀ
 *
p
 = 
pP¨£
->
pNewTabÀ
;

86037 
nByã
;

86038 
i
;

86039 
nCﬁ
;

86040 *
z
;

86042 
	`as£π
–
pTo
!=0 );

86043 if–
p
==0 || 
IN_DECLARE_VTAB
 ) 
fk_íd
;

86044 if–
pFromCﬁ
==0 ){

86045 
iCﬁ
 = 
p
->
nCﬁ
-1;

86046 if–
	`NEVER
(
iCﬁ
<0ËË
fk_íd
;

86047 if–
pToCﬁ
 &&ÖToCﬁ->
nEx¥
!=1 ){

86048 
	`sqlôe3Eº‹Msg
(
pP¨£
, "foreign key on %s"

86050 
p
->
aCﬁ
[
iCﬁ
].
zName
, 
pTo
);

86051 
fk_íd
;

86053 
nCﬁ
 = 1;

86054 }if–
pToCﬁ
 &&ÖToCﬁ->
nEx¥
!=
pFromCﬁ
->nExpr ){

86055 
	`sqlôe3Eº‹Msg
(
pP¨£
,

86058 
fk_íd
;

86060 
nCﬁ
 = 
pFromCﬁ
->
nEx¥
;

86062 
nByã
 = (*
pFKey
Ë+ (
nCﬁ
-1)*’FKey->
aCﬁ
[0]Ë+ 
pTo
->
n
 + 1;

86063 if–
pToCﬁ
 ){

86064 
i
=0; i<
pToCﬁ
->
nEx¥
; i++){

86065 
nByã
 +
	`sqlôe3SåÀn30
(
pToCﬁ
->
a
[
i
].
zName
) + 1;

86068 
pFKey
 = 
	`sqlôe3DbMÆlocZîo
(
db
, 
nByã
 );

86069 if–
pFKey
==0 ){

86070 
fk_íd
;

86072 
pFKey
->
pFrom
 = 
p
;

86073 
pFKey
->
pNextFrom
 = 
p
->pFKey;

86074 
z
 = (*)&
pFKey
->
aCﬁ
[
nCﬁ
];

86075 
pFKey
->
zTo
 = 
z
;

86076 
	`mem˝y
(
z
, 
pTo
->z,ÖTo->
n
);

86077 
z
[
pTo
->
n
] = 0;

86078 
	`sqlôe3DequŸe
(
z
);

86079 
z
 +
pTo
->
n
+1;

86080 
pFKey
->
nCﬁ
 =ÇCol;

86081 if–
pFromCﬁ
==0 ){

86082 
pFKey
->
aCﬁ
[0].
iFrom
 = 
p
->
nCﬁ
-1;

86084 
i
=0; i<
nCﬁ
; i++){

86085 
j
;

86086 
j
=0; j<
p
->
nCﬁ
; j++){

86087 if–
	`sqlôe3SåICmp
(
p
->
aCﬁ
[
j
].
zName
, 
pFromCﬁ
->
a
[
i
].zName)==0 ){

86088 
pFKey
->
aCﬁ
[
i
].
iFrom
 = 
j
;

86092 if–
j
>=
p
->
nCﬁ
 ){

86093 
	`sqlôe3Eº‹Msg
(
pP¨£
,

86095 
pFromCﬁ
->
a
[
i
].
zName
);

86096 
fk_íd
;

86100 if–
pToCﬁ
 ){

86101 
i
=0; i<
nCﬁ
; i++){

86102 
n
 = 
	`sqlôe3SåÀn30
(
pToCﬁ
->
a
[
i
].
zName
);

86103 
pFKey
->
aCﬁ
[
i
].
zCﬁ
 = 
z
;

86104 
	`mem˝y
(
z
, 
pToCﬁ
->
a
[
i
].
zName
, 
n
);

86105 
z
[
n
] = 0;

86106 
z
 +
n
+1;

86109 
pFKey
->
isDe„ºed
 = 0;

86110 
pFKey
->
aA˘i⁄
[0] = (
u8
)(
Êags
 & 0xff);

86111 
pFKey
->
aA˘i⁄
[1] = (
u8
)((
Êags
 >> 8 ) & 0xff);

86113 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 0, 
p
->
pSchema
) );

86114 
pNextTo
 = (
FKey
 *)
	`sqlôe3HashIn£π
(&
p
->
pSchema
->
fkeyHash
,

86115 
pFKey
->
zTo
, 
	`sqlôe3SåÀn30
(pFKey->zTo), (*)pFKey

86117 if–
pNextTo
==
pFKey
 ){

86118 
db
->
mÆlocFaûed
 = 1;

86119 
fk_íd
;

86121 if–
pNextTo
 ){

86122 
	`as£π
–
pNextTo
->
pPªvTo
==0 );

86123 
pFKey
->
pNextTo
 =ÖNextTo;

86124 
pNextTo
->
pPªvTo
 = 
pFKey
;

86129 
p
->
pFKey
 =ÖFKey;

86130 
pFKey
 = 0;

86132 
fk_íd
:

86133 
	`sqlôe3DbFªe
(
db
, 
pFKey
);

86135 
	`sqlôe3Ex¥Li°Dñëe
(
db
, 
pFromCﬁ
);

86136 
	`sqlôe3Ex¥Li°Dñëe
(
db
, 
pToCﬁ
);

86146 
SQLITE_PRIVATE
 
	`sqlôe3De„rF‹eignKey
(
P¨£
 *
pP¨£
, 
isDe„ºed
){

86147 #i‚de‡
SQLITE_OMIT_FOREIGN_KEY


86148 
TabÀ
 *
pTab
;

86149 
FKey
 *
pFKey
;

86150 if–(
pTab
 = 
pP¨£
->
pNewTabÀ
)==0 || (
pFKey
 =ÖTab->pFKey)==0 ) ;

86151 
	`as£π
–
isDe„ºed
==0 || isDeferred==1 );

86152 
pFKey
->
isDe„ºed
 = (
u8
)isDeferred;

86167 
	`sqlôe3RefûlIndex
(
P¨£
 *
pP¨£
, 
Index
 *
pIndex
, 
memRoŸPage
){

86168 
TabÀ
 *
pTab
 = 
pIndex
->
pTabÀ
;

86169 
iTab
 = 
pP¨£
->
nTab
++;

86170 
iIdx
 = 
pP¨£
->
nTab
++;

86171 
iS‹ãr
;

86172 
addr1
;

86173 
addr2
;

86174 
äum
;

86175 
iP¨tIdxLabñ
;

86176 
Vdbe
 *
v
;

86177 
KeyInfo
 *
pKey
;

86178 
ªgRec‹d
;

86179 
sqlôe3
 *
db
 = 
pP¨£
->db;

86180 
iDb
 = 
	`sqlôe3SchemaToIndex
(
db
, 
pIndex
->
pSchema
);

86182 #i‚de‡
SQLITE_OMIT_AUTHORIZATION


86183 if–
	`sqlôe3AuthCheck
(
pP¨£
, 
SQLITE_REINDEX
, 
pIndex
->
zName
, 0,

86184 
db
->
aDb
[
iDb
].
zName
 ) ){

86190 
	`sqlôe3TabÀLock
(
pP¨£
, 
iDb
, 
pTab
->
äum
, 1,ÖTab->
zName
);

86192 
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

86193 if–
v
==0 ) ;

86194 if–
memRoŸPage
>=0 ){

86195 
äum
 = 
memRoŸPage
;

86197 
äum
 = 
pIndex
->tnum;

86198 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_CÀ¨
, 
äum
, 
iDb
);

86200 
pKey
 = 
	`sqlôe3IndexKeyöfo
(
pP¨£
, 
pIndex
);

86201 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_O≥nWrôe
, 
iIdx
, 
äum
, 
iDb
,

86202 (*)
pKey
, 
P4_KEYINFO_HANDOFF
);

86203 
	`sqlôe3VdbeCh™geP5
(
v
, 
OPFLAG_BULKCSR
|((
memRoŸPage
>=0)?
OPFLAG_P2ISREG
:0));

86206 
iS‹ãr
 = 
pP¨£
->
nTab
++;

86207 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_S‹ãrO≥n
, 
iS‹ãr
, 0, 0, (*)
pKey
, 
P4_KEYINFO
);

86211 
	`sqlôe3O≥nTabÀ
(
pP¨£
, 
iTab
, 
iDb
, 
pTab
, 
OP_O≥nRód
);

86212 
addr1
 = 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Rewöd
, 
iTab
, 0);

86213 
ªgRec‹d
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

86215 
	`sqlôe3Gíî©eIndexKey
(
pP¨£
, 
pIndex
, 
iTab
, 
ªgRec‹d
, 1, &
iP¨tIdxLabñ
);

86216 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_S‹ãrIn£π
, 
iS‹ãr
, 
ªgRec‹d
);

86217 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
iP¨tIdxLabñ
);

86218 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Next
, 
iTab
, 
addr1
+1);

86219 
	`sqlôe3VdbeJumpHîe
(
v
, 
addr1
);

86220 
addr1
 = 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_S‹ãrS‹t
, 
iS‹ãr
, 0);

86221 if–
pIndex
->
⁄Eº‹
!=
OE_N⁄e
 ){

86222 
j2
 = 
	`sqlôe3VdbeCuºítAddr
(
v
) + 3;

86223 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_GŸo
, 0, 
j2
);

86224 
addr2
 = 
	`sqlôe3VdbeCuºítAddr
(
v
);

86225 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_S‹ãrCom∑ª
, 
iS‹ãr
, 
j2
, 
ªgRec‹d
);

86226 
	`sqlôe3HÆtC⁄°øöt
(
pP¨£
, 
SQLITE_CONSTRAINT_UNIQUE
,

86227 
OE_Ab‹t
, "ödexed cﬁumn†¨ênŸ unique", 
P4_STATIC


86230 
addr2
 = 
	`sqlôe3VdbeCuºítAddr
(
v
);

86232 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_S‹ãrD©a
, 
iS‹ãr
, 
ªgRec‹d
);

86233 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_IdxIn£π
, 
iIdx
, 
ªgRec‹d
, 1);

86234 
	`sqlôe3VdbeCh™geP5
(
v
, 
OPFLAG_USESEEKRESULT
);

86235 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
ªgRec‹d
);

86236 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_S‹ãrNext
, 
iS‹ãr
, 
addr2
);

86237 
	`sqlôe3VdbeJumpHîe
(
v
, 
addr1
);

86239 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Clo£
, 
iTab
);

86240 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Clo£
, 
iIdx
);

86241 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Clo£
, 
iS‹ãr
);

86260 
SQLITE_PRIVATE
 
Index
 *
	`sqlôe3Cª©eIndex
(

86261 
P¨£
 *
pP¨£
,

86262 
Tokí
 *
pName1
,

86263 
Tokí
 *
pName2
,

86264 
SrcLi°
 *
pTblName
,

86265 
Ex¥Li°
 *
pLi°
,

86266 
⁄Eº‹
,

86267 
Tokí
 *
pSèπ
,

86268 
Ex¥
 *
pPIWhîe
,

86269 
s‹tOrdî
,

86270 
ifNŸExi°


86272 
Index
 *
pRë
 = 0;

86273 
TabÀ
 *
pTab
 = 0;

86274 
Index
 *
pIndex
 = 0;

86275 *
zName
 = 0;

86276 
nName
;

86277 
i
, 
j
;

86278 
Tokí
 
nuŒId
;

86279 
DbFixî
 
sFix
;

86280 
s‹tOrdîMask
;

86281 
sqlôe3
 *
db
 = 
pP¨£
->db;

86282 
Db
 *
pDb
;

86283 
iDb
;

86284 
Tokí
 *
pName
 = 0;

86285 
Ex¥Li°_ôem
 *
pLi°Iãm
;

86286 c⁄° 
Cﬁumn
 *
pTabCﬁ
;

86287 
nCﬁ
;

86288 
nExåa
 = 0;

86289 *
zExåa
;

86291 
	`as£π
–
pP¨£
->
nEº
==0 );

86292 if–
db
->
mÆlocFaûed
 || 
IN_DECLARE_VTAB
 ){

86293 
exô_¸óã_ödex
;

86295 if–
SQLITE_OK
!=
	`sqlôe3RódSchema
(
pP¨£
) ){

86296 
exô_¸óã_ödex
;

86302 if–
pTblName
!=0 ){

86308 
	`as£π
–
pName1
 && 
pName2
 );

86309 
iDb
 = 
	`sqlôe3TwoP¨tName
(
pP¨£
, 
pName1
, 
pName2
, &
pName
);

86310 if–
iDb
<0 ) 
exô_¸óã_ödex
;

86311 
	`as£π
–
pName
 &&ÖName->
z
 );

86313 #i‚de‡
SQLITE_OMIT_TEMPDB


86318 if–!
db
->
öô
.
busy
 ){

86319 
pTab
 = 
	`sqlôe3SrcLi°Lookup
(
pP¨£
, 
pTblName
);

86320 if–
pName2
->
n
==0 && 
pTab
 &&ÖTab->
pSchema
==
db
->
aDb
[1].pSchema ){

86321 
iDb
 = 1;

86326 
	`sqlôe3FixInô
(&
sFix
, 
pP¨£
, 
iDb
, "ödex", 
pName
);

86327 if–
	`sqlôe3FixSrcLi°
(&
sFix
, 
pTblName
) ){

86330 
	`as£π
(0);

86332 
pTab
 = 
	`sqlôe3LoˇãTabÀIãm
(
pP¨£
, 0, &
pTblName
->
a
[0]);

86333 
	`as£π
–
db
->
mÆlocFaûed
==0 || 
pTab
==0 );

86334 if–
pTab
==0 ) 
exô_¸óã_ödex
;

86335 if–
iDb
==1 && 
db
->
aDb
[iDb].
pSchema
!=
pTab
->pSchema ){

86336 
	`sqlôe3Eº‹Msg
(
pP¨£
,

86338 
pTab
->
zName
);

86339 
exô_¸óã_ödex
;

86342 
	`as£π
–
pName
==0 );

86343 
	`as£π
–
pSèπ
==0 );

86344 
pTab
 = 
pP¨£
->
pNewTabÀ
;

86345 if–!
pTab
 ) 
exô_¸óã_ödex
;

86346 
iDb
 = 
	`sqlôe3SchemaToIndex
(
db
, 
pTab
->
pSchema
);

86348 
pDb
 = &
db
->
aDb
[
iDb
];

86350 
	`as£π
–
pTab
!=0 );

86351 
	`as£π
–
pP¨£
->
nEº
==0 );

86352 if–
	`sqlôe3SåNICmp
(
pTab
->
zName
, "sqlite_", 7)==0

86353 && 
	`sqlôe3SåNICmp
(&
pTab
->
zName
[7],"altertab_",9)!=0 ){

86354 
	`sqlôe3Eº‹Msg
(
pP¨£
, "èbÀ %†mayÇŸ bêödexed", 
pTab
->
zName
);

86355 
exô_¸óã_ödex
;

86357 #i‚de‡
SQLITE_OMIT_VIEW


86358 if–
pTab
->
pSñe˘
 ){

86359 
	`sqlôe3Eº‹Msg
(
pP¨£
, "views mayÇot be indexed");

86360 
exô_¸óã_ödex
;

86363 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


86364 if–
	`IsVútuÆ
(
pTab
) ){

86365 
	`sqlôe3Eº‹Msg
(
pP¨£
, "virtualÅables mayÇot be indexed");

86366 
exô_¸óã_ödex
;

86383 if–
pName
 ){

86384 
zName
 = 
	`sqlôe3NameFromTokí
(
db
, 
pName
);

86385 if–
zName
==0 ) 
exô_¸óã_ödex
;

86386 
	`as£π
–
pName
->
z
!=0 );

86387 if–
SQLITE_OK
!=
	`sqlôe3CheckObje˘Name
(
pP¨£
, 
zName
) ){

86388 
exô_¸óã_ödex
;

86390 if–!
db
->
öô
.
busy
 ){

86391 if–
	`sqlôe3FödTabÀ
(
db
, 
zName
, 0)!=0 ){

86392 
	`sqlôe3Eº‹Msg
(
pP¨£
, "thîêi†ÆªadyáÅabÀÇamed %s", 
zName
);

86393 
exô_¸óã_ödex
;

86396 if–
	`sqlôe3FödIndex
(
db
, 
zName
, 
pDb
->zName)!=0 ){

86397 if–!
ifNŸExi°
 ){

86398 
	`sqlôe3Eº‹Msg
(
pP¨£
, "ödex %†ÆªadyÉxi°s", 
zName
);

86400 
	`as£π
–!
db
->
öô
.
busy
 );

86401 
	`sqlôe3CodeVîifySchema
(
pP¨£
, 
iDb
);

86403 
exô_¸óã_ödex
;

86406 
n
;

86407 
Index
 *
pLo›
;

86408 
pLo›
=
pTab
->
pIndex
, 
n
=1;ÖLo›;ÖLo›ıLo›->
pNext
,Ç++){}

86409 
zName
 = 
	`sqlôe3MPrötf
(
db
, "sqlôe_autoödex_%s_%d", 
pTab
->zName, 
n
);

86410 if–
zName
==0 ){

86411 
exô_¸óã_ödex
;

86417 #i‚de‡
SQLITE_OMIT_AUTHORIZATION


86419 c⁄° *
zDb
 = 
pDb
->
zName
;

86420 if–
	`sqlôe3AuthCheck
(
pP¨£
, 
SQLITE_INSERT
, 
	`SCHEMA_TABLE
(
iDb
), 0, 
zDb
) ){

86421 
exô_¸óã_ödex
;

86423 
i
 = 
SQLITE_CREATE_INDEX
;

86424 if–!
OMIT_TEMPDB
 && 
iDb
==1 ) 
i
 = 
SQLITE_CREATE_TEMP_INDEX
;

86425 if–
	`sqlôe3AuthCheck
(
pP¨£
, 
i
, 
zName
, 
pTab
->zName, 
zDb
) ){

86426 
exô_¸óã_ödex
;

86435 if–
pLi°
==0 ){

86436 
nuŒId
.
z
 = 
pTab
->
aCﬁ
[pTab->
nCﬁ
-1].
zName
;

86437 
nuŒId
.
n
 = 
	`sqlôe3SåÀn30
((*ÍuŒId.
z
);

86438 
pLi°
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
, 0, 0);

86439 if–
pLi°
==0 ) 
exô_¸óã_ödex
;

86440 
	`sqlôe3Ex¥Li°SëName
(
pP¨£
, 
pLi°
, &
nuŒId
, 0);

86441 
pLi°
->
a
[0].
s‹tOrdî
 = (
u8
)sortOrder;

86447 
i
=0; i<
pLi°
->
nEx¥
; i++){

86448 
Ex¥
 *
pEx¥
 = 
pLi°
->
a
[
i
].pExpr;

86449 if–
pEx¥
 ){

86450 
	`as£π
–
pEx¥
->
›
==
TK_COLLATE
 );

86451 
nExåa
 +(1 + 
	`sqlôe3SåÀn30
(
pEx¥
->
u
.
zTokí
));

86458 
nName
 = 
	`sqlôe3SåÀn30
(
zName
);

86459 
nCﬁ
 = 
pLi°
->
nEx¥
;

86460 
pIndex
 = 
	`sqlôe3DbMÆlocZîo
(
db
,

86461 
	`ROUND8
((
Index
)) +

86462 
	`ROUND8
((
tRow˙t
)*(
nCﬁ
+1)) +

86463 (*)*
nCﬁ
 +

86464 ()*
nCﬁ
 +

86465 (
u8
)*
nCﬁ
 +

86466 
nName
 + 1 +

86467 
nExåa


86469 if–
db
->
mÆlocFaûed
 ){

86470 
exô_¸óã_ödex
;

86472 
zExåa
 = (*)
pIndex
;

86473 
pIndex
->
aiRowE°
 = (
tRow˙t
*)&
zExåa
[
	`ROUND8
((
Index
))];

86474 
pIndex
->
azCﬁl
 = (**)

86475 ((*)
pIndex
->
aiRowE°
 + 
	`ROUND8
((
tRow˙t
)*
nCﬁ
+1));

86476 
	`as£π
–
	`EIGHT_BYTE_ALIGNMENT
(
pIndex
->
aiRowE°
) );

86477 
	`as£π
–
	`EIGHT_BYTE_ALIGNMENT
(
pIndex
->
azCﬁl
) );

86478 
pIndex
->
aiCﬁumn
 = (*)(&pIndex->
azCﬁl
[
nCﬁ
]);

86479 
pIndex
->
aS‹tOrdî
 = (
u8
 *)(&pIndex->
aiCﬁumn
[
nCﬁ
]);

86480 
pIndex
->
zName
 = (*)(&pIndex->
aS‹tOrdî
[
nCﬁ
]);

86481 
zExåa
 = (*)(&
pIndex
->
zName
[
nName
+1]);

86482 
	`mem˝y
(
pIndex
->
zName
, zName, 
nName
+1);

86483 
pIndex
->
pTabÀ
 = 
pTab
;

86484 
pIndex
->
nCﬁumn
 = 
pLi°
->
nEx¥
;

86485 
pIndex
->
⁄Eº‹
 = (
u8
)onError;

86486 
pIndex
->
uniqNŸNuŒ
 = 
⁄Eº‹
==
OE_Ab‹t
;

86487 
pIndex
->
autoIndex
 = (
u8
)(
pName
==0);

86488 
pIndex
->
pSchema
 = 
db
->
aDb
[
iDb
].pSchema;

86489 if–
pPIWhîe
 ){

86490 
	`sqlôe3ResﬁveSñfRe„ªn˚
(
pP¨£
, 
pTab
, 
NC_P¨tIdx
, 
pPIWhîe
, 0);

86491 
pIndex
->
pP¨tIdxWhîe
 = 
pPIWhîe
;

86492 
pPIWhîe
 = 0;

86494 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 
iDb
, 0) );

86498 if–
pDb
->
pSchema
->
fûe_f‹m©
>=4 ){

86499 
s‹tOrdîMask
 = -1;

86501 
s‹tOrdîMask
 = 0;

86514 
i
=0, 
pLi°Iãm
=
pLi°
->
a
; i<pLi°->
nEx¥
; i++,ÖListItem++){

86515 c⁄° *
zCﬁName
 = 
pLi°Iãm
->
zName
;

86516 
ªque°edS‹tOrdî
;

86517 *
zCﬁl
;

86519 
j
=0, 
pTabCﬁ
=
pTab
->
aCﬁ
; j<pTab->
nCﬁ
; j++,ÖTabCol++){

86520 if–
	`sqlôe3SåICmp
(
zCﬁName
, 
pTabCﬁ
->
zName
)==0 ) ;

86522 if–
j
>=
pTab
->
nCﬁ
 ){

86523 
	`sqlôe3Eº‹Msg
(
pP¨£
, "table %s hasÇo columnÇamed %s",

86524 
pTab
->
zName
, 
zCﬁName
);

86525 
pP¨£
->
checkSchema
 = 1;

86526 
exô_¸óã_ödex
;

86528 
pIndex
->
aiCﬁumn
[
i
] = 
j
;

86529 if–
pLi°Iãm
->
pEx¥
 ){

86530 
nCﬁl
;

86531 
	`as£π
–
pLi°Iãm
->
pEx¥
->
›
==
TK_COLLATE
 );

86532 
zCﬁl
 = 
pLi°Iãm
->
pEx¥
->
u
.
zTokí
;

86533 
nCﬁl
 = 
	`sqlôe3SåÀn30
(
zCﬁl
) + 1;

86534 
	`as£π
–
nExåa
>=
nCﬁl
 );

86535 
	`mem˝y
(
zExåa
, 
zCﬁl
, 
nCﬁl
);

86536 
zCﬁl
 = 
zExåa
;

86537 
zExåa
 +
nCﬁl
;

86538 
nExåa
 -
nCﬁl
;

86540 
zCﬁl
 = 
pTab
->
aCﬁ
[
j
].zColl;

86541 if–!
zCﬁl
 ) zColl = "BINARY";

86543 if–!
db
->
öô
.
busy
 && !
	`sqlôe3LoˇãCﬁlSeq
(
pP¨£
, 
zCﬁl
) ){

86544 
exô_¸óã_ödex
;

86546 
pIndex
->
azCﬁl
[
i
] = 
zCﬁl
;

86547 
ªque°edS‹tOrdî
 = 
pLi°Iãm
->
s‹tOrdî
 & 
s‹tOrdîMask
;

86548 
pIndex
->
aS‹tOrdî
[
i
] = (
u8
)
ªque°edS‹tOrdî
;

86549 if–
pTab
->
aCﬁ
[
j
].
nŸNuŒ
==0 ) 
pIndex
->
uniqNŸNuŒ
 = 0;

86551 
	`sqlôe3DeÁu…RowE°
(
pIndex
);

86552 if–
pP¨£
->
pNewTabÀ
==0 ) 
	`e°im©eIndexWidth
(
pIndex
);

86554 if–
pTab
==
pP¨£
->
pNewTabÀ
 ){

86576 
Index
 *
pIdx
;

86577 
pIdx
=
pTab
->
pIndex
;ÖIdx;ÖIdxıIdx->
pNext
){

86578 
k
;

86579 
	`as£π
–
pIdx
->
⁄Eº‹
!=
OE_N⁄e
 );

86580 
	`as£π
–
pIdx
->
autoIndex
 );

86581 
	`as£π
–
pIndex
->
⁄Eº‹
!=
OE_N⁄e
 );

86583 if–
pIdx
->
nCﬁumn
!=
pIndex
->nColumn ) ;

86584 
k
=0; k<
pIdx
->
nCﬁumn
; k++){

86585 c⁄° *
z1
;

86586 c⁄° *
z2
;

86587 if–
pIdx
->
aiCﬁumn
[
k
]!=
pIndex
->aiColumn[k] ) ;

86588 
z1
 = 
pIdx
->
azCﬁl
[
k
];

86589 
z2
 = 
pIndex
->
azCﬁl
[
k
];

86590 if–
z1
!=
z2
 && 
	`sqlôe3SåICmp
(z1, z2) ) ;

86592 if–
k
==
pIdx
->
nCﬁumn
 ){

86593 if–
pIdx
->
⁄Eº‹
!=
pIndex
->onError ){

86601 if–!(
pIdx
->
⁄Eº‹
==
OE_DeÁu…
 || 
pIndex
->onError==OE_Default) ){

86602 
	`sqlôe3Eº‹Msg
(
pP¨£
,

86605 if–
pIdx
->
⁄Eº‹
==
OE_DeÁu…
 ){

86606 
pIdx
->
⁄Eº‹
 = 
pIndex
->onError;

86609 
exô_¸óã_ödex
;

86617 if–
db
->
öô
.
busy
 ){

86618 
Index
 *
p
;

86619 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 0, 
pIndex
->
pSchema
) );

86620 
p
 = 
	`sqlôe3HashIn£π
(&
pIndex
->
pSchema
->
idxHash
,

86621 
pIndex
->
zName
, 
	`sqlôe3SåÀn30
(pIndex->zName),

86622 
pIndex
);

86623 if–
p
 ){

86624 
	`as£π
–
p
==
pIndex
 );

86625 
db
->
mÆlocFaûed
 = 1;

86626 
exô_¸óã_ödex
;

86628 
db
->
Êags
 |
SQLITE_I¡înCh™ges
;

86629 if–
pTblName
!=0 ){

86630 
pIndex
->
äum
 = 
db
->
öô
.
√wTnum
;

86649 if–
pP¨£
->
nEº
==0 ){

86650 
Vdbe
 *
v
;

86651 *
zStmt
;

86652 
iMem
 = ++
pP¨£
->
nMem
;

86654 
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

86655 if–
v
==0 ) 
exô_¸óã_ödex
;

86660 
	`sqlôe3BegöWrôeO≥øti⁄
(
pP¨£
, 1, 
iDb
);

86661 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Cª©eIndex
, 
iDb
, 
iMem
);

86666 if–
pSèπ
 ){

86667 
n
 = ()(
pP¨£
->
sLa°Tokí
.
z
 - 
pName
->z) +ÖParse->sLastToken.n;

86668 if–
pName
->
z
[
n
-1]==';' )Ç--;

86670 
zStmt
 = 
	`sqlôe3MPrötf
(
db
, "CREATE%s INDEX %.*s",

86671 
⁄Eº‹
==
OE_N⁄e
 ? "" : " UNIQUE", 
n
, 
pName
->
z
);

86675 
zStmt
 = 0;

86680 
	`sqlôe3Ne°edP¨£
(
pP¨£
,

86682 
db
->
aDb
[
iDb
].
zName
, 
	`SCHEMA_TABLE
(iDb),

86683 
pIndex
->
zName
,

86684 
pTab
->
zName
,

86685 
iMem
,

86686 
zStmt


86688 
	`sqlôe3DbFªe
(
db
, 
zStmt
);

86693 if–
pTblName
 ){

86694 
	`sqlôe3RefûlIndex
(
pP¨£
, 
pIndex
, 
iMem
);

86695 
	`sqlôe3Ch™geCookõ
(
pP¨£
, 
iDb
);

86696 
	`sqlôe3VdbeAddP¨£SchemaOp
(
v
, 
iDb
,

86697 
	`sqlôe3MPrötf
(
db
, "«me='%q' ANDÅy≥='ödex'", 
pIndex
->
zName
));

86698 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Expúe
, 0);

86708 if–
db
->
öô
.
busy
 || 
pTblName
==0 ){

86709 if–
⁄Eº‹
!=
OE_Rïœ˚
 || 
pTab
->
pIndex
==0

86710 || 
pTab
->
pIndex
->
⁄Eº‹
==
OE_Rïœ˚
){

86711 
pIndex
->
pNext
 = 
pTab
->pIndex;

86712 
pTab
->
pIndex
 =ÖIndex;

86714 
Index
 *
pOthî
 = 
pTab
->
pIndex
;

86715  
pOthî
->
pNext
 &&ÖOthî->pNext->
⁄Eº‹
!=
OE_Rïœ˚
 ){

86716 
pOthî
 =ÖOthî->
pNext
;

86718 
pIndex
->
pNext
 = 
pOthî
->pNext;

86719 
pOthî
->
pNext
 = 
pIndex
;

86721 
pRë
 = 
pIndex
;

86722 
pIndex
 = 0;

86726 
exô_¸óã_ödex
:

86727 if–
pIndex
 ) 
	`‰ìIndex
(
db
,ÖIndex);

86728 
	`sqlôe3Ex¥Dñëe
(
db
, 
pPIWhîe
);

86729 
	`sqlôe3Ex¥Li°Dñëe
(
db
, 
pLi°
);

86730 
	`sqlôe3SrcLi°Dñëe
(
db
, 
pTblName
);

86731 
	`sqlôe3DbFªe
(
db
, 
zName
);

86732  
pRë
;

86753 
SQLITE_PRIVATE
 
	`sqlôe3DeÁu…RowE°
(
Index
 *
pIdx
){

86754 
tRow˙t
 *
a
 = 
pIdx
->
aiRowE°
;

86755 
i
;

86756 
tRow˙t
 
n
;

86757 
	`as£π
–
a
!=0 );

86758 
a
[0] = 
pIdx
->
pTabÀ
->
nRowE°
;

86759 if–
a
[0]<10 )á[0] = 10;

86760 
n
 = 10;

86761 
i
=1; i<=
pIdx
->
nCﬁumn
; i++){

86762 
a
[
i
] = 
n
;

86763 if–
n
>5 )Ç--;

86765 if–
pIdx
->
⁄Eº‹
!=
OE_N⁄e
 ){

86766 
a
[
pIdx
->
nCﬁumn
] = 1;

86774 
SQLITE_PRIVATE
 
	`sqlôe3Dr›Index
(
P¨£
 *
pP¨£
, 
SrcLi°
 *
pName
, 
ifExi°s
){

86775 
Index
 *
pIndex
;

86776 
Vdbe
 *
v
;

86777 
sqlôe3
 *
db
 = 
pP¨£
->db;

86778 
iDb
;

86780 
	`as£π
–
pP¨£
->
nEº
==0 );

86781 if–
db
->
mÆlocFaûed
 ){

86782 
exô_dr›_ödex
;

86784 
	`as£π
–
pName
->
nSrc
==1 );

86785 if–
SQLITE_OK
!=
	`sqlôe3RódSchema
(
pP¨£
) ){

86786 
exô_dr›_ödex
;

86788 
pIndex
 = 
	`sqlôe3FödIndex
(
db
, 
pName
->
a
[0].
zName
,ÖName->a[0].
zD©aba£
);

86789 if–
pIndex
==0 ){

86790 if–!
ifExi°s
 ){

86791 
	`sqlôe3Eº‹Msg
(
pP¨£
, "nÿsuch index: %S", 
pName
, 0);

86793 
	`sqlôe3CodeVîifyNamedSchema
(
pP¨£
, 
pName
->
a
[0].
zD©aba£
);

86795 
pP¨£
->
checkSchema
 = 1;

86796 
exô_dr›_ödex
;

86798 if–
pIndex
->
autoIndex
 ){

86799 
	`sqlôe3Eº‹Msg
(
pP¨£
, "indexássociated with UNIQUE "

86801 
exô_dr›_ödex
;

86803 
iDb
 = 
	`sqlôe3SchemaToIndex
(
db
, 
pIndex
->
pSchema
);

86804 #i‚de‡
SQLITE_OMIT_AUTHORIZATION


86806 
code
 = 
SQLITE_DROP_INDEX
;

86807 
TabÀ
 *
pTab
 = 
pIndex
->
pTabÀ
;

86808 c⁄° *
zDb
 = 
db
->
aDb
[
iDb
].
zName
;

86809 c⁄° *
zTab
 = 
	`SCHEMA_TABLE
(
iDb
);

86810 if–
	`sqlôe3AuthCheck
(
pP¨£
, 
SQLITE_DELETE
, 
zTab
, 0, 
zDb
) ){

86811 
exô_dr›_ödex
;

86813 if–!
OMIT_TEMPDB
 && 
iDb
 ) 
code
 = 
SQLITE_DROP_TEMP_INDEX
;

86814 if–
	`sqlôe3AuthCheck
(
pP¨£
, 
code
, 
pIndex
->
zName
, 
pTab
->zName, 
zDb
) ){

86815 
exô_dr›_ödex
;

86821 
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

86822 if–
v
 ){

86823 
	`sqlôe3BegöWrôeO≥øti⁄
(
pP¨£
, 1, 
iDb
);

86824 
	`sqlôe3Ne°edP¨£
(
pP¨£
,

86826 
db
->
aDb
[
iDb
].
zName
, 
	`SCHEMA_TABLE
(iDb), 
pIndex
->zName

86828 
	`sqlôe3CÀ¨SètTabÀs
(
pP¨£
, 
iDb
, "idx", 
pIndex
->
zName
);

86829 
	`sqlôe3Ch™geCookõ
(
pP¨£
, 
iDb
);

86830 
	`de°royRoŸPage
(
pP¨£
, 
pIndex
->
äum
, 
iDb
);

86831 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Dr›Index
, 
iDb
, 0, 0, 
pIndex
->
zName
, 0);

86834 
exô_dr›_ödex
:

86835 
	`sqlôe3SrcLi°Dñëe
(
db
, 
pName
);

86855 
SQLITE_PRIVATE
 *
	`sqlôe3AºayAŒoˇã
(

86856 
sqlôe3
 *
db
,

86857 *
pAºay
,

86858 
szE¡ry
,

86859 *
≤E¡ry
,

86860 *
pIdx


86862 *
z
;

86863 
n
 = *
≤E¡ry
;

86864 if–(
n
 & (n-1))==0 ){

86865 
sz
 = (
n
==0) ? 1 : 2*n;

86866 *
pNew
 = 
	`sqlôe3DbRóŒoc
(
db
, 
pAºay
, 
sz
*
szE¡ry
);

86867 if–
pNew
==0 ){

86868 *
pIdx
 = -1;

86869  
pAºay
;

86871 
pAºay
 = 
pNew
;

86873 
z
 = (*)
pAºay
;

86874 
	`mem£t
(&
z
[
n
 * 
szE¡ry
], 0, szEntry);

86875 *
pIdx
 = 
n
;

86876 ++*
≤E¡ry
;

86877  
pAºay
;

86886 
SQLITE_PRIVATE
 
IdLi°
 *
	`sqlôe3IdLi°Aµíd
(
sqlôe3
 *
db
, IdLi° *
pLi°
, 
Tokí
 *
pTokí
){

86887 
i
;

86888 if–
pLi°
==0 ){

86889 
pLi°
 = 
	`sqlôe3DbMÆlocZîo
(
db
, (
IdLi°
) );

86890 if–
pLi°
==0 )  0;

86892 
pLi°
->
a
 = 
	`sqlôe3AºayAŒoˇã
(

86893 
db
,

86894 
pLi°
->
a
,

86895 (
pLi°
->
a
[0]),

86896 &
pLi°
->
nId
,

86897 &
i


86899 if–
i
<0 ){

86900 
	`sqlôe3IdLi°Dñëe
(
db
, 
pLi°
);

86903 
pLi°
->
a
[
i
].
zName
 = 
	`sqlôe3NameFromTokí
(
db
, 
pTokí
);

86904  
pLi°
;

86910 
SQLITE_PRIVATE
 
	`sqlôe3IdLi°Dñëe
(
sqlôe3
 *
db
, 
IdLi°
 *
pLi°
){

86911 
i
;

86912 if–
pLi°
==0 ) ;

86913 
i
=0; i<
pLi°
->
nId
; i++){

86914 
	`sqlôe3DbFªe
(
db
, 
pLi°
->
a
[
i
].
zName
);

86916 
	`sqlôe3DbFªe
(
db
, 
pLi°
->
a
);

86917 
	`sqlôe3DbFªe
(
db
, 
pLi°
);

86924 
SQLITE_PRIVATE
 
	`sqlôe3IdLi°Index
(
IdLi°
 *
pLi°
, c⁄° *
zName
){

86925 
i
;

86926 if–
pLi°
==0 )  -1;

86927 
i
=0; i<
pLi°
->
nId
; i++){

86928 if–
	`sqlôe3SåICmp
(
pLi°
->
a
[
i
].
zName
, zName)==0 )  i;

86952 
SQLITE_PRIVATE
 
SrcLi°
 *
	`sqlôe3SrcLi°E∆¨ge
(

86953 
sqlôe3
 *
db
,

86954 
SrcLi°
 *
pSrc
,

86955 
nExåa
,

86956 
iSèπ


86958 
i
;

86961 
	`as£π
–
iSèπ
>=0 );

86962 
	`as£π
–
nExåa
>=1 );

86963 
	`as£π
–
pSrc
!=0 );

86964 
	`as£π
–
iSèπ
<=
pSrc
->
nSrc
 );

86967 if–
pSrc
->
nSrc
+
nExåa
>pSrc->
nAŒoc
 ){

86968 
SrcLi°
 *
pNew
;

86969 
nAŒoc
 = 
pSrc
->
nSrc
+
nExåa
;

86970 
nGŸ
;

86971 
pNew
 = 
	`sqlôe3DbRóŒoc
(
db
, 
pSrc
,

86972 (*
pSrc
Ë+ (
nAŒoc
-1)*’Src->
a
[0]) );

86973 if–
pNew
==0 ){

86974 
	`as£π
–
db
->
mÆlocFaûed
 );

86975  
pSrc
;

86977 
pSrc
 = 
pNew
;

86978 
nGŸ
 = (
	`sqlôe3DbMÆlocSize
(
db
, 
pNew
Ë- (*
pSrc
))/’Src->
a
[0])+1;

86979 
pSrc
->
nAŒoc
 = (
u8
)
nGŸ
;

86984 
i
=
pSrc
->
nSrc
-1; i>=
iSèπ
; i--){

86985 
pSrc
->
a
[
i
+
nExåa
] =ÖSrc->a[i];

86987 
pSrc
->
nSrc
 +(
i8
)
nExåa
;

86990 
	`mem£t
(&
pSrc
->
a
[
iSèπ
], 0, ’Src->a[0])*
nExåa
);

86991 
i
=
iSèπ
; i<iSèπ+
nExåa
; i++){

86992 
pSrc
->
a
[
i
].
iCurs‹
 = -1;

86996  
pSrc
;

87034 
SQLITE_PRIVATE
 
SrcLi°
 *
	`sqlôe3SrcLi°Aµíd
(

87035 
sqlôe3
 *
db
,

87036 
SrcLi°
 *
pLi°
,

87037 
Tokí
 *
pTabÀ
,

87038 
Tokí
 *
pD©aba£


87040 
SrcLi°_ôem
 *
pIãm
;

87041 
	`as£π
–
pD©aba£
==0 || 
pTabÀ
!=0 );

87042 if–
pLi°
==0 ){

87043 
pLi°
 = 
	`sqlôe3DbMÆlocZîo
(
db
, (
SrcLi°
) );

87044 if–
pLi°
==0 )  0;

87045 
pLi°
->
nAŒoc
 = 1;

87047 
pLi°
 = 
	`sqlôe3SrcLi°E∆¨ge
(
db
,ÖLi°, 1,ÖLi°->
nSrc
);

87048 if–
db
->
mÆlocFaûed
 ){

87049 
	`sqlôe3SrcLi°Dñëe
(
db
, 
pLi°
);

87052 
pIãm
 = &
pLi°
->
a
[pLi°->
nSrc
-1];

87053 if–
pD©aba£
 &&ÖD©aba£->
z
==0 ){

87054 
pD©aba£
 = 0;

87056 if–
pD©aba£
 ){

87057 
Tokí
 *
pTemp
 = 
pD©aba£
;

87058 
pD©aba£
 = 
pTabÀ
;

87059 
pTabÀ
 = 
pTemp
;

87061 
pIãm
->
zName
 = 
	`sqlôe3NameFromTokí
(
db
, 
pTabÀ
);

87062 
pIãm
->
zD©aba£
 = 
	`sqlôe3NameFromTokí
(
db
, 
pD©aba£
);

87063  
pLi°
;

87069 
SQLITE_PRIVATE
 
	`sqlôe3SrcLi°AssignCurs‹s
(
P¨£
 *
pP¨£
, 
SrcLi°
 *
pLi°
){

87070 
i
;

87071 
SrcLi°_ôem
 *
pIãm
;

87072 
	`as£π
(
pLi°
 || 
pP¨£
->
db
->
mÆlocFaûed
 );

87073 if–
pLi°
 ){

87074 
i
=0, 
pIãm
=
pLi°
->
a
; i<pLi°->
nSrc
; i++,ÖItem++){

87075 if–
pIãm
->
iCurs‹
>=0 ) ;

87076 
pIãm
->
iCurs‹
 = 
pP¨£
->
nTab
++;

87077 if–
pIãm
->
pSñe˘
 ){

87078 
	`sqlôe3SrcLi°AssignCurs‹s
(
pP¨£
, 
pIãm
->
pSñe˘
->
pSrc
);

87087 
SQLITE_PRIVATE
 
	`sqlôe3SrcLi°Dñëe
(
sqlôe3
 *
db
, 
SrcLi°
 *
pLi°
){

87088 
i
;

87089 
SrcLi°_ôem
 *
pIãm
;

87090 if–
pLi°
==0 ) ;

87091 
pIãm
=
pLi°
->
a
, 
i
=0; i<pLi°->
nSrc
; i++,ÖItem++){

87092 
	`sqlôe3DbFªe
(
db
, 
pIãm
->
zD©aba£
);

87093 
	`sqlôe3DbFªe
(
db
, 
pIãm
->
zName
);

87094 
	`sqlôe3DbFªe
(
db
, 
pIãm
->
zAlüs
);

87095 
	`sqlôe3DbFªe
(
db
, 
pIãm
->
zIndex
);

87096 
	`sqlôe3DñëeTabÀ
(
db
, 
pIãm
->
pTab
);

87097 
	`sqlôe3Sñe˘Dñëe
(
db
, 
pIãm
->
pSñe˘
);

87098 
	`sqlôe3Ex¥Dñëe
(
db
, 
pIãm
->
pOn
);

87099 
	`sqlôe3IdLi°Dñëe
(
db
, 
pIãm
->
pUsög
);

87101 
	`sqlôe3DbFªe
(
db
, 
pLi°
);

87120 
SQLITE_PRIVATE
 
SrcLi°
 *
	`sqlôe3SrcLi°AµídFromTîm
(

87121 
P¨£
 *
pP¨£
,

87122 
SrcLi°
 *
p
,

87123 
Tokí
 *
pTabÀ
,

87124 
Tokí
 *
pD©aba£
,

87125 
Tokí
 *
pAlüs
,

87126 
Sñe˘
 *
pSubquîy
,

87127 
Ex¥
 *
pOn
,

87128 
IdLi°
 *
pUsög


87130 
SrcLi°_ôem
 *
pIãm
;

87131 
sqlôe3
 *
db
 = 
pP¨£
->db;

87132 if–!
p
 && (
pOn
 || 
pUsög
) ){

87133 
	`sqlôe3Eº‹Msg
(
pP¨£
, "a JOIN clause isÑequired before %s",

87134 (
pOn
 ? "ON" : "USING")

87136 
≠≥nd_‰om_îr‹
;

87138 
p
 = 
	`sqlôe3SrcLi°Aµíd
(
db
,Ö, 
pTabÀ
, 
pD©aba£
);

87139 if–
p
==0 || 
	`NEVER
’->
nSrc
==0) ){

87140 
≠≥nd_‰om_îr‹
;

87142 
pIãm
 = &
p
->
a
[p->
nSrc
-1];

87143 
	`as£π
–
pAlüs
!=0 );

87144 if–
pAlüs
->
n
 ){

87145 
pIãm
->
zAlüs
 = 
	`sqlôe3NameFromTokí
(
db
, 
pAlüs
);

87147 
pIãm
->
pSñe˘
 = 
pSubquîy
;

87148 
pIãm
->
pOn
 =ÖOn;

87149 
pIãm
->
pUsög
 =ÖUsing;

87150  
p
;

87152 
≠≥nd_‰om_îr‹
:

87153 
	`as£π
–
p
==0 );

87154 
	`sqlôe3Ex¥Dñëe
(
db
, 
pOn
);

87155 
	`sqlôe3IdLi°Dñëe
(
db
, 
pUsög
);

87156 
	`sqlôe3Sñe˘Dñëe
(
db
, 
pSubquîy
);

87164 
SQLITE_PRIVATE
 
	`sqlôe3SrcLi°IndexedBy
(
P¨£
 *
pP¨£
, 
SrcLi°
 *
p
, 
Tokí
 *
pIndexedBy
){

87165 
	`as£π
–
pIndexedBy
!=0 );

87166 if–
p
 && 
	`ALWAYS
’->
nSrc
>0) ){

87167 
SrcLi°_ôem
 *
pIãm
 = &
p
->
a
[p->
nSrc
-1];

87168 
	`as£π
–
pIãm
->
nŸIndexed
==0 &&ÖIãm->
zIndex
==0 );

87169 if–
pIndexedBy
->
n
==1 && !pIndexedBy->
z
 ){

87172 
pIãm
->
nŸIndexed
 = 1;

87174 
pIãm
->
zIndex
 = 
	`sqlôe3NameFromTokí
(
pP¨£
->
db
, 
pIndexedBy
);

87194 
SQLITE_PRIVATE
 
	`sqlôe3SrcLi°Shi·JoöTy≥
(
SrcLi°
 *
p
){

87195 if–
p
 ){

87196 
i
;

87197 
	`as£π
–
p
->
a
 ||Ö->
nSrc
==0 );

87198 
i
=
p
->
nSrc
-1; i>0; i--){

87199 
p
->
a
[
i
].
joöty≥
 =Ö->a[i-1].jointype;

87201 
p
->
a
[0].
joöty≥
 = 0;

87208 
SQLITE_PRIVATE
 
	`sqlôe3BegöTønß˘i⁄
(
P¨£
 *
pP¨£
, 
ty≥
){

87209 
sqlôe3
 *
db
;

87210 
Vdbe
 *
v
;

87211 
i
;

87213 
	`as£π
–
pP¨£
!=0 );

87214 
db
 = 
pP¨£
->db;

87215 
	`as£π
–
db
!=0 );

87217 if–
	`sqlôe3AuthCheck
(
pP¨£
, 
SQLITE_TRANSACTION
, "BEGIN", 0, 0) ){

87220 
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

87221 if–!
v
 ) ;

87222 if–
ty≥
!=
TK_DEFERRED
 ){

87223 
i
=0; i<
db
->
nDb
; i++){

87224 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Tønß˘i⁄
, 
i
, (
ty≥
==
TK_EXCLUSIVE
)+1);

87225 
	`sqlôe3VdbeU£sBåì
(
v
, 
i
);

87228 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_AutoCommô
, 0, 0);

87234 
SQLITE_PRIVATE
 
	`sqlôe3CommôTønß˘i⁄
(
P¨£
 *
pP¨£
){

87235 
Vdbe
 *
v
;

87237 
	`as£π
–
pP¨£
!=0 );

87238 
	`as£π
–
pP¨£
->
db
!=0 );

87239 if–
	`sqlôe3AuthCheck
(
pP¨£
, 
SQLITE_TRANSACTION
, "COMMIT", 0, 0) ){

87242 
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

87243 if–
v
 ){

87244 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_AutoCommô
, 1, 0);

87251 
SQLITE_PRIVATE
 
	`sqlôe3RﬁlbackTønß˘i⁄
(
P¨£
 *
pP¨£
){

87252 
Vdbe
 *
v
;

87254 
	`as£π
–
pP¨£
!=0 );

87255 
	`as£π
–
pP¨£
->
db
!=0 );

87256 if–
	`sqlôe3AuthCheck
(
pP¨£
, 
SQLITE_TRANSACTION
, "ROLLBACK", 0, 0) ){

87259 
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

87260 if–
v
 ){

87261 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_AutoCommô
, 1, 1);

87269 
SQLITE_PRIVATE
 
	`sqlôe3Savïoöt
(
P¨£
 *
pP¨£
, 
›
, 
Tokí
 *
pName
){

87270 *
zName
 = 
	`sqlôe3NameFromTokí
(
pP¨£
->
db
, 
pName
);

87271 if–
zName
 ){

87272 
Vdbe
 *
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

87273 #i‚de‡
SQLITE_OMIT_AUTHORIZATION


87274 c⁄° * c⁄° 
az
[] = { "BEGIN", "RELEASE", "ROLLBACK" };

87275 
	`as£π
–!
SAVEPOINT_BEGIN
 && 
SAVEPOINT_RELEASE
==1 && 
SAVEPOINT_ROLLBACK
==2 );

87277 if–!
v
 || 
	`sqlôe3AuthCheck
(
pP¨£
, 
SQLITE_SAVEPOINT
, 
az
[
›
], 
zName
, 0) ){

87278 
	`sqlôe3DbFªe
(
pP¨£
->
db
, 
zName
);

87281 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Savïoöt
, 
›
, 0, 0, 
zName
, 
P4_DYNAMIC
);

87289 
SQLITE_PRIVATE
 
	`sqlôe3O≥nTempD©aba£
(
P¨£
 *
pP¨£
){

87290 
sqlôe3
 *
db
 = 
pP¨£
->db;

87291 if–
db
->
aDb
[1].
pBt
==0 && !
pP¨£
->
ex∂aö
 ){

87292 
rc
;

87293 
Båì
 *
pBt
;

87294 c⁄° 
Êags
 =

87295 
SQLITE_OPEN_READWRITE
 |

87296 
SQLITE_OPEN_CREATE
 |

87297 
SQLITE_OPEN_EXCLUSIVE
 |

87298 
SQLITE_OPEN_DELETEONCLOSE
 |

87299 
SQLITE_OPEN_TEMP_DB
;

87301 
rc
 = 
	`sqlôe3BåìO≥n
(
db
->
pVfs
, 0, db, &
pBt
, 0, 
Êags
);

87302 if–
rc
!=
SQLITE_OK
 ){

87303 
	`sqlôe3Eº‹Msg
(
pP¨£
, "unableÅo openáÅemporary database "

87305 
pP¨£
->
rc
 =Ñc;

87308 
db
->
aDb
[1].
pBt
 =ÖBt;

87309 
	`as£π
–
db
->
aDb
[1].
pSchema
 );

87310 if–
SQLITE_NOMEM
==
	`sqlôe3BåìSëPageSize
(
pBt
, 
db
->
√xtPagesize
, -1, 0) ){

87311 
db
->
mÆlocFaûed
 = 1;

87340 
SQLITE_PRIVATE
 
	`sqlôe3CodeVîifySchema
(
P¨£
 *
pP¨£
, 
iDb
){

87341 
P¨£
 *
pT›Àvñ
 = 
	`sqlôe3P¨£T›Àvñ
(
pP¨£
);

87343 #i‚de‡
SQLITE_OMIT_TRIGGER


87344 if–
pT›Àvñ
!=
pP¨£
 ){

87349 
pP¨£
->
cookõGŸo
 = -1;

87352 if–
pT›Àvñ
->
cookõGŸo
==0 ){

87353 
Vdbe
 *
v
 = 
	`sqlôe3GëVdbe
(
pT›Àvñ
);

87354 if–
v
==0 ) ;

87355 
pT›Àvñ
->
cookõGŸo
 = 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_GŸo
, 0, 0)+1;

87357 if–
iDb
>=0 ){

87358 
sqlôe3
 *
db
 = 
pT›Àvñ
->db;

87359 
yDbMask
 
mask
;

87361 
	`as£π
–
iDb
<
db
->
nDb
 );

87362 
	`as£π
–
db
->
aDb
[
iDb
].
pBt
!=0 || iDb==1 );

87363 
	`as£π
–
iDb
<
SQLITE_MAX_ATTACHED
+2 );

87364 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 
iDb
, 0) );

87365 
mask
 = ((
yDbMask
)1)<<
iDb
;

87366 if–(
pT›Àvñ
->
cookõMask
 & 
mask
)==0 ){

87367 
pT›Àvñ
->
cookõMask
 |
mask
;

87368 
pT›Àvñ
->
cookõVÆue
[
iDb
] = 
db
->
aDb
[iDb].
pSchema
->
schema_cookõ
;

87369 if–!
OMIT_TEMPDB
 && 
iDb
==1 ){

87370 
	`sqlôe3O≥nTempD©aba£
(
pT›Àvñ
);

87380 
SQLITE_PRIVATE
 
	`sqlôe3CodeVîifyNamedSchema
(
P¨£
 *
pP¨£
, c⁄° *
zDb
){

87381 
sqlôe3
 *
db
 = 
pP¨£
->db;

87382 
i
;

87383 
i
=0; i<
db
->
nDb
; i++){

87384 
Db
 *
pDb
 = &
db
->
aDb
[
i
];

87385 if–
pDb
->
pBt
 && (!
zDb
 || 0==
	`sqlôe3SåICmp
(zDb,ÖDb->
zName
)) ){

87386 
	`sqlôe3CodeVîifySchema
(
pP¨£
, 
i
);

87404 
SQLITE_PRIVATE
 
	`sqlôe3BegöWrôeO≥øti⁄
(
P¨£
 *
pP¨£
, 
£tSèãmít
, 
iDb
){

87405 
P¨£
 *
pT›Àvñ
 = 
	`sqlôe3P¨£T›Àvñ
(
pP¨£
);

87406 
	`sqlôe3CodeVîifySchema
(
pP¨£
, 
iDb
);

87407 
pT›Àvñ
->
wrôeMask
 |((
yDbMask
)1)<<
iDb
;

87408 
pT›Àvñ
->
isMu…iWrôe
 |
£tSèãmít
;

87418 
SQLITE_PRIVATE
 
	`sqlôe3Mu…iWrôe
(
P¨£
 *
pP¨£
){

87419 
P¨£
 *
pT›Àvñ
 = 
	`sqlôe3P¨£T›Àvñ
(
pP¨£
);

87420 
pT›Àvñ
->
isMu…iWrôe
 = 1;

87439 
SQLITE_PRIVATE
 
	`sqlôe3MayAb‹t
(
P¨£
 *
pP¨£
){

87440 
P¨£
 *
pT›Àvñ
 = 
	`sqlôe3P¨£T›Àvñ
(
pP¨£
);

87441 
pT›Àvñ
->
mayAb‹t
 = 1;

87449 
SQLITE_PRIVATE
 
	`sqlôe3HÆtC⁄°øöt
(

87450 
P¨£
 *
pP¨£
,

87451 
îrCode
,

87452 
⁄Eº‹
,

87453 *
p4
,

87454 
p4ty≥


87456 
Vdbe
 *
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

87457 
	`as£π
–(
îrCode
&0xff)==
SQLITE_CONSTRAINT
 );

87458 if–
⁄Eº‹
==
OE_Ab‹t
 ){

87459 
	`sqlôe3MayAb‹t
(
pP¨£
);

87461 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_HÆt
, 
îrCode
, 
⁄Eº‹
, 0, 
p4
, 
p4ty≥
);

87468 #i‚de‡
SQLITE_OMIT_REINDEX


87469 
	`cﬁœti⁄M©ch
(c⁄° *
zCﬁl
, 
Index
 *
pIndex
){

87470 
i
;

87471 
	`as£π
–
zCﬁl
!=0 );

87472 
i
=0; i<
pIndex
->
nCﬁumn
; i++){

87473 c⁄° *
z
 = 
pIndex
->
azCﬁl
[
i
];

87474 
	`as£π
–
z
!=0 );

87475 if–0==
	`sqlôe3SåICmp
(
z
, 
zCﬁl
) ){

87487 #i‚de‡
SQLITE_OMIT_REINDEX


87488 
	`ªödexTabÀ
(
P¨£
 *
pP¨£
, 
TabÀ
 *
pTab
, c⁄° *
zCﬁl
){

87489 
Index
 *
pIndex
;

87491 
pIndex
=
pTab
->pIndex;ÖIndex;ÖIndexıIndex->
pNext
){

87492 if–
zCﬁl
==0 || 
	`cﬁœti⁄M©ch
(zCﬁl, 
pIndex
) ){

87493 
iDb
 = 
	`sqlôe3SchemaToIndex
(
pP¨£
->
db
, 
pTab
->
pSchema
);

87494 
	`sqlôe3BegöWrôeO≥øti⁄
(
pP¨£
, 0, 
iDb
);

87495 
	`sqlôe3RefûlIndex
(
pP¨£
, 
pIndex
, -1);

87506 #i‚de‡
SQLITE_OMIT_REINDEX


87507 
	`ªödexD©aba£s
(
P¨£
 *
pP¨£
, c⁄° *
zCﬁl
){

87508 
Db
 *
pDb
;

87509 
iDb
;

87510 
sqlôe3
 *
db
 = 
pP¨£
->db;

87511 
HashEÀm
 *
k
;

87512 
TabÀ
 *
pTab
;

87514 
	`as£π
–
	`sqlôe3BåìHﬁdsAŒMuãxes
(
db
) );

87515 
iDb
=0, 
pDb
=
db
->
aDb
; iDb<db->
nDb
; iDb++,ÖDb++){

87516 
	`as£π
–
pDb
!=0 );

87517 
k
=
	`sqlôeHashFú°
(&
pDb
->
pSchema
->
tblHash
); k; k=
	`sqlôeHashNext
(k)){

87518 
pTab
 = (
TabÀ
*)
	`sqlôeHashD©a
(
k
);

87519 
	`ªödexTabÀ
(
pP¨£
, 
pTab
, 
zCﬁl
);

87538 #i‚de‡
SQLITE_OMIT_REINDEX


87539 
SQLITE_PRIVATE
 
	`sqlôe3Reödex
(
P¨£
 *
pP¨£
, 
Tokí
 *
pName1
, Tokí *
pName2
){

87540 
CﬁlSeq
 *
pCﬁl
;

87541 *
z
;

87542 c⁄° *
zDb
;

87543 
TabÀ
 *
pTab
;

87544 
Index
 *
pIndex
;

87545 
iDb
;

87546 
sqlôe3
 *
db
 = 
pP¨£
->db;

87547 
Tokí
 *
pObjName
;

87551 if–
SQLITE_OK
!=
	`sqlôe3RódSchema
(
pP¨£
) ){

87555 if–
pName1
==0 ){

87556 
	`ªödexD©aba£s
(
pP¨£
, 0);

87558 }if–
	`NEVER
(
pName2
==0Ë||ÖName2->
z
==0 ){

87559 *
zCﬁl
;

87560 
	`as£π
–
pName1
->
z
 );

87561 
zCﬁl
 = 
	`sqlôe3NameFromTokí
(
pP¨£
->
db
, 
pName1
);

87562 if–!
zCﬁl
 ) ;

87563 
pCﬁl
 = 
	`sqlôe3FödCﬁlSeq
(
db
, 
	`ENC
(db), 
zCﬁl
, 0);

87564 if–
pCﬁl
 ){

87565 
	`ªödexD©aba£s
(
pP¨£
, 
zCﬁl
);

87566 
	`sqlôe3DbFªe
(
db
, 
zCﬁl
);

87569 
	`sqlôe3DbFªe
(
db
, 
zCﬁl
);

87571 
iDb
 = 
	`sqlôe3TwoP¨tName
(
pP¨£
, 
pName1
, 
pName2
, &
pObjName
);

87572 if–
iDb
<0 ) ;

87573 
z
 = 
	`sqlôe3NameFromTokí
(
db
, 
pObjName
);

87574 if–
z
==0 ) ;

87575 
zDb
 = 
db
->
aDb
[
iDb
].
zName
;

87576 
pTab
 = 
	`sqlôe3FödTabÀ
(
db
, 
z
, 
zDb
);

87577 if–
pTab
 ){

87578 
	`ªödexTabÀ
(
pP¨£
, 
pTab
, 0);

87579 
	`sqlôe3DbFªe
(
db
, 
z
);

87582 
pIndex
 = 
	`sqlôe3FödIndex
(
db
, 
z
, 
zDb
);

87583 
	`sqlôe3DbFªe
(
db
, 
z
);

87584 if–
pIndex
 ){

87585 
	`sqlôe3BegöWrôeO≥øti⁄
(
pP¨£
, 0, 
iDb
);

87586 
	`sqlôe3RefûlIndex
(
pP¨£
, 
pIndex
, -1);

87589 
	`sqlôe3Eº‹Msg
(
pP¨£
, "unableÅo identifyÅhe objectÅo beÑeindexed");

87603 
SQLITE_PRIVATE
 
KeyInfo
 *
	`sqlôe3IndexKeyöfo
(
P¨£
 *
pP¨£
, 
Index
 *
pIdx
){

87604 
i
;

87605 
nCﬁ
 = 
pIdx
->
nCﬁumn
;

87606 
KeyInfo
 *
pKey
;

87608 
pKey
 = 
	`sqlôe3KeyInfoAŒoc
(
pP¨£
->
db
, 
nCﬁ
);

87609 if–
pKey
 ){

87610 
i
=0; i<
nCﬁ
; i++){

87611 *
zCﬁl
 = 
pIdx
->
azCﬁl
[
i
];

87612 
	`as£π
–
zCﬁl
 );

87613 
pKey
->
aCﬁl
[
i
] = 
	`sqlôe3LoˇãCﬁlSeq
(
pP¨£
, 
zCﬁl
);

87614 
pKey
->
aS‹tOrdî
[
i
] = 
pIdx
->aSortOrder[i];

87618 if–
pP¨£
->
nEº
 ){

87619 
	`sqlôe3DbFªe
(
pP¨£
->
db
, 
pKey
);

87620 
pKey
 = 0;

87622  
pKey
;

87648 
	`ˇŒCﬁlNìded
(
sqlôe3
 *
db
, 
íc
, c⁄° *
zName
){

87649 
	`as£π
–!
db
->
xCﬁlNìded
 || !db->
xCﬁlNìded16
 );

87650 if–
db
->
xCﬁlNìded
 ){

87651 *
zExã∫Æ
 = 
	`sqlôe3DbSåDup
(
db
, 
zName
);

87652 if–!
zExã∫Æ
 ) ;

87653 
db
->
	`xCﬁlNìded
(db->
pCﬁlNìdedArg
, db, 
íc
, 
zExã∫Æ
);

87654 
	`sqlôe3DbFªe
(
db
, 
zExã∫Æ
);

87656 #i‚de‡
SQLITE_OMIT_UTF16


87657 if–
db
->
xCﬁlNìded16
 ){

87658 c⁄° *
zExã∫Æ
;

87659 
sqlôe3_vÆue
 *
pTmp
 = 
	`sqlôe3VÆueNew
(
db
);

87660 
	`sqlôe3VÆueSëSå
(
pTmp
, -1, 
zName
, 
SQLITE_UTF8
, 
SQLITE_STATIC
);

87661 
zExã∫Æ
 = 
	`sqlôe3VÆueText
(
pTmp
, 
SQLITE_UTF16NATIVE
);

87662 if–
zExã∫Æ
 ){

87663 
db
->
	`xCﬁlNìded16
(db->
pCﬁlNìdedArg
, db, ()
	`ENC
(db), 
zExã∫Æ
);

87665 
	`sqlôe3VÆueFªe
(
pTmp
);

87677 
	`sy¡hCﬁlSeq
(
sqlôe3
 *
db
, 
CﬁlSeq
 *
pCﬁl
){

87678 
CﬁlSeq
 *
pCﬁl2
;

87679 *
z
 = 
pCﬁl
->
zName
;

87680 
i
;

87681 c⁄° 
u8
 
aEnc
[] = { 
SQLITE_UTF16BE
, 
SQLITE_UTF16LE
, 
SQLITE_UTF8
 };

87682 
i
=0; i<3; i++){

87683 
pCﬁl2
 = 
	`sqlôe3FödCﬁlSeq
(
db
, 
aEnc
[
i
], 
z
, 0);

87684 if–
pCﬁl2
->
xCmp
!=0 ){

87685 
	`mem˝y
(
pCﬁl
, 
pCﬁl2
, (
CﬁlSeq
));

87686 
pCﬁl
->
xDñ
 = 0;

87687  
SQLITE_OK
;

87690  
SQLITE_ERROR
;

87707 
SQLITE_PRIVATE
 
CﬁlSeq
 *
	`sqlôe3GëCﬁlSeq
(

87708 
P¨£
 *
pP¨£
,

87709 
u8
 
íc
,

87710 
CﬁlSeq
 *
pCﬁl
,

87711 c⁄° *
zName


87713 
CﬁlSeq
 *
p
;

87714 
sqlôe3
 *
db
 = 
pP¨£
->db;

87716 
p
 = 
pCﬁl
;

87717 if–!
p
 ){

87718 
p
 = 
	`sqlôe3FödCﬁlSeq
(
db
, 
íc
, 
zName
, 0);

87720 if–!
p
 || !p->
xCmp
 ){

87724 
	`ˇŒCﬁlNìded
(
db
, 
íc
, 
zName
);

87725 
p
 = 
	`sqlôe3FödCﬁlSeq
(
db
, 
íc
, 
zName
, 0);

87727 if–
p
 && !p->
xCmp
 && 
	`sy¡hCﬁlSeq
(
db
,Ö) ){

87728 
p
 = 0;

87730 
	`as£π
–!
p
 ||Ö->
xCmp
 );

87731 if–
p
==0 ){

87732 
	`sqlôe3Eº‹Msg
(
pP¨£
, "nÿsuch cﬁœti⁄ sequí˚: %s", 
zName
);

87734  
p
;

87748 
SQLITE_PRIVATE
 
	`sqlôe3CheckCﬁlSeq
(
P¨£
 *
pP¨£
, 
CﬁlSeq
 *
pCﬁl
){

87749 if–
pCﬁl
 ){

87750 c⁄° *
zName
 = 
pCﬁl
->zName;

87751 
sqlôe3
 *
db
 = 
pP¨£
->db;

87752 
CﬁlSeq
 *
p
 = 
	`sqlôe3GëCﬁlSeq
(
pP¨£
, 
	`ENC
(
db
), 
pCﬁl
, 
zName
);

87753 if–!
p
 ){

87754  
SQLITE_ERROR
;

87756 
	`as£π
–
p
==
pCﬁl
 );

87758  
SQLITE_OK
;

87776 
CﬁlSeq
 *
	`födCﬁlSeqE¡ry
(

87777 
sqlôe3
 *
db
,

87778 c⁄° *
zName
,

87779 
¸óã


87781 
CﬁlSeq
 *
pCﬁl
;

87782 
nName
 = 
	`sqlôe3SåÀn30
(
zName
);

87783 
pCﬁl
 = 
	`sqlôe3HashFöd
(&
db
->
aCﬁlSeq
, 
zName
, 
nName
);

87785 if–0==
pCﬁl
 && 
¸óã
 ){

87786 
pCﬁl
 = 
	`sqlôe3DbMÆlocZîo
(
db
, 3*(*pCﬁlË+ 
nName
 + 1 );

87787 if–
pCﬁl
 ){

87788 
CﬁlSeq
 *
pDñ
 = 0;

87789 
pCﬁl
[0].
zName
 = (*)&pColl[3];

87790 
pCﬁl
[0].
íc
 = 
SQLITE_UTF8
;

87791 
pCﬁl
[1].
zName
 = (*)&pColl[3];

87792 
pCﬁl
[1].
íc
 = 
SQLITE_UTF16LE
;

87793 
pCﬁl
[2].
zName
 = (*)&pColl[3];

87794 
pCﬁl
[2].
íc
 = 
SQLITE_UTF16BE
;

87795 
	`mem˝y
(
pCﬁl
[0].
zName
, zName, 
nName
);

87796 
pCﬁl
[0].
zName
[
nName
] = 0;

87797 
pDñ
 = 
	`sqlôe3HashIn£π
(&
db
->
aCﬁlSeq
, 
pCﬁl
[0].
zName
, 
nName
,ÖColl);

87803 
	`as£π
–
pDñ
==0 ||ÖDñ==
pCﬁl
 );

87804 if–
pDñ
!=0 ){

87805 
db
->
mÆlocFaûed
 = 1;

87806 
	`sqlôe3DbFªe
(
db
, 
pDñ
);

87807 
pCﬁl
 = 0;

87811  
pCﬁl
;

87829 
SQLITE_PRIVATE
 
CﬁlSeq
 *
	`sqlôe3FödCﬁlSeq
(

87830 
sqlôe3
 *
db
,

87831 
u8
 
íc
,

87832 c⁄° *
zName
,

87833 
¸óã


87835 
CﬁlSeq
 *
pCﬁl
;

87836 if–
zName
 ){

87837 
pCﬁl
 = 
	`födCﬁlSeqE¡ry
(
db
, 
zName
, 
¸óã
);

87839 
pCﬁl
 = 
db
->
pDÊtCﬁl
;

87841 
	`as£π
–
SQLITE_UTF8
==1 && 
SQLITE_UTF16LE
==2 && 
SQLITE_UTF16BE
==3 );

87842 
	`as£π
–
íc
>=
SQLITE_UTF8
 &&Énc<=
SQLITE_UTF16BE
 );

87843 if–
pCﬁl
 )ÖCﬁ»+
íc
-1;

87844  
pCﬁl
;

87875 
	#FUNC_PERFECT_MATCH
 6

	)

87876 
	`m©chQuÆôy
(

87877 
FuncDef
 *
p
,

87878 
nArg
,

87879 
u8
 
íc


87881 
m©ch
;

87884 if–
nArg
==(-2ËË (
p
->
xFunc
==0 &&Ö->
xSãp
==0Ë? 0 : 
FUNC_PERFECT_MATCH
;

87887 if–
p
->
nArg
!=nArg &&Ö->nArg>=0 )  0;

87891 if–
p
->
nArg
==nArg ){

87892 
m©ch
 = 4;

87894 
m©ch
 = 1;

87898 if–
íc
==(
p
->
funcFœgs
 & 
SQLITE_FUNC_ENCMASK
) ){

87899 
m©ch
 += 2;

87900 }if–(
íc
 & 
p
->
funcFœgs
 & 2)!=0 ){

87901 
m©ch
 += 1;

87904  
m©ch
;

87911 
FuncDef
 *
	`fun˘i⁄Sórch
(

87912 
FuncDefHash
 *
pHash
,

87913 
h
,

87914 c⁄° *
zFunc
,

87915 
nFunc


87917 
FuncDef
 *
p
;

87918 
p
=
pHash
->
a
[
h
];Ö;Ö=p->pHash){

87919 if–
	`sqlôe3SåNICmp
(
p
->
zName
, 
zFunc
, 
nFunc
)==0 &&Ö->zName[nFunc]==0 ){

87920  
p
;

87929 
SQLITE_PRIVATE
 
	`sqlôe3FuncDefIn£π
(

87930 
FuncDefHash
 *
pHash
,

87931 
FuncDef
 *
pDef


87933 
FuncDef
 *
pOthî
;

87934 
nName
 = 
	`sqlôe3SåÀn30
(
pDef
->
zName
);

87935 
u8
 
c1
 = (u8)
pDef
->
zName
[0];

87936 
h
 = (
sqlôe3UµîToLowî
[
c1
] + 
nName
Ë% 
	`AºaySize
(
pHash
->
a
);

87937 
pOthî
 = 
	`fun˘i⁄Sórch
(
pHash
, 
h
, 
pDef
->
zName
, 
nName
);

87938 if–
pOthî
 ){

87939 
	`as£π
–
pOthî
!=
pDef
 &&ÖOthî->
pNext
!=pDef );

87940 
pDef
->
pNext
 = 
pOthî
->pNext;

87941 
pOthî
->
pNext
 = 
pDef
;

87943 
pDef
->
pNext
 = 0;

87944 
pDef
->
pHash
 =ÖHash->
a
[
h
];

87945 
pHash
->
a
[
h
] = 
pDef
;

87970 
SQLITE_PRIVATE
 
FuncDef
 *
	`sqlôe3FödFun˘i⁄
(

87971 
sqlôe3
 *
db
,

87972 c⁄° *
zName
,

87973 
nName
,

87974 
nArg
,

87975 
u8
 
íc
,

87976 
u8
 
¸óãFœg


87978 
FuncDef
 *
p
;

87979 
FuncDef
 *
pBe°
 = 0;

87980 
be°Sc‹e
 = 0;

87981 
h
;

87983 
	`as£π
–
nArg
>=(-2) );

87984 
	`as£π
–
nArg
>=(-1Ë|| 
¸óãFœg
==0 );

87985 
	`as£π
–
íc
==
SQLITE_UTF8
 ||Énc==
SQLITE_UTF16LE
 ||Énc==
SQLITE_UTF16BE
 );

87986 
h
 = (
sqlôe3UµîToLowî
[(
u8
)
zName
[0]] + 
nName
Ë% 
	`AºaySize
(
db
->
aFunc
.
a
);

87990 
p
 = 
	`fun˘i⁄Sórch
(&
db
->
aFunc
, 
h
, 
zName
, 
nName
);

87991  
p
 ){

87992 
sc‹e
 = 
	`m©chQuÆôy
(
p
, 
nArg
, 
íc
);

87993 if–
sc‹e
>
be°Sc‹e
 ){

87994 
pBe°
 = 
p
;

87995 
be°Sc‹e
 = 
sc‹e
;

87997 
p
 =Ö->
pNext
;

88012 if–!
¸óãFœg
 && (
pBe°
==0 || (
db
->
Êags
 & 
SQLITE_Pª„rBuûtö
)!=0) ){

88013 
FuncDefHash
 *
pHash
 = &
	`GLOBAL
(FuncDefHash, 
sqlôe3GlobÆFun˘i⁄s
);

88014 
be°Sc‹e
 = 0;

88015 
p
 = 
	`fun˘i⁄Sórch
(
pHash
, 
h
, 
zName
, 
nName
);

88016  
p
 ){

88017 
sc‹e
 = 
	`m©chQuÆôy
(
p
, 
nArg
, 
íc
);

88018 if–
sc‹e
>
be°Sc‹e
 ){

88019 
pBe°
 = 
p
;

88020 
be°Sc‹e
 = 
sc‹e
;

88022 
p
 =Ö->
pNext
;

88030 if–
¸óãFœg
 && 
be°Sc‹e
<
FUNC_PERFECT_MATCH
 &&

88031 (
pBe°
 = 
	`sqlôe3DbMÆlocZîo
(
db
, (*pBe°)+
nName
+1))!=0 ){

88032 
pBe°
->
zName
 = (*)&pBest[1];

88033 
pBe°
->
nArg
 = (
u16
)nArg;

88034 
pBe°
->
funcFœgs
 = 
íc
;

88035 
	`mem˝y
(
pBe°
->
zName
, zName, 
nName
);

88036 
pBe°
->
zName
[
nName
] = 0;

88037 
	`sqlôe3FuncDefIn£π
(&
db
->
aFunc
, 
pBe°
);

88040 if–
pBe°
 && (pBe°->
xSãp
 ||ÖBe°->
xFunc
 || 
¸óãFœg
) ){

88041  
pBe°
;

88054 
SQLITE_PRIVATE
 
	`sqlôe3SchemaCÀ¨
(*
p
){

88055 
Hash
 
ãmp1
;

88056 
Hash
 
ãmp2
;

88057 
HashEÀm
 *
pEÀm
;

88058 
Schema
 *
pSchema
 = (Schem®*)
p
;

88060 
ãmp1
 = 
pSchema
->
tblHash
;

88061 
ãmp2
 = 
pSchema
->
åigHash
;

88062 
	`sqlôe3HashInô
(&
pSchema
->
åigHash
);

88063 
	`sqlôe3HashCÀ¨
(&
pSchema
->
idxHash
);

88064 
pEÀm
=
	`sqlôeHashFú°
(&
ãmp2
);ÖEÀm;ÖEÀm=
	`sqlôeHashNext
(pElem)){

88065 
	`sqlôe3DñëeTriggî
(0, (
Triggî
*)
	`sqlôeHashD©a
(
pEÀm
));

88067 
	`sqlôe3HashCÀ¨
(&
ãmp2
);

88068 
	`sqlôe3HashInô
(&
pSchema
->
tblHash
);

88069 
pEÀm
=
	`sqlôeHashFú°
(&
ãmp1
);ÖEÀm;ÖEÀm=
	`sqlôeHashNext
(pElem)){

88070 
TabÀ
 *
pTab
 = 
	`sqlôeHashD©a
(
pEÀm
);

88071 
	`sqlôe3DñëeTabÀ
(0, 
pTab
);

88073 
	`sqlôe3HashCÀ¨
(&
ãmp1
);

88074 
	`sqlôe3HashCÀ¨
(&
pSchema
->
fkeyHash
);

88075 
pSchema
->
pSeqTab
 = 0;

88076 if–
pSchema
->
Êags
 & 
DB_SchemaLﬂded
 ){

88077 
pSchema
->
iGíî©i⁄
++;

88078 
pSchema
->
Êags
 &~
DB_SchemaLﬂded
;

88086 
SQLITE_PRIVATE
 
Schema
 *
	`sqlôe3SchemaGë
(
sqlôe3
 *
db
, 
Båì
 *
pBt
){

88087 
Schema
 * 
p
;

88088 if–
pBt
 ){

88089 
p
 = (
Schema
 *)
	`sqlôe3BåìSchema
(
pBt
, (Schema), 
sqlôe3SchemaCÀ¨
);

88091 
p
 = (
Schema
 *)
	`sqlôe3DbMÆlocZîo
(0, (Schema));

88093 if–!
p
 ){

88094 
db
->
mÆlocFaûed
 = 1;

88095 }i‡–0==
p
->
fûe_f‹m©
 ){

88096 
	`sqlôe3HashInô
(&
p
->
tblHash
);

88097 
	`sqlôe3HashInô
(&
p
->
idxHash
);

88098 
	`sqlôe3HashInô
(&
p
->
åigHash
);

88099 
	`sqlôe3HashInô
(&
p
->
fkeyHash
);

88100 
p
->
íc
 = 
SQLITE_UTF8
;

88102  
p
;

88136 
SQLITE_PRIVATE
 
TabÀ
 *
	`sqlôe3SrcLi°Lookup
(
P¨£
 *
pP¨£
, 
SrcLi°
 *
pSrc
){

88137 
SrcLi°_ôem
 *
pIãm
 = 
pSrc
->
a
;

88138 
TabÀ
 *
pTab
;

88139 
	`as£π
–
pIãm
 && 
pSrc
->
nSrc
==1 );

88140 
pTab
 = 
	`sqlôe3LoˇãTabÀIãm
(
pP¨£
, 0, 
pIãm
);

88141 
	`sqlôe3DñëeTabÀ
(
pP¨£
->
db
, 
pIãm
->
pTab
);

88142 
pIãm
->
pTab
 =ÖTab;

88143 if–
pTab
 ){

88144 
pTab
->
nRef
++;

88146 if–
	`sqlôe3IndexedByLookup
(
pP¨£
, 
pIãm
) ){

88147 
pTab
 = 0;

88149  
pTab
;

88157 
SQLITE_PRIVATE
 
	`sqlôe3IsRódO∆y
(
P¨£
 *
pP¨£
, 
TabÀ
 *
pTab
, 
võwOk
){

88168 if––
	`IsVútuÆ
(
pTab
)

88169 && 
	`sqlôe3GëVTabÀ
(
pP¨£
->
db
, 
pTab
)->
pMod
->
pModuÀ
->
xUpd©e
==0 )

88170 || ( (
pTab
->
èbFœgs
 & 
TF_Ród⁄ly
)!=0

88171 && (
pP¨£
->
db
->
Êags
 & 
SQLITE_WrôeSchema
)==0

88172 && 
pP¨£
->
√°ed
==0 )

88174 
	`sqlôe3Eº‹Msg
(
pP¨£
, "èbÀ %†mayÇŸ bêmodifõd", 
pTab
->
zName
);

88178 #i‚de‡
SQLITE_OMIT_VIEW


88179 if–!
võwOk
 && 
pTab
->
pSñe˘
 ){

88180 
	`sqlôe3Eº‹Msg
(
pP¨£
,"ˇ¬Ÿ modify %†beˇu£ iài†®võw",
pTab
->
zName
);

88188 #i‡!
	`deföed
(
SQLITE_OMIT_VIEW
Ë&& !deföed(
SQLITE_OMIT_TRIGGER
)

88194 
SQLITE_PRIVATE
 
	`sqlôe3M©îülizeVõw
(

88195 
P¨£
 *
pP¨£
,

88196 
TabÀ
 *
pVõw
,

88197 
Ex¥
 *
pWhîe
,

88198 
iCur


88200 
Sñe˘De°
 
de°
;

88201 
Sñe˘
 *
pSñ
;

88202 
SrcLi°
 *
pFrom
;

88203 
sqlôe3
 *
db
 = 
pP¨£
->db;

88204 
iDb
 = 
	`sqlôe3SchemaToIndex
(
db
, 
pVõw
->
pSchema
);

88206 
pWhîe
 = 
	`sqlôe3Ex¥Dup
(
db
,ÖWhere, 0);

88207 
pFrom
 = 
	`sqlôe3SrcLi°Aµíd
(
db
, 0, 0, 0);

88209 if–
pFrom
 ){

88210 
	`as£π
–
pFrom
->
nSrc
==1 );

88211 
pFrom
->
a
[0].
zName
 = 
	`sqlôe3DbSåDup
(
db
, 
pVõw
->zName);

88212 
pFrom
->
a
[0].
zD©aba£
 = 
	`sqlôe3DbSåDup
(
db
, db->
aDb
[
iDb
].
zName
);

88213 
	`as£π
–
pFrom
->
a
[0].
pOn
==0 );

88214 
	`as£π
–
pFrom
->
a
[0].
pUsög
==0 );

88217 
pSñ
 = 
	`sqlôe3Sñe˘New
(
pP¨£
, 0, 
pFrom
, 
pWhîe
, 0, 0, 0, 0, 0, 0);

88218 if–
pSñ
 )ÖSñ->
£lFœgs
 |
SF_M©îülize
;

88220 
	`sqlôe3Sñe˘De°Inô
(&
de°
, 
SRT_EphemTab
, 
iCur
);

88221 
	`sqlôe3Sñe˘
(
pP¨£
, 
pSñ
, &
de°
);

88222 
	`sqlôe3Sñe˘Dñëe
(
db
, 
pSñ
);

88226 #i‡
	`deföed
(
SQLITE_ENABLE_UPDATE_DELETE_LIMIT
Ë&& !deföed(
SQLITE_OMIT_SUBQUERY
)

88235 
SQLITE_PRIVATE
 
Ex¥
 *
	`sqlôe3LimôWhîe
(

88236 
P¨£
 *
pP¨£
,

88237 
SrcLi°
 *
pSrc
,

88238 
Ex¥
 *
pWhîe
,

88239 
Ex¥Li°
 *
pOrdîBy
,

88240 
Ex¥
 *
pLimô
,

88241 
Ex¥
 *
pOff£t
,

88242 *
zStmtTy≥


88244 
Ex¥
 *
pWhîeRowid
 = 
NULL
;

88245 
Ex¥
 *
pInCœu£
 = 
NULL
;

88246 
Ex¥
 *
pSñe˘Rowid
 = 
NULL
;

88247 
Ex¥Li°
 *
pELi°
 = 
NULL
;

88248 
SrcLi°
 *
pSñe˘Src
 = 
NULL
;

88249 
Sñe˘
 *
pSñe˘
 = 
NULL
;

88253 if–
pOrdîBy
 && (
pLimô
 == 0) ) {

88254 
	`sqlôe3Eº‹Msg
(
pP¨£
, "ORDER BY wôhouàLIMIT o¿%s", 
zStmtTy≥
);

88255 
limô_whîe_˛ónup_2
;

88261 if–
pLimô
 == 0 ) {

88263 
	`as£π
–
pOff£t
 == 0 );

88264  
pWhîe
;

88276 
pSñe˘Rowid
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_ROW
, 0, 0, 0);

88277 if–
pSñe˘Rowid
 =0 ) 
limô_whîe_˛ónup_2
;

88278 
pELi°
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
, 0, 
pSñe˘Rowid
);

88279 if–
pELi°
 =0 ) 
limô_whîe_˛ónup_2
;

88283 
pSñe˘Src
 = 
	`sqlôe3SrcLi°Dup
(
pP¨£
->
db
, 
pSrc
, 0);

88284 if–
pSñe˘Src
 == 0 ) {

88285 
	`sqlôe3Ex¥Li°Dñëe
(
pP¨£
->
db
, 
pELi°
);

88286 
limô_whîe_˛ónup_2
;

88290 
pSñe˘
 = 
	`sqlôe3Sñe˘New
(
pP¨£
,
pELi°
,
pSñe˘Src
,
pWhîe
,0,0,

88291 
pOrdîBy
,0,
pLimô
,
pOff£t
);

88292 if–
pSñe˘
 == 0 )  0;

88295 
pWhîeRowid
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_ROW
, 0, 0, 0);

88296 if–
pWhîeRowid
 =0 ) 
limô_whîe_˛ónup_1
;

88297 
pInCœu£
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_IN
, 
pWhîeRowid
, 0, 0);

88298 if–
pInCœu£
 =0 ) 
limô_whîe_˛ónup_1
;

88300 
pInCœu£
->
x
.
pSñe˘
 =ÖSelect;

88301 
pInCœu£
->
Êags
 |
EP_xIsSñe˘
;

88302 
	`sqlôe3Ex¥SëHeight
(
pP¨£
, 
pInCœu£
);

88303  
pInCœu£
;

88306 
limô_whîe_˛ónup_1
:

88307 
	`sqlôe3Sñe˘Dñëe
(
pP¨£
->
db
, 
pSñe˘
);

88310 
limô_whîe_˛ónup_2
:

88311 
	`sqlôe3Ex¥Dñëe
(
pP¨£
->
db
, 
pWhîe
);

88312 
	`sqlôe3Ex¥Li°Dñëe
(
pP¨£
->
db
, 
pOrdîBy
);

88313 
	`sqlôe3Ex¥Dñëe
(
pP¨£
->
db
, 
pLimô
);

88314 
	`sqlôe3Ex¥Dñëe
(
pP¨£
->
db
, 
pOff£t
);

88326 
SQLITE_PRIVATE
 
	`sqlôe3DñëeFrom
(

88327 
P¨£
 *
pP¨£
,

88328 
SrcLi°
 *
pTabLi°
,

88329 
Ex¥
 *
pWhîe


88331 
Vdbe
 *
v
;

88332 
TabÀ
 *
pTab
;

88333 c⁄° *
zDb
;

88334 
íd
, 
addr
 = 0;

88335 
i
;

88336 
WhîeInfo
 *
pWInfo
;

88337 
Index
 *
pIdx
;

88338 
iCur
;

88339 
sqlôe3
 *
db
;

88340 
AuthC⁄ãxt
 
sC⁄ãxt
;

88341 
NameC⁄ãxt
 
sNC
;

88342 
iDb
;

88343 
memC¡
 = -1;

88344 
rˇuth
;

88346 #i‚de‡
SQLITE_OMIT_TRIGGER


88347 
isVõw
;

88348 
Triggî
 *
pTriggî
;

88351 
	`mem£t
(&
sC⁄ãxt
, 0, (sContext));

88352 
db
 = 
pP¨£
->db;

88353 if–
pP¨£
->
nEº
 || 
db
->
mÆlocFaûed
 ){

88354 
dñëe_‰om_˛ónup
;

88356 
	`as£π
–
pTabLi°
->
nSrc
==1 );

88363 
pTab
 = 
	`sqlôe3SrcLi°Lookup
(
pP¨£
, 
pTabLi°
);

88364 if–
pTab
==0 ) 
dñëe_‰om_˛ónup
;

88369 #i‚de‡
SQLITE_OMIT_TRIGGER


88370 
pTriggî
 = 
	`sqlôe3TriggîsExi°
(
pP¨£
, 
pTab
, 
TK_DELETE
, 0, 0);

88371 
isVõw
 = 
pTab
->
pSñe˘
!=0;

88373 
	#pTriggî
 0

	)

88374 
	#isVõw
 0

	)

88376 #ifde‡
SQLITE_OMIT_VIEW


88377 #unde‡
isVõw


88378 
	#isVõw
 0

	)

88383 if–
	`sqlôe3VõwGëCﬁumnNames
(
pP¨£
, 
pTab
) ){

88384 
dñëe_‰om_˛ónup
;

88387 if–
	`sqlôe3IsRódO∆y
(
pP¨£
, 
pTab
, (
pTriggî
?1:0)) ){

88388 
dñëe_‰om_˛ónup
;

88390 
iDb
 = 
	`sqlôe3SchemaToIndex
(
db
, 
pTab
->
pSchema
);

88391 
	`as£π
–
iDb
<
db
->
nDb
 );

88392 
zDb
 = 
db
->
aDb
[
iDb
].
zName
;

88393 
rˇuth
 = 
	`sqlôe3AuthCheck
(
pP¨£
, 
SQLITE_DELETE
, 
pTab
->
zName
, 0, 
zDb
);

88394 
	`as£π
–
rˇuth
==
SQLITE_OK
 ||Ñˇuth==
SQLITE_DENY
 ||Ñˇuth==
SQLITE_IGNORE
 );

88395 if–
rˇuth
==
SQLITE_DENY
 ){

88396 
dñëe_‰om_˛ónup
;

88398 
	`as£π
(!
isVõw
 || 
pTriggî
);

88402 
	`as£π
–
pTabLi°
->
nSrc
==1 );

88403 
iCur
 = 
pTabLi°
->
a
[0].
iCurs‹
 = 
pP¨£
->
nTab
++;

88404 
pIdx
=
pTab
->
pIndex
;ÖIdx;ÖIdxıIdx->
pNext
){

88405 
pP¨£
->
nTab
++;

88410 if–
isVõw
 ){

88411 
	`sqlôe3AuthC⁄ãxtPush
(
pP¨£
, &
sC⁄ãxt
, 
pTab
->
zName
);

88416 
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

88417 if–
v
==0 ){

88418 
dñëe_‰om_˛ónup
;

88420 if–
pP¨£
->
√°ed
==0 ) 
	`sqlôe3VdbeCou¡Ch™ges
(
v
);

88421 
	`sqlôe3BegöWrôeO≥øti⁄
(
pP¨£
, 1, 
iDb
);

88426 #i‡!
	`deföed
(
SQLITE_OMIT_VIEW
Ë&& !deföed(
SQLITE_OMIT_TRIGGER
)

88427 if–
isVõw
 ){

88428 
	`sqlôe3M©îülizeVõw
(
pP¨£
, 
pTab
, 
pWhîe
, 
iCur
);

88434 
	`mem£t
(&
sNC
, 0, (sNC));

88435 
sNC
.
pP¨£
 =ÖParse;

88436 
sNC
.
pSrcLi°
 = 
pTabLi°
;

88437 if–
	`sqlôe3ResﬁveEx¥Names
(&
sNC
, 
pWhîe
) ){

88438 
dñëe_‰om_˛ónup
;

88444 if–
db
->
Êags
 & 
SQLITE_Cou¡Rows
 ){

88445 
memC¡
 = ++
pP¨£
->
nMem
;

88446 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 0, 
memC¡
);

88449 #i‚de‡
SQLITE_OMIT_TRUNCATE_OPTIMIZATION


88454 if–
rˇuth
==
SQLITE_OK
 && 
pWhîe
==0 && !
pTriggî
 && !
	`IsVútuÆ
(
pTab
)

88455 && 0==
	`sqlôe3FkRequúed
(
pP¨£
, 
pTab
, 0, 0)

88457 
	`as£π
–!
isVõw
 );

88458 
	`sqlôe3TabÀLock
(
pP¨£
, 
iDb
, 
pTab
->
äum
, 1,ÖTab->
zName
);

88459 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_CÀ¨
, 
pTab
->
äum
, 
iDb
, 
memC¡
,

88460 
pTab
->
zName
, 
P4_STATIC
);

88461 
pIdx
=
pTab
->
pIndex
;ÖIdx;ÖIdxıIdx->
pNext
){

88462 
	`as£π
–
pIdx
->
pSchema
==
pTab
->pSchema );

88463 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_CÀ¨
, 
pIdx
->
äum
, 
iDb
);

88471 
iRowSë
 = ++
pP¨£
->
nMem
;

88472 
iRowid
 = ++
pP¨£
->
nMem
;

88473 
ªgRowid
;

88477 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NuŒ
, 0, 
iRowSë
);

88478 
pWInfo
 = 
	`sqlôe3WhîeBegö
(

88479 
pP¨£
, 
pTabLi°
, 
pWhîe
, 0, 0, 
WHERE_DUPLICATES_OK
, 0

88481 if–
pWInfo
==0 ) 
dñëe_‰om_˛ónup
;

88482 
ªgRowid
 = 
	`sqlôe3Ex¥CodeGëCﬁumn
(
pP¨£
, 
pTab
, -1, 
iCur
, 
iRowid
, 0);

88483 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_RowSëAdd
, 
iRowSë
, 
ªgRowid
);

88484 if–
db
->
Êags
 & 
SQLITE_Cou¡Rows
 ){

88485 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_AddImm
, 
memC¡
, 1);

88487 
	`sqlôe3WhîeEnd
(
pWInfo
);

88492 
íd
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

88498 if–!
isVõw
 ){

88499 
	`sqlôe3O≥nTabÀAndIndi˚s
(
pP¨£
, 
pTab
, 
iCur
, 
OP_O≥nWrôe
);

88502 
addr
 = 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_RowSëRód
, 
iRowSë
, 
íd
, 
iRowid
);

88505 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


88506 if–
	`IsVútuÆ
(
pTab
) ){

88507 c⁄° *
pVTab
 = (c⁄° *)
	`sqlôe3GëVTabÀ
(
db
, 
pTab
);

88508 
	`sqlôe3VèbMakeWrôabÀ
(
pP¨£
, 
pTab
);

88509 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_VUpd©e
, 0, 1, 
iRowid
, 
pVTab
, 
P4_VTAB
);

88510 
	`sqlôe3VdbeCh™geP5
(
v
, 
OE_Ab‹t
);

88511 
	`sqlôe3MayAb‹t
(
pP¨£
);

88515 
cou¡
 = (
pP¨£
->
√°ed
==0);

88516 
	`sqlôe3Gíî©eRowDñëe
(
pP¨£
, 
pTab
, 
iCur
, 
iRowid
, 
cou¡
, 
pTriggî
, 
OE_DeÁu…
);

88520 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_GŸo
, 0, 
addr
);

88521 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
íd
);

88524 if–!
isVõw
 && !
	`IsVútuÆ
(
pTab
) ){

88525 
i
=1, 
pIdx
=
pTab
->
pIndex
;ÖIdx; i++,ÖIdxıIdx->
pNext
){

88526 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Clo£
, 
iCur
 + 
i
, 
pIdx
->
äum
);

88528 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Clo£
, 
iCur
);

88536 if–
pP¨£
->
√°ed
==0 &&ÖP¨£->
pTriggîTab
==0 ){

88537 
	`sqlôe3Autoö¸emítEnd
(
pP¨£
);

88544 if–(
db
->
Êags
&
SQLITE_Cou¡Rows
Ë&& !
pP¨£
->
√°ed
 && !pP¨£->
pTriggîTab
 ){

88545 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Resu…Row
, 
memC¡
, 1);

88546 
	`sqlôe3VdbeSëNumCﬁs
(
v
, 1);

88547 
	`sqlôe3VdbeSëCﬁName
(
v
, 0, 
COLNAME_NAME
, "row†dñëed", 
SQLITE_STATIC
);

88550 
dñëe_‰om_˛ónup
:

88551 
	`sqlôe3AuthC⁄ãxtP›
(&
sC⁄ãxt
);

88552 
	`sqlôe3SrcLi°Dñëe
(
db
, 
pTabLi°
);

88553 
	`sqlôe3Ex¥Dñëe
(
db
, 
pWhîe
);

88559 #ifde‡
isVõw


88560 #unde‡
isVõw


88562 #ifde‡
pTriggî


88563 #unde‡
pTriggî


88585 
SQLITE_PRIVATE
 
	`sqlôe3Gíî©eRowDñëe
(

88586 
P¨£
 *
pP¨£
,

88587 
TabÀ
 *
pTab
,

88588 
iCur
,

88589 
iRowid
,

88590 
cou¡
,

88591 
Triggî
 *
pTriggî
,

88592 
⁄c⁄f


88594 
Vdbe
 *
v
 = 
pP¨£
->
pVdbe
;

88595 
iOld
 = 0;

88596 
iLabñ
;

88599 
	`as£π
–
v
 );

88604 
iLabñ
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

88605 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_NŸExi°s
, 
iCur
, 
iLabñ
, 
iRowid
);

88609 if–
	`sqlôe3FkRequúed
(
pP¨£
, 
pTab
, 0, 0Ë|| 
pTriggî
 ){

88610 
u32
 
mask
;

88611 
iCﬁ
;

88615 
mask
 = 
	`sqlôe3TriggîCﬁmask
(

88616 
pP¨£
, 
pTriggî
, 0, 0, 
TRIGGER_BEFORE
|
TRIGGER_AFTER
, 
pTab
, 
⁄c⁄f


88618 
mask
 |
	`sqlôe3FkOldmask
(
pP¨£
, 
pTab
);

88619 
iOld
 = 
pP¨£
->
nMem
+1;

88620 
pP¨£
->
nMem
 +(1 + 
pTab
->
nCﬁ
);

88624 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_C›y
, 
iRowid
, 
iOld
);

88625 
iCﬁ
=0; iCﬁ<
pTab
->
nCﬁ
; iCol++){

88626 if–
mask
==0xfffffff‡|| mask&(1<<
iCﬁ
) ){

88627 
	`sqlôe3Ex¥CodeGëCﬁumnOfTabÀ
(
v
, 
pTab
, 
iCur
, 
iCﬁ
, 
iOld
+iCol+1);

88632 
	`sqlôe3CodeRowTriggî
(
pP¨£
, 
pTriggî
,

88633 
TK_DELETE
, 0, 
TRIGGER_BEFORE
, 
pTab
, 
iOld
, 
⁄c⁄f
, 
iLabñ


88640 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_NŸExi°s
, 
iCur
, 
iLabñ
, 
iRowid
);

88645 
	`sqlôe3FkCheck
(
pP¨£
, 
pTab
, 
iOld
, 0, 0, 0);

88651 if–
pTab
->
pSñe˘
==0 ){

88652 
	`sqlôe3Gíî©eRowIndexDñëe
(
pP¨£
, 
pTab
, 
iCur
, 0);

88653 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Dñëe
, 
iCur
, (
cou¡
?
OPFLAG_NCHANGE
:0));

88654 if–
cou¡
 ){

88655 
	`sqlôe3VdbeCh™geP4
(
v
, -1, 
pTab
->
zName
, 
P4_TRANSIENT
);

88662 
	`sqlôe3FkA˘i⁄s
(
pP¨£
, 
pTab
, 0, 
iOld
, 0, 0);

88665 
	`sqlôe3CodeRowTriggî
(
pP¨£
, 
pTriggî
,

88666 
TK_DELETE
, 0, 
TRIGGER_AFTER
, 
pTab
, 
iOld
, 
⁄c⁄f
, 
iLabñ


88672 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
iLabñ
);

88691 
SQLITE_PRIVATE
 
	`sqlôe3Gíî©eRowIndexDñëe
(

88692 
P¨£
 *
pP¨£
,

88693 
TabÀ
 *
pTab
,

88694 
iCur
,

88695 *
aRegIdx


88697 
i
;

88698 
Index
 *
pIdx
;

88699 
r1
;

88700 
iP¨tIdxLabñ
;

88701 
Vdbe
 *
v
 = 
pP¨£
->
pVdbe
;

88703 
i
=1, 
pIdx
=
pTab
->
pIndex
;ÖIdx; i++,ÖIdxıIdx->
pNext
){

88704 if–
aRegIdx
!=0 &&áRegIdx[
i
-1]==0 ) ;

88705 
r1
 = 
	`sqlôe3Gíî©eIndexKey
(
pP¨£
, 
pIdx
, 
iCur
, 0, 0, &
iP¨tIdxLabñ
);

88706 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_IdxDñëe
, 
iCur
+
i
, 
r1
, 
pIdx
->
nCﬁumn
+1);

88707 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
iP¨tIdxLabñ
);

88729 
SQLITE_PRIVATE
 
	`sqlôe3Gíî©eIndexKey
(

88730 
P¨£
 *
pP¨£
,

88731 
Index
 *
pIdx
,

88732 
iCur
,

88733 
ªgOut
,

88734 
doMakeRec
,

88735 *
piP¨tIdxLabñ


88737 
Vdbe
 *
v
 = 
pP¨£
->
pVdbe
;

88738 
j
;

88739 
TabÀ
 *
pTab
 = 
pIdx
->
pTabÀ
;

88740 
ªgBa£
;

88741 
nCﬁ
;

88743 if–
piP¨tIdxLabñ
 ){

88744 if–
pIdx
->
pP¨tIdxWhîe
 ){

88745 *
piP¨tIdxLabñ
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

88746 
pP¨£
->
iP¨tIdxTab
 = 
iCur
;

88747 
	`sqlôe3Ex¥IfFÆ£
(
pP¨£
, 
pIdx
->
pP¨tIdxWhîe
, *
piP¨tIdxLabñ
,

88748 
SQLITE_JUMPIFNULL
);

88750 *
piP¨tIdxLabñ
 = 0;

88753 
nCﬁ
 = 
pIdx
->
nCﬁumn
;

88754 
ªgBa£
 = 
	`sqlôe3GëTempR™ge
(
pP¨£
, 
nCﬁ
+1);

88755 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Rowid
, 
iCur
, 
ªgBa£
+
nCﬁ
);

88756 
j
=0; j<
nCﬁ
; j++){

88757 
idx
 = 
pIdx
->
aiCﬁumn
[
j
];

88758 if–
idx
==
pTab
->
iPKey
 ){

88759 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_SC›y
, 
ªgBa£
+
nCﬁ
,ÑegBa£+
j
);

88761 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Cﬁumn
, 
iCur
, 
idx
, 
ªgBa£
+
j
);

88762 
	`sqlôe3CﬁumnDeÁu…
(
v
, 
pTab
, 
idx
, -1);

88765 if–
doMakeRec
 ){

88766 c⁄° *
zAff
;

88767 if–
pTab
->
pSñe˘


88768 || 
	`O±imiz©i⁄DißbÀd
(
pP¨£
->
db
, 
SQLITE_IdxRólAsI¡
)

88770 
zAff
 = 0;

88772 
zAff
 = 
	`sqlôe3IndexAfföôySå
(
v
, 
pIdx
);

88774 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_MakeRec‹d
, 
ªgBa£
, 
nCﬁ
+1, 
ªgOut
);

88775 
	`sqlôe3VdbeCh™geP4
(
v
, -1, 
zAff
, 
P4_TRANSIENT
);

88777 
	`sqlôe3Rñó£TempR™ge
(
pP¨£
, 
ªgBa£
, 
nCﬁ
+1);

88778  
ªgBa£
;

88807 
CﬁlSeq
 *
	`sqlôe3GëFuncCﬁlSeq
(
sqlôe3_c⁄ãxt
 *
c⁄ãxt
){

88808  
c⁄ãxt
->
pCﬁl
;

88815 
	`sqlôe3SkùAccumuœt‹Lﬂd
(
sqlôe3_c⁄ãxt
 *
c⁄ãxt
){

88816 
c⁄ãxt
->
skùFœg
 = 1;

88822 
	`mömaxFunc
(

88823 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

88824 
¨gc
,

88825 
sqlôe3_vÆue
 **
¨gv


88827 
i
;

88828 
mask
;

88829 
iBe°
;

88830 
CﬁlSeq
 *
pCﬁl
;

88832 
	`as£π
–
¨gc
>1 );

88833 
mask
 = 
	`sqlôe3_u£r_d©a
(
c⁄ãxt
)==0 ? 0 : -1;

88834 
pCﬁl
 = 
	`sqlôe3GëFuncCﬁlSeq
(
c⁄ãxt
);

88835 
	`as£π
–
pCﬁl
 );

88836 
	`as£π
–
mask
==-1 || mask==0 );

88837 
iBe°
 = 0;

88838 if–
	`sqlôe3_vÆue_ty≥
(
¨gv
[0])==
SQLITE_NULL
 ) ;

88839 
i
=1; i<
¨gc
; i++){

88840 if–
	`sqlôe3_vÆue_ty≥
(
¨gv
[
i
])==
SQLITE_NULL
 ) ;

88841 if–(
	`sqlôe3MemCom∑ª
(
¨gv
[
iBe°
],árgv[
i
], 
pCﬁl
)^
mask
)>=0 ){

88842 
	`ã°ˇ£
–
mask
==0 );

88843 
iBe°
 = 
i
;

88846 
	`sqlôe3_ªsu…_vÆue
(
c⁄ãxt
, 
¨gv
[
iBe°
]);

88852 
	`ty≥ofFunc
(

88853 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

88854 
NŸU£d
,

88855 
sqlôe3_vÆue
 **
¨gv


88857 c⁄° *
z
 = 0;

88858 
	`UNUSED_PARAMETER
(
NŸU£d
);

88859  
	`sqlôe3_vÆue_ty≥
(
¨gv
[0]) ){

88860 
SQLITE_INTEGER
: 
z
 = "integer"; ;

88861 
SQLITE_TEXT
: 
z
 = "text"; ;

88862 
SQLITE_FLOAT
: 
z
 = "real"; ;

88863 
SQLITE_BLOB
: 
z
 = "blob"; ;

88864 : 
z
 = "null"; ;

88866 
	`sqlôe3_ªsu…_ãxt
(
c⁄ãxt
, 
z
, -1, 
SQLITE_STATIC
);

88873 
	`ÀngthFunc
(

88874 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

88875 
¨gc
,

88876 
sqlôe3_vÆue
 **
¨gv


88878 
Àn
;

88880 
	`as£π
–
¨gc
==1 );

88881 
	`UNUSED_PARAMETER
(
¨gc
);

88882  
	`sqlôe3_vÆue_ty≥
(
¨gv
[0]) ){

88883 
SQLITE_BLOB
:

88884 
SQLITE_INTEGER
:

88885 
SQLITE_FLOAT
: {

88886 
	`sqlôe3_ªsu…_öt
(
c⁄ãxt
, 
	`sqlôe3_vÆue_byãs
(
¨gv
[0]));

88889 
SQLITE_TEXT
: {

88890 c⁄° *
z
 = 
	`sqlôe3_vÆue_ãxt
(
¨gv
[0]);

88891 if–
z
==0 ) ;

88892 
Àn
 = 0;

88893  *
z
 ){

88894 
Àn
++;

88895 
	`SQLITE_SKIP_UTF8
(
z
);

88897 
	`sqlôe3_ªsu…_öt
(
c⁄ãxt
, 
Àn
);

88901 
	`sqlôe3_ªsu…_nuŒ
(
c⁄ãxt
);

88913 
	`absFunc
(
sqlôe3_c⁄ãxt
 *
c⁄ãxt
, 
¨gc
, 
sqlôe3_vÆue
 **
¨gv
){

88914 
	`as£π
–
¨gc
==1 );

88915 
	`UNUSED_PARAMETER
(
¨gc
);

88916  
	`sqlôe3_vÆue_ty≥
(
¨gv
[0]) ){

88917 
SQLITE_INTEGER
: {

88918 
i64
 
iVÆ
 = 
	`sqlôe3_vÆue_öt64
(
¨gv
[0]);

88919 if–
iVÆ
<0 ){

88920 if–(
iVÆ
<<1)==0 ){

88924 
	`sqlôe3_ªsu…_îr‹
(
c⁄ãxt
, "integer overflow", -1);

88927 
iVÆ
 = -iVal;

88929 
	`sqlôe3_ªsu…_öt64
(
c⁄ãxt
, 
iVÆ
);

88932 
SQLITE_NULL
: {

88934 
	`sqlôe3_ªsu…_nuŒ
(
c⁄ãxt
);

88943 
rVÆ
 = 
	`sqlôe3_vÆue_doubÀ
(
¨gv
[0]);

88944 if–
rVÆ
<0 )ÑVal = -rVal;

88945 
	`sqlôe3_ªsu…_doubÀ
(
c⁄ãxt
, 
rVÆ
);

88962 
	`ö°rFunc
(

88963 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

88964 
¨gc
,

88965 
sqlôe3_vÆue
 **
¨gv


88967 c⁄° *
zHay°ack
;

88968 c⁄° *
zNìdÀ
;

88969 
nHay°ack
;

88970 
nNìdÀ
;

88971 
ty≥Hay°ack
, 
ty≥NìdÀ
;

88972 
N
 = 1;

88973 
isText
;

88975 
	`UNUSED_PARAMETER
(
¨gc
);

88976 
ty≥Hay°ack
 = 
	`sqlôe3_vÆue_ty≥
(
¨gv
[0]);

88977 
ty≥NìdÀ
 = 
	`sqlôe3_vÆue_ty≥
(
¨gv
[1]);

88978 if–
ty≥Hay°ack
==
SQLITE_NULL
 || 
ty≥NìdÀ
==SQLITE_NULL ) ;

88979 
nHay°ack
 = 
	`sqlôe3_vÆue_byãs
(
¨gv
[0]);

88980 
nNìdÀ
 = 
	`sqlôe3_vÆue_byãs
(
¨gv
[1]);

88981 if–
ty≥Hay°ack
==
SQLITE_BLOB
 && 
ty≥NìdÀ
==SQLITE_BLOB ){

88982 
zHay°ack
 = 
	`sqlôe3_vÆue_blob
(
¨gv
[0]);

88983 
zNìdÀ
 = 
	`sqlôe3_vÆue_blob
(
¨gv
[1]);

88984 
isText
 = 0;

88986 
zHay°ack
 = 
	`sqlôe3_vÆue_ãxt
(
¨gv
[0]);

88987 
zNìdÀ
 = 
	`sqlôe3_vÆue_ãxt
(
¨gv
[1]);

88988 
isText
 = 1;

88990  
nNìdÀ
<=
nHay°ack
 && 
	`memcmp
(
zHay°ack
, 
zNìdÀ
,ÇNeedle)!=0 ){

88991 
N
++;

88993 
nHay°ack
--;

88994 
zHay°ack
++;

88995 } 
isText
 && (
zHay°ack
[0]&0xc0)==0x80 );

88997 if–
nNìdÀ
>
nHay°ack
 ) 
N
 = 0;

88998 
	`sqlôe3_ªsu…_öt
(
c⁄ãxt
, 
N
);

89013 
	`sub°rFunc
(

89014 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

89015 
¨gc
,

89016 
sqlôe3_vÆue
 **
¨gv


89018 c⁄° *
z
;

89019 c⁄° *
z2
;

89020 
Àn
;

89021 
p0ty≥
;

89022 
i64
 
p1
, 
p2
;

89023 
√gP2
 = 0;

89025 
	`as£π
–
¨gc
==3 ||árgc==2 );

89026 if–
	`sqlôe3_vÆue_ty≥
(
¨gv
[1])==
SQLITE_NULL


89027 || (
¨gc
==3 && 
	`sqlôe3_vÆue_ty≥
(
¨gv
[2])==
SQLITE_NULL
)

89031 
p0ty≥
 = 
	`sqlôe3_vÆue_ty≥
(
¨gv
[0]);

89032 
p1
 = 
	`sqlôe3_vÆue_öt
(
¨gv
[1]);

89033 if–
p0ty≥
==
SQLITE_BLOB
 ){

89034 
Àn
 = 
	`sqlôe3_vÆue_byãs
(
¨gv
[0]);

89035 
z
 = 
	`sqlôe3_vÆue_blob
(
¨gv
[0]);

89036 if–
z
==0 ) ;

89037 
	`as£π
–
Àn
==
	`sqlôe3_vÆue_byãs
(
¨gv
[0]) );

89039 
z
 = 
	`sqlôe3_vÆue_ãxt
(
¨gv
[0]);

89040 if–
z
==0 ) ;

89041 
Àn
 = 0;

89042 if–
p1
<0 ){

89043 
z2
=
z
; *z2; 
Àn
++){

89044 
	`SQLITE_SKIP_UTF8
(
z2
);

89048 if–
¨gc
==3 ){

89049 
p2
 = 
	`sqlôe3_vÆue_öt
(
¨gv
[2]);

89050 if–
p2
<0 ){

89051 
p2
 = -p2;

89052 
√gP2
 = 1;

89055 
p2
 = 
	`sqlôe3_c⁄ãxt_db_h™dÀ
(
c⁄ãxt
)->
aLimô
[
SQLITE_LIMIT_LENGTH
];

89057 if–
p1
<0 ){

89058 
p1
 +
Àn
;

89059 if–
p1
<0 ){

89060 
p2
 +
p1
;

89061 if–
p2
<0 )Ö2 = 0;

89062 
p1
 = 0;

89064 }if–
p1
>0 ){

89065 
p1
--;

89066 }if–
p2
>0 ){

89067 
p2
--;

89069 if–
√gP2
 ){

89070 
p1
 -
p2
;

89071 if–
p1
<0 ){

89072 
p2
 +
p1
;

89073 
p1
 = 0;

89076 
	`as£π
–
p1
>=0 && 
p2
>=0 );

89077 if–
p0ty≥
!=
SQLITE_BLOB
 ){

89078  *
z
 && 
p1
 ){

89079 
	`SQLITE_SKIP_UTF8
(
z
);

89080 
p1
--;

89082 
z2
=
z
; *z2 && 
p2
;Ö2--){

89083 
	`SQLITE_SKIP_UTF8
(
z2
);

89085 
	`sqlôe3_ªsu…_ãxt
(
c⁄ãxt
, (*)
z
, ()(
z2
-z), 
SQLITE_TRANSIENT
);

89087 if–
p1
+
p2
>
Àn
 ){

89088 
p2
 = 
Àn
-
p1
;

89089 if–
p2
<0 )Ö2 = 0;

89091 
	`sqlôe3_ªsu…_blob
(
c⁄ãxt
, (*)&
z
[
p1
], ()
p2
, 
SQLITE_TRANSIENT
);

89098 #i‚de‡
SQLITE_OMIT_FLOATING_POINT


89099 
	`roundFunc
(
sqlôe3_c⁄ãxt
 *
c⁄ãxt
, 
¨gc
, 
sqlôe3_vÆue
 **
¨gv
){

89100 
n
 = 0;

89101 
r
;

89102 *
zBuf
;

89103 
	`as£π
–
¨gc
==1 ||árgc==2 );

89104 if–
¨gc
==2 ){

89105 if–
SQLITE_NULL
==
	`sqlôe3_vÆue_ty≥
(
¨gv
[1]) ) ;

89106 
n
 = 
	`sqlôe3_vÆue_öt
(
¨gv
[1]);

89107 if–
n
>30 )Ç = 30;

89108 if–
n
<0 )Ç = 0;

89110 if–
	`sqlôe3_vÆue_ty≥
(
¨gv
[0])==
SQLITE_NULL
 ) ;

89111 
r
 = 
	`sqlôe3_vÆue_doubÀ
(
¨gv
[0]);

89116 if–
n
==0 && 
r
>=0 &&Ñ<
LARGEST_INT64
-1 ){

89117 
r
 = ()((
sqlôe_öt64
)(r+0.5));

89118 }if–
n
==0 && 
r
<0 && (-r)<
LARGEST_INT64
-1 ){

89119 
r
 = -()((
sqlôe_öt64
)((-r)+0.5));

89121 
zBuf
 = 
	`sqlôe3_m¥ötf
("%.*f",
n
,
r
);

89122 if–
zBuf
==0 ){

89123 
	`sqlôe3_ªsu…_îr‹_nomem
(
c⁄ãxt
);

89126 
	`sqlôe3AtoF
(
zBuf
, &
r
, 
	`sqlôe3SåÀn30
(zBuf), 
SQLITE_UTF8
);

89127 
	`sqlôe3_‰ì
(
zBuf
);

89129 
	`sqlôe3_ªsu…_doubÀ
(
c⁄ãxt
, 
r
);

89140 *
	`c⁄ãxtMÆloc
(
sqlôe3_c⁄ãxt
 *
c⁄ãxt
, 
i64
 
nByã
){

89141 *
z
;

89142 
sqlôe3
 *
db
 = 
	`sqlôe3_c⁄ãxt_db_h™dÀ
(
c⁄ãxt
);

89143 
	`as£π
–
nByã
>0 );

89144 
	`ã°ˇ£
–
nByã
==
db
->
aLimô
[
SQLITE_LIMIT_LENGTH
] );

89145 
	`ã°ˇ£
–
nByã
==
db
->
aLimô
[
SQLITE_LIMIT_LENGTH
]+1 );

89146 if–
nByã
>
db
->
aLimô
[
SQLITE_LIMIT_LENGTH
] ){

89147 
	`sqlôe3_ªsu…_îr‹_toobig
(
c⁄ãxt
);

89148 
z
 = 0;

89150 
z
 = 
	`sqlôe3MÆloc
(()
nByã
);

89151 if–!
z
 ){

89152 
	`sqlôe3_ªsu…_îr‹_nomem
(
c⁄ãxt
);

89155  
z
;

89161 
	`uµîFunc
(
sqlôe3_c⁄ãxt
 *
c⁄ãxt
, 
¨gc
, 
sqlôe3_vÆue
 **
¨gv
){

89162 *
z1
;

89163 c⁄° *
z2
;

89164 
i
, 
n
;

89165 
	`UNUSED_PARAMETER
(
¨gc
);

89166 
z2
 = (*)
	`sqlôe3_vÆue_ãxt
(
¨gv
[0]);

89167 
n
 = 
	`sqlôe3_vÆue_byãs
(
¨gv
[0]);

89169 
	`as£π
–
z2
==(*)
	`sqlôe3_vÆue_ãxt
(
¨gv
[0]) );

89170 if–
z2
 ){

89171 
z1
 = 
	`c⁄ãxtMÆloc
(
c⁄ãxt
, ((
i64
)
n
)+1);

89172 if–
z1
 ){

89173 
i
=0; i<
n
; i++){

89174 
z1
[
i
] = ()
	`sqlôe3Touµî
(
z2
[i]);

89176 
	`sqlôe3_ªsu…_ãxt
(
c⁄ãxt
, 
z1
, 
n
, 
sqlôe3_‰ì
);

89180 
	`lowîFunc
(
sqlôe3_c⁄ãxt
 *
c⁄ãxt
, 
¨gc
, 
sqlôe3_vÆue
 **
¨gv
){

89181 *
z1
;

89182 c⁄° *
z2
;

89183 
i
, 
n
;

89184 
	`UNUSED_PARAMETER
(
¨gc
);

89185 
z2
 = (*)
	`sqlôe3_vÆue_ãxt
(
¨gv
[0]);

89186 
n
 = 
	`sqlôe3_vÆue_byãs
(
¨gv
[0]);

89188 
	`as£π
–
z2
==(*)
	`sqlôe3_vÆue_ãxt
(
¨gv
[0]) );

89189 if–
z2
 ){

89190 
z1
 = 
	`c⁄ãxtMÆloc
(
c⁄ãxt
, ((
i64
)
n
)+1);

89191 if–
z1
 ){

89192 
i
=0; i<
n
; i++){

89193 
z1
[
i
] = 
	`sqlôe3Tﬁowî
(
z2
[i]);

89195 
	`sqlôe3_ªsu…_ãxt
(
c⁄ãxt
, 
z1
, 
n
, 
sqlôe3_‰ì
);

89208 
	#no›Func
 
vîsi⁄Func


	)

89213 
	`øndomFunc
(

89214 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

89215 
NŸU£d
,

89216 
sqlôe3_vÆue
 **
NŸU£d2


89218 
sqlôe_öt64
 
r
;

89219 
	`UNUSED_PARAMETER2
(
NŸU£d
, 
NŸU£d2
);

89220 
	`sqlôe3_øndom√ss
((
r
), &r);

89221 if–
r
<0 ){

89230 
r
 = -‘ & 
LARGEST_INT64
);

89232 
	`sqlôe3_ªsu…_öt64
(
c⁄ãxt
, 
r
);

89239 
	`øndomBlob
(

89240 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

89241 
¨gc
,

89242 
sqlôe3_vÆue
 **
¨gv


89244 
n
;

89245 *
p
;

89246 
	`as£π
–
¨gc
==1 );

89247 
	`UNUSED_PARAMETER
(
¨gc
);

89248 
n
 = 
	`sqlôe3_vÆue_öt
(
¨gv
[0]);

89249 if–
n
<1 ){

89250 
n
 = 1;

89252 
p
 = 
	`c⁄ãxtMÆloc
(
c⁄ãxt
, 
n
);

89253 if–
p
 ){

89254 
	`sqlôe3_øndom√ss
(
n
, 
p
);

89255 
	`sqlôe3_ªsu…_blob
(
c⁄ãxt
, (*)
p
, 
n
, 
sqlôe3_‰ì
);

89263 
	`œ°_ö£π_rowid
(

89264 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

89265 
NŸU£d
,

89266 
sqlôe3_vÆue
 **
NŸU£d2


89268 
sqlôe3
 *
db
 = 
	`sqlôe3_c⁄ãxt_db_h™dÀ
(
c⁄ãxt
);

89269 
	`UNUSED_PARAMETER2
(
NŸU£d
, 
NŸU£d2
);

89273 
	`sqlôe3_ªsu…_öt64
(
c⁄ãxt
, 
	`sqlôe3_œ°_ö£π_rowid
(
db
));

89283 
	`ch™ges
(

89284 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

89285 
NŸU£d
,

89286 
sqlôe3_vÆue
 **
NŸU£d2


89288 
sqlôe3
 *
db
 = 
	`sqlôe3_c⁄ãxt_db_h™dÀ
(
c⁄ãxt
);

89289 
	`UNUSED_PARAMETER2
(
NŸU£d
, 
NŸU£d2
);

89290 
	`sqlôe3_ªsu…_öt
(
c⁄ãxt
, 
	`sqlôe3_ch™ges
(
db
));

89297 
	`tŸÆ_ch™ges
(

89298 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

89299 
NŸU£d
,

89300 
sqlôe3_vÆue
 **
NŸU£d2


89302 
sqlôe3
 *
db
 = 
	`sqlôe3_c⁄ãxt_db_h™dÀ
(
c⁄ãxt
);

89303 
	`UNUSED_PARAMETER2
(
NŸU£d
, 
NŸU£d2
);

89306 
	`sqlôe3_ªsu…_öt
(
c⁄ãxt
, 
	`sqlôe3_tŸÆ_ch™ges
(
db
));

89312 
	scom∑ªInfo
 {

89313 
u8
 
m©chAŒ
;

89314 
u8
 
m©chO√
;

89315 
u8
 
m©chSë
;

89316 
u8
 
noCa£
;

89325 #i‡
	`deföed
(
SQLITE_EBCDIC
)

89326 
	#sqlôe3Utf8Ród
(
A
Ë(*((*A)++))

	)

89327 
	#GlobUµîToLowî
(
A
ËA = 
sqlôe3UµîToLowî
[A]

	)

89329 
	#GlobUµîToLowî
(
A
Ëif–!((A)&~0x7fË){ A = 
sqlôe3UµîToLowî
[A]; }

	)

89332 c⁄° 
com∑ªInfo
 
globInfo
 = { '*', '?', '[', 0 };

89335 c⁄° 
com∑ªInfo
 
likeInfoN‹m
 = { '%', '_', 0, 1 };

89338 c⁄° 
com∑ªInfo
 
likeInfoA…
 = { '%', '_', 0, 0 };

89368 
	`∑âînCom∑ª
(

89369 c⁄° 
u8
 *
zP©ã∫
,

89370 c⁄° 
u8
 *
zSåög
,

89371 c⁄° 
com∑ªInfo
 *
pInfo
,

89372 
u32
 
esc


89374 
u32
 
c
, 
c2
;

89375 
övît
;

89376 
£í
;

89377 
u8
 
m©chO√
 = 
pInfo
->matchOne;

89378 
u8
 
m©chAŒ
 = 
pInfo
->matchAll;

89379 
u8
 
m©chSë
 = 
pInfo
->matchSet;

89380 
u8
 
noCa£
 = 
pInfo
->noCase;

89381 
¥evEsˇ≥
 = 0;

89383  (
c
 = 
	`sqlôe3Utf8Ród
(&
zP©ã∫
))!=0 ){

89384 if–
c
==
m©chAŒ
 && !
¥evEsˇ≥
 ){

89385  (
c
=
	`sqlôe3Utf8Ród
(&
zP©ã∫
)Ë=
m©chAŒ


89386 || 
c
 =
m©chO√
 ){

89387 if–
c
==
m©chO√
 && 
	`sqlôe3Utf8Ród
(&
zSåög
)==0 ){

89391 if–
c
==0 ){

89393 }if–
c
==
esc
 ){

89394 
c
 = 
	`sqlôe3Utf8Ród
(&
zP©ã∫
);

89395 if–
c
==0 ){

89398 }if–
c
==
m©chSë
 ){

89399 
	`as£π
–
esc
==0 );

89400 
	`as£π
–
m©chSë
<0x80 );

89401  *
zSåög
 && 
	`∑âînCom∑ª
(&
zP©ã∫
[-1],zSåög,
pInfo
,
esc
)==0 ){

89402 
	`SQLITE_SKIP_UTF8
(
zSåög
);

89404  *
zSåög
!=0;

89406  (
c2
 = 
	`sqlôe3Utf8Ród
(&
zSåög
))!=0 ){

89407 if–
noCa£
 ){

89408 
	`GlobUµîToLowî
(
c2
);

89409 
	`GlobUµîToLowî
(
c
);

89410  
c2
 !0 && c2 !
c
 ){

89411 
c2
 = 
	`sqlôe3Utf8Ród
(&
zSåög
);

89412 
	`GlobUµîToLowî
(
c2
);

89415  
c2
 !0 && c2 !
c
 ){

89416 
c2
 = 
	`sqlôe3Utf8Ród
(&
zSåög
);

89419 if–
c2
==0 )  0;

89420 if–
	`∑âînCom∑ª
(
zP©ã∫
,
zSåög
,
pInfo
,
esc
) )  1;

89423 }if–
c
==
m©chO√
 && !
¥evEsˇ≥
 ){

89424 if–
	`sqlôe3Utf8Ród
(&
zSåög
)==0 ){

89427 }if–
c
==
m©chSë
 ){

89428 
u32
 
¥i‹_c
 = 0;

89429 
	`as£π
–
esc
==0 );

89430 
£í
 = 0;

89431 
övît
 = 0;

89432 
c
 = 
	`sqlôe3Utf8Ród
(&
zSåög
);

89433 if–
c
==0 )  0;

89434 
c2
 = 
	`sqlôe3Utf8Ród
(&
zP©ã∫
);

89435 if–
c2
=='^' ){

89436 
övît
 = 1;

89437 
c2
 = 
	`sqlôe3Utf8Ród
(&
zP©ã∫
);

89439 if–
c2
==']' ){

89440 if–
c
==']' ) 
£í
 = 1;

89441 
c2
 = 
	`sqlôe3Utf8Ród
(&
zP©ã∫
);

89443  
c2
 && c2!=']' ){

89444 if–
c2
=='-' && 
zP©ã∫
[0]!=']' && zP©ã∫[0]!=0 && 
¥i‹_c
>0 ){

89445 
c2
 = 
	`sqlôe3Utf8Ród
(&
zP©ã∫
);

89446 if–
c
>=
¥i‹_c
 && c<=
c2
 ) 
£í
 = 1;

89447 
¥i‹_c
 = 0;

89449 if–
c
==
c2
 ){

89450 
£í
 = 1;

89452 
¥i‹_c
 = 
c2
;

89454 
c2
 = 
	`sqlôe3Utf8Ród
(&
zP©ã∫
);

89456 if–
c2
==0 || (
£í
 ^ 
övît
)==0 ){

89459 }if–
esc
==
c
 && !
¥evEsˇ≥
 ){

89460 
¥evEsˇ≥
 = 1;

89462 
c2
 = 
	`sqlôe3Utf8Ród
(&
zSåög
);

89463 if–
noCa£
 ){

89464 
	`GlobUµîToLowî
(
c
);

89465 
	`GlobUµîToLowî
(
c2
);

89467 if–
c
!=
c2
 ){

89470 
¥evEsˇ≥
 = 0;

89473  *
zSåög
==0;

89479 
SQLITE_API
 
	`sqlôe3_°rglob
(c⁄° *
zGlobP©ã∫
, c⁄° *
zSåög
){

89480  
	`∑âînCom∑ª
((
u8
*)
zGlobP©ã∫
, (u8*)
zSåög
, &
globInfo
, 0)==0;

89488 #ifde‡
SQLITE_TEST


89489 
SQLITE_API
 
sqlôe3_like_cou¡
 = 0;

89505 
	`likeFunc
(

89506 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

89507 
¨gc
,

89508 
sqlôe3_vÆue
 **
¨gv


89510 c⁄° *
zA
, *
zB
;

89511 
u32
 
esˇ≥
 = 0;

89512 
nP©
;

89513 
sqlôe3
 *
db
 = 
	`sqlôe3_c⁄ãxt_db_h™dÀ
(
c⁄ãxt
);

89515 
zB
 = 
	`sqlôe3_vÆue_ãxt
(
¨gv
[0]);

89516 
zA
 = 
	`sqlôe3_vÆue_ãxt
(
¨gv
[1]);

89521 
nP©
 = 
	`sqlôe3_vÆue_byãs
(
¨gv
[0]);

89522 
	`ã°ˇ£
–
nP©
==
db
->
aLimô
[
SQLITE_LIMIT_LIKE_PATTERN_LENGTH
] );

89523 
	`ã°ˇ£
–
nP©
==
db
->
aLimô
[
SQLITE_LIMIT_LIKE_PATTERN_LENGTH
]+1 );

89524 if–
nP©
 > 
db
->
aLimô
[
SQLITE_LIMIT_LIKE_PATTERN_LENGTH
] ){

89525 
	`sqlôe3_ªsu…_îr‹
(
c⁄ãxt
, "LIKE or GLOBÖatternÅoo complex", -1);

89528 
	`as£π
–
zB
==
	`sqlôe3_vÆue_ãxt
(
¨gv
[0]) );

89530 if–
¨gc
==3 ){

89534 c⁄° *
zEsc
 = 
	`sqlôe3_vÆue_ãxt
(
¨gv
[2]);

89535 if–
zEsc
==0 ) ;

89536 if–
	`sqlôe3Utf8Ch¨Lí
((*)
zEsc
, -1)!=1 ){

89537 
	`sqlôe3_ªsu…_îr‹
(
c⁄ãxt
,

89541 
esˇ≥
 = 
	`sqlôe3Utf8Ród
(&
zEsc
);

89543 if–
zA
 && 
zB
 ){

89544 
com∑ªInfo
 *
pInfo
 = 
	`sqlôe3_u£r_d©a
(
c⁄ãxt
);

89545 #ifde‡
SQLITE_TEST


89546 
sqlôe3_like_cou¡
++;

89549 
	`sqlôe3_ªsu…_öt
(
c⁄ãxt
, 
	`∑âînCom∑ª
(
zB
, 
zA
, 
pInfo
, 
esˇ≥
));

89558 
	`nuŒifFunc
(

89559 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

89560 
NŸU£d
,

89561 
sqlôe3_vÆue
 **
¨gv


89563 
CﬁlSeq
 *
pCﬁl
 = 
	`sqlôe3GëFuncCﬁlSeq
(
c⁄ãxt
);

89564 
	`UNUSED_PARAMETER
(
NŸU£d
);

89565 if–
	`sqlôe3MemCom∑ª
(
¨gv
[0],árgv[1], 
pCﬁl
)!=0 ){

89566 
	`sqlôe3_ªsu…_vÆue
(
c⁄ãxt
, 
¨gv
[0]);

89574 
	`vîsi⁄Func
(

89575 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

89576 
NŸU£d
,

89577 
sqlôe3_vÆue
 **
NŸU£d2


89579 
	`UNUSED_PARAMETER2
(
NŸU£d
, 
NŸU£d2
);

89582 
	`sqlôe3_ªsu…_ãxt
(
c⁄ãxt
, 
	`sqlôe3_libvîsi⁄
(), -1, 
SQLITE_STATIC
);

89590 
	`sour˚idFunc
(

89591 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

89592 
NŸU£d
,

89593 
sqlôe3_vÆue
 **
NŸU£d2


89595 
	`UNUSED_PARAMETER2
(
NŸU£d
, 
NŸU£d2
);

89598 
	`sqlôe3_ªsu…_ãxt
(
c⁄ãxt
, 
	`sqlôe3_sour˚id
(), -1, 
SQLITE_STATIC
);

89606 
	`îæogFunc
(

89607 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

89608 
¨gc
,

89609 
sqlôe3_vÆue
 **
¨gv


89611 
	`UNUSED_PARAMETER
(
¨gc
);

89612 
	`UNUSED_PARAMETER
(
c⁄ãxt
);

89613 
	`sqlôe3_log
(
	`sqlôe3_vÆue_öt
(
¨gv
[0]), "%s", 
	`sqlôe3_vÆue_ãxt
(argv[1]));

89621 #i‚de‡
SQLITE_OMIT_COMPILEOPTION_DIAGS


89622 
	`compûe›ti⁄u£dFunc
(

89623 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

89624 
¨gc
,

89625 
sqlôe3_vÆue
 **
¨gv


89627 c⁄° *
zO±Name
;

89628 
	`as£π
–
¨gc
==1 );

89629 
	`UNUSED_PARAMETER
(
¨gc
);

89634 if–(
zO±Name
 = (c⁄° *)
	`sqlôe3_vÆue_ãxt
(
¨gv
[0]))!=0 ){

89635 
	`sqlôe3_ªsu…_öt
(
c⁄ãxt
, 
	`sqlôe3_compûe›ti⁄_u£d
(
zO±Name
));

89645 #i‚de‡
SQLITE_OMIT_COMPILEOPTION_DIAGS


89646 
	`compûe›ti⁄gëFunc
(

89647 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

89648 
¨gc
,

89649 
sqlôe3_vÆue
 **
¨gv


89651 
n
;

89652 
	`as£π
–
¨gc
==1 );

89653 
	`UNUSED_PARAMETER
(
¨gc
);

89657 
n
 = 
	`sqlôe3_vÆue_öt
(
¨gv
[0]);

89658 
	`sqlôe3_ªsu…_ãxt
(
c⁄ãxt
, 
	`sqlôe3_compûe›ti⁄_gë
(
n
), -1, 
SQLITE_STATIC
);

89664 c⁄° 
hexdigôs
[] = {

89676 
	`quŸeFunc
(
sqlôe3_c⁄ãxt
 *
c⁄ãxt
, 
¨gc
, 
sqlôe3_vÆue
 **
¨gv
){

89677 
	`as£π
–
¨gc
==1 );

89678 
	`UNUSED_PARAMETER
(
¨gc
);

89679  
	`sqlôe3_vÆue_ty≥
(
¨gv
[0]) ){

89680 
SQLITE_FLOAT
: {

89681 
r1
, 
r2
;

89682 
zBuf
[50];

89683 
r1
 = 
	`sqlôe3_vÆue_doubÀ
(
¨gv
[0]);

89684 
	`sqlôe3_¢¥ötf
((
zBuf
), zBuf, "%!.15g", 
r1
);

89685 
	`sqlôe3AtoF
(
zBuf
, &
r2
, 20, 
SQLITE_UTF8
);

89686 if–
r1
!=
r2
 ){

89687 
	`sqlôe3_¢¥ötf
((
zBuf
), zBuf, "%!.20e", 
r1
);

89689 
	`sqlôe3_ªsu…_ãxt
(
c⁄ãxt
, 
zBuf
, -1, 
SQLITE_TRANSIENT
);

89692 
SQLITE_INTEGER
: {

89693 
	`sqlôe3_ªsu…_vÆue
(
c⁄ãxt
, 
¨gv
[0]);

89696 
SQLITE_BLOB
: {

89697 *
zText
 = 0;

89698 c⁄° *
zBlob
 = 
	`sqlôe3_vÆue_blob
(
¨gv
[0]);

89699 
nBlob
 = 
	`sqlôe3_vÆue_byãs
(
¨gv
[0]);

89700 
	`as£π
–
zBlob
==
	`sqlôe3_vÆue_blob
(
¨gv
[0]) );

89701 
zText
 = (*)
	`c⁄ãxtMÆloc
(
c⁄ãxt
, (2*(
i64
)
nBlob
)+4);

89702 if–
zText
 ){

89703 
i
;

89704 
i
=0; i<
nBlob
; i++){

89705 
zText
[(
i
*2)+2] = 
hexdigôs
[(
zBlob
[i]>>4)&0x0F];

89706 
zText
[(
i
*2)+3] = 
hexdigôs
[(
zBlob
[i])&0x0F];

89708 
zText
[(
nBlob
*2)+2] = '\'';

89709 
zText
[(
nBlob
*2)+3] = '\0';

89710 
zText
[0] = 'X';

89711 
zText
[1] = '\'';

89712 
	`sqlôe3_ªsu…_ãxt
(
c⁄ãxt
, 
zText
, -1, 
SQLITE_TRANSIENT
);

89713 
	`sqlôe3_‰ì
(
zText
);

89717 
SQLITE_TEXT
: {

89718 
i
,
j
;

89719 
u64
 
n
;

89720 c⁄° *
zArg
 = 
	`sqlôe3_vÆue_ãxt
(
¨gv
[0]);

89721 *
z
;

89723 if–
zArg
==0 ) ;

89724 
i
=0, 
n
=0; 
zArg
[i]; i++){ if( zArg[i]=='\'' )Ç++; }

89725 
z
 = 
	`c⁄ãxtMÆloc
(
c⁄ãxt
, ((
i64
)
i
)+((i64)
n
)+3);

89726 if–
z
 ){

89727 
z
[0] = '\'';

89728 
i
=0, 
j
=1; 
zArg
[i]; i++){

89729 
z
[
j
++] = 
zArg
[
i
];

89730 if–
zArg
[
i
]=='\'' ){

89731 
z
[
j
++] = '\'';

89734 
z
[
j
++] = '\'';

89735 
z
[
j
] = 0;

89736 
	`sqlôe3_ªsu…_ãxt
(
c⁄ãxt
, 
z
, 
j
, 
sqlôe3_‰ì
);

89741 
	`as£π
–
	`sqlôe3_vÆue_ty≥
(
¨gv
[0])==
SQLITE_NULL
 );

89742 
	`sqlôe3_ªsu…_ãxt
(
c⁄ãxt
, "NULL", 4, 
SQLITE_STATIC
);

89752 
	`unicodeFunc
(

89753 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

89754 
¨gc
,

89755 
sqlôe3_vÆue
 **
¨gv


89757 c⁄° *
z
 = 
	`sqlôe3_vÆue_ãxt
(
¨gv
[0]);

89758 ()
¨gc
;

89759 if–
z
 && z[0] ) 
	`sqlôe3_ªsu…_öt
(
c⁄ãxt
, 
	`sqlôe3Utf8Ród
(&z));

89767 
	`ch¨Func
(

89768 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

89769 
¨gc
,

89770 
sqlôe3_vÆue
 **
¨gv


89772 *
z
, *
zOut
;

89773 
i
;

89774 
zOut
 = 
z
 = 
	`sqlôe3_mÆloc
–
¨gc
*4 );

89775 if–
z
==0 ){

89776 
	`sqlôe3_ªsu…_îr‹_nomem
(
c⁄ãxt
);

89779 
i
=0; i<
¨gc
; i++){

89780 
sqlôe3_öt64
 
x
;

89781 
c
;

89782 
x
 = 
	`sqlôe3_vÆue_öt64
(
¨gv
[
i
]);

89783 if–
x
<0 || x>0x10ffff ) x = 0xfffd;

89784 
c
 = ()(
x
 & 0x1fffff);

89785 if–
c
<0x00080 ){

89786 *
zOut
++ = (
u8
)(
c
&0xFF);

89787 }if–
c
<0x00800 ){

89788 *
zOut
++ = 0xC0 + (
u8
)((
c
>>6)&0x1F);

89789 *
zOut
++ = 0x80 + (
u8
)(
c
 & 0x3F);

89790 }if–
c
<0x10000 ){

89791 *
zOut
++ = 0xE0 + (
u8
)((
c
>>12)&0x0F);

89792 *
zOut
++ = 0x80 + (
u8
)((
c
>>6) & 0x3F);

89793 *
zOut
++ = 0x80 + (
u8
)(
c
 & 0x3F);

89795 *
zOut
++ = 0xF0 + (
u8
)((
c
>>18) & 0x07);

89796 *
zOut
++ = 0x80 + (
u8
)((
c
>>12) & 0x3F);

89797 *
zOut
++ = 0x80 + (
u8
)((
c
>>6) & 0x3F);

89798 *
zOut
++ = 0x80 + (
u8
)(
c
 & 0x3F);

89801 
	`sqlôe3_ªsu…_ãxt
(
c⁄ãxt
, (*)
z
, ()(
zOut
-z), 
sqlôe3_‰ì
);

89808 
	`hexFunc
(

89809 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

89810 
¨gc
,

89811 
sqlôe3_vÆue
 **
¨gv


89813 
i
, 
n
;

89814 c⁄° *
pBlob
;

89815 *
zHex
, *
z
;

89816 
	`as£π
–
¨gc
==1 );

89817 
	`UNUSED_PARAMETER
(
¨gc
);

89818 
pBlob
 = 
	`sqlôe3_vÆue_blob
(
¨gv
[0]);

89819 
n
 = 
	`sqlôe3_vÆue_byãs
(
¨gv
[0]);

89820 
	`as£π
–
pBlob
==
	`sqlôe3_vÆue_blob
(
¨gv
[0]) );

89821 
z
 = 
zHex
 = 
	`c⁄ãxtMÆloc
(
c⁄ãxt
, ((
i64
)
n
)*2 + 1);

89822 if–
zHex
 ){

89823 
i
=0; i<
n
; i++, 
pBlob
++){

89824 
c
 = *
pBlob
;

89825 *(
z
++Ë
hexdigôs
[(
c
>>4)&0xf];

89826 *(
z
++Ë
hexdigôs
[
c
&0xf];

89828 *
z
 = 0;

89829 
	`sqlôe3_ªsu…_ãxt
(
c⁄ãxt
, 
zHex
, 
n
*2, 
sqlôe3_‰ì
);

89836 
	`zîoblobFunc
(

89837 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

89838 
¨gc
,

89839 
sqlôe3_vÆue
 **
¨gv


89841 
i64
 
n
;

89842 
sqlôe3
 *
db
 = 
	`sqlôe3_c⁄ãxt_db_h™dÀ
(
c⁄ãxt
);

89843 
	`as£π
–
¨gc
==1 );

89844 
	`UNUSED_PARAMETER
(
¨gc
);

89845 
n
 = 
	`sqlôe3_vÆue_öt64
(
¨gv
[0]);

89846 
	`ã°ˇ£
–
n
==
db
->
aLimô
[
SQLITE_LIMIT_LENGTH
] );

89847 
	`ã°ˇ£
–
n
==
db
->
aLimô
[
SQLITE_LIMIT_LENGTH
]+1 );

89848 if–
n
>
db
->
aLimô
[
SQLITE_LIMIT_LENGTH
] ){

89849 
	`sqlôe3_ªsu…_îr‹_toobig
(
c⁄ãxt
);

89851 
	`sqlôe3_ªsu…_zîoblob
(
c⁄ãxt
, ()
n
);

89861 
	`ª∂a˚Func
(

89862 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

89863 
¨gc
,

89864 
sqlôe3_vÆue
 **
¨gv


89866 c⁄° *
zSå
;

89867 c⁄° *
zP©ã∫
;

89868 c⁄° *
zRï
;

89869 *
zOut
;

89870 
nSå
;

89871 
nP©ã∫
;

89872 
nRï
;

89873 
i64
 
nOut
;

89874 
lo›Limô
;

89875 
i
, 
j
;

89877 
	`as£π
–
¨gc
==3 );

89878 
	`UNUSED_PARAMETER
(
¨gc
);

89879 
zSå
 = 
	`sqlôe3_vÆue_ãxt
(
¨gv
[0]);

89880 if–
zSå
==0 ) ;

89881 
nSå
 = 
	`sqlôe3_vÆue_byãs
(
¨gv
[0]);

89882 
	`as£π
–
zSå
==
	`sqlôe3_vÆue_ãxt
(
¨gv
[0]) );

89883 
zP©ã∫
 = 
	`sqlôe3_vÆue_ãxt
(
¨gv
[1]);

89884 if–
zP©ã∫
==0 ){

89885 
	`as£π
–
	`sqlôe3_vÆue_ty≥
(
¨gv
[1])==
SQLITE_NULL


89886 || 
	`sqlôe3_c⁄ãxt_db_h™dÀ
(
c⁄ãxt
)->
mÆlocFaûed
 );

89889 if–
zP©ã∫
[0]==0 ){

89890 
	`as£π
–
	`sqlôe3_vÆue_ty≥
(
¨gv
[1])!=
SQLITE_NULL
 );

89891 
	`sqlôe3_ªsu…_vÆue
(
c⁄ãxt
, 
¨gv
[0]);

89894 
nP©ã∫
 = 
	`sqlôe3_vÆue_byãs
(
¨gv
[1]);

89895 
	`as£π
–
zP©ã∫
==
	`sqlôe3_vÆue_ãxt
(
¨gv
[1]) );

89896 
zRï
 = 
	`sqlôe3_vÆue_ãxt
(
¨gv
[2]);

89897 if–
zRï
==0 ) ;

89898 
nRï
 = 
	`sqlôe3_vÆue_byãs
(
¨gv
[2]);

89899 
	`as£π
–
zRï
==
	`sqlôe3_vÆue_ãxt
(
¨gv
[2]) );

89900 
nOut
 = 
nSå
 + 1;

89901 
	`as£π
–
nOut
<
SQLITE_MAX_LENGTH
 );

89902 
zOut
 = 
	`c⁄ãxtMÆloc
(
c⁄ãxt
, (
i64
)
nOut
);

89903 if–
zOut
==0 ){

89906 
lo›Limô
 = 
nSå
 - 
nP©ã∫
;

89907 
i
=
j
=0; i<=
lo›Limô
; i++){

89908 if–
zSå
[
i
]!=
zP©ã∫
[0] || 
	`memcmp
(&zSå[i], zP©ã∫, 
nP©ã∫
) ){

89909 
zOut
[
j
++] = 
zSå
[
i
];

89911 
u8
 *
zOld
;

89912 
sqlôe3
 *
db
 = 
	`sqlôe3_c⁄ãxt_db_h™dÀ
(
c⁄ãxt
);

89913 
nOut
 +
nRï
 - 
nP©ã∫
;

89914 
	`ã°ˇ£
–
nOut
-1==
db
->
aLimô
[
SQLITE_LIMIT_LENGTH
] );

89915 
	`ã°ˇ£
–
nOut
-2==
db
->
aLimô
[
SQLITE_LIMIT_LENGTH
] );

89916 if–
nOut
-1>
db
->
aLimô
[
SQLITE_LIMIT_LENGTH
] ){

89917 
	`sqlôe3_ªsu…_îr‹_toobig
(
c⁄ãxt
);

89918 
	`sqlôe3_‰ì
(
zOut
);

89921 
zOld
 = 
zOut
;

89922 
zOut
 = 
	`sqlôe3_ªÆloc
(zOut, ()
nOut
);

89923 if–
zOut
==0 ){

89924 
	`sqlôe3_ªsu…_îr‹_nomem
(
c⁄ãxt
);

89925 
	`sqlôe3_‰ì
(
zOld
);

89928 
	`mem˝y
(&
zOut
[
j
], 
zRï
, 
nRï
);

89929 
j
 +
nRï
;

89930 
i
 +
nP©ã∫
-1;

89933 
	`as£π
–
j
+
nSå
-
i
+1==
nOut
 );

89934 
	`mem˝y
(&
zOut
[
j
], &
zSå
[
i
], 
nSå
-i);

89935 
j
 +
nSå
 - 
i
;

89936 
	`as£π
–
j
<=
nOut
 );

89937 
zOut
[
j
] = 0;

89938 
	`sqlôe3_ªsu…_ãxt
(
c⁄ãxt
, (*)
zOut
, 
j
, 
sqlôe3_‰ì
);

89945 
	`åimFunc
(

89946 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

89947 
¨gc
,

89948 
sqlôe3_vÆue
 **
¨gv


89950 c⁄° *
zIn
;

89951 c⁄° *
zCh¨Së
;

89952 
nIn
;

89953 
Êags
;

89954 
i
;

89955 *
aLí
 = 0;

89956 **
azCh¨
 = 0;

89957 
nCh¨
;

89959 if–
	`sqlôe3_vÆue_ty≥
(
¨gv
[0])==
SQLITE_NULL
 ){

89962 
zIn
 = 
	`sqlôe3_vÆue_ãxt
(
¨gv
[0]);

89963 if–
zIn
==0 ) ;

89964 
nIn
 = 
	`sqlôe3_vÆue_byãs
(
¨gv
[0]);

89965 
	`as£π
–
zIn
==
	`sqlôe3_vÆue_ãxt
(
¨gv
[0]) );

89966 if–
¨gc
==1 ){

89967 c⁄° 
ÀnO√
[] = { 1 };

89968 * c⁄° 
azO√
[] = { (
u8
*)" " };

89969 
nCh¨
 = 1;

89970 
aLí
 = (
u8
*)
ÀnO√
;

89971 
azCh¨
 = (**)
azO√
;

89972 
zCh¨Së
 = 0;

89973 }if–(
zCh¨Së
 = 
	`sqlôe3_vÆue_ãxt
(
¨gv
[1]))==0 ){

89976 c⁄° *
z
;

89977 
z
=
zCh¨Së
, 
nCh¨
=0; *z;ÇChar++){

89978 
	`SQLITE_SKIP_UTF8
(
z
);

89980 if–
nCh¨
>0 ){

89981 
azCh¨
 = 
	`c⁄ãxtMÆloc
(
c⁄ãxt
, ((
i64
)
nCh¨
)*((*)+1));

89982 if–
azCh¨
==0 ){

89985 
aLí
 = (*)&
azCh¨
[
nCh¨
];

89986 
z
=
zCh¨Së
, 
nCh¨
=0; *z;ÇChar++){

89987 
azCh¨
[
nCh¨
] = (*)
z
;

89988 
	`SQLITE_SKIP_UTF8
(
z
);

89989 
aLí
[
nCh¨
] = (
u8
)(
z
 - 
azCh¨
[nChar]);

89993 if–
nCh¨
>0 ){

89994 
Êags
 = 
	`SQLITE_PTR_TO_INT
(
	`sqlôe3_u£r_d©a
(
c⁄ãxt
));

89995 if–
Êags
 & 1 ){

89996  
nIn
>0 ){

89997 
Àn
 = 0;

89998 
i
=0; i<
nCh¨
; i++){

89999 
Àn
 = 
aLí
[
i
];

90000 if–
Àn
<=
nIn
 && 
	`memcmp
(
zIn
, 
azCh¨
[
i
],Üen)==0 ) ;

90002 if–
i
>=
nCh¨
 ) ;

90003 
zIn
 +
Àn
;

90004 
nIn
 -
Àn
;

90007 if–
Êags
 & 2 ){

90008  
nIn
>0 ){

90009 
Àn
 = 0;

90010 
i
=0; i<
nCh¨
; i++){

90011 
Àn
 = 
aLí
[
i
];

90012 if–
Àn
<=
nIn
 && 
	`memcmp
(&
zIn
[nIn-Àn],
azCh¨
[
i
],len)==0 ) ;

90014 if–
i
>=
nCh¨
 ) ;

90015 
nIn
 -
Àn
;

90018 if–
zCh¨Së
 ){

90019 
	`sqlôe3_‰ì
(
azCh¨
);

90022 
	`sqlôe3_ªsu…_ãxt
(
c⁄ãxt
, (*)
zIn
, 
nIn
, 
SQLITE_TRANSIENT
);

90030 #ifde‡
SQLITE_SOUNDEX


90037 
	`soundexFunc
(

90038 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

90039 
¨gc
,

90040 
sqlôe3_vÆue
 **
¨gv


90042 
zResu…
[8];

90043 c⁄° 
u8
 *
zIn
;

90044 
i
, 
j
;

90045 c⁄° 
iCode
[] = {

90055 
	`as£π
–
¨gc
==1 );

90056 
zIn
 = (
u8
*)
	`sqlôe3_vÆue_ãxt
(
¨gv
[0]);

90057 if–
zIn
==0 ) zI¿(
u8
*)"";

90058 
i
=0; 
zIn
[i] && !
	`sqlôe3IßÕha
(zIn[i]); i++){}

90059 if–
zIn
[
i
] ){

90060 
u8
 
¥evcode
 = 
iCode
[
zIn
[
i
]&0x7f];

90061 
zResu…
[0] = 
	`sqlôe3Touµî
(
zIn
[
i
]);

90062 
j
=1; j<4 && 
zIn
[
i
]; i++){

90063 
code
 = 
iCode
[
zIn
[
i
]&0x7f];

90064 if–
code
>0 ){

90065 if–
code
!=
¥evcode
 ){

90066 
¥evcode
 = 
code
;

90067 
zResu…
[
j
++] = 
code
 + '0';

90070 
¥evcode
 = 0;

90073  
j
<4 ){

90074 
zResu…
[
j
++] = '0';

90076 
zResu…
[
j
] = 0;

90077 
	`sqlôe3_ªsu…_ãxt
(
c⁄ãxt
, 
zResu…
, 4, 
SQLITE_TRANSIENT
);

90081 
	`sqlôe3_ªsu…_ãxt
(
c⁄ãxt
, "?000", 4, 
SQLITE_STATIC
);

90086 #i‚de‡
SQLITE_OMIT_LOAD_EXTENSION


90090 
	`lﬂdExt
(
sqlôe3_c⁄ãxt
 *
c⁄ãxt
, 
¨gc
, 
sqlôe3_vÆue
 **
¨gv
){

90091 c⁄° *
zFûe
 = (c⁄° *)
	`sqlôe3_vÆue_ãxt
(
¨gv
[0]);

90092 c⁄° *
zProc
;

90093 
sqlôe3
 *
db
 = 
	`sqlôe3_c⁄ãxt_db_h™dÀ
(
c⁄ãxt
);

90094 *
zEºMsg
 = 0;

90096 if–
¨gc
==2 ){

90097 
zProc
 = (c⁄° *)
	`sqlôe3_vÆue_ãxt
(
¨gv
[1]);

90099 
zProc
 = 0;

90101 if–
zFûe
 && 
	`sqlôe3_lﬂd_exãnsi⁄
(
db
, zFûe, 
zProc
, &
zEºMsg
) ){

90102 
	`sqlôe3_ªsu…_îr‹
(
c⁄ãxt
, 
zEºMsg
, -1);

90103 
	`sqlôe3_‰ì
(
zEºMsg
);

90113 
SumCtx
 
	tSumCtx
;

90114 
	sSumCtx
 {

90115 
rSum
;

90116 
i64
 
iSum
;

90117 
i64
 
˙t
;

90118 
u8
 
ovîÊow
;

90119 
u8
 
≠¥ox
;

90132 
	`sumSãp
(
sqlôe3_c⁄ãxt
 *
c⁄ãxt
, 
¨gc
, 
sqlôe3_vÆue
 **
¨gv
){

90133 
SumCtx
 *
p
;

90134 
ty≥
;

90135 
	`as£π
–
¨gc
==1 );

90136 
	`UNUSED_PARAMETER
(
¨gc
);

90137 
p
 = 
	`sqlôe3_aggªg©e_c⁄ãxt
(
c⁄ãxt
, (*p));

90138 
ty≥
 = 
	`sqlôe3_vÆue_numîic_ty≥
(
¨gv
[0]);

90139 if–
p
 && 
ty≥
!=
SQLITE_NULL
 ){

90140 
p
->
˙t
++;

90141 if–
ty≥
==
SQLITE_INTEGER
 ){

90142 
i64
 
v
 = 
	`sqlôe3_vÆue_öt64
(
¨gv
[0]);

90143 
p
->
rSum
 +
v
;

90144 if–(
p
->
≠¥ox
|p->
ovîÊow
)==0 && 
	`sqlôe3AddI¡64
(&p->
iSum
, 
v
) ){

90145 
p
->
ovîÊow
 = 1;

90148 
p
->
rSum
 +
	`sqlôe3_vÆue_doubÀ
(
¨gv
[0]);

90149 
p
->
≠¥ox
 = 1;

90153 
	`sumFöÆize
(
sqlôe3_c⁄ãxt
 *
c⁄ãxt
){

90154 
SumCtx
 *
p
;

90155 
p
 = 
	`sqlôe3_aggªg©e_c⁄ãxt
(
c⁄ãxt
, 0);

90156 if–
p
 &&Ö->
˙t
>0 ){

90157 if–
p
->
ovîÊow
 ){

90158 
	`sqlôe3_ªsu…_îr‹
(
c⁄ãxt
,"integer overflow",-1);

90159 }if–
p
->
≠¥ox
 ){

90160 
	`sqlôe3_ªsu…_doubÀ
(
c⁄ãxt
, 
p
->
rSum
);

90162 
	`sqlôe3_ªsu…_öt64
(
c⁄ãxt
, 
p
->
iSum
);

90166 
	`avgFöÆize
(
sqlôe3_c⁄ãxt
 *
c⁄ãxt
){

90167 
SumCtx
 *
p
;

90168 
p
 = 
	`sqlôe3_aggªg©e_c⁄ãxt
(
c⁄ãxt
, 0);

90169 if–
p
 &&Ö->
˙t
>0 ){

90170 
	`sqlôe3_ªsu…_doubÀ
(
c⁄ãxt
, 
p
->
rSum
/(Ì->
˙t
);

90173 
	`tŸÆFöÆize
(
sqlôe3_c⁄ãxt
 *
c⁄ãxt
){

90174 
SumCtx
 *
p
;

90175 
p
 = 
	`sqlôe3_aggªg©e_c⁄ãxt
(
c⁄ãxt
, 0);

90177 
	`sqlôe3_ªsu…_doubÀ
(
c⁄ãxt
, 
p
 ?Ö->
rSum
 : ()0);

90184 
Cou¡Ctx
 
	tCou¡Ctx
;

90185 
	sCou¡Ctx
 {

90186 
i64
 
n
;

90192 
	`cou¡Sãp
(
sqlôe3_c⁄ãxt
 *
c⁄ãxt
, 
¨gc
, 
sqlôe3_vÆue
 **
¨gv
){

90193 
Cou¡Ctx
 *
p
;

90194 
p
 = 
	`sqlôe3_aggªg©e_c⁄ãxt
(
c⁄ãxt
, (*p));

90195 if–(
¨gc
==0 || 
SQLITE_NULL
!=
	`sqlôe3_vÆue_ty≥
(
¨gv
[0])Ë&& 
p
 ){

90196 
p
->
n
++;

90199 #i‚de‡
SQLITE_OMIT_DEPRECATED


90204 
	`as£π
–
¨gc
==1 || 
p
==0 ||Ö->
n
>0x7fffffff

90205 || 
p
->
n
==
	`sqlôe3_aggªg©e_cou¡
(
c⁄ãxt
) );

90208 
	`cou¡FöÆize
(
sqlôe3_c⁄ãxt
 *
c⁄ãxt
){

90209 
Cou¡Ctx
 *
p
;

90210 
p
 = 
	`sqlôe3_aggªg©e_c⁄ãxt
(
c⁄ãxt
, 0);

90211 
	`sqlôe3_ªsu…_öt64
(
c⁄ãxt
, 
p
 ?Ö->
n
 : 0);

90217 
	`mömaxSãp
(

90218 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

90219 
NŸU£d
,

90220 
sqlôe3_vÆue
 **
¨gv


90222 
Mem
 *
pArg
 = (Mem *)
¨gv
[0];

90223 
Mem
 *
pBe°
;

90224 
	`UNUSED_PARAMETER
(
NŸU£d
);

90226 
pBe°
 = (
Mem
 *)
	`sqlôe3_aggªg©e_c⁄ãxt
(
c⁄ãxt
, (*pBest));

90227 if–!
pBe°
 ) ;

90229 if–
	`sqlôe3_vÆue_ty≥
(
¨gv
[0])==
SQLITE_NULL
 ){

90230 if–
pBe°
->
Êags
 ) 
	`sqlôe3SkùAccumuœt‹Lﬂd
(
c⁄ãxt
);

90231 }if–
pBe°
->
Êags
 ){

90232 
max
;

90233 
cmp
;

90234 
CﬁlSeq
 *
pCﬁl
 = 
	`sqlôe3GëFuncCﬁlSeq
(
c⁄ãxt
);

90243 
max
 = 
	`sqlôe3_u£r_d©a
(
c⁄ãxt
)!=0;

90244 
cmp
 = 
	`sqlôe3MemCom∑ª
(
pBe°
, 
pArg
, 
pCﬁl
);

90245 if–(
max
 && 
cmp
<0) || (!max && cmp>0) ){

90246 
	`sqlôe3VdbeMemC›y
(
pBe°
, 
pArg
);

90248 
	`sqlôe3SkùAccumuœt‹Lﬂd
(
c⁄ãxt
);

90251 
	`sqlôe3VdbeMemC›y
(
pBe°
, 
pArg
);

90254 
	`möMaxFöÆize
(
sqlôe3_c⁄ãxt
 *
c⁄ãxt
){

90255 
sqlôe3_vÆue
 *
pRes
;

90256 
pRes
 = (
sqlôe3_vÆue
 *)
	`sqlôe3_aggªg©e_c⁄ãxt
(
c⁄ãxt
, 0);

90257 if–
pRes
 ){

90258 if–
pRes
->
Êags
 ){

90259 
	`sqlôe3_ªsu…_vÆue
(
c⁄ãxt
, 
pRes
);

90261 
	`sqlôe3VdbeMemRñó£
(
pRes
);

90268 
	`groupC⁄ˇtSãp
(

90269 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

90270 
¨gc
,

90271 
sqlôe3_vÆue
 **
¨gv


90273 c⁄° *
zVÆ
;

90274 
SåAccum
 *
pAccum
;

90275 c⁄° *
zSï
;

90276 
nVÆ
, 
nSï
;

90277 
	`as£π
–
¨gc
==1 ||árgc==2 );

90278 if–
	`sqlôe3_vÆue_ty≥
(
¨gv
[0])==
SQLITE_NULL
 ) ;

90279 
pAccum
 = (
SåAccum
*)
	`sqlôe3_aggªg©e_c⁄ãxt
(
c⁄ãxt
, (*pAccum));

90281 if–
pAccum
 ){

90282 
sqlôe3
 *
db
 = 
	`sqlôe3_c⁄ãxt_db_h™dÀ
(
c⁄ãxt
);

90283 
fú°Tîm
 = 
pAccum
->
u£MÆloc
==0;

90284 
pAccum
->
u£MÆloc
 = 2;

90285 
pAccum
->
mxAŒoc
 = 
db
->
aLimô
[
SQLITE_LIMIT_LENGTH
];

90286 if–!
fú°Tîm
 ){

90287 if–
¨gc
==2 ){

90288 
zSï
 = (*)
	`sqlôe3_vÆue_ãxt
(
¨gv
[1]);

90289 
nSï
 = 
	`sqlôe3_vÆue_byãs
(
¨gv
[1]);

90291 
zSï
 = ",";

90292 
nSï
 = 1;

90294 
	`sqlôe3SåAccumAµíd
(
pAccum
, 
zSï
, 
nSï
);

90296 
zVÆ
 = (*)
	`sqlôe3_vÆue_ãxt
(
¨gv
[0]);

90297 
nVÆ
 = 
	`sqlôe3_vÆue_byãs
(
¨gv
[0]);

90298 
	`sqlôe3SåAccumAµíd
(
pAccum
, 
zVÆ
, 
nVÆ
);

90301 
	`groupC⁄ˇtFöÆize
(
sqlôe3_c⁄ãxt
 *
c⁄ãxt
){

90302 
SåAccum
 *
pAccum
;

90303 
pAccum
 = 
	`sqlôe3_aggªg©e_c⁄ãxt
(
c⁄ãxt
, 0);

90304 if–
pAccum
 ){

90305 if–
pAccum
->
accEº‹
==
STRACCUM_TOOBIG
 ){

90306 
	`sqlôe3_ªsu…_îr‹_toobig
(
c⁄ãxt
);

90307 }if–
pAccum
->
accEº‹
==
STRACCUM_NOMEM
 ){

90308 
	`sqlôe3_ªsu…_îr‹_nomem
(
c⁄ãxt
);

90310 
	`sqlôe3_ªsu…_ãxt
(
c⁄ãxt
, 
	`sqlôe3SåAccumFöish
(
pAccum
), -1,

90311 
sqlôe3_‰ì
);

90321 
SQLITE_PRIVATE
 
	`sqlôe3Regi°îBuûtöFun˘i⁄s
(
sqlôe3
 *
db
){

90322 
rc
 = 
	`sqlôe3_ovîlﬂd_fun˘i⁄
(
db
, "MATCH", 2);

90323 
	`as£π
–
rc
==
SQLITE_NOMEM
 ||Ñc==
SQLITE_OK
 );

90324 if–
rc
==
SQLITE_NOMEM
 ){

90325 
db
->
mÆlocFaûed
 = 1;

90332 
	`£tLikeO±Fœg
(
sqlôe3
 *
db
, c⁄° *
zName
, 
u8
 
ÊagVÆ
){

90333 
FuncDef
 *
pDef
;

90334 
pDef
 = 
	`sqlôe3FödFun˘i⁄
(
db
, 
zName
, 
	`sqlôe3SåÀn30
(zName),

90335 2, 
SQLITE_UTF8
, 0);

90336 if–
	`ALWAYS
(
pDef
) ){

90337 
pDef
->
funcFœgs
 |
ÊagVÆ
;

90346 
SQLITE_PRIVATE
 
	`sqlôe3Regi°îLikeFun˘i⁄s
(
sqlôe3
 *
db
, 
ˇ£Sísôive
){

90347 
com∑ªInfo
 *
pInfo
;

90348 if–
ˇ£Sísôive
 ){

90349 
pInfo
 = (
com∑ªInfo
*)&
likeInfoA…
;

90351 
pInfo
 = (
com∑ªInfo
*)&
likeInfoN‹m
;

90353 
	`sqlôe3Cª©eFunc
(
db
, "like", 2, 
SQLITE_UTF8
, 
pInfo
, 
likeFunc
, 0, 0, 0);

90354 
	`sqlôe3Cª©eFunc
(
db
, "like", 3, 
SQLITE_UTF8
, 
pInfo
, 
likeFunc
, 0, 0, 0);

90355 
	`sqlôe3Cª©eFunc
(
db
, "glob", 2, 
SQLITE_UTF8
,

90356 (
com∑ªInfo
*)&
globInfo
, 
likeFunc
, 0, 0, 0);

90357 
	`£tLikeO±Fœg
(
db
, "glob", 
SQLITE_FUNC_LIKE
 | 
SQLITE_FUNC_CASE
);

90358 
	`£tLikeO±Fœg
(
db
, "like",

90359 
ˇ£Sísôive
 ? (
SQLITE_FUNC_LIKE
 | 
SQLITE_FUNC_CASE
) : SQLITE_FUNC_LIKE);

90369 
SQLITE_PRIVATE
 
	`sqlôe3IsLikeFun˘i⁄
(
sqlôe3
 *
db
, 
Ex¥
 *
pEx¥
, *
pIsNoˇ£
, *
aWc
){

90370 
FuncDef
 *
pDef
;

90371 if–
pEx¥
->
›
!=
TK_FUNCTION


90372 || !
pEx¥
->
x
.
pLi°


90373 || 
pEx¥
->
x
.
pLi°
->
nEx¥
!=2

90377 
	`as£π
–!
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_xIsSñe˘
) );

90378 
pDef
 = 
	`sqlôe3FödFun˘i⁄
(
db
, 
pEx¥
->
u
.
zTokí
,

90379 
	`sqlôe3SåÀn30
(
pEx¥
->
u
.
zTokí
),

90380 2, 
SQLITE_UTF8
, 0);

90381 if–
	`NEVER
(
pDef
==0Ë|| (pDef->
funcFœgs
 & 
SQLITE_FUNC_LIKE
)==0 ){

90389 
	`mem˝y
(
aWc
, 
pDef
->
pU£rD©a
, 3);

90390 
	`as£π
–(*)&
likeInfoA…
 =(*)&likeInfoA….
m©chAŒ
 );

90391 
	`as£π
–&((*)&
likeInfoA…
)[1] =(*)&likeInfoA….
m©chO√
 );

90392 
	`as£π
–&((*)&
likeInfoA…
)[2] =(*)&likeInfoA….
m©chSë
 );

90393 *
pIsNoˇ£
 = (
pDef
->
funcFœgs
 & 
SQLITE_FUNC_CASE
)==0;

90404 
SQLITE_PRIVATE
 
	`sqlôe3Regi°îGlobÆFun˘i⁄s
(){

90413 
SQLITE_WSD
 
FuncDef
 
aBuûtöFunc
[] = {

90414 
	`FUNCTION
(
…rim
, 1, 1, 0, 
åimFunc
 ),

90415 
	`FUNCTION
(
…rim
, 2, 1, 0, 
åimFunc
 ),

90416 
	`FUNCTION
(
πrim
, 1, 2, 0, 
åimFunc
 ),

90417 
	`FUNCTION
(
πrim
, 2, 2, 0, 
åimFunc
 ),

90418 
	`FUNCTION
(
åim
, 1, 3, 0, 
åimFunc
 ),

90419 
	`FUNCTION
(
åim
, 2, 3, 0, 
åimFunc
 ),

90420 
	`FUNCTION
(
mö
, -1, 0, 1, 
mömaxFunc
 ),

90421 
	`FUNCTION
(
mö
, 0, 0, 1, 0 ),

90422 
	`AGGREGATE
(
mö
, 1, 0, 1, 
mömaxSãp
, 
möMaxFöÆize
 ),

90423 
	`FUNCTION
(
max
, -1, 1, 1, 
mömaxFunc
 ),

90424 
	`FUNCTION
(
max
, 0, 1, 1, 0 ),

90425 
	`AGGREGATE
(
max
, 1, 1, 1, 
mömaxSãp
, 
möMaxFöÆize
 ),

90426 
	`FUNCTION2
(
ty≥of
, 1, 0, 0, 
ty≥ofFunc
, 
SQLITE_FUNC_TYPEOF
),

90427 
	`FUNCTION2
(
Àngth
, 1, 0, 0, 
ÀngthFunc
, 
SQLITE_FUNC_LENGTH
),

90428 
	`FUNCTION
(
ö°r
, 2, 0, 0, 
ö°rFunc
 ),

90429 
	`FUNCTION
(
sub°r
, 2, 0, 0, 
sub°rFunc
 ),

90430 
	`FUNCTION
(
sub°r
, 3, 0, 0, 
sub°rFunc
 ),

90431 
	`FUNCTION
(
unicode
, 1, 0, 0, 
unicodeFunc
 ),

90432 
	`FUNCTION
(, -1, 0, 0, 
ch¨Func
 ),

90433 
	`FUNCTION
(
abs
, 1, 0, 0, 
absFunc
 ),

90434 #i‚de‡
SQLITE_OMIT_FLOATING_POINT


90435 
	`FUNCTION
(
round
, 1, 0, 0, 
roundFunc
 ),

90436 
	`FUNCTION
(
round
, 2, 0, 0, 
roundFunc
 ),

90438 
	`FUNCTION
(
uµî
, 1, 0, 0, 
uµîFunc
 ),

90439 
	`FUNCTION
(
lowî
, 1, 0, 0, 
lowîFunc
 ),

90440 
	`FUNCTION
(
cﬂÀs˚
, 1, 0, 0, 0 ),

90441 
	`FUNCTION
(
cﬂÀs˚
, 0, 0, 0, 0 ),

90442 
	`FUNCTION2
(
cﬂÀs˚
, -1, 0, 0, 
no›Func
, 
SQLITE_FUNC_COALESCE
),

90443 
	`FUNCTION
(
hex
, 1, 0, 0, 
hexFunc
 ),

90444 
	`FUNCTION2
(
i‚uŒ
, 2, 0, 0, 
no›Func
, 
SQLITE_FUNC_COALESCE
),

90445 
	`FUNCTION2
(
u∆ikñy
, 1, 0, 0, 
no›Func
, 
SQLITE_FUNC_UNLIKELY
),

90446 
	`FUNCTION2
(
likñihood
, 2, 0, 0, 
no›Func
, 
SQLITE_FUNC_UNLIKELY
),

90447 
	`FUNCTION
(
øndom
, 0, 0, 0, 
øndomFunc
 ),

90448 
	`FUNCTION
(
øndomblob
, 1, 0, 0, 
øndomBlob
 ),

90449 
	`FUNCTION
(
nuŒif
, 2, 0, 1, 
nuŒifFunc
 ),

90450 
	`FUNCTION
(
sqlôe_vîsi⁄
, 0, 0, 0, 
vîsi⁄Func
 ),

90451 
	`FUNCTION
(
sqlôe_sour˚_id
, 0, 0, 0, 
sour˚idFunc
 ),

90452 
	`FUNCTION
(
sqlôe_log
, 2, 0, 0, 
îæogFunc
 ),

90453 #i‚de‡
SQLITE_OMIT_COMPILEOPTION_DIAGS


90454 
	`FUNCTION
(
sqlôe_compûe›ti⁄_u£d
,1, 0, 0, 
compûe›ti⁄u£dFunc
 ),

90455 
	`FUNCTION
(
sqlôe_compûe›ti⁄_gë
, 1, 0, 0, 
compûe›ti⁄gëFunc
 ),

90457 
	`FUNCTION
(
quŸe
, 1, 0, 0, 
quŸeFunc
 ),

90458 
	`FUNCTION
(
œ°_ö£π_rowid
, 0, 0, 0,Üast_insert_rowid),

90459 
	`FUNCTION
(
ch™ges
, 0, 0, 0, changes ),

90460 
	`FUNCTION
(
tŸÆ_ch™ges
, 0, 0, 0,Åotal_changes ),

90461 
	`FUNCTION
(
ª∂a˚
, 3, 0, 0, 
ª∂a˚Func
 ),

90462 
	`FUNCTION
(
zîoblob
, 1, 0, 0, 
zîoblobFunc
 ),

90463 #ifde‡
SQLITE_SOUNDEX


90464 
	`FUNCTION
(
soundex
, 1, 0, 0, 
soundexFunc
 ),

90466 #i‚de‡
SQLITE_OMIT_LOAD_EXTENSION


90467 
	`FUNCTION
(
lﬂd_exãnsi⁄
, 1, 0, 0, 
lﬂdExt
 ),

90468 
	`FUNCTION
(
lﬂd_exãnsi⁄
, 2, 0, 0, 
lﬂdExt
 ),

90470 
	`AGGREGATE
(
sum
, 1, 0, 0, 
sumSãp
, 
sumFöÆize
 ),

90471 
	`AGGREGATE
(
tŸÆ
, 1, 0, 0, 
sumSãp
, 
tŸÆFöÆize
 ),

90472 
	`AGGREGATE
(
avg
, 1, 0, 0, 
sumSãp
, 
avgFöÆize
 ),

90474 {0,
SQLITE_UTF8
|
SQLITE_FUNC_COUNT
,0,0,0,
cou¡Sãp
,
cou¡FöÆize
,"count",0,0},

90475 
	`AGGREGATE
(
cou¡
, 1, 0, 0, 
cou¡Sãp
, 
cou¡FöÆize
 ),

90476 
	`AGGREGATE
(
group_c⁄ˇt
, 1, 0, 0, 
groupC⁄ˇtSãp
, 
groupC⁄ˇtFöÆize
),

90477 
	`AGGREGATE
(
group_c⁄ˇt
, 2, 0, 0, 
groupC⁄ˇtSãp
, 
groupC⁄ˇtFöÆize
),

90479 
	`LIKEFUNC
(
glob
, 2, &
globInfo
, 
SQLITE_FUNC_LIKE
|
SQLITE_FUNC_CASE
),

90480 #ifde‡
SQLITE_CASE_SENSITIVE_LIKE


90481 
	`LIKEFUNC
(
like
, 2, &
likeInfoA…
, 
SQLITE_FUNC_LIKE
|
SQLITE_FUNC_CASE
),

90482 
	`LIKEFUNC
(
like
, 3, &
likeInfoA…
, 
SQLITE_FUNC_LIKE
|
SQLITE_FUNC_CASE
),

90484 
	`LIKEFUNC
(
like
, 2, &
likeInfoN‹m
, 
SQLITE_FUNC_LIKE
),

90485 
	`LIKEFUNC
(
like
, 3, &
likeInfoN‹m
, 
SQLITE_FUNC_LIKE
),

90489 
i
;

90490 
FuncDefHash
 *
pHash
 = &
	`GLOBAL
(FuncDefHash, 
sqlôe3GlobÆFun˘i⁄s
);

90491 
FuncDef
 *
aFunc
 = (FuncDef*)&
	`GLOBAL
(FuncDef, 
aBuûtöFunc
);

90493 
i
=0; i<
	`AºaySize
(
aBuûtöFunc
); i++){

90494 
	`sqlôe3FuncDefIn£π
(
pHash
, &
aFunc
[
i
]);

90496 
	`sqlôe3Regi°îD©eTimeFun˘i⁄s
();

90497 #i‚de‡
SQLITE_OMIT_ALTERTABLE


90498 
	`sqlôe3A…îFun˘i⁄s
();

90500 #i‡
	`deföed
(
SQLITE_ENABLE_STAT3
Ë|| deföed(
SQLITE_ENABLE_STAT4
)

90501 
	`sqlôe3A«lyzeFun˘i⁄s
();

90521 #i‚de‡
SQLITE_OMIT_FOREIGN_KEY


90522 #i‚de‡
SQLITE_OMIT_TRIGGER


90688 
SQLITE_PRIVATE
 
	`sqlôe3FkLoˇãIndex
(

90689 
P¨£
 *
pP¨£
,

90690 
TabÀ
 *
pP¨ít
,

90691 
FKey
 *
pFKey
,

90692 
Index
 **
µIdx
,

90693 **
∑iCﬁ


90695 
Index
 *
pIdx
 = 0;

90696 *
aiCﬁ
 = 0;

90697 
nCﬁ
 = 
pFKey
->nCol;

90698 *
zKey
 = 
pFKey
->
aCﬁ
[0].
zCﬁ
;

90701 
	`as£π
–
µIdx
 && *ppIdx==0 );

90702 
	`as£π
–!
∑iCﬁ
 || *paiCol==0 );

90703 
	`as£π
–
pP¨£
 );

90713 if–
nCﬁ
==1 ){

90721 if–
pP¨ít
->
iPKey
>=0 ){

90722 if–!
zKey
 )  0;

90723 if–!
	`sqlôe3SåICmp
(
pP¨ít
->
aCﬁ
[pP¨ít->
iPKey
].
zName
, 
zKey
) )  0;

90725 }if–
∑iCﬁ
 ){

90726 
	`as£π
–
nCﬁ
>1 );

90727 
aiCﬁ
 = (*)
	`sqlôe3DbMÆlocRaw
(
pP¨£
->
db
, 
nCﬁ
*());

90728 if–!
aiCﬁ
 )  1;

90729 *
∑iCﬁ
 = 
aiCﬁ
;

90732 
pIdx
=
pP¨ít
->
pIndex
;ÖIdx;ÖIdxıIdx->
pNext
){

90733 if–
pIdx
->
nCﬁumn
==
nCﬁ
 &&ÖIdx->
⁄Eº‹
!=
OE_N⁄e
 ){

90738 if–
zKey
==0 ){

90742 if–
pIdx
->
autoIndex
==2 ){

90743 if–
aiCﬁ
 ){

90744 
i
;

90745 
i
=0; i<
nCﬁ
; i++Ë
aiCﬁ
[i] = 
pFKey
->
aCﬁ
[i].
iFrom
;

90754 
i
, 
j
;

90755 
i
=0; i<
nCﬁ
; i++){

90756 
iCﬁ
 = 
pIdx
->
aiCﬁumn
[
i
];

90757 *
zDÊtCﬁl
;

90758 *
zIdxCﬁ
;

90763 
zDÊtCﬁl
 = 
pP¨ít
->
aCﬁ
[
iCﬁ
].
zCﬁl
;

90764 if–!
zDÊtCﬁl
 ){

90765 
zDÊtCﬁl
 = "BINARY";

90767 if–
	`sqlôe3SåICmp
(
pIdx
->
azCﬁl
[
i
], 
zDÊtCﬁl
) ) ;

90769 
zIdxCﬁ
 = 
pP¨ít
->
aCﬁ
[
iCﬁ
].
zName
;

90770 
j
=0; j<
nCﬁ
; j++){

90771 if–
	`sqlôe3SåICmp
(
pFKey
->
aCﬁ
[
j
].
zCﬁ
, 
zIdxCﬁ
)==0 ){

90772 if–
aiCﬁ
 )áiCﬁ[
i
] = 
pFKey
->
aCﬁ
[
j
].
iFrom
;

90776 if–
j
==
nCﬁ
 ) ;

90778 if–
i
==
nCﬁ
 ) ;

90783 if–!
pIdx
 ){

90784 if–!
pP¨£
->
dißbÀTriggîs
 ){

90785 
	`sqlôe3Eº‹Msg
(
pP¨£
,

90787 
pFKey
->
pFrom
->
zName
,ÖFKey->
zTo
);

90789 
	`sqlôe3DbFªe
(
pP¨£
->
db
, 
aiCﬁ
);

90793 *
µIdx
 = 
pIdx
;

90823 
	`fkLookupP¨ít
(

90824 
P¨£
 *
pP¨£
,

90825 
iDb
,

90826 
TabÀ
 *
pTab
,

90827 
Index
 *
pIdx
,

90828 
FKey
 *
pFKey
,

90829 *
aiCﬁ
,

90830 
ªgD©a
,

90831 
nIn¸
,

90832 
isIgn‹e


90834 
i
;

90835 
Vdbe
 *
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

90836 
iCur
 = 
pP¨£
->
nTab
 - 1;

90837 
iOk
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

90846 if–
nIn¸
<0 ){

90847 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_FkIfZîo
, 
pFKey
->
isDe„ºed
, 
iOk
);

90849 
i
=0; i<
pFKey
->
nCﬁ
; i++){

90850 
iReg
 = 
aiCﬁ
[
i
] + 
ªgD©a
 + 1;

90851 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_IsNuŒ
, 
iReg
, 
iOk
);

90854 if–
isIgn‹e
==0 ){

90855 if–
pIdx
==0 ){

90858 
iMu°BeI¡
;

90859 
ªgTemp
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

90866 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_SC›y
, 
aiCﬁ
[0]+1+
ªgD©a
, 
ªgTemp
);

90867 
iMu°BeI¡
 = 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Mu°BeI¡
, 
ªgTemp
, 0);

90873 if–
pTab
==
pFKey
->
pFrom
 && 
nIn¸
==1 ){

90874 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Eq
, 
ªgD©a
, 
iOk
, 
ªgTemp
);

90877 
	`sqlôe3O≥nTabÀ
(
pP¨£
, 
iCur
, 
iDb
, 
pTab
, 
OP_O≥nRód
);

90878 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_NŸExi°s
, 
iCur
, 0, 
ªgTemp
);

90879 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_GŸo
, 0, 
iOk
);

90880 
	`sqlôe3VdbeJumpHîe
(
v
, 
	`sqlôe3VdbeCuºítAddr
(v)-2);

90881 
	`sqlôe3VdbeJumpHîe
(
v
, 
iMu°BeI¡
);

90882 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
ªgTemp
);

90884 
nCﬁ
 = 
pFKey
->nCol;

90885 
ªgTemp
 = 
	`sqlôe3GëTempR™ge
(
pP¨£
, 
nCﬁ
);

90886 
ªgRec
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

90887 
KeyInfo
 *
pKey
 = 
	`sqlôe3IndexKeyöfo
(
pP¨£
, 
pIdx
);

90889 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_O≥nRód
, 
iCur
, 
pIdx
->
äum
, 
iDb
);

90890 
	`sqlôe3VdbeCh™geP4
(
v
, -1, (*)
pKey
, 
P4_KEYINFO_HANDOFF
);

90891 
i
=0; i<
nCﬁ
; i++){

90892 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_C›y
, 
aiCﬁ
[
i
]+1+
ªgD©a
, 
ªgTemp
+i);

90905 if–
pTab
==
pFKey
->
pFrom
 && 
nIn¸
==1 ){

90906 
iJump
 = 
	`sqlôe3VdbeCuºítAddr
(
v
Ë+ 
nCﬁ
 + 1;

90907 
i
=0; i<
nCﬁ
; i++){

90908 
iChûd
 = 
aiCﬁ
[
i
]+1+
ªgD©a
;

90909 
iP¨ít
 = 
pIdx
->
aiCﬁumn
[
i
]+1+
ªgD©a
;

90910 
	`as£π
–
aiCﬁ
[
i
]!=
pTab
->
iPKey
 );

90911 if–
pIdx
->
aiCﬁumn
[
i
]==
pTab
->
iPKey
 ){

90913 
iP¨ít
 = 
ªgD©a
;

90915 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Ne
, 
iChûd
, 
iJump
, 
iP¨ít
);

90916 
	`sqlôe3VdbeCh™geP5
(
v
, 
SQLITE_JUMPIFNULL
);

90918 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_GŸo
, 0, 
iOk
);

90921 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_MakeRec‹d
, 
ªgTemp
, 
nCﬁ
, 
ªgRec
);

90922 
	`sqlôe3VdbeCh™geP4
(
v
, -1, 
	`sqlôe3IndexAfföôySå
(v,
pIdx
), 
P4_TRANSIENT
);

90923 
	`sqlôe3VdbeAddOp4I¡
(
v
, 
OP_Found
, 
iCur
, 
iOk
, 
ªgRec
, 0);

90925 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
ªgRec
);

90926 
	`sqlôe3Rñó£TempR™ge
(
pP¨£
, 
ªgTemp
, 
nCﬁ
);

90930 if–!
pFKey
->
isDe„ºed
 && !(
pP¨£
->
db
->
Êags
 & 
SQLITE_De„rFKs
)

90931 && !
pP¨£
->
pT›Àvñ


90932 && !
pP¨£
->
isMu…iWrôe


90938 
	`as£π
–
nIn¸
==1 );

90939 
	`sqlôe3HÆtC⁄°øöt
(
pP¨£
, 
SQLITE_CONSTRAINT_FOREIGNKEY
,

90940 
OE_Ab‹t
, "f‹eig¿key c⁄°øöàÁûed", 
P4_STATIC


90943 if–
nIn¸
>0 && 
pFKey
->
isDe„ºed
==0 ){

90944 
	`sqlôe3P¨£T›Àvñ
(
pP¨£
)->
mayAb‹t
 = 1;

90946 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_FkCou¡î
, 
pFKey
->
isDe„ºed
, 
nIn¸
);

90949 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
iOk
);

90950 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Clo£
, 
iCur
);

90981 
	`fkSˇnChûdªn
(

90982 
P¨£
 *
pP¨£
,

90983 
SrcLi°
 *
pSrc
,

90984 
TabÀ
 *
pTab
,

90985 
Index
 *
pIdx
,

90986 
FKey
 *
pFKey
,

90987 *
aiCﬁ
,

90988 
ªgD©a
,

90989 
nIn¸


90991 
sqlôe3
 *
db
 = 
pP¨£
->db;

90992 
i
;

90993 
Ex¥
 *
pWhîe
 = 0;

90994 
NameC⁄ãxt
 
sNameC⁄ãxt
;

90995 
WhîeInfo
 *
pWInfo
;

90996 
iFkIfZîo
 = 0;

90997 
Vdbe
 *
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

90999 
	`as£π
–!
pIdx
 ||ÖIdx->
pTabÀ
==
pTab
 );

91001 if–
nIn¸
<0 ){

91002 
iFkIfZîo
 = 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_FkIfZîo
, 
pFKey
->
isDe„ºed
, 0);

91013 
i
=0; i<
pFKey
->
nCﬁ
; i++){

91014 
Ex¥
 *
pLe·
;

91015 
Ex¥
 *
pRight
;

91016 
Ex¥
 *
pEq
;

91017 
iCﬁ
;

91018 c⁄° *
zCﬁ
;

91020 
pLe·
 = 
	`sqlôe3Ex¥
(
db
, 
TK_REGISTER
, 0);

91021 if–
pLe·
 ){

91024 if–
pIdx
 ){

91025 
Cﬁumn
 *
pCﬁ
;

91026 c⁄° *
zCﬁl
;

91027 
iCﬁ
 = 
pIdx
->
aiCﬁumn
[
i
];

91028 
pCﬁ
 = &
pTab
->
aCﬁ
[
iCﬁ
];

91029 if–
pTab
->
iPKey
==
iCﬁ
 ) iCol = -1;

91030 
pLe·
->
iTabÀ
 = 
ªgD©a
+
iCﬁ
+1;

91031 
pLe·
->
afföôy
 = 
pCﬁ
->affinity;

91032 
zCﬁl
 = 
pCﬁ
->zColl;

91033 if–
zCﬁl
==0 ) zCﬁ»
db
->
pDÊtCﬁl
->
zName
;

91034 
pLe·
 = 
	`sqlôe3Ex¥AddCﬁœãSåög
(
pP¨£
,ÖLe·, 
zCﬁl
);

91036 
pLe·
->
iTabÀ
 = 
ªgD©a
;

91037 
pLe·
->
afföôy
 = 
SQLITE_AFF_INTEGER
;

91040 
iCﬁ
 = 
aiCﬁ
 ?áiCﬁ[
i
] : 
pFKey
->
aCﬁ
[0].
iFrom
;

91041 
	`as£π
–
iCﬁ
>=0 );

91042 
zCﬁ
 = 
pFKey
->
pFrom
->
aCﬁ
[
iCﬁ
].
zName
;

91043 
pRight
 = 
	`sqlôe3Ex¥
(
db
, 
TK_ID
, 
zCﬁ
);

91044 
pEq
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_EQ
, 
pLe·
, 
pRight
, 0);

91045 
pWhîe
 = 
	`sqlôe3Ex¥And
(
db
,ÖWhîe, 
pEq
);

91052 if–
pTab
==
pFKey
->
pFrom
 && 
nIn¸
>0 ){

91053 
Ex¥
 *
pEq
;

91054 
Ex¥
 *
pLe·
;

91055 
Ex¥
 *
pRight
;

91056 
pLe·
 = 
	`sqlôe3Ex¥
(
db
, 
TK_REGISTER
, 0);

91057 
pRight
 = 
	`sqlôe3Ex¥
(
db
, 
TK_COLUMN
, 0);

91058 if–
pLe·
 && 
pRight
 ){

91059 
pLe·
->
iTabÀ
 = 
ªgD©a
;

91060 
pLe·
->
afföôy
 = 
SQLITE_AFF_INTEGER
;

91061 
pRight
->
iTabÀ
 = 
pSrc
->
a
[0].
iCurs‹
;

91062 
pRight
->
iCﬁumn
 = -1;

91064 
pEq
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_NE
, 
pLe·
, 
pRight
, 0);

91065 
pWhîe
 = 
	`sqlôe3Ex¥And
(
db
,ÖWhîe, 
pEq
);

91069 
	`mem£t
(&
sNameC⁄ãxt
, 0, (
NameC⁄ãxt
));

91070 
sNameC⁄ãxt
.
pSrcLi°
 = 
pSrc
;

91071 
sNameC⁄ãxt
.
pP¨£
 =ÖParse;

91072 
	`sqlôe3ResﬁveEx¥Names
(&
sNameC⁄ãxt
, 
pWhîe
);

91078 
pWInfo
 = 
	`sqlôe3WhîeBegö
(
pP¨£
, 
pSrc
, 
pWhîe
, 0, 0, 0, 0);

91079 if–
nIn¸
>0 && 
pFKey
->
isDe„ºed
==0 ){

91080 
	`sqlôe3P¨£T›Àvñ
(
pP¨£
)->
mayAb‹t
 = 1;

91082 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_FkCou¡î
, 
pFKey
->
isDe„ºed
, 
nIn¸
);

91083 if–
pWInfo
 ){

91084 
	`sqlôe3WhîeEnd
(
pWInfo
);

91088 
	`sqlôe3Ex¥Dñëe
(
db
, 
pWhîe
);

91089 if–
iFkIfZîo
 ){

91090 
	`sqlôe3VdbeJumpHîe
(
v
, 
iFkIfZîo
);

91108 
SQLITE_PRIVATE
 
FKey
 *
	`sqlôe3FkRe„ªn˚s
(
TabÀ
 *
pTab
){

91109 
nName
 = 
	`sqlôe3SåÀn30
(
pTab
->
zName
);

91110  (
FKey
 *)
	`sqlôe3HashFöd
(&
pTab
->
pSchema
->
fkeyHash
,ÖTab->
zName
, 
nName
);

91121 
	`fkTriggîDñëe
(
sqlôe3
 *
dbMem
, 
Triggî
 *
p
){

91122 if–
p
 ){

91123 
TriggîSãp
 *
pSãp
 = 
p
->
°ï_li°
;

91124 
	`sqlôe3Ex¥Dñëe
(
dbMem
, 
pSãp
->
pWhîe
);

91125 
	`sqlôe3Ex¥Li°Dñëe
(
dbMem
, 
pSãp
->
pEx¥Li°
);

91126 
	`sqlôe3Sñe˘Dñëe
(
dbMem
, 
pSãp
->
pSñe˘
);

91127 
	`sqlôe3Ex¥Dñëe
(
dbMem
, 
p
->
pWhí
);

91128 
	`sqlôe3DbFªe
(
dbMem
, 
p
);

91149 
SQLITE_PRIVATE
 
	`sqlôe3FkDr›TabÀ
(
P¨£
 *
pP¨£
, 
SrcLi°
 *
pName
, 
TabÀ
 *
pTab
){

91150 
sqlôe3
 *
db
 = 
pP¨£
->db;

91151 if–(
db
->
Êags
&
SQLITE_F‹eignKeys
Ë&& !
	`IsVútuÆ
(
pTab
Ë&& !pTab->
pSñe˘
 ){

91152 
iSkù
 = 0;

91153 
Vdbe
 *
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

91155 
	`as£π
–
v
 );

91156 if–
	`sqlôe3FkRe„ªn˚s
(
pTab
)==0 ){

91162 
FKey
 *
p
;

91163 
p
=
pTab
->
pFKey
;Ö;Öı->
pNextFrom
){

91164 if–
p
->
isDe„ºed
 || (
db
->
Êags
 & 
SQLITE_De„rFKs
) ) ;

91166 if–!
p
 ) ;

91167 
iSkù
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

91168 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_FkIfZîo
, 1, 
iSkù
);

91171 
pP¨£
->
dißbÀTriggîs
 = 1;

91172 
	`sqlôe3DñëeFrom
(
pP¨£
, 
	`sqlôe3SrcLi°Dup
(
db
, 
pName
, 0), 0);

91173 
pP¨£
->
dißbÀTriggîs
 = 0;

91184 if–(
db
->
Êags
 & 
SQLITE_De„rFKs
)==0 ){

91185 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_FkIfZîo
, 0, 
	`sqlôe3VdbeCuºítAddr
(v)+2);

91186 
	`sqlôe3HÆtC⁄°øöt
(
pP¨£
, 
SQLITE_CONSTRAINT_FOREIGNKEY
,

91187 
OE_Ab‹t
, "f‹eig¿key c⁄°øöàÁûed", 
P4_STATIC


91191 if–
iSkù
 ){

91192 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
iSkù
);

91210 
	`fkChûdIsModifõd
(

91211 
TabÀ
 *
pTab
,

91212 
FKey
 *
p
,

91213 *
aCh™ge
,

91214 
bChngRowid


91216 
i
;

91217 
i
=0; i<
p
->
nCﬁ
; i++){

91218 
iChûdKey
 = 
p
->
aCﬁ
[
i
].
iFrom
;

91219 if–
aCh™ge
[
iChûdKey
]>=0 )  1;

91220 if–
iChûdKey
==
pTab
->
iPKey
 && 
bChngRowid
 )  1;

91237 
	`fkP¨ítIsModifõd
(

91238 
TabÀ
 *
pTab
,

91239 
FKey
 *
p
,

91240 *
aCh™ge
,

91241 
bChngRowid


91243 
i
;

91244 
i
=0; i<
p
->
nCﬁ
; i++){

91245 *
zKey
 = 
p
->
aCﬁ
[
i
].
zCﬁ
;

91246 
iKey
;

91247 
iKey
=0; iKey<
pTab
->
nCﬁ
; iKey++){

91248 if–
aCh™ge
[
iKey
]>=0 || (iKey==
pTab
->
iPKey
 && 
bChngRowid
) ){

91249 
Cﬁumn
 *
pCﬁ
 = &
pTab
->
aCﬁ
[
iKey
];

91250 if–
zKey
 ){

91251 if–0==
	`sqlôe3SåICmp
(
pCﬁ
->
zName
, 
zKey
) )  1;

91252 }if–
pCﬁ
->
cﬁFœgs
 & 
COLFLAG_PRIMKEY
 ){

91281 
SQLITE_PRIVATE
 
	`sqlôe3FkCheck
(

91282 
P¨£
 *
pP¨£
,

91283 
TabÀ
 *
pTab
,

91284 
ªgOld
,

91285 
ªgNew
,

91286 *
aCh™ge
,

91287 
bChngRowid


91289 
sqlôe3
 *
db
 = 
pP¨£
->db;

91290 
FKey
 *
pFKey
;

91291 
iDb
;

91292 c⁄° *
zDb
;

91293 
isIgn‹eEº‹s
 = 
pP¨£
->
dißbÀTriggîs
;

91296 
	`as£π
–(
ªgOld
==0)!=(
ªgNew
==0) );

91299 if–(
db
->
Êags
&
SQLITE_F‹eignKeys
)==0 ) ;

91301 
iDb
 = 
	`sqlôe3SchemaToIndex
(
db
, 
pTab
->
pSchema
);

91302 
zDb
 = 
db
->
aDb
[
iDb
].
zName
;

91306 
pFKey
=
pTab
->pFKey;ÖFKey;ÖFKeyıFKey->
pNextFrom
){

91307 
TabÀ
 *
pTo
;

91308 
Index
 *
pIdx
 = 0;

91309 *
aiFªe
 = 0;

91310 *
aiCﬁ
;

91311 
iCﬁ
;

91312 
i
;

91313 
isIgn‹e
 = 0;

91315 if–
aCh™ge


91316 && 
	`sqlôe3_°ricmp
(
pTab
->
zName
, 
pFKey
->
zTo
)!=0

91317 && 
	`fkChûdIsModifõd
(
pTab
, 
pFKey
, 
aCh™ge
, 
bChngRowid
)==0

91326 if–
pP¨£
->
dißbÀTriggîs
 ){

91327 
pTo
 = 
	`sqlôe3FödTabÀ
(
db
, 
pFKey
->
zTo
, 
zDb
);

91329 
pTo
 = 
	`sqlôe3LoˇãTabÀ
(
pP¨£
, 0, 
pFKey
->
zTo
, 
zDb
);

91331 if–!
pTo
 || 
	`sqlôe3FkLoˇãIndex
(
pP¨£
,ÖTo, 
pFKey
, &
pIdx
, &
aiFªe
) ){

91332 
	`as£π
–
isIgn‹eEº‹s
==0 || (
ªgOld
!=0 && 
ªgNew
==0) );

91333 if–!
isIgn‹eEº‹s
 || 
db
->
mÆlocFaûed
 ) ;

91334 if–
pTo
==0 ){

91342 
Vdbe
 *
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

91343 
iJump
 = 
	`sqlôe3VdbeCuºítAddr
(
v
Ë+ 
pFKey
->
nCﬁ
 + 1;

91344 
i
=0; i<
pFKey
->
nCﬁ
; i++){

91345 
iReg
 = 
pFKey
->
aCﬁ
[
i
].
iFrom
 + 
ªgOld
 + 1;

91346 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_IsNuŒ
, 
iReg
, 
iJump
);

91348 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_FkCou¡î
, 
pFKey
->
isDe„ºed
, -1);

91352 
	`as£π
–
pFKey
->
nCﬁ
==1 || (
aiFªe
 && 
pIdx
) );

91354 if–
aiFªe
 ){

91355 
aiCﬁ
 = 
aiFªe
;

91357 
iCﬁ
 = 
pFKey
->
aCﬁ
[0].
iFrom
;

91358 
aiCﬁ
 = &
iCﬁ
;

91360 
i
=0; i<
pFKey
->
nCﬁ
; i++){

91361 if–
aiCﬁ
[
i
]==
pTab
->
iPKey
 ){

91362 
aiCﬁ
[
i
] = -1;

91364 #i‚de‡
SQLITE_OMIT_AUTHORIZATION


91368 if–
db
->
xAuth
 ){

91369 
rˇuth
;

91370 *
zCﬁ
 = 
pTo
->
aCﬁ
[
pIdx
 ?ÖIdx->
aiCﬁumn
[
i
] :ÖTo->
iPKey
].
zName
;

91371 
rˇuth
 = 
	`sqlôe3AuthRódCﬁ
(
pP¨£
, 
pTo
->
zName
, 
zCﬁ
, 
iDb
);

91372 
isIgn‹e
 = (
rˇuth
==
SQLITE_IGNORE
);

91380 
	`sqlôe3TabÀLock
(
pP¨£
, 
iDb
, 
pTo
->
äum
, 0,ÖTo->
zName
);

91381 
pP¨£
->
nTab
++;

91383 if–
ªgOld
!=0 ){

91387 
	`fkLookupP¨ít
(
pP¨£
, 
iDb
, 
pTo
, 
pIdx
, 
pFKey
, 
aiCﬁ
, 
ªgOld
, -1,
isIgn‹e
);

91389 if–
ªgNew
!=0 ){

91392 
	`fkLookupP¨ít
(
pP¨£
, 
iDb
, 
pTo
, 
pIdx
, 
pFKey
, 
aiCﬁ
, 
ªgNew
, +1,
isIgn‹e
);

91395 
	`sqlôe3DbFªe
(
db
, 
aiFªe
);

91399 
pFKey
 = 
	`sqlôe3FkRe„ªn˚s
(
pTab
);ÖFKey;ÖFKeyıFKey->
pNextTo
){

91400 
Index
 *
pIdx
 = 0;

91401 
SrcLi°
 *
pSrc
;

91402 *
aiCﬁ
 = 0;

91404 if–
aCh™ge
 && 
	`fkP¨ítIsModifõd
(
pTab
, 
pFKey
,áCh™ge, 
bChngRowid
)==0 ){

91408 if–!
pFKey
->
isDe„ºed
 && !(
db
->
Êags
 & 
SQLITE_De„rFKs
)

91409 && !
pP¨£
->
pT›Àvñ
 && !pP¨£->
isMu…iWrôe


91411 
	`as£π
–
ªgOld
==0 && 
ªgNew
!=0 );

91417 if–
	`sqlôe3FkLoˇãIndex
(
pP¨£
, 
pTab
, 
pFKey
, &
pIdx
, &
aiCﬁ
) ){

91418 if–!
isIgn‹eEº‹s
 || 
db
->
mÆlocFaûed
 ) ;

91421 
	`as£π
–
aiCﬁ
 || 
pFKey
->
nCﬁ
==1 );

91426 
pSrc
 = 
	`sqlôe3SrcLi°Aµíd
(
db
, 0, 0, 0);

91427 if–
pSrc
 ){

91428 
SrcLi°_ôem
 *
pIãm
 = 
pSrc
->
a
;

91429 
pIãm
->
pTab
 = 
pFKey
->
pFrom
;

91430 
pIãm
->
zName
 = 
pFKey
->
pFrom
->zName;

91431 
pIãm
->
pTab
->
nRef
++;

91432 
pIãm
->
iCurs‹
 = 
pP¨£
->
nTab
++;

91434 if–
ªgNew
!=0 ){

91435 
	`fkSˇnChûdªn
(
pP¨£
, 
pSrc
, 
pTab
, 
pIdx
, 
pFKey
, 
aiCﬁ
, 
ªgNew
, -1);

91437 if–
ªgOld
!=0 ){

91444 
	`fkSˇnChûdªn
(
pP¨£
, 
pSrc
, 
pTab
, 
pIdx
, 
pFKey
, 
aiCﬁ
, 
ªgOld
, 1);

91446 
pIãm
->
zName
 = 0;

91447 
	`sqlôe3SrcLi°Dñëe
(
db
, 
pSrc
);

91449 
	`sqlôe3DbFªe
(
db
, 
aiCﬁ
);

91453 
	#COLUMN_MASK
(
x
Ë(((x)>31Ë? 0xfffffff‡: ((
u32
)1<<(x)))

	)

91459 
SQLITE_PRIVATE
 
u32
 
	`sqlôe3FkOldmask
(

91460 
P¨£
 *
pP¨£
,

91461 
TabÀ
 *
pTab


91463 
u32
 
mask
 = 0;

91464 if–
pP¨£
->
db
->
Êags
&
SQLITE_F‹eignKeys
 ){

91465 
FKey
 *
p
;

91466 
i
;

91467 
p
=
pTab
->
pFKey
;Ö;Öı->
pNextFrom
){

91468 
i
=0; i<
p
->
nCﬁ
; i++Ë
mask
 |
	`COLUMN_MASK
’->
aCﬁ
[i].
iFrom
);

91470 
p
=
	`sqlôe3FkRe„ªn˚s
(
pTab
);Ö;Öı->
pNextTo
){

91471 
Index
 *
pIdx
 = 0;

91472 
	`sqlôe3FkLoˇãIndex
(
pP¨£
, 
pTab
, 
p
, &
pIdx
, 0);

91473 if–
pIdx
 ){

91474 
i
=0; i<
pIdx
->
nCﬁumn
; i++Ë
mask
 |
	`COLUMN_MASK
’Idx->
aiCﬁumn
[i]);

91478  
mask
;

91496 
SQLITE_PRIVATE
 
	`sqlôe3FkRequúed
(

91497 
P¨£
 *
pP¨£
,

91498 
TabÀ
 *
pTab
,

91499 *
aCh™ge
,

91500 
chngRowid


91502 if–
pP¨£
->
db
->
Êags
&
SQLITE_F‹eignKeys
 ){

91503 if–!
aCh™ge
 ){

91507  (
	`sqlôe3FkRe„ªn˚s
(
pTab
Ë||ÖTab->
pFKey
);

91511 
FKey
 *
p
;

91514 
p
=
pTab
->
pFKey
;Ö;Öı->
pNextFrom
){

91515 if–
	`fkChûdIsModifõd
(
pTab
, 
p
, 
aCh™ge
, 
chngRowid
) )  1;

91519 
p
=
	`sqlôe3FkRe„ªn˚s
(
pTab
);Ö;Öı->
pNextTo
){

91520 if–
	`fkP¨ítIsModifõd
(
pTab
, 
p
, 
aCh™ge
, 
chngRowid
) )  1;

91556 
Triggî
 *
	`fkA˘i⁄Triggî
(

91557 
P¨£
 *
pP¨£
,

91558 
TabÀ
 *
pTab
,

91559 
FKey
 *
pFKey
,

91560 
Ex¥Li°
 *
pCh™ges


91562 
sqlôe3
 *
db
 = 
pP¨£
->db;

91563 
a˘i⁄
;

91564 
Triggî
 *
pTriggî
;

91565 
iA˘i⁄
 = (
pCh™ges
!=0);

91567 
a˘i⁄
 = 
pFKey
->
aA˘i⁄
[
iA˘i⁄
];

91568 
pTriggî
 = 
pFKey
->
≠Triggî
[
iA˘i⁄
];

91570 if–
a˘i⁄
!=
OE_N⁄e
 && !
pTriggî
 ){

91571 
u8
 
íabÀLookaside
;

91572 c⁄° *
zFrom
;

91573 
nFrom
;

91574 
Index
 *
pIdx
 = 0;

91575 *
aiCﬁ
 = 0;

91576 
TriggîSãp
 *
pSãp
 = 0;

91577 
Ex¥
 *
pWhîe
 = 0;

91578 
Ex¥Li°
 *
pLi°
 = 0;

91579 
Sñe˘
 *
pSñe˘
 = 0;

91580 
i
;

91581 
Ex¥
 *
pWhí
 = 0;

91583 if–
	`sqlôe3FkLoˇãIndex
(
pP¨£
, 
pTab
, 
pFKey
, &
pIdx
, &
aiCﬁ
) )  0;

91584 
	`as£π
–
aiCﬁ
 || 
pFKey
->
nCﬁ
==1 );

91586 
i
=0; i<
pFKey
->
nCﬁ
; i++){

91587 
Tokí
 
tOld
 = { "old", 3 };

91588 
Tokí
 
tNew
 = { "new", 3 };

91589 
Tokí
 
tFromCﬁ
;

91590 
Tokí
 
tToCﬁ
;

91591 
iFromCﬁ
;

91592 
Ex¥
 *
pEq
;

91594 
iFromCﬁ
 = 
aiCﬁ
 ?áiCﬁ[
i
] : 
pFKey
->
aCﬁ
[0].
iFrom
;

91595 
	`as£π
–
iFromCﬁ
>=0 );

91596 
tToCﬁ
.
z
 = 
pIdx
 ? 
pTab
->
aCﬁ
[pIdx->
aiCﬁumn
[
i
]].
zName
 : "oid";

91597 
tFromCﬁ
.
z
 = 
pFKey
->
pFrom
->
aCﬁ
[
iFromCﬁ
].
zName
;

91599 
tToCﬁ
.
n
 = 
	`sqlôe3SåÀn30
—ToCﬁ.
z
);

91600 
tFromCﬁ
.
n
 = 
	`sqlôe3SåÀn30
—FromCﬁ.
z
);

91606 
pEq
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_EQ
,

91607 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_DOT
,

91608 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_ID
, 0, 0, &
tOld
),

91609 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_ID
, 0, 0, &
tToCﬁ
)

91611 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_ID
, 0, 0, &
tFromCﬁ
)

91613 
pWhîe
 = 
	`sqlôe3Ex¥And
(
db
,ÖWhîe, 
pEq
);

91620 if–
pCh™ges
 ){

91621 
pEq
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_IS
,

91622 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_DOT
,

91623 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_ID
, 0, 0, &
tOld
),

91624 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_ID
, 0, 0, &
tToCﬁ
),

91626 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_DOT
,

91627 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_ID
, 0, 0, &
tNew
),

91628 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_ID
, 0, 0, &
tToCﬁ
),

91631 
pWhí
 = 
	`sqlôe3Ex¥And
(
db
,ÖWhí, 
pEq
);

91634 if–
a˘i⁄
!=
OE_Re°ri˘
 && (a˘i⁄!=
OE_Casˇde
 || 
pCh™ges
) ){

91635 
Ex¥
 *
pNew
;

91636 if–
a˘i⁄
==
OE_Casˇde
 ){

91637 
pNew
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_DOT
,

91638 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_ID
, 0, 0, &
tNew
),

91639 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_ID
, 0, 0, &
tToCﬁ
)

91641 }if–
a˘i⁄
==
OE_SëDÊt
 ){

91642 
Ex¥
 *
pDÊt
 = 
pFKey
->
pFrom
->
aCﬁ
[
iFromCﬁ
].pDflt;

91643 if–
pDÊt
 ){

91644 
pNew
 = 
	`sqlôe3Ex¥Dup
(
db
, 
pDÊt
, 0);

91646 
pNew
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_NULL
, 0, 0, 0);

91649 
pNew
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_NULL
, 0, 0, 0);

91651 
pLi°
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,ÖLi°, 
pNew
);

91652 
	`sqlôe3Ex¥Li°SëName
(
pP¨£
, 
pLi°
, &
tFromCﬁ
, 0);

91655 
	`sqlôe3DbFªe
(
db
, 
aiCﬁ
);

91657 
zFrom
 = 
pFKey
->
pFrom
->
zName
;

91658 
nFrom
 = 
	`sqlôe3SåÀn30
(
zFrom
);

91660 if–
a˘i⁄
==
OE_Re°ri˘
 ){

91661 
Tokí
 
tFrom
;

91662 
Ex¥
 *
pRai£
;

91664 
tFrom
.
z
 = 
zFrom
;

91665 
tFrom
.
n
 = 
nFrom
;

91666 
pRai£
 = 
	`sqlôe3Ex¥
(
db
, 
TK_RAISE
, "foreign key constraint failed");

91667 if–
pRai£
 ){

91668 
pRai£
->
afföôy
 = 
OE_Ab‹t
;

91670 
pSñe˘
 = 
	`sqlôe3Sñe˘New
(
pP¨£
,

91671 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
, 0, 
pRai£
),

91672 
	`sqlôe3SrcLi°Aµíd
(
db
, 0, &
tFrom
, 0),

91673 
pWhîe
,

91676 
pWhîe
 = 0;

91680 
íabÀLookaside
 = 
db
->
lookaside
.
bE«bÀd
;

91681 
db
->
lookaside
.
bE«bÀd
 = 0;

91683 
pTriggî
 = (
Triggî
 *)
	`sqlôe3DbMÆlocZîo
(
db
,

91684 (
Triggî
) +

91685 (
TriggîSãp
) +

91686 
nFrom
 + 1

91688 if–
pTriggî
 ){

91689 
pSãp
 = 
pTriggî
->
°ï_li°
 = (
TriggîSãp
 *)&pTrigger[1];

91690 
pSãp
->
èrgë
.
z
 = (*)&pStep[1];

91691 
pSãp
->
èrgë
.
n
 = 
nFrom
;

91692 
	`mem˝y
((*)
pSãp
->
èrgë
.
z
, 
zFrom
, 
nFrom
);

91694 
pSãp
->
pWhîe
 = 
	`sqlôe3Ex¥Dup
(
db
,ÖWhîe, 
EXPRDUP_REDUCE
);

91695 
pSãp
->
pEx¥Li°
 = 
	`sqlôe3Ex¥Li°Dup
(
db
, 
pLi°
, 
EXPRDUP_REDUCE
);

91696 
pSãp
->
pSñe˘
 = 
	`sqlôe3Sñe˘Dup
(
db
,ÖSñe˘, 
EXPRDUP_REDUCE
);

91697 if–
pWhí
 ){

91698 
pWhí
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_NOT
,ÖWhen, 0, 0);

91699 
pTriggî
->
pWhí
 = 
	`sqlôe3Ex¥Dup
(
db
,ÖWhí, 
EXPRDUP_REDUCE
);

91704 
db
->
lookaside
.
bE«bÀd
 = 
íabÀLookaside
;

91706 
	`sqlôe3Ex¥Dñëe
(
db
, 
pWhîe
);

91707 
	`sqlôe3Ex¥Dñëe
(
db
, 
pWhí
);

91708 
	`sqlôe3Ex¥Li°Dñëe
(
db
, 
pLi°
);

91709 
	`sqlôe3Sñe˘Dñëe
(
db
, 
pSñe˘
);

91710 if–
db
->
mÆlocFaûed
==1 ){

91711 
	`fkTriggîDñëe
(
db
, 
pTriggî
);

91714 
	`as£π
–
pSãp
!=0 );

91716  
a˘i⁄
 ){

91717 
OE_Re°ri˘
:

91718 
pSãp
->
›
 = 
TK_SELECT
;

91720 
OE_Casˇde
:

91721 if–!
pCh™ges
 ){

91722 
pSãp
->
›
 = 
TK_DELETE
;

91726 
pSãp
->
›
 = 
TK_UPDATE
;

91728 
pSãp
->
pTrig
 = 
pTriggî
;

91729 
pTriggî
->
pSchema
 = 
pTab
->pSchema;

91730 
pTriggî
->
pTabSchema
 = 
pTab
->
pSchema
;

91731 
pFKey
->
≠Triggî
[
iA˘i⁄
] = 
pTriggî
;

91732 
pTriggî
->
›
 = (
pCh™ges
 ? 
TK_UPDATE
 : 
TK_DELETE
);

91735  
pTriggî
;

91742 
SQLITE_PRIVATE
 
	`sqlôe3FkA˘i⁄s
(

91743 
P¨£
 *
pP¨£
,

91744 
TabÀ
 *
pTab
,

91745 
Ex¥Li°
 *
pCh™ges
,

91746 
ªgOld
,

91747 *
aCh™ge
,

91748 
bChngRowid


91754 if–
pP¨£
->
db
->
Êags
&
SQLITE_F‹eignKeys
 ){

91755 
FKey
 *
pFKey
;

91756 
pFKey
 = 
	`sqlôe3FkRe„ªn˚s
(
pTab
);ÖFKey;ÖFKeyıFKey->
pNextTo
){

91757 if–
aCh™ge
==0 || 
	`fkP¨ítIsModifõd
(
pTab
, 
pFKey
,áCh™ge, 
bChngRowid
) ){

91758 
Triggî
 *
pA˘
 = 
	`fkA˘i⁄Triggî
(
pP¨£
, 
pTab
, 
pFKey
, 
pCh™ges
);

91759 if–
pA˘
 ){

91760 
	`sqlôe3CodeRowTriggîDúe˘
(
pP¨£
, 
pA˘
, 
pTab
, 
ªgOld
, 
OE_Ab‹t
, 0);

91774 
SQLITE_PRIVATE
 
	`sqlôe3FkDñëe
(
sqlôe3
 *
db
, 
TabÀ
 *
pTab
){

91775 
FKey
 *
pFKey
;

91776 
FKey
 *
pNext
;

91778 
	`as£π
–
db
==0 || 
	`sqlôe3SchemaMuãxHñd
(db, 0, 
pTab
->
pSchema
) );

91779 
pFKey
=
pTab
->pFKey;ÖFKey;ÖFKey=
pNext
){

91782 if–!
db
 || db->
≤ByãsFªed
==0 ){

91783 if–
pFKey
->
pPªvTo
 ){

91784 
pFKey
->
pPªvTo
->
pNextTo
 =ÖFKey->pNextTo;

91786 *
p
 = (*)
pFKey
->
pNextTo
;

91787 c⁄° *
z
 = (
p
 ? 
pFKey
->
pNextTo
->
zTo
 :ÖFKey->zTo);

91788 
	`sqlôe3HashIn£π
(&
pTab
->
pSchema
->
fkeyHash
, 
z
, 
	`sqlôe3SåÀn30
(z), 
p
);

91790 if–
pFKey
->
pNextTo
 ){

91791 
pFKey
->
pNextTo
->
pPªvTo
 =ÖFKey->pPrevTo;

91798 
	`as£π
–
pFKey
->
isDe„ºed
==0 ||ÖFKey->isDeferred==1 );

91801 #i‚de‡
SQLITE_OMIT_TRIGGER


91802 
	`fkTriggîDñëe
(
db
, 
pFKey
->
≠Triggî
[0]);

91803 
	`fkTriggîDñëe
(
db
, 
pFKey
->
≠Triggî
[1]);

91806 
pNext
 = 
pFKey
->
pNextFrom
;

91807 
	`sqlôe3DbFªe
(
db
, 
pFKey
);

91832 
SQLITE_PRIVATE
 
	`sqlôe3O≥nTabÀ
(

91833 
P¨£
 *
p
,

91834 
iCur
,

91835 
iDb
,

91836 
TabÀ
 *
pTab
,

91837 
›code


91839 
Vdbe
 *
v
;

91840 
	`as£π
–!
	`IsVútuÆ
(
pTab
) );

91841 
v
 = 
	`sqlôe3GëVdbe
(
p
);

91842 
	`as£π
–
›code
==
OP_O≥nWrôe
 || opcode==
OP_O≥nRód
 );

91843 
	`sqlôe3TabÀLock
(
p
, 
iDb
, 
pTab
->
äum
, (
›code
==
OP_O≥nWrôe
)?1:0,ÖTab->
zName
);

91844 
	`sqlôe3VdbeAddOp3
(
v
, 
›code
, 
iCur
, 
pTab
->
äum
, 
iDb
);

91845 
	`sqlôe3VdbeCh™geP4
(
v
, -1, 
	`SQLITE_INT_TO_PTR
(
pTab
->
nCﬁ
), 
P4_INT32
);

91846 
	`VdbeCommít
((
v
, "%s", 
pTab
->
zName
));

91869 
SQLITE_PRIVATE
 c⁄° *
	`sqlôe3IndexAfföôySå
(
Vdbe
 *
v
, 
Index
 *
pIdx
){

91870 if–!
pIdx
->
zCﬁAff
 ){

91879 
n
;

91880 
TabÀ
 *
pTab
 = 
pIdx
->
pTabÀ
;

91881 
sqlôe3
 *
db
 = 
	`sqlôe3VdbeDb
(
v
);

91882 
pIdx
->
zCﬁAff
 = (*)
	`sqlôe3DbMÆlocRaw
(0,ÖIdx->
nCﬁumn
+2);

91883 if–!
pIdx
->
zCﬁAff
 ){

91884 
db
->
mÆlocFaûed
 = 1;

91887 
n
=0;Ç<
pIdx
->
nCﬁumn
;Ç++){

91888 
pIdx
->
zCﬁAff
[
n
] = 
pTab
->
aCﬁ
[pIdx->
aiCﬁumn
[n]].
afföôy
;

91890 
pIdx
->
zCﬁAff
[
n
++] = 
SQLITE_AFF_INTEGER
;

91891 
pIdx
->
zCﬁAff
[
n
] = 0;

91894  
pIdx
->
zCﬁAff
;

91911 
SQLITE_PRIVATE
 
	`sqlôe3TabÀAfföôySå
(
Vdbe
 *
v
, 
TabÀ
 *
pTab
){

91919 if–!
pTab
->
zCﬁAff
 ){

91920 *
zCﬁAff
;

91921 
i
;

91922 
sqlôe3
 *
db
 = 
	`sqlôe3VdbeDb
(
v
);

91924 
zCﬁAff
 = (*)
	`sqlôe3DbMÆlocRaw
(0, 
pTab
->
nCﬁ
+1);

91925 if–!
zCﬁAff
 ){

91926 
db
->
mÆlocFaûed
 = 1;

91930 
i
=0; i<
pTab
->
nCﬁ
; i++){

91931 
zCﬁAff
[
i
] = 
pTab
->
aCﬁ
[i].
afföôy
;

91933 
zCﬁAff
[
pTab
->
nCﬁ
] = '\0';

91935 
pTab
->
zCﬁAff
 = zColAff;

91938 
	`sqlôe3VdbeCh™geP4
(
v
, -1, 
pTab
->
zCﬁAff
, 
P4_TRANSIENT
);

91948 
	`ªadsTabÀ
(
P¨£
 *
p
, 
iSèπAddr
, 
iDb
, 
TabÀ
 *
pTab
){

91949 
Vdbe
 *
v
 = 
	`sqlôe3GëVdbe
(
p
);

91950 
i
;

91951 
iEnd
 = 
	`sqlôe3VdbeCuºítAddr
(
v
);

91952 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


91953 
VTabÀ
 *
pVTab
 = 
	`IsVútuÆ
(
pTab
Ë? 
	`sqlôe3GëVTabÀ
(
p
->
db
,ÖTab) : 0;

91956 
i
=
iSèπAddr
; i<
iEnd
; i++){

91957 
VdbeOp
 *
pOp
 = 
	`sqlôe3VdbeGëOp
(
v
, 
i
);

91958 
	`as£π
–
pOp
!=0 );

91959 if–
pOp
->
›code
==
OP_O≥nRód
 &&ÖOp->
p3
==
iDb
 ){

91960 
Index
 *
pIndex
;

91961 
äum
 = 
pOp
->
p2
;

91962 if–
äum
==
pTab
->tnum ){

91965 
pIndex
=
pTab
->pIndex;ÖIndex;ÖIndexıIndex->
pNext
){

91966 if–
äum
==
pIndex
->tnum ){

91971 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


91972 if–
pOp
->
›code
==
OP_VO≥n
 &&ÖOp->
p4
.
pVèb
==
pVTab
 ){

91973 
	`as£π
–
pOp
->
p4
.
pVèb
!=0 );

91974 
	`as£π
–
pOp
->
p4ty≥
==
P4_VTAB
 );

91982 #i‚de‡
SQLITE_OMIT_AUTOINCREMENT


92003 
	`autoIncBegö
(

92004 
P¨£
 *
pP¨£
,

92005 
iDb
,

92006 
TabÀ
 *
pTab


92008 
memId
 = 0;

92009 if–
pTab
->
èbFœgs
 & 
TF_Autoö¸emít
 ){

92010 
P¨£
 *
pT›Àvñ
 = 
	`sqlôe3P¨£T›Àvñ
(
pP¨£
);

92011 
AutoöcInfo
 *
pInfo
;

92013 
pInfo
 = 
pT›Àvñ
->
pAöc
;

92014  
pInfo
 &&ÖInfo->
pTab
!ıTab ){ÖInfÿpInfo->
pNext
; }

92015 if–
pInfo
==0 ){

92016 
pInfo
 = 
	`sqlôe3DbMÆlocRaw
(
pP¨£
->
db
, (*pInfo));

92017 if–
pInfo
==0 )  0;

92018 
pInfo
->
pNext
 = 
pT›Àvñ
->
pAöc
;

92019 
pT›Àvñ
->
pAöc
 = 
pInfo
;

92020 
pInfo
->
pTab
 =ÖTab;

92021 
pInfo
->
iDb
 = iDb;

92022 
pT›Àvñ
->
nMem
++;

92023 
pInfo
->
ªgCå
 = ++
pT›Àvñ
->
nMem
;

92024 
pT›Àvñ
->
nMem
++;

92026 
memId
 = 
pInfo
->
ªgCå
;

92028  
memId
;

92035 
SQLITE_PRIVATE
 
	`sqlôe3Autoö¸emítBegö
(
P¨£
 *
pP¨£
){

92036 
AutoöcInfo
 *
p
;

92037 
sqlôe3
 *
db
 = 
pP¨£
->db;

92038 
Db
 *
pDb
;

92039 
memId
;

92040 
addr
;

92041 
Vdbe
 *
v
 = 
pP¨£
->
pVdbe
;

92045 
	`as£π
–
pP¨£
->
pTriggîTab
==0 );

92046 
	`as£π
–
pP¨£
==
	`sqlôe3P¨£T›Àvñ
(pParse) );

92048 
	`as£π
–
v
 );

92049 
p
 = 
pP¨£
->
pAöc
;Ö;Ö =Ö->
pNext
){

92050 
pDb
 = &
db
->
aDb
[
p
->
iDb
];

92051 
memId
 = 
p
->
ªgCå
;

92052 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 0, 
pDb
->
pSchema
) );

92053 
	`sqlôe3O≥nTabÀ
(
pP¨£
, 0, 
p
->
iDb
, 
pDb
->
pSchema
->
pSeqTab
, 
OP_O≥nRód
);

92054 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_NuŒ
, 0, 
memId
, memId+1);

92055 
addr
 = 
	`sqlôe3VdbeCuºítAddr
(
v
);

92056 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Såög8
, 0, 
memId
-1, 0, 
p
->
pTab
->
zName
, 0);

92057 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Rewöd
, 0, 
addr
+9);

92058 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Cﬁumn
, 0, 0, 
memId
);

92059 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Ne
, 
memId
-1, 
addr
+7, memId);

92060 
	`sqlôe3VdbeCh™geP5
(
v
, 
SQLITE_JUMPIFNULL
);

92061 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Rowid
, 0, 
memId
+1);

92062 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Cﬁumn
, 0, 1, 
memId
);

92063 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_GŸo
, 0, 
addr
+9);

92064 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Next
, 0, 
addr
+2);

92065 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 0, 
memId
);

92066 
	`sqlôe3VdbeAddOp0
(
v
, 
OP_Clo£
);

92078 
	`autoIncSãp
(
P¨£
 *
pP¨£
, 
memId
, 
ªgRowid
){

92079 if–
memId
>0 ){

92080 
	`sqlôe3VdbeAddOp2
(
pP¨£
->
pVdbe
, 
OP_MemMax
, 
memId
, 
ªgRowid
);

92091 
SQLITE_PRIVATE
 
	`sqlôe3Autoö¸emítEnd
(
P¨£
 *
pP¨£
){

92092 
AutoöcInfo
 *
p
;

92093 
Vdbe
 *
v
 = 
pP¨£
->
pVdbe
;

92094 
sqlôe3
 *
db
 = 
pP¨£
->db;

92096 
	`as£π
–
v
 );

92097 
p
 = 
pP¨£
->
pAöc
;Ö;Ö =Ö->
pNext
){

92098 
Db
 *
pDb
 = &
db
->
aDb
[
p
->
iDb
];

92099 
j1
, 
j2
, 
j3
, 
j4
, 
j5
;

92100 
iRec
;

92101 
memId
 = 
p
->
ªgCå
;

92103 
iRec
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

92104 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 0, 
pDb
->
pSchema
) );

92105 
	`sqlôe3O≥nTabÀ
(
pP¨£
, 0, 
p
->
iDb
, 
pDb
->
pSchema
->
pSeqTab
, 
OP_O≥nWrôe
);

92106 
j1
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_NŸNuŒ
, 
memId
+1);

92107 
j2
 = 
	`sqlôe3VdbeAddOp0
(
v
, 
OP_Rewöd
);

92108 
j3
 = 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Cﬁumn
, 0, 0, 
iRec
);

92109 
j4
 = 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Eq
, 
memId
-1, 0, 
iRec
);

92110 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Next
, 0, 
j3
);

92111 
	`sqlôe3VdbeJumpHîe
(
v
, 
j2
);

92112 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NewRowid
, 0, 
memId
+1);

92113 
j5
 = 
	`sqlôe3VdbeAddOp0
(
v
, 
OP_GŸo
);

92114 
	`sqlôe3VdbeJumpHîe
(
v
, 
j4
);

92115 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Rowid
, 0, 
memId
+1);

92116 
	`sqlôe3VdbeJumpHîe
(
v
, 
j1
);

92117 
	`sqlôe3VdbeJumpHîe
(
v
, 
j5
);

92118 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_MakeRec‹d
, 
memId
-1, 2, 
iRec
);

92119 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_In£π
, 0, 
iRec
, 
memId
+1);

92120 
	`sqlôe3VdbeCh™geP5
(
v
, 
OPFLAG_APPEND
);

92121 
	`sqlôe3VdbeAddOp0
(
v
, 
OP_Clo£
);

92122 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
iRec
);

92130 
	#autoIncBegö
(
A
,
B
,
C
Ë(0)

	)

92131 
	#autoIncSãp
(
A
,
B
,
C
)

	)

92194 
SQLITE_PRIVATE
 
	`sqlôe3CodeC‹outöe
(
P¨£
 *
pP¨£
, 
Sñe˘
 *
pSñe˘
, 
Sñe˘De°
 *
pDe°
){

92195 
ªgYõld
;

92196 
ªgEof
;

92197 
addrT›
;

92198 
j1
;

92199 
rc
;

92200 
Vdbe
 *
v
;

92202 
ªgYõld
 = ++
pP¨£
->
nMem
;

92203 
ªgEof
 = ++
pP¨£
->
nMem
;

92204 
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

92205 
addrT›
 = 
	`sqlôe3VdbeCuºítAddr
(
v
);

92206 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 
addrT›
+2, 
ªgYõld
);

92207 
	`VdbeCommít
((
v
, "Co-routineÉntryÖoint"));

92208 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 0, 
ªgEof
);

92209 
	`VdbeCommít
((
v
, "Co-routine completion flag"));

92210 
	`sqlôe3Sñe˘De°Inô
(
pDe°
, 
SRT_C‹outöe
, 
ªgYõld
);

92211 
j1
 = 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_GŸo
, 0, 0);

92212 
rc
 = 
	`sqlôe3Sñe˘
(
pP¨£
, 
pSñe˘
, 
pDe°
);

92213 
	`as£π
–
pP¨£
->
nEº
==0 || 
rc
 );

92214 if–
pP¨£
->
db
->
mÆlocFaûed
 && 
rc
==
SQLITE_OK
 )Ñ¯
SQLITE_NOMEM
;

92215 if–
rc
 ) Ñc;

92216 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 1, 
ªgEof
);

92217 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Yõld
, 
ªgYõld
);

92218 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_HÆt
, 
SQLITE_INTERNAL
, 
OE_Ab‹t
);

92219 
	`VdbeCommít
((
v
, "End of coroutine"));

92220 
	`sqlôe3VdbeJumpHîe
(
v
, 
j1
);

92221  
rc
;

92227 
	`x„rO±imiz©i⁄
(

92228 
P¨£
 *
pP¨£
,

92229 
TabÀ
 *
pDe°
,

92230 
Sñe˘
 *
pSñe˘
,

92231 
⁄Eº‹
,

92232 
iDbDe°


92337 
SQLITE_PRIVATE
 
	`sqlôe3In£π
(

92338 
P¨£
 *
pP¨£
,

92339 
SrcLi°
 *
pTabLi°
,

92340 
Ex¥Li°
 *
pLi°
,

92341 
Sñe˘
 *
pSñe˘
,

92342 
IdLi°
 *
pCﬁumn
,

92343 
⁄Eº‹


92345 
sqlôe3
 *
db
;

92346 
TabÀ
 *
pTab
;

92347 *
zTab
;

92348 c⁄° *
zDb
;

92349 
i
, 
j
, 
idx
;

92350 
Vdbe
 *
v
;

92351 
Index
 *
pIdx
;

92352 
nCﬁumn
;

92353 
nHiddí
 = 0;

92354 
ba£Cur
 = 0;

92355 
keyCﬁumn
 = -1;

92356 
ídOfLo›
;

92357 
u£TempTabÀ
 = 0;

92358 
§cTab
 = 0;

92359 
addrInsT›
 = 0;

92360 
addrC⁄t
 = 0;

92361 
addrSñe˘
 = 0;

92362 
Sñe˘De°
 
de°
;

92363 
iDb
;

92364 
Db
 *
pDb
;

92365 
≠≥ndFœg
 = 0;

92368 
ªgFromSñe˘
 = 0;

92369 
ªgAutoöc
 = 0;

92370 
ªgRowCou¡
 = 0;

92371 
ªgIns
;

92372 
ªgRowid
;

92373 
ªgD©a
;

92374 
ªgEof
 = 0;

92375 *
aRegIdx
 = 0;

92377 #i‚de‡
SQLITE_OMIT_TRIGGER


92378 
isVõw
;

92379 
Triggî
 *
pTriggî
;

92380 
tmask
;

92383 
db
 = 
pP¨£
->db;

92384 
	`mem£t
(&
de°
, 0, (dest));

92385 if–
pP¨£
->
nEº
 || 
db
->
mÆlocFaûed
 ){

92386 
ö£π_˛ónup
;

92391 
	`as£π
–
pTabLi°
->
nSrc
==1 );

92392 
zTab
 = 
pTabLi°
->
a
[0].
zName
;

92393 if–
	`NEVER
(
zTab
==0ËË
ö£π_˛ónup
;

92394 
pTab
 = 
	`sqlôe3SrcLi°Lookup
(
pP¨£
, 
pTabLi°
);

92395 if–
pTab
==0 ){

92396 
ö£π_˛ónup
;

92398 
iDb
 = 
	`sqlôe3SchemaToIndex
(
db
, 
pTab
->
pSchema
);

92399 
	`as£π
–
iDb
<
db
->
nDb
 );

92400 
pDb
 = &
db
->
aDb
[
iDb
];

92401 
zDb
 = 
pDb
->
zName
;

92402 if–
	`sqlôe3AuthCheck
(
pP¨£
, 
SQLITE_INSERT
, 
pTab
->
zName
, 0, 
zDb
) ){

92403 
ö£π_˛ónup
;

92409 #i‚de‡
SQLITE_OMIT_TRIGGER


92410 
pTriggî
 = 
	`sqlôe3TriggîsExi°
(
pP¨£
, 
pTab
, 
TK_INSERT
, 0, &
tmask
);

92411 
isVõw
 = 
pTab
->
pSñe˘
!=0;

92413 
	#pTriggî
 0

	)

92414 
	#tmask
 0

	)

92415 
	#isVõw
 0

	)

92417 #ifde‡
SQLITE_OMIT_VIEW


92418 #unde‡
isVõw


92419 
	#isVõw
 0

	)

92421 
	`as£π
–(
pTriggî
 && 
tmask
) || (pTrigger==0 &&Åmask==0) );

92427 if–
	`sqlôe3VõwGëCﬁumnNames
(
pP¨£
, 
pTab
) ){

92428 
ö£π_˛ónup
;

92435 if–
	`sqlôe3IsRódO∆y
(
pP¨£
, 
pTab
, 
tmask
) ){

92436 
ö£π_˛ónup
;

92441 
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

92442 if–
v
==0 ) 
ö£π_˛ónup
;

92443 if–
pP¨£
->
√°ed
==0 ) 
	`sqlôe3VdbeCou¡Ch™ges
(
v
);

92444 
	`sqlôe3BegöWrôeO≥øti⁄
(
pP¨£
, 
pSñe˘
 || 
pTriggî
, 
iDb
);

92446 #i‚de‡
SQLITE_OMIT_XFER_OPT


92456 if–
pCﬁumn
==0 && 
	`x„rO±imiz©i⁄
(
pP¨£
, 
pTab
, 
pSñe˘
, 
⁄Eº‹
, 
iDb
) ){

92457 
	`as£π
–!
pTriggî
 );

92458 
	`as£π
–
pLi°
==0 );

92459 
ö£π_íd
;

92466 
ªgAutoöc
 = 
	`autoIncBegö
(
pP¨£
, 
iDb
, 
pTab
);

92473 if–
pSñe˘
 ){

92476 
rc
 = 
	`sqlôe3CodeC‹outöe
(
pP¨£
, 
pSñe˘
, &
de°
);

92477 if–
rc
 ) 
ö£π_˛ónup
;

92479 
ªgEof
 = 
de°
.
iSDP¨m
 + 1;

92480 
ªgFromSñe˘
 = 
de°
.
iSd°
;

92481 
	`as£π
–
pSñe˘
->
pELi°
 );

92482 
nCﬁumn
 = 
pSñe˘
->
pELi°
->
nEx¥
;

92483 
	`as£π
–
de°
.
nSd°
==
nCﬁumn
 );

92494 if–
pTriggî
 || 
	`ªadsTabÀ
(
pP¨£
, 
addrSñe˘
, 
iDb
, 
pTab
) ){

92495 
u£TempTabÀ
 = 1;

92498 if–
u£TempTabÀ
 ){

92510 
ªgRec
;

92511 
ªgTempRowid
;

92512 
addrT›
;

92513 
addrIf
;

92515 
§cTab
 = 
pP¨£
->
nTab
++;

92516 
ªgRec
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

92517 
ªgTempRowid
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

92518 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_O≥nEphemîÆ
, 
§cTab
, 
nCﬁumn
);

92519 
addrT›
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Yõld
, 
de°
.
iSDP¨m
);

92520 
addrIf
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_If
, 
ªgEof
);

92521 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_MakeRec‹d
, 
ªgFromSñe˘
, 
nCﬁumn
, 
ªgRec
);

92522 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NewRowid
, 
§cTab
, 
ªgTempRowid
);

92523 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_In£π
, 
§cTab
, 
ªgRec
, 
ªgTempRowid
);

92524 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_GŸo
, 0, 
addrT›
);

92525 
	`sqlôe3VdbeJumpHîe
(
v
, 
addrIf
);

92526 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
ªgRec
);

92527 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
ªgTempRowid
);

92533 
NameC⁄ãxt
 
sNC
;

92534 
	`mem£t
(&
sNC
, 0, (sNC));

92535 
sNC
.
pP¨£
 =ÖParse;

92536 
§cTab
 = -1;

92537 
	`as£π
–
u£TempTabÀ
==0 );

92538 
nCﬁumn
 = 
pLi°
 ?ÖLi°->
nEx¥
 : 0;

92539 
i
=0; i<
nCﬁumn
; i++){

92540 if–
	`sqlôe3ResﬁveEx¥Names
(&
sNC
, 
pLi°
->
a
[
i
].
pEx¥
) ){

92541 
ö£π_˛ónup
;

92549 if–
	`IsVútuÆ
(
pTab
) ){

92550 
i
=0; i<
pTab
->
nCﬁ
; i++){

92551 
nHiddí
 +(
	`IsHiddíCﬁumn
(&
pTab
->
aCﬁ
[
i
]) ? 1 : 0);

92554 if–
pCﬁumn
==0 && 
nCﬁumn
 &&ÇCﬁumn!=(
pTab
->
nCﬁ
-
nHiddí
) ){

92555 
	`sqlôe3Eº‹Msg
(
pP¨£
,

92557 
pTabLi°
, 0, 
pTab
->
nCﬁ
-
nHiddí
, 
nCﬁumn
);

92558 
ö£π_˛ónup
;

92560 if–
pCﬁumn
!=0 && 
nCﬁumn
!ıCﬁumn->
nId
 ){

92561 
	`sqlôe3Eº‹Msg
(
pP¨£
, "%d vÆue†f‹ %d cﬁumns", 
nCﬁumn
, 
pCﬁumn
->
nId
);

92562 
ö£π_˛ónup
;

92576 if–
pCﬁumn
 ){

92577 
i
=0; i<
pCﬁumn
->
nId
; i++){

92578 
pCﬁumn
->
a
[
i
].
idx
 = -1;

92580 
i
=0; i<
pCﬁumn
->
nId
; i++){

92581 
j
=0; j<
pTab
->
nCﬁ
; j++){

92582 if–
	`sqlôe3SåICmp
(
pCﬁumn
->
a
[
i
].
zName
, 
pTab
->
aCﬁ
[
j
].zName)==0 ){

92583 
pCﬁumn
->
a
[
i
].
idx
 = 
j
;

92584 if–
j
==
pTab
->
iPKey
 ){

92585 
keyCﬁumn
 = 
i
;

92590 if–
j
>=
pTab
->
nCﬁ
 ){

92591 if–
	`sqlôe3IsRowid
(
pCﬁumn
->
a
[
i
].
zName
) ){

92592 
keyCﬁumn
 = 
i
;

92594 
	`sqlôe3Eº‹Msg
(
pP¨£
, "table %S hasÇo columnÇamed %s",

92595 
pTabLi°
, 0, 
pCﬁumn
->
a
[
i
].
zName
);

92596 
pP¨£
->
checkSchema
 = 1;

92597 
ö£π_˛ónup
;

92607 if–
pCﬁumn
==0 && 
nCﬁumn
>0 ){

92608 
keyCﬁumn
 = 
pTab
->
iPKey
;

92613 if–
db
->
Êags
 & 
SQLITE_Cou¡Rows
 ){

92614 
ªgRowCou¡
 = ++
pP¨£
->
nMem
;

92615 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 0, 
ªgRowCou¡
);

92619 if–!
isVõw
 ){

92620 
nIdx
;

92622 
ba£Cur
 = 
pP¨£
->
nTab
;

92623 
nIdx
 = 
	`sqlôe3O≥nTabÀAndIndi˚s
(
pP¨£
, 
pTab
, 
ba£Cur
, 
OP_O≥nWrôe
);

92624 
aRegIdx
 = 
	`sqlôe3DbMÆlocRaw
(
db
, ()*(
nIdx
+1));

92625 if–
aRegIdx
==0 ){

92626 
ö£π_˛ónup
;

92628 
i
=0; i<
nIdx
; i++){

92629 
aRegIdx
[
i
] = ++
pP¨£
->
nMem
;

92634 if–
u£TempTabÀ
 ){

92644 
addrInsT›
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Rewöd
, 
§cTab
);

92645 
addrC⁄t
 = 
	`sqlôe3VdbeCuºítAddr
(
v
);

92646 }if–
pSñe˘
 ){

92656 
addrC⁄t
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Yõld
, 
de°
.
iSDP¨m
);

92657 
addrInsT›
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_If
, 
ªgEof
);

92663 
ªgRowid
 = 
ªgIns
 = 
pP¨£
->
nMem
+1;

92664 
pP¨£
->
nMem
 +
pTab
->
nCﬁ
 + 1;

92665 if–
	`IsVútuÆ
(
pTab
) ){

92666 
ªgRowid
++;

92667 
pP¨£
->
nMem
++;

92669 
ªgD©a
 = 
ªgRowid
+1;

92673 
ídOfLo›
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

92674 if–
tmask
 & 
TRIGGER_BEFORE
 ){

92675 
ªgCﬁs
 = 
	`sqlôe3GëTempR™ge
(
pP¨£
, 
pTab
->
nCﬁ
+1);

92683 if–
keyCﬁumn
<0 ){

92684 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, -1, 
ªgCﬁs
);

92686 
j1
;

92687 if–
u£TempTabÀ
 ){

92688 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Cﬁumn
, 
§cTab
, 
keyCﬁumn
, 
ªgCﬁs
);

92690 
	`as£π
–
pSñe˘
==0 );

92691 
	`sqlôe3Ex¥Code
(
pP¨£
, 
pLi°
->
a
[
keyCﬁumn
].
pEx¥
, 
ªgCﬁs
);

92693 
j1
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_NŸNuŒ
, 
ªgCﬁs
);

92694 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, -1, 
ªgCﬁs
);

92695 
	`sqlôe3VdbeJumpHîe
(
v
, 
j1
);

92696 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Mu°BeI¡
, 
ªgCﬁs
);

92702 
	`as£π
–!
	`IsVútuÆ
(
pTab
) );

92706 
i
=0; i<
pTab
->
nCﬁ
; i++){

92707 if–
pCﬁumn
==0 ){

92708 
j
 = 
i
;

92710 
j
=0; j<
pCﬁumn
->
nId
; j++){

92711 if–
pCﬁumn
->
a
[
j
].
idx
==
i
 ) ;

92714 if–(!
u£TempTabÀ
 && !
pLi°
Ë|| (
pCﬁumn
 && 
j
>ıCﬁumn->
nId
) ){

92715 
	`sqlôe3Ex¥Code
(
pP¨£
, 
pTab
->
aCﬁ
[
i
].
pDÊt
, 
ªgCﬁs
+i+1);

92716 }if–
u£TempTabÀ
 ){

92717 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Cﬁumn
, 
§cTab
, 
j
, 
ªgCﬁs
+
i
+1);

92719 
	`as£π
–
pSñe˘
==0 );

92720 
	`sqlôe3Ex¥CodeAndCache
(
pP¨£
, 
pLi°
->
a
[
j
].
pEx¥
, 
ªgCﬁs
+
i
+1);

92729 if–!
isVõw
 ){

92730 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Afföôy
, 
ªgCﬁs
+1, 
pTab
->
nCﬁ
);

92731 
	`sqlôe3TabÀAfföôySå
(
v
, 
pTab
);

92735 
	`sqlôe3CodeRowTriggî
(
pP¨£
, 
pTriggî
, 
TK_INSERT
, 0, 
TRIGGER_BEFORE
,

92736 
pTab
, 
ªgCﬁs
-pTab->
nCﬁ
-1, 
⁄Eº‹
, 
ídOfLo›
);

92738 
	`sqlôe3Rñó£TempR™ge
(
pP¨£
, 
ªgCﬁs
, 
pTab
->
nCﬁ
+1);

92746 if–!
isVõw
 ){

92747 if–
	`IsVútuÆ
(
pTab
) ){

92749 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NuŒ
, 0, 
ªgIns
);

92751 if–
keyCﬁumn
>=0 ){

92752 if–
u£TempTabÀ
 ){

92753 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Cﬁumn
, 
§cTab
, 
keyCﬁumn
, 
ªgRowid
);

92754 }if–
pSñe˘
 ){

92755 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_SC›y
, 
ªgFromSñe˘
+
keyCﬁumn
, 
ªgRowid
);

92757 
VdbeOp
 *
pOp
;

92758 
	`sqlôe3Ex¥Code
(
pP¨£
, 
pLi°
->
a
[
keyCﬁumn
].
pEx¥
, 
ªgRowid
);

92759 
pOp
 = 
	`sqlôe3VdbeGëOp
(
v
, -1);

92760 if–
	`ALWAYS
(
pOp
Ë&&ÖOp->
›code
==
OP_NuŒ
 && !
	`IsVútuÆ
(
pTab
) ){

92761 
≠≥ndFœg
 = 1;

92762 
pOp
->
›code
 = 
OP_NewRowid
;

92763 
pOp
->
p1
 = 
ba£Cur
;

92764 
pOp
->
p2
 = 
ªgRowid
;

92765 
pOp
->
p3
 = 
ªgAutoöc
;

92771 if–!
≠≥ndFœg
 ){

92772 
j1
;

92773 if–!
	`IsVútuÆ
(
pTab
) ){

92774 
j1
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_NŸNuŒ
, 
ªgRowid
);

92775 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_NewRowid
, 
ba£Cur
, 
ªgRowid
, 
ªgAutoöc
);

92776 
	`sqlôe3VdbeJumpHîe
(
v
, 
j1
);

92778 
j1
 = 
	`sqlôe3VdbeCuºítAddr
(
v
);

92779 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_IsNuŒ
, 
ªgRowid
, 
j1
+2);

92781 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Mu°BeI¡
, 
ªgRowid
);

92783 }if–
	`IsVútuÆ
(
pTab
) ){

92784 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NuŒ
, 0, 
ªgRowid
);

92786 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_NewRowid
, 
ba£Cur
, 
ªgRowid
, 
ªgAutoöc
);

92787 
≠≥ndFœg
 = 1;

92789 
	`autoIncSãp
(
pP¨£
, 
ªgAutoöc
, 
ªgRowid
);

92794 
nHiddí
 = 0;

92795 
i
=0; i<
pTab
->
nCﬁ
; i++){

92796 
iRegSt‹e
 = 
ªgRowid
+1+
i
;

92797 if–
i
==
pTab
->
iPKey
 ){

92802 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NuŒ
, 0, 
iRegSt‹e
);

92805 if–
pCﬁumn
==0 ){

92806 if–
	`IsHiddíCﬁumn
(&
pTab
->
aCﬁ
[
i
]) ){

92807 
	`as£π
–
	`IsVútuÆ
(
pTab
) );

92808 
j
 = -1;

92809 
nHiddí
++;

92811 
j
 = 
i
 - 
nHiddí
;

92814 
j
=0; j<
pCﬁumn
->
nId
; j++){

92815 if–
pCﬁumn
->
a
[
j
].
idx
==
i
 ) ;

92818 if–
j
<0 || 
nCﬁumn
==0 || (
pCﬁumn
 && j>ıCﬁumn->
nId
) ){

92819 
	`sqlôe3Ex¥Code
(
pP¨£
, 
pTab
->
aCﬁ
[
i
].
pDÊt
, 
iRegSt‹e
);

92820 }if–
u£TempTabÀ
 ){

92821 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Cﬁumn
, 
§cTab
, 
j
, 
iRegSt‹e
);

92822 }if–
pSñe˘
 ){

92823 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_SC›y
, 
ªgFromSñe˘
+
j
, 
iRegSt‹e
);

92825 
	`sqlôe3Ex¥Code
(
pP¨£
, 
pLi°
->
a
[
j
].
pEx¥
, 
iRegSt‹e
);

92832 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


92833 if–
	`IsVútuÆ
(
pTab
) ){

92834 c⁄° *
pVTab
 = (c⁄° *)
	`sqlôe3GëVTabÀ
(
db
, 
pTab
);

92835 
	`sqlôe3VèbMakeWrôabÀ
(
pP¨£
, 
pTab
);

92836 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_VUpd©e
, 1, 
pTab
->
nCﬁ
+2, 
ªgIns
, 
pVTab
, 
P4_VTAB
);

92837 
	`sqlôe3VdbeCh™geP5
(
v
, 
⁄Eº‹
==
OE_DeÁu…
 ? 
OE_Ab‹t
 : onError);

92838 
	`sqlôe3MayAb‹t
(
pP¨£
);

92842 
isRïœ˚
;

92843 
	`sqlôe3Gíî©eC⁄°øötChecks
(
pP¨£
, 
pTab
, 
ba£Cur
, 
ªgIns
, 
aRegIdx
,

92844 
keyCﬁumn
>=0, 0, 
⁄Eº‹
, 
ídOfLo›
, &
isRïœ˚


92846 
	`sqlôe3FkCheck
(
pP¨£
, 
pTab
, 0, 
ªgIns
, 0, 0);

92847 
	`sqlôe3Com∂ëeIn£πi⁄
(

92848 
pP¨£
, 
pTab
, 
ba£Cur
, 
ªgIns
, 
aRegIdx
, 0, 
≠≥ndFœg
, 
isRïœ˚
==0

92855 if–(
db
->
Êags
 & 
SQLITE_Cou¡Rows
)!=0 ){

92856 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_AddImm
, 
ªgRowCou¡
, 1);

92859 if–
pTriggî
 ){

92861 
	`sqlôe3CodeRowTriggî
(
pP¨£
, 
pTriggî
, 
TK_INSERT
, 0, 
TRIGGER_AFTER
,

92862 
pTab
, 
ªgD©a
-2-pTab->
nCﬁ
, 
⁄Eº‹
, 
ídOfLo›
);

92868 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
ídOfLo›
);

92869 if–
u£TempTabÀ
 ){

92870 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Next
, 
§cTab
, 
addrC⁄t
);

92871 
	`sqlôe3VdbeJumpHîe
(
v
, 
addrInsT›
);

92872 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Clo£
, 
§cTab
);

92873 }if–
pSñe˘
 ){

92874 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_GŸo
, 0, 
addrC⁄t
);

92875 
	`sqlôe3VdbeJumpHîe
(
v
, 
addrInsT›
);

92878 if–!
	`IsVútuÆ
(
pTab
Ë&& !
isVõw
 ){

92880 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Clo£
, 
ba£Cur
);

92881 
idx
=1, 
pIdx
=
pTab
->
pIndex
;ÖIdx;ÖIdxıIdx->
pNext
, idx++){

92882 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Clo£
, 
idx
+
ba£Cur
);

92886 
ö£π_íd
:

92891 if–
pP¨£
->
√°ed
==0 &&ÖP¨£->
pTriggîTab
==0 ){

92892 
	`sqlôe3Autoö¸emítEnd
(
pP¨£
);

92900 if–(
db
->
Êags
&
SQLITE_Cou¡Rows
Ë&& !
pP¨£
->
√°ed
 && !pP¨£->
pTriggîTab
 ){

92901 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Resu…Row
, 
ªgRowCou¡
, 1);

92902 
	`sqlôe3VdbeSëNumCﬁs
(
v
, 1);

92903 
	`sqlôe3VdbeSëCﬁName
(
v
, 0, 
COLNAME_NAME
, "row†ö£πed", 
SQLITE_STATIC
);

92906 
ö£π_˛ónup
:

92907 
	`sqlôe3SrcLi°Dñëe
(
db
, 
pTabLi°
);

92908 
	`sqlôe3Ex¥Li°Dñëe
(
db
, 
pLi°
);

92909 
	`sqlôe3Sñe˘Dñëe
(
db
, 
pSñe˘
);

92910 
	`sqlôe3IdLi°Dñëe
(
db
, 
pCﬁumn
);

92911 
	`sqlôe3DbFªe
(
db
, 
aRegIdx
);

92917 #ifde‡
isVõw


92918 #unde‡
isVõw


92920 #ifde‡
pTriggî


92921 #unde‡
pTriggî


92923 #ifde‡
tmask


92924 #unde‡
tmask


93003 
SQLITE_PRIVATE
 
	`sqlôe3Gíî©eC⁄°øötChecks
(

93004 
P¨£
 *
pP¨£
,

93005 
TabÀ
 *
pTab
,

93006 
ba£Cur
,

93007 
ªgRowid
,

93008 *
aRegIdx
,

93009 
rowidChng
,

93010 
isUpd©e
,

93011 
ovîrideEº‹
,

93012 
ign‹eDe°
,

93013 *
pbMayRïœ˚


93015 
i
;

93016 
Vdbe
 *
v
;

93017 
nCﬁ
;

93018 
⁄Eº‹
;

93019 
j1
;

93020 
j2
 = 0, 
j3
;

93021 
ªgD©a
;

93022 
iCur
;

93023 
Index
 *
pIdx
;

93024 
sqlôe3
 *
db
;

93025 
£íRïœ˚
 = 0;

93026 
ªgOldRowid
 = (
rowidChng
 && 
isUpd©e
Ë?ÑowidChng : 
ªgRowid
;

93028 
db
 = 
pP¨£
->db;

93029 
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

93030 
	`as£π
–
v
!=0 );

93031 
	`as£π
–
pTab
->
pSñe˘
==0 );

93032 
nCﬁ
 = 
pTab
->nCol;

93033 
ªgD©a
 = 
ªgRowid
 + 1;

93037 
i
=0; i<
nCﬁ
; i++){

93038 if–
i
==
pTab
->
iPKey
 ){

93041 
⁄Eº‹
 = 
pTab
->
aCﬁ
[
i
].
nŸNuŒ
;

93042 if–
⁄Eº‹
==
OE_N⁄e
 ) ;

93043 if–
ovîrideEº‹
!=
OE_DeÁu…
 ){

93044 
⁄Eº‹
 = 
ovîrideEº‹
;

93045 }if–
⁄Eº‹
==
OE_DeÁu…
 ){

93046 
⁄Eº‹
 = 
OE_Ab‹t
;

93048 if–
⁄Eº‹
==
OE_Rïœ˚
 && 
pTab
->
aCﬁ
[
i
].
pDÊt
==0 ){

93049 
⁄Eº‹
 = 
OE_Ab‹t
;

93051 
	`as£π
–
⁄Eº‹
==
OE_Rﬁlback
 || onEº‹==
OE_Ab‹t
 || onEº‹==
OE_Faû


93052 || 
⁄Eº‹
==
OE_Ign‹e
 || onEº‹==
OE_Rïœ˚
 );

93053  
⁄Eº‹
 ){

93054 
OE_Ab‹t
:

93055 
	`sqlôe3MayAb‹t
(
pP¨£
);

93056 
OE_Rﬁlback
:

93057 
OE_Faû
: {

93058 *
zMsg
;

93059 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_HÆtIfNuŒ
,

93060 
SQLITE_CONSTRAINT_NOTNULL
, 
⁄Eº‹
, 
ªgD©a
+
i
);

93061 
zMsg
 = 
	`sqlôe3MPrötf
(
db
, "%s.%s mayÇot be NULL",

93062 
pTab
->
zName
,ÖTab->
aCﬁ
[
i
].zName);

93063 
	`sqlôe3VdbeCh™geP4
(
v
, -1, 
zMsg
, 
P4_DYNAMIC
);

93066 
OE_Ign‹e
: {

93067 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_IsNuŒ
, 
ªgD©a
+
i
, 
ign‹eDe°
);

93071 
	`as£π
–
⁄Eº‹
==
OE_Rïœ˚
 );

93072 
j1
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_NŸNuŒ
, 
ªgD©a
+
i
);

93073 
	`sqlôe3Ex¥Code
(
pP¨£
, 
pTab
->
aCﬁ
[
i
].
pDÊt
, 
ªgD©a
+i);

93074 
	`sqlôe3VdbeJumpHîe
(
v
, 
j1
);

93082 #i‚de‡
SQLITE_OMIT_CHECK


93083 if–
pTab
->
pCheck
 && (
db
->
Êags
 & 
SQLITE_Ign‹eChecks
)==0 ){

93084 
Ex¥Li°
 *
pCheck
 = 
pTab
->pCheck;

93085 
pP¨£
->
ckBa£
 = 
ªgD©a
;

93086 
⁄Eº‹
 = 
ovîrideEº‹
!=
OE_DeÁu…
 ? ovîrideEº‹ : 
OE_Ab‹t
;

93087 
i
=0; i<
pCheck
->
nEx¥
; i++){

93088 
ÆlOk
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

93089 
	`sqlôe3Ex¥IfTrue
(
pP¨£
, 
pCheck
->
a
[
i
].
pEx¥
, 
ÆlOk
, 
SQLITE_JUMPIFNULL
);

93090 if–
⁄Eº‹
==
OE_Ign‹e
 ){

93091 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_GŸo
, 0, 
ign‹eDe°
);

93093 *
zC⁄sName
 = 
pCheck
->
a
[
i
].
zName
;

93094 if–
⁄Eº‹
==
OE_Rïœ˚
 ) onEº‹ = 
OE_Ab‹t
;

93095 if–
zC⁄sName
 ){

93096 
zC⁄sName
 = 
	`sqlôe3MPrötf
(
db
, "constraint %s failed", zConsName);

93098 
zC⁄sName
 = 0;

93100 
	`sqlôe3HÆtC⁄°øöt
(
pP¨£
, 
SQLITE_CONSTRAINT_CHECK
,

93101 
⁄Eº‹
, 
zC⁄sName
, 
P4_DYNAMIC
);

93103 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
ÆlOk
);

93112 if–
rowidChng
 ){

93113 
⁄Eº‹
 = 
pTab
->
keyC⁄f
;

93114 if–
ovîrideEº‹
!=
OE_DeÁu…
 ){

93115 
⁄Eº‹
 = 
ovîrideEº‹
;

93116 }if–
⁄Eº‹
==
OE_DeÁu…
 ){

93117 
⁄Eº‹
 = 
OE_Ab‹t
;

93120 if–
isUpd©e
 ){

93121 
j2
 = 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Eq
, 
ªgRowid
, 0, 
rowidChng
);

93123 
j3
 = 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_NŸExi°s
, 
ba£Cur
, 0, 
ªgRowid
);

93124  
⁄Eº‹
 ){

93126 
⁄Eº‹
 = 
OE_Ab‹t
;

93129 
OE_Rﬁlback
:

93130 
OE_Ab‹t
:

93131 
OE_Faû
: {

93132 
	`sqlôe3HÆtC⁄°øöt
(
pP¨£
, 
SQLITE_CONSTRAINT_PRIMARYKEY
,

93133 
⁄Eº‹
, "PRIMARY KEY mu° bêunique", 
P4_STATIC
);

93136 
OE_Rïœ˚
: {

93159 
Triggî
 *
pTriggî
 = 0;

93160 if–
db
->
Êags
&
SQLITE_RecTriggîs
 ){

93161 
pTriggî
 = 
	`sqlôe3TriggîsExi°
(
pP¨£
, 
pTab
, 
TK_DELETE
, 0, 0);

93163 if–
pTriggî
 || 
	`sqlôe3FkRequúed
(
pP¨£
, 
pTab
, 0, 0) ){

93164 
	`sqlôe3Mu…iWrôe
(
pP¨£
);

93165 
	`sqlôe3Gíî©eRowDñëe
(

93166 
pP¨£
, 
pTab
, 
ba£Cur
, 
ªgRowid
, 0, 
pTriggî
, 
OE_Rïœ˚


93168 }if–
pTab
->
pIndex
 ){

93169 
	`sqlôe3Mu…iWrôe
(
pP¨£
);

93170 
	`sqlôe3Gíî©eRowIndexDñëe
(
pP¨£
, 
pTab
, 
ba£Cur
, 0);

93172 
£íRïœ˚
 = 1;

93175 
OE_Ign‹e
: {

93176 
	`as£π
–
£íRïœ˚
==0 );

93177 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_GŸo
, 0, 
ign‹eDe°
);

93181 
	`sqlôe3VdbeJumpHîe
(
v
, 
j3
);

93182 if–
isUpd©e
 ){

93183 
	`sqlôe3VdbeJumpHîe
(
v
, 
j2
);

93191 
iCur
=0, 
pIdx
=
pTab
->
pIndex
;ÖIdx;ÖIdxıIdx->
pNext
, iCur++){

93192 
ªgIdx
;

93193 
ªgR
;

93194 
addrSkùRow
 = 0;

93196 if–
aRegIdx
[
iCur
]==0 ) ;

93198 if–
pIdx
->
pP¨tIdxWhîe
 ){

93199 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NuŒ
, 0, 
aRegIdx
[
iCur
]);

93200 
addrSkùRow
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

93201 
pP¨£
->
ckBa£
 = 
ªgD©a
;

93202 
	`sqlôe3Ex¥IfFÆ£
(
pP¨£
, 
pIdx
->
pP¨tIdxWhîe
, 
addrSkùRow
,

93203 
SQLITE_JUMPIFNULL
);

93204 
pP¨£
->
ckBa£
 = 0;

93208 
ªgIdx
 = 
	`sqlôe3GëTempR™ge
(
pP¨£
, 
pIdx
->
nCﬁumn
+1);

93209 
i
=0; i<
pIdx
->
nCﬁumn
; i++){

93210 
idx
 = 
pIdx
->
aiCﬁumn
[
i
];

93211 if–
idx
==
pTab
->
iPKey
 ){

93212 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_SC›y
, 
ªgRowid
, 
ªgIdx
+
i
);

93214 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_SC›y
, 
ªgD©a
+
idx
, 
ªgIdx
+
i
);

93217 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_SC›y
, 
ªgRowid
, 
ªgIdx
+
i
);

93218 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_MakeRec‹d
, 
ªgIdx
, 
pIdx
->
nCﬁumn
+1, 
aRegIdx
[
iCur
]);

93219 
	`sqlôe3VdbeCh™geP4
(
v
, -1, 
	`sqlôe3IndexAfföôySå
(v, 
pIdx
), 
P4_TRANSIENT
);

93220 
	`sqlôe3Ex¥CacheAfföôyCh™ge
(
pP¨£
, 
ªgIdx
, 
pIdx
->
nCﬁumn
+1);

93223 
⁄Eº‹
 = 
pIdx
->onError;

93224 if–
⁄Eº‹
==
OE_N⁄e
 ){

93225 
	`sqlôe3Rñó£TempR™ge
(
pP¨£
, 
ªgIdx
, 
pIdx
->
nCﬁumn
+1);

93226 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
addrSkùRow
);

93229 if–
ovîrideEº‹
!=
OE_DeÁu…
 ){

93230 
⁄Eº‹
 = 
ovîrideEº‹
;

93231 }if–
⁄Eº‹
==
OE_DeÁu…
 ){

93232 
⁄Eº‹
 = 
OE_Ab‹t
;

93234 if–
£íRïœ˚
 ){

93235 if–
⁄Eº‹
==
OE_Ign‹e
 ) onEº‹ = 
OE_Rïœ˚
;

93236 if–
⁄Eº‹
==
OE_Faû
 ) onEº‹ = 
OE_Ab‹t
;

93240 
ªgR
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

93241 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_SC›y
, 
ªgOldRowid
, 
ªgR
);

93242 
j3
 = 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_IsUnique
, 
ba£Cur
+
iCur
+1, 0,

93243 
ªgR
, 
	`SQLITE_INT_TO_PTR
(
ªgIdx
),

93244 
P4_INT32
);

93245 
	`sqlôe3Rñó£TempR™ge
(
pP¨£
, 
ªgIdx
, 
pIdx
->
nCﬁumn
+1);

93248 
	`as£π
–
⁄Eº‹
==
OE_Rﬁlback
 || onEº‹==
OE_Ab‹t
 || onEº‹==
OE_Faû


93249 || 
⁄Eº‹
==
OE_Ign‹e
 || onEº‹==
OE_Rïœ˚
 );

93250  
⁄Eº‹
 ){

93251 
OE_Rﬁlback
:

93252 
OE_Ab‹t
:

93253 
OE_Faû
: {

93254 
j
;

93255 
SåAccum
 
îrMsg
;

93256 c⁄° *
zSï
;

93257 *
zEº
;

93259 
	`sqlôe3SåAccumInô
(&
îrMsg
, 0, 0, 200);

93260 
îrMsg
.
db
 = db;

93261 
zSï
 = 
pIdx
->
nCﬁumn
>1 ? "columns " : "column ";

93262 
j
=0; j<
pIdx
->
nCﬁumn
; j++){

93263 *
zCﬁ
 = 
pTab
->
aCﬁ
[
pIdx
->
aiCﬁumn
[
j
]].
zName
;

93264 
	`sqlôe3SåAccumAµíd
(&
îrMsg
, 
zSï
, -1);

93265 
zSï
 = ", ";

93266 
	`sqlôe3SåAccumAµíd
(&
îrMsg
, 
zCﬁ
, -1);

93268 
	`sqlôe3SåAccumAµíd
(&
îrMsg
,

93269 
pIdx
->
nCﬁumn
>1 ? "áreÇot unique" : " isÇot unique", -1);

93270 
zEº
 = 
	`sqlôe3SåAccumFöish
(&
îrMsg
);

93271 
	`sqlôe3HÆtC⁄°øöt
(
pP¨£
, 
SQLITE_CONSTRAINT_UNIQUE
,

93272 
⁄Eº‹
, 
zEº
, 0);

93273 
	`sqlôe3DbFªe
(
îrMsg
.
db
, 
zEº
);

93276 
OE_Ign‹e
: {

93277 
	`as£π
–
£íRïœ˚
==0 );

93278 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_GŸo
, 0, 
ign‹eDe°
);

93282 
Triggî
 *
pTriggî
 = 0;

93283 
	`as£π
–
⁄Eº‹
==
OE_Rïœ˚
 );

93284 
	`sqlôe3Mu…iWrôe
(
pP¨£
);

93285 if–
db
->
Êags
&
SQLITE_RecTriggîs
 ){

93286 
pTriggî
 = 
	`sqlôe3TriggîsExi°
(
pP¨£
, 
pTab
, 
TK_DELETE
, 0, 0);

93288 
	`sqlôe3Gíî©eRowDñëe
(

93289 
pP¨£
, 
pTab
, 
ba£Cur
, 
ªgR
, 0, 
pTriggî
, 
OE_Rïœ˚


93291 
£íRïœ˚
 = 1;

93295 
	`sqlôe3VdbeJumpHîe
(
v
, 
j3
);

93296 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
addrSkùRow
);

93297 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
ªgR
);

93300 if–
pbMayRïœ˚
 ){

93301 *
pbMayRïœ˚
 = 
£íRïœ˚
;

93314 
SQLITE_PRIVATE
 
	`sqlôe3Com∂ëeIn£πi⁄
(

93315 
P¨£
 *
pP¨£
,

93316 
TabÀ
 *
pTab
,

93317 
ba£Cur
,

93318 
ªgRowid
,

93319 *
aRegIdx
,

93320 
isUpd©e
,

93321 
≠≥ndBüs
,

93322 
u£SìkResu…


93324 
i
;

93325 
Vdbe
 *
v
;

93326 
Index
 *
pIdx
;

93327 
u8
 
pik_Êags
;

93328 
ªgD©a
;

93329 
ªgRec
;

93331 
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

93332 
	`as£π
–
v
!=0 );

93333 
	`as£π
–
pTab
->
pSñe˘
==0 );

93334 
i
=0, 
pIdx
=
pTab
->
pIndex
;ÖIdx;ÖIdxıIdx->
pNext
, i++){

93335 if–
aRegIdx
[
i
]==0 ) ;

93336 if–
pIdx
->
pP¨tIdxWhîe
 ){

93337 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_IsNuŒ
, 
aRegIdx
[
i
], 
	`sqlôe3VdbeCuºítAddr
(v)+2);

93339 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_IdxIn£π
, 
ba£Cur
+
i
+1, 
aRegIdx
[i]);

93340 if–
u£SìkResu…
 ){

93341 
	`sqlôe3VdbeCh™geP5
(
v
, 
OPFLAG_USESEEKRESULT
);

93344 
ªgD©a
 = 
ªgRowid
 + 1;

93345 
ªgRec
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

93346 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_MakeRec‹d
, 
ªgD©a
, 
pTab
->
nCﬁ
, 
ªgRec
);

93347 
	`sqlôe3TabÀAfföôySå
(
v
, 
pTab
);

93348 
	`sqlôe3Ex¥CacheAfföôyCh™ge
(
pP¨£
, 
ªgD©a
, 
pTab
->
nCﬁ
);

93349 if–
pP¨£
->
√°ed
 ){

93350 
pik_Êags
 = 0;

93352 
pik_Êags
 = 
OPFLAG_NCHANGE
;

93353 
pik_Êags
 |(
isUpd©e
?
OPFLAG_ISUPDATE
:
OPFLAG_LASTROWID
);

93355 if–
≠≥ndBüs
 ){

93356 
pik_Êags
 |
OPFLAG_APPEND
;

93358 if–
u£SìkResu…
 ){

93359 
pik_Êags
 |
OPFLAG_USESEEKRESULT
;

93361 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_In£π
, 
ba£Cur
, 
ªgRec
, 
ªgRowid
);

93362 if–!
pP¨£
->
√°ed
 ){

93363 
	`sqlôe3VdbeCh™geP4
(
v
, -1, 
pTab
->
zName
, 
P4_TRANSIENT
);

93365 
	`sqlôe3VdbeCh™geP5
(
v
, 
pik_Êags
);

93375 
SQLITE_PRIVATE
 
	`sqlôe3O≥nTabÀAndIndi˚s
(

93376 
P¨£
 *
pP¨£
,

93377 
TabÀ
 *
pTab
,

93378 
ba£Cur
,

93379 
›


93381 
i
;

93382 
iDb
;

93383 
Index
 *
pIdx
;

93384 
Vdbe
 *
v
;

93386 if–
	`IsVútuÆ
(
pTab
) )  0;

93387 
iDb
 = 
	`sqlôe3SchemaToIndex
(
pP¨£
->
db
, 
pTab
->
pSchema
);

93388 
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

93389 
	`as£π
–
v
!=0 );

93390 
	`sqlôe3O≥nTabÀ
(
pP¨£
, 
ba£Cur
, 
iDb
, 
pTab
, 
›
);

93391 
i
=1, 
pIdx
=
pTab
->
pIndex
;ÖIdx;ÖIdxıIdx->
pNext
, i++){

93392 
KeyInfo
 *
pKey
 = 
	`sqlôe3IndexKeyöfo
(
pP¨£
, 
pIdx
);

93393 
	`as£π
–
pIdx
->
pSchema
==
pTab
->pSchema );

93394 
	`sqlôe3VdbeAddOp4
(
v
, 
›
, 
i
+
ba£Cur
, 
pIdx
->
äum
, 
iDb
,

93395 (*)
pKey
, 
P4_KEYINFO_HANDOFF
);

93396 
	`VdbeCommít
((
v
, "%s", 
pIdx
->
zName
));

93398 if–
pP¨£
->
nTab
<
ba£Cur
+
i
 ){

93399 
pP¨£
->
nTab
 = 
ba£Cur
+
i
;

93401  
i
-1;

93405 #ifde‡
SQLITE_TEST


93412 
SQLITE_API
 
sqlôe3_x„r›t_cou¡
;

93416 #i‚de‡
SQLITE_OMIT_XFER_OPT


93420 
	`x„rCom∑tibÀCﬁœti⁄
(c⁄° *
z1
, c⁄° *
z2
){

93421 if–
z1
==0 ){

93422  
z2
==0;

93424 if–
z2
==0 ){

93427  
	`sqlôe3SåICmp
(
z1
, 
z2
)==0;

93442 
	`x„rCom∑tibÀIndex
(
Index
 *
pDe°
, Index *
pSrc
){

93443 
i
;

93444 
	`as£π
–
pDe°
 && 
pSrc
 );

93445 
	`as£π
–
pDe°
->
pTabÀ
!=
pSrc
->pTable );

93446 if–
pDe°
->
nCﬁumn
!=
pSrc
->nColumn ){

93449 if–
pDe°
->
⁄Eº‹
!=
pSrc
->onError ){

93452 
i
=0; i<
pSrc
->
nCﬁumn
; i++){

93453 if–
pSrc
->
aiCﬁumn
[
i
]!=
pDe°
->aiColumn[i] ){

93456 if–
pSrc
->
aS‹tOrdî
[
i
]!=
pDe°
->aSortOrder[i] ){

93459 if–!
	`x„rCom∑tibÀCﬁœti⁄
(
pSrc
->
azCﬁl
[
i
],
pDe°
->azColl[i]) ){

93463 if–
	`sqlôe3Ex¥Com∑ª
(
pSrc
->
pP¨tIdxWhîe
, 
pDe°
->pPartIdxWhere, -1) ){

93496 
	`x„rO±imiz©i⁄
(

93497 
P¨£
 *
pP¨£
,

93498 
TabÀ
 *
pDe°
,

93499 
Sñe˘
 *
pSñe˘
,

93500 
⁄Eº‹
,

93501 
iDbDe°


93503 
Ex¥Li°
 *
pELi°
;

93504 
TabÀ
 *
pSrc
;

93505 
Index
 *
pSrcIdx
, *
pDe°Idx
;

93506 
SrcLi°_ôem
 *
pIãm
;

93507 
i
;

93508 
iDbSrc
;

93509 
iSrc
, 
iDe°
;

93510 
addr1
, 
addr2
;

93511 
em±yDe°Te°
;

93512 
em±ySrcTe°
;

93513 
Vdbe
 *
v
;

93514 
KeyInfo
 *
pKey
;

93515 
ªgAutoöc
;

93516 
de°HasUniqueIdx
 = 0;

93517 
ªgD©a
, 
ªgRowid
;

93519 if–
pSñe˘
==0 ){

93522 if–
	`sqlôe3TriggîLi°
(
pP¨£
, 
pDe°
) ){

93525 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


93526 if–
pDe°
->
èbFœgs
 & 
TF_VútuÆ
 ){

93530 if–
⁄Eº‹
==
OE_DeÁu…
 ){

93531 if–
pDe°
->
iPKey
>=0 ) 
⁄Eº‹
 =ÖDe°->
keyC⁄f
;

93532 if–
⁄Eº‹
==
OE_DeÁu…
 ) onEº‹ = 
OE_Ab‹t
;

93534 
	`as£π
(
pSñe˘
->
pSrc
);

93535 if–
pSñe˘
->
pSrc
->
nSrc
!=1 ){

93538 if–
pSñe˘
->
pSrc
->
a
[0].pSelect ){

93541 if–
pSñe˘
->
pWhîe
 ){

93544 if–
pSñe˘
->
pOrdîBy
 ){

93549 if–
pSñe˘
->
pGroupBy
 ){

93552 if–
pSñe˘
->
pLimô
 ){

93555 
	`as£π
–
pSñe˘
->
pOff£t
==0 );

93556 if–
pSñe˘
->
pPri‹
 ){

93559 if–
pSñe˘
->
£lFœgs
 & 
SF_Di°ö˘
 ){

93562 
pELi°
 = 
pSñe˘
->pEList;

93563 
	`as£π
–
pELi°
!=0 );

93564 if–
pELi°
->
nEx¥
!=1 ){

93567 
	`as£π
–
pELi°
->
a
[0].
pEx¥
 );

93568 if–
pELi°
->
a
[0].
pEx¥
->
›
!=
TK_ALL
 ){

93576 
pIãm
 = 
pSñe˘
->
pSrc
->
a
;

93577 
pSrc
 = 
	`sqlôe3LoˇãTabÀIãm
(
pP¨£
, 0, 
pIãm
);

93578 if–
pSrc
==0 ){

93581 if–
pSrc
==
pDe°
 ){

93584 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


93585 if–
pSrc
->
èbFœgs
 & 
TF_VútuÆ
 ){

93589 if–
pSrc
->
pSñe˘
 ){

93592 if–
pDe°
->
nCﬁ
!=
pSrc
->nCol ){

93595 if–
pDe°
->
iPKey
!=
pSrc
->iPKey ){

93598 
i
=0; i<
pDe°
->
nCﬁ
; i++){

93599 if–
pDe°
->
aCﬁ
[
i
].
afföôy
!=
pSrc
->aCol[i].affinity ){

93602 if–!
	`x„rCom∑tibÀCﬁœti⁄
(
pDe°
->
aCﬁ
[
i
].
zCﬁl
, 
pSrc
->aCol[i].zColl) ){

93605 if–
pDe°
->
aCﬁ
[
i
].
nŸNuŒ
 && !
pSrc
->aCol[i].notNull ){

93609 
pDe°Idx
=
pDe°
->
pIndex
;ÖDe°Idx;ÖDe°IdxıDe°Idx->
pNext
){

93610 if–
pDe°Idx
->
⁄Eº‹
!=
OE_N⁄e
 ){

93611 
de°HasUniqueIdx
 = 1;

93613 
pSrcIdx
=
pSrc
->
pIndex
;ÖSrcIdx;ÖSrcIdxıSrcIdx->
pNext
){

93614 if–
	`x„rCom∑tibÀIndex
(
pDe°Idx
, 
pSrcIdx
) ) ;

93616 if–
pSrcIdx
==0 ){

93620 #i‚de‡
SQLITE_OMIT_CHECK


93621 if–
pDe°
->
pCheck
 && 
	`sqlôe3Ex¥Li°Com∑ª
(
pSrc
->pCheck,pDest->pCheck,-1) ){

93625 #i‚de‡
SQLITE_OMIT_FOREIGN_KEY


93633 if–(
pP¨£
->
db
->
Êags
 & 
SQLITE_F‹eignKeys
)!=0 && 
pDe°
->
pFKey
!=0 ){

93637 if–(
pP¨£
->
db
->
Êags
 & 
SQLITE_Cou¡Rows
)!=0 ){

93645 #ifde‡
SQLITE_TEST


93646 
sqlôe3_x„r›t_cou¡
++;

93648 
iDbSrc
 = 
	`sqlôe3SchemaToIndex
(
pP¨£
->
db
, 
pSrc
->
pSchema
);

93649 
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

93650 
	`sqlôe3CodeVîifySchema
(
pP¨£
, 
iDbSrc
);

93651 
iSrc
 = 
pP¨£
->
nTab
++;

93652 
iDe°
 = 
pP¨£
->
nTab
++;

93653 
ªgAutoöc
 = 
	`autoIncBegö
(
pP¨£
, 
iDbDe°
, 
pDe°
);

93654 
	`sqlôe3O≥nTabÀ
(
pP¨£
, 
iDe°
, 
iDbDe°
, 
pDe°
, 
OP_O≥nWrôe
);

93655 if–(
pDe°
->
iPKey
<0 &&ÖDe°->
pIndex
!=0)

93656 || 
de°HasUniqueIdx


93657 || (
⁄Eº‹
!=
OE_Ab‹t
 && onEº‹!=
OE_Rﬁlback
)

93673 
addr1
 = 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Rewöd
, 
iDe°
, 0);

93674 
em±yDe°Te°
 = 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_GŸo
, 0, 0);

93675 
	`sqlôe3VdbeJumpHîe
(
v
, 
addr1
);

93677 
em±yDe°Te°
 = 0;

93679 
	`sqlôe3O≥nTabÀ
(
pP¨£
, 
iSrc
, 
iDbSrc
, 
pSrc
, 
OP_O≥nRód
);

93680 
em±ySrcTe°
 = 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Rewöd
, 
iSrc
, 0);

93681 
ªgD©a
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

93682 
ªgRowid
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

93683 if–
pDe°
->
iPKey
>=0 ){

93684 
addr1
 = 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Rowid
, 
iSrc
, 
ªgRowid
);

93685 
addr2
 = 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_NŸExi°s
, 
iDe°
, 0, 
ªgRowid
);

93686 
	`sqlôe3HÆtC⁄°øöt
(
pP¨£
, 
SQLITE_CONSTRAINT_PRIMARYKEY
,

93687 
⁄Eº‹
, "PRIMARY KEY mu° bêunique", 
P4_STATIC
);

93688 
	`sqlôe3VdbeJumpHîe
(
v
, 
addr2
);

93689 
	`autoIncSãp
(
pP¨£
, 
ªgAutoöc
, 
ªgRowid
);

93690 }if–
pDe°
->
pIndex
==0 ){

93691 
addr1
 = 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NewRowid
, 
iDe°
, 
ªgRowid
);

93693 
addr1
 = 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Rowid
, 
iSrc
, 
ªgRowid
);

93694 
	`as£π
–(
pDe°
->
èbFœgs
 & 
TF_Autoö¸emít
)==0 );

93696 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_RowD©a
, 
iSrc
, 
ªgD©a
);

93697 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_In£π
, 
iDe°
, 
ªgD©a
, 
ªgRowid
);

93698 
	`sqlôe3VdbeCh™geP5
(
v
, 
OPFLAG_NCHANGE
|
OPFLAG_LASTROWID
|
OPFLAG_APPEND
);

93699 
	`sqlôe3VdbeCh™geP4
(
v
, -1, 
pDe°
->
zName
, 0);

93700 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Next
, 
iSrc
, 
addr1
);

93701 
pDe°Idx
=
pDe°
->
pIndex
;ÖDe°Idx;ÖDe°IdxıDe°Idx->
pNext
){

93702 
pSrcIdx
=
pSrc
->
pIndex
; 
	`ALWAYS
’SrcIdx);ÖSrcIdxıSrcIdx->
pNext
){

93703 if–
	`x„rCom∑tibÀIndex
(
pDe°Idx
, 
pSrcIdx
) ) ;

93705 
	`as£π
–
pSrcIdx
 );

93706 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Clo£
, 
iSrc
, 0);

93707 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Clo£
, 
iDe°
, 0);

93708 
pKey
 = 
	`sqlôe3IndexKeyöfo
(
pP¨£
, 
pSrcIdx
);

93709 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_O≥nRód
, 
iSrc
, 
pSrcIdx
->
äum
, 
iDbSrc
,

93710 (*)
pKey
, 
P4_KEYINFO_HANDOFF
);

93711 
	`VdbeCommít
((
v
, "%s", 
pSrcIdx
->
zName
));

93712 
pKey
 = 
	`sqlôe3IndexKeyöfo
(
pP¨£
, 
pDe°Idx
);

93713 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_O≥nWrôe
, 
iDe°
, 
pDe°Idx
->
äum
, 
iDbDe°
,

93714 (*)
pKey
, 
P4_KEYINFO_HANDOFF
);

93715 
	`sqlôe3VdbeCh™geP5
(
v
, 
OPFLAG_BULKCSR
);

93716 
	`VdbeCommít
((
v
, "%s", 
pDe°Idx
->
zName
));

93717 
addr1
 = 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Rewöd
, 
iSrc
, 0);

93718 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_RowKey
, 
iSrc
, 
ªgD©a
);

93719 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_IdxIn£π
, 
iDe°
, 
ªgD©a
, 1);

93720 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Next
, 
iSrc
, 
addr1
+1);

93721 
	`sqlôe3VdbeJumpHîe
(
v
, 
addr1
);

93723 
	`sqlôe3VdbeJumpHîe
(
v
, 
em±ySrcTe°
);

93724 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
ªgRowid
);

93725 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
ªgD©a
);

93726 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Clo£
, 
iSrc
, 0);

93727 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Clo£
, 
iDe°
, 0);

93728 if–
em±yDe°Te°
 ){

93729 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_HÆt
, 
SQLITE_OK
, 0);

93730 
	`sqlôe3VdbeJumpHîe
(
v
, 
em±yDe°Te°
);

93731 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Clo£
, 
iDe°
, 0);

93769 
SQLITE_API
 
	`sqlôe3_exec
(

93770 
sqlôe3
 *
db
,

93771 c⁄° *
zSql
,

93772 
sqlôe3_ˇŒback
 
xCÆlback
,

93773 *
pArg
,

93774 **
pzEºMsg


93776 
rc
 = 
SQLITE_OK
;

93777 c⁄° *
zLe·ovî
;

93778 
sqlôe3_°mt
 *
pStmt
 = 0;

93779 **
azCﬁs
 = 0;

93780 
ˇŒbackIsInô
;

93782 if–!
	`sqlôe3Sa„tyCheckOk
(
db
ËË 
SQLITE_MISUSE_BKPT
;

93783 if–
zSql
==0 ) zSql = "";

93785 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

93786 
	`sqlôe3Eº‹
(
db
, 
SQLITE_OK
, 0);

93787  
rc
==
SQLITE_OK
 && 
zSql
[0] ){

93788 
nCﬁ
;

93789 **
azVÆs
 = 0;

93791 
pStmt
 = 0;

93792 
rc
 = 
	`sqlôe3_¥ï¨e_v2
(
db
, 
zSql
, -1, &
pStmt
, &
zLe·ovî
);

93793 
	`as£π
–
rc
==
SQLITE_OK
 || 
pStmt
==0 );

93794 if–
rc
!=
SQLITE_OK
 ){

93797 if–!
pStmt
 ){

93799 
zSql
 = 
zLe·ovî
;

93803 
ˇŒbackIsInô
 = 0;

93804 
nCﬁ
 = 
	`sqlôe3_cﬁumn_cou¡
(
pStmt
);

93807 
i
;

93808 
rc
 = 
	`sqlôe3_°ï
(
pStmt
);

93811 if–
xCÆlback
 && (
SQLITE_ROW
==
rc
 ||

93812 (
SQLITE_DONE
==
rc
 && !
ˇŒbackIsInô


93813 && 
db
->
Êags
&
SQLITE_NuŒCÆlback
)) ){

93814 if–!
ˇŒbackIsInô
 ){

93815 
azCﬁs
 = 
	`sqlôe3DbMÆlocZîo
(
db
, 2*
nCﬁ
*(const *) + 1);

93816 if–
azCﬁs
==0 ){

93817 
exec_out
;

93819 
i
=0; i<
nCﬁ
; i++){

93820 
azCﬁs
[
i
] = (*)
	`sqlôe3_cﬁumn_«me
(
pStmt
, i);

93823 
	`as£π
–
azCﬁs
[
i
]!=0 );

93825 
ˇŒbackIsInô
 = 1;

93827 if–
rc
==
SQLITE_ROW
 ){

93828 
azVÆs
 = &
azCﬁs
[
nCﬁ
];

93829 
i
=0; i<
nCﬁ
; i++){

93830 
azVÆs
[
i
] = (*)
	`sqlôe3_cﬁumn_ãxt
(
pStmt
, i);

93831 if–!
azVÆs
[
i
] && 
	`sqlôe3_cﬁumn_ty≥
(
pStmt
, i)!=
SQLITE_NULL
 ){

93832 
db
->
mÆlocFaûed
 = 1;

93833 
exec_out
;

93837 if–
	`xCÆlback
(
pArg
, 
nCﬁ
, 
azVÆs
, 
azCﬁs
) ){

93838 
rc
 = 
SQLITE_ABORT
;

93839 
	`sqlôe3VdbeFöÆize
((
Vdbe
 *)
pStmt
);

93840 
pStmt
 = 0;

93841 
	`sqlôe3Eº‹
(
db
, 
SQLITE_ABORT
, 0);

93842 
exec_out
;

93846 if–
rc
!=
SQLITE_ROW
 ){

93847 
rc
 = 
	`sqlôe3VdbeFöÆize
((
Vdbe
 *)
pStmt
);

93848 
pStmt
 = 0;

93849 
zSql
 = 
zLe·ovî
;

93850  
	`sqlôe3Is•a˚
(
zSql
[0]) ) zSql++;

93855 
	`sqlôe3DbFªe
(
db
, 
azCﬁs
);

93856 
azCﬁs
 = 0;

93859 
exec_out
:

93860 if–
pStmt
 ) 
	`sqlôe3VdbeFöÆize
((
Vdbe
 *)pStmt);

93861 
	`sqlôe3DbFªe
(
db
, 
azCﬁs
);

93863 
rc
 = 
	`sqlôe3ApiExô
(
db
,Ñc);

93864 if–
rc
!=
SQLITE_OK
 && 
	`ALWAYS
‘c==
	`sqlôe3_îrcode
(
db
)Ë&& 
pzEºMsg
 ){

93865 
nEºMsg
 = 1 + 
	`sqlôe3SåÀn30
(
	`sqlôe3_îrmsg
(
db
));

93866 *
pzEºMsg
 = 
	`sqlôe3MÆloc
(
nEºMsg
);

93867 if–*
pzEºMsg
 ){

93868 
	`mem˝y
(*
pzEºMsg
, 
	`sqlôe3_îrmsg
(
db
), 
nEºMsg
);

93870 
rc
 = 
SQLITE_NOMEM
;

93871 
	`sqlôe3Eº‹
(
db
, 
SQLITE_NOMEM
, 0);

93873 }if–
pzEºMsg
 ){

93874 *
pzEºMsg
 = 0;

93877 
	`as£π
–(
rc
&
db
->
îrMask
)==rc );

93878 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

93879  
rc
;

93899 #i‚de‡
SQLITE_CORE


93900 
	#SQLITE_CORE
 1

	)

93921 #i‚de‡
_SQLITE3EXT_H_


93922 
	#_SQLITE3EXT_H_


	)

93924 
sqlôe3_≠i_routöes
 
	tsqlôe3_≠i_routöes
;

93936 
	ssqlôe3_≠i_routöes
 {

93937 * (*
aggªg©e_c⁄ãxt
)(
sqlôe3_c⁄ãxt
*,
nByãs
);

93938 (*
aggªg©e_cou¡
)(
sqlôe3_c⁄ãxt
*);

93939 (*
böd_blob
)(
sqlôe3_°mt
*,,c⁄° *,
n
,(*)(*));

93940 (*
böd_doubÀ
)(
sqlôe3_°mt
*,,);

93941 (*
böd_öt
)(
sqlôe3_°mt
*,,);

93942 (*
böd_öt64
)(
sqlôe3_°mt
*,,
sqlôe_öt64
);

93943 (*
böd_nuŒ
)(
sqlôe3_°mt
*,);

93944 (*
böd_∑ømëî_cou¡
)(
sqlôe3_°mt
*);

93945 (*
böd_∑ømëî_ödex
)(
sqlôe3_°mt
*,c⁄° *
zName
);

93946 c⁄° * (*
böd_∑ømëî_«me
)(
sqlôe3_°mt
*,);

93947 (*
böd_ãxt
)(
sqlôe3_°mt
*,,c⁄° *,
n
,(*)(*));

93948 (*
böd_ãxt16
)(
sqlôe3_°mt
*,,const *,,(*)(*));

93949 (*
böd_vÆue
)(
sqlôe3_°mt
*,,c⁄° 
sqlôe3_vÆue
*);

93950 (*
busy_h™dÀr
)(
sqlôe3
*,(*)(*,),*);

93951 (*
busy_timeout
)(
sqlôe3
*,
ms
);

93952 (*
ch™ges
)(
sqlôe3
*);

93953 (*
˛o£
)(
sqlôe3
*);

93954 (*
cﬁœti⁄_√eded
)(
sqlôe3
*,*,(*)(*,sqlite3*,

93955 
eTextRï
,const *));

93956 (*
cﬁœti⁄_√eded16
)(
sqlôe3
*,*,(*)(*,sqlite3*,

93957 
eTextRï
,const *));

93958 c⁄° * (*
cﬁumn_blob
)(
sqlôe3_°mt
*,
iCﬁ
);

93959 (*
cﬁumn_byãs
)(
sqlôe3_°mt
*,
iCﬁ
);

93960 (*
cﬁumn_byãs16
)(
sqlôe3_°mt
*,
iCﬁ
);

93961 (*
cﬁumn_cou¡
)(
sqlôe3_°mt
*
pStmt
);

93962 c⁄° * (*
cﬁumn_d©aba£_«me
)(
sqlôe3_°mt
*,);

93963 c⁄° * (*
cﬁumn_d©aba£_«me16
)(
sqlôe3_°mt
*,);

93964 c⁄° * (*
cﬁumn_de˛ty≥
)(
sqlôe3_°mt
*,
i
);

93965 c⁄° * (*
cﬁumn_de˛ty≥16
)(
sqlôe3_°mt
*,);

93966 (*
cﬁumn_doubÀ
)(
sqlôe3_°mt
*,
iCﬁ
);

93967 (*
cﬁumn_öt
)(
sqlôe3_°mt
*,
iCﬁ
);

93968 
	`sqlôe_öt64
 (*
cﬁumn_öt64
)(
sqlôe3_°mt
*,
iCﬁ
);

93969 c⁄° * (*
cﬁumn_«me
)(
sqlôe3_°mt
*,);

93970 c⁄° * (*
cﬁumn_«me16
)(
sqlôe3_°mt
*,);

93971 c⁄° * (*
cﬁumn_‹igö_«me
)(
sqlôe3_°mt
*,);

93972 c⁄° * (*
cﬁumn_‹igö_«me16
)(
sqlôe3_°mt
*,);

93973 c⁄° * (*
cﬁumn_èbÀ_«me
)(
sqlôe3_°mt
*,);

93974 c⁄° * (*
cﬁumn_èbÀ_«me16
)(
sqlôe3_°mt
*,);

93975 c⁄° * (*
cﬁumn_ãxt
)(
sqlôe3_°mt
*,
iCﬁ
);

93976 c⁄° * (*
cﬁumn_ãxt16
)(
sqlôe3_°mt
*,
iCﬁ
);

93977 (*
cﬁumn_ty≥
)(
sqlôe3_°mt
*,
iCﬁ
);

93978 
sqlôe3_vÆue
* (*
cﬁumn_vÆue
)(
sqlôe3_°mt
*,
iCﬁ
);

93979 * (*
commô_hook
)(
sqlôe3
*,(*)(*),*);

93980 (*
com∂ëe
)(c⁄° *
sql
);

93981 (*
com∂ëe16
)(c⁄° *
sql
);

93982 (*
¸óã_cﬁœti⁄
)(
sqlôe3
*,const *,,*,

93984 (*
¸óã_cﬁœti⁄16
)(
sqlôe3
*,const *,,*,

93986 (*
¸óã_fun˘i⁄
)(
sqlôe3
*,const *,,,*,

93987 (*
xFunc
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
**),

93988 (*
xSãp
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
**),

93989 (*
xFöÆ
)(
sqlôe3_c⁄ãxt
*));

93990 (*
¸óã_fun˘i⁄16
)(
sqlôe3
*,const *,,,*,

93991 (*
xFunc
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
**),

93992 (*
xSãp
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
**),

93993 (*
xFöÆ
)(
sqlôe3_c⁄ãxt
*));

93994 (*
¸óã_moduÀ
)(
sqlôe3
*,c⁄° *,c⁄° 
sqlôe3_moduÀ
*,*);

93995 (*
d©a_cou¡
)(
sqlôe3_°mt
*
pStmt
);

93996 
sqlôe3
 * (*
db_h™dÀ
)(
sqlôe3_°mt
*);

93997 (*
de˛¨e_vèb
)(
sqlôe3
*,const *);

93998 (*
íabÀ_sh¨ed_ˇche
)();

93999 (*
îrcode
)(
sqlôe3
*
db
);

94000 c⁄° * (*
îrmsg
)(
sqlôe3
*);

94001 c⁄° * (*
îrmsg16
)(
sqlôe3
*);

94002 (*
exec
)(
sqlôe3
*,c⁄° *,
sqlôe3_ˇŒback
,*,**);

94003 (*
expúed
)(
sqlôe3_°mt
*);

94004 (*
föÆize
)(
sqlôe3_°mt
*
pStmt
);

94005 (*
‰ì
)(*);

94006 (*
‰ì_èbÀ
)(**
ªsu…
);

94007 (*
gë_autocommô
)(
sqlôe3
*);

94008 * (*
gë_auxd©a
)(
sqlôe3_c⁄ãxt
*,);

94009 (*
gë_èbÀ
)(
sqlôe3
*,const *,***,*,*,**);

94010 (*
globÆ_ªcovî
)();

94011 (*
öãºu±x
)(
sqlôe3
*);

94012 
	`sqlôe_öt64
 (*
œ°_ö£π_rowid
)(
sqlôe3
*);

94013 c⁄° * (*
libvîsi⁄
)();

94014 (*
libvîsi⁄_numbî
)();

94015 *(*
mÆloc
)();

94016 * (*
m¥ötf
)(const *,...);

94017 (*
›í
)(c⁄° *,
sqlôe3
**);

94018 (*
›í16
)(c⁄° *,
sqlôe3
**);

94019 (*
¥ï¨e
)(
sqlôe3
*,c⁄° *,,
sqlôe3_°mt
**,const **);

94020 (*
¥ï¨e16
)(
sqlôe3
*,c⁄° *,,
sqlôe3_°mt
**,const **);

94021 * (*
¥ofûe
)(
sqlôe3
*,(*)(*,c⁄° *,
sqlôe_uöt64
),*);

94022 (*
¥ogªss_h™dÀr
)(
sqlôe3
*,,(*)(*),*);

94023 *(*
ªÆloc
)(*,);

94024 (*
ª£t
)(
sqlôe3_°mt
*
pStmt
);

94025 (*
ªsu…_blob
)(
sqlôe3_c⁄ãxt
*,const *,,(*)(*));

94026 (*
ªsu…_doubÀ
)(
sqlôe3_c⁄ãxt
*,);

94027 (*
ªsu…_îr‹
)(
sqlôe3_c⁄ãxt
*,const *,);

94028 (*
ªsu…_îr‹16
)(
sqlôe3_c⁄ãxt
*,const *,);

94029 (*
ªsu…_öt
)(
sqlôe3_c⁄ãxt
*,);

94030 (*
ªsu…_öt64
)(
sqlôe3_c⁄ãxt
*,
sqlôe_öt64
);

94031 (*
ªsu…_nuŒ
)(
sqlôe3_c⁄ãxt
*);

94032 (*
ªsu…_ãxt
)(
sqlôe3_c⁄ãxt
*,const *,,(*)(*));

94033 (*
ªsu…_ãxt16
)(
sqlôe3_c⁄ãxt
*,const *,,(*)(*));

94034 (*
ªsu…_ãxt16be
)(
sqlôe3_c⁄ãxt
*,const *,,(*)(*));

94035 (*
ªsu…_ãxt16À
)(
sqlôe3_c⁄ãxt
*,const *,,(*)(*));

94036 (*
ªsu…_vÆue
)(
sqlôe3_c⁄ãxt
*,
sqlôe3_vÆue
*);

94037 * (*
rﬁlback_hook
)(
sqlôe3
*,(*)(*),*);

94038 (*
£t_auth‹izî
)(
sqlôe3
*,(*)(*,,const *,const *,

94040 (*
£t_auxd©a
)(
sqlôe3_c⁄ãxt
*,,*,(*)(*));

94041 * (*
¢¥ötf
)(,*,const *,...);

94042 (*
°ï
)(
sqlôe3_°mt
*);

94043 (*
èbÀ_cﬁumn_mëad©a
)(
sqlôe3
*,const *,const *,const *,

94045 (*
thªad_˛ónup
)();

94046 (*
tŸÆ_ch™ges
)(
sqlôe3
*);

94047 * (*
åa˚
)(
sqlôe3
*,(*
xTø˚
)(*,const *),*);

94048 (*
å™s„r_bödögs
)(
sqlôe3_°mt
*,sqlite3_stmt*);

94049 * (*
upd©e_hook
)(
sqlôe3
*,(*)(*,,const*,const*,

94050 
sqlôe_öt64
),*);

94051 * (*
u£r_d©a
)(
sqlôe3_c⁄ãxt
*);

94052 c⁄° * (*
vÆue_blob
)(
sqlôe3_vÆue
*);

94053 (*
vÆue_byãs
)(
sqlôe3_vÆue
*);

94054 (*
vÆue_byãs16
)(
sqlôe3_vÆue
*);

94055 (*
vÆue_doubÀ
)(
sqlôe3_vÆue
*);

94056 (*
vÆue_öt
)(
sqlôe3_vÆue
*);

94057 
	`sqlôe_öt64
 (*
vÆue_öt64
)(
sqlôe3_vÆue
*);

94058 (*
vÆue_numîic_ty≥
)(
sqlôe3_vÆue
*);

94059 c⁄° * (*
vÆue_ãxt
)(
sqlôe3_vÆue
*);

94060 c⁄° * (*
vÆue_ãxt16
)(
sqlôe3_vÆue
*);

94061 c⁄° * (*
vÆue_ãxt16be
)(
sqlôe3_vÆue
*);

94062 c⁄° * (*
vÆue_ãxt16À
)(
sqlôe3_vÆue
*);

94063 (*
vÆue_ty≥
)(
sqlôe3_vÆue
*);

94064 *(*
vm¥ötf
)(c⁄° *,
va_li°
);

94066 (*
ovîlﬂd_fun˘i⁄
)(
sqlôe3
*, c⁄° *
zFuncName
, 
nArg
);

94068 (*
¥ï¨e_v2
)(
sqlôe3
*,c⁄° *,,
sqlôe3_°mt
**,const **);

94069 (*
¥ï¨e16_v2
)(
sqlôe3
*,c⁄° *,,
sqlôe3_°mt
**,const **);

94070 (*
˛ór_bödögs
)(
sqlôe3_°mt
*);

94072 (*
¸óã_moduÀ_v2
)(
sqlôe3
*,c⁄° *,c⁄° 
sqlôe3_moduÀ
*,*,

94073 (*
xDe°roy
)(*));

94075 (*
böd_zîoblob
)(
sqlôe3_°mt
*,,);

94076 (*
blob_byãs
)(
sqlôe3_blob
*);

94077 (*
blob_˛o£
)(
sqlôe3_blob
*);

94078 (*
blob_›í
)(
sqlôe3
*,c⁄° *,c⁄° *,c⁄° *,
sqlôe3_öt64
,

94079 ,
sqlôe3_blob
**);

94080 (*
blob_ªad
)(
sqlôe3_blob
*,*,,);

94081 (*
blob_wrôe
)(
sqlôe3_blob
*,const *,,);

94082 (*
¸óã_cﬁœti⁄_v2
)(
sqlôe3
*,const *,,*,

94085 (*
fûe_c⁄åﬁ
)(
sqlôe3
*,const *,,*);

94086 
	`sqlôe3_öt64
 (*
mem‹y_highw©î
)();

94087 
	`sqlôe3_öt64
 (*
mem‹y_u£d
)();

94088 
sqlôe3_muãx
 *(*
muãx_Æloc
)();

94089 (*
muãx_íãr
)(
sqlôe3_muãx
*);

94090 (*
muãx_‰ì
)(
sqlôe3_muãx
*);

94091 (*
muãx_Àave
)(
sqlôe3_muãx
*);

94092 (*
muãx_åy
)(
sqlôe3_muãx
*);

94093 (*
›í_v2
)(c⁄° *,
sqlôe3
**,,const *);

94094 (*
ªÀa£_mem‹y
)();

94095 (*
ªsu…_îr‹_nomem
)(
sqlôe3_c⁄ãxt
*);

94096 (*
ªsu…_îr‹_toobig
)(
sqlôe3_c⁄ãxt
*);

94097 (*
¶ìp
)();

94098 (*
so·_hóp_limô
)();

94099 
sqlôe3_vfs
 *(*
vfs_föd
)(const *);

94100 (*
vfs_ªgi°î
)(
sqlôe3_vfs
*,);

94101 (*
vfs_uƒegi°î
)(
sqlôe3_vfs
*);

94102 (*
xthªadß„
)();

94103 (*
ªsu…_zîoblob
)(
sqlôe3_c⁄ãxt
*,);

94104 (*
ªsu…_îr‹_code
)(
sqlôe3_c⁄ãxt
*,);

94105 (*
ã°_c⁄åﬁ
)(, ...);

94106 (*
øndom√ss
)(,*);

94107 
sqlôe3
 *(*
c⁄ãxt_db_h™dÀ
)(
sqlôe3_c⁄ãxt
*);

94108 (*
exãnded_ªsu…_codes
)(
sqlôe3
*,);

94109 (*
limô
)(
sqlôe3
*,,);

94110 
sqlôe3_°mt
 *(*
√xt_°mt
)(
sqlôe3
*,sqlite3_stmt*);

94111 c⁄° *(*
sql
)(
sqlôe3_°mt
*);

94112 (*
°©us
)(,*,*,);

94113 (*
backup_föish
)(
sqlôe3_backup
*);

94114 
sqlôe3_backup
 *(*
backup_öô
)(
sqlôe3
*,const *,sqlite3*,const *);

94115 (*
backup_∑gecou¡
)(
sqlôe3_backup
*);

94116 (*
backup_ªmaöög
)(
sqlôe3_backup
*);

94117 (*
backup_°ï
)(
sqlôe3_backup
*,);

94118 c⁄° *(*
compûe›ti⁄_gë
)();

94119 (*
compûe›ti⁄_u£d
)(const *);

94120 (*
¸óã_fun˘i⁄_v2
)(
sqlôe3
*,const *,,,*,

94121 (*
xFunc
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
**),

94122 (*
xSãp
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
**),

94123 (*
xFöÆ
)(
sqlôe3_c⁄ãxt
*),

94124 (*
xDe°roy
)(*));

94125 (*
db_c⁄fig
)(
sqlôe3
*,,...);

94126 
sqlôe3_muãx
 *(*
db_muãx
)(
sqlôe3
*);

94127 (*
db_°©us
)(
sqlôe3
*,,*,*,);

94128 (*
exãnded_îrcode
)(
sqlôe3
*);

94129 (*
log
)(,const *,...);

94130 
	`sqlôe3_öt64
 (*
so·_hóp_limô64
)(
sqlôe3_öt64
);

94131 c⁄° *(*
sour˚id
)();

94132 (*
°mt_°©us
)(
sqlôe3_°mt
*,,);

94133 (*
°∫icmp
)(const *,const *,);

94134 (*
u∆ock_nŸify
)(
sqlôe3
*,(*)(**,),*);

94135 (*
wÆ_autocheckpoöt
)(
sqlôe3
*,);

94136 (*
wÆ_checkpoöt
)(
sqlôe3
*,const *);

94137 *(*
wÆ_hook
)(
sqlôe3
*,(*)(*,sqlite3*,const *,),*);

94138 (*
blob_ª›í
)(
sqlôe3_blob
*,
sqlôe3_öt64
);

94139 (*
vèb_c⁄fig
)(
sqlôe3
*,
›
,...);

94140 (*
vèb_⁄_c⁄Êi˘
)(
sqlôe3
*);

94142 (*
˛o£_v2
)(
sqlôe3
*);

94143 c⁄° *(*
db_fûíame
)(
sqlôe3
*,const *);

94144 (*
db_ªad⁄ly
)(
sqlôe3
*,const *);

94145 (*
db_ªÀa£_mem‹y
)(
sqlôe3
*);

94146 c⁄° *(*
îr°r
)();

94147 (*
°mt_busy
)(
sqlôe3_°mt
*);

94148 (*
°mt_ªad⁄ly
)(
sqlôe3_°mt
*);

94149 (*
°ricmp
)(const *,const *);

94150 (*
uri_boﬁón
)(const *,const *,);

94151 
	`sqlôe3_öt64
 (*
uri_öt64
)(c⁄° *,c⁄° *,
sqlôe3_öt64
);

94152 c⁄° *(*
uri_∑ømëî
)(const *,const *);

94153 *(*
v¢¥ötf
)(,*,c⁄° *,
va_li°
);

94154 (*
wÆ_checkpoöt_v2
)(
sqlôe3
*,const *,,*,*);

94168 #i‚de‡
SQLITE_CORE


94169 
	#sqlôe3_aggªg©e_c⁄ãxt
 
sqlôe3_≠i
->
aggªg©e_c⁄ãxt


	)

94170 #i‚de‡
SQLITE_OMIT_DEPRECATED


94171 
	#sqlôe3_aggªg©e_cou¡
 
sqlôe3_≠i
->
aggªg©e_cou¡


	)

94173 
	#sqlôe3_böd_blob
 
sqlôe3_≠i
->
böd_blob


	)

94174 
	#sqlôe3_böd_doubÀ
 
sqlôe3_≠i
->
böd_doubÀ


	)

94175 
	#sqlôe3_böd_öt
 
sqlôe3_≠i
->
böd_öt


	)

94176 
	#sqlôe3_böd_öt64
 
sqlôe3_≠i
->
böd_öt64


	)

94177 
	#sqlôe3_böd_nuŒ
 
sqlôe3_≠i
->
böd_nuŒ


	)

94178 
	#sqlôe3_böd_∑ømëî_cou¡
 
sqlôe3_≠i
->
böd_∑ømëî_cou¡


	)

94179 
	#sqlôe3_böd_∑ømëî_ödex
 
sqlôe3_≠i
->
böd_∑ømëî_ödex


	)

94180 
	#sqlôe3_böd_∑ømëî_«me
 
sqlôe3_≠i
->
böd_∑ømëî_«me


	)

94181 
	#sqlôe3_böd_ãxt
 
sqlôe3_≠i
->
böd_ãxt


	)

94182 
	#sqlôe3_böd_ãxt16
 
sqlôe3_≠i
->
böd_ãxt16


	)

94183 
	#sqlôe3_böd_vÆue
 
sqlôe3_≠i
->
böd_vÆue


	)

94184 
	#sqlôe3_busy_h™dÀr
 
sqlôe3_≠i
->
busy_h™dÀr


	)

94185 
	#sqlôe3_busy_timeout
 
sqlôe3_≠i
->
busy_timeout


	)

94186 
	#sqlôe3_ch™ges
 
sqlôe3_≠i
->
ch™ges


	)

94187 
	#sqlôe3_˛o£
 
sqlôe3_≠i
->
˛o£


	)

94188 
	#sqlôe3_cﬁœti⁄_√eded
 
sqlôe3_≠i
->
cﬁœti⁄_√eded


	)

94189 
	#sqlôe3_cﬁœti⁄_√eded16
 
sqlôe3_≠i
->
cﬁœti⁄_√eded16


	)

94190 
	#sqlôe3_cﬁumn_blob
 
sqlôe3_≠i
->
cﬁumn_blob


	)

94191 
	#sqlôe3_cﬁumn_byãs
 
sqlôe3_≠i
->
cﬁumn_byãs


	)

94192 
	#sqlôe3_cﬁumn_byãs16
 
sqlôe3_≠i
->
cﬁumn_byãs16


	)

94193 
	#sqlôe3_cﬁumn_cou¡
 
sqlôe3_≠i
->
cﬁumn_cou¡


	)

94194 
	#sqlôe3_cﬁumn_d©aba£_«me
 
sqlôe3_≠i
->
cﬁumn_d©aba£_«me


	)

94195 
	#sqlôe3_cﬁumn_d©aba£_«me16
 
sqlôe3_≠i
->
cﬁumn_d©aba£_«me16


	)

94196 
	#sqlôe3_cﬁumn_de˛ty≥
 
sqlôe3_≠i
->
cﬁumn_de˛ty≥


	)

94197 
	#sqlôe3_cﬁumn_de˛ty≥16
 
sqlôe3_≠i
->
cﬁumn_de˛ty≥16


	)

94198 
	#sqlôe3_cﬁumn_doubÀ
 
sqlôe3_≠i
->
cﬁumn_doubÀ


	)

94199 
	#sqlôe3_cﬁumn_öt
 
sqlôe3_≠i
->
cﬁumn_öt


	)

94200 
	#sqlôe3_cﬁumn_öt64
 
sqlôe3_≠i
->
cﬁumn_öt64


	)

94201 
	#sqlôe3_cﬁumn_«me
 
sqlôe3_≠i
->
cﬁumn_«me


	)

94202 
	#sqlôe3_cﬁumn_«me16
 
sqlôe3_≠i
->
cﬁumn_«me16


	)

94203 
	#sqlôe3_cﬁumn_‹igö_«me
 
sqlôe3_≠i
->
cﬁumn_‹igö_«me


	)

94204 
	#sqlôe3_cﬁumn_‹igö_«me16
 
sqlôe3_≠i
->
cﬁumn_‹igö_«me16


	)

94205 
	#sqlôe3_cﬁumn_èbÀ_«me
 
sqlôe3_≠i
->
cﬁumn_èbÀ_«me


	)

94206 
	#sqlôe3_cﬁumn_èbÀ_«me16
 
sqlôe3_≠i
->
cﬁumn_èbÀ_«me16


	)

94207 
	#sqlôe3_cﬁumn_ãxt
 
sqlôe3_≠i
->
cﬁumn_ãxt


	)

94208 
	#sqlôe3_cﬁumn_ãxt16
 
sqlôe3_≠i
->
cﬁumn_ãxt16


	)

94209 
	#sqlôe3_cﬁumn_ty≥
 
sqlôe3_≠i
->
cﬁumn_ty≥


	)

94210 
	#sqlôe3_cﬁumn_vÆue
 
sqlôe3_≠i
->
cﬁumn_vÆue


	)

94211 
	#sqlôe3_commô_hook
 
sqlôe3_≠i
->
commô_hook


	)

94212 
	#sqlôe3_com∂ëe
 
sqlôe3_≠i
->
com∂ëe


	)

94213 
	#sqlôe3_com∂ëe16
 
sqlôe3_≠i
->
com∂ëe16


	)

94214 
	#sqlôe3_¸óã_cﬁœti⁄
 
sqlôe3_≠i
->
¸óã_cﬁœti⁄


	)

94215 
	#sqlôe3_¸óã_cﬁœti⁄16
 
sqlôe3_≠i
->
¸óã_cﬁœti⁄16


	)

94216 
	#sqlôe3_¸óã_fun˘i⁄
 
sqlôe3_≠i
->
¸óã_fun˘i⁄


	)

94217 
	#sqlôe3_¸óã_fun˘i⁄16
 
sqlôe3_≠i
->
¸óã_fun˘i⁄16


	)

94218 
	#sqlôe3_¸óã_moduÀ
 
sqlôe3_≠i
->
¸óã_moduÀ


	)

94219 
	#sqlôe3_¸óã_moduÀ_v2
 
sqlôe3_≠i
->
¸óã_moduÀ_v2


	)

94220 
	#sqlôe3_d©a_cou¡
 
sqlôe3_≠i
->
d©a_cou¡


	)

94221 
	#sqlôe3_db_h™dÀ
 
sqlôe3_≠i
->
db_h™dÀ


	)

94222 
	#sqlôe3_de˛¨e_vèb
 
sqlôe3_≠i
->
de˛¨e_vèb


	)

94223 
	#sqlôe3_íabÀ_sh¨ed_ˇche
 
sqlôe3_≠i
->
íabÀ_sh¨ed_ˇche


	)

94224 
	#sqlôe3_îrcode
 
sqlôe3_≠i
->
îrcode


	)

94225 
	#sqlôe3_îrmsg
 
sqlôe3_≠i
->
îrmsg


	)

94226 
	#sqlôe3_îrmsg16
 
sqlôe3_≠i
->
îrmsg16


	)

94227 
	#sqlôe3_exec
 
sqlôe3_≠i
->
exec


	)

94228 #i‚de‡
SQLITE_OMIT_DEPRECATED


94229 
	#sqlôe3_expúed
 
sqlôe3_≠i
->
expúed


	)

94231 
	#sqlôe3_föÆize
 
sqlôe3_≠i
->
föÆize


	)

94232 
	#sqlôe3_‰ì
 
sqlôe3_≠i
->
‰ì


	)

94233 
	#sqlôe3_‰ì_èbÀ
 
sqlôe3_≠i
->
‰ì_èbÀ


	)

94234 
	#sqlôe3_gë_autocommô
 
sqlôe3_≠i
->
gë_autocommô


	)

94235 
	#sqlôe3_gë_auxd©a
 
sqlôe3_≠i
->
gë_auxd©a


	)

94236 
	#sqlôe3_gë_èbÀ
 
sqlôe3_≠i
->
gë_èbÀ


	)

94237 #i‚de‡
SQLITE_OMIT_DEPRECATED


94238 
	#sqlôe3_globÆ_ªcovî
 
sqlôe3_≠i
->
globÆ_ªcovî


	)

94240 
	#sqlôe3_öãºu±
 
sqlôe3_≠i
->
öãºu±x


	)

94241 
	#sqlôe3_œ°_ö£π_rowid
 
sqlôe3_≠i
->
œ°_ö£π_rowid


	)

94242 
	#sqlôe3_libvîsi⁄
 
sqlôe3_≠i
->
libvîsi⁄


	)

94243 
	#sqlôe3_libvîsi⁄_numbî
 
sqlôe3_≠i
->
libvîsi⁄_numbî


	)

94244 
	#sqlôe3_mÆloc
 
sqlôe3_≠i
->
mÆloc


	)

94245 
	#sqlôe3_m¥ötf
 
sqlôe3_≠i
->
m¥ötf


	)

94246 
	#sqlôe3_›í
 
sqlôe3_≠i
->
›í


	)

94247 
	#sqlôe3_›í16
 
sqlôe3_≠i
->
›í16


	)

94248 
	#sqlôe3_¥ï¨e
 
sqlôe3_≠i
->
¥ï¨e


	)

94249 
	#sqlôe3_¥ï¨e16
 
sqlôe3_≠i
->
¥ï¨e16


	)

94250 
	#sqlôe3_¥ï¨e_v2
 
sqlôe3_≠i
->
¥ï¨e_v2


	)

94251 
	#sqlôe3_¥ï¨e16_v2
 
sqlôe3_≠i
->
¥ï¨e16_v2


	)

94252 
	#sqlôe3_¥ofûe
 
sqlôe3_≠i
->
¥ofûe


	)

94253 
	#sqlôe3_¥ogªss_h™dÀr
 
sqlôe3_≠i
->
¥ogªss_h™dÀr


	)

94254 
	#sqlôe3_ªÆloc
 
sqlôe3_≠i
->
ªÆloc


	)

94255 
	#sqlôe3_ª£t
 
sqlôe3_≠i
->
ª£t


	)

94256 
	#sqlôe3_ªsu…_blob
 
sqlôe3_≠i
->
ªsu…_blob


	)

94257 
	#sqlôe3_ªsu…_doubÀ
 
sqlôe3_≠i
->
ªsu…_doubÀ


	)

94258 
	#sqlôe3_ªsu…_îr‹
 
sqlôe3_≠i
->
ªsu…_îr‹


	)

94259 
	#sqlôe3_ªsu…_îr‹16
 
sqlôe3_≠i
->
ªsu…_îr‹16


	)

94260 
	#sqlôe3_ªsu…_öt
 
sqlôe3_≠i
->
ªsu…_öt


	)

94261 
	#sqlôe3_ªsu…_öt64
 
sqlôe3_≠i
->
ªsu…_öt64


	)

94262 
	#sqlôe3_ªsu…_nuŒ
 
sqlôe3_≠i
->
ªsu…_nuŒ


	)

94263 
	#sqlôe3_ªsu…_ãxt
 
sqlôe3_≠i
->
ªsu…_ãxt


	)

94264 
	#sqlôe3_ªsu…_ãxt16
 
sqlôe3_≠i
->
ªsu…_ãxt16


	)

94265 
	#sqlôe3_ªsu…_ãxt16be
 
sqlôe3_≠i
->
ªsu…_ãxt16be


	)

94266 
	#sqlôe3_ªsu…_ãxt16À
 
sqlôe3_≠i
->
ªsu…_ãxt16À


	)

94267 
	#sqlôe3_ªsu…_vÆue
 
sqlôe3_≠i
->
ªsu…_vÆue


	)

94268 
	#sqlôe3_rﬁlback_hook
 
sqlôe3_≠i
->
rﬁlback_hook


	)

94269 
	#sqlôe3_£t_auth‹izî
 
sqlôe3_≠i
->
£t_auth‹izî


	)

94270 
	#sqlôe3_£t_auxd©a
 
sqlôe3_≠i
->
£t_auxd©a


	)

94271 
	#sqlôe3_¢¥ötf
 
sqlôe3_≠i
->
¢¥ötf


	)

94272 
	#sqlôe3_°ï
 
sqlôe3_≠i
->
°ï


	)

94273 
	#sqlôe3_èbÀ_cﬁumn_mëad©a
 
sqlôe3_≠i
->
èbÀ_cﬁumn_mëad©a


	)

94274 
	#sqlôe3_thªad_˛ónup
 
sqlôe3_≠i
->
thªad_˛ónup


	)

94275 
	#sqlôe3_tŸÆ_ch™ges
 
sqlôe3_≠i
->
tŸÆ_ch™ges


	)

94276 
	#sqlôe3_åa˚
 
sqlôe3_≠i
->
åa˚


	)

94277 #i‚de‡
SQLITE_OMIT_DEPRECATED


94278 
	#sqlôe3_å™s„r_bödögs
 
sqlôe3_≠i
->
å™s„r_bödögs


	)

94280 
	#sqlôe3_upd©e_hook
 
sqlôe3_≠i
->
upd©e_hook


	)

94281 
	#sqlôe3_u£r_d©a
 
sqlôe3_≠i
->
u£r_d©a


	)

94282 
	#sqlôe3_vÆue_blob
 
sqlôe3_≠i
->
vÆue_blob


	)

94283 
	#sqlôe3_vÆue_byãs
 
sqlôe3_≠i
->
vÆue_byãs


	)

94284 
	#sqlôe3_vÆue_byãs16
 
sqlôe3_≠i
->
vÆue_byãs16


	)

94285 
	#sqlôe3_vÆue_doubÀ
 
sqlôe3_≠i
->
vÆue_doubÀ


	)

94286 
	#sqlôe3_vÆue_öt
 
sqlôe3_≠i
->
vÆue_öt


	)

94287 
	#sqlôe3_vÆue_öt64
 
sqlôe3_≠i
->
vÆue_öt64


	)

94288 
	#sqlôe3_vÆue_numîic_ty≥
 
sqlôe3_≠i
->
vÆue_numîic_ty≥


	)

94289 
	#sqlôe3_vÆue_ãxt
 
sqlôe3_≠i
->
vÆue_ãxt


	)

94290 
	#sqlôe3_vÆue_ãxt16
 
sqlôe3_≠i
->
vÆue_ãxt16


	)

94291 
	#sqlôe3_vÆue_ãxt16be
 
sqlôe3_≠i
->
vÆue_ãxt16be


	)

94292 
	#sqlôe3_vÆue_ãxt16À
 
sqlôe3_≠i
->
vÆue_ãxt16À


	)

94293 
	#sqlôe3_vÆue_ty≥
 
sqlôe3_≠i
->
vÆue_ty≥


	)

94294 
	#sqlôe3_vm¥ötf
 
sqlôe3_≠i
->
vm¥ötf


	)

94295 
	#sqlôe3_ovîlﬂd_fun˘i⁄
 
sqlôe3_≠i
->
ovîlﬂd_fun˘i⁄


	)

94296 
	#sqlôe3_¥ï¨e_v2
 
sqlôe3_≠i
->
¥ï¨e_v2


	)

94297 
	#sqlôe3_¥ï¨e16_v2
 
sqlôe3_≠i
->
¥ï¨e16_v2


	)

94298 
	#sqlôe3_˛ór_bödögs
 
sqlôe3_≠i
->
˛ór_bödögs


	)

94299 
	#sqlôe3_böd_zîoblob
 
sqlôe3_≠i
->
böd_zîoblob


	)

94300 
	#sqlôe3_blob_byãs
 
sqlôe3_≠i
->
blob_byãs


	)

94301 
	#sqlôe3_blob_˛o£
 
sqlôe3_≠i
->
blob_˛o£


	)

94302 
	#sqlôe3_blob_›í
 
sqlôe3_≠i
->
blob_›í


	)

94303 
	#sqlôe3_blob_ªad
 
sqlôe3_≠i
->
blob_ªad


	)

94304 
	#sqlôe3_blob_wrôe
 
sqlôe3_≠i
->
blob_wrôe


	)

94305 
	#sqlôe3_¸óã_cﬁœti⁄_v2
 
sqlôe3_≠i
->
¸óã_cﬁœti⁄_v2


	)

94306 
	#sqlôe3_fûe_c⁄åﬁ
 
sqlôe3_≠i
->
fûe_c⁄åﬁ


	)

94307 
	#sqlôe3_mem‹y_highw©î
 
sqlôe3_≠i
->
mem‹y_highw©î


	)

94308 
	#sqlôe3_mem‹y_u£d
 
sqlôe3_≠i
->
mem‹y_u£d


	)

94309 
	#sqlôe3_muãx_Æloc
 
sqlôe3_≠i
->
muãx_Æloc


	)

94310 
	#sqlôe3_muãx_íãr
 
sqlôe3_≠i
->
muãx_íãr


	)

94311 
	#sqlôe3_muãx_‰ì
 
sqlôe3_≠i
->
muãx_‰ì


	)

94312 
	#sqlôe3_muãx_Àave
 
sqlôe3_≠i
->
muãx_Àave


	)

94313 
	#sqlôe3_muãx_åy
 
sqlôe3_≠i
->
muãx_åy


	)

94314 
	#sqlôe3_›í_v2
 
sqlôe3_≠i
->
›í_v2


	)

94315 
	#sqlôe3_ªÀa£_mem‹y
 
sqlôe3_≠i
->
ªÀa£_mem‹y


	)

94316 
	#sqlôe3_ªsu…_îr‹_nomem
 
sqlôe3_≠i
->
ªsu…_îr‹_nomem


	)

94317 
	#sqlôe3_ªsu…_îr‹_toobig
 
sqlôe3_≠i
->
ªsu…_îr‹_toobig


	)

94318 
	#sqlôe3_¶ìp
 
sqlôe3_≠i
->
¶ìp


	)

94319 
	#sqlôe3_so·_hóp_limô
 
sqlôe3_≠i
->
so·_hóp_limô


	)

94320 
	#sqlôe3_vfs_föd
 
sqlôe3_≠i
->
vfs_föd


	)

94321 
	#sqlôe3_vfs_ªgi°î
 
sqlôe3_≠i
->
vfs_ªgi°î


	)

94322 
	#sqlôe3_vfs_uƒegi°î
 
sqlôe3_≠i
->
vfs_uƒegi°î


	)

94323 
	#sqlôe3_thªadß„
 
sqlôe3_≠i
->
xthªadß„


	)

94324 
	#sqlôe3_ªsu…_zîoblob
 
sqlôe3_≠i
->
ªsu…_zîoblob


	)

94325 
	#sqlôe3_ªsu…_îr‹_code
 
sqlôe3_≠i
->
ªsu…_îr‹_code


	)

94326 
	#sqlôe3_ã°_c⁄åﬁ
 
sqlôe3_≠i
->
ã°_c⁄åﬁ


	)

94327 
	#sqlôe3_øndom√ss
 
sqlôe3_≠i
->
øndom√ss


	)

94328 
	#sqlôe3_c⁄ãxt_db_h™dÀ
 
sqlôe3_≠i
->
c⁄ãxt_db_h™dÀ


	)

94329 
	#sqlôe3_exãnded_ªsu…_codes
 
sqlôe3_≠i
->
exãnded_ªsu…_codes


	)

94330 
	#sqlôe3_limô
 
sqlôe3_≠i
->
limô


	)

94331 
	#sqlôe3_√xt_°mt
 
sqlôe3_≠i
->
√xt_°mt


	)

94332 
	#sqlôe3_sql
 
sqlôe3_≠i
->
sql


	)

94333 
	#sqlôe3_°©us
 
sqlôe3_≠i
->
°©us


	)

94334 
	#sqlôe3_backup_föish
 
sqlôe3_≠i
->
backup_föish


	)

94335 
	#sqlôe3_backup_öô
 
sqlôe3_≠i
->
backup_öô


	)

94336 
	#sqlôe3_backup_∑gecou¡
 
sqlôe3_≠i
->
backup_∑gecou¡


	)

94337 
	#sqlôe3_backup_ªmaöög
 
sqlôe3_≠i
->
backup_ªmaöög


	)

94338 
	#sqlôe3_backup_°ï
 
sqlôe3_≠i
->
backup_°ï


	)

94339 
	#sqlôe3_compûe›ti⁄_gë
 
sqlôe3_≠i
->
compûe›ti⁄_gë


	)

94340 
	#sqlôe3_compûe›ti⁄_u£d
 
sqlôe3_≠i
->
compûe›ti⁄_u£d


	)

94341 
	#sqlôe3_¸óã_fun˘i⁄_v2
 
sqlôe3_≠i
->
¸óã_fun˘i⁄_v2


	)

94342 
	#sqlôe3_db_c⁄fig
 
sqlôe3_≠i
->
db_c⁄fig


	)

94343 
	#sqlôe3_db_muãx
 
sqlôe3_≠i
->
db_muãx


	)

94344 
	#sqlôe3_db_°©us
 
sqlôe3_≠i
->
db_°©us


	)

94345 
	#sqlôe3_exãnded_îrcode
 
sqlôe3_≠i
->
exãnded_îrcode


	)

94346 
	#sqlôe3_log
 
sqlôe3_≠i
->
log


	)

94347 
	#sqlôe3_so·_hóp_limô64
 
sqlôe3_≠i
->
so·_hóp_limô64


	)

94348 
	#sqlôe3_sour˚id
 
sqlôe3_≠i
->
sour˚id


	)

94349 
	#sqlôe3_°mt_°©us
 
sqlôe3_≠i
->
°mt_°©us


	)

94350 
	#sqlôe3_°∫icmp
 
sqlôe3_≠i
->
°∫icmp


	)

94351 
	#sqlôe3_u∆ock_nŸify
 
sqlôe3_≠i
->
u∆ock_nŸify


	)

94352 
	#sqlôe3_wÆ_autocheckpoöt
 
sqlôe3_≠i
->
wÆ_autocheckpoöt


	)

94353 
	#sqlôe3_wÆ_checkpoöt
 
sqlôe3_≠i
->
wÆ_checkpoöt


	)

94354 
	#sqlôe3_wÆ_hook
 
sqlôe3_≠i
->
wÆ_hook


	)

94355 
	#sqlôe3_blob_ª›í
 
sqlôe3_≠i
->
blob_ª›í


	)

94356 
	#sqlôe3_vèb_c⁄fig
 
sqlôe3_≠i
->
vèb_c⁄fig


	)

94357 
	#sqlôe3_vèb_⁄_c⁄Êi˘
 
sqlôe3_≠i
->
vèb_⁄_c⁄Êi˘


	)

94359 
	#sqlôe3_˛o£_v2
 
sqlôe3_≠i
->
˛o£_v2


	)

94360 
	#sqlôe3_db_fûíame
 
sqlôe3_≠i
->
db_fûíame


	)

94361 
	#sqlôe3_db_ªad⁄ly
 
sqlôe3_≠i
->
db_ªad⁄ly


	)

94362 
	#sqlôe3_db_ªÀa£_mem‹y
 
sqlôe3_≠i
->
db_ªÀa£_mem‹y


	)

94363 
	#sqlôe3_îr°r
 
sqlôe3_≠i
->
îr°r


	)

94364 
	#sqlôe3_°mt_busy
 
sqlôe3_≠i
->
°mt_busy


	)

94365 
	#sqlôe3_°mt_ªad⁄ly
 
sqlôe3_≠i
->
°mt_ªad⁄ly


	)

94366 
	#sqlôe3_°ricmp
 
sqlôe3_≠i
->
°ricmp


	)

94367 
	#sqlôe3_uri_boﬁón
 
sqlôe3_≠i
->
uri_boﬁón


	)

94368 
	#sqlôe3_uri_öt64
 
sqlôe3_≠i
->
uri_öt64


	)

94369 
	#sqlôe3_uri_∑ømëî
 
sqlôe3_≠i
->
uri_∑ømëî


	)

94370 
	#sqlôe3_uri_v¢¥ötf
 
sqlôe3_≠i
->
v¢¥ötf


	)

94371 
	#sqlôe3_wÆ_checkpoöt_v2
 
sqlôe3_≠i
->
wÆ_checkpoöt_v2


	)

94374 #i‚de‡
SQLITE_CORE


94377 
	#SQLITE_EXTENSION_INIT1
 c⁄° 
sqlôe3_≠i_routöes
 *
sqlôe3_≠i
=0;

	)

94378 
	#SQLITE_EXTENSION_INIT2
(
v
Ë
sqlôe3_≠i
=v;

	)

94379 
	#SQLITE_EXTENSION_INIT3
 \

94380 c⁄° 
sqlôe3_≠i_routöes
 *
sqlôe3_≠i
;

	)

94384 
	#SQLITE_EXTENSION_INIT1


	)

94385 
	#SQLITE_EXTENSION_INIT2
(
v
Ë()v;

	)

94386 
	#SQLITE_EXTENSION_INIT3


	)

94395 #i‚de‡
SQLITE_OMIT_LOAD_EXTENSION


94402 #i‚de‡
SQLITE_ENABLE_COLUMN_METADATA


94403 
	#sqlôe3_cﬁumn_d©aba£_«me
 0

	)

94404 
	#sqlôe3_cﬁumn_d©aba£_«me16
 0

	)

94405 
	#sqlôe3_cﬁumn_èbÀ_«me
 0

	)

94406 
	#sqlôe3_cﬁumn_èbÀ_«me16
 0

	)

94407 
	#sqlôe3_cﬁumn_‹igö_«me
 0

	)

94408 
	#sqlôe3_cﬁumn_‹igö_«me16
 0

	)

94409 
	#sqlôe3_èbÀ_cﬁumn_mëad©a
 0

	)

94412 #ifde‡
SQLITE_OMIT_AUTHORIZATION


94413 
	#sqlôe3_£t_auth‹izî
 0

	)

94416 #ifde‡
SQLITE_OMIT_UTF16


94417 
	#sqlôe3_böd_ãxt16
 0

	)

94418 
	#sqlôe3_cﬁœti⁄_√eded16
 0

	)

94419 
	#sqlôe3_cﬁumn_de˛ty≥16
 0

	)

94420 
	#sqlôe3_cﬁumn_«me16
 0

	)

94421 
	#sqlôe3_cﬁumn_ãxt16
 0

	)

94422 
	#sqlôe3_com∂ëe16
 0

	)

94423 
	#sqlôe3_¸óã_cﬁœti⁄16
 0

	)

94424 
	#sqlôe3_¸óã_fun˘i⁄16
 0

	)

94425 
	#sqlôe3_îrmsg16
 0

	)

94426 
	#sqlôe3_›í16
 0

	)

94427 
	#sqlôe3_¥ï¨e16
 0

	)

94428 
	#sqlôe3_¥ï¨e16_v2
 0

	)

94429 
	#sqlôe3_ªsu…_îr‹16
 0

	)

94430 
	#sqlôe3_ªsu…_ãxt16
 0

	)

94431 
	#sqlôe3_ªsu…_ãxt16be
 0

	)

94432 
	#sqlôe3_ªsu…_ãxt16À
 0

	)

94433 
	#sqlôe3_vÆue_ãxt16
 0

	)

94434 
	#sqlôe3_vÆue_ãxt16be
 0

	)

94435 
	#sqlôe3_vÆue_ãxt16À
 0

	)

94436 
	#sqlôe3_cﬁumn_d©aba£_«me16
 0

	)

94437 
	#sqlôe3_cﬁumn_èbÀ_«me16
 0

	)

94438 
	#sqlôe3_cﬁumn_‹igö_«me16
 0

	)

94441 #ifde‡
SQLITE_OMIT_COMPLETE


94442 
	#sqlôe3_com∂ëe
 0

	)

94443 
	#sqlôe3_com∂ëe16
 0

	)

94446 #ifde‡
SQLITE_OMIT_DECLTYPE


94447 
	#sqlôe3_cﬁumn_de˛ty≥16
 0

	)

94448 
	#sqlôe3_cﬁumn_de˛ty≥
 0

	)

94451 #ifde‡
SQLITE_OMIT_PROGRESS_CALLBACK


94452 
	#sqlôe3_¥ogªss_h™dÀr
 0

	)

94455 #ifde‡
SQLITE_OMIT_VIRTUALTABLE


94456 
	#sqlôe3_¸óã_moduÀ
 0

	)

94457 
	#sqlôe3_¸óã_moduÀ_v2
 0

	)

94458 
	#sqlôe3_de˛¨e_vèb
 0

	)

94459 
	#sqlôe3_vèb_c⁄fig
 0

	)

94460 
	#sqlôe3_vèb_⁄_c⁄Êi˘
 0

	)

94463 #ifde‡
SQLITE_OMIT_SHARED_CACHE


94464 
	#sqlôe3_íabÀ_sh¨ed_ˇche
 0

	)

94467 #ifde‡
SQLITE_OMIT_TRACE


94468 
	#sqlôe3_¥ofûe
 0

	)

94469 
	#sqlôe3_åa˚
 0

	)

94472 #ifde‡
SQLITE_OMIT_GET_TABLE


94473 
	#sqlôe3_‰ì_èbÀ
 0

	)

94474 
	#sqlôe3_gë_èbÀ
 0

	)

94477 #ifde‡
SQLITE_OMIT_INCRBLOB


94478 
	#sqlôe3_böd_zîoblob
 0

	)

94479 
	#sqlôe3_blob_byãs
 0

	)

94480 
	#sqlôe3_blob_˛o£
 0

	)

94481 
	#sqlôe3_blob_›í
 0

	)

94482 
	#sqlôe3_blob_ªad
 0

	)

94483 
	#sqlôe3_blob_wrôe
 0

	)

94484 
	#sqlôe3_blob_ª›í
 0

	)

94502 c⁄° 
sqlôe3_≠i_routöes
 
sqlôe3Apis
 = {

94503 
sqlôe3_aggªg©e_c⁄ãxt
,

94504 #i‚de‡
SQLITE_OMIT_DEPRECATED


94505 
sqlôe3_aggªg©e_cou¡
,

94509 
sqlôe3_böd_blob
,

94510 
sqlôe3_böd_doubÀ
,

94511 
sqlôe3_böd_öt
,

94512 
sqlôe3_böd_öt64
,

94513 
sqlôe3_böd_nuŒ
,

94514 
sqlôe3_böd_∑ømëî_cou¡
,

94515 
sqlôe3_böd_∑ømëî_ödex
,

94516 
sqlôe3_böd_∑ømëî_«me
,

94517 
sqlôe3_böd_ãxt
,

94518 
sqlôe3_böd_ãxt16
,

94519 
sqlôe3_böd_vÆue
,

94520 
sqlôe3_busy_h™dÀr
,

94521 
sqlôe3_busy_timeout
,

94522 
sqlôe3_ch™ges
,

94523 
sqlôe3_˛o£
,

94524 
sqlôe3_cﬁœti⁄_√eded
,

94525 
sqlôe3_cﬁœti⁄_√eded16
,

94526 
sqlôe3_cﬁumn_blob
,

94527 
sqlôe3_cﬁumn_byãs
,

94528 
sqlôe3_cﬁumn_byãs16
,

94529 
sqlôe3_cﬁumn_cou¡
,

94530 
sqlôe3_cﬁumn_d©aba£_«me
,

94531 
sqlôe3_cﬁumn_d©aba£_«me16
,

94532 
sqlôe3_cﬁumn_de˛ty≥
,

94533 
sqlôe3_cﬁumn_de˛ty≥16
,

94534 
sqlôe3_cﬁumn_doubÀ
,

94535 
sqlôe3_cﬁumn_öt
,

94536 
sqlôe3_cﬁumn_öt64
,

94537 
sqlôe3_cﬁumn_«me
,

94538 
sqlôe3_cﬁumn_«me16
,

94539 
sqlôe3_cﬁumn_‹igö_«me
,

94540 
sqlôe3_cﬁumn_‹igö_«me16
,

94541 
sqlôe3_cﬁumn_èbÀ_«me
,

94542 
sqlôe3_cﬁumn_èbÀ_«me16
,

94543 
sqlôe3_cﬁumn_ãxt
,

94544 
sqlôe3_cﬁumn_ãxt16
,

94545 
sqlôe3_cﬁumn_ty≥
,

94546 
sqlôe3_cﬁumn_vÆue
,

94547 
sqlôe3_commô_hook
,

94548 
sqlôe3_com∂ëe
,

94549 
sqlôe3_com∂ëe16
,

94550 
sqlôe3_¸óã_cﬁœti⁄
,

94551 
sqlôe3_¸óã_cﬁœti⁄16
,

94552 
sqlôe3_¸óã_fun˘i⁄
,

94553 
sqlôe3_¸óã_fun˘i⁄16
,

94554 
sqlôe3_¸óã_moduÀ
,

94555 
sqlôe3_d©a_cou¡
,

94556 
sqlôe3_db_h™dÀ
,

94557 
sqlôe3_de˛¨e_vèb
,

94558 
sqlôe3_íabÀ_sh¨ed_ˇche
,

94559 
sqlôe3_îrcode
,

94560 
sqlôe3_îrmsg
,

94561 
sqlôe3_îrmsg16
,

94562 
sqlôe3_exec
,

94563 #i‚de‡
SQLITE_OMIT_DEPRECATED


94564 
sqlôe3_expúed
,

94568 
sqlôe3_föÆize
,

94569 
sqlôe3_‰ì
,

94570 
sqlôe3_‰ì_èbÀ
,

94571 
sqlôe3_gë_autocommô
,

94572 
sqlôe3_gë_auxd©a
,

94573 
sqlôe3_gë_èbÀ
,

94575 
sqlôe3_öãºu±
,

94576 
sqlôe3_œ°_ö£π_rowid
,

94577 
sqlôe3_libvîsi⁄
,

94578 
sqlôe3_libvîsi⁄_numbî
,

94579 
sqlôe3_mÆloc
,

94580 
sqlôe3_m¥ötf
,

94581 
sqlôe3_›í
,

94582 
sqlôe3_›í16
,

94583 
sqlôe3_¥ï¨e
,

94584 
sqlôe3_¥ï¨e16
,

94585 
sqlôe3_¥ofûe
,

94586 
sqlôe3_¥ogªss_h™dÀr
,

94587 
sqlôe3_ªÆloc
,

94588 
sqlôe3_ª£t
,

94589 
sqlôe3_ªsu…_blob
,

94590 
sqlôe3_ªsu…_doubÀ
,

94591 
sqlôe3_ªsu…_îr‹
,

94592 
sqlôe3_ªsu…_îr‹16
,

94593 
sqlôe3_ªsu…_öt
,

94594 
sqlôe3_ªsu…_öt64
,

94595 
sqlôe3_ªsu…_nuŒ
,

94596 
sqlôe3_ªsu…_ãxt
,

94597 
sqlôe3_ªsu…_ãxt16
,

94598 
sqlôe3_ªsu…_ãxt16be
,

94599 
sqlôe3_ªsu…_ãxt16À
,

94600 
sqlôe3_ªsu…_vÆue
,

94601 
sqlôe3_rﬁlback_hook
,

94602 
sqlôe3_£t_auth‹izî
,

94603 
sqlôe3_£t_auxd©a
,

94604 
sqlôe3_¢¥ötf
,

94605 
sqlôe3_°ï
,

94606 
sqlôe3_èbÀ_cﬁumn_mëad©a
,

94607 #i‚de‡
SQLITE_OMIT_DEPRECATED


94608 
sqlôe3_thªad_˛ónup
,

94612 
sqlôe3_tŸÆ_ch™ges
,

94613 
sqlôe3_åa˚
,

94614 #i‚de‡
SQLITE_OMIT_DEPRECATED


94615 
sqlôe3_å™s„r_bödögs
,

94619 
sqlôe3_upd©e_hook
,

94620 
sqlôe3_u£r_d©a
,

94621 
sqlôe3_vÆue_blob
,

94622 
sqlôe3_vÆue_byãs
,

94623 
sqlôe3_vÆue_byãs16
,

94624 
sqlôe3_vÆue_doubÀ
,

94625 
sqlôe3_vÆue_öt
,

94626 
sqlôe3_vÆue_öt64
,

94627 
sqlôe3_vÆue_numîic_ty≥
,

94628 
sqlôe3_vÆue_ãxt
,

94629 
sqlôe3_vÆue_ãxt16
,

94630 
sqlôe3_vÆue_ãxt16be
,

94631 
sqlôe3_vÆue_ãxt16À
,

94632 
sqlôe3_vÆue_ty≥
,

94633 
sqlôe3_vm¥ötf
,

94642 
sqlôe3_ovîlﬂd_fun˘i⁄
,

94647 
sqlôe3_¥ï¨e_v2
,

94648 
sqlôe3_¥ï¨e16_v2
,

94649 
sqlôe3_˛ór_bödögs
,

94654 
sqlôe3_¸óã_moduÀ_v2
,

94659 
sqlôe3_böd_zîoblob
,

94660 
sqlôe3_blob_byãs
,

94661 
sqlôe3_blob_˛o£
,

94662 
sqlôe3_blob_›í
,

94663 
sqlôe3_blob_ªad
,

94664 
sqlôe3_blob_wrôe
,

94665 
sqlôe3_¸óã_cﬁœti⁄_v2
,

94666 
sqlôe3_fûe_c⁄åﬁ
,

94667 
sqlôe3_mem‹y_highw©î
,

94668 
sqlôe3_mem‹y_u£d
,

94669 #ifde‡
SQLITE_MUTEX_OMIT


94676 
sqlôe3_muãx_Æloc
,

94677 
sqlôe3_muãx_íãr
,

94678 
sqlôe3_muãx_‰ì
,

94679 
sqlôe3_muãx_Àave
,

94680 
sqlôe3_muãx_åy
,

94682 
sqlôe3_›í_v2
,

94683 
sqlôe3_ªÀa£_mem‹y
,

94684 
sqlôe3_ªsu…_îr‹_nomem
,

94685 
sqlôe3_ªsu…_îr‹_toobig
,

94686 
sqlôe3_¶ìp
,

94687 
sqlôe3_so·_hóp_limô
,

94688 
sqlôe3_vfs_föd
,

94689 
sqlôe3_vfs_ªgi°î
,

94690 
sqlôe3_vfs_uƒegi°î
,

94695 
sqlôe3_thªadß„
,

94696 
sqlôe3_ªsu…_zîoblob
,

94697 
sqlôe3_ªsu…_îr‹_code
,

94698 
sqlôe3_ã°_c⁄åﬁ
,

94699 
sqlôe3_øndom√ss
,

94700 
sqlôe3_c⁄ãxt_db_h™dÀ
,

94705 
sqlôe3_exãnded_ªsu…_codes
,

94706 
sqlôe3_limô
,

94707 
sqlôe3_√xt_°mt
,

94708 
sqlôe3_sql
,

94709 
sqlôe3_°©us
,

94714 
sqlôe3_backup_föish
,

94715 
sqlôe3_backup_öô
,

94716 
sqlôe3_backup_∑gecou¡
,

94717 
sqlôe3_backup_ªmaöög
,

94718 
sqlôe3_backup_°ï
,

94719 #i‚de‡
SQLITE_OMIT_COMPILEOPTION_DIAGS


94720 
sqlôe3_compûe›ti⁄_gë
,

94721 
sqlôe3_compûe›ti⁄_u£d
,

94726 
sqlôe3_¸óã_fun˘i⁄_v2
,

94727 
sqlôe3_db_c⁄fig
,

94728 
sqlôe3_db_muãx
,

94729 
sqlôe3_db_°©us
,

94730 
sqlôe3_exãnded_îrcode
,

94731 
sqlôe3_log
,

94732 
sqlôe3_so·_hóp_limô64
,

94733 
sqlôe3_sour˚id
,

94734 
sqlôe3_°mt_°©us
,

94735 
sqlôe3_°∫icmp
,

94736 #ifde‡
SQLITE_ENABLE_UNLOCK_NOTIFY


94737 
sqlôe3_u∆ock_nŸify
,

94741 #i‚de‡
SQLITE_OMIT_WAL


94742 
sqlôe3_wÆ_autocheckpoöt
,

94743 
sqlôe3_wÆ_checkpoöt
,

94744 
sqlôe3_wÆ_hook
,

94750 
sqlôe3_blob_ª›í
,

94751 
sqlôe3_vèb_c⁄fig
,

94752 
sqlôe3_vèb_⁄_c⁄Êi˘
,

94753 
sqlôe3_˛o£_v2
,

94754 
sqlôe3_db_fûíame
,

94755 
sqlôe3_db_ªad⁄ly
,

94756 
sqlôe3_db_ªÀa£_mem‹y
,

94757 
sqlôe3_îr°r
,

94758 
sqlôe3_°mt_busy
,

94759 
sqlôe3_°mt_ªad⁄ly
,

94760 
sqlôe3_°ricmp
,

94761 
sqlôe3_uri_boﬁón
,

94762 
sqlôe3_uri_öt64
,

94763 
sqlôe3_uri_∑ømëî
,

94764 
sqlôe3_v¢¥ötf
,

94765 
sqlôe3_wÆ_checkpoöt_v2


94780 
	`sqlôe3LﬂdExãnsi⁄
(

94781 
sqlôe3
 *
db
,

94782 c⁄° *
zFûe
,

94783 c⁄° *
zProc
,

94784 **
pzEºMsg


94786 
sqlôe3_vfs
 *
pVfs
 = 
db
->pVfs;

94787 *
h™dÀ
;

94788 (*
xInô
)(
sqlôe3
*,**,c⁄° 
sqlôe3_≠i_routöes
*);

94789 *
zEºmsg
 = 0;

94790 c⁄° *
zE¡ry
;

94791 *
zA…E¡ry
 = 0;

94792 **
aH™dÀ
;

94793 
nMsg
 = 300 + 
	`sqlôe3SåÀn30
(
zFûe
);

94794 
ii
;

94797 c⁄° *
azEndögs
[] = {

94798 #i‡
SQLITE_OS_WIN


94800 #ñi‡
	`deföed
(
__APPLE__
)

94808 if–
pzEºMsg
 ) *pzErrMsg = 0;

94816 if–(
db
->
Êags
 & 
SQLITE_LﬂdExãnsi⁄
)==0 ){

94817 if–
pzEºMsg
 ){

94818 *
pzEºMsg
 = 
	`sqlôe3_m¥ötf
("notáuthorized");

94820  
SQLITE_ERROR
;

94823 
zE¡ry
 = 
zProc
 ? zProc : "sqlite3_extension_init";

94825 
h™dÀ
 = 
	`sqlôe3OsDlO≥n
(
pVfs
, 
zFûe
);

94826 #i‡
SQLITE_OS_UNIX
 || 
SQLITE_OS_WIN


94827 
ii
=0; ii<
	`AºaySize
(
azEndögs
Ë&& 
h™dÀ
==0; ii++){

94828 *
zA…Fûe
 = 
	`sqlôe3_m¥ötf
("%s.%s", 
zFûe
, 
azEndögs
[
ii
]);

94829 if–
zA…Fûe
==0 )  
SQLITE_NOMEM
;

94830 
h™dÀ
 = 
	`sqlôe3OsDlO≥n
(
pVfs
, 
zA…Fûe
);

94831 
	`sqlôe3_‰ì
(
zA…Fûe
);

94834 if–
h™dÀ
==0 ){

94835 if–
pzEºMsg
 ){

94836 *
pzEºMsg
 = 
zEºmsg
 = 
	`sqlôe3_mÆloc
(
nMsg
);

94837 if–
zEºmsg
 ){

94838 
	`sqlôe3_¢¥ötf
(
nMsg
, 
zEºmsg
,

94839 "u«bÀÅÿ›í sh¨edÜibøry [%s]", 
zFûe
);

94840 
	`sqlôe3OsDlEº‹
(
pVfs
, 
nMsg
-1, 
zEºmsg
);

94843  
SQLITE_ERROR
;

94845 
xInô
 = ((*)(
sqlôe3
*,**,c⁄° 
sqlôe3_≠i_routöes
*))

94846 
	`sqlôe3OsDlSym
(
pVfs
, 
h™dÀ
, 
zE¡ry
);

94859 if–
xInô
==0 && 
zProc
==0 ){

94860 
iFûe
, 
iE¡ry
, 
c
;

94861 
ncFûe
 = 
	`sqlôe3SåÀn30
(
zFûe
);

94862 
zA…E¡ry
 = 
	`sqlôe3_mÆloc
(
ncFûe
+30);

94863 if–
zA…E¡ry
==0 ){

94864 
	`sqlôe3OsDlClo£
(
pVfs
, 
h™dÀ
);

94865  
SQLITE_NOMEM
;

94867 
	`mem˝y
(
zA…E¡ry
, "sqlite3_", 8);

94868 
iFûe
=
ncFûe
-1; iFûe>=0 && 
zFûe
[iFile]!='/'; iFile--){}

94869 
iFûe
++;

94870 if–
	`sqlôe3_°∫icmp
(
zFûe
+
iFûe
, "lib", 3)==0 ) iFile += 3;

94871 
iE¡ry
=8; (
c
 = 
zFûe
[
iFûe
])!=0 && c!='.'; iFile++){

94872 if–
	`sqlôe3IßÕha
(
c
) ){

94873 
zA…E¡ry
[
iE¡ry
++] = ()
sqlôe3UµîToLowî
[()
c
];

94876 
	`mem˝y
(
zA…E¡ry
+
iE¡ry
, "_init", 6);

94877 
zE¡ry
 = 
zA…E¡ry
;

94878 
xInô
 = ((*)(
sqlôe3
*,**,c⁄° 
sqlôe3_≠i_routöes
*))

94879 
	`sqlôe3OsDlSym
(
pVfs
, 
h™dÀ
, 
zE¡ry
);

94881 if–
xInô
==0 ){

94882 if–
pzEºMsg
 ){

94883 
nMsg
 +
	`sqlôe3SåÀn30
(
zE¡ry
);

94884 *
pzEºMsg
 = 
zEºmsg
 = 
	`sqlôe3_mÆloc
(
nMsg
);

94885 if–
zEºmsg
 ){

94886 
	`sqlôe3_¢¥ötf
(
nMsg
, 
zEºmsg
,

94887 "nÿíåyÖoöà[%s] i¿sh¨edÜibøry [%s]", 
zE¡ry
, 
zFûe
);

94888 
	`sqlôe3OsDlEº‹
(
pVfs
, 
nMsg
-1, 
zEºmsg
);

94891 
	`sqlôe3OsDlClo£
(
pVfs
, 
h™dÀ
);

94892 
	`sqlôe3_‰ì
(
zA…E¡ry
);

94893  
SQLITE_ERROR
;

94895 
	`sqlôe3_‰ì
(
zA…E¡ry
);

94896 if–
	`xInô
(
db
, &
zEºmsg
, &
sqlôe3Apis
) ){

94897 if–
pzEºMsg
 ){

94898 *
pzEºMsg
 = 
	`sqlôe3_m¥ötf
("îr‹ durög inôüliz©i⁄: %s", 
zEºmsg
);

94900 
	`sqlôe3_‰ì
(
zEºmsg
);

94901 
	`sqlôe3OsDlClo£
(
pVfs
, 
h™dÀ
);

94902  
SQLITE_ERROR
;

94906 
aH™dÀ
 = 
	`sqlôe3DbMÆlocZîo
(
db
, (
h™dÀ
)*(db->
nExãnsi⁄
+1));

94907 if–
aH™dÀ
==0 ){

94908  
SQLITE_NOMEM
;

94910 if–
db
->
nExãnsi⁄
>0 ){

94911 
	`mem˝y
(
aH™dÀ
, 
db
->
aExãnsi⁄
, (
h™dÀ
)*db->
nExãnsi⁄
);

94913 
	`sqlôe3DbFªe
(
db
, db->
aExãnsi⁄
);

94914 
db
->
aExãnsi⁄
 = 
aH™dÀ
;

94916 
db
->
aExãnsi⁄
[db->
nExãnsi⁄
++] = 
h™dÀ
;

94917  
SQLITE_OK
;

94919 
SQLITE_API
 
	`sqlôe3_lﬂd_exãnsi⁄
(

94920 
sqlôe3
 *
db
,

94921 c⁄° *
zFûe
,

94922 c⁄° *
zProc
,

94923 **
pzEºMsg


94925 
rc
;

94926 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

94927 
rc
 = 
	`sqlôe3LﬂdExãnsi⁄
(
db
, 
zFûe
, 
zProc
, 
pzEºMsg
);

94928 
rc
 = 
	`sqlôe3ApiExô
(
db
,Ñc);

94929 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

94930  
rc
;

94937 
SQLITE_PRIVATE
 
	`sqlôe3Clo£Exãnsi⁄s
(
sqlôe3
 *
db
){

94938 
i
;

94939 
	`as£π
–
	`sqlôe3_muãx_hñd
(
db
->
muãx
) );

94940 
i
=0; i<
db
->
nExãnsi⁄
; i++){

94941 
	`sqlôe3OsDlClo£
(
db
->
pVfs
, db->
aExãnsi⁄
[
i
]);

94943 
	`sqlôe3DbFªe
(
db
, db->
aExãnsi⁄
);

94950 
SQLITE_API
 
	`sqlôe3_íabÀ_lﬂd_exãnsi⁄
(
sqlôe3
 *
db
, 
⁄off
){

94951 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

94952 if–
⁄off
 ){

94953 
db
->
Êags
 |
SQLITE_LﬂdExãnsi⁄
;

94955 
db
->
Êags
 &~
SQLITE_LﬂdExãnsi⁄
;

94957 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

94958  
SQLITE_OK
;

94969 #ifde‡
SQLITE_OMIT_LOAD_EXTENSION


94970 c⁄° 
sqlôe3_≠i_routöes
 
sqlôe3Apis
 = { 0 };

94981 
sqlôe3AutoExtLi°
 
	tsqlôe3AutoExtLi°
;

94982 
SQLITE_WSD
 
	ssqlôe3AutoExtLi°
 {

94983 
nExt
;

94984 (**
aExt
)();

94985 } 
sqlôe3Aut€xt
 = { 0, 0 };

94993 #ifde‡
SQLITE_OMIT_WSD


94994 
	#wsdAut€xtInô
 \

94995 
sqlôe3AutoExtLi°
 *
x
 = &
	`GLOBAL
(sqlôe3AutoExtLi°,
sqlôe3Aut€xt
)

	)

94996 
	#wsdAut€xt
 
x
[0]

	)

94998 
	#wsdAut€xtInô


	)

94999 
	#wsdAut€xt
 
sqlôe3Aut€xt


	)

95007 
SQLITE_API
 
	`sqlôe3_auto_exãnsi⁄
((*
xInô
)()){

95008 
rc
 = 
SQLITE_OK
;

95009 #i‚de‡
SQLITE_OMIT_AUTOINIT


95010 
rc
 = 
	`sqlôe3_öôülize
();

95011 if–
rc
 ){

95012  
rc
;

95016 
i
;

95017 #i‡
SQLITE_THREADSAFE


95018 
sqlôe3_muãx
 *
muãx
 = 
	`sqlôe3MuãxAŒoc
(
SQLITE_MUTEX_STATIC_MASTER
);

95020 
wsdAut€xtInô
;

95021 
	`sqlôe3_muãx_íãr
(
muãx
);

95022 
i
=0; i<
wsdAut€xt
.
nExt
; i++){

95023 if–
wsdAut€xt
.
aExt
[
i
]==
xInô
 ) ;

95025 if–
i
==
wsdAut€xt
.
nExt
 ){

95026 
nByã
 = (
wsdAut€xt
.
nExt
+1)*(wsdAut€xt.
aExt
[0]);

95027 (**
aNew
)();

95028 
aNew
 = 
	`sqlôe3_ªÆloc
(
wsdAut€xt
.
aExt
, 
nByã
);

95029 if–
aNew
==0 ){

95030 
rc
 = 
SQLITE_NOMEM
;

95032 
wsdAut€xt
.
aExt
 = 
aNew
;

95033 
wsdAut€xt
.
aExt
[wsdAut€xt.
nExt
] = 
xInô
;

95034 
wsdAut€xt
.
nExt
++;

95037 
	`sqlôe3_muãx_Àave
(
muãx
);

95038 
	`as£π
–(
rc
&0xff)==rc );

95039  
rc
;

95052 
SQLITE_API
 
	`sqlôe3_ˇn˚l_auto_exãnsi⁄
((*
xInô
)()){

95053 #i‡
SQLITE_THREADSAFE


95054 
sqlôe3_muãx
 *
muãx
 = 
	`sqlôe3MuãxAŒoc
(
SQLITE_MUTEX_STATIC_MASTER
);

95056 
i
;

95057 
n
 = 0;

95058 
wsdAut€xtInô
;

95059 
	`sqlôe3_muãx_íãr
(
muãx
);

95060 
i
=
wsdAut€xt
.
nExt
-1; i>=0; i--){

95061 if–
wsdAut€xt
.
aExt
[
i
]==
xInô
 ){

95062 
wsdAut€xt
.
nExt
--;

95063 
wsdAut€xt
.
aExt
[
i
] = wsdAut€xt.aExt[wsdAut€xt.
nExt
];

95064 
n
++;

95068 
	`sqlôe3_muãx_Àave
(
muãx
);

95069  
n
;

95075 
SQLITE_API
 
	`sqlôe3_ª£t_auto_exãnsi⁄
(){

95076 #i‚de‡
SQLITE_OMIT_AUTOINIT


95077 if–
	`sqlôe3_öôülize
()==
SQLITE_OK
 )

95080 #i‡
SQLITE_THREADSAFE


95081 
sqlôe3_muãx
 *
muãx
 = 
	`sqlôe3MuãxAŒoc
(
SQLITE_MUTEX_STATIC_MASTER
);

95083 
wsdAut€xtInô
;

95084 
	`sqlôe3_muãx_íãr
(
muãx
);

95085 
	`sqlôe3_‰ì
(
wsdAut€xt
.
aExt
);

95086 
wsdAut€xt
.
aExt
 = 0;

95087 
wsdAut€xt
.
nExt
 = 0;

95088 
	`sqlôe3_muãx_Àave
(
muãx
);

95097 
SQLITE_PRIVATE
 
	`sqlôe3AutoLﬂdExãnsi⁄s
(
sqlôe3
 *
db
){

95098 
i
;

95099 
go
 = 1;

95100 
rc
;

95101 (*
xInô
)(
sqlôe3
*,**,c⁄° 
sqlôe3_≠i_routöes
*);

95103 
wsdAut€xtInô
;

95104 if–
wsdAut€xt
.
nExt
==0 ){

95108 
i
=0; 
go
; i++){

95109 *
zEºmsg
;

95110 #i‡
SQLITE_THREADSAFE


95111 
sqlôe3_muãx
 *
muãx
 = 
	`sqlôe3MuãxAŒoc
(
SQLITE_MUTEX_STATIC_MASTER
);

95113 
	`sqlôe3_muãx_íãr
(
muãx
);

95114 if–
i
>=
wsdAut€xt
.
nExt
 ){

95115 
xInô
 = 0;

95116 
go
 = 0;

95118 
xInô
 = ((*)(
sqlôe3
*,**,c⁄° 
sqlôe3_≠i_routöes
*))

95119 
wsdAut€xt
.
aExt
[
i
];

95121 
	`sqlôe3_muãx_Àave
(
muãx
);

95122 
zEºmsg
 = 0;

95123 if–
xInô
 && (
rc
 = 
	`xInô
(
db
, &
zEºmsg
, &
sqlôe3Apis
))!=0 ){

95124 
	`sqlôe3Eº‹
(
db
, 
rc
,

95125 "autom©i¯exãnsi⁄Üﬂdög faûed: %s", 
zEºmsg
);

95126 
go
 = 0;

95128 
	`sqlôe3_‰ì
(
zEºmsg
);

95148 #i‡!
	`deföed
(
SQLITE_ENABLE_LOCKING_STYLE
)

95149 #i‡
	`deföed
(
__APPLE__
)

95150 
	#SQLITE_ENABLE_LOCKING_STYLE
 1

	)

95152 
	#SQLITE_ENABLE_LOCKING_STYLE
 0

	)

95163 
	#PøgTyp_HEADER_VALUE
 0

	)

95164 
	#PøgTyp_AUTO_VACUUM
 1

	)

95165 
	#PøgTyp_FLAG
 2

	)

95166 
	#PøgTyp_BUSY_TIMEOUT
 3

	)

95167 
	#PøgTyp_CACHE_SIZE
 4

	)

95168 
	#PøgTyp_CASE_SENSITIVE_LIKE
 5

	)

95169 
	#PøgTyp_COLLATION_LIST
 6

	)

95170 
	#PøgTyp_COMPILE_OPTIONS
 7

	)

95171 
	#PøgTyp_DATA_STORE_DIRECTORY
 8

	)

95172 
	#PøgTyp_DATABASE_LIST
 9

	)

95173 
	#PøgTyp_DEFAULT_CACHE_SIZE
 10

	)

95174 
	#PøgTyp_ENCODING
 11

	)

95175 
	#PøgTyp_FOREIGN_KEY_CHECK
 12

	)

95176 
	#PøgTyp_FOREIGN_KEY_LIST
 13

	)

95177 
	#PøgTyp_INCREMENTAL_VACUUM
 14

	)

95178 
	#PøgTyp_INDEX_INFO
 15

	)

95179 
	#PøgTyp_INDEX_LIST
 16

	)

95180 
	#PøgTyp_INTEGRITY_CHECK
 17

	)

95181 
	#PøgTyp_JOURNAL_MODE
 18

	)

95182 
	#PøgTyp_JOURNAL_SIZE_LIMIT
 19

	)

95183 
	#PøgTyp_LOCK_PROXY_FILE
 20

	)

95184 
	#PøgTyp_LOCKING_MODE
 21

	)

95185 
	#PøgTyp_PAGE_COUNT
 22

	)

95186 
	#PøgTyp_MMAP_SIZE
 23

	)

95187 
	#PøgTyp_PAGE_SIZE
 24

	)

95188 
	#PøgTyp_SECURE_DELETE
 25

	)

95189 
	#PøgTyp_SHRINK_MEMORY
 26

	)

95190 
	#PøgTyp_SOFT_HEAP_LIMIT
 27

	)

95191 
	#PøgTyp_STATS
 28

	)

95192 
	#PøgTyp_SYNCHRONOUS
 29

	)

95193 
	#PøgTyp_TABLE_INFO
 30

	)

95194 
	#PøgTyp_TEMP_STORE
 31

	)

95195 
	#PøgTyp_TEMP_STORE_DIRECTORY
 32

	)

95196 
	#PøgTyp_WAL_AUTOCHECKPOINT
 33

	)

95197 
	#PøgTyp_WAL_CHECKPOINT
 34

	)

95198 
	#PøgTyp_ACTIVATE_EXTENSIONS
 35

	)

95199 
	#PøgTyp_HEXKEY
 36

	)

95200 
	#PøgTyp_KEY
 37

	)

95201 
	#PøgTyp_REKEY
 38

	)

95202 
	#PøgTyp_LOCK_STATUS
 39

	)

95203 
	#PøgTyp_PARSER_TRACE
 40

	)

95204 
	#PøgFœg_NìdSchema
 0x01

	)

95205 c⁄° 
	ssPøgmaNames
 {

95206 c⁄° *c⁄° 
zName
;

95207 
u8
 
ePøgTyp
;

95208 
u8
 
mPøgFœg
;

95209 
u32
 
iArg
;

95210 } 
aPøgmaNames
[] = {

95211 #i‡
	`deföed
(
SQLITE_HAS_CODEC
Ë|| deföed(
SQLITE_ENABLE_CEROD
)

95213  
PøgTyp_ACTIVATE_EXTENSIONS
,

95217 #i‡!
	`deföed
(
SQLITE_OMIT_SCHEMA_VERSION_PRAGMAS
)

95219  
PøgTyp_HEADER_VALUE
,

95223 #i‡!
	`deföed
(
SQLITE_OMIT_AUTOVACUUM
)

95225  
PøgTyp_AUTO_VACUUM
,

95226  
PøgFœg_NìdSchema
,

95229 #i‡!
	`deföed
(
SQLITE_OMIT_AUTOMATIC_INDEX
)

95231  
PøgTyp_FLAG
,

95233  
SQLITE_AutoIndex
 },

95236  
PøgTyp_BUSY_TIMEOUT
,

95239 #i‡!
	`deföed
(
SQLITE_OMIT_PAGER_PRAGMAS
)

95241  
PøgTyp_CACHE_SIZE
,

95242  
PøgFœg_NìdSchema
,

95246  
PøgTyp_FLAG
,

95248  
SQLITE_CacheSpûl
 },

95250  
PøgTyp_CASE_SENSITIVE_LIKE
,

95254  
PøgTyp_FLAG
,

95256  
SQLITE_Ck±FuŒFSync
 },

95257 #i‡!
	`deföed
(
SQLITE_OMIT_SCHEMA_PRAGMAS
)

95259  
PøgTyp_COLLATION_LIST
,

95263 #i‡!
	`deföed
(
SQLITE_OMIT_COMPILEOPTION_DIAGS
)

95265  
PøgTyp_COMPILE_OPTIONS
,

95270  
PøgTyp_FLAG
,

95272  
SQLITE_Cou¡Rows
 },

95273 #i‡!
	`deföed
(
SQLITE_OMIT_PAGER_PRAGMAS
Ë&& 
SQLITE_OS_WIN


95275  
PøgTyp_DATA_STORE_DIRECTORY
,

95279 #i‡!
	`deföed
(
SQLITE_OMIT_SCHEMA_PRAGMAS
)

95281  
PøgTyp_DATABASE_LIST
,

95282  
PøgFœg_NìdSchema
,

95285 #i‡!
	`deföed
(
SQLITE_OMIT_PAGER_PRAGMAS
Ë&& !deföed(
SQLITE_OMIT_DEPRECATED
)

95287  
PøgTyp_DEFAULT_CACHE_SIZE
,

95288  
PøgFœg_NìdSchema
,

95291 #i‡!
	`deföed
(
SQLITE_OMIT_FOREIGN_KEY
Ë&& !deföed(
SQLITE_OMIT_TRIGGER
)

95293  
PøgTyp_FLAG
,

95295  
SQLITE_De„rFKs
 },

95298  
PøgTyp_FLAG
,

95300  
SQLITE_NuŒCÆlback
 },

95301 #i‡!
	`deföed
(
SQLITE_OMIT_UTF16
)

95303  
PøgTyp_ENCODING
,

95307 #i‡!
	`deföed
(
SQLITE_OMIT_FOREIGN_KEY
Ë&& !deföed(
SQLITE_OMIT_TRIGGER
)

95309  
PøgTyp_FOREIGN_KEY_CHECK
,

95310  
PøgFœg_NìdSchema
,

95313 #i‡!
	`deföed
(
SQLITE_OMIT_FOREIGN_KEY
)

95315  
PøgTyp_FOREIGN_KEY_LIST
,

95316  
PøgFœg_NìdSchema
,

95319 #i‡!
	`deföed
(
SQLITE_OMIT_FOREIGN_KEY
Ë&& !deföed(
SQLITE_OMIT_TRIGGER
)

95321  
PøgTyp_FLAG
,

95323  
SQLITE_F‹eignKeys
 },

95325 #i‡!
	`deföed
(
SQLITE_OMIT_SCHEMA_VERSION_PRAGMAS
)

95327  
PøgTyp_HEADER_VALUE
,

95332  
PøgTyp_FLAG
,

95334  
SQLITE_FuŒCﬁNames
 },

95336  
PøgTyp_FLAG
,

95338  
SQLITE_FuŒFSync
 },

95339 #i‡
	`deföed
(
SQLITE_HAS_CODEC
)

95341  
PøgTyp_HEXKEY
,

95345  
PøgTyp_HEXKEY
,

95349 #i‡!
	`deföed
(
SQLITE_OMIT_CHECK
)

95351  
PøgTyp_FLAG
,

95353  
SQLITE_Ign‹eChecks
 },

95355 #i‡!
	`deföed
(
SQLITE_OMIT_AUTOVACUUM
)

95357  
PøgTyp_INCREMENTAL_VACUUM
,

95358  
PøgFœg_NìdSchema
,

95361 #i‡!
	`deföed
(
SQLITE_OMIT_SCHEMA_PRAGMAS
)

95363  
PøgTyp_INDEX_INFO
,

95364  
PøgFœg_NìdSchema
,

95367  
PøgTyp_INDEX_LIST
,

95368  
PøgFœg_NìdSchema
,

95371 #i‡!
	`deföed
(
SQLITE_OMIT_INTEGRITY_CHECK
)

95373  
PøgTyp_INTEGRITY_CHECK
,

95374  
PøgFœg_NìdSchema
,

95377 #i‡!
	`deföed
(
SQLITE_OMIT_PAGER_PRAGMAS
)

95379  
PøgTyp_JOURNAL_MODE
,

95380  
PøgFœg_NìdSchema
,

95383  
PøgTyp_JOURNAL_SIZE_LIMIT
,

95387 #i‡
	`deföed
(
SQLITE_HAS_CODEC
)

95389  
PøgTyp_KEY
,

95394  
PøgTyp_FLAG
,

95396  
SQLITE_LegacyFûeFmt
 },

95397 #i‡!
	`deföed
(
SQLITE_OMIT_PAGER_PRAGMAS
Ë&& 
SQLITE_ENABLE_LOCKING_STYLE


95399  
PøgTyp_LOCK_PROXY_FILE
,

95403 #i‡
	`deföed
(
SQLITE_DEBUG
Ë|| deföed(
SQLITE_TEST
)

95405  
PøgTyp_LOCK_STATUS
,

95409 #i‡!
	`deföed
(
SQLITE_OMIT_PAGER_PRAGMAS
)

95411  
PøgTyp_LOCKING_MODE
,

95415  
PøgTyp_PAGE_COUNT
,

95416  
PøgFœg_NìdSchema
,

95419  
PøgTyp_MMAP_SIZE
,

95423  
PøgTyp_PAGE_COUNT
,

95424  
PøgFœg_NìdSchema
,

95427  
PøgTyp_PAGE_SIZE
,

95431 #i‡
	`deföed
(
SQLITE_DEBUG
)

95433  
PøgTyp_PARSER_TRACE
,

95438  
PøgTyp_FLAG
,

95440  
SQLITE_QuîyO∆y
 },

95441 #i‡!
	`deföed
(
SQLITE_OMIT_INTEGRITY_CHECK
)

95443  
PøgTyp_INTEGRITY_CHECK
,

95444  
PøgFœg_NìdSchema
,

95448  
PøgTyp_FLAG
,

95450  
SQLITE_RódUncommôãd
 },

95452  
PøgTyp_FLAG
,

95454  
SQLITE_RecTriggîs
 },

95455 #i‡
	`deföed
(
SQLITE_HAS_CODEC
)

95457  
PøgTyp_REKEY
,

95462  
PøgTyp_FLAG
,

95464  
SQLITE_Revî£Ordî
 },

95465 #i‡!
	`deföed
(
SQLITE_OMIT_SCHEMA_VERSION_PRAGMAS
)

95467  
PøgTyp_HEADER_VALUE
,

95471 #i‡!
	`deföed
(
SQLITE_OMIT_PAGER_PRAGMAS
)

95473  
PøgTyp_SECURE_DELETE
,

95478  
PøgTyp_FLAG
,

95480  
SQLITE_Sh‹tCﬁNames
 },

95482  
PøgTyp_SHRINK_MEMORY
,

95486  
PøgTyp_SOFT_HEAP_LIMIT
,

95489 #i‡
	`deföed
(
SQLITE_DEBUG
)

95491  
PøgTyp_FLAG
,

95493  
SQLITE_SqlTø˚
 },

95495 #i‡!
	`deföed
(
SQLITE_OMIT_SCHEMA_PRAGMAS
)

95497  
PøgTyp_STATS
,

95498  
PøgFœg_NìdSchema
,

95501 #i‡!
	`deföed
(
SQLITE_OMIT_PAGER_PRAGMAS
)

95503  
PøgTyp_SYNCHRONOUS
,

95504  
PøgFœg_NìdSchema
,

95507 #i‡!
	`deföed
(
SQLITE_OMIT_SCHEMA_PRAGMAS
)

95509  
PøgTyp_TABLE_INFO
,

95510  
PøgFœg_NìdSchema
,

95513 #i‡!
	`deföed
(
SQLITE_OMIT_PAGER_PRAGMAS
)

95515  
PøgTyp_TEMP_STORE
,

95519  
PøgTyp_TEMP_STORE_DIRECTORY
,

95523 #i‡!
	`deföed
(
SQLITE_OMIT_SCHEMA_VERSION_PRAGMAS
)

95525  
PøgTyp_HEADER_VALUE
,

95529 #i‡
	`deföed
(
SQLITE_DEBUG
)

95531  
PøgTyp_FLAG
,

95533  
SQLITE_VdbeAdd›Tø˚
 },

95535  
PøgTyp_FLAG
,

95537  
SQLITE_SqlTø˚
|
SQLITE_VdbeLi°ög
|
SQLITE_VdbeTø˚
 },

95539  
PøgTyp_FLAG
,

95541  
SQLITE_VdbeLi°ög
 },

95543  
PøgTyp_FLAG
,

95545  
SQLITE_VdbeTø˚
 },

95547 #i‡!
	`deföed
(
SQLITE_OMIT_WAL
)

95549  
PøgTyp_WAL_AUTOCHECKPOINT
,

95553  
PøgTyp_WAL_CHECKPOINT
,

95554  
PøgFœg_NìdSchema
,

95558  
PøgTyp_FLAG
,

95560  
SQLITE_WrôeSchema
|
SQLITE_RecovîyMode
 },

95577 
u8
 
	`gëSa„tyLevñ
(c⁄° *
z
, 
omôFuŒ
, 
dÊt
){

95579 c⁄° 
zText
[] = "onoffalseyestruefull";

95580 c⁄° 
u8
 
iOff£t
[] = {0, 1, 2, 4, 9, 12, 16};

95581 c⁄° 
u8
 
iLígth
[] = {2, 2, 3, 5, 3, 4, 4};

95582 c⁄° 
u8
 
iVÆue
[] = {1, 0, 0, 0, 1, 1, 2};

95583 
i
, 
n
;

95584 if–
	`sqlôe3Isdigô
(*
z
) ){

95585  (
u8
)
	`sqlôe3Atoi
(
z
);

95587 
n
 = 
	`sqlôe3SåÀn30
(
z
);

95588 
i
=0; i<
	`AºaySize
(
iLígth
)-
omôFuŒ
; i++){

95589 if–
iLígth
[
i
]==
n
 && 
	`sqlôe3SåNICmp
(&
zText
[
iOff£t
[i]],
z
,n)==0 ){

95590  
iVÆue
[
i
];

95593  
dÊt
;

95599 
SQLITE_PRIVATE
 
u8
 
	`sqlôe3GëBoﬁón
(c⁄° *
z
, 
dÊt
){

95600  
	`gëSa„tyLevñ
(
z
,1,
dÊt
)!=0;

95607 #i‡!
	`deföed
(
SQLITE_OMIT_PRAGMA
)

95612 
	`gëLockögMode
(c⁄° *
z
){

95613 if–
z
 ){

95614 if–0==
	`sqlôe3SåICmp
(
z
, "ex˛usive"ËË 
PAGER_LOCKINGMODE_EXCLUSIVE
;

95615 if–0==
	`sqlôe3SåICmp
(
z
, "n‹mÆ"ËË 
PAGER_LOCKINGMODE_NORMAL
;

95617  
PAGER_LOCKINGMODE_QUERY
;

95620 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


95627 
	`gëAutoVacuum
(c⁄° *
z
){

95628 
i
;

95629 if–0==
	`sqlôe3SåICmp
(
z
, "n⁄e"ËË 
BTREE_AUTOVACUUM_NONE
;

95630 if–0==
	`sqlôe3SåICmp
(
z
, "fuŒ"ËË 
BTREE_AUTOVACUUM_FULL
;

95631 if–0==
	`sqlôe3SåICmp
(
z
, "ö¸emíèl"ËË 
BTREE_AUTOVACUUM_INCR
;

95632 
i
 = 
	`sqlôe3Atoi
(
z
);

95633  (
u8
)((
i
>=0&&i<=2)?i:0);

95637 #i‚de‡
SQLITE_OMIT_PAGER_PRAGMAS


95643 
	`gëTempSt‹e
(c⁄° *
z
){

95644 if–
z
[0]>='0' && z[0]<='2' ){

95645  
z
[0] - '0';

95646 }if–
	`sqlôe3SåICmp
(
z
, "file")==0 ){

95648 }if–
	`sqlôe3SåICmp
(
z
, "memory")==0 ){

95656 #i‚de‡
SQLITE_OMIT_PAGER_PRAGMAS


95661 
	`övÆid©eTempSt‹age
(
P¨£
 *
pP¨£
){

95662 
sqlôe3
 *
db
 = 
pP¨£
->db;

95663 if–
db
->
aDb
[1].
pBt
!=0 ){

95664 if–!
db
->
autoCommô
 || 
	`sqlôe3BåìIsInRódTøns
(db->
aDb
[1].
pBt
) ){

95665 
	`sqlôe3Eº‹Msg
(
pP¨£
, "temporary storage cannot be changed "

95667  
SQLITE_ERROR
;

95669 
	`sqlôe3BåìClo£
(
db
->
aDb
[1].
pBt
);

95670 
db
->
aDb
[1].
pBt
 = 0;

95671 
	`sqlôe3Re£tAŒSchemasOfC⁄√˘i⁄
(
db
);

95673  
SQLITE_OK
;

95677 #i‚de‡
SQLITE_OMIT_PAGER_PRAGMAS


95683 
	`ch™geTempSt‹age
(
P¨£
 *
pP¨£
, c⁄° *
zSt‹ageTy≥
){

95684 
ts
 = 
	`gëTempSt‹e
(
zSt‹ageTy≥
);

95685 
sqlôe3
 *
db
 = 
pP¨£
->db;

95686 if–
db
->
ãmp_°‹e
==
ts
 )  
SQLITE_OK
;

95687 if–
	`övÆid©eTempSt‹age
–
pP¨£
 ) !
SQLITE_OK
 ){

95688  
SQLITE_ERROR
;

95690 
db
->
ãmp_°‹e
 = (
u8
)
ts
;

95691  
SQLITE_OK
;

95698 
	`ªtu∫SögÀI¡
(
P¨£
 *
pP¨£
, c⁄° *
zLabñ
, 
i64
 
vÆue
){

95699 
Vdbe
 *
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

95700 
mem
 = ++
pP¨£
->
nMem
;

95701 
i64
 *
pI64
 = 
	`sqlôe3DbMÆlocRaw
(
pP¨£
->
db
, (
vÆue
));

95702 if–
pI64
 ){

95703 
	`mem˝y
(
pI64
, &
vÆue
, (value));

95705 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_I¡64
, 0, 
mem
, 0, (*)
pI64
, 
P4_INT64
);

95706 
	`sqlôe3VdbeSëNumCﬁs
(
v
, 1);

95707 
	`sqlôe3VdbeSëCﬁName
(
v
, 0, 
COLNAME_NAME
, 
zLabñ
, 
SQLITE_STATIC
);

95708 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Resu…Row
, 
mem
, 1);

95716 #i‚de‡
SQLITE_OMIT_PAGER_PRAGMAS


95717 
	`£tAŒPagîFœgs
(
sqlôe3
 *
db
){

95718 if–
db
->
autoCommô
 ){

95719 
Db
 *
pDb
 = 
db
->
aDb
;

95720 
n
 = 
db
->
nDb
;

95721 
	`as£π
–
SQLITE_FuŒFSync
==
PAGER_FULLFSYNC
 );

95722 
	`as£π
–
SQLITE_Ck±FuŒFSync
==
PAGER_CKPT_FULLFSYNC
 );

95723 
	`as£π
–
SQLITE_CacheSpûl
==
PAGER_CACHESPILL
 );

95724 
	`as£π
–(
PAGER_FULLFSYNC
 | 
PAGER_CKPT_FULLFSYNC
 | 
PAGER_CACHESPILL
)

95725 =
PAGER_FLAGS_MASK
 );

95726 
	`as£π
–(
pDb
->
ß„ty_Àvñ
 & 
PAGER_SYNCHRONOUS_MASK
)==pDb->safety_level );

95727  (
n
--) > 0 ){

95728 if–
pDb
->
pBt
 ){

95729 
	`sqlôe3BåìSëPagîFœgs
(
pDb
->
pBt
,

95730 
pDb
->
ß„ty_Àvñ
 | (
db
->
Êags
 & 
PAGER_FLAGS_MASK
) );

95732 
pDb
++;

95737 
	#£tAŒPagîFœgs
(
X
Ë

	)

95744 #i‚de‡
SQLITE_OMIT_FOREIGN_KEY


95745 c⁄° *
	`a˘i⁄Name
(
u8
 
a˘i⁄
){

95746 c⁄° *
zName
;

95747  
a˘i⁄
 ){

95748 
OE_SëNuŒ
: 
zName
 = "SET NULL"; ;

95749 
OE_SëDÊt
: 
zName
 = "SET DEFAULT"; ;

95750 
OE_Casˇde
: 
zName
 = "CASCADE"; ;

95751 
OE_Re°ri˘
: 
zName
 = "RESTRICT"; ;

95752 : 
zName
 = "NO ACTION";

95753 
	`as£π
–
a˘i⁄
==
OE_N⁄e
 ); ;

95755  
zName
;

95765 
SQLITE_PRIVATE
 c⁄° *
	`sqlôe3Jou∫ÆModíame
(
eMode
){

95766 * c⁄° 
azModeName
[] = {

95768 #i‚de‡
SQLITE_OMIT_WAL


95772 
	`as£π
–
PAGER_JOURNALMODE_DELETE
==0 );

95773 
	`as£π
–
PAGER_JOURNALMODE_PERSIST
==1 );

95774 
	`as£π
–
PAGER_JOURNALMODE_OFF
==2 );

95775 
	`as£π
–
PAGER_JOURNALMODE_TRUNCATE
==3 );

95776 
	`as£π
–
PAGER_JOURNALMODE_MEMORY
==4 );

95777 
	`as£π
–
PAGER_JOURNALMODE_WAL
==5 );

95778 
	`as£π
–
eMode
>=0 &&ÉMode<=
	`AºaySize
(
azModeName
) );

95780 if–
eMode
==
	`AºaySize
(
azModeName
) )  0;

95781  
azModeName
[
eMode
];

95799 
SQLITE_PRIVATE
 
	`sqlôe3Pøgma
(

95800 
P¨£
 *
pP¨£
,

95801 
Tokí
 *
pId1
,

95802 
Tokí
 *
pId2
,

95803 
Tokí
 *
pVÆue
,

95804 
möusFœg


95806 *
zLe·
 = 0;

95807 *
zRight
 = 0;

95808 c⁄° *
zDb
 = 0;

95809 
Tokí
 *
pId
;

95810 *
aF˙é
[4];

95811 
iDb
;

95812 
lwr
, 
u¥
, 
mid
;

95813 
rc
;

95814 
sqlôe3
 *
db
 = 
pP¨£
->db;

95815 
Db
 *
pDb
;

95816 
Vdbe
 *
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

95818 if–
v
==0 ) ;

95819 
	`sqlôe3VdbeRunO∆yOn˚
(
v
);

95820 
pP¨£
->
nMem
 = 2;

95824 
iDb
 = 
	`sqlôe3TwoP¨tName
(
pP¨£
, 
pId1
, 
pId2
, &
pId
);

95825 if–
iDb
<0 ) ;

95826 
pDb
 = &
db
->
aDb
[
iDb
];

95831 if–
iDb
==1 && 
	`sqlôe3O≥nTempD©aba£
(
pP¨£
) ){

95835 
zLe·
 = 
	`sqlôe3NameFromTokí
(
db
, 
pId
);

95836 if–!
zLe·
 ) ;

95837 if–
möusFœg
 ){

95838 
zRight
 = 
	`sqlôe3MPrötf
(
db
, "-%T", 
pVÆue
);

95840 
zRight
 = 
	`sqlôe3NameFromTokí
(
db
, 
pVÆue
);

95843 
	`as£π
–
pId2
 );

95844 
zDb
 = 
pId2
->
n
>0 ? 
pDb
->
zName
 : 0;

95845 if–
	`sqlôe3AuthCheck
(
pP¨£
, 
SQLITE_PRAGMA
, 
zLe·
, 
zRight
, 
zDb
) ){

95846 
¥agma_out
;

95853 
aF˙é
[0] = 0;

95854 
aF˙é
[1] = 
zLe·
;

95855 
aF˙é
[2] = 
zRight
;

95856 
aF˙é
[3] = 0;

95857 
db
->
busyH™dÀr
.
nBusy
 = 0;

95858 
rc
 = 
	`sqlôe3_fûe_c⁄åﬁ
(
db
, 
zDb
, 
SQLITE_FCNTL_PRAGMA
, (*)
aF˙é
);

95859 if–
rc
==
SQLITE_OK
 ){

95860 if–
aF˙é
[0] ){

95861 
mem
 = ++
pP¨£
->
nMem
;

95862 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Såög8
, 0, 
mem
, 0, 
aF˙é
[0], 0);

95863 
	`sqlôe3VdbeSëNumCﬁs
(
v
, 1);

95864 
	`sqlôe3VdbeSëCﬁName
(
v
, 0, 
COLNAME_NAME
, "ªsu…", 
SQLITE_STATIC
);

95865 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Resu…Row
, 
mem
, 1);

95866 
	`sqlôe3_‰ì
(
aF˙é
[0]);

95868 
¥agma_out
;

95870 if–
rc
!=
SQLITE_NOTFOUND
 ){

95871 if–
aF˙é
[0] ){

95872 
	`sqlôe3Eº‹Msg
(
pP¨£
, "%s", 
aF˙é
[0]);

95873 
	`sqlôe3_‰ì
(
aF˙é
[0]);

95875 
pP¨£
->
nEº
++;

95876 
pP¨£
->
rc
 =Ñc;

95877 
¥agma_out
;

95881 
lwr
 = 0;

95882 
u¥
 = 
	`AºaySize
(
aPøgmaNames
)-1;

95883  
lwr
<=
u¥
 ){

95884 
mid
 = (
lwr
+
u¥
)/2;

95885 
rc
 = 
	`sqlôe3_°ricmp
(
zLe·
, 
aPøgmaNames
[
mid
].
zName
);

95886 if–
rc
==0 ) ;

95887 if–
rc
<0 ){

95888 
u¥
 = 
mid
 - 1;

95890 
lwr
 = 
mid
 + 1;

95893 if–
lwr
>
u¥
 ) 
¥agma_out
;

95896 if–(
aPøgmaNames
[
mid
].
mPøgFœg
 & 
PøgFœg_NìdSchema
)!=0 ){

95897 if–
	`sqlôe3RódSchema
(
pP¨£
ËË
¥agma_out
;

95901  
aPøgmaNames
[
mid
].
ePøgTyp
 ){

95903 #i‡!
	`deföed
(
SQLITE_OMIT_PAGER_PRAGMAS
Ë&& !deföed(
SQLITE_OMIT_DEPRECATED
)

95920 
PøgTyp_DEFAULT_CACHE_SIZE
: {

95921 c⁄° 
VdbeOpLi°
 
gëCacheSize
[] = {

95922 { 
OP_Tønß˘i⁄
, 0, 0, 0},

95923 { 
OP_RódCookõ
, 0, 1, 
BTREE_DEFAULT_CACHE_SIZE
},

95924 { 
OP_IfPos
, 1, 8, 0},

95925 { 
OP_I¡egî
, 0, 2, 0},

95926 { 
OP_Subåa˘
, 1, 2, 1},

95927 { 
OP_IfPos
, 1, 8, 0},

95928 { 
OP_I¡egî
, 0, 1, 0},

95929 { 
OP_No›
, 0, 0, 0},

95930 { 
OP_Resu…Row
, 1, 1, 0},

95932 
addr
;

95933 
	`sqlôe3VdbeU£sBåì
(
v
, 
iDb
);

95934 if–!
zRight
 ){

95935 
	`sqlôe3VdbeSëNumCﬁs
(
v
, 1);

95936 
	`sqlôe3VdbeSëCﬁName
(
v
, 0, 
COLNAME_NAME
, "ˇche_size", 
SQLITE_STATIC
);

95937 
pP¨£
->
nMem
 += 2;

95938 
addr
 = 
	`sqlôe3VdbeAddOpLi°
(
v
, 
	`AºaySize
(
gëCacheSize
), getCacheSize);

95939 
	`sqlôe3VdbeCh™geP1
(
v
, 
addr
, 
iDb
);

95940 
	`sqlôe3VdbeCh™geP1
(
v
, 
addr
+1, 
iDb
);

95941 
	`sqlôe3VdbeCh™geP1
(
v
, 
addr
+6, 
SQLITE_DEFAULT_CACHE_SIZE
);

95943 
size
 = 
	`sqlôe3AbsI¡32
(
	`sqlôe3Atoi
(
zRight
));

95944 
	`sqlôe3BegöWrôeO≥øti⁄
(
pP¨£
, 0, 
iDb
);

95945 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 
size
, 1);

95946 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_SëCookõ
, 
iDb
, 
BTREE_DEFAULT_CACHE_SIZE
, 1);

95947 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 
iDb
, 0) );

95948 
pDb
->
pSchema
->
ˇche_size
 = 
size
;

95949 
	`sqlôe3BåìSëCacheSize
(
pDb
->
pBt
,ÖDb->
pSchema
->
ˇche_size
);

95955 #i‡!
	`deföed
(
SQLITE_OMIT_PAGER_PRAGMAS
)

95965 
PøgTyp_PAGE_SIZE
: {

95966 
Båì
 *
pBt
 = 
pDb
->pBt;

95967 
	`as£π
–
pBt
!=0 );

95968 if–!
zRight
 ){

95969 
size
 = 
	`ALWAYS
(
pBt
Ë? 
	`sqlôe3BåìGëPageSize
(pBt) : 0;

95970 
	`ªtu∫SögÀI¡
(
pP¨£
, "∑ge_size", 
size
);

95975 
db
->
√xtPagesize
 = 
	`sqlôe3Atoi
(
zRight
);

95976 if–
SQLITE_NOMEM
==
	`sqlôe3BåìSëPageSize
(
pBt
, 
db
->
√xtPagesize
,-1,0) ){

95977 
db
->
mÆlocFaûed
 = 1;

95991 
PøgTyp_SECURE_DELETE
: {

95992 
Båì
 *
pBt
 = 
pDb
->pBt;

95993 
b
 = -1;

95994 
	`as£π
–
pBt
!=0 );

95995 if–
zRight
 ){

95996 
b
 = 
	`sqlôe3GëBoﬁón
(
zRight
, 0);

95998 if–
pId2
->
n
==0 && 
b
>=0 ){

95999 
ii
;

96000 
ii
=0; ii<
db
->
nDb
; ii++){

96001 
	`sqlôe3BåìSecuªDñëe
(
db
->
aDb
[
ii
].
pBt
, 
b
);

96004 
b
 = 
	`sqlôe3BåìSecuªDñëe
(
pBt
, b);

96005 
	`ªtu∫SögÀI¡
(
pP¨£
, "£cuª_dñëe", 
b
);

96026 
PøgTyp_PAGE_COUNT
: {

96027 
iReg
;

96028 
	`sqlôe3CodeVîifySchema
(
pP¨£
, 
iDb
);

96029 
iReg
 = ++
pP¨£
->
nMem
;

96030 if–
	`sqlôe3Tﬁowî
(
zLe·
[0])=='p' ){

96031 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Pagecou¡
, 
iDb
, 
iReg
);

96033 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_MaxPg˙t
, 
iDb
, 
iReg
,

96034 
	`sqlôe3AbsI¡32
(
	`sqlôe3Atoi
(
zRight
)));

96036 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Resu…Row
, 
iReg
, 1);

96037 
	`sqlôe3VdbeSëNumCﬁs
(
v
, 1);

96038 
	`sqlôe3VdbeSëCﬁName
(
v
, 0, 
COLNAME_NAME
, 
zLe·
, 
SQLITE_TRANSIENT
);

96046 
PøgTyp_LOCKING_MODE
: {

96047 c⁄° *
zRë
 = "normal";

96048 
eMode
 = 
	`gëLockögMode
(
zRight
);

96050 if–
pId2
->
n
==0 && 
eMode
==
PAGER_LOCKINGMODE_QUERY
 ){

96055 
eMode
 = 
db
->
dÊtLockMode
;

96057 
Pagî
 *
pPagî
;

96058 if–
pId2
->
n
==0 ){

96067 
ii
;

96068 
	`as£π
(
pDb
==&
db
->
aDb
[0]);

96069 
ii
=2; ii<
db
->
nDb
; ii++){

96070 
pPagî
 = 
	`sqlôe3BåìPagî
(
db
->
aDb
[
ii
].
pBt
);

96071 
	`sqlôe3PagîLockögMode
(
pPagî
, 
eMode
);

96073 
db
->
dÊtLockMode
 = (
u8
)
eMode
;

96075 
pPagî
 = 
	`sqlôe3BåìPagî
(
pDb
->
pBt
);

96076 
eMode
 = 
	`sqlôe3PagîLockögMode
(
pPagî
,ÉMode);

96079 
	`as£π
–
eMode
==
PAGER_LOCKINGMODE_NORMAL


96080 || 
eMode
==
PAGER_LOCKINGMODE_EXCLUSIVE
 );

96081 if–
eMode
==
PAGER_LOCKINGMODE_EXCLUSIVE
 ){

96082 
zRë
 = "exclusive";

96084 
	`sqlôe3VdbeSëNumCﬁs
(
v
, 1);

96085 
	`sqlôe3VdbeSëCﬁName
(
v
, 0, 
COLNAME_NAME
, "lockög_mode", 
SQLITE_STATIC
);

96086 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Såög8
, 0, 1, 0, 
zRë
, 0);

96087 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Resu…Row
, 1, 1);

96096 
PøgTyp_JOURNAL_MODE
: {

96097 
eMode
;

96098 
ii
;

96100 
	`sqlôe3VdbeSëNumCﬁs
(
v
, 1);

96101 
	`sqlôe3VdbeSëCﬁName
(
v
, 0, 
COLNAME_NAME
, "jou∫Æ_mode", 
SQLITE_STATIC
);

96103 if–
zRight
==0 ){

96106 
eMode
 = 
PAGER_JOURNALMODE_QUERY
;

96108 c⁄° *
zMode
;

96109 
n
 = 
	`sqlôe3SåÀn30
(
zRight
);

96110 
eMode
=0; (
zMode
 = 
	`sqlôe3Jou∫ÆModíame
(eMode))!=0;ÉMode++){

96111 if–
	`sqlôe3SåNICmp
(
zRight
, 
zMode
, 
n
)==0 ) ;

96113 if–!
zMode
 ){

96116 
eMode
 = 
PAGER_JOURNALMODE_QUERY
;

96119 if–
eMode
==
PAGER_JOURNALMODE_QUERY
 && 
pId2
->
n
==0 ){

96121 
iDb
 = 0;

96122 
pId2
->
n
 = 1;

96124 
ii
=
db
->
nDb
-1; ii>=0; ii--){

96125 if–
db
->
aDb
[
ii
].
pBt
 && (ii==
iDb
 || 
pId2
->
n
==0) ){

96126 
	`sqlôe3VdbeU£sBåì
(
v
, 
ii
);

96127 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Jou∫ÆMode
, 
ii
, 1, 
eMode
);

96130 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Resu…Row
, 1, 1);

96140 
PøgTyp_JOURNAL_SIZE_LIMIT
: {

96141 
Pagî
 *
pPagî
 = 
	`sqlôe3BåìPagî
(
pDb
->
pBt
);

96142 
i64
 
iLimô
 = -2;

96143 if–
zRight
 ){

96144 
	`sqlôe3Atoi64
(
zRight
, &
iLimô
, 
	`sqlôe3SåÀn30
(zRight), 
SQLITE_UTF8
);

96145 if–
iLimô
<-1 ) iLimit = -1;

96147 
iLimô
 = 
	`sqlôe3PagîJou∫ÆSizeLimô
(
pPagî
, iLimit);

96148 
	`ªtu∫SögÀI¡
(
pP¨£
, "jou∫Æ_size_limô", 
iLimô
);

96161 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


96162 
PøgTyp_AUTO_VACUUM
: {

96163 
Båì
 *
pBt
 = 
pDb
->pBt;

96164 
	`as£π
–
pBt
!=0 );

96165 if–!
zRight
 ){

96166 
	`ªtu∫SögÀI¡
(
pP¨£
, "auto_vacuum", 
	`sqlôe3BåìGëAutoVacuum
(
pBt
));

96168 
eAuto
 = 
	`gëAutoVacuum
(
zRight
);

96169 
	`as£π
–
eAuto
>=0 &&ÉAuto<=2 );

96170 
db
->
√xtAutovac
 = (
u8
)
eAuto
;

96176 
rc
 = 
	`sqlôe3BåìSëAutoVacuum
(
pBt
, 
eAuto
);

96177 if–
rc
==
SQLITE_OK
 && (
eAuto
==1 ||ÉAuto==2) ){

96183 c⁄° 
VdbeOpLi°
 
£tMëa6
[] = {

96184 { 
OP_Tønß˘i⁄
, 0, 1, 0},

96185 { 
OP_RódCookõ
, 0, 1, 
BTREE_LARGEST_ROOT_PAGE
},

96186 { 
OP_If
, 1, 0, 0},

96187 { 
OP_HÆt
, 
SQLITE_OK
, 
OE_Ab‹t
, 0},

96188 { 
OP_I¡egî
, 0, 1, 0},

96189 { 
OP_SëCookõ
, 0, 
BTREE_INCR_VACUUM
, 1},

96191 
iAddr
;

96192 
iAddr
 = 
	`sqlôe3VdbeAddOpLi°
(
v
, 
	`AºaySize
(
£tMëa6
), setMeta6);

96193 
	`sqlôe3VdbeCh™geP1
(
v
, 
iAddr
, 
iDb
);

96194 
	`sqlôe3VdbeCh™geP1
(
v
, 
iAddr
+1, 
iDb
);

96195 
	`sqlôe3VdbeCh™geP2
(
v
, 
iAddr
+2, iAddr+4);

96196 
	`sqlôe3VdbeCh™geP1
(
v
, 
iAddr
+4, 
eAuto
-1);

96197 
	`sqlôe3VdbeCh™geP1
(
v
, 
iAddr
+5, 
iDb
);

96198 
	`sqlôe3VdbeU£sBåì
(
v
, 
iDb
);

96210 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


96211 
PøgTyp_INCREMENTAL_VACUUM
: {

96212 
iLimô
, 
addr
;

96213 if–
zRight
==0 || !
	`sqlôe3GëI¡32
(zRight, &
iLimô
) || iLimit<=0 ){

96214 
iLimô
 = 0x7fffffff;

96216 
	`sqlôe3BegöWrôeO≥øti⁄
(
pP¨£
, 0, 
iDb
);

96217 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 
iLimô
, 1);

96218 
addr
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_In¸Vacuum
, 
iDb
);

96219 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Resu…Row
, 1);

96220 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_AddImm
, 1, -1);

96221 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_IfPos
, 1, 
addr
);

96222 
	`sqlôe3VdbeJumpHîe
(
v
, 
addr
);

96227 #i‚de‡
SQLITE_OMIT_PAGER_PRAGMAS


96239 
PøgTyp_CACHE_SIZE
: {

96240 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 
iDb
, 0) );

96241 if–!
zRight
 ){

96242 
	`ªtu∫SögÀI¡
(
pP¨£
, "ˇche_size", 
pDb
->
pSchema
->
ˇche_size
);

96244 
size
 = 
	`sqlôe3Atoi
(
zRight
);

96245 
pDb
->
pSchema
->
ˇche_size
 = 
size
;

96246 
	`sqlôe3BåìSëCacheSize
(
pDb
->
pBt
,ÖDb->
pSchema
->
ˇche_size
);

96265 
PøgTyp_MMAP_SIZE
: {

96266 
sqlôe3_öt64
 
sz
;

96267 #i‡
SQLITE_MAX_MMAP_SIZE
>0

96268 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 
iDb
, 0) );

96269 if–
zRight
 ){

96270 
ii
;

96271 
	`sqlôe3Atoi64
(
zRight
, &
sz
, 
	`sqlôe3SåÀn30
(zRight), 
SQLITE_UTF8
);

96272 if–
sz
<0 ) sz = 
sqlôe3GlobÆC⁄fig
.
szMm≠
;

96273 if–
pId2
->
n
==0 ) 
db
->
szMm≠
 = 
sz
;

96274 
ii
=
db
->
nDb
-1; ii>=0; ii--){

96275 if–
db
->
aDb
[
ii
].
pBt
 && (ii==
iDb
 || 
pId2
->
n
==0) ){

96276 
	`sqlôe3BåìSëMm≠Limô
(
db
->
aDb
[
ii
].
pBt
, 
sz
);

96280 
sz
 = -1;

96281 
rc
 = 
	`sqlôe3_fûe_c⁄åﬁ
(
db
, 
zDb
, 
SQLITE_FCNTL_MMAP_SIZE
, &
sz
);

96283 
sz
 = 0;

96284 
rc
 = 
SQLITE_OK
;

96286 if–
rc
==
SQLITE_OK
 ){

96287 
	`ªtu∫SögÀI¡
(
pP¨£
, "mm≠_size", 
sz
);

96288 }if–
rc
!=
SQLITE_NOTFOUND
 ){

96289 
pP¨£
->
nEº
++;

96290 
pP¨£
->
rc
 =Ñc;

96306 
PøgTyp_TEMP_STORE
: {

96307 if–!
zRight
 ){

96308 
	`ªtu∫SögÀI¡
(
pP¨£
, "ãmp_°‹e", 
db
->
ãmp_°‹e
);

96310 
	`ch™geTempSt‹age
(
pP¨£
, 
zRight
);

96325 
PøgTyp_TEMP_STORE_DIRECTORY
: {

96326 if–!
zRight
 ){

96327 if–
sqlôe3_ãmp_dúe˘‹y
 ){

96328 
	`sqlôe3VdbeSëNumCﬁs
(
v
, 1);

96329 
	`sqlôe3VdbeSëCﬁName
(
v
, 0, 
COLNAME_NAME
,

96330 "ãmp_°‹e_dúe˘‹y", 
SQLITE_STATIC
);

96331 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Såög8
, 0, 1, 0, 
sqlôe3_ãmp_dúe˘‹y
, 0);

96332 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Resu…Row
, 1, 1);

96335 #i‚de‡
SQLITE_OMIT_WSD


96336 if–
zRight
[0] ){

96337 
ªs
;

96338 
rc
 = 
	`sqlôe3OsAc˚ss
(
db
->
pVfs
, 
zRight
, 
SQLITE_ACCESS_READWRITE
, &
ªs
);

96339 if–
rc
!=
SQLITE_OK
 || 
ªs
==0 ){

96340 
	`sqlôe3Eº‹Msg
(
pP¨£
, "notá writable directory");

96341 
¥agma_out
;

96344 if–
SQLITE_TEMP_STORE
==0

96345 || (
SQLITE_TEMP_STORE
==1 && 
db
->
ãmp_°‹e
<=1)

96346 || (
SQLITE_TEMP_STORE
==2 && 
db
->
ãmp_°‹e
==1)

96348 
	`övÆid©eTempSt‹age
(
pP¨£
);

96350 
	`sqlôe3_‰ì
(
sqlôe3_ãmp_dúe˘‹y
);

96351 if–
zRight
[0] ){

96352 
sqlôe3_ãmp_dúe˘‹y
 = 
	`sqlôe3_m¥ötf
("%s", 
zRight
);

96354 
sqlôe3_ãmp_dúe˘‹y
 = 0;

96361 #i‡
SQLITE_OS_WIN


96375 
PøgTyp_DATA_STORE_DIRECTORY
: {

96376 if–!
zRight
 ){

96377 if–
sqlôe3_d©a_dúe˘‹y
 ){

96378 
	`sqlôe3VdbeSëNumCﬁs
(
v
, 1);

96379 
	`sqlôe3VdbeSëCﬁName
(
v
, 0, 
COLNAME_NAME
,

96380 "d©a_°‹e_dúe˘‹y", 
SQLITE_STATIC
);

96381 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Såög8
, 0, 1, 0, 
sqlôe3_d©a_dúe˘‹y
, 0);

96382 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Resu…Row
, 1, 1);

96385 #i‚de‡
SQLITE_OMIT_WSD


96386 if–
zRight
[0] ){

96387 
ªs
;

96388 
rc
 = 
	`sqlôe3OsAc˚ss
(
db
->
pVfs
, 
zRight
, 
SQLITE_ACCESS_READWRITE
, &
ªs
);

96389 if–
rc
!=
SQLITE_OK
 || 
ªs
==0 ){

96390 
	`sqlôe3Eº‹Msg
(
pP¨£
, "notá writable directory");

96391 
¥agma_out
;

96394 
	`sqlôe3_‰ì
(
sqlôe3_d©a_dúe˘‹y
);

96395 if–
zRight
[0] ){

96396 
sqlôe3_d©a_dúe˘‹y
 = 
	`sqlôe3_m¥ötf
("%s", 
zRight
);

96398 
sqlôe3_d©a_dúe˘‹y
 = 0;

96406 #i‡
SQLITE_ENABLE_LOCKING_STYLE


96415 
PøgTyp_LOCK_PROXY_FILE
: {

96416 if–!
zRight
 ){

96417 
Pagî
 *
pPagî
 = 
	`sqlôe3BåìPagî
(
pDb
->
pBt
);

96418 *
¥oxy_fûe_∑th
 = 
NULL
;

96419 
sqlôe3_fûe
 *
pFûe
 = 
	`sqlôe3PagîFûe
(
pPagî
);

96420 
	`sqlôe3OsFûeC⁄åﬁHöt
(
pFûe
, 
SQLITE_GET_LOCKPROXYFILE
,

96421 &
¥oxy_fûe_∑th
);

96423 if–
¥oxy_fûe_∑th
 ){

96424 
	`sqlôe3VdbeSëNumCﬁs
(
v
, 1);

96425 
	`sqlôe3VdbeSëCﬁName
(
v
, 0, 
COLNAME_NAME
,

96426 "lock_¥oxy_fûe", 
SQLITE_STATIC
);

96427 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Såög8
, 0, 1, 0, 
¥oxy_fûe_∑th
, 0);

96428 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Resu…Row
, 1, 1);

96431 
Pagî
 *
pPagî
 = 
	`sqlôe3BåìPagî
(
pDb
->
pBt
);

96432 
sqlôe3_fûe
 *
pFûe
 = 
	`sqlôe3PagîFûe
(
pPagî
);

96433 
ªs
;

96434 if–
zRight
[0] ){

96435 
ªs
=
	`sqlôe3OsFûeC⁄åﬁ
(
pFûe
, 
SQLITE_SET_LOCKPROXYFILE
,

96436 
zRight
);

96438 
ªs
=
	`sqlôe3OsFûeC⁄åﬁ
(
pFûe
, 
SQLITE_SET_LOCKPROXYFILE
,

96439 
NULL
);

96441 if–
ªs
!=
SQLITE_OK
 ){

96442 
	`sqlôe3Eº‹Msg
(
pP¨£
, "failedÅo setÜockÖroxy file");

96443 
¥agma_out
;

96459 
PøgTyp_SYNCHRONOUS
: {

96460 if–!
zRight
 ){

96461 
	`ªtu∫SögÀI¡
(
pP¨£
, "synchr⁄ous", 
pDb
->
ß„ty_Àvñ
-1);

96463 if–!
db
->
autoCommô
 ){

96464 
	`sqlôe3Eº‹Msg
(
pP¨£
,

96467 
pDb
->
ß„ty_Àvñ
 = 
	`gëSa„tyLevñ
(
zRight
,0,1)+1;

96468 
	`£tAŒPagîFœgs
(
db
);

96475 #i‚de‡
SQLITE_OMIT_FLAG_PRAGMAS


96476 
PøgTyp_FLAG
: {

96477 if–
zRight
==0 ){

96478 
	`ªtu∫SögÀI¡
(
pP¨£
, 
aPøgmaNames
[
mid
].
zName
,

96479 (
db
->
Êags
 & 
aPøgmaNames
[
mid
].
iArg
)!=0 );

96481 
mask
 = 
aPøgmaNames
[
mid
].
iArg
;

96482 if–
db
->
autoCommô
==0 ){

96485 
mask
 &~(
SQLITE_F‹eignKeys
);

96488 if–
	`sqlôe3GëBoﬁón
(
zRight
, 0) ){

96489 
db
->
Êags
 |
mask
;

96491 
db
->
Êags
 &~
mask
;

96492 if–
mask
==
SQLITE_De„rFKs
 ) 
db
->
nDe„ºedImmC⁄s
 = 0;

96499 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Expúe
, 0, 0);

96500 
	`£tAŒPagîFœgs
(
db
);

96506 #i‚de‡
SQLITE_OMIT_SCHEMA_PRAGMAS


96519 
PøgTyp_TABLE_INFO
: if–
zRight
 ){

96520 
TabÀ
 *
pTab
;

96521 
pTab
 = 
	`sqlôe3FödTabÀ
(
db
, 
zRight
, 
zDb
);

96522 if–
pTab
 ){

96523 
i
, 
k
;

96524 
nHiddí
 = 0;

96525 
Cﬁumn
 *
pCﬁ
;

96526 
Index
 *
pPk
;

96527 
pPk
=
pTab
->
pIndex
;ÖPk &&ÖPk->
autoIndex
!=2;ÖPkıPk->
pNext
){}

96528 
	`sqlôe3VdbeSëNumCﬁs
(
v
, 6);

96529 
pP¨£
->
nMem
 = 6;

96530 
	`sqlôe3CodeVîifySchema
(
pP¨£
, 
iDb
);

96531 
	`sqlôe3VdbeSëCﬁName
(
v
, 0, 
COLNAME_NAME
, "cid", 
SQLITE_STATIC
);

96532 
	`sqlôe3VdbeSëCﬁName
(
v
, 1, 
COLNAME_NAME
, "«me", 
SQLITE_STATIC
);

96533 
	`sqlôe3VdbeSëCﬁName
(
v
, 2, 
COLNAME_NAME
, "ty≥", 
SQLITE_STATIC
);

96534 
	`sqlôe3VdbeSëCﬁName
(
v
, 3, 
COLNAME_NAME
, "nŸnuŒ", 
SQLITE_STATIC
);

96535 
	`sqlôe3VdbeSëCﬁName
(
v
, 4, 
COLNAME_NAME
, "dÊt_vÆue", 
SQLITE_STATIC
);

96536 
	`sqlôe3VdbeSëCﬁName
(
v
, 5, 
COLNAME_NAME
, "pk", 
SQLITE_STATIC
);

96537 
	`sqlôe3VõwGëCﬁumnNames
(
pP¨£
, 
pTab
);

96538 
i
=0, 
pCﬁ
=
pTab
->
aCﬁ
; i<pTab->
nCﬁ
; i++,ÖCol++){

96539 if–
	`IsHiddíCﬁumn
(
pCﬁ
) ){

96540 
nHiddí
++;

96543 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 
i
-
nHiddí
, 1);

96544 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Såög8
, 0, 2, 0, 
pCﬁ
->
zName
, 0);

96545 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Såög8
, 0, 3, 0,

96546 
pCﬁ
->
zTy≥
 ?ÖCol->zType : "", 0);

96547 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, (
pCﬁ
->
nŸNuŒ
 ? 1 : 0), 4);

96548 if–
pCﬁ
->
zDÊt
 ){

96549 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Såög8
, 0, 5, 0, (*)
pCﬁ
->
zDÊt
, 0);

96551 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NuŒ
, 0, 5);

96553 if–(
pCﬁ
->
cﬁFœgs
 & 
COLFLAG_PRIMKEY
)==0 ){

96554 
k
 = 0;

96555 }if–
pPk
==0 ){

96556 
k
 = 1;

96558 
k
=1; 
	`ALWAYS
(k<=
pTab
->
nCﬁ
Ë&& 
pPk
->
aiCﬁumn
[k-1]!=
i
; k++){}

96560 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 
k
, 6);

96561 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Resu…Row
, 1, 6);

96567 
PøgTyp_STATS
: {

96568 
Index
 *
pIdx
;

96569 
HashEÀm
 *
i
;

96570 
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

96571 
	`sqlôe3VdbeSëNumCﬁs
(
v
, 4);

96572 
pP¨£
->
nMem
 = 4;

96573 
	`sqlôe3CodeVîifySchema
(
pP¨£
, 
iDb
);

96574 
	`sqlôe3VdbeSëCﬁName
(
v
, 0, 
COLNAME_NAME
, "èbÀ", 
SQLITE_STATIC
);

96575 
	`sqlôe3VdbeSëCﬁName
(
v
, 1, 
COLNAME_NAME
, "ödex", 
SQLITE_STATIC
);

96576 
	`sqlôe3VdbeSëCﬁName
(
v
, 2, 
COLNAME_NAME
, "width", 
SQLITE_STATIC
);

96577 
	`sqlôe3VdbeSëCﬁName
(
v
, 3, 
COLNAME_NAME
, "height", 
SQLITE_STATIC
);

96578 
i
=
	`sqlôeHashFú°
(&
pDb
->
pSchema
->
tblHash
); i; i=
	`sqlôeHashNext
(i)){

96579 
TabÀ
 *
pTab
 = 
	`sqlôeHashD©a
(
i
);

96580 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Såög8
, 0, 1, 0, 
pTab
->
zName
, 0);

96581 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NuŒ
, 0, 2);

96582 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
,

96583 ()
	`sqlôe3LogE°ToI¡
(
pTab
->
szTabRow
), 3);

96584 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, ()
pTab
->
nRowE°
, 4);

96585 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Resu…Row
, 1, 4);

96586 
pIdx
=
pTab
->
pIndex
;ÖIdx;ÖIdxıIdx->
pNext
){

96587 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Såög8
, 0, 2, 0, 
pIdx
->
zName
, 0);

96588 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
,

96589 ()
	`sqlôe3LogE°ToI¡
(
pIdx
->
szIdxRow
), 3);

96590 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, ()
pIdx
->
aiRowE°
[0], 4);

96591 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Resu…Row
, 1, 4);

96597 
PøgTyp_INDEX_INFO
: if–
zRight
 ){

96598 
Index
 *
pIdx
;

96599 
TabÀ
 *
pTab
;

96600 
pIdx
 = 
	`sqlôe3FödIndex
(
db
, 
zRight
, 
zDb
);

96601 if–
pIdx
 ){

96602 
i
;

96603 
pTab
 = 
pIdx
->
pTabÀ
;

96604 
	`sqlôe3VdbeSëNumCﬁs
(
v
, 3);

96605 
pP¨£
->
nMem
 = 3;

96606 
	`sqlôe3CodeVîifySchema
(
pP¨£
, 
iDb
);

96607 
	`sqlôe3VdbeSëCﬁName
(
v
, 0, 
COLNAME_NAME
, "£qno", 
SQLITE_STATIC
);

96608 
	`sqlôe3VdbeSëCﬁName
(
v
, 1, 
COLNAME_NAME
, "cid", 
SQLITE_STATIC
);

96609 
	`sqlôe3VdbeSëCﬁName
(
v
, 2, 
COLNAME_NAME
, "«me", 
SQLITE_STATIC
);

96610 
i
=0; i<
pIdx
->
nCﬁumn
; i++){

96611 
˙um
 = 
pIdx
->
aiCﬁumn
[
i
];

96612 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 
i
, 1);

96613 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 
˙um
, 2);

96614 
	`as£π
–
pTab
->
nCﬁ
>
˙um
 );

96615 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Såög8
, 0, 3, 0, 
pTab
->
aCﬁ
[
˙um
].
zName
, 0);

96616 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Resu…Row
, 1, 3);

96622 
PøgTyp_INDEX_LIST
: if–
zRight
 ){

96623 
Index
 *
pIdx
;

96624 
TabÀ
 *
pTab
;

96625 
i
;

96626 
pTab
 = 
	`sqlôe3FödTabÀ
(
db
, 
zRight
, 
zDb
);

96627 if–
pTab
 ){

96628 
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

96629 
	`sqlôe3VdbeSëNumCﬁs
(
v
, 3);

96630 
pP¨£
->
nMem
 = 3;

96631 
	`sqlôe3CodeVîifySchema
(
pP¨£
, 
iDb
);

96632 
	`sqlôe3VdbeSëCﬁName
(
v
, 0, 
COLNAME_NAME
, "£q", 
SQLITE_STATIC
);

96633 
	`sqlôe3VdbeSëCﬁName
(
v
, 1, 
COLNAME_NAME
, "«me", 
SQLITE_STATIC
);

96634 
	`sqlôe3VdbeSëCﬁName
(
v
, 2, 
COLNAME_NAME
, "unique", 
SQLITE_STATIC
);

96635 
pIdx
=
pTab
->
pIndex
, 
i
=0;ÖIdx;ÖIdxıIdx->
pNext
, i++){

96636 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 
i
, 1);

96637 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Såög8
, 0, 2, 0, 
pIdx
->
zName
, 0);

96638 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 
pIdx
->
⁄Eº‹
!=
OE_N⁄e
, 3);

96639 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Resu…Row
, 1, 3);

96645 
PøgTyp_DATABASE_LIST
: {

96646 
i
;

96647 
	`sqlôe3VdbeSëNumCﬁs
(
v
, 3);

96648 
pP¨£
->
nMem
 = 3;

96649 
	`sqlôe3VdbeSëCﬁName
(
v
, 0, 
COLNAME_NAME
, "£q", 
SQLITE_STATIC
);

96650 
	`sqlôe3VdbeSëCﬁName
(
v
, 1, 
COLNAME_NAME
, "«me", 
SQLITE_STATIC
);

96651 
	`sqlôe3VdbeSëCﬁName
(
v
, 2, 
COLNAME_NAME
, "fûe", 
SQLITE_STATIC
);

96652 
i
=0; i<
db
->
nDb
; i++){

96653 if–
db
->
aDb
[
i
].
pBt
==0 ) ;

96654 
	`as£π
–
db
->
aDb
[
i
].
zName
!=0 );

96655 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 
i
, 1);

96656 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Såög8
, 0, 2, 0, 
db
->
aDb
[
i
].
zName
, 0);

96657 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Såög8
, 0, 3, 0,

96658 
	`sqlôe3BåìGëFûíame
(
db
->
aDb
[
i
].
pBt
), 0);

96659 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Resu…Row
, 1, 3);

96664 
PøgTyp_COLLATION_LIST
: {

96665 
i
 = 0;

96666 
HashEÀm
 *
p
;

96667 
	`sqlôe3VdbeSëNumCﬁs
(
v
, 2);

96668 
pP¨£
->
nMem
 = 2;

96669 
	`sqlôe3VdbeSëCﬁName
(
v
, 0, 
COLNAME_NAME
, "£q", 
SQLITE_STATIC
);

96670 
	`sqlôe3VdbeSëCﬁName
(
v
, 1, 
COLNAME_NAME
, "«me", 
SQLITE_STATIC
);

96671 
p
=
	`sqlôeHashFú°
(&
db
->
aCﬁlSeq
);Ö;Ö=
	`sqlôeHashNext
(p)){

96672 
CﬁlSeq
 *
pCﬁl
 = (CﬁlSeq *)
	`sqlôeHashD©a
(
p
);

96673 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 
i
++, 1);

96674 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Såög8
, 0, 2, 0, 
pCﬁl
->
zName
, 0);

96675 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Resu…Row
, 1, 2);

96681 #i‚de‡
SQLITE_OMIT_FOREIGN_KEY


96682 
PøgTyp_FOREIGN_KEY_LIST
: if–
zRight
 ){

96683 
FKey
 *
pFK
;

96684 
TabÀ
 *
pTab
;

96685 
pTab
 = 
	`sqlôe3FödTabÀ
(
db
, 
zRight
, 
zDb
);

96686 if–
pTab
 ){

96687 
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

96688 
pFK
 = 
pTab
->
pFKey
;

96689 if–
pFK
 ){

96690 
i
 = 0;

96691 
	`sqlôe3VdbeSëNumCﬁs
(
v
, 8);

96692 
pP¨£
->
nMem
 = 8;

96693 
	`sqlôe3CodeVîifySchema
(
pP¨£
, 
iDb
);

96694 
	`sqlôe3VdbeSëCﬁName
(
v
, 0, 
COLNAME_NAME
, "id", 
SQLITE_STATIC
);

96695 
	`sqlôe3VdbeSëCﬁName
(
v
, 1, 
COLNAME_NAME
, "£q", 
SQLITE_STATIC
);

96696 
	`sqlôe3VdbeSëCﬁName
(
v
, 2, 
COLNAME_NAME
, "èbÀ", 
SQLITE_STATIC
);

96697 
	`sqlôe3VdbeSëCﬁName
(
v
, 3, 
COLNAME_NAME
, "‰om", 
SQLITE_STATIC
);

96698 
	`sqlôe3VdbeSëCﬁName
(
v
, 4, 
COLNAME_NAME
, "to", 
SQLITE_STATIC
);

96699 
	`sqlôe3VdbeSëCﬁName
(
v
, 5, 
COLNAME_NAME
, "⁄_upd©e", 
SQLITE_STATIC
);

96700 
	`sqlôe3VdbeSëCﬁName
(
v
, 6, 
COLNAME_NAME
, "⁄_dñëe", 
SQLITE_STATIC
);

96701 
	`sqlôe3VdbeSëCﬁName
(
v
, 7, 
COLNAME_NAME
, "m©ch", 
SQLITE_STATIC
);

96702 
pFK
){

96703 
j
;

96704 
j
=0; j<
pFK
->
nCﬁ
; j++){

96705 *
zCﬁ
 = 
pFK
->
aCﬁ
[
j
].zCol;

96706 *
zOnDñëe
 = (*)
	`a˘i⁄Name
(
pFK
->
aA˘i⁄
[0]);

96707 *
zOnUpd©e
 = (*)
	`a˘i⁄Name
(
pFK
->
aA˘i⁄
[1]);

96708 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 
i
, 1);

96709 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 
j
, 2);

96710 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Såög8
, 0, 3, 0, 
pFK
->
zTo
, 0);

96711 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Såög8
, 0, 4, 0,

96712 
pTab
->
aCﬁ
[
pFK
->aCﬁ[
j
].
iFrom
].
zName
, 0);

96713 
	`sqlôe3VdbeAddOp4
(
v
, 
zCﬁ
 ? 
OP_Såög8
 : 
OP_NuŒ
, 0, 5, 0, zCol, 0);

96714 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Såög8
, 0, 6, 0, 
zOnUpd©e
, 0);

96715 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Såög8
, 0, 7, 0, 
zOnDñëe
, 0);

96716 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Såög8
, 0, 8, 0, "NONE", 0);

96717 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Resu…Row
, 1, 8);

96719 ++
i
;

96720 
pFK
 =ÖFK->
pNextFrom
;

96728 #i‚de‡
SQLITE_OMIT_FOREIGN_KEY


96729 #i‚de‡
SQLITE_OMIT_TRIGGER


96730 
PøgTyp_FOREIGN_KEY_CHECK
: {

96731 
FKey
 *
pFK
;

96732 
TabÀ
 *
pTab
;

96733 
TabÀ
 *
pP¨ít
;

96734 
Index
 *
pIdx
;

96735 
i
;

96736 
j
;

96737 
HashEÀm
 *
k
;

96738 
x
;

96739 
ªgResu…
;

96740 
ªgKey
;

96741 
ªgRow
;

96742 
addrT›
;

96743 
addrOk
;

96744 *
aiCﬁs
;

96746 
ªgResu…
 = 
pP¨£
->
nMem
+1;

96747 
pP¨£
->
nMem
 += 4;

96748 
ªgKey
 = ++
pP¨£
->
nMem
;

96749 
ªgRow
 = ++
pP¨£
->
nMem
;

96750 
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

96751 
	`sqlôe3VdbeSëNumCﬁs
(
v
, 4);

96752 
	`sqlôe3VdbeSëCﬁName
(
v
, 0, 
COLNAME_NAME
, "èbÀ", 
SQLITE_STATIC
);

96753 
	`sqlôe3VdbeSëCﬁName
(
v
, 1, 
COLNAME_NAME
, "rowid", 
SQLITE_STATIC
);

96754 
	`sqlôe3VdbeSëCﬁName
(
v
, 2, 
COLNAME_NAME
, "∑ª¡", 
SQLITE_STATIC
);

96755 
	`sqlôe3VdbeSëCﬁName
(
v
, 3, 
COLNAME_NAME
, "fkid", 
SQLITE_STATIC
);

96756 
	`sqlôe3CodeVîifySchema
(
pP¨£
, 
iDb
);

96757 
k
 = 
	`sqlôeHashFú°
(&
db
->
aDb
[
iDb
].
pSchema
->
tblHash
);

96758  
k
 ){

96759 if–
zRight
 ){

96760 
pTab
 = 
	`sqlôe3LoˇãTabÀ
(
pP¨£
, 0, 
zRight
, 
zDb
);

96761 
k
 = 0;

96763 
pTab
 = (
TabÀ
*)
	`sqlôeHashD©a
(
k
);

96764 
k
 = 
	`sqlôeHashNext
(k);

96766 if–
pTab
==0 ||ÖTab->
pFKey
==0 ) ;

96767 
	`sqlôe3TabÀLock
(
pP¨£
, 
iDb
, 
pTab
->
äum
, 0,ÖTab->
zName
);

96768 if–
pTab
->
nCﬁ
+
ªgRow
>
pP¨£
->
nMem
 )ÖParse->nMem =ÖTab->nCol +ÑegRow;

96769 
	`sqlôe3O≥nTabÀ
(
pP¨£
, 0, 
iDb
, 
pTab
, 
OP_O≥nRód
);

96770 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Såög8
, 0, 
ªgResu…
, 0, 
pTab
->
zName
,

96771 
P4_TRANSIENT
);

96772 
i
=1, 
pFK
=
pTab
->
pFKey
;ÖFK; i++,ÖFKıFK->
pNextFrom
){

96773 
pP¨ít
 = 
	`sqlôe3FödTabÀ
(
db
, 
pFK
->
zTo
, 
zDb
);

96774 if–
pP¨ít
==0 ) ;

96775 
pIdx
 = 0;

96776 
	`sqlôe3TabÀLock
(
pP¨£
, 
iDb
, 
pP¨ít
->
äum
, 0,ÖP¨ít->
zName
);

96777 
x
 = 
	`sqlôe3FkLoˇãIndex
(
pP¨£
, 
pP¨ít
, 
pFK
, &
pIdx
, 0);

96778 if–
x
==0 ){

96779 if–
pIdx
==0 ){

96780 
	`sqlôe3O≥nTabÀ
(
pP¨£
, 
i
, 
iDb
, 
pP¨ít
, 
OP_O≥nRód
);

96782 
KeyInfo
 *
pKey
 = 
	`sqlôe3IndexKeyöfo
(
pP¨£
, 
pIdx
);

96783 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_O≥nRód
, 
i
, 
pIdx
->
äum
, 
iDb
);

96784 
	`sqlôe3VdbeCh™geP4
(
v
, -1, (*)
pKey
, 
P4_KEYINFO_HANDOFF
);

96787 
k
 = 0;

96791 
	`as£π
–
pP¨£
->
nEº
>0 || 
pFK
==0 );

96792 if–
pFK
 ) ;

96793 if–
pP¨£
->
nTab
<
i
 )ÖParse->nTab = i;

96794 
addrT›
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Rewöd
, 0);

96795 
i
=1, 
pFK
=
pTab
->
pFKey
;ÖFK; i++,ÖFKıFK->
pNextFrom
){

96796 
pP¨ít
 = 
	`sqlôe3FödTabÀ
(
db
, 
pFK
->
zTo
, 
zDb
);

96797 
pIdx
 = 0;

96798 
aiCﬁs
 = 0;

96799 if–
pP¨ít
 ){

96800 
x
 = 
	`sqlôe3FkLoˇãIndex
(
pP¨£
, 
pP¨ít
, 
pFK
, &
pIdx
, &
aiCﬁs
);

96801 
	`as£π
–
x
==0 );

96803 
addrOk
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

96804 if–
pP¨ít
 && 
pIdx
==0 ){

96805 
iKey
 = 
pFK
->
aCﬁ
[0].
iFrom
;

96806 
	`as£π
–
iKey
>=0 && iKey<
pTab
->
nCﬁ
 );

96807 if–
iKey
!=
pTab
->
iPKey
 ){

96808 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Cﬁumn
, 0, 
iKey
, 
ªgRow
);

96809 
	`sqlôe3CﬁumnDeÁu…
(
v
, 
pTab
, 
iKey
, 
ªgRow
);

96810 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_IsNuŒ
, 
ªgRow
, 
addrOk
);

96811 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Mu°BeI¡
, 
ªgRow
,

96812 
	`sqlôe3VdbeCuºítAddr
(
v
)+3);

96814 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Rowid
, 0, 
ªgRow
);

96816 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_NŸExi°s
, 
i
, 0, 
ªgRow
);

96817 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_GŸo
, 0, 
addrOk
);

96818 
	`sqlôe3VdbeJumpHîe
(
v
, 
	`sqlôe3VdbeCuºítAddr
(v)-2);

96820 
j
=0; j<
pFK
->
nCﬁ
; j++){

96821 
	`sqlôe3Ex¥CodeGëCﬁumnOfTabÀ
(
v
, 
pTab
, 0,

96822 
aiCﬁs
 ?áiCﬁs[
j
] : 
pFK
->
aCﬁ
[j].
iFrom
, 
ªgRow
+j);

96823 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_IsNuŒ
, 
ªgRow
+
j
, 
addrOk
);

96825 if–
pP¨ít
 ){

96826 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_MakeRec‹d
, 
ªgRow
, 
pFK
->
nCﬁ
, 
ªgKey
);

96827 
	`sqlôe3VdbeCh™geP4
(
v
, -1,

96828 
	`sqlôe3IndexAfföôySå
(
v
,
pIdx
), 
P4_TRANSIENT
);

96829 
	`sqlôe3VdbeAddOp4I¡
(
v
, 
OP_Found
, 
i
, 
addrOk
, 
ªgKey
, 0);

96832 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Rowid
, 0, 
ªgResu…
+1);

96833 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Såög8
, 0, 
ªgResu…
+2, 0,

96834 
pFK
->
zTo
, 
P4_TRANSIENT
);

96835 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 
i
-1, 
ªgResu…
+3);

96836 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Resu…Row
, 
ªgResu…
, 4);

96837 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
addrOk
);

96838 
	`sqlôe3DbFªe
(
db
, 
aiCﬁs
);

96840 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Next
, 0, 
addrT›
+1);

96841 
	`sqlôe3VdbeJumpHîe
(
v
, 
addrT›
);

96848 #i‚de‡
NDEBUG


96849 
PøgTyp_PARSER_TRACE
: {

96850 if–
zRight
 ){

96851 if–
	`sqlôe3GëBoﬁón
(
zRight
, 0) ){

96852 
	`sqlôe3P¨£rTø˚
(
°dîr
, "parser: ");

96854 
	`sqlôe3P¨£rTø˚
(0, 0);

96864 
PøgTyp_CASE_SENSITIVE_LIKE
: {

96865 if–
zRight
 ){

96866 
	`sqlôe3Regi°îLikeFun˘i⁄s
(
db
, 
	`sqlôe3GëBoﬁón
(
zRight
, 0));

96871 #i‚de‡
SQLITE_INTEGRITY_CHECK_ERROR_MAX


96872 
	#SQLITE_INTEGRITY_CHECK_ERROR_MAX
 100

	)

96875 #i‚de‡
SQLITE_OMIT_INTEGRITY_CHECK


96880 
PøgTyp_INTEGRITY_CHECK
: {

96881 
i
, 
j
, 
addr
, 
mxEº
;

96887 c⁄° 
VdbeOpLi°
 
ídCode
[] = {

96888 { 
OP_AddImm
, 1, 0, 0},

96889 { 
OP_IfNeg
, 1, 0, 0},

96890 { 
OP_Såög8
, 0, 3, 0},

96891 { 
OP_Resu…Row
, 3, 1, 0},

96894 
isQuick
 = (
	`sqlôe3Tﬁowî
(
zLe·
[0])=='q');

96905 
	`as£π
–
iDb
>=0 );

96906 
	`as£π
–
iDb
==0 || 
pId2
->
z
 );

96907 if–
pId2
->
z
==0 ) 
iDb
 = -1;

96910 
pP¨£
->
nMem
 = 6;

96911 
	`sqlôe3VdbeSëNumCﬁs
(
v
, 1);

96912 
	`sqlôe3VdbeSëCﬁName
(
v
, 0, 
COLNAME_NAME
, "öãgrôy_check", 
SQLITE_STATIC
);

96915 
mxEº
 = 
SQLITE_INTEGRITY_CHECK_ERROR_MAX
;

96916 if–
zRight
 ){

96917 
	`sqlôe3GëI¡32
(
zRight
, &
mxEº
);

96918 if–
mxEº
<=0 ){

96919 
mxEº
 = 
SQLITE_INTEGRITY_CHECK_ERROR_MAX
;

96922 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 
mxEº
, 1);

96925 
i
=0; i<
db
->
nDb
; i++){

96926 
HashEÀm
 *
x
;

96927 
Hash
 *
pTbls
;

96928 
˙t
 = 0;

96930 if–
OMIT_TEMPDB
 && 
i
==1 ) ;

96931 if–
iDb
>=0 && 
i
!=iDb ) ;

96933 
	`sqlôe3CodeVîifySchema
(
pP¨£
, 
i
);

96934 
addr
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_IfPos
, 1);

96935 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_HÆt
, 0, 0);

96936 
	`sqlôe3VdbeJumpHîe
(
v
, 
addr
);

96943 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 
i
, 0) );

96944 
pTbls
 = &
db
->
aDb
[
i
].
pSchema
->
tblHash
;

96945 
x
=
	`sqlôeHashFú°
(
pTbls
); x; x=
	`sqlôeHashNext
(x)){

96946 
TabÀ
 *
pTab
 = 
	`sqlôeHashD©a
(
x
);

96947 
Index
 *
pIdx
;

96948 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 
pTab
->
äum
, 2+
˙t
);

96949 
˙t
++;

96950 
pIdx
=
pTab
->
pIndex
;ÖIdx;ÖIdxıIdx->
pNext
){

96951 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 
pIdx
->
äum
, 2+
˙t
);

96952 
˙t
++;

96957 
pP¨£
->
nMem
 = 
	`MAX
–pP¨£->nMem, 
˙t
+7 );

96960 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_I¡egrôyCk
, 2, 
˙t
, 1);

96961 
	`sqlôe3VdbeCh™geP5
(
v
, (
u8
)
i
);

96962 
addr
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_IsNuŒ
, 2);

96963 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Såög8
, 0, 3, 0,

96964 
	`sqlôe3MPrötf
(
db
, "*** i¿d©aba£ %†***\n", db->
aDb
[
i
].
zName
),

96965 
P4_DYNAMIC
);

96966 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Move
, 2, 4);

96967 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_C⁄ˇt
, 4, 3, 2);

96968 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Resu…Row
, 2, 1);

96969 
	`sqlôe3VdbeJumpHîe
(
v
, 
addr
);

96973 
x
=
	`sqlôeHashFú°
(
pTbls
); x && !
isQuick
; x=
	`sqlôeHashNext
(x)){

96974 
TabÀ
 *
pTab
 = 
	`sqlôeHashD©a
(
x
);

96975 
Index
 *
pIdx
;

96976 
lo›T›
;

96978 if–
pTab
->
pIndex
==0 ) ;

96979 
addr
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_IfPos
, 1);

96980 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_HÆt
, 0, 0);

96981 
	`sqlôe3VdbeJumpHîe
(
v
, 
addr
);

96982 
	`sqlôe3Ex¥CacheCÀ¨
(
pP¨£
);

96983 
	`sqlôe3O≥nTabÀAndIndi˚s
(
pP¨£
, 
pTab
, 1, 
OP_O≥nRód
);

96984 
j
=0, 
pIdx
=
pTab
->
pIndex
;ÖIdx;ÖIdxıIdx->
pNext
, j++){

96985 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 0, 7+
j
);

96987 
pP¨£
->
nMem
 = 
	`MAX
’P¨£->nMem, 7+
j
);

96988 
lo›T›
 = 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Rewöd
, 1, 0) + 1;

96989 
j
=0, 
pIdx
=
pTab
->
pIndex
;ÖIdx;ÖIdxıIdx->
pNext
, j++){

96990 
jmp2
, 
jmp3
;

96991 
r1
;

96992 c⁄° 
VdbeOpLi°
 
idxEº
[] = {

96993 { 
OP_AddImm
, 1, -1, 0},

96994 { 
OP_Såög8
, 0, 3, 0},

96995 { 
OP_Rowid
, 1, 4, 0},

96996 { 
OP_Såög8
, 0, 5, 0},

96997 { 
OP_Såög8
, 0, 6, 0},

96998 { 
OP_C⁄ˇt
, 4, 3, 3},

96999 { 
OP_C⁄ˇt
, 5, 3, 3},

97000 { 
OP_C⁄ˇt
, 6, 3, 3},

97001 { 
OP_Resu…Row
, 3, 1, 0},

97002 { 
OP_IfPos
, 1, 0, 0},

97003 { 
OP_HÆt
, 0, 0, 0},

97005 
r1
 = 
	`sqlôe3Gíî©eIndexKey
(
pP¨£
, 
pIdx
, 1, 3, 0, &
jmp3
);

97006 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_AddImm
, 7+
j
, 1);

97007 
jmp2
 = 
	`sqlôe3VdbeAddOp4I¡
(
v
, 
OP_Found
, 
j
+2, 0, 
r1
, 
pIdx
->
nCﬁumn
+1);

97008 
addr
 = 
	`sqlôe3VdbeAddOpLi°
(
v
, 
	`AºaySize
(
idxEº
), idxErr);

97009 
	`sqlôe3VdbeCh™geP4
(
v
, 
addr
+1, "rowid ", 
P4_STATIC
);

97010 
	`sqlôe3VdbeCh™geP4
(
v
, 
addr
+3, " missög from index ", 
P4_STATIC
);

97011 
	`sqlôe3VdbeCh™geP4
(
v
, 
addr
+4, 
pIdx
->
zName
, 
P4_TRANSIENT
);

97012 
	`sqlôe3VdbeJumpHîe
(
v
, 
addr
+9);

97013 
	`sqlôe3VdbeJumpHîe
(
v
, 
jmp2
);

97014 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
jmp3
);

97016 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Next
, 1, 
lo›T›
);

97017 
	`sqlôe3VdbeJumpHîe
(
v
, 
lo›T›
-1);

97018 #i‚de‡
SQLITE_OMIT_BTREECOUNT


97019 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Såög8
, 0, 2, 0,

97020 "wr⁄g # o‡íåõ†ö index ", 
P4_STATIC
);

97021 
j
=0, 
pIdx
=
pTab
->
pIndex
;ÖIdx;ÖIdxıIdx->
pNext
, j++){

97022 
addr
 = 
	`sqlôe3VdbeCuºítAddr
(
v
);

97023 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_IfPos
, 1, 
addr
+2);

97024 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_HÆt
, 0, 0);

97025 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Cou¡
, 
j
+2, 3);

97026 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Eq
, 7+
j
, 
addr
+8, 3);

97027 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_AddImm
, 1, -1);

97028 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Såög8
, 0, 3, 0, 
pIdx
->
zName
, 
P4_TRANSIENT
);

97029 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_C⁄ˇt
, 3, 2, 7);

97030 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Resu…Row
, 7, 1);

97035 
addr
 = 
	`sqlôe3VdbeAddOpLi°
(
v
, 
	`AºaySize
(
ídCode
),ÉndCode);

97036 
	`sqlôe3VdbeCh™geP2
(
v
, 
addr
, -
mxEº
);

97037 
	`sqlôe3VdbeJumpHîe
(
v
, 
addr
+1);

97038 
	`sqlôe3VdbeCh™geP4
(
v
, 
addr
+2, "ok", 
P4_STATIC
);

97043 #i‚de‡
SQLITE_OMIT_UTF16


97066 
PøgTyp_ENCODING
: {

97067 c⁄° 
	sEncName
 {

97068 *
zName
;

97069 
u8
 
íc
;

97070 } 
í˙ames
[] = {

97071 { "UTF8", 
SQLITE_UTF8
 },

97072 { "UTF-8", 
SQLITE_UTF8
 },

97073 { "UTF-16À", 
SQLITE_UTF16LE
 },

97074 { "UTF-16be", 
SQLITE_UTF16BE
 },

97075 { "UTF16À", 
SQLITE_UTF16LE
 },

97076 { "UTF16be", 
SQLITE_UTF16BE
 },

97081 c⁄° 
EncName
 *
pEnc
;

97082 if–!
zRight
 ){

97083 if–
	`sqlôe3RódSchema
(
pP¨£
ËË
¥agma_out
;

97084 
	`sqlôe3VdbeSëNumCﬁs
(
v
, 1);

97085 
	`sqlôe3VdbeSëCﬁName
(
v
, 0, 
COLNAME_NAME
, "ícodög", 
SQLITE_STATIC
);

97086 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Såög8
, 0, 1);

97087 
	`as£π
–
í˙ames
[
SQLITE_UTF8
].
íc
==SQLITE_UTF8 );

97088 
	`as£π
–
í˙ames
[
SQLITE_UTF16LE
].
íc
==SQLITE_UTF16LE );

97089 
	`as£π
–
í˙ames
[
SQLITE_UTF16BE
].
íc
==SQLITE_UTF16BE );

97090 
	`sqlôe3VdbeCh™geP4
(
v
, -1, 
í˙ames
[
	`ENC
(
pP¨£
->
db
)].
zName
, 
P4_STATIC
);

97091 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Resu…Row
, 1, 1);

97099 !(
	`DbHasPr›îty
(
db
, 0, 
DB_SchemaLﬂded
)) ||

97100 
	`DbHasPr›îty
(
db
, 0, 
DB_Em±y
)

97102 
pEnc
=&
í˙ames
[0];ÖEnc->
zName
;ÖEnc++){

97103 if–0==
	`sqlôe3SåICmp
(
zRight
, 
pEnc
->
zName
) ){

97104 
	`ENC
(
pP¨£
->
db
Ë
pEnc
->
íc
 ?ÖEnc->í¯: 
SQLITE_UTF16NATIVE
;

97108 if–!
pEnc
->
zName
 ){

97109 
	`sqlôe3Eº‹Msg
(
pP¨£
, "unsuµ‹ãdÉncodög: %s", 
zRight
);

97117 #i‚de‡
SQLITE_OMIT_SCHEMA_VERSION_PRAGMAS


97148 
PøgTyp_HEADER_VALUE
: {

97149 
iCookõ
;

97150 
	`sqlôe3VdbeU£sBåì
(
v
, 
iDb
);

97151  
zLe·
[0] ){

97153 
iCookõ
 = 
BTREE_APPLICATION_ID
;

97156 
iCookõ
 = 
BTREE_FREE_PAGE_COUNT
;

97159 
iCookõ
 = 
BTREE_SCHEMA_VERSION
;

97162 
iCookõ
 = 
BTREE_USER_VERSION
;

97166 if–
zRight
 && 
iCookõ
!=
BTREE_FREE_PAGE_COUNT
 ){

97168 c⁄° 
VdbeOpLi°
 
£tCookõ
[] = {

97169 { 
OP_Tønß˘i⁄
, 0, 1, 0},

97170 { 
OP_I¡egî
, 0, 1, 0},

97171 { 
OP_SëCookõ
, 0, 0, 1},

97173 
addr
 = 
	`sqlôe3VdbeAddOpLi°
(
v
, 
	`AºaySize
(
£tCookõ
), setCookie);

97174 
	`sqlôe3VdbeCh™geP1
(
v
, 
addr
, 
iDb
);

97175 
	`sqlôe3VdbeCh™geP1
(
v
, 
addr
+1, 
	`sqlôe3Atoi
(
zRight
));

97176 
	`sqlôe3VdbeCh™geP1
(
v
, 
addr
+2, 
iDb
);

97177 
	`sqlôe3VdbeCh™geP2
(
v
, 
addr
+2, 
iCookõ
);

97180 c⁄° 
VdbeOpLi°
 
ªadCookõ
[] = {

97181 { 
OP_Tønß˘i⁄
, 0, 0, 0},

97182 { 
OP_RódCookõ
, 0, 1, 0},

97183 { 
OP_Resu…Row
, 1, 1, 0}

97185 
addr
 = 
	`sqlôe3VdbeAddOpLi°
(
v
, 
	`AºaySize
(
ªadCookõ
),ÑeadCookie);

97186 
	`sqlôe3VdbeCh™geP1
(
v
, 
addr
, 
iDb
);

97187 
	`sqlôe3VdbeCh™geP1
(
v
, 
addr
+1, 
iDb
);

97188 
	`sqlôe3VdbeCh™geP3
(
v
, 
addr
+1, 
iCookõ
);

97189 
	`sqlôe3VdbeSëNumCﬁs
(
v
, 1);

97190 
	`sqlôe3VdbeSëCﬁName
(
v
, 0, 
COLNAME_NAME
, 
zLe·
, 
SQLITE_TRANSIENT
);

97196 #i‚de‡
SQLITE_OMIT_COMPILEOPTION_DIAGS


97203 
PøgTyp_COMPILE_OPTIONS
: {

97204 
i
 = 0;

97205 c⁄° *
zO±
;

97206 
	`sqlôe3VdbeSëNumCﬁs
(
v
, 1);

97207 
pP¨£
->
nMem
 = 1;

97208 
	`sqlôe3VdbeSëCﬁName
(
v
, 0, 
COLNAME_NAME
, "compûe_›ti⁄", 
SQLITE_STATIC
);

97209  (
zO±
 = 
	`sqlôe3_compûe›ti⁄_gë
(
i
++))!=0 ){

97210 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Såög8
, 0, 1, 0, 
zO±
, 0);

97211 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Resu…Row
, 1, 1);

97217 #i‚de‡
SQLITE_OMIT_WAL


97223 
PøgTyp_WAL_CHECKPOINT
: {

97224 
iBt
 = (
pId2
->
z
?
iDb
:
SQLITE_MAX_ATTACHED
);

97225 
eMode
 = 
SQLITE_CHECKPOINT_PASSIVE
;

97226 if–
zRight
 ){

97227 if–
	`sqlôe3SåICmp
(
zRight
, "full")==0 ){

97228 
eMode
 = 
SQLITE_CHECKPOINT_FULL
;

97229 }if–
	`sqlôe3SåICmp
(
zRight
, "restart")==0 ){

97230 
eMode
 = 
SQLITE_CHECKPOINT_RESTART
;

97233 
	`sqlôe3VdbeSëNumCﬁs
(
v
, 3);

97234 
pP¨£
->
nMem
 = 3;

97235 
	`sqlôe3VdbeSëCﬁName
(
v
, 0, 
COLNAME_NAME
, "busy", 
SQLITE_STATIC
);

97236 
	`sqlôe3VdbeSëCﬁName
(
v
, 1, 
COLNAME_NAME
, "log", 
SQLITE_STATIC
);

97237 
	`sqlôe3VdbeSëCﬁName
(
v
, 2, 
COLNAME_NAME
, "checkpoöãd", 
SQLITE_STATIC
);

97239 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Checkpoöt
, 
iBt
, 
eMode
, 1);

97240 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Resu…Row
, 1, 3);

97252 
PøgTyp_WAL_AUTOCHECKPOINT
: {

97253 if–
zRight
 ){

97254 
	`sqlôe3_wÆ_autocheckpoöt
(
db
, 
	`sqlôe3Atoi
(
zRight
));

97256 
	`ªtu∫SögÀI¡
(
pP¨£
, "wal_autocheckpoint",

97257 
db
->
xWÆCÆlback
==
sqlôe3WÆDeÁu…Hook
 ?

97258 
	`SQLITE_PTR_TO_INT
(
db
->
pWÆArg
) : 0);

97269 
PøgTyp_SHRINK_MEMORY
: {

97270 
	`sqlôe3_db_ªÀa£_mem‹y
(
db
);

97284 
	`as£π
–
aPøgmaNames
[
mid
].
ePøgTyp
==
PøgTyp_BUSY_TIMEOUT
 );

97285 if–
zRight
 ){

97286 
	`sqlôe3_busy_timeout
(
db
, 
	`sqlôe3Atoi
(
zRight
));

97288 
	`ªtu∫SögÀI¡
(
pP¨£
, "timeout", 
db
->
busyTimeout
);

97299 
PøgTyp_SOFT_HEAP_LIMIT
: {

97300 
sqlôe3_öt64
 
N
;

97301 if–
zRight
 && 
	`sqlôe3Atoi64
(zRight, &
N
, 1000000, 
SQLITE_UTF8
)==
SQLITE_OK
 ){

97302 
	`sqlôe3_so·_hóp_limô64
(
N
);

97304 
	`ªtu∫SögÀI¡
(
pP¨£
, "so·_hóp_limô", 
	`sqlôe3_so·_hóp_limô64
(-1));

97308 #i‡
	`deföed
(
SQLITE_DEBUG
Ë|| deföed(
SQLITE_TEST
)

97312 
PøgTyp_LOCK_STATUS
: {

97313 c⁄° *c⁄° 
azLockName
[] = {

97316 
i
;

97317 
	`sqlôe3VdbeSëNumCﬁs
(
v
, 2);

97318 
pP¨£
->
nMem
 = 2;

97319 
	`sqlôe3VdbeSëCﬁName
(
v
, 0, 
COLNAME_NAME
, "d©aba£", 
SQLITE_STATIC
);

97320 
	`sqlôe3VdbeSëCﬁName
(
v
, 1, 
COLNAME_NAME
, "°©us", 
SQLITE_STATIC
);

97321 
i
=0; i<
db
->
nDb
; i++){

97322 
Båì
 *
pBt
;

97323 c⁄° *
zSèã
 = "unknown";

97324 
j
;

97325 if–
db
->
aDb
[
i
].
zName
==0 ) ;

97326 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Såög8
, 0, 1, 0, 
db
->
aDb
[
i
].
zName
, 
P4_STATIC
);

97327 
pBt
 = 
db
->
aDb
[
i
].pBt;

97328 if–
pBt
==0 || 
	`sqlôe3BåìPagî
(pBt)==0 ){

97329 
zSèã
 = "closed";

97330 }if–
	`sqlôe3_fûe_c⁄åﬁ
(
db
, 
i
 ? db->
aDb
[i].
zName
 : 0,

97331 
SQLITE_FCNTL_LOCKSTATE
, &
j
)==
SQLITE_OK
 ){

97332 
zSèã
 = 
azLockName
[
j
];

97334 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Såög8
, 0, 2, 0, 
zSèã
, 
P4_STATIC
);

97335 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Resu…Row
, 1, 2);

97341 #ifde‡
SQLITE_HAS_CODEC


97342 
PøgTyp_KEY
: {

97343 if–
zRight
 ) 
	`sqlôe3_key_v2
(
db
, 
zDb
, zRight, 
	`sqlôe3SåÀn30
(zRight));

97346 
PøgTyp_REKEY
: {

97347 if–
zRight
 ) 
	`sqlôe3_ªkey_v2
(
db
, 
zDb
, zRight, 
	`sqlôe3SåÀn30
(zRight));

97350 
PøgTyp_HEXKEY
: {

97351 if–
zRight
 ){

97352 
u8
 
iByã
;

97353 
i
;

97354 
zKey
[40];

97355 
i
=0, 
iByã
=0; i<(
zKey
)*2 && 
	`sqlôe3Isxdigô
(
zRight
[i]); i++){

97356 
iByã
 = (iByã<<4Ë+ 
	`sqlôe3HexToI¡
(
zRight
[
i
]);

97357 if–(
i
&1)!=0 ) 
zKey
[i/2] = 
iByã
;

97359 if–(
zLe·
[3] & 0xf)==0xb ){

97360 
	`sqlôe3_key_v2
(
db
, 
zDb
, 
zKey
, 
i
/2);

97362 
	`sqlôe3_ªkey_v2
(
db
, 
zDb
, 
zKey
, 
i
/2);

97368 #i‡
	`deföed
(
SQLITE_HAS_CODEC
Ë|| deföed(
SQLITE_ENABLE_CEROD
)

97369 
PøgTyp_ACTIVATE_EXTENSIONS
: if–
zRight
 ){

97370 #ifde‡
SQLITE_HAS_CODEC


97371 if–
	`sqlôe3SåNICmp
(
zRight
, "see-", 4)==0 ){

97372 
	`sqlôe3_a˘iv©e_£e
(&
zRight
[4]);

97375 #ifde‡
SQLITE_ENABLE_CEROD


97376 if–
	`sqlôe3SåNICmp
(
zRight
, "cerod-", 6)==0 ){

97377 
	`sqlôe3_a˘iv©e_˚rod
(&
zRight
[6]);

97386 
¥agma_out
:

97387 
	`sqlôe3DbFªe
(
db
, 
zLe·
);

97388 
	`sqlôe3DbFªe
(
db
, 
zRight
);

97415 
	`c‹ru±Schema
(

97416 
InôD©a
 *
pD©a
,

97417 c⁄° *
zObj
,

97418 c⁄° *
zExåa


97420 
sqlôe3
 *
db
 = 
pD©a
->db;

97421 if–!
db
->
mÆlocFaûed
 && (db->
Êags
 & 
SQLITE_RecovîyMode
)==0 ){

97422 if–
zObj
==0 ) zObj = "?";

97423 
	`sqlôe3SëSåög
(
pD©a
->
pzEºMsg
, 
db
,

97424 "mÆf‹med d©aba£ schem®(%s)", 
zObj
);

97425 if–
zExåa
 ){

97426 *
pD©a
->
pzEºMsg
 = 
	`sqlôe3MAµídf
(
db
, *pData->pzErrMsg,

97427 "%†- %s", *
pD©a
->
pzEºMsg
, 
zExåa
);

97430 
pD©a
->
rc
 = 
db
->
mÆlocFaûed
 ? 
SQLITE_NOMEM
 : 
SQLITE_CORRUPT_BKPT
;

97445 
SQLITE_PRIVATE
 
	`sqlôe3InôCÆlback
(*
pInô
, 
¨gc
, **
¨gv
, **
NŸU£d
){

97446 
InôD©a
 *
pD©a
 = (InôD©a*)
pInô
;

97447 
sqlôe3
 *
db
 = 
pD©a
->db;

97448 
iDb
 = 
pD©a
->iDb;

97450 
	`as£π
–
¨gc
==3 );

97451 
	`UNUSED_PARAMETER2
(
NŸU£d
, 
¨gc
);

97452 
	`as£π
–
	`sqlôe3_muãx_hñd
(
db
->
muãx
) );

97453 
	`DbCÀ¨Pr›îty
(
db
, 
iDb
, 
DB_Em±y
);

97454 if–
db
->
mÆlocFaûed
 ){

97455 
	`c‹ru±Schema
(
pD©a
, 
¨gv
[0], 0);

97459 
	`as£π
–
iDb
>=0 && iDb<
db
->
nDb
 );

97460 if–
¨gv
==0 )  0;

97461 if–
¨gv
[1]==0 ){

97462 
	`c‹ru±Schema
(
pD©a
, 
¨gv
[0], 0);

97463 }if–
¨gv
[2] &&árgv[2][0] ){

97469 
rc
;

97470 
sqlôe3_°mt
 *
pStmt
;

97471 
	`TESTONLY
(
r˝
);

97473 
	`as£π
–
db
->
öô
.
busy
 );

97474 
db
->
öô
.
iDb
 = iDb;

97475 
db
->
öô
.
√wTnum
 = 
	`sqlôe3Atoi
(
¨gv
[1]);

97476 
db
->
öô
.
‹ph™Triggî
 = 0;

97477 
	`TESTONLY
(
r˝
 = ) 
	`sqlôe3_¥ï¨e
(
db
, 
¨gv
[2], -1, &
pStmt
, 0);

97478 
rc
 = 
db
->
îrCode
;

97479 
	`as£π
–(
rc
&0xFF)==(
r˝
&0xFF) );

97480 
db
->
öô
.
iDb
 = 0;

97481 if–
SQLITE_OK
!=
rc
 ){

97482 if–
db
->
öô
.
‹ph™Triggî
 ){

97483 
	`as£π
–
iDb
==1 );

97485 
pD©a
->
rc
 =Ñc;

97486 if–
rc
==
SQLITE_NOMEM
 ){

97487 
db
->
mÆlocFaûed
 = 1;

97488 }if–
rc
!=
SQLITE_INTERRUPT
 && (rc&0xFF)!=
SQLITE_LOCKED
 ){

97489 
	`c‹ru±Schema
(
pD©a
, 
¨gv
[0], 
	`sqlôe3_îrmsg
(
db
));

97493 
	`sqlôe3_föÆize
(
pStmt
);

97494 }if–
¨gv
[0]==0 ){

97495 
	`c‹ru±Schema
(
pD©a
, 0, 0);

97503 
Index
 *
pIndex
;

97504 
pIndex
 = 
	`sqlôe3FödIndex
(
db
, 
¨gv
[0], db->
aDb
[
iDb
].
zName
);

97505 if–
pIndex
==0 ){

97512 }if–
	`sqlôe3GëI¡32
(
¨gv
[1], &
pIndex
->
äum
)==0 ){

97513 
	`c‹ru±Schema
(
pD©a
, 
¨gv
[0], "invalidÑootpage");

97527 
	`sqlôe3InôO√
(
sqlôe3
 *
db
, 
iDb
, **
pzEºMsg
){

97528 
rc
;

97529 
i
;

97530 #i‚de‡
SQLITE_OMIT_DEPRECATED


97531 
size
;

97533 
TabÀ
 *
pTab
;

97534 
Db
 *
pDb
;

97535 c⁄° *
azArg
[4];

97536 
mëa
[5];

97537 
InôD©a
 
öôD©a
;

97538 c⁄° *
zMa°îSchema
;

97539 c⁄° *
zMa°îName
;

97540 
›íedTønß˘i⁄
 = 0;

97545 c⁄° 
ma°î_schema
[] =

97554 #i‚de‡
SQLITE_OMIT_TEMPDB


97555 c⁄° 
ãmp_ma°î_schema
[] =

97565 
	#ãmp_ma°î_schema
 0

	)

97568 
	`as£π
–
iDb
>=0 && iDb<
db
->
nDb
 );

97569 
	`as£π
–
db
->
aDb
[
iDb
].
pSchema
 );

97570 
	`as£π
–
	`sqlôe3_muãx_hñd
(
db
->
muãx
) );

97571 
	`as£π
–
iDb
==1 || 
	`sqlôe3BåìHﬁdsMuãx
(
db
->
aDb
[iDb].
pBt
) );

97577 if–!
OMIT_TEMPDB
 && 
iDb
==1 ){

97578 
zMa°îSchema
 = 
ãmp_ma°î_schema
;

97580 
zMa°îSchema
 = 
ma°î_schema
;

97582 
zMa°îName
 = 
	`SCHEMA_TABLE
(
iDb
);

97585 
azArg
[0] = 
zMa°îName
;

97586 
azArg
[1] = "1";

97587 
azArg
[2] = 
zMa°îSchema
;

97588 
azArg
[3] = 0;

97589 
öôD©a
.
db
 = db;

97590 
öôD©a
.
iDb
 = iDb;

97591 
öôD©a
.
rc
 = 
SQLITE_OK
;

97592 
öôD©a
.
pzEºMsg
 =ÖzErrMsg;

97593 
	`sqlôe3InôCÆlback
(&
öôD©a
, 3, (**)
azArg
, 0);

97594 if–
öôD©a
.
rc
 ){

97595 
rc
 = 
öôD©a
.rc;

97596 
îr‹_out
;

97598 
pTab
 = 
	`sqlôe3FödTabÀ
(
db
, 
zMa°îName
, db->
aDb
[
iDb
].
zName
);

97599 if–
	`ALWAYS
(
pTab
) ){

97600 
pTab
->
èbFœgs
 |
TF_Ród⁄ly
;

97605 
pDb
 = &
db
->
aDb
[
iDb
];

97606 if–
pDb
->
pBt
==0 ){

97607 if–!
OMIT_TEMPDB
 && 
	`ALWAYS
(
iDb
==1) ){

97608 
	`DbSëPr›îty
(
db
, 1, 
DB_SchemaLﬂded
);

97610  
SQLITE_OK
;

97616 
	`sqlôe3BåìE¡î
(
pDb
->
pBt
);

97617 if–!
	`sqlôe3BåìIsInRódTøns
(
pDb
->
pBt
) ){

97618 
rc
 = 
	`sqlôe3BåìBegöTøns
(
pDb
->
pBt
, 0);

97619 if–
rc
!=
SQLITE_OK
 ){

97620 
	`sqlôe3SëSåög
(
pzEºMsg
, 
db
, "%s", 
	`sqlôe3EºSå
(
rc
));

97621 
öô⁄e_îr‹_out
;

97623 
›íedTønß˘i⁄
 = 1;

97643 
i
=0; i<
	`AºaySize
(
mëa
); i++){

97644 
	`sqlôe3BåìGëMëa
(
pDb
->
pBt
, 
i
+1, (
u32
 *)&
mëa
[i]);

97646 
pDb
->
pSchema
->
schema_cookõ
 = 
mëa
[
BTREE_SCHEMA_VERSION
-1];

97653 if–
mëa
[
BTREE_TEXT_ENCODING
-1] ){

97654 if–
iDb
==0 ){

97655 #i‚de‡
SQLITE_OMIT_UTF16


97656 
u8
 
ícodög
;

97658 
ícodög
 = (
u8
)
mëa
[
BTREE_TEXT_ENCODING
-1] & 3;

97659 if–
ícodög
==0 )Éncodög = 
SQLITE_UTF8
;

97660 
	`ENC
(
db
Ë
ícodög
;

97662 
	`ENC
(
db
Ë
SQLITE_UTF8
;

97666 if–
mëa
[
BTREE_TEXT_ENCODING
-1]!=
	`ENC
(
db
) ){

97667 
	`sqlôe3SëSåög
(
pzEºMsg
, 
db
, "attached databases must useÅhe same"

97669 
rc
 = 
SQLITE_ERROR
;

97670 
öô⁄e_îr‹_out
;

97674 
	`DbSëPr›îty
(
db
, 
iDb
, 
DB_Em±y
);

97676 
pDb
->
pSchema
->
íc
 = 
	`ENC
(
db
);

97678 if–
pDb
->
pSchema
->
ˇche_size
==0 ){

97679 #i‚de‡
SQLITE_OMIT_DEPRECATED


97680 
size
 = 
	`sqlôe3AbsI¡32
(
mëa
[
BTREE_DEFAULT_CACHE_SIZE
-1]);

97681 if–
size
==0 ){ sizê
SQLITE_DEFAULT_CACHE_SIZE
; }

97682 
pDb
->
pSchema
->
ˇche_size
 = 
size
;

97684 
pDb
->
pSchema
->
ˇche_size
 = 
SQLITE_DEFAULT_CACHE_SIZE
;

97686 
	`sqlôe3BåìSëCacheSize
(
pDb
->
pBt
,ÖDb->
pSchema
->
ˇche_size
);

97695 
pDb
->
pSchema
->
fûe_f‹m©
 = (
u8
)
mëa
[
BTREE_FILE_FORMAT
-1];

97696 if–
pDb
->
pSchema
->
fûe_f‹m©
==0 ){

97697 
pDb
->
pSchema
->
fûe_f‹m©
 = 1;

97699 if–
pDb
->
pSchema
->
fûe_f‹m©
>
SQLITE_MAX_FILE_FORMAT
 ){

97700 
	`sqlôe3SëSåög
(
pzEºMsg
, 
db
, "unsupported file format");

97701 
rc
 = 
SQLITE_ERROR
;

97702 
öô⁄e_îr‹_out
;

97710 if–
iDb
==0 && 
mëa
[
BTREE_FILE_FORMAT
-1]>=4 ){

97711 
db
->
Êags
 &~
SQLITE_LegacyFûeFmt
;

97716 
	`as£π
–
db
->
öô
.
busy
 );

97718 *
zSql
;

97719 
zSql
 = 
	`sqlôe3MPrötf
(
db
,

97721 
db
->
aDb
[
iDb
].
zName
, 
zMa°îName
);

97722 #i‚de‡
SQLITE_OMIT_AUTHORIZATION


97724 (*
xAuth
)(*,,const *,const *,const *,const *);

97725 
xAuth
 = 
db
->xAuth;

97726 
db
->
xAuth
 = 0;

97728 
rc
 = 
	`sqlôe3_exec
(
db
, 
zSql
, 
sqlôe3InôCÆlback
, &
öôD©a
, 0);

97729 #i‚de‡
SQLITE_OMIT_AUTHORIZATION


97730 
db
->
xAuth
 = xAuth;

97733 if–
rc
==
SQLITE_OK
 )Ñ¯
öôD©a
.rc;

97734 
	`sqlôe3DbFªe
(
db
, 
zSql
);

97735 #i‚de‡
SQLITE_OMIT_ANALYZE


97736 if–
rc
==
SQLITE_OK
 ){

97737 
	`sqlôe3A«lysisLﬂd
(
db
, 
iDb
);

97741 if–
db
->
mÆlocFaûed
 ){

97742 
rc
 = 
SQLITE_NOMEM
;

97743 
	`sqlôe3Re£tAŒSchemasOfC⁄√˘i⁄
(
db
);

97745 if–
rc
==
SQLITE_OK
 || (
db
->
Êags
&
SQLITE_RecovîyMode
)){

97754 
	`DbSëPr›îty
(
db
, 
iDb
, 
DB_SchemaLﬂded
);

97755 
rc
 = 
SQLITE_OK
;

97762 
öô⁄e_îr‹_out
:

97763 if–
›íedTønß˘i⁄
 ){

97764 
	`sqlôe3BåìCommô
(
pDb
->
pBt
);

97766 
	`sqlôe3BåìLóve
(
pDb
->
pBt
);

97768 
îr‹_out
:

97769 if–
rc
==
SQLITE_NOMEM
 ||Ñc==
SQLITE_IOERR_NOMEM
 ){

97770 
db
->
mÆlocFaûed
 = 1;

97772  
rc
;

97785 
SQLITE_PRIVATE
 
	`sqlôe3Inô
(
sqlôe3
 *
db
, **
pzEºMsg
){

97786 
i
, 
rc
;

97787 
commô_öã∫Æ
 = !(
db
->
Êags
&
SQLITE_I¡înCh™ges
);

97789 
	`as£π
–
	`sqlôe3_muãx_hñd
(
db
->
muãx
) );

97790 
rc
 = 
SQLITE_OK
;

97791 
db
->
öô
.
busy
 = 1;

97792 
i
=0; 
rc
==
SQLITE_OK
 && i<
db
->
nDb
; i++){

97793 if–
	`DbHasPr›îty
(
db
, 
i
, 
DB_SchemaLﬂded
) || i==1 ) ;

97794 
rc
 = 
	`sqlôe3InôO√
(
db
, 
i
, 
pzEºMsg
);

97795 if–
rc
 ){

97796 
	`sqlôe3Re£tO√Schema
(
db
, 
i
);

97804 #i‚de‡
SQLITE_OMIT_TEMPDB


97805 if–
rc
==
SQLITE_OK
 && 
	`ALWAYS
(
db
->
nDb
>1)

97806 && !
	`DbHasPr›îty
(
db
, 1, 
DB_SchemaLﬂded
) ){

97807 
rc
 = 
	`sqlôe3InôO√
(
db
, 1, 
pzEºMsg
);

97808 if–
rc
 ){

97809 
	`sqlôe3Re£tO√Schema
(
db
, 1);

97814 
db
->
öô
.
busy
 = 0;

97815 if–
rc
==
SQLITE_OK
 && 
commô_öã∫Æ
 ){

97816 
	`sqlôe3CommôI¡î«lCh™ges
(
db
);

97819  
rc
;

97826 
SQLITE_PRIVATE
 
	`sqlôe3RódSchema
(
P¨£
 *
pP¨£
){

97827 
rc
 = 
SQLITE_OK
;

97828 
sqlôe3
 *
db
 = 
pP¨£
->db;

97829 
	`as£π
–
	`sqlôe3_muãx_hñd
(
db
->
muãx
) );

97830 if–!
db
->
öô
.
busy
 ){

97831 
rc
 = 
	`sqlôe3Inô
(
db
, &
pP¨£
->
zEºMsg
);

97833 if–
rc
!=
SQLITE_OK
 ){

97834 
pP¨£
->
rc
 =Ñc;

97835 
pP¨£
->
nEº
++;

97837  
rc
;

97846 
	`schemaIsVÆid
(
P¨£
 *
pP¨£
){

97847 
sqlôe3
 *
db
 = 
pP¨£
->db;

97848 
iDb
;

97849 
rc
;

97850 
cookõ
;

97852 
	`as£π
–
pP¨£
->
checkSchema
 );

97853 
	`as£π
–
	`sqlôe3_muãx_hñd
(
db
->
muãx
) );

97854 
iDb
=0; iDb<
db
->
nDb
; iDb++){

97855 
›íedTønß˘i⁄
 = 0;

97856 
Båì
 *
pBt
 = 
db
->
aDb
[
iDb
].pBt;

97857 if–
pBt
==0 ) ;

97862 if–!
	`sqlôe3BåìIsInRódTøns
(
pBt
) ){

97863 
rc
 = 
	`sqlôe3BåìBegöTøns
(
pBt
, 0);

97864 if–
rc
==
SQLITE_NOMEM
 ||Ñc==
SQLITE_IOERR_NOMEM
 ){

97865 
db
->
mÆlocFaûed
 = 1;

97867 if–
rc
!=
SQLITE_OK
 ) ;

97868 
›íedTønß˘i⁄
 = 1;

97874 
	`sqlôe3BåìGëMëa
(
pBt
, 
BTREE_SCHEMA_VERSION
, (
u32
 *)&
cookõ
);

97875 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 
iDb
, 0) );

97876 if–
cookõ
!=
db
->
aDb
[
iDb
].
pSchema
->
schema_cookõ
 ){

97877 
	`sqlôe3Re£tO√Schema
(
db
, 
iDb
);

97878 
pP¨£
->
rc
 = 
SQLITE_SCHEMA
;

97882 if–
›íedTønß˘i⁄
 ){

97883 
	`sqlôe3BåìCommô
(
pBt
);

97895 
SQLITE_PRIVATE
 
	`sqlôe3SchemaToIndex
(
sqlôe3
 *
db
, 
Schema
 *
pSchema
){

97896 
i
 = -1000000;

97908 
	`as£π
–
	`sqlôe3_muãx_hñd
(
db
->
muãx
) );

97909 if–
pSchema
 ){

97910 
i
=0; 
	`ALWAYS
(i<
db
->
nDb
); i++){

97911 if–
db
->
aDb
[
i
].
pSchema
==pSchema ){

97915 
	`as£π
–
i
>=0 && i<
db
->
nDb
 );

97917  
i
;

97923 
	`sqlôe3Pª∑ª
(

97924 
sqlôe3
 *
db
,

97925 c⁄° *
zSql
,

97926 
nByãs
,

97927 
ßveSqlFœg
,

97928 
Vdbe
 *
pRïª∑ª
,

97929 
sqlôe3_°mt
 **
µStmt
,

97930 c⁄° **
pzTaû


97932 
P¨£
 *
pP¨£
;

97933 *
zEºMsg
 = 0;

97934 
rc
 = 
SQLITE_OK
;

97935 
i
;

97938 
pP¨£
 = 
	`sqlôe3SèckAŒocZîo
(
db
, (*pParse));

97939 if–
pP¨£
==0 ){

97940 
rc
 = 
SQLITE_NOMEM
;

97941 
íd_¥ï¨e
;

97943 
pP¨£
->
pRïª∑ª
 =ÖReprepare;

97944 
	`as£π
–
µStmt
 && *ppStmt==0 );

97945 
	`as£π
–!
db
->
mÆlocFaûed
 );

97946 
	`as£π
–
	`sqlôe3_muãx_hñd
(
db
->
muãx
) );

97971 
i
=0; i<
db
->
nDb
; i++) {

97972 
Båì
 *
pBt
 = 
db
->
aDb
[
i
].pBt;

97973 if–
pBt
 ){

97974 
	`as£π
–
	`sqlôe3BåìHﬁdsMuãx
(
pBt
) );

97975 
rc
 = 
	`sqlôe3BåìSchemaLocked
(
pBt
);

97976 if–
rc
 ){

97977 c⁄° *
zDb
 = 
db
->
aDb
[
i
].
zName
;

97978 
	`sqlôe3Eº‹
(
db
, 
rc
, "d©aba£ schem®i†locked: %s", 
zDb
);

97979 
	`ã°ˇ£
–
db
->
Êags
 & 
SQLITE_RódUncommôãd
 );

97980 
íd_¥ï¨e
;

97985 
	`sqlôe3VèbU∆ockLi°
(
db
);

97987 
pP¨£
->
db
 = db;

97988 
pP¨£
->
nQuîyLo›
 = 0;

97989 if–
nByãs
>=0 && (nByãs==0 || 
zSql
[nBytes-1]!=0) ){

97990 *
zSqlC›y
;

97991 
mxLí
 = 
db
->
aLimô
[
SQLITE_LIMIT_SQL_LENGTH
];

97992 
	`ã°ˇ£
–
nByãs
==
mxLí
 );

97993 
	`ã°ˇ£
–
nByãs
==
mxLí
+1 );

97994 if–
nByãs
>
mxLí
 ){

97995 
	`sqlôe3Eº‹
(
db
, 
SQLITE_TOOBIG
, "statementÅooÜong");

97996 
rc
 = 
	`sqlôe3ApiExô
(
db
, 
SQLITE_TOOBIG
);

97997 
íd_¥ï¨e
;

97999 
zSqlC›y
 = 
	`sqlôe3DbSåNDup
(
db
, 
zSql
, 
nByãs
);

98000 if–
zSqlC›y
 ){

98001 
	`sqlôe3RunP¨£r
(
pP¨£
, 
zSqlC›y
, &
zEºMsg
);

98002 
	`sqlôe3DbFªe
(
db
, 
zSqlC›y
);

98003 
pP¨£
->
zTaû
 = &
zSql
[pP¨£->zTaû-
zSqlC›y
];

98005 
pP¨£
->
zTaû
 = &
zSql
[
nByãs
];

98008 
	`sqlôe3RunP¨£r
(
pP¨£
, 
zSql
, &
zEºMsg
);

98010 
	`as£π
–0==
pP¨£
->
nQuîyLo›
 );

98012 if–
db
->
mÆlocFaûed
 ){

98013 
pP¨£
->
rc
 = 
SQLITE_NOMEM
;

98015 if–
pP¨£
->
rc
==
SQLITE_DONE
 )ÖP¨£->r¯
SQLITE_OK
;

98016 if–
pP¨£
->
checkSchema
 ){

98017 
	`schemaIsVÆid
(
pP¨£
);

98019 if–
db
->
mÆlocFaûed
 ){

98020 
pP¨£
->
rc
 = 
SQLITE_NOMEM
;

98022 if–
pzTaû
 ){

98023 *
pzTaû
 = 
pP¨£
->
zTaû
;

98025 
rc
 = 
pP¨£
->rc;

98027 #i‚de‡
SQLITE_OMIT_EXPLAIN


98028 if–
rc
==
SQLITE_OK
 && 
pP¨£
->
pVdbe
 &&ÖP¨£->
ex∂aö
 ){

98029 c⁄° * c⁄° 
azCﬁName
[] = {

98033 
iFú°
, 
mx
;

98034 if–
pP¨£
->
ex∂aö
==2 ){

98035 
	`sqlôe3VdbeSëNumCﬁs
(
pP¨£
->
pVdbe
, 4);

98036 
iFú°
 = 8;

98037 
mx
 = 12;

98039 
	`sqlôe3VdbeSëNumCﬁs
(
pP¨£
->
pVdbe
, 8);

98040 
iFú°
 = 0;

98041 
mx
 = 8;

98043 
i
=
iFú°
; i<
mx
; i++){

98044 
	`sqlôe3VdbeSëCﬁName
(
pP¨£
->
pVdbe
, 
i
-
iFú°
, 
COLNAME_NAME
,

98045 
azCﬁName
[
i
], 
SQLITE_STATIC
);

98050 if–
db
->
öô
.
busy
==0 ){

98051 
Vdbe
 *
pVdbe
 = 
pP¨£
->pVdbe;

98052 
	`sqlôe3VdbeSëSql
(
pVdbe
, 
zSql
, ()(
pP¨£
->
zTaû
-zSql), 
ßveSqlFœg
);

98054 if–
pP¨£
->
pVdbe
 && (
rc
!=
SQLITE_OK
 || 
db
->
mÆlocFaûed
) ){

98055 
	`sqlôe3VdbeFöÆize
(
pP¨£
->
pVdbe
);

98056 
	`as£π
(!(*
µStmt
));

98058 *
µStmt
 = (
sqlôe3_°mt
*)
pP¨£
->
pVdbe
;

98061 if–
zEºMsg
 ){

98062 
	`sqlôe3Eº‹
(
db
, 
rc
, "%s", 
zEºMsg
);

98063 
	`sqlôe3DbFªe
(
db
, 
zEºMsg
);

98065 
	`sqlôe3Eº‹
(
db
, 
rc
, 0);

98069  
pP¨£
->
pTriggîPrg
 ){

98070 
TriggîPrg
 *
pT
 = 
pP¨£
->
pTriggîPrg
;

98071 
pP¨£
->
pTriggîPrg
 = 
pT
->
pNext
;

98072 
	`sqlôe3DbFªe
(
db
, 
pT
);

98075 
íd_¥ï¨e
:

98077 
	`sqlôe3SèckFªe
(
db
, 
pP¨£
);

98078 
rc
 = 
	`sqlôe3ApiExô
(
db
,Ñc);

98079 
	`as£π
–(
rc
&
db
->
îrMask
)==rc );

98080  
rc
;

98082 
	`sqlôe3LockAndPª∑ª
(

98083 
sqlôe3
 *
db
,

98084 c⁄° *
zSql
,

98085 
nByãs
,

98086 
ßveSqlFœg
,

98087 
Vdbe
 *
pOld
,

98088 
sqlôe3_°mt
 **
µStmt
,

98089 c⁄° **
pzTaû


98091 
rc
;

98092 
	`as£π
–
µStmt
!=0 );

98093 *
µStmt
 = 0;

98094 if–!
	`sqlôe3Sa„tyCheckOk
(
db
) ){

98095  
SQLITE_MISUSE_BKPT
;

98097 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

98098 
	`sqlôe3BåìE¡îAŒ
(
db
);

98099 
rc
 = 
	`sqlôe3Pª∑ª
(
db
, 
zSql
, 
nByãs
, 
ßveSqlFœg
, 
pOld
, 
µStmt
, 
pzTaû
);

98100 if–
rc
==
SQLITE_SCHEMA
 ){

98101 
	`sqlôe3_föÆize
(*
µStmt
);

98102 
rc
 = 
	`sqlôe3Pª∑ª
(
db
, 
zSql
, 
nByãs
, 
ßveSqlFœg
, 
pOld
, 
µStmt
, 
pzTaû
);

98104 
	`sqlôe3BåìLóveAŒ
(
db
);

98105 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

98106 
	`as£π
–
rc
==
SQLITE_OK
 || *
µStmt
==0 );

98107  
rc
;

98118 
SQLITE_PRIVATE
 
	`sqlôe3Rïª∑ª
(
Vdbe
 *
p
){

98119 
rc
;

98120 
sqlôe3_°mt
 *
pNew
;

98121 c⁄° *
zSql
;

98122 
sqlôe3
 *
db
;

98124 
	`as£π
–
	`sqlôe3_muãx_hñd
(
	`sqlôe3VdbeDb
(
p
)->
muãx
) );

98125 
zSql
 = 
	`sqlôe3_sql
((
sqlôe3_°mt
 *)
p
);

98126 
	`as£π
–
zSql
!=0 );

98127 
db
 = 
	`sqlôe3VdbeDb
(
p
);

98128 
	`as£π
–
	`sqlôe3_muãx_hñd
(
db
->
muãx
) );

98129 
rc
 = 
	`sqlôe3LockAndPª∑ª
(
db
, 
zSql
, -1, 0, 
p
, &
pNew
, 0);

98130 if–
rc
 ){

98131 if–
rc
==
SQLITE_NOMEM
 ){

98132 
db
->
mÆlocFaûed
 = 1;

98134 
	`as£π
–
pNew
==0 );

98135  
rc
;

98137 
	`as£π
–
pNew
!=0 );

98139 
	`sqlôe3VdbeSw≠
((
Vdbe
*)
pNew
, 
p
);

98140 
	`sqlôe3Tøns„rBödögs
(
pNew
, (
sqlôe3_°mt
*)
p
);

98141 
	`sqlôe3VdbeRe£tSãpResu…
((
Vdbe
*)
pNew
);

98142 
	`sqlôe3VdbeFöÆize
((
Vdbe
*)
pNew
);

98143  
SQLITE_OK
;

98155 
SQLITE_API
 
	`sqlôe3_¥ï¨e
(

98156 
sqlôe3
 *
db
,

98157 c⁄° *
zSql
,

98158 
nByãs
,

98159 
sqlôe3_°mt
 **
µStmt
,

98160 c⁄° **
pzTaû


98162 
rc
;

98163 
rc
 = 
	`sqlôe3LockAndPª∑ª
(
db
,
zSql
,
nByãs
,0,0,
µStmt
,
pzTaû
);

98164 
	`as£π
–
rc
==
SQLITE_OK
 || 
µStmt
==0 || *ppStmt==0 );

98165  
rc
;

98167 
SQLITE_API
 
	`sqlôe3_¥ï¨e_v2
(

98168 
sqlôe3
 *
db
,

98169 c⁄° *
zSql
,

98170 
nByãs
,

98171 
sqlôe3_°mt
 **
µStmt
,

98172 c⁄° **
pzTaû


98174 
rc
;

98175 
rc
 = 
	`sqlôe3LockAndPª∑ª
(
db
,
zSql
,
nByãs
,1,0,
µStmt
,
pzTaû
);

98176 
	`as£π
–
rc
==
SQLITE_OK
 || 
µStmt
==0 || *ppStmt==0 );

98177  
rc
;

98181 #i‚de‡
SQLITE_OMIT_UTF16


98185 
	`sqlôe3Pª∑ª16
(

98186 
sqlôe3
 *
db
,

98187 c⁄° *
zSql
,

98188 
nByãs
,

98189 
ßveSqlFœg
,

98190 
sqlôe3_°mt
 **
µStmt
,

98191 c⁄° **
pzTaû


98197 *
zSql8
;

98198 c⁄° *
zTaû8
 = 0;

98199 
rc
 = 
SQLITE_OK
;

98201 
	`as£π
–
µStmt
 );

98202 *
µStmt
 = 0;

98203 if–!
	`sqlôe3Sa„tyCheckOk
(
db
) ){

98204  
SQLITE_MISUSE_BKPT
;

98206 if–
nByãs
>=0 ){

98207 
sz
;

98208 c⁄° *
z
 = (c⁄° *)
zSql
;

98209 
sz
=0; sz<
nByãs
 && (
z
[sz]!=0 || z[sz+1]!=0); sz += 2){}

98210 
nByãs
 = 
sz
;

98212 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

98213 
zSql8
 = 
	`sqlôe3Utf16to8
(
db
, 
zSql
, 
nByãs
, 
SQLITE_UTF16NATIVE
);

98214 if–
zSql8
 ){

98215 
rc
 = 
	`sqlôe3LockAndPª∑ª
(
db
, 
zSql8
, -1, 
ßveSqlFœg
, 0, 
µStmt
, &
zTaû8
);

98218 if–
zTaû8
 && 
pzTaû
 ){

98224 
ch¨s_∑r£d
 = 
	`sqlôe3Utf8Ch¨Lí
(
zSql8
, ()(
zTaû8
-zSql8));

98225 *
pzTaû
 = (
u8
 *)
zSql
 + 
	`sqlôe3Utf16ByãLí
(zSql, 
ch¨s_∑r£d
);

98227 
	`sqlôe3DbFªe
(
db
, 
zSql8
);

98228 
rc
 = 
	`sqlôe3ApiExô
(
db
,Ñc);

98229 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

98230  
rc
;

98241 
SQLITE_API
 
	`sqlôe3_¥ï¨e16
(

98242 
sqlôe3
 *
db
,

98243 c⁄° *
zSql
,

98244 
nByãs
,

98245 
sqlôe3_°mt
 **
µStmt
,

98246 c⁄° **
pzTaû


98248 
rc
;

98249 
rc
 = 
	`sqlôe3Pª∑ª16
(
db
,
zSql
,
nByãs
,0,
µStmt
,
pzTaû
);

98250 
	`as£π
–
rc
==
SQLITE_OK
 || 
µStmt
==0 || *ppStmt==0 );

98251  
rc
;

98253 
SQLITE_API
 
	`sqlôe3_¥ï¨e16_v2
(

98254 
sqlôe3
 *
db
,

98255 c⁄° *
zSql
,

98256 
nByãs
,

98257 
sqlôe3_°mt
 **
µStmt
,

98258 c⁄° **
pzTaû


98260 
rc
;

98261 
rc
 = 
	`sqlôe3Pª∑ª16
(
db
,
zSql
,
nByãs
,1,
µStmt
,
pzTaû
);

98262 
	`as£π
–
rc
==
SQLITE_OK
 || 
µStmt
==0 || *ppStmt==0 );

98263  
rc
;

98290 
	`˛órSñe˘
(
sqlôe3
 *
db
, 
Sñe˘
 *
p
){

98291 
	`sqlôe3Ex¥Li°Dñëe
(
db
, 
p
->
pELi°
);

98292 
	`sqlôe3SrcLi°Dñëe
(
db
, 
p
->
pSrc
);

98293 
	`sqlôe3Ex¥Dñëe
(
db
, 
p
->
pWhîe
);

98294 
	`sqlôe3Ex¥Li°Dñëe
(
db
, 
p
->
pGroupBy
);

98295 
	`sqlôe3Ex¥Dñëe
(
db
, 
p
->
pHavög
);

98296 
	`sqlôe3Ex¥Li°Dñëe
(
db
, 
p
->
pOrdîBy
);

98297 
	`sqlôe3Sñe˘Dñëe
(
db
, 
p
->
pPri‹
);

98298 
	`sqlôe3Ex¥Dñëe
(
db
, 
p
->
pLimô
);

98299 
	`sqlôe3Ex¥Dñëe
(
db
, 
p
->
pOff£t
);

98305 
SQLITE_PRIVATE
 
	`sqlôe3Sñe˘De°Inô
(
Sñe˘De°
 *
pDe°
, 
eDe°
, 
iP¨m
){

98306 
pDe°
->
eDe°
 = (
u8
)eDest;

98307 
pDe°
->
iSDP¨m
 = 
iP¨m
;

98308 
pDe°
->
affSd°
 = 0;

98309 
pDe°
->
iSd°
 = 0;

98310 
pDe°
->
nSd°
 = 0;

98318 
SQLITE_PRIVATE
 
Sñe˘
 *
	`sqlôe3Sñe˘New
(

98319 
P¨£
 *
pP¨£
,

98320 
Ex¥Li°
 *
pELi°
,

98321 
SrcLi°
 *
pSrc
,

98322 
Ex¥
 *
pWhîe
,

98323 
Ex¥Li°
 *
pGroupBy
,

98324 
Ex¥
 *
pHavög
,

98325 
Ex¥Li°
 *
pOrdîBy
,

98326 
u16
 
£lFœgs
,

98327 
Ex¥
 *
pLimô
,

98328 
Ex¥
 *
pOff£t


98330 
Sñe˘
 *
pNew
;

98331 
Sñe˘
 
°™dö
;

98332 
sqlôe3
 *
db
 = 
pP¨£
->db;

98333 
pNew
 = 
	`sqlôe3DbMÆlocZîo
(
db
, (*pNew) );

98334 
	`as£π
–
db
->
mÆlocFaûed
 || !
pOff£t
 || 
pLimô
 );

98335 if–
pNew
==0 ){

98336 
	`as£π
–
db
->
mÆlocFaûed
 );

98337 
pNew
 = &
°™dö
;

98338 
	`mem£t
(
pNew
, 0, (*pNew));

98340 if–
pELi°
==0 ){

98341 
pELi°
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
, 0, 
	`sqlôe3Ex¥
(
db
,
TK_ALL
,0));

98343 
pNew
->
pELi°
 =ÖEList;

98344 if–
pSrc
==0 )ÖSr¯
	`sqlôe3DbMÆlocZîo
(
db
, (*pSrc));

98345 
pNew
->
pSrc
 =ÖSrc;

98346 
pNew
->
pWhîe
 =ÖWhere;

98347 
pNew
->
pGroupBy
 =ÖGroupBy;

98348 
pNew
->
pHavög
 =ÖHaving;

98349 
pNew
->
pOrdîBy
 =ÖOrderBy;

98350 
pNew
->
£lFœgs
 = selFlags;

98351 
pNew
->
›
 = 
TK_SELECT
;

98352 
pNew
->
pLimô
 =ÖLimit;

98353 
pNew
->
pOff£t
 =ÖOffset;

98354 
	`as£π
–
pOff£t
==0 || 
pLimô
!=0 );

98355 
pNew
->
addrO≥nEphm
[0] = -1;

98356 
pNew
->
addrO≥nEphm
[1] = -1;

98357 
pNew
->
addrO≥nEphm
[2] = -1;

98358 if–
db
->
mÆlocFaûed
 ) {

98359 
	`˛órSñe˘
(
db
, 
pNew
);

98360 if–
pNew
!=&
°™dö
 ) 
	`sqlôe3DbFªe
(
db
,ÖNew);

98361 
pNew
 = 0;

98363 
	`as£π
–
pNew
->
pSrc
!=0 || 
pP¨£
->
nEº
>0 );

98365 
	`as£π
–
pNew
!=&
°™dö
 );

98366  
pNew
;

98372 
SQLITE_PRIVATE
 
	`sqlôe3Sñe˘Dñëe
(
sqlôe3
 *
db
, 
Sñe˘
 *
p
){

98373 if–
p
 ){

98374 
	`˛órSñe˘
(
db
, 
p
);

98375 
	`sqlôe3DbFªe
(
db
, 
p
);

98396 
SQLITE_PRIVATE
 
	`sqlôe3JoöTy≥
(
P¨£
 *
pP¨£
, 
Tokí
 *
pA
, Tokí *
pB
, Tokí *
pC
){

98397 
joöty≥
 = 0;

98398 
Tokí
 *
≠AŒ
[3];

98399 
Tokí
 *
p
;

98401 c⁄° 
zKeyText
[] = "naturaleftouterightfullinnercross";

98403 
u8
 
i
;

98404 
u8
 
nCh¨
;

98405 
u8
 
code
;

98406 } 
aKeyw‹d
[] = {

98407  { 0, 7, 
JT_NATURAL
 },

98408  { 6, 4, 
JT_LEFT
|
JT_OUTER
 },

98409  { 10, 5, 
JT_OUTER
 },

98410  { 14, 5, 
JT_RIGHT
|
JT_OUTER
 },

98411  { 19, 4, 
JT_LEFT
|
JT_RIGHT
|
JT_OUTER
 },

98412  { 23, 5, 
JT_INNER
 },

98413  { 28, 5, 
JT_INNER
|
JT_CROSS
 },

98415 
i
, 
j
;

98416 
≠AŒ
[0] = 
pA
;

98417 
≠AŒ
[1] = 
pB
;

98418 
≠AŒ
[2] = 
pC
;

98419 
i
=0; i<3 && 
≠AŒ
[i]; i++){

98420 
p
 = 
≠AŒ
[
i
];

98421 
j
=0; j<
	`AºaySize
(
aKeyw‹d
); j++){

98422 if–
p
->
n
==
aKeyw‹d
[
j
].
nCh¨


98423 && 
	`sqlôe3SåNICmp
((*)
p
->
z
, &
zKeyText
[
aKeyw‹d
[
j
].
i
],Ö->
n
)==0 ){

98424 
joöty≥
 |
aKeyw‹d
[
j
].
code
;

98428 
	`ã°ˇ£
–
j
==0 || j==1 || j==2 || j==3 || j==4 || j==5 || j==6 );

98429 if–
j
>=
	`AºaySize
(
aKeyw‹d
) ){

98430 
joöty≥
 |
JT_ERROR
;

98435 (
joöty≥
 & (
JT_INNER
|
JT_OUTER
))==(JT_INNER|JT_OUTER) ||

98436 (
joöty≥
 & 
JT_ERROR
)!=0

98438 c⁄° *
zSp
 = " ";

98439 
	`as£π
–
pB
!=0 );

98440 if–
pC
==0 ){ 
zSp
++; }

98441 
	`sqlôe3Eº‹Msg
(
pP¨£
, "unknown or unsupported joinÅype: "

98442 "%T %T%s%T", 
pA
, 
pB
, 
zSp
, 
pC
);

98443 
joöty≥
 = 
JT_INNER
;

98444 }if–(
joöty≥
 & 
JT_OUTER
)!=0

98445 && (
joöty≥
 & (
JT_LEFT
|
JT_RIGHT
))!=JT_LEFT ){

98446 
	`sqlôe3Eº‹Msg
(
pP¨£
,

98448 
joöty≥
 = 
JT_INNER
;

98450  
joöty≥
;

98457 
	`cﬁumnIndex
(
TabÀ
 *
pTab
, c⁄° *
zCﬁ
){

98458 
i
;

98459 
i
=0; i<
pTab
->
nCﬁ
; i++){

98460 if–
	`sqlôe3SåICmp
(
pTab
->
aCﬁ
[
i
].
zName
, 
zCﬁ
)==0 )  i;

98474 
	`èbÀAndCﬁumnIndex
(

98475 
SrcLi°
 *
pSrc
,

98476 
N
,

98477 c⁄° *
zCﬁ
,

98478 *
piTab
,

98479 *
piCﬁ


98481 
i
;

98482 
iCﬁ
;

98484 
	`as£π
–(
piTab
==0)==(
piCﬁ
==0) );

98485 
i
=0; i<
N
; i++){

98486 
iCﬁ
 = 
	`cﬁumnIndex
(
pSrc
->
a
[
i
].
pTab
, 
zCﬁ
);

98487 if–
iCﬁ
>=0 ){

98488 if–
piTab
 ){

98489 *
piTab
 = 
i
;

98490 *
piCﬁ
 = 
iCﬁ
;

98509 
	`addWhîeTîm
(

98510 
P¨£
 *
pP¨£
,

98511 
SrcLi°
 *
pSrc
,

98512 
iLe·
,

98513 
iCﬁLe·
,

98514 
iRight
,

98515 
iCﬁRight
,

98516 
isOuãrJoö
,

98517 
Ex¥
 **
µWhîe


98519 
sqlôe3
 *
db
 = 
pP¨£
->db;

98520 
Ex¥
 *
pE1
;

98521 
Ex¥
 *
pE2
;

98522 
Ex¥
 *
pEq
;

98524 
	`as£π
–
iLe·
<
iRight
 );

98525 
	`as£π
–
pSrc
->
nSrc
>
iRight
 );

98526 
	`as£π
–
pSrc
->
a
[
iLe·
].
pTab
 );

98527 
	`as£π
–
pSrc
->
a
[
iRight
].
pTab
 );

98529 
pE1
 = 
	`sqlôe3Cª©eCﬁumnEx¥
(
db
, 
pSrc
, 
iLe·
, 
iCﬁLe·
);

98530 
pE2
 = 
	`sqlôe3Cª©eCﬁumnEx¥
(
db
, 
pSrc
, 
iRight
, 
iCﬁRight
);

98532 
pEq
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_EQ
, 
pE1
, 
pE2
, 0);

98533 if–
pEq
 && 
isOuãrJoö
 ){

98534 
	`Ex¥SëPr›îty
(
pEq
, 
EP_FromJoö
);

98535 
	`as£π
–!
	`Ex¥HasPr›îty
(
pEq
, 
EP_TokíO∆y
|
EP_Redu˚d
) );

98536 
	`Ex¥SëVVAPr›îty
(
pEq
, 
EP_NoRedu˚
);

98537 
pEq
->
iRightJoöTabÀ
 = (
i16
)
pE2
->
iTabÀ
;

98539 *
µWhîe
 = 
	`sqlôe3Ex¥And
(
db
, *µWhîe, 
pEq
);

98568 
	`£tJoöEx¥
(
Ex¥
 *
p
, 
iTabÀ
){

98569  
p
 ){

98570 
	`Ex¥SëPr›îty
(
p
, 
EP_FromJoö
);

98571 
	`as£π
–!
	`Ex¥HasPr›îty
(
p
, 
EP_TokíO∆y
|
EP_Redu˚d
) );

98572 
	`Ex¥SëVVAPr›îty
(
p
, 
EP_NoRedu˚
);

98573 
p
->
iRightJoöTabÀ
 = (
i16
)
iTabÀ
;

98574 
	`£tJoöEx¥
(
p
->
pLe·
, 
iTabÀ
);

98575 
p
 =Ö->
pRight
;

98593 
	`sqlôePro˚ssJoö
(
P¨£
 *
pP¨£
, 
Sñe˘
 *
p
){

98594 
SrcLi°
 *
pSrc
;

98595 
i
, 
j
;

98596 
SrcLi°_ôem
 *
pLe·
;

98597 
SrcLi°_ôem
 *
pRight
;

98599 
pSrc
 = 
p
->pSrc;

98600 
pLe·
 = &
pSrc
->
a
[0];

98601 
pRight
 = &
pLe·
[1];

98602 
i
=0; i<
pSrc
->
nSrc
-1; i++, 
pRight
++, 
pLe·
++){

98603 
TabÀ
 *
pLe·Tab
 = 
pLe·
->
pTab
;

98604 
TabÀ
 *
pRightTab
 = 
pRight
->
pTab
;

98605 
isOuãr
;

98607 if–
	`NEVER
(
pLe·Tab
==0 || 
pRightTab
==0) ) ;

98608 
isOuãr
 = (
pRight
->
joöty≥
 & 
JT_OUTER
)!=0;

98613 if–
pRight
->
joöty≥
 & 
JT_NATURAL
 ){

98614 if–
pRight
->
pOn
 ||ÖRight->
pUsög
 ){

98615 
	`sqlôe3Eº‹Msg
(
pP¨£
, "a NATURAL join mayÇot have "

98619 
j
=0; j<
pRightTab
->
nCﬁ
; j++){

98620 *
zName
;

98621 
iLe·
;

98622 
iLe·Cﬁ
;

98624 
zName
 = 
pRightTab
->
aCﬁ
[
j
].zName;

98625 if–
	`èbÀAndCﬁumnIndex
(
pSrc
, 
i
+1, 
zName
, &
iLe·
, &
iLe·Cﬁ
) ){

98626 
	`addWhîeTîm
(
pP¨£
, 
pSrc
, 
iLe·
, 
iLe·Cﬁ
, 
i
+1, 
j
,

98627 
isOuãr
, &
p
->
pWhîe
);

98634 if–
pRight
->
pOn
 &&ÖRight->
pUsög
 ){

98635 
	`sqlôe3Eº‹Msg
(
pP¨£
, "cannot have both ONánd USING "

98643 if–
pRight
->
pOn
 ){

98644 if–
isOuãr
 ) 
	`£tJoöEx¥
(
pRight
->
pOn
,ÖRight->
iCurs‹
);

98645 
p
->
pWhîe
 = 
	`sqlôe3Ex¥And
(
pP¨£
->
db
,Ö->pWhîe, 
pRight
->
pOn
);

98646 
pRight
->
pOn
 = 0;

98656 if–
pRight
->
pUsög
 ){

98657 
IdLi°
 *
pLi°
 = 
pRight
->
pUsög
;

98658 
j
=0; j<
pLi°
->
nId
; j++){

98659 *
zName
;

98660 
iLe·
;

98661 
iLe·Cﬁ
;

98662 
iRightCﬁ
;

98664 
zName
 = 
pLi°
->
a
[
j
].zName;

98665 
iRightCﬁ
 = 
	`cﬁumnIndex
(
pRightTab
, 
zName
);

98666 if–
iRightCﬁ
<0

98667 || !
	`èbÀAndCﬁumnIndex
(
pSrc
, 
i
+1, 
zName
, &
iLe·
, &
iLe·Cﬁ
)

98669 
	`sqlôe3Eº‹Msg
(
pP¨£
, "cannot join using column %s - column "

98670 "nŸÖª£¡ i¿bŸhÅabÀs", 
zName
);

98673 
	`addWhîeTîm
(
pP¨£
, 
pSrc
, 
iLe·
, 
iLe·Cﬁ
, 
i
+1, 
iRightCﬁ
,

98674 
isOuãr
, &
p
->
pWhîe
);

98685 
	`pushO¡oS‹ãr
(

98686 
P¨£
 *
pP¨£
,

98687 
Ex¥Li°
 *
pOrdîBy
,

98688 
Sñe˘
 *
pSñe˘
,

98689 
ªgD©a


98691 
Vdbe
 *
v
 = 
pP¨£
->
pVdbe
;

98692 
nEx¥
 = 
pOrdîBy
->nExpr;

98693 
ªgBa£
 = 
	`sqlôe3GëTempR™ge
(
pP¨£
, 
nEx¥
+2);

98694 
ªgRec‹d
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

98695 
›
;

98696 
	`sqlôe3Ex¥CacheCÀ¨
(
pP¨£
);

98697 
	`sqlôe3Ex¥CodeEx¥Li°
(
pP¨£
, 
pOrdîBy
, 
ªgBa£
, 0);

98698 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Sequí˚
, 
pOrdîBy
->
iECurs‹
, 
ªgBa£
+
nEx¥
);

98699 
	`sqlôe3Ex¥CodeMove
(
pP¨£
, 
ªgD©a
, 
ªgBa£
+
nEx¥
+1, 1);

98700 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_MakeRec‹d
, 
ªgBa£
, 
nEx¥
 + 2, 
ªgRec‹d
);

98701 if–
pSñe˘
->
£lFœgs
 & 
SF_U£S‹ãr
 ){

98702 
›
 = 
OP_S‹ãrIn£π
;

98704 
›
 = 
OP_IdxIn£π
;

98706 
	`sqlôe3VdbeAddOp2
(
v
, 
›
, 
pOrdîBy
->
iECurs‹
, 
ªgRec‹d
);

98707 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
ªgRec‹d
);

98708 
	`sqlôe3Rñó£TempR™ge
(
pP¨£
, 
ªgBa£
, 
nEx¥
+2);

98709 if–
pSñe˘
->
iLimô
 ){

98710 
addr1
, 
addr2
;

98711 
iLimô
;

98712 if–
pSñe˘
->
iOff£t
 ){

98713 
iLimô
 = 
pSñe˘
->
iOff£t
+1;

98715 
iLimô
 = 
pSñe˘
->iLimit;

98717 
addr1
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_IfZîo
, 
iLimô
);

98718 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_AddImm
, 
iLimô
, -1);

98719 
addr2
 = 
	`sqlôe3VdbeAddOp0
(
v
, 
OP_GŸo
);

98720 
	`sqlôe3VdbeJumpHîe
(
v
, 
addr1
);

98721 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_La°
, 
pOrdîBy
->
iECurs‹
);

98722 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Dñëe
, 
pOrdîBy
->
iECurs‹
);

98723 
	`sqlôe3VdbeJumpHîe
(
v
, 
addr2
);

98730 
	`codeOff£t
(

98731 
Vdbe
 *
v
,

98732 
Sñe˘
 *
p
,

98733 
iC⁄töue


98735 if–
p
->
iOff£t
 && 
iC⁄töue
!=0 ){

98736 
addr
;

98737 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_AddImm
, 
p
->
iOff£t
, -1);

98738 
addr
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_IfNeg
, 
p
->
iOff£t
);

98739 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_GŸo
, 0, 
iC⁄töue
);

98740 
	`VdbeCommít
((
v
, "skip OFFSETÑecords"));

98741 
	`sqlôe3VdbeJumpHîe
(
v
, 
addr
);

98754 
	`codeDi°ö˘
(

98755 
P¨£
 *
pP¨£
,

98756 
iTab
,

98757 
addrRïót
,

98758 
N
,

98759 
iMem


98761 
Vdbe
 *
v
;

98762 
r1
;

98764 
v
 = 
pP¨£
->
pVdbe
;

98765 
r1
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

98766 
	`sqlôe3VdbeAddOp4I¡
(
v
, 
OP_Found
, 
iTab
, 
addrRïót
, 
iMem
, 
N
);

98767 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_MakeRec‹d
, 
iMem
, 
N
, 
r1
);

98768 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_IdxIn£π
, 
iTab
, 
r1
);

98769 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
r1
);

98772 #i‚de‡
SQLITE_OMIT_SUBQUERY


98780 
	`checkF‹Mu…iCﬁumnSñe˘Eº‹
(

98781 
P¨£
 *
pP¨£
,

98782 
Sñe˘De°
 *
pDe°
,

98783 
nEx¥


98785 
eDe°
 = 
pDe°
->eDest;

98786 if–
nEx¥
>1 && (
eDe°
==
SRT_Mem
 ||ÉDe°==
SRT_Së
) ){

98787 
	`sqlôe3Eº‹Msg
(
pP¨£
, "onlyá singleÑesultállowed for "

98801 
Di°ö˘Ctx
 
	tDi°ö˘Ctx
;

98802 
	sDi°ö˘Ctx
 {

98803 
u8
 
isTn˘
;

98804 
u8
 
eTn˘Ty≥
;

98805 
èbTn˘
;

98806 
addrTn˘
;

98818 
	`£À˘I¬îLo›
(

98819 
P¨£
 *
pP¨£
,

98820 
Sñe˘
 *
p
,

98821 
Ex¥Li°
 *
pELi°
,

98822 
§cTab
,

98823 
nCﬁumn
,

98824 
Ex¥Li°
 *
pOrdîBy
,

98825 
Di°ö˘Ctx
 *
pDi°ö˘
,

98826 
Sñe˘De°
 *
pDe°
,

98827 
iC⁄töue
,

98828 
iBªak


98830 
Vdbe
 *
v
 = 
pP¨£
->
pVdbe
;

98831 
i
;

98832 
hasDi°ö˘
;

98833 
ªgResu…
;

98834 
eDe°
 = 
pDe°
->eDest;

98835 
iP¨m
 = 
pDe°
->
iSDP¨m
;

98836 
nResu…Cﬁ
;

98838 
	`as£π
–
v
 );

98839 if–
	`NEVER
(
v
==0) ) ;

98840 
	`as£π
–
pELi°
!=0 );

98841 
hasDi°ö˘
 = 
pDi°ö˘
 ?ÖDi°ö˘->
eTn˘Ty≥
 : 
WHERE_DISTINCT_NOOP
;

98842 if–
pOrdîBy
==0 && !
hasDi°ö˘
 ){

98843 
	`codeOff£t
(
v
, 
p
, 
iC⁄töue
);

98848 if–
nCﬁumn
>0 ){

98849 
nResu…Cﬁ
 = 
nCﬁumn
;

98851 
nResu…Cﬁ
 = 
pELi°
->
nEx¥
;

98853 if–
pDe°
->
iSd°
==0 ){

98854 
pDe°
->
iSd°
 = 
pP¨£
->
nMem
+1;

98855 
pDe°
->
nSd°
 = 
nResu…Cﬁ
;

98856 
pP¨£
->
nMem
 +
nResu…Cﬁ
;

98858 
	`as£π
–
pDe°
->
nSd°
==
nResu…Cﬁ
 );

98860 
ªgResu…
 = 
pDe°
->
iSd°
;

98861 if–
nCﬁumn
>0 ){

98862 
i
=0; i<
nCﬁumn
; i++){

98863 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Cﬁumn
, 
§cTab
, 
i
, 
ªgResu…
+i);

98865 }if–
eDe°
!=
SRT_Exi°s
 ){

98869 
	`sqlôe3Ex¥CacheCÀ¨
(
pP¨£
);

98870 
	`sqlôe3Ex¥CodeEx¥Li°
(
pP¨£
, 
pELi°
, 
ªgResu…
, 
eDe°
==
SRT_Ouçut
);

98872 
nCﬁumn
 = 
nResu…Cﬁ
;

98878 if–
hasDi°ö˘
 ){

98879 
	`as£π
–
pELi°
!=0 );

98880 
	`as£π
–
pELi°
->
nEx¥
==
nCﬁumn
 );

98881  
pDi°ö˘
->
eTn˘Ty≥
 ){

98882 
WHERE_DISTINCT_ORDERED
: {

98883 
VdbeOp
 *
pOp
;

98884 
iJump
;

98885 
ªgPªv
;

98888 
ªgPªv
 = 
pP¨£
->
nMem
+1;

98889 
pP¨£
->
nMem
 +
nCﬁumn
;

98897 
	`sqlôe3VdbeCh™geToNo›
(
v
, 
pDi°ö˘
->
addrTn˘
);

98898 
pOp
 = 
	`sqlôe3VdbeGëOp
(
v
, 
pDi°ö˘
->
addrTn˘
);

98899 
pOp
->
›code
 = 
OP_NuŒ
;

98900 
pOp
->
p1
 = 1;

98901 
pOp
->
p2
 = 
ªgPªv
;

98903 
iJump
 = 
	`sqlôe3VdbeCuºítAddr
(
v
Ë+ 
nCﬁumn
;

98904 
i
=0; i<
nCﬁumn
; i++){

98905 
CﬁlSeq
 *
pCﬁl
 = 
	`sqlôe3Ex¥CﬁlSeq
(
pP¨£
, 
pELi°
->
a
[
i
].
pEx¥
);

98906 if–
i
<
nCﬁumn
-1 ){

98907 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Ne
, 
ªgResu…
+
i
, 
iJump
, 
ªgPªv
+i);

98909 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Eq
, 
ªgResu…
+
i
, 
iC⁄töue
, 
ªgPªv
+i);

98911 
	`sqlôe3VdbeCh™geP4
(
v
, -1, (c⁄° *)
pCﬁl
, 
P4_COLLSEQ
);

98912 
	`sqlôe3VdbeCh™geP5
(
v
, 
SQLITE_NULLEQ
);

98914 
	`as£π
–
	`sqlôe3VdbeCuºítAddr
(
v
)==
iJump
 );

98915 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_C›y
, 
ªgResu…
, 
ªgPªv
, 
nCﬁumn
-1);

98919 
WHERE_DISTINCT_UNIQUE
: {

98920 
	`sqlôe3VdbeCh™geToNo›
(
v
, 
pDi°ö˘
->
addrTn˘
);

98925 
	`as£π
–
pDi°ö˘
->
eTn˘Ty≥
==
WHERE_DISTINCT_UNORDERED
 );

98926 
	`codeDi°ö˘
(
pP¨£
, 
pDi°ö˘
->
èbTn˘
, 
iC⁄töue
, 
nCﬁumn
, 
ªgResu…
);

98930 if–
pOrdîBy
==0 ){

98931 
	`codeOff£t
(
v
, 
p
, 
iC⁄töue
);

98935  
eDe°
 ){

98939 #i‚de‡
SQLITE_OMIT_COMPOUND_SELECT


98940 
SRT_Uni⁄
: {

98941 
r1
;

98942 
r1
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

98943 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_MakeRec‹d
, 
ªgResu…
, 
nCﬁumn
, 
r1
);

98944 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_IdxIn£π
, 
iP¨m
, 
r1
);

98945 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
r1
);

98953 
SRT_Ex˚±
: {

98954 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_IdxDñëe
, 
iP¨m
, 
ªgResu…
, 
nCﬁumn
);

98961 
SRT_TabÀ
:

98962 
SRT_EphemTab
: {

98963 
r1
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

98964 
	`ã°ˇ£
–
eDe°
==
SRT_TabÀ
 );

98965 
	`ã°ˇ£
–
eDe°
==
SRT_EphemTab
 );

98966 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_MakeRec‹d
, 
ªgResu…
, 
nCﬁumn
, 
r1
);

98967 if–
pOrdîBy
 ){

98968 
	`pushO¡oS‹ãr
(
pP¨£
, 
pOrdîBy
, 
p
, 
r1
);

98970 
r2
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

98971 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NewRowid
, 
iP¨m
, 
r2
);

98972 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_In£π
, 
iP¨m
, 
r1
, 
r2
);

98973 
	`sqlôe3VdbeCh™geP5
(
v
, 
OPFLAG_APPEND
);

98974 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
r2
);

98976 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
r1
);

98980 #i‚de‡
SQLITE_OMIT_SUBQUERY


98985 
SRT_Së
: {

98986 
	`as£π
–
nCﬁumn
==1 );

98987 
pDe°
->
affSd°
 =

98988 
	`sqlôe3Com∑ªAfföôy
(
pELi°
->
a
[0].
pEx¥
, 
pDe°
->
affSd°
);

98989 if–
pOrdîBy
 ){

98994 
	`pushO¡oS‹ãr
(
pP¨£
, 
pOrdîBy
, 
p
, 
ªgResu…
);

98996 
r1
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

98997 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_MakeRec‹d
, 
ªgResu…
,1,
r1
, &
pDe°
->
affSd°
, 1);

98998 
	`sqlôe3Ex¥CacheAfföôyCh™ge
(
pP¨£
, 
ªgResu…
, 1);

98999 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_IdxIn£π
, 
iP¨m
, 
r1
);

99000 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
r1
);

99007 
SRT_Exi°s
: {

99008 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 1, 
iP¨m
);

99017 
SRT_Mem
: {

99018 
	`as£π
–
nCﬁumn
==1 );

99019 if–
pOrdîBy
 ){

99020 
	`pushO¡oS‹ãr
(
pP¨£
, 
pOrdîBy
, 
p
, 
ªgResu…
);

99022 
	`sqlôe3Ex¥CodeMove
(
pP¨£
, 
ªgResu…
, 
iP¨m
, 1);

99033 
SRT_C‹outöe
:

99034 
SRT_Ouçut
: {

99035 
	`ã°ˇ£
–
eDe°
==
SRT_C‹outöe
 );

99036 
	`ã°ˇ£
–
eDe°
==
SRT_Ouçut
 );

99037 if–
pOrdîBy
 ){

99038 
r1
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

99039 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_MakeRec‹d
, 
ªgResu…
, 
nCﬁumn
, 
r1
);

99040 
	`pushO¡oS‹ãr
(
pP¨£
, 
pOrdîBy
, 
p
, 
r1
);

99041 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
r1
);

99042 }if–
eDe°
==
SRT_C‹outöe
 ){

99043 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Yõld
, 
pDe°
->
iSDP¨m
);

99045 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Resu…Row
, 
ªgResu…
, 
nCﬁumn
);

99046 
	`sqlôe3Ex¥CacheAfföôyCh™ge
(
pP¨£
, 
ªgResu…
, 
nCﬁumn
);

99051 #i‡!
	`deföed
(
SQLITE_OMIT_TRIGGER
)

99058 
	`as£π
–
eDe°
==
SRT_Disˇrd
 );

99068 if–
pOrdîBy
==0 && 
p
->
iLimô
 ){

99069 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_IfZîo
, 
p
->
iLimô
, 
iBªak
, -1);

99080 
SQLITE_PRIVATE
 
KeyInfo
 *
	`sqlôe3KeyInfoAŒoc
(
sqlôe3
 *
db
, 
N
){

99081 
KeyInfo
 *
p
 = 
	`sqlôe3DbMÆlocZîo
(
db
,

99082 (
KeyInfo
Ë+ (
N
+1)*((
CﬁlSeq
*)+1));

99083 if–
p
 ){

99084 
p
->
aS‹tOrdî
 = (
u8
*)&p->
aCﬁl
[
N
+1];

99085 
p
->
nFõld
 = (
u16
)
N
;

99086 
p
->
íc
 = 
	`ENC
(
db
);

99087 
p
->
db
 = db;

99089  
p
;

99107 
KeyInfo
 *
	`keyInfoFromEx¥Li°
(
P¨£
 *
pP¨£
, 
Ex¥Li°
 *
pLi°
){

99108 
nEx¥
;

99109 
KeyInfo
 *
pInfo
;

99110 
Ex¥Li°_ôem
 *
pIãm
;

99111 
sqlôe3
 *
db
 = 
pP¨£
->db;

99112 
i
;

99114 
nEx¥
 = 
pLi°
->nExpr;

99115 
pInfo
 = 
	`sqlôe3KeyInfoAŒoc
(
db
, 
nEx¥
);

99116 if–
pInfo
 ){

99117 
i
=0, 
pIãm
=
pLi°
->
a
; i<
nEx¥
; i++,ÖItem++){

99118 
CﬁlSeq
 *
pCﬁl
;

99119 
pCﬁl
 = 
	`sqlôe3Ex¥CﬁlSeq
(
pP¨£
, 
pIãm
->
pEx¥
);

99120 if–!
pCﬁl
 )ÖCﬁ»
db
->
pDÊtCﬁl
;

99121 
pInfo
->
aCﬁl
[
i
] = 
pCﬁl
;

99122 
pInfo
->
aS‹tOrdî
[
i
] = 
pIãm
->
s‹tOrdî
;

99125  
pInfo
;

99128 #i‚de‡
SQLITE_OMIT_COMPOUND_SELECT


99132 c⁄° *
	`£À˘OpName
(
id
){

99133 *
z
;

99134  
id
 ){

99135 
TK_ALL
: 
z
 = "UNION ALL"; ;

99136 
TK_INTERSECT
: 
z
 = "INTERSECT"; ;

99137 
TK_EXCEPT
: 
z
 = "EXCEPT"; ;

99138 : 
z
 = "UNION"; ;

99140  
z
;

99144 #i‚de‡
SQLITE_OMIT_EXPLAIN


99155 
	`ex∂aöTempTabÀ
(
P¨£
 *
pP¨£
, c⁄° *
zUßge
){

99156 if–
pP¨£
->
ex∂aö
==2 ){

99157 
Vdbe
 *
v
 = 
pP¨£
->
pVdbe
;

99158 *
zMsg
 = 
	`sqlôe3MPrötf
(
pP¨£
->
db
, "USE TEMP B-TREE FOR %s", 
zUßge
);

99159 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Ex∂aö
, 
pP¨£
->
iSñe˘Id
, 0, 0, 
zMsg
, 
P4_DYNAMIC
);

99170 
	#ex∂aöSëI¡egî
(
a
, 
b
Ë®
	)
b

99174 
	#ex∂aöTempTabÀ
(
y
,
z
)

	)

99175 
	#ex∂aöSëI¡egî
(
y
,
z
)

	)

99178 #i‡!
	`deföed
(
SQLITE_OMIT_EXPLAIN
Ë&& !deföed(
SQLITE_OMIT_COMPOUND_SELECT
)

99193 
	`ex∂aöComposôe
(

99194 
P¨£
 *
pP¨£
,

99195 
›
,

99196 
iSub1
,

99197 
iSub2
,

99198 
bU£Tmp


99200 
	`as£π
–
›
==
TK_UNION
 || op==
TK_EXCEPT
 || op==
TK_INTERSECT
 || op==
TK_ALL
 );

99201 if–
pP¨£
->
ex∂aö
==2 ){

99202 
Vdbe
 *
v
 = 
pP¨£
->
pVdbe
;

99203 *
zMsg
 = 
	`sqlôe3MPrötf
(

99204 
pP¨£
->
db
, "COMPOUND SUBQUERIES %d AND %d %s(%s)", 
iSub1
, 
iSub2
,

99205 
bU£Tmp
?"USING TEMP B-TREE ":"", 
	`£À˘OpName
(
›
)

99207 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Ex∂aö
, 
pP¨£
->
iSñe˘Id
, 0, 0, 
zMsg
, 
P4_DYNAMIC
);

99212 
	#ex∂aöComposôe
(
v
,
w
,
x
,
y
,
z
)

	)

99221 
	`gíî©eS‹tTaû
(

99222 
P¨£
 *
pP¨£
,

99223 
Sñe˘
 *
p
,

99224 
Vdbe
 *
v
,

99225 
nCﬁumn
,

99226 
Sñe˘De°
 *
pDe°


99228 
addrBªak
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

99229 
addrC⁄töue
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

99230 
addr
;

99231 
iTab
;

99232 
p£udoTab
 = 0;

99233 
Ex¥Li°
 *
pOrdîBy
 = 
p
->pOrderBy;

99235 
eDe°
 = 
pDe°
->eDest;

99236 
iP¨m
 = 
pDe°
->
iSDP¨m
;

99238 
ªgRow
;

99239 
ªgRowid
;

99241 
iTab
 = 
pOrdîBy
->
iECurs‹
;

99242 
ªgRow
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

99243 if–
eDe°
==
SRT_Ouçut
 ||ÉDe°==
SRT_C‹outöe
 ){

99244 
p£udoTab
 = 
pP¨£
->
nTab
++;

99245 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_O≥nP£udo
, 
p£udoTab
, 
ªgRow
, 
nCﬁumn
);

99246 
ªgRowid
 = 0;

99248 
ªgRowid
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

99250 if–
p
->
£lFœgs
 & 
SF_U£S‹ãr
 ){

99251 
ªgS‹tOut
 = ++
pP¨£
->
nMem
;

99252 
±ab2
 = 
pP¨£
->
nTab
++;

99253 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_O≥nP£udo
, 
±ab2
, 
ªgS‹tOut
, 
pOrdîBy
->
nEx¥
+2);

99254 
addr
 = 1 + 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_S‹ãrS‹t
, 
iTab
, 
addrBªak
);

99255 
	`codeOff£t
(
v
, 
p
, 
addrC⁄töue
);

99256 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_S‹ãrD©a
, 
iTab
, 
ªgS‹tOut
);

99257 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Cﬁumn
, 
±ab2
, 
pOrdîBy
->
nEx¥
+1, 
ªgRow
);

99258 
	`sqlôe3VdbeCh™geP5
(
v
, 
OPFLAG_CLEARCACHE
);

99260 
addr
 = 1 + 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_S‹t
, 
iTab
, 
addrBªak
);

99261 
	`codeOff£t
(
v
, 
p
, 
addrC⁄töue
);

99262 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Cﬁumn
, 
iTab
, 
pOrdîBy
->
nEx¥
+1, 
ªgRow
);

99264  
eDe°
 ){

99265 
SRT_TabÀ
:

99266 
SRT_EphemTab
: {

99267 
	`ã°ˇ£
–
eDe°
==
SRT_TabÀ
 );

99268 
	`ã°ˇ£
–
eDe°
==
SRT_EphemTab
 );

99269 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NewRowid
, 
iP¨m
, 
ªgRowid
);

99270 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_In£π
, 
iP¨m
, 
ªgRow
, 
ªgRowid
);

99271 
	`sqlôe3VdbeCh™geP5
(
v
, 
OPFLAG_APPEND
);

99274 #i‚de‡
SQLITE_OMIT_SUBQUERY


99275 
SRT_Së
: {

99276 
	`as£π
–
nCﬁumn
==1 );

99277 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_MakeRec‹d
, 
ªgRow
, 1, 
ªgRowid
,

99278 &
pDe°
->
affSd°
, 1);

99279 
	`sqlôe3Ex¥CacheAfföôyCh™ge
(
pP¨£
, 
ªgRow
, 1);

99280 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_IdxIn£π
, 
iP¨m
, 
ªgRowid
);

99283 
SRT_Mem
: {

99284 
	`as£π
–
nCﬁumn
==1 );

99285 
	`sqlôe3Ex¥CodeMove
(
pP¨£
, 
ªgRow
, 
iP¨m
, 1);

99291 
i
;

99292 
	`as£π
–
eDe°
==
SRT_Ouçut
 ||ÉDe°==
SRT_C‹outöe
 );

99293 
	`ã°ˇ£
–
eDe°
==
SRT_Ouçut
 );

99294 
	`ã°ˇ£
–
eDe°
==
SRT_C‹outöe
 );

99295 
i
=0; i<
nCﬁumn
; i++){

99296 
	`as£π
–
ªgRow
!=
pDe°
->
iSd°
+
i
 );

99297 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Cﬁumn
, 
p£udoTab
, 
i
, 
pDe°
->
iSd°
+i);

99298 if–
i
==0 ){

99299 
	`sqlôe3VdbeCh™geP5
(
v
, 
OPFLAG_CLEARCACHE
);

99302 if–
eDe°
==
SRT_Ouçut
 ){

99303 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Resu…Row
, 
pDe°
->
iSd°
, 
nCﬁumn
);

99304 
	`sqlôe3Ex¥CacheAfföôyCh™ge
(
pP¨£
, 
pDe°
->
iSd°
, 
nCﬁumn
);

99306 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Yõld
, 
pDe°
->
iSDP¨m
);

99311 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
ªgRow
);

99312 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
ªgRowid
);

99316 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
addrC⁄töue
);

99317 if–
p
->
£lFœgs
 & 
SF_U£S‹ãr
 ){

99318 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_S‹ãrNext
, 
iTab
, 
addr
);

99320 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Next
, 
iTab
, 
addr
);

99322 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
addrBªak
);

99323 if–
eDe°
==
SRT_Ouçut
 ||ÉDe°==
SRT_C‹outöe
 ){

99324 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Clo£
, 
p£udoTab
, 0);

99352 #ifde‡
SQLITE_ENABLE_COLUMN_METADATA


99353 
	#cﬁumnTy≥
(
A
,
B
,
C
,
D
,
E
,
F
Ë
	`cﬁumnTy≥Im∂
(A,B,C,D,E,F)

	)

99354 c⁄° *
	`cﬁumnTy≥Im∂
(

99355 
NameC⁄ãxt
 *
pNC
,

99356 
Ex¥
 *
pEx¥
,

99357 c⁄° **
pzOrigDb
,

99358 c⁄° **
pzOrigTab
,

99359 c⁄° **
pzOrigCﬁ
,

99360 
u8
 *
pE°Width


99362 c⁄° *
zOrigDb
 = 0;

99363 c⁄° *
zOrigTab
 = 0;

99364 c⁄° *
zOrigCﬁ
 = 0;

99366 
	#cﬁumnTy≥
(
A
,
B
,
C
,
D
,
E
,
F
Ë
	`cﬁumnTy≥Im∂
(A,B,F)

	)

99367 c⁄° *
	`cﬁumnTy≥Im∂
(

99368 
NameC⁄ãxt
 *
pNC
,

99369 
Ex¥
 *
pEx¥
,

99370 
u8
 *
pE°Width


99373 c⁄° *
zTy≥
 = 0;

99374 
j
;

99375 
u8
 
e°Width
 = 1;

99377 if–
	`NEVER
(
pEx¥
==0Ë|| 
pNC
->
pSrcLi°
==0 )  0;

99378  
pEx¥
->
›
 ){

99379 
TK_AGG_COLUMN
:

99380 
TK_COLUMN
: {

99385 
TabÀ
 *
pTab
 = 0;

99386 
Sñe˘
 *
pS
 = 0;

99387 
iCﬁ
 = 
pEx¥
->
iCﬁumn
;

99388 
	`ã°ˇ£
–
pEx¥
->
›
==
TK_AGG_COLUMN
 );

99389 
	`ã°ˇ£
–
pEx¥
->
›
==
TK_COLUMN
 );

99390  
pNC
 && !
pTab
 ){

99391 
SrcLi°
 *
pTabLi°
 = 
pNC
->
pSrcLi°
;

99392 
j
=0;j<
pTabLi°
->
nSrc
 &&ÖTabLi°->
a
[j].
iCurs‹
!=
pEx¥
->
iTabÀ
;j++);

99393 if–
j
<
pTabLi°
->
nSrc
 ){

99394 
pTab
 = 
pTabLi°
->
a
[
j
].pTab;

99395 
pS
 = 
pTabLi°
->
a
[
j
].
pSñe˘
;

99397 
pNC
 =ÖNC->
pNext
;

99401 if–
pTab
==0 ){

99422 
	`as£π
–
pTab
 && 
pEx¥
->pTab==pTab );

99423 if–
pS
 ){

99428 if–
iCﬁ
>=0 && 
	`ALWAYS
(iCﬁ<
pS
->
pELi°
->
nEx¥
) ){

99433 
NameC⁄ãxt
 
sNC
;

99434 
Ex¥
 *
p
 = 
pS
->
pELi°
->
a
[
iCﬁ
].
pEx¥
;

99435 
sNC
.
pSrcLi°
 = 
pS
->
pSrc
;

99436 
sNC
.
pNext
 = 
pNC
;

99437 
sNC
.
pP¨£
 = 
pNC
->pParse;

99438 
zTy≥
 = 
	`cﬁumnTy≥
(&
sNC
, 
p
,&
zOrigDb
,&
zOrigTab
,&
zOrigCﬁ
, &
e°Width
);

99440 }if–
	`ALWAYS
(
pTab
->
pSchema
) ){

99442 
	`as£π
–!
pS
 );

99443 if–
iCﬁ
<0 ) iCﬁ = 
pTab
->
iPKey
;

99444 
	`as£π
–
iCﬁ
==-1 || (iCﬁ>=0 && iCﬁ<
pTab
->
nCﬁ
) );

99445 #ifde‡
SQLITE_ENABLE_COLUMN_METADATA


99446 if–
iCﬁ
<0 ){

99447 
zTy≥
 = "INTEGER";

99448 
zOrigCﬁ
 = "rowid";

99450 
zTy≥
 = 
pTab
->
aCﬁ
[
iCﬁ
].zType;

99451 
zOrigCﬁ
 = 
pTab
->
aCﬁ
[
iCﬁ
].
zName
;

99452 
e°Width
 = 
pTab
->
aCﬁ
[
iCﬁ
].
szE°
;

99454 
zOrigTab
 = 
pTab
->
zName
;

99455 if–
pNC
->
pP¨£
 ){

99456 
iDb
 = 
	`sqlôe3SchemaToIndex
(
pNC
->
pP¨£
->
db
, 
pTab
->
pSchema
);

99457 
zOrigDb
 = 
pNC
->
pP¨£
->
db
->
aDb
[
iDb
].
zName
;

99460 if–
iCﬁ
<0 ){

99461 
zTy≥
 = "INTEGER";

99463 
zTy≥
 = 
pTab
->
aCﬁ
[
iCﬁ
].zType;

99464 
e°Width
 = 
pTab
->
aCﬁ
[
iCﬁ
].
szE°
;

99470 #i‚de‡
SQLITE_OMIT_SUBQUERY


99471 
TK_SELECT
: {

99476 
NameC⁄ãxt
 
sNC
;

99477 
Sñe˘
 *
pS
 = 
pEx¥
->
x
.
pSñe˘
;

99478 
Ex¥
 *
p
 = 
pS
->
pELi°
->
a
[0].
pEx¥
;

99479 
	`as£π
–
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_xIsSñe˘
) );

99480 
sNC
.
pSrcLi°
 = 
pS
->
pSrc
;

99481 
sNC
.
pNext
 = 
pNC
;

99482 
sNC
.
pP¨£
 = 
pNC
->pParse;

99483 
zTy≥
 = 
	`cﬁumnTy≥
(&
sNC
, 
p
, &
zOrigDb
, &
zOrigTab
, &
zOrigCﬁ
, &
e°Width
);

99489 #ifde‡
SQLITE_ENABLE_COLUMN_METADATA


99490 if–
pzOrigDb
 ){

99491 
	`as£π
–
pzOrigTab
 && 
pzOrigCﬁ
 );

99492 *
pzOrigDb
 = 
zOrigDb
;

99493 *
pzOrigTab
 = 
zOrigTab
;

99494 *
pzOrigCﬁ
 = 
zOrigCﬁ
;

99497 if–
pE°Width
 ) *pE°Width = 
e°Width
;

99498  
zTy≥
;

99505 
	`gíî©eCﬁumnTy≥s
(

99506 
P¨£
 *
pP¨£
,

99507 
SrcLi°
 *
pTabLi°
,

99508 
Ex¥Li°
 *
pELi°


99510 #i‚de‡
SQLITE_OMIT_DECLTYPE


99511 
Vdbe
 *
v
 = 
pP¨£
->
pVdbe
;

99512 
i
;

99513 
NameC⁄ãxt
 
sNC
;

99514 
sNC
.
pSrcLi°
 = 
pTabLi°
;

99515 
sNC
.
pP¨£
 =ÖParse;

99516 
i
=0; i<
pELi°
->
nEx¥
; i++){

99517 
Ex¥
 *
p
 = 
pELi°
->
a
[
i
].
pEx¥
;

99518 c⁄° *
zTy≥
;

99519 #ifde‡
SQLITE_ENABLE_COLUMN_METADATA


99520 c⁄° *
zOrigDb
 = 0;

99521 c⁄° *
zOrigTab
 = 0;

99522 c⁄° *
zOrigCﬁ
 = 0;

99523 
zTy≥
 = 
	`cﬁumnTy≥
(&
sNC
, 
p
, &
zOrigDb
, &
zOrigTab
, &
zOrigCﬁ
, 0);

99529 
	`sqlôe3VdbeSëCﬁName
(
v
, 
i
, 
COLNAME_DATABASE
, 
zOrigDb
, 
SQLITE_TRANSIENT
);

99530 
	`sqlôe3VdbeSëCﬁName
(
v
, 
i
, 
COLNAME_TABLE
, 
zOrigTab
, 
SQLITE_TRANSIENT
);

99531 
	`sqlôe3VdbeSëCﬁName
(
v
, 
i
, 
COLNAME_COLUMN
, 
zOrigCﬁ
, 
SQLITE_TRANSIENT
);

99533 
zTy≥
 = 
	`cﬁumnTy≥
(&
sNC
, 
p
, 0, 0, 0, 0);

99535 
	`sqlôe3VdbeSëCﬁName
(
v
, 
i
, 
COLNAME_DECLTYPE
, 
zTy≥
, 
SQLITE_TRANSIENT
);

99545 
	`gíî©eCﬁumnNames
(

99546 
P¨£
 *
pP¨£
,

99547 
SrcLi°
 *
pTabLi°
,

99548 
Ex¥Li°
 *
pELi°


99550 
Vdbe
 *
v
 = 
pP¨£
->
pVdbe
;

99551 
i
, 
j
;

99552 
sqlôe3
 *
db
 = 
pP¨£
->db;

99553 
fuŒNames
, 
sh‹tNames
;

99555 #i‚de‡
SQLITE_OMIT_EXPLAIN


99557 if–
pP¨£
->
ex∂aö
 ){

99562 if–
pP¨£
->
cﬁNamesSë
 || 
	`NEVER
(
v
==0Ë|| 
db
->
mÆlocFaûed
 ) ;

99563 
pP¨£
->
cﬁNamesSë
 = 1;

99564 
fuŒNames
 = (
db
->
Êags
 & 
SQLITE_FuŒCﬁNames
)!=0;

99565 
sh‹tNames
 = (
db
->
Êags
 & 
SQLITE_Sh‹tCﬁNames
)!=0;

99566 
	`sqlôe3VdbeSëNumCﬁs
(
v
, 
pELi°
->
nEx¥
);

99567 
i
=0; i<
pELi°
->
nEx¥
; i++){

99568 
Ex¥
 *
p
;

99569 
p
 = 
pELi°
->
a
[
i
].
pEx¥
;

99570 if–
	`NEVER
(
p
==0) ) ;

99571 if–
pELi°
->
a
[
i
].
zName
 ){

99572 *
zName
 = 
pELi°
->
a
[
i
].zName;

99573 
	`sqlôe3VdbeSëCﬁName
(
v
, 
i
, 
COLNAME_NAME
, 
zName
, 
SQLITE_TRANSIENT
);

99574 }if–(
p
->
›
==
TK_COLUMN
 ||Ö->›==
TK_AGG_COLUMN
Ë&& 
pTabLi°
 ){

99575 
TabÀ
 *
pTab
;

99576 *
zCﬁ
;

99577 
iCﬁ
 = 
p
->
iCﬁumn
;

99578 
j
=0; 
	`ALWAYS
(j<
pTabLi°
->
nSrc
); j++){

99579 if–
pTabLi°
->
a
[
j
].
iCurs‹
==
p
->
iTabÀ
 ) ;

99581 
	`as£π
–
j
<
pTabLi°
->
nSrc
 );

99582 
pTab
 = 
pTabLi°
->
a
[
j
].pTab;

99583 if–
iCﬁ
<0 ) iCﬁ = 
pTab
->
iPKey
;

99584 
	`as£π
–
iCﬁ
==-1 || (iCﬁ>=0 && iCﬁ<
pTab
->
nCﬁ
) );

99585 if–
iCﬁ
<0 ){

99586 
zCﬁ
 = "rowid";

99588 
zCﬁ
 = 
pTab
->
aCﬁ
[
iCﬁ
].
zName
;

99590 if–!
sh‹tNames
 && !
fuŒNames
 ){

99591 
	`sqlôe3VdbeSëCﬁName
(
v
, 
i
, 
COLNAME_NAME
,

99592 
	`sqlôe3DbSåDup
(
db
, 
pELi°
->
a
[
i
].
zS∑n
), 
SQLITE_DYNAMIC
);

99593 }if–
fuŒNames
 ){

99594 *
zName
 = 0;

99595 
zName
 = 
	`sqlôe3MPrötf
(
db
, "%s.%s", 
pTab
->zName, 
zCﬁ
);

99596 
	`sqlôe3VdbeSëCﬁName
(
v
, 
i
, 
COLNAME_NAME
, 
zName
, 
SQLITE_DYNAMIC
);

99598 
	`sqlôe3VdbeSëCﬁName
(
v
, 
i
, 
COLNAME_NAME
, 
zCﬁ
, 
SQLITE_TRANSIENT
);

99601 
	`sqlôe3VdbeSëCﬁName
(
v
, 
i
, 
COLNAME_NAME
,

99602 
	`sqlôe3DbSåDup
(
db
, 
pELi°
->
a
[
i
].
zS∑n
), 
SQLITE_DYNAMIC
);

99605 
	`gíî©eCﬁumnTy≥s
(
pP¨£
, 
pTabLi°
, 
pELi°
);

99621 
	`£À˘CﬁumnsFromEx¥Li°
(

99622 
P¨£
 *
pP¨£
,

99623 
Ex¥Li°
 *
pELi°
,

99624 
i16
 *
≤Cﬁ
,

99625 
Cﬁumn
 **
∑Cﬁ


99627 
sqlôe3
 *
db
 = 
pP¨£
->db;

99628 
i
, 
j
;

99629 
˙t
;

99630 
Cﬁumn
 *
aCﬁ
, *
pCﬁ
;

99631 
nCﬁ
;

99632 
Ex¥
 *
p
;

99633 *
zName
;

99634 
nName
;

99636 if–
pELi°
 ){

99637 
nCﬁ
 = 
pELi°
->
nEx¥
;

99638 
aCﬁ
 = 
	`sqlôe3DbMÆlocZîo
(
db
, ◊Cﬁ[0])*
nCﬁ
);

99639 
	`ã°ˇ£
–
aCﬁ
==0 );

99641 
nCﬁ
 = 0;

99642 
aCﬁ
 = 0;

99644 *
≤Cﬁ
 = 
nCﬁ
;

99645 *
∑Cﬁ
 = 
aCﬁ
;

99647 
i
=0, 
pCﬁ
=
aCﬁ
; i<
nCﬁ
; i++,ÖCol++){

99650 
p
 = 
	`sqlôe3Ex¥SkùCﬁœã
(
pELi°
->
a
[
i
].
pEx¥
);

99651 if–(
zName
 = 
pELi°
->
a
[
i
].zName)!=0 ){

99653 
zName
 = 
	`sqlôe3DbSåDup
(
db
, zName);

99655 
Ex¥
 *
pCﬁEx¥
 = 
p
;

99656 
TabÀ
 *
pTab
;

99657  
pCﬁEx¥
->
›
==
TK_DOT
 ){

99658 
pCﬁEx¥
 =ÖCﬁEx¥->
pRight
;

99659 
	`as£π
–
pCﬁEx¥
!=0 );

99661 if–
pCﬁEx¥
->
›
==
TK_COLUMN
 && 
	`ALWAYS
’CﬁEx¥->
pTab
!=0) ){

99663 
iCﬁ
 = 
pCﬁEx¥
->
iCﬁumn
;

99664 
pTab
 = 
pCﬁEx¥
->pTab;

99665 if–
iCﬁ
<0 ) iCﬁ = 
pTab
->
iPKey
;

99666 
zName
 = 
	`sqlôe3MPrötf
(
db
, "%s",

99667 
iCﬁ
>=0 ? 
pTab
->
aCﬁ
[iCﬁ].
zName
 : "rowid");

99668 }if–
pCﬁEx¥
->
›
==
TK_ID
 ){

99669 
	`as£π
–!
	`Ex¥HasPr›îty
(
pCﬁEx¥
, 
EP_I¡VÆue
) );

99670 
zName
 = 
	`sqlôe3MPrötf
(
db
, "%s", 
pCﬁEx¥
->
u
.
zTokí
);

99673 
zName
 = 
	`sqlôe3MPrötf
(
db
, "%s", 
pELi°
->
a
[
i
].
zS∑n
);

99676 if–
db
->
mÆlocFaûed
 ){

99677 
	`sqlôe3DbFªe
(
db
, 
zName
);

99684 
nName
 = 
	`sqlôe3SåÀn30
(
zName
);

99685 
j
=
˙t
=0; j<
i
; j++){

99686 if–
	`sqlôe3SåICmp
(
aCﬁ
[
j
].
zName
, zName)==0 ){

99687 *
zNewName
;

99688 
k
;

99689 
k
=
nName
-1; k>1 && 
	`sqlôe3Isdigô
(
zName
[k]); k--){}

99690 if–
zName
[
k
]==':' ) 
nName
 = k;

99691 
zName
[
nName
] = 0;

99692 
zNewName
 = 
	`sqlôe3MPrötf
(
db
, "%s:%d", 
zName
, ++
˙t
);

99693 
	`sqlôe3DbFªe
(
db
, 
zName
);

99694 
zName
 = 
zNewName
;

99695 
j
 = -1;

99696 if–
zName
==0 ) ;

99699 
pCﬁ
->
zName
 = zName;

99701 if–
db
->
mÆlocFaûed
 ){

99702 
j
=0; j<
i
; j++){

99703 
	`sqlôe3DbFªe
(
db
, 
aCﬁ
[
j
].
zName
);

99705 
	`sqlôe3DbFªe
(
db
, 
aCﬁ
);

99706 *
∑Cﬁ
 = 0;

99707 *
≤Cﬁ
 = 0;

99708  
SQLITE_NOMEM
;

99710  
SQLITE_OK
;

99724 
	`£À˘AddCﬁumnTy≥AndCﬁœti⁄
(

99725 
P¨£
 *
pP¨£
,

99726 
TabÀ
 *
pTab
,

99727 
Sñe˘
 *
pSñe˘


99729 
sqlôe3
 *
db
 = 
pP¨£
->db;

99730 
NameC⁄ãxt
 
sNC
;

99731 
Cﬁumn
 *
pCﬁ
;

99732 
CﬁlSeq
 *
pCﬁl
;

99733 
i
;

99734 
Ex¥
 *
p
;

99735 
Ex¥Li°_ôem
 *
a
;

99736 
u64
 
szAŒ
 = 0;

99738 
	`as£π
–
pSñe˘
!=0 );

99739 
	`as£π
–(
pSñe˘
->
£lFœgs
 & 
SF_Resﬁved
)!=0 );

99740 
	`as£π
–
pTab
->
nCﬁ
==
pSñe˘
->
pELi°
->
nEx¥
 || 
db
->
mÆlocFaûed
 );

99741 if–
db
->
mÆlocFaûed
 ) ;

99742 
	`mem£t
(&
sNC
, 0, (sNC));

99743 
sNC
.
pSrcLi°
 = 
pSñe˘
->
pSrc
;

99744 
a
 = 
pSñe˘
->
pELi°
->a;

99745 
i
=0, 
pCﬁ
=
pTab
->
aCﬁ
; i<pTab->
nCﬁ
; i++,ÖCol++){

99746 
p
 = 
a
[
i
].
pEx¥
;

99747 
pCﬁ
->
zTy≥
 = 
	`sqlôe3DbSåDup
(
db
, 
	`cﬁumnTy≥
(&
sNC
, 
p
,0,0,0, &pCﬁ->
szE°
));

99748 
szAŒ
 +
pCﬁ
->
szE°
;

99749 
pCﬁ
->
afföôy
 = 
	`sqlôe3Ex¥Afföôy
(
p
);

99750 if–
pCﬁ
->
afföôy
==0 )ÖCﬁ->afföôy = 
SQLITE_AFF_NONE
;

99751 
pCﬁl
 = 
	`sqlôe3Ex¥CﬁlSeq
(
pP¨£
, 
p
);

99752 if–
pCﬁl
 ){

99753 
pCﬁ
->
zCﬁl
 = 
	`sqlôe3DbSåDup
(
db
, 
pCﬁl
->
zName
);

99756 
pTab
->
szTabRow
 = 
	`sqlôe3LogE°
(
szAŒ
*4);

99763 
SQLITE_PRIVATE
 
TabÀ
 *
	`sqlôe3Resu…SëOfSñe˘
(
P¨£
 *
pP¨£
, 
Sñe˘
 *
pSñe˘
){

99764 
TabÀ
 *
pTab
;

99765 
sqlôe3
 *
db
 = 
pP¨£
->db;

99766 
ßvedFœgs
;

99768 
ßvedFœgs
 = 
db
->
Êags
;

99769 
db
->
Êags
 &~
SQLITE_FuŒCﬁNames
;

99770 
db
->
Êags
 |
SQLITE_Sh‹tCﬁNames
;

99771 
	`sqlôe3Sñe˘Pªp
(
pP¨£
, 
pSñe˘
, 0);

99772 if–
pP¨£
->
nEº
 )  0;

99773  
pSñe˘
->
pPri‹
 )ÖSelect =ÖSelect->pPrior;

99774 
db
->
Êags
 = 
ßvedFœgs
;

99775 
pTab
 = 
	`sqlôe3DbMÆlocZîo
(
db
, (
TabÀ
) );

99776 if–
pTab
==0 ){

99781 
	`as£π
–
db
->
lookaside
.
bE«bÀd
==0 );

99782 
pTab
->
nRef
 = 1;

99783 
pTab
->
zName
 = 0;

99784 
pTab
->
nRowE°
 = 1048576;

99785 
	`£À˘CﬁumnsFromEx¥Li°
(
pP¨£
, 
pSñe˘
->
pELi°
, &
pTab
->
nCﬁ
, &pTab->
aCﬁ
);

99786 
	`£À˘AddCﬁumnTy≥AndCﬁœti⁄
(
pP¨£
, 
pTab
, 
pSñe˘
);

99787 
pTab
->
iPKey
 = -1;

99788 if–
db
->
mÆlocFaûed
 ){

99789 
	`sqlôe3DñëeTabÀ
(
db
, 
pTab
);

99792  
pTab
;

99799 
SQLITE_PRIVATE
 
Vdbe
 *
	`sqlôe3GëVdbe
(
P¨£
 *
pP¨£
){

99800 
Vdbe
 *
v
 = 
pP¨£
->
pVdbe
;

99801 if–
v
==0 ){

99802 
v
 = 
pP¨£
->
pVdbe
 = 
	`sqlôe3VdbeCª©e
’P¨£->
db
);

99803 #i‚de‡
SQLITE_OMIT_TRACE


99804 if–
v
 ){

99805 
	`sqlôe3VdbeAddOp0
(
v
, 
OP_Tø˚
);

99809  
v
;

99831 
	`compuãLimôRegi°îs
(
P¨£
 *
pP¨£
, 
Sñe˘
 *
p
, 
iBªak
){

99832 
Vdbe
 *
v
 = 0;

99833 
iLimô
 = 0;

99834 
iOff£t
;

99835 
addr1
, 
n
;

99836 if–
p
->
iLimô
 ) ;

99844 
	`sqlôe3Ex¥CacheCÀ¨
(
pP¨£
);

99845 
	`as£π
–
p
->
pOff£t
==0 ||Ö->
pLimô
!=0 );

99846 if–
p
->
pLimô
 ){

99847 
p
->
iLimô
 = iLimô = ++
pP¨£
->
nMem
;

99848 
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

99849 if–
	`NEVER
(
v
==0) ) ;

99850 if–
	`sqlôe3Ex¥IsI¡egî
(
p
->
pLimô
, &
n
) ){

99851 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 
n
, 
iLimô
);

99852 
	`VdbeCommít
((
v
, "LIMIT counter"));

99853 if–
n
==0 ){

99854 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_GŸo
, 0, 
iBªak
);

99855 }if–
n
>=0 && 
p
->
nSñe˘Row
>(
u64
)n ){

99856 
p
->
nSñe˘Row
 = 
n
;

99859 
	`sqlôe3Ex¥Code
(
pP¨£
, 
p
->
pLimô
, 
iLimô
);

99860 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Mu°BeI¡
, 
iLimô
);

99861 
	`VdbeCommít
((
v
, "LIMIT counter"));

99862 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_IfZîo
, 
iLimô
, 
iBªak
);

99864 if–
p
->
pOff£t
 ){

99865 
p
->
iOff£t
 = iOff£à++
pP¨£
->
nMem
;

99866 
pP¨£
->
nMem
++;

99867 
	`sqlôe3Ex¥Code
(
pP¨£
, 
p
->
pOff£t
, 
iOff£t
);

99868 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Mu°BeI¡
, 
iOff£t
);

99869 
	`VdbeCommít
((
v
, "OFFSET counter"));

99870 
addr1
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_IfPos
, 
iOff£t
);

99871 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 0, 
iOff£t
);

99872 
	`sqlôe3VdbeJumpHîe
(
v
, 
addr1
);

99873 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Add
, 
iLimô
, 
iOff£t
, iOffset+1);

99874 
	`VdbeCommít
((
v
, "LIMIT+OFFSET"));

99875 
addr1
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_IfPos
, 
iLimô
);

99876 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, -1, 
iOff£t
+1);

99877 
	`sqlôe3VdbeJumpHîe
(
v
, 
addr1
);

99882 #i‚de‡
SQLITE_OMIT_COMPOUND_SELECT


99891 
CﬁlSeq
 *
	`mu…iSñe˘CﬁlSeq
(
P¨£
 *
pP¨£
, 
Sñe˘
 *
p
, 
iCﬁ
){

99892 
CﬁlSeq
 *
pRë
;

99893 if–
p
->
pPri‹
 ){

99894 
pRë
 = 
	`mu…iSñe˘CﬁlSeq
(
pP¨£
, 
p
->
pPri‹
, 
iCﬁ
);

99896 
pRë
 = 0;

99898 
	`as£π
–
iCﬁ
>=0 );

99899 if–
pRë
==0 && 
iCﬁ
<
p
->
pELi°
->
nEx¥
 ){

99900 
pRë
 = 
	`sqlôe3Ex¥CﬁlSeq
(
pP¨£
, 
p
->
pELi°
->
a
[
iCﬁ
].
pEx¥
);

99902  
pRë
;

99907 
	`mu…iSñe˘OrdîBy
(

99908 
P¨£
 *
pP¨£
,

99909 
Sñe˘
 *
p
,

99910 
Sñe˘De°
 *
pDe°


99914 #i‚de‡
SQLITE_OMIT_COMPOUND_SELECT


99946 
	`mu…iSñe˘
(

99947 
P¨£
 *
pP¨£
,

99948 
Sñe˘
 *
p
,

99949 
Sñe˘De°
 *
pDe°


99951 
rc
 = 
SQLITE_OK
;

99952 
Sñe˘
 *
pPri‹
;

99953 
Vdbe
 *
v
;

99954 
Sñe˘De°
 
de°
;

99955 
Sñe˘
 *
pDñëe
 = 0;

99956 
sqlôe3
 *
db
;

99957 #i‚de‡
SQLITE_OMIT_EXPLAIN


99958 
iSub1
;

99959 
iSub2
;

99965 
	`as£π
–
p
 &&Ö->
pPri‹
 );

99966 
db
 = 
pP¨£
->db;

99967 
pPri‹
 = 
p
->pPrior;

99968 
	`as£π
–
pPri‹
->
pRightmo°
!=pPrior );

99969 
	`as£π
–
pPri‹
->
pRightmo°
==
p
->pRightmost );

99970 
de°
 = *
pDe°
;

99971 if–
pPri‹
->
pOrdîBy
 ){

99972 
	`sqlôe3Eº‹Msg
(
pP¨£
,"ORDER BY clause should comeáfter %sÇot before",

99973 
	`£À˘OpName
(
p
->
›
));

99974 
rc
 = 1;

99975 
mu…i_£À˘_íd
;

99977 if–
pPri‹
->
pLimô
 ){

99978 
	`sqlôe3Eº‹Msg
(
pP¨£
,"LIMIT clause should comeáfter %sÇot before",

99979 
	`£À˘OpName
(
p
->
›
));

99980 
rc
 = 1;

99981 
mu…i_£À˘_íd
;

99984 
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

99985 
	`as£π
–
v
!=0 );

99989 if–
de°
.
eDe°
==
SRT_EphemTab
 ){

99990 
	`as£π
–
p
->
pELi°
 );

99991 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_O≥nEphemîÆ
, 
de°
.
iSDP¨m
, 
p
->
pELi°
->
nEx¥
);

99992 
	`sqlôe3VdbeCh™geP5
(
v
, 
BTREE_UNORDERED
);

99993 
de°
.
eDe°
 = 
SRT_TabÀ
;

99999 
	`as£π
–
p
->
pELi°
 && 
pPri‹
->pEList );

100000 if–
p
->
pELi°
->
nEx¥
!=
pPri‹
->pEList->nExpr ){

100001 if–
p
->
£lFœgs
 & 
SF_VÆues
 ){

100002 
	`sqlôe3Eº‹Msg
(
pP¨£
, "all VALUES must haveÅhe sameÇumber ofÅerms");

100004 
	`sqlôe3Eº‹Msg
(
pP¨£
, "SELECTsÅoÅheÜeftándÑight of %s"

100005 " dÿnŸ havêthêßmênumbî o‡ªsu… cﬁumns", 
	`£À˘OpName
(
p
->
›
));

100007 
rc
 = 1;

100008 
mu…i_£À˘_íd
;

100013 if–
p
->
pOrdîBy
 ){

100014  
	`mu…iSñe˘OrdîBy
(
pP¨£
, 
p
, 
pDe°
);

100019  
p
->
›
 ){

100020 
TK_ALL
: {

100021 
addr
 = 0;

100022 
nLimô
;

100023 
	`as£π
–!
pPri‹
->
pLimô
 );

100024 
pPri‹
->
iLimô
 = 
p
->iLimit;

100025 
pPri‹
->
iOff£t
 = 
p
->iOffset;

100026 
pPri‹
->
pLimô
 = 
p
->pLimit;

100027 
pPri‹
->
pOff£t
 = 
p
->pOffset;

100028 
	`ex∂aöSëI¡egî
(
iSub1
, 
pP¨£
->
iNextSñe˘Id
);

100029 
rc
 = 
	`sqlôe3Sñe˘
(
pP¨£
, 
pPri‹
, &
de°
);

100030 
p
->
pLimô
 = 0;

100031 
p
->
pOff£t
 = 0;

100032 if–
rc
 ){

100033 
mu…i_£À˘_íd
;

100035 
p
->
pPri‹
 = 0;

100036 
p
->
iLimô
 = 
pPri‹
->iLimit;

100037 
p
->
iOff£t
 = 
pPri‹
->iOffset;

100038 if–
p
->
iLimô
 ){

100039 
addr
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_IfZîo
, 
p
->
iLimô
);

100040 
	`VdbeCommít
((
v
, "Jumpáhead if LIMITÑeached"));

100042 
	`ex∂aöSëI¡egî
(
iSub2
, 
pP¨£
->
iNextSñe˘Id
);

100043 
rc
 = 
	`sqlôe3Sñe˘
(
pP¨£
, 
p
, &
de°
);

100044 
	`ã°ˇ£
–
rc
!=
SQLITE_OK
 );

100045 
pDñëe
 = 
p
->
pPri‹
;

100046 
p
->
pPri‹
 =ÖPrior;

100047 
p
->
nSñe˘Row
 +
pPri‹
->nSelectRow;

100048 if–
pPri‹
->
pLimô


100049 && 
	`sqlôe3Ex¥IsI¡egî
(
pPri‹
->
pLimô
, &
nLimô
)

100050 && 
nLimô
>0 && 
p
->
nSñe˘Row
 > (
u64
)nLimit

100052 
p
->
nSñe˘Row
 = 
nLimô
;

100054 if–
addr
 ){

100055 
	`sqlôe3VdbeJumpHîe
(
v
, 
addr
);

100059 
TK_EXCEPT
:

100060 
TK_UNION
: {

100061 
uni⁄Tab
;

100062 
u8
 
›
 = 0;

100063 
¥i‹Op
;

100064 
Ex¥
 *
pLimô
, *
pOff£t
;

100065 
addr
;

100066 
Sñe˘De°
 
uni⁄de°
;

100068 
	`ã°ˇ£
–
p
->
›
==
TK_EXCEPT
 );

100069 
	`ã°ˇ£
–
p
->
›
==
TK_UNION
 );

100070 
¥i‹Op
 = 
SRT_Uni⁄
;

100071 if–
de°
.
eDe°
==
¥i‹Op
 && 
	`ALWAYS
(!
p
->
pLimô
 &&!p->
pOff£t
) ){

100075 
	`as£π
–
p
->
pRightmo°
!=p );

100077 
	`as£π
–
p
->
pLimô
==0 );

100078 
	`as£π
–
p
->
pOff£t
==0 );

100079 
uni⁄Tab
 = 
de°
.
iSDP¨m
;

100084 
uni⁄Tab
 = 
pP¨£
->
nTab
++;

100085 
	`as£π
–
p
->
pOrdîBy
==0 );

100086 
addr
 = 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_O≥nEphemîÆ
, 
uni⁄Tab
, 0);

100087 
	`as£π
–
p
->
addrO≥nEphm
[0] == -1 );

100088 
p
->
addrO≥nEphm
[0] = 
addr
;

100089 
p
->
pRightmo°
->
£lFœgs
 |
SF_U£sEphemîÆ
;

100090 
	`as£π
–
p
->
pELi°
 );

100095 
	`as£π
–!
pPri‹
->
pOrdîBy
 );

100096 
	`sqlôe3Sñe˘De°Inô
(&
uni⁄de°
, 
¥i‹Op
, 
uni⁄Tab
);

100097 
	`ex∂aöSëI¡egî
(
iSub1
, 
pP¨£
->
iNextSñe˘Id
);

100098 
rc
 = 
	`sqlôe3Sñe˘
(
pP¨£
, 
pPri‹
, &
uni⁄de°
);

100099 if–
rc
 ){

100100 
mu…i_£À˘_íd
;

100105 if–
p
->
›
==
TK_EXCEPT
 ){

100106 
›
 = 
SRT_Ex˚±
;

100108 
	`as£π
–
p
->
›
==
TK_UNION
 );

100109 
›
 = 
SRT_Uni⁄
;

100111 
p
->
pPri‹
 = 0;

100112 
pLimô
 = 
p
->pLimit;

100113 
p
->
pLimô
 = 0;

100114 
pOff£t
 = 
p
->pOffset;

100115 
p
->
pOff£t
 = 0;

100116 
uni⁄de°
.
eDe°
 = 
›
;

100117 
	`ex∂aöSëI¡egî
(
iSub2
, 
pP¨£
->
iNextSñe˘Id
);

100118 
rc
 = 
	`sqlôe3Sñe˘
(
pP¨£
, 
p
, &
uni⁄de°
);

100119 
	`ã°ˇ£
–
rc
!=
SQLITE_OK
 );

100122 
	`sqlôe3Ex¥Li°Dñëe
(
db
, 
p
->
pOrdîBy
);

100123 
pDñëe
 = 
p
->
pPri‹
;

100124 
p
->
pPri‹
 =ÖPrior;

100125 
p
->
pOrdîBy
 = 0;

100126 if–
p
->
›
==
TK_UNION
 )Ö->
nSñe˘Row
 +
pPri‹
->nSelectRow;

100127 
	`sqlôe3Ex¥Dñëe
(
db
, 
p
->
pLimô
);

100128 
p
->
pLimô
 =ÖLimit;

100129 
p
->
pOff£t
 =ÖOffset;

100130 
p
->
iLimô
 = 0;

100131 
p
->
iOff£t
 = 0;

100136 
	`as£π
–
uni⁄Tab
==
de°
.
iSDP¨m
 || de°.
eDe°
!=
¥i‹Op
 );

100137 if–
de°
.
eDe°
!=
¥i‹Op
 ){

100138 
iC⁄t
, 
iBªak
, 
iSèπ
;

100139 
	`as£π
–
p
->
pELi°
 );

100140 if–
de°
.
eDe°
==
SRT_Ouçut
 ){

100141 
Sñe˘
 *
pFú°
 = 
p
;

100142  
pFú°
->
pPri‹
 )ÖFirst =ÖFirst->pPrior;

100143 
	`gíî©eCﬁumnNames
(
pP¨£
, 0, 
pFú°
->
pELi°
);

100145 
iBªak
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

100146 
iC⁄t
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

100147 
	`compuãLimôRegi°îs
(
pP¨£
, 
p
, 
iBªak
);

100148 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Rewöd
, 
uni⁄Tab
, 
iBªak
);

100149 
iSèπ
 = 
	`sqlôe3VdbeCuºítAddr
(
v
);

100150 
	`£À˘I¬îLo›
(
pP¨£
, 
p
,Ö->
pELi°
, 
uni⁄Tab
,Ö->pELi°->
nEx¥
,

100151 0, 0, &
de°
, 
iC⁄t
, 
iBªak
);

100152 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
iC⁄t
);

100153 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Next
, 
uni⁄Tab
, 
iSèπ
);

100154 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
iBªak
);

100155 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Clo£
, 
uni⁄Tab
, 0);

100159 : 
	`as£π
–
p
->
›
==
TK_INTERSECT
 ); {

100160 
èb1
, 
èb2
;

100161 
iC⁄t
, 
iBªak
, 
iSèπ
;

100162 
Ex¥
 *
pLimô
, *
pOff£t
;

100163 
addr
;

100164 
Sñe˘De°
 
öãr£˘de°
;

100165 
r1
;

100171 
èb1
 = 
pP¨£
->
nTab
++;

100172 
èb2
 = 
pP¨£
->
nTab
++;

100173 
	`as£π
–
p
->
pOrdîBy
==0 );

100175 
addr
 = 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_O≥nEphemîÆ
, 
èb1
, 0);

100176 
	`as£π
–
p
->
addrO≥nEphm
[0] == -1 );

100177 
p
->
addrO≥nEphm
[0] = 
addr
;

100178 
p
->
pRightmo°
->
£lFœgs
 |
SF_U£sEphemîÆ
;

100179 
	`as£π
–
p
->
pELi°
 );

100183 
	`sqlôe3Sñe˘De°Inô
(&
öãr£˘de°
, 
SRT_Uni⁄
, 
èb1
);

100184 
	`ex∂aöSëI¡egî
(
iSub1
, 
pP¨£
->
iNextSñe˘Id
);

100185 
rc
 = 
	`sqlôe3Sñe˘
(
pP¨£
, 
pPri‹
, &
öãr£˘de°
);

100186 if–
rc
 ){

100187 
mu…i_£À˘_íd
;

100192 
addr
 = 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_O≥nEphemîÆ
, 
èb2
, 0);

100193 
	`as£π
–
p
->
addrO≥nEphm
[1] == -1 );

100194 
p
->
addrO≥nEphm
[1] = 
addr
;

100195 
p
->
pPri‹
 = 0;

100196 
pLimô
 = 
p
->pLimit;

100197 
p
->
pLimô
 = 0;

100198 
pOff£t
 = 
p
->pOffset;

100199 
p
->
pOff£t
 = 0;

100200 
öãr£˘de°
.
iSDP¨m
 = 
èb2
;

100201 
	`ex∂aöSëI¡egî
(
iSub2
, 
pP¨£
->
iNextSñe˘Id
);

100202 
rc
 = 
	`sqlôe3Sñe˘
(
pP¨£
, 
p
, &
öãr£˘de°
);

100203 
	`ã°ˇ£
–
rc
!=
SQLITE_OK
 );

100204 
pDñëe
 = 
p
->
pPri‹
;

100205 
p
->
pPri‹
 =ÖPrior;

100206 if–
p
->
nSñe˘Row
>
pPri‹
->nSelectRow )Ö->nSelectRow =ÖPrior->nSelectRow;

100207 
	`sqlôe3Ex¥Dñëe
(
db
, 
p
->
pLimô
);

100208 
p
->
pLimô
 =ÖLimit;

100209 
p
->
pOff£t
 =ÖOffset;

100214 
	`as£π
–
p
->
pELi°
 );

100215 if–
de°
.
eDe°
==
SRT_Ouçut
 ){

100216 
Sñe˘
 *
pFú°
 = 
p
;

100217  
pFú°
->
pPri‹
 )ÖFirst =ÖFirst->pPrior;

100218 
	`gíî©eCﬁumnNames
(
pP¨£
, 0, 
pFú°
->
pELi°
);

100220 
iBªak
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

100221 
iC⁄t
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

100222 
	`compuãLimôRegi°îs
(
pP¨£
, 
p
, 
iBªak
);

100223 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Rewöd
, 
èb1
, 
iBªak
);

100224 
r1
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

100225 
iSèπ
 = 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_RowKey
, 
èb1
, 
r1
);

100226 
	`sqlôe3VdbeAddOp4I¡
(
v
, 
OP_NŸFound
, 
èb2
, 
iC⁄t
, 
r1
, 0);

100227 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
r1
);

100228 
	`£À˘I¬îLo›
(
pP¨£
, 
p
,Ö->
pELi°
, 
èb1
,Ö->pELi°->
nEx¥
,

100229 0, 0, &
de°
, 
iC⁄t
, 
iBªak
);

100230 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
iC⁄t
);

100231 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Next
, 
èb1
, 
iSèπ
);

100232 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
iBªak
);

100233 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Clo£
, 
èb2
, 0);

100234 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Clo£
, 
èb1
, 0);

100239 
	`ex∂aöComposôe
(
pP¨£
, 
p
->
›
, 
iSub1
, 
iSub2
,Ö->›!=
TK_ALL
);

100250 if–
p
->
£lFœgs
 & 
SF_U£sEphemîÆ
 ){

100251 
i
;

100252 
KeyInfo
 *
pKeyInfo
;

100253 
Sñe˘
 *
pLo›
;

100254 
CﬁlSeq
 **
≠Cﬁl
;

100255 
nCﬁ
;

100257 
	`as£π
–
p
->
pRightmo°
==p );

100258 
nCﬁ
 = 
p
->
pELi°
->
nEx¥
;

100259 
pKeyInfo
 = 
	`sqlôe3KeyInfoAŒoc
(
db
, 
nCﬁ
);

100260 if–!
pKeyInfo
 ){

100261 
rc
 = 
SQLITE_NOMEM
;

100262 
mu…i_£À˘_íd
;

100264 
i
=0, 
≠Cﬁl
=
pKeyInfo
->
aCﬁl
; i<
nCﬁ
; i++,ápColl++){

100265 *
≠Cﬁl
 = 
	`mu…iSñe˘CﬁlSeq
(
pP¨£
, 
p
, 
i
);

100266 if–0==*
≠Cﬁl
 ){

100267 *
≠Cﬁl
 = 
db
->
pDÊtCﬁl
;

100271 
pLo›
=
p
;ÖLo›;ÖLo›ıLo›->
pPri‹
){

100272 
i
=0; i<2; i++){

100273 
addr
 = 
pLo›
->
addrO≥nEphm
[
i
];

100274 if–
addr
<0 ){

100277 
	`as£π
–
pLo›
->
addrO≥nEphm
[1]<0 );

100280 
	`sqlôe3VdbeCh™geP2
(
v
, 
addr
, 
nCﬁ
);

100281 
	`sqlôe3VdbeCh™geP4
(
v
, 
addr
, (*)
pKeyInfo
, 
P4_KEYINFO
);

100282 
pLo›
->
addrO≥nEphm
[
i
] = -1;

100285 
	`sqlôe3DbFªe
(
db
, 
pKeyInfo
);

100288 
mu…i_£À˘_íd
:

100289 
pDe°
->
iSd°
 = 
de°
.iSdst;

100290 
pDe°
->
nSd°
 = 
de°
.nSdst;

100291 
	`sqlôe3Sñe˘Dñëe
(
db
, 
pDñëe
);

100292  
rc
;

100316 
	`gíî©eOuçutSubroutöe
(

100317 
P¨£
 *
pP¨£
,

100318 
Sñe˘
 *
p
,

100319 
Sñe˘De°
 *
pIn
,

100320 
Sñe˘De°
 *
pDe°
,

100321 
ªgRëu∫
,

100322 
ªgPªv
,

100323 
KeyInfo
 *
pKeyInfo
,

100324 
p4ty≥
,

100325 
iBªak


100327 
Vdbe
 *
v
 = 
pP¨£
->
pVdbe
;

100328 
iC⁄töue
;

100329 
addr
;

100331 
addr
 = 
	`sqlôe3VdbeCuºítAddr
(
v
);

100332 
iC⁄töue
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

100336 if–
ªgPªv
 ){

100337 
j1
, 
j2
;

100338 
j1
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_IfNŸ
, 
ªgPªv
);

100339 
j2
 = 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Com∑ª
, 
pIn
->
iSd°
, 
ªgPªv
+1,ÖIn->
nSd°
,

100340 (*)
pKeyInfo
, 
p4ty≥
);

100341 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Jump
, 
j2
+2, 
iC⁄töue
, j2+2);

100342 
	`sqlôe3VdbeJumpHîe
(
v
, 
j1
);

100343 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_C›y
, 
pIn
->
iSd°
, 
ªgPªv
+1,ÖIn->
nSd°
-1);

100344 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 1, 
ªgPªv
);

100346 if–
pP¨£
->
db
->
mÆlocFaûed
 )  0;

100350 
	`codeOff£t
(
v
, 
p
, 
iC⁄töue
);

100352  
pDe°
->
eDe°
 ){

100355 
SRT_TabÀ
:

100356 
SRT_EphemTab
: {

100357 
r1
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

100358 
r2
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

100359 
	`ã°ˇ£
–
pDe°
->
eDe°
==
SRT_TabÀ
 );

100360 
	`ã°ˇ£
–
pDe°
->
eDe°
==
SRT_EphemTab
 );

100361 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_MakeRec‹d
, 
pIn
->
iSd°
,ÖIn->
nSd°
, 
r1
);

100362 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NewRowid
, 
pDe°
->
iSDP¨m
, 
r2
);

100363 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_In£π
, 
pDe°
->
iSDP¨m
, 
r1
, 
r2
);

100364 
	`sqlôe3VdbeCh™geP5
(
v
, 
OPFLAG_APPEND
);

100365 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
r2
);

100366 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
r1
);

100370 #i‚de‡
SQLITE_OMIT_SUBQUERY


100375 
SRT_Së
: {

100376 
r1
;

100377 
	`as£π
–
pIn
->
nSd°
==1 );

100378 
pDe°
->
affSd°
 =

100379 
	`sqlôe3Com∑ªAfföôy
(
p
->
pELi°
->
a
[0].
pEx¥
, 
pDe°
->
affSd°
);

100380 
r1
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

100381 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_MakeRec‹d
, 
pIn
->
iSd°
, 1, 
r1
, &
pDe°
->
affSd°
,1);

100382 
	`sqlôe3Ex¥CacheAfföôyCh™ge
(
pP¨£
, 
pIn
->
iSd°
, 1);

100383 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_IdxIn£π
, 
pDe°
->
iSDP¨m
, 
r1
);

100384 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
r1
);

100391 
SRT_Exi°s
: {

100392 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 1, 
pDe°
->
iSDP¨m
);

100402 
SRT_Mem
: {

100403 
	`as£π
–
pIn
->
nSd°
==1 );

100404 
	`sqlôe3Ex¥CodeMove
(
pP¨£
, 
pIn
->
iSd°
, 
pDe°
->
iSDP¨m
, 1);

100413 
SRT_C‹outöe
: {

100414 if–
pDe°
->
iSd°
==0 ){

100415 
pDe°
->
iSd°
 = 
	`sqlôe3GëTempR™ge
(
pP¨£
, 
pIn
->
nSd°
);

100416 
pDe°
->
nSd°
 = 
pIn
->nSdst;

100418 
	`sqlôe3Ex¥CodeMove
(
pP¨£
, 
pIn
->
iSd°
, 
pDe°
->iSd°,ÖDe°->
nSd°
);

100419 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Yõld
, 
pDe°
->
iSDP¨m
);

100432 
	`as£π
–
pDe°
->
eDe°
==
SRT_Ouçut
 );

100433 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Resu…Row
, 
pIn
->
iSd°
,ÖIn->
nSd°
);

100434 
	`sqlôe3Ex¥CacheAfföôyCh™ge
(
pP¨£
, 
pIn
->
iSd°
,ÖIn->
nSd°
);

100441 if–
p
->
iLimô
 ){

100442 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_IfZîo
, 
p
->
iLimô
, 
iBªak
, -1);

100447 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
iC⁄töue
);

100448 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Rëu∫
, 
ªgRëu∫
);

100450  
addr
;

100538 #i‚de‡
SQLITE_OMIT_COMPOUND_SELECT


100539 
	`mu…iSñe˘OrdîBy
(

100540 
P¨£
 *
pP¨£
,

100541 
Sñe˘
 *
p
,

100542 
Sñe˘De°
 *
pDe°


100544 
i
, 
j
;

100545 
Sñe˘
 *
pPri‹
;

100546 
Vdbe
 *
v
;

100547 
Sñe˘De°
 
de°A
;

100548 
Sñe˘De°
 
de°B
;

100549 
ªgAddrA
;

100550 
ªgEofA
;

100551 
ªgAddrB
;

100552 
ªgEofB
;

100553 
addrSñe˘A
;

100554 
addrSñe˘B
;

100555 
ªgOutA
;

100556 
ªgOutB
;

100557 
addrOutA
;

100558 
addrOutB
 = 0;

100559 
addrEofA
;

100560 
addrEofB
;

100561 
addrA…B
;

100562 
addrAeqB
;

100563 
addrAgtB
;

100564 
ªgLimôA
;

100565 
ªgLimôB
;

100566 
ªgPªv
;

100567 
ßvedLimô
;

100568 
ßvedOff£t
;

100569 
œbñCm¥
;

100570 
œbñEnd
;

100571 
j1
;

100572 
›
;

100573 
KeyInfo
 *
pKeyDup
 = 0;

100574 
KeyInfo
 *
pKeyMîge
;

100575 
sqlôe3
 *
db
;

100576 
Ex¥Li°
 *
pOrdîBy
;

100577 
nOrdîBy
;

100578 *
aPîmuã
;

100579 #i‚de‡
SQLITE_OMIT_EXPLAIN


100580 
iSub1
;

100581 
iSub2
;

100584 
	`as£π
–
p
->
pOrdîBy
!=0 );

100585 
	`as£π
–
pKeyDup
==0 );

100586 
db
 = 
pP¨£
->db;

100587 
v
 = 
pP¨£
->
pVdbe
;

100588 
	`as£π
–
v
!=0 );

100589 
œbñEnd
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

100590 
œbñCm¥
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

100595 
›
 = 
p
->op;

100596 
pPri‹
 = 
p
->pPrior;

100597 
	`as£π
–
pPri‹
->
pOrdîBy
==0 );

100598 
pOrdîBy
 = 
p
->pOrderBy;

100599 
	`as£π
–
pOrdîBy
 );

100600 
nOrdîBy
 = 
pOrdîBy
->
nEx¥
;

100606 if–
›
!=
TK_ALL
 ){

100607 
i
=1; 
db
->
mÆlocFaûed
==0 && i<=
p
->
pELi°
->
nEx¥
; i++){

100608 
Ex¥Li°_ôem
 *
pIãm
;

100609 
j
=0, 
pIãm
=
pOrdîBy
->
a
; j<
nOrdîBy
; j++,ÖItem++){

100610 
	`as£π
–
pIãm
->
iOrdîByCﬁ
>0 );

100611 if–
pIãm
->
iOrdîByCﬁ
==
i
 ) ;

100613 if–
j
==
nOrdîBy
 ){

100614 
Ex¥
 *
pNew
 = 
	`sqlôe3Ex¥
(
db
, 
TK_INTEGER
, 0);

100615 if–
pNew
==0 )  
SQLITE_NOMEM
;

100616 
pNew
->
Êags
 |
EP_I¡VÆue
;

100617 
pNew
->
u
.
iVÆue
 = 
i
;

100618 
pOrdîBy
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,ÖOrdîBy, 
pNew
);

100619 if–
pOrdîBy
 )ÖOrdîBy->
a
[
nOrdîBy
++].
iOrdîByCﬁ
 = (
u16
)
i
;

100631 
aPîmuã
 = 
	`sqlôe3DbMÆlocRaw
(
db
, ()*
nOrdîBy
);

100632 if–
aPîmuã
 ){

100633 
Ex¥Li°_ôem
 *
pIãm
;

100634 
i
=0, 
pIãm
=
pOrdîBy
->
a
; i<
nOrdîBy
; i++,ÖItem++){

100635 
	`as£π
–
pIãm
->
iOrdîByCﬁ
>0 &&ÖIãm->iOrdîByCﬁ<=
p
->
pELi°
->
nEx¥
 );

100636 
aPîmuã
[
i
] = 
pIãm
->
iOrdîByCﬁ
 - 1;

100638 
pKeyMîge
 = 
	`sqlôe3KeyInfoAŒoc
(
db
, 
nOrdîBy
);

100639 if–
pKeyMîge
 ){

100640 
i
=0; i<
nOrdîBy
; i++){

100641 
CﬁlSeq
 *
pCﬁl
;

100642 
Ex¥
 *
pTîm
 = 
pOrdîBy
->
a
[
i
].
pEx¥
;

100643 if–
pTîm
->
Êags
 & 
EP_Cﬁœã
 ){

100644 
pCﬁl
 = 
	`sqlôe3Ex¥CﬁlSeq
(
pP¨£
, 
pTîm
);

100646 
pCﬁl
 = 
	`mu…iSñe˘CﬁlSeq
(
pP¨£
, 
p
, 
aPîmuã
[
i
]);

100647 if–
pCﬁl
==0 )ÖCﬁ»
db
->
pDÊtCﬁl
;

100648 
pOrdîBy
->
a
[
i
].
pEx¥
 =

100649 
	`sqlôe3Ex¥AddCﬁœãSåög
(
pP¨£
, 
pTîm
, 
pCﬁl
->
zName
);

100651 
pKeyMîge
->
aCﬁl
[
i
] = 
pCﬁl
;

100652 
pKeyMîge
->
aS‹tOrdî
[
i
] = 
pOrdîBy
->
a
[i].
s‹tOrdî
;

100656 
pKeyMîge
 = 0;

100661 
p
->
pOrdîBy
 =ÖOrderBy;

100662 
pPri‹
->
pOrdîBy
 = 
	`sqlôe3Ex¥Li°Dup
(
pP¨£
->
db
,ÖOrderBy, 0);

100668 if–
›
==
TK_ALL
 ){

100669 
ªgPªv
 = 0;

100671 
nEx¥
 = 
p
->
pELi°
->nExpr;

100672 
	`as£π
–
nOrdîBy
>=
nEx¥
 || 
db
->
mÆlocFaûed
 );

100673 
ªgPªv
 = 
pP¨£
->
nMem
+1;

100674 
pP¨£
->
nMem
 +
nEx¥
+1;

100675 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 0, 
ªgPªv
);

100676 
pKeyDup
 = 
	`sqlôe3KeyInfoAŒoc
(
db
, 
nEx¥
);

100677 if–
pKeyDup
 ){

100678 
i
=0; i<
nEx¥
; i++){

100679 
pKeyDup
->
aCﬁl
[
i
] = 
	`mu…iSñe˘CﬁlSeq
(
pP¨£
, 
p
, i);

100680 
pKeyDup
->
aS‹tOrdî
[
i
] = 0;

100687 
p
->
pPri‹
 = 0;

100688 
	`sqlôe3ResﬁveOrdîGroupBy
(
pP¨£
, 
p
,Ö->
pOrdîBy
, "ORDER");

100689 if–
pPri‹
->pPrior==0 ){

100690 
	`sqlôe3ResﬁveOrdîGroupBy
(
pP¨£
, 
pPri‹
,ÖPri‹->
pOrdîBy
, "ORDER");

100694 
	`compuãLimôRegi°îs
(
pP¨£
, 
p
, 
œbñEnd
);

100695 if–
p
->
iLimô
 && 
›
==
TK_ALL
 ){

100696 
ªgLimôA
 = ++
pP¨£
->
nMem
;

100697 
ªgLimôB
 = ++
pP¨£
->
nMem
;

100698 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_C›y
, 
p
->
iOff£t
 ?Ö->iOff£t+1 :Ö->
iLimô
,

100699 
ªgLimôA
);

100700 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_C›y
, 
ªgLimôA
, 
ªgLimôB
);

100702 
ªgLimôA
 = 
ªgLimôB
 = 0;

100704 
	`sqlôe3Ex¥Dñëe
(
db
, 
p
->
pLimô
);

100705 
p
->
pLimô
 = 0;

100706 
	`sqlôe3Ex¥Dñëe
(
db
, 
p
->
pOff£t
);

100707 
p
->
pOff£t
 = 0;

100709 
ªgAddrA
 = ++
pP¨£
->
nMem
;

100710 
ªgEofA
 = ++
pP¨£
->
nMem
;

100711 
ªgAddrB
 = ++
pP¨£
->
nMem
;

100712 
ªgEofB
 = ++
pP¨£
->
nMem
;

100713 
ªgOutA
 = ++
pP¨£
->
nMem
;

100714 
ªgOutB
 = ++
pP¨£
->
nMem
;

100715 
	`sqlôe3Sñe˘De°Inô
(&
de°A
, 
SRT_C‹outöe
, 
ªgAddrA
);

100716 
	`sqlôe3Sñe˘De°Inô
(&
de°B
, 
SRT_C‹outöe
, 
ªgAddrB
);

100721 
j1
 = 
	`sqlôe3VdbeAddOp0
(
v
, 
OP_GŸo
);

100722 
addrSñe˘A
 = 
	`sqlôe3VdbeCuºítAddr
(
v
);

100728 
	`VdbeNo›Commít
((
v
, "Begin coroutine forÜeft SELECT"));

100729 
pPri‹
->
iLimô
 = 
ªgLimôA
;

100730 
	`ex∂aöSëI¡egî
(
iSub1
, 
pP¨£
->
iNextSñe˘Id
);

100731 
	`sqlôe3Sñe˘
(
pP¨£
, 
pPri‹
, &
de°A
);

100732 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 1, 
ªgEofA
);

100733 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Yõld
, 
ªgAddrA
);

100734 
	`VdbeNo›Commít
((
v
, "End coroutine forÜeft SELECT"));

100739 
addrSñe˘B
 = 
	`sqlôe3VdbeCuºítAddr
(
v
);

100740 
	`VdbeNo›Commít
((
v
, "Begin coroutine forÑight SELECT"));

100741 
ßvedLimô
 = 
p
->
iLimô
;

100742 
ßvedOff£t
 = 
p
->
iOff£t
;

100743 
p
->
iLimô
 = 
ªgLimôB
;

100744 
p
->
iOff£t
 = 0;

100745 
	`ex∂aöSëI¡egî
(
iSub2
, 
pP¨£
->
iNextSñe˘Id
);

100746 
	`sqlôe3Sñe˘
(
pP¨£
, 
p
, &
de°B
);

100747 
p
->
iLimô
 = 
ßvedLimô
;

100748 
p
->
iOff£t
 = 
ßvedOff£t
;

100749 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 1, 
ªgEofB
);

100750 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Yõld
, 
ªgAddrB
);

100751 
	`VdbeNo›Commít
((
v
, "End coroutine forÑight SELECT"));

100756 
	`VdbeNo›Commít
((
v
, "OutputÑoutine for A"));

100757 
addrOutA
 = 
	`gíî©eOuçutSubroutöe
(
pP¨£
,

100758 
p
, &
de°A
, 
pDe°
, 
ªgOutA
,

100759 
ªgPªv
, 
pKeyDup
, 
P4_KEYINFO_HANDOFF
, 
œbñEnd
);

100764 if–
›
==
TK_ALL
 || op==
TK_UNION
 ){

100765 
	`VdbeNo›Commít
((
v
, "OutputÑoutine for B"));

100766 
addrOutB
 = 
	`gíî©eOuçutSubroutöe
(
pP¨£
,

100767 
p
, &
de°B
, 
pDe°
, 
ªgOutB
,

100768 
ªgPªv
, 
pKeyDup
, 
P4_KEYINFO_STATIC
, 
œbñEnd
);

100774 
	`VdbeNo›Commít
((
v
, "eof-A subroutine"));

100775 if–
›
==
TK_EXCEPT
 || op==
TK_INTERSECT
 ){

100776 
addrEofA
 = 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_GŸo
, 0, 
œbñEnd
);

100778 
addrEofA
 = 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_If
, 
ªgEofB
, 
œbñEnd
);

100779 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Gosub
, 
ªgOutB
, 
addrOutB
);

100780 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Yõld
, 
ªgAddrB
);

100781 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_GŸo
, 0, 
addrEofA
);

100782 
p
->
nSñe˘Row
 +
pPri‹
->nSelectRow;

100788 if–
›
==
TK_INTERSECT
 ){

100789 
addrEofB
 = 
addrEofA
;

100790 if–
p
->
nSñe˘Row
 > 
pPri‹
->nSelectRow )Ö->nSelectRow =ÖPrior->nSelectRow;

100792 
	`VdbeNo›Commít
((
v
, "eof-B subroutine"));

100793 
addrEofB
 = 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_If
, 
ªgEofA
, 
œbñEnd
);

100794 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Gosub
, 
ªgOutA
, 
addrOutA
);

100795 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Yõld
, 
ªgAddrA
);

100796 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_GŸo
, 0, 
addrEofB
);

100801 
	`VdbeNo›Commít
((
v
, "A-lt-B subroutine"));

100802 
addrA…B
 = 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Gosub
, 
ªgOutA
, 
addrOutA
);

100803 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Yõld
, 
ªgAddrA
);

100804 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_If
, 
ªgEofA
, 
addrEofA
);

100805 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_GŸo
, 0, 
œbñCm¥
);

100809 if–
›
==
TK_ALL
 ){

100810 
addrAeqB
 = 
addrA…B
;

100811 }if–
›
==
TK_INTERSECT
 ){

100812 
addrAeqB
 = 
addrA…B
;

100813 
addrA…B
++;

100815 
	`VdbeNo›Commít
((
v
, "A-eq-B subroutine"));

100816 
addrAeqB
 =

100817 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Yõld
, 
ªgAddrA
);

100818 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_If
, 
ªgEofA
, 
addrEofA
);

100819 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_GŸo
, 0, 
œbñCm¥
);

100824 
	`VdbeNo›Commít
((
v
, "A-gt-B subroutine"));

100825 
addrAgtB
 = 
	`sqlôe3VdbeCuºítAddr
(
v
);

100826 if–
›
==
TK_ALL
 || op==
TK_UNION
 ){

100827 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Gosub
, 
ªgOutB
, 
addrOutB
);

100829 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Yõld
, 
ªgAddrB
);

100830 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_If
, 
ªgEofB
, 
addrEofB
);

100831 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_GŸo
, 0, 
œbñCm¥
);

100835 
	`sqlôe3VdbeJumpHîe
(
v
, 
j1
);

100836 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 0, 
ªgEofA
);

100837 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 0, 
ªgEofB
);

100838 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Gosub
, 
ªgAddrA
, 
addrSñe˘A
);

100839 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Gosub
, 
ªgAddrB
, 
addrSñe˘B
);

100840 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_If
, 
ªgEofA
, 
addrEofA
);

100841 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_If
, 
ªgEofB
, 
addrEofB
);

100845 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
œbñCm¥
);

100846 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Pîmuèti⁄
, 0, 0, 0, (*)
aPîmuã
, 
P4_INTARRAY
);

100847 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Com∑ª
, 
de°A
.
iSd°
, 
de°B
.iSd°, 
nOrdîBy
,

100848 (*)
pKeyMîge
, 
P4_KEYINFO_HANDOFF
);

100849 
	`sqlôe3VdbeCh™geP5
(
v
, 
OPFLAG_PERMUTE
);

100850 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Jump
, 
addrA…B
, 
addrAeqB
, 
addrAgtB
);

100854 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
œbñEnd
);

100858 if–
pDe°
->
eDe°
==
SRT_Ouçut
 ){

100859 
Sñe˘
 *
pFú°
 = 
pPri‹
;

100860  
pFú°
->
pPri‹
 )ÖFirst =ÖFirst->pPrior;

100861 
	`gíî©eCﬁumnNames
(
pP¨£
, 0, 
pFú°
->
pELi°
);

100866 if–
p
->
pPri‹
 ){

100867 
	`sqlôe3Sñe˘Dñëe
(
db
, 
p
->
pPri‹
);

100869 
p
->
pPri‹
 =ÖPrior;

100873 
	`ex∂aöComposôe
(
pP¨£
, 
p
->
›
, 
iSub1
, 
iSub2
, 0);

100874  
SQLITE_OK
;

100878 #i‡!
	`deföed
(
SQLITE_OMIT_SUBQUERY
Ë|| !deföed(
SQLITE_OMIT_VIEW
)

100880 
	`sub°Ex¥Li°
(
sqlôe3
*, 
Ex¥Li°
*, , ExprList*);

100881 
	`sub°Sñe˘
(
sqlôe3
*, 
Sñe˘
 *, , 
Ex¥Li°
 *);

100896 
Ex¥
 *
	`sub°Ex¥
(

100897 
sqlôe3
 *
db
,

100898 
Ex¥
 *
pEx¥
,

100899 
iTabÀ
,

100900 
Ex¥Li°
 *
pELi°


100902 if–
pEx¥
==0 )  0;

100903 if–
pEx¥
->
›
==
TK_COLUMN
 &&ÖEx¥->
iTabÀ
==iTable ){

100904 if–
pEx¥
->
iCﬁumn
<0 ){

100905 
pEx¥
->
›
 = 
TK_NULL
;

100907 
Ex¥
 *
pNew
;

100908 
	`as£π
–
pELi°
!=0 && 
pEx¥
->
iCﬁumn
<pELi°->
nEx¥
 );

100909 
	`as£π
–
pEx¥
->
pLe·
==0 &&ÖEx¥->
pRight
==0 );

100910 
pNew
 = 
	`sqlôe3Ex¥Dup
(
db
, 
pELi°
->
a
[
pEx¥
->
iCﬁumn
].pExpr, 0);

100911 
	`sqlôe3Ex¥Dñëe
(
db
, 
pEx¥
);

100912 
pEx¥
 = 
pNew
;

100915 
pEx¥
->
pLe·
 = 
	`sub°Ex¥
(
db
,ÖEx¥->pLe·, 
iTabÀ
, 
pELi°
);

100916 
pEx¥
->
pRight
 = 
	`sub°Ex¥
(
db
,ÖEx¥->pRight, 
iTabÀ
, 
pELi°
);

100917 if–
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_xIsSñe˘
) ){

100918 
	`sub°Sñe˘
(
db
, 
pEx¥
->
x
.
pSñe˘
, 
iTabÀ
, 
pELi°
);

100920 
	`sub°Ex¥Li°
(
db
, 
pEx¥
->
x
.
pLi°
, 
iTabÀ
, 
pELi°
);

100923  
pEx¥
;

100925 
	`sub°Ex¥Li°
(

100926 
sqlôe3
 *
db
,

100927 
Ex¥Li°
 *
pLi°
,

100928 
iTabÀ
,

100929 
Ex¥Li°
 *
pELi°


100931 
i
;

100932 if–
pLi°
==0 ) ;

100933 
i
=0; i<
pLi°
->
nEx¥
; i++){

100934 
pLi°
->
a
[
i
].
pEx¥
 = 
	`sub°Ex¥
(
db
,ÖLi°->a[i].pEx¥, 
iTabÀ
, 
pELi°
);

100937 
	`sub°Sñe˘
(

100938 
sqlôe3
 *
db
,

100939 
Sñe˘
 *
p
,

100940 
iTabÀ
,

100941 
Ex¥Li°
 *
pELi°


100943 
SrcLi°
 *
pSrc
;

100944 
SrcLi°_ôem
 *
pIãm
;

100945 
i
;

100946 if–!
p
 ) ;

100947 
	`sub°Ex¥Li°
(
db
, 
p
->
pELi°
, 
iTabÀ
,ÖEList);

100948 
	`sub°Ex¥Li°
(
db
, 
p
->
pGroupBy
, 
iTabÀ
, 
pELi°
);

100949 
	`sub°Ex¥Li°
(
db
, 
p
->
pOrdîBy
, 
iTabÀ
, 
pELi°
);

100950 
p
->
pHavög
 = 
	`sub°Ex¥
(
db
,Ö->pHavög, 
iTabÀ
, 
pELi°
);

100951 
p
->
pWhîe
 = 
	`sub°Ex¥
(
db
,Ö->pWhîe, 
iTabÀ
, 
pELi°
);

100952 
	`sub°Sñe˘
(
db
, 
p
->
pPri‹
, 
iTabÀ
, 
pELi°
);

100953 
pSrc
 = 
p
->pSrc;

100954 
	`as£π
–
pSrc
 );

100955 if–
	`ALWAYS
(
pSrc
) ){

100956 
i
=
pSrc
->
nSrc
, 
pIãm
ıSrc->
a
; i>0; i--,ÖItem++){

100957 
	`sub°Sñe˘
(
db
, 
pIãm
->
pSñe˘
, 
iTabÀ
, 
pELi°
);

100963 #i‡!
	`deföed
(
SQLITE_OMIT_SUBQUERY
Ë|| !deföed(
SQLITE_OMIT_VIEW
)

101085 
	`Ê©ãnSubquîy
(

101086 
P¨£
 *
pP¨£
,

101087 
Sñe˘
 *
p
,

101088 
iFrom
,

101089 
isAgg
,

101090 
subquîyIsAgg


101092 c⁄° *
zSavedAuthC⁄ãxt
 = 
pP¨£
->
zAuthC⁄ãxt
;

101093 
Sñe˘
 *
pP¨ít
;

101094 
Sñe˘
 *
pSub
;

101095 
Sñe˘
 *
pSub1
;

101096 
SrcLi°
 *
pSrc
;

101097 
SrcLi°
 *
pSubSrc
;

101098 
Ex¥Li°
 *
pLi°
;

101099 
iP¨ít
;

101100 
i
;

101101 
Ex¥
 *
pWhîe
;

101102 
SrcLi°_ôem
 *
pSubôem
;

101103 
sqlôe3
 *
db
 = 
pP¨£
->db;

101107 
	`as£π
–
p
!=0 );

101108 
	`as£π
–
p
->
pPri‹
==0 );

101109 if–
	`O±imiz©i⁄DißbÀd
(
db
, 
SQLITE_QuîyFœâíî
) )  0;

101110 
pSrc
 = 
p
->pSrc;

101111 
	`as£π
–
pSrc
 && 
iFrom
>=0 && iFrom<pSrc->
nSrc
 );

101112 
pSubôem
 = &
pSrc
->
a
[
iFrom
];

101113 
iP¨ít
 = 
pSubôem
->
iCurs‹
;

101114 
pSub
 = 
pSubôem
->
pSñe˘
;

101115 
	`as£π
–
pSub
!=0 );

101116 if–
isAgg
 && 
subquîyIsAgg
 )  0;

101117 if–
subquîyIsAgg
 && 
pSrc
->
nSrc
>1 )  0;

101118 
pSubSrc
 = 
pSub
->
pSrc
;

101119 
	`as£π
–
pSubSrc
 );

101125 if–
pSub
->
pLimô
 && 
p
->pLimit )  0;

101126 if–
pSub
->
pOff£t
 )  0;

101127 if–
p
->
pRightmo°
 && 
pSub
->
pLimô
 ){

101130 if–
pSubSrc
->
nSrc
==0 )  0;

101131 if–
pSub
->
£lFœgs
 & 
SF_Di°ö˘
 )  0;

101132 if–
pSub
->
pLimô
 && (
pSrc
->
nSrc
>1 || 
isAgg
) ){

101135 if–(
p
->
£lFœgs
 & 
SF_Di°ö˘
)!=0 && 
subquîyIsAgg
 ){

101138 if–
p
->
pOrdîBy
 && 
pSub
->pOrderBy ){

101141 if–
isAgg
 && 
pSub
->
pOrdîBy
 )  0;

101142 if–
pSub
->
pLimô
 && 
p
->
pWhîe
 )  0;

101143 if–
pSub
->
pLimô
 && (
p
->
£lFœgs
 & 
SF_Di°ö˘
)!=0 ){

101179 if–(
pSubôem
->
joöty≥
 & 
JT_OUTER
)!=0 ){

101188 if–
pSub
->
pPri‹
 ){

101189 if–
pSub
->
pOrdîBy
 ){

101192 if–
isAgg
 || (
p
->
£lFœgs
 & 
SF_Di°ö˘
)!=0 || 
pSrc
->
nSrc
!=1 ){

101195 
pSub1
=
pSub
;ÖSub1;ÖSub1ıSub1->
pPri‹
){

101196 
	`ã°ˇ£
–(
pSub1
->
£lFœgs
 & (
SF_Di°ö˘
|
SF_Aggªg©e
))==SF_Distinct );

101197 
	`ã°ˇ£
–(
pSub1
->
£lFœgs
 & (
SF_Di°ö˘
|
SF_Aggªg©e
))==SF_Aggregate );

101198 
	`as£π
–
pSub
->
pSrc
!=0 );

101199 if–(
pSub1
->
£lFœgs
 & (
SF_Di°ö˘
|
SF_Aggªg©e
))!=0

101200 || (
pSub1
->
pPri‹
 &&ÖSub1->
›
!=
TK_ALL
)

101201 || 
pSub1
->
pSrc
->
nSrc
<1

101202 || 
pSub
->
pELi°
->
nEx¥
!=
pSub1
->pEList->nExpr

101206 
	`ã°ˇ£
–
pSub1
->
pSrc
->
nSrc
>1 );

101210 if–
p
->
pOrdîBy
 ){

101211 
ii
;

101212 
ii
=0; ii<
p
->
pOrdîBy
->
nEx¥
; ii++){

101213 if–
p
->
pOrdîBy
->
a
[
ii
].
iOrdîByCﬁ
==0 )  0;

101221 
pP¨£
->
zAuthC⁄ãxt
 = 
pSubôem
->
zName
;

101222 
	`TESTONLY
(
i
 =Ë
	`sqlôe3AuthCheck
(
pP¨£
, 
SQLITE_SELECT
, 0, 0, 0);

101223 
	`ã°ˇ£
–
i
==
SQLITE_DENY
 );

101224 
pP¨£
->
zAuthC⁄ãxt
 = 
zSavedAuthC⁄ãxt
;

101259 
pSub
ıSub->
pPri‹
;ÖSub;ÖSub=pSub->pPrior){

101260 
Sñe˘
 *
pNew
;

101261 
Ex¥Li°
 *
pOrdîBy
 = 
p
->pOrderBy;

101262 
Ex¥
 *
pLimô
 = 
p
->pLimit;

101263 
Ex¥
 *
pOff£t
 = 
p
->pOffset;

101264 
Sñe˘
 *
pPri‹
 = 
p
->pPrior;

101265 
p
->
pOrdîBy
 = 0;

101266 
p
->
pSrc
 = 0;

101267 
p
->
pPri‹
 = 0;

101268 
p
->
pLimô
 = 0;

101269 
p
->
pOff£t
 = 0;

101270 
pNew
 = 
	`sqlôe3Sñe˘Dup
(
db
, 
p
, 0);

101271 
p
->
pOff£t
 =ÖOffset;

101272 
p
->
pLimô
 =ÖLimit;

101273 
p
->
pOrdîBy
 =ÖOrderBy;

101274 
p
->
pSrc
 =ÖSrc;

101275 
p
->
›
 = 
TK_ALL
;

101276 
p
->
pRightmo°
 = 0;

101277 if–
pNew
==0 ){

101278 
pNew
 = 
pPri‹
;

101280 
pNew
->
pPri‹
 =ÖPrior;

101281 
pNew
->
pRightmo°
 = 0;

101283 
p
->
pPri‹
 = 
pNew
;

101284 if–
db
->
mÆlocFaûed
 )  1;

101290 
pSub
 = 
pSub1
 = 
pSubôem
->
pSñe˘
;

101295 
	`sqlôe3DbFªe
(
db
, 
pSubôem
->
zD©aba£
);

101296 
	`sqlôe3DbFªe
(
db
, 
pSubôem
->
zName
);

101297 
	`sqlôe3DbFªe
(
db
, 
pSubôem
->
zAlüs
);

101298 
pSubôem
->
zD©aba£
 = 0;

101299 
pSubôem
->
zName
 = 0;

101300 
pSubôem
->
zAlüs
 = 0;

101301 
pSubôem
->
pSñe˘
 = 0;

101310 if–
	`ALWAYS
(
pSubôem
->
pTab
!=0) ){

101311 
TabÀ
 *
pTabToDñ
 = 
pSubôem
->
pTab
;

101312 if–
pTabToDñ
->
nRef
==1 ){

101313 
P¨£
 *
pT›Àvñ
 = 
	`sqlôe3P¨£T›Àvñ
(
pP¨£
);

101314 
pTabToDñ
->
pNextZombõ
 = 
pT›Àvñ
->
pZombõTab
;

101315 
pT›Àvñ
->
pZombõTab
 = 
pTabToDñ
;

101317 
pTabToDñ
->
nRef
--;

101319 
pSubôem
->
pTab
 = 0;

101335 
pP¨ít
=
p
;ÖP¨ít;ÖP¨ítıP¨ít->
pPri‹
, 
pSub
=pSub->pPrior){

101336 
nSubSrc
;

101337 
u8
 
joöty≥
 = 0;

101338 
pSubSrc
 = 
pSub
->
pSrc
;

101339 
nSubSrc
 = 
pSubSrc
->
nSrc
;

101340 
pSrc
 = 
pP¨ít
->pSrc;

101342 if–
pSrc
 ){

101343 
	`as£π
–
pP¨ít
==
p
 );

101344 
joöty≥
 = 
pSubôem
->jointype;

101346 
	`as£π
–
pP¨ít
!=
p
 );

101347 
pSrc
 = 
pP¨ít
->pSr¯
	`sqlôe3SrcLi°Aµíd
(
db
, 0, 0, 0);

101348 if–
pSrc
==0 ){

101349 
	`as£π
–
db
->
mÆlocFaûed
 );

101369 if–
nSubSrc
>1 ){

101370 
pP¨ít
->
pSrc
 =ÖSr¯
	`sqlôe3SrcLi°E∆¨ge
(
db
,ÖSrc, 
nSubSrc
-1,
iFrom
+1);

101371 if–
db
->
mÆlocFaûed
 ){

101379 
i
=0; i<
nSubSrc
; i++){

101380 
	`sqlôe3IdLi°Dñëe
(
db
, 
pSrc
->
a
[
i
+
iFrom
].
pUsög
);

101381 
pSrc
->
a
[
i
+
iFrom
] = 
pSubSrc
->a[i];

101382 
	`mem£t
(&
pSubSrc
->
a
[
i
], 0, (pSubSrc->a[i]));

101384 
pSrc
->
a
[
iFrom
].
joöty≥
 = jointype;

101398 
pLi°
 = 
pP¨ít
->
pELi°
;

101399 
i
=0; i<
pLi°
->
nEx¥
; i++){

101400 if–
pLi°
->
a
[
i
].
zName
==0 ){

101401 *
zName
 = 
	`sqlôe3DbSåDup
(
db
, 
pLi°
->
a
[
i
].
zS∑n
);

101402 
	`sqlôe3DequŸe
(
zName
);

101403 
pLi°
->
a
[
i
].
zName
 = zName;

101406 
	`sub°Ex¥Li°
(
db
, 
pP¨ít
->
pELi°
, 
iP¨ít
, 
pSub
->pEList);

101407 if–
isAgg
 ){

101408 
	`sub°Ex¥Li°
(
db
, 
pP¨ít
->
pGroupBy
, 
iP¨ít
, 
pSub
->
pELi°
);

101409 
pP¨ít
->
pHavög
 = 
	`sub°Ex¥
(
db
,ÖP¨ít->pHavög, 
iP¨ít
, 
pSub
->
pELi°
);

101411 if–
pSub
->
pOrdîBy
 ){

101412 
	`as£π
–
pP¨ít
->
pOrdîBy
==0 );

101413 
pP¨ít
->
pOrdîBy
 = 
pSub
->pOrderBy;

101414 
pSub
->
pOrdîBy
 = 0;

101415 }if–
pP¨ít
->
pOrdîBy
 ){

101416 
	`sub°Ex¥Li°
(
db
, 
pP¨ít
->
pOrdîBy
, 
iP¨ít
, 
pSub
->
pELi°
);

101418 if–
pSub
->
pWhîe
 ){

101419 
pWhîe
 = 
	`sqlôe3Ex¥Dup
(
db
, 
pSub
->pWhere, 0);

101421 
pWhîe
 = 0;

101423 if–
subquîyIsAgg
 ){

101424 
	`as£π
–
pP¨ít
->
pHavög
==0 );

101425 
pP¨ít
->
pHavög
 =ÖP¨ít->
pWhîe
;

101426 
pP¨ít
->
pWhîe
 =ÖWhere;

101427 
pP¨ít
->
pHavög
 = 
	`sub°Ex¥
(
db
,ÖP¨ít->pHavög, 
iP¨ít
, 
pSub
->
pELi°
);

101428 
pP¨ít
->
pHavög
 = 
	`sqlôe3Ex¥And
(
db
,ÖParent->pHaving,

101429 
	`sqlôe3Ex¥Dup
(
db
, 
pSub
->
pHavög
, 0));

101430 
	`as£π
–
pP¨ít
->
pGroupBy
==0 );

101431 
pP¨ít
->
pGroupBy
 = 
	`sqlôe3Ex¥Li°Dup
(
db
, 
pSub
->pGroupBy, 0);

101433 
pP¨ít
->
pWhîe
 = 
	`sub°Ex¥
(
db
,ÖP¨ít->pWhîe, 
iP¨ít
, 
pSub
->
pELi°
);

101434 
pP¨ít
->
pWhîe
 = 
	`sqlôe3Ex¥And
(
db
,ÖParent->pWhere,ÖWhere);

101440 
pP¨ít
->
£lFœgs
 |
pSub
->£lFœg†& 
SF_Di°ö˘
;

101448 if–
pSub
->
pLimô
 ){

101449 
pP¨ít
->
pLimô
 = 
pSub
->pLimit;

101450 
pSub
->
pLimô
 = 0;

101457 
	`sqlôe3Sñe˘Dñëe
(
db
, 
pSub1
);

101478 
u8
 
	`möMaxQuîy
(
AggInfo
 *
pAggInfo
, 
Ex¥Li°
 **
µMöMax
){

101479 
eRë
 = 
WHERE_ORDERBY_NORMAL
;

101481 *
µMöMax
 = 0;

101482 if–
pAggInfo
->
nFunc
==1 ){

101483 
Ex¥
 *
pEx¥
 = 
pAggInfo
->
aFunc
[0].pExpr;

101484 
Ex¥Li°
 *
pELi°
 = 
pEx¥
->
x
.
pLi°
;

101486 
	`as£π
–
pEx¥
->
›
==
TK_AGG_FUNCTION
 );

101487 if–
pELi°
 &&ÖELi°->
nEx¥
==1 &&ÖELi°->
a
[0].
pEx¥
->
›
==
TK_AGG_COLUMN
 ){

101488 c⁄° *
zFunc
 = 
pEx¥
->
u
.
zTokí
;

101489 if–
	`sqlôe3SåICmp
(
zFunc
, "min")==0 ){

101490 
eRë
 = 
WHERE_ORDERBY_MIN
;

101491 *
µMöMax
 = 
pELi°
;

101492 }if–
	`sqlôe3SåICmp
(
zFunc
, "max")==0 ){

101493 
eRë
 = 
WHERE_ORDERBY_MAX
;

101494 *
µMöMax
 = 
pELi°
;

101499 
	`as£π
–*
µMöMax
==0 || (*µMöMax)->
nEx¥
==1 );

101500  
eRë
;

101514 
TabÀ
 *
	`isSim∂eCou¡
(
Sñe˘
 *
p
, 
AggInfo
 *
pAggInfo
){

101515 
TabÀ
 *
pTab
;

101516 
Ex¥
 *
pEx¥
;

101518 
	`as£π
–!
p
->
pGroupBy
 );

101520 if–
p
->
pWhîe
 ||Ö->
pELi°
->
nEx¥
!=1

101521 || 
p
->
pSrc
->
nSrc
!=1 ||Ö->pSrc->
a
[0].
pSñe˘


101525 
pTab
 = 
p
->
pSrc
->
a
[0].pTab;

101526 
pEx¥
 = 
p
->
pELi°
->
a
[0].pExpr;

101527 
	`as£π
–
pTab
 && !pTab->
pSñe˘
 && 
pEx¥
 );

101529 if–
	`IsVútuÆ
(
pTab
) )  0;

101530 if–
pEx¥
->
›
!=
TK_AGG_FUNCTION
 )  0;

101531 if–
	`NEVER
(
pAggInfo
->
nFunc
==0) )  0;

101532 if–(
pAggInfo
->
aFunc
[0].
pFunc
->
funcFœgs
&
SQLITE_FUNC_COUNT
)==0 )  0;

101533 if–
pEx¥
->
Êags
&
EP_Di°ö˘
 )  0;

101535  
pTab
;

101545 
SQLITE_PRIVATE
 
	`sqlôe3IndexedByLookup
(
P¨£
 *
pP¨£
, 
SrcLi°_ôem
 *
pFrom
){

101546 if–
pFrom
->
pTab
 &&ÖFrom->
zIndex
 ){

101547 
TabÀ
 *
pTab
 = 
pFrom
->pTab;

101548 *
zIndex
 = 
pFrom
->zIndex;

101549 
Index
 *
pIdx
;

101550 
pIdx
=
pTab
->
pIndex
;

101551 
pIdx
 && 
	`sqlôe3SåICmp
’Idx->
zName
, 
zIndex
);

101552 
pIdx
ıIdx->
pNext


101554 if–!
pIdx
 ){

101555 
	`sqlôe3Eº‹Msg
(
pP¨£
, "nÿsuch index: %s", 
zIndex
, 0);

101556 
pP¨£
->
checkSchema
 = 1;

101557  
SQLITE_ERROR
;

101559 
pFrom
->
pIndex
 = 
pIdx
;

101561  
SQLITE_OK
;

101584 
	`c⁄vîtCompoundSñe˘ToSubquîy
(
WÆkî
 *
pWÆkî
, 
Sñe˘
 *
p
){

101585 
i
;

101586 
Sñe˘
 *
pNew
;

101587 
Sñe˘
 *
pX
;

101588 
sqlôe3
 *
db
;

101589 
Ex¥Li°_ôem
 *
a
;

101590 
SrcLi°
 *
pNewSrc
;

101591 
P¨£
 *
pP¨£
;

101592 
Tokí
 
dummy
;

101594 if–
p
->
pPri‹
==0 )  
WRC_C⁄töue
;

101595 if–
p
->
pOrdîBy
==0 )  
WRC_C⁄töue
;

101596 
pX
=
p
;ÖX && (pX->
›
==
TK_ALL
 ||ÖX->›==
TK_SELECT
);ÖXıX->
pPri‹
){}

101597 if–
pX
==0 )  
WRC_C⁄töue
;

101598 
a
 = 
p
->
pOrdîBy
->a;

101599 
i
=
p
->
pOrdîBy
->
nEx¥
-1; i>=0; i--){

101600 if–
a
[
i
].
pEx¥
->
Êags
 & 
EP_Cﬁœã
 ) ;

101602 if–
i
<0 )  
WRC_C⁄töue
;

101606 
pP¨£
 = 
pWÆkî
->pParse;

101607 
db
 = 
pP¨£
->db;

101608 
pNew
 = 
	`sqlôe3DbMÆlocZîo
(
db
, (*pNew) );

101609 if–
pNew
==0 )  
WRC_Ab‹t
;

101610 
	`mem£t
(&
dummy
, 0, (dummy));

101611 
pNewSrc
 = 
	`sqlôe3SrcLi°AµídFromTîm
(
pP¨£
,0,0,0,&
dummy
,
pNew
,0,0);

101612 if–
pNewSrc
==0 )  
WRC_Ab‹t
;

101613 *
pNew
 = *
p
;

101614 
p
->
pSrc
 = 
pNewSrc
;

101615 
p
->
pELi°
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
, 0, 
	`sqlôe3Ex¥
(
db
, 
TK_ALL
, 0));

101616 
p
->
›
 = 
TK_SELECT
;

101617 
p
->
pWhîe
 = 0;

101618 
pNew
->
pGroupBy
 = 0;

101619 
pNew
->
pHavög
 = 0;

101620 
pNew
->
pOrdîBy
 = 0;

101621 
p
->
pPri‹
 = 0;

101622 
pNew
->
pLimô
 = 0;

101623 
pNew
->
pOff£t
 = 0;

101624  
WRC_C⁄töue
;

101651 
	`£À˘Ex∑ndî
(
WÆkî
 *
pWÆkî
, 
Sñe˘
 *
p
){

101652 
P¨£
 *
pP¨£
 = 
pWÆkî
->pParse;

101653 
i
, 
j
, 
k
;

101654 
SrcLi°
 *
pTabLi°
;

101655 
Ex¥Li°
 *
pELi°
;

101656 
SrcLi°_ôem
 *
pFrom
;

101657 
sqlôe3
 *
db
 = 
pP¨£
->db;

101658 
Ex¥
 *
pE
, *
pRight
, *
pEx¥
;

101659 
u16
 
£lFœgs
 = 
p
->selFlags;

101661 
p
->
£lFœgs
 |
SF_Ex∑nded
;

101662 if–
db
->
mÆlocFaûed
 ){

101663  
WRC_Ab‹t
;

101665 if–
	`NEVER
(
p
->
pSrc
==0Ë|| (
£lFœgs
 & 
SF_Ex∑nded
)!=0 ){

101666  
WRC_Pru√
;

101668 
pTabLi°
 = 
p
->
pSrc
;

101669 
pELi°
 = 
p
->pEList;

101674 
	`sqlôe3SrcLi°AssignCurs‹s
(
pP¨£
, 
pTabLi°
);

101680 
i
=0, 
pFrom
=
pTabLi°
->
a
; i<pTabLi°->
nSrc
; i++,ÖFrom++){

101681 
TabÀ
 *
pTab
;

101682 if–
pFrom
->
pTab
!=0 ){

101685 
	`as£π
–
i
==0 );

101686  
WRC_Pru√
;

101688 if–
pFrom
->
zName
==0 ){

101689 #i‚de‡
SQLITE_OMIT_SUBQUERY


101690 
Sñe˘
 *
pSñ
 = 
pFrom
->
pSñe˘
;

101692 
	`as£π
–
pSñ
!=0 );

101693 
	`as£π
–
pFrom
->
pTab
==0 );

101694 
	`sqlôe3WÆkSñe˘
(
pWÆkî
, 
pSñ
);

101695 
pFrom
->
pTab
 =ÖTab = 
	`sqlôe3DbMÆlocZîo
(
db
, (
TabÀ
));

101696 if–
pTab
==0 )  
WRC_Ab‹t
;

101697 
pTab
->
nRef
 = 1;

101698 
pTab
->
zName
 = 
	`sqlôe3MPrötf
(
db
, "sqlite_sq_%p", (*)pTab);

101699  
pSñ
->
pPri‹
 ){ÖSel =ÖSel->pPrior; }

101700 
	`£À˘CﬁumnsFromEx¥Li°
(
pP¨£
, 
pSñ
->
pELi°
, &
pTab
->
nCﬁ
, &pTab->
aCﬁ
);

101701 
pTab
->
iPKey
 = -1;

101702 
pTab
->
nRowE°
 = 1048576;

101703 
pTab
->
èbFœgs
 |
TF_EphemîÆ
;

101707 
	`as£π
–
pFrom
->
pTab
==0 );

101708 
pFrom
->
pTab
 =ÖTab = 
	`sqlôe3LoˇãTabÀIãm
(
pP¨£
, 0,ÖFrom);

101709 if–
pTab
==0 )  
WRC_Ab‹t
;

101710 if–
pTab
->
nRef
==0xffff ){

101711 
	`sqlôe3Eº‹Msg
(
pP¨£
, "too manyÑeferencesÅo \"%s\": max 65535",

101712 
pTab
->
zName
);

101713 
pFrom
->
pTab
 = 0;

101714  
WRC_Ab‹t
;

101716 
pTab
->
nRef
++;

101717 #i‡!
	`deföed
(
SQLITE_OMIT_VIEW
Ë|| !deföed (
SQLITE_OMIT_VIRTUALTABLE
)

101718 if–
pTab
->
pSñe˘
 || 
	`IsVútuÆ
(pTab) ){

101720 if–
	`sqlôe3VõwGëCﬁumnNames
(
pP¨£
, 
pTab
ËË 
WRC_Ab‹t
;

101721 
	`as£π
–
pFrom
->
pSñe˘
==0 );

101722 
pFrom
->
pSñe˘
 = 
	`sqlôe3Sñe˘Dup
(
db
, 
pTab
->pSelect, 0);

101723 
	`sqlôe3WÆkSñe˘
(
pWÆkî
, 
pFrom
->
pSñe˘
);

101729 if–
	`sqlôe3IndexedByLookup
(
pP¨£
, 
pFrom
) ){

101730  
WRC_Ab‹t
;

101736 if–
db
->
mÆlocFaûed
 || 
	`sqlôePro˚ssJoö
(
pP¨£
, 
p
) ){

101737  
WRC_Ab‹t
;

101750 
k
=0; k<
pELi°
->
nEx¥
; k++){

101751 
pE
 = 
pELi°
->
a
[
k
].
pEx¥
;

101752 if–
pE
->
›
==
TK_ALL
 ) ;

101753 
	`as£π
–
pE
->
›
!=
TK_DOT
 ||ÖE->
pRight
!=0 );

101754 
	`as£π
–
pE
->
›
!=
TK_DOT
 || (pE->
pLe·
!=0 &&ÖE->pLe·->›==
TK_ID
) );

101755 if–
pE
->
›
==
TK_DOT
 &&ÖE->
pRight
->›==
TK_ALL
 ) ;

101757 if–
k
<
pELi°
->
nEx¥
 ){

101763 
Ex¥Li°_ôem
 *
a
 = 
pELi°
->a;

101764 
Ex¥Li°
 *
pNew
 = 0;

101765 
Êags
 = 
pP¨£
->
db
->flags;

101766 
l⁄gNames
 = (
Êags
 & 
SQLITE_FuŒCﬁNames
)!=0

101767 && (
Êags
 & 
SQLITE_Sh‹tCﬁNames
)==0;

101772 
	`as£π
–(
p
->
£lFœgs
 & 
SF_Ne°edFrom
)==0

101773 || ((
Êags
 & 
SQLITE_FuŒCﬁNames
)==0 &&

101774 (
Êags
 & 
SQLITE_Sh‹tCﬁNames
)!=0) );

101776 
k
=0; k<
pELi°
->
nEx¥
; k++){

101777 
pE
 = 
a
[
k
].
pEx¥
;

101778 
pRight
 = 
pE
->pRight;

101779 
	`as£π
–
pE
->
›
!=
TK_DOT
 || 
pRight
!=0 );

101780 if–
pE
->
›
!=
TK_ALL
 && (pE->›!=
TK_DOT
 || 
pRight
->op!=TK_ALL) ){

101783 
pNew
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,ÖNew, 
a
[
k
].
pEx¥
);

101784 if–
pNew
 ){

101785 
pNew
->
a
[pNew->
nEx¥
-1].
zName
 =á[
k
].zName;

101786 
pNew
->
a
[pNew->
nEx¥
-1].
zS∑n
 =á[
k
].zSpan;

101787 
a
[
k
].
zName
 = 0;

101788 
a
[
k
].
zS∑n
 = 0;

101790 
a
[
k
].
pEx¥
 = 0;

101794 
èbÀSìn
 = 0;

101795 *
zTName
 = 0;

101796 if–
pE
->
›
==
TK_DOT
 ){

101797 
	`as£π
–
pE
->
pLe·
!=0 );

101798 
	`as£π
–!
	`Ex¥HasPr›îty
(
pE
->
pLe·
, 
EP_I¡VÆue
) );

101799 
zTName
 = 
pE
->
pLe·
->
u
.
zTokí
;

101801 
i
=0, 
pFrom
=
pTabLi°
->
a
; i<pTabLi°->
nSrc
; i++,ÖFrom++){

101802 
TabÀ
 *
pTab
 = 
pFrom
->pTab;

101803 
Sñe˘
 *
pSub
 = 
pFrom
->
pSñe˘
;

101804 *
zTabName
 = 
pFrom
->
zAlüs
;

101805 c⁄° *
zSchemaName
 = 0;

101806 
iDb
;

101807 if–
zTabName
==0 ){

101808 
zTabName
 = 
pTab
->
zName
;

101810 if–
db
->
mÆlocFaûed
 ) ;

101811 if–
pSub
==0 || (pSub->
£lFœgs
 & 
SF_Ne°edFrom
)==0 ){

101812 
pSub
 = 0;

101813 if–
zTName
 && 
	`sqlôe3SåICmp
(zTName, 
zTabName
)!=0 ){

101816 
iDb
 = 
	`sqlôe3SchemaToIndex
(
db
, 
pTab
->
pSchema
);

101817 
zSchemaName
 = 
iDb
>=0 ? 
db
->
aDb
[iDb].
zName
 : "*";

101819 
j
=0; j<
pTab
->
nCﬁ
; j++){

101820 *
zName
 = 
pTab
->
aCﬁ
[
j
].zName;

101821 *
zCﬁ«me
;

101822 *
zToFªe
;

101823 
Tokí
 
sCﬁ«me
;

101825 
	`as£π
–
zName
 );

101826 if–
zTName
 && 
pSub


101827 && 
	`sqlôe3M©chS∑nName
(
pSub
->
pELi°
->
a
[
j
].
zS∑n
, 0, 
zTName
, 0)==0

101836 if–
	`IsHiddíCﬁumn
(&
pTab
->
aCﬁ
[
j
]) ){

101837 
	`as£π
(
	`IsVútuÆ
(
pTab
));

101840 
èbÀSìn
 = 1;

101842 if–
i
>0 && 
zTName
==0 ){

101843 if–(
pFrom
->
joöty≥
 & 
JT_NATURAL
)!=0

101844 && 
	`èbÀAndCﬁumnIndex
(
pTabLi°
, 
i
, 
zName
, 0, 0)

101850 if–
	`sqlôe3IdLi°Index
(
pFrom
->
pUsög
, 
zName
)>=0 ){

101856 
pRight
 = 
	`sqlôe3Ex¥
(
db
, 
TK_ID
, 
zName
);

101857 
zCﬁ«me
 = 
zName
;

101858 
zToFªe
 = 0;

101859 if–
l⁄gNames
 || 
pTabLi°
->
nSrc
>1 ){

101860 
Ex¥
 *
pLe·
;

101861 
pLe·
 = 
	`sqlôe3Ex¥
(
db
, 
TK_ID
, 
zTabName
);

101862 
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_DOT
, 
pLe·
, 
pRight
, 0);

101863 if–
zSchemaName
 ){

101864 
pLe·
 = 
	`sqlôe3Ex¥
(
db
, 
TK_ID
, 
zSchemaName
);

101865 
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_DOT
, 
pLe·
,ÖExpr, 0);

101867 if–
l⁄gNames
 ){

101868 
zCﬁ«me
 = 
	`sqlôe3MPrötf
(
db
, "%s.%s", 
zTabName
, 
zName
);

101869 
zToFªe
 = 
zCﬁ«me
;

101872 
pEx¥
 = 
pRight
;

101874 
pNew
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,ÖNew, 
pEx¥
);

101875 
sCﬁ«me
.
z
 = 
zCﬁ«me
;

101876 
sCﬁ«me
.
n
 = 
	`sqlôe3SåÀn30
(
zCﬁ«me
);

101877 
	`sqlôe3Ex¥Li°SëName
(
pP¨£
, 
pNew
, &
sCﬁ«me
, 0);

101878 if–
pNew
 && (
p
->
£lFœgs
 & 
SF_Ne°edFrom
)!=0 ){

101879 
Ex¥Li°_ôem
 *
pX
 = &
pNew
->
a
[pNew->
nEx¥
-1];

101880 if–
pSub
 ){

101881 
pX
->
zS∑n
 = 
	`sqlôe3DbSåDup
(
db
, 
pSub
->
pELi°
->
a
[
j
].zSpan);

101882 
	`ã°ˇ£
–
pX
->
zS∑n
==0 );

101884 
pX
->
zS∑n
 = 
	`sqlôe3MPrötf
(
db
, "%s.%s.%s",

101885 
zSchemaName
, 
zTabName
, 
zCﬁ«me
);

101886 
	`ã°ˇ£
–
pX
->
zS∑n
==0 );

101888 
pX
->
bS∑nIsTab
 = 1;

101890 
	`sqlôe3DbFªe
(
db
, 
zToFªe
);

101893 if–!
èbÀSìn
 ){

101894 if–
zTName
 ){

101895 
	`sqlôe3Eº‹Msg
(
pP¨£
, "nÿsuchÅabÀ: %s", 
zTName
);

101897 
	`sqlôe3Eº‹Msg
(
pP¨£
, "noÅables specified");

101902 
	`sqlôe3Ex¥Li°Dñëe
(
db
, 
pELi°
);

101903 
p
->
pELi°
 = 
pNew
;

101905 #i‡
SQLITE_MAX_COLUMN


101906 if–
p
->
pELi°
 &&Ö->pELi°->
nEx¥
>
db
->
aLimô
[
SQLITE_LIMIT_COLUMN
] ){

101907 
	`sqlôe3Eº‹Msg
(
pP¨£
, "too many columns inÑesult set");

101910  
WRC_C⁄töue
;

101922 
	`ex¥WÆkNo›
(
WÆkî
 *
NŸU£d
, 
Ex¥
 *
NŸU£d2
){

101923 
	`UNUSED_PARAMETER2
(
NŸU£d
, 
NŸU£d2
);

101924  
WRC_C⁄töue
;

101940 
	`sqlôe3Sñe˘Ex∑nd
(
P¨£
 *
pP¨£
, 
Sñe˘
 *
pSñe˘
){

101941 
WÆkî
 
w
;

101942 
	`mem£t
(&
w
, 0, (w));

101943 
w
.
xEx¥CÆlback
 = 
ex¥WÆkNo›
;

101944 
w
.
pP¨£
 =ÖParse;

101945 if–
pP¨£
->
hasCompound
 ){

101946 
w
.
xSñe˘CÆlback
 = 
c⁄vîtCompoundSñe˘ToSubquîy
;

101947 
	`sqlôe3WÆkSñe˘
(&
w
, 
pSñe˘
);

101949 
w
.
xSñe˘CÆlback
 = 
£À˘Ex∑ndî
;

101950 
	`sqlôe3WÆkSñe˘
(&
w
, 
pSñe˘
);

101954 #i‚de‡
SQLITE_OMIT_SUBQUERY


101968 
	`£À˘AddSubquîyTy≥Info
(
WÆkî
 *
pWÆkî
, 
Sñe˘
 *
p
){

101969 
P¨£
 *
pP¨£
;

101970 
i
;

101971 
SrcLi°
 *
pTabLi°
;

101972 
SrcLi°_ôem
 *
pFrom
;

101974 
	`as£π
–
p
->
£lFœgs
 & 
SF_Resﬁved
 );

101975 if–(
p
->
£lFœgs
 & 
SF_HasTy≥Info
)==0 ){

101976 
p
->
£lFœgs
 |
SF_HasTy≥Info
;

101977 
pP¨£
 = 
pWÆkî
->pParse;

101978 
pTabLi°
 = 
p
->
pSrc
;

101979 
i
=0, 
pFrom
=
pTabLi°
->
a
; i<pTabLi°->
nSrc
; i++,ÖFrom++){

101980 
TabÀ
 *
pTab
 = 
pFrom
->pTab;

101981 if–
	`ALWAYS
(
pTab
!=0Ë&& (pTab->
èbFœgs
 & 
TF_EphemîÆ
)!=0 ){

101983 
Sñe˘
 *
pSñ
 = 
pFrom
->
pSñe˘
;

101984 
	`as£π
–
pSñ
 );

101985  
pSñ
->
pPri‹
 )ÖSel =ÖSel->pPrior;

101986 
	`£À˘AddCﬁumnTy≥AndCﬁœti⁄
(
pP¨£
, 
pTab
, 
pSñ
);

101990  
WRC_C⁄töue
;

102002 
	`sqlôe3Sñe˘AddTy≥Info
(
P¨£
 *
pP¨£
, 
Sñe˘
 *
pSñe˘
){

102003 #i‚de‡
SQLITE_OMIT_SUBQUERY


102004 
WÆkî
 
w
;

102005 
	`mem£t
(&
w
, 0, (w));

102006 
w
.
xSñe˘CÆlback
 = 
£À˘AddSubquîyTy≥Info
;

102007 
w
.
xEx¥CÆlback
 = 
ex¥WÆkNo›
;

102008 
w
.
pP¨£
 =ÖParse;

102009 
w
.
bSñe˘DïthFú°
 = 1;

102010 
	`sqlôe3WÆkSñe˘
(&
w
, 
pSñe˘
);

102027 
SQLITE_PRIVATE
 
	`sqlôe3Sñe˘Pªp
(

102028 
P¨£
 *
pP¨£
,

102029 
Sñe˘
 *
p
,

102030 
NameC⁄ãxt
 *
pOuãrNC


102032 
sqlôe3
 *
db
;

102033 if–
	`NEVER
(
p
==0) ) ;

102034 
db
 = 
pP¨£
->db;

102035 if–
db
->
mÆlocFaûed
 ) ;

102036 if–
p
->
£lFœgs
 & 
SF_HasTy≥Info
 ) ;

102037 
	`sqlôe3Sñe˘Ex∑nd
(
pP¨£
, 
p
);

102038 if–
pP¨£
->
nEº
 || 
db
->
mÆlocFaûed
 ) ;

102039 
	`sqlôe3ResﬁveSñe˘Names
(
pP¨£
, 
p
, 
pOuãrNC
);

102040 if–
pP¨£
->
nEº
 || 
db
->
mÆlocFaûed
 ) ;

102041 
	`sqlôe3Sñe˘AddTy≥Info
(
pP¨£
, 
p
);

102052 
	`ª£tAccumuœt‹
(
P¨£
 *
pP¨£
, 
AggInfo
 *
pAggInfo
){

102053 
Vdbe
 *
v
 = 
pP¨£
->
pVdbe
;

102054 
i
;

102055 
AggInfo_func
 *
pFunc
;

102056 if–
pAggInfo
->
nFunc
+pAggInfo->
nCﬁumn
==0 ){

102059 
i
=0; i<
pAggInfo
->
nCﬁumn
; i++){

102060 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NuŒ
, 0, 
pAggInfo
->
aCﬁ
[
i
].
iMem
);

102062 
pFunc
=
pAggInfo
->
aFunc
, 
i
=0; i<pAggInfo->
nFunc
; i++,ÖFunc++){

102063 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NuŒ
, 0, 
pFunc
->
iMem
);

102064 if–
pFunc
->
iDi°ö˘
>=0 ){

102065 
Ex¥
 *
pE
 = 
pFunc
->
pEx¥
;

102066 
	`as£π
–!
	`Ex¥HasPr›îty
(
pE
, 
EP_xIsSñe˘
) );

102067 if–
pE
->
x
.
pLi°
==0 ||ÖE->x.pLi°->
nEx¥
!=1 ){

102068 
	`sqlôe3Eº‹Msg
(
pP¨£
, "DISTINCTággregates must haveÉxactly one "

102070 
pFunc
->
iDi°ö˘
 = -1;

102072 
KeyInfo
 *
pKeyInfo
 = 
	`keyInfoFromEx¥Li°
(
pP¨£
, 
pE
->
x
.
pLi°
);

102073 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_O≥nEphemîÆ
, 
pFunc
->
iDi°ö˘
, 0, 0,

102074 (*)
pKeyInfo
, 
P4_KEYINFO_HANDOFF
);

102084 
	`föÆizeAggFun˘i⁄s
(
P¨£
 *
pP¨£
, 
AggInfo
 *
pAggInfo
){

102085 
Vdbe
 *
v
 = 
pP¨£
->
pVdbe
;

102086 
i
;

102087 
AggInfo_func
 *
pF
;

102088 
i
=0, 
pF
=
pAggInfo
->
aFunc
; i<pAggInfo->
nFunc
; i++,ÖF++){

102089 
Ex¥Li°
 *
pLi°
 = 
pF
->
pEx¥
->
x
.pList;

102090 
	`as£π
–!
	`Ex¥HasPr›îty
(
pF
->
pEx¥
, 
EP_xIsSñe˘
) );

102091 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_AggFöÆ
, 
pF
->
iMem
, 
pLi°
 ?ÖLi°->
nEx¥
 : 0, 0,

102092 (*)
pF
->
pFunc
, 
P4_FUNCDEF
);

102100 
	`upd©eAccumuœt‹
(
P¨£
 *
pP¨£
, 
AggInfo
 *
pAggInfo
){

102101 
Vdbe
 *
v
 = 
pP¨£
->
pVdbe
;

102102 
i
;

102103 
ªgHô
 = 0;

102104 
addrHôTe°
 = 0;

102105 
AggInfo_func
 *
pF
;

102106 
AggInfo_cﬁ
 *
pC
;

102108 
pAggInfo
->
dúe˘Mode
 = 1;

102109 
	`sqlôe3Ex¥CacheCÀ¨
(
pP¨£
);

102110 
i
=0, 
pF
=
pAggInfo
->
aFunc
; i<pAggInfo->
nFunc
; i++,ÖF++){

102111 
nArg
;

102112 
addrNext
 = 0;

102113 
ªgAgg
;

102114 
Ex¥Li°
 *
pLi°
 = 
pF
->
pEx¥
->
x
.pList;

102115 
	`as£π
–!
	`Ex¥HasPr›îty
(
pF
->
pEx¥
, 
EP_xIsSñe˘
) );

102116 if–
pLi°
 ){

102117 
nArg
 = 
pLi°
->
nEx¥
;

102118 
ªgAgg
 = 
	`sqlôe3GëTempR™ge
(
pP¨£
, 
nArg
);

102119 
	`sqlôe3Ex¥CodeEx¥Li°
(
pP¨£
, 
pLi°
, 
ªgAgg
, 1);

102121 
nArg
 = 0;

102122 
ªgAgg
 = 0;

102124 if–
pF
->
iDi°ö˘
>=0 ){

102125 
addrNext
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

102126 
	`as£π
–
nArg
==1 );

102127 
	`codeDi°ö˘
(
pP¨£
, 
pF
->
iDi°ö˘
, 
addrNext
, 1, 
ªgAgg
);

102129 if–
pF
->
pFunc
->
funcFœgs
 & 
SQLITE_FUNC_NEEDCOLL
 ){

102130 
CﬁlSeq
 *
pCﬁl
 = 0;

102131 
Ex¥Li°_ôem
 *
pIãm
;

102132 
j
;

102133 
	`as£π
–
pLi°
!=0 );

102134 
j
=0, 
pIãm
=
pLi°
->
a
; !
pCﬁl
 && j<
nArg
; j++,ÖItem++){

102135 
pCﬁl
 = 
	`sqlôe3Ex¥CﬁlSeq
(
pP¨£
, 
pIãm
->
pEx¥
);

102137 if–!
pCﬁl
 ){

102138 
pCﬁl
 = 
pP¨£
->
db
->
pDÊtCﬁl
;

102140 if–
ªgHô
==0 && 
pAggInfo
->
nAccumuœt‹
 )ÑegHô = ++
pP¨£
->
nMem
;

102141 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_CﬁlSeq
, 
ªgHô
, 0, 0, (*)
pCﬁl
, 
P4_COLLSEQ
);

102143 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_AggSãp
, 0, 
ªgAgg
, 
pF
->
iMem
,

102144 (*)
pF
->
pFunc
, 
P4_FUNCDEF
);

102145 
	`sqlôe3VdbeCh™geP5
(
v
, (
u8
)
nArg
);

102146 
	`sqlôe3Ex¥CacheAfföôyCh™ge
(
pP¨£
, 
ªgAgg
, 
nArg
);

102147 
	`sqlôe3Rñó£TempR™ge
(
pP¨£
, 
ªgAgg
, 
nArg
);

102148 if–
addrNext
 ){

102149 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
addrNext
);

102150 
	`sqlôe3Ex¥CacheCÀ¨
(
pP¨£
);

102164 if–
ªgHô
 ){

102165 
addrHôTe°
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_If
, 
ªgHô
);

102167 
	`sqlôe3Ex¥CacheCÀ¨
(
pP¨£
);

102168 
i
=0, 
pC
=
pAggInfo
->
aCﬁ
; i<pAggInfo->
nAccumuœt‹
; i++,ÖC++){

102169 
	`sqlôe3Ex¥Code
(
pP¨£
, 
pC
->
pEx¥
,ÖC->
iMem
);

102171 
pAggInfo
->
dúe˘Mode
 = 0;

102172 
	`sqlôe3Ex¥CacheCÀ¨
(
pP¨£
);

102173 if–
addrHôTe°
 ){

102174 
	`sqlôe3VdbeJumpHîe
(
v
, 
addrHôTe°
);

102182 #i‚de‡
SQLITE_OMIT_EXPLAIN


102183 
	`ex∂aöSim∂eCou¡
(

102184 
P¨£
 *
pP¨£
,

102185 
TabÀ
 *
pTab
,

102186 
Index
 *
pIdx


102188 if–
pP¨£
->
ex∂aö
==2 ){

102189 *
zEqp
 = 
	`sqlôe3MPrötf
(
pP¨£
->
db
, "SCAN TABLE %s%s%s",

102190 
pTab
->
zName
,

102191 
pIdx
 ? " USING COVERING INDEX " : "",

102192 
pIdx
 ?ÖIdx->
zName
 : ""

102194 
	`sqlôe3VdbeAddOp4
(

102195 
pP¨£
->
pVdbe
, 
OP_Ex∂aö
,ÖP¨£->
iSñe˘Id
, 0, 0, 
zEqp
, 
P4_DYNAMIC


102200 
	#ex∂aöSim∂eCou¡
(
a
,
b
,
c
)

	)

102258 
SQLITE_PRIVATE
 
	`sqlôe3Sñe˘
(

102259 
P¨£
 *
pP¨£
,

102260 
Sñe˘
 *
p
,

102261 
Sñe˘De°
 *
pDe°


102263 
i
, 
j
;

102264 
WhîeInfo
 *
pWInfo
;

102265 
Vdbe
 *
v
;

102266 
isAgg
;

102267 
Ex¥Li°
 *
pELi°
;

102268 
SrcLi°
 *
pTabLi°
;

102269 
Ex¥
 *
pWhîe
;

102270 
Ex¥Li°
 *
pOrdîBy
;

102271 
Ex¥Li°
 *
pGroupBy
;

102272 
Ex¥
 *
pHavög
;

102273 
rc
 = 1;

102274 
addrS‹tIndex
;

102275 
Di°ö˘Ctx
 
sDi°ö˘
;

102276 
AggInfo
 
sAggInfo
;

102277 
iEnd
;

102278 
sqlôe3
 *
db
;

102280 #i‚de‡
SQLITE_OMIT_EXPLAIN


102281 
iRe°‹eSñe˘Id
 = 
pP¨£
->
iSñe˘Id
;

102282 
pP¨£
->
iSñe˘Id
 =ÖP¨£->
iNextSñe˘Id
++;

102285 
db
 = 
pP¨£
->db;

102286 if–
p
==0 || 
db
->
mÆlocFaûed
 || 
pP¨£
->
nEº
 ){

102289 if–
	`sqlôe3AuthCheck
(
pP¨£
, 
SQLITE_SELECT
, 0, 0, 0) )  1;

102290 
	`mem£t
(&
sAggInfo
, 0, (sAggInfo));

102292 if–
	`Ign‹abÀOrdîby
(
pDe°
) ){

102293 
	`as£π
(
pDe°
->
eDe°
==
SRT_Exi°s
 ||ÖDe°->eDe°==
SRT_Uni⁄
 ||

102294 
pDe°
->
eDe°
==
SRT_Ex˚±
 ||ÖDe°->eDe°==
SRT_Disˇrd
);

102297 
	`sqlôe3Ex¥Li°Dñëe
(
db
, 
p
->
pOrdîBy
);

102298 
p
->
pOrdîBy
 = 0;

102299 
p
->
£lFœgs
 &~
SF_Di°ö˘
;

102301 
	`sqlôe3Sñe˘Pªp
(
pP¨£
, 
p
, 0);

102302 
pOrdîBy
 = 
p
->pOrderBy;

102303 
pTabLi°
 = 
p
->
pSrc
;

102304 
pELi°
 = 
p
->pEList;

102305 if–
pP¨£
->
nEº
 || 
db
->
mÆlocFaûed
 ){

102306 
£À˘_íd
;

102308 
isAgg
 = (
p
->
£lFœgs
 & 
SF_Aggªg©e
)!=0;

102309 
	`as£π
–
pELi°
!=0 );

102313 
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

102314 if–
v
==0 ) 
£À˘_íd
;

102319 #i‚de‡
SQLITE_OMIT_SUBQUERY


102320 if–
	`checkF‹Mu…iCﬁumnSñe˘Eº‹
(
pP¨£
, 
pDe°
, 
pELi°
->
nEx¥
) ){

102321 
£À˘_íd
;

102327 #i‡!
	`deföed
(
SQLITE_OMIT_SUBQUERY
Ë|| !deföed(
SQLITE_OMIT_VIEW
)

102328 
i
=0; !
p
->
pPri‹
 && i<
pTabLi°
->
nSrc
; i++){

102329 
SrcLi°_ôem
 *
pIãm
 = &
pTabLi°
->
a
[
i
];

102330 
Sñe˘De°
 
de°
;

102331 
Sñe˘
 *
pSub
 = 
pIãm
->
pSñe˘
;

102332 
isAggSub
;

102334 if–
pSub
==0 ) ;

102342 if–
pIãm
->
addrFûlSub
 ){

102343 if–
pIãm
->
vüC‹outöe
==0 ){

102344 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Gosub
, 
pIãm
->
ªgRëu∫
,ÖIãm->
addrFûlSub
);

102356 
pP¨£
->
nHeight
 +
	`sqlôe3Sñe˘Ex¥Height
(
p
);

102358 
isAggSub
 = (
pSub
->
£lFœgs
 & 
SF_Aggªg©e
)!=0;

102359 if–
	`Ê©ãnSubquîy
(
pP¨£
, 
p
, 
i
, 
isAgg
, 
isAggSub
) ){

102361 if–
isAggSub
 ){

102362 
isAgg
 = 1;

102363 
p
->
£lFœgs
 |
SF_Aggªg©e
;

102365 
i
 = -1;

102366 }if–
pTabLi°
->
nSrc
==1 && (
p
->
£lFœgs
 & 
SF_M©îülize
)==0

102367 && 
	`O±imiz©i⁄E«bÀd
(
db
, 
SQLITE_SubqC‹outöe
)

102372 
addrT›
;

102373 
addrEof
;

102374 
pIãm
->
ªgRëu∫
 = ++
pP¨£
->
nMem
;

102375 
addrEof
 = ++
pP¨£
->
nMem
;

102384 
	`sqlôe3CodeVîifySchema
(
pP¨£
, -1);

102385 
	`sqlôe3VdbeAddOp0
(
v
, 
OP_GŸo
);

102386 
addrT›
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_O≥nP£udo
, 
pIãm
->
iCurs‹
);

102387 
	`sqlôe3VdbeCh™geP5
(
v
, 1);

102388 
	`VdbeCommít
((
v
, "c‹outöêf‹ %s", 
pIãm
->
pTab
->
zName
));

102389 
pIãm
->
addrFûlSub
 = 
addrT›
;

102390 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 0, 
addrEof
);

102391 
	`sqlôe3VdbeCh™geP5
(
v
, 1);

102392 
	`sqlôe3Sñe˘De°Inô
(&
de°
, 
SRT_C‹outöe
, 
pIãm
->
ªgRëu∫
);

102393 
	`ex∂aöSëI¡egî
(
pIãm
->
iSñe˘Id
, (
u8
)
pP¨£
->
iNextSñe˘Id
);

102394 
	`sqlôe3Sñe˘
(
pP¨£
, 
pSub
, &
de°
);

102395 
pIãm
->
pTab
->
nRowE°
 = ()
pSub
->
nSñe˘Row
;

102396 
pIãm
->
vüC‹outöe
 = 1;

102397 
	`sqlôe3VdbeCh™geP2
(
v
, 
addrT›
, 
de°
.
iSd°
);

102398 
	`sqlôe3VdbeCh™geP3
(
v
, 
addrT›
, 
de°
.
nSd°
);

102399 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 1, 
addrEof
);

102400 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Yõld
, 
pIãm
->
ªgRëu∫
);

102401 
	`VdbeCommít
((
v
, "íd %s", 
pIãm
->
pTab
->
zName
));

102402 
	`sqlôe3VdbeJumpHîe
(
v
, 
addrT›
-1);

102403 
	`sqlôe3CÀ¨TempRegCache
(
pP¨£
);

102410 
t›Addr
;

102411 
⁄˚Addr
 = 0;

102412 
ªtAddr
;

102413 
	`as£π
–
pIãm
->
addrFûlSub
==0 );

102414 
pIãm
->
ªgRëu∫
 = ++
pP¨£
->
nMem
;

102415 
t›Addr
 = 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 0, 
pIãm
->
ªgRëu∫
);

102416 
pIãm
->
addrFûlSub
 = 
t›Addr
+1;

102417 
	`VdbeNo›Commít
((
v
, "m©îülizê%s", 
pIãm
->
pTab
->
zName
));

102418 if–
pIãm
->
isC‹ªœãd
==0 ){

102422 
⁄˚Addr
 = 
	`sqlôe3CodeOn˚
(
pP¨£
);

102424 
	`sqlôe3Sñe˘De°Inô
(&
de°
, 
SRT_EphemTab
, 
pIãm
->
iCurs‹
);

102425 
	`ex∂aöSëI¡egî
(
pIãm
->
iSñe˘Id
, (
u8
)
pP¨£
->
iNextSñe˘Id
);

102426 
	`sqlôe3Sñe˘
(
pP¨£
, 
pSub
, &
de°
);

102427 
pIãm
->
pTab
->
nRowE°
 = ()
pSub
->
nSñe˘Row
;

102428 if–
⁄˚Addr
 ) 
	`sqlôe3VdbeJumpHîe
(
v
, onceAddr);

102429 
ªtAddr
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Rëu∫
, 
pIãm
->
ªgRëu∫
);

102430 
	`VdbeCommít
((
v
, "íd %s", 
pIãm
->
pTab
->
zName
));

102431 
	`sqlôe3VdbeCh™geP1
(
v
, 
t›Addr
, 
ªtAddr
);

102432 
	`sqlôe3CÀ¨TempRegCache
(
pP¨£
);

102434 if– 
db
->
mÆlocFaûed
 ){

102435 
£À˘_íd
;

102437 
pP¨£
->
nHeight
 -
	`sqlôe3Sñe˘Ex¥Height
(
p
);

102438 
pTabLi°
 = 
p
->
pSrc
;

102439 if–!
	`Ign‹abÀOrdîby
(
pDe°
) ){

102440 
pOrdîBy
 = 
p
->pOrderBy;

102443 
pELi°
 = 
p
->pEList;

102445 
pWhîe
 = 
p
->pWhere;

102446 
pGroupBy
 = 
p
->pGroupBy;

102447 
pHavög
 = 
p
->pHaving;

102448 
sDi°ö˘
.
isTn˘
 = (
p
->
£lFœgs
 & 
SF_Di°ö˘
)!=0;

102450 #i‚de‡
SQLITE_OMIT_COMPOUND_SELECT


102453 if–
p
->
pPri‹
 ){

102454 if–
p
->
pRightmo°
==0 ){

102455 
Sñe˘
 *
pLo›
, *
pRight
 = 0;

102456 
˙t
 = 0;

102457 
mxSñe˘
;

102458 
pLo›
=
p
;ÖLo›;ÖLo›ıLo›->
pPri‹
, 
˙t
++){

102459 
pLo›
->
pRightmo°
 = 
p
;

102460 
pLo›
->
pNext
 = 
pRight
;

102461 
pRight
 = 
pLo›
;

102463 
mxSñe˘
 = 
db
->
aLimô
[
SQLITE_LIMIT_COMPOUND_SELECT
];

102464 if–
mxSñe˘
 && 
˙t
>mxSelect ){

102465 
	`sqlôe3Eº‹Msg
(
pP¨£
, "too manyÅerms in compound SELECT");

102466 
£À˘_íd
;

102469 
rc
 = 
	`mu…iSñe˘
(
pP¨£
, 
p
, 
pDe°
);

102470 
	`ex∂aöSëI¡egî
(
pP¨£
->
iSñe˘Id
, 
iRe°‹eSñe˘Id
);

102471  
rc
;

102482 if–
	`sqlôe3Ex¥Li°Com∑ª
(
p
->
pGroupBy
, 
pOrdîBy
, -1)==0

102483 && 
	`O±imiz©i⁄E«bÀd
(
db
, 
SQLITE_GroupByOrdî
) ){

102484 
pOrdîBy
 = 0;

102502 if–(
p
->
£lFœgs
 & (
SF_Di°ö˘
|
SF_Aggªg©e
))==SF_Distinct

102503 && 
	`sqlôe3Ex¥Li°Com∑ª
(
pOrdîBy
, 
p
->
pELi°
, -1)==0

102505 
p
->
£lFœgs
 &~
SF_Di°ö˘
;

102506 
p
->
pGroupBy
 = 
	`sqlôe3Ex¥Li°Dup
(
db
,Ö->
pELi°
, 0);

102507 
pGroupBy
 = 
p
->pGroupBy;

102508 
pOrdîBy
 = 0;

102512 
	`as£π
–
sDi°ö˘
.
isTn˘
 );

102522 if–
pOrdîBy
 ){

102523 
KeyInfo
 *
pKeyInfo
;

102524 
pKeyInfo
 = 
	`keyInfoFromEx¥Li°
(
pP¨£
, 
pOrdîBy
);

102525 
pOrdîBy
->
iECurs‹
 = 
pP¨£
->
nTab
++;

102526 
p
->
addrO≥nEphm
[2] = 
addrS‹tIndex
 =

102527 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_O≥nEphemîÆ
,

102528 
pOrdîBy
->
iECurs‹
,ÖOrdîBy->
nEx¥
+2, 0,

102529 (*)
pKeyInfo
, 
P4_KEYINFO_HANDOFF
);

102531 
addrS‹tIndex
 = -1;

102536 if–
pDe°
->
eDe°
==
SRT_EphemTab
 ){

102537 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_O≥nEphemîÆ
, 
pDe°
->
iSDP¨m
, 
pELi°
->
nEx¥
);

102542 
iEnd
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

102543 
p
->
nSñe˘Row
 = 
LARGEST_INT64
;

102544 
	`compuãLimôRegi°îs
(
pP¨£
, 
p
, 
iEnd
);

102545 if–
p
->
iLimô
==0 && 
addrS‹tIndex
>=0 ){

102546 
	`sqlôe3VdbeGëOp
(
v
, 
addrS‹tIndex
)->
›code
 = 
OP_S‹ãrO≥n
;

102547 
p
->
£lFœgs
 |
SF_U£S‹ãr
;

102552 if–
p
->
£lFœgs
 & 
SF_Di°ö˘
 ){

102553 
sDi°ö˘
.
èbTn˘
 = 
pP¨£
->
nTab
++;

102554 
sDi°ö˘
.
addrTn˘
 = 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_O≥nEphemîÆ
,

102555 
sDi°ö˘
.
èbTn˘
, 0, 0,

102556 (*)
	`keyInfoFromEx¥Li°
(
pP¨£
, 
p
->
pELi°
),

102557 
P4_KEYINFO_HANDOFF
);

102558 
	`sqlôe3VdbeCh™geP5
(
v
, 
BTREE_UNORDERED
);

102559 
sDi°ö˘
.
eTn˘Ty≥
 = 
WHERE_DISTINCT_UNORDERED
;

102561 
sDi°ö˘
.
eTn˘Ty≥
 = 
WHERE_DISTINCT_NOOP
;

102564 if–!
isAgg
 && 
pGroupBy
==0 ){

102566 
u16
 
w˘æFœgs
 = (
sDi°ö˘
.
isTn˘
 ? 
WHERE_WANT_DISTINCT
 : 0);

102569 
pWInfo
 = 
	`sqlôe3WhîeBegö
(
pP¨£
, 
pTabLi°
, 
pWhîe
, 
pOrdîBy
, 
p
->
pELi°
,

102570 
w˘æFœgs
, 0);

102571 if–
pWInfo
==0 ) 
£À˘_íd
;

102572 if–
	`sqlôe3WhîeOuçutRowCou¡
(
pWInfo
Ë< 
p
->
nSñe˘Row
 ){

102573 
p
->
nSñe˘Row
 = 
	`sqlôe3WhîeOuçutRowCou¡
(
pWInfo
);

102575 if–
sDi°ö˘
.
isTn˘
 && 
	`sqlôe3WhîeIsDi°ö˘
(
pWInfo
) ){

102576 
sDi°ö˘
.
eTn˘Ty≥
 = 
	`sqlôe3WhîeIsDi°ö˘
(
pWInfo
);

102578 if–
pOrdîBy
 && 
	`sqlôe3WhîeIsOrdîed
(
pWInfo
) )ÖOrderBy = 0;

102584 if–
addrS‹tIndex
>=0 && 
pOrdîBy
==0 ){

102585 
	`sqlôe3VdbeCh™geToNo›
(
v
, 
addrS‹tIndex
);

102586 
p
->
addrO≥nEphm
[2] = -1;

102590 
	`£À˘I¬îLo›
(
pP¨£
, 
p
, 
pELi°
, 0, 0, 
pOrdîBy
, &
sDi°ö˘
, 
pDe°
,

102591 
	`sqlôe3WhîeC⁄töueLabñ
(
pWInfo
),

102592 
	`sqlôe3WhîeBªakLabñ
(
pWInfo
));

102596 
	`sqlôe3WhîeEnd
(
pWInfo
);

102600 
NameC⁄ãxt
 
sNC
;

102601 
iAMem
;

102602 
iBMem
;

102603 
iU£Fœg
;

102606 
iAb‹tFœg
;

102607 
groupByS‹t
;

102608 
addrEnd
;

102609 
s‹tPTab
 = 0;

102610 
s‹tOut
 = 0;

102615 if–
pGroupBy
 ){

102616 
k
;

102617 
Ex¥Li°_ôem
 *
pIãm
;

102619 
k
=
p
->
pELi°
->
nEx¥
, 
pIãm
ı->pELi°->
a
; k>0; k--,ÖItem++){

102620 
pIãm
->
iAlüs
 = 0;

102622 
k
=
pGroupBy
->
nEx¥
, 
pIãm
ıGroupBy->
a
; k>0; k--,ÖItem++){

102623 
pIãm
->
iAlüs
 = 0;

102625 if–
p
->
nSñe˘Row
>100 )Ö->nSelectRow = 100;

102627 
p
->
nSñe˘Row
 = 1;

102632 
addrEnd
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

102638 
	`mem£t
(&
sNC
, 0, (sNC));

102639 
sNC
.
pP¨£
 =ÖParse;

102640 
sNC
.
pSrcLi°
 = 
pTabLi°
;

102641 
sNC
.
pAggInfo
 = &
sAggInfo
;

102642 
sAggInfo
.
nS‹tögCﬁumn
 = 
pGroupBy
 ?ÖGroupBy->
nEx¥
+1 : 0;

102643 
sAggInfo
.
pGroupBy
 =ÖGroupBy;

102644 
	`sqlôe3Ex¥A«lyzeAggLi°
(&
sNC
, 
pELi°
);

102645 
	`sqlôe3Ex¥A«lyzeAggLi°
(&
sNC
, 
pOrdîBy
);

102646 if–
pHavög
 ){

102647 
	`sqlôe3Ex¥A«lyzeAggªg©es
(&
sNC
, 
pHavög
);

102649 
sAggInfo
.
nAccumuœt‹
 = sAggInfo.
nCﬁumn
;

102650 
i
=0; i<
sAggInfo
.
nFunc
; i++){

102651 
	`as£π
–!
	`Ex¥HasPr›îty
(
sAggInfo
.
aFunc
[
i
].
pEx¥
, 
EP_xIsSñe˘
) );

102652 
sNC
.
ncFœgs
 |
NC_InAggFunc
;

102653 
	`sqlôe3Ex¥A«lyzeAggLi°
(&
sNC
, 
sAggInfo
.
aFunc
[
i
].
pEx¥
->
x
.
pLi°
);

102654 
sNC
.
ncFœgs
 &~
NC_InAggFunc
;

102656 if–
db
->
mÆlocFaûed
 ) 
£À˘_íd
;

102661 if–
pGroupBy
 ){

102662 
KeyInfo
 *
pKeyInfo
;

102663 
j1
;

102664 
addrOuçutRow
;

102665 
ªgOuçutRow
;

102666 
addrSëAb‹t
;

102667 
addrT›OfLo›
;

102668 
addrS‹tögIdx
;

102669 
addrRe£t
;

102670 
ªgRe£t
;

102677 
sAggInfo
.
s‹tögIdx
 = 
pP¨£
->
nTab
++;

102678 
pKeyInfo
 = 
	`keyInfoFromEx¥Li°
(
pP¨£
, 
pGroupBy
);

102679 
addrS‹tögIdx
 = 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_S‹ãrO≥n
,

102680 
sAggInfo
.
s‹tögIdx
, sAggInfo.
nS‹tögCﬁumn
,

102681 0, (*)
pKeyInfo
, 
P4_KEYINFO_HANDOFF
);

102685 
iU£Fœg
 = ++
pP¨£
->
nMem
;

102686 
iAb‹tFœg
 = ++
pP¨£
->
nMem
;

102687 
ªgOuçutRow
 = ++
pP¨£
->
nMem
;

102688 
addrOuçutRow
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

102689 
ªgRe£t
 = ++
pP¨£
->
nMem
;

102690 
addrRe£t
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

102691 
iAMem
 = 
pP¨£
->
nMem
 + 1;

102692 
pP¨£
->
nMem
 +
pGroupBy
->
nEx¥
;

102693 
iBMem
 = 
pP¨£
->
nMem
 + 1;

102694 
pP¨£
->
nMem
 +
pGroupBy
->
nEx¥
;

102695 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 0, 
iAb‹tFœg
);

102696 
	`VdbeCommít
((
v
, "clearábort flag"));

102697 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 0, 
iU£Fœg
);

102698 
	`VdbeCommít
((
v
, "indicateáccumulatorÉmpty"));

102699 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_NuŒ
, 0, 
iAMem
, iAMem+
pGroupBy
->
nEx¥
-1);

102706 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Gosub
, 
ªgRe£t
, 
addrRe£t
);

102707 
pWInfo
 = 
	`sqlôe3WhîeBegö
(
pP¨£
, 
pTabLi°
, 
pWhîe
, 
pGroupBy
, 0,

102708 
WHERE_GROUPBY
, 0);

102709 if–
pWInfo
==0 ) 
£À˘_íd
;

102710 if–
	`sqlôe3WhîeIsOrdîed
(
pWInfo
) ){

102715 
groupByS‹t
 = 0;

102722 
ªgBa£
;

102723 
ªgRec‹d
;

102724 
nCﬁ
;

102725 
nGroupBy
;

102727 
	`ex∂aöTempTabÀ
(
pP¨£
,

102728 (
sDi°ö˘
.
isTn˘
 && (
p
->
£lFœgs
&
SF_Di°ö˘
)==0) ?

102731 
groupByS‹t
 = 1;

102732 
nGroupBy
 = 
pGroupBy
->
nEx¥
;

102733 
nCﬁ
 = 
nGroupBy
 + 1;

102734 
j
 = 
nGroupBy
+1;

102735 
i
=0; i<
sAggInfo
.
nCﬁumn
; i++){

102736 if–
sAggInfo
.
aCﬁ
[
i
].
iS‹ãrCﬁumn
>=
j
 ){

102737 
nCﬁ
++;

102738 
j
++;

102741 
ªgBa£
 = 
	`sqlôe3GëTempR™ge
(
pP¨£
, 
nCﬁ
);

102742 
	`sqlôe3Ex¥CacheCÀ¨
(
pP¨£
);

102743 
	`sqlôe3Ex¥CodeEx¥Li°
(
pP¨£
, 
pGroupBy
, 
ªgBa£
, 0);

102744 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Sequí˚
, 
sAggInfo
.
s‹tögIdx
,
ªgBa£
+
nGroupBy
);

102745 
j
 = 
nGroupBy
+1;

102746 
i
=0; i<
sAggInfo
.
nCﬁumn
; i++){

102747 
AggInfo_cﬁ
 *
pCﬁ
 = &
sAggInfo
.
aCﬁ
[
i
];

102748 if–
pCﬁ
->
iS‹ãrCﬁumn
>=
j
 ){

102749 
r1
 = 
j
 + 
ªgBa£
;

102750 
r2
;

102752 
r2
 = 
	`sqlôe3Ex¥CodeGëCﬁumn
(
pP¨£
,

102753 
pCﬁ
->
pTab
,ÖCﬁ->
iCﬁumn
,ÖCﬁ->
iTabÀ
, 
r1
, 0);

102754 if–
r1
!=
r2
 ){

102755 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_SC›y
, 
r2
, 
r1
);

102757 
j
++;

102760 
ªgRec‹d
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

102761 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_MakeRec‹d
, 
ªgBa£
, 
nCﬁ
, 
ªgRec‹d
);

102762 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_S‹ãrIn£π
, 
sAggInfo
.
s‹tögIdx
, 
ªgRec‹d
);

102763 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
ªgRec‹d
);

102764 
	`sqlôe3Rñó£TempR™ge
(
pP¨£
, 
ªgBa£
, 
nCﬁ
);

102765 
	`sqlôe3WhîeEnd
(
pWInfo
);

102766 
sAggInfo
.
s‹tögIdxPTab
 = 
s‹tPTab
 = 
pP¨£
->
nTab
++;

102767 
s‹tOut
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

102768 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_O≥nP£udo
, 
s‹tPTab
, 
s‹tOut
, 
nCﬁ
);

102769 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_S‹ãrS‹t
, 
sAggInfo
.
s‹tögIdx
, 
addrEnd
);

102770 
	`VdbeCommít
((
v
, "GROUP BY sort"));

102771 
sAggInfo
.
u£S‹tögIdx
 = 1;

102772 
	`sqlôe3Ex¥CacheCÀ¨
(
pP¨£
);

102780 
addrT›OfLo›
 = 
	`sqlôe3VdbeCuºítAddr
(
v
);

102781 
	`sqlôe3Ex¥CacheCÀ¨
(
pP¨£
);

102782 if–
groupByS‹t
 ){

102783 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_S‹ãrD©a
, 
sAggInfo
.
s‹tögIdx
, 
s‹tOut
);

102785 
j
=0; j<
pGroupBy
->
nEx¥
; j++){

102786 if–
groupByS‹t
 ){

102787 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Cﬁumn
, 
s‹tPTab
, 
j
, 
iBMem
+j);

102788 if–
j
==0 ) 
	`sqlôe3VdbeCh™geP5
(
v
, 
OPFLAG_CLEARCACHE
);

102790 
sAggInfo
.
dúe˘Mode
 = 1;

102791 
	`sqlôe3Ex¥Code
(
pP¨£
, 
pGroupBy
->
a
[
j
].
pEx¥
, 
iBMem
+j);

102794 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Com∑ª
, 
iAMem
, 
iBMem
, 
pGroupBy
->
nEx¥
,

102795 (*)
pKeyInfo
, 
P4_KEYINFO
);

102796 
j1
 = 
	`sqlôe3VdbeCuºítAddr
(
v
);

102797 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Jump
, 
j1
+1, 0, j1+1);

102808 
	`sqlôe3Ex¥CodeMove
(
pP¨£
, 
iBMem
, 
iAMem
, 
pGroupBy
->
nEx¥
);

102809 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Gosub
, 
ªgOuçutRow
, 
addrOuçutRow
);

102810 
	`VdbeCommít
((
v
, "output oneÑow"));

102811 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_IfPos
, 
iAb‹tFœg
, 
addrEnd
);

102812 
	`VdbeCommít
((
v
, "checkábort flag"));

102813 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Gosub
, 
ªgRe£t
, 
addrRe£t
);

102814 
	`VdbeCommít
((
v
, "resetáccumulator"));

102819 
	`sqlôe3VdbeJumpHîe
(
v
, 
j1
);

102820 
	`upd©eAccumuœt‹
(
pP¨£
, &
sAggInfo
);

102821 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 1, 
iU£Fœg
);

102822 
	`VdbeCommít
((
v
, "indicate data ináccumulator"));

102826 if–
groupByS‹t
 ){

102827 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_S‹ãrNext
, 
sAggInfo
.
s‹tögIdx
, 
addrT›OfLo›
);

102829 
	`sqlôe3WhîeEnd
(
pWInfo
);

102830 
	`sqlôe3VdbeCh™geToNo›
(
v
, 
addrS‹tögIdx
);

102835 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Gosub
, 
ªgOuçutRow
, 
addrOuçutRow
);

102836 
	`VdbeCommít
((
v
, "output finalÑow"));

102840 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_GŸo
, 0, 
addrEnd
);

102849 
addrSëAb‹t
 = 
	`sqlôe3VdbeCuºítAddr
(
v
);

102850 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 1, 
iAb‹tFœg
);

102851 
	`VdbeCommít
((
v
, "setábort flag"));

102852 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Rëu∫
, 
ªgOuçutRow
);

102853 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
addrOuçutRow
);

102854 
addrOuçutRow
 = 
	`sqlôe3VdbeCuºítAddr
(
v
);

102855 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_IfPos
, 
iU£Fœg
, 
addrOuçutRow
+2);

102856 
	`VdbeCommít
((
v
, "GroupbyÑesult generatorÉntryÖoint"));

102857 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Rëu∫
, 
ªgOuçutRow
);

102858 
	`föÆizeAggFun˘i⁄s
(
pP¨£
, &
sAggInfo
);

102859 
	`sqlôe3Ex¥IfFÆ£
(
pP¨£
, 
pHavög
, 
addrOuçutRow
+1, 
SQLITE_JUMPIFNULL
);

102860 
	`£À˘I¬îLo›
(
pP¨£
, 
p
,Ö->
pELi°
, 0, 0, 
pOrdîBy
,

102861 &
sDi°ö˘
, 
pDe°
,

102862 
addrOuçutRow
+1, 
addrSëAb‹t
);

102863 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Rëu∫
, 
ªgOuçutRow
);

102864 
	`VdbeCommít
((
v
, "end groupbyÑesult generator"));

102868 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
addrRe£t
);

102869 
	`ª£tAccumuœt‹
(
pP¨£
, &
sAggInfo
);

102870 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Rëu∫
, 
ªgRe£t
);

102874 
Ex¥Li°
 *
pDñ
 = 0;

102875 #i‚de‡
SQLITE_OMIT_BTREECOUNT


102876 
TabÀ
 *
pTab
;

102877 if–(
pTab
 = 
	`isSim∂eCou¡
(
p
, &
sAggInfo
))!=0 ){

102891 c⁄° 
iDb
 = 
	`sqlôe3SchemaToIndex
(
pP¨£
->
db
, 
pTab
->
pSchema
);

102892 c⁄° 
iC§
 = 
pP¨£
->
nTab
++;

102893 
Index
 *
pIdx
;

102894 
KeyInfo
 *
pKeyInfo
 = 0;

102895 
Index
 *
pBe°
 = 0;

102896 
iRoŸ
 = 
pTab
->
äum
;

102898 
	`sqlôe3CodeVîifySchema
(
pP¨£
, 
iDb
);

102899 
	`sqlôe3TabÀLock
(
pP¨£
, 
iDb
, 
pTab
->
äum
, 0,ÖTab->
zName
);

102910 
pIdx
=
pTab
->
pIndex
;ÖIdx;ÖIdxıIdx->
pNext
){

102911 if–
pIdx
->
bUn‹dîed
==0

102912 && 
pIdx
->
szIdxRow
<
pTab
->
szTabRow


102913 && 
pIdx
->
pP¨tIdxWhîe
==0

102914 && (!
pBe°
 || 
pIdx
->
szIdxRow
<pBest->szIdxRow)

102916 
pBe°
 = 
pIdx
;

102919 if–
pBe°
 ){

102920 
iRoŸ
 = 
pBe°
->
äum
;

102921 
pKeyInfo
 = 
	`sqlôe3IndexKeyöfo
(
pP¨£
, 
pBe°
);

102925 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_O≥nRód
, 
iC§
, 
iRoŸ
, 
iDb
);

102926 if–
pKeyInfo
 ){

102927 
	`sqlôe3VdbeCh™geP4
(
v
, -1, (*)
pKeyInfo
, 
P4_KEYINFO_HANDOFF
);

102929 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Cou¡
, 
iC§
, 
sAggInfo
.
aFunc
[0].
iMem
);

102930 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Clo£
, 
iC§
);

102931 
	`ex∂aöSim∂eCou¡
(
pP¨£
, 
pTab
, 
pBe°
);

102960 
Ex¥Li°
 *
pMöMax
 = 0;

102961 
u8
 
Êag
 = 
WHERE_ORDERBY_NORMAL
;

102963 
	`as£π
–
p
->
pGroupBy
==0 );

102964 
	`as£π
–
Êag
==0 );

102965 if–
p
->
pHavög
==0 ){

102966 
Êag
 = 
	`möMaxQuîy
(&
sAggInfo
, &
pMöMax
);

102968 
	`as£π
–
Êag
==0 || (
pMöMax
!=0 &&ÖMöMax->
nEx¥
==1) );

102970 if–
Êag
 ){

102971 
pMöMax
 = 
	`sqlôe3Ex¥Li°Dup
(
db
,ÖMinMax, 0);

102972 
pDñ
 = 
pMöMax
;

102973 if–
pMöMax
 && !
db
->
mÆlocFaûed
 ){

102974 
pMöMax
->
a
[0].
s‹tOrdî
 = 
Êag
!=
WHERE_ORDERBY_MIN
 ?1:0;

102975 
pMöMax
->
a
[0].
pEx¥
->
›
 = 
TK_COLUMN
;

102983 
	`ª£tAccumuœt‹
(
pP¨£
, &
sAggInfo
);

102984 
pWInfo
 = 
	`sqlôe3WhîeBegö
(
pP¨£
, 
pTabLi°
, 
pWhîe
, 
pMöMax
,0,
Êag
,0);

102985 if–
pWInfo
==0 ){

102986 
	`sqlôe3Ex¥Li°Dñëe
(
db
, 
pDñ
);

102987 
£À˘_íd
;

102989 
	`upd©eAccumuœt‹
(
pP¨£
, &
sAggInfo
);

102990 
	`as£π
–
pMöMax
==0 ||ÖMöMax->
nEx¥
==1 );

102991 if–
	`sqlôe3WhîeIsOrdîed
(
pWInfo
) ){

102992 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_GŸo
, 0, 
	`sqlôe3WhîeBªakLabñ
(
pWInfo
));

102993 
	`VdbeCommít
((
v
, "%s() by index",

102994 (
Êag
==
WHERE_ORDERBY_MIN
?"min":"max")));

102996 
	`sqlôe3WhîeEnd
(
pWInfo
);

102997 
	`föÆizeAggFun˘i⁄s
(
pP¨£
, &
sAggInfo
);

103000 
pOrdîBy
 = 0;

103001 
	`sqlôe3Ex¥IfFÆ£
(
pP¨£
, 
pHavög
, 
addrEnd
, 
SQLITE_JUMPIFNULL
);

103002 
	`£À˘I¬îLo›
(
pP¨£
, 
p
,Ö->
pELi°
, 0, 0, 0, 0,

103003 
pDe°
, 
addrEnd
,áddrEnd);

103004 
	`sqlôe3Ex¥Li°Dñëe
(
db
, 
pDñ
);

103006 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
addrEnd
);

103010 if–
sDi°ö˘
.
eTn˘Ty≥
==
WHERE_DISTINCT_UNORDERED
 ){

103011 
	`ex∂aöTempTabÀ
(
pP¨£
, "DISTINCT");

103017 if–
pOrdîBy
 ){

103018 
	`ex∂aöTempTabÀ
(
pP¨£
, "ORDER BY");

103019 
	`gíî©eS‹tTaû
(
pP¨£
, 
p
, 
v
, 
pELi°
->
nEx¥
, 
pDe°
);

103024 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
iEnd
);

103029 
rc
 = 0;

103034 
£À˘_íd
:

103035 
	`ex∂aöSëI¡egî
(
pP¨£
->
iSñe˘Id
, 
iRe°‹eSñe˘Id
);

103039 if–
rc
==
SQLITE_OK
 && 
pDe°
->
eDe°
==
SRT_Ouçut
 ){

103040 
	`gíî©eCﬁumnNames
(
pP¨£
, 
pTabLi°
, 
pELi°
);

103043 
	`sqlôe3DbFªe
(
db
, 
sAggInfo
.
aCﬁ
);

103044 
	`sqlôe3DbFªe
(
db
, 
sAggInfo
.
aFunc
);

103045  
rc
;

103048 #i‡
	`deföed
(
SQLITE_ENABLE_TREE_EXPLAIN
)

103052 
	`ex∂aöO√Sñe˘
(
Vdbe
 *
pVdbe
, 
Sñe˘
 *
p
){

103053 
	`sqlôe3Ex∂aöPrötf
(
pVdbe
, "SELECT ");

103054 if–
p
->
£lFœgs
 & (
SF_Di°ö˘
|
SF_Aggªg©e
) ){

103055 if–
p
->
£lFœgs
 & 
SF_Di°ö˘
 ){

103056 
	`sqlôe3Ex∂aöPrötf
(
pVdbe
, "DISTINCT ");

103058 if–
p
->
£lFœgs
 & 
SF_Aggªg©e
 ){

103059 
	`sqlôe3Ex∂aöPrötf
(
pVdbe
, "agg_flag ");

103061 
	`sqlôe3Ex∂aöNL
(
pVdbe
);

103062 
	`sqlôe3Ex∂aöPrötf
(
pVdbe
, " ");

103064 
	`sqlôe3Ex∂aöEx¥Li°
(
pVdbe
, 
p
->
pELi°
);

103065 
	`sqlôe3Ex∂aöNL
(
pVdbe
);

103066 if–
p
->
pSrc
 &&Ö->pSrc->
nSrc
 ){

103067 
i
;

103068 
	`sqlôe3Ex∂aöPrötf
(
pVdbe
, "FROM ");

103069 
	`sqlôe3Ex∂aöPush
(
pVdbe
);

103070 
i
=0; i<
p
->
pSrc
->
nSrc
; i++){

103071 
SrcLi°_ôem
 *
pIãm
 = &
p
->
pSrc
->
a
[
i
];

103072 
	`sqlôe3Ex∂aöPrötf
(
pVdbe
, "{%d,*} = ", 
pIãm
->
iCurs‹
);

103073 if–
pIãm
->
pSñe˘
 ){

103074 
	`sqlôe3Ex∂aöSñe˘
(
pVdbe
, 
pIãm
->
pSñe˘
);

103075 if–
pIãm
->
pTab
 ){

103076 
	`sqlôe3Ex∂aöPrötf
(
pVdbe
, " (èb«me=%s)", 
pIãm
->
pTab
->
zName
);

103078 }if–
pIãm
->
zName
 ){

103079 
	`sqlôe3Ex∂aöPrötf
(
pVdbe
, "%s", 
pIãm
->
zName
);

103081 if–
pIãm
->
zAlüs
 ){

103082 
	`sqlôe3Ex∂aöPrötf
(
pVdbe
, " (AS %s)", 
pIãm
->
zAlüs
);

103084 if–
pIãm
->
joöty≥
 & 
JT_LEFT
 ){

103085 
	`sqlôe3Ex∂aöPrötf
(
pVdbe
, " LEFT-JOIN");

103087 
	`sqlôe3Ex∂aöNL
(
pVdbe
);

103089 
	`sqlôe3Ex∂aöP›
(
pVdbe
);

103091 if–
p
->
pWhîe
 ){

103092 
	`sqlôe3Ex∂aöPrötf
(
pVdbe
, "WHERE ");

103093 
	`sqlôe3Ex∂aöEx¥
(
pVdbe
, 
p
->
pWhîe
);

103094 
	`sqlôe3Ex∂aöNL
(
pVdbe
);

103096 if–
p
->
pGroupBy
 ){

103097 
	`sqlôe3Ex∂aöPrötf
(
pVdbe
, "GROUPBY ");

103098 
	`sqlôe3Ex∂aöEx¥Li°
(
pVdbe
, 
p
->
pGroupBy
);

103099 
	`sqlôe3Ex∂aöNL
(
pVdbe
);

103101 if–
p
->
pHavög
 ){

103102 
	`sqlôe3Ex∂aöPrötf
(
pVdbe
, "HAVING ");

103103 
	`sqlôe3Ex∂aöEx¥
(
pVdbe
, 
p
->
pHavög
);

103104 
	`sqlôe3Ex∂aöNL
(
pVdbe
);

103106 if–
p
->
pOrdîBy
 ){

103107 
	`sqlôe3Ex∂aöPrötf
(
pVdbe
, "ORDERBY ");

103108 
	`sqlôe3Ex∂aöEx¥Li°
(
pVdbe
, 
p
->
pOrdîBy
);

103109 
	`sqlôe3Ex∂aöNL
(
pVdbe
);

103111 if–
p
->
pLimô
 ){

103112 
	`sqlôe3Ex∂aöPrötf
(
pVdbe
, "LIMIT ");

103113 
	`sqlôe3Ex∂aöEx¥
(
pVdbe
, 
p
->
pLimô
);

103114 
	`sqlôe3Ex∂aöNL
(
pVdbe
);

103116 if–
p
->
pOff£t
 ){

103117 
	`sqlôe3Ex∂aöPrötf
(
pVdbe
, "OFFSET ");

103118 
	`sqlôe3Ex∂aöEx¥
(
pVdbe
, 
p
->
pOff£t
);

103119 
	`sqlôe3Ex∂aöNL
(
pVdbe
);

103122 
SQLITE_PRIVATE
 
	`sqlôe3Ex∂aöSñe˘
(
Vdbe
 *
pVdbe
, 
Sñe˘
 *
p
){

103123 if–
p
==0 ){

103124 
	`sqlôe3Ex∂aöPrötf
(
pVdbe
, "(null-select)");

103127  
p
->
pPri‹
 ){

103128 
p
->
pPri‹
->
pNext
 =Ö;

103129 
p
 =Ö->
pPri‹
;

103131 
	`sqlôe3Ex∂aöPush
(
pVdbe
);

103132  
p
 ){

103133 
	`ex∂aöO√Sñe˘
(
pVdbe
, 
p
);

103134 
p
 =Ö->
pNext
;

103135 if–
p
==0 ) ;

103136 
	`sqlôe3Ex∂aöNL
(
pVdbe
);

103137 
	`sqlôe3Ex∂aöPrötf
(
pVdbe
, "%s\n", 
	`£À˘OpName
(
p
->
›
));

103139 
	`sqlôe3Ex∂aöPrötf
(
pVdbe
, "END");

103140 
	`sqlôe3Ex∂aöP›
(
pVdbe
);

103170 #i‚de‡
SQLITE_OMIT_GET_TABLE


103176 
	sTabResu…
 {

103177 **
azResu…
;

103178 *
zEºMsg
;

103179 
nAŒoc
;

103180 
nRow
;

103181 
nCﬁumn
;

103182 
nD©a
;

103183 
rc
;

103184 } 
	tTabResu…
;

103191 
	`sqlôe3_gë_èbÀ_cb
(*
pArg
, 
nCﬁ
, **
¨gv
, **
cﬁv
){

103192 
TabResu…
 *
p
 = (TabResu…*)
pArg
;

103193 
√ed
;

103194 
i
;

103195 *
z
;

103200 if–
p
->
nRow
==0 && 
¨gv
!=0 ){

103201 
√ed
 = 
nCﬁ
*2;

103203 
√ed
 = 
nCﬁ
;

103205 if–
p
->
nD©a
 + 
√ed
 >Ö->
nAŒoc
 ){

103206 **
azNew
;

103207 
p
->
nAŒoc
 =Ö->nAŒoc*2 + 
√ed
;

103208 
azNew
 = 
	`sqlôe3_ªÆloc
–
p
->
azResu…
, (*)*p->
nAŒoc
 );

103209 if–
azNew
==0 ) 
mÆloc_Áûed
;

103210 
p
->
azResu…
 = 
azNew
;

103216 if–
p
->
nRow
==0 ){

103217 
p
->
nCﬁumn
 = 
nCﬁ
;

103218 
i
=0; i<
nCﬁ
; i++){

103219 
z
 = 
	`sqlôe3_m¥ötf
("%s", 
cﬁv
[
i
]);

103220 if–
z
==0 ) 
mÆloc_Áûed
;

103221 
p
->
azResu…
[p->
nD©a
++] = 
z
;

103223 }if–
p
->
nCﬁumn
!=
nCﬁ
 ){

103224 
	`sqlôe3_‰ì
(
p
->
zEºMsg
);

103225 
p
->
zEºMsg
 = 
	`sqlôe3_m¥ötf
(

103228 
p
->
rc
 = 
SQLITE_ERROR
;

103234 if–
¨gv
!=0 ){

103235 
i
=0; i<
nCﬁ
; i++){

103236 if–
¨gv
[
i
]==0 ){

103237 
z
 = 0;

103239 
n
 = 
	`sqlôe3SåÀn30
(
¨gv
[
i
])+1;

103240 
z
 = 
	`sqlôe3_mÆloc
–
n
 );

103241 if–
z
==0 ) 
mÆloc_Áûed
;

103242 
	`mem˝y
(
z
, 
¨gv
[
i
], 
n
);

103244 
p
->
azResu…
[p->
nD©a
++] = 
z
;

103246 
p
->
nRow
++;

103250 
mÆloc_Áûed
:

103251 
p
->
rc
 = 
SQLITE_NOMEM
;

103265 
SQLITE_API
 
	`sqlôe3_gë_èbÀ
(

103266 
sqlôe3
 *
db
,

103267 c⁄° *
zSql
,

103268 ***
∑zResu…
,

103269 *
≤Row
,

103270 *
≤Cﬁumn
,

103271 **
pzEºMsg


103273 
rc
;

103274 
TabResu…
 
ªs
;

103276 *
∑zResu…
 = 0;

103277 if–
≤Cﬁumn
 ) *pnColumn = 0;

103278 if–
≤Row
 ) *pnRow = 0;

103279 if–
pzEºMsg
 ) *pzErrMsg = 0;

103280 
ªs
.
zEºMsg
 = 0;

103281 
ªs
.
nRow
 = 0;

103282 
ªs
.
nCﬁumn
 = 0;

103283 
ªs
.
nD©a
 = 1;

103284 
ªs
.
nAŒoc
 = 20;

103285 
ªs
.
rc
 = 
SQLITE_OK
;

103286 
ªs
.
azResu…
 = 
	`sqlôe3_mÆloc
((*)*ªs.
nAŒoc
 );

103287 if–
ªs
.
azResu…
==0 ){

103288 
db
->
îrCode
 = 
SQLITE_NOMEM
;

103289  
SQLITE_NOMEM
;

103291 
ªs
.
azResu…
[0] = 0;

103292 
rc
 = 
	`sqlôe3_exec
(
db
, 
zSql
, 
sqlôe3_gë_èbÀ_cb
, &
ªs
, 
pzEºMsg
);

103293 
	`as£π
–(
ªs
.
azResu…
[0])>‘es.
nD©a
) );

103294 
ªs
.
azResu…
[0] = 
	`SQLITE_INT_TO_PTR
‘es.
nD©a
);

103295 if–(
rc
&0xff)==
SQLITE_ABORT
 ){

103296 
	`sqlôe3_‰ì_èbÀ
(&
ªs
.
azResu…
[1]);

103297 if–
ªs
.
zEºMsg
 ){

103298 if–
pzEºMsg
 ){

103299 
	`sqlôe3_‰ì
(*
pzEºMsg
);

103300 *
pzEºMsg
 = 
	`sqlôe3_m¥ötf
("%s",
ªs
.
zEºMsg
);

103302 
	`sqlôe3_‰ì
(
ªs
.
zEºMsg
);

103304 
db
->
îrCode
 = 
ªs
.
rc
;

103305  
ªs
.
rc
;

103307 
	`sqlôe3_‰ì
(
ªs
.
zEºMsg
);

103308 if–
rc
!=
SQLITE_OK
 ){

103309 
	`sqlôe3_‰ì_èbÀ
(&
ªs
.
azResu…
[1]);

103310  
rc
;

103312 if–
ªs
.
nAŒoc
>ªs.
nD©a
 ){

103313 **
azNew
;

103314 
azNew
 = 
	`sqlôe3_ªÆloc
–
ªs
.
azResu…
, (*)*ªs.
nD©a
 );

103315 if–
azNew
==0 ){

103316 
	`sqlôe3_‰ì_èbÀ
(&
ªs
.
azResu…
[1]);

103317 
db
->
îrCode
 = 
SQLITE_NOMEM
;

103318  
SQLITE_NOMEM
;

103320 
ªs
.
azResu…
 = 
azNew
;

103322 *
∑zResu…
 = &
ªs
.
azResu…
[1];

103323 if–
≤Cﬁumn
 ) *≤Cﬁum¿
ªs
.
nCﬁumn
;

103324 if–
≤Row
 ) *≤Row = 
ªs
.
nRow
;

103325  
rc
;

103331 
SQLITE_API
 
	`sqlôe3_‰ì_èbÀ
(

103332 **
azResu…


103334 if–
azResu…
 ){

103335 
i
, 
n
;

103336 
azResu…
--;

103337 
	`as£π
–
azResu…
!=0 );

103338 
n
 = 
	`SQLITE_PTR_TO_INT
(
azResu…
[0]);

103339 
i
=1; i<
n
; i++){ if–
azResu…
[i] ) 
	`sqlôe3_‰ì
(azResult[i]); }

103340 
	`sqlôe3_‰ì
(
azResu…
);

103361 #i‚de‡
SQLITE_OMIT_TRIGGER


103365 
SQLITE_PRIVATE
 
	`sqlôe3DñëeTriggîSãp
(
sqlôe3
 *
db
, 
TriggîSãp
 *
pTriggîSãp
){

103366  
pTriggîSãp
 ){

103367 
TriggîSãp
 * 
pTmp
 = 
pTriggîSãp
;

103368 
pTriggîSãp
 =ÖTriggîSãp->
pNext
;

103370 
	`sqlôe3Ex¥Dñëe
(
db
, 
pTmp
->
pWhîe
);

103371 
	`sqlôe3Ex¥Li°Dñëe
(
db
, 
pTmp
->
pEx¥Li°
);

103372 
	`sqlôe3Sñe˘Dñëe
(
db
, 
pTmp
->
pSñe˘
);

103373 
	`sqlôe3IdLi°Dñëe
(
db
, 
pTmp
->
pIdLi°
);

103375 
	`sqlôe3DbFªe
(
db
, 
pTmp
);

103393 
SQLITE_PRIVATE
 
Triggî
 *
	`sqlôe3TriggîLi°
(
P¨£
 *
pP¨£
, 
TabÀ
 *
pTab
){

103394 
Schema
 * c⁄° 
pTmpSchema
 = 
pP¨£
->
db
->
aDb
[1].
pSchema
;

103395 
Triggî
 *
pLi°
 = 0;

103397 if–
pP¨£
->
dißbÀTriggîs
 ){

103401 if–
pTmpSchema
!=
pTab
->
pSchema
 ){

103402 
HashEÀm
 *
p
;

103403 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
pP¨£
->
db
, 0, 
pTmpSchema
) );

103404 
p
=
	`sqlôeHashFú°
(&
pTmpSchema
->
åigHash
);Ö;Ö=
	`sqlôeHashNext
(p)){

103405 
Triggî
 *
pTrig
 = (Triggî *)
	`sqlôeHashD©a
(
p
);

103406 if–
pTrig
->
pTabSchema
==
pTab
->
pSchema


103407 && 0==
	`sqlôe3SåICmp
(
pTrig
->
èbÀ
, 
pTab
->
zName
)

103409 
pTrig
->
pNext
 = (
pLi°
 ?ÖLi° : 
pTab
->
pTriggî
);

103410 
pLi°
 = 
pTrig
;

103415  (
pLi°
 ?ÖLi° : 
pTab
->
pTriggî
);

103426 
SQLITE_PRIVATE
 
	`sqlôe3BegöTriggî
(

103427 
P¨£
 *
pP¨£
,

103428 
Tokí
 *
pName1
,

103429 
Tokí
 *
pName2
,

103430 
å_tm
,

103431 
›
,

103432 
IdLi°
 *
pCﬁumns
,

103433 
SrcLi°
 *
pTabÀName
,

103434 
Ex¥
 *
pWhí
,

103435 
isTemp
,

103436 
noEº


103438 
Triggî
 *
pTriggî
 = 0;

103439 
TabÀ
 *
pTab
;

103440 *
zName
 = 0;

103441 
sqlôe3
 *
db
 = 
pP¨£
->db;

103442 
iDb
;

103443 
Tokí
 *
pName
;

103444 
DbFixî
 
sFix
;

103445 
iTabDb
;

103447 
	`as£π
–
pName1
!=0 );

103448 
	`as£π
–
pName2
!=0 );

103449 
	`as£π
–
›
==
TK_INSERT
 || op==
TK_UPDATE
 || op==
TK_DELETE
 );

103450 
	`as£π
–
›
>0 && op<0xff );

103451 if–
isTemp
 ){

103453 if–
pName2
->
n
>0 ){

103454 
	`sqlôe3Eº‹Msg
(
pP¨£
, "temporaryÅrigger mayÇot have qualifiedÇame");

103455 
åiggî_˛ónup
;

103457 
iDb
 = 1;

103458 
pName
 = 
pName1
;

103461 
iDb
 = 
	`sqlôe3TwoP¨tName
(
pP¨£
, 
pName1
, 
pName2
, &
pName
);

103462 if–
iDb
<0 ){

103463 
åiggî_˛ónup
;

103466 if–!
pTabÀName
 || 
db
->
mÆlocFaûed
 ){

103467 
åiggî_˛ónup
;

103478 if–
db
->
öô
.
busy
 && 
iDb
!=1 ){

103479 
	`sqlôe3DbFªe
(
db
, 
pTabÀName
->
a
[0].
zD©aba£
);

103480 
pTabÀName
->
a
[0].
zD©aba£
 = 0;

103488 
pTab
 = 
	`sqlôe3SrcLi°Lookup
(
pP¨£
, 
pTabÀName
);

103489 if–
db
->
öô
.
busy
==0 && 
pName2
->
n
==0 && 
pTab


103490 && 
pTab
->
pSchema
==
db
->
aDb
[1].pSchema ){

103491 
iDb
 = 1;

103495 if–
db
->
mÆlocFaûed
 ) 
åiggî_˛ónup
;

103496 
	`as£π
–
pTabÀName
->
nSrc
==1 );

103497 
	`sqlôe3FixInô
(&
sFix
, 
pP¨£
, 
iDb
, "åiggî", 
pName
);

103498 if–
	`sqlôe3FixSrcLi°
(&
sFix
, 
pTabÀName
) ){

103499 
åiggî_˛ónup
;

103501 
pTab
 = 
	`sqlôe3SrcLi°Lookup
(
pP¨£
, 
pTabÀName
);

103502 if–!
pTab
 ){

103504 if–
db
->
öô
.
iDb
==1 ){

103513 
db
->
öô
.
‹ph™Triggî
 = 1;

103515 
åiggî_˛ónup
;

103517 if–
	`IsVútuÆ
(
pTab
) ){

103518 
	`sqlôe3Eº‹Msg
(
pP¨£
, "cannot createÅriggers on virtualÅables");

103519 
åiggî_˛ónup
;

103524 
zName
 = 
	`sqlôe3NameFromTokí
(
db
, 
pName
);

103525 if–!
zName
 || 
SQLITE_OK
!=
	`sqlôe3CheckObje˘Name
(
pP¨£
, zName) ){

103526 
åiggî_˛ónup
;

103528 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 
iDb
, 0) );

103529 if–
	`sqlôe3HashFöd
(&(
db
->
aDb
[
iDb
].
pSchema
->
åigHash
),

103530 
zName
, 
	`sqlôe3SåÀn30
(zName)) ){

103531 if–!
noEº
 ){

103532 
	`sqlôe3Eº‹Msg
(
pP¨£
, "åiggî %TáÃódyÉxi°s", 
pName
);

103534 
	`as£π
–!
db
->
öô
.
busy
 );

103535 
	`sqlôe3CodeVîifySchema
(
pP¨£
, 
iDb
);

103537 
åiggî_˛ónup
;

103541 if–
	`sqlôe3SåNICmp
(
pTab
->
zName
, "sqlite_", 7)==0 ){

103542 
	`sqlôe3Eº‹Msg
(
pP¨£
, "cannot createÅrigger on systemÅable");

103543 
pP¨£
->
nEº
++;

103544 
åiggî_˛ónup
;

103550 if–
pTab
->
pSñe˘
 && 
å_tm
!=
TK_INSTEAD
 ){

103551 
	`sqlôe3Eº‹Msg
(
pP¨£
, "cannot create %sÅrigger on view: %S",

103552 (
å_tm
 =
TK_BEFORE
)?"BEFORE":"AFTER", 
pTabÀName
, 0);

103553 
åiggî_˛ónup
;

103555 if–!
pTab
->
pSñe˘
 && 
å_tm
==
TK_INSTEAD
 ){

103556 
	`sqlôe3Eº‹Msg
(
pP¨£
, "cannot create INSTEAD OF"

103557 "Åriggî o¿èbÀ: %S", 
pTabÀName
, 0);

103558 
åiggî_˛ónup
;

103560 
iTabDb
 = 
	`sqlôe3SchemaToIndex
(
db
, 
pTab
->
pSchema
);

103562 #i‚de‡
SQLITE_OMIT_AUTHORIZATION


103564 
code
 = 
SQLITE_CREATE_TRIGGER
;

103565 c⁄° *
zDb
 = 
db
->
aDb
[
iTabDb
].
zName
;

103566 c⁄° *
zDbTrig
 = 
isTemp
 ? 
db
->
aDb
[1].
zName
 : 
zDb
;

103567 if–
iTabDb
==1 || 
isTemp
 ) 
code
 = 
SQLITE_CREATE_TEMP_TRIGGER
;

103568 if–
	`sqlôe3AuthCheck
(
pP¨£
, 
code
, 
zName
, 
pTab
->zName, 
zDbTrig
) ){

103569 
åiggî_˛ónup
;

103571 if–
	`sqlôe3AuthCheck
(
pP¨£
, 
SQLITE_INSERT
, 
	`SCHEMA_TABLE
(
iTabDb
),0,
zDb
)){

103572 
åiggî_˛ónup
;

103582 i‡(
å_tm
 =
TK_INSTEAD
){

103583 
å_tm
 = 
TK_BEFORE
;

103587 
pTriggî
 = (
Triggî
*)
	`sqlôe3DbMÆlocZîo
(
db
, (Trigger));

103588 if–
pTriggî
==0 ) 
åiggî_˛ónup
;

103589 
pTriggî
->
zName
 = zName;

103590 
zName
 = 0;

103591 
pTriggî
->
èbÀ
 = 
	`sqlôe3DbSåDup
(
db
, 
pTabÀName
->
a
[0].
zName
);

103592 
pTriggî
->
pSchema
 = 
db
->
aDb
[
iDb
].pSchema;

103593 
pTriggî
->
pTabSchema
 = 
pTab
->
pSchema
;

103594 
pTriggî
->
›
 = (
u8
)op;

103595 
pTriggî
->
å_tm
 =År_tm==
TK_BEFORE
 ? 
TRIGGER_BEFORE
 : 
TRIGGER_AFTER
;

103596 
pTriggî
->
pWhí
 = 
	`sqlôe3Ex¥Dup
(
db
,ÖWhí, 
EXPRDUP_REDUCE
);

103597 
pTriggî
->
pCﬁumns
 = 
	`sqlôe3IdLi°Dup
(
db
,ÖColumns);

103598 
	`as£π
–
pP¨£
->
pNewTriggî
==0 );

103599 
pP¨£
->
pNewTriggî
 = 
pTriggî
;

103601 
åiggî_˛ónup
:

103602 
	`sqlôe3DbFªe
(
db
, 
zName
);

103603 
	`sqlôe3SrcLi°Dñëe
(
db
, 
pTabÀName
);

103604 
	`sqlôe3IdLi°Dñëe
(
db
, 
pCﬁumns
);

103605 
	`sqlôe3Ex¥Dñëe
(
db
, 
pWhí
);

103606 if–!
pP¨£
->
pNewTriggî
 ){

103607 
	`sqlôe3DñëeTriggî
(
db
, 
pTriggî
);

103609 
	`as£π
–
pP¨£
->
pNewTriggî
==
pTriggî
 );

103617 
SQLITE_PRIVATE
 
	`sqlôe3FöishTriggî
(

103618 
P¨£
 *
pP¨£
,

103619 
TriggîSãp
 *
pSãpLi°
,

103620 
Tokí
 *
pAŒ


103622 
Triggî
 *
pTrig
 = 
pP¨£
->
pNewTriggî
;

103623 *
zName
;

103624 
sqlôe3
 *
db
 = 
pP¨£
->db;

103625 
DbFixî
 
sFix
;

103626 
iDb
;

103627 
Tokí
 
«meTokí
;

103629 
pP¨£
->
pNewTriggî
 = 0;

103630 if–
	`NEVER
(
pP¨£
->
nEº
Ë|| !
pTrig
 ) 
åiggîföish_˛ónup
;

103631 
zName
 = 
pTrig
->zName;

103632 
iDb
 = 
	`sqlôe3SchemaToIndex
(
pP¨£
->
db
, 
pTrig
->
pSchema
);

103633 
pTrig
->
°ï_li°
 = 
pSãpLi°
;

103634  
pSãpLi°
 ){

103635 
pSãpLi°
->
pTrig
 =ÖTrig;

103636 
pSãpLi°
 =ÖSãpLi°->
pNext
;

103638 
«meTokí
.
z
 = 
pTrig
->
zName
;

103639 
«meTokí
.
n
 = 
	`sqlôe3SåÀn30
“ameTokí.
z
);

103640 
	`sqlôe3FixInô
(&
sFix
, 
pP¨£
, 
iDb
, "åiggî", &
«meTokí
);

103641 if–
	`sqlôe3FixTriggîSãp
(&
sFix
, 
pTrig
->
°ï_li°
)

103642 || 
	`sqlôe3FixEx¥
(&
sFix
, 
pTrig
->
pWhí
)

103644 
åiggîföish_˛ónup
;

103650 if–!
db
->
öô
.
busy
 ){

103651 
Vdbe
 *
v
;

103652 *
z
;

103655 
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

103656 if–
v
==0 ) 
åiggîföish_˛ónup
;

103657 
	`sqlôe3BegöWrôeO≥øti⁄
(
pP¨£
, 0, 
iDb
);

103658 
z
 = 
	`sqlôe3DbSåNDup
(
db
, (*)
pAŒ
->z,ÖAŒ->
n
);

103659 
	`sqlôe3Ne°edP¨£
(
pP¨£
,

103661 
db
->
aDb
[
iDb
].
zName
, 
	`SCHEMA_TABLE
(iDb), zName,

103662 
pTrig
->
èbÀ
, 
z
);

103663 
	`sqlôe3DbFªe
(
db
, 
z
);

103664 
	`sqlôe3Ch™geCookõ
(
pP¨£
, 
iDb
);

103665 
	`sqlôe3VdbeAddP¨£SchemaOp
(
v
, 
iDb
,

103666 
	`sqlôe3MPrötf
(
db
, "ty≥='åiggî' ANDÇame='%q'", 
zName
));

103669 if–
db
->
öô
.
busy
 ){

103670 
Triggî
 *
pLök
 = 
pTrig
;

103671 
Hash
 *
pHash
 = &
db
->
aDb
[
iDb
].
pSchema
->
åigHash
;

103672 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 
iDb
, 0) );

103673 
pTrig
 = 
	`sqlôe3HashIn£π
(
pHash
, 
zName
, 
	`sqlôe3SåÀn30
(zName),ÖTrig);

103674 if–
pTrig
 ){

103675 
db
->
mÆlocFaûed
 = 1;

103676 }if–
pLök
->
pSchema
=ıLök->
pTabSchema
 ){

103677 
TabÀ
 *
pTab
;

103678 
n
 = 
	`sqlôe3SåÀn30
(
pLök
->
èbÀ
);

103679 
pTab
 = 
	`sqlôe3HashFöd
(&
pLök
->
pTabSchema
->
tblHash
,ÖLök->
èbÀ
, 
n
);

103680 
	`as£π
–
pTab
!=0 );

103681 
pLök
->
pNext
 = 
pTab
->
pTriggî
;

103682 
pTab
->
pTriggî
 = 
pLök
;

103686 
åiggîföish_˛ónup
:

103687 
	`sqlôe3DñëeTriggî
(
db
, 
pTrig
);

103688 
	`as£π
–!
pP¨£
->
pNewTriggî
 );

103689 
	`sqlôe3DñëeTriggîSãp
(
db
, 
pSãpLi°
);

103699 
SQLITE_PRIVATE
 
TriggîSãp
 *
	`sqlôe3TriggîSñe˘Sãp
(
sqlôe3
 *
db
, 
Sñe˘
 *
pSñe˘
){

103700 
TriggîSãp
 *
pTriggîSãp
 = 
	`sqlôe3DbMÆlocZîo
(
db
, (TriggerStep));

103701 if–
pTriggîSãp
==0 ) {

103702 
	`sqlôe3Sñe˘Dñëe
(
db
, 
pSñe˘
);

103705 
pTriggîSãp
->
›
 = 
TK_SELECT
;

103706 
pTriggîSãp
->
pSñe˘
 =ÖSelect;

103707 
pTriggîSãp
->
‹c⁄f
 = 
OE_DeÁu…
;

103708  
pTriggîSãp
;

103717 
TriggîSãp
 *
	`åiggîSãpAŒoˇã
(

103718 
sqlôe3
 *
db
,

103719 
u8
 
›
,

103720 
Tokí
 *
pName


103722 
TriggîSãp
 *
pTriggîSãp
;

103724 
pTriggîSãp
 = 
	`sqlôe3DbMÆlocZîo
(
db
, (
TriggîSãp
Ë+ 
pName
->
n
);

103725 if–
pTriggîSãp
 ){

103726 *
z
 = (*)&
pTriggîSãp
[1];

103727 
	`mem˝y
(
z
, 
pName
->z,ÖName->
n
);

103728 
pTriggîSãp
->
èrgë
.
z
 = z;

103729 
pTriggîSãp
->
èrgë
.
n
 = 
pName
->n;

103730 
pTriggîSãp
->
›
 = op;

103732  
pTriggîSãp
;

103742 
SQLITE_PRIVATE
 
TriggîSãp
 *
	`sqlôe3TriggîIn£πSãp
(

103743 
sqlôe3
 *
db
,

103744 
Tokí
 *
pTabÀName
,

103745 
IdLi°
 *
pCﬁumn
,

103746 
Ex¥Li°
 *
pELi°
,

103747 
Sñe˘
 *
pSñe˘
,

103748 
u8
 
‹c⁄f


103750 
TriggîSãp
 *
pTriggîSãp
;

103752 
	`as£π
(
pELi°
 =0 || 
pSñe˘
 == 0);

103753 
	`as£π
(
pELi°
 !0 || 
pSñe˘
 !0 || 
db
->
mÆlocFaûed
);

103755 
pTriggîSãp
 = 
	`åiggîSãpAŒoˇã
(
db
, 
TK_INSERT
, 
pTabÀName
);

103756 if–
pTriggîSãp
 ){

103757 
pTriggîSãp
->
pSñe˘
 = 
	`sqlôe3Sñe˘Dup
(
db
,ÖSñe˘, 
EXPRDUP_REDUCE
);

103758 
pTriggîSãp
->
pIdLi°
 = 
pCﬁumn
;

103759 
pTriggîSãp
->
pEx¥Li°
 = 
	`sqlôe3Ex¥Li°Dup
(
db
, 
pELi°
, 
EXPRDUP_REDUCE
);

103760 
pTriggîSãp
->
‹c⁄f
 = orconf;

103762 
	`sqlôe3IdLi°Dñëe
(
db
, 
pCﬁumn
);

103764 
	`sqlôe3Ex¥Li°Dñëe
(
db
, 
pELi°
);

103765 
	`sqlôe3Sñe˘Dñëe
(
db
, 
pSñe˘
);

103767  
pTriggîSãp
;

103775 
SQLITE_PRIVATE
 
TriggîSãp
 *
	`sqlôe3TriggîUpd©eSãp
(

103776 
sqlôe3
 *
db
,

103777 
Tokí
 *
pTabÀName
,

103778 
Ex¥Li°
 *
pELi°
,

103779 
Ex¥
 *
pWhîe
,

103780 
u8
 
‹c⁄f


103782 
TriggîSãp
 *
pTriggîSãp
;

103784 
pTriggîSãp
 = 
	`åiggîSãpAŒoˇã
(
db
, 
TK_UPDATE
, 
pTabÀName
);

103785 if–
pTriggîSãp
 ){

103786 
pTriggîSãp
->
pEx¥Li°
 = 
	`sqlôe3Ex¥Li°Dup
(
db
, 
pELi°
, 
EXPRDUP_REDUCE
);

103787 
pTriggîSãp
->
pWhîe
 = 
	`sqlôe3Ex¥Dup
(
db
,ÖWhîe, 
EXPRDUP_REDUCE
);

103788 
pTriggîSãp
->
‹c⁄f
 = orconf;

103790 
	`sqlôe3Ex¥Li°Dñëe
(
db
, 
pELi°
);

103791 
	`sqlôe3Ex¥Dñëe
(
db
, 
pWhîe
);

103792  
pTriggîSãp
;

103800 
SQLITE_PRIVATE
 
TriggîSãp
 *
	`sqlôe3TriggîDñëeSãp
(

103801 
sqlôe3
 *
db
,

103802 
Tokí
 *
pTabÀName
,

103803 
Ex¥
 *
pWhîe


103805 
TriggîSãp
 *
pTriggîSãp
;

103807 
pTriggîSãp
 = 
	`åiggîSãpAŒoˇã
(
db
, 
TK_DELETE
, 
pTabÀName
);

103808 if–
pTriggîSãp
 ){

103809 
pTriggîSãp
->
pWhîe
 = 
	`sqlôe3Ex¥Dup
(
db
,ÖWhîe, 
EXPRDUP_REDUCE
);

103810 
pTriggîSãp
->
‹c⁄f
 = 
OE_DeÁu…
;

103812 
	`sqlôe3Ex¥Dñëe
(
db
, 
pWhîe
);

103813  
pTriggîSãp
;

103819 
SQLITE_PRIVATE
 
	`sqlôe3DñëeTriggî
(
sqlôe3
 *
db
, 
Triggî
 *
pTriggî
){

103820 if–
pTriggî
==0 ) ;

103821 
	`sqlôe3DñëeTriggîSãp
(
db
, 
pTriggî
->
°ï_li°
);

103822 
	`sqlôe3DbFªe
(
db
, 
pTriggî
->
zName
);

103823 
	`sqlôe3DbFªe
(
db
, 
pTriggî
->
èbÀ
);

103824 
	`sqlôe3Ex¥Dñëe
(
db
, 
pTriggî
->
pWhí
);

103825 
	`sqlôe3IdLi°Dñëe
(
db
, 
pTriggî
->
pCﬁumns
);

103826 
	`sqlôe3DbFªe
(
db
, 
pTriggî
);

103837 
SQLITE_PRIVATE
 
	`sqlôe3Dr›Triggî
(
P¨£
 *
pP¨£
, 
SrcLi°
 *
pName
, 
noEº
){

103838 
Triggî
 *
pTriggî
 = 0;

103839 
i
;

103840 c⁄° *
zDb
;

103841 c⁄° *
zName
;

103842 
nName
;

103843 
sqlôe3
 *
db
 = 
pP¨£
->db;

103845 if–
db
->
mÆlocFaûed
 ) 
dr›_åiggî_˛ónup
;

103846 if–
SQLITE_OK
!=
	`sqlôe3RódSchema
(
pP¨£
) ){

103847 
dr›_åiggî_˛ónup
;

103850 
	`as£π
–
pName
->
nSrc
==1 );

103851 
zDb
 = 
pName
->
a
[0].
zD©aba£
;

103852 
zName
 = 
pName
->
a
[0].zName;

103853 
nName
 = 
	`sqlôe3SåÀn30
(
zName
);

103854 
	`as£π
–
zDb
!=0 || 
	`sqlôe3BåìHﬁdsAŒMuãxes
(
db
) );

103855 
i
=
OMIT_TEMPDB
; i<
db
->
nDb
; i++){

103856 
j
 = (
i
<2) ? i^1 : i;

103857 if–
zDb
 && 
	`sqlôe3SåICmp
(
db
->
aDb
[
j
].
zName
, zDb) ) ;

103858 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 
j
, 0) );

103859 
pTriggî
 = 
	`sqlôe3HashFöd
(&(
db
->
aDb
[
j
].
pSchema
->
åigHash
), 
zName
, 
nName
);

103860 if–
pTriggî
 ) ;

103862 if–!
pTriggî
 ){

103863 if–!
noEº
 ){

103864 
	`sqlôe3Eº‹Msg
(
pP¨£
, "nÿsuchÅriggî: %S", 
pName
, 0);

103866 
	`sqlôe3CodeVîifyNamedSchema
(
pP¨£
, 
zDb
);

103868 
pP¨£
->
checkSchema
 = 1;

103869 
dr›_åiggî_˛ónup
;

103871 
	`sqlôe3Dr›TriggîPå
(
pP¨£
, 
pTriggî
);

103873 
dr›_åiggî_˛ónup
:

103874 
	`sqlôe3SrcLi°Dñëe
(
db
, 
pName
);

103881 
TabÀ
 *
	`èbÀOfTriggî
(
Triggî
 *
pTriggî
){

103882 
n
 = 
	`sqlôe3SåÀn30
(
pTriggî
->
èbÀ
);

103883  
	`sqlôe3HashFöd
(&
pTriggî
->
pTabSchema
->
tblHash
,ÖTriggî->
èbÀ
, 
n
);

103890 
SQLITE_PRIVATE
 
	`sqlôe3Dr›TriggîPå
(
P¨£
 *
pP¨£
, 
Triggî
 *
pTriggî
){

103891 
TabÀ
 *
pTabÀ
;

103892 
Vdbe
 *
v
;

103893 
sqlôe3
 *
db
 = 
pP¨£
->db;

103894 
iDb
;

103896 
iDb
 = 
	`sqlôe3SchemaToIndex
(
pP¨£
->
db
, 
pTriggî
->
pSchema
);

103897 
	`as£π
–
iDb
>=0 && iDb<
db
->
nDb
 );

103898 
pTabÀ
 = 
	`èbÀOfTriggî
(
pTriggî
);

103899 
	`as£π
–
pTabÀ
 );

103900 
	`as£π
–
pTabÀ
->
pSchema
==
pTriggî
->pSchem®|| 
iDb
==1 );

103901 #i‚de‡
SQLITE_OMIT_AUTHORIZATION


103903 
code
 = 
SQLITE_DROP_TRIGGER
;

103904 c⁄° *
zDb
 = 
db
->
aDb
[
iDb
].
zName
;

103905 c⁄° *
zTab
 = 
	`SCHEMA_TABLE
(
iDb
);

103906 if–
iDb
==1 ) 
code
 = 
SQLITE_DROP_TEMP_TRIGGER
;

103907 if–
	`sqlôe3AuthCheck
(
pP¨£
, 
code
, 
pTriggî
->
zName
, 
pTabÀ
->zName, 
zDb
) ||

103908 
	`sqlôe3AuthCheck
(
pP¨£
, 
SQLITE_DELETE
, 
zTab
, 0, 
zDb
) ){

103916 
	`as£π
–
pTabÀ
!=0 );

103917 if–(
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
))!=0 ){

103918 
ba£
;

103919 c⁄° 
VdbeOpLi°
 
dr›Triggî
[] = {

103920 { 
OP_Rewöd
, 0, 
	`ADDR
(9), 0},

103921 { 
OP_Såög8
, 0, 1, 0},

103922 { 
OP_Cﬁumn
, 0, 1, 2},

103923 { 
OP_Ne
, 2, 
	`ADDR
(8), 1},

103924 { 
OP_Såög8
, 0, 1, 0},

103925 { 
OP_Cﬁumn
, 0, 0, 2},

103926 { 
OP_Ne
, 2, 
	`ADDR
(8), 1},

103927 { 
OP_Dñëe
, 0, 0, 0},

103928 { 
OP_Next
, 0, 
	`ADDR
(1), 0},

103931 
	`sqlôe3BegöWrôeO≥øti⁄
(
pP¨£
, 0, 
iDb
);

103932 
	`sqlôe3O≥nMa°îTabÀ
(
pP¨£
, 
iDb
);

103933 
ba£
 = 
	`sqlôe3VdbeAddOpLi°
(
v
, 
	`AºaySize
(
dr›Triggî
), dropTrigger);

103934 
	`sqlôe3VdbeCh™geP4
(
v
, 
ba£
+1, 
pTriggî
->
zName
, 
P4_TRANSIENT
);

103935 
	`sqlôe3VdbeCh™geP4
(
v
, 
ba£
+4, "åiggî", 
P4_STATIC
);

103936 
	`sqlôe3Ch™geCookõ
(
pP¨£
, 
iDb
);

103937 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Clo£
, 0, 0);

103938 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Dr›Triggî
, 
iDb
, 0, 0, 
pTriggî
->
zName
, 0);

103939 if–
pP¨£
->
nMem
<3 ){

103940 
pP¨£
->
nMem
 = 3;

103948 
SQLITE_PRIVATE
 
	`sqlôe3U∆ökAndDñëeTriggî
(
sqlôe3
 *
db
, 
iDb
, c⁄° *
zName
){

103949 
Triggî
 *
pTriggî
;

103950 
Hash
 *
pHash
;

103952 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 
iDb
, 0) );

103953 
pHash
 = &(
db
->
aDb
[
iDb
].
pSchema
->
åigHash
);

103954 
pTriggî
 = 
	`sqlôe3HashIn£π
(
pHash
, 
zName
, 
	`sqlôe3SåÀn30
(zName), 0);

103955 if–
	`ALWAYS
(
pTriggî
) ){

103956 if–
pTriggî
->
pSchema
=ıTriggî->
pTabSchema
 ){

103957 
TabÀ
 *
pTab
 = 
	`èbÀOfTriggî
(
pTriggî
);

103958 
Triggî
 **
µ
;

103959 
µ
=&
pTab
->
pTriggî
; *µ!ıTriggî;Öp=&((*µ)->
pNext
));

103960 *
µ
 = (*µ)->
pNext
;

103962 
	`sqlôe3DñëeTriggî
(
db
, 
pTriggî
);

103963 
db
->
Êags
 |
SQLITE_I¡înCh™ges
;

103976 
	`checkCﬁumnOvîœp
(
IdLi°
 *
pIdLi°
, 
Ex¥Li°
 *
pELi°
){

103977 
e
;

103978 if–
pIdLi°
==0 || 
	`NEVER
(
pELi°
==0) )  1;

103979 
e
=0;É<
pELi°
->
nEx¥
;É++){

103980 if–
	`sqlôe3IdLi°Index
(
pIdLi°
, 
pELi°
->
a
[
e
].
zName
)>=0 )  1;

103991 
SQLITE_PRIVATE
 
Triggî
 *
	`sqlôe3TriggîsExi°
(

103992 
P¨£
 *
pP¨£
,

103993 
TabÀ
 *
pTab
,

103994 
›
,

103995 
Ex¥Li°
 *
pCh™ges
,

103996 *
pMask


103998 
mask
 = 0;

103999 
Triggî
 *
pLi°
 = 0;

104000 
Triggî
 *
p
;

104002 if–(
pP¨£
->
db
->
Êags
 & 
SQLITE_E«bÀTriggî
)!=0 ){

104003 
pLi°
 = 
	`sqlôe3TriggîLi°
(
pP¨£
, 
pTab
);

104005 
	`as£π
–
pLi°
==0 || 
	`IsVútuÆ
(
pTab
)==0 );

104006 
p
=
pLi°
;Ö;Öı->
pNext
){

104007 if–
p
->
›
==› && 
	`checkCﬁumnOvîœp
’->
pCﬁumns
, 
pCh™ges
) ){

104008 
mask
 |
p
->
å_tm
;

104011 if–
pMask
 ){

104012 *
pMask
 = 
mask
;

104014  (
mask
 ? 
pLi°
 : 0);

104027 
SrcLi°
 *
	`èrgëSrcLi°
(

104028 
P¨£
 *
pP¨£
,

104029 
TriggîSãp
 *
pSãp


104031 
iDb
;

104032 
SrcLi°
 *
pSrc
;

104034 
pSrc
 = 
	`sqlôe3SrcLi°Aµíd
(
pP¨£
->
db
, 0, &
pSãp
->
èrgë
, 0);

104035 if–
pSrc
 ){

104036 
	`as£π
–
pSrc
->
nSrc
>0 );

104037 
	`as£π
–
pSrc
->
a
!=0 );

104038 
iDb
 = 
	`sqlôe3SchemaToIndex
(
pP¨£
->
db
, 
pSãp
->
pTrig
->
pSchema
);

104039 if–
iDb
==0 || iDb>=2 ){

104040 
sqlôe3
 *
db
 = 
pP¨£
->db;

104041 
	`as£π
–
iDb
<
pP¨£
->
db
->
nDb
 );

104042 
pSrc
->
a
[pSrc->
nSrc
-1].
zD©aba£
 = 
	`sqlôe3DbSåDup
(
db
, db->
aDb
[
iDb
].
zName
);

104045  
pSrc
;

104052 
	`codeTriggîProgøm
(

104053 
P¨£
 *
pP¨£
,

104054 
TriggîSãp
 *
pSãpLi°
,

104055 
‹c⁄f


104057 
TriggîSãp
 *
pSãp
;

104058 
Vdbe
 *
v
 = 
pP¨£
->
pVdbe
;

104059 
sqlôe3
 *
db
 = 
pP¨£
->db;

104061 
	`as£π
–
pP¨£
->
pTriggîTab
 &&ÖP¨£->
pT›Àvñ
 );

104062 
	`as£π
–
pSãpLi°
 );

104063 
	`as£π
–
v
!=0 );

104064 
pSãp
=
pSãpLi°
;ÖSãp;ÖSãpıSãp->
pNext
){

104078 
pP¨£
->
eOrc⁄f
 = (
‹c⁄f
==
OE_DeÁu…
)?
pSãp
->‹c⁄f:(
u8
)orconf;

104086 
	`as£π
–
pP¨£
->
cookõGŸo
==0 ||ÖParse->cookieGoto==-1 );

104087 
pP¨£
->
cookõGŸo
 = 0;

104089  
pSãp
->
›
 ){

104090 
TK_UPDATE
: {

104091 
	`sqlôe3Upd©e
(
pP¨£
,

104092 
	`èrgëSrcLi°
(
pP¨£
, 
pSãp
),

104093 
	`sqlôe3Ex¥Li°Dup
(
db
, 
pSãp
->
pEx¥Li°
, 0),

104094 
	`sqlôe3Ex¥Dup
(
db
, 
pSãp
->
pWhîe
, 0),

104095 
pP¨£
->
eOrc⁄f


104099 
TK_INSERT
: {

104100 
	`sqlôe3In£π
(
pP¨£
,

104101 
	`èrgëSrcLi°
(
pP¨£
, 
pSãp
),

104102 
	`sqlôe3Ex¥Li°Dup
(
db
, 
pSãp
->
pEx¥Li°
, 0),

104103 
	`sqlôe3Sñe˘Dup
(
db
, 
pSãp
->
pSñe˘
, 0),

104104 
	`sqlôe3IdLi°Dup
(
db
, 
pSãp
->
pIdLi°
),

104105 
pP¨£
->
eOrc⁄f


104109 
TK_DELETE
: {

104110 
	`sqlôe3DñëeFrom
(
pP¨£
,

104111 
	`èrgëSrcLi°
(
pP¨£
, 
pSãp
),

104112 
	`sqlôe3Ex¥Dup
(
db
, 
pSãp
->
pWhîe
, 0)

104116 : 
	`as£π
–
pSãp
->
›
==
TK_SELECT
 ); {

104117 
Sñe˘De°
 
sDe°
;

104118 
Sñe˘
 *
pSñe˘
 = 
	`sqlôe3Sñe˘Dup
(
db
, 
pSãp
->pSelect, 0);

104119 
	`sqlôe3Sñe˘De°Inô
(&
sDe°
, 
SRT_Disˇrd
, 0);

104120 
	`sqlôe3Sñe˘
(
pP¨£
, 
pSñe˘
, &
sDe°
);

104121 
	`sqlôe3Sñe˘Dñëe
(
db
, 
pSñe˘
);

104125 if–
pSãp
->
›
!=
TK_SELECT
 ){

104126 
	`sqlôe3VdbeAddOp0
(
v
, 
OP_Re£tCou¡
);

104133 #ifde‡
SQLITE_DEBUG


104138 c⁄° *
	`⁄Eº‹Text
(
⁄Eº‹
){

104139  
⁄Eº‹
 ){

104140 
OE_Ab‹t
:  "abort";

104141 
OE_Rﬁlback
:  "rollback";

104142 
OE_Faû
:  "fail";

104143 
OE_Rïœ˚
:  "replace";

104144 
OE_Ign‹e
:  "ignore";

104145 
OE_DeÁu…
:  "default";

104156 
	`å™s„rP¨£Eº‹
(
P¨£
 *
pTo
, P¨£ *
pFrom
){

104157 
	`as£π
–
pFrom
->
zEºMsg
==0 ||ÖFrom->
nEº
 );

104158 
	`as£π
–
pTo
->
zEºMsg
==0 ||ÖTo->
nEº
 );

104159 if–
pTo
->
nEº
==0 ){

104160 
pTo
->
zEºMsg
 = 
pFrom
->zErrMsg;

104161 
pTo
->
nEº
 = 
pFrom
->nErr;

104163 
	`sqlôe3DbFªe
(
pFrom
->
db
,ÖFrom->
zEºMsg
);

104171 
TriggîPrg
 *
	`codeRowTriggî
(

104172 
P¨£
 *
pP¨£
,

104173 
Triggî
 *
pTriggî
,

104174 
TabÀ
 *
pTab
,

104175 
‹c⁄f


104177 
P¨£
 *
pT›
 = 
	`sqlôe3P¨£T›Àvñ
(
pP¨£
);

104178 
sqlôe3
 *
db
 = 
pP¨£
->db;

104179 
TriggîPrg
 *
pPrg
;

104180 
Ex¥
 *
pWhí
 = 0;

104181 
Vdbe
 *
v
;

104182 
NameC⁄ãxt
 
sNC
;

104183 
SubProgøm
 *
pProgøm
 = 0;

104184 
P¨£
 *
pSubP¨£
;

104185 
iEndTriggî
 = 0;

104187 
	`as£π
–
pTriggî
->
zName
==0 || 
pTab
==
	`èbÀOfTriggî
(pTrigger) );

104188 
	`as£π
–
pT›
->
pVdbe
 );

104193 
pPrg
 = 
	`sqlôe3DbMÆlocZîo
(
db
, (
TriggîPrg
));

104194 if–!
pPrg
 )  0;

104195 
pPrg
->
pNext
 = 
pT›
->
pTriggîPrg
;

104196 
pT›
->
pTriggîPrg
 = 
pPrg
;

104197 
pPrg
->
pProgøm
 =ÖProgøm = 
	`sqlôe3DbMÆlocZîo
(
db
, (
SubProgøm
));

104198 if–!
pProgøm
 )  0;

104199 
	`sqlôe3VdbeLökSubProgøm
(
pT›
->
pVdbe
, 
pProgøm
);

104200 
pPrg
->
pTriggî
 =ÖTrigger;

104201 
pPrg
->
‹c⁄f
 = orconf;

104202 
pPrg
->
aCﬁmask
[0] = 0xffffffff;

104203 
pPrg
->
aCﬁmask
[1] = 0xffffffff;

104207 
pSubP¨£
 = 
	`sqlôe3SèckAŒocZîo
(
db
, (
P¨£
));

104208 if–!
pSubP¨£
 )  0;

104209 
	`mem£t
(&
sNC
, 0, (sNC));

104210 
sNC
.
pP¨£
 = 
pSubP¨£
;

104211 
pSubP¨£
->
db
 = db;

104212 
pSubP¨£
->
pTriggîTab
 = 
pTab
;

104213 
pSubP¨£
->
pT›Àvñ
 = 
pT›
;

104214 
pSubP¨£
->
zAuthC⁄ãxt
 = 
pTriggî
->
zName
;

104215 
pSubP¨£
->
eTriggîOp
 = 
pTriggî
->
›
;

104216 
pSubP¨£
->
nQuîyLo›
 = 
pP¨£
->nQueryLoop;

104218 
v
 = 
	`sqlôe3GëVdbe
(
pSubP¨£
);

104219 if–
v
 ){

104220 
	`VdbeCommít
((
v
, "Start: %s.%s (%s %s%s%s ON %s)",

104221 
pTriggî
->
zName
, 
	`⁄Eº‹Text
(
‹c⁄f
),

104222 (
pTriggî
->
å_tm
==
TRIGGER_BEFORE
 ? "BEFORE" : "AFTER"),

104223 (
pTriggî
->
›
==
TK_UPDATE
 ? "UPDATE" : ""),

104224 (
pTriggî
->
›
==
TK_INSERT
 ? "INSERT" : ""),

104225 (
pTriggî
->
›
==
TK_DELETE
 ? "DELETE" : ""),

104226 
pTab
->
zName


104228 #i‚de‡
SQLITE_OMIT_TRACE


104229 
	`sqlôe3VdbeCh™geP4
(
v
, -1,

104230 
	`sqlôe3MPrötf
(
db
, "-- TRIGGER %s", 
pTriggî
->
zName
), 
P4_DYNAMIC


104237 if–
pTriggî
->
pWhí
 ){

104238 
pWhí
 = 
	`sqlôe3Ex¥Dup
(
db
, 
pTriggî
->pWhen, 0);

104239 if–
SQLITE_OK
==
	`sqlôe3ResﬁveEx¥Names
(&
sNC
, 
pWhí
)

104240 && 
db
->
mÆlocFaûed
==0

104242 
iEndTriggî
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

104243 
	`sqlôe3Ex¥IfFÆ£
(
pSubP¨£
, 
pWhí
, 
iEndTriggî
, 
SQLITE_JUMPIFNULL
);

104245 
	`sqlôe3Ex¥Dñëe
(
db
, 
pWhí
);

104249 
	`codeTriggîProgøm
(
pSubP¨£
, 
pTriggî
->
°ï_li°
, 
‹c⁄f
);

104252 if–
iEndTriggî
 ){

104253 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
iEndTriggî
);

104255 
	`sqlôe3VdbeAddOp0
(
v
, 
OP_HÆt
);

104256 
	`VdbeCommít
((
v
, "End: %s.%s", 
pTriggî
->
zName
, 
	`⁄Eº‹Text
(
‹c⁄f
)));

104258 
	`å™s„rP¨£Eº‹
(
pP¨£
, 
pSubP¨£
);

104259 if–
db
->
mÆlocFaûed
==0 ){

104260 
pProgøm
->
aOp
 = 
	`sqlôe3VdbeTakeOpAºay
(
v
, &pProgøm->
nOp
, &
pT›
->
nMaxArg
);

104262 
pProgøm
->
nMem
 = 
pSubP¨£
->nMem;

104263 
pProgøm
->
nC§
 = 
pSubP¨£
->
nTab
;

104264 
pProgøm
->
nOn˚
 = 
pSubP¨£
->nOnce;

104265 
pProgøm
->
tokí
 = (*)
pTriggî
;

104266 
pPrg
->
aCﬁmask
[0] = 
pSubP¨£
->
ﬁdmask
;

104267 
pPrg
->
aCﬁmask
[1] = 
pSubP¨£
->
√wmask
;

104268 
	`sqlôe3VdbeDñëe
(
v
);

104271 
	`as£π
–!
pSubP¨£
->
pAöc
 && !pSubP¨£->
pZombõTab
 );

104272 
	`as£π
–!
pSubP¨£
->
pTriggîPrg
 && !pSubP¨£->
nMaxArg
 );

104273 
	`sqlôe3SèckFªe
(
db
, 
pSubP¨£
);

104275  
pPrg
;

104284 
TriggîPrg
 *
	`gëRowTriggî
(

104285 
P¨£
 *
pP¨£
,

104286 
Triggî
 *
pTriggî
,

104287 
TabÀ
 *
pTab
,

104288 
‹c⁄f


104290 
P¨£
 *
pRoŸ
 = 
	`sqlôe3P¨£T›Àvñ
(
pP¨£
);

104291 
TriggîPrg
 *
pPrg
;

104293 
	`as£π
–
pTriggî
->
zName
==0 || 
pTab
==
	`èbÀOfTriggî
(pTrigger) );

104299 
pPrg
=
pRoŸ
->
pTriggîPrg
;

104300 
pPrg
 && (pPrg->
pTriggî
!ıTriggî ||ÖPrg->
‹c⁄f
!=orconf);

104301 
pPrg
ıPrg->
pNext


104305 if–!
pPrg
 ){

104306 
pPrg
 = 
	`codeRowTriggî
(
pP¨£
, 
pTriggî
, 
pTab
, 
‹c⁄f
);

104309  
pPrg
;

104318 
SQLITE_PRIVATE
 
	`sqlôe3CodeRowTriggîDúe˘
(

104319 
P¨£
 *
pP¨£
,

104320 
Triggî
 *
p
,

104321 
TabÀ
 *
pTab
,

104322 
ªg
,

104323 
‹c⁄f
,

104324 
ign‹eJump


104326 
Vdbe
 *
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

104327 
TriggîPrg
 *
pPrg
;

104328 
pPrg
 = 
	`gëRowTriggî
(
pP¨£
, 
p
, 
pTab
, 
‹c⁄f
);

104329 
	`as£π
–
pPrg
 || 
pP¨£
->
nEº
 ||ÖP¨£->
db
->
mÆlocFaûed
 );

104333 if–
pPrg
 ){

104334 
bRecursive
 = (
p
->
zName
 && 0==(
pP¨£
->
db
->
Êags
&
SQLITE_RecTriggîs
));

104336 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Progøm
, 
ªg
, 
ign‹eJump
, ++
pP¨£
->
nMem
);

104337 
	`sqlôe3VdbeCh™geP4
(
v
, -1, (c⁄° *)
pPrg
->
pProgøm
, 
P4_SUBPROGRAM
);

104338 
	`VdbeCommít
(

104339 (
v
, "CÆl: %s.%s", (
p
->
zName
?p->zName:"fkey"), 
	`⁄Eº‹Text
(
‹c⁄f
)));

104346 
	`sqlôe3VdbeCh™geP5
(
v
, (
u8
)
bRecursive
);

104390 
SQLITE_PRIVATE
 
	`sqlôe3CodeRowTriggî
(

104391 
P¨£
 *
pP¨£
,

104392 
Triggî
 *
pTriggî
,

104393 
›
,

104394 
Ex¥Li°
 *
pCh™ges
,

104395 
å_tm
,

104396 
TabÀ
 *
pTab
,

104397 
ªg
,

104398 
‹c⁄f
,

104399 
ign‹eJump


104401 
Triggî
 *
p
;

104403 
	`as£π
–
›
==
TK_UPDATE
 || op==
TK_INSERT
 || op==
TK_DELETE
 );

104404 
	`as£π
–
å_tm
==
TRIGGER_BEFORE
 ||År_tm==
TRIGGER_AFTER
 );

104405 
	`as£π
–(
›
==
TK_UPDATE
)==(
pCh™ges
!=0) );

104407 
p
=
pTriggî
;Ö;Öı->
pNext
){

104412 
	`as£π
–
p
->
pSchema
!=0 );

104413 
	`as£π
–
p
->
pTabSchema
!=0 );

104414 
	`as£π
–
p
->
pSchema
=ı->
pTabSchema


104415 || 
p
->
pSchema
==
pP¨£
->
db
->
aDb
[1].pSchema );

104418 if–
p
->
›
==op

104419 && 
p
->
å_tm
==tr_tm

104420 && 
	`checkCﬁumnOvîœp
(
p
->
pCﬁumns
, 
pCh™ges
)

104422 
	`sqlôe3CodeRowTriggîDúe˘
(
pP¨£
, 
p
, 
pTab
, 
ªg
, 
‹c⁄f
, 
ign‹eJump
);

104452 
SQLITE_PRIVATE
 
u32
 
	`sqlôe3TriggîCﬁmask
(

104453 
P¨£
 *
pP¨£
,

104454 
Triggî
 *
pTriggî
,

104455 
Ex¥Li°
 *
pCh™ges
,

104456 
isNew
,

104457 
å_tm
,

104458 
TabÀ
 *
pTab
,

104459 
‹c⁄f


104461 c⁄° 
›
 = 
pCh™ges
 ? 
TK_UPDATE
 : 
TK_DELETE
;

104462 
u32
 
mask
 = 0;

104463 
Triggî
 *
p
;

104465 
	`as£π
–
isNew
==1 || isNew==0 );

104466 
p
=
pTriggî
;Ö;Öı->
pNext
){

104467 if–
p
->
›
==› && (
å_tm
&p->tr_tm)

104468 && 
	`checkCﬁumnOvîœp
(
p
->
pCﬁumns
,
pCh™ges
)

104470 
TriggîPrg
 *
pPrg
;

104471 
pPrg
 = 
	`gëRowTriggî
(
pP¨£
, 
p
, 
pTab
, 
‹c⁄f
);

104472 if–
pPrg
 ){

104473 
mask
 |
pPrg
->
aCﬁmask
[
isNew
];

104478  
mask
;

104500 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


104502 
	`upd©eVútuÆTabÀ
(

104503 
P¨£
 *
pP¨£
,

104504 
SrcLi°
 *
pSrc
,

104505 
TabÀ
 *
pTab
,

104506 
Ex¥Li°
 *
pCh™ges
,

104507 
Ex¥
 *
pRowidEx¥
,

104508 *
aXRef
,

104509 
Ex¥
 *
pWhîe
,

104510 
⁄Eº‹


104544 
SQLITE_PRIVATE
 
	`sqlôe3CﬁumnDeÁu…
(
Vdbe
 *
v
, 
TabÀ
 *
pTab
, 
i
, 
iReg
){

104545 
	`as£π
–
pTab
!=0 );

104546 if–!
pTab
->
pSñe˘
 ){

104547 
sqlôe3_vÆue
 *
pVÆue
 = 0;

104548 
u8
 
íc
 = 
	`ENC
(
	`sqlôe3VdbeDb
(
v
));

104549 
Cﬁumn
 *
pCﬁ
 = &
pTab
->
aCﬁ
[
i
];

104550 
	`VdbeCommít
((
v
, "%s.%s", 
pTab
->
zName
, 
pCﬁ
->zName));

104551 
	`as£π
–
i
<
pTab
->
nCﬁ
 );

104552 
	`sqlôe3VÆueFromEx¥
(
	`sqlôe3VdbeDb
(
v
), 
pCﬁ
->
pDÊt
, 
íc
,

104553 
pCﬁ
->
afföôy
, &
pVÆue
);

104554 if–
pVÆue
 ){

104555 
	`sqlôe3VdbeCh™geP4
(
v
, -1, (c⁄° *)
pVÆue
, 
P4_MEM
);

104557 #i‚de‡
SQLITE_OMIT_FLOATING_POINT


104558 if–
iReg
>=0 && 
pTab
->
aCﬁ
[
i
].
afföôy
==
SQLITE_AFF_REAL
 ){

104559 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_RólAfföôy
, 
iReg
);

104572 
SQLITE_PRIVATE
 
	`sqlôe3Upd©e
(

104573 
P¨£
 *
pP¨£
,

104574 
SrcLi°
 *
pTabLi°
,

104575 
Ex¥Li°
 *
pCh™ges
,

104576 
Ex¥
 *
pWhîe
,

104577 
⁄Eº‹


104579 
i
, 
j
;

104580 
TabÀ
 *
pTab
;

104581 
addr
 = 0;

104582 
WhîeInfo
 *
pWInfo
;

104583 
Vdbe
 *
v
;

104584 
Index
 *
pIdx
;

104585 
nIdx
;

104586 
iCur
;

104587 
sqlôe3
 *
db
;

104588 *
aRegIdx
 = 0;

104589 *
aXRef
 = 0;

104592 
chngRowid
;

104593 
Ex¥
 *
pRowidEx¥
 = 0;

104594 
›íAŒ
 = 0;

104595 
AuthC⁄ãxt
 
sC⁄ãxt
;

104596 
NameC⁄ãxt
 
sNC
;

104597 
iDb
;

104598 
okO√Pass
;

104599 
hasFK
;

104601 #i‚de‡
SQLITE_OMIT_TRIGGER


104602 
isVõw
;

104603 
Triggî
 *
pTriggî
;

104604 
tmask
;

104606 
√wmask
;

104609 
ªgRowCou¡
 = 0;

104610 
ªgOldRowid
;

104611 
ªgNewRowid
;

104612 
ªgNew
;

104613 
ªgOld
 = 0;

104614 
ªgRowSë
 = 0;

104616 
	`mem£t
(&
sC⁄ãxt
, 0, (sContext));

104617 
db
 = 
pP¨£
->db;

104618 if–
pP¨£
->
nEº
 || 
db
->
mÆlocFaûed
 ){

104619 
upd©e_˛ónup
;

104621 
	`as£π
–
pTabLi°
->
nSrc
==1 );

104625 
pTab
 = 
	`sqlôe3SrcLi°Lookup
(
pP¨£
, 
pTabLi°
);

104626 if–
pTab
==0 ) 
upd©e_˛ónup
;

104627 
iDb
 = 
	`sqlôe3SchemaToIndex
(
pP¨£
->
db
, 
pTab
->
pSchema
);

104632 #i‚de‡
SQLITE_OMIT_TRIGGER


104633 
pTriggî
 = 
	`sqlôe3TriggîsExi°
(
pP¨£
, 
pTab
, 
TK_UPDATE
, 
pCh™ges
, &
tmask
);

104634 
isVõw
 = 
pTab
->
pSñe˘
!=0;

104635 
	`as£π
–
pTriggî
 || 
tmask
==0 );

104637 
	#pTriggî
 0

	)

104638 
	#isVõw
 0

	)

104639 
	#tmask
 0

	)

104641 #ifde‡
SQLITE_OMIT_VIEW


104642 #unde‡
isVõw


104643 
	#isVõw
 0

	)

104646 if–
	`sqlôe3VõwGëCﬁumnNames
(
pP¨£
, 
pTab
) ){

104647 
upd©e_˛ónup
;

104649 if–
	`sqlôe3IsRódO∆y
(
pP¨£
, 
pTab
, 
tmask
) ){

104650 
upd©e_˛ónup
;

104652 
aXRef
 = 
	`sqlôe3DbMÆlocRaw
(
db
, (Ë* 
pTab
->
nCﬁ
 );

104653 if–
aXRef
==0 ) 
upd©e_˛ónup
;

104654 
i
=0; i<
pTab
->
nCﬁ
; i++Ë
aXRef
[i] = -1;

104661 
pTabLi°
->
a
[0].
iCurs‹
 = 
iCur
 = 
pP¨£
->
nTab
++;

104662 
pIdx
=
pTab
->
pIndex
;ÖIdx;ÖIdxıIdx->
pNext
){

104663 
pP¨£
->
nTab
++;

104667 
	`mem£t
(&
sNC
, 0, (sNC));

104668 
sNC
.
pP¨£
 =ÖParse;

104669 
sNC
.
pSrcLi°
 = 
pTabLi°
;

104677 
chngRowid
 = 0;

104678 
i
=0; i<
pCh™ges
->
nEx¥
; i++){

104679 if–
	`sqlôe3ResﬁveEx¥Names
(&
sNC
, 
pCh™ges
->
a
[
i
].
pEx¥
) ){

104680 
upd©e_˛ónup
;

104682 
j
=0; j<
pTab
->
nCﬁ
; j++){

104683 if–
	`sqlôe3SåICmp
(
pTab
->
aCﬁ
[
j
].
zName
, 
pCh™ges
->
a
[
i
].zName)==0 ){

104684 if–
j
==
pTab
->
iPKey
 ){

104685 
chngRowid
 = 1;

104686 
pRowidEx¥
 = 
pCh™ges
->
a
[
i
].
pEx¥
;

104688 
aXRef
[
j
] = 
i
;

104692 if–
j
>=
pTab
->
nCﬁ
 ){

104693 if–
	`sqlôe3IsRowid
(
pCh™ges
->
a
[
i
].
zName
) ){

104694 
j
 = -1;

104695 
chngRowid
 = 1;

104696 
pRowidEx¥
 = 
pCh™ges
->
a
[
i
].
pEx¥
;

104698 
	`sqlôe3Eº‹Msg
(
pP¨£
, "nÿsuch cﬁumn: %s", 
pCh™ges
->
a
[
i
].
zName
);

104699 
pP¨£
->
checkSchema
 = 1;

104700 
upd©e_˛ónup
;

104703 #i‚de‡
SQLITE_OMIT_AUTHORIZATION


104705 
rc
;

104706 
rc
 = 
	`sqlôe3AuthCheck
(
pP¨£
, 
SQLITE_UPDATE
, 
pTab
->
zName
,

104707 
j
<0 ? "ROWID" : 
pTab
->
aCﬁ
[j].
zName
,

104708 
db
->
aDb
[
iDb
].
zName
);

104709 if–
rc
==
SQLITE_DENY
 ){

104710 
upd©e_˛ónup
;

104711 }if–
rc
==
SQLITE_IGNORE
 ){

104712 
aXRef
[
j
] = -1;

104718 
hasFK
 = 
	`sqlôe3FkRequúed
(
pP¨£
, 
pTab
, 
aXRef
, 
chngRowid
);

104725 
nIdx
=0, 
pIdx
=
pTab
->
pIndex
;ÖIdx;ÖIdxıIdx->
pNext
,ÇIdx++){}

104726 if–
nIdx
>0 ){

104727 
aRegIdx
 = 
	`sqlôe3DbMÆlocRaw
(
db
, (
Index
*Ë* 
nIdx
 );

104728 if–
aRegIdx
==0 ) 
upd©e_˛ónup
;

104730 
j
=0, 
pIdx
=
pTab
->
pIndex
;ÖIdx;ÖIdxıIdx->
pNext
, j++){

104731 
ªg
;

104732 if–
hasFK
 || 
chngRowid
 || 
pIdx
->
pP¨tIdxWhîe
 ){

104733 
ªg
 = ++
pP¨£
->
nMem
;

104735 
ªg
 = 0;

104736 
i
=0; i<
pIdx
->
nCﬁumn
; i++){

104737 if–
aXRef
[
pIdx
->
aiCﬁumn
[
i
]]>=0 ){

104738 
ªg
 = ++
pP¨£
->
nMem
;

104743 
aRegIdx
[
j
] = 
ªg
;

104747 
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

104748 if–
v
==0 ) 
upd©e_˛ónup
;

104749 if–
pP¨£
->
√°ed
==0 ) 
	`sqlôe3VdbeCou¡Ch™ges
(
v
);

104750 
	`sqlôe3BegöWrôeO≥øti⁄
(
pP¨£
, 1, 
iDb
);

104752 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


104754 if–
	`IsVútuÆ
(
pTab
) ){

104755 
	`upd©eVútuÆTabÀ
(
pP¨£
, 
pTabLi°
, 
pTab
, 
pCh™ges
, 
pRowidEx¥
, 
aXRef
,

104756 
pWhîe
, 
⁄Eº‹
);

104757 
pWhîe
 = 0;

104758 
pTabLi°
 = 0;

104759 
upd©e_˛ónup
;

104764 
ªgRowSë
 = ++
pP¨£
->
nMem
;

104765 
ªgOldRowid
 = 
ªgNewRowid
 = ++
pP¨£
->
nMem
;

104766 if–
pTriggî
 || 
hasFK
 ){

104767 
ªgOld
 = 
pP¨£
->
nMem
 + 1;

104768 
pP¨£
->
nMem
 +
pTab
->
nCﬁ
;

104770 if–
chngRowid
 || 
pTriggî
 || 
hasFK
 ){

104771 
ªgNewRowid
 = ++
pP¨£
->
nMem
;

104773 
ªgNew
 = 
pP¨£
->
nMem
 + 1;

104774 
pP¨£
->
nMem
 +
pTab
->
nCﬁ
;

104777 if–
isVõw
 ){

104778 
	`sqlôe3AuthC⁄ãxtPush
(
pP¨£
, &
sC⁄ãxt
, 
pTab
->
zName
);

104784 #i‡!
	`deföed
(
SQLITE_OMIT_VIEW
Ë&& !deföed(
SQLITE_OMIT_TRIGGER
)

104785 if–
isVõw
 ){

104786 
	`sqlôe3M©îülizeVõw
(
pP¨£
, 
pTab
, 
pWhîe
, 
iCur
);

104793 if–
	`sqlôe3ResﬁveEx¥Names
(&
sNC
, 
pWhîe
) ){

104794 
upd©e_˛ónup
;

104799 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_NuŒ
, 0, 
ªgRowSë
, 
ªgOldRowid
);

104800 
pWInfo
 = 
	`sqlôe3WhîeBegö
(

104801 
pP¨£
, 
pTabLi°
, 
pWhîe
, 0, 0, 
WHERE_ONEPASS_DESIRED
, 0

104803 if–
pWInfo
==0 ) 
upd©e_˛ónup
;

104804 
okO√Pass
 = 
	`sqlôe3WhîeOkO√Pass
(
pWInfo
);

104808 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Rowid
, 
iCur
, 
ªgOldRowid
);

104809 if–!
okO√Pass
 ){

104810 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_RowSëAdd
, 
ªgRowSë
, 
ªgOldRowid
);

104815 
	`sqlôe3WhîeEnd
(
pWInfo
);

104819 if–(
db
->
Êags
 & 
SQLITE_Cou¡Rows
Ë&& !
pP¨£
->
pTriggîTab
 ){

104820 
ªgRowCou¡
 = ++
pP¨£
->
nMem
;

104821 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 0, 
ªgRowCou¡
);

104824 if–!
isVõw
 ){

104831 if–!
okO√Pass
 ) 
	`sqlôe3O≥nTabÀ
(
pP¨£
, 
iCur
, 
iDb
, 
pTab
, 
OP_O≥nWrôe
);

104832 if–
⁄Eº‹
==
OE_Rïœ˚
 ){

104833 
›íAŒ
 = 1;

104835 
›íAŒ
 = 0;

104836 
pIdx
=
pTab
->
pIndex
;ÖIdx;ÖIdxıIdx->
pNext
){

104837 if–
pIdx
->
⁄Eº‹
==
OE_Rïœ˚
 ){

104838 
›íAŒ
 = 1;

104843 
i
=0, 
pIdx
=
pTab
->
pIndex
;ÖIdx;ÖIdxıIdx->
pNext
, i++){

104844 
	`as£π
–
aRegIdx
 );

104845 if–
›íAŒ
 || 
aRegIdx
[
i
]>0 ){

104846 
KeyInfo
 *
pKey
 = 
	`sqlôe3IndexKeyöfo
(
pP¨£
, 
pIdx
);

104847 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_O≥nWrôe
, 
iCur
+
i
+1, 
pIdx
->
äum
, 
iDb
,

104848 (*)
pKey
, 
P4_KEYINFO_HANDOFF
);

104849 
	`as£π
–
pP¨£
->
nTab
>
iCur
+
i
+1 );

104855 if–
okO√Pass
 ){

104856 
a1
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_NŸNuŒ
, 
ªgOldRowid
);

104857 
addr
 = 
	`sqlôe3VdbeAddOp0
(
v
, 
OP_GŸo
);

104858 
	`sqlôe3VdbeJumpHîe
(
v
, 
a1
);

104860 
addr
 = 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_RowSëRód
, 
ªgRowSë
, 0, 
ªgOldRowid
);

104866 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_NŸExi°s
, 
iCur
, 
addr
, 
ªgOldRowid
);

104872 
	`as£π
–
chngRowid
 || 
pTriggî
 || 
hasFK
 || 
ªgOldRowid
==
ªgNewRowid
 );

104873 if–
chngRowid
 ){

104874 
	`sqlôe3Ex¥Code
(
pP¨£
, 
pRowidEx¥
, 
ªgNewRowid
);

104875 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Mu°BeI¡
, 
ªgNewRowid
);

104880 if–
hasFK
 || 
pTriggî
 ){

104881 
u32
 
ﬁdmask
 = (
hasFK
 ? 
	`sqlôe3FkOldmask
(
pP¨£
, 
pTab
) : 0);

104882 
ﬁdmask
 |
	`sqlôe3TriggîCﬁmask
(
pP¨£
,

104883 
pTriggî
, 
pCh™ges
, 0, 
TRIGGER_BEFORE
|
TRIGGER_AFTER
, 
pTab
, 
⁄Eº‹


104885 
i
=0; i<
pTab
->
nCﬁ
; i++){

104886 if–
aXRef
[
i
]<0 || 
ﬁdmask
==0xffffffff || (i<32 && (oldmask & (1<<i))) ){

104887 
	`sqlôe3Ex¥CodeGëCﬁumnOfTabÀ
(
v
, 
pTab
, 
iCur
, 
i
, 
ªgOld
+i);

104889 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NuŒ
, 0, 
ªgOld
+
i
);

104892 if–
chngRowid
==0 ){

104893 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_C›y
, 
ªgOldRowid
, 
ªgNewRowid
);

104910 
√wmask
 = 
	`sqlôe3TriggîCﬁmask
(

104911 
pP¨£
, 
pTriggî
, 
pCh™ges
, 1, 
TRIGGER_BEFORE
, 
pTab
, 
⁄Eº‹


104913 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_NuŒ
, 0, 
ªgNew
,ÑegNew+
pTab
->
nCﬁ
-1);

104914 
i
=0; i<
pTab
->
nCﬁ
; i++){

104915 if–
i
==
pTab
->
iPKey
 ){

104918 
j
 = 
aXRef
[
i
];

104919 if–
j
>=0 ){

104920 
	`sqlôe3Ex¥Code
(
pP¨£
, 
pCh™ges
->
a
[
j
].
pEx¥
, 
ªgNew
+
i
);

104921 }if–0==(
tmask
&
TRIGGER_BEFORE
Ë|| 
i
>31 || (
√wmask
&(1<<i)) ){

104927 
	`ã°ˇ£
–
i
==31 );

104928 
	`ã°ˇ£
–
i
==32 );

104929 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Cﬁumn
, 
iCur
, 
i
, 
ªgNew
+i);

104930 
	`sqlôe3CﬁumnDeÁu…
(
v
, 
pTab
, 
i
, 
ªgNew
+i);

104938 if–
tmask
&
TRIGGER_BEFORE
 ){

104939 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Afföôy
, 
ªgNew
, 
pTab
->
nCﬁ
);

104940 
	`sqlôe3TabÀAfföôySå
(
v
, 
pTab
);

104941 
	`sqlôe3CodeRowTriggî
(
pP¨£
, 
pTriggî
, 
TK_UPDATE
, 
pCh™ges
,

104942 
TRIGGER_BEFORE
, 
pTab
, 
ªgOldRowid
, 
⁄Eº‹
, 
addr
);

104950 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_NŸExi°s
, 
iCur
, 
addr
, 
ªgOldRowid
);

104957 
i
=0; i<
pTab
->
nCﬁ
; i++){

104958 if–
aXRef
[
i
]<0 && i!=
pTab
->
iPKey
 ){

104959 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Cﬁumn
, 
iCur
, 
i
, 
ªgNew
+i);

104960 
	`sqlôe3CﬁumnDeÁu…
(
v
, 
pTab
, 
i
, 
ªgNew
+i);

104965 if–!
isVõw
 ){

104966 
j1
;

104969 
	`sqlôe3Gíî©eC⁄°øötChecks
(
pP¨£
, 
pTab
, 
iCur
, 
ªgNewRowid
,

104970 
aRegIdx
, (
chngRowid
?
ªgOldRowid
:0), 1, 
⁄Eº‹
, 
addr
, 0);

104973 if–
hasFK
 ){

104974 
	`sqlôe3FkCheck
(
pP¨£
, 
pTab
, 
ªgOldRowid
, 0, 
aXRef
, 
chngRowid
);

104978 
j1
 = 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_NŸExi°s
, 
iCur
, 0, 
ªgOldRowid
);

104979 
	`sqlôe3Gíî©eRowIndexDñëe
(
pP¨£
, 
pTab
, 
iCur
, 
aRegIdx
);

104982 if–
hasFK
 || 
chngRowid
 ){

104983 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Dñëe
, 
iCur
, 0);

104985 
	`sqlôe3VdbeJumpHîe
(
v
, 
j1
);

104987 if–
hasFK
 ){

104988 
	`sqlôe3FkCheck
(
pP¨£
, 
pTab
, 0, 
ªgNewRowid
, 
aXRef
, 
chngRowid
);

104992 
	`sqlôe3Com∂ëeIn£πi⁄
(
pP¨£
, 
pTab
, 
iCur
, 
ªgNewRowid
, 
aRegIdx
, 1, 0, 0);

104997 if–
hasFK
 ){

104998 
	`sqlôe3FkA˘i⁄s
(
pP¨£
, 
pTab
, 
pCh™ges
, 
ªgOldRowid
, 
aXRef
, 
chngRowid
);

105004 if–(
db
->
Êags
 & 
SQLITE_Cou¡Rows
Ë&& !
pP¨£
->
pTriggîTab
){

105005 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_AddImm
, 
ªgRowCou¡
, 1);

105008 
	`sqlôe3CodeRowTriggî
(
pP¨£
, 
pTriggî
, 
TK_UPDATE
, 
pCh™ges
,

105009 
TRIGGER_AFTER
, 
pTab
, 
ªgOldRowid
, 
⁄Eº‹
, 
addr
);

105014 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_GŸo
, 0, 
addr
);

105015 
	`sqlôe3VdbeJumpHîe
(
v
, 
addr
);

105018 
i
=0, 
pIdx
=
pTab
->
pIndex
;ÖIdx;ÖIdxıIdx->
pNext
, i++){

105019 
	`as£π
–
aRegIdx
 );

105020 if–
›íAŒ
 || 
aRegIdx
[
i
]>0 ){

105021 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Clo£
, 
iCur
+
i
+1, 0);

105024 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Clo£
, 
iCur
, 0);

105030 if–
pP¨£
->
√°ed
==0 &&ÖP¨£->
pTriggîTab
==0 ){

105031 
	`sqlôe3Autoö¸emítEnd
(
pP¨£
);

105039 if–(
db
->
Êags
&
SQLITE_Cou¡Rows
Ë&& !
pP¨£
->
pTriggîTab
 && !pP¨£->
√°ed
 ){

105040 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Resu…Row
, 
ªgRowCou¡
, 1);

105041 
	`sqlôe3VdbeSëNumCﬁs
(
v
, 1);

105042 
	`sqlôe3VdbeSëCﬁName
(
v
, 0, 
COLNAME_NAME
, "row†upd©ed", 
SQLITE_STATIC
);

105045 
upd©e_˛ónup
:

105046 
	`sqlôe3AuthC⁄ãxtP›
(&
sC⁄ãxt
);

105047 
	`sqlôe3DbFªe
(
db
, 
aRegIdx
);

105048 
	`sqlôe3DbFªe
(
db
, 
aXRef
);

105049 
	`sqlôe3SrcLi°Dñëe
(
db
, 
pTabLi°
);

105050 
	`sqlôe3Ex¥Li°Dñëe
(
db
, 
pCh™ges
);

105051 
	`sqlôe3Ex¥Dñëe
(
db
, 
pWhîe
);

105057 #ifde‡
isVõw


105058 #unde‡
isVõw


105060 #ifde‡
pTriggî


105061 #unde‡
pTriggî


105064 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


105084 
	`upd©eVútuÆTabÀ
(

105085 
P¨£
 *
pP¨£
,

105086 
SrcLi°
 *
pSrc
,

105087 
TabÀ
 *
pTab
,

105088 
Ex¥Li°
 *
pCh™ges
,

105089 
Ex¥
 *
pRowid
,

105090 *
aXRef
,

105091 
Ex¥
 *
pWhîe
,

105092 
⁄Eº‹


105094 
Vdbe
 *
v
 = 
pP¨£
->
pVdbe
;

105095 
Ex¥Li°
 *
pELi°
 = 0;

105096 
Sñe˘
 *
pSñe˘
 = 0;

105097 
Ex¥
 *
pEx¥
;

105098 
ïhemTab
;

105099 
i
;

105100 
addr
;

105101 
iReg
;

105102 
sqlôe3
 *
db
 = 
pP¨£
->db;

105103 c⁄° *
pVTab
 = (c⁄° *)
	`sqlôe3GëVTabÀ
(
db
, 
pTab
);

105104 
Sñe˘De°
 
de°
;

105109 
pELi°
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
, 0, 
	`sqlôe3Ex¥
(
db
, 
TK_ID
, "_rowid_"));

105110 if–
pRowid
 ){

105111 
pELi°
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,ÖEList,

105112 
	`sqlôe3Ex¥Dup
(
db
, 
pRowid
, 0));

105114 
	`as£π
–
pTab
->
iPKey
<0 );

105115 
i
=0; i<
pTab
->
nCﬁ
; i++){

105116 if–
aXRef
[
i
]>=0 ){

105117 
pEx¥
 = 
	`sqlôe3Ex¥Dup
(
db
, 
pCh™ges
->
a
[
aXRef
[
i
]].pExpr, 0);

105119 
pEx¥
 = 
	`sqlôe3Ex¥
(
db
, 
TK_ID
, 
pTab
->
aCﬁ
[
i
].
zName
);

105121 
pELi°
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,ÖELi°, 
pEx¥
);

105123 
pSñe˘
 = 
	`sqlôe3Sñe˘New
(
pP¨£
, 
pELi°
, 
pSrc
, 
pWhîe
, 0, 0, 0, 0, 0, 0);

105128 
	`as£π
–
v
 );

105129 
ïhemTab
 = 
pP¨£
->
nTab
++;

105130 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_O≥nEphemîÆ
, 
ïhemTab
, 
pTab
->
nCﬁ
+1+(
pRowid
!=0));

105131 
	`sqlôe3VdbeCh™geP5
(
v
, 
BTREE_UNORDERED
);

105135 
	`sqlôe3Sñe˘De°Inô
(&
de°
, 
SRT_TabÀ
, 
ïhemTab
);

105136 
	`sqlôe3Sñe˘
(
pP¨£
, 
pSñe˘
, &
de°
);

105139 
iReg
 = ++
pP¨£
->
nMem
;

105140 
pP¨£
->
nMem
 +
pTab
->
nCﬁ
+1;

105141 
addr
 = 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Rewöd
, 
ïhemTab
, 0);

105142 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Cﬁumn
, 
ïhemTab
, 0, 
iReg
);

105143 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Cﬁumn
, 
ïhemTab
, (
pRowid
?1:0), 
iReg
+1);

105144 
i
=0; i<
pTab
->
nCﬁ
; i++){

105145 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Cﬁumn
, 
ïhemTab
, 
i
+1+(
pRowid
!=0), 
iReg
+2+i);

105147 
	`sqlôe3VèbMakeWrôabÀ
(
pP¨£
, 
pTab
);

105148 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_VUpd©e
, 0, 
pTab
->
nCﬁ
+2, 
iReg
, 
pVTab
, 
P4_VTAB
);

105149 
	`sqlôe3VdbeCh™geP5
(
v
, 
⁄Eº‹
==
OE_DeÁu…
 ? 
OE_Ab‹t
 : onError);

105150 
	`sqlôe3MayAb‹t
(
pP¨£
);

105151 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Next
, 
ïhemTab
, 
addr
+1);

105152 
	`sqlôe3VdbeJumpHîe
(
v
, 
addr
);

105153 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Clo£
, 
ïhemTab
, 0);

105156 
	`sqlôe3Sñe˘Dñëe
(
db
, 
pSñe˘
);

105179 #i‡!
	`deföed
(
SQLITE_OMIT_VACUUM
Ë&& !deföed(
SQLITE_OMIT_ATTACH
)

105184 
	`vacuumFöÆize
(
sqlôe3
 *
db
, 
sqlôe3_°mt
 *
pStmt
, **
pzEºMsg
){

105185 
rc
;

105186 
rc
 = 
	`sqlôe3VdbeFöÆize
((
Vdbe
*)
pStmt
);

105187 if–
rc
 ){

105188 
	`sqlôe3SëSåög
(
pzEºMsg
, 
db
, 
	`sqlôe3_îrmsg
(db));

105190  
rc
;

105196 
	`execSql
(
sqlôe3
 *
db
, **
pzEºMsg
, c⁄° *
zSql
){

105197 
sqlôe3_°mt
 *
pStmt
;

105198 
	`VVA_ONLY
–
rc
; )

105199 if–!
zSql
 ){

105200  
SQLITE_NOMEM
;

105202 if–
SQLITE_OK
!=
	`sqlôe3_¥ï¨e
(
db
, 
zSql
, -1, &
pStmt
, 0) ){

105203 
	`sqlôe3SëSåög
(
pzEºMsg
, 
db
, 
	`sqlôe3_îrmsg
(db));

105204  
	`sqlôe3_îrcode
(
db
);

105206 
	`VVA_ONLY
–
rc
 = ) 
	`sqlôe3_°ï
(
pStmt
);

105207 
	`as£π
–
rc
!=
SQLITE_ROW
 || (
db
->
Êags
&
SQLITE_Cou¡Rows
) );

105208  
	`vacuumFöÆize
(
db
, 
pStmt
, 
pzEºMsg
);

105215 
	`execExecSql
(
sqlôe3
 *
db
, **
pzEºMsg
, c⁄° *
zSql
){

105216 
sqlôe3_°mt
 *
pStmt
;

105217 
rc
;

105219 
rc
 = 
	`sqlôe3_¥ï¨e
(
db
, 
zSql
, -1, &
pStmt
, 0);

105220 if–
rc
!=
SQLITE_OK
 ) Ñc;

105222  
SQLITE_ROW
==
	`sqlôe3_°ï
(
pStmt
) ){

105223 
rc
 = 
	`execSql
(
db
, 
pzEºMsg
, (*)
	`sqlôe3_cﬁumn_ãxt
(
pStmt
, 0));

105224 if–
rc
!=
SQLITE_OK
 ){

105225 
	`vacuumFöÆize
(
db
, 
pStmt
, 
pzEºMsg
);

105226  
rc
;

105230  
	`vacuumFöÆize
(
db
, 
pStmt
, 
pzEºMsg
);

105263 
SQLITE_PRIVATE
 
	`sqlôe3Vacuum
(
P¨£
 *
pP¨£
){

105264 
Vdbe
 *
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

105265 if–
v
 ){

105266 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Vacuum
, 0, 0);

105267 
	`sqlôe3VdbeU£sBåì
(
v
, 0);

105275 
SQLITE_PRIVATE
 
	`sqlôe3RunVacuum
(**
pzEºMsg
, 
sqlôe3
 *
db
){

105276 
rc
 = 
SQLITE_OK
;

105277 
Båì
 *
pMaö
;

105278 
Båì
 *
pTemp
;

105279 *
zSql
 = 0;

105280 
ßved_Êags
;

105281 
ßved_nCh™ge
;

105282 
ßved_nTŸÆCh™ge
;

105283 (*
ßved_xTø˚
)(*,const *);

105284 
Db
 *
pDb
 = 0;

105285 
isMemDb
;

105286 
nRes
;

105287 
nDb
;

105289 if–!
db
->
autoCommô
 ){

105290 
	`sqlôe3SëSåög
(
pzEºMsg
, 
db
, "cannot VACUUM from withináÅransaction");

105291  
SQLITE_ERROR
;

105293 if–
db
->
nVdbeA˘ive
>1 ){

105294 
	`sqlôe3SëSåög
(
pzEºMsg
, 
db
,"cannot VACUUM - SQL statements inÖrogress");

105295  
SQLITE_ERROR
;

105301 
ßved_Êags
 = 
db
->
Êags
;

105302 
ßved_nCh™ge
 = 
db
->
nCh™ge
;

105303 
ßved_nTŸÆCh™ge
 = 
db
->
nTŸÆCh™ge
;

105304 
ßved_xTø˚
 = 
db
->
xTø˚
;

105305 
db
->
Êags
 |
SQLITE_WrôeSchema
 | 
SQLITE_Ign‹eChecks
 | 
SQLITE_Pª„rBuûtö
;

105306 
db
->
Êags
 &~(
SQLITE_F‹eignKeys
 | 
SQLITE_Revî£Ordî
);

105307 
db
->
xTø˚
 = 0;

105309 
pMaö
 = 
db
->
aDb
[0].
pBt
;

105310 
isMemDb
 = 
	`sqlôe3PagîIsMemdb
(
	`sqlôe3BåìPagî
(
pMaö
));

105326 
nDb
 = 
db
->nDb;

105327 if–
	`sqlôe3TempInMem‹y
(
db
) ){

105328 
zSql
 = "ATTACH ':memory:' AS vacuum_db;";

105330 
zSql
 = "ATTACH '' AS vacuum_db;";

105332 
rc
 = 
	`execSql
(
db
, 
pzEºMsg
, 
zSql
);

105333 if–
db
->
nDb
>nDb ){

105334 
pDb
 = &
db
->
aDb
[db->
nDb
-1];

105335 
	`as£π
–
	`°rcmp
(
pDb
->
zName
,"vacuum_db")==0 );

105337 if–
rc
!=
SQLITE_OK
 ) 
íd_of_vacuum
;

105338 
pTemp
 = 
db
->
aDb
[db->
nDb
-1].
pBt
;

105344 
	`sqlôe3BåìCommô
(
pTemp
);

105346 
nRes
 = 
	`sqlôe3BåìGëRe£rve
(
pMaö
);

105349 #ifde‡
SQLITE_HAS_CODEC


105350 if–
db
->
√xtPagesize
 ){

105351 
	`sqlôe3CodecGëKey
(
sqlôe3
*, , **, *);

105352 
nKey
;

105353 *
zKey
;

105354 
	`sqlôe3CodecGëKey
(
db
, 0, (**)&
zKey
, &
nKey
);

105355 if–
nKey
 ) 
db
->
√xtPagesize
 = 0;

105359 
rc
 = 
	`execSql
(
db
, 
pzEºMsg
, "PRAGMA vacuum_db.synchronous=OFF");

105360 if–
rc
!=
SQLITE_OK
 ) 
íd_of_vacuum
;

105366 
rc
 = 
	`execSql
(
db
, 
pzEºMsg
, "BEGIN;");

105367 if–
rc
!=
SQLITE_OK
 ) 
íd_of_vacuum
;

105368 
rc
 = 
	`sqlôe3BåìBegöTøns
(
pMaö
, 2);

105369 if–
rc
!=
SQLITE_OK
 ) 
íd_of_vacuum
;

105372 if–
	`sqlôe3PagîGëJou∫ÆMode
(
	`sqlôe3BåìPagî
(
pMaö
))

105373 ==
PAGER_JOURNALMODE_WAL
 ){

105374 
db
->
√xtPagesize
 = 0;

105377 if–
	`sqlôe3BåìSëPageSize
(
pTemp
, 
	`sqlôe3BåìGëPageSize
(
pMaö
), 
nRes
, 0)

105378 || (!
isMemDb
 && 
	`sqlôe3BåìSëPageSize
(
pTemp
, 
db
->
√xtPagesize
, 
nRes
, 0))

105379 || 
	`NEVER
(
db
->
mÆlocFaûed
)

105381 
rc
 = 
SQLITE_NOMEM
;

105382 
íd_of_vacuum
;

105385 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


105386 
	`sqlôe3BåìSëAutoVacuum
(
pTemp
, 
db
->
√xtAutovac
>=0 ? db->nextAutovac :

105387 
	`sqlôe3BåìGëAutoVacuum
(
pMaö
));

105393 
rc
 = 
	`execExecSql
(
db
, 
pzEºMsg
,

105398 if–
rc
!=
SQLITE_OK
 ) 
íd_of_vacuum
;

105399 
rc
 = 
	`execExecSql
(
db
, 
pzEºMsg
,

105402 if–
rc
!=
SQLITE_OK
 ) 
íd_of_vacuum
;

105403 
rc
 = 
	`execExecSql
(
db
, 
pzEºMsg
,

105406 if–
rc
!=
SQLITE_OK
 ) 
íd_of_vacuum
;

105412 
rc
 = 
	`execExecSql
(
db
, 
pzEºMsg
,

105419 if–
rc
!=
SQLITE_OK
 ) 
íd_of_vacuum
;

105423 
rc
 = 
	`execExecSql
(
db
, 
pzEºMsg
,

105427 if–
rc
!=
SQLITE_OK
 ) 
íd_of_vacuum
;

105428 
rc
 = 
	`execExecSql
(
db
, 
pzEºMsg
,

105433 if–
rc
!=
SQLITE_OK
 ) 
íd_of_vacuum
;

105441 
rc
 = 
	`execSql
(
db
, 
pzEºMsg
,

105448 if–
rc
 ) 
íd_of_vacuum
;

105457 
u32
 
mëa
;

105458 
i
;

105466 c⁄° 
aC›y
[] = {

105467 
BTREE_SCHEMA_VERSION
, 1,

105468 
BTREE_DEFAULT_CACHE_SIZE
, 0,

105469 
BTREE_TEXT_ENCODING
, 0,

105470 
BTREE_USER_VERSION
, 0,

105471 
BTREE_APPLICATION_ID
, 0,

105474 
	`as£π
–1==
	`sqlôe3BåìIsInTøns
(
pTemp
) );

105475 
	`as£π
–1==
	`sqlôe3BåìIsInTøns
(
pMaö
) );

105478 
i
=0; i<
	`AºaySize
(
aC›y
); i+=2){

105481 
	`sqlôe3BåìGëMëa
(
pMaö
, 
aC›y
[
i
], &
mëa
);

105482 
rc
 = 
	`sqlôe3BåìUpd©eMëa
(
pTemp
, 
aC›y
[
i
], 
mëa
+aCopy[i+1]);

105483 if–
	`NEVER
(
rc
!=
SQLITE_OK
ËË
íd_of_vacuum
;

105486 
rc
 = 
	`sqlôe3BåìC›yFûe
(
pMaö
, 
pTemp
);

105487 if–
rc
!=
SQLITE_OK
 ) 
íd_of_vacuum
;

105488 
rc
 = 
	`sqlôe3BåìCommô
(
pTemp
);

105489 if–
rc
!=
SQLITE_OK
 ) 
íd_of_vacuum
;

105490 #i‚de‡
SQLITE_OMIT_AUTOVACUUM


105491 
	`sqlôe3BåìSëAutoVacuum
(
pMaö
, 
	`sqlôe3BåìGëAutoVacuum
(
pTemp
));

105495 
	`as£π
–
rc
==
SQLITE_OK
 );

105496 
rc
 = 
	`sqlôe3BåìSëPageSize
(
pMaö
, 
	`sqlôe3BåìGëPageSize
(
pTemp
), 
nRes
,1);

105498 
íd_of_vacuum
:

105500 
db
->
Êags
 = 
ßved_Êags
;

105501 
db
->
nCh™ge
 = 
ßved_nCh™ge
;

105502 
db
->
nTŸÆCh™ge
 = 
ßved_nTŸÆCh™ge
;

105503 
db
->
xTø˚
 = 
ßved_xTø˚
;

105504 
	`sqlôe3BåìSëPageSize
(
pMaö
, -1, -1, 1);

105513 
db
->
autoCommô
 = 1;

105515 if–
pDb
 ){

105516 
	`sqlôe3BåìClo£
(
pDb
->
pBt
);

105517 
pDb
->
pBt
 = 0;

105518 
pDb
->
pSchema
 = 0;

105523 
	`sqlôe3Re£tAŒSchemasOfC⁄√˘i⁄
(
db
);

105525  
rc
;

105545 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


105554 
	sVèbCtx
 {

105555 
VTabÀ
 *
pVTabÀ
;

105556 
TabÀ
 *
pTab
;

105564 
	`¸óãModuÀ
(

105565 
sqlôe3
 *
db
,

105566 c⁄° *
zName
,

105567 c⁄° 
sqlôe3_moduÀ
 *
pModuÀ
,

105568 *
pAux
,

105569 (*
xDe°roy
)(*)

105571 
rc
 = 
SQLITE_OK
;

105572 
nName
;

105574 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

105575 
nName
 = 
	`sqlôe3SåÀn30
(
zName
);

105576 if–
	`sqlôe3HashFöd
(&
db
->
aModuÀ
, 
zName
, 
nName
) ){

105577 
rc
 = 
SQLITE_MISUSE_BKPT
;

105579 
ModuÀ
 *
pMod
;

105580 
pMod
 = (
ModuÀ
 *)
	`sqlôe3DbMÆlocRaw
(
db
, (ModuÀË+ 
nName
 + 1);

105581 if–
pMod
 ){

105582 
ModuÀ
 *
pDñ
;

105583 *
zC›y
 = (*)(&
pMod
[1]);

105584 
	`mem˝y
(
zC›y
, 
zName
, 
nName
+1);

105585 
pMod
->
zName
 = 
zC›y
;

105586 
pMod
->
pModuÀ
 =ÖModule;

105587 
pMod
->
pAux
 =ÖAux;

105588 
pMod
->
xDe°roy
 = xDestroy;

105589 
pDñ
 = (
ModuÀ
 *)
	`sqlôe3HashIn£π
(&
db
->
aModuÀ
,
zC›y
,
nName
,(*)
pMod
);

105590 
	`as£π
–
pDñ
==0 ||ÖDñ==
pMod
 );

105591 if–
pDñ
 ){

105592 
db
->
mÆlocFaûed
 = 1;

105593 
	`sqlôe3DbFªe
(
db
, 
pDñ
);

105597 
rc
 = 
	`sqlôe3ApiExô
(
db
,Ñc);

105598 if–
rc
!=
SQLITE_OK
 && 
xDe°roy
 ) 
	`xDe°roy
(
pAux
);

105600 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

105601  
rc
;

105608 
SQLITE_API
 
	`sqlôe3_¸óã_moduÀ
(

105609 
sqlôe3
 *
db
,

105610 c⁄° *
zName
,

105611 c⁄° 
sqlôe3_moduÀ
 *
pModuÀ
,

105612 *
pAux


105614  
	`¸óãModuÀ
(
db
, 
zName
, 
pModuÀ
, 
pAux
, 0);

105620 
SQLITE_API
 
	`sqlôe3_¸óã_moduÀ_v2
(

105621 
sqlôe3
 *
db
,

105622 c⁄° *
zName
,

105623 c⁄° 
sqlôe3_moduÀ
 *
pModuÀ
,

105624 *
pAux
,

105625 (*
xDe°roy
)(*)

105627  
	`¸óãModuÀ
(
db
, 
zName
, 
pModuÀ
, 
pAux
, 
xDe°roy
);

105638 
SQLITE_PRIVATE
 
	`sqlôe3VèbLock
(
VTabÀ
 *
pVTab
){

105639 
pVTab
->
nRef
++;

105648 
SQLITE_PRIVATE
 
VTabÀ
 *
	`sqlôe3GëVTabÀ
(
sqlôe3
 *
db
, 
TabÀ
 *
pTab
){

105649 
VTabÀ
 *
pVèb
;

105650 
	`as£π
–
	`IsVútuÆ
(
pTab
) );

105651 
pVèb
=
pTab
->
pVTabÀ
;ÖVèb &&ÖVèb->
db
!=db;ÖVèbıVèb->
pNext
);

105652  
pVèb
;

105659 
SQLITE_PRIVATE
 
	`sqlôe3VèbU∆ock
(
VTabÀ
 *
pVTab
){

105660 
sqlôe3
 *
db
 = 
pVTab
->db;

105662 
	`as£π
–
db
 );

105663 
	`as£π
–
pVTab
->
nRef
>0 );

105664 
	`as£π
–
db
->
magic
==
SQLITE_MAGIC_OPEN
 || db->magic==
SQLITE_MAGIC_ZOMBIE
 );

105666 
pVTab
->
nRef
--;

105667 if–
pVTab
->
nRef
==0 ){

105668 
sqlôe3_vèb
 *
p
 = 
pVTab
->
pVèb
;

105669 if–
p
 ){

105670 
p
->
pModuÀ
->
	`xDisc⁄√˘
(p);

105672 
	`sqlôe3DbFªe
(
db
, 
pVTab
);

105683 
VTabÀ
 *
	`vèbDisc⁄√˘AŒ
(
sqlôe3
 *
db
, 
TabÀ
 *
p
){

105684 
VTabÀ
 *
pRë
 = 0;

105685 
VTabÀ
 *
pVTabÀ
 = 
p
->pVTable;

105686 
p
->
pVTabÀ
 = 0;

105694 
	`as£π
–
db
==0 || 
	`sqlôe3SchemaMuãxHñd
(db, 0, 
p
->
pSchema
) );

105696  
pVTabÀ
 ){

105697 
sqlôe3
 *
db2
 = 
pVTabÀ
->
db
;

105698 
VTabÀ
 *
pNext
 = 
pVTabÀ
->pNext;

105699 
	`as£π
–
db2
 );

105700 if–
db2
==
db
 ){

105701 
pRë
 = 
pVTabÀ
;

105702 
p
->
pVTabÀ
 = 
pRë
;

105703 
pRë
->
pNext
 = 0;

105705 
pVTabÀ
->
pNext
 = 
db2
->
pDisc⁄√˘
;

105706 
db2
->
pDisc⁄√˘
 = 
pVTabÀ
;

105708 
pVTabÀ
 = 
pNext
;

105711 
	`as£π
–!
db
 || 
pRë
 );

105712  
pRë
;

105723 
SQLITE_PRIVATE
 
	`sqlôe3VèbDisc⁄√˘
(
sqlôe3
 *
db
, 
TabÀ
 *
p
){

105724 
VTabÀ
 **
µVTab
;

105726 
	`as£π
–
	`IsVútuÆ
(
p
) );

105727 
	`as£π
–
	`sqlôe3BåìHﬁdsAŒMuãxes
(
db
) );

105728 
	`as£π
–
	`sqlôe3_muãx_hñd
(
db
->
muãx
) );

105730 
µVTab
=&
p
->
pVTabÀ
; *µVTab;ÖpVTab=&(*µVTab)->
pNext
){

105731 if–(*
µVTab
)->
db
==db ){

105732 
VTabÀ
 *
pVTab
 = *
µVTab
;

105733 *
µVTab
 = 
pVTab
->
pNext
;

105734 
	`sqlôe3VèbU∆ock
(
pVTab
);

105761 
SQLITE_PRIVATE
 
	`sqlôe3VèbU∆ockLi°
(
sqlôe3
 *
db
){

105762 
VTabÀ
 *
p
 = 
db
->
pDisc⁄√˘
;

105763 
db
->
pDisc⁄√˘
 = 0;

105765 
	`as£π
–
	`sqlôe3BåìHﬁdsAŒMuãxes
(
db
) );

105766 
	`as£π
–
	`sqlôe3_muãx_hñd
(
db
->
muãx
) );

105768 if–
p
 ){

105769 
	`sqlôe3ExpúePª∑ªdSèãmíts
(
db
);

105771 
VTabÀ
 *
pNext
 = 
p
->pNext;

105772 
	`sqlôe3VèbU∆ock
(
p
);

105773 
p
 = 
pNext
;

105774 } 
p
 );

105792 
SQLITE_PRIVATE
 
	`sqlôe3VèbCÀ¨
(
sqlôe3
 *
db
, 
TabÀ
 *
p
){

105793 if–!
db
 || db->
≤ByãsFªed
==0 ) 
	`vèbDisc⁄√˘AŒ
(0, 
p
);

105794 if–
p
->
azModuÀArg
 ){

105795 
i
;

105796 
i
=0; i<
p
->
nModuÀArg
; i++){

105797 if–
i
!=1 ) 
	`sqlôe3DbFªe
(
db
, 
p
->
azModuÀArg
[i]);

105799 
	`sqlôe3DbFªe
(
db
, 
p
->
azModuÀArg
);

105809 
	`addModuÀArgumít
(
sqlôe3
 *
db
, 
TabÀ
 *
pTabÀ
, *
zArg
){

105810 
i
 = 
pTabÀ
->
nModuÀArg
++;

105811 
nByãs
 = (*)*(1+
pTabÀ
->
nModuÀArg
);

105812 **
azModuÀArg
;

105813 
azModuÀArg
 = 
	`sqlôe3DbRóŒoc
(
db
, 
pTabÀ
->azModuÀArg, 
nByãs
);

105814 if–
azModuÀArg
==0 ){

105815 
j
;

105816 
j
=0; j<
i
; j++){

105817 
	`sqlôe3DbFªe
(
db
, 
pTabÀ
->
azModuÀArg
[
j
]);

105819 
	`sqlôe3DbFªe
(
db
, 
zArg
);

105820 
	`sqlôe3DbFªe
(
db
, 
pTabÀ
->
azModuÀArg
);

105821 
pTabÀ
->
nModuÀArg
 = 0;

105823 
azModuÀArg
[
i
] = 
zArg
;

105824 
azModuÀArg
[
i
+1] = 0;

105826 
pTabÀ
->
azModuÀArg
 =ázModuleArg;

105834 
SQLITE_PRIVATE
 
	`sqlôe3VèbBegöP¨£
(

105835 
P¨£
 *
pP¨£
,

105836 
Tokí
 *
pName1
,

105837 
Tokí
 *
pName2
,

105838 
Tokí
 *
pModuÀName
,

105839 
ifNŸExi°s


105841 
iDb
;

105842 
TabÀ
 *
pTabÀ
;

105843 
sqlôe3
 *
db
;

105845 
	`sqlôe3SèπTabÀ
(
pP¨£
, 
pName1
, 
pName2
, 0, 0, 1, 
ifNŸExi°s
);

105846 
pTabÀ
 = 
pP¨£
->
pNewTabÀ
;

105847 if–
pTabÀ
==0 ) ;

105848 
	`as£π
–0==
pTabÀ
->
pIndex
 );

105850 
db
 = 
pP¨£
->db;

105851 
iDb
 = 
	`sqlôe3SchemaToIndex
(
db
, 
pTabÀ
->
pSchema
);

105852 
	`as£π
–
iDb
>=0 );

105854 
pTabÀ
->
èbFœgs
 |
TF_VútuÆ
;

105855 
pTabÀ
->
nModuÀArg
 = 0;

105856 
	`addModuÀArgumít
(
db
, 
pTabÀ
, 
	`sqlôe3NameFromTokí
(db, 
pModuÀName
));

105857 
	`addModuÀArgumít
(
db
, 
pTabÀ
, 0);

105858 
	`addModuÀArgumít
(
db
, 
pTabÀ
, 
	`sqlôe3DbSåDup
(db,ÖTabÀ->
zName
));

105859 
pP¨£
->
sNameTokí
.
n
 = ()(&
pModuÀName
->
z
[pModuÀName->n] - 
pName1
->z);

105861 #i‚de‡
SQLITE_OMIT_AUTHORIZATION


105867 if–
pTabÀ
->
azModuÀArg
 ){

105868 
	`sqlôe3AuthCheck
(
pP¨£
, 
SQLITE_CREATE_VTABLE
, 
pTabÀ
->
zName
,

105869 
pTabÀ
->
azModuÀArg
[0], 
pP¨£
->
db
->
aDb
[
iDb
].
zName
);

105879 
	`addArgumítToVèb
(
P¨£
 *
pP¨£
){

105880 if–
pP¨£
->
sArg
.
z
 &&ÖP¨£->
pNewTabÀ
 ){

105881 c⁄° *
z
 = (c⁄° *)
pP¨£
->
sArg
.z;

105882 
n
 = 
pP¨£
->
sArg
.n;

105883 
sqlôe3
 *
db
 = 
pP¨£
->db;

105884 
	`addModuÀArgumít
(
db
, 
pP¨£
->
pNewTabÀ
, 
	`sqlôe3DbSåNDup
(db, 
z
, 
n
));

105892 
SQLITE_PRIVATE
 
	`sqlôe3VèbFöishP¨£
(
P¨£
 *
pP¨£
, 
Tokí
 *
pEnd
){

105893 
TabÀ
 *
pTab
 = 
pP¨£
->
pNewTabÀ
;

105894 
sqlôe3
 *
db
 = 
pP¨£
->db;

105896 if–
pTab
==0 ) ;

105897 
	`addArgumítToVèb
(
pP¨£
);

105898 
pP¨£
->
sArg
.
z
 = 0;

105899 if–
pTab
->
nModuÀArg
<1 ) ;

105907 if–!
db
->
öô
.
busy
 ){

105908 *
zStmt
;

105909 *
zWhîe
;

105910 
iDb
;

105911 
Vdbe
 *
v
;

105914 if–
pEnd
 ){

105915 
pP¨£
->
sNameTokí
.
n
 = ()(
pEnd
->
z
 -ÖParse->sNameToken.z) +ÖEnd->n;

105917 
zStmt
 = 
	`sqlôe3MPrötf
(
db
, "CREATE VIRTUAL TABLE %T", &
pP¨£
->
sNameTokí
);

105927 
iDb
 = 
	`sqlôe3SchemaToIndex
(
db
, 
pTab
->
pSchema
);

105928 
	`sqlôe3Ne°edP¨£
(
pP¨£
,

105932 
db
->
aDb
[
iDb
].
zName
, 
	`SCHEMA_TABLE
(iDb),

105933 
pTab
->
zName
,

105934 
pTab
->
zName
,

105935 
zStmt
,

105936 
pP¨£
->
ªgRowid


105938 
	`sqlôe3DbFªe
(
db
, 
zStmt
);

105939 
v
 = 
	`sqlôe3GëVdbe
(
pP¨£
);

105940 
	`sqlôe3Ch™geCookõ
(
pP¨£
, 
iDb
);

105942 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Expúe
, 0, 0);

105943 
zWhîe
 = 
	`sqlôe3MPrötf
(
db
, "«me='%q' ANDÅy≥='èbÀ'", 
pTab
->
zName
);

105944 
	`sqlôe3VdbeAddP¨£SchemaOp
(
v
, 
iDb
, 
zWhîe
);

105945 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_VCª©e
, 
iDb
, 0, 0,

105946 
pTab
->
zName
, 
	`sqlôe3SåÀn30
(pTab->zName) + 1);

105955 
TabÀ
 *
pOld
;

105956 
Schema
 *
pSchema
 = 
pTab
->pSchema;

105957 c⁄° *
zName
 = 
pTab
->zName;

105958 
nName
 = 
	`sqlôe3SåÀn30
(
zName
);

105959 
	`as£π
–
	`sqlôe3SchemaMuãxHñd
(
db
, 0, 
pSchema
) );

105960 
pOld
 = 
	`sqlôe3HashIn£π
(&
pSchema
->
tblHash
, 
zName
, 
nName
, 
pTab
);

105961 if–
pOld
 ){

105962 
db
->
mÆlocFaûed
 = 1;

105963 
	`as£π
–
pTab
==
pOld
 );

105966 
pP¨£
->
pNewTabÀ
 = 0;

105974 
SQLITE_PRIVATE
 
	`sqlôe3VèbArgInô
(
P¨£
 *
pP¨£
){

105975 
	`addArgumítToVèb
(
pP¨£
);

105976 
pP¨£
->
sArg
.
z
 = 0;

105977 
pP¨£
->
sArg
.
n
 = 0;

105984 
SQLITE_PRIVATE
 
	`sqlôe3VèbArgExãnd
(
P¨£
 *
pP¨£
, 
Tokí
 *
p
){

105985 
Tokí
 *
pArg
 = &
pP¨£
->
sArg
;

105986 if–
pArg
->
z
==0 ){

105987 
pArg
->
z
 = 
p
->z;

105988 
pArg
->
n
 = 
p
->n;

105990 
	`as£π
(
pArg
->
z
 < 
p
->z);

105991 
pArg
->
n
 = ()(&
p
->
z
[p->n] -ÖArg->z);

106000 
	`vèbCÆlC⁄°ru˘‹
(

106001 
sqlôe3
 *
db
,

106002 
TabÀ
 *
pTab
,

106003 
ModuÀ
 *
pMod
,

106004 (*
xC⁄°ru˘
)(
sqlôe3
*,*,,c⁄° *c⁄°*,
sqlôe3_vèb
**,**),

106005 **
pzEº


106007 
VèbCtx
 
sCtx
, *
pPri‹Ctx
;

106008 
VTabÀ
 *
pVTabÀ
;

106009 
rc
;

106010 c⁄° *c⁄°*
azArg
 = (c⁄° *c⁄°*)
pTab
->
azModuÀArg
;

106011 
nArg
 = 
pTab
->
nModuÀArg
;

106012 *
zEº
 = 0;

106013 *
zModuÀName
 = 
	`sqlôe3MPrötf
(
db
, "%s", 
pTab
->
zName
);

106014 
iDb
;

106016 if–!
zModuÀName
 ){

106017  
SQLITE_NOMEM
;

106020 
pVTabÀ
 = 
	`sqlôe3DbMÆlocZîo
(
db
, (
VTabÀ
));

106021 if–!
pVTabÀ
 ){

106022 
	`sqlôe3DbFªe
(
db
, 
zModuÀName
);

106023  
SQLITE_NOMEM
;

106025 
pVTabÀ
->
db
 = db;

106026 
pVTabÀ
->
pMod
 =ÖMod;

106028 
iDb
 = 
	`sqlôe3SchemaToIndex
(
db
, 
pTab
->
pSchema
);

106029 
pTab
->
azModuÀArg
[1] = 
db
->
aDb
[
iDb
].
zName
;

106032 
	`as£π
–&
db
->
pVèbCtx
 );

106033 
	`as£π
–
xC⁄°ru˘
 );

106034 
sCtx
.
pTab
 =ÖTab;

106035 
sCtx
.
pVTabÀ
 =ÖVTable;

106036 
pPri‹Ctx
 = 
db
->
pVèbCtx
;

106037 
db
->
pVèbCtx
 = &
sCtx
;

106038 
rc
 = 
	`xC⁄°ru˘
(
db
, 
pMod
->
pAux
, 
nArg
, 
azArg
, &
pVTabÀ
->
pVèb
, &
zEº
);

106039 
db
->
pVèbCtx
 = 
pPri‹Ctx
;

106040 if–
rc
==
SQLITE_NOMEM
 ) 
db
->
mÆlocFaûed
 = 1;

106042 if–
SQLITE_OK
!=
rc
 ){

106043 if–
zEº
==0 ){

106044 *
pzEº
 = 
	`sqlôe3MPrötf
(
db
, "vèbÀ c⁄°ru˘‹ faûed: %s", 
zModuÀName
);

106046 *
pzEº
 = 
	`sqlôe3MPrötf
(
db
, "%s", 
zEº
);

106047 
	`sqlôe3_‰ì
(
zEº
);

106049 
	`sqlôe3DbFªe
(
db
, 
pVTabÀ
);

106050 }if–
	`ALWAYS
(
pVTabÀ
->
pVèb
) ){

106053 
pVTabÀ
->
pVèb
->
pModuÀ
 = 
pMod
->pModule;

106054 
pVTabÀ
->
nRef
 = 1;

106055 if–
sCtx
.
pTab
 ){

106056 c⁄° *
zF‹m©
 = "vtable constructor didÇot declare schema: %s";

106057 *
pzEº
 = 
	`sqlôe3MPrötf
(
db
, 
zF‹m©
, 
pTab
->
zName
);

106058 
	`sqlôe3VèbU∆ock
(
pVTabÀ
);

106059 
rc
 = 
SQLITE_ERROR
;

106061 
iCﬁ
;

106067 
pVTabÀ
->
pNext
 = 
pTab
->pVTable;

106068 
pTab
->
pVTabÀ
 =ÖVTable;

106070 
iCﬁ
=0; iCﬁ<
pTab
->
nCﬁ
; iCol++){

106071 *
zTy≥
 = 
pTab
->
aCﬁ
[
iCﬁ
].zType;

106072 
nTy≥
;

106073 
i
 = 0;

106074 if–!
zTy≥
 ) ;

106075 
nTy≥
 = 
	`sqlôe3SåÀn30
(
zTy≥
);

106076 if–
	`sqlôe3SåNICmp
("hiddí", 
zTy≥
, 6)||(zType[6] && zType[6]!=' ') ){

106077 
i
=0; i<
nTy≥
; i++){

106078 if–(0==
	`sqlôe3SåNICmp
(" hiddí", &
zTy≥
[
i
], 7))

106079 && (
zTy≥
[
i
+7]=='\0' || zType[i+7]==' ')

106081 
i
++;

106086 if–
i
<
nTy≥
 ){

106087 
j
;

106088 
nDñ
 = 6 + (
zTy≥
[
i
+6] ? 1 : 0);

106089 
j
=
i
; (j+
nDñ
)<=
nTy≥
; j++){

106090 
zTy≥
[
j
] = zTy≥[j+
nDñ
];

106092 if–
zTy≥
[
i
]=='\0' && i>0 ){

106093 
	`as£π
(
zTy≥
[
i
-1]==' ');

106094 
zTy≥
[
i
-1] = '\0';

106096 
pTab
->
aCﬁ
[
iCﬁ
].
cﬁFœgs
 |
COLFLAG_HIDDEN
;

106102 
	`sqlôe3DbFªe
(
db
, 
zModuÀName
);

106103  
rc
;

106113 
SQLITE_PRIVATE
 
	`sqlôe3VèbCÆlC⁄√˘
(
P¨£
 *
pP¨£
, 
TabÀ
 *
pTab
){

106114 
sqlôe3
 *
db
 = 
pP¨£
->db;

106115 c⁄° *
zMod
;

106116 
ModuÀ
 *
pMod
;

106117 
rc
;

106119 
	`as£π
–
pTab
 );

106120 if–(
pTab
->
èbFœgs
 & 
TF_VútuÆ
)==0 || 
	`sqlôe3GëVTabÀ
(
db
,ÖTab) ){

106121  
SQLITE_OK
;

106125 
zMod
 = 
pTab
->
azModuÀArg
[0];

106126 
pMod
 = (
ModuÀ
*)
	`sqlôe3HashFöd
(&
db
->
aModuÀ
, 
zMod
, 
	`sqlôe3SåÀn30
(zMod));

106128 if–!
pMod
 ){

106129 c⁄° *
zModuÀ
 = 
pTab
->
azModuÀArg
[0];

106130 
	`sqlôe3Eº‹Msg
(
pP¨£
, "nÿsuch moduÀ: %s", 
zModuÀ
);

106131 
rc
 = 
SQLITE_ERROR
;

106133 *
zEº
 = 0;

106134 
rc
 = 
	`vèbCÆlC⁄°ru˘‹
(
db
, 
pTab
, 
pMod
,ÖMod->
pModuÀ
->
xC⁄√˘
, &
zEº
);

106135 if–
rc
!=
SQLITE_OK
 ){

106136 
	`sqlôe3Eº‹Msg
(
pP¨£
, "%s", 
zEº
);

106138 
	`sqlôe3DbFªe
(
db
, 
zEº
);

106141  
rc
;

106147 
	`growVTøns
(
sqlôe3
 *
db
){

106148 c⁄° 
ARRAY_INCR
 = 5;

106151 if–(
db
->
nVTøns
%
ARRAY_INCR
)==0 ){

106152 
VTabÀ
 **
aVTøns
;

106153 
nByãs
 = (
sqlôe3_vèb
 *Ë* (
db
->
nVTøns
 + 
ARRAY_INCR
);

106154 
aVTøns
 = 
	`sqlôe3DbRóŒoc
(
db
, (*)db->aVTøns, 
nByãs
);

106155 if–!
aVTøns
 ){

106156  
SQLITE_NOMEM
;

106158 
	`mem£t
(&
aVTøns
[
db
->
nVTøns
], 0, (
sqlôe3_vèb
 *)*
ARRAY_INCR
);

106159 
db
->
aVTøns
 =áVTrans;

106162  
SQLITE_OK
;

106169 
	`addToVTøns
(
sqlôe3
 *
db
, 
VTabÀ
 *
pVTab
){

106171 
db
->
aVTøns
[db->
nVTøns
++] = 
pVTab
;

106172 
	`sqlôe3VèbLock
(
pVTab
);

106183 
SQLITE_PRIVATE
 
	`sqlôe3VèbCÆlCª©e
(
sqlôe3
 *
db
, 
iDb
, c⁄° *
zTab
, **
pzEº
){

106184 
rc
 = 
SQLITE_OK
;

106185 
TabÀ
 *
pTab
;

106186 
ModuÀ
 *
pMod
;

106187 c⁄° *
zMod
;

106189 
pTab
 = 
	`sqlôe3FödTabÀ
(
db
, 
zTab
, db->
aDb
[
iDb
].
zName
);

106190 
	`as£π
–
pTab
 && (pTab->
èbFœgs
 & 
TF_VútuÆ
)!=0 && !pTab->
pVTabÀ
 );

106193 
zMod
 = 
pTab
->
azModuÀArg
[0];

106194 
pMod
 = (
ModuÀ
*)
	`sqlôe3HashFöd
(&
db
->
aModuÀ
, 
zMod
, 
	`sqlôe3SåÀn30
(zMod));

106200 if–!
pMod
 ){

106201 *
pzEº
 = 
	`sqlôe3MPrötf
(
db
, "nÿsuch moduÀ: %s", 
zMod
);

106202 
rc
 = 
SQLITE_ERROR
;

106204 
rc
 = 
	`vèbCÆlC⁄°ru˘‹
(
db
, 
pTab
, 
pMod
,ÖMod->
pModuÀ
->
xCª©e
, 
pzEº
);

106209 if–
rc
==
SQLITE_OK
 && 
	`ALWAYS
(
	`sqlôe3GëVTabÀ
(
db
, 
pTab
)) ){

106210 
rc
 = 
	`growVTøns
(
db
);

106211 if–
rc
==
SQLITE_OK
 ){

106212 
	`addToVTøns
(
db
, 
	`sqlôe3GëVTabÀ
(db, 
pTab
));

106216  
rc
;

106224 
SQLITE_API
 
	`sqlôe3_de˛¨e_vèb
(
sqlôe3
 *
db
, c⁄° *
zCª©eTabÀ
){

106225 
P¨£
 *
pP¨£
;

106227 
rc
 = 
SQLITE_OK
;

106228 
TabÀ
 *
pTab
;

106229 *
zEº
 = 0;

106231 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

106232 if–!
db
->
pVèbCtx
 || !(
pTab
 = db->pVtabCtx->pTab) ){

106233 
	`sqlôe3Eº‹
(
db
, 
SQLITE_MISUSE
, 0);

106234 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

106235  
SQLITE_MISUSE_BKPT
;

106237 
	`as£π
–(
pTab
->
èbFœgs
 & 
TF_VútuÆ
)!=0 );

106239 
pP¨£
 = 
	`sqlôe3SèckAŒocZîo
(
db
, (*pParse));

106240 if–
pP¨£
==0 ){

106241 
rc
 = 
SQLITE_NOMEM
;

106243 
pP¨£
->
de˛¨eVèb
 = 1;

106244 
pP¨£
->
db
 = db;

106245 
pP¨£
->
nQuîyLo›
 = 1;

106247 if–
SQLITE_OK
==
	`sqlôe3RunP¨£r
(
pP¨£
, 
zCª©eTabÀ
, &
zEº
)

106248 && 
pP¨£
->
pNewTabÀ


106249 && !
db
->
mÆlocFaûed


106250 && !
pP¨£
->
pNewTabÀ
->
pSñe˘


106251 && (
pP¨£
->
pNewTabÀ
->
èbFœgs
 & 
TF_VútuÆ
)==0

106253 if–!
pTab
->
aCﬁ
 ){

106254 
pTab
->
aCﬁ
 = 
pP¨£
->
pNewTabÀ
->aCol;

106255 
pTab
->
nCﬁ
 = 
pP¨£
->
pNewTabÀ
->nCol;

106256 
pP¨£
->
pNewTabÀ
->
nCﬁ
 = 0;

106257 
pP¨£
->
pNewTabÀ
->
aCﬁ
 = 0;

106259 
db
->
pVèbCtx
->
pTab
 = 0;

106261 
	`sqlôe3Eº‹
(
db
, 
SQLITE_ERROR
, (
zEº
 ? "%s" : 0), zErr);

106262 
	`sqlôe3DbFªe
(
db
, 
zEº
);

106263 
rc
 = 
SQLITE_ERROR
;

106265 
pP¨£
->
de˛¨eVèb
 = 0;

106267 if–
pP¨£
->
pVdbe
 ){

106268 
	`sqlôe3VdbeFöÆize
(
pP¨£
->
pVdbe
);

106270 
	`sqlôe3DñëeTabÀ
(
db
, 
pP¨£
->
pNewTabÀ
);

106271 
	`sqlôe3SèckFªe
(
db
, 
pP¨£
);

106274 
	`as£π
–(
rc
&0xff)==rc );

106275 
rc
 = 
	`sqlôe3ApiExô
(
db
,Ñc);

106276 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

106277  
rc
;

106287 
SQLITE_PRIVATE
 
	`sqlôe3VèbCÆlDe°roy
(
sqlôe3
 *
db
, 
iDb
, c⁄° *
zTab
){

106288 
rc
 = 
SQLITE_OK
;

106289 
TabÀ
 *
pTab
;

106291 
pTab
 = 
	`sqlôe3FödTabÀ
(
db
, 
zTab
, db->
aDb
[
iDb
].
zName
);

106292 if–
	`ALWAYS
(
pTab
!=0 &&ÖTab->
pVTabÀ
!=0) ){

106293 
VTabÀ
 *
p
 = 
	`vèbDisc⁄√˘AŒ
(
db
, 
pTab
);

106295 
	`as£π
–
rc
==
SQLITE_OK
 );

106296 
rc
 = 
p
->
pMod
->
pModuÀ
->
	`xDe°roy
’->
pVèb
);

106299 if–
rc
==
SQLITE_OK
 ){

106300 
	`as£π
–
pTab
->
pVTabÀ
==
p
 &&Ö->
pNext
==0 );

106301 
p
->
pVèb
 = 0;

106302 
pTab
->
pVTabÀ
 = 0;

106303 
	`sqlôe3VèbU∆ock
(
p
);

106307  
rc
;

106318 
	`ˇŒFöÆi£r
(
sqlôe3
 *
db
, 
off£t
){

106319 
i
;

106320 if–
db
->
aVTøns
 ){

106321 
i
=0; i<
db
->
nVTøns
; i++){

106322 
VTabÀ
 *
pVTab
 = 
db
->
aVTøns
[
i
];

106323 
sqlôe3_vèb
 *
p
 = 
pVTab
->
pVèb
;

106324 if–
p
 ){

106325 (*
x
)(
sqlôe3_vèb
 *);

106326 
x
 = *((**)(
sqlôe3_vèb
 *))((*)
p
->
pModuÀ
 + 
off£t
);

106327 if–
x
 ) 
	`x
(
p
);

106329 
pVTab
->
iSavïoöt
 = 0;

106330 
	`sqlôe3VèbU∆ock
(
pVTab
);

106332 
	`sqlôe3DbFªe
(
db
, db->
aVTøns
);

106333 
db
->
nVTøns
 = 0;

106334 
db
->
aVTøns
 = 0;

106345 
SQLITE_PRIVATE
 
	`sqlôe3VèbSync
(
sqlôe3
 *
db
, 
Vdbe
 *
p
){

106346 
i
;

106347 
rc
 = 
SQLITE_OK
;

106348 
VTabÀ
 **
aVTøns
 = 
db
->aVTrans;

106350 
db
->
aVTøns
 = 0;

106351 
i
=0; 
rc
==
SQLITE_OK
 && i<
db
->
nVTøns
; i++){

106352 (*
x
)(
sqlôe3_vèb
 *);

106353 
sqlôe3_vèb
 *
pVèb
 = 
aVTøns
[
i
]->pVtab;

106354 if–
pVèb
 && (
x
 =ÖVèb->
pModuÀ
->
xSync
)!=0 ){

106355 
rc
 = 
	`x
(
pVèb
);

106356 
	`sqlôe3VèbImp‹tEºmsg
(
p
, 
pVèb
);

106359 
db
->
aVTøns
 =áVTrans;

106360  
rc
;

106367 
SQLITE_PRIVATE
 
	`sqlôe3VèbRﬁlback
(
sqlôe3
 *
db
){

106368 
	`ˇŒFöÆi£r
(
db
, 
	`off£tof
(
sqlôe3_moduÀ
,
xRﬁlback
));

106369  
SQLITE_OK
;

106376 
SQLITE_PRIVATE
 
	`sqlôe3VèbCommô
(
sqlôe3
 *
db
){

106377 
	`ˇŒFöÆi£r
(
db
, 
	`off£tof
(
sqlôe3_moduÀ
,
xCommô
));

106378  
SQLITE_OK
;

106389 
SQLITE_PRIVATE
 
	`sqlôe3VèbBegö
(
sqlôe3
 *
db
, 
VTabÀ
 *
pVTab
){

106390 
rc
 = 
SQLITE_OK
;

106391 c⁄° 
sqlôe3_moduÀ
 *
pModuÀ
;

106398 if–
	`sqlôe3VèbInSync
(
db
) ){

106399  
SQLITE_LOCKED
;

106401 if–!
pVTab
 ){

106402  
SQLITE_OK
;

106404 
pModuÀ
 = 
pVTab
->
pVèb
->pModule;

106406 if–
pModuÀ
->
xBegö
 ){

106407 
i
;

106410 
i
=0; i<
db
->
nVTøns
; i++){

106411 if–
db
->
aVTøns
[
i
]==
pVTab
 ){

106412  
SQLITE_OK
;

106418 
rc
 = 
	`growVTøns
(
db
);

106419 if–
rc
==
SQLITE_OK
 ){

106420 
rc
 = 
pModuÀ
->
	`xBegö
(
pVTab
->
pVèb
);

106421 if–
rc
==
SQLITE_OK
 ){

106422 
	`addToVTøns
(
db
, 
pVTab
);

106426  
rc
;

106444 
SQLITE_PRIVATE
 
	`sqlôe3VèbSavïoöt
(
sqlôe3
 *
db
, 
›
, 
iSavïoöt
){

106445 
rc
 = 
SQLITE_OK
;

106447 
	`as£π
–
›
==
SAVEPOINT_RELEASE
||›==
SAVEPOINT_ROLLBACK
||›==
SAVEPOINT_BEGIN
 );

106448 
	`as£π
–
iSavïoöt
>=0 );

106449 if–
db
->
aVTøns
 ){

106450 
i
;

106451 
i
=0; 
rc
==
SQLITE_OK
 && i<
db
->
nVTøns
; i++){

106452 
VTabÀ
 *
pVTab
 = 
db
->
aVTøns
[
i
];

106453 c⁄° 
sqlôe3_moduÀ
 *
pMod
 = 
pVTab
->pMod->
pModuÀ
;

106454 if–
pVTab
->
pVèb
 && 
pMod
->
iVîsi⁄
>=2 ){

106455 (*
xMëhod
)(
sqlôe3_vèb
 *, );

106456  
›
 ){

106457 
SAVEPOINT_BEGIN
:

106458 
xMëhod
 = 
pMod
->
xSavïoöt
;

106459 
pVTab
->
iSavïoöt
 = iSavepoint+1;

106461 
SAVEPOINT_ROLLBACK
:

106462 
xMëhod
 = 
pMod
->
xRﬁlbackTo
;

106465 
xMëhod
 = 
pMod
->
xRñó£
;

106468 if–
xMëhod
 && 
pVTab
->
iSavïoöt
>iSavepoint ){

106469 
rc
 = 
	`xMëhod
(
pVTab
->
pVèb
, 
iSavïoöt
);

106474  
rc
;

106490 
SQLITE_PRIVATE
 
FuncDef
 *
	`sqlôe3VèbOvîlﬂdFun˘i⁄
(

106491 
sqlôe3
 *
db
,

106492 
FuncDef
 *
pDef
,

106493 
nArg
,

106494 
Ex¥
 *
pEx¥


106496 
TabÀ
 *
pTab
;

106497 
sqlôe3_vèb
 *
pVèb
;

106498 
sqlôe3_moduÀ
 *
pMod
;

106499 (*
xFunc
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
**) = 0;

106500 *
pArg
 = 0;

106501 
FuncDef
 *
pNew
;

106502 
rc
 = 0;

106503 *
zLowîName
;

106504 *
z
;

106508 if–
	`NEVER
(
pEx¥
==0ËË 
pDef
;

106509 if–
pEx¥
->
›
!=
TK_COLUMN
 )  
pDef
;

106510 
pTab
 = 
pEx¥
->pTab;

106511 if–
	`NEVER
(
pTab
==0ËË 
pDef
;

106512 if–(
pTab
->
èbFœgs
 & 
TF_VútuÆ
)==0 )  
pDef
;

106513 
pVèb
 = 
	`sqlôe3GëVTabÀ
(
db
, 
pTab
)->pVtab;

106514 
	`as£π
–
pVèb
!=0 );

106515 
	`as£π
–
pVèb
->
pModuÀ
!=0 );

106516 
pMod
 = (
sqlôe3_moduÀ
 *)
pVèb
->
pModuÀ
;

106517 if–
pMod
->
xFödFun˘i⁄
==0 )  
pDef
;

106522 
zLowîName
 = 
	`sqlôe3DbSåDup
(
db
, 
pDef
->
zName
);

106523 if–
zLowîName
 ){

106524 
z
=(*)
zLowîName
; *z; z++){

106525 *
z
 = 
sqlôe3UµîToLowî
[*z];

106527 
rc
 = 
pMod
->
	`xFödFun˘i⁄
(
pVèb
, 
nArg
, 
zLowîName
, &
xFunc
, &
pArg
);

106528 
	`sqlôe3DbFªe
(
db
, 
zLowîName
);

106530 if–
rc
==0 ){

106531  
pDef
;

106536 
pNew
 = 
	`sqlôe3DbMÆlocZîo
(
db
, (*pNew)

106537 + 
	`sqlôe3SåÀn30
(
pDef
->
zName
) + 1);

106538 if–
pNew
==0 ){

106539  
pDef
;

106541 *
pNew
 = *
pDef
;

106542 
pNew
->
zName
 = (*)&pNew[1];

106543 
	`mem˝y
(
pNew
->
zName
, 
pDef
->zName, 
	`sqlôe3SåÀn30
(pDef->zName)+1);

106544 
pNew
->
xFunc
 = xFunc;

106545 
pNew
->
pU£rD©a
 = 
pArg
;

106546 
pNew
->
funcFœgs
 |
SQLITE_FUNC_EPHEM
;

106547  
pNew
;

106556 
SQLITE_PRIVATE
 
	`sqlôe3VèbMakeWrôabÀ
(
P¨£
 *
pP¨£
, 
TabÀ
 *
pTab
){

106557 
P¨£
 *
pT›Àvñ
 = 
	`sqlôe3P¨£T›Àvñ
(
pP¨£
);

106558 
i
, 
n
;

106559 
TabÀ
 **
≠VèbLock
;

106561 
	`as£π
–
	`IsVútuÆ
(
pTab
) );

106562 
i
=0; i<
pT›Àvñ
->
nVèbLock
; i++){

106563 if–
pTab
==
pT›Àvñ
->
≠VèbLock
[
i
] ) ;

106565 
n
 = (
pT›Àvñ
->
nVèbLock
+1)*’T›Àvñ->
≠VèbLock
[0]);

106566 
≠VèbLock
 = 
	`sqlôe3_ªÆloc
(
pT›Àvñ
->≠VèbLock, 
n
);

106567 if–
≠VèbLock
 ){

106568 
pT›Àvñ
->
≠VèbLock
 =ápVtabLock;

106569 
pT›Àvñ
->
≠VèbLock
[pT›Àvñ->
nVèbLock
++] = 
pTab
;

106571 
pT›Àvñ
->
db
->
mÆlocFaûed
 = 1;

106582 
SQLITE_API
 
	`sqlôe3_vèb_⁄_c⁄Êi˘
(
sqlôe3
 *
db
){

106583 c⁄° 
aM≠
[] = {

106584 
SQLITE_ROLLBACK
, 
SQLITE_ABORT
, 
SQLITE_FAIL
, 
SQLITE_IGNORE
, 
SQLITE_REPLACE


106586 
	`as£π
–
OE_Rﬁlback
==1 && 
OE_Ab‹t
==2 && 
OE_Faû
==3 );

106587 
	`as£π
–
OE_Ign‹e
==4 && 
OE_Rïœ˚
==5 );

106588 
	`as£π
–
db
->
vèbOnC⁄Êi˘
>=1 && db->vtabOnConflict<=5 );

106589  ()
aM≠
[
db
->
vèbOnC⁄Êi˘
-1];

106597 
SQLITE_API
 
	`sqlôe3_vèb_c⁄fig
(
sqlôe3
 *
db
, 
›
, ...){

106598 
va_li°
 
≠
;

106599 
rc
 = 
SQLITE_OK
;

106601 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

106603 
	`va_°¨t
(
≠
, 
›
);

106604  
›
 ){

106605 
SQLITE_VTAB_CONSTRAINT_SUPPORT
: {

106606 
VèbCtx
 *
p
 = 
db
->
pVèbCtx
;

106607 if–!
p
 ){

106608 
rc
 = 
SQLITE_MISUSE_BKPT
;

106610 
	`as£π
–
p
->
pTab
==0 || (p->pTab->
èbFœgs
 & 
TF_VútuÆ
)!=0 );

106611 
p
->
pVTabÀ
->
bC⁄°øöt
 = (
u8
)
	`va_¨g
(
≠
, );

106616 
rc
 = 
SQLITE_MISUSE_BKPT
;

106619 
	`va_íd
(
≠
);

106621 if–
rc
!=
SQLITE_OK
 ) 
	`sqlôe3Eº‹
(
db
,Ñc, 0);

106622 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

106623  
rc
;

106653 #i‡
	`deföed
(
SQLITE_TEST
Ë|| deföed(
SQLITE_DEBUG
)

106654  
sqlôe3WhîeTø˚
 = 0;

106656 #i‡
	`deföed
(
SQLITE_DEBUG
) \

106657 && (
	`deföed
(
SQLITE_TEST
Ë|| deföed(
SQLITE_ENABLE_WHERETRACE
))

106658 
	#WHERETRACE
(
K
,
X
Ëif(
sqlôe3WhîeTø˚
&(K)Ë
sqlôe3DebugPrötf
 
	)
X

106659 
	#WHERETRACE_ENABLED
 1

	)

106661 
	#WHERETRACE
(
K
,
X
)

	)

106666 
WhîeCœu£
 
	tWhîeCœu£
;

106667 
WhîeMaskSë
 
	tWhîeMaskSë
;

106668 
WhîeOrInfo
 
	tWhîeOrInfo
;

106669 
WhîeAndInfo
 
	tWhîeAndInfo
;

106670 
WhîeLevñ
 
	tWhîeLevñ
;

106671 
WhîeLo›
 
	tWhîeLo›
;

106672 
WhîeP©h
 
	tWhîeP©h
;

106673 
WhîeTîm
 
	tWhîeTîm
;

106674 
WhîeLo›Buûdî
 
	tWhîeLo›Buûdî
;

106675 
WhîeSˇn
 
	tWhîeSˇn
;

106676 
WhîeOrCo°
 
	tWhîeOrCo°
;

106677 
WhîeOrSë
 
	tWhîeOrSë
;

106694 
	sWhîeLevñ
 {

106695 
iLe·Joö
;

106696 
iTabCur
;

106697 
iIdxCur
;

106698 
addrBrk
;

106699 
addrNxt
;

106700 
addrC⁄t
;

106701 
addrFú°
;

106702 
addrBody
;

106703 
u8
 
iFrom
;

106704 
u8
 
›
, 
p5
;

106705 
p1
, 
p2
;

106708 
nIn
;

106709 
	sInLo›
 {

106710 
iCur
;

106711 
addrInT›
;

106712 
u8
 
eEndLo›Op
;

106713 } *
aInLo›
;

106714 } 
ö
;

106715 
Index
 *
pCovidx
;

106716 } 
u
;

106717 
WhîeLo›
 *
pWLo›
;

106718 
Bômask
 
nŸRódy
;

106735 
	sWhîeLo›
 {

106736 
Bômask
 
¥îeq
;

106737 
Bômask
 
maskSñf
;

106738 #ifde‡
SQLITE_DEBUG


106739 
cId
;

106741 
u8
 
iTab
;

106742 
u8
 
iS‹tIdx
;

106743 
LogE°
 
rSëup
;

106744 
LogE°
 
rRun
;

106745 
LogE°
 
nOut
;

106748 
nEq
;

106749 
Index
 *
pIndex
;

106750 } 
båì
;

106752 
idxNum
;

106753 
u8
 
√edFªe
;

106754 
u8
 
isOrdîed
;

106755 
u16
 
omôMask
;

106756 *
idxSå
;

106757 } 
vèb
;

106758 } 
u
;

106759 
u32
 
wsFœgs
;

106760 
u16
 
nLTîm
;

106762 
	#WHERE_LOOP_XFER_SZ
 
	`off£tof
(
WhîeLo›
,
nLSlŸ
)

	)

106763 
u16
 
nLSlŸ
;

106764 
WhîeTîm
 **
aLTîm
;

106765 
WhîeLo›
 *
pNextLo›
;

106766 
WhîeTîm
 *
aLTîmS∑˚
[4];

106773 
	sWhîeOrCo°
 {

106774 
Bômask
 
¥îeq
;

106775 
LogE°
 
rRun
;

106776 
LogE°
 
nOut
;

106783 
	#N_OR_COST
 3

	)

106784 
	sWhîeOrSë
 {

106785 
u16
 
n
;

106786 
WhîeOrCo°
 
a
[
N_OR_COST
];

106791 
	`whîeLo›Resize
(
sqlôe3
*, 
WhîeLo›
*, );

106811 
	sWhîeP©h
 {

106812 
Bômask
 
maskLo›
;

106813 
Bômask
 
ªvLo›
;

106814 
LogE°
 
nRow
;

106815 
LogE°
 
rCo°
;

106816 
u8
 
isOrdîed
;

106817 
u8
 
isOrdîedVÆid
;

106818 
WhîeLo›
 **
aLo›
;

106872 
	sWhîeTîm
 {

106873 
Ex¥
 *
pEx¥
;

106874 
iP¨ít
;

106875 
À·Curs‹
;

106877 
À·Cﬁumn
;

106878 
WhîeOrInfo
 *
pOrInfo
;

106879 
WhîeAndInfo
 *
pAndInfo
;

106880 } 
u
;

106881 
LogE°
 
åuthProb
;

106882 
u16
 
eO≥øt‹
;

106883 
u8
 
wtFœgs
;

106884 
u8
 
nChûd
;

106885 
WhîeCœu£
 *
pWC
;

106886 
Bômask
 
¥îeqRight
;

106887 
Bômask
 
¥îeqAŒ
;

106893 
	#TERM_DYNAMIC
 0x01

	)

106894 
	#TERM_VIRTUAL
 0x02

	)

106895 
	#TERM_CODED
 0x04

	)

106896 
	#TERM_COPIED
 0x08

	)

106897 
	#TERM_ORINFO
 0x10

	)

106898 
	#TERM_ANDINFO
 0x20

	)

106899 
	#TERM_OR_OK
 0x40

	)

106900 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


106901 
	#TERM_VNULL
 0x80

	)

106903 
	#TERM_VNULL
 0x00

	)

106910 
	sWhîeSˇn
 {

106911 
WhîeCœu£
 *
pOrigWC
;

106912 
WhîeCœu£
 *
pWC
;

106913 *
zCﬁlName
;

106914 
idxaff
;

106915 
nEquiv
;

106916 
iEquiv
;

106917 
u32
 
›Mask
;

106918 
k
;

106919 
aEquiv
[22];

106934 
	sWhîeCœu£
 {

106935 
WhîeInfo
 *
pWInfo
;

106936 
WhîeCœu£
 *
pOuãr
;

106937 
u8
 
›
;

106938 
nTîm
;

106939 
nSlŸ
;

106940 
WhîeTîm
 *
a
;

106941 #i‡
	`deföed
(
SQLITE_SMALL_STACK
)

106942 
WhîeTîm
 
aSètic
[1];

106944 
WhîeTîm
 
aSètic
[8];

106952 
	sWhîeOrInfo
 {

106953 
WhîeCœu£
 
wc
;

106954 
Bômask
 
ödexabÀ
;

106961 
	sWhîeAndInfo
 {

106962 
WhîeCœu£
 
wc
;

106991 
	sWhîeMaskSë
 {

106992 
n
;

106993 
ix
[
BMS
];

107000 
	sWhîeLo›Buûdî
 {

107001 
WhîeInfo
 *
pWInfo
;

107002 
WhîeCœu£
 *
pWC
;

107003 
Ex¥Li°
 *
pOrdîBy
;

107004 
WhîeLo›
 *
pNew
;

107005 
WhîeOrSë
 *
pOrSë
;

107006 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


107007 
U≈ackedRec‹d
 *
pRec
;

107008 
nRecVÆid
;

107022 
	sWhîeInfo
 {

107023 
P¨£
 *
pP¨£
;

107024 
SrcLi°
 *
pTabLi°
;

107025 
Ex¥Li°
 *
pOrdîBy
;

107026 
Ex¥Li°
 *
pResu…Së
;

107027 
WhîeLo›
 *
pLo›s
;

107028 
Bômask
 
ªvMask
;

107029 
LogE°
 
nRowOut
;

107030 
u16
 
w˘æFœgs
;

107031 
u8
 
bOBS©
;

107032 
u8
 
okO√Pass
;

107033 
u8
 
u¡e°edTîms
;

107034 
u8
 
eDi°ö˘
;

107035 
u8
 
nLevñ
;

107036 
iT›
;

107037 
iC⁄töue
;

107038 
iBªak
;

107039 
ßvedNQuîyLo›
;

107040 
WhîeMaskSë
 
sMaskSë
;

107041 
WhîeCœu£
 
sWC
;

107042 
WhîeLevñ
 
a
[1];

107051 
	#WO_IN
 0x001

	)

107052 
	#WO_EQ
 0x002

	)

107053 
	#WO_LT
 (
WO_EQ
<<(
TK_LT
-
TK_EQ
))

	)

107054 
	#WO_LE
 (
WO_EQ
<<(
TK_LE
-
TK_EQ
))

	)

107055 
	#WO_GT
 (
WO_EQ
<<(
TK_GT
-
TK_EQ
))

	)

107056 
	#WO_GE
 (
WO_EQ
<<(
TK_GE
-
TK_EQ
))

	)

107057 
	#WO_MATCH
 0x040

	)

107058 
	#WO_ISNULL
 0x080

	)

107059 
	#WO_OR
 0x100

	)

107060 
	#WO_AND
 0x200

	)

107061 
	#WO_EQUIV
 0x400

	)

107062 
	#WO_NOOP
 0x800

	)

107064 
	#WO_ALL
 0xff‡

	)

107065 
	#WO_SINGLE
 0x0f‡

	)

107072 
	#WHERE_COLUMN_EQ
 0x00000001

	)

107073 
	#WHERE_COLUMN_RANGE
 0x00000002

	)

107074 
	#WHERE_COLUMN_IN
 0x00000004

	)

107075 
	#WHERE_COLUMN_NULL
 0x00000008

	)

107076 
	#WHERE_CONSTRAINT
 0x0000000‡

	)

107077 
	#WHERE_TOP_LIMIT
 0x00000010

	)

107078 
	#WHERE_BTM_LIMIT
 0x00000020

	)

107079 
	#WHERE_BOTH_LIMIT
 0x00000030

	)

107080 
	#WHERE_IDX_ONLY
 0x00000040

	)

107081 
	#WHERE_IPK
 0x00000100

	)

107082 
	#WHERE_INDEXED
 0x00000200

	)

107083 
	#WHERE_VIRTUALTABLE
 0x00000400

	)

107084 
	#WHERE_IN_ABLE
 0x00000800

	)

107085 
	#WHERE_ONEROW
 0x00001000

	)

107086 
	#WHERE_MULTI_OR
 0x00002000

	)

107087 
	#WHERE_AUTO_INDEX
 0x00004000

	)

107092 
SQLITE_PRIVATE
 
u64
 
	`sqlôe3WhîeOuçutRowCou¡
(
WhîeInfo
 *
pWInfo
){

107093  
	`sqlôe3LogE°ToI¡
(
pWInfo
->
nRowOut
);

107100 
SQLITE_PRIVATE
 
	`sqlôe3WhîeIsDi°ö˘
(
WhîeInfo
 *
pWInfo
){

107101  
pWInfo
->
eDi°ö˘
;

107108 
SQLITE_PRIVATE
 
	`sqlôe3WhîeIsOrdîed
(
WhîeInfo
 *
pWInfo
){

107109  
pWInfo
->
bOBS©
!=0;

107116 
SQLITE_PRIVATE
 
	`sqlôe3WhîeC⁄töueLabñ
(
WhîeInfo
 *
pWInfo
){

107117  
pWInfo
->
iC⁄töue
;

107124 
SQLITE_PRIVATE
 
	`sqlôe3WhîeBªakLabñ
(
WhîeInfo
 *
pWInfo
){

107125  
pWInfo
->
iBªak
;

107133 
SQLITE_PRIVATE
 
	`sqlôe3WhîeOkO√Pass
(
WhîeInfo
 *
pWInfo
){

107134  
pWInfo
->
okO√Pass
;

107140 
	`whîeOrMove
(
WhîeOrSë
 *
pDe°
, WhîeOrSë *
pSrc
){

107141 
pDe°
->
n
 = 
pSrc
->n;

107142 
	`mem˝y
(
pDe°
->
a
, 
pSrc
->a,ÖDe°->
n
*(pDest->a[0]));

107152 
	`whîeOrIn£π
(

107153 
WhîeOrSë
 *
pSë
,

107154 
Bômask
 
¥îeq
,

107155 
LogE°
 
rRun
,

107156 
LogE°
 
nOut


107158 
u16
 
i
;

107159 
WhîeOrCo°
 *
p
;

107160 
i
=
pSë
->
n
, 
p
ıSë->
a
; i>0; i--,Ö++){

107161 if–
rRun
<=
p
->rRu¿&& (
¥îeq
 &Ö->prereq)==prereq ){

107162 
whîeOrIn£π_d⁄e
;

107164 if–
p
->
rRun
<ÙRu¿&& (p->
¥îeq
 &Örereq)==p->prereq ){

107168 if–
pSë
->
n
<
N_OR_COST
 ){

107169 
p
 = &
pSë
->
a
[pSë->
n
++];

107170 
p
->
nOut
 =ÇOut;

107172 
p
 = 
pSë
->
a
;

107173 
i
=1; i<
pSë
->
n
; i++){

107174 if–
p
->
rRun
>
pSë
->
a
[
i
].rRun )Ö =ÖSet->a + i;

107176 if–
p
->
rRun
<=rRun )  0;

107178 
whîeOrIn£π_d⁄e
:

107179 
p
->
¥îeq
 =Örereq;

107180 
p
->
rRun
 =ÑRun;

107181 if–
p
->
nOut
>nOut )Ö->nOut =ÇOut;

107188 
	`whîeCœu£Inô
(

107189 
WhîeCœu£
 *
pWC
,

107190 
WhîeInfo
 *
pWInfo


107192 
pWC
->
pWInfo
 =ÖWInfo;

107193 
pWC
->
pOuãr
 = 0;

107194 
pWC
->
nTîm
 = 0;

107195 
pWC
->
nSlŸ
 = 
	`AºaySize
’WC->
aSètic
);

107196 
pWC
->
a
 =ÖWC->
aSètic
;

107200 
	`whîeCœu£CÀ¨
(
WhîeCœu£
*);

107205 
	`whîeOrInfoDñëe
(
sqlôe3
 *
db
, 
WhîeOrInfo
 *
p
){

107206 
	`whîeCœu£CÀ¨
(&
p
->
wc
);

107207 
	`sqlôe3DbFªe
(
db
, 
p
);

107213 
	`whîeAndInfoDñëe
(
sqlôe3
 *
db
, 
WhîeAndInfo
 *
p
){

107214 
	`whîeCœu£CÀ¨
(&
p
->
wc
);

107215 
	`sqlôe3DbFªe
(
db
, 
p
);

107222 
	`whîeCœu£CÀ¨
(
WhîeCœu£
 *
pWC
){

107223 
i
;

107224 
WhîeTîm
 *
a
;

107225 
sqlôe3
 *
db
 = 
pWC
->
pWInfo
->
pP¨£
->db;

107226 
i
=
pWC
->
nTîm
-1, 
a
=pWC->a; i>=0; i--,á++){

107227 if–
a
->
wtFœgs
 & 
TERM_DYNAMIC
 ){

107228 
	`sqlôe3Ex¥Dñëe
(
db
, 
a
->
pEx¥
);

107230 if–
a
->
wtFœgs
 & 
TERM_ORINFO
 ){

107231 
	`whîeOrInfoDñëe
(
db
, 
a
->
u
.
pOrInfo
);

107232 }if–
a
->
wtFœgs
 & 
TERM_ANDINFO
 ){

107233 
	`whîeAndInfoDñëe
(
db
, 
a
->
u
.
pAndInfo
);

107236 if–
pWC
->
a
!ıWC->
aSètic
 ){

107237 
	`sqlôe3DbFªe
(
db
, 
pWC
->
a
);

107260 
	`whîeCœu£In£π
(
WhîeCœu£
 *
pWC
, 
Ex¥
 *
p
, 
u8
 
wtFœgs
){

107261 
WhîeTîm
 *
pTîm
;

107262 
idx
;

107263 
	`ã°ˇ£
–
wtFœgs
 & 
TERM_VIRTUAL
 );

107264 if–
pWC
->
nTîm
>ıWC->
nSlŸ
 ){

107265 
WhîeTîm
 *
pOld
 = 
pWC
->
a
;

107266 
sqlôe3
 *
db
 = 
pWC
->
pWInfo
->
pP¨£
->db;

107267 
pWC
->
a
 = 
	`sqlôe3DbMÆlocRaw
(
db
, ’WC->a[0])*pWC->
nSlŸ
*2 );

107268 if–
pWC
->
a
==0 ){

107269 if–
wtFœgs
 & 
TERM_DYNAMIC
 ){

107270 
	`sqlôe3Ex¥Dñëe
(
db
, 
p
);

107272 
pWC
->
a
 = 
pOld
;

107275 
	`mem˝y
(
pWC
->
a
, 
pOld
, ’WC->a[0])*pWC->
nTîm
);

107276 if–
pOld
!=
pWC
->
aSètic
 ){

107277 
	`sqlôe3DbFªe
(
db
, 
pOld
);

107279 
pWC
->
nSlŸ
 = 
	`sqlôe3DbMÆlocSize
(
db
,ÖWC->
a
)/(pWC->a[0]);

107281 
pTîm
 = &
pWC
->
a
[
idx
 =ÖWC->
nTîm
++];

107282 if–
p
 && 
	`Ex¥HasPr›îty
’, 
EP_U∆ikñy
) ){

107283 
pTîm
->
åuthProb
 = 
	`sqlôe3LogE°
(
p
->
iTabÀ
) - 99;

107285 
pTîm
->
åuthProb
 = -1;

107287 
pTîm
->
pEx¥
 = 
	`sqlôe3Ex¥SkùCﬁœã
(
p
);

107288 
pTîm
->
wtFœgs
 = wtFlags;

107289 
pTîm
->
pWC
 =ÖWC;

107290 
pTîm
->
iP¨ít
 = -1;

107291  
idx
;

107311 
	`whîeS∂ô
(
WhîeCœu£
 *
pWC
, 
Ex¥
 *
pEx¥
, 
u8
 
›
){

107312 
pWC
->
›
 = op;

107313 if–
pEx¥
==0 ) ;

107314 if–
pEx¥
->
›
!=op ){

107315 
	`whîeCœu£In£π
(
pWC
, 
pEx¥
, 0);

107317 
	`whîeS∂ô
(
pWC
, 
pEx¥
->
pLe·
, 
›
);

107318 
	`whîeS∂ô
(
pWC
, 
pEx¥
->
pRight
, 
›
);

107325 
	#öôMaskSë
(
P
Ë(P)->
n
=0

	)

107331 
Bômask
 
	`gëMask
(
WhîeMaskSë
 *
pMaskSë
, 
iCurs‹
){

107332 
i
;

107333 
	`as£π
–
pMaskSë
->
n
<=()(
Bômask
)*8 );

107334 
i
=0; i<
pMaskSë
->
n
; i++){

107335 if–
pMaskSë
->
ix
[
i
]==
iCurs‹
 ){

107336  
	`MASKBIT
(
i
);

107350 
	`¸óãMask
(
WhîeMaskSë
 *
pMaskSë
, 
iCurs‹
){

107351 
	`as£π
–
pMaskSë
->
n
 < 
	`AºaySize
’MaskSë->
ix
) );

107352 
pMaskSë
->
ix
[pMaskSë->
n
++] = 
iCurs‹
;

107360 
Bômask
 
	`ex¥Li°TabÀUßge
(
WhîeMaskSë
*, 
Ex¥Li°
*);

107361 
Bômask
 
	`ex¥Sñe˘TabÀUßge
(
WhîeMaskSë
*, 
Sñe˘
*);

107362 
Bômask
 
	`ex¥TabÀUßge
(
WhîeMaskSë
 *
pMaskSë
, 
Ex¥
 *
p
){

107363 
Bômask
 
mask
 = 0;

107364 if–
p
==0 )  0;

107365 if–
p
->
›
==
TK_COLUMN
 ){

107366 
mask
 = 
	`gëMask
(
pMaskSë
, 
p
->
iTabÀ
);

107367  
mask
;

107369 
mask
 = 
	`ex¥TabÀUßge
(
pMaskSë
, 
p
->
pRight
);

107370 
mask
 |
	`ex¥TabÀUßge
(
pMaskSë
, 
p
->
pLe·
);

107371 if–
	`Ex¥HasPr›îty
(
p
, 
EP_xIsSñe˘
) ){

107372 
mask
 |
	`ex¥Sñe˘TabÀUßge
(
pMaskSë
, 
p
->
x
.
pSñe˘
);

107374 
mask
 |
	`ex¥Li°TabÀUßge
(
pMaskSë
, 
p
->
x
.
pLi°
);

107376  
mask
;

107378 
Bômask
 
	`ex¥Li°TabÀUßge
(
WhîeMaskSë
 *
pMaskSë
, 
Ex¥Li°
 *
pLi°
){

107379 
i
;

107380 
Bômask
 
mask
 = 0;

107381 if–
pLi°
 ){

107382 
i
=0; i<
pLi°
->
nEx¥
; i++){

107383 
mask
 |
	`ex¥TabÀUßge
(
pMaskSë
, 
pLi°
->
a
[
i
].
pEx¥
);

107386  
mask
;

107388 
Bômask
 
	`ex¥Sñe˘TabÀUßge
(
WhîeMaskSë
 *
pMaskSë
, 
Sñe˘
 *
pS
){

107389 
Bômask
 
mask
 = 0;

107390  
pS
 ){

107391 
SrcLi°
 *
pSrc
 = 
pS
->pSrc;

107392 
mask
 |
	`ex¥Li°TabÀUßge
(
pMaskSë
, 
pS
->
pELi°
);

107393 
mask
 |
	`ex¥Li°TabÀUßge
(
pMaskSë
, 
pS
->
pGroupBy
);

107394 
mask
 |
	`ex¥Li°TabÀUßge
(
pMaskSë
, 
pS
->
pOrdîBy
);

107395 
mask
 |
	`ex¥TabÀUßge
(
pMaskSë
, 
pS
->
pWhîe
);

107396 
mask
 |
	`ex¥TabÀUßge
(
pMaskSë
, 
pS
->
pHavög
);

107397 if–
	`ALWAYS
(
pSrc
!=0) ){

107398 
i
;

107399 
i
=0; i<
pSrc
->
nSrc
; i++){

107400 
mask
 |
	`ex¥Sñe˘TabÀUßge
(
pMaskSë
, 
pSrc
->
a
[
i
].
pSñe˘
);

107401 
mask
 |
	`ex¥TabÀUßge
(
pMaskSë
, 
pSrc
->
a
[
i
].
pOn
);

107404 
pS
 =ÖS->
pPri‹
;

107406  
mask
;

107414 
	`ÆlowedOp
(
›
){

107415 
	`as£π
–
TK_GT
>
TK_EQ
 && TK_GT<
TK_GE
 );

107416 
	`as£π
–
TK_LT
>
TK_EQ
 && TK_LT<
TK_GE
 );

107417 
	`as£π
–
TK_LE
>
TK_EQ
 && TK_LE<
TK_GE
 );

107418 
	`as£π
–
TK_GE
==
TK_EQ
+4 );

107419  
›
==
TK_IN
 || (›>=
TK_EQ
 && op<=
TK_GE
Ë|| op==
TK_ISNULL
;

107425 
	#SWAP
(
TYPE
,
A
,
B
Ë{TYPE 
t
=A; A=B; BÒ;}

	)

107439 
	`ex¥Commuã
(
P¨£
 *
pP¨£
, 
Ex¥
 *
pEx¥
){

107440 
u16
 
expRight
 = (
pEx¥
->
pRight
->
Êags
 & 
EP_Cﬁœã
);

107441 
u16
 
expLe·
 = (
pEx¥
->
pLe·
->
Êags
 & 
EP_Cﬁœã
);

107442 
	`as£π
–
	`ÆlowedOp
(
pEx¥
->
›
Ë&&ÖEx¥->›!=
TK_IN
 );

107443 if–
expRight
==
expLe·
 ){

107445 if–
expRight
 ){

107448 
pEx¥
->
pRight
->
Êags
 &~
EP_Cﬁœã
;

107449 }if–
	`sqlôe3Ex¥CﬁlSeq
(
pP¨£
, 
pEx¥
->
pLe·
)!=0 ){

107453 
pEx¥
->
pLe·
->
Êags
 |
EP_Cﬁœã
;

107456 
	`SWAP
(
Ex¥
*,
pEx¥
->
pRight
,pEx¥->
pLe·
);

107457 if–
pEx¥
->
›
>=
TK_GT
 ){

107458 
	`as£π
–
TK_LT
==
TK_GT
+2 );

107459 
	`as£π
–
TK_GE
==
TK_LE
+2 );

107460 
	`as£π
–
TK_GT
>
TK_EQ
 );

107461 
	`as£π
–
TK_GT
<
TK_LE
 );

107462 
	`as£π
–
pEx¥
->
›
>=
TK_GT
 &&ÖEx¥->›<=
TK_GE
 );

107463 
pEx¥
->
›
 = (’Ex¥->›-
TK_GT
)^2)+TK_GT;

107470 
u16
 
	`›î©‹Mask
(
›
){

107471 
u16
 
c
;

107472 
	`as£π
–
	`ÆlowedOp
(
›
) );

107473 if–
›
==
TK_IN
 ){

107474 
c
 = 
WO_IN
;

107475 }if–
›
==
TK_ISNULL
 ){

107476 
c
 = 
WO_ISNULL
;

107478 
	`as£π
–(
WO_EQ
<<(
›
-
TK_EQ
)) < 0x7fff );

107479 
c
 = (
u16
)(
WO_EQ
<<(
›
-
TK_EQ
));

107481 
	`as£π
–
›
!=
TK_ISNULL
 || 
c
==
WO_ISNULL
 );

107482 
	`as£π
–
›
!=
TK_IN
 || 
c
==
WO_IN
 );

107483 
	`as£π
–
›
!=
TK_EQ
 || 
c
==
WO_EQ
 );

107484 
	`as£π
–
›
!=
TK_LT
 || 
c
==
WO_LT
 );

107485 
	`as£π
–
›
!=
TK_LE
 || 
c
==
WO_LE
 );

107486 
	`as£π
–
›
!=
TK_GT
 || 
c
==
WO_GT
 );

107487 
	`as£π
–
›
!=
TK_GE
 || 
c
==
WO_GE
 );

107488  
c
;

107496 
WhîeTîm
 *
	`whîeSˇnNext
(
WhîeSˇn
 *
pSˇn
){

107497 
iCur
;

107498 
iCﬁumn
;

107499 
Ex¥
 *
pX
;

107500 
WhîeCœu£
 *
pWC
;

107501 
WhîeTîm
 *
pTîm
;

107502 
k
 = 
pSˇn
->k;

107504  
pSˇn
->
iEquiv
<ıSˇn->
nEquiv
 ){

107505 
iCur
 = 
pSˇn
->
aEquiv
[pSˇn->
iEquiv
-2];

107506 
iCﬁumn
 = 
pSˇn
->
aEquiv
[pSˇn->
iEquiv
-1];

107507  (
pWC
 = 
pSˇn
->pWC)!=0 ){

107508 
pTîm
=
pWC
->
a
+
k
; k<pWC->
nTîm
; k++,ÖTerm++){

107509 if–
pTîm
->
À·Curs‹
==
iCur
 &&ÖTîm->
u
.
À·Cﬁumn
==
iCﬁumn
 ){

107510 if–(
pTîm
->
eO≥øt‹
 & 
WO_EQUIV
)!=0

107511 && 
pSˇn
->
nEquiv
<
	`AºaySize
’Sˇn->
aEquiv
)

107513 
j
;

107514 
pX
 = 
	`sqlôe3Ex¥SkùCﬁœã
(
pTîm
->
pEx¥
->
pRight
);

107515 
	`as£π
–
pX
->
›
==
TK_COLUMN
 );

107516 
j
=0; j<
pSˇn
->
nEquiv
; j+=2){

107517 if–
pSˇn
->
aEquiv
[
j
]==
pX
->
iTabÀ


107518 && 
pSˇn
->
aEquiv
[
j
+1]==
pX
->
iCﬁumn
 ){

107522 if–
j
==
pSˇn
->
nEquiv
 ){

107523 
pSˇn
->
aEquiv
[
j
] = 
pX
->
iTabÀ
;

107524 
pSˇn
->
aEquiv
[
j
+1] = 
pX
->
iCﬁumn
;

107525 
pSˇn
->
nEquiv
 += 2;

107528 if–(
pTîm
->
eO≥øt‹
 & 
pSˇn
->
›Mask
)!=0 ){

107530 if–
pSˇn
->
zCﬁlName
 && (
pTîm
->
eO≥øt‹
 & 
WO_ISNULL
)==0 ){

107531 
CﬁlSeq
 *
pCﬁl
;

107532 
P¨£
 *
pP¨£
 = 
pWC
->
pWInfo
->pParse;

107533 
pX
 = 
pTîm
->
pEx¥
;

107534 if–!
	`sqlôe3IndexAfföôyOk
(
pX
, 
pSˇn
->
idxaff
) ){

107537 
	`as£π
(
pX
->
pLe·
);

107538 
pCﬁl
 = 
	`sqlôe3Bö¨yCom∑ªCﬁlSeq
(
pP¨£
,

107539 
pX
->
pLe·
,ÖX->
pRight
);

107540 if–
pCﬁl
==0 )ÖCﬁ»
pP¨£
->
db
->
pDÊtCﬁl
;

107541 if–
	`sqlôe3SåICmp
(
pCﬁl
->
zName
, 
pSˇn
->
zCﬁlName
) ){

107545 if–(
pTîm
->
eO≥øt‹
 & 
WO_EQ
)!=0

107546 && (
pX
 = 
pTîm
->
pEx¥
->
pRight
)->
›
==
TK_COLUMN


107547 && 
pX
->
iTabÀ
==
pSˇn
->
aEquiv
[0]

107548 && 
pX
->
iCﬁumn
==
pSˇn
->
aEquiv
[1]

107552 
pSˇn
->
k
 = k+1;

107553  
pTîm
;

107557 
pSˇn
->
pWC
 =ÖSˇn->pWC->
pOuãr
;

107558 
k
 = 0;

107560 
pSˇn
->
pWC
 =ÖSˇn->
pOrigWC
;

107561 
k
 = 0;

107562 
pSˇn
->
iEquiv
 += 2;

107583 
WhîeTîm
 *
	`whîeSˇnInô
(

107584 
WhîeSˇn
 *
pSˇn
,

107585 
WhîeCœu£
 *
pWC
,

107586 
iCur
,

107587 
iCﬁumn
,

107588 
u32
 
›Mask
,

107589 
Index
 *
pIdx


107591 
j
;

107594 
pSˇn
->
pOrigWC
 = 
pWC
;

107595 
pSˇn
->
pWC
 =ÖWC;

107596 if–
pIdx
 && 
iCﬁumn
>=0 ){

107597 
pSˇn
->
idxaff
 = 
pIdx
->
pTabÀ
->
aCﬁ
[
iCﬁumn
].
afföôy
;

107598 
j
=0; 
pIdx
->
aiCﬁumn
[j]!=
iCﬁumn
; j++){

107599 if–
	`NEVER
(
j
>=
pIdx
->
nCﬁumn
) )  0;

107601 
pSˇn
->
zCﬁlName
 = 
pIdx
->
azCﬁl
[
j
];

107603 
pSˇn
->
idxaff
 = 0;

107604 
pSˇn
->
zCﬁlName
 = 0;

107606 
pSˇn
->
›Mask
 = opMask;

107607 
pSˇn
->
k
 = 0;

107608 
pSˇn
->
aEquiv
[0] = 
iCur
;

107609 
pSˇn
->
aEquiv
[1] = 
iCﬁumn
;

107610 
pSˇn
->
nEquiv
 = 2;

107611 
pSˇn
->
iEquiv
 = 2;

107612  
	`whîeSˇnNext
(
pSˇn
);

107638 
WhîeTîm
 *
	`födTîm
(

107639 
WhîeCœu£
 *
pWC
,

107640 
iCur
,

107641 
iCﬁumn
,

107642 
Bômask
 
nŸRódy
,

107643 
u32
 
›
,

107644 
Index
 *
pIdx


107646 
WhîeTîm
 *
pResu…
 = 0;

107647 
WhîeTîm
 *
p
;

107648 
WhîeSˇn
 
sˇn
;

107650 
p
 = 
	`whîeSˇnInô
(&
sˇn
, 
pWC
, 
iCur
, 
iCﬁumn
, 
›
, 
pIdx
);

107651  
p
 ){

107652 if–(
p
->
¥îeqRight
 & 
nŸRódy
)==0 ){

107653 if–
p
->
¥îeqRight
==0 && (p->
eO≥øt‹
&
WO_EQ
)!=0 ){

107654  
p
;

107656 if–
pResu…
==0 )ÖResu… = 
p
;

107658 
p
 = 
	`whîeSˇnNext
(&
sˇn
);

107660  
pResu…
;

107664 
	`ex¥A«lyze
(
SrcLi°
*, 
WhîeCœu£
*, );

107669 
	`ex¥A«lyzeAŒ
(

107670 
SrcLi°
 *
pTabLi°
,

107671 
WhîeCœu£
 *
pWC


107673 
i
;

107674 
i
=
pWC
->
nTîm
-1; i>=0; i--){

107675 
	`ex¥A«lyze
(
pTabLi°
, 
pWC
, 
i
);

107679 #i‚de‡
SQLITE_OMIT_LIKE_OPTIMIZATION


107688 
	`isLikeOrGlob
(

107689 
P¨£
 *
pP¨£
,

107690 
Ex¥
 *
pEx¥
,

107691 
Ex¥
 **
µPªfix
,

107692 *
pisCom∂ëe
,

107693 *
≤oCa£


107695 c⁄° *
z
 = 0;

107696 
Ex¥
 *
pRight
, *
pLe·
;

107697 
Ex¥Li°
 *
pLi°
;

107698 
c
;

107699 
˙t
;

107700 
wc
[3];

107701 
sqlôe3
 *
db
 = 
pP¨£
->db;

107702 
sqlôe3_vÆue
 *
pVÆ
 = 0;

107703 
›
;

107705 if–!
	`sqlôe3IsLikeFun˘i⁄
(
db
, 
pEx¥
, 
≤oCa£
, 
wc
) ){

107708 #ifde‡
SQLITE_EBCDIC


107709 if–*
≤oCa£
 )  0;

107711 
pLi°
 = 
pEx¥
->
x
.pList;

107712 
pLe·
 = 
pLi°
->
a
[1].
pEx¥
;

107713 if–
pLe·
->
›
!=
TK_COLUMN


107714 || 
	`sqlôe3Ex¥Afföôy
(
pLe·
)!=
SQLITE_AFF_TEXT


107715 || 
	`IsVútuÆ
(
pLe·
->
pTab
)

107721 
	`as£π
–
pLe·
->
iCﬁumn
!=(-1) );

107723 
pRight
 = 
pLi°
->
a
[0].
pEx¥
;

107724 
›
 = 
pRight
->op;

107725 if–
›
==
TK_REGISTER
 ){

107726 
›
 = 
pRight
->
›2
;

107728 if–
›
==
TK_VARIABLE
 ){

107729 
Vdbe
 *
pRïª∑ª
 = 
pP¨£
->pReprepare;

107730 
iCﬁ
 = 
pRight
->
iCﬁumn
;

107731 
pVÆ
 = 
	`sqlôe3VdbeGëBoundVÆue
(
pRïª∑ª
, 
iCﬁ
, 
SQLITE_AFF_NONE
);

107732 if–
pVÆ
 && 
	`sqlôe3_vÆue_ty≥
’VÆ)==
SQLITE_TEXT
 ){

107733 
z
 = (*)
	`sqlôe3_vÆue_ãxt
(
pVÆ
);

107735 
	`sqlôe3VdbeSëV¨mask
(
pP¨£
->
pVdbe
, 
iCﬁ
);

107736 
	`as£π
–
pRight
->
›
==
TK_VARIABLE
 ||ÖRight->›==
TK_REGISTER
 );

107737 }if–
›
==
TK_STRING
 ){

107738 
z
 = 
pRight
->
u
.
zTokí
;

107740 if–
z
 ){

107741 
˙t
 = 0;

107742  (
c
=
z
[
˙t
])!=0 && c!=
wc
[0] && c!=wc[1] && c!=wc[2] ){

107743 
˙t
++;

107745 if–
˙t
!=0 && 255!=(
u8
)
z
[cnt-1] ){

107746 
Ex¥
 *
pPªfix
;

107747 *
pisCom∂ëe
 = 
c
==
wc
[0] && 
z
[
˙t
+1]==0;

107748 
pPªfix
 = 
	`sqlôe3Ex¥
(
db
, 
TK_STRING
, 
z
);

107749 if–
pPªfix
 )ÖPªfix->
u
.
zTokí
[
˙t
] = 0;

107750 *
µPªfix
 = 
pPªfix
;

107751 if–
›
==
TK_VARIABLE
 ){

107752 
Vdbe
 *
v
 = 
pP¨£
->
pVdbe
;

107753 
	`sqlôe3VdbeSëV¨mask
(
v
, 
pRight
->
iCﬁumn
);

107754 if–*
pisCom∂ëe
 && 
pRight
->
u
.
zTokí
[1] ){

107761 
r1
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

107762 
	`sqlôe3Ex¥CodeT¨gë
(
pP¨£
, 
pRight
, 
r1
);

107763 
	`sqlôe3VdbeCh™geP3
(
v
, 
	`sqlôe3VdbeCuºítAddr
(v)-1, 0);

107764 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
r1
);

107768 
z
 = 0;

107772 
	`sqlôe3VÆueFªe
(
pVÆ
);

107773  (
z
!=0);

107778 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


107786 
	`isM©chOfCﬁumn
(

107787 
Ex¥
 *
pEx¥


107789 
Ex¥Li°
 *
pLi°
;

107791 if–
pEx¥
->
›
!=
TK_FUNCTION
 ){

107794 if–
	`sqlôe3SåICmp
(
pEx¥
->
u
.
zTokí
,"match")!=0 ){

107797 
pLi°
 = 
pEx¥
->
x
.pList;

107798 if–
pLi°
->
nEx¥
!=2 ){

107801 if–
pLi°
->
a
[1].
pEx¥
->
›
 !
TK_COLUMN
 ){

107812 
	`å™s„rJoöM¨kögs
(
Ex¥
 *
pDîived
, Ex¥ *
pBa£
){

107813 if–
pDîived
 ){

107814 
pDîived
->
Êags
 |
pBa£
->Êag†& 
EP_FromJoö
;

107815 
pDîived
->
iRightJoöTabÀ
 = 
pBa£
->iRightJoinTable;

107819 #i‡!
	`deföed
(
SQLITE_OMIT_OR_OPTIMIZATION
Ë&& !deföed(
SQLITE_OMIT_SUBQUERY
)

107896 
	`ex¥A«lyzeOrTîm
(

107897 
SrcLi°
 *
pSrc
,

107898 
WhîeCœu£
 *
pWC
,

107899 
idxTîm


107901 
WhîeInfo
 *
pWInfo
 = 
pWC
->pWInfo;

107902 
P¨£
 *
pP¨£
 = 
pWInfo
->pParse;

107903 
sqlôe3
 *
db
 = 
pP¨£
->db;

107904 
WhîeTîm
 *
pTîm
 = &
pWC
->
a
[
idxTîm
];

107905 
Ex¥
 *
pEx¥
 = 
pTîm
->pExpr;

107906 
i
;

107907 
WhîeCœu£
 *
pOrWc
;

107908 
WhîeTîm
 *
pOrTîm
;

107909 
WhîeOrInfo
 *
pOrInfo
;

107910 
Bômask
 
chngToIN
;

107911 
Bômask
 
ödexabÀ
;

107918 
	`as£π
–(
pTîm
->
wtFœgs
 & (
TERM_DYNAMIC
|
TERM_ORINFO
|
TERM_ANDINFO
))==0 );

107919 
	`as£π
–
pEx¥
->
›
==
TK_OR
 );

107920 
pTîm
->
u
.
pOrInfo
 =ÖOrInfÿ
	`sqlôe3DbMÆlocZîo
(
db
, (*pOrInfo));

107921 if–
pOrInfo
==0 ) ;

107922 
pTîm
->
wtFœgs
 |
TERM_ORINFO
;

107923 
pOrWc
 = &
pOrInfo
->
wc
;

107924 
	`whîeCœu£Inô
(
pOrWc
, 
pWInfo
);

107925 
	`whîeS∂ô
(
pOrWc
, 
pEx¥
, 
TK_OR
);

107926 
	`ex¥A«lyzeAŒ
(
pSrc
, 
pOrWc
);

107927 if–
db
->
mÆlocFaûed
 ) ;

107928 
	`as£π
–
pOrWc
->
nTîm
>=2 );

107933 
ödexabÀ
 = ~(
Bômask
)0;

107934 
chngToIN
 = ~(
Bômask
)0;

107935 
i
=
pOrWc
->
nTîm
-1, 
pOrTîm
ıOrWc->
a
; i>=0 && 
ödexabÀ
; i--,ÖOrTerm++){

107936 if–(
pOrTîm
->
eO≥øt‹
 & 
WO_SINGLE
)==0 ){

107937 
WhîeAndInfo
 *
pAndInfo
;

107938 
	`as£π
–(
pOrTîm
->
wtFœgs
 & (
TERM_ANDINFO
|
TERM_ORINFO
))==0 );

107939 
chngToIN
 = 0;

107940 
pAndInfo
 = 
	`sqlôe3DbMÆlocRaw
(
db
, (*pAndInfo));

107941 if–
pAndInfo
 ){

107942 
WhîeCœu£
 *
pAndWC
;

107943 
WhîeTîm
 *
pAndTîm
;

107944 
j
;

107945 
Bômask
 
b
 = 0;

107946 
pOrTîm
->
u
.
pAndInfo
 =ÖAndInfo;

107947 
pOrTîm
->
wtFœgs
 |
TERM_ANDINFO
;

107948 
pOrTîm
->
eO≥øt‹
 = 
WO_AND
;

107949 
pAndWC
 = &
pAndInfo
->
wc
;

107950 
	`whîeCœu£Inô
(
pAndWC
, 
pWC
->
pWInfo
);

107951 
	`whîeS∂ô
(
pAndWC
, 
pOrTîm
->
pEx¥
, 
TK_AND
);

107952 
	`ex¥A«lyzeAŒ
(
pSrc
, 
pAndWC
);

107953 
pAndWC
->
pOuãr
 = 
pWC
;

107954 
	`ã°ˇ£
–
db
->
mÆlocFaûed
 );

107955 if–!
db
->
mÆlocFaûed
 ){

107956 
j
=0, 
pAndTîm
=
pAndWC
->
a
; j<pAndWC->
nTîm
; j++,ÖAndTerm++){

107957 
	`as£π
–
pAndTîm
->
pEx¥
 );

107958 if–
	`ÆlowedOp
(
pAndTîm
->
pEx¥
->
›
) ){

107959 
b
 |
	`gëMask
(&
pWInfo
->
sMaskSë
, 
pAndTîm
->
À·Curs‹
);

107963 
ödexabÀ
 &
b
;

107965 }if–
pOrTîm
->
wtFœgs
 & 
TERM_COPIED
 ){

107969 
Bômask
 
b
;

107970 
b
 = 
	`gëMask
(&
pWInfo
->
sMaskSë
, 
pOrTîm
->
À·Curs‹
);

107971 if–
pOrTîm
->
wtFœgs
 & 
TERM_VIRTUAL
 ){

107972 
WhîeTîm
 *
pOthî
 = &
pOrWc
->
a
[
pOrTîm
->
iP¨ít
];

107973 
b
 |
	`gëMask
(&
pWInfo
->
sMaskSë
, 
pOthî
->
À·Curs‹
);

107975 
ödexabÀ
 &
b
;

107976 if–(
pOrTîm
->
eO≥øt‹
 & 
WO_EQ
)==0 ){

107977 
chngToIN
 = 0;

107979 
chngToIN
 &
b
;

107988 
pOrInfo
->
ödexabÀ
 = indexable;

107989 
pTîm
->
eO≥øt‹
 = 
ödexabÀ
==0 ? 0 : 
WO_OR
;

108012 if–
chngToIN
 ){

108013 
okToChngToIN
 = 0;

108014 
iCﬁumn
 = -1;

108015 
iCurs‹
 = -1;

108016 
j
 = 0;

108024 
j
=0; j<2 && !
okToChngToIN
; j++){

108025 
pOrTîm
 = 
pOrWc
->
a
;

108026 
i
=
pOrWc
->
nTîm
-1; i>=0; i--, 
pOrTîm
++){

108027 
	`as£π
–
pOrTîm
->
eO≥øt‹
 & 
WO_EQ
 );

108028 
pOrTîm
->
wtFœgs
 &~
TERM_OR_OK
;

108029 if–
pOrTîm
->
À·Curs‹
==
iCurs‹
 ){

108032 
	`as£π
–
j
==1 );

108035 if–(
chngToIN
 & 
	`gëMask
(&
pWInfo
->
sMaskSë
, 
pOrTîm
->
À·Curs‹
))==0 ){

108040 
	`ã°ˇ£
–
pOrTîm
->
wtFœgs
 & 
TERM_COPIED
 );

108041 
	`ã°ˇ£
–
pOrTîm
->
wtFœgs
 & 
TERM_VIRTUAL
 );

108042 
	`as£π
–
pOrTîm
->
wtFœgs
 & (
TERM_COPIED
|
TERM_VIRTUAL
) );

108045 
iCﬁumn
 = 
pOrTîm
->
u
.
À·Cﬁumn
;

108046 
iCurs‹
 = 
pOrTîm
->
À·Curs‹
;

108049 if–
i
<0 ){

108052 
	`as£π
–
j
==1 );

108053 
	`as£π
–
	`IsPowîOfTwo
(
chngToIN
) );

108054 
	`as£π
–
chngToIN
==
	`gëMask
(&
pWInfo
->
sMaskSë
, 
iCurs‹
) );

108057 
	`ã°ˇ£
–
j
==1 );

108061 
okToChngToIN
 = 1;

108062 ; 
i
>=0 && 
okToChngToIN
; i--, 
pOrTîm
++){

108063 
	`as£π
–
pOrTîm
->
eO≥øt‹
 & 
WO_EQ
 );

108064 if–
pOrTîm
->
À·Curs‹
!=
iCurs‹
 ){

108065 
pOrTîm
->
wtFœgs
 &~
TERM_OR_OK
;

108066 }if–
pOrTîm
->
u
.
À·Cﬁumn
!=
iCﬁumn
 ){

108067 
okToChngToIN
 = 0;

108069 
affLe·
, 
affRight
;

108074 
affRight
 = 
	`sqlôe3Ex¥Afföôy
(
pOrTîm
->
pEx¥
->
pRight
);

108075 
affLe·
 = 
	`sqlôe3Ex¥Afföôy
(
pOrTîm
->
pEx¥
->
pLe·
);

108076 if–
affRight
!=0 &&áffRight!=
affLe·
 ){

108077 
okToChngToIN
 = 0;

108079 
pOrTîm
->
wtFœgs
 |
TERM_OR_OK
;

108089 if–
okToChngToIN
 ){

108090 
Ex¥
 *
pDup
;

108091 
Ex¥Li°
 *
pLi°
 = 0;

108092 
Ex¥
 *
pLe·
 = 0;

108093 
Ex¥
 *
pNew
;

108095 
i
=
pOrWc
->
nTîm
-1, 
pOrTîm
ıOrWc->
a
; i>=0; i--,ÖOrTerm++){

108096 if–(
pOrTîm
->
wtFœgs
 & 
TERM_OR_OK
)==0 ) ;

108097 
	`as£π
–
pOrTîm
->
eO≥øt‹
 & 
WO_EQ
 );

108098 
	`as£π
–
pOrTîm
->
À·Curs‹
==
iCurs‹
 );

108099 
	`as£π
–
pOrTîm
->
u
.
À·Cﬁumn
==
iCﬁumn
 );

108100 
pDup
 = 
	`sqlôe3Ex¥Dup
(
db
, 
pOrTîm
->
pEx¥
->
pRight
, 0);

108101 
pLi°
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pWInfo
->
pP¨£
,ÖLi°, 
pDup
);

108102 
pLe·
 = 
pOrTîm
->
pEx¥
->pLeft;

108104 
	`as£π
–
pLe·
!=0 );

108105 
pDup
 = 
	`sqlôe3Ex¥Dup
(
db
, 
pLe·
, 0);

108106 
pNew
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_IN
, 
pDup
, 0, 0);

108107 if–
pNew
 ){

108108 
idxNew
;

108109 
	`å™s„rJoöM¨kögs
(
pNew
, 
pEx¥
);

108110 
	`as£π
–!
	`Ex¥HasPr›îty
(
pNew
, 
EP_xIsSñe˘
) );

108111 
pNew
->
x
.
pLi°
 =ÖList;

108112 
idxNew
 = 
	`whîeCœu£In£π
(
pWC
, 
pNew
, 
TERM_VIRTUAL
|
TERM_DYNAMIC
);

108113 
	`ã°ˇ£
–
idxNew
==0 );

108114 
	`ex¥A«lyze
(
pSrc
, 
pWC
, 
idxNew
);

108115 
pTîm
 = &
pWC
->
a
[
idxTîm
];

108116 
pWC
->
a
[
idxNew
].
iP¨ít
 = 
idxTîm
;

108117 
pTîm
->
nChûd
 = 1;

108119 
	`sqlôe3Ex¥Li°Dñëe
(
db
, 
pLi°
);

108121 
pTîm
->
eO≥øt‹
 = 
WO_NOOP
;

108145 
	`ex¥A«lyze
(

108146 
SrcLi°
 *
pSrc
,

108147 
WhîeCœu£
 *
pWC
,

108148 
idxTîm


108150 
WhîeInfo
 *
pWInfo
 = 
pWC
->pWInfo;

108151 
WhîeTîm
 *
pTîm
;

108152 
WhîeMaskSë
 *
pMaskSë
;

108153 
Ex¥
 *
pEx¥
;

108154 
Bômask
 
¥îeqLe·
;

108155 
Bômask
 
¥îeqAŒ
;

108156 
Bômask
 
exåaRight
 = 0;

108157 
Ex¥
 *
pSå1
 = 0;

108158 
isCom∂ëe
 = 0;

108159 
noCa£
 = 0;

108160 
›
;

108161 
P¨£
 *
pP¨£
 = 
pWInfo
->pParse;

108162 
sqlôe3
 *
db
 = 
pP¨£
->db;

108164 if–
db
->
mÆlocFaûed
 ){

108167 
pTîm
 = &
pWC
->
a
[
idxTîm
];

108168 
pMaskSë
 = &
pWInfo
->
sMaskSë
;

108169 
pEx¥
 = 
pTîm
->pExpr;

108170 
	`as£π
–
pEx¥
->
›
!=
TK_AS
 &&ÖEx¥->›!=
TK_COLLATE
 );

108171 
¥îeqLe·
 = 
	`ex¥TabÀUßge
(
pMaskSë
, 
pEx¥
->
pLe·
);

108172 
›
 = 
pEx¥
->op;

108173 if–
›
==
TK_IN
 ){

108174 
	`as£π
–
pEx¥
->
pRight
==0 );

108175 if–
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_xIsSñe˘
) ){

108176 
pTîm
->
¥îeqRight
 = 
	`ex¥Sñe˘TabÀUßge
(
pMaskSë
, 
pEx¥
->
x
.
pSñe˘
);

108178 
pTîm
->
¥îeqRight
 = 
	`ex¥Li°TabÀUßge
(
pMaskSë
, 
pEx¥
->
x
.
pLi°
);

108180 }if–
›
==
TK_ISNULL
 ){

108181 
pTîm
->
¥îeqRight
 = 0;

108183 
pTîm
->
¥îeqRight
 = 
	`ex¥TabÀUßge
(
pMaskSë
, 
pEx¥
->
pRight
);

108185 
¥îeqAŒ
 = 
	`ex¥TabÀUßge
(
pMaskSë
, 
pEx¥
);

108186 if–
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_FromJoö
) ){

108187 
Bômask
 
x
 = 
	`gëMask
(
pMaskSë
, 
pEx¥
->
iRightJoöTabÀ
);

108188 
¥îeqAŒ
 |
x
;

108189 
exåaRight
 = 
x
-1;

108192 
pTîm
->
¥îeqAŒ
 =ÖrereqAll;

108193 
pTîm
->
À·Curs‹
 = -1;

108194 
pTîm
->
iP¨ít
 = -1;

108195 
pTîm
->
eO≥øt‹
 = 0;

108196 if–
	`ÆlowedOp
(
›
) ){

108197 
Ex¥
 *
pLe·
 = 
	`sqlôe3Ex¥SkùCﬁœã
(
pEx¥
->pLeft);

108198 
Ex¥
 *
pRight
 = 
	`sqlôe3Ex¥SkùCﬁœã
(
pEx¥
->pRight);

108199 
u16
 
›Mask
 = (
pTîm
->
¥îeqRight
 & 
¥îeqLe·
)==0 ? 
WO_ALL
 : 
WO_EQUIV
;

108200 if–
pLe·
->
›
==
TK_COLUMN
 ){

108201 
pTîm
->
À·Curs‹
 = 
pLe·
->
iTabÀ
;

108202 
pTîm
->
u
.
À·Cﬁumn
 = 
pLe·
->
iCﬁumn
;

108203 
pTîm
->
eO≥øt‹
 = 
	`›î©‹Mask
(
›
Ë& 
›Mask
;

108205 if–
pRight
 &&ÖRight->
›
==
TK_COLUMN
 ){

108206 
WhîeTîm
 *
pNew
;

108207 
Ex¥
 *
pDup
;

108208 
u16
 
eExåaOp
 = 0;

108209 if–
pTîm
->
À·Curs‹
>=0 ){

108210 
idxNew
;

108211 
pDup
 = 
	`sqlôe3Ex¥Dup
(
db
, 
pEx¥
, 0);

108212 if–
db
->
mÆlocFaûed
 ){

108213 
	`sqlôe3Ex¥Dñëe
(
db
, 
pDup
);

108216 
idxNew
 = 
	`whîeCœu£In£π
(
pWC
, 
pDup
, 
TERM_VIRTUAL
|
TERM_DYNAMIC
);

108217 if–
idxNew
==0 ) ;

108218 
pNew
 = &
pWC
->
a
[
idxNew
];

108219 
pNew
->
iP¨ít
 = 
idxTîm
;

108220 
pTîm
 = &
pWC
->
a
[
idxTîm
];

108221 
pTîm
->
nChûd
 = 1;

108222 
pTîm
->
wtFœgs
 |
TERM_COPIED
;

108223 if–
pEx¥
->
›
==
TK_EQ


108224 && !
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_FromJoö
)

108225 && 
	`O±imiz©i⁄E«bÀd
(
db
, 
SQLITE_Tønsôive
)

108227 
pTîm
->
eO≥øt‹
 |
WO_EQUIV
;

108228 
eExåaOp
 = 
WO_EQUIV
;

108231 
pDup
 = 
pEx¥
;

108232 
pNew
 = 
pTîm
;

108234 
	`ex¥Commuã
(
pP¨£
, 
pDup
);

108235 
pLe·
 = 
	`sqlôe3Ex¥SkùCﬁœã
(
pDup
->pLeft);

108236 
pNew
->
À·Curs‹
 = 
pLe·
->
iTabÀ
;

108237 
pNew
->
u
.
À·Cﬁumn
 = 
pLe·
->
iCﬁumn
;

108238 
	`ã°ˇ£
–(
¥îeqLe·
 | 
exåaRight
) !=ÖrereqLeft );

108239 
pNew
->
¥îeqRight
 = 
¥îeqLe·
 | 
exåaRight
;

108240 
pNew
->
¥îeqAŒ
 =ÖrereqAll;

108241 
pNew
->
eO≥øt‹
 = (
	`›î©‹Mask
(
pDup
->
›
Ë+ 
eExåaOp
Ë& 
›Mask
;

108245 #i‚de‡
SQLITE_OMIT_BETWEEN_OPTIMIZATION


108261 if–
pEx¥
->
›
==
TK_BETWEEN
 && 
pWC
->›==
TK_AND
 ){

108262 
Ex¥Li°
 *
pLi°
 = 
pEx¥
->
x
.pList;

108263 
i
;

108264 c⁄° 
u8
 
›s
[] = {
TK_GE
, 
TK_LE
};

108265 
	`as£π
–
pLi°
!=0 );

108266 
	`as£π
–
pLi°
->
nEx¥
==2 );

108267 
i
=0; i<2; i++){

108268 
Ex¥
 *
pNewEx¥
;

108269 
idxNew
;

108270 
pNewEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
›s
[
i
],

108271 
	`sqlôe3Ex¥Dup
(
db
, 
pEx¥
->
pLe·
, 0),

108272 
	`sqlôe3Ex¥Dup
(
db
, 
pLi°
->
a
[
i
].
pEx¥
, 0), 0);

108273 
	`å™s„rJoöM¨kögs
(
pNewEx¥
, 
pEx¥
);

108274 
idxNew
 = 
	`whîeCœu£In£π
(
pWC
, 
pNewEx¥
, 
TERM_VIRTUAL
|
TERM_DYNAMIC
);

108275 
	`ã°ˇ£
–
idxNew
==0 );

108276 
	`ex¥A«lyze
(
pSrc
, 
pWC
, 
idxNew
);

108277 
pTîm
 = &
pWC
->
a
[
idxTîm
];

108278 
pWC
->
a
[
idxNew
].
iP¨ít
 = 
idxTîm
;

108280 
pTîm
->
nChûd
 = 2;

108284 #i‡!
	`deföed
(
SQLITE_OMIT_OR_OPTIMIZATION
Ë&& !deföed(
SQLITE_OMIT_SUBQUERY
)

108288 if–
pEx¥
->
›
==
TK_OR
 ){

108289 
	`as£π
–
pWC
->
›
==
TK_AND
 );

108290 
	`ex¥A«lyzeOrTîm
(
pSrc
, 
pWC
, 
idxTîm
);

108291 
pTîm
 = &
pWC
->
a
[
idxTîm
];

108295 #i‚de‡
SQLITE_OMIT_LIKE_OPTIMIZATION


108306 if–
pWC
->
›
==
TK_AND


108307 && 
	`isLikeOrGlob
(
pP¨£
, 
pEx¥
, &
pSå1
, &
isCom∂ëe
, &
noCa£
)

108309 
Ex¥
 *
pLe·
;

108310 
Ex¥
 *
pSå2
;

108311 
Ex¥
 *
pNewEx¥1
;

108312 
Ex¥
 *
pNewEx¥2
;

108313 
idxNew1
;

108314 
idxNew2
;

108315 
Tokí
 
sCﬁlSeqName
;

108317 
pLe·
 = 
pEx¥
->
x
.
pLi°
->
a
[1].pExpr;

108318 
pSå2
 = 
	`sqlôe3Ex¥Dup
(
db
, 
pSå1
, 0);

108319 if–!
db
->
mÆlocFaûed
 ){

108320 
u8
 
c
, *
pC
;

108321 
pC
 = (
u8
*)&
pSå2
->
u
.
zTokí
[
	`sqlôe3SåÀn30
(pStr2->u.zToken)-1];

108322 
c
 = *
pC
;

108323 if–
noCa£
 ){

108330 if–
c
=='A'-1 ) 
isCom∂ëe
 = 0;

108331 
c
 = 
sqlôe3UµîToLowî
[c];

108333 *
pC
 = 
c
 + 1;

108335 
sCﬁlSeqName
.
z
 = 
noCa£
 ? "NOCASE" : "BINARY";

108336 
sCﬁlSeqName
.
n
 = 6;

108337 
pNewEx¥1
 = 
	`sqlôe3Ex¥Dup
(
db
, 
pLe·
, 0);

108338 
pNewEx¥1
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_GE
,

108339 
	`sqlôe3Ex¥AddCﬁœãTokí
(
pP¨£
,
pNewEx¥1
,&
sCﬁlSeqName
),

108340 
pSå1
, 0);

108341 
	`å™s„rJoöM¨kögs
(
pNewEx¥1
, 
pEx¥
);

108342 
idxNew1
 = 
	`whîeCœu£In£π
(
pWC
, 
pNewEx¥1
, 
TERM_VIRTUAL
|
TERM_DYNAMIC
);

108343 
	`ã°ˇ£
–
idxNew1
==0 );

108344 
	`ex¥A«lyze
(
pSrc
, 
pWC
, 
idxNew1
);

108345 
pNewEx¥2
 = 
	`sqlôe3Ex¥Dup
(
db
, 
pLe·
, 0);

108346 
pNewEx¥2
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_LT
,

108347 
	`sqlôe3Ex¥AddCﬁœãTokí
(
pP¨£
,
pNewEx¥2
,&
sCﬁlSeqName
),

108348 
pSå2
, 0);

108349 
	`å™s„rJoöM¨kögs
(
pNewEx¥2
, 
pEx¥
);

108350 
idxNew2
 = 
	`whîeCœu£In£π
(
pWC
, 
pNewEx¥2
, 
TERM_VIRTUAL
|
TERM_DYNAMIC
);

108351 
	`ã°ˇ£
–
idxNew2
==0 );

108352 
	`ex¥A«lyze
(
pSrc
, 
pWC
, 
idxNew2
);

108353 
pTîm
 = &
pWC
->
a
[
idxTîm
];

108354 if–
isCom∂ëe
 ){

108355 
pWC
->
a
[
idxNew1
].
iP¨ít
 = 
idxTîm
;

108356 
pWC
->
a
[
idxNew2
].
iP¨ít
 = 
idxTîm
;

108357 
pTîm
->
nChûd
 = 2;

108362 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


108369 if–
	`isM©chOfCﬁumn
(
pEx¥
) ){

108370 
idxNew
;

108371 
Ex¥
 *
pRight
, *
pLe·
;

108372 
WhîeTîm
 *
pNewTîm
;

108373 
Bômask
 
¥îeqCﬁumn
, 
¥îeqEx¥
;

108375 
pRight
 = 
pEx¥
->
x
.
pLi°
->
a
[0].pExpr;

108376 
pLe·
 = 
pEx¥
->
x
.
pLi°
->
a
[1].pExpr;

108377 
¥îeqEx¥
 = 
	`ex¥TabÀUßge
(
pMaskSë
, 
pRight
);

108378 
¥îeqCﬁumn
 = 
	`ex¥TabÀUßge
(
pMaskSë
, 
pLe·
);

108379 if–(
¥îeqEx¥
 & 
¥îeqCﬁumn
)==0 ){

108380 
Ex¥
 *
pNewEx¥
;

108381 
pNewEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_MATCH
,

108382 0, 
	`sqlôe3Ex¥Dup
(
db
, 
pRight
, 0), 0);

108383 
idxNew
 = 
	`whîeCœu£In£π
(
pWC
, 
pNewEx¥
, 
TERM_VIRTUAL
|
TERM_DYNAMIC
);

108384 
	`ã°ˇ£
–
idxNew
==0 );

108385 
pNewTîm
 = &
pWC
->
a
[
idxNew
];

108386 
pNewTîm
->
¥îeqRight
 = 
¥îeqEx¥
;

108387 
pNewTîm
->
À·Curs‹
 = 
pLe·
->
iTabÀ
;

108388 
pNewTîm
->
u
.
À·Cﬁumn
 = 
pLe·
->
iCﬁumn
;

108389 
pNewTîm
->
eO≥øt‹
 = 
WO_MATCH
;

108390 
pNewTîm
->
iP¨ít
 = 
idxTîm
;

108391 
pTîm
 = &
pWC
->
a
[
idxTîm
];

108392 
pTîm
->
nChûd
 = 1;

108393 
pTîm
->
wtFœgs
 |
TERM_COPIED
;

108394 
pNewTîm
->
¥îeqAŒ
 = 
pTîm
->prereqAll;

108399 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


108410 if–
pEx¥
->
›
==
TK_NOTNULL


108411 && 
pEx¥
->
pLe·
->
›
==
TK_COLUMN


108412 && 
pEx¥
->
pLe·
->
iCﬁumn
>=0

108413 && 
	`O±imiz©i⁄E«bÀd
(
db
, 
SQLITE_Sèt3
)

108415 
Ex¥
 *
pNewEx¥
;

108416 
Ex¥
 *
pLe·
 = 
pEx¥
->pLeft;

108417 
idxNew
;

108418 
WhîeTîm
 *
pNewTîm
;

108420 
pNewEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_GT
,

108421 
	`sqlôe3Ex¥Dup
(
db
, 
pLe·
, 0),

108422 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_NULL
, 0, 0, 0), 0);

108424 
idxNew
 = 
	`whîeCœu£In£π
(
pWC
, 
pNewEx¥
,

108425 
TERM_VIRTUAL
|
TERM_DYNAMIC
|
TERM_VNULL
);

108426 if–
idxNew
 ){

108427 
pNewTîm
 = &
pWC
->
a
[
idxNew
];

108428 
pNewTîm
->
¥îeqRight
 = 0;

108429 
pNewTîm
->
À·Curs‹
 = 
pLe·
->
iTabÀ
;

108430 
pNewTîm
->
u
.
À·Cﬁumn
 = 
pLe·
->
iCﬁumn
;

108431 
pNewTîm
->
eO≥øt‹
 = 
WO_GT
;

108432 
pNewTîm
->
iP¨ít
 = 
idxTîm
;

108433 
pTîm
 = &
pWC
->
a
[
idxTîm
];

108434 
pTîm
->
nChûd
 = 1;

108435 
pTîm
->
wtFœgs
 |
TERM_COPIED
;

108436 
pNewTîm
->
¥îeqAŒ
 = 
pTîm
->prereqAll;

108444 
pTîm
->
¥îeqRight
 |
exåaRight
;

108454 
	`födIndexCﬁ
(

108455 
P¨£
 *
pP¨£
,

108456 
Ex¥Li°
 *
pLi°
,

108457 
iBa£
,

108458 
Index
 *
pIdx
,

108459 
iCﬁ


108461 
i
;

108462 c⁄° *
zCﬁl
 = 
pIdx
->
azCﬁl
[
iCﬁ
];

108464 
i
=0; i<
pLi°
->
nEx¥
; i++){

108465 
Ex¥
 *
p
 = 
	`sqlôe3Ex¥SkùCﬁœã
(
pLi°
->
a
[
i
].
pEx¥
);

108466 if–
p
->
›
==
TK_COLUMN


108467 && 
p
->
iCﬁumn
==
pIdx
->
aiCﬁumn
[
iCﬁ
]

108468 && 
p
->
iTabÀ
==
iBa£


108470 
CﬁlSeq
 *
pCﬁl
 = 
	`sqlôe3Ex¥CﬁlSeq
(
pP¨£
, 
pLi°
->
a
[
i
].
pEx¥
);

108471 if–
	`ALWAYS
(
pCﬁl
Ë&& 0==
	`sqlôe3SåICmp
’Cﬁl->
zName
, 
zCﬁl
) ){

108472  
i
;

108487 
	`isDi°ö˘Redund™t
(

108488 
P¨£
 *
pP¨£
,

108489 
SrcLi°
 *
pTabLi°
,

108490 
WhîeCœu£
 *
pWC
,

108491 
Ex¥Li°
 *
pDi°ö˘


108493 
TabÀ
 *
pTab
;

108494 
Index
 *
pIdx
;

108495 
i
;

108496 
iBa£
;

108501 if–
pTabLi°
->
nSrc
!=1 )  0;

108502 
iBa£
 = 
pTabLi°
->
a
[0].
iCurs‹
;

108503 
pTab
 = 
pTabLi°
->
a
[0].pTab;

108509 
i
=0; i<
pDi°ö˘
->
nEx¥
; i++){

108510 
Ex¥
 *
p
 = 
	`sqlôe3Ex¥SkùCﬁœã
(
pDi°ö˘
->
a
[
i
].
pEx¥
);

108511 if–
p
->
›
==
TK_COLUMN
 &&Ö->
iTabÀ
==
iBa£
 &&Ö->
iCﬁumn
<0 )  1;

108527 
pIdx
=
pTab
->
pIndex
;ÖIdx;ÖIdxıIdx->
pNext
){

108528 if–
pIdx
->
⁄Eº‹
==
OE_N⁄e
 ) ;

108529 
i
=0; i<
pIdx
->
nCﬁumn
; i++){

108530 
iCﬁ
 = 
pIdx
->
aiCﬁumn
[
i
];

108531 if–0==
	`födTîm
(
pWC
, 
iBa£
, 
iCﬁ
, ~(
Bômask
)0, 
WO_EQ
, 
pIdx
) ){

108532 
iIdxCﬁ
 = 
	`födIndexCﬁ
(
pP¨£
, 
pDi°ö˘
, 
iBa£
, 
pIdx
, 
i
);

108533 if–
iIdxCﬁ
<0 || 
pTab
->
aCﬁ
[
pIdx
->
aiCﬁumn
[
i
]].
nŸNuŒ
==0 ){

108538 if–
i
==
pIdx
->
nCﬁumn
 ){

108551 
LogE°
 
	`e°Log
(LogE° 
N
){

108552 
LogE°
 
x
 = 
	`sqlôe3LogE°
(
N
);

108553  
x
>33 ? x - 33 : 0;

108562 #i‡!
	`deföed
(
SQLITE_OMIT_VIRTUALTABLE
Ë&& deföed(
WHERETRACE_ENABLED
)

108563 
	`TRACE_IDX_INPUTS
(
sqlôe3_ödex_öfo
 *
p
){

108564 
i
;

108565 if–!
sqlôe3WhîeTø˚
 ) ;

108566 
i
=0; i<
p
->
nC⁄°øöt
; i++){

108567 
	`sqlôe3DebugPrötf
(" constraint[%d]: col=%dÅermid=%d op=%d usabled=%d\n",

108568 
i
,

108569 
p
->
aC⁄°øöt
[
i
].
iCﬁumn
,

108570 
p
->
aC⁄°øöt
[
i
].
iTîmOff£t
,

108571 
p
->
aC⁄°øöt
[
i
].
›
,

108572 
p
->
aC⁄°øöt
[
i
].
ußbÀ
);

108574 
i
=0; i<
p
->
nOrdîBy
; i++){

108575 
	`sqlôe3DebugPrötf
(" orderby[%d]: col=%d desc=%d\n",

108576 
i
,

108577 
p
->
aOrdîBy
[
i
].
iCﬁumn
,

108578 
p
->
aOrdîBy
[
i
].
desc
);

108581 
	`TRACE_IDX_OUTPUTS
(
sqlôe3_ödex_öfo
 *
p
){

108582 
i
;

108583 if–!
sqlôe3WhîeTø˚
 ) ;

108584 
i
=0; i<
p
->
nC⁄°øöt
; i++){

108585 
	`sqlôe3DebugPrötf
(" usage[%d]:árgvIdx=%d omit=%d\n",

108586 
i
,

108587 
p
->
aC⁄°øötUßge
[
i
].
¨gvIndex
,

108588 
p
->
aC⁄°øötUßge
[
i
].
omô
);

108590 
	`sqlôe3DebugPrötf
(" idxNum=%d\n", 
p
->
idxNum
);

108591 
	`sqlôe3DebugPrötf
(" idxSå=%s\n", 
p
->
idxSå
);

108592 
	`sqlôe3DebugPrötf
(" ordîByC⁄sumed=%d\n", 
p
->
‹dîByC⁄sumed
);

108593 
	`sqlôe3DebugPrötf
("É°im©edCo°=%g\n", 
p
->
e°im©edCo°
);

108596 
	#TRACE_IDX_INPUTS
(
A
)

	)

108597 
	#TRACE_IDX_OUTPUTS
(
A
)

	)

108600 #i‚de‡
SQLITE_OMIT_AUTOMATIC_INDEX


108606 
	`ãrmC™DriveIndex
(

108607 
WhîeTîm
 *
pTîm
,

108608 
SrcLi°_ôem
 *
pSrc
,

108609 
Bômask
 
nŸRódy


108611 
aff
;

108612 if–
pTîm
->
À·Curs‹
!=
pSrc
->
iCurs‹
 )  0;

108613 if–(
pTîm
->
eO≥øt‹
 & 
WO_EQ
)==0 )  0;

108614 if–(
pTîm
->
¥îeqRight
 & 
nŸRódy
)!=0 )  0;

108615 if–
pTîm
->
u
.
À·Cﬁumn
<0 )  0;

108616 
aff
 = 
pSrc
->
pTab
->
aCﬁ
[
pTîm
->
u
.
À·Cﬁumn
].
afföôy
;

108617 if–!
	`sqlôe3IndexAfföôyOk
(
pTîm
->
pEx¥
, 
aff
) )  0;

108623 #i‚de‡
SQLITE_OMIT_AUTOMATIC_INDEX


108629 
	`c⁄°ru˘Autom©icIndex
(

108630 
P¨£
 *
pP¨£
,

108631 
WhîeCœu£
 *
pWC
,

108632 
SrcLi°_ôem
 *
pSrc
,

108633 
Bômask
 
nŸRódy
,

108634 
WhîeLevñ
 *
pLevñ


108636 
nCﬁumn
;

108637 
WhîeTîm
 *
pTîm
;

108638 
WhîeTîm
 *
pWCEnd
;

108639 
nByã
;

108640 
Index
 *
pIdx
;

108641 
Vdbe
 *
v
;

108642 
addrInô
;

108643 
TabÀ
 *
pTabÀ
;

108644 
KeyInfo
 *
pKeyöfo
;

108645 
addrT›
;

108646 
ªgRec‹d
;

108647 
n
;

108648 
i
;

108649 
mxBôCﬁ
;

108650 
CﬁlSeq
 *
pCﬁl
;

108651 
WhîeLo›
 *
pLo›
;

108652 
Bômask
 
idxCﬁs
;

108653 
Bômask
 
exåaCﬁs
;

108654 
u8
 
£¡W¨nög
 = 0;

108658 
v
 = 
pP¨£
->
pVdbe
;

108659 
	`as£π
–
v
!=0 );

108660 
addrInô
 = 
	`sqlôe3CodeOn˚
(
pP¨£
);

108664 
nCﬁumn
 = 0;

108665 
pTabÀ
 = 
pSrc
->
pTab
;

108666 
pWCEnd
 = &
pWC
->
a
[pWC->
nTîm
];

108667 
pLo›
 = 
pLevñ
->
pWLo›
;

108668 
idxCﬁs
 = 0;

108669 
pTîm
=
pWC
->
a
;ÖTîm<
pWCEnd
;ÖTerm++){

108670 if–
	`ãrmC™DriveIndex
(
pTîm
, 
pSrc
, 
nŸRódy
) ){

108671 
iCﬁ
 = 
pTîm
->
u
.
À·Cﬁumn
;

108672 
Bômask
 
cMask
 = 
iCﬁ
>=
BMS
 ? 
	`MASKBIT
(BMS-1) : MASKBIT(iCol);

108673 
	`ã°ˇ£
–
iCﬁ
==
BMS
 );

108674 
	`ã°ˇ£
–
iCﬁ
==
BMS
-1 );

108675 if–!
£¡W¨nög
 ){

108676 
	`sqlôe3_log
(
SQLITE_WARNING_AUTOINDEX
,

108677 "autom©i¯ödex o¿%s(%s)", 
pTabÀ
->
zName
,

108678 
pTabÀ
->
aCﬁ
[
iCﬁ
].
zName
);

108679 
£¡W¨nög
 = 1;

108681 if–(
idxCﬁs
 & 
cMask
)==0 ){

108682 if–
	`whîeLo›Resize
(
pP¨£
->
db
, 
pLo›
, 
nCﬁumn
+1) ) ;

108683 
pLo›
->
aLTîm
[
nCﬁumn
++] = 
pTîm
;

108684 
idxCﬁs
 |
cMask
;

108688 
	`as£π
–
nCﬁumn
>0 );

108689 
pLo›
->
u
.
båì
.
nEq
 =ÖLo›->
nLTîm
 = 
nCﬁumn
;

108690 
pLo›
->
wsFœgs
 = 
WHERE_COLUMN_EQ
 | 
WHERE_IDX_ONLY
 | 
WHERE_INDEXED


108691 | 
WHERE_AUTO_INDEX
;

108701 
exåaCﬁs
 = 
pSrc
->
cﬁU£d
 & (~
idxCﬁs
 | 
	`MASKBIT
(
BMS
-1));

108702 
mxBôCﬁ
 = (
pTabÀ
->
nCﬁ
 >
BMS
-1) ? BMS-1 :ÖTable->nCol;

108703 
	`ã°ˇ£
–
pTabÀ
->
nCﬁ
==
BMS
-1 );

108704 
	`ã°ˇ£
–
pTabÀ
->
nCﬁ
==
BMS
-2 );

108705 
i
=0; i<
mxBôCﬁ
; i++){

108706 if–
exåaCﬁs
 & 
	`MASKBIT
(
i
ËË
nCﬁumn
++;

108708 if–
pSrc
->
cﬁU£d
 & 
	`MASKBIT
(
BMS
-1) ){

108709 
nCﬁumn
 +
pTabÀ
->
nCﬁ
 - 
BMS
 + 1;

108711 
pLo›
->
wsFœgs
 |
WHERE_COLUMN_EQ
 | 
WHERE_IDX_ONLY
;

108714 
nByã
 = (
Index
);

108715 
nByã
 +
nCﬁumn
*();

108716 
nByã
 +
nCﬁumn
*(*);

108717 
nByã
 +
nCﬁumn
;

108718 
pIdx
 = 
	`sqlôe3DbMÆlocZîo
(
pP¨£
->
db
, 
nByã
);

108719 if–
pIdx
==0 ) ;

108720 
pLo›
->
u
.
båì
.
pIndex
 = 
pIdx
;

108721 
pIdx
->
azCﬁl
 = (**)&pIdx[1];

108722 
pIdx
->
aiCﬁumn
 = (*)&pIdx->
azCﬁl
[
nCﬁumn
];

108723 
pIdx
->
aS‹tOrdî
 = (
u8
*)&pIdx->
aiCﬁumn
[
nCﬁumn
];

108724 
pIdx
->
zName
 = "auto-index";

108725 
pIdx
->
nCﬁumn
 =ÇColumn;

108726 
pIdx
->
pTabÀ
 =ÖTable;

108727 
n
 = 0;

108728 
idxCﬁs
 = 0;

108729 
pTîm
=
pWC
->
a
;ÖTîm<
pWCEnd
;ÖTerm++){

108730 if–
	`ãrmC™DriveIndex
(
pTîm
, 
pSrc
, 
nŸRódy
) ){

108731 
iCﬁ
 = 
pTîm
->
u
.
À·Cﬁumn
;

108732 
Bômask
 
cMask
 = 
iCﬁ
>=
BMS
 ? 
	`MASKBIT
(BMS-1) : MASKBIT(iCol);

108733 
	`ã°ˇ£
–
iCﬁ
==
BMS
-1 );

108734 
	`ã°ˇ£
–
iCﬁ
==
BMS
 );

108735 if–(
idxCﬁs
 & 
cMask
)==0 ){

108736 
Ex¥
 *
pX
 = 
pTîm
->
pEx¥
;

108737 
idxCﬁs
 |
cMask
;

108738 
pIdx
->
aiCﬁumn
[
n
] = 
pTîm
->
u
.
À·Cﬁumn
;

108739 
pCﬁl
 = 
	`sqlôe3Bö¨yCom∑ªCﬁlSeq
(
pP¨£
, 
pX
->
pLe·
,ÖX->
pRight
);

108740 
pIdx
->
azCﬁl
[
n
] = 
	`ALWAYS
(
pCﬁl
Ë?ÖCﬁl->
zName
 : "BINARY";

108741 
n
++;

108745 
	`as£π
–(
u32
)
n
==
pLo›
->
u
.
båì
.
nEq
 );

108749 
i
=0; i<
mxBôCﬁ
; i++){

108750 if–
exåaCﬁs
 & 
	`MASKBIT
(
i
) ){

108751 
pIdx
->
aiCﬁumn
[
n
] = 
i
;

108752 
pIdx
->
azCﬁl
[
n
] = "BINARY";

108753 
n
++;

108756 if–
pSrc
->
cﬁU£d
 & 
	`MASKBIT
(
BMS
-1) ){

108757 
i
=
BMS
-1; i<
pTabÀ
->
nCﬁ
; i++){

108758 
pIdx
->
aiCﬁumn
[
n
] = 
i
;

108759 
pIdx
->
azCﬁl
[
n
] = "BINARY";

108760 
n
++;

108763 
	`as£π
–
n
==
nCﬁumn
 );

108766 
pKeyöfo
 = 
	`sqlôe3IndexKeyöfo
(
pP¨£
, 
pIdx
);

108767 
	`as£π
–
pLevñ
->
iIdxCur
>=0 );

108768 
pLevñ
->
iIdxCur
 = 
pP¨£
->
nTab
++;

108769 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_O≥nAutoödex
, 
pLevñ
->
iIdxCur
, 
nCﬁumn
+1, 0,

108770 (*)
pKeyöfo
, 
P4_KEYINFO_HANDOFF
);

108771 
	`VdbeCommít
((
v
, "f‹ %s", 
pTabÀ
->
zName
));

108774 
addrT›
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Rewöd
, 
pLevñ
->
iTabCur
);

108775 
ªgRec‹d
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

108776 
	`sqlôe3Gíî©eIndexKey
(
pP¨£
, 
pIdx
, 
pLevñ
->
iTabCur
, 
ªgRec‹d
, 1, 0);

108777 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_IdxIn£π
, 
pLevñ
->
iIdxCur
, 
ªgRec‹d
);

108778 
	`sqlôe3VdbeCh™geP5
(
v
, 
OPFLAG_USESEEKRESULT
);

108779 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Next
, 
pLevñ
->
iTabCur
, 
addrT›
+1);

108780 
	`sqlôe3VdbeCh™geP5
(
v
, 
SQLITE_STMTSTATUS_AUTOINDEX
);

108781 
	`sqlôe3VdbeJumpHîe
(
v
, 
addrT›
);

108782 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
ªgRec‹d
);

108785 
	`sqlôe3VdbeJumpHîe
(
v
, 
addrInô
);

108789 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


108795 
sqlôe3_ödex_öfo
 *
	`ÆloˇãIndexInfo
(

108796 
P¨£
 *
pP¨£
,

108797 
WhîeCœu£
 *
pWC
,

108798 
SrcLi°_ôem
 *
pSrc
,

108799 
Ex¥Li°
 *
pOrdîBy


108801 
i
, 
j
;

108802 
nTîm
;

108803 
sqlôe3_ödex_c⁄°øöt
 *
pIdxC⁄s
;

108804 
sqlôe3_ödex_‹dîby
 *
pIdxOrdîBy
;

108805 
sqlôe3_ödex_c⁄°øöt_ußge
 *
pUßge
;

108806 
WhîeTîm
 *
pTîm
;

108807 
nOrdîBy
;

108808 
sqlôe3_ödex_öfo
 *
pIdxInfo
;

108812 
i
=
nTîm
=0, 
pTîm
=
pWC
->
a
; i<pWC->nTerm; i++,ÖTerm++){

108813 if–
pTîm
->
À·Curs‹
 !
pSrc
->
iCurs‹
 ) ;

108814 
	`as£π
–
	`IsPowîOfTwo
(
pTîm
->
eO≥øt‹
 & ~
WO_EQUIV
) );

108815 
	`ã°ˇ£
–
pTîm
->
eO≥øt‹
 & 
WO_IN
 );

108816 
	`ã°ˇ£
–
pTîm
->
eO≥øt‹
 & 
WO_ISNULL
 );

108817 if–
pTîm
->
eO≥øt‹
 & (
WO_ISNULL
) ) ;

108818 if–
pTîm
->
wtFœgs
 & 
TERM_VNULL
 ) ;

108819 
nTîm
++;

108826 
nOrdîBy
 = 0;

108827 if–
pOrdîBy
 ){

108828 
n
 = 
pOrdîBy
->
nEx¥
;

108829 
i
=0; i<
n
; i++){

108830 
Ex¥
 *
pEx¥
 = 
pOrdîBy
->
a
[
i
].pExpr;

108831 if–
pEx¥
->
›
!=
TK_COLUMN
 ||ÖEx¥->
iTabÀ
!=
pSrc
->
iCurs‹
 ) ;

108833 if–
i
==
n
){

108834 
nOrdîBy
 = 
n
;

108840 
pIdxInfo
 = 
	`sqlôe3DbMÆlocZîo
(
pP¨£
->
db
, (*pIdxInfo)

108841 + ((*
pIdxC⁄s
Ë+ (*
pUßge
))*
nTîm


108842 + (*
pIdxOrdîBy
)*
nOrdîBy
 );

108843 if–
pIdxInfo
==0 ){

108844 
	`sqlôe3Eº‹Msg
(
pP¨£
, "out of memory");

108853 
pIdxC⁄s
 = (
sqlôe3_ödex_c⁄°øöt
*)&
pIdxInfo
[1];

108854 
pIdxOrdîBy
 = (
sqlôe3_ödex_‹dîby
*)&
pIdxC⁄s
[
nTîm
];

108855 
pUßge
 = (
sqlôe3_ödex_c⁄°øöt_ußge
*)&
pIdxOrdîBy
[
nOrdîBy
];

108856 *(*)&
pIdxInfo
->
nC⁄°øöt
 = 
nTîm
;

108857 *(*)&
pIdxInfo
->
nOrdîBy
 =ÇOrderBy;

108858 *(
sqlôe3_ödex_c⁄°øöt
**)&
pIdxInfo
->
aC⁄°øöt
 = 
pIdxC⁄s
;

108859 *(
sqlôe3_ödex_‹dîby
**)&
pIdxInfo
->
aOrdîBy
 = 
pIdxOrdîBy
;

108860 *(
sqlôe3_ödex_c⁄°øöt_ußge
**)&
pIdxInfo
->
aC⁄°øötUßge
 =

108861 
pUßge
;

108863 
i
=
j
=0, 
pTîm
=
pWC
->
a
; i<pWC->
nTîm
; i++,ÖTerm++){

108864 
u8
 
›
;

108865 if–
pTîm
->
À·Curs‹
 !
pSrc
->
iCurs‹
 ) ;

108866 
	`as£π
–
	`IsPowîOfTwo
(
pTîm
->
eO≥øt‹
 & ~
WO_EQUIV
) );

108867 
	`ã°ˇ£
–
pTîm
->
eO≥øt‹
 & 
WO_IN
 );

108868 
	`ã°ˇ£
–
pTîm
->
eO≥øt‹
 & 
WO_ISNULL
 );

108869 if–
pTîm
->
eO≥øt‹
 & (
WO_ISNULL
) ) ;

108870 if–
pTîm
->
wtFœgs
 & 
TERM_VNULL
 ) ;

108871 
pIdxC⁄s
[
j
].
iCﬁumn
 = 
pTîm
->
u
.
À·Cﬁumn
;

108872 
pIdxC⁄s
[
j
].
iTîmOff£t
 = 
i
;

108873 
›
 = (
u8
)
pTîm
->
eO≥øt‹
 & 
WO_ALL
;

108874 if–
›
==
WO_IN
 ) o∞
WO_EQ
;

108875 
pIdxC⁄s
[
j
].
›
 = op;

108879 
	`as£π
–
WO_EQ
==
SQLITE_INDEX_CONSTRAINT_EQ
 );

108880 
	`as£π
–
WO_LT
==
SQLITE_INDEX_CONSTRAINT_LT
 );

108881 
	`as£π
–
WO_LE
==
SQLITE_INDEX_CONSTRAINT_LE
 );

108882 
	`as£π
–
WO_GT
==
SQLITE_INDEX_CONSTRAINT_GT
 );

108883 
	`as£π
–
WO_GE
==
SQLITE_INDEX_CONSTRAINT_GE
 );

108884 
	`as£π
–
WO_MATCH
==
SQLITE_INDEX_CONSTRAINT_MATCH
 );

108885 
	`as£π
–
pTîm
->
eO≥øt‹
 & (
WO_IN
|
WO_EQ
|
WO_LT
|
WO_LE
|
WO_GT
|
WO_GE
|
WO_MATCH
) );

108886 
j
++;

108888 
i
=0; i<
nOrdîBy
; i++){

108889 
Ex¥
 *
pEx¥
 = 
pOrdîBy
->
a
[
i
].pExpr;

108890 
pIdxOrdîBy
[
i
].
iCﬁumn
 = 
pEx¥
->iColumn;

108891 
pIdxOrdîBy
[
i
].
desc
 = 
pOrdîBy
->
a
[i].
s‹tOrdî
;

108894  
pIdxInfo
;

108911 
	`vèbBe°Index
(
P¨£
 *
pP¨£
, 
TabÀ
 *
pTab
, 
sqlôe3_ödex_öfo
 *
p
){

108912 
sqlôe3_vèb
 *
pVèb
 = 
	`sqlôe3GëVTabÀ
(
pP¨£
->
db
, 
pTab
)->pVtab;

108913 
i
;

108914 
rc
;

108916 
	`TRACE_IDX_INPUTS
(
p
);

108917 
rc
 = 
pVèb
->
pModuÀ
->
	`xBe°Index
’Vèb, 
p
);

108918 
	`TRACE_IDX_OUTPUTS
(
p
);

108920 if–
rc
!=
SQLITE_OK
 ){

108921 if–
rc
==
SQLITE_NOMEM
 ){

108922 
pP¨£
->
db
->
mÆlocFaûed
 = 1;

108923 }if–!
pVèb
->
zEºMsg
 ){

108924 
	`sqlôe3Eº‹Msg
(
pP¨£
, "%s", 
	`sqlôe3EºSå
(
rc
));

108926 
	`sqlôe3Eº‹Msg
(
pP¨£
, "%s", 
pVèb
->
zEºMsg
);

108929 
	`sqlôe3_‰ì
(
pVèb
->
zEºMsg
);

108930 
pVèb
->
zEºMsg
 = 0;

108932 
i
=0; i<
p
->
nC⁄°øöt
; i++){

108933 if–!
p
->
aC⁄°øöt
[
i
].
ußbÀ
 &&Ö->
aC⁄°øötUßge
[i].
¨gvIndex
>0 ){

108934 
	`sqlôe3Eº‹Msg
(
pP¨£
,

108935 "èbÀ %s: xBe°IndexÑëu∫edá¿övÆidÖœn", 
pTab
->
zName
);

108939  
pP¨£
->
nEº
;

108944 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


108954 
	`whîeKeySèts
(

108955 
P¨£
 *
pP¨£
,

108956 
Index
 *
pIdx
,

108957 
U≈ackedRec‹d
 *
pRec
,

108958 
roundUp
,

108959 
tRow˙t
 *
aSèt


108961 
IndexSam∂e
 *
aSam∂e
 = 
pIdx
->aSample;

108962 
iCﬁ
;

108963 
iMö
 = 0;

108964 
i
 = 
pIdx
->
nSam∂e
;

108965 
iTe°
;

108966 
ªs
;

108968 #i‚de‡
SQLITE_DEBUG


108969 
	`UNUSED_PARAMETER
–
pP¨£
 );

108971 
	`as£π
–
pRec
!=0 || 
pP¨£
->
db
->
mÆlocFaûed
 );

108972 if–
pRec
==0 ) ;

108973 
iCﬁ
 = 
pRec
->
nFõld
 - 1;

108974 
	`as£π
–
pIdx
->
nSam∂e
>0 );

108975 
	`as£π
–
pRec
->
nFõld
>0 && 
iCﬁ
<
pIdx
->
nSam∂eCﬁ
 );

108977 
iTe°
 = (
iMö
+
i
)/2;

108978 
ªs
 = 
	`sqlôe3VdbeRec‹dCom∑ª
(
aSam∂e
[
iTe°
].
n
,áSam∂e[iTe°].
p
, 
pRec
);

108979 if–
ªs
<0 ){

108980 
iMö
 = 
iTe°
+1;

108982 
i
 = 
iTe°
;

108984 } 
ªs
 && 
iMö
<
i
 );

108986 #ifde‡
SQLITE_DEBUG


108990 if–
ªs
==0 ){

108992 
	`as£π
–
i
<
pIdx
->
nSam∂e
 );

108993 
	`as£π
–0==
	`sqlôe3VdbeRec‹dCom∑ª
(
aSam∂e
[
i
].
n
,áSam∂e[i].
p
, 
pRec
)

108994 || 
pP¨£
->
db
->
mÆlocFaûed
 );

108998 
	`as£π
–
i
==
pIdx
->
nSam∂e


108999 || 
	`sqlôe3VdbeRec‹dCom∑ª
(
aSam∂e
[
i
].
n
,áSam∂e[i].
p
, 
pRec
)>0

109000 || 
pP¨£
->
db
->
mÆlocFaûed
 );

109001 
	`as£π
–
i
==0

109002 || 
	`sqlôe3VdbeRec‹dCom∑ª
(
aSam∂e
[
i
-1].
n
,áSam∂e[i-1].
p
, 
pRec
)<0

109003 || 
pP¨£
->
db
->
mÆlocFaûed
 );

109011 if–
ªs
==0 ){

109012 
aSèt
[0] = 
aSam∂e
[
i
].
™Lt
[
iCﬁ
];

109013 
aSèt
[1] = 
aSam∂e
[
i
].
™Eq
[
iCﬁ
];

109015 
tRow˙t
 
iLowî
, 
iUµî
, 
iG≠
;

109016 if–
i
==0 ){

109017 
iLowî
 = 0;

109018 
iUµî
 = 
aSam∂e
[0].
™Lt
[
iCﬁ
];

109020 
iUµî
 = 
i
>=
pIdx
->
nSam∂e
 ?ÖIdx->
aiRowE°
[0] : 
aSam∂e
[i].
™Lt
[
iCﬁ
];

109021 
iLowî
 = 
aSam∂e
[
i
-1].
™Eq
[
iCﬁ
] +áSam∂e[i-1].
™Lt
[iCol];

109023 
aSèt
[1] = (
pIdx
->
nCﬁumn
>
iCﬁ
 ?ÖIdx->
aAvgEq
[iCol] : 1);

109024 if–
iLowî
>=
iUµî
 ){

109025 
iG≠
 = 0;

109027 
iG≠
 = 
iUµî
 - 
iLowî
;

109029 if–
roundUp
 ){

109030 
iG≠
 = (iGap*2)/3;

109032 
iG≠
 = iGap/3;

109034 
aSèt
[0] = 
iLowî
 + 
iG≠
;

109079 
	`whîeR™geSˇnE°
(

109080 
P¨£
 *
pP¨£
,

109081 
WhîeLo›Buûdî
 *
pBuûdî
,

109082 
WhîeTîm
 *
pLowî
,

109083 
WhîeTîm
 *
pUµî
,

109084 
WhîeLo›
 *
pLo›


109086 
rc
 = 
SQLITE_OK
;

109087 
nOut
 = 
pLo›
->nOut;

109088 
LogE°
 
nNew
;

109090 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


109091 
Index
 *
p
 = 
pLo›
->
u
.
båì
.
pIndex
;

109092 
nEq
 = 
pLo›
->
u
.
båì
.nEq;

109094 if–
p
->
nSam∂e
>0

109095 && 
nEq
==
pBuûdî
->
nRecVÆid


109096 && 
nEq
<
p
->
nSam∂eCﬁ


109097 && 
	`O±imiz©i⁄E«bÀd
(
pP¨£
->
db
, 
SQLITE_Sèt3
)

109099 
U≈ackedRec‹d
 *
pRec
 = 
pBuûdî
->pRec;

109100 
tRow˙t
 
a
[2];

109101 
u8
 
aff
;

109120 
tRow˙t
 
iLowî
;

109121 
tRow˙t
 
iUµî
;

109123 if–
nEq
==
p
->
nCﬁumn
 ){

109124 
aff
 = 
SQLITE_AFF_INTEGER
;

109126 
aff
 = 
p
->
pTabÀ
->
aCﬁ
[p->
aiCﬁumn
[
nEq
]].
afföôy
;

109129 if–
nEq
==0 ){

109130 
iLowî
 = 0;

109131 
iUµî
 = 
p
->
aiRowE°
[0];

109135 
	`whîeKeySèts
(
pP¨£
, 
p
, 
pRec
, 0, 
a
);

109136 
iLowî
 = 
a
[0];

109137 
iUµî
 = 
a
[0] +á[1];

109141 if–
pLowî
 ){

109142 
bOk
;

109143 
Ex¥
 *
pEx¥
 = 
pLowî
->pEx¥->
pRight
;

109144 
	`as£π
–(
pLowî
->
eO≥øt‹
 & (
WO_GT
|
WO_GE
))!=0 );

109145 
rc
 = 
	`sqlôe3Sèt4ProbeSëVÆue
(
pP¨£
, 
p
, &
pRec
, 
pEx¥
, 
aff
, 
nEq
, &
bOk
);

109146 if–
rc
==
SQLITE_OK
 && 
bOk
 ){

109147 
tRow˙t
 
iNew
;

109148 
	`whîeKeySèts
(
pP¨£
, 
p
, 
pRec
, 0, 
a
);

109149 
iNew
 = 
a
[0] + ((
pLowî
->
eO≥øt‹
 & 
WO_GT
) ?á[1] : 0);

109150 if–
iNew
>
iLowî
 ) iLower = iNew;

109151 
nOut
--;

109156 if–
pUµî
 ){

109157 
bOk
;

109158 
Ex¥
 *
pEx¥
 = 
pUµî
->pEx¥->
pRight
;

109159 
	`as£π
–(
pUµî
->
eO≥øt‹
 & (
WO_LT
|
WO_LE
))!=0 );

109160 
rc
 = 
	`sqlôe3Sèt4ProbeSëVÆue
(
pP¨£
, 
p
, &
pRec
, 
pEx¥
, 
aff
, 
nEq
, &
bOk
);

109161 if–
rc
==
SQLITE_OK
 && 
bOk
 ){

109162 
tRow˙t
 
iNew
;

109163 
	`whîeKeySèts
(
pP¨£
, 
p
, 
pRec
, 1, 
a
);

109164 
iNew
 = 
a
[0] + ((
pUµî
->
eO≥øt‹
 & 
WO_LE
) ?á[1] : 0);

109165 if–
iNew
<
iUµî
 ) iUpper = iNew;

109166 
nOut
--;

109170 
pBuûdî
->
pRec
 =ÖRec;

109171 if–
rc
==
SQLITE_OK
 ){

109172 if–
iUµî
>
iLowî
 ){

109173 
nNew
 = 
	`sqlôe3LogE°
(
iUµî
 - 
iLowî
);

109175 
nNew
 = 10; 
	`as£π
–10==
	`sqlôe3LogE°
(2) );

109177 if–
nNew
<
nOut
 ){

109178 
nOut
 = 
nNew
;

109180 
pLo›
->
nOut
 = (
LogE°
)nOut;

109181 
	`WHERETRACE
(0x100, ("range scanÑegions: %u..%uÉst=%d\n",

109182 (
u32
)
iLowî
, (u32)
iUµî
, 
nOut
));

109183  
SQLITE_OK
;

109187 
	`UNUSED_PARAMETER
(
pP¨£
);

109188 
	`UNUSED_PARAMETER
(
pBuûdî
);

109190 
	`as£π
–
pLowî
 || 
pUµî
 );

109193 
nNew
 = 
nOut
;

109194 if–
pLowî
 && (pLowî->
wtFœgs
 & 
TERM_VNULL
)==0 ){

109195 
nNew
 -20; 
	`as£π
–20==
	`sqlôe3LogE°
(4) );

109196 
nOut
--;

109198 if–
pUµî
 ){

109199 
nNew
 -20; 
	`as£π
–20==
	`sqlôe3LogE°
(4) );

109200 
nOut
--;

109202 if–
nNew
<10 )ÇNew = 10;

109203 if–
nNew
<
nOut
 )ÇOut =ÇNew;

109204 
pLo›
->
nOut
 = (
LogE°
)nOut;

109205  
rc
;

109208 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


109226 
	`whîeEquÆSˇnE°
(

109227 
P¨£
 *
pP¨£
,

109228 
WhîeLo›Buûdî
 *
pBuûdî
,

109229 
Ex¥
 *
pEx¥
,

109230 
tRow˙t
 *
≤Row


109232 
Index
 *
p
 = 
pBuûdî
->
pNew
->
u
.
båì
.
pIndex
;

109233 
nEq
 = 
pBuûdî
->
pNew
->
u
.
båì
.nEq;

109234 
U≈ackedRec‹d
 *
pRec
 = 
pBuûdî
->pRec;

109235 
u8
 
aff
;

109236 
rc
;

109237 
tRow˙t
 
a
[2];

109238 
bOk
;

109240 
	`as£π
–
nEq
>=1 );

109241 
	`as£π
–
nEq
<=(
p
->
nCﬁumn
+1) );

109242 
	`as£π
–
p
->
aSam∂e
!=0 );

109243 
	`as£π
–
p
->
nSam∂e
>0 );

109244 
	`as£π
–
pBuûdî
->
nRecVÆid
<
nEq
 );

109248 if–
pBuûdî
->
nRecVÆid
<(
nEq
-1) ){

109249  
SQLITE_NOTFOUND
;

109254 if–
nEq
>
p
->
nCﬁumn
 ){

109255 *
≤Row
 = 1;

109256  
SQLITE_OK
;

109259 
aff
 = 
p
->
pTabÀ
->
aCﬁ
[p->
aiCﬁumn
[
nEq
-1]].
afföôy
;

109260 
rc
 = 
	`sqlôe3Sèt4ProbeSëVÆue
(
pP¨£
, 
p
, &
pRec
, 
pEx¥
, 
aff
, 
nEq
-1, &
bOk
);

109261 
pBuûdî
->
pRec
 =ÖRec;

109262 if–
rc
!=
SQLITE_OK
 ) Ñc;

109263 if–
bOk
==0 )  
SQLITE_NOTFOUND
;

109264 
pBuûdî
->
nRecVÆid
 = 
nEq
;

109266 
	`whîeKeySèts
(
pP¨£
, 
p
, 
pRec
, 0, 
a
);

109267 
	`WHERETRACE
(0x100,("equÆôy sˇ¿ªgi⁄s: %d\n", ()
a
[1]));

109268 *
≤Row
 = 
a
[1];

109270  
rc
;

109274 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


109291 
	`whîeInSˇnE°
(

109292 
P¨£
 *
pP¨£
,

109293 
WhîeLo›Buûdî
 *
pBuûdî
,

109294 
Ex¥Li°
 *
pLi°
,

109295 
tRow˙t
 *
≤Row


109297 
Index
 *
p
 = 
pBuûdî
->
pNew
->
u
.
båì
.
pIndex
;

109298 
nRecVÆid
 = 
pBuûdî
->nRecValid;

109299 
rc
 = 
SQLITE_OK
;

109300 
tRow˙t
 
nE°
;

109301 
tRow˙t
 
nRowE°
 = 0;

109302 
i
;

109304 
	`as£π
–
p
->
aSam∂e
!=0 );

109305 
i
=0; 
rc
==
SQLITE_OK
 && i<
pLi°
->
nEx¥
; i++){

109306 
nE°
 = 
p
->
aiRowE°
[0];

109307 
rc
 = 
	`whîeEquÆSˇnE°
(
pP¨£
, 
pBuûdî
, 
pLi°
->
a
[
i
].
pEx¥
, &
nE°
);

109308 
nRowE°
 +
nE°
;

109309 
pBuûdî
->
nRecVÆid
 =ÇRecValid;

109312 if–
rc
==
SQLITE_OK
 ){

109313 if–
nRowE°
 > 
p
->
aiRowE°
[0] )ÇRowEst =Ö->aiRowEst[0];

109314 *
≤Row
 = 
nRowE°
;

109315 
	`WHERETRACE
(0x100,("INÑowÉ°im©e:É°=%g\n", 
nRowE°
));

109317 
	`as£π
–
pBuûdî
->
nRecVÆid
==nRecValid );

109318  
rc
;

109345 
	`dißbÀTîm
(
WhîeLevñ
 *
pLevñ
, 
WhîeTîm
 *
pTîm
){

109346 if–
pTîm


109347 && (
pTîm
->
wtFœgs
 & 
TERM_CODED
)==0

109348 && (
pLevñ
->
iLe·Joö
==0 || 
	`Ex¥HasPr›îty
(
pTîm
->
pEx¥
, 
EP_FromJoö
))

109349 && (
pLevñ
->
nŸRódy
 & 
pTîm
->
¥îeqAŒ
)==0

109351 
pTîm
->
wtFœgs
 |
TERM_CODED
;

109352 if–
pTîm
->
iP¨ít
>=0 ){

109353 
WhîeTîm
 *
pOthî
 = &
pTîm
->
pWC
->
a
[pTîm->
iP¨ít
];

109354 if–(--
pOthî
->
nChûd
)==0 ){

109355 
	`dißbÀTîm
(
pLevñ
, 
pOthî
);

109372 
	`codeAµlyAfföôy
(
P¨£
 *
pP¨£
, 
ba£
, 
n
, *
zAff
){

109373 
Vdbe
 *
v
 = 
pP¨£
->
pVdbe
;

109374 if–
zAff
==0 ){

109375 
	`as£π
–
pP¨£
->
db
->
mÆlocFaûed
 );

109378 
	`as£π
–
v
!=0 );

109383  
n
>0 && 
zAff
[0]==
SQLITE_AFF_NONE
 ){

109384 
n
--;

109385 
ba£
++;

109386 
zAff
++;

109388  
n
>1 && 
zAff
[n-1]==
SQLITE_AFF_NONE
 ){

109389 
n
--;

109393 if–
n
>0 ){

109394 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Afföôy
, 
ba£
, 
n
);

109395 
	`sqlôe3VdbeCh™geP4
(
v
, -1, 
zAff
, 
n
);

109396 
	`sqlôe3Ex¥CacheAfföôyCh™ge
(
pP¨£
, 
ba£
, 
n
);

109412 
	`codeEquÆôyTîm
(

109413 
P¨£
 *
pP¨£
,

109414 
WhîeTîm
 *
pTîm
,

109415 
WhîeLevñ
 *
pLevñ
,

109416 
iEq
,

109417 
bRev
,

109418 
iT¨gë


109420 
Ex¥
 *
pX
 = 
pTîm
->
pEx¥
;

109421 
Vdbe
 *
v
 = 
pP¨£
->
pVdbe
;

109422 
iReg
;

109424 
	`as£π
–
iT¨gë
>0 );

109425 if–
pX
->
›
==
TK_EQ
 ){

109426 
iReg
 = 
	`sqlôe3Ex¥CodeT¨gë
(
pP¨£
, 
pX
->
pRight
, 
iT¨gë
);

109427 }if–
pX
->
›
==
TK_ISNULL
 ){

109428 
iReg
 = 
iT¨gë
;

109429 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NuŒ
, 0, 
iReg
);

109430 #i‚de‡
SQLITE_OMIT_SUBQUERY


109432 
eTy≥
;

109433 
iTab
;

109434 
InLo›
 *
pIn
;

109435 
WhîeLo›
 *
pLo›
 = 
pLevñ
->
pWLo›
;

109437 if–(
pLo›
->
wsFœgs
 & 
WHERE_VIRTUALTABLE
)==0

109438 && 
pLo›
->
u
.
båì
.
pIndex
!=0

109439 && 
pLo›
->
u
.
båì
.
pIndex
->
aS‹tOrdî
[
iEq
]

109441 
	`ã°ˇ£
–
iEq
==0 );

109442 
	`ã°ˇ£
–
bRev
 );

109443 
bRev
 = !bRev;

109445 
	`as£π
–
pX
->
›
==
TK_IN
 );

109446 
iReg
 = 
iT¨gë
;

109447 
eTy≥
 = 
	`sqlôe3FödInIndex
(
pP¨£
, 
pX
, 0);

109448 if–
eTy≥
==
IN_INDEX_INDEX_DESC
 ){

109449 
	`ã°ˇ£
–
bRev
 );

109450 
bRev
 = !bRev;

109452 
iTab
 = 
pX
->
iTabÀ
;

109453 
	`sqlôe3VdbeAddOp2
(
v
, 
bRev
 ? 
OP_La°
 : 
OP_Rewöd
, 
iTab
, 0);

109454 
	`as£π
–(
pLo›
->
wsFœgs
 & 
WHERE_MULTI_OR
)==0 );

109455 
pLo›
->
wsFœgs
 |
WHERE_IN_ABLE
;

109456 if–
pLevñ
->
u
.
ö
.
nIn
==0 ){

109457 
pLevñ
->
addrNxt
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

109459 
pLevñ
->
u
.
ö
.
nIn
++;

109460 
pLevñ
->
u
.
ö
.
aInLo›
 =

109461 
	`sqlôe3DbRóŒocOrFªe
(
pP¨£
->
db
, 
pLevñ
->
u
.
ö
.
aInLo›
,

109462 (
pLevñ
->
u
.
ö
.
aInLo›
[0])*pLevñ->u.ö.
nIn
);

109463 
pIn
 = 
pLevñ
->
u
.
ö
.
aInLo›
;

109464 if–
pIn
 ){

109465 
pIn
 +
pLevñ
->
u
.
ö
.
nIn
 - 1;

109466 
pIn
->
iCur
 = 
iTab
;

109467 if–
eTy≥
==
IN_INDEX_ROWID
 ){

109468 
pIn
->
addrInT›
 = 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Rowid
, 
iTab
, 
iReg
);

109470 
pIn
->
addrInT›
 = 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Cﬁumn
, 
iTab
, 0, 
iReg
);

109472 
pIn
->
eEndLo›Op
 = 
bRev
 ? 
OP_Pªv
 : 
OP_Next
;

109473 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_IsNuŒ
, 
iReg
);

109475 
pLevñ
->
u
.
ö
.
nIn
 = 0;

109479 
	`dißbÀTîm
(
pLevñ
, 
pTîm
);

109480  
iReg
;

109522 
	`codeAŒEquÆôyTîms
(

109523 
P¨£
 *
pP¨£
,

109524 
WhîeLevñ
 *
pLevñ
,

109525 
bRev
,

109526 
nExåaReg
,

109527 **
pzAff


109529 
nEq
;

109530 
Vdbe
 *
v
 = 
pP¨£
->
pVdbe
;

109531 
Index
 *
pIdx
;

109532 
WhîeTîm
 *
pTîm
;

109533 
WhîeLo›
 *
pLo›
;

109534 
j
;

109535 
ªgBa£
;

109536 
nReg
;

109537 *
zAff
;

109540 
pLo›
 = 
pLevñ
->
pWLo›
;

109541 
	`as£π
–(
pLo›
->
wsFœgs
 & 
WHERE_VIRTUALTABLE
)==0 );

109542 
nEq
 = 
pLo›
->
u
.
båì
.nEq;

109543 
pIdx
 = 
pLo›
->
u
.
båì
.
pIndex
;

109544 
	`as£π
–
pIdx
!=0 );

109548 
ªgBa£
 = 
pP¨£
->
nMem
 + 1;

109549 
nReg
 = 
pLo›
->
u
.
båì
.
nEq
 + 
nExåaReg
;

109550 
pP¨£
->
nMem
 +
nReg
;

109552 
zAff
 = 
	`sqlôe3DbSåDup
(
pP¨£
->
db
, 
	`sqlôe3IndexAfföôySå
(
v
, 
pIdx
));

109553 if–!
zAff
 ){

109554 
pP¨£
->
db
->
mÆlocFaûed
 = 1;

109559 
	`as£π
–
zAff
==0 || ()
	`°æí
(zAff)>=
nEq
 );

109560 
j
=0; j<
nEq
; j++){

109561 
r1
;

109562 
pTîm
 = 
pLo›
->
aLTîm
[
j
];

109563 
	`as£π
–
pTîm
!=0 );

109566 
	`ã°ˇ£
–(
pTîm
->
wtFœgs
 & 
TERM_CODED
)!=0 );

109567 
	`ã°ˇ£
–
pTîm
->
wtFœgs
 & 
TERM_VIRTUAL
 );

109568 
r1
 = 
	`codeEquÆôyTîm
(
pP¨£
, 
pTîm
, 
pLevñ
, 
j
, 
bRev
, 
ªgBa£
+j);

109569 if–
r1
!=
ªgBa£
+
j
 ){

109570 if–
nReg
==1 ){

109571 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
ªgBa£
);

109572 
ªgBa£
 = 
r1
;

109574 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_SC›y
, 
r1
, 
ªgBa£
+
j
);

109577 
	`ã°ˇ£
–
pTîm
->
eO≥øt‹
 & 
WO_ISNULL
 );

109578 
	`ã°ˇ£
–
pTîm
->
eO≥øt‹
 & 
WO_IN
 );

109579 if–(
pTîm
->
eO≥øt‹
 & (
WO_ISNULL
|
WO_IN
))==0 ){

109580 
Ex¥
 *
pRight
 = 
pTîm
->
pEx¥
->pRight;

109581 
	`sqlôe3Ex¥CodeIsNuŒJump
(
v
, 
pRight
, 
ªgBa£
+
j
, 
pLevñ
->
addrBrk
);

109582 if–
zAff
 ){

109583 if–
	`sqlôe3Com∑ªAfföôy
(
pRight
, 
zAff
[
j
])==
SQLITE_AFF_NONE
 ){

109584 
zAff
[
j
] = 
SQLITE_AFF_NONE
;

109586 if–
	`sqlôe3Ex¥NìdsNoAfföôyCh™ge
(
pRight
, 
zAff
[
j
]) ){

109587 
zAff
[
j
] = 
SQLITE_AFF_NONE
;

109592 *
pzAff
 = 
zAff
;

109593  
ªgBa£
;

109596 #i‚de‡
SQLITE_OMIT_EXPLAIN


109605 
	`ex∂aöAµídTîm
(

109606 
SåAccum
 *
pSå
,

109607 
iTîm
,

109608 c⁄° *
zCﬁumn
,

109609 c⁄° *
zOp


109611 if–
iTîm
 ) 
	`sqlôe3SåAccumAµíd
(
pSå
, " AND ", 5);

109612 
	`sqlôe3SåAccumAµíd
(
pSå
, 
zCﬁumn
, -1);

109613 
	`sqlôe3SåAccumAµíd
(
pSå
, 
zOp
, 1);

109614 
	`sqlôe3SåAccumAµíd
(
pSå
, "?", 1);

109636 *
	`ex∂aöIndexR™ge
(
sqlôe3
 *
db
, 
WhîeLo›
 *
pLo›
, 
TabÀ
 *
pTab
){

109637 
Index
 *
pIndex
 = 
pLo›
->
u
.
båì
.pIndex;

109638 
nEq
 = 
pLo›
->
u
.
båì
.nEq;

109639 
i
, 
j
;

109640 
Cﬁumn
 *
aCﬁ
 = 
pTab
->aCol;

109641 *
aiCﬁumn
 = 
pIndex
->aiColumn;

109642 
SåAccum
 
txt
;

109644 if–
nEq
==0 && (
pLo›
->
wsFœgs
 & (
WHERE_BTM_LIMIT
|
WHERE_TOP_LIMIT
))==0 ){

109647 
	`sqlôe3SåAccumInô
(&
txt
, 0, 0, 
SQLITE_MAX_LENGTH
);

109648 
txt
.
db
 = db;

109649 
	`sqlôe3SåAccumAµíd
(&
txt
, " (", 2);

109650 
i
=0; i<
nEq
; i++){

109651 *
z
 = (
i
==
pIndex
->
nCﬁumn
 ) ? "rowid" : 
aCﬁ
[
aiCﬁumn
[i]].
zName
;

109652 
	`ex∂aöAµídTîm
(&
txt
, 
i
, 
z
, "=");

109655 
j
 = 
i
;

109656 if–
pLo›
->
wsFœgs
&
WHERE_BTM_LIMIT
 ){

109657 *
z
 = (
j
==
pIndex
->
nCﬁumn
 ) ? "rowid" : 
aCﬁ
[
aiCﬁumn
[j]].
zName
;

109658 
	`ex∂aöAµídTîm
(&
txt
, 
i
++, 
z
, ">");

109660 if–
pLo›
->
wsFœgs
&
WHERE_TOP_LIMIT
 ){

109661 *
z
 = (
j
==
pIndex
->
nCﬁumn
 ) ? "rowid" : 
aCﬁ
[
aiCﬁumn
[j]].
zName
;

109662 
	`ex∂aöAµídTîm
(&
txt
, 
i
, 
z
, "<");

109664 
	`sqlôe3SåAccumAµíd
(&
txt
, ")", 1);

109665  
	`sqlôe3SåAccumFöish
(&
txt
);

109674 
	`ex∂aöO√Sˇn
(

109675 
P¨£
 *
pP¨£
,

109676 
SrcLi°
 *
pTabLi°
,

109677 
WhîeLevñ
 *
pLevñ
,

109678 
iLevñ
,

109679 
iFrom
,

109680 
u16
 
w˘æFœgs


109682 if–
pP¨£
->
ex∂aö
==2 ){

109683 
SrcLi°_ôem
 *
pIãm
 = &
pTabLi°
->
a
[
pLevñ
->
iFrom
];

109684 
Vdbe
 *
v
 = 
pP¨£
->
pVdbe
;

109685 
sqlôe3
 *
db
 = 
pP¨£
->db;

109686 *
zMsg
;

109687 
iId
 = 
pP¨£
->
iSñe˘Id
;

109688 
isSórch
;

109689 
WhîeLo›
 *
pLo›
;

109690 
u32
 
Êags
;

109692 
pLo›
 = 
pLevñ
->
pWLo›
;

109693 
Êags
 = 
pLo›
->
wsFœgs
;

109694 if–(
Êags
&
WHERE_MULTI_OR
Ë|| (
w˘æFœgs
&
WHERE_ONETABLE_ONLY
) ) ;

109696 
isSórch
 = (
Êags
&(
WHERE_BTM_LIMIT
|
WHERE_TOP_LIMIT
))!=0

109697 || ((
Êags
&
WHERE_VIRTUALTABLE
)==0 && (
pLo›
->
u
.
båì
.
nEq
>0))

109698 || (
w˘æFœgs
&(
WHERE_ORDERBY_MIN
|
WHERE_ORDERBY_MAX
));

109700 
zMsg
 = 
	`sqlôe3MPrötf
(
db
, "%s", 
isSórch
?"SEARCH":"SCAN");

109701 if–
pIãm
->
pSñe˘
 ){

109702 
zMsg
 = 
	`sqlôe3MAµídf
(
db
, zMsg, "%†SUBQUERY %d", zMsg,
pIãm
->
iSñe˘Id
);

109704 
zMsg
 = 
	`sqlôe3MAµídf
(
db
, zMsg, "%†TABLE %s", zMsg, 
pIãm
->
zName
);

109707 if–
pIãm
->
zAlüs
 ){

109708 
zMsg
 = 
	`sqlôe3MAµídf
(
db
, zMsg, "%†AS %s", zMsg, 
pIãm
->
zAlüs
);

109710 if–(
Êags
 & (
WHERE_IPK
|
WHERE_VIRTUALTABLE
))==0

109711 && 
	`ALWAYS
(
pLo›
->
u
.
båì
.
pIndex
!=0)

109713 *
zWhîe
 = 
	`ex∂aöIndexR™ge
(
db
, 
pLo›
, 
pIãm
->
pTab
);

109714 
zMsg
 = 
	`sqlôe3MAµídf
(
db
, zMsg,

109715 ((
Êags
 & 
WHERE_AUTO_INDEX
) ?

109718 
zMsg
, ((
Êags
 & 
WHERE_IDX_ONLY
) ? "COVERING " : ""),

109719 
pLo›
->
u
.
båì
.
pIndex
->
zName
, 
zWhîe
);

109720 
	`sqlôe3DbFªe
(
db
, 
zWhîe
);

109721 }if–(
Êags
 & 
WHERE_IPK
)!=0 && (Êag†& 
WHERE_CONSTRAINT
)!=0 ){

109722 
zMsg
 = 
	`sqlôe3MAµídf
(
db
, zMsg, "%s USING INTEGER PRIMARY KEY", zMsg);

109724 if–
Êags
&(
WHERE_COLUMN_EQ
|
WHERE_COLUMN_IN
) ){

109725 
zMsg
 = 
	`sqlôe3MAµídf
(
db
, zMsg, "%s (rowid=?)", zMsg);

109726 }if–(
Êags
&
WHERE_BOTH_LIMIT
)==WHERE_BOTH_LIMIT ){

109727 
zMsg
 = 
	`sqlôe3MAµídf
(
db
, zMsg, "%s (rowid>? ANDÑowid<?)", zMsg);

109728 }if–
Êags
&
WHERE_BTM_LIMIT
 ){

109729 
zMsg
 = 
	`sqlôe3MAµídf
(
db
, zMsg, "%s (rowid>?)", zMsg);

109730 }if–
	`ALWAYS
(
Êags
&
WHERE_TOP_LIMIT
) ){

109731 
zMsg
 = 
	`sqlôe3MAµídf
(
db
, zMsg, "%s (rowid<?)", zMsg);

109734 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


109735 if–(
Êags
 & 
WHERE_VIRTUALTABLE
)!=0 ){

109736 
zMsg
 = 
	`sqlôe3MAµídf
(
db
, zMsg, "%s VIRTUAL TABLE INDEX %d:%s", zMsg,

109737 
pLo›
->
u
.
vèb
.
idxNum
,ÖLo›->u.vèb.
idxSå
);

109740 
zMsg
 = 
	`sqlôe3MAµídf
(
db
, zMsg, "%s", zMsg);

109741 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_Ex∂aö
, 
iId
, 
iLevñ
, 
iFrom
, 
zMsg
, 
P4_DYNAMIC
);

109745 
	#ex∂aöO√Sˇn
(
u
,
v
,
w
,
x
,
y
,
z
)

	)

109753 
Bômask
 
	`codeO√Lo›Sèπ
(

109754 
WhîeInfo
 *
pWInfo
,

109755 
iLevñ
,

109756 
Bômask
 
nŸRódy


109758 
j
, 
k
;

109759 
iCur
;

109760 
addrNxt
;

109761 
omôTabÀ
;

109762 
bRev
;

109763 
WhîeLevñ
 *
pLevñ
;

109764 
WhîeLo›
 *
pLo›
;

109765 
WhîeCœu£
 *
pWC
;

109766 
WhîeTîm
 *
pTîm
;

109767 
P¨£
 *
pP¨£
;

109768 
sqlôe3
 *
db
;

109769 
Vdbe
 *
v
;

109770 
SrcLi°_ôem
 *
pTabIãm
;

109771 
addrBrk
;

109772 
addrC⁄t
;

109773 
iRowidReg
 = 0;

109774 
iRñó£Reg
 = 0;

109776 
pP¨£
 = 
pWInfo
->pParse;

109777 
v
 = 
pP¨£
->
pVdbe
;

109778 
pWC
 = &
pWInfo
->
sWC
;

109779 
db
 = 
pP¨£
->db;

109780 
pLevñ
 = &
pWInfo
->
a
[
iLevñ
];

109781 
pLo›
 = 
pLevñ
->
pWLo›
;

109782 
pTabIãm
 = &
pWInfo
->
pTabLi°
->
a
[
pLevñ
->
iFrom
];

109783 
iCur
 = 
pTabIãm
->
iCurs‹
;

109784 
pLevñ
->
nŸRódy
 =ÇŸRódy & ~
	`gëMask
(&
pWInfo
->
sMaskSë
, 
iCur
);

109785 
bRev
 = (
pWInfo
->
ªvMask
>>
iLevñ
)&1;

109786 
omôTabÀ
 = (
pLo›
->
wsFœgs
 & 
WHERE_IDX_ONLY
)!=0

109787 && (
pWInfo
->
w˘æFœgs
 & 
WHERE_FORCE_TABLE
)==0;

109788 
	`VdbeNo›Commít
((
v
, "Begö Joö Lo› %d", 
iLevñ
));

109800 
addrBrk
 = 
pLevñ
->addrBrk =ÖLevñ->
addrNxt
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

109801 
addrC⁄t
 = 
pLevñ
->addrC⁄à
	`sqlôe3VdbeMakeLabñ
(
v
);

109807 if–
pLevñ
->
iFrom
>0 && (
pTabIãm
[0].
joöty≥
 & 
JT_LEFT
)!=0 ){

109808 
pLevñ
->
iLe·Joö
 = ++
pP¨£
->
nMem
;

109809 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 0, 
pLevñ
->
iLe·Joö
);

109810 
	`VdbeCommít
((
v
, "init LEFT JOINÇo-match flag"));

109814 if–
pTabIãm
->
vüC‹outöe
 ){

109815 
ªgYõld
 = 
pTabIãm
->
ªgRëu∫
;

109816 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 
pTabIãm
->
addrFûlSub
-1, 
ªgYõld
);

109817 
pLevñ
->
p2
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Yõld
, 
ªgYõld
);

109818 
	`VdbeCommít
((
v
, "√xàrow o‡co-routöê%s", 
pTabIãm
->
pTab
->
zName
));

109819 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_If
, 
ªgYõld
+1, 
addrBrk
);

109820 
pLevñ
->
›
 = 
OP_GŸo
;

109823 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


109824 if–(
pLo›
->
wsFœgs
 & 
WHERE_VIRTUALTABLE
)!=0 ){

109828 
iReg
;

109829 
addrNŸFound
;

109830 
nC⁄°øöt
 = 
pLo›
->
nLTîm
;

109832 
	`sqlôe3Ex¥CachePush
(
pP¨£
);

109833 
iReg
 = 
	`sqlôe3GëTempR™ge
(
pP¨£
, 
nC⁄°øöt
+2);

109834 
addrNŸFound
 = 
pLevñ
->
addrBrk
;

109835 
j
=0; j<
nC⁄°øöt
; j++){

109836 
iT¨gë
 = 
iReg
+
j
+2;

109837 
pTîm
 = 
pLo›
->
aLTîm
[
j
];

109838 if–
pTîm
==0 ) ;

109839 if–
pTîm
->
eO≥øt‹
 & 
WO_IN
 ){

109840 
	`codeEquÆôyTîm
(
pP¨£
, 
pTîm
, 
pLevñ
, 
j
, 
bRev
, 
iT¨gë
);

109841 
addrNŸFound
 = 
pLevñ
->
addrNxt
;

109843 
	`sqlôe3Ex¥Code
(
pP¨£
, 
pTîm
->
pEx¥
->
pRight
, 
iT¨gë
);

109846 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 
pLo›
->
u
.
vèb
.
idxNum
, 
iReg
);

109847 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 
nC⁄°øöt
, 
iReg
+1);

109848 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_VFûãr
, 
iCur
, 
addrNŸFound
, 
iReg
,

109849 
pLo›
->
u
.
vèb
.
idxSå
,

109850 
pLo›
->
u
.
vèb
.
√edFªe
 ? 
P4_MPRINTF
 : 
P4_STATIC
);

109851 
pLo›
->
u
.
vèb
.
√edFªe
 = 0;

109852 
j
=0; j<
nC⁄°øöt
 && j<16; j++){

109853 if–(
pLo›
->
u
.
vèb
.
omôMask
>>
j
)&1 ){

109854 
	`dißbÀTîm
(
pLevñ
, 
pLo›
->
aLTîm
[
j
]);

109857 
pLevñ
->
›
 = 
OP_VNext
;

109858 
pLevñ
->
p1
 = 
iCur
;

109859 
pLevñ
->
p2
 = 
	`sqlôe3VdbeCuºítAddr
(
v
);

109860 
	`sqlôe3Rñó£TempR™ge
(
pP¨£
, 
iReg
, 
nC⁄°øöt
+2);

109861 
	`sqlôe3Ex¥CacheP›
(
pP¨£
, 1);

109865 if–(
pLo›
->
wsFœgs
 & 
WHERE_IPK
)!=0

109866 && (
pLo›
->
wsFœgs
 & (
WHERE_COLUMN_IN
|
WHERE_COLUMN_EQ
))!=0

109873 
	`as£π
–
pLo›
->
u
.
båì
.
nEq
==1 );

109874 
iRñó£Reg
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

109875 
pTîm
 = 
pLo›
->
aLTîm
[0];

109876 
	`as£π
–
pTîm
!=0 );

109877 
	`as£π
–
pTîm
->
pEx¥
!=0 );

109878 
	`as£π
–
omôTabÀ
==0 );

109879 
	`ã°ˇ£
–
pTîm
->
wtFœgs
 & 
TERM_VIRTUAL
 );

109880 
iRowidReg
 = 
	`codeEquÆôyTîm
(
pP¨£
, 
pTîm
, 
pLevñ
, 0, 
bRev
, 
iRñó£Reg
);

109881 
addrNxt
 = 
pLevñ
->addrNxt;

109882 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Mu°BeI¡
, 
iRowidReg
, 
addrNxt
);

109883 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_NŸExi°s
, 
iCur
, 
addrNxt
, 
iRowidReg
);

109884 
	`sqlôe3Ex¥CacheAfföôyCh™ge
(
pP¨£
, 
iRowidReg
, 1);

109885 
	`sqlôe3Ex¥CacheSt‹e
(
pP¨£
, 
iCur
, -1, 
iRowidReg
);

109886 
	`VdbeCommít
((
v
, "pk"));

109887 
pLevñ
->
›
 = 
OP_No›
;

109888 }if–(
pLo›
->
wsFœgs
 & 
WHERE_IPK
)!=0

109889 && (
pLo›
->
wsFœgs
 & 
WHERE_COLUMN_RANGE
)!=0

109893 
ã°Op
 = 
OP_No›
;

109894 
°¨t
;

109895 
memEndVÆue
 = 0;

109896 
WhîeTîm
 *
pSèπ
, *
pEnd
;

109898 
	`as£π
–
omôTabÀ
==0 );

109899 
j
 = 0;

109900 
pSèπ
 = 
pEnd
 = 0;

109901 if–
pLo›
->
wsFœgs
 & 
WHERE_BTM_LIMIT
 ) 
pSèπ
 =ÖLo›->
aLTîm
[
j
++];

109902 if–
pLo›
->
wsFœgs
 & 
WHERE_TOP_LIMIT
 ) 
pEnd
 =ÖLo›->
aLTîm
[
j
++];

109903 
	`as£π
–
pSèπ
!=0 || 
pEnd
!=0 );

109904 if–
bRev
 ){

109905 
pTîm
 = 
pSèπ
;

109906 
pSèπ
 = 
pEnd
;

109907 
pEnd
 = 
pTîm
;

109909 if–
pSèπ
 ){

109910 
Ex¥
 *
pX
;

109911 
r1
, 
rTemp
;

109916 c⁄° 
u8
 
aMoveOp
[] = {

109917  
OP_SìkGt
,

109918  
OP_SìkLe
,

109919  
OP_SìkLt
,

109920  
OP_SìkGe


109922 
	`as£π
–
TK_LE
==
TK_GT
+1 );

109923 
	`as£π
–
TK_LT
==
TK_GT
+2 );

109924 
	`as£π
–
TK_GE
==
TK_GT
+3 );

109926 
	`as£π
–(
pSèπ
->
wtFœgs
 & 
TERM_VNULL
)==0 );

109927 
	`ã°ˇ£
–
pSèπ
->
wtFœgs
 & 
TERM_VIRTUAL
 );

109928 
pX
 = 
pSèπ
->
pEx¥
;

109929 
	`as£π
–
pX
!=0 );

109930 
	`ã°ˇ£
–
pSèπ
->
À·Curs‹
!=
iCur
 );

109931 
r1
 = 
	`sqlôe3Ex¥CodeTemp
(
pP¨£
, 
pX
->
pRight
, &
rTemp
);

109932 
	`sqlôe3VdbeAddOp3
(
v
, 
aMoveOp
[
pX
->
›
-
TK_GT
], 
iCur
, 
addrBrk
, 
r1
);

109933 
	`VdbeCommít
((
v
, "pk"));

109934 
	`sqlôe3Ex¥CacheAfföôyCh™ge
(
pP¨£
, 
r1
, 1);

109935 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
rTemp
);

109936 
	`dißbÀTîm
(
pLevñ
, 
pSèπ
);

109938 
	`sqlôe3VdbeAddOp2
(
v
, 
bRev
 ? 
OP_La°
 : 
OP_Rewöd
, 
iCur
, 
addrBrk
);

109940 if–
pEnd
 ){

109941 
Ex¥
 *
pX
;

109942 
pX
 = 
pEnd
->
pEx¥
;

109943 
	`as£π
–
pX
!=0 );

109944 
	`as£π
–(
pEnd
->
wtFœgs
 & 
TERM_VNULL
)==0 );

109945 
	`ã°ˇ£
–
pEnd
->
À·Curs‹
!=
iCur
 );

109946 
	`ã°ˇ£
–
pEnd
->
wtFœgs
 & 
TERM_VIRTUAL
 );

109947 
memEndVÆue
 = ++
pP¨£
->
nMem
;

109948 
	`sqlôe3Ex¥Code
(
pP¨£
, 
pX
->
pRight
, 
memEndVÆue
);

109949 if–
pX
->
›
==
TK_LT
 ||ÖX->›==
TK_GT
 ){

109950 
ã°Op
 = 
bRev
 ? 
OP_Le
 : 
OP_Ge
;

109952 
ã°Op
 = 
bRev
 ? 
OP_Lt
 : 
OP_Gt
;

109954 
	`dißbÀTîm
(
pLevñ
, 
pEnd
);

109956 
°¨t
 = 
	`sqlôe3VdbeCuºítAddr
(
v
);

109957 
pLevñ
->
›
 = 
bRev
 ? 
OP_Pªv
 : 
OP_Next
;

109958 
pLevñ
->
p1
 = 
iCur
;

109959 
pLevñ
->
p2
 = 
°¨t
;

109960 
	`as£π
–
pLevñ
->
p5
==0 );

109961 if–
ã°Op
!=
OP_No›
 ){

109962 
iRowidReg
 = 
iRñó£Reg
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

109963 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Rowid
, 
iCur
, 
iRowidReg
);

109964 
	`sqlôe3Ex¥CacheSt‹e
(
pP¨£
, 
iCur
, -1, 
iRowidReg
);

109965 
	`sqlôe3VdbeAddOp3
(
v
, 
ã°Op
, 
memEndVÆue
, 
addrBrk
, 
iRowidReg
);

109966 
	`sqlôe3VdbeCh™geP5
(
v
, 
SQLITE_AFF_NUMERIC
 | 
SQLITE_JUMPIFNULL
);

109968 }if–
pLo›
->
wsFœgs
 & 
WHERE_INDEXED
 ){

110000 c⁄° 
u8
 
aSèπOp
[] = {

110003 
OP_Rewöd
,

110004 
OP_La°
,

110005 
OP_SìkGt
,

110006 
OP_SìkLt
,

110007 
OP_SìkGe
,

110008 
OP_SìkLe


110010 c⁄° 
u8
 
aEndOp
[] = {

110011 
OP_No›
,

110012 
OP_IdxGE
,

110013 
OP_IdxLT


110015 
nEq
 = 
pLo›
->
u
.
båì
.nEq;

110016 
isMöQuîy
 = 0;

110017 
ªgBa£
;

110018 
r1
;

110019 
WhîeTîm
 *
pR™geSèπ
 = 0;

110020 
WhîeTîm
 *
pR™geEnd
 = 0;

110021 
°¨tEq
;

110022 
ídEq
;

110023 
°¨t_c⁄°øöts
;

110024 
nC⁄°øöt
;

110025 
Index
 *
pIdx
;

110026 
iIdxCur
;

110027 
nExåaReg
 = 0;

110028 
›
;

110029 *
zSèπAff
;

110030 *
zEndAff
;

110032 
pIdx
 = 
pLo›
->
u
.
båì
.
pIndex
;

110033 
iIdxCur
 = 
pLevñ
->iIdxCur;

110043 if–(
pWInfo
->
w˘æFœgs
&
WHERE_ORDERBY_MIN
)!=0

110044 && (
pWInfo
->
bOBS©
!=0)

110045 && (
pIdx
->
nCﬁumn
>
nEq
)

110049 
isMöQuîy
 = 1;

110050 
nExåaReg
 = 1;

110056 
j
 = 
nEq
;

110057 if–
pLo›
->
wsFœgs
 & 
WHERE_BTM_LIMIT
 ){

110058 
pR™geSèπ
 = 
pLo›
->
aLTîm
[
j
++];

110059 
nExåaReg
 = 1;

110061 if–
pLo›
->
wsFœgs
 & 
WHERE_TOP_LIMIT
 ){

110062 
pR™geEnd
 = 
pLo›
->
aLTîm
[
j
++];

110063 
nExåaReg
 = 1;

110070 
ªgBa£
 = 
	`codeAŒEquÆôyTîms
(
pP¨£
,
pLevñ
,
bRev
,
nExåaReg
,&
zSèπAff
);

110071 
zEndAff
 = 
	`sqlôe3DbSåDup
(
db
, 
zSèπAff
);

110072 
addrNxt
 = 
pLevñ
->addrNxt;

110078 if–(
nEq
<
pIdx
->
nCﬁumn
 && 
bRev
==’Idx->
aS‹tOrdî
[nEq]==
SQLITE_SO_ASC
))

110079 || (
bRev
 && 
pIdx
->
nCﬁumn
==
nEq
)

110081 
	`SWAP
(
WhîeTîm
 *, 
pR™geEnd
, 
pR™geSèπ
);

110084 
	`ã°ˇ£
–
pR™geSèπ
 && (pR™geSèπ->
eO≥øt‹
 & 
WO_LE
)!=0 );

110085 
	`ã°ˇ£
–
pR™geSèπ
 && (pR™geSèπ->
eO≥øt‹
 & 
WO_GE
)!=0 );

110086 
	`ã°ˇ£
–
pR™geEnd
 && (pR™geEnd->
eO≥øt‹
 & 
WO_LE
)!=0 );

110087 
	`ã°ˇ£
–
pR™geEnd
 && (pR™geEnd->
eO≥øt‹
 & 
WO_GE
)!=0 );

110088 
°¨tEq
 = !
pR™geSèπ
 ||ÖR™geSèπ->
eO≥øt‹
 & (
WO_LE
|
WO_GE
);

110089 
ídEq
 = !
pR™geEnd
 ||ÖR™geEnd->
eO≥øt‹
 & (
WO_LE
|
WO_GE
);

110090 
°¨t_c⁄°øöts
 = 
pR™geSèπ
 || 
nEq
>0;

110093 
nC⁄°øöt
 = 
nEq
;

110094 if–
pR™geSèπ
 ){

110095 
Ex¥
 *
pRight
 = 
pR™geSèπ
->
pEx¥
->pRight;

110096 
	`sqlôe3Ex¥Code
(
pP¨£
, 
pRight
, 
ªgBa£
+
nEq
);

110097 if–(
pR™geSèπ
->
wtFœgs
 & 
TERM_VNULL
)==0 ){

110098 
	`sqlôe3Ex¥CodeIsNuŒJump
(
v
, 
pRight
, 
ªgBa£
+
nEq
, 
addrNxt
);

110100 if–
zSèπAff
 ){

110101 if–
	`sqlôe3Com∑ªAfföôy
(
pRight
, 
zSèπAff
[
nEq
])==
SQLITE_AFF_NONE
){

110105 
zSèπAff
[
nEq
] = 
SQLITE_AFF_NONE
;

110107 if–
	`sqlôe3Ex¥NìdsNoAfföôyCh™ge
(
pRight
, 
zSèπAff
[
nEq
]) ){

110108 
zSèπAff
[
nEq
] = 
SQLITE_AFF_NONE
;

110111 
nC⁄°øöt
++;

110112 
	`ã°ˇ£
–
pR™geSèπ
->
wtFœgs
 & 
TERM_VIRTUAL
 );

110113 }if–
isMöQuîy
 ){

110114 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NuŒ
, 0, 
ªgBa£
+
nEq
);

110115 
nC⁄°øöt
++;

110116 
°¨tEq
 = 0;

110117 
°¨t_c⁄°øöts
 = 1;

110119 
	`codeAµlyAfföôy
(
pP¨£
, 
ªgBa£
, 
nC⁄°øöt
, 
zSèπAff
);

110120 
›
 = 
aSèπOp
[(
°¨t_c⁄°øöts
<<2Ë+ (
°¨tEq
<<1Ë+ 
bRev
];

110121 
	`as£π
–
›
!=0 );

110122 
	`ã°ˇ£
–
›
==
OP_Rewöd
 );

110123 
	`ã°ˇ£
–
›
==
OP_La°
 );

110124 
	`ã°ˇ£
–
›
==
OP_SìkGt
 );

110125 
	`ã°ˇ£
–
›
==
OP_SìkGe
 );

110126 
	`ã°ˇ£
–
›
==
OP_SìkLe
 );

110127 
	`ã°ˇ£
–
›
==
OP_SìkLt
 );

110128 
	`sqlôe3VdbeAddOp4I¡
(
v
, 
›
, 
iIdxCur
, 
addrNxt
, 
ªgBa£
, 
nC⁄°øöt
);

110133 
nC⁄°øöt
 = 
nEq
;

110134 if–
pR™geEnd
 ){

110135 
Ex¥
 *
pRight
 = 
pR™geEnd
->
pEx¥
->pRight;

110136 
	`sqlôe3Ex¥CacheRemove
(
pP¨£
, 
ªgBa£
+
nEq
, 1);

110137 
	`sqlôe3Ex¥Code
(
pP¨£
, 
pRight
, 
ªgBa£
+
nEq
);

110138 if–(
pR™geEnd
->
wtFœgs
 & 
TERM_VNULL
)==0 ){

110139 
	`sqlôe3Ex¥CodeIsNuŒJump
(
v
, 
pRight
, 
ªgBa£
+
nEq
, 
addrNxt
);

110141 if–
zEndAff
 ){

110142 if–
	`sqlôe3Com∑ªAfföôy
(
pRight
, 
zEndAff
[
nEq
])==
SQLITE_AFF_NONE
){

110146 
zEndAff
[
nEq
] = 
SQLITE_AFF_NONE
;

110148 if–
	`sqlôe3Ex¥NìdsNoAfföôyCh™ge
(
pRight
, 
zEndAff
[
nEq
]) ){

110149 
zEndAff
[
nEq
] = 
SQLITE_AFF_NONE
;

110152 
	`codeAµlyAfföôy
(
pP¨£
, 
ªgBa£
, 
nEq
+1, 
zEndAff
);

110153 
nC⁄°øöt
++;

110154 
	`ã°ˇ£
–
pR™geEnd
->
wtFœgs
 & 
TERM_VIRTUAL
 );

110156 
	`sqlôe3DbFªe
(
db
, 
zSèπAff
);

110157 
	`sqlôe3DbFªe
(
db
, 
zEndAff
);

110160 
pLevñ
->
p2
 = 
	`sqlôe3VdbeCuºítAddr
(
v
);

110163 
›
 = 
aEndOp
[(
pR™geEnd
 || 
nEq
Ë* (1 + 
bRev
)];

110164 
	`ã°ˇ£
–
›
==
OP_No›
 );

110165 
	`ã°ˇ£
–
›
==
OP_IdxGE
 );

110166 
	`ã°ˇ£
–
›
==
OP_IdxLT
 );

110167 if–
›
!=
OP_No›
 ){

110168 
	`sqlôe3VdbeAddOp4I¡
(
v
, 
›
, 
iIdxCur
, 
addrNxt
, 
ªgBa£
, 
nC⁄°øöt
);

110169 
	`sqlôe3VdbeCh™geP5
(
v
, 
ídEq
!=
bRev
 ?1:0);

110176 
r1
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

110177 
	`ã°ˇ£
–
pLo›
->
wsFœgs
 & 
WHERE_BTM_LIMIT
 );

110178 
	`ã°ˇ£
–
pLo›
->
wsFœgs
 & 
WHERE_TOP_LIMIT
 );

110179 if–(
pLo›
->
wsFœgs
 & (
WHERE_BTM_LIMIT
|
WHERE_TOP_LIMIT
))!=0 ){

110180 
	`sqlôe3VdbeAddOp3
(
v
, 
OP_Cﬁumn
, 
iIdxCur
, 
nEq
, 
r1
);

110181 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_IsNuŒ
, 
r1
, 
addrC⁄t
);

110183 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
r1
);

110186 
	`dißbÀTîm
(
pLevñ
, 
pR™geSèπ
);

110187 
	`dißbÀTîm
(
pLevñ
, 
pR™geEnd
);

110188 if–!
omôTabÀ
 ){

110189 
iRowidReg
 = 
iRñó£Reg
 = 
	`sqlôe3GëTempReg
(
pP¨£
);

110190 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_IdxRowid
, 
iIdxCur
, 
iRowidReg
);

110191 
	`sqlôe3Ex¥CacheSt‹e
(
pP¨£
, 
iCur
, -1, 
iRowidReg
);

110192 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Sìk
, 
iCur
, 
iRowidReg
);

110198 if–
pLo›
->
wsFœgs
 & 
WHERE_ONEROW
 ){

110199 
pLevñ
->
›
 = 
OP_No›
;

110200 }if–
bRev
 ){

110201 
pLevñ
->
›
 = 
OP_Pªv
;

110203 
pLevñ
->
›
 = 
OP_Next
;

110205 
pLevñ
->
p1
 = 
iIdxCur
;

110206 if–(
pLo›
->
wsFœgs
 & 
WHERE_CONSTRAINT
)==0 ){

110207 
pLevñ
->
p5
 = 
SQLITE_STMTSTATUS_FULLSCAN_STEP
;

110209 
	`as£π
–
pLevñ
->
p5
==0 );

110213 #i‚de‡
SQLITE_OMIT_OR_OPTIMIZATION


110214 if–
pLo›
->
wsFœgs
 & 
WHERE_MULTI_OR
 ){

110254 
WhîeCœu£
 *
pOrWc
;

110255 
SrcLi°
 *
pOrTab
;

110256 
Index
 *
pCov
 = 0;

110257 
iCovCur
 = 
pP¨£
->
nTab
++;

110259 
ªgRëu∫
 = ++
pP¨£
->
nMem
;

110260 
ªgRow£t
 = 0;

110261 
ªgRowid
 = 0;

110262 
iLo›Body
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

110263 
iRëInô
;

110264 
u¡e°edTîms
 = 0;

110265 
ii
;

110266 
Ex¥
 *
pAndEx¥
 = 0;

110268 
pTîm
 = 
pLo›
->
aLTîm
[0];

110269 
	`as£π
–
pTîm
!=0 );

110270 
	`as£π
–
pTîm
->
eO≥øt‹
 & 
WO_OR
 );

110271 
	`as£π
–(
pTîm
->
wtFœgs
 & 
TERM_ORINFO
)!=0 );

110272 
pOrWc
 = &
pTîm
->
u
.
pOrInfo
->
wc
;

110273 
pLevñ
->
›
 = 
OP_Rëu∫
;

110274 
pLevñ
->
p1
 = 
ªgRëu∫
;

110280 if–
pWInfo
->
nLevñ
>1 ){

110281 
nNŸRódy
;

110282 
SrcLi°_ôem
 *
‹igSrc
;

110283 
nNŸRódy
 = 
pWInfo
->
nLevñ
 - 
iLevñ
 - 1;

110284 
pOrTab
 = 
	`sqlôe3SèckAŒocRaw
(
db
,

110285 (*
pOrTab
)+ 
nNŸRódy
*’OrTab->
a
[0]));

110286 if–
pOrTab
==0 )  
nŸRódy
;

110287 
pOrTab
->
nAŒoc
 = (
u8
)(
nNŸRódy
 + 1);

110288 
pOrTab
->
nSrc
 =ÖOrTab->
nAŒoc
;

110289 
	`mem˝y
(
pOrTab
->
a
, 
pTabIãm
, (*pTabItem));

110290 
‹igSrc
 = 
pWInfo
->
pTabLi°
->
a
;

110291 
k
=1; k<=
nNŸRódy
; k++){

110292 
	`mem˝y
(&
pOrTab
->
a
[
k
], &
‹igSrc
[
pLevñ
[k].
iFrom
], (pOrTab->a[k]));

110295 
pOrTab
 = 
pWInfo
->
pTabLi°
;

110309 if–(
pWInfo
->
w˘æFœgs
 & 
WHERE_DUPLICATES_OK
)==0 ){

110310 
ªgRow£t
 = ++
pP¨£
->
nMem
;

110311 
ªgRowid
 = ++
pP¨£
->
nMem
;

110312 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_NuŒ
, 0, 
ªgRow£t
);

110314 
iRëInô
 = 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 0, 
ªgRëu∫
);

110330 if–
pWC
->
nTîm
>1 ){

110331 
iTîm
;

110332 
iTîm
=0; iTîm<
pWC
->
nTîm
; iTerm++){

110333 
Ex¥
 *
pEx¥
 = 
pWC
->
a
[
iTîm
].pExpr;

110334 if–&
pWC
->
a
[
iTîm
] =
pTîm
 ) ;

110335 if–
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_FromJoö
) ) ;

110336 if–
pWC
->
a
[
iTîm
].
wtFœgs
 & (
TERM_ORINFO
) ) ;

110337 if–(
pWC
->
a
[
iTîm
].
eO≥øt‹
 & 
WO_ALL
)==0 ) ;

110338 
pEx¥
 = 
	`sqlôe3Ex¥Dup
(
db
,ÖExpr, 0);

110339 
pAndEx¥
 = 
	`sqlôe3Ex¥And
(
db
,ÖAndEx¥, 
pEx¥
);

110341 if–
pAndEx¥
 ){

110342 
pAndEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_AND
, 0,ÖAndExpr, 0);

110346 
ii
=0; ii<
pOrWc
->
nTîm
; ii++){

110347 
WhîeTîm
 *
pOrTîm
 = &
pOrWc
->
a
[
ii
];

110348 if–
pOrTîm
->
À·Curs‹
==
iCur
 || (pOrTîm->
eO≥øt‹
 & 
WO_AND
)!=0 ){

110349 
WhîeInfo
 *
pSubWInfo
;

110350 
Ex¥
 *
pOrEx¥
 = 
pOrTîm
->
pEx¥
;

110351 if–
pAndEx¥
 && !
	`Ex¥HasPr›îty
(
pOrEx¥
, 
EP_FromJoö
) ){

110352 
pAndEx¥
->
pLe·
 = 
pOrEx¥
;

110353 
pOrEx¥
 = 
pAndEx¥
;

110356 
pSubWInfo
 = 
	`sqlôe3WhîeBegö
(
pP¨£
, 
pOrTab
, 
pOrEx¥
, 0, 0,

110357 
WHERE_OMIT_OPEN_CLOSE
 | 
WHERE_AND_ONLY
 |

110358 
WHERE_FORCE_TABLE
 | 
WHERE_ONETABLE_ONLY
, 
iCovCur
);

110359 
	`as£π
–
pSubWInfo
 || 
pP¨£
->
nEº
 || 
db
->
mÆlocFaûed
 );

110360 if–
pSubWInfo
 ){

110361 
WhîeLo›
 *
pSubLo›
;

110362 
	`ex∂aöO√Sˇn
(

110363 
pP¨£
, 
pOrTab
, &
pSubWInfo
->
a
[0], 
iLevñ
, 
pLevñ
->
iFrom
, 0

110365 if–(
pWInfo
->
w˘æFœgs
 & 
WHERE_DUPLICATES_OK
)==0 ){

110366 
iSë
 = ((
ii
==
pOrWc
->
nTîm
-1)?-1:ii);

110367 
r
;

110368 
r
 = 
	`sqlôe3Ex¥CodeGëCﬁumn
(
pP¨£
, 
pTabIãm
->
pTab
, -1, 
iCur
,

110369 
ªgRowid
, 0);

110370 
	`sqlôe3VdbeAddOp4I¡
(
v
, 
OP_RowSëTe°
, 
ªgRow£t
,

110371 
	`sqlôe3VdbeCuºítAddr
(
v
)+2, 
r
, 
iSë
);

110373 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Gosub
, 
ªgRëu∫
, 
iLo›Body
);

110380 if–
pSubWInfo
->
u¡e°edTîms
 ) untestedTerms = 1;

110394 
pSubLo›
 = 
pSubWInfo
->
a
[0].
pWLo›
;

110395 
	`as£π
–(
pSubLo›
->
wsFœgs
 & 
WHERE_AUTO_INDEX
)==0 );

110396 if–(
pSubLo›
->
wsFœgs
 & 
WHERE_INDEXED
)!=0

110397 && (
ii
==0 || 
pSubLo›
->
u
.
båì
.
pIndex
==
pCov
)

110399 
	`as£π
–
pSubWInfo
->
a
[0].
iIdxCur
==
iCovCur
 );

110400 
pCov
 = 
pSubLo›
->
u
.
båì
.
pIndex
;

110402 
pCov
 = 0;

110406 
	`sqlôe3WhîeEnd
(
pSubWInfo
);

110410 
pLevñ
->
u
.
pCovidx
 = 
pCov
;

110411 if–
pCov
 ) 
pLevñ
->
iIdxCur
 = 
iCovCur
;

110412 if–
pAndEx¥
 ){

110413 
pAndEx¥
->
pLe·
 = 0;

110414 
	`sqlôe3Ex¥Dñëe
(
db
, 
pAndEx¥
);

110416 
	`sqlôe3VdbeCh™geP1
(
v
, 
iRëInô
, 
	`sqlôe3VdbeCuºítAddr
(v));

110417 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_GŸo
, 0, 
pLevñ
->
addrBrk
);

110418 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
iLo›Body
);

110420 if–
pWInfo
->
nLevñ
>1 ) 
	`sqlôe3SèckFªe
(
db
, 
pOrTab
);

110421 if–!
u¡e°edTîms
 ) 
	`dißbÀTîm
(
pLevñ
, 
pTîm
);

110429 c⁄° 
u8
 
aSãp
[] = { 
OP_Next
, 
OP_Pªv
 };

110430 c⁄° 
u8
 
aSèπ
[] = { 
OP_Rewöd
, 
OP_La°
 };

110431 
	`as£π
–
bRev
==0 || bRev==1 );

110432 
pLevñ
->
›
 = 
aSãp
[
bRev
];

110433 
pLevñ
->
p1
 = 
iCur
;

110434 
pLevñ
->
p2
 = 1 + 
	`sqlôe3VdbeAddOp2
(
v
, 
aSèπ
[
bRev
], 
iCur
, 
addrBrk
);

110435 
pLevñ
->
p5
 = 
SQLITE_STMTSTATUS_FULLSCAN_STEP
;

110441 
pTîm
=
pWC
->
a
, 
j
ıWC->
nTîm
; j>0; j--,ÖTerm++){

110442 
Ex¥
 *
pE
;

110443 
	`ã°ˇ£
–
pTîm
->
wtFœgs
 & 
TERM_VIRTUAL
 );

110444 
	`ã°ˇ£
–
pTîm
->
wtFœgs
 & 
TERM_CODED
 );

110445 if–
pTîm
->
wtFœgs
 & (
TERM_VIRTUAL
|
TERM_CODED
) ) ;

110446 if–(
pTîm
->
¥îeqAŒ
 & 
pLevñ
->
nŸRódy
)!=0 ){

110447 
	`ã°ˇ£
–
pWInfo
->
u¡e°edTîms
==0

110448 && (
pWInfo
->
w˘æFœgs
 & 
WHERE_ONETABLE_ONLY
)!=0 );

110449 
pWInfo
->
u¡e°edTîms
 = 1;

110452 
pE
 = 
pTîm
->
pEx¥
;

110453 
	`as£π
–
pE
!=0 );

110454 if–
pLevñ
->
iLe·Joö
 && !
	`Ex¥HasPr›îty
(
pE
, 
EP_FromJoö
) ){

110457 
	`sqlôe3Ex¥IfFÆ£
(
pP¨£
, 
pE
, 
addrC⁄t
, 
SQLITE_JUMPIFNULL
);

110458 
pTîm
->
wtFœgs
 |
TERM_CODED
;

110469 
pTîm
=
pWC
->
a
, 
j
ıWC->
nTîm
; j>0; j--,ÖTerm++){

110470 
Ex¥
 *
pE
, *
pEA…
;

110471 
WhîeTîm
 *
pA…
;

110472 if–
pTîm
->
wtFœgs
 & (
TERM_VIRTUAL
|
TERM_CODED
) ) ;

110473 if–
pTîm
->
eO≥øt‹
!=(
WO_EQUIV
|
WO_EQ
) ) ;

110474 if–
pTîm
->
À·Curs‹
!=
iCur
 ) ;

110475 if–
pLevñ
->
iLe·Joö
 ) ;

110476 
pE
 = 
pTîm
->
pEx¥
;

110477 
	`as£π
–!
	`Ex¥HasPr›îty
(
pE
, 
EP_FromJoö
) );

110478 
	`as£π
–(
pTîm
->
¥îeqRight
 & 
pLevñ
->
nŸRódy
)!=0 );

110479 
pA…
 = 
	`födTîm
(
pWC
, 
iCur
, 
pTîm
->
u
.
À·Cﬁumn
, 
nŸRódy
, 
WO_EQ
|
WO_IN
, 0);

110480 if–
pA…
==0 ) ;

110481 if–
pA…
->
wtFœgs
 & (
TERM_CODED
) ) ;

110482 
	`ã°ˇ£
–
pA…
->
eO≥øt‹
 & 
WO_EQ
 );

110483 
	`ã°ˇ£
–
pA…
->
eO≥øt‹
 & 
WO_IN
 );

110484 
	`VdbeNo›Commít
((
v
, "beginÅransitive constraint"));

110485 
pEA…
 = 
	`sqlôe3SèckAŒocRaw
(
db
, (*pEAlt));

110486 if–
pEA…
 ){

110487 *
pEA…
 = *
pA…
->
pEx¥
;

110488 
pEA…
->
pLe·
 = 
pE
->pLeft;

110489 
	`sqlôe3Ex¥IfFÆ£
(
pP¨£
, 
pEA…
, 
addrC⁄t
, 
SQLITE_JUMPIFNULL
);

110490 
	`sqlôe3SèckFªe
(
db
, 
pEA…
);

110497 if–
pLevñ
->
iLe·Joö
 ){

110498 
pLevñ
->
addrFú°
 = 
	`sqlôe3VdbeCuºítAddr
(
v
);

110499 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_I¡egî
, 1, 
pLevñ
->
iLe·Joö
);

110500 
	`VdbeCommít
((
v
, "record LEFT JOIN hit"));

110501 
	`sqlôe3Ex¥CacheCÀ¨
(
pP¨£
);

110502 
pTîm
=
pWC
->
a
, 
j
=0; j<pWC->
nTîm
; j++,ÖTerm++){

110503 
	`ã°ˇ£
–
pTîm
->
wtFœgs
 & 
TERM_VIRTUAL
 );

110504 
	`ã°ˇ£
–
pTîm
->
wtFœgs
 & 
TERM_CODED
 );

110505 if–
pTîm
->
wtFœgs
 & (
TERM_VIRTUAL
|
TERM_CODED
) ) ;

110506 if–(
pTîm
->
¥îeqAŒ
 & 
pLevñ
->
nŸRódy
)!=0 ){

110507 
	`as£π
–
pWInfo
->
u¡e°edTîms
 );

110510 
	`as£π
–
pTîm
->
pEx¥
 );

110511 
	`sqlôe3Ex¥IfFÆ£
(
pP¨£
, 
pTîm
->
pEx¥
, 
addrC⁄t
, 
SQLITE_JUMPIFNULL
);

110512 
pTîm
->
wtFœgs
 |
TERM_CODED
;

110515 
	`sqlôe3Rñó£TempReg
(
pP¨£
, 
iRñó£Reg
);

110517  
pLevñ
->
nŸRódy
;

110520 #ifde‡
WHERETRACE_ENABLED


110524 
	`whîeLo›Pröt
(
WhîeLo›
 *
p
, 
SrcLi°
 *
pTabLi°
){

110525 
nb
 = 1+(
pTabLi°
->
nSrc
+7)/8;

110526 
SrcLi°_ôem
 *
pIãm
 = 
pTabLi°
->
a
 + 
p
->
iTab
;

110527 
TabÀ
 *
pTab
 = 
pIãm
->pTab;

110528 
	`sqlôe3DebugPrötf
("%c%2d.%0*Œx.%0*Œx", 
p
->
cId
,

110529 
p
->
iTab
, 
nb
,Ö->
maskSñf
,Çb,Ö->
¥îeq
);

110530 
	`sqlôe3DebugPrötf
(" %12s",

110531 
pIãm
->
zAlüs
 ?ÖIãm->zAlü†: 
pTab
->
zName
);

110532 if–(
p
->
wsFœgs
 & 
WHERE_VIRTUALTABLE
)==0 ){

110533 if–
p
->
u
.
båì
.
pIndex
 ){

110534 c⁄° *
zName
 = 
p
->
u
.
båì
.
pIndex
->zName;

110535 if–
zName
==0 ) zName = "ipk";

110536 if–
	`°∫cmp
(
zName
, "sqlite_autoindex_", 17)==0 ){

110537 
i
 = 
	`sqlôe3SåÀn30
(
zName
) - 1;

110538  
zName
[
i
]!='_' ) i--;

110539 
zName
 +
i
;

110541 
	`sqlôe3DebugPrötf
(".%-16†%2d", 
zName
, 
p
->
u
.
båì
.
nEq
);

110543 
	`sqlôe3DebugPrötf
("%20s","");

110546 *
z
;

110547 if–
p
->
u
.
vèb
.
idxSå
 ){

110548 
z
 = 
	`sqlôe3_m¥ötf
("(%d,\"%s\",%x)",

110549 
p
->
u
.
vèb
.
idxNum
,Ö->u.vèb.
idxSå
,Ö->u.vèb.
omôMask
);

110551 
z
 = 
	`sqlôe3_m¥ötf
("(%d,%x)", 
p
->
u
.
vèb
.
idxNum
,Ö->u.vèb.
omôMask
);

110553 
	`sqlôe3DebugPrötf
(" %-19s", 
z
);

110554 
	`sqlôe3_‰ì
(
z
);

110556 
	`sqlôe3DebugPrötf
(" f %04x N %d", 
p
->
wsFœgs
,Ö->
nLTîm
);

110557 
	`sqlôe3DebugPrötf
(" co° %d,%d,%d\n", 
p
->
rSëup
,Ö->
rRun
,Ö->
nOut
);

110565 
	`whîeLo›Inô
(
WhîeLo›
 *
p
){

110566 
p
->
aLTîm
 =Ö->
aLTîmS∑˚
;

110567 
p
->
nLTîm
 = 0;

110568 
p
->
nLSlŸ
 = 
	`AºaySize
’->
aLTîmS∑˚
);

110569 
p
->
wsFœgs
 = 0;

110575 
	`whîeLo›CÀ¨Uni⁄
(
sqlôe3
 *
db
, 
WhîeLo›
 *
p
){

110576 if–
p
->
wsFœgs
 & (
WHERE_VIRTUALTABLE
|
WHERE_AUTO_INDEX
) ){

110577 if–(
p
->
wsFœgs
 & 
WHERE_VIRTUALTABLE
)!=0 &&Ö->
u
.
vèb
.
√edFªe
 ){

110578 
	`sqlôe3_‰ì
(
p
->
u
.
vèb
.
idxSå
);

110579 
p
->
u
.
vèb
.
√edFªe
 = 0;

110580 
p
->
u
.
vèb
.
idxSå
 = 0;

110581 }if–(
p
->
wsFœgs
 & 
WHERE_AUTO_INDEX
)!=0 &&Ö->
u
.
båì
.
pIndex
!=0 ){

110582 
	`sqlôe3DbFªe
(
db
, 
p
->
u
.
båì
.
pIndex
->
zCﬁAff
);

110583 
	`sqlôe3DbFªe
(
db
, 
p
->
u
.
båì
.
pIndex
);

110584 
p
->
u
.
båì
.
pIndex
 = 0;

110592 
	`whîeLo›CÀ¨
(
sqlôe3
 *
db
, 
WhîeLo›
 *
p
){

110593 if–
p
->
aLTîm
!ı->
aLTîmS∑˚
 ) 
	`sqlôe3DbFªe
(
db
,Ö->aLTerm);

110594 
	`whîeLo›CÀ¨Uni⁄
(
db
, 
p
);

110595 
	`whîeLo›Inô
(
p
);

110601 
	`whîeLo›Resize
(
sqlôe3
 *
db
, 
WhîeLo›
 *
p
, 
n
){

110602 
WhîeTîm
 **
∑New
;

110603 if–
p
->
nLSlŸ
>=
n
 )  
SQLITE_OK
;

110604 
n
 = (n+7)&~7;

110605 
∑New
 = 
	`sqlôe3DbMÆlocRaw
(
db
, (
p
->
aLTîm
[0])*
n
);

110606 if–
∑New
==0 )  
SQLITE_NOMEM
;

110607 
	`mem˝y
(
∑New
, 
p
->
aLTîm
, ’->aLTîm[0])*p->
nLSlŸ
);

110608 if–
p
->
aLTîm
!ı->
aLTîmS∑˚
 ) 
	`sqlôe3DbFªe
(
db
,Ö->aLTerm);

110609 
p
->
aLTîm
 = 
∑New
;

110610 
p
->
nLSlŸ
 = 
n
;

110611  
SQLITE_OK
;

110617 
	`whîeLo›X„r
(
sqlôe3
 *
db
, 
WhîeLo›
 *
pTo
, WhîeLo› *
pFrom
){

110618 
	`whîeLo›CÀ¨Uni⁄
(
db
, 
pTo
);

110619 if–
	`whîeLo›Resize
(
db
, 
pTo
, 
pFrom
->
nLTîm
) ){

110620 
	`mem£t
(&
pTo
->
u
, 0, (pTo->u));

110621  
SQLITE_NOMEM
;

110623 
	`mem˝y
(
pTo
, 
pFrom
, 
WHERE_LOOP_XFER_SZ
);

110624 
	`mem˝y
(
pTo
->
aLTîm
, 
pFrom
->aLTîm,ÖTo->
nLTîm
*(pTo->aLTerm[0]));

110625 if–
pFrom
->
wsFœgs
 & 
WHERE_VIRTUALTABLE
 ){

110626 
pFrom
->
u
.
vèb
.
√edFªe
 = 0;

110627 }if–(
pFrom
->
wsFœgs
 & 
WHERE_AUTO_INDEX
)!=0 ){

110628 
pFrom
->
u
.
båì
.
pIndex
 = 0;

110630  
SQLITE_OK
;

110636 
	`whîeLo›Dñëe
(
sqlôe3
 *
db
, 
WhîeLo›
 *
p
){

110637 
	`whîeLo›CÀ¨
(
db
, 
p
);

110638 
	`sqlôe3DbFªe
(
db
, 
p
);

110644 
	`whîeInfoFªe
(
sqlôe3
 *
db
, 
WhîeInfo
 *
pWInfo
){

110645 if–
	`ALWAYS
(
pWInfo
) ){

110646 
	`whîeCœu£CÀ¨
(&
pWInfo
->
sWC
);

110647  
pWInfo
->
pLo›s
 ){

110648 
WhîeLo›
 *
p
 = 
pWInfo
->
pLo›s
;

110649 
pWInfo
->
pLo›s
 = 
p
->
pNextLo›
;

110650 
	`whîeLo›Dñëe
(
db
, 
p
);

110652 
	`sqlôe3DbFªe
(
db
, 
pWInfo
);

110682 
	`whîeLo›In£π
(
WhîeLo›Buûdî
 *
pBuûdî
, 
WhîeLo›
 *
pTem∂©e
){

110683 
WhîeLo›
 **
µPªv
, *
p
, *
pNext
 = 0;

110684 
WhîeInfo
 *
pWInfo
 = 
pBuûdî
->pWInfo;

110685 
sqlôe3
 *
db
 = 
pWInfo
->
pP¨£
->db;

110690 if–
pBuûdî
->
pOrSë
!=0 ){

110691 #i‡
WHERETRACE_ENABLED


110692 
u16
 
n
 = 
pBuûdî
->
pOrSë
->n;

110693 
x
 =

110695 
	`whîeOrIn£π
(
pBuûdî
->
pOrSë
, 
pTem∂©e
->
¥îeq
,ÖTem∂©e->
rRun
,

110696 
pTem∂©e
->
nOut
);

110697 #i‡
WHERETRACE_ENABLED


110698 if–
sqlôe3WhîeTø˚
 & 0x8 ){

110699 
	`sqlôe3DebugPrötf
(
x
?" or-%d: ":" or-X: ", 
n
);

110700 
	`whîeLo›Pröt
(
pTem∂©e
, 
pWInfo
->
pTabLi°
);

110703  
SQLITE_OK
;

110709 
µPªv
=&
pWInfo
->
pLo›s
, 
p
=*µPªv;Ö;ÖpPªv=&p->
pNextLo›
,Ö=*ppPrev){

110710 if–
p
->
iTab
!=
pTem∂©e
->iTab ||Ö->
iS‹tIdx
!=pTemplate->iSortIdx ){

110719 
	`as£π
–
p
->
rSëup
==0 || 
pTem∂©e
->rSetup==0

110720 || 
p
->
rSëup
==
pTem∂©e
->rSetup );

110725 
	`as£π
–
p
->
rSëup
>=
pTem∂©e
->rSetup );

110727 if–(
p
->
¥îeq
 & 
pTem∂©e
->prereq)==p->prereq

110728 && 
p
->
rSëup
<=
pTem∂©e
->rSetup

110729 && 
p
->
rRun
<=
pTem∂©e
->rRun

110730 && 
p
->
nOut
<=
pTem∂©e
->nOut

110735 
	`as£π
–
p
->
rSëup
==
pTem∂©e
->rSetup );

110736 if–
p
->
¥îeq
==
pTem∂©e
->prereq

110737 && 
p
->
nLTîm
<
pTem∂©e
->nLTerm

110738 && (
p
->
wsFœgs
 & 
pTem∂©e
->wsFœg†& 
WHERE_INDEXED
)!=0

110739 && (
p
->
u
.
båì
.
pIndex
==
pTem∂©e
->u.btree.pIndex

110740 || 
pTem∂©e
->
rRun
+
p
->
nLTîm
<=p->rRun+pTemplate->nLTerm)

110744 
pNext
 = 
p
->
pNextLo›
;

110749 
whîeLo›In£π_no›
;

110752 if–(
p
->
¥îeq
 & 
pTem∂©e
->prereq)==pTemplate->prereq

110753 && 
p
->
rRun
>=
pTem∂©e
->rRun

110754 && 
p
->
nOut
>=
pTem∂©e
->nOut

110760 
	`as£π
–
p
->
rSëup
>=
pTem∂©e
->rSetup );

110761 
pNext
 = 
p
->
pNextLo›
;

110770 #i‡
WHERETRACE_ENABLED


110771 if–
sqlôe3WhîeTø˚
 & 0x8 ){

110772 if–
p
!=0 ){

110773 
	`sqlôe3DebugPrötf
("ins-del: ");

110774 
	`whîeLo›Pröt
(
p
, 
pWInfo
->
pTabLi°
);

110776 
	`sqlôe3DebugPrötf
("ins-new: ");

110777 
	`whîeLo›Pröt
(
pTem∂©e
, 
pWInfo
->
pTabLi°
);

110780 if–
p
==0 ){

110781 
p
 = 
	`sqlôe3DbMÆlocRaw
(
db
, (
WhîeLo›
));

110782 if–
p
==0 )  
SQLITE_NOMEM
;

110783 
	`whîeLo›Inô
(
p
);

110785 
	`whîeLo›X„r
(
db
, 
p
, 
pTem∂©e
);

110786 
p
->
pNextLo›
 = 
pNext
;

110787 *
µPªv
 = 
p
;

110788 if–(
p
->
wsFœgs
 & 
WHERE_VIRTUALTABLE
)==0 ){

110789 
Index
 *
pIndex
 = 
p
->
u
.
båì
.pIndex;

110790 if–
pIndex
 &&ÖIndex->
äum
==0 ){

110791 
p
->
u
.
båì
.
pIndex
 = 0;

110794  
SQLITE_OK
;

110797 
whîeLo›In£π_no›
:

110798 #i‡
WHERETRACE_ENABLED


110799 if–
sqlôe3WhîeTø˚
 & 0x8 ){

110800 
	`sqlôe3DebugPrötf
("ins-noop: ");

110801 
	`whîeLo›Pröt
(
pTem∂©e
, 
pWInfo
->
pTabLi°
);

110804  
SQLITE_OK
;

110816 
	`whîeLo›OuçutAdju°
(
WhîeCœu£
 *
pWC
, 
WhîeLo›
 *
pLo›
){

110817 
WhîeTîm
 *
pTîm
, *
pX
;

110818 
Bômask
 
nŸAŒowed
 = ~(
pLo›
->
¥îeq
|pLo›->
maskSñf
);

110819 
i
, 
j
;

110821 if–!
	`O±imiz©i⁄E«bÀd
(
pWC
->
pWInfo
->
pP¨£
->
db
, 
SQLITE_Adju°OutE°
) ){

110824 
i
=
pWC
->
nTîm
, 
pTîm
ıWC->
a
; i>0; i--,ÖTerm++){

110825 if–(
pTîm
->
wtFœgs
 & 
TERM_VIRTUAL
)!=0 ) ;

110826 if–(
pTîm
->
¥îeqAŒ
 & 
pLo›
->
maskSñf
)==0 ) ;

110827 if–(
pTîm
->
¥îeqAŒ
 & 
nŸAŒowed
)!=0 ) ;

110828 
j
=
pLo›
->
nLTîm
-1; j>=0; j--){

110829 
pX
 = 
pLo›
->
aLTîm
[
j
];

110830 if–
pX
==
pTîm
 ) ;

110831 if–
pX
->
iP¨ít
>=0 && (&
pWC
->
a
[pX->iP¨ít])==
pTîm
 ) ;

110833 if–
j
<0 ) 
pLo›
->
nOut
 +
pTîm
->
åuthProb
;

110844 
	`whîeLo›AddBåìIndex
(

110845 
WhîeLo›Buûdî
 *
pBuûdî
,

110846 
SrcLi°_ôem
 *
pSrc
,

110847 
Index
 *
pProbe
,

110848 
LogE°
 
nInMul


110850 
WhîeInfo
 *
pWInfo
 = 
pBuûdî
->pWInfo;

110851 
P¨£
 *
pP¨£
 = 
pWInfo
->pParse;

110852 
sqlôe3
 *
db
 = 
pP¨£
->db;

110853 
WhîeLo›
 *
pNew
;

110854 
WhîeTîm
 *
pTîm
;

110855 
›Mask
;

110856 
WhîeSˇn
 
sˇn
;

110857 
Bômask
 
ßved_¥îeq
;

110858 
u16
 
ßved_nLTîm
;

110859 
ßved_nEq
;

110860 
u32
 
ßved_wsFœgs
;

110861 
LogE°
 
ßved_nOut
;

110862 
iCﬁ
;

110863 
rc
 = 
SQLITE_OK
;

110864 
LogE°
 
nRowE°
;

110865 
LogE°
 
rLogSize
;

110866 
WhîeTîm
 *
pT›
 = 0, *
pBtm
 = 0;

110868 
pNew
 = 
pBuûdî
->pNew;

110869 if–
db
->
mÆlocFaûed
 )  
SQLITE_NOMEM
;

110871 
	`as£π
–(
pNew
->
wsFœgs
 & 
WHERE_VIRTUALTABLE
)==0 );

110872 
	`as£π
–(
pNew
->
wsFœgs
 & 
WHERE_TOP_LIMIT
)==0 );

110873 if–
pNew
->
wsFœgs
 & 
WHERE_BTM_LIMIT
 ){

110874 
›Mask
 = 
WO_LT
|
WO_LE
;

110875 }if–
pProbe
->
äum
<=0 || (
pSrc
->
joöty≥
 & 
JT_LEFT
)!=0 ){

110876 
›Mask
 = 
WO_EQ
|
WO_IN
|
WO_GT
|
WO_GE
|
WO_LT
|
WO_LE
;

110878 
›Mask
 = 
WO_EQ
|
WO_IN
|
WO_ISNULL
|
WO_GT
|
WO_GE
|
WO_LT
|
WO_LE
;

110880 if–
pProbe
->
bUn‹dîed
 ) 
›Mask
 &~(
WO_GT
|
WO_GE
|
WO_LT
|
WO_LE
);

110882 
	`as£π
–
pNew
->
u
.
båì
.
nEq
<=
pProbe
->
nCﬁumn
 );

110883 if–
pNew
->
u
.
båì
.
nEq
 < 
pProbe
->
nCﬁumn
 ){

110884 
iCﬁ
 = 
pProbe
->
aiCﬁumn
[
pNew
->
u
.
båì
.
nEq
];

110885 
nRowE°
 = 
	`sqlôe3LogE°
(
pProbe
->
aiRowE°
[
pNew
->
u
.
båì
.
nEq
+1]);

110886 if–
nRowE°
==0 && 
pProbe
->
⁄Eº‹
==
OE_N⁄e
 )ÇRowEst = 1;

110888 
iCﬁ
 = -1;

110889 
nRowE°
 = 0;

110891 
pTîm
 = 
	`whîeSˇnInô
(&
sˇn
, 
pBuûdî
->
pWC
, 
pSrc
->
iCurs‹
, 
iCﬁ
,

110892 
›Mask
, 
pProbe
);

110893 
ßved_nEq
 = 
pNew
->
u
.
båì
.
nEq
;

110894 
ßved_nLTîm
 = 
pNew
->
nLTîm
;

110895 
ßved_wsFœgs
 = 
pNew
->
wsFœgs
;

110896 
ßved_¥îeq
 = 
pNew
->
¥îeq
;

110897 
ßved_nOut
 = 
pNew
->
nOut
;

110898 
pNew
->
rSëup
 = 0;

110899 
rLogSize
 = 
	`e°Log
(
	`sqlôe3LogE°
(
pProbe
->
aiRowE°
[0]));

110900 ; 
rc
==
SQLITE_OK
 && 
pTîm
!=0;ÖTîm = 
	`whîeSˇnNext
(&
sˇn
)){

110901 
nIn
 = 0;

110902 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


110903 
nRecVÆid
 = 
pBuûdî
->nRecValid;

110905 if–(
pTîm
->
eO≥øt‹
==
WO_ISNULL
 || (pTîm->
wtFœgs
&
TERM_VNULL
)!=0)

110906 && (
iCﬁ
<0 || 
pSrc
->
pTab
->
aCﬁ
[iCﬁ].
nŸNuŒ
)

110910 if–
pTîm
->
¥îeqRight
 & 
pNew
->
maskSñf
 ) ;

110912 
	`as£π
–
pNew
->
nOut
==
ßved_nOut
 );

110914 
pNew
->
wsFœgs
 = 
ßved_wsFœgs
;

110915 
pNew
->
u
.
båì
.
nEq
 = 
ßved_nEq
;

110916 
pNew
->
nLTîm
 = 
ßved_nLTîm
;

110917 if–
	`whîeLo›Resize
(
db
, 
pNew
,ÖNew->
nLTîm
+1) ) ;

110918 
pNew
->
aLTîm
[pNew->
nLTîm
++] = 
pTîm
;

110919 
pNew
->
¥îeq
 = (
ßved_¥îeq
 | 
pTîm
->
¥îeqRight
Ë& ~pNew->
maskSñf
;

110920 
pNew
->
rRun
 = 
rLogSize
;

110921 if–
pTîm
->
eO≥øt‹
 & 
WO_IN
 ){

110922 
Ex¥
 *
pEx¥
 = 
pTîm
->pExpr;

110923 
pNew
->
wsFœgs
 |
WHERE_COLUMN_IN
;

110924 if–
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_xIsSñe˘
) ){

110926 
nIn
 = 46; 
	`as£π
–46==
	`sqlôe3LogE°
(25) );

110927 }if–
	`ALWAYS
(
pEx¥
->
x
.
pLi°
 &&ÖEx¥->x.pLi°->
nEx¥
) ){

110929 
nIn
 = 
	`sqlôe3LogE°
(
pEx¥
->
x
.
pLi°
->
nEx¥
);

110931 
pNew
->
rRun
 +
nIn
;

110932 
pNew
->
u
.
båì
.
nEq
++;

110933 
pNew
->
nOut
 = 
nRowE°
 + 
nInMul
 + 
nIn
;

110934 }if–
pTîm
->
eO≥øt‹
 & (
WO_EQ
) ){

110935 
	`as£π
–(
pNew
->
wsFœgs
 & (
WHERE_COLUMN_NULL
|
WHERE_COLUMN_IN
))!=0

110936 || 
nInMul
==0 );

110937 
pNew
->
wsFœgs
 |
WHERE_COLUMN_EQ
;

110938 if–
iCﬁ
<0

110939 || (
pProbe
->
⁄Eº‹
!=
OE_N⁄e
 && 
nInMul
==0

110940 && 
pNew
->
u
.
båì
.
nEq
==
pProbe
->
nCﬁumn
-1)

110942 
	`as£π
–(
pNew
->
wsFœgs
 & 
WHERE_COLUMN_IN
)==0 || 
iCﬁ
<0 );

110943 
pNew
->
wsFœgs
 |
WHERE_ONEROW
;

110945 
pNew
->
u
.
båì
.
nEq
++;

110946 
pNew
->
nOut
 = 
nRowE°
 + 
nInMul
;

110947 }if–
pTîm
->
eO≥øt‹
 & (
WO_ISNULL
) ){

110948 
pNew
->
wsFœgs
 |
WHERE_COLUMN_NULL
;

110949 
pNew
->
u
.
båì
.
nEq
++;

110951 
nIn
 = 10; 
	`as£π
–10==
	`sqlôe3LogE°
(2) );

110952 
pNew
->
nOut
 = 
nRowE°
 + 
nInMul
 + 
nIn
;

110953 }if–
pTîm
->
eO≥øt‹
 & (
WO_GT
|
WO_GE
) ){

110954 
	`ã°ˇ£
–
pTîm
->
eO≥øt‹
 & 
WO_GT
 );

110955 
	`ã°ˇ£
–
pTîm
->
eO≥øt‹
 & 
WO_GE
 );

110956 
pNew
->
wsFœgs
 |
WHERE_COLUMN_RANGE
|
WHERE_BTM_LIMIT
;

110957 
pBtm
 = 
pTîm
;

110958 
pT›
 = 0;

110960 
	`as£π
–
pTîm
->
eO≥øt‹
 & (
WO_LT
|
WO_LE
) );

110961 
	`ã°ˇ£
–
pTîm
->
eO≥øt‹
 & 
WO_LT
 );

110962 
	`ã°ˇ£
–
pTîm
->
eO≥øt‹
 & 
WO_LE
 );

110963 
pNew
->
wsFœgs
 |
WHERE_COLUMN_RANGE
|
WHERE_TOP_LIMIT
;

110964 
pT›
 = 
pTîm
;

110965 
pBtm
 = (
pNew
->
wsFœgs
 & 
WHERE_BTM_LIMIT
)!=0 ?

110966 
pNew
->
aLTîm
[pNew->
nLTîm
-2] : 0;

110968 if–
pNew
->
wsFœgs
 & 
WHERE_COLUMN_RANGE
 ){

110970 
	`as£π
–
pNew
->
nOut
==
ßved_nOut
 );

110971 
	`whîeR™geSˇnE°
(
pP¨£
, 
pBuûdî
, 
pBtm
, 
pT›
, 
pNew
);

110973 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


110974 if–
nInMul
==0

110975 && 
pProbe
->
nSam∂e


110976 && 
pNew
->
u
.
båì
.
nEq
<=
pProbe
->
nSam∂eCﬁ


110977 && 
	`O±imiz©i⁄E«bÀd
(
db
, 
SQLITE_Sèt3
)

110979 
Ex¥
 *
pEx¥
 = 
pTîm
->pExpr;

110980 
tRow˙t
 
nOut
 = 0;

110981 if–(
pTîm
->
eO≥øt‹
 & (
WO_EQ
|
WO_ISNULL
))!=0 ){

110982 
	`ã°ˇ£
–
pTîm
->
eO≥øt‹
 & 
WO_EQ
 );

110983 
	`ã°ˇ£
–
pTîm
->
eO≥øt‹
 & 
WO_ISNULL
 );

110984 
rc
 = 
	`whîeEquÆSˇnE°
(
pP¨£
, 
pBuûdî
, 
pEx¥
->
pRight
, &
nOut
);

110985 }if–(
pTîm
->
eO≥øt‹
 & 
WO_IN
)

110986 && !
	`Ex¥HasPr›îty
(
pEx¥
, 
EP_xIsSñe˘
) ){

110987 
rc
 = 
	`whîeInSˇnE°
(
pP¨£
, 
pBuûdî
, 
pEx¥
->
x
.
pLi°
, &
nOut
);

110989 
	`as£π
–
nOut
==0 || 
rc
==
SQLITE_OK
 );

110990 if–
nOut
 ){

110991 
pNew
->
nOut
 = 
	`sqlôe3LogE°
(nOut);

110992 if–
pNew
->
nOut
>
ßved_nOut
 )ÖNew->nOut = saved_nOut;

110996 if–(
pNew
->
wsFœgs
 & (
WHERE_IDX_ONLY
|
WHERE_IPK
))==0 ){

110999 
pNew
->
rRun
 = 
	`sqlôe3LogE°Add
’New->rRun,
rLogSize
>27 ?ÑLogSize-17 : 10);

111002 
pNew
->
rRun
 = 
	`sqlôe3LogE°Add
’New->rRun,ÖNew->
nOut
);

111003 
	`whîeLo›OuçutAdju°
(
pBuûdî
->
pWC
, 
pNew
);

111004 
rc
 = 
	`whîeLo›In£π
(
pBuûdî
, 
pNew
);

111005 if–(
pNew
->
wsFœgs
 & 
WHERE_TOP_LIMIT
)==0

111006 && 
pNew
->
u
.
båì
.
nEq
<(
pProbe
->
nCﬁumn
 + (pProbe->
zName
!=0))

111008 
	`whîeLo›AddBåìIndex
(
pBuûdî
, 
pSrc
, 
pProbe
, 
nInMul
+
nIn
);

111010 
pNew
->
nOut
 = 
ßved_nOut
;

111011 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


111012 
pBuûdî
->
nRecVÆid
 =ÇRecValid;

111015 
pNew
->
¥îeq
 = 
ßved_¥îeq
;

111016 
pNew
->
u
.
båì
.
nEq
 = 
ßved_nEq
;

111017 
pNew
->
wsFœgs
 = 
ßved_wsFœgs
;

111018 
pNew
->
nOut
 = 
ßved_nOut
;

111019 
pNew
->
nLTîm
 = 
ßved_nLTîm
;

111020  
rc
;

111031 
	`ödexMightHñpWôhOrdîBy
(

111032 
WhîeLo›Buûdî
 *
pBuûdî
,

111033 
Index
 *
pIndex
,

111034 
iCurs‹


111036 
Ex¥Li°
 *
pOB
;

111037 
ii
, 
jj
;

111039 if–
pIndex
->
bUn‹dîed
 )  0;

111040 if–(
pOB
 = 
pBuûdî
->
pWInfo
->
pOrdîBy
)==0 )  0;

111041 
ii
=0; ii<
pOB
->
nEx¥
; ii++){

111042 
Ex¥
 *
pEx¥
 = 
	`sqlôe3Ex¥SkùCﬁœã
(
pOB
->
a
[
ii
].pExpr);

111043 if–
pEx¥
->
›
!=
TK_COLUMN
 )  0;

111044 if–
pEx¥
->
iTabÀ
==
iCurs‹
 ){

111045 
jj
=0; jj<
pIndex
->
nCﬁumn
; jj++){

111046 if–
pEx¥
->
iCﬁumn
==
pIndex
->
aiCﬁumn
[
jj
] )  1;

111057 
Bômask
 
	`cﬁumnsInIndex
(
Index
 *
pIdx
){

111058 
Bômask
 
m
 = 0;

111059 
j
;

111060 
j
=
pIdx
->
nCﬁumn
-1; j>=0; j--){

111061 
x
 = 
pIdx
->
aiCﬁumn
[
j
];

111062 
	`as£π
–
x
>=0 );

111063 
	`ã°ˇ£
–
x
==
BMS
-1 );

111064 
	`ã°ˇ£
–
x
==
BMS
-2 );

111065 if–
x
<
BMS
-1 ) 
m
 |
	`MASKBIT
(x);

111067  
m
;

111073 
	`whîeUßbÀP¨tülIndex
(
iTab
, 
WhîeCœu£
 *
pWC
, 
Ex¥
 *
pWhîe
){

111074 
i
;

111075 
WhîeTîm
 *
pTîm
;

111076 
i
=0, 
pTîm
=
pWC
->
a
; i<pWC->
nTîm
; i++,ÖTerm++){

111077 if–
	`sqlôe3Ex¥Im∂õsEx¥
(
pTîm
->
pEx¥
, 
pWhîe
, 
iTab
) )  1;

111087 
	`whîeLo›AddBåì
(

111088 
WhîeLo›Buûdî
 *
pBuûdî
,

111089 
Bômask
 
mExåa


111091 
WhîeInfo
 *
pWInfo
;

111092 
Index
 *
pProbe
;

111093 
Index
 
sPk
;

111094 
tRow˙t
 
aiRowE°Pk
[2];

111095 
aiCﬁumnPk
 = -1;

111096 
SrcLi°
 *
pTabLi°
;

111097 
SrcLi°_ôem
 *
pSrc
;

111098 
WhîeLo›
 *
pNew
;

111099 
rc
 = 
SQLITE_OK
;

111100 
iS‹tIdx
 = 1;

111101 
b
;

111102 
LogE°
 
rSize
;

111103 
LogE°
 
rLogSize
;

111104 
WhîeCœu£
 *
pWC
;

111105 
TabÀ
 *
pTab
;

111107 
pNew
 = 
pBuûdî
->pNew;

111108 
pWInfo
 = 
pBuûdî
->pWInfo;

111109 
pTabLi°
 = 
pWInfo
->pTabList;

111110 
pSrc
 = 
pTabLi°
->
a
 + 
pNew
->
iTab
;

111111 
pTab
 = 
pSrc
->pTab;

111112 
pWC
 = 
pBuûdî
->pWC;

111113 
	`as£π
–!
	`IsVútuÆ
(
pSrc
->
pTab
) );

111115 if–
pSrc
->
pIndex
 ){

111117 
pProbe
 = 
pSrc
->
pIndex
;

111123 
Index
 *
pFú°
;

111124 
	`mem£t
(&
sPk
, 0, (
Index
));

111125 
sPk
.
nCﬁumn
 = 1;

111126 
sPk
.
aiCﬁumn
 = &
aiCﬁumnPk
;

111127 
sPk
.
aiRowE°
 = 
aiRowE°Pk
;

111128 
sPk
.
⁄Eº‹
 = 
OE_Rïœ˚
;

111129 
sPk
.
pTabÀ
 = 
pTab
;

111130 
aiRowE°Pk
[0] = 
pTab
->
nRowE°
;

111131 
aiRowE°Pk
[1] = 1;

111132 
pFú°
 = 
pSrc
->
pTab
->
pIndex
;

111133 if–
pSrc
->
nŸIndexed
==0 ){

111136 
sPk
.
pNext
 = 
pFú°
;

111138 
pProbe
 = &
sPk
;

111140 
rSize
 = 
	`sqlôe3LogE°
(
pTab
->
nRowE°
);

111141 
rLogSize
 = 
	`e°Log
(
rSize
);

111143 #i‚de‡
SQLITE_OMIT_AUTOMATIC_INDEX


111145 if–!
pBuûdî
->
pOrSë


111146 && (
pWInfo
->
pP¨£
->
db
->
Êags
 & 
SQLITE_AutoIndex
)!=0

111147 && 
pSrc
->
pIndex
==0

111148 && !
pSrc
->
vüC‹outöe


111149 && !
pSrc
->
nŸIndexed


111150 && !
pSrc
->
isC‹ªœãd


111153 
WhîeTîm
 *
pTîm
;

111154 
WhîeTîm
 *
pWCEnd
 = 
pWC
->
a
 +ÖWC->
nTîm
;

111155 
pTîm
=
pWC
->
a
; 
rc
==
SQLITE_OK
 &&ÖTîm<
pWCEnd
;ÖTerm++){

111156 if–
pTîm
->
¥îeqRight
 & 
pNew
->
maskSñf
 ) ;

111157 if–
	`ãrmC™DriveIndex
(
pTîm
, 
pSrc
, 0) ){

111158 
pNew
->
u
.
båì
.
nEq
 = 1;

111159 
pNew
->
u
.
båì
.
pIndex
 = 0;

111160 
pNew
->
nLTîm
 = 1;

111161 
pNew
->
aLTîm
[0] = 
pTîm
;

111165 
pNew
->
rSëup
 = 
rLogSize
 + 
rSize
 + 28; 
	`as£π
–28==
	`sqlôe3LogE°
(7) );

111170 
pNew
->
nOut
 = 43; 
	`as£π
–43==
	`sqlôe3LogE°
(20) );

111171 
pNew
->
rRun
 = 
	`sqlôe3LogE°Add
(
rLogSize
,pNew->
nOut
);

111172 
pNew
->
wsFœgs
 = 
WHERE_AUTO_INDEX
;

111173 
pNew
->
¥îeq
 = 
mExåa
 | 
pTîm
->
¥îeqRight
;

111174 
rc
 = 
	`whîeLo›In£π
(
pBuûdî
, 
pNew
);

111182 ; 
rc
==
SQLITE_OK
 && 
pProbe
;ÖProbeıProbe->
pNext
, 
iS‹tIdx
++){

111183 if–
pProbe
->
pP¨tIdxWhîe
!=0

111184 && !
	`whîeUßbÀP¨tülIndex
(
pNew
->
iTab
, 
pWC
, 
pProbe
->
pP¨tIdxWhîe
) ){

111187 
pNew
->
u
.
båì
.
nEq
 = 0;

111188 
pNew
->
nLTîm
 = 0;

111189 
pNew
->
iS‹tIdx
 = 0;

111190 
pNew
->
rSëup
 = 0;

111191 
pNew
->
¥îeq
 = 
mExåa
;

111192 
pNew
->
nOut
 = 
rSize
;

111193 
pNew
->
u
.
båì
.
pIndex
 = 
pProbe
;

111194 
b
 = 
	`ödexMightHñpWôhOrdîBy
(
pBuûdî
, 
pProbe
, 
pSrc
->
iCurs‹
);

111196 
	`as£π
–(
pWInfo
->
w˘æFœgs
 & 
WHERE_ONEPASS_DESIRED
)==0 || 
b
==0 );

111197 if–
pProbe
->
äum
<=0 ){

111199 
pNew
->
wsFœgs
 = 
WHERE_IPK
;

111202 
pNew
->
iS‹tIdx
 = 
b
 ? iSortIdx : 0;

111206 
pNew
->
rRun
 = 
	`sqlôe3LogE°Add
(
rSize
,
rLogSize
) + 16;

111207 
	`whîeLo›OuçutAdju°
(
pWC
, 
pNew
);

111208 
rc
 = 
	`whîeLo›In£π
(
pBuûdî
, 
pNew
);

111209 
pNew
->
nOut
 = 
rSize
;

111210 if–
rc
 ) ;

111212 
Bômask
 
m
 = 
pSrc
->
cﬁU£d
 & ~
	`cﬁumnsInIndex
(
pProbe
);

111213 
pNew
->
wsFœgs
 = (
m
==0Ë? (
WHERE_IDX_ONLY
|
WHERE_INDEXED
) : WHERE_INDEXED;

111216 if–
b


111217 || ( 
m
==0

111218 && 
pProbe
->
bUn‹dîed
==0

111219 && 
pProbe
->
szIdxRow
<
pTab
->
szTabRow


111220 && (
pWInfo
->
w˘æFœgs
 & 
WHERE_ONEPASS_DESIRED
)==0

111221 && 
sqlôe3GlobÆC⁄fig
.
bU£Cis


111222 && 
	`O±imiz©i⁄E«bÀd
(
pWInfo
->
pP¨£
->
db
, 
SQLITE_CovîIdxSˇn
)

111225 
pNew
->
iS‹tIdx
 = 
b
 ? iSortIdx : 0;

111226 if–
m
==0 ){

111232 
pNew
->
rRun
 = 
	`sqlôe3LogE°Add
(
rSize
,
rLogSize
) + 1 +

111233 (15*
pProbe
->
szIdxRow
)/
pTab
->
szTabRow
;

111235 
	`as£π
–
b
!=0 );

111238 
pNew
->
rRun
 = 
rSize
 + 
rLogSize
;

111240 
	`whîeLo›OuçutAdju°
(
pWC
, 
pNew
);

111241 
rc
 = 
	`whîeLo›In£π
(
pBuûdî
, 
pNew
);

111242 
pNew
->
nOut
 = 
rSize
;

111243 if–
rc
 ) ;

111247 
rc
 = 
	`whîeLo›AddBåìIndex
(
pBuûdî
, 
pSrc
, 
pProbe
, 0);

111248 #ifde‡
SQLITE_ENABLE_STAT3_OR_STAT4


111249 
	`sqlôe3Sèt4ProbeFªe
(
pBuûdî
->
pRec
);

111250 
pBuûdî
->
nRecVÆid
 = 0;

111251 
pBuûdî
->
pRec
 = 0;

111256 if–
pSrc
->
pIndex
 ) ;

111258  
rc
;

111261 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


111266 
	`whîeLo›AddVútuÆ
(

111267 
WhîeLo›Buûdî
 *
pBuûdî


111269 
WhîeInfo
 *
pWInfo
;

111270 
P¨£
 *
pP¨£
;

111271 
WhîeCœu£
 *
pWC
;

111272 
SrcLi°_ôem
 *
pSrc
;

111273 
TabÀ
 *
pTab
;

111274 
sqlôe3
 *
db
;

111275 
sqlôe3_ödex_öfo
 *
pIdxInfo
;

111276 
sqlôe3_ödex_c⁄°øöt
 *
pIdxC⁄s
;

111277 
sqlôe3_ödex_c⁄°øöt_ußge
 *
pUßge
;

111278 
WhîeTîm
 *
pTîm
;

111279 
i
, 
j
;

111280 
iTîm
, 
mxTîm
;

111281 
nC⁄°øöt
;

111282 
£íIn
 = 0;

111283 
£íV¨
 = 0;

111284 
iPha£
;

111285 
WhîeLo›
 *
pNew
;

111286 
rc
 = 
SQLITE_OK
;

111288 
pWInfo
 = 
pBuûdî
->pWInfo;

111289 
pP¨£
 = 
pWInfo
->pParse;

111290 
db
 = 
pP¨£
->db;

111291 
pWC
 = 
pBuûdî
->pWC;

111292 
pNew
 = 
pBuûdî
->pNew;

111293 
pSrc
 = &
pWInfo
->
pTabLi°
->
a
[
pNew
->
iTab
];

111294 
pTab
 = 
pSrc
->pTab;

111295 
	`as£π
–
	`IsVútuÆ
(
pTab
) );

111296 
pIdxInfo
 = 
	`ÆloˇãIndexInfo
(
pP¨£
, 
pWC
, 
pSrc
, 
pBuûdî
->
pOrdîBy
);

111297 if–
pIdxInfo
==0 )  
SQLITE_NOMEM
;

111298 
pNew
->
¥îeq
 = 0;

111299 
pNew
->
rSëup
 = 0;

111300 
pNew
->
wsFœgs
 = 
WHERE_VIRTUALTABLE
;

111301 
pNew
->
nLTîm
 = 0;

111302 
pNew
->
u
.
vèb
.
√edFªe
 = 0;

111303 
pUßge
 = 
pIdxInfo
->
aC⁄°øötUßge
;

111304 
nC⁄°øöt
 = 
pIdxInfo
->nConstraint;

111305 if–
	`whîeLo›Resize
(
db
, 
pNew
, 
nC⁄°øöt
) ){

111306 
	`sqlôe3DbFªe
(
db
, 
pIdxInfo
);

111307  
SQLITE_NOMEM
;

111310 
iPha£
=0; iPhase<=3; iPhase++){

111311 if–!
£íIn
 && (
iPha£
&1)!=0 ){

111312 
iPha£
++;

111313 if–
iPha£
>3 ) ;

111315 if–!
£íV¨
 && 
iPha£
>1 ) ;

111316 
pIdxC⁄s
 = *(
sqlôe3_ödex_c⁄°øöt
**)&
pIdxInfo
->
aC⁄°øöt
;

111317 
i
=0; i<
pIdxInfo
->
nC⁄°øöt
; i++, 
pIdxC⁄s
++){

111318 
j
 = 
pIdxC⁄s
->
iTîmOff£t
;

111319 
pTîm
 = &
pWC
->
a
[
j
];

111320  
iPha£
 ){

111322 
pIdxC⁄s
->
ußbÀ
 = 0;

111323 if–(
pTîm
->
eO≥øt‹
 & 
WO_IN
)!=0 ){

111324 
£íIn
 = 1;

111326 if–
pTîm
->
¥îeqRight
!=0 ){

111327 
£íV¨
 = 1;

111328 }if–(
pTîm
->
eO≥øt‹
 & 
WO_IN
)==0 ){

111329 
pIdxC⁄s
->
ußbÀ
 = 1;

111333 
	`as£π
–
£íIn
 );

111334 
pIdxC⁄s
->
ußbÀ
 = (
pTîm
->
¥îeqRight
==0);

111337 
	`as£π
–
£íV¨
 );

111338 
pIdxC⁄s
->
ußbÀ
 = (
pTîm
->
eO≥øt‹
 & 
WO_IN
)==0;

111341 
	`as£π
–
£íV¨
 && 
£íIn
 );

111342 
pIdxC⁄s
->
ußbÀ
 = 1;

111346 
	`mem£t
(
pUßge
, 0, ’Ußge[0])*
pIdxInfo
->
nC⁄°øöt
);

111347 if–
pIdxInfo
->
√edToFªeIdxSå
 ) 
	`sqlôe3_‰ì
’IdxInfo->
idxSå
);

111348 
pIdxInfo
->
idxSå
 = 0;

111349 
pIdxInfo
->
idxNum
 = 0;

111350 
pIdxInfo
->
√edToFªeIdxSå
 = 0;

111351 
pIdxInfo
->
‹dîByC⁄sumed
 = 0;

111352 
pIdxInfo
->
e°im©edCo°
 = 
SQLITE_BIG_DBL
 / ()2;

111353 
rc
 = 
	`vèbBe°Index
(
pP¨£
, 
pTab
, 
pIdxInfo
);

111354 if–
rc
 ) 
whîeLo›AddVèb_exô
;

111355 
pIdxC⁄s
 = *(
sqlôe3_ödex_c⁄°øöt
**)&
pIdxInfo
->
aC⁄°øöt
;

111356 
pNew
->
¥îeq
 = 0;

111357 
mxTîm
 = -1;

111358 
	`as£π
–
pNew
->
nLSlŸ
>=
nC⁄°øöt
 );

111359 
i
=0; i<
nC⁄°øöt
; i++Ë
pNew
->
aLTîm
[i] = 0;

111360 
pNew
->
u
.
vèb
.
omôMask
 = 0;

111361 
i
=0; i<
nC⁄°øöt
; i++, 
pIdxC⁄s
++){

111362 if–(
iTîm
 = 
pUßge
[
i
].
¨gvIndex
 - 1)>=0 ){

111363 
j
 = 
pIdxC⁄s
->
iTîmOff£t
;

111364 if–
iTîm
>=
nC⁄°øöt


111365 || 
j
<0

111366 || 
j
>=
pWC
->
nTîm


111367 || 
pNew
->
aLTîm
[
iTîm
]!=0

111369 
rc
 = 
SQLITE_ERROR
;

111370 
	`sqlôe3Eº‹Msg
(
pP¨£
, "%s.xBe°Index(ËmÆfun˘i⁄", 
pTab
->
zName
);

111371 
whîeLo›AddVèb_exô
;

111373 
	`ã°ˇ£
–
iTîm
==
nC⁄°øöt
-1 );

111374 
	`ã°ˇ£
–
j
==0 );

111375 
	`ã°ˇ£
–
j
==
pWC
->
nTîm
-1 );

111376 
pTîm
 = &
pWC
->
a
[
j
];

111377 
pNew
->
¥îeq
 |
pTîm
->
¥îeqRight
;

111378 
	`as£π
–
iTîm
<
pNew
->
nLSlŸ
 );

111379 
pNew
->
aLTîm
[
iTîm
] = 
pTîm
;

111380 if–
iTîm
>
mxTîm
 ) mxTerm = iTerm;

111381 
	`ã°ˇ£
–
iTîm
==15 );

111382 
	`ã°ˇ£
–
iTîm
==16 );

111383 if–
iTîm
<16 && 
pUßge
[
i
].
omô
 ) 
pNew
->
u
.
vèb
.
omôMask
 |= 1<<iTerm;

111384 if–(
pTîm
->
eO≥øt‹
 & 
WO_IN
)!=0 ){

111385 if–
pUßge
[
i
].
omô
==0 ){

111397 
pIdxInfo
->
‹dîByC⁄sumed
 = 0;

111401 if–
i
>=
nC⁄°øöt
 ){

111402 
pNew
->
nLTîm
 = 
mxTîm
+1;

111403 
	`as£π
–
pNew
->
nLTîm
<ıNew->
nLSlŸ
 );

111404 
pNew
->
u
.
vèb
.
idxNum
 = 
pIdxInfo
->idxNum;

111405 
pNew
->
u
.
vèb
.
√edFªe
 = 
pIdxInfo
->
√edToFªeIdxSå
;

111406 
pIdxInfo
->
√edToFªeIdxSå
 = 0;

111407 
pNew
->
u
.
vèb
.
idxSå
 = 
pIdxInfo
->idxStr;

111408 
pNew
->
u
.
vèb
.
isOrdîed
 = (
u8
)((
pIdxInfo
->
nOrdîBy
!=0)

111409 && 
pIdxInfo
->
‹dîByC⁄sumed
);

111410 
pNew
->
rSëup
 = 0;

111411 
pNew
->
rRun
 = 
	`sqlôe3LogE°FromDoubÀ
(
pIdxInfo
->
e°im©edCo°
);

111413 
pNew
->
nOut
 = 46; 
	`as£π
–46==
	`sqlôe3LogE°
(25) );

111414 
	`whîeLo›In£π
(
pBuûdî
, 
pNew
);

111415 if–
pNew
->
u
.
vèb
.
√edFªe
 ){

111416 
	`sqlôe3_‰ì
(
pNew
->
u
.
vèb
.
idxSå
);

111417 
pNew
->
u
.
vèb
.
√edFªe
 = 0;

111422 
whîeLo›AddVèb_exô
:

111423 if–
pIdxInfo
->
√edToFªeIdxSå
 ) 
	`sqlôe3_‰ì
’IdxInfo->
idxSå
);

111424 
	`sqlôe3DbFªe
(
db
, 
pIdxInfo
);

111425  
rc
;

111433 
	`whîeLo›AddOr
(
WhîeLo›Buûdî
 *
pBuûdî
, 
Bômask
 
mExåa
){

111434 
WhîeInfo
 *
pWInfo
 = 
pBuûdî
->pWInfo;

111435 
WhîeCœu£
 *
pWC
;

111436 
WhîeLo›
 *
pNew
;

111437 
WhîeTîm
 *
pTîm
, *
pWCEnd
;

111438 
rc
 = 
SQLITE_OK
;

111439 
iCur
;

111440 
WhîeCœu£
 
ãmpWC
;

111441 
WhîeLo›Buûdî
 
sSubBuûd
;

111442 
WhîeOrSë
 
sSum
, 
sCur
, 
sPªv
;

111443 
SrcLi°_ôem
 *
pIãm
;

111445 
pWC
 = 
pBuûdî
->pWC;

111446 if–
pWInfo
->
w˘æFœgs
 & 
WHERE_AND_ONLY
 )  
SQLITE_OK
;

111447 
pWCEnd
 = 
pWC
->
a
 +ÖWC->
nTîm
;

111448 
pNew
 = 
pBuûdî
->pNew;

111449 
	`mem£t
(&
sSum
, 0, (sSum));

111450 
pIãm
 = 
pWInfo
->
pTabLi°
->
a
 + 
pNew
->
iTab
;

111451 
iCur
 = 
pIãm
->
iCurs‹
;

111453 
pTîm
=
pWC
->
a
;ÖTîm<
pWCEnd
 && 
rc
==
SQLITE_OK
;ÖTerm++){

111454 if–(
pTîm
->
eO≥øt‹
 & 
WO_OR
)!=0

111455 && (
pTîm
->
u
.
pOrInfo
->
ödexabÀ
 & 
pNew
->
maskSñf
)!=0

111457 
WhîeCœu£
 * c⁄° 
pOrWC
 = &
pTîm
->
u
.
pOrInfo
->
wc
;

111458 
WhîeTîm
 * c⁄° 
pOrWCEnd
 = &
pOrWC
->
a
[pOrWC->
nTîm
];

111459 
WhîeTîm
 *
pOrTîm
;

111460 
⁄˚
 = 1;

111461 
i
, 
j
;

111463 
sSubBuûd
 = *
pBuûdî
;

111464 
sSubBuûd
.
pOrdîBy
 = 0;

111465 
sSubBuûd
.
pOrSë
 = &
sCur
;

111467 
pOrTîm
=
pOrWC
->
a
;ÖOrTîm<
pOrWCEnd
;ÖOrTerm++){

111468 if–(
pOrTîm
->
eO≥øt‹
 & 
WO_AND
)!=0 ){

111469 
sSubBuûd
.
pWC
 = &
pOrTîm
->
u
.
pAndInfo
->
wc
;

111470 }if–
pOrTîm
->
À·Curs‹
==
iCur
 ){

111471 
ãmpWC
.
pWInfo
 = 
pWC
->pWInfo;

111472 
ãmpWC
.
pOuãr
 = 
pWC
;

111473 
ãmpWC
.
›
 = 
TK_AND
;

111474 
ãmpWC
.
nTîm
 = 1;

111475 
ãmpWC
.
a
 = 
pOrTîm
;

111476 
sSubBuûd
.
pWC
 = &
ãmpWC
;

111480 
sCur
.
n
 = 0;

111481 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


111482 if–
	`IsVútuÆ
(
pIãm
->
pTab
) ){

111483 
rc
 = 
	`whîeLo›AddVútuÆ
(&
sSubBuûd
);

111484 
i
=0; i<
sCur
.
n
; i++ËsCur.
a
[i].
¥îeq
 |
mExåa
;

111488 
rc
 = 
	`whîeLo›AddBåì
(&
sSubBuûd
, 
mExåa
);

111490 
	`as£π
–
rc
==
SQLITE_OK
 || 
sCur
.
n
==0 );

111491 if–
sCur
.
n
==0 ){

111492 
sSum
.
n
 = 0;

111494 }if–
⁄˚
 ){

111495 
	`whîeOrMove
(&
sSum
, &
sCur
);

111496 
⁄˚
 = 0;

111498 
	`whîeOrMove
(&
sPªv
, &
sSum
);

111499 
sSum
.
n
 = 0;

111500 
i
=0; i<
sPªv
.
n
; i++){

111501 
j
=0; j<
sCur
.
n
; j++){

111502 
	`whîeOrIn£π
(&
sSum
, 
sPªv
.
a
[
i
].
¥îeq
 | 
sCur
.a[
j
].prereq,

111503 
	`sqlôe3LogE°Add
(
sPªv
.
a
[
i
].
rRun
, 
sCur
.a[
j
].rRun),

111504 
	`sqlôe3LogE°Add
(
sPªv
.
a
[
i
].
nOut
, 
sCur
.a[
j
].nOut));

111509 
pNew
->
nLTîm
 = 1;

111510 
pNew
->
aLTîm
[0] = 
pTîm
;

111511 
pNew
->
wsFœgs
 = 
WHERE_MULTI_OR
;

111512 
pNew
->
rSëup
 = 0;

111513 
pNew
->
iS‹tIdx
 = 0;

111514 
	`mem£t
(&
pNew
->
u
, 0, (pNew->u));

111515 
i
=0; 
rc
==
SQLITE_OK
 && i<
sSum
.
n
; i++){

111517 
pNew
->
rRun
 = 
sSum
.
a
[
i
].rRun + 18;

111518 
pNew
->
nOut
 = 
sSum
.
a
[
i
].nOut;

111519 
pNew
->
¥îeq
 = 
sSum
.
a
[
i
].prereq;

111520 
rc
 = 
	`whîeLo›In£π
(
pBuûdî
, 
pNew
);

111524  
rc
;

111530 
	`whîeLo›AddAŒ
(
WhîeLo›Buûdî
 *
pBuûdî
){

111531 
WhîeInfo
 *
pWInfo
 = 
pBuûdî
->pWInfo;

111532 
Bômask
 
mExåa
 = 0;

111533 
Bômask
 
mPri‹
 = 0;

111534 
iTab
;

111535 
SrcLi°
 *
pTabLi°
 = 
pWInfo
->pTabList;

111536 
SrcLi°_ôem
 *
pIãm
;

111537 
sqlôe3
 *
db
 = 
pWInfo
->
pP¨£
->db;

111538 
nTabLi°
 = 
pWInfo
->
nLevñ
;

111539 
rc
 = 
SQLITE_OK
;

111540 
u8
 
¥i‹JoöTy≥
 = 0;

111541 
WhîeLo›
 *
pNew
;

111544 
pNew
 = 
pBuûdî
->pNew;

111545 
	`whîeLo›Inô
(
pNew
);

111546 
iTab
=0, 
pIãm
=
pTabLi°
->
a
; iTab<
nTabLi°
; iTab++,ÖItem++){

111547 
pNew
->
iTab
 = iTab;

111548 
pNew
->
maskSñf
 = 
	`gëMask
(&
pWInfo
->
sMaskSë
, 
pIãm
->
iCurs‹
);

111549 if–((
pIãm
->
joöty≥
|
¥i‹JoöTy≥
Ë& (
JT_LEFT
|
JT_CROSS
))!=0 ){

111550 
mExåa
 = 
mPri‹
;

111552 
¥i‹JoöTy≥
 = 
pIãm
->
joöty≥
;

111553 if–
	`IsVútuÆ
(
pIãm
->
pTab
) ){

111554 
rc
 = 
	`whîeLo›AddVútuÆ
(
pBuûdî
);

111556 
rc
 = 
	`whîeLo›AddBåì
(
pBuûdî
, 
mExåa
);

111558 if–
rc
==
SQLITE_OK
 ){

111559 
rc
 = 
	`whîeLo›AddOr
(
pBuûdî
, 
mExåa
);

111561 
mPri‹
 |
pNew
->
maskSñf
;

111562 if–
rc
 || 
db
->
mÆlocFaûed
 ) ;

111564 
	`whîeLo›CÀ¨
(
db
, 
pNew
);

111565  
rc
;

111585 
	`whîeP©hS©isfõsOrdîBy
(

111586 
WhîeInfo
 *
pWInfo
,

111587 
Ex¥Li°
 *
pOrdîBy
,

111588 
WhîeP©h
 *
pP©h
,

111589 
u16
 
w˘æFœgs
,

111590 
u16
 
nLo›
,

111591 
WhîeLo›
 *
pLa°
,

111592 
Bômask
 *
pRevMask


111594 
u8
 
ªvSë
;

111595 
u8
 
ªv
;

111596 
u8
 
ªvIdx
;

111597 
u8
 
isOrdîDi°ö˘
;

111598 
u8
 
di°ö˘Cﬁumns
;

111599 
u8
 
isM©ch
;

111600 
u16
 
nCﬁumn
;

111601 
u16
 
nOrdîBy
;

111602 
iLo›
;

111603 
i
, 
j
;

111604 
iCur
;

111605 
iCﬁumn
;

111606 
WhîeLo›
 *
pLo›
 = 0;

111607 
WhîeTîm
 *
pTîm
;

111608 
Ex¥
 *
pOBEx¥
;

111609 
CﬁlSeq
 *
pCﬁl
;

111610 
Index
 *
pIndex
;

111611 
sqlôe3
 *
db
 = 
pWInfo
->
pP¨£
->db;

111612 
Bômask
 
obS©
 = 0;

111613 
Bômask
 
obD⁄e
;

111614 
Bômask
 
‹dîDi°ö˘Mask
;

111615 
Bômask
 
ªady
;

111639 
	`as£π
–
pOrdîBy
!=0 );

111643 if–
pLa°
->
wsFœgs
 & 
WHERE_VIRTUALTABLE
 ){

111644 
	`ã°ˇ£
–
nLo›
>0 );

111646  
pLa°
->
u
.
vèb
.
isOrdîed
;

111648 if–
nLo›
 && 
	`O±imiz©i⁄DißbÀd
(
db
, 
SQLITE_OrdîByIdxJoö
) )  0;

111650 
nOrdîBy
 = 
pOrdîBy
->
nEx¥
;

111651 
	`ã°ˇ£
–
nOrdîBy
==
BMS
-1 );

111652 if–
nOrdîBy
>
BMS
-1 )  0;

111653 
isOrdîDi°ö˘
 = 1;

111654 
obD⁄e
 = 
	`MASKBIT
(
nOrdîBy
)-1;

111655 
‹dîDi°ö˘Mask
 = 0;

111656 
ªady
 = 0;

111657 
iLo›
=0; 
isOrdîDi°ö˘
 && 
obS©
<
obD⁄e
 && iLo›<=
nLo›
; iLoop++){

111658 if–
iLo›
>0 ) 
ªady
 |
pLo›
->
maskSñf
;

111659 
pLo›
 = 
iLo›
<
nLo›
 ? 
pP©h
->
aLo›
[iLo›] : 
pLa°
;

111660 
	`as£π
–(
pLo›
->
wsFœgs
 & 
WHERE_VIRTUALTABLE
)==0 );

111661 
iCur
 = 
pWInfo
->
pTabLi°
->
a
[
pLo›
->
iTab
].
iCurs‹
;

111668 
i
=0; i<
nOrdîBy
; i++){

111669 if–
	`MASKBIT
(
i
Ë& 
obS©
 ) ;

111670 
pOBEx¥
 = 
	`sqlôe3Ex¥SkùCﬁœã
(
pOrdîBy
->
a
[
i
].
pEx¥
);

111671 if–
pOBEx¥
->
›
!=
TK_COLUMN
 ) ;

111672 if–
pOBEx¥
->
iTabÀ
!=
iCur
 ) ;

111673 
pTîm
 = 
	`födTîm
(&
pWInfo
->
sWC
, 
iCur
, 
pOBEx¥
->
iCﬁumn
,

111674 ~
ªady
, 
WO_EQ
|
WO_ISNULL
, 0);

111675 if–
pTîm
==0 ) ;

111676 if–(
pTîm
->
eO≥øt‹
&
WO_EQ
)!=0 && 
pOBEx¥
->
iCﬁumn
>=0 ){

111677 c⁄° *
z1
, *
z2
;

111678 
pCﬁl
 = 
	`sqlôe3Ex¥CﬁlSeq
(
pWInfo
->
pP¨£
, 
pOrdîBy
->
a
[
i
].
pEx¥
);

111679 if–!
pCﬁl
 )ÖCﬁ»
db
->
pDÊtCﬁl
;

111680 
z1
 = 
pCﬁl
->
zName
;

111681 
pCﬁl
 = 
	`sqlôe3Ex¥CﬁlSeq
(
pWInfo
->
pP¨£
, 
pTîm
->
pEx¥
);

111682 if–!
pCﬁl
 )ÖCﬁ»
db
->
pDÊtCﬁl
;

111683 
z2
 = 
pCﬁl
->
zName
;

111684 if–
	`sqlôe3SåICmp
(
z1
, 
z2
)!=0 ) ;

111686 
obS©
 |
	`MASKBIT
(
i
);

111689 if–(
pLo›
->
wsFœgs
 & 
WHERE_ONEROW
)==0 ){

111690 if–
pLo›
->
wsFœgs
 & 
WHERE_IPK
 ){

111691 
pIndex
 = 0;

111692 
nCﬁumn
 = 0;

111693 }if–(
pIndex
 = 
pLo›
->
u
.
båì
.pIndex)==0 ||ÖIndex->
bUn‹dîed
 ){

111696 
nCﬁumn
 = 
pIndex
->nColumn;

111697 
isOrdîDi°ö˘
 = 
pIndex
->
⁄Eº‹
!=
OE_N⁄e
;

111703 
ªv
 = 
ªvSë
 = 0;

111704 
di°ö˘Cﬁumns
 = 0;

111705 
j
=0; j<=
nCﬁumn
; j++){

111706 
u8
 
bOn˚
;

111709 if–
j
<
pLo›
->
u
.
båì
.
nEq


111710 && ((
i
 = 
pLo›
->
aLTîm
[
j
]->
eO≥øt‹
Ë& (
WO_EQ
|
WO_ISNULL
))!=0

111712 if–
i
 & 
WO_ISNULL
 ){

111713 
	`ã°ˇ£
–
isOrdîDi°ö˘
 );

111714 
isOrdîDi°ö˘
 = 0;

111722 if–
j
<
nCﬁumn
 ){

111724 
iCﬁumn
 = 
pIndex
->
aiCﬁumn
[
j
];

111725 
ªvIdx
 = 
pIndex
->
aS‹tOrdî
[
j
];

111726 if–
iCﬁumn
==
pIndex
->
pTabÀ
->
iPKey
 ) iColumn = -1;

111729 
	`as£π
–
j
==
nCﬁumn
 );

111730 
iCﬁumn
 = -1;

111731 
ªvIdx
 = 0;

111737 if–
isOrdîDi°ö˘


111738 && 
iCﬁumn
>=0

111739 && 
j
>=
pLo›
->
u
.
båì
.
nEq


111740 && 
pIndex
->
pTabÀ
->
aCﬁ
[
iCﬁumn
].
nŸNuŒ
==0

111742 
isOrdîDi°ö˘
 = 0;

111748 
bOn˚
 = 1;

111749 
isM©ch
 = 0;

111750 
i
=0; 
bOn˚
 && i<
nOrdîBy
; i++){

111751 if–
	`MASKBIT
(
i
Ë& 
obS©
 ) ;

111752 
pOBEx¥
 = 
	`sqlôe3Ex¥SkùCﬁœã
(
pOrdîBy
->
a
[
i
].
pEx¥
);

111753 
	`ã°ˇ£
–
w˘æFœgs
 & 
WHERE_GROUPBY
 );

111754 
	`ã°ˇ£
–
w˘æFœgs
 & 
WHERE_DISTINCTBY
 );

111755 if–(
w˘æFœgs
 & (
WHERE_GROUPBY
|
WHERE_DISTINCTBY
))==0 ) 
bOn˚
 = 0;

111756 if–
pOBEx¥
->
›
!=
TK_COLUMN
 ) ;

111757 if–
pOBEx¥
->
iTabÀ
!=
iCur
 ) ;

111758 if–
pOBEx¥
->
iCﬁumn
!=iColumn ) ;

111759 if–
iCﬁumn
>=0 ){

111760 
pCﬁl
 = 
	`sqlôe3Ex¥CﬁlSeq
(
pWInfo
->
pP¨£
, 
pOrdîBy
->
a
[
i
].
pEx¥
);

111761 if–!
pCﬁl
 )ÖCﬁ»
db
->
pDÊtCﬁl
;

111762 if–
	`sqlôe3SåICmp
(
pCﬁl
->
zName
, 
pIndex
->
azCﬁl
[
j
])!=0 ) ;

111764 
isM©ch
 = 1;

111767 if–
isM©ch
 ){

111768 if–
iCﬁumn
<0 ){

111769 
	`ã°ˇ£
–
di°ö˘Cﬁumns
==0 );

111770 
di°ö˘Cﬁumns
 = 1;

111772 
obS©
 |
	`MASKBIT
(
i
);

111773 if–(
pWInfo
->
w˘æFœgs
 & 
WHERE_GROUPBY
)==0 ){

111776 if–
ªvSë
 ){

111777 if–(
ªv
 ^ 
ªvIdx
)!=
pOrdîBy
->
a
[
i
].
s‹tOrdî
 )  0;

111779 
ªv
 = 
ªvIdx
 ^ 
pOrdîBy
->
a
[
i
].
s‹tOrdî
;

111780 if–
ªv
 ) *
pRevMask
 |
	`MASKBIT
(
iLo›
);

111781 
ªvSë
 = 1;

111786 if–
j
==0 || j<
nCﬁumn
 ){

111787 
	`ã°ˇ£
–
isOrdîDi°ö˘
!=0 );

111788 
isOrdîDi°ö˘
 = 0;

111793 if–
di°ö˘Cﬁumns
 ){

111794 
	`ã°ˇ£
–
isOrdîDi°ö˘
==0 );

111795 
isOrdîDi°ö˘
 = 1;

111800 if–
isOrdîDi°ö˘
 ){

111801 
‹dîDi°ö˘Mask
 |
pLo›
->
maskSñf
;

111802 
i
=0; i<
nOrdîBy
; i++){

111803 
Ex¥
 *
p
;

111804 if–
	`MASKBIT
(
i
Ë& 
obS©
 ) ;

111805 
p
 = 
pOrdîBy
->
a
[
i
].
pEx¥
;

111806 if–(
	`ex¥TabÀUßge
(&
pWInfo
->
sMaskSë
, 
p
)&~
‹dîDi°ö˘Mask
)==0 ){

111807 
obS©
 |
	`MASKBIT
(
i
);

111812 if–
obS©
==
obD⁄e
 )  1;

111813 if–!
isOrdîDi°ö˘
 )  0;

111817 #ifde‡
WHERETRACE_ENABLED


111819 c⁄° *
	`whîeP©hName
(
WhîeP©h
 *
pP©h
, 
nLo›
, 
WhîeLo›
 *
pLa°
){

111820 
zName
[65];

111821 
i
;

111822 
i
=0; i<
nLo›
; i++){ 
zName
[i] = 
pP©h
->
aLo›
[i]->
cId
; }

111823 if–
pLa°
 ) 
zName
[
i
++] =ÖLa°->
cId
;

111824 
zName
[
i
] = 0;

111825  
zName
;

111842 
	`whîeP©hSﬁvî
(
WhîeInfo
 *
pWInfo
, 
LogE°
 
nRowE°
){

111843 
mxChoi˚
;

111844 
nLo›
;

111845 
P¨£
 *
pP¨£
;

111846 
sqlôe3
 *
db
;

111847 
iLo›
;

111848 
ii
, 
jj
;

111849 
mxI
 = 0;

111850 
LogE°
 
rCo°
;

111851 
LogE°
 
nOut
;

111852 
LogE°
 
mxCo°
 = 0;

111853 
LogE°
 
mxOut
 = 0;

111854 
LogE°
 
rS‹tCo°
;

111855 
nTo
, 
nFrom
;

111856 
WhîeP©h
 *
aFrom
;

111857 
WhîeP©h
 *
aTo
;

111858 
WhîeP©h
 *
pFrom
;

111859 
WhîeP©h
 *
pTo
;

111860 
WhîeLo›
 *
pWLo›
;

111861 
WhîeLo›
 **
pX
;

111862 *
pS∑˚
;

111864 
pP¨£
 = 
pWInfo
->pParse;

111865 
db
 = 
pP¨£
->db;

111866 
nLo›
 = 
pWInfo
->
nLevñ
;

111870 
mxChoi˚
 = (
nLo›
==1) ? 1 : (nLoop==2 ? 5 : 10);

111871 
	`as£π
–
nLo›
<=
pWInfo
->
pTabLi°
->
nSrc
 );

111872 
	`WHERETRACE
(0x002, ("---- begin solver\n"));

111875 
ii
 = ((
WhîeP©h
)+(
WhîeLo›
*)*
nLo›
)*
mxChoi˚
*2;

111876 
pS∑˚
 = 
	`sqlôe3DbMÆlocRaw
(
db
, 
ii
);

111877 if–
pS∑˚
==0 )  
SQLITE_NOMEM
;

111878 
aTo
 = (
WhîeP©h
*)
pS∑˚
;

111879 
aFrom
 = 
aTo
+
mxChoi˚
;

111880 
	`mem£t
(
aFrom
, 0, (aFrom[0]));

111881 
pX
 = (
WhîeLo›
**)(
aFrom
+
mxChoi˚
);

111882 
ii
=
mxChoi˚
*2, 
pFrom
=
aTo
; ii>0; ii--,ÖFrom++, 
pX
 +
nLo›
){

111883 
pFrom
->
aLo›
 = 
pX
;

111891 
aFrom
[0].
nRow
 = 
	`MIN
(
pP¨£
->
nQuîyLo›
, 46); 
	`as£π
–46==
	`sqlôe3LogE°
(25) );

111892 
nFrom
 = 1;

111896 
rS‹tCo°
 = 0;

111897 if–
pWInfo
->
pOrdîBy
==0 || 
nRowE°
==0 ){

111898 
aFrom
[0].
isOrdîedVÆid
 = 1;

111904 
rS‹tCo°
 = 
nRowE°
 + 
	`e°Log
(nRowEst);

111905 
	`WHERETRACE
(0x002,("---- s‹àco°=%-3d\n", 
rS‹tCo°
));

111911 
iLo›
=0; iLo›<
nLo›
; iLoop++){

111912 
nTo
 = 0;

111913 
ii
=0, 
pFrom
=
aFrom
; ii<
nFrom
; ii++,ÖFrom++){

111914 
pWLo›
=
pWInfo
->
pLo›s
;ÖWLo›;ÖWLo›ıWLo›->
pNextLo›
){

111915 
Bômask
 
maskNew
;

111916 
Bômask
 
ªvMask
 = 0;

111917 
u8
 
isOrdîedVÆid
 = 
pFrom
->isOrderedValid;

111918 
u8
 
isOrdîed
 = 
pFrom
->isOrdered;

111919 if–(
pWLo›
->
¥îeq
 & ~
pFrom
->
maskLo›
)!=0 ) ;

111920 if–(
pWLo›
->
maskSñf
 & 
pFrom
->
maskLo›
)!=0 ) ;

111923 
rCo°
 = 
	`sqlôe3LogE°Add
(
pWLo›
->
rSëup
,pWLo›->
rRun
 + 
pFrom
->
nRow
);

111924 
rCo°
 = 
	`sqlôe3LogE°Add
‘Co°, 
pFrom
->rCost);

111925 
nOut
 = 
pFrom
->
nRow
 + 
pWLo›
->nOut;

111926 
maskNew
 = 
pFrom
->
maskLo›
 | 
pWLo›
->
maskSñf
;

111927 if–!
isOrdîedVÆid
 ){

111928  
	`whîeP©hS©isfõsOrdîBy
(
pWInfo
,

111929 
pWInfo
->
pOrdîBy
, 
pFrom
,ÖWInfo->
w˘æFœgs
,

111930 
iLo›
, 
pWLo›
, &
ªvMask
) ){

111932 
isOrdîed
 = 1;

111933 
isOrdîedVÆid
 = 1;

111936 
isOrdîed
 = 0;

111937 
isOrdîedVÆid
 = 1;

111938 
rCo°
 = 
	`sqlôe3LogE°Add
‘Co°, 
rS‹tCo°
);

111944 
ªvMask
 = 
pFrom
->
ªvLo›
;

111947 
jj
=0, 
pTo
=
aTo
; jj<
nTo
; jj++,ÖTo++){

111948 if–
pTo
->
maskLo›
==
maskNew


111949 && 
pTo
->
isOrdîedVÆid
==isOrderedValid

111950 && ((
pTo
->
rCo°
<ÙCo° &&ÖTo->
nRow
<=
nOut
) ||

111951 (
pTo
->
rCo°
>ÙCo° &&ÖTo->
nRow
>=
nOut
))

111953 
	`ã°ˇ£
–
jj
==
nTo
-1 );

111957 if–
jj
>=
nTo
 ){

111958 if–
nTo
>=
mxChoi˚
 && 
rCo°
>=
mxCo°
 ){

111959 #ifde‡
WHERETRACE_ENABLED


111960 if–
sqlôe3WhîeTø˚
&0x4 ){

111961 
	`sqlôe3DebugPrötf
("Skip %s cost=%-3d,%3d order=%c\n",

111962 
	`whîeP©hName
(
pFrom
, 
iLo›
, 
pWLo›
), 
rCo°
, 
nOut
,

111963 
isOrdîedVÆid
 ? (
isOrdîed
 ? 'Y' : 'N') : '?');

111969 if–
nTo
<
mxChoi˚
 ){

111971 
jj
 = 
nTo
++;

111974 
jj
 = 
mxI
;

111976 
pTo
 = &
aTo
[
jj
];

111977 #ifde‡
WHERETRACE_ENABLED


111978 if–
sqlôe3WhîeTø˚
&0x4 ){

111979 
	`sqlôe3DebugPrötf
("New %s cost=%-3d,%3d order=%c\n",

111980 
	`whîeP©hName
(
pFrom
, 
iLo›
, 
pWLo›
), 
rCo°
, 
nOut
,

111981 
isOrdîedVÆid
 ? (
isOrdîed
 ? 'Y' : 'N') : '?');

111985 if–
pTo
->
rCo°
<ÙCo° &&ÖTo->
nRow
<=
nOut
 ){

111986 #ifde‡
WHERETRACE_ENABLED


111987 if–
sqlôe3WhîeTø˚
&0x4 ){

111988 
	`sqlôe3DebugPrötf
(

111990 
	`whîeP©hName
(
pFrom
, 
iLo›
, 
pWLo›
), 
rCo°
, 
nOut
,

111991 
isOrdîedVÆid
 ? (
isOrdîed
 ? 'Y' : 'N') : '?');

111992 
	`sqlôe3DebugPrötf
(" vs %s cost=%-3d,%d order=%c\n",

111993 
	`whîeP©hName
(
pTo
, 
iLo›
+1, 0),ÖTo->
rCo°
,ÖTo->
nRow
,

111994 
pTo
->
isOrdîedVÆid
 ? (pTo->
isOrdîed
 ? 'Y' : 'N') : '?');

111997 
	`ã°ˇ£
–
pTo
->
rCo°
==rCost );

112000 
	`ã°ˇ£
–
pTo
->
rCo°
==rCost+1 );

112002 #ifde‡
WHERETRACE_ENABLED


112003 if–
sqlôe3WhîeTø˚
&0x4 ){

112004 
	`sqlôe3DebugPrötf
(

112006 
	`whîeP©hName
(
pFrom
, 
iLo›
, 
pWLo›
), 
rCo°
, 
nOut
,

112007 
isOrdîedVÆid
 ? (
isOrdîed
 ? 'Y' : 'N') : '?');

112008 
	`sqlôe3DebugPrötf
(" was %s cost=%-3d,%3d order=%c\n",

112009 
	`whîeP©hName
(
pTo
, 
iLo›
+1, 0),ÖTo->
rCo°
,ÖTo->
nRow
,

112010 
pTo
->
isOrdîedVÆid
 ? (pTo->
isOrdîed
 ? 'Y' : 'N') : '?');

112015 
pTo
->
maskLo›
 = 
pFrom
->maskLo› | 
pWLo›
->
maskSñf
;

112016 
pTo
->
ªvLo›
 = 
ªvMask
;

112017 
pTo
->
nRow
 = 
nOut
;

112018 
pTo
->
rCo°
 =ÑCost;

112019 
pTo
->
isOrdîedVÆid
 = isOrderedValid;

112020 
pTo
->
isOrdîed
 = isOrdered;

112021 
	`mem˝y
(
pTo
->
aLo›
, 
pFrom
->aLo›, (
WhîeLo›
*)*
iLo›
);

112022 
pTo
->
aLo›
[
iLo›
] = 
pWLo›
;

112023 if–
nTo
>=
mxChoi˚
 ){

112024 
mxI
 = 0;

112025 
mxCo°
 = 
aTo
[0].
rCo°
;

112026 
mxOut
 = 
aTo
[0].
nRow
;

112027 
jj
=1, 
pTo
=&
aTo
[1]; jj<
mxChoi˚
; jj++,ÖTo++){

112028 if–
pTo
->
rCo°
>
mxCo°
 || (pTo->rCo°==mxCo° &&ÖTo->
nRow
>
mxOut
) ){

112029 
mxCo°
 = 
pTo
->
rCo°
;

112030 
mxOut
 = 
pTo
->
nRow
;

112031 
mxI
 = 
jj
;

112038 #ifde‡
WHERETRACE_ENABLED


112039 if–
sqlôe3WhîeTø˚
>=2 ){

112040 
	`sqlôe3DebugPrötf
("----á·îÑound %d ----\n", 
iLo›
);

112041 
ii
=0, 
pTo
=
aTo
; ii<
nTo
; ii++,ÖTo++){

112042 
	`sqlôe3DebugPrötf
(" %s cost=%-3dÇrow=%-3d order=%c",

112043 
	`whîeP©hName
(
pTo
, 
iLo›
+1, 0),ÖTo->
rCo°
,ÖTo->
nRow
,

112044 
pTo
->
isOrdîedVÆid
 ? (pTo->
isOrdîed
 ? 'Y' : 'N') : '?');

112045 if–
pTo
->
isOrdîedVÆid
 &&ÖTo->
isOrdîed
 ){

112046 
	`sqlôe3DebugPrötf
("Ñev=0x%Œx\n", 
pTo
->
ªvLo›
);

112048 
	`sqlôe3DebugPrötf
("\n");

112055 
pFrom
 = 
aTo
;

112056 
aTo
 = 
aFrom
;

112057 
aFrom
 = 
pFrom
;

112058 
nFrom
 = 
nTo
;

112061 if–
nFrom
==0 ){

112062 
	`sqlôe3Eº‹Msg
(
pP¨£
, "no query solution");

112063 
	`sqlôe3DbFªe
(
db
, 
pS∑˚
);

112064  
SQLITE_ERROR
;

112068 
pFrom
 = 
aFrom
;

112069 
ii
=1; ii<
nFrom
; ii++){

112070 if–
pFrom
->
rCo°
>
aFrom
[
ii
].rCost )ÖFrom = &aFrom[ii];

112072 
	`as£π
–
pWInfo
->
nLevñ
==
nLo›
 );

112074 
iLo›
=0; iLo›<
nLo›
; iLoop++){

112075 
WhîeLevñ
 *
pLevñ
 = 
pWInfo
->
a
 + 
iLo›
;

112076 
pLevñ
->
pWLo›
 =ÖWLo› = 
pFrom
->
aLo›
[
iLo›
];

112077 
pLevñ
->
iFrom
 = 
pWLo›
->
iTab
;

112078 
pLevñ
->
iTabCur
 = 
pWInfo
->
pTabLi°
->
a
[pLevñ->
iFrom
].
iCurs‹
;

112080 if–(
pWInfo
->
w˘æFœgs
 & 
WHERE_WANT_DISTINCT
)!=0

112081 && (
pWInfo
->
w˘æFœgs
 & 
WHERE_DISTINCTBY
)==0

112082 && 
pWInfo
->
eDi°ö˘
==
WHERE_DISTINCT_NOOP


112083 && 
nRowE°


112085 
Bômask
 
nŸU£d
;

112086 
rc
 = 
	`whîeP©hS©isfõsOrdîBy
(
pWInfo
,ÖWInfo->
pResu…Së
, 
pFrom
,

112087 
WHERE_DISTINCTBY
, 
nLo›
-1, 
pFrom
->
aLo›
[nLo›-1], &
nŸU£d
);

112088 if–
rc
==1 ) 
pWInfo
->
eDi°ö˘
 = 
WHERE_DISTINCT_ORDERED
;

112090 if–
pFrom
->
isOrdîed
 ){

112091 if–
pWInfo
->
w˘æFœgs
 & 
WHERE_DISTINCTBY
 ){

112092 
pWInfo
->
eDi°ö˘
 = 
WHERE_DISTINCT_ORDERED
;

112094 
pWInfo
->
bOBS©
 = 1;

112095 
pWInfo
->
ªvMask
 = 
pFrom
->
ªvLo›
;

112098 
pWInfo
->
nRowOut
 = 
pFrom
->
nRow
;

112101 
	`sqlôe3DbFªe
(
db
, 
pS∑˚
);

112102  
SQLITE_OK
;

112116 
	`whîeSh‹tCut
(
WhîeLo›Buûdî
 *
pBuûdî
){

112117 
WhîeInfo
 *
pWInfo
;

112118 
SrcLi°_ôem
 *
pIãm
;

112119 
WhîeCœu£
 *
pWC
;

112120 
WhîeTîm
 *
pTîm
;

112121 
WhîeLo›
 *
pLo›
;

112122 
iCur
;

112123 
j
;

112124 
TabÀ
 *
pTab
;

112125 
Index
 *
pIdx
;

112127 
pWInfo
 = 
pBuûdî
->pWInfo;

112128 if–
pWInfo
->
w˘æFœgs
 & 
WHERE_FORCE_TABLE
 )  0;

112129 
	`as£π
–
pWInfo
->
pTabLi°
->
nSrc
>=1 );

112130 
pIãm
 = 
pWInfo
->
pTabLi°
->
a
;

112131 
pTab
 = 
pIãm
->pTab;

112132 if–
	`IsVútuÆ
(
pTab
) )  0;

112133 if–
pIãm
->
zIndex
 )  0;

112134 
iCur
 = 
pIãm
->
iCurs‹
;

112135 
pWC
 = &
pWInfo
->
sWC
;

112136 
pLo›
 = 
pBuûdî
->
pNew
;

112137 
pLo›
->
wsFœgs
 = 0;

112138 
pTîm
 = 
	`födTîm
(
pWC
, 
iCur
, -1, 0, 
WO_EQ
, 0);

112139 if–
pTîm
 ){

112140 
pLo›
->
wsFœgs
 = 
WHERE_COLUMN_EQ
|
WHERE_IPK
|
WHERE_ONEROW
;

112141 
pLo›
->
aLTîm
[0] = 
pTîm
;

112142 
pLo›
->
nLTîm
 = 1;

112143 
pLo›
->
u
.
båì
.
nEq
 = 1;

112145 
pLo›
->
rRun
 = 33;

112147 
pIdx
=
pTab
->
pIndex
;ÖIdx;ÖIdxıIdx->
pNext
){

112148 
	`as£π
–
pLo›
->
aLTîmS∑˚
=ıLo›->
aLTîm
 );

112149 
	`as£π
–
	`AºaySize
(
pLo›
->
aLTîmS∑˚
)==4 );

112150 if–
pIdx
->
⁄Eº‹
==
OE_N⁄e


112151 || 
pIdx
->
pP¨tIdxWhîe
!=0

112152 || 
pIdx
->
nCﬁumn
>
	`AºaySize
(
pLo›
->
aLTîmS∑˚
)

112154 
j
=0; j<
pIdx
->
nCﬁumn
; j++){

112155 
pTîm
 = 
	`födTîm
(
pWC
, 
iCur
, 
pIdx
->
aiCﬁumn
[
j
], 0, 
WO_EQ
,ÖIdx);

112156 if–
pTîm
==0 ) ;

112157 
pLo›
->
aLTîm
[
j
] = 
pTîm
;

112159 if–
j
!=
pIdx
->
nCﬁumn
 ) ;

112160 
pLo›
->
wsFœgs
 = 
WHERE_COLUMN_EQ
|
WHERE_ONEROW
|
WHERE_INDEXED
;

112161 if–(
pIãm
->
cﬁU£d
 & ~
	`cﬁumnsInIndex
(
pIdx
))==0 ){

112162 
pLo›
->
wsFœgs
 |
WHERE_IDX_ONLY
;

112164 
pLo›
->
nLTîm
 = 
j
;

112165 
pLo›
->
u
.
båì
.
nEq
 = 
j
;

112166 
pLo›
->
u
.
båì
.
pIndex
 = 
pIdx
;

112168 
pLo›
->
rRun
 = 39;

112172 if–
pLo›
->
wsFœgs
 ){

112173 
pLo›
->
nOut
 = (
LogE°
)1;

112174 
pWInfo
->
a
[0].
pWLo›
 = 
pLo›
;

112175 
pLo›
->
maskSñf
 = 
	`gëMask
(&
pWInfo
->
sMaskSë
, 
iCur
);

112176 
pWInfo
->
a
[0].
iTabCur
 = 
iCur
;

112177 
pWInfo
->
nRowOut
 = 1;

112178 if–
pWInfo
->
pOrdîBy
 )ÖWInfo->
bOBS©
 = 1;

112179 if–
pWInfo
->
w˘æFœgs
 & 
WHERE_WANT_DISTINCT
 ){

112180 
pWInfo
->
eDi°ö˘
 = 
WHERE_DISTINCT_UNIQUE
;

112182 #ifde‡
SQLITE_DEBUG


112183 
pLo›
->
cId
 = '0';

112270 
SQLITE_PRIVATE
 
WhîeInfo
 *
	`sqlôe3WhîeBegö
(

112271 
P¨£
 *
pP¨£
,

112272 
SrcLi°
 *
pTabLi°
,

112273 
Ex¥
 *
pWhîe
,

112274 
Ex¥Li°
 *
pOrdîBy
,

112275 
Ex¥Li°
 *
pResu…Së
,

112276 
u16
 
w˘æFœgs
,

112277 
iIdxCur


112279 
nByãWInfo
;

112280 
nTabLi°
;

112281 
WhîeInfo
 *
pWInfo
;

112282 
Vdbe
 *
v
 = 
pP¨£
->
pVdbe
;

112283 
Bômask
 
nŸRódy
;

112284 
WhîeLo›Buûdî
 
sWLB
;

112285 
WhîeMaskSë
 *
pMaskSë
;

112286 
WhîeLevñ
 *
pLevñ
;

112287 
WhîeLo›
 *
pLo›
;

112288 
ii
;

112289 
sqlôe3
 *
db
;

112290 
rc
;

112294 
db
 = 
pP¨£
->db;

112295 
	`mem£t
(&
sWLB
, 0, (sWLB));

112296 
sWLB
.
pOrdîBy
 =ÖOrderBy;

112300 if–
	`O±imiz©i⁄DißbÀd
(
db
, 
SQLITE_Di°ö˘O±
) ){

112301 
w˘æFœgs
 &~
WHERE_WANT_DISTINCT
;

112307 
	`ã°ˇ£
–
pTabLi°
->
nSrc
==
BMS
 );

112308 if–
pTabLi°
->
nSrc
>
BMS
 ){

112309 
	`sqlôe3Eº‹Msg
(
pP¨£
, "© mo° %dÅabÀ†öá joö", 
BMS
);

112318 
nTabLi°
 = (
w˘æFœgs
 & 
WHERE_ONETABLE_ONLY
Ë? 1 : 
pTabLi°
->
nSrc
;

112327 
nByãWInfo
 = 
	`ROUND8
((
WhîeInfo
)+(
nTabLi°
-1)*(
WhîeLevñ
));

112328 
pWInfo
 = 
	`sqlôe3DbMÆlocZîo
(
db
, 
nByãWInfo
 + (
WhîeLo›
));

112329 if–
db
->
mÆlocFaûed
 ){

112330 
	`sqlôe3DbFªe
(
db
, 
pWInfo
);

112331 
pWInfo
 = 0;

112332 
whîeBegöEº‹
;

112334 
pWInfo
->
nLevñ
 = 
nTabLi°
;

112335 
pWInfo
->
pP¨£
 =ÖParse;

112336 
pWInfo
->
pTabLi°
 =ÖTabList;

112337 
pWInfo
->
pOrdîBy
 =ÖOrderBy;

112338 
pWInfo
->
pResu…Së
 =ÖResultSet;

112339 
pWInfo
->
iBªak
 = 
	`sqlôe3VdbeMakeLabñ
(
v
);

112340 
pWInfo
->
w˘æFœgs
 = wctrlFlags;

112341 
pWInfo
->
ßvedNQuîyLo›
 = 
pP¨£
->
nQuîyLo›
;

112342 
pMaskSë
 = &
pWInfo
->
sMaskSë
;

112343 
sWLB
.
pWInfo
 =ÖWInfo;

112344 
sWLB
.
pWC
 = &
pWInfo
->
sWC
;

112345 
sWLB
.
pNew
 = (
WhîeLo›
*)(((*)
pWInfo
)+
nByãWInfo
);

112346 
	`as£π
–
	`EIGHT_BYTE_ALIGNMENT
(
sWLB
.
pNew
) );

112347 
	`whîeLo›Inô
(
sWLB
.
pNew
);

112348 #ifde‡
SQLITE_DEBUG


112349 
sWLB
.
pNew
->
cId
 = '*';

112355 
	`öôMaskSë
(
pMaskSë
);

112356 
	`whîeCœu£Inô
(&
pWInfo
->
sWC
,ÖWInfo);

112357 
	`sqlôe3Ex¥CodeC⁄°™ts
(
pP¨£
, 
pWhîe
);

112358 
	`whîeS∂ô
(&
pWInfo
->
sWC
, 
pWhîe
, 
TK_AND
);

112359 
	`sqlôe3CodeVîifySchema
(
pP¨£
, -1);

112364 if–
pWhîe
 && (
nTabLi°
==0 || 
	`sqlôe3Ex¥IsC⁄°™tNŸJoö
(pWhere)) ){

112365 
	`sqlôe3Ex¥IfFÆ£
(
pP¨£
, 
pWhîe
, 
pWInfo
->
iBªak
, 
SQLITE_JUMPIFNULL
);

112366 
pWhîe
 = 0;

112371 if–
nTabLi°
==0 ){

112372 if–
pOrdîBy
 ) 
pWInfo
->
bOBS©
 = 1;

112373 if–
w˘æFœgs
 & 
WHERE_WANT_DISTINCT
 ){

112374 
pWInfo
->
eDi°ö˘
 = 
WHERE_DISTINCT_UNIQUE
;

112394 
ii
=0; ii<
pTabLi°
->
nSrc
; ii++){

112395 
	`¸óãMask
(
pMaskSë
, 
pTabLi°
->
a
[
ii
].
iCurs‹
);

112397 #i‚de‡
NDEBUG


112399 
Bômask
 
toTheLe·
 = 0;

112400 
ii
=0; ii<
pTabLi°
->
nSrc
; ii++){

112401 
Bômask
 
m
 = 
	`gëMask
(
pMaskSë
, 
pTabLi°
->
a
[
ii
].
iCurs‹
);

112402 
	`as£π
–(
m
-1)==
toTheLe·
 );

112403 
toTheLe·
 |
m
;

112413 
	`ex¥A«lyzeAŒ
(
pTabLi°
, &
pWInfo
->
sWC
);

112414 if–
db
->
mÆlocFaûed
 ){

112415 
whîeBegöEº‹
;

112422 if–
pOrdîBy
 && (
w˘æFœgs
 & 
WHERE_WANT_DISTINCT
)!=0 ){

112423 
ii
=0; ii<
pOrdîBy
->
nEx¥
; ii++){

112424 
Ex¥
 *
pEx¥
 = 
	`sqlôe3Ex¥SkùCﬁœã
(
pOrdîBy
->
a
[
ii
].pExpr);

112425 if–
pEx¥
->
›
!=
TK_COLUMN
 ){

112426 
pWInfo
->
pOrdîBy
 =ÖOrderBy = 0;

112428 }if–
pEx¥
->
iCﬁumn
<0 ){

112434 if–
w˘æFœgs
 & 
WHERE_WANT_DISTINCT
 ){

112435 if–
	`isDi°ö˘Redund™t
(
pP¨£
, 
pTabLi°
, &
pWInfo
->
sWC
, 
pResu…Së
) ){

112437 
pWInfo
->
eDi°ö˘
 = 
WHERE_DISTINCT_UNIQUE
;

112438 }if–
pOrdîBy
==0 ){

112440 
pWInfo
->
w˘æFœgs
 |
WHERE_DISTINCTBY
;

112441 
pWInfo
->
pOrdîBy
 = 
pResu…Së
;

112446 
	`WHERETRACE
(0xffff,("*** Optimizer Start ***\n"));

112447 if–
nTabLi°
!=1 || 
	`whîeSh‹tCut
(&
sWLB
)==0 ){

112448 
rc
 = 
	`whîeLo›AddAŒ
(&
sWLB
);

112449 if–
rc
 ) 
whîeBegöEº‹
;

112452 #ifde‡
WHERETRACE_ENABLED


112453 if–
sqlôe3WhîeTø˚
 ){

112454 
WhîeLo›
 *
p
;

112455 
i
;

112456 
zLabñ
[] = "0123456789abcdefghijklmnopqrstuvwyxz"

112458 
p
=
pWInfo
->
pLo›s
, 
i
=0;Ö;Öı->
pNextLo›
, i++){

112459 
p
->
cId
 = 
zLabñ
[
i
%(zLabel)];

112460 
	`whîeLo›Pröt
(
p
, 
pTabLi°
);

112465 
	`whîeP©hSﬁvî
(
pWInfo
, 0);

112466 if–
db
->
mÆlocFaûed
 ) 
whîeBegöEº‹
;

112467 if–
pWInfo
->
pOrdîBy
 ){

112468 
	`whîeP©hSﬁvî
(
pWInfo
,ÖWInfo->
nRowOut
+1);

112469 if–
db
->
mÆlocFaûed
 ) 
whîeBegöEº‹
;

112472 if–
pWInfo
->
pOrdîBy
==0 && (
db
->
Êags
 & 
SQLITE_Revî£Ordî
)!=0 ){

112473 
pWInfo
->
ªvMask
 = (
Bômask
)(-1);

112475 if–
pP¨£
->
nEº
 || 
	`NEVER
(
db
->
mÆlocFaûed
) ){

112476 
whîeBegöEº‹
;

112478 #ifde‡
WHERETRACE_ENABLED


112479 if–
sqlôe3WhîeTø˚
 ){

112480 
ii
;

112481 
	`sqlôe3DebugPrötf
("---- Sﬁuti⁄ÇRow=%d", 
pWInfo
->
nRowOut
);

112482 if–
pWInfo
->
bOBS©
 ){

112483 
	`sqlôe3DebugPrötf
(" ORDERBY=0x%Œx", 
pWInfo
->
ªvMask
);

112485  
pWInfo
->
eDi°ö˘
 ){

112486 
WHERE_DISTINCT_UNIQUE
: {

112487 
	`sqlôe3DebugPrötf
(" DISTINCT=unique");

112490 
WHERE_DISTINCT_ORDERED
: {

112491 
	`sqlôe3DebugPrötf
(" DISTINCT=ordered");

112494 
WHERE_DISTINCT_UNORDERED
: {

112495 
	`sqlôe3DebugPrötf
(" DISTINCT=unordered");

112499 
	`sqlôe3DebugPrötf
("\n");

112500 
ii
=0; ii<
pWInfo
->
nLevñ
; ii++){

112501 
	`whîeLo›Pröt
(
pWInfo
->
a
[
ii
].
pWLo›
, 
pTabLi°
);

112506 if–
pWInfo
->
nLevñ
>=2

112507 && 
pResu…Së
!=0

112508 && 
	`O±imiz©i⁄E«bÀd
(
db
, 
SQLITE_OmôNo›Joö
)

112510 
Bômask
 
èbU£d
 = 
	`ex¥Li°TabÀUßge
(
pMaskSë
, 
pResu…Së
);

112511 if–
sWLB
.
pOrdîBy
 ) 
èbU£d
 |
	`ex¥Li°TabÀUßge
(
pMaskSë
, sWLB.pOrderBy);

112512  
pWInfo
->
nLevñ
>=2 ){

112513 
WhîeTîm
 *
pTîm
, *
pEnd
;

112514 
pLo›
 = 
pWInfo
->
a
[pWInfo->
nLevñ
-1].
pWLo›
;

112515 if–(
pWInfo
->
pTabLi°
->
a
[
pLo›
->
iTab
].
joöty≥
 & 
JT_LEFT
)==0 ) ;

112516 if–(
w˘æFœgs
 & 
WHERE_WANT_DISTINCT
)==0

112517 && (
pLo›
->
wsFœgs
 & 
WHERE_ONEROW
)==0

112521 if–(
èbU£d
 & 
pLo›
->
maskSñf
)!=0 ) ;

112522 
pEnd
 = 
sWLB
.
pWC
->
a
 + sWLB.pWC->
nTîm
;

112523 
pTîm
=
sWLB
.
pWC
->
a
;ÖTîm<
pEnd
;ÖTerm++){

112524 if–(
pTîm
->
¥îeqAŒ
 & 
pLo›
->
maskSñf
)!=0

112525 && !
	`Ex¥HasPr›îty
(
pTîm
->
pEx¥
, 
EP_FromJoö
)

112530 if–
pTîm
<
pEnd
 ) ;

112531 
	`WHERETRACE
(0xffff, ("-> dr›Üo› %¯nŸ u£d\n", 
pLo›
->
cId
));

112532 
pWInfo
->
nLevñ
--;

112533 
nTabLi°
--;

112536 
	`WHERETRACE
(0xffff,("*** Optimizer Finished ***\n"));

112537 
pWInfo
->
pP¨£
->
nQuîyLo›
 +pWInfo->
nRowOut
;

112544 
	`as£π
–(
w˘æFœgs
 & 
WHERE_ONEPASS_DESIRED
)==0 || 
pWInfo
->
nLevñ
==1 );

112545 if–(
w˘æFœgs
 & 
WHERE_ONEPASS_DESIRED
)!=0

112546 && (
pWInfo
->
a
[0].
pWLo›
->
wsFœgs
 & 
WHERE_ONEROW
)!=0 ){

112547 
pWInfo
->
okO√Pass
 = 1;

112548 
pWInfo
->
a
[0].
pWLo›
->
wsFœgs
 &~
WHERE_IDX_ONLY
;

112554 
nŸRódy
 = ~(
Bômask
)0;

112555 
ii
=0, 
pLevñ
=
pWInfo
->
a
; ii<
nTabLi°
; ii++,ÖLevel++){

112556 
TabÀ
 *
pTab
;

112557 
iDb
;

112558 
SrcLi°_ôem
 *
pTabIãm
;

112560 
pTabIãm
 = &
pTabLi°
->
a
[
pLevñ
->
iFrom
];

112561 
pTab
 = 
pTabIãm
->pTab;

112562 
iDb
 = 
	`sqlôe3SchemaToIndex
(
db
, 
pTab
->
pSchema
);

112563 
pLo›
 = 
pLevñ
->
pWLo›
;

112564 if–(
pTab
->
èbFœgs
 & 
TF_EphemîÆ
)!=0 ||ÖTab->
pSñe˘
 ){

112567 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


112568 if–(
pLo›
->
wsFœgs
 & 
WHERE_VIRTUALTABLE
)!=0 ){

112569 c⁄° *
pVTab
 = (c⁄° *)
	`sqlôe3GëVTabÀ
(
db
, 
pTab
);

112570 
iCur
 = 
pTabIãm
->
iCurs‹
;

112571 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_VO≥n
, 
iCur
, 0, 0, 
pVTab
, 
P4_VTAB
);

112572 }if–
	`IsVútuÆ
(
pTab
) ){

112576 if–(
pLo›
->
wsFœgs
 & 
WHERE_IDX_ONLY
)==0

112577 && (
w˘æFœgs
 & 
WHERE_OMIT_OPEN_CLOSE
)==0 ){

112578 
›
 = 
pWInfo
->
okO√Pass
 ? 
OP_O≥nWrôe
 : 
OP_O≥nRód
;

112579 
	`sqlôe3O≥nTabÀ
(
pP¨£
, 
pTabIãm
->
iCurs‹
, 
iDb
, 
pTab
, 
›
);

112580 
	`ã°ˇ£
–!
pWInfo
->
okO√Pass
 && 
pTab
->
nCﬁ
==
BMS
-1 );

112581 
	`ã°ˇ£
–!
pWInfo
->
okO√Pass
 && 
pTab
->
nCﬁ
==
BMS
 );

112582 if–!
pWInfo
->
okO√Pass
 && 
pTab
->
nCﬁ
<
BMS
 ){

112583 
Bômask
 
b
 = 
pTabIãm
->
cﬁU£d
;

112584 
n
 = 0;

112585 ; 
b
; b=b>>1, 
n
++){}

112586 
	`sqlôe3VdbeCh™geP4
(
v
, 
	`sqlôe3VdbeCuºítAddr
(v)-1,

112587 
	`SQLITE_INT_TO_PTR
(
n
), 
P4_INT32
);

112588 
	`as£π
–
n
<=
pTab
->
nCﬁ
 );

112591 
	`sqlôe3TabÀLock
(
pP¨£
, 
iDb
, 
pTab
->
äum
, 0,ÖTab->
zName
);

112593 if–
pLo›
->
wsFœgs
 & 
WHERE_INDEXED
 ){

112594 
Index
 *
pIx
 = 
pLo›
->
u
.
båì
.
pIndex
;

112595 
KeyInfo
 *
pKey
 = 
	`sqlôe3IndexKeyöfo
(
pP¨£
, 
pIx
);

112597 
iIndexCur
 = 
pLevñ
->
iIdxCur
 = iIdxCu∏? iIdxCu∏: 
pP¨£
->
nTab
++;

112598 
	`as£π
–
pIx
->
pSchema
==
pTab
->pSchema );

112599 
	`as£π
–
iIndexCur
>=0 );

112600 
	`sqlôe3VdbeAddOp4
(
v
, 
OP_O≥nRód
, 
iIndexCur
, 
pIx
->
äum
, 
iDb
,

112601 (*)
pKey
, 
P4_KEYINFO_HANDOFF
);

112602 
	`VdbeCommít
((
v
, "%s", 
pIx
->
zName
));

112604 
	`sqlôe3CodeVîifySchema
(
pP¨£
, 
iDb
);

112605 
nŸRódy
 &~
	`gëMask
(&
pWInfo
->
sMaskSë
, 
pTabIãm
->
iCurs‹
);

112607 
pWInfo
->
iT›
 = 
	`sqlôe3VdbeCuºítAddr
(
v
);

112608 if–
db
->
mÆlocFaûed
 ) 
whîeBegöEº‹
;

112614 
nŸRódy
 = ~(
Bômask
)0;

112615 
ii
=0; ii<
nTabLi°
; ii++){

112616 
pLevñ
 = &
pWInfo
->
a
[
ii
];

112617 #i‚de‡
SQLITE_OMIT_AUTOMATIC_INDEX


112618 if–(
pLevñ
->
pWLo›
->
wsFœgs
 & 
WHERE_AUTO_INDEX
)!=0 ){

112619 
	`c⁄°ru˘Autom©icIndex
(
pP¨£
, &
pWInfo
->
sWC
,

112620 &
pTabLi°
->
a
[
pLevñ
->
iFrom
], 
nŸRódy
,ÖLevel);

112621 if–
db
->
mÆlocFaûed
 ) 
whîeBegöEº‹
;

112624 
	`ex∂aöO√Sˇn
(
pP¨£
, 
pTabLi°
, 
pLevñ
, 
ii
,ÖLevñ->
iFrom
, 
w˘æFœgs
);

112625 
pLevñ
->
addrBody
 = 
	`sqlôe3VdbeCuºítAddr
(
v
);

112626 
nŸRódy
 = 
	`codeO√Lo›Sèπ
(
pWInfo
, 
ii
,ÇotReady);

112627 
pWInfo
->
iC⁄töue
 = 
pLevñ
->
addrC⁄t
;

112631  
pWInfo
;

112634 
whîeBegöEº‹
:

112635 if–
pWInfo
 ){

112636 
pP¨£
->
nQuîyLo›
 = 
pWInfo
->
ßvedNQuîyLo›
;

112637 
	`whîeInfoFªe
(
db
, 
pWInfo
);

112646 
SQLITE_PRIVATE
 
	`sqlôe3WhîeEnd
(
WhîeInfo
 *
pWInfo
){

112647 
P¨£
 *
pP¨£
 = 
pWInfo
->pParse;

112648 
Vdbe
 *
v
 = 
pP¨£
->
pVdbe
;

112649 
i
;

112650 
WhîeLevñ
 *
pLevñ
;

112651 
WhîeLo›
 *
pLo›
;

112652 
SrcLi°
 *
pTabLi°
 = 
pWInfo
->pTabList;

112653 
sqlôe3
 *
db
 = 
pP¨£
->db;

112657 
	`sqlôe3Ex¥CacheCÀ¨
(
pP¨£
);

112658 
i
=
pWInfo
->
nLevñ
-1; i>=0; i--){

112659 
pLevñ
 = &
pWInfo
->
a
[
i
];

112660 
pLo›
 = 
pLevñ
->
pWLo›
;

112661 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
pLevñ
->
addrC⁄t
);

112662 if–
pLevñ
->
›
!=
OP_No›
 ){

112663 
	`sqlôe3VdbeAddOp2
(
v
, 
pLevñ
->
›
,ÖLevñ->
p1
,ÖLevñ->
p2
);

112664 
	`sqlôe3VdbeCh™geP5
(
v
, 
pLevñ
->
p5
);

112666 if–
pLo›
->
wsFœgs
 & 
WHERE_IN_ABLE
 && 
pLevñ
->
u
.
ö
.
nIn
>0 ){

112667 
InLo›
 *
pIn
;

112668 
j
;

112669 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
pLevñ
->
addrNxt
);

112670 
j
=
pLevñ
->
u
.
ö
.
nIn
, 
pIn
=&pLevñ->u.ö.
aInLo›
[j-1]; j>0; j--,ÖIn--){

112671 
	`sqlôe3VdbeJumpHîe
(
v
, 
pIn
->
addrInT›
+1);

112672 
	`sqlôe3VdbeAddOp2
(
v
, 
pIn
->
eEndLo›Op
,ÖIn->
iCur
,ÖIn->
addrInT›
);

112673 
	`sqlôe3VdbeJumpHîe
(
v
, 
pIn
->
addrInT›
-1);

112675 
	`sqlôe3DbFªe
(
db
, 
pLevñ
->
u
.
ö
.
aInLo›
);

112677 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
pLevñ
->
addrBrk
);

112678 if–
pLevñ
->
iLe·Joö
 ){

112679 
addr
;

112680 
addr
 = 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_IfPos
, 
pLevñ
->
iLe·Joö
);

112681 
	`as£π
–(
pLo›
->
wsFœgs
 & 
WHERE_IDX_ONLY
)==0

112682 || (
pLo›
->
wsFœgs
 & 
WHERE_INDEXED
)!=0 );

112683 if–(
pLo›
->
wsFœgs
 & 
WHERE_IDX_ONLY
)==0 ){

112684 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_NuŒRow
, 
pTabLi°
->
a
[
i
].
iCurs‹
);

112686 if–
pLo›
->
wsFœgs
 & 
WHERE_INDEXED
 ){

112687 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_NuŒRow
, 
pLevñ
->
iIdxCur
);

112689 if–
pLevñ
->
›
==
OP_Rëu∫
 ){

112690 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_Gosub
, 
pLevñ
->
p1
,ÖLevñ->
addrFú°
);

112692 
	`sqlôe3VdbeAddOp2
(
v
, 
OP_GŸo
, 0, 
pLevñ
->
addrFú°
);

112694 
	`sqlôe3VdbeJumpHîe
(
v
, 
addr
);

112701 
	`sqlôe3VdbeResﬁveLabñ
(
v
, 
pWInfo
->
iBªak
);

112705 
	`as£π
–
pWInfo
->
nLevñ
<=
pTabLi°
->
nSrc
 );

112706 
i
=0, 
pLevñ
=
pWInfo
->
a
; i<pWInfo->
nLevñ
; i++,ÖLevel++){

112707 
Index
 *
pIdx
 = 0;

112708 
SrcLi°_ôem
 *
pTabIãm
 = &
pTabLi°
->
a
[
pLevñ
->
iFrom
];

112709 
TabÀ
 *
pTab
 = 
pTabIãm
->pTab;

112710 
	`as£π
–
pTab
!=0 );

112711 
pLo›
 = 
pLevñ
->
pWLo›
;

112712 if–(
pTab
->
èbFœgs
 & 
TF_EphemîÆ
)==0

112713 && 
pTab
->
pSñe˘
==0

112714 && (
pWInfo
->
w˘æFœgs
 & 
WHERE_OMIT_OPEN_CLOSE
)==0

112716 
ws
 = 
pLo›
->
wsFœgs
;

112717 if–!
pWInfo
->
okO√Pass
 && (
ws
 & 
WHERE_IDX_ONLY
)==0 ){

112718 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Clo£
, 
pTabIãm
->
iCurs‹
);

112720 if–(
ws
 & 
WHERE_INDEXED
)!=0 && (w†& (
WHERE_IPK
|
WHERE_AUTO_INDEX
))==0 ){

112721 
	`sqlôe3VdbeAddOp1
(
v
, 
OP_Clo£
, 
pLevñ
->
iIdxCur
);

112736 if–
pLo›
->
wsFœgs
 & (
WHERE_INDEXED
|
WHERE_IDX_ONLY
) ){

112737 
pIdx
 = 
pLo›
->
u
.
båì
.
pIndex
;

112738 }if–
pLo›
->
wsFœgs
 & 
WHERE_MULTI_OR
 ){

112739 
pIdx
 = 
pLevñ
->
u
.
pCovidx
;

112741 if–
pIdx
 && !
db
->
mÆlocFaûed
 ){

112742 
k
, 
j
, 
œ°
;

112743 
VdbeOp
 *
pOp
;

112745 
œ°
 = 
	`sqlôe3VdbeCuºítAddr
(
v
);

112746 
k
 = 
pLevñ
->
addrBody
;

112747 
pOp
 = 
	`sqlôe3VdbeGëOp
(
v
, 
k
);

112748 ; 
k
<
œ°
; k++, 
pOp
++){

112749 if–
pOp
->
p1
!=
pLevñ
->
iTabCur
 ) ;

112750 if–
pOp
->
›code
==
OP_Cﬁumn
 ){

112751 
j
=0; j<
pIdx
->
nCﬁumn
; j++){

112752 if–
pOp
->
p2
==
pIdx
->
aiCﬁumn
[
j
] ){

112753 
pOp
->
p2
 = 
j
;

112754 
pOp
->
p1
 = 
pLevñ
->
iIdxCur
;

112758 
	`as£π
–(
pLo›
->
wsFœgs
 & 
WHERE_IDX_ONLY
)==0 || 
j
<
pIdx
->
nCﬁumn
 );

112759 }if–
pOp
->
›code
==
OP_Rowid
 ){

112760 
pOp
->
p1
 = 
pLevñ
->
iIdxCur
;

112761 
pOp
->
›code
 = 
OP_IdxRowid
;

112769 
pP¨£
->
nQuîyLo›
 = 
pWInfo
->
ßvedNQuîyLo›
;

112770 
	`whîeInfoFªe
(
db
, 
pWInfo
);

112794 
	#YYNOERRORRECOVERY
 1

	)

112799 
	#yyã°ˇ£
(
X
Ë
	`ã°ˇ£
(X)

	)

112805 
	sLimôVÆ
 {

112806 
Ex¥
 *
pLimô
;

112807 
Ex¥
 *
pOff£t
;

112814 
	sLikeOp
 {

112815 
Tokí
 
eO≥øt‹
;

112816 
bNŸ
;

112828 
	sTrigEvít
 { 
a
; 
IdLi°
 * 
b
; };

112833 
	sAâachKey
 { 
ty≥
; 
Tokí
 
key
; };

112838 
	sVÆueLi°
 {

112839 
Ex¥Li°
 *
pLi°
;

112840 
Sñe˘
 *
pSñe˘
;

112848 
	`•™Së
(
Ex¥S∑n
 *
pOut
, 
Tokí
 *
pSèπ
, Tokí *
pEnd
){

112849 
pOut
->
zSèπ
 = 
pSèπ
->
z
;

112850 
pOut
->
zEnd
 = &
pEnd
->
z
[pEnd->
n
];

112857 
	`•™Ex¥
(
Ex¥S∑n
 *
pOut
, 
P¨£
 *
pP¨£
, 
›
, 
Tokí
 *
pVÆue
){

112858 
pOut
->
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
›
, 0, 0, 
pVÆue
);

112859 
pOut
->
zSèπ
 = 
pVÆue
->
z
;

112860 
pOut
->
zEnd
 = &
pVÆue
->
z
[pVÆue->
n
];

112866 
	`•™Bö¨yEx¥
(

112867 
Ex¥S∑n
 *
pOut
,

112868 
P¨£
 *
pP¨£
,

112869 
›
,

112870 
Ex¥S∑n
 *
pLe·
,

112871 
Ex¥S∑n
 *
pRight


112873 
pOut
->
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
›
, 
pLe·
->pEx¥, 
pRight
->pExpr, 0);

112874 
pOut
->
zSèπ
 = 
pLe·
->zStart;

112875 
pOut
->
zEnd
 = 
pRight
->zEnd;

112880 
	`•™U«ryPo°fix
(

112881 
Ex¥S∑n
 *
pOut
,

112882 
P¨£
 *
pP¨£
,

112883 
›
,

112884 
Ex¥S∑n
 *
pO≥ønd
,

112885 
Tokí
 *
pPo°Op


112887 
pOut
->
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
›
, 
pO≥ønd
->pExpr, 0, 0);

112888 
pOut
->
zSèπ
 = 
pO≥ønd
->zStart;

112889 
pOut
->
zEnd
 = &
pPo°Op
->
z
[pPo°Op->
n
];

112894 
	`bö¨yToU«ryIfNuŒ
(
P¨£
 *
pP¨£
, 
Ex¥
 *
pY
, Ex¥ *
pA
, 
›
){

112895 
sqlôe3
 *
db
 = 
pP¨£
->db;

112896 if–
db
->
mÆlocFaûed
==0 && 
pY
->
›
==
TK_NULL
 ){

112897 
pA
->
›
 = (
u8
)op;

112898 
	`sqlôe3Ex¥Dñëe
(
db
, 
pA
->
pRight
);

112899 
pA
->
pRight
 = 0;

112905 
	`•™U«ryPªfix
(

112906 
Ex¥S∑n
 *
pOut
,

112907 
P¨£
 *
pP¨£
,

112908 
›
,

112909 
Ex¥S∑n
 *
pO≥ønd
,

112910 
Tokí
 *
pPªOp


112912 
pOut
->
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
›
, 
pO≥ønd
->pExpr, 0, 0);

112913 
pOut
->
zSèπ
 = 
pPªOp
->
z
;

112914 
pOut
->
zEnd
 = 
pO≥ønd
->zEnd;

112928 #i‚de‡
INTERFACE


112929 
	#INTERFACE
 1

	)

112965 
	#YYCODETYPE
 

	)

112966 
	#YYNOCODE
 249

	)

112967 
	#YYACTIONTYPE
 

	)

112968 
	#YYWILDCARD
 67

	)

112969 
	#sqlôe3P¨£rTOKENTYPE
 
Tokí


	)

112971 
yyöô
;

112972 
sqlôe3P¨£rTOKENTYPE
 
yy0
;

112973 
Sñe˘
* 
yy43
;

112974 
TriggîSãp
* 
yy75
;

112975 
LimôVÆ
 
yy84
;

112976 
Ex¥S∑n
 
yy86
;

112977 
LikeOp
 
yy87
;

112978 °ru˘ {
vÆue
; 
mask
;} 
yy207
;

112979 
Ex¥Li°
* 
yy242
;

112980 
u8
 
yy306
;

112981 
yy316
;

112982 
VÆueLi°
 
yy323
;

112983 
IdLi°
* 
yy352
;

112984 
TrigEvít
 
yy354
;

112985 
SrcLi°
* 
yy419
;

112986 
Ex¥
* 
yy450
;

112987 
u16
 
yy473
;

112988 } 
	tYYMINORTYPE
;

112989 #i‚de‡
YYSTACKDEPTH


112990 
	#YYSTACKDEPTH
 100

	)

112992 
	#sqlôe3P¨£rARG_SDECL
 
P¨£
 *
pP¨£
;

	)

112993 
	#sqlôe3P¨£rARG_PDECL
 ,
P¨£
 *
pP¨£


	)

112994 
	#sqlôe3P¨£rARG_FETCH
 
P¨£
 *
pP¨£
 = 
yypP¨£r
->
	)
pParse

112995 
	#sqlôe3P¨£rARG_STORE
 
yypP¨£r
->
pP¨£
 = 
	)
pParse

112996 
	#YYNSTATE
 627

	)

112997 
	#YYNRULE
 324

	)

112998 
	#YYFALLBACK
 1

	)

112999 
	#YY_NO_ACTION
 (
YYNSTATE
+
YYNRULE
+2)

	)

113000 
	#YY_ACCEPT_ACTION
 (
YYNSTATE
+
YYNRULE
+1)

	)

113001 
	#YY_ERROR_ACTION
 (
YYNSTATE
+
YYNRULE
)

	)

113005 c⁄° 
YYMINORTYPE
 
yyzîomö‹
 = { 0 };

113015 #i‚de‡
yyã°ˇ£


113016 
	#yyã°ˇ£
(
X
)

	)

113067 
	#YY_ACTTAB_COUNT
 (1576)

	)

113068 c⁄° 
YYACTIONTYPE
 
yy_a˘i⁄
[] = {

113228 c⁄° 
YYCODETYPE
 
yy_lookahód
[] = {

113388 
	#YY_SHIFT_USE_DFLT
 (-70)

	)

113389 
	#YY_SHIFT_COUNT
 (418)

	)

113390 
	#YY_SHIFT_MIN
 (-69)

	)

113391 
	#YY_SHIFT_MAX
 (1490)

	)

113392 c⁄° 
yy_shi·_of°
[] = {

113436 
	#YY_REDUCE_USE_DFLT
 (-169)

	)

113437 
	#YY_REDUCE_COUNT
 (310)

	)

113438 
	#YY_REDUCE_MIN
 (-168)

	)

113439 
	#YY_REDUCE_MAX
 (1396)

	)

113440 c⁄° 
yy_ªdu˚_of°
[] = {

113474 c⁄° 
YYACTIONTYPE
 
yy_deÁu…
[] = {

113550 #ifde‡
YYFALLBACK


113551 c⁄° 
YYCODETYPE
 
yyFÆlback
[] = {

113634 
	syySèckE¡ry
 {

113635 
YYACTIONTYPE
 
°©ío
;

113636 
YYCODETYPE
 
maj‹
;

113638 
YYMINORTYPE
 
mö‹
;

113641 
yySèckE¡ry
 
	tyySèckE¡ry
;

113645 
	syyP¨£r
 {

113646 
yyidx
;

113647 #ifde‡
YYTRACKMAXSTACKDEPTH


113648 
yyidxMax
;

113650 
yyîr˙t
;

113651 
sqlôe3P¨£rARG_SDECL


113652 #i‡
YYSTACKDEPTH
<=0

113653 
yy°ksz
;

113654 
yySèckE¡ry
 *
yy°ack
;

113656 
yySèckE¡ry
 
yy°ack
[
YYSTACKDEPTH
];

113659 
yyP¨£r
 
	tyyP¨£r
;

113661 #i‚de‡
NDEBUG


113663 
FILE
 *
yyTø˚FILE
 = 0;

113664 *
yyTø˚Prom±
 = 0;

113667 #i‚de‡
NDEBUG


113685 
SQLITE_PRIVATE
 
	`sqlôe3P¨£rTø˚
(
FILE
 *
Tø˚FILE
, *
zTø˚Prom±
){

113686 
yyTø˚FILE
 = 
Tø˚FILE
;

113687 
yyTø˚Prom±
 = 
zTø˚Prom±
;

113688 if–
yyTø˚FILE
==0 ) 
yyTø˚Prom±
 = 0;

113689 if–
yyTø˚Prom±
==0 ) 
yyTø˚FILE
 = 0;

113693 #i‚de‡
NDEBUG


113696 c⁄° *c⁄° 
yyTokíName
[] = {

113762 #i‚de‡
NDEBUG


113765 c⁄° *c⁄° 
yyRuÀName
[] = {

114094 #i‡
YYSTACKDEPTH
<=0

114098 
	`yyGrowSèck
(
yyP¨£r
 *
p
){

114099 
√wSize
;

114100 
yySèckE¡ry
 *
pNew
;

114102 
√wSize
 = 
p
->
yy°ksz
*2 + 100;

114103 
pNew
 = 
	`ªÆloc
(
p
->
yy°ack
, 
√wSize
*(pNew[0]));

114104 if–
pNew
 ){

114105 
p
->
yy°ack
 = 
pNew
;

114106 
p
->
yy°ksz
 = 
√wSize
;

114107 #i‚de‡
NDEBUG


114108 if–
yyTø˚FILE
 ){

114109 
	`Ârötf
(
yyTø˚FILE
,"%sStack growsÅo %dÉntries!\n",

114110 
yyTø˚Prom±
, 
p
->
yy°ksz
);

114129 
SQLITE_PRIVATE
 *
	`sqlôe3P¨£rAŒoc
(*(*
mÆlocProc
)(
size_t
)){

114130 
yyP¨£r
 *
pP¨£r
;

114131 
pP¨£r
 = (
yyP¨£r
*)(*
mÆlocProc
)–(
size_t
)(yyParser) );

114132 if–
pP¨£r
 ){

114133 
pP¨£r
->
yyidx
 = -1;

114134 #ifde‡
YYTRACKMAXSTACKDEPTH


114135 
pP¨£r
->
yyidxMax
 = 0;

114137 #i‡
YYSTACKDEPTH
<=0

114138 
pP¨£r
->
yy°ack
 = 
NULL
;

114139 
pP¨£r
->
yy°ksz
 = 0;

114140 
	`yyGrowSèck
(
pP¨£r
);

114143  
pP¨£r
;

114151 
	`yy_de°ru˘‹
(

114152 
yyP¨£r
 *
yypP¨£r
,

114153 
YYCODETYPE
 
yymaj‹
,

114154 
YYMINORTYPE
 *
yypmö‹


114156 
sqlôe3P¨£rARG_FETCH
;

114157  
yymaj‹
 ){

114171 
	`sqlôe3Sñe˘Dñëe
(
pP¨£
->
db
, (
yypmö‹
->
yy43
));

114177 
	`sqlôe3Ex¥Dñëe
(
pP¨£
->
db
, (
yypmö‹
->
yy86
).
pEx¥
);

114192 
	`sqlôe3Ex¥Li°Dñëe
(
pP¨£
->
db
, (
yypmö‹
->
yy242
));

114200 
	`sqlôe3SrcLi°Dñëe
(
pP¨£
->
db
, (
yypmö‹
->
yy419
));

114211 
	`sqlôe3Ex¥Dñëe
(
pP¨£
->
db
, (
yypmö‹
->
yy450
));

114218 
	`sqlôe3IdLi°Dñëe
(
pP¨£
->
db
, (
yypmö‹
->
yy352
));

114224 
	`sqlôe3Ex¥Li°Dñëe
(
pP¨£
->
db
, (
yypmö‹
->
yy323
).
pLi°
);

114225 
	`sqlôe3Sñe˘Dñëe
(
pP¨£
->
db
, (
yypmö‹
->
yy323
).
pSñe˘
);

114232 
	`sqlôe3DñëeTriggîSãp
(
pP¨£
->
db
, (
yypmö‹
->
yy75
));

114237 
	`sqlôe3IdLi°Dñëe
(
pP¨£
->
db
, (
yypmö‹
->
yy354
).
b
);

114252 
	`yy_p›_∑r£r_°ack
(
yyP¨£r
 *
pP¨£r
){

114253 
YYCODETYPE
 
yymaj‹
;

114254 
yySèckE¡ry
 *
yytos
 = &
pP¨£r
->
yy°ack
[pP¨£r->
yyidx
];

114258 if–
	`NEVER
(
pP¨£r
->
yyidx
<0) )  0;

114259 #i‚de‡
NDEBUG


114260 if–
yyTø˚FILE
 && 
pP¨£r
->
yyidx
>=0 ){

114261 
	`Ârötf
(
yyTø˚FILE
,"%sPopping %s\n",

114262 
yyTø˚Prom±
,

114263 
yyTokíName
[
yytos
->
maj‹
]);

114266 
yymaj‹
 = 
yytos
->
maj‹
;

114267 
	`yy_de°ru˘‹
(
pP¨£r
, 
yymaj‹
, &
yytos
->
mö‹
);

114268 
pP¨£r
->
yyidx
--;

114269  
yymaj‹
;

114284 
SQLITE_PRIVATE
 
	`sqlôe3P¨£rFªe
(

114285 *
p
,

114286 (*
‰ìProc
)(*)

114288 
yyP¨£r
 *
pP¨£r
 = (yyP¨£r*)
p
;

114291 if–
	`NEVER
(
pP¨£r
==0) ) ;

114292  
pP¨£r
->
yyidx
>=0 ) 
	`yy_p›_∑r£r_°ack
(pParser);

114293 #i‡
YYSTACKDEPTH
<=0

114294 
	`‰ì
(
pP¨£r
->
yy°ack
);

114296 (*
‰ìProc
)((*)
pP¨£r
);

114302 #ifde‡
YYTRACKMAXSTACKDEPTH


114303 
SQLITE_PRIVATE
 
	`sqlôe3P¨£rSèckPók
(*
p
){

114304 
yyP¨£r
 *
pP¨£r
 = (yyP¨£r*)
p
;

114305  
pP¨£r
->
yyidxMax
;

114317 
	`yy_föd_shi·_a˘i⁄
(

114318 
yyP¨£r
 *
pP¨£r
,

114319 
YYCODETYPE
 
iLookAhód


114321 
i
;

114322 
°©ío
 = 
pP¨£r
->
yy°ack
[pP¨£r->
yyidx
].stateno;

114324 if–
°©ío
>
YY_SHIFT_COUNT


114325 || (
i
 = 
yy_shi·_of°
[
°©ío
])==
YY_SHIFT_USE_DFLT
 ){

114326  
yy_deÁu…
[
°©ío
];

114328 
	`as£π
–
iLookAhód
!=
YYNOCODE
 );

114329 
i
 +
iLookAhód
;

114330 if–
i
<0 || i>=
YY_ACTTAB_COUNT
 || 
yy_lookahód
[i]!=
iLookAhód
 ){

114331 if–
iLookAhód
>0 ){

114332 #ifde‡
YYFALLBACK


114333 
YYCODETYPE
 
iFÆlback
;

114334 if–
iLookAhód
<(
yyFÆlback
)/(yyFallback[0])

114335 && (
iFÆlback
 = 
yyFÆlback
[
iLookAhód
])!=0 ){

114336 #i‚de‡
NDEBUG


114337 if–
yyTø˚FILE
 ){

114338 
	`Ârötf
(
yyTø˚FILE
, "%sFALLBACK %s => %s\n",

114339 
yyTø˚Prom±
, 
yyTokíName
[
iLookAhód
], yyTokíName[
iFÆlback
]);

114342  
	`yy_föd_shi·_a˘i⁄
(
pP¨£r
, 
iFÆlback
);

114345 #ifde‡
YYWILDCARD


114347 
j
 = 
i
 - 
iLookAhód
 + 
YYWILDCARD
;

114349 #i‡
YY_SHIFT_MIN
+
YYWILDCARD
<0

114350 
j
>=0 &&

114352 #i‡
YY_SHIFT_MAX
+
YYWILDCARD
>=
YY_ACTTAB_COUNT


114353 
j
<
YY_ACTTAB_COUNT
 &&

114355 
yy_lookahód
[
j
]==
YYWILDCARD


114357 #i‚de‡
NDEBUG


114358 if–
yyTø˚FILE
 ){

114359 
	`Ârötf
(
yyTø˚FILE
, "%sWILDCARD %s => %s\n",

114360 
yyTø˚Prom±
, 
yyTokíName
[
iLookAhód
], yyTokíName[
YYWILDCARD
]);

114363  
yy_a˘i⁄
[
j
];

114368  
yy_deÁu…
[
°©ío
];

114370  
yy_a˘i⁄
[
i
];

114382 
	`yy_föd_ªdu˚_a˘i⁄
(

114383 
°©ío
,

114384 
YYCODETYPE
 
iLookAhód


114386 
i
;

114387 #ifde‡
YYERRORSYMBOL


114388 if–
°©ío
>
YY_REDUCE_COUNT
 ){

114389  
yy_deÁu…
[
°©ío
];

114392 
	`as£π
–
°©ío
<=
YY_REDUCE_COUNT
 );

114394 
i
 = 
yy_ªdu˚_of°
[
°©ío
];

114395 
	`as£π
–
i
!=
YY_REDUCE_USE_DFLT
 );

114396 
	`as£π
–
iLookAhód
!=
YYNOCODE
 );

114397 
i
 +
iLookAhód
;

114398 #ifde‡
YYERRORSYMBOL


114399 if–
i
<0 || i>=
YY_ACTTAB_COUNT
 || 
yy_lookahód
[i]!=
iLookAhód
 ){

114400  
yy_deÁu…
[
°©ío
];

114403 
	`as£π
–
i
>=0 && i<
YY_ACTTAB_COUNT
 );

114404 
	`as£π
–
yy_lookahód
[
i
]==
iLookAhód
 );

114406  
yy_a˘i⁄
[
i
];

114412 
	`yySèckOvîÊow
(
yyP¨£r
 *
yypP¨£r
, 
YYMINORTYPE
 *
yypMö‹
){

114413 
sqlôe3P¨£rARG_FETCH
;

114414 
yypP¨£r
->
yyidx
--;

114415 #i‚de‡
NDEBUG


114416 if–
yyTø˚FILE
 ){

114417 
	`Ârötf
(
yyTø˚FILE
,"%sSèck OvîÊow!\n",
yyTø˚Prom±
);

114420  
yypP¨£r
->
yyidx
>=0 ) 
	`yy_p›_∑r£r_°ack
(yypParser);

114424 
	`UNUSED_PARAMETER
(
yypMö‹
);

114425 
	`sqlôe3Eº‹Msg
(
pP¨£
, "parser stack overflow");

114426 
sqlôe3P¨£rARG_STORE
;

114432 
	`yy_shi·
(

114433 
yyP¨£r
 *
yypP¨£r
,

114434 
yyNewSèã
,

114435 
yyMaj‹
,

114436 
YYMINORTYPE
 *
yypMö‹


114438 
yySèckE¡ry
 *
yytos
;

114439 
yypP¨£r
->
yyidx
++;

114440 #ifde‡
YYTRACKMAXSTACKDEPTH


114441 if–
yypP¨£r
->
yyidx
>yypP¨£r->
yyidxMax
 ){

114442 
yypP¨£r
->
yyidxMax
 = yypP¨£r->
yyidx
;

114445 #i‡
YYSTACKDEPTH
>0

114446 if–
yypP¨£r
->
yyidx
>=
YYSTACKDEPTH
 ){

114447 
	`yySèckOvîÊow
(
yypP¨£r
, 
yypMö‹
);

114451 if–
yypP¨£r
->
yyidx
>=yypP¨£r->
yy°ksz
 ){

114452 
	`yyGrowSèck
(
yypP¨£r
);

114453 if–
yypP¨£r
->
yyidx
>=yypP¨£r->
yy°ksz
 ){

114454 
	`yySèckOvîÊow
(
yypP¨£r
, 
yypMö‹
);

114459 
yytos
 = &
yypP¨£r
->
yy°ack
[yypP¨£r->
yyidx
];

114460 
yytos
->
°©ío
 = (
YYACTIONTYPE
)
yyNewSèã
;

114461 
yytos
->
maj‹
 = (
YYCODETYPE
)
yyMaj‹
;

114462 
yytos
->
mö‹
 = *
yypMö‹
;

114463 #i‚de‡
NDEBUG


114464 if–
yyTø˚FILE
 && 
yypP¨£r
->
yyidx
>0 ){

114465 
i
;

114466 
	`Ârötf
(
yyTø˚FILE
,"%sShi· %d\n",
yyTø˚Prom±
,
yyNewSèã
);

114467 
	`Ârötf
(
yyTø˚FILE
,"%sSèck:",
yyTø˚Prom±
);

114468 
i
=1; i<=
yypP¨£r
->
yyidx
; i++)

114469 
	`Ârötf
(
yyTø˚FILE
," %s",
yyTokíName
[
yypP¨£r
->
yy°ack
[
i
].
maj‹
]);

114470 
	`Ârötf
(
yyTø˚FILE
,"\n");

114479 
YYCODETYPE
 
lhs
;

114480 
ƒhs
;

114481 } 
yyRuÀInfo
[] = {

114808 
	`yy_ac˚±
(
yyP¨£r
*);

114814 
	`yy_ªdu˚
(

114815 
yyP¨£r
 *
yypP¨£r
,

114816 
yyruÀno


114818 
yygŸo
;

114819 
yya˘
;

114820 
YYMINORTYPE
 
yygŸomö‹
;

114821 
yySèckE¡ry
 *
yym•
;

114822 
yysize
;

114823 
sqlôe3P¨£rARG_FETCH
;

114824 
yym•
 = &
yypP¨£r
->
yy°ack
[yypP¨£r->
yyidx
];

114825 #i‚de‡
NDEBUG


114826 if–
yyTø˚FILE
 && 
yyruÀno
>=0

114827 && 
yyruÀno
<()((
yyRuÀName
)/(yyRuleName[0])) ){

114828 
	`Ârötf
(
yyTø˚FILE
, "%sRedu˚ [%s].\n", 
yyTø˚Prom±
,

114829 
yyRuÀName
[
yyruÀno
]);

114848 
yygŸomö‹
 = 
yyzîomö‹
;

114851  
yyruÀno
 ){

114861 { 
	`sqlôe3BegöP¨£
(
pP¨£
, 0); }

114864 { 
	`sqlôe3BegöP¨£
(
pP¨£
, 1); }

114867 { 
	`sqlôe3BegöP¨£
(
pP¨£
, 2); }

114870 { 
	`sqlôe3FöishCodög
(
pP¨£
); }

114873 {
	`sqlôe3BegöTønß˘i⁄
(
pP¨£
, 
yym•
[-1].
mö‹
.
yy316
);}

114876 {
yygŸomö‹
.
yy316
 = 
TK_DEFERRED
;}

114879 15: 
	`yyã°ˇ£
(
yyruÀno
==15);

114880 16: 
	`yyã°ˇ£
(
yyruÀno
==16);

114881 115: 
	`yyã°ˇ£
(
yyruÀno
==115);

114882 117: 
	`yyã°ˇ£
(
yyruÀno
==117);

114883 {
yygŸomö‹
.
yy316
 = 
yym•
[0].
maj‹
;}

114886 18: 
	`yyã°ˇ£
(
yyruÀno
==18);

114887 {
	`sqlôe3CommôTønß˘i⁄
(
pP¨£
);}

114890 {
	`sqlôe3RﬁlbackTønß˘i⁄
(
pP¨£
);}

114894 
	`sqlôe3Savïoöt
(
pP¨£
, 
SAVEPOINT_BEGIN
, &
yym•
[0].
mö‹
.
yy0
);

114899 
	`sqlôe3Savïoöt
(
pP¨£
, 
SAVEPOINT_RELEASE
, &
yym•
[0].
mö‹
.
yy0
);

114904 
	`sqlôe3Savïoöt
(
pP¨£
, 
SAVEPOINT_ROLLBACK
, &
yym•
[0].
mö‹
.
yy0
);

114909 
	`sqlôe3SèπTabÀ
(
pP¨£
,&
yym•
[-1].
mö‹
.
yy0
,&yym•[0].mö‹.yy0,yym•[-4].mö‹.
yy316
,0,0,yymsp[-2].minor.yy316);

114914 
pP¨£
->
db
->
lookaside
.
bE«bÀd
 = 0;

114915 
yygŸomö‹
.
yy0
 = 
yym•
[0].
mö‹
.yy0;

114919 31: 
	`yyã°ˇ£
(
yyruÀno
==31);

114920 69: 
	`yyã°ˇ£
(
yyruÀno
==69);

114921 82: 
	`yyã°ˇ£
(
yyruÀno
==82);

114922 84: 
	`yyã°ˇ£
(
yyruÀno
==84);

114923 86: 
	`yyã°ˇ£
(
yyruÀno
==86);

114924 98: 
	`yyã°ˇ£
(
yyruÀno
==98);

114925 109: 
	`yyã°ˇ£
(
yyruÀno
==109);

114926 221: 
	`yyã°ˇ£
(
yyruÀno
==221);

114927 224: 
	`yyã°ˇ£
(
yyruÀno
==224);

114928 {
yygŸomö‹
.
yy316
 = 0;}

114931 30: 
	`yyã°ˇ£
(
yyruÀno
==30);

114932 70: 
	`yyã°ˇ£
(
yyruÀno
==70);

114933 85: 
	`yyã°ˇ£
(
yyruÀno
==85);

114934 108: 
	`yyã°ˇ£
(
yyruÀno
==108);

114935 222: 
	`yyã°ˇ£
(
yyruÀno
==222);

114936 225: 
	`yyã°ˇ£
(
yyruÀno
==225);

114937 {
yygŸomö‹
.
yy316
 = 1;}

114941 
	`sqlôe3EndTabÀ
(
pP¨£
,&
yym•
[-1].
mö‹
.
yy0
,&yymsp[0].minor.yy0,0);

114946 
	`sqlôe3EndTabÀ
(
pP¨£
,0,0,
yym•
[0].
mö‹
.
yy43
);

114947 
	`sqlôe3Sñe˘Dñëe
(
pP¨£
->
db
, 
yym•
[0].
mö‹
.
yy43
);

114952 
yygŸomö‹
.
yy0
.
z
 = 
yym•
[-2].
mö‹
.yy0.z;

114953 
yygŸomö‹
.
yy0
.
n
 = ()(
pP¨£
->
sLa°Tokí
.
z
-
yym•
[-2].
mö‹
.yy0.z) +ÖParse->sLastToken.n;

114958 
	`sqlôe3AddCﬁumn
(
pP¨£
,&
yym•
[0].
mö‹
.
yy0
);

114959 
yygŸomö‹
.
yy0
 = 
yym•
[0].
mö‹
.yy0;

114960 
pP¨£
->
c⁄°øötName
.
n
 = 0;

114964 39: 
	`yyã°ˇ£
(
yyruÀno
==39);

114965 40: 
	`yyã°ˇ£
(
yyruÀno
==40);

114966 41: 
	`yyã°ˇ£
(
yyruÀno
==41);

114967 42: 
	`yyã°ˇ£
(
yyruÀno
==42);

114968 43: 
	`yyã°ˇ£
(
yyruÀno
==43);

114969 46: 
	`yyã°ˇ£
(
yyruÀno
==46);

114970 49: 
	`yyã°ˇ£
(
yyruÀno
==49);

114971 127: 
	`yyã°ˇ£
(
yyruÀno
==127);

114972 128: 
	`yyã°ˇ£
(
yyruÀno
==128);

114973 138: 
	`yyã°ˇ£
(
yyruÀno
==138);

114974 147: 
	`yyã°ˇ£
(
yyruÀno
==147);

114975 250: 
	`yyã°ˇ£
(
yyruÀno
==250);

114976 259: 
	`yyã°ˇ£
(
yyruÀno
==259);

114977 260: 
	`yyã°ˇ£
(
yyruÀno
==260);

114978 261: 
	`yyã°ˇ£
(
yyruÀno
==261);

114979 262: 
	`yyã°ˇ£
(
yyruÀno
==262);

114980 263: 
	`yyã°ˇ£
(
yyruÀno
==263);

114981 264: 
	`yyã°ˇ£
(
yyruÀno
==264);

114982 265: 
	`yyã°ˇ£
(
yyruÀno
==265);

114983 266: 
	`yyã°ˇ£
(
yyruÀno
==266);

114984 267: 
	`yyã°ˇ£
(
yyruÀno
==267);

114985 283: 
	`yyã°ˇ£
(
yyruÀno
==283);

114986 {
yygŸomö‹
.
yy0
 = 
yym•
[0].
mö‹
.yy0;}

114989 {
	`sqlôe3AddCﬁumnTy≥
(
pP¨£
,&
yym•
[0].
mö‹
.
yy0
);}

114993 
yygŸomö‹
.
yy0
.
z
 = 
yym•
[-3].
mö‹
.yy0.z;

114994 
yygŸomö‹
.
yy0
.
n
 = ()(&
yym•
[0].
mö‹
.yy0.
z
[yymsp[0].minor.yy0.n] - yymsp[-3].minor.yy0.z);

114999 
yygŸomö‹
.
yy0
.
z
 = 
yym•
[-5].
mö‹
.yy0.z;

115000 
yygŸomö‹
.
yy0
.
n
 = ()(&
yym•
[0].
mö‹
.yy0.
z
[yymsp[0].minor.yy0.n] - yymsp[-5].minor.yy0.z);

115004 {
yygŸomö‹
.
yy0
.
z
=
yym•
[-1].
mö‹
.yy0.z; yygŸomö‹.yy0.
n
=yymsp[0].minor.yy0.n+()(yymsp[0].minor.yy0.z-yymsp[-1].minor.yy0.z);}

115007 93: 
	`yyã°ˇ£
(
yyruÀno
==93);

115008 {
pP¨£
->
c⁄°øötName
 = 
yym•
[0].
mö‹
.
yy0
;}

115011 58: 
	`yyã°ˇ£
(
yyruÀno
==58);

115012 {
	`sqlôe3AddDeÁu…VÆue
(
pP¨£
,&
yym•
[0].
mö‹
.
yy86
);}

115015 {
	`sqlôe3AddDeÁu…VÆue
(
pP¨£
,&
yym•
[-1].
mö‹
.
yy86
);}

115019 
Ex¥S∑n
 
v
;

115020 
v
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_UMINUS
, 
yym•
[0].
mö‹
.
yy86
.pExpr, 0, 0);

115021 
v
.
zSèπ
 = 
yym•
[-1].
mö‹
.
yy0
.
z
;

115022 
v
.
zEnd
 = 
yym•
[0].
mö‹
.
yy86
.zEnd;

115023 
	`sqlôe3AddDeÁu…VÆue
(
pP¨£
,&
v
);

115028 
Ex¥S∑n
 
v
;

115029 
	`•™Ex¥
(&
v
, 
pP¨£
, 
TK_STRING
, &
yym•
[0].
mö‹
.
yy0
);

115030 
	`sqlôe3AddDeÁu…VÆue
(
pP¨£
,&
v
);

115034 {
	`sqlôe3AddNŸNuŒ
(
pP¨£
, 
yym•
[0].
mö‹
.
yy316
);}

115037 {
	`sqlôe3AddPrim¨yKey
(
pP¨£
,0,
yym•
[-1].
mö‹
.
yy316
,yymsp[0].minor.yy316,yymsp[-2].minor.yy316);}

115040 {
	`sqlôe3Cª©eIndex
(
pP¨£
,0,0,0,0,
yym•
[0].
mö‹
.
yy316
,0,0,0,0);}

115043 {
	`sqlôe3AddCheckC⁄°øöt
(
pP¨£
,
yym•
[-1].
mö‹
.
yy86
.
pEx¥
);}

115046 {
	`sqlôe3Cª©eF‹eignKey
(
pP¨£
,0,&
yym•
[-2].
mö‹
.
yy0
,yym•[-1].mö‹.
yy242
,yym•[0].mö‹.
yy316
);}

115049 {
	`sqlôe3De„rF‹eignKey
(
pP¨£
,
yym•
[0].
mö‹
.
yy316
);}

115052 {
	`sqlôe3AddCﬁœãTy≥
(
pP¨£
, &
yym•
[0].
mö‹
.
yy0
);}

115055 { 
yygŸomö‹
.
yy316
 = 
OE_N⁄e
*0x0101; }

115058 { 
yygŸomö‹
.
yy316
 = (
yym•
[-1].
mö‹
.yy316 & ~yym•[0].mö‹.
yy207
.
mask
Ë| yym•[0].mö‹.yy207.
vÆue
; }

115061 74: 
	`yyã°ˇ£
(
yyruÀno
==74);

115062 { 
yygŸomö‹
.
yy207
.
vÆue
 = 0; yygŸomö‹.yy207.
mask
 = 0x000000; }

115065 { 
yygŸomö‹
.
yy207
.
vÆue
 = 
yym•
[0].
mö‹
.
yy316
; yygŸomö‹.yy207.
mask
 = 0x0000ff; }

115068 { 
yygŸomö‹
.
yy207
.
vÆue
 = 
yym•
[0].
mö‹
.
yy316
<<8; yygŸomö‹.yy207.
mask
 = 0x00ff00; }

115071 { 
yygŸomö‹
.
yy316
 = 
OE_SëNuŒ
; }

115074 { 
yygŸomö‹
.
yy316
 = 
OE_SëDÊt
; }

115077 { 
yygŸomö‹
.
yy316
 = 
OE_Casˇde
; }

115080 { 
yygŸomö‹
.
yy316
 = 
OE_Re°ri˘
; }

115083 { 
yygŸomö‹
.
yy316
 = 
OE_N⁄e
; }

115086 99: 
	`yyã°ˇ£
(
yyruÀno
==99);

115087 101: 
	`yyã°ˇ£
(
yyruÀno
==101);

115088 104: 
	`yyã°ˇ£
(
yyruÀno
==104);

115089 {
yygŸomö‹
.
yy316
 = 
yym•
[0].
mö‹
.yy316;}

115092 {
yygŸomö‹
.
yy0
.
n
 = 0; yygŸomö‹.yy0.
z
 = 0;}

115095 {
yygŸomö‹
.
yy0
 = 
yym•
[-1].
mö‹
.yy0;}

115098 {
pP¨£
->
c⁄°øötName
.
n
 = 0;}

115101 {
	`sqlôe3AddPrim¨yKey
(
pP¨£
,
yym•
[-3].
mö‹
.
yy242
,yym•[0].mö‹.
yy316
,yymsp[-2].minor.yy316,0);}

115104 {
	`sqlôe3Cª©eIndex
(
pP¨£
,0,0,0,
yym•
[-2].
mö‹
.
yy242
,yym•[0].mö‹.
yy316
,0,0,0,0);}

115107 {
	`sqlôe3AddCheckC⁄°øöt
(
pP¨£
,
yym•
[-2].
mö‹
.
yy86
.
pEx¥
);}

115111 
	`sqlôe3Cª©eF‹eignKey
(
pP¨£
, 
yym•
[-6].
mö‹
.
yy242
, &yym•[-3].mö‹.
yy0
, yym•[-2].mö‹.yy242, yym•[-1].mö‹.
yy316
);

115112 
	`sqlôe3De„rF‹eignKey
(
pP¨£
, 
yym•
[0].
mö‹
.
yy316
);

115116 {
yygŸomö‹
.
yy316
 = 
OE_DeÁu…
;}

115119 {
yygŸomö‹
.
yy306
 = 
OE_DeÁu…
;}

115122 {
yygŸomö‹
.
yy306
 = (
u8
)
yym•
[0].
mö‹
.
yy316
;}

115125 {
yygŸomö‹
.
yy316
 = 
OE_Ign‹e
;}

115128 {
yygŸomö‹
.
yy316
 = 
OE_Rïœ˚
;}

115132 
	`sqlôe3Dr›TabÀ
(
pP¨£
, 
yym•
[0].
mö‹
.
yy419
, 0, yym•[-1].mö‹.
yy316
);

115137 
	`sqlôe3Cª©eVõw
(
pP¨£
, &
yym•
[-7].
mö‹
.
yy0
, &yym•[-3].mö‹.yy0, &yym•[-2].mö‹.yy0, yym•[0].mö‹.
yy43
, yym•[-6].mö‹.
yy316
, yymsp[-4].minor.yy316);

115142 
	`sqlôe3Dr›TabÀ
(
pP¨£
, 
yym•
[0].
mö‹
.
yy419
, 1, yym•[-1].mö‹.
yy316
);

115147 
Sñe˘De°
 
de°
 = {
SRT_Ouçut
, 0, 0, 0, 0};

115148 
	`sqlôe3Sñe˘
(
pP¨£
, 
yym•
[0].
mö‹
.
yy43
, &
de°
);

115149 
	`sqlôe3Ex∂aöBegö
(
pP¨£
->
pVdbe
);

115150 
	`sqlôe3Ex∂aöSñe˘
(
pP¨£
->
pVdbe
, 
yym•
[0].
mö‹
.
yy43
);

115151 
	`sqlôe3Ex∂aöFöish
(
pP¨£
->
pVdbe
);

115152 
	`sqlôe3Sñe˘Dñëe
(
pP¨£
->
db
, 
yym•
[0].
mö‹
.
yy43
);

115156 {
yygŸomö‹
.
yy43
 = 
yym•
[0].
mö‹
.yy43;}

115160 if–
yym•
[0].
mö‹
.
yy43
 ){

115161 
yym•
[0].
mö‹
.
yy43
->
›
 = (
u8
)yym•[-1].mö‹.
yy316
;

115162 
yym•
[0].
mö‹
.
yy43
->
pPri‹
 = yymsp[-2].minor.yy43;

115163 if–
yym•
[-1].
mö‹
.
yy316
!=
TK_ALL
 ) 
pP¨£
->
hasCompound
 = 1;

115165 
	`sqlôe3Sñe˘Dñëe
(
pP¨£
->
db
, 
yym•
[-2].
mö‹
.
yy43
);

115167 
yygŸomö‹
.
yy43
 = 
yym•
[0].
mö‹
.yy43;

115171 {
yygŸomö‹
.
yy316
 = 
TK_ALL
;}

115175 
yygŸomö‹
.
yy43
 = 
	`sqlôe3Sñe˘New
(
pP¨£
,
yym•
[-6].
mö‹
.
yy242
,yym•[-5].mö‹.
yy419
,yym•[-4].mö‹.
yy450
,yym•[-3].mö‹.yy242,yym•[-2].mö‹.yy450,yym•[-1].mö‹.yy242,yym•[-7].mö‹.
yy473
,yym•[0].mö‹.
yy84
.
pLimô
,yym•[0].mö‹.yy84.
pOff£t
);

115179 {
yygŸomö‹
.
yy473
 = 
SF_Di°ö˘
;}

115182 121: 
	`yyã°ˇ£
(
yyruÀno
==121);

115183 {
yygŸomö‹
.
yy473
 = 0;}

115186 246: 
	`yyã°ˇ£
(
yyruÀno
==246);

115187 {
yygŸomö‹
.
yy242
 = 
yym•
[-1].
mö‹
.yy242;}

115190 151: 
	`yyã°ˇ£
(
yyruÀno
==151);

115191 158: 
	`yyã°ˇ£
(
yyruÀno
==158);

115192 239: 
	`yyã°ˇ£
(
yyruÀno
==239);

115193 245: 
	`yyã°ˇ£
(
yyruÀno
==245);

115194 {
yygŸomö‹
.
yy242
 = 0;}

115198 
yygŸomö‹
.
yy242
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
, 
yym•
[-2].
mö‹
.yy242, yym•[-1].mö‹.
yy86
.
pEx¥
);

115199 if–
yym•
[0].
mö‹
.
yy0
.
n
>0 ) 
	`sqlôe3Ex¥Li°SëName
(
pP¨£
, 
yygŸomö‹
.
yy242
, &yymsp[0].minor.yy0, 1);

115200 
	`sqlôe3Ex¥Li°SëS∑n
(
pP¨£
,
yygŸomö‹
.
yy242
,&
yym•
[-1].
mö‹
.
yy86
);

115205 
Ex¥
 *
p
 = 
	`sqlôe3Ex¥
(
pP¨£
->
db
, 
TK_ALL
, 0);

115206 
yygŸomö‹
.
yy242
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
, 
yym•
[-1].
mö‹
.yy242, 
p
);

115211 
Ex¥
 *
pRight
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_ALL
, 0, 0, &
yym•
[0].
mö‹
.
yy0
);

115212 
Ex¥
 *
pLe·
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_ID
, 0, 0, &
yym•
[-2].
mö‹
.
yy0
);

115213 
Ex¥
 *
pDŸ
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_DOT
, 
pLe·
, 
pRight
, 0);

115214 
yygŸomö‹
.
yy242
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,
yym•
[-3].
mö‹
.yy242, 
pDŸ
);

115218 {
yygŸomö‹
.
yy0
.
n
 = 0;}

115221 {
yygŸomö‹
.
yy419
 = 
	`sqlôe3DbMÆlocZîo
(
pP¨£
->
db
, (*yygotominor.yy419));}

115225 
yygŸomö‹
.
yy419
 = 
yym•
[0].
mö‹
.yy419;

115226 
	`sqlôe3SrcLi°Shi·JoöTy≥
(
yygŸomö‹
.
yy419
);

115231 
yygŸomö‹
.
yy419
 = 
yym•
[-1].
mö‹
.yy419;

115232 if–
	`ALWAYS
(
yygŸomö‹
.
yy419
 && yygŸomö‹.yy419->
nSrc
>0ËËyygŸomö‹.yy419->
a
[yygŸomö‹.yy419->nSrc-1].
joöty≥
 = (
u8
)
yym•
[0].
mö‹
.
yy316
;

115236 {
yygŸomö‹
.
yy419
 = 0;}

115240 
yygŸomö‹
.
yy419
 = 
	`sqlôe3SrcLi°AµídFromTîm
(
pP¨£
,
yym•
[-6].
mö‹
.yy419,&yym•[-5].mö‹.
yy0
,&yym•[-4].mö‹.yy0,&yym•[-3].mö‹.yy0,0,yym•[-1].mö‹.
yy450
,yym•[0].mö‹.
yy352
);

115241 
	`sqlôe3SrcLi°IndexedBy
(
pP¨£
, 
yygŸomö‹
.
yy419
, &
yym•
[-2].
mö‹
.
yy0
);

115246 
yygŸomö‹
.
yy419
 = 
	`sqlôe3SrcLi°AµídFromTîm
(
pP¨£
,
yym•
[-6].
mö‹
.yy419,0,0,&yym•[-2].mö‹.
yy0
,yym•[-4].mö‹.
yy43
,yym•[-1].mö‹.
yy450
,yym•[0].mö‹.
yy352
);

115251 if–
yym•
[-6].
mö‹
.
yy419
==0 && yym•[-2].mö‹.
yy0
.
n
==0 && yym•[-1].mö‹.
yy450
==0 && yym•[0].mö‹.
yy352
==0 ){

115252 
yygŸomö‹
.
yy419
 = 
yym•
[-4].
mö‹
.yy419;

115253 }if–
yym•
[-4].
mö‹
.
yy419
->
nSrc
==1 ){

115254 
yygŸomö‹
.
yy419
 = 
	`sqlôe3SrcLi°AµídFromTîm
(
pP¨£
,
yym•
[-6].
mö‹
.yy419,0,0,&yym•[-2].mö‹.
yy0
,0,yym•[-1].mö‹.
yy450
,yym•[0].mö‹.
yy352
);

115255 if–
yygŸomö‹
.
yy419
 ){

115256 
SrcLi°_ôem
 *
pNew
 = &
yygŸomö‹
.
yy419
->
a
[yygŸomö‹.yy419->
nSrc
-1];

115257 
SrcLi°_ôem
 *
pOld
 = 
yym•
[-4].
mö‹
.
yy419
->
a
;

115258 
pNew
->
zName
 = 
pOld
->zName;

115259 
pNew
->
zD©aba£
 = 
pOld
->zDatabase;

115260 
pNew
->
pSñe˘
 = 
pOld
->pSelect;

115261 
pOld
->
zName
 =ÖOld->
zD©aba£
 = 0;

115262 
pOld
->
pSñe˘
 = 0;

115264 
	`sqlôe3SrcLi°Dñëe
(
pP¨£
->
db
, 
yym•
[-4].
mö‹
.
yy419
);

115266 
Sñe˘
 *
pSubquîy
;

115267 
	`sqlôe3SrcLi°Shi·JoöTy≥
(
yym•
[-4].
mö‹
.
yy419
);

115268 
pSubquîy
 = 
	`sqlôe3Sñe˘New
(
pP¨£
,0,
yym•
[-4].
mö‹
.
yy419
,0,0,0,0,
SF_Ne°edFrom
,0,0);

115269 
yygŸomö‹
.
yy419
 = 
	`sqlôe3SrcLi°AµídFromTîm
(
pP¨£
,
yym•
[-6].
mö‹
.yy419,0,0,&yym•[-2].mö‹.
yy0
,
pSubquîy
,yym•[-1].mö‹.
yy450
,yym•[0].mö‹.
yy352
);

115274 146: 
	`yyã°ˇ£
(
yyruÀno
==146);

115275 {
yygŸomö‹
.
yy0
.
z
=0; yygŸomö‹.yy0.
n
=0;}

115278 {
yygŸomö‹
.
yy419
 = 
	`sqlôe3SrcLi°Aµíd
(
pP¨£
->
db
,0,&
yym•
[-1].
mö‹
.
yy0
,&yymsp[0].minor.yy0);}

115281 { 
yygŸomö‹
.
yy316
 = 
JT_INNER
; }

115284 { 
yygŸomö‹
.
yy316
 = 
	`sqlôe3JoöTy≥
(
pP¨£
,&
yym•
[-1].
mö‹
.
yy0
,0,0); }

115287 { 
yygŸomö‹
.
yy316
 = 
	`sqlôe3JoöTy≥
(
pP¨£
,&
yym•
[-2].
mö‹
.
yy0
,&yymsp[-1].minor.yy0,0); }

115290 { 
yygŸomö‹
.
yy316
 = 
	`sqlôe3JoöTy≥
(
pP¨£
,&
yym•
[-3].
mö‹
.
yy0
,&yymsp[-2].minor.yy0,&yymsp[-1].minor.yy0); }

115293 161: 
	`yyã°ˇ£
(
yyruÀno
==161);

115294 168: 
	`yyã°ˇ£
(
yyruÀno
==168);

115295 234: 
	`yyã°ˇ£
(
yyruÀno
==234);

115296 236: 
	`yyã°ˇ£
(
yyruÀno
==236);

115297 {
yygŸomö‹
.
yy450
 = 
yym•
[0].
mö‹
.
yy86
.
pEx¥
;}

115300 160: 
	`yyã°ˇ£
(
yyruÀno
==160);

115301 167: 
	`yyã°ˇ£
(
yyruÀno
==167);

115302 235: 
	`yyã°ˇ£
(
yyruÀno
==235);

115303 237: 
	`yyã°ˇ£
(
yyruÀno
==237);

115304 {
yygŸomö‹
.
yy450
 = 0;}

115307 {
yygŸomö‹
.
yy0
.
z
=0; yygŸomö‹.yy0.
n
=1;}

115310 180: 
	`yyã°ˇ£
(
yyruÀno
==180);

115311 {
yygŸomö‹
.
yy352
 = 
yym•
[-1].
mö‹
.yy352;}

115314 179: 
	`yyã°ˇ£
(
yyruÀno
==179);

115315 {
yygŸomö‹
.
yy352
 = 0;}

115318 159: 
	`yyã°ˇ£
(
yyruÀno
==159);

115319 238: 
	`yyã°ˇ£
(
yyruÀno
==238);

115320 {
yygŸomö‹
.
yy242
 = 
yym•
[0].
mö‹
.yy242;}

115324 
yygŸomö‹
.
yy242
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,
yym•
[-3].
mö‹
.yy242,yym•[-1].mö‹.
yy86
.
pEx¥
);

115325 if–
yygŸomö‹
.
yy242
 ) yygŸomö‹.yy242->
a
[yygŸomö‹.yy242->
nEx¥
-1].
s‹tOrdî
 = (
u8
)
yym•
[0].
mö‹
.
yy316
;

115330 
yygŸomö‹
.
yy242
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,0,
yym•
[-1].
mö‹
.
yy86
.
pEx¥
);

115331 if–
yygŸomö‹
.
yy242
 && 
	`ALWAYS
(yygŸomö‹.yy242->
a
ËËyygŸomö‹.yy242->a[0].
s‹tOrdî
 = (
u8
)
yym•
[0].
mö‹
.
yy316
;

115335 157: 
	`yyã°ˇ£
(
yyruÀno
==157);

115336 {
yygŸomö‹
.
yy316
 = 
SQLITE_SO_ASC
;}

115339 {
yygŸomö‹
.
yy316
 = 
SQLITE_SO_DESC
;}

115342 {
yygŸomö‹
.
yy84
.
pLimô
 = 0; yygŸomö‹.yy84.
pOff£t
 = 0;}

115345 {
yygŸomö‹
.
yy84
.
pLimô
 = 
yym•
[0].
mö‹
.
yy86
.
pEx¥
; yygŸomö‹.yy84.
pOff£t
 = 0;}

115348 {
yygŸomö‹
.
yy84
.
pLimô
 = 
yym•
[-2].
mö‹
.
yy86
.
pEx¥
; yygŸomö‹.yy84.
pOff£t
 = yymsp[0].minor.yy86.pExpr;}

115351 {
yygŸomö‹
.
yy84
.
pOff£t
 = 
yym•
[-2].
mö‹
.
yy86
.
pEx¥
; yygŸomö‹.yy84.
pLimô
 = yymsp[0].minor.yy86.pExpr;}

115355 
	`sqlôe3SrcLi°IndexedBy
(
pP¨£
, 
yym•
[-2].
mö‹
.
yy419
, &yym•[-1].mö‹.
yy0
);

115356 
	`sqlôe3DñëeFrom
(
pP¨£
,
yym•
[-2].
mö‹
.
yy419
,yym•[0].mö‹.
yy450
);

115361 
	`sqlôe3SrcLi°IndexedBy
(
pP¨£
, 
yym•
[-4].
mö‹
.
yy419
, &yym•[-3].mö‹.
yy0
);

115362 
	`sqlôe3Ex¥Li°CheckLígth
(
pP¨£
,
yym•
[-1].
mö‹
.
yy242
,"setÜist");

115363 
	`sqlôe3Upd©e
(
pP¨£
,
yym•
[-4].
mö‹
.
yy419
,yym•[-1].mö‹.
yy242
,yym•[0].mö‹.
yy450
,yym•[-5].mö‹.
yy306
);

115368 
yygŸomö‹
.
yy242
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
, 
yym•
[-4].
mö‹
.yy242, yym•[0].mö‹.
yy86
.
pEx¥
);

115369 
	`sqlôe3Ex¥Li°SëName
(
pP¨£
, 
yygŸomö‹
.
yy242
, &
yym•
[-2].
mö‹
.
yy0
, 1);

115374 
yygŸomö‹
.
yy242
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
, 0, 
yym•
[0].
mö‹
.
yy86
.
pEx¥
);

115375 
	`sqlôe3Ex¥Li°SëName
(
pP¨£
, 
yygŸomö‹
.
yy242
, &
yym•
[-2].
mö‹
.
yy0
, 1);

115379 {
	`sqlôe3In£π
(
pP¨£
, 
yym•
[-2].
mö‹
.
yy419
, yym•[0].mö‹.
yy323
.
pLi°
, yym•[0].mö‹.yy323.
pSñe˘
, yym•[-1].mö‹.
yy352
, yym•[-4].mö‹.
yy306
);}

115382 {
	`sqlôe3In£π
(
pP¨£
, 
yym•
[-2].
mö‹
.
yy419
, 0, yym•[0].mö‹.
yy43
, yym•[-1].mö‹.
yy352
, yym•[-4].mö‹.
yy306
);}

115385 {
	`sqlôe3In£π
(
pP¨£
, 
yym•
[-3].
mö‹
.
yy419
, 0, 0, yym•[-2].mö‹.
yy352
, yym•[-5].mö‹.
yy306
);}

115388 {
yygŸomö‹
.
yy306
 = 
yym•
[0].
mö‹
.yy306;}

115391 {
yygŸomö‹
.
yy306
 = 
OE_Rïœ˚
;}

115395 
yygŸomö‹
.
yy323
.
pLi°
 = 
yym•
[-1].
mö‹
.
yy242
;

115396 
yygŸomö‹
.
yy323
.
pSñe˘
 = 0;

115401 
Sñe˘
 *
pRight
 = 
	`sqlôe3Sñe˘New
(
pP¨£
, 
yym•
[-1].
mö‹
.
yy242
, 0, 0, 0, 0, 0, 0, 0, 0);

115402 if–
yym•
[-4].
mö‹
.
yy323
.
pLi°
 ){

115403 
yym•
[-4].
mö‹
.
yy323
.
pSñe˘
 = 
	`sqlôe3Sñe˘New
(
pP¨£
, yym•[-4].mö‹.yy323.
pLi°
, 0, 0, 0, 0, 0, 0, 0, 0);

115404 
yym•
[-4].
mö‹
.
yy323
.
pLi°
 = 0;

115406 
yygŸomö‹
.
yy323
.
pLi°
 = 0;

115407 if–
yym•
[-4].
mö‹
.
yy323
.
pSñe˘
==0 || 
pRight
==0 ){

115408 
	`sqlôe3Sñe˘Dñëe
(
pP¨£
->
db
, 
pRight
);

115409 
	`sqlôe3Sñe˘Dñëe
(
pP¨£
->
db
, 
yym•
[-4].
mö‹
.
yy323
.
pSñe˘
);

115410 
yygŸomö‹
.
yy323
.
pSñe˘
 = 0;

115412 
pRight
->
›
 = 
TK_ALL
;

115413 
pRight
->
pPri‹
 = 
yym•
[-4].
mö‹
.
yy323
.
pSñe˘
;

115414 
pRight
->
£lFœgs
 |
SF_VÆues
;

115415 
pRight
->
pPri‹
->
£lFœgs
 |
SF_VÆues
;

115416 
yygŸomö‹
.
yy323
.
pSñe˘
 = 
pRight
;

115421 {
yygŸomö‹
.
yy352
 = 
	`sqlôe3IdLi°Aµíd
(
pP¨£
->
db
,
yym•
[-2].
mö‹
.yy352,&yym•[0].mö‹.
yy0
);}

115424 {
yygŸomö‹
.
yy352
 = 
	`sqlôe3IdLi°Aµíd
(
pP¨£
->
db
,0,&
yym•
[0].
mö‹
.
yy0
);}

115427 {
yygŸomö‹
.
yy86
 = 
yym•
[0].
mö‹
.yy86;}

115430 {
yygŸomö‹
.
yy86
.
pEx¥
 = 
yym•
[-1].
mö‹
.yy86.pEx¥; 
	`•™Së
(&yygŸomö‹.yy86,&yym•[-2].mö‹.
yy0
,&yymsp[0].minor.yy0);}

115433 190: 
	`yyã°ˇ£
(
yyruÀno
==190);

115434 191: 
	`yyã°ˇ£
(
yyruÀno
==191);

115435 {
	`•™Ex¥
(&
yygŸomö‹
.
yy86
, 
pP¨£
, 
yym•
[0].
maj‹
, &yym•[0].
mö‹
.
yy0
);}

115438 187: 
	`yyã°ˇ£
(
yyruÀno
==187);

115439 {
	`•™Ex¥
(&
yygŸomö‹
.
yy86
, 
pP¨£
, 
TK_ID
, &
yym•
[0].
mö‹
.
yy0
);}

115443 
Ex¥
 *
ãmp1
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_ID
, 0, 0, &
yym•
[-2].
mö‹
.
yy0
);

115444 
Ex¥
 *
ãmp2
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_ID
, 0, 0, &
yym•
[0].
mö‹
.
yy0
);

115445 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_DOT
, 
ãmp1
, 
ãmp2
, 0);

115446 
	`•™Së
(&
yygŸomö‹
.
yy86
,&
yym•
[-2].
mö‹
.
yy0
,&yymsp[0].minor.yy0);

115451 
Ex¥
 *
ãmp1
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_ID
, 0, 0, &
yym•
[-4].
mö‹
.
yy0
);

115452 
Ex¥
 *
ãmp2
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_ID
, 0, 0, &
yym•
[-2].
mö‹
.
yy0
);

115453 
Ex¥
 *
ãmp3
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_ID
, 0, 0, &
yym•
[0].
mö‹
.
yy0
);

115454 
Ex¥
 *
ãmp4
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_DOT
, 
ãmp2
, 
ãmp3
, 0);

115455 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_DOT
, 
ãmp1
, 
ãmp4
, 0);

115456 
	`•™Së
(&
yygŸomö‹
.
yy86
,&
yym•
[-4].
mö‹
.
yy0
,&yymsp[0].minor.yy0);

115464 if–
pP¨£
->
√°ed
==0 ){

115465 
	`sqlôe3Eº‹Msg
(
pP¨£
, "√¨ \"%T\": sy¡axÉº‹", &
yym•
[0].
mö‹
.
yy0
);

115466 
yygŸomö‹
.
yy86
.
pEx¥
 = 0;

115468 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_REGISTER
, 0, 0, &
yym•
[0].
mö‹
.
yy0
);

115469 if–
yygŸomö‹
.
yy86
.
pEx¥
 ) 
	`sqlôe3GëI¡32
(&
yym•
[0].
mö‹
.
yy0
.
z
[1], &yygŸomö‹.yy86.pEx¥->
iTabÀ
);

115471 
	`•™Së
(&
yygŸomö‹
.
yy86
, &
yym•
[0].
mö‹
.
yy0
, &yymsp[0].minor.yy0);

115476 
	`•™Ex¥
(&
yygŸomö‹
.
yy86
, 
pP¨£
, 
TK_VARIABLE
, &
yym•
[0].
mö‹
.
yy0
);

115477 
	`sqlôe3Ex¥AssignV¨Numbî
(
pP¨£
, 
yygŸomö‹
.
yy86
.
pEx¥
);

115478 
	`•™Së
(&
yygŸomö‹
.
yy86
, &
yym•
[0].
mö‹
.
yy0
, &yymsp[0].minor.yy0);

115483 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3Ex¥AddCﬁœãTokí
(
pP¨£
, 
yym•
[-2].
mö‹
.yy86.pEx¥, &yym•[0].mö‹.
yy0
);

115484 
yygŸomö‹
.
yy86
.
zSèπ
 = 
yym•
[-2].
mö‹
.yy86.zStart;

115485 
yygŸomö‹
.
yy86
.
zEnd
 = &
yym•
[0].
mö‹
.
yy0
.
z
[yym•[0].mö‹.yy0.
n
];

115490 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_CAST
, 
yym•
[-3].
mö‹
.yy86.pEx¥, 0, &yym•[-1].mö‹.
yy0
);

115491 
	`•™Së
(&
yygŸomö‹
.
yy86
,&
yym•
[-5].
mö‹
.
yy0
,&yymsp[0].minor.yy0);

115496 if–
yym•
[-1].
mö‹
.
yy242
 && yym•[-1].mö‹.yy242->
nEx¥
>
pP¨£
->
db
->
aLimô
[
SQLITE_LIMIT_FUNCTION_ARG
] ){

115497 
	`sqlôe3Eº‹Msg
(
pP¨£
, "toÿm™yárgumít†⁄ fun˘i⁄ %T", &
yym•
[-4].
mö‹
.
yy0
);

115499 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3Ex¥Fun˘i⁄
(
pP¨£
, 
yym•
[-1].
mö‹
.
yy242
, &yym•[-4].mö‹.
yy0
);

115500 
	`•™Së
(&
yygŸomö‹
.
yy86
,&
yym•
[-4].
mö‹
.
yy0
,&yymsp[0].minor.yy0);

115501 if–
yym•
[-2].
mö‹
.
yy473
 && 
yygŸomö‹
.
yy86
.
pEx¥
 ){

115502 
yygŸomö‹
.
yy86
.
pEx¥
->
Êags
 |
EP_Di°ö˘
;

115508 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3Ex¥Fun˘i⁄
(
pP¨£
, 0, &
yym•
[-3].
mö‹
.
yy0
);

115509 
	`•™Së
(&
yygŸomö‹
.
yy86
,&
yym•
[-3].
mö‹
.
yy0
,&yymsp[0].minor.yy0);

115516 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3Ex¥Fun˘i⁄
(
pP¨£
, 0,&
yym•
[0].
mö‹
.
yy0
);

115517 if–
yygŸomö‹
.
yy86
.
pEx¥
 ){

115518 
yygŸomö‹
.
yy86
.
pEx¥
->
›
 = 
TK_CONST_FUNC
;

115520 
	`•™Së
(&
yygŸomö‹
.
yy86
, &
yym•
[0].
mö‹
.
yy0
, &yymsp[0].minor.yy0);

115524 200: 
	`yyã°ˇ£
(
yyruÀno
==200);

115525 201: 
	`yyã°ˇ£
(
yyruÀno
==201);

115526 202: 
	`yyã°ˇ£
(
yyruÀno
==202);

115527 203: 
	`yyã°ˇ£
(
yyruÀno
==203);

115528 204: 
	`yyã°ˇ£
(
yyruÀno
==204);

115529 205: 
	`yyã°ˇ£
(
yyruÀno
==205);

115530 206: 
	`yyã°ˇ£
(
yyruÀno
==206);

115531 {
	`•™Bö¨yEx¥
(&
yygŸomö‹
.
yy86
,
pP¨£
,
yym•
[-1].
maj‹
,&yym•[-2].
mö‹
.yy86,&yymsp[0].minor.yy86);}

115534 209: 
	`yyã°ˇ£
(
yyruÀno
==209);

115535 {
yygŸomö‹
.
yy87
.
eO≥øt‹
 = 
yym•
[0].
mö‹
.
yy0
; yygŸomö‹.yy87.
bNŸ
 = 0;}

115538 210: 
	`yyã°ˇ£
(
yyruÀno
==210);

115539 {
yygŸomö‹
.
yy87
.
eO≥øt‹
 = 
yym•
[0].
mö‹
.
yy0
; yygŸomö‹.yy87.
bNŸ
 = 1;}

115543 
Ex¥Li°
 *
pLi°
;

115544 
pLi°
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,0, 
yym•
[0].
mö‹
.
yy86
.
pEx¥
);

115545 
pLi°
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,pLi°, 
yym•
[-2].
mö‹
.
yy86
.
pEx¥
);

115546 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3Ex¥Fun˘i⁄
(
pP¨£
, 
pLi°
, &
yym•
[-1].
mö‹
.
yy87
.
eO≥øt‹
);

115547 if–
yym•
[-1].
mö‹
.
yy87
.
bNŸ
 ) 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_NOT
, yygotominor.yy86.pExpr, 0, 0);

115548 
yygŸomö‹
.
yy86
.
zSèπ
 = 
yym•
[-2].
mö‹
.yy86.zStart;

115549 
yygŸomö‹
.
yy86
.
zEnd
 = 
yym•
[0].
mö‹
.yy86.zEnd;

115550 if–
yygŸomö‹
.
yy86
.
pEx¥
 ) yygŸomö‹.yy86.pEx¥->
Êags
 |
EP_InfixFunc
;

115555 
Ex¥Li°
 *
pLi°
;

115556 
pLi°
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,0, 
yym•
[-2].
mö‹
.
yy86
.
pEx¥
);

115557 
pLi°
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,pLi°, 
yym•
[-4].
mö‹
.
yy86
.
pEx¥
);

115558 
pLi°
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,pLi°, 
yym•
[0].
mö‹
.
yy86
.
pEx¥
);

115559 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3Ex¥Fun˘i⁄
(
pP¨£
, 
pLi°
, &
yym•
[-3].
mö‹
.
yy87
.
eO≥øt‹
);

115560 if–
yym•
[-3].
mö‹
.
yy87
.
bNŸ
 ) 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_NOT
, yygotominor.yy86.pExpr, 0, 0);

115561 
yygŸomö‹
.
yy86
.
zSèπ
 = 
yym•
[-4].
mö‹
.yy86.zStart;

115562 
yygŸomö‹
.
yy86
.
zEnd
 = 
yym•
[0].
mö‹
.yy86.zEnd;

115563 if–
yygŸomö‹
.
yy86
.
pEx¥
 ) yygŸomö‹.yy86.pEx¥->
Êags
 |
EP_InfixFunc
;

115567 {
	`•™U«ryPo°fix
(&
yygŸomö‹
.
yy86
,
pP¨£
,
yym•
[0].
maj‹
,&yym•[-1].
mö‹
.yy86,&yym•[0].mö‹.
yy0
);}

115570 {
	`•™U«ryPo°fix
(&
yygŸomö‹
.
yy86
,
pP¨£
,
TK_NOTNULL
,&
yym•
[-2].
mö‹
.yy86,&yym•[0].mö‹.
yy0
);}

115574 
	`•™Bö¨yEx¥
(&
yygŸomö‹
.
yy86
,
pP¨£
,
TK_IS
,&
yym•
[-2].
mö‹
.yy86,&yymsp[0].minor.yy86);

115575 
	`bö¨yToU«ryIfNuŒ
(
pP¨£
, 
yym•
[0].
mö‹
.
yy86
.
pEx¥
, 
yygŸomö‹
.yy86.pEx¥, 
TK_ISNULL
);

115580 
	`•™Bö¨yEx¥
(&
yygŸomö‹
.
yy86
,
pP¨£
,
TK_ISNOT
,&
yym•
[-3].
mö‹
.yy86,&yymsp[0].minor.yy86);

115581 
	`bö¨yToU«ryIfNuŒ
(
pP¨£
, 
yym•
[0].
mö‹
.
yy86
.
pEx¥
, 
yygŸomö‹
.yy86.pEx¥, 
TK_NOTNULL
);

115585 218: 
	`yyã°ˇ£
(
yyruÀno
==218);

115586 {
	`•™U«ryPªfix
(&
yygŸomö‹
.
yy86
,
pP¨£
,
yym•
[-1].
maj‹
,&yym•[0].
mö‹
.yy86,&yym•[-1].mö‹.
yy0
);}

115589 {
	`•™U«ryPªfix
(&
yygŸomö‹
.
yy86
,
pP¨£
,
TK_UMINUS
,&
yym•
[0].
mö‹
.yy86,&yym•[-1].mö‹.
yy0
);}

115592 {
	`•™U«ryPªfix
(&
yygŸomö‹
.
yy86
,
pP¨£
,
TK_UPLUS
,&
yym•
[0].
mö‹
.yy86,&yym•[-1].mö‹.
yy0
);}

115596 
Ex¥Li°
 *
pLi°
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,0, 
yym•
[-2].
mö‹
.
yy86
.
pEx¥
);

115597 
pLi°
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,pLi°, 
yym•
[0].
mö‹
.
yy86
.
pEx¥
);

115598 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_BETWEEN
, 
yym•
[-4].
mö‹
.yy86.pExpr, 0, 0);

115599 if–
yygŸomö‹
.
yy86
.
pEx¥
 ){

115600 
yygŸomö‹
.
yy86
.
pEx¥
->
x
.
pLi°
 =ÖList;

115602 
	`sqlôe3Ex¥Li°Dñëe
(
pP¨£
->
db
, 
pLi°
);

115604 if–
yym•
[-3].
mö‹
.
yy316
 ) 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_NOT
, yygotominor.yy86.pExpr, 0, 0);

115605 
yygŸomö‹
.
yy86
.
zSèπ
 = 
yym•
[-4].
mö‹
.yy86.zStart;

115606 
yygŸomö‹
.
yy86
.
zEnd
 = 
yym•
[0].
mö‹
.yy86.zEnd;

115611 if–
yym•
[-1].
mö‹
.
yy242
==0 ){

115620 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_INTEGER
, 0, 0, &
sqlôe3I¡Tokís
[
yym•
[-3].
mö‹
.
yy316
]);

115621 
	`sqlôe3Ex¥Dñëe
(
pP¨£
->
db
, 
yym•
[-4].
mö‹
.
yy86
.
pEx¥
);

115623 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_IN
, 
yym•
[-4].
mö‹
.yy86.pExpr, 0, 0);

115624 if–
yygŸomö‹
.
yy86
.
pEx¥
 ){

115625 
yygŸomö‹
.
yy86
.
pEx¥
->
x
.
pLi°
 = 
yym•
[-1].
mö‹
.
yy242
;

115626 
	`sqlôe3Ex¥SëHeight
(
pP¨£
, 
yygŸomö‹
.
yy86
.
pEx¥
);

115628 
	`sqlôe3Ex¥Li°Dñëe
(
pP¨£
->
db
, 
yym•
[-1].
mö‹
.
yy242
);

115630 if–
yym•
[-3].
mö‹
.
yy316
 ) 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_NOT
, yygotominor.yy86.pExpr, 0, 0);

115632 
yygŸomö‹
.
yy86
.
zSèπ
 = 
yym•
[-4].
mö‹
.yy86.zStart;

115633 
yygŸomö‹
.
yy86
.
zEnd
 = &
yym•
[0].
mö‹
.
yy0
.
z
[yym•[0].mö‹.yy0.
n
];

115638 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_SELECT
, 0, 0, 0);

115639 if–
yygŸomö‹
.
yy86
.
pEx¥
 ){

115640 
yygŸomö‹
.
yy86
.
pEx¥
->
x
.
pSñe˘
 = 
yym•
[-1].
mö‹
.
yy43
;

115641 
	`Ex¥SëPr›îty
(
yygŸomö‹
.
yy86
.
pEx¥
, 
EP_xIsSñe˘
);

115642 
	`sqlôe3Ex¥SëHeight
(
pP¨£
, 
yygŸomö‹
.
yy86
.
pEx¥
);

115644 
	`sqlôe3Sñe˘Dñëe
(
pP¨£
->
db
, 
yym•
[-1].
mö‹
.
yy43
);

115646 
yygŸomö‹
.
yy86
.
zSèπ
 = 
yym•
[-2].
mö‹
.
yy0
.
z
;

115647 
yygŸomö‹
.
yy86
.
zEnd
 = &
yym•
[0].
mö‹
.
yy0
.
z
[yym•[0].mö‹.yy0.
n
];

115652 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_IN
, 
yym•
[-4].
mö‹
.yy86.pExpr, 0, 0);

115653 if–
yygŸomö‹
.
yy86
.
pEx¥
 ){

115654 
yygŸomö‹
.
yy86
.
pEx¥
->
x
.
pSñe˘
 = 
yym•
[-1].
mö‹
.
yy43
;

115655 
	`Ex¥SëPr›îty
(
yygŸomö‹
.
yy86
.
pEx¥
, 
EP_xIsSñe˘
);

115656 
	`sqlôe3Ex¥SëHeight
(
pP¨£
, 
yygŸomö‹
.
yy86
.
pEx¥
);

115658 
	`sqlôe3Sñe˘Dñëe
(
pP¨£
->
db
, 
yym•
[-1].
mö‹
.
yy43
);

115660 if–
yym•
[-3].
mö‹
.
yy316
 ) 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_NOT
, yygotominor.yy86.pExpr, 0, 0);

115661 
yygŸomö‹
.
yy86
.
zSèπ
 = 
yym•
[-4].
mö‹
.yy86.zStart;

115662 
yygŸomö‹
.
yy86
.
zEnd
 = &
yym•
[0].
mö‹
.
yy0
.
z
[yym•[0].mö‹.yy0.
n
];

115667 
SrcLi°
 *
pSrc
 = 
	`sqlôe3SrcLi°Aµíd
(
pP¨£
->
db
, 0,&
yym•
[-1].
mö‹
.
yy0
,&yymsp[0].minor.yy0);

115668 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_IN
, 
yym•
[-3].
mö‹
.yy86.pExpr, 0, 0);

115669 if–
yygŸomö‹
.
yy86
.
pEx¥
 ){

115670 
yygŸomö‹
.
yy86
.
pEx¥
->
x
.
pSñe˘
 = 
	`sqlôe3Sñe˘New
(
pP¨£
, 0,
pSrc
,0,0,0,0,0,0,0);

115671 
	`Ex¥SëPr›îty
(
yygŸomö‹
.
yy86
.
pEx¥
, 
EP_xIsSñe˘
);

115672 
	`sqlôe3Ex¥SëHeight
(
pP¨£
, 
yygŸomö‹
.
yy86
.
pEx¥
);

115674 
	`sqlôe3SrcLi°Dñëe
(
pP¨£
->
db
, 
pSrc
);

115676 if–
yym•
[-2].
mö‹
.
yy316
 ) 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_NOT
, yygotominor.yy86.pExpr, 0, 0);

115677 
yygŸomö‹
.
yy86
.
zSèπ
 = 
yym•
[-3].
mö‹
.yy86.zStart;

115678 
yygŸomö‹
.
yy86
.
zEnd
 = 
yym•
[0].
mö‹
.
yy0
.
z
 ? &yym•[0].mö‹.yy0.z[yym•[0].mö‹.yy0.
n
] : &yymsp[-1].minor.yy0.z[yymsp[-1].minor.yy0.n];

115683 
Ex¥
 *
p
 = 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_EXISTS
, 0, 0, 0);

115684 if–
p
 ){

115685 
p
->
x
.
pSñe˘
 = 
yym•
[-1].
mö‹
.
yy43
;

115686 
	`Ex¥SëPr›îty
(
p
, 
EP_xIsSñe˘
);

115687 
	`sqlôe3Ex¥SëHeight
(
pP¨£
, 
p
);

115689 
	`sqlôe3Sñe˘Dñëe
(
pP¨£
->
db
, 
yym•
[-1].
mö‹
.
yy43
);

115691 
yygŸomö‹
.
yy86
.
zSèπ
 = 
yym•
[-3].
mö‹
.
yy0
.
z
;

115692 
yygŸomö‹
.
yy86
.
zEnd
 = &
yym•
[0].
mö‹
.
yy0
.
z
[yym•[0].mö‹.yy0.
n
];

115697 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_CASE
, 
yym•
[-3].
mö‹
.
yy450
, 0, 0);

115698 if–
yygŸomö‹
.
yy86
.
pEx¥
 ){

115699 
yygŸomö‹
.
yy86
.
pEx¥
->
x
.
pLi°
 = 
yym•
[-1].
mö‹
.
yy450
 ? 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,yym•[-2].mö‹.
yy242
,yymsp[-1].minor.yy450) : yymsp[-2].minor.yy242;

115700 
	`sqlôe3Ex¥SëHeight
(
pP¨£
, 
yygŸomö‹
.
yy86
.
pEx¥
);

115702 
	`sqlôe3Ex¥Li°Dñëe
(
pP¨£
->
db
, 
yym•
[-2].
mö‹
.
yy242
);

115703 
	`sqlôe3Ex¥Dñëe
(
pP¨£
->
db
, 
yym•
[-1].
mö‹
.
yy450
);

115705 
yygŸomö‹
.
yy86
.
zSèπ
 = 
yym•
[-4].
mö‹
.
yy0
.
z
;

115706 
yygŸomö‹
.
yy86
.
zEnd
 = &
yym•
[0].
mö‹
.
yy0
.
z
[yym•[0].mö‹.yy0.
n
];

115711 
yygŸomö‹
.
yy242
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,
yym•
[-4].
mö‹
.yy242, yym•[-2].mö‹.
yy86
.
pEx¥
);

115712 
yygŸomö‹
.
yy242
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,yygŸomö‹.yy242, 
yym•
[0].
mö‹
.
yy86
.
pEx¥
);

115717 
yygŸomö‹
.
yy242
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,0, 
yym•
[-2].
mö‹
.
yy86
.
pEx¥
);

115718 
yygŸomö‹
.
yy242
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,yygŸomö‹.yy242, 
yym•
[0].
mö‹
.
yy86
.
pEx¥
);

115722 {
yygŸomö‹
.
yy242
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,
yym•
[-2].
mö‹
.yy242,yym•[0].mö‹.
yy86
.
pEx¥
);}

115725 {
yygŸomö‹
.
yy242
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,0,
yym•
[0].
mö‹
.
yy86
.
pEx¥
);}

115729 
	`sqlôe3Cª©eIndex
(
pP¨£
, &
yym•
[-7].
mö‹
.
yy0
, &yymsp[-6].minor.yy0,

115730 
	`sqlôe3SrcLi°Aµíd
(
pP¨£
->
db
,0,&
yym•
[-4].
mö‹
.
yy0
,0), yym•[-2].mö‹.
yy242
, yym•[-10].mö‹.
yy316
,

115731 &
yym•
[-11].
mö‹
.
yy0
, yym•[0].mö‹.
yy450
, 
SQLITE_SO_ASC
, yym•[-8].mö‹.
yy316
);

115735 296: 
	`yyã°ˇ£
(
yyruÀno
==296);

115736 {
yygŸomö‹
.
yy316
 = 
OE_Ab‹t
;}

115739 {
yygŸomö‹
.
yy316
 = 
OE_N⁄e
;}

115743 
Ex¥
 *
p
 = 
	`sqlôe3Ex¥AddCﬁœãTokí
(
pP¨£
, 0, &
yym•
[-1].
mö‹
.
yy0
);

115744 
yygŸomö‹
.
yy242
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,
yym•
[-4].
mö‹
.yy242, 
p
);

115745 
	`sqlôe3Ex¥Li°SëName
(
pP¨£
,
yygŸomö‹
.
yy242
,&
yym•
[-2].
mö‹
.
yy0
,1);

115746 
	`sqlôe3Ex¥Li°CheckLígth
(
pP¨£
, 
yygŸomö‹
.
yy242
, "index");

115747 if–
yygŸomö‹
.
yy242
 ) yygŸomö‹.yy242->
a
[yygŸomö‹.yy242->
nEx¥
-1].
s‹tOrdî
 = (
u8
)
yym•
[0].
mö‹
.
yy316
;

115752 
Ex¥
 *
p
 = 
	`sqlôe3Ex¥AddCﬁœãTokí
(
pP¨£
, 0, &
yym•
[-1].
mö‹
.
yy0
);

115753 
yygŸomö‹
.
yy242
 = 
	`sqlôe3Ex¥Li°Aµíd
(
pP¨£
,0, 
p
);

115754 
	`sqlôe3Ex¥Li°SëName
(
pP¨£
, 
yygŸomö‹
.
yy242
, &
yym•
[-2].
mö‹
.
yy0
, 1);

115755 
	`sqlôe3Ex¥Li°CheckLígth
(
pP¨£
, 
yygŸomö‹
.
yy242
, "index");

115756 if–
yygŸomö‹
.
yy242
 ) yygŸomö‹.yy242->
a
[yygŸomö‹.yy242->
nEx¥
-1].
s‹tOrdî
 = (
u8
)
yym•
[0].
mö‹
.
yy316
;

115760 {
yygŸomö‹
.
yy0
.
z
 = 0; yygŸomö‹.yy0.
n
 = 0;}

115763 {
	`sqlôe3Dr›Index
(
pP¨£
, 
yym•
[0].
mö‹
.
yy419
, yym•[-1].mö‹.
yy316
);}

115766 253: 
	`yyã°ˇ£
(
yyruÀno
==253);

115767 {
	`sqlôe3Vacuum
(
pP¨£
);}

115770 {
	`sqlôe3Pøgma
(
pP¨£
,&
yym•
[-1].
mö‹
.
yy0
,&yymsp[0].minor.yy0,0,0);}

115773 {
	`sqlôe3Pøgma
(
pP¨£
,&
yym•
[-3].
mö‹
.
yy0
,&yymsp[-2].minor.yy0,&yymsp[0].minor.yy0,0);}

115776 {
	`sqlôe3Pøgma
(
pP¨£
,&
yym•
[-4].
mö‹
.
yy0
,&yymsp[-3].minor.yy0,&yymsp[-1].minor.yy0,0);}

115779 {
	`sqlôe3Pøgma
(
pP¨£
,&
yym•
[-3].
mö‹
.
yy0
,&yymsp[-2].minor.yy0,&yymsp[0].minor.yy0,1);}

115782 {
	`sqlôe3Pøgma
(
pP¨£
,&
yym•
[-4].
mö‹
.
yy0
,&yymsp[-3].minor.yy0,&yymsp[-1].minor.yy0,1);}

115786 
Tokí
 
Æl
;

115787 
Æl
.
z
 = 
yym•
[-3].
mö‹
.
yy0
.z;

115788 
Æl
.
n
 = ()(
yym•
[0].
mö‹
.
yy0
.
z
 - yymsp[-3].minor.yy0.z) + yymsp[0].minor.yy0.n;

115789 
	`sqlôe3FöishTriggî
(
pP¨£
, 
yym•
[-1].
mö‹
.
yy75
, &
Æl
);

115794 
	`sqlôe3BegöTriggî
(
pP¨£
, &
yym•
[-7].
mö‹
.
yy0
, &yym•[-6].mö‹.yy0, yym•[-5].mö‹.
yy316
, yym•[-4].mö‹.
yy354
.
a
, yym•[-4].mö‹.yy354.
b
, yym•[-2].mö‹.
yy419
, yym•[0].mö‹.
yy450
, yymsp[-10].minor.yy316, yymsp[-8].minor.yy316);

115795 
yygŸomö‹
.
yy0
 = (
yym•
[-6].
mö‹
.yy0.
n
==0?yymsp[-7].minor.yy0:yymsp[-6].minor.yy0);

115799 273: 
	`yyã°ˇ£
(
yyruÀno
==273);

115800 { 
yygŸomö‹
.
yy316
 = 
TK_BEFORE
; }

115803 { 
yygŸomö‹
.
yy316
 = 
TK_AFTER
; }

115806 { 
yygŸomö‹
.
yy316
 = 
TK_INSTEAD
;}

115809 275: 
	`yyã°ˇ£
(
yyruÀno
==275);

115810 {
yygŸomö‹
.
yy354
.
a
 = 
yym•
[0].
maj‹
; yygŸomö‹.yy354.
b
 = 0;}

115813 {
yygŸomö‹
.
yy354
.
a
 = 
TK_UPDATE
; yygŸomö‹.yy354.
b
 = 
yym•
[0].
mö‹
.
yy352
;}

115816 301: 
	`yyã°ˇ£
(
yyruÀno
==301);

115817 { 
yygŸomö‹
.
yy450
 = 0; }

115820 302: 
	`yyã°ˇ£
(
yyruÀno
==302);

115821 { 
yygŸomö‹
.
yy450
 = 
yym•
[0].
mö‹
.
yy86
.
pEx¥
; }

115825 
	`as£π
–
yym•
[-2].
mö‹
.
yy75
!=0 );

115826 
yym•
[-2].
mö‹
.
yy75
->
pLa°
->
pNext
 = yymsp[-1].minor.yy75;

115827 
yym•
[-2].
mö‹
.
yy75
->
pLa°
 = yymsp[-1].minor.yy75;

115828 
yygŸomö‹
.
yy75
 = 
yym•
[-2].
mö‹
.yy75;

115833 
	`as£π
–
yym•
[-1].
mö‹
.
yy75
!=0 );

115834 
yym•
[-1].
mö‹
.
yy75
->
pLa°
 = yymsp[-1].minor.yy75;

115835 
yygŸomö‹
.
yy75
 = 
yym•
[-1].
mö‹
.yy75;

115840 
yygŸomö‹
.
yy0
 = 
yym•
[0].
mö‹
.yy0;

115841 
	`sqlôe3Eº‹Msg
(
pP¨£
,

115848 
	`sqlôe3Eº‹Msg
(
pP¨£
,

115855 
	`sqlôe3Eº‹Msg
(
pP¨£
,

115861 { 
yygŸomö‹
.
yy75
 = 
	`sqlôe3TriggîUpd©eSãp
(
pP¨£
->
db
, &
yym•
[-4].
mö‹
.
yy0
, yym•[-1].mö‹.
yy242
, yym•[0].mö‹.
yy450
, yym•[-5].mö‹.
yy306
); }

115864 {
yygŸomö‹
.
yy75
 = 
	`sqlôe3TriggîIn£πSãp
(
pP¨£
->
db
, &
yym•
[-2].
mö‹
.
yy0
, yym•[-1].mö‹.
yy352
, yym•[0].mö‹.
yy323
.
pLi°
, yym•[0].mö‹.yy323.
pSñe˘
, yym•[-4].mö‹.
yy306
);}

115867 {
yygŸomö‹
.
yy75
 = 
	`sqlôe3TriggîIn£πSãp
(
pP¨£
->
db
, &
yym•
[-2].
mö‹
.
yy0
, yym•[-1].mö‹.
yy352
, 0, yym•[0].mö‹.
yy43
, yym•[-4].mö‹.
yy306
);}

115870 {
yygŸomö‹
.
yy75
 = 
	`sqlôe3TriggîDñëeSãp
(
pP¨£
->
db
, &
yym•
[-2].
mö‹
.
yy0
, yym•[0].mö‹.
yy450
);}

115873 {
yygŸomö‹
.
yy75
 = 
	`sqlôe3TriggîSñe˘Sãp
(
pP¨£
->
db
, 
yym•
[0].
mö‹
.
yy43
); }

115877 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_RAISE
, 0, 0, 0);

115878 if–
yygŸomö‹
.
yy86
.
pEx¥
 ){

115879 
yygŸomö‹
.
yy86
.
pEx¥
->
afföôy
 = 
OE_Ign‹e
;

115881 
yygŸomö‹
.
yy86
.
zSèπ
 = 
yym•
[-3].
mö‹
.
yy0
.
z
;

115882 
yygŸomö‹
.
yy86
.
zEnd
 = &
yym•
[0].
mö‹
.
yy0
.
z
[yym•[0].mö‹.yy0.
n
];

115887 
yygŸomö‹
.
yy86
.
pEx¥
 = 
	`sqlôe3PEx¥
(
pP¨£
, 
TK_RAISE
, 0, 0, &
yym•
[-1].
mö‹
.
yy0
);

115888 if–
yygŸomö‹
.
yy86
.
pEx¥
 ) {

115889 
yygŸomö‹
.
yy86
.
pEx¥
->
afföôy
 = ()
yym•
[-3].
mö‹
.
yy316
;

115891 
yygŸomö‹
.
yy86
.
zSèπ
 = 
yym•
[-5].
mö‹
.
yy0
.
z
;

115892 
yygŸomö‹
.
yy86
.
zEnd
 = &
yym•
[0].
mö‹
.
yy0
.
z
[yym•[0].mö‹.yy0.
n
];

115896 {
yygŸomö‹
.
yy316
 = 
OE_Rﬁlback
;}

115899 {
yygŸomö‹
.
yy316
 = 
OE_Faû
;}

115903 
	`sqlôe3Dr›Triggî
(
pP¨£
,
yym•
[0].
mö‹
.
yy419
,yym•[-1].mö‹.
yy316
);

115908 
	`sqlôe3Aâach
(
pP¨£
, 
yym•
[-3].
mö‹
.
yy86
.
pEx¥
, yym•[-1].mö‹.yy86.pEx¥, yym•[0].mö‹.
yy450
);

115913 
	`sqlôe3Dëach
(
pP¨£
, 
yym•
[0].
mö‹
.
yy86
.
pEx¥
);

115917 {
	`sqlôe3Reödex
(
pP¨£
, 0, 0);}

115920 {
	`sqlôe3Reödex
(
pP¨£
, &
yym•
[-1].
mö‹
.
yy0
, &yymsp[0].minor.yy0);}

115923 {
	`sqlôe3A«lyze
(
pP¨£
, 0, 0);}

115926 {
	`sqlôe3A«lyze
(
pP¨£
, &
yym•
[-1].
mö‹
.
yy0
, &yymsp[0].minor.yy0);}

115930 
	`sqlôe3A…îRíameTabÀ
(
pP¨£
,
yym•
[-3].
mö‹
.
yy419
,&yym•[0].mö‹.
yy0
);

115935 
pP¨£
->
c⁄°øötName
 = 
yym•
[-1].
mö‹
.
yy0
;

115936 
	`sqlôe3AddC⁄°øötgrk
(
pP¨£
,
yym•
[-4].
mö‹
.
yy419
,yym•[0].mö‹.
yy86
.
pEx¥
);

115940 {
	`sqlôe3VèbFöishP¨£
(
pP¨£
,0);}

115943 {
	`sqlôe3VèbFöishP¨£
(
pP¨£
,&
yym•
[0].
mö‹
.
yy0
);}

115947 
	`sqlôe3VèbBegöP¨£
(
pP¨£
, &
yym•
[-3].
mö‹
.
yy0
, &yym•[-2].mö‹.yy0, &yym•[0].mö‹.yy0, yym•[-4].mö‹.
yy316
);

115951 {
	`sqlôe3VèbArgInô
(
pP¨£
);}

115954 319: 
	`yyã°ˇ£
(
yyruÀno
==319);

115955 320: 
	`yyã°ˇ£
(
yyruÀno
==320);

115956 {
	`sqlôe3VèbArgExãnd
(
pP¨£
,&
yym•
[0].
mö‹
.
yy0
);}

115959  
	`yyã°ˇ£
(
yyruÀno
==0);

115960  
	`yyã°ˇ£
(
yyruÀno
==1);

115961  
	`yyã°ˇ£
(
yyruÀno
==2);

115962  
	`yyã°ˇ£
(
yyruÀno
==3);

115963  
	`yyã°ˇ£
(
yyruÀno
==4);

115964  
	`yyã°ˇ£
(
yyruÀno
==10);

115965  
	`yyã°ˇ£
(
yyruÀno
==11);

115966  
	`yyã°ˇ£
(
yyruÀno
==12);

115967  
	`yyã°ˇ£
(
yyruÀno
==20);

115968  
	`yyã°ˇ£
(
yyruÀno
==21);

115969  
	`yyã°ˇ£
(
yyruÀno
==25);

115970  
	`yyã°ˇ£
(
yyruÀno
==34);

115971  
	`yyã°ˇ£
(
yyruÀno
==35);

115972  
	`yyã°ˇ£
(
yyruÀno
==44);

115973  
	`yyã°ˇ£
(
yyruÀno
==51);

115974  
	`yyã°ˇ£
(
yyruÀno
==52);

115975  
	`yyã°ˇ£
(
yyruÀno
==53);

115976  
	`yyã°ˇ£
(
yyruÀno
==54);

115977  
	`yyã°ˇ£
(
yyruÀno
==61);

115978  
	`yyã°ˇ£
(
yyruÀno
==89);

115979  
	`yyã°ˇ£
(
yyruÀno
==90);

115980  
	`yyã°ˇ£
(
yyruÀno
==92);

115981  
	`yyã°ˇ£
(
yyruÀno
==277);

115982  
	`yyã°ˇ£
(
yyruÀno
==278);

115983  
	`yyã°ˇ£
(
yyruÀno
==285);

115984  
	`yyã°ˇ£
(
yyruÀno
==303);

115985  
	`yyã°ˇ£
(
yyruÀno
==304);

115986  
	`yyã°ˇ£
(
yyruÀno
==314);

115987  
	`yyã°ˇ£
(
yyruÀno
==315);

115988  
	`yyã°ˇ£
(
yyruÀno
==317);

115989  
	`yyã°ˇ£
(
yyruÀno
==321);

115990  
	`yyã°ˇ£
(
yyruÀno
==322);

115991  
	`yyã°ˇ£
(
yyruÀno
==323);

115994 
	`as£π
–
yyruÀno
>=0 && yyruÀno<(
yyRuÀInfo
)/(yyRuleInfo[0]) );

115995 
yygŸo
 = 
yyRuÀInfo
[
yyruÀno
].
lhs
;

115996 
yysize
 = 
yyRuÀInfo
[
yyruÀno
].
ƒhs
;

115997 
yypP¨£r
->
yyidx
 -
yysize
;

115998 
yya˘
 = 
	`yy_föd_ªdu˚_a˘i⁄
(
yym•
[-
yysize
].
°©ío
,(
YYCODETYPE
)
yygŸo
);

115999 if–
yya˘
 < 
YYNSTATE
 ){

116000 #ifde‡
NDEBUG


116005 if–
yysize
 ){

116006 
yypP¨£r
->
yyidx
++;

116007 
yym•
 -
yysize
-1;

116008 
yym•
->
°©ío
 = (
YYACTIONTYPE
)
yya˘
;

116009 
yym•
->
maj‹
 = (
YYCODETYPE
)
yygŸo
;

116010 
yym•
->
mö‹
 = 
yygŸomö‹
;

116014 
	`yy_shi·
(
yypP¨£r
,
yya˘
,
yygŸo
,&
yygŸomö‹
);

116017 
	`as£π
–
yya˘
 =
YYNSTATE
 + 
YYNRULE
 + 1 );

116018 
	`yy_ac˚±
(
yypP¨£r
);

116025 #i‚de‡
YYNOERRORRECOVERY


116026 
	`yy_∑r£_Áûed
(

116027 
yyP¨£r
 *
yypP¨£r


116029 
sqlôe3P¨£rARG_FETCH
;

116030 #i‚de‡
NDEBUG


116031 if–
yyTø˚FILE
 ){

116032 
	`Ârötf
(
yyTø˚FILE
,"%sFaû!\n",
yyTø˚Prom±
);

116035  
yypP¨£r
->
yyidx
>=0 ) 
	`yy_p›_∑r£r_°ack
(yypParser);

116038 
sqlôe3P¨£rARG_STORE
;

116045 
	`yy_sy¡ax_îr‹
(

116046 
yyP¨£r
 *
yypP¨£r
,

116047 
yymaj‹
,

116048 
YYMINORTYPE
 
yymö‹


116050 
sqlôe3P¨£rARG_FETCH
;

116051 
	#TOKEN
 (
yymö‹
.
yy0
)

	)

116053 
	`UNUSED_PARAMETER
(
yymaj‹
);

116054 
	`as£π
–
TOKEN
.
z
[0] );

116055 
	`sqlôe3Eº‹Msg
(
pP¨£
, "√¨ \"%T\": sy¡axÉº‹", &
TOKEN
);

116056 
sqlôe3P¨£rARG_STORE
;

116062 
	`yy_ac˚±
(

116063 
yyP¨£r
 *
yypP¨£r


116065 
sqlôe3P¨£rARG_FETCH
;

116066 #i‚de‡
NDEBUG


116067 if–
yyTø˚FILE
 ){

116068 
	`Ârötf
(
yyTø˚FILE
,"%sAc˚±!\n",
yyTø˚Prom±
);

116071  
yypP¨£r
->
yyidx
>=0 ) 
	`yy_p›_∑r£r_°ack
(yypParser);

116074 
sqlôe3P¨£rARG_STORE
;

116096 
SQLITE_PRIVATE
 
	`sqlôe3P¨£r
(

116097 *
yyp
,

116098 
yymaj‹
,

116099 
sqlôe3P¨£rTOKENTYPE
 
yymö‹


116100 
sqlôe3P¨£rARG_PDECL


116102 
YYMINORTYPE
 
yymö‹uni⁄
;

116103 
yya˘
;

116104 #i‡!
	`deföed
(
YYERRORSYMBOL
Ë&& !deföed(
YYNOERRORRECOVERY
)

116105 
yyídoföput
;

116107 #ifde‡
YYERRORSYMBOL


116108 
yyîr‹hô
 = 0;

116110 
yyP¨£r
 *
yypP¨£r
;

116113 
yypP¨£r
 = (
yyP¨£r
*)
yyp
;

116114 if–
yypP¨£r
->
yyidx
<0 ){

116115 #i‡
YYSTACKDEPTH
<=0

116116 if–
yypP¨£r
->
yy°ksz
 <=0 ){

116118 
yymö‹uni⁄
 = 
yyzîomö‹
;

116119 
	`yySèckOvîÊow
(
yypP¨£r
, &
yymö‹uni⁄
);

116123 
yypP¨£r
->
yyidx
 = 0;

116124 
yypP¨£r
->
yyîr˙t
 = -1;

116125 
yypP¨£r
->
yy°ack
[0].
°©ío
 = 0;

116126 
yypP¨£r
->
yy°ack
[0].
maj‹
 = 0;

116128 
yymö‹uni⁄
.
yy0
 = 
yymö‹
;

116129 #i‡!
	`deföed
(
YYERRORSYMBOL
Ë&& !deföed(
YYNOERRORRECOVERY
)

116130 
yyídoföput
 = (
yymaj‹
==0);

116132 
sqlôe3P¨£rARG_STORE
;

116134 #i‚de‡
NDEBUG


116135 if–
yyTø˚FILE
 ){

116136 
	`Ârötf
(
yyTø˚FILE
,"%sI≈uà%s\n",
yyTø˚Prom±
,
yyTokíName
[
yymaj‹
]);

116141 
yya˘
 = 
	`yy_föd_shi·_a˘i⁄
(
yypP¨£r
,(
YYCODETYPE
)
yymaj‹
);

116142 if–
yya˘
<
YYNSTATE
 ){

116143 
	`yy_shi·
(
yypP¨£r
,
yya˘
,
yymaj‹
,&
yymö‹uni⁄
);

116144 
yypP¨£r
->
yyîr˙t
--;

116145 
yymaj‹
 = 
YYNOCODE
;

116146 }if–
yya˘
 < 
YYNSTATE
 + 
YYNRULE
 ){

116147 
	`yy_ªdu˚
(
yypP¨£r
,
yya˘
-
YYNSTATE
);

116149 
	`as£π
–
yya˘
 =
YY_ERROR_ACTION
 );

116150 #ifde‡
YYERRORSYMBOL


116151 
yymx
;

116153 #i‚de‡
NDEBUG


116154 if–
yyTø˚FILE
 ){

116155 
	`Ârötf
(
yyTø˚FILE
,"%sSy¡ax Eº‹!\n",
yyTø˚Prom±
);

116158 #ifde‡
YYERRORSYMBOL


116178 if–
yypP¨£r
->
yyîr˙t
<0 ){

116179 
	`yy_sy¡ax_îr‹
(
yypP¨£r
,
yymaj‹
,
yymö‹uni⁄
);

116181 
yymx
 = 
yypP¨£r
->
yy°ack
[yypP¨£r->
yyidx
].
maj‹
;

116182 if–
yymx
==
YYERRORSYMBOL
 || 
yyîr‹hô
 ){

116183 #i‚de‡
NDEBUG


116184 if–
yyTø˚FILE
 ){

116185 
	`Ârötf
(
yyTø˚FILE
,"%sDiscard inputÅoken %s\n",

116186 
yyTø˚Prom±
,
yyTokíName
[
yymaj‹
]);

116189 
	`yy_de°ru˘‹
(
yypP¨£r
, (
YYCODETYPE
)
yymaj‹
,&
yymö‹uni⁄
);

116190 
yymaj‹
 = 
YYNOCODE
;

116193 
yypP¨£r
->
yyidx
 >= 0 &&

116194 
yymx
 !
YYERRORSYMBOL
 &&

116195 (
yya˘
 = 
	`yy_föd_ªdu˚_a˘i⁄
(

116196 
yypP¨£r
->
yy°ack
[yypP¨£r->
yyidx
].
°©ío
,

116197 
YYERRORSYMBOL
)Ë>
YYNSTATE


116199 
	`yy_p›_∑r£r_°ack
(
yypP¨£r
);

116201 if–
yypP¨£r
->
yyidx
 < 0 || 
yymaj‹
==0 ){

116202 
	`yy_de°ru˘‹
(
yypP¨£r
,(
YYCODETYPE
)
yymaj‹
,&
yymö‹uni⁄
);

116203 
	`yy_∑r£_Áûed
(
yypP¨£r
);

116204 
yymaj‹
 = 
YYNOCODE
;

116205 }if–
yymx
!=
YYERRORSYMBOL
 ){

116206 
YYMINORTYPE
 
u2
;

116207 
u2
.
YYERRSYMDT
 = 0;

116208 
	`yy_shi·
(
yypP¨£r
,
yya˘
,
YYERRORSYMBOL
,&
u2
);

116211 
yypP¨£r
->
yyîr˙t
 = 3;

116212 
yyîr‹hô
 = 1;

116213 #ñi‡
	`deföed
(
YYNOERRORRECOVERY
)

116221 
	`yy_sy¡ax_îr‹
(
yypP¨£r
,
yymaj‹
,
yymö‹uni⁄
);

116222 
	`yy_de°ru˘‹
(
yypP¨£r
,(
YYCODETYPE
)
yymaj‹
,&
yymö‹uni⁄
);

116223 
yymaj‹
 = 
YYNOCODE
;

116235 if–
yypP¨£r
->
yyîr˙t
<=0 ){

116236 
	`yy_sy¡ax_îr‹
(
yypP¨£r
,
yymaj‹
,
yymö‹uni⁄
);

116238 
yypP¨£r
->
yyîr˙t
 = 3;

116239 
	`yy_de°ru˘‹
(
yypP¨£r
,(
YYCODETYPE
)
yymaj‹
,&
yymö‹uni⁄
);

116240 if–
yyídoföput
 ){

116241 
	`yy_∑r£_Áûed
(
yypP¨£r
);

116243 
yymaj‹
 = 
YYNOCODE
;

116246 } 
yymaj‹
!=
YYNOCODE
 && 
yypP¨£r
->
yyidx
>=0 );

116278 #ifde‡
SQLITE_ASCII


116279 
	#ch¨M≠
(
X
Ë
sqlôe3UµîToLowî
[()X]

	)

116281 #ifde‡
SQLITE_EBCDIC


116282 
	#ch¨M≠
(
X
Ë
ebcdicToAscii
[()X]

	)

116283 c⁄° 
ebcdicToAscii
[] = {

116331 
	`keyw‹dCode
(c⁄° *
z
, 
n
){

116343 c⁄° 
zText
[540] = {

116375 c⁄° 
aHash
[127] = {

116387 c⁄° 
aNext
[121] = {

116399 c⁄° 
aLí
[121] = {

116411 c⁄° 
aOff£t
[121] = {

116423 c⁄° 
aCode
[121] = {

116424 
TK_REINDEX
, 
TK_INDEXED
, 
TK_INDEX
, 
TK_DESC
, 
TK_ESCAPE
,

116425 
TK_EACH
, 
TK_CHECK
, 
TK_KEY
, 
TK_BEFORE
, 
TK_FOREIGN
,

116426 
TK_FOR
, 
TK_IGNORE
, 
TK_LIKE_KW
, 
TK_EXPLAIN
, 
TK_INSTEAD
,

116427 
TK_ADD
, 
TK_DATABASE
, 
TK_AS
, 
TK_SELECT
, 
TK_TABLE
,

116428 
TK_JOIN_KW
, 
TK_THEN
, 
TK_END
, 
TK_DEFERRABLE
, 
TK_ELSE
,

116429 
TK_EXCEPT
, 
TK_TRANSACTION
,
TK_ACTION
, 
TK_ON
, 
TK_JOIN_KW
,

116430 
TK_ALTER
, 
TK_RAISE
, 
TK_EXCLUSIVE
, 
TK_EXISTS
, 
TK_SAVEPOINT
,

116431 
TK_INTERSECT
, 
TK_TRIGGER
, 
TK_REFERENCES
, 
TK_CONSTRAINT
, 
TK_INTO
,

116432 
TK_OFFSET
, 
TK_OF
, 
TK_SET
, 
TK_TEMP
, TK_TEMP,

116433 
TK_OR
, 
TK_UNIQUE
, 
TK_QUERY
, 
TK_ATTACH
, 
TK_HAVING
,

116434 
TK_GROUP
, 
TK_UPDATE
, 
TK_BEGIN
, 
TK_JOIN_KW
, 
TK_RELEASE
,

116435 
TK_BETWEEN
, 
TK_NOTNULL
, 
TK_NOT
, 
TK_NO
, 
TK_NULL
,

116436 
TK_LIKE_KW
, 
TK_CASCADE
, 
TK_ASC
, 
TK_DELETE
, 
TK_CASE
,

116437 
TK_COLLATE
, 
TK_CREATE
, 
TK_CTIME_KW
, 
TK_DETACH
, 
TK_IMMEDIATE
,

116438 
TK_JOIN
, 
TK_INSERT
, 
TK_MATCH
, 
TK_PLAN
, 
TK_ANALYZE
,

116439 
TK_PRAGMA
, 
TK_ABORT
, 
TK_VALUES
, 
TK_VIRTUAL
, 
TK_LIMIT
,

116440 
TK_WHEN
, 
TK_WHERE
, 
TK_RENAME
, 
TK_AFTER
, 
TK_REPLACE
,

116441 
TK_AND
, 
TK_DEFAULT
, 
TK_AUTOINCR
, 
TK_TO
, 
TK_IN
,

116442 
TK_CAST
, 
TK_COLUMNKW
, 
TK_COMMIT
, 
TK_CONFLICT
, 
TK_JOIN_KW
,

116443 
TK_CTIME_KW
, TK_CTIME_KW, 
TK_PRIMARY
, 
TK_DEFERRED
, 
TK_DISTINCT
,

116444 
TK_IS
, 
TK_DROP
, 
TK_FAIL
, 
TK_FROM
, 
TK_JOIN_KW
,

116445 
TK_LIKE_KW
, 
TK_BY
, 
TK_IF
, 
TK_ISNULL
, 
TK_ORDER
,

116446 
TK_RESTRICT
, 
TK_JOIN_KW
, TK_JOIN_KW, 
TK_ROLLBACK
, 
TK_ROW
,

116447 
TK_UNION
, 
TK_USING
, 
TK_VACUUM
, 
TK_VIEW
, 
TK_INITIALLY
,

116448 
TK_ALL
,

116450 
h
, 
i
;

116451 if–
n
<2 )  
TK_ID
;

116452 
h
 = ((
	`ch¨M≠
(
z
[0])*4) ^

116453 (
	`ch¨M≠
(
z
[
n
-1])*3) ^

116454 
n
) % 127;

116455 
i
=(()
aHash
[
h
])-1; i>=0; i=(()
aNext
[i])-1){

116456 if–
aLí
[
i
]==
n
 && 
	`sqlôe3SåNICmp
(&
zText
[
aOff£t
[i]],
z
,n)==0 ){

116457 
	`ã°ˇ£
–
i
==0 );

116458 
	`ã°ˇ£
–
i
==1 );

116459 
	`ã°ˇ£
–
i
==2 );

116460 
	`ã°ˇ£
–
i
==3 );

116461 
	`ã°ˇ£
–
i
==4 );

116462 
	`ã°ˇ£
–
i
==5 );

116463 
	`ã°ˇ£
–
i
==6 );

116464 
	`ã°ˇ£
–
i
==7 );

116465 
	`ã°ˇ£
–
i
==8 );

116466 
	`ã°ˇ£
–
i
==9 );

116467 
	`ã°ˇ£
–
i
==10 );

116468 
	`ã°ˇ£
–
i
==11 );

116469 
	`ã°ˇ£
–
i
==12 );

116470 
	`ã°ˇ£
–
i
==13 );

116471 
	`ã°ˇ£
–
i
==14 );

116472 
	`ã°ˇ£
–
i
==15 );

116473 
	`ã°ˇ£
–
i
==16 );

116474 
	`ã°ˇ£
–
i
==17 );

116475 
	`ã°ˇ£
–
i
==18 );

116476 
	`ã°ˇ£
–
i
==19 );

116477 
	`ã°ˇ£
–
i
==20 );

116478 
	`ã°ˇ£
–
i
==21 );

116479 
	`ã°ˇ£
–
i
==22 );

116480 
	`ã°ˇ£
–
i
==23 );

116481 
	`ã°ˇ£
–
i
==24 );

116482 
	`ã°ˇ£
–
i
==25 );

116483 
	`ã°ˇ£
–
i
==26 );

116484 
	`ã°ˇ£
–
i
==27 );

116485 
	`ã°ˇ£
–
i
==28 );

116486 
	`ã°ˇ£
–
i
==29 );

116487 
	`ã°ˇ£
–
i
==30 );

116488 
	`ã°ˇ£
–
i
==31 );

116489 
	`ã°ˇ£
–
i
==32 );

116490 
	`ã°ˇ£
–
i
==33 );

116491 
	`ã°ˇ£
–
i
==34 );

116492 
	`ã°ˇ£
–
i
==35 );

116493 
	`ã°ˇ£
–
i
==36 );

116494 
	`ã°ˇ£
–
i
==37 );

116495 
	`ã°ˇ£
–
i
==38 );

116496 
	`ã°ˇ£
–
i
==39 );

116497 
	`ã°ˇ£
–
i
==40 );

116498 
	`ã°ˇ£
–
i
==41 );

116499 
	`ã°ˇ£
–
i
==42 );

116500 
	`ã°ˇ£
–
i
==43 );

116501 
	`ã°ˇ£
–
i
==44 );

116502 
	`ã°ˇ£
–
i
==45 );

116503 
	`ã°ˇ£
–
i
==46 );

116504 
	`ã°ˇ£
–
i
==47 );

116505 
	`ã°ˇ£
–
i
==48 );

116506 
	`ã°ˇ£
–
i
==49 );

116507 
	`ã°ˇ£
–
i
==50 );

116508 
	`ã°ˇ£
–
i
==51 );

116509 
	`ã°ˇ£
–
i
==52 );

116510 
	`ã°ˇ£
–
i
==53 );

116511 
	`ã°ˇ£
–
i
==54 );

116512 
	`ã°ˇ£
–
i
==55 );

116513 
	`ã°ˇ£
–
i
==56 );

116514 
	`ã°ˇ£
–
i
==57 );

116515 
	`ã°ˇ£
–
i
==58 );

116516 
	`ã°ˇ£
–
i
==59 );

116517 
	`ã°ˇ£
–
i
==60 );

116518 
	`ã°ˇ£
–
i
==61 );

116519 
	`ã°ˇ£
–
i
==62 );

116520 
	`ã°ˇ£
–
i
==63 );

116521 
	`ã°ˇ£
–
i
==64 );

116522 
	`ã°ˇ£
–
i
==65 );

116523 
	`ã°ˇ£
–
i
==66 );

116524 
	`ã°ˇ£
–
i
==67 );

116525 
	`ã°ˇ£
–
i
==68 );

116526 
	`ã°ˇ£
–
i
==69 );

116527 
	`ã°ˇ£
–
i
==70 );

116528 
	`ã°ˇ£
–
i
==71 );

116529 
	`ã°ˇ£
–
i
==72 );

116530 
	`ã°ˇ£
–
i
==73 );

116531 
	`ã°ˇ£
–
i
==74 );

116532 
	`ã°ˇ£
–
i
==75 );

116533 
	`ã°ˇ£
–
i
==76 );

116534 
	`ã°ˇ£
–
i
==77 );

116535 
	`ã°ˇ£
–
i
==78 );

116536 
	`ã°ˇ£
–
i
==79 );

116537 
	`ã°ˇ£
–
i
==80 );

116538 
	`ã°ˇ£
–
i
==81 );

116539 
	`ã°ˇ£
–
i
==82 );

116540 
	`ã°ˇ£
–
i
==83 );

116541 
	`ã°ˇ£
–
i
==84 );

116542 
	`ã°ˇ£
–
i
==85 );

116543 
	`ã°ˇ£
–
i
==86 );

116544 
	`ã°ˇ£
–
i
==87 );

116545 
	`ã°ˇ£
–
i
==88 );

116546 
	`ã°ˇ£
–
i
==89 );

116547 
	`ã°ˇ£
–
i
==90 );

116548 
	`ã°ˇ£
–
i
==91 );

116549 
	`ã°ˇ£
–
i
==92 );

116550 
	`ã°ˇ£
–
i
==93 );

116551 
	`ã°ˇ£
–
i
==94 );

116552 
	`ã°ˇ£
–
i
==95 );

116553 
	`ã°ˇ£
–
i
==96 );

116554 
	`ã°ˇ£
–
i
==97 );

116555 
	`ã°ˇ£
–
i
==98 );

116556 
	`ã°ˇ£
–
i
==99 );

116557 
	`ã°ˇ£
–
i
==100 );

116558 
	`ã°ˇ£
–
i
==101 );

116559 
	`ã°ˇ£
–
i
==102 );

116560 
	`ã°ˇ£
–
i
==103 );

116561 
	`ã°ˇ£
–
i
==104 );

116562 
	`ã°ˇ£
–
i
==105 );

116563 
	`ã°ˇ£
–
i
==106 );

116564 
	`ã°ˇ£
–
i
==107 );

116565 
	`ã°ˇ£
–
i
==108 );

116566 
	`ã°ˇ£
–
i
==109 );

116567 
	`ã°ˇ£
–
i
==110 );

116568 
	`ã°ˇ£
–
i
==111 );

116569 
	`ã°ˇ£
–
i
==112 );

116570 
	`ã°ˇ£
–
i
==113 );

116571 
	`ã°ˇ£
–
i
==114 );

116572 
	`ã°ˇ£
–
i
==115 );

116573 
	`ã°ˇ£
–
i
==116 );

116574 
	`ã°ˇ£
–
i
==117 );

116575 
	`ã°ˇ£
–
i
==118 );

116576 
	`ã°ˇ£
–
i
==119 );

116577 
	`ã°ˇ£
–
i
==120 );

116578  
aCode
[
i
];

116581  
TK_ID
;

116583 
SQLITE_PRIVATE
 
	`sqlôe3Keyw‹dCode
(c⁄° *
z
, 
n
){

116584  
	`keyw‹dCode
((*)
z
, 
n
);

116586 
	#SQLITE_N_KEYWORD
 121

	)

116608 #ifde‡
SQLITE_ASCII


116609 
	#IdCh¨
(
C
Ë((
sqlôe3Cty≥M≠
[()C]&0x46)!=0)

	)

116611 #ifde‡
SQLITE_EBCDIC


116612 
SQLITE_PRIVATE
 c⁄° 
sqlôe3IsEbcdicIdCh¨
[] = {

116627 
	#IdCh¨
(
C
Ë(((
c
=C)>=0x42 && 
sqlôe3IsEbcdicIdCh¨
[c-0x40]))

	)

116635 
SQLITE_PRIVATE
 
	`sqlôe3GëTokí
(c⁄° *
z
, *
tokíTy≥
){

116636 
i
, 
c
;

116637  *
z
 ){

116639 
	`ã°ˇ£
–
z
[0]==' ' );

116640 
	`ã°ˇ£
–
z
[0]=='\t' );

116641 
	`ã°ˇ£
–
z
[0]=='\n' );

116642 
	`ã°ˇ£
–
z
[0]=='\f' );

116643 
	`ã°ˇ£
–
z
[0]=='\r' );

116644 
i
=1; 
	`sqlôe3Is•a˚
(
z
[i]); i++){}

116645 *
tokíTy≥
 = 
TK_SPACE
;

116646  
i
;

116649 if–
z
[1]=='-' ){

116650 
i
=2; (
c
=
z
[i])!=0 && c!='\n'; i++){}

116651 *
tokíTy≥
 = 
TK_SPACE
;

116652  
i
;

116654 *
tokíTy≥
 = 
TK_MINUS
;

116658 *
tokíTy≥
 = 
TK_LP
;

116662 *
tokíTy≥
 = 
TK_RP
;

116666 *
tokíTy≥
 = 
TK_SEMI
;

116670 *
tokíTy≥
 = 
TK_PLUS
;

116674 *
tokíTy≥
 = 
TK_STAR
;

116678 if–
z
[1]!='*' || z[2]==0 ){

116679 *
tokíTy≥
 = 
TK_SLASH
;

116682 
i
=3, 
c
=
z
[2]; (c!='*' || z[i]!='/') && (c=z[i])!=0; i++){}

116683 if–
c
 ) 
i
++;

116684 *
tokíTy≥
 = 
TK_SPACE
;

116685  
i
;

116688 *
tokíTy≥
 = 
TK_REM
;

116692 *
tokíTy≥
 = 
TK_EQ
;

116693  1 + (
z
[1]=='=');

116696 if–(
c
=
z
[1])=='=' ){

116697 *
tokíTy≥
 = 
TK_LE
;

116699 }if–
c
=='>' ){

116700 *
tokíTy≥
 = 
TK_NE
;

116702 }if–
c
=='<' ){

116703 *
tokíTy≥
 = 
TK_LSHIFT
;

116706 *
tokíTy≥
 = 
TK_LT
;

116711 if–(
c
=
z
[1])=='=' ){

116712 *
tokíTy≥
 = 
TK_GE
;

116714 }if–
c
=='>' ){

116715 *
tokíTy≥
 = 
TK_RSHIFT
;

116718 *
tokíTy≥
 = 
TK_GT
;

116723 if–
z
[1]!='=' ){

116724 *
tokíTy≥
 = 
TK_ILLEGAL
;

116727 *
tokíTy≥
 = 
TK_NE
;

116732 if–
z
[1]!='|' ){

116733 *
tokíTy≥
 = 
TK_BITOR
;

116736 *
tokíTy≥
 = 
TK_CONCAT
;

116741 *
tokíTy≥
 = 
TK_COMMA
;

116745 *
tokíTy≥
 = 
TK_BITAND
;

116749 *
tokíTy≥
 = 
TK_BITNOT
;

116755 
dñim
 = 
z
[0];

116756 
	`ã°ˇ£
–
dñim
=='`' );

116757 
	`ã°ˇ£
–
dñim
=='\'' );

116758 
	`ã°ˇ£
–
dñim
=='"' );

116759 
i
=1; (
c
=
z
[i])!=0; i++){

116760 if–
c
==
dñim
 ){

116761 if–
z
[
i
+1]==
dñim
 ){

116762 
i
++;

116768 if–
c
=='\'' ){

116769 *
tokíTy≥
 = 
TK_STRING
;

116770  
i
+1;

116771 }if–
c
!=0 ){

116772 *
tokíTy≥
 = 
TK_ID
;

116773  
i
+1;

116775 *
tokíTy≥
 = 
TK_ILLEGAL
;

116776  
i
;

116780 #i‚de‡
SQLITE_OMIT_FLOATING_POINT


116781 if–!
	`sqlôe3Isdigô
(
z
[1]) )

116784 *
tokíTy≥
 = 
TK_DOT
;

116792 
	`ã°ˇ£
–
z
[0]=='0' );Åestcase( z[0]=='1' );Åestcase( z[0]=='2' );

116793 
	`ã°ˇ£
–
z
[0]=='3' );Åestcase( z[0]=='4' );Åestcase( z[0]=='5' );

116794 
	`ã°ˇ£
–
z
[0]=='6' );Åestcase( z[0]=='7' );Åestcase( z[0]=='8' );

116795 
	`ã°ˇ£
–
z
[0]=='9' );

116796 *
tokíTy≥
 = 
TK_INTEGER
;

116797 
i
=0; 
	`sqlôe3Isdigô
(
z
[i]); i++){}

116798 #i‚de‡
SQLITE_OMIT_FLOATING_POINT


116799 if–
z
[
i
]=='.' ){

116800 
i
++;

116801  
	`sqlôe3Isdigô
(
z
[
i
]) ){ i++; }

116802 *
tokíTy≥
 = 
TK_FLOAT
;

116804 if–(
z
[
i
]=='e' || z[i]=='E') &&

116805 –
	`sqlôe3Isdigô
(
z
[
i
+1])

116806 || ((
z
[
i
+1]=='+' || z[i+1]=='-'Ë&& 
	`sqlôe3Isdigô
(z[i+2]))

116809 
i
 += 2;

116810  
	`sqlôe3Isdigô
(
z
[
i
]) ){ i++; }

116811 *
tokíTy≥
 = 
TK_FLOAT
;

116814  
	`IdCh¨
(
z
[
i
]) ){

116815 *
tokíTy≥
 = 
TK_ILLEGAL
;

116816 
i
++;

116818  
i
;

116821 
i
=1, 
c
=
z
[0]; c!=']' && (c=z[i])!=0; i++){}

116822 *
tokíTy≥
 = 
c
==']' ? 
TK_ID
 : 
TK_ILLEGAL
;

116823  
i
;

116826 *
tokíTy≥
 = 
TK_VARIABLE
;

116827 
i
=1; 
	`sqlôe3Isdigô
(
z
[i]); i++){}

116828  
i
;

116831 
i
=1; 
	`sqlôe3Isdigô
(
z
[i]); i++){}

116832 if–
i
>1 ){

116835 *
tokíTy≥
 = 
TK_REGISTER
;

116836  
i
;

116841 #i‚de‡
SQLITE_OMIT_TCL_VARIABLE


116846 
n
 = 0;

116847 
	`ã°ˇ£
–
z
[0]=='$' );Åestcase( z[0]=='@' );Åestcase( z[0]==':' );

116848 *
tokíTy≥
 = 
TK_VARIABLE
;

116849 
i
=1; (
c
=
z
[i])!=0; i++){

116850 if–
	`IdCh¨
(
c
) ){

116851 
n
++;

116852 #i‚de‡
SQLITE_OMIT_TCL_VARIABLE


116853 }if–
c
=='(' && 
n
>0 ){

116855 
i
++;

116856 } (
c
=
z
[
i
])!=0 && !
	`sqlôe3Is•a˚
(c) && c!=')' );

116857 if–
c
==')' ){

116858 
i
++;

116860 *
tokíTy≥
 = 
TK_ILLEGAL
;

116863 }if–
c
==':' && 
z
[
i
+1]==':' ){

116864 
i
++;

116870 if–
n
==0 ) *
tokíTy≥
 = 
TK_ILLEGAL
;

116871  
i
;

116873 #i‚de‡
SQLITE_OMIT_BLOB_LITERAL


116875 
	`ã°ˇ£
–
z
[0]=='x' );Åestcase( z[0]=='X' );

116876 if–
z
[1]=='\'' ){

116877 *
tokíTy≥
 = 
TK_BLOB
;

116878 
i
=2; 
	`sqlôe3Isxdigô
(
z
[i]); i++){}

116879 if–
z
[
i
]!='\'' || i%2 ){

116880 *
tokíTy≥
 = 
TK_ILLEGAL
;

116881  
z
[
i
] && z[i]!='\'' ){ i++; }

116883 if–
z
[
i
] ) i++;

116884  
i
;

116890 if–!
	`IdCh¨
(*
z
) ){

116893 
i
=1; 
	`IdCh¨
(
z
[i]); i++){}

116894 *
tokíTy≥
 = 
	`keyw‹dCode
((*)
z
, 
i
);

116895  
i
;

116898 *
tokíTy≥
 = 
TK_ILLEGAL
;

116909 
SQLITE_PRIVATE
 
	`sqlôe3RunP¨£r
(
P¨£
 *
pP¨£
, c⁄° *
zSql
, **
pzEºMsg
){

116910 
nEº
 = 0;

116911 
i
;

116912 *
pEngöe
;

116913 
tokíTy≥
;

116914 
œ°TokíP¨£d
 = -1;

116915 
u8
 
íabÀLookaside
;

116916 
sqlôe3
 *
db
 = 
pP¨£
->db;

116917 
mxSqlLí
;

116920 
mxSqlLí
 = 
db
->
aLimô
[
SQLITE_LIMIT_SQL_LENGTH
];

116921 if–
db
->
nVdbeA˘ive
==0 ){

116922 
db
->
u1
.
isI¡îru±ed
 = 0;

116924 
pP¨£
->
rc
 = 
SQLITE_OK
;

116925 
pP¨£
->
zTaû
 = 
zSql
;

116926 
i
 = 0;

116927 
	`as£π
–
pzEºMsg
!=0 );

116928 
pEngöe
 = 
	`sqlôe3P¨£rAŒoc
((*(*)(
size_t
))
sqlôe3MÆloc
);

116929 if–
pEngöe
==0 ){

116930 
db
->
mÆlocFaûed
 = 1;

116931  
SQLITE_NOMEM
;

116933 
	`as£π
–
pP¨£
->
pNewTabÀ
==0 );

116934 
	`as£π
–
pP¨£
->
pNewTriggî
==0 );

116935 
	`as£π
–
pP¨£
->
nV¨
==0 );

116936 
	`as£π
–
pP¨£
->
nzV¨
==0 );

116937 
	`as£π
–
pP¨£
->
azV¨
==0 );

116938 
íabÀLookaside
 = 
db
->
lookaside
.
bE«bÀd
;

116939 if–
db
->
lookaside
.
pSèπ
 ) db->lookaside.
bE«bÀd
 = 1;

116940  !
db
->
mÆlocFaûed
 && 
zSql
[
i
]!=0 ){

116941 
	`as£π
–
i
>=0 );

116942 
pP¨£
->
sLa°Tokí
.
z
 = &
zSql
[
i
];

116943 
pP¨£
->
sLa°Tokí
.
n
 = 
	`sqlôe3GëTokí
((*)&
zSql
[
i
],&
tokíTy≥
);

116944 
i
 +
pP¨£
->
sLa°Tokí
.
n
;

116945 if–
i
>
mxSqlLí
 ){

116946 
pP¨£
->
rc
 = 
SQLITE_TOOBIG
;

116949  
tokíTy≥
 ){

116950 
TK_SPACE
: {

116951 if–
db
->
u1
.
isI¡îru±ed
 ){

116952 
	`sqlôe3Eº‹Msg
(
pP¨£
, "interrupt");

116953 
pP¨£
->
rc
 = 
SQLITE_INTERRUPT
;

116954 
ab‹t_∑r£
;

116958 
TK_ILLEGAL
: {

116959 
	`sqlôe3DbFªe
(
db
, *
pzEºMsg
);

116960 *
pzEºMsg
 = 
	`sqlôe3MPrötf
(
db
, "unrecognizedÅoken: \"%T\"",

116961 &
pP¨£
->
sLa°Tokí
);

116962 
nEº
++;

116963 
ab‹t_∑r£
;

116965 
TK_SEMI
: {

116966 
pP¨£
->
zTaû
 = &
zSql
[
i
];

116970 
	`sqlôe3P¨£r
(
pEngöe
, 
tokíTy≥
, 
pP¨£
->
sLa°Tokí
,ÖParse);

116971 
œ°TokíP¨£d
 = 
tokíTy≥
;

116972 if–
pP¨£
->
rc
!=
SQLITE_OK
 ){

116973 
ab‹t_∑r£
;

116979 
ab‹t_∑r£
:

116980 if–
zSql
[
i
]==0 && 
nEº
==0 && 
pP¨£
->
rc
==
SQLITE_OK
 ){

116981 if–
œ°TokíP¨£d
!=
TK_SEMI
 ){

116982 
	`sqlôe3P¨£r
(
pEngöe
, 
TK_SEMI
, 
pP¨£
->
sLa°Tokí
,ÖParse);

116983 
pP¨£
->
zTaû
 = &
zSql
[
i
];

116985 
	`sqlôe3P¨£r
(
pEngöe
, 0, 
pP¨£
->
sLa°Tokí
,ÖParse);

116987 #ifde‡
YYTRACKMAXSTACKDEPTH


116988 
	`sqlôe3SètusSë
(
SQLITE_STATUS_PARSER_STACK
,

116989 
	`sqlôe3P¨£rSèckPók
(
pEngöe
)

116992 
	`sqlôe3P¨£rFªe
(
pEngöe
, 
sqlôe3_‰ì
);

116993 
db
->
lookaside
.
bE«bÀd
 = 
íabÀLookaside
;

116994 if–
db
->
mÆlocFaûed
 ){

116995 
pP¨£
->
rc
 = 
SQLITE_NOMEM
;

116997 if–
pP¨£
->
rc
!=
SQLITE_OK
 &&ÖP¨£->rc!=
SQLITE_DONE
 &&ÖP¨£->
zEºMsg
==0 ){

116998 
	`sqlôe3SëSåög
(&
pP¨£
->
zEºMsg
, 
db
, "%s", 
	`sqlôe3EºSå
’P¨£->
rc
));

117000 
	`as£π
–
pzEºMsg
!=0 );

117001 if–
pP¨£
->
zEºMsg
 ){

117002 *
pzEºMsg
 = 
pP¨£
->
zEºMsg
;

117003 
	`sqlôe3_log
(
pP¨£
->
rc
, "%s", *
pzEºMsg
);

117004 
pP¨£
->
zEºMsg
 = 0;

117005 
nEº
++;

117007 if–
pP¨£
->
pVdbe
 &&ÖP¨£->
nEº
>0 &&ÖP¨£->
√°ed
==0 ){

117008 
	`sqlôe3VdbeDñëe
(
pP¨£
->
pVdbe
);

117009 
pP¨£
->
pVdbe
 = 0;

117011 #i‚de‡
SQLITE_OMIT_SHARED_CACHE


117012 if–
pP¨£
->
√°ed
==0 ){

117013 
	`sqlôe3DbFªe
(
db
, 
pP¨£
->
aTabÀLock
);

117014 
pP¨£
->
aTabÀLock
 = 0;

117015 
pP¨£
->
nTabÀLock
 = 0;

117018 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


117019 
	`sqlôe3_‰ì
(
pP¨£
->
≠VèbLock
);

117022 if–!
IN_DECLARE_VTAB
 ){

117027 
	`sqlôe3DñëeTabÀ
(
db
, 
pP¨£
->
pNewTabÀ
);

117030 
	`sqlôe3DñëeTriggî
(
db
, 
pP¨£
->
pNewTriggî
);

117031 
i
=
pP¨£
->
nzV¨
-1; i>=0; i--Ë
	`sqlôe3DbFªe
(
db
,ÖP¨£->
azV¨
[i]);

117032 
	`sqlôe3DbFªe
(
db
, 
pP¨£
->
azV¨
);

117033 
	`sqlôe3DbFªe
(
db
, 
pP¨£
->
aAlüs
);

117034  
pP¨£
->
pAöc
 ){

117035 
AutoöcInfo
 *
p
 = 
pP¨£
->
pAöc
;

117036 
pP¨£
->
pAöc
 = 
p
->
pNext
;

117037 
	`sqlôe3DbFªe
(
db
, 
p
);

117039  
pP¨£
->
pZombõTab
 ){

117040 
TabÀ
 *
p
 = 
pP¨£
->
pZombõTab
;

117041 
pP¨£
->
pZombõTab
 = 
p
->
pNextZombõ
;

117042 
	`sqlôe3DñëeTabÀ
(
db
, 
p
);

117044 if–
nEº
>0 && 
pP¨£
->
rc
==
SQLITE_OK
 ){

117045 
pP¨£
->
rc
 = 
SQLITE_ERROR
;

117047  
nEº
;

117070 #i‚de‡
SQLITE_OMIT_COMPLETE


117075 #i‚de‡
SQLITE_AMALGAMATION


117076 #ifde‡
SQLITE_ASCII


117077 
	#IdCh¨
(
C
Ë((
sqlôe3Cty≥M≠
[()C]&0x46)!=0)

	)

117079 #ifde‡
SQLITE_EBCDIC


117080 
SQLITE_PRIVATE
 c⁄° 
sqlôe3IsEbcdicIdCh¨
[];

117081 
	#IdCh¨
(
C
Ë(((
c
=C)>=0x42 && 
sqlôe3IsEbcdicIdCh¨
[c-0x40]))

	)

117090 
	#tkSEMI
 0

	)

117091 
	#tkWS
 1

	)

117092 
	#tkOTHER
 2

	)

117093 #i‚de‡
SQLITE_OMIT_TRIGGER


117094 
	#tkEXPLAIN
 3

	)

117095 
	#tkCREATE
 4

	)

117096 
	#tkTEMP
 5

	)

117097 
	#tkTRIGGER
 6

	)

117098 
	#tkEND
 7

	)

117154 
SQLITE_API
 
	`sqlôe3_com∂ëe
(c⁄° *
zSql
){

117155 
u8
 
°©e
 = 0;

117156 
u8
 
tokí
;

117158 #i‚de‡
SQLITE_OMIT_TRIGGER


117162 c⁄° 
u8
 
å™s
[8][8] = {

117178 c⁄° 
u8
 
å™s
[3][3] = {

117187  *
zSql
 ){

117188  *
zSql
 ){

117190 
tokí
 = 
tkSEMI
;

117198 
tokí
 = 
tkWS
;

117202 if–
zSql
[1]!='*' ){

117203 
tokí
 = 
tkOTHER
;

117206 
zSql
 += 2;

117207  
zSql
[0] && (zSql[0]!='*' || zSql[1]!='/') ){ zSql++; }

117208 if–
zSql
[0]==0 )  0;

117209 
zSql
++;

117210 
tokí
 = 
tkWS
;

117214 if–
zSql
[1]!='-' ){

117215 
tokí
 = 
tkOTHER
;

117218  *
zSql
 && *zSql!='\n' ){ zSql++; }

117219 if–*
zSql
==0 )  
°©e
==1;

117220 
tokí
 = 
tkWS
;

117224 
zSql
++;

117225  *
zSql
 && *zSql!=']' ){ zSql++; }

117226 if–*
zSql
==0 )  0;

117227 
tokí
 = 
tkOTHER
;

117233 
c
 = *
zSql
;

117234 
zSql
++;

117235  *
zSql
 && *zSql!=
c
 ){ zSql++; }

117236 if–*
zSql
==0 )  0;

117237 
tokí
 = 
tkOTHER
;

117241 #ifde‡
SQLITE_EBCDIC


117242 
c
;

117244 if–
	`IdCh¨
((
u8
)*
zSql
) ){

117246 
nId
;

117247 
nId
=1; 
	`IdCh¨
(
zSql
[nId]);ÇId++){}

117248 #ifde‡
SQLITE_OMIT_TRIGGER


117249 
tokí
 = 
tkOTHER
;

117251  *
zSql
 ){

117253 if–
nId
==6 && 
	`sqlôe3SåNICmp
(
zSql
, "create", 6)==0 ){

117254 
tokí
 = 
tkCREATE
;

117256 
tokí
 = 
tkOTHER
;

117261 if–
nId
==7 && 
	`sqlôe3SåNICmp
(
zSql
, "trigger", 7)==0 ){

117262 
tokí
 = 
tkTRIGGER
;

117263 }if–
nId
==4 && 
	`sqlôe3SåNICmp
(
zSql
, "temp", 4)==0 ){

117264 
tokí
 = 
tkTEMP
;

117265 }if–
nId
==9 && 
	`sqlôe3SåNICmp
(
zSql
, "temporary", 9)==0 ){

117266 
tokí
 = 
tkTEMP
;

117268 
tokí
 = 
tkOTHER
;

117273 if–
nId
==3 && 
	`sqlôe3SåNICmp
(
zSql
, "end", 3)==0 ){

117274 
tokí
 = 
tkEND
;

117276 #i‚de‡
SQLITE_OMIT_EXPLAIN


117277 if–
nId
==7 && 
	`sqlôe3SåNICmp
(
zSql
, "explain", 7)==0 ){

117278 
tokí
 = 
tkEXPLAIN
;

117282 
tokí
 = 
tkOTHER
;

117287 
tokí
 = 
tkOTHER
;

117292 
zSql
 +
nId
-1;

117295 
tokí
 = 
tkOTHER
;

117300 
°©e
 = 
å™s
[°©e][
tokí
];

117301 
zSql
++;

117303  
°©e
==1;

117306 #i‚de‡
SQLITE_OMIT_UTF16


117312 
SQLITE_API
 
	`sqlôe3_com∂ëe16
(c⁄° *
zSql
){

117313 
sqlôe3_vÆue
 *
pVÆ
;

117314 c⁄° *
zSql8
;

117315 
rc
 = 
SQLITE_NOMEM
;

117317 #i‚de‡
SQLITE_OMIT_AUTOINIT


117318 
rc
 = 
	`sqlôe3_öôülize
();

117319 if–
rc
 ) Ñc;

117321 
pVÆ
 = 
	`sqlôe3VÆueNew
(0);

117322 
	`sqlôe3VÆueSëSå
(
pVÆ
, -1, 
zSql
, 
SQLITE_UTF16NATIVE
, 
SQLITE_STATIC
);

117323 
zSql8
 = 
	`sqlôe3VÆueText
(
pVÆ
, 
SQLITE_UTF8
);

117324 if–
zSql8
 ){

117325 
rc
 = 
	`sqlôe3_com∂ëe
(
zSql8
);

117327 
rc
 = 
SQLITE_NOMEM
;

117329 
	`sqlôe3VÆueFªe
(
pVÆ
);

117330  
	`sqlôe3ApiExô
(0, 
rc
);

117354 #ifde‡
SQLITE_ENABLE_FTS3


117377 
SQLITE_PRIVATE
 
	`sqlôe3Fts3Inô
(
sqlôe3
 *
db
);

117386 #ifde‡
SQLITE_ENABLE_RTREE


117409 
SQLITE_PRIVATE
 
	`sqlôe3RåìInô
(
sqlôe3
 *
db
);

117418 #ifde‡
SQLITE_ENABLE_ICU


117441 
SQLITE_PRIVATE
 
	`sqlôe3IcuInô
(
sqlôe3
 *
db
);

117452 #i‚de‡
SQLITE_AMALGAMATION


117456 
SQLITE_API
 c⁄° 
sqlôe3_vîsi⁄
[] = 
SQLITE_VERSION
;

117462 
SQLITE_API
 c⁄° *
	`sqlôe3_libvîsi⁄
(){  
sqlôe3_vîsi⁄
; }

117468 
SQLITE_API
 c⁄° *
	`sqlôe3_sour˚id
(){  
SQLITE_SOURCE_ID
; }

117473 
SQLITE_API
 
	`sqlôe3_libvîsi⁄_numbî
(){  
SQLITE_VERSION_NUMBER
; }

117479 
SQLITE_API
 
	`sqlôe3_thªadß„
(){  
SQLITE_THREADSAFE
; }

117481 #i‡!
	`deföed
(
SQLITE_OMIT_TRACE
Ë&& deföed(
SQLITE_ENABLE_IOTRACE
)

117488 
SQLITE_PRIVATE
 (*
sqlôe3IoTø˚
)(const *, ...) = 0;

117498 
SQLITE_API
 *
sqlôe3_ãmp_dúe˘‹y
 = 0;

117507 
SQLITE_API
 *
sqlôe3_d©a_dúe˘‹y
 = 0;

117540 
SQLITE_API
 
	`sqlôe3_öôülize
(){

117541 
	`MUTEX_LOGIC
–
sqlôe3_muãx
 *
pMa°î
; )

117542 
rc
;

117543 #ifde‡
SQLITE_EXTRA_INIT


117544 
bRunExåaInô
 = 0;

117547 #ifde‡
SQLITE_OMIT_WSD


117548 
rc
 = 
	`sqlôe3_wsd_öô
(4096, 24);

117549 if–
rc
!=
SQLITE_OK
 ){

117550  
rc
;

117559 if–
sqlôe3GlobÆC⁄fig
.
isInô
 )  
SQLITE_OK
;

117561 #ifde‡
SQLITE_ENABLE_SQLLOG


117563 
	`sqlôe3_öô_sqŒog
();

117564 
	`sqlôe3_öô_sqŒog
();

117576 
rc
 = 
	`sqlôe3MuãxInô
();

117577 if–
rc
 ) Ñc;

117585 
	`MUTEX_LOGIC
–
pMa°î
 = 
	`sqlôe3MuãxAŒoc
(
SQLITE_MUTEX_STATIC_MASTER
); )

117586 
	`sqlôe3_muãx_íãr
(
pMa°î
);

117587 
sqlôe3GlobÆC⁄fig
.
isMuãxInô
 = 1;

117588 if–!
sqlôe3GlobÆC⁄fig
.
isMÆlocInô
 ){

117589 
rc
 = 
	`sqlôe3MÆlocInô
();

117591 if–
rc
==
SQLITE_OK
 ){

117592 
sqlôe3GlobÆC⁄fig
.
isMÆlocInô
 = 1;

117593 if–!
sqlôe3GlobÆC⁄fig
.
pInôMuãx
 ){

117594 
sqlôe3GlobÆC⁄fig
.
pInôMuãx
 =

117595 
	`sqlôe3MuãxAŒoc
(
SQLITE_MUTEX_RECURSIVE
);

117596 if–
sqlôe3GlobÆC⁄fig
.
bC‹eMuãx
 && !sqlôe3GlobÆC⁄fig.
pInôMuãx
 ){

117597 
rc
 = 
SQLITE_NOMEM
;

117601 if–
rc
==
SQLITE_OK
 ){

117602 
sqlôe3GlobÆC⁄fig
.
nRefInôMuãx
++;

117604 
	`sqlôe3_muãx_Àave
(
pMa°î
);

117609 if–
rc
!=
SQLITE_OK
 ){

117610  
rc
;

117626 
	`sqlôe3_muãx_íãr
(
sqlôe3GlobÆC⁄fig
.
pInôMuãx
);

117627 if–
sqlôe3GlobÆC⁄fig
.
isInô
==0 && sqlôe3GlobÆC⁄fig.
öProgªss
==0 ){

117628 
FuncDefHash
 *
pHash
 = &
	`GLOBAL
(FuncDefHash, 
sqlôe3GlobÆFun˘i⁄s
);

117629 
sqlôe3GlobÆC⁄fig
.
öProgªss
 = 1;

117630 
	`mem£t
(
pHash
, 0, (
sqlôe3GlobÆFun˘i⁄s
));

117631 
	`sqlôe3Regi°îGlobÆFun˘i⁄s
();

117632 if–
sqlôe3GlobÆC⁄fig
.
isPCacheInô
==0 ){

117633 
rc
 = 
	`sqlôe3PˇcheInôülize
();

117635 if–
rc
==
SQLITE_OK
 ){

117636 
sqlôe3GlobÆC⁄fig
.
isPCacheInô
 = 1;

117637 
rc
 = 
	`sqlôe3OsInô
();

117639 if–
rc
==
SQLITE_OK
 ){

117640 
	`sqlôe3PCacheBuf„rSëup
–
sqlôe3GlobÆC⁄fig
.
pPage
,

117641 
sqlôe3GlobÆC⁄fig
.
szPage
, sqlôe3GlobÆC⁄fig.
nPage
);

117642 
sqlôe3GlobÆC⁄fig
.
isInô
 = 1;

117643 #ifde‡
SQLITE_EXTRA_INIT


117644 
bRunExåaInô
 = 1;

117647 
sqlôe3GlobÆC⁄fig
.
öProgªss
 = 0;

117649 
	`sqlôe3_muãx_Àave
(
sqlôe3GlobÆC⁄fig
.
pInôMuãx
);

117654 
	`sqlôe3_muãx_íãr
(
pMa°î
);

117655 
sqlôe3GlobÆC⁄fig
.
nRefInôMuãx
--;

117656 if–
sqlôe3GlobÆC⁄fig
.
nRefInôMuãx
<=0 ){

117657 
	`as£π
–
sqlôe3GlobÆC⁄fig
.
nRefInôMuãx
==0 );

117658 
	`sqlôe3_muãx_‰ì
(
sqlôe3GlobÆC⁄fig
.
pInôMuãx
);

117659 
sqlôe3GlobÆC⁄fig
.
pInôMuãx
 = 0;

117661 
	`sqlôe3_muãx_Àave
(
pMa°î
);

117668 #i‚de‡
NDEBUG


117669 #i‚de‡
SQLITE_OMIT_FLOATING_POINT


117671 i‡–
rc
==
SQLITE_OK
 ){

117672 
u64
 
x
 = (((u64)1)<<63)-1;

117673 
y
;

117674 
	`as£π
((
x
)==8);

117675 
	`as£π
((
x
)==(
y
));

117676 
	`mem˝y
(&
y
, &
x
, 8);

117677 
	`as£π
–
	`sqlôe3IsNaN
(
y
) );

117685 #ifde‡
SQLITE_EXTRA_INIT


117686 if–
bRunExåaInô
 ){

117687 
	`SQLITE_EXTRA_INIT
(const *);

117688 
rc
 = 
	`SQLITE_EXTRA_INIT
(0);

117692  
rc
;

117703 
SQLITE_API
 
	`sqlôe3_shutdown
(){

117704 if–
sqlôe3GlobÆC⁄fig
.
isInô
 ){

117705 #ifde‡
SQLITE_EXTRA_SHUTDOWN


117706 
	`SQLITE_EXTRA_SHUTDOWN
();

117707 
	`SQLITE_EXTRA_SHUTDOWN
();

117709 
	`sqlôe3_os_íd
();

117710 
	`sqlôe3_ª£t_auto_exãnsi⁄
();

117711 
sqlôe3GlobÆC⁄fig
.
isInô
 = 0;

117713 if–
sqlôe3GlobÆC⁄fig
.
isPCacheInô
 ){

117714 
	`sqlôe3PˇcheShutdown
();

117715 
sqlôe3GlobÆC⁄fig
.
isPCacheInô
 = 0;

117717 if–
sqlôe3GlobÆC⁄fig
.
isMÆlocInô
 ){

117718 
	`sqlôe3MÆlocEnd
();

117719 
sqlôe3GlobÆC⁄fig
.
isMÆlocInô
 = 0;

117721 #i‚de‡
SQLITE_OMIT_SHUTDOWN_DIRECTORIES


117729 
sqlôe3_d©a_dúe˘‹y
 = 0;

117730 
sqlôe3_ãmp_dúe˘‹y
 = 0;

117733 if–
sqlôe3GlobÆC⁄fig
.
isMuãxInô
 ){

117734 
	`sqlôe3MuãxEnd
();

117735 
sqlôe3GlobÆC⁄fig
.
isMuãxInô
 = 0;

117738  
SQLITE_OK
;

117750 
SQLITE_API
 
	`sqlôe3_c⁄fig
(
›
, ...){

117751 
va_li°
 
≠
;

117752 
rc
 = 
SQLITE_OK
;

117756 if–
sqlôe3GlobÆC⁄fig
.
isInô
 )  
SQLITE_MISUSE_BKPT
;

117758 
	`va_°¨t
(
≠
, 
›
);

117759  
›
 ){

117764 #i‡
	`deföed
(
SQLITE_THREADSAFE
) && SQLITE_THREADSAFE>0

117765 
SQLITE_CONFIG_SINGLETHREAD
: {

117767 
sqlôe3GlobÆC⁄fig
.
bC‹eMuãx
 = 0;

117768 
sqlôe3GlobÆC⁄fig
.
bFuŒMuãx
 = 0;

117771 
SQLITE_CONFIG_MULTITHREAD
: {

117774 
sqlôe3GlobÆC⁄fig
.
bC‹eMuãx
 = 1;

117775 
sqlôe3GlobÆC⁄fig
.
bFuŒMuãx
 = 0;

117778 
SQLITE_CONFIG_SERIALIZED
: {

117780 
sqlôe3GlobÆC⁄fig
.
bC‹eMuãx
 = 1;

117781 
sqlôe3GlobÆC⁄fig
.
bFuŒMuãx
 = 1;

117784 
SQLITE_CONFIG_MUTEX
: {

117786 
sqlôe3GlobÆC⁄fig
.
muãx
 = *
	`va_¨g
(
≠
, 
sqlôe3_muãx_mëhods
*);

117789 
SQLITE_CONFIG_GETMUTEX
: {

117791 *
	`va_¨g
(
≠
, 
sqlôe3_muãx_mëhods
*Ë
sqlôe3GlobÆC⁄fig
.
muãx
;

117797 
SQLITE_CONFIG_MALLOC
: {

117799 
sqlôe3GlobÆC⁄fig
.
m
 = *
	`va_¨g
(
≠
, 
sqlôe3_mem_mëhods
*);

117802 
SQLITE_CONFIG_GETMALLOC
: {

117804 if–
sqlôe3GlobÆC⁄fig
.
m
.
xMÆloc
==0 ) 
	`sqlôe3MemSëDeÁu…
();

117805 *
	`va_¨g
(
≠
, 
sqlôe3_mem_mëhods
*Ë
sqlôe3GlobÆC⁄fig
.
m
;

117808 
SQLITE_CONFIG_MEMSTATUS
: {

117810 
sqlôe3GlobÆC⁄fig
.
bMem°©
 = 
	`va_¨g
(
≠
, );

117813 
SQLITE_CONFIG_SCRATCH
: {

117815 
sqlôe3GlobÆC⁄fig
.
pS¸©ch
 = 
	`va_¨g
(
≠
, *);

117816 
sqlôe3GlobÆC⁄fig
.
szS¸©ch
 = 
	`va_¨g
(
≠
, );

117817 
sqlôe3GlobÆC⁄fig
.
nS¸©ch
 = 
	`va_¨g
(
≠
, );

117820 
SQLITE_CONFIG_PAGECACHE
: {

117822 
sqlôe3GlobÆC⁄fig
.
pPage
 = 
	`va_¨g
(
≠
, *);

117823 
sqlôe3GlobÆC⁄fig
.
szPage
 = 
	`va_¨g
(
≠
, );

117824 
sqlôe3GlobÆC⁄fig
.
nPage
 = 
	`va_¨g
(
≠
, );

117828 
SQLITE_CONFIG_PCACHE
: {

117832 
SQLITE_CONFIG_GETPCACHE
: {

117834 
rc
 = 
SQLITE_ERROR
;

117838 
SQLITE_CONFIG_PCACHE2
: {

117840 
sqlôe3GlobÆC⁄fig
.
pˇche2
 = *
	`va_¨g
(
≠
, 
sqlôe3_pˇche_mëhods2
*);

117843 
SQLITE_CONFIG_GETPCACHE2
: {

117844 if–
sqlôe3GlobÆC⁄fig
.
pˇche2
.
xInô
==0 ){

117845 
	`sqlôe3PCacheSëDeÁu…
();

117847 *
	`va_¨g
(
≠
, 
sqlôe3_pˇche_mëhods2
*Ë
sqlôe3GlobÆC⁄fig
.
pˇche2
;

117851 #i‡
	`deföed
(
SQLITE_ENABLE_MEMSYS3
Ë|| deföed(
SQLITE_ENABLE_MEMSYS5
)

117852 
SQLITE_CONFIG_HEAP
: {

117854 
sqlôe3GlobÆC⁄fig
.
pHóp
 = 
	`va_¨g
(
≠
, *);

117855 
sqlôe3GlobÆC⁄fig
.
nHóp
 = 
	`va_¨g
(
≠
, );

117856 
sqlôe3GlobÆC⁄fig
.
mnReq
 = 
	`va_¨g
(
≠
, );

117858 if–
sqlôe3GlobÆC⁄fig
.
mnReq
<1 ){

117859 
sqlôe3GlobÆC⁄fig
.
mnReq
 = 1;

117860 }if–
sqlôe3GlobÆC⁄fig
.
mnReq
>(1<<12) ){

117862 
sqlôe3GlobÆC⁄fig
.
mnReq
 = (1<<12);

117865 if–
sqlôe3GlobÆC⁄fig
.
pHóp
==0 ){

117871 
	`mem£t
(&
sqlôe3GlobÆC⁄fig
.
m
, 0, (sqlite3GlobalConfig.m));

117877 #ifde‡
SQLITE_ENABLE_MEMSYS3


117878 
sqlôe3GlobÆC⁄fig
.
m
 = *
	`sqlôe3MemGëMemsys3
();

117880 #ifde‡
SQLITE_ENABLE_MEMSYS5


117881 
sqlôe3GlobÆC⁄fig
.
m
 = *
	`sqlôe3MemGëMemsys5
();

117888 
SQLITE_CONFIG_LOOKASIDE
: {

117889 
sqlôe3GlobÆC⁄fig
.
szLookaside
 = 
	`va_¨g
(
≠
, );

117890 
sqlôe3GlobÆC⁄fig
.
nLookaside
 = 
	`va_¨g
(
≠
, );

117898 
SQLITE_CONFIG_LOG
: {

117903 (*
	tLOGFUNC_t
)(*,,const *);

117904 
sqlôe3GlobÆC⁄fig
.
xLog
 = 
	`va_¨g
(
≠
, 
LOGFUNC_t
);

117905 
sqlôe3GlobÆC⁄fig
.
pLogArg
 = 
	`va_¨g
(
≠
, *);

117909 
SQLITE_CONFIG_URI
: {

117910 
sqlôe3GlobÆC⁄fig
.
bO≥nUri
 = 
	`va_¨g
(
≠
, );

117914 
SQLITE_CONFIG_COVERING_INDEX_SCAN
: {

117915 
sqlôe3GlobÆC⁄fig
.
bU£Cis
 = 
	`va_¨g
(
≠
, );

117919 #ifde‡
SQLITE_ENABLE_SQLLOG


117920 
SQLITE_CONFIG_SQLLOG
: {

117921 (*
	tSQLLOGFUNC_t
)(*, 
	tsqlôe3
*, const *, );

117922 
sqlôe3GlobÆC⁄fig
.
xSqŒog
 = 
	`va_¨g
(
≠
, 
SQLLOGFUNC_t
);

117923 
sqlôe3GlobÆC⁄fig
.
pSqŒogArg
 = 
	`va_¨g
(
≠
, *);

117928 
SQLITE_CONFIG_MMAP_SIZE
: {

117929 
sqlôe3_öt64
 
szMm≠
 = 
	`va_¨g
(
≠
, sqlite3_int64);

117930 
sqlôe3_öt64
 
mxMm≠
 = 
	`va_¨g
(
≠
, sqlite3_int64);

117931 if–
mxMm≠
<0 || mxMm≠>
SQLITE_MAX_MMAP_SIZE
 ){

117932 
mxMm≠
 = 
SQLITE_MAX_MMAP_SIZE
;

117934 
sqlôe3GlobÆC⁄fig
.
mxMm≠
 = mxMmap;

117935 if–
szMm≠
<0 ) szMm≠ = 
SQLITE_DEFAULT_MMAP_SIZE
;

117936 if–
szMm≠
>
mxMm≠
) szMmap = mxMmap;

117937 
sqlôe3GlobÆC⁄fig
.
szMm≠
 = szMmap;

117942 
rc
 = 
SQLITE_ERROR
;

117946 
	`va_íd
(
≠
);

117947  
rc
;

117961 
	`£tupLookaside
(
sqlôe3
 *
db
, *
pBuf
, 
sz
, 
˙t
){

117962 *
pSèπ
;

117963 if–
db
->
lookaside
.
nOut
 ){

117964  
SQLITE_BUSY
;

117970 if–
db
->
lookaside
.
bMÆlo˚d
 ){

117971 
	`sqlôe3_‰ì
(
db
->
lookaside
.
pSèπ
);

117976 
sz
 = 
	`ROUNDDOWN8
(sz);

117977 if–
sz
<=()(
LookasideSlŸ
*) ) sz = 0;

117978 if–
˙t
<0 ) cnt = 0;

117979 if–
sz
==0 || 
˙t
==0 ){

117980 
sz
 = 0;

117981 
pSèπ
 = 0;

117982 }if–
pBuf
==0 ){

117983 
	`sqlôe3BegöBíignMÆloc
();

117984 
pSèπ
 = 
	`sqlôe3MÆloc
–
sz
*
˙t
 );

117985 
	`sqlôe3EndBíignMÆloc
();

117986 if–
pSèπ
 ) 
˙t
 = 
	`sqlôe3MÆlocSize
’Sèπ)/
sz
;

117988 
pSèπ
 = 
pBuf
;

117990 
db
->
lookaside
.
pSèπ
 =ÖStart;

117991 
db
->
lookaside
.
pFªe
 = 0;

117992 
db
->
lookaside
.
sz
 = (
u16
)sz;

117993 if–
pSèπ
 ){

117994 
i
;

117995 
LookasideSlŸ
 *
p
;

117996 
	`as£π
–
sz
 > ()(
LookasideSlŸ
*) );

117997 
p
 = (
LookasideSlŸ
*)
pSèπ
;

117998 
i
=
˙t
-1; i>=0; i--){

117999 
p
->
pNext
 = 
db
->
lookaside
.
pFªe
;

118000 
db
->
lookaside
.
pFªe
 = 
p
;

118001 
p
 = (
LookasideSlŸ
*)&((
u8
*Ì)[
sz
];

118003 
db
->
lookaside
.
pEnd
 = 
p
;

118004 
db
->
lookaside
.
bE«bÀd
 = 1;

118005 
db
->
lookaside
.
bMÆlo˚d
 = 
pBuf
==0 ?1:0;

118007 
db
->
lookaside
.
pEnd
 = 0;

118008 
db
->
lookaside
.
bE«bÀd
 = 0;

118009 
db
->
lookaside
.
bMÆlo˚d
 = 0;

118011  
SQLITE_OK
;

118017 
SQLITE_API
 
sqlôe3_muãx
 *
	`sqlôe3_db_muãx
(
sqlôe3
 *
db
){

118018  
db
->
muãx
;

118025 
SQLITE_API
 
	`sqlôe3_db_ªÀa£_mem‹y
(
sqlôe3
 *
db
){

118026 
i
;

118027 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

118028 
	`sqlôe3BåìE¡îAŒ
(
db
);

118029 
i
=0; i<
db
->
nDb
; i++){

118030 
Båì
 *
pBt
 = 
db
->
aDb
[
i
].pBt;

118031 if–
pBt
 ){

118032 
Pagî
 *
pPagî
 = 
	`sqlôe3BåìPagî
(
pBt
);

118033 
	`sqlôe3PagîShrök
(
pPagî
);

118036 
	`sqlôe3BåìLóveAŒ
(
db
);

118037 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

118038  
SQLITE_OK
;

118044 
SQLITE_API
 
	`sqlôe3_db_c⁄fig
(
sqlôe3
 *
db
, 
›
, ...){

118045 
va_li°
 
≠
;

118046 
rc
;

118047 
	`va_°¨t
(
≠
, 
›
);

118048  
›
 ){

118049 
SQLITE_DBCONFIG_LOOKASIDE
: {

118050 *
pBuf
 = 
	`va_¨g
(
≠
, *);

118051 
sz
 = 
	`va_¨g
(
≠
, );

118052 
˙t
 = 
	`va_¨g
(
≠
, );

118053 
rc
 = 
	`£tupLookaside
(
db
, 
pBuf
, 
sz
, 
˙t
);

118058 
›
;

118059 
u32
 
mask
;

118060 } 
aFœgOp
[] = {

118061 { 
SQLITE_DBCONFIG_ENABLE_FKEY
, 
SQLITE_F‹eignKeys
 },

118062 { 
SQLITE_DBCONFIG_ENABLE_TRIGGER
, 
SQLITE_E«bÀTriggî
 },

118064 
i
;

118065 
rc
 = 
SQLITE_ERROR
;

118066 
i
=0; i<
	`AºaySize
(
aFœgOp
); i++){

118067 if–
aFœgOp
[
i
].
›
==op ){

118068 
⁄off
 = 
	`va_¨g
(
≠
, );

118069 *
pRes
 = 
	`va_¨g
(
≠
, *);

118070 
ﬁdFœgs
 = 
db
->
Êags
;

118071 if–
⁄off
>0 ){

118072 
db
->
Êags
 |
aFœgOp
[
i
].
mask
;

118073 }if–
⁄off
==0 ){

118074 
db
->
Êags
 &~
aFœgOp
[
i
].
mask
;

118076 if–
ﬁdFœgs
!=
db
->
Êags
 ){

118077 
	`sqlôe3ExpúePª∑ªdSèãmíts
(
db
);

118079 if–
pRes
 ){

118080 *
pRes
 = (
db
->
Êags
 & 
aFœgOp
[
i
].
mask
)!=0;

118082 
rc
 = 
SQLITE_OK
;

118089 
	`va_íd
(
≠
);

118090  
rc
;

118097 
	`ÆlS∑˚s
(c⁄° *
z
, 
n
){

118098  
n
>0 && 
z
[n-1]==' ' ){Ç--; }

118099  
n
==0;

118109 
	`böCﬁlFunc
(

118110 *
∑dFœg
,

118111 
nKey1
, c⁄° *
pKey1
,

118112 
nKey2
, c⁄° *
pKey2


118114 
rc
, 
n
;

118115 
n
 = 
nKey1
<
nKey2
 ?ÇKey1 :ÇKey2;

118116 
rc
 = 
	`memcmp
(
pKey1
, 
pKey2
, 
n
);

118117 if–
rc
==0 ){

118118 if–
∑dFœg


118119 && 
	`ÆlS∑˚s
(((*)
pKey1
)+
n
, 
nKey1
-n)

118120 && 
	`ÆlS∑˚s
(((*)
pKey2
)+
n
, 
nKey2
-n)

118124 
rc
 = 
nKey1
 - 
nKey2
;

118127  
rc
;

118139 
	`noˇ£CﬁœtögFunc
(

118140 *
NŸU£d
,

118141 
nKey1
, c⁄° *
pKey1
,

118142 
nKey2
, c⁄° *
pKey2


118144 
r
 = 
	`sqlôe3SåNICmp
(

118145 (c⁄° *)
pKey1
, (c⁄° *)
pKey2
, (
nKey1
<
nKey2
)?nKey1:nKey2);

118146 
	`UNUSED_PARAMETER
(
NŸU£d
);

118147 if–0==
r
 ){

118148 
r
 = 
nKey1
-
nKey2
;

118150  
r
;

118156 
SQLITE_API
 
sqlôe_öt64
 
	`sqlôe3_œ°_ö£π_rowid
(
sqlôe3
 *
db
){

118157  
db
->
œ°Rowid
;

118163 
SQLITE_API
 
	`sqlôe3_ch™ges
(
sqlôe3
 *
db
){

118164  
db
->
nCh™ge
;

118170 
SQLITE_API
 
	`sqlôe3_tŸÆ_ch™ges
(
sqlôe3
 *
db
){

118171  
db
->
nTŸÆCh™ge
;

118179 
SQLITE_PRIVATE
 
	`sqlôe3Clo£Savïoöts
(
sqlôe3
 *
db
){

118180  
db
->
pSavïoöt
 ){

118181 
Savïoöt
 *
pTmp
 = 
db
->
pSavïoöt
;

118182 
db
->
pSavïoöt
 = 
pTmp
->
pNext
;

118183 
	`sqlôe3DbFªe
(
db
, 
pTmp
);

118185 
db
->
nSavïoöt
 = 0;

118186 
db
->
nSèãmít
 = 0;

118187 
db
->
isTønß˘i⁄Savïoöt
 = 0;

118196 
	`fun˘i⁄De°roy
(
sqlôe3
 *
db
, 
FuncDef
 *
p
){

118197 
FuncDe°ru˘‹
 *
pDe°ru˘‹
 = 
p
->pDestructor;

118198 if–
pDe°ru˘‹
 ){

118199 
pDe°ru˘‹
->
nRef
--;

118200 if–
pDe°ru˘‹
->
nRef
==0 ){

118201 
pDe°ru˘‹
->
	`xDe°roy
’De°ru˘‹->
pU£rD©a
);

118202 
	`sqlôe3DbFªe
(
db
, 
pDe°ru˘‹
);

118211 
	`disc⁄√˘AŒVèb
(
sqlôe3
 *
db
){

118212 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


118213 
i
;

118214 
	`sqlôe3BåìE¡îAŒ
(
db
);

118215 
i
=0; i<
db
->
nDb
; i++){

118216 
Schema
 *
pSchema
 = 
db
->
aDb
[
i
].pSchema;

118217 if–
db
->
aDb
[
i
].
pSchema
 ){

118218 
HashEÀm
 *
p
;

118219 
p
=
	`sqlôeHashFú°
(&
pSchema
->
tblHash
);Ö;Ö=
	`sqlôeHashNext
(p)){

118220 
TabÀ
 *
pTab
 = (TabÀ *)
	`sqlôeHashD©a
(
p
);

118221 if–
	`IsVútuÆ
(
pTab
ËË
	`sqlôe3VèbDisc⁄√˘
(
db
,ÖTab);

118225 
	`sqlôe3BåìLóveAŒ
(
db
);

118227 
	`UNUSED_PARAMETER
(
db
);

118235 
	`c⁄√˘i⁄IsBusy
(
sqlôe3
 *
db
){

118236 
j
;

118237 
	`as£π
–
	`sqlôe3_muãx_hñd
(
db
->
muãx
) );

118238 if–
db
->
pVdbe
 )  1;

118239 
j
=0; j<
db
->
nDb
; j++){

118240 
Båì
 *
pBt
 = 
db
->
aDb
[
j
].pBt;

118241 if–
pBt
 && 
	`sqlôe3BåìIsInBackup
(pBt) )  1;

118249 
	`sqlôe3Clo£
(
sqlôe3
 *
db
, 
f‹˚Zombõ
){

118250 if–!
db
 ){

118251  
SQLITE_OK
;

118253 if–!
	`sqlôe3Sa„tyCheckSickOrOk
(
db
) ){

118254  
SQLITE_MISUSE_BKPT
;

118256 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

118259 
	`disc⁄√˘AŒVèb
(
db
);

118268 
	`sqlôe3VèbRﬁlback
(
db
);

118273 if–!
f‹˚Zombõ
 && 
	`c⁄√˘i⁄IsBusy
(
db
) ){

118274 
	`sqlôe3Eº‹
(
db
, 
SQLITE_BUSY
, "unableÅo close dueÅo unfinalized "

118276 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

118277  
SQLITE_BUSY
;

118280 #ifde‡
SQLITE_ENABLE_SQLLOG


118281 if–
sqlôe3GlobÆC⁄fig
.
xSqŒog
 ){

118283 
sqlôe3GlobÆC⁄fig
.
	`xSqŒog
(sqlôe3GlobÆC⁄fig.
pSqŒogArg
, 
db
, 0, 2);

118289 
db
->
magic
 = 
SQLITE_MAGIC_ZOMBIE
;

118290 
	`sqlôe3LóveMuãxAndClo£Zombõ
(
db
);

118291  
SQLITE_OK
;

118303 
SQLITE_API
 
	`sqlôe3_˛o£
(
sqlôe3
 *
db
){  
	`sqlôe3Clo£
(db,0); }

118304 
SQLITE_API
 
	`sqlôe3_˛o£_v2
(
sqlôe3
 *
db
){  
	`sqlôe3Clo£
(db,1); }

118315 
SQLITE_PRIVATE
 
	`sqlôe3LóveMuãxAndClo£Zombõ
(
sqlôe3
 *
db
){

118316 
HashEÀm
 *
i
;

118317 
j
;

118323 if–
db
->
magic
!=
SQLITE_MAGIC_ZOMBIE
 || 
	`c⁄√˘i⁄IsBusy
(db) ){

118324 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

118338 
	`sqlôe3RﬁlbackAŒ
(
db
, 
SQLITE_OK
);

118341 
	`sqlôe3Clo£Savïoöts
(
db
);

118344 
j
=0; j<
db
->
nDb
; j++){

118345 
Db
 *
pDb
 = &
db
->
aDb
[
j
];

118346 if–
pDb
->
pBt
 ){

118347 
	`sqlôe3BåìClo£
(
pDb
->
pBt
);

118348 
pDb
->
pBt
 = 0;

118349 if–
j
!=1 ){

118350 
pDb
->
pSchema
 = 0;

118355 if–
db
->
aDb
[1].
pSchema
 ){

118356 
	`sqlôe3SchemaCÀ¨
(
db
->
aDb
[1].
pSchema
);

118358 
	`sqlôe3VèbU∆ockLi°
(
db
);

118361 
	`sqlôe3Cﬁœp£D©aba£Aºay
(
db
);

118362 
	`as£π
–
db
->
nDb
<=2 );

118363 
	`as£π
–
db
->
aDb
==db->
aDbSètic
 );

118368 
	`sqlôe3C⁄√˘i⁄Clo£d
(
db
);

118370 
j
=0; j<
	`AºaySize
(
db
->
aFunc
.
a
); j++){

118371 
FuncDef
 *
pNext
, *
pHash
, *
p
;

118372 
p
=
db
->
aFunc
.
a
[
j
];Ö;Ö=
pHash
){

118373 
pHash
 = 
p
->pHash;

118374  
p
 ){

118375 
	`fun˘i⁄De°roy
(
db
, 
p
);

118376 
pNext
 = 
p
->pNext;

118377 
	`sqlôe3DbFªe
(
db
, 
p
);

118378 
p
 = 
pNext
;

118382 
i
=
	`sqlôeHashFú°
(&
db
->
aCﬁlSeq
); i; i=
	`sqlôeHashNext
(i)){

118383 
CﬁlSeq
 *
pCﬁl
 = (CﬁlSeq *)
	`sqlôeHashD©a
(
i
);

118385 
j
=0; j<3; j++){

118386 if–
pCﬁl
[
j
].
xDñ
 ){

118387 
pCﬁl
[
j
].
	`xDñ
’Cﬁl[j].
pU£r
);

118390 
	`sqlôe3DbFªe
(
db
, 
pCﬁl
);

118392 
	`sqlôe3HashCÀ¨
(&
db
->
aCﬁlSeq
);

118393 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


118394 
i
=
	`sqlôeHashFú°
(&
db
->
aModuÀ
); i; i=
	`sqlôeHashNext
(i)){

118395 
ModuÀ
 *
pMod
 = (ModuÀ *)
	`sqlôeHashD©a
(
i
);

118396 if–
pMod
->
xDe°roy
 ){

118397 
pMod
->
	`xDe°roy
’Mod->
pAux
);

118399 
	`sqlôe3DbFªe
(
db
, 
pMod
);

118401 
	`sqlôe3HashCÀ¨
(&
db
->
aModuÀ
);

118404 
	`sqlôe3Eº‹
(
db
, 
SQLITE_OK
, 0);

118405 if–
db
->
pEº
 ){

118406 
	`sqlôe3VÆueFªe
(
db
->
pEº
);

118408 
	`sqlôe3Clo£Exãnsi⁄s
(
db
);

118410 
db
->
magic
 = 
SQLITE_MAGIC_ERROR
;

118418 
	`sqlôe3DbFªe
(
db
, db->
aDb
[1].
pSchema
);

118419 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

118420 
db
->
magic
 = 
SQLITE_MAGIC_CLOSED
;

118421 
	`sqlôe3_muãx_‰ì
(
db
->
muãx
);

118422 
	`as£π
–
db
->
lookaside
.
nOut
==0 );

118423 if–
db
->
lookaside
.
bMÆlo˚d
 ){

118424 
	`sqlôe3_‰ì
(
db
->
lookaside
.
pSèπ
);

118426 
	`sqlôe3_‰ì
(
db
);

118435 
SQLITE_PRIVATE
 
	`sqlôe3RﬁlbackAŒ
(
sqlôe3
 *
db
, 
åùCode
){

118436 
i
;

118437 
öTøns
 = 0;

118438 
	`as£π
–
	`sqlôe3_muãx_hñd
(
db
->
muãx
) );

118439 
	`sqlôe3BegöBíignMÆloc
();

118447 
	`sqlôe3BåìE¡îAŒ
(
db
);

118449 
i
=0; i<
db
->
nDb
; i++){

118450 
Båì
 *
p
 = 
db
->
aDb
[
i
].
pBt
;

118451 if–
p
 ){

118452 if–
	`sqlôe3BåìIsInTøns
(
p
) ){

118453 
öTøns
 = 1;

118455 
	`sqlôe3BåìRﬁlback
(
p
, 
åùCode
);

118458 
	`sqlôe3VèbRﬁlback
(
db
);

118459 
	`sqlôe3EndBíignMÆloc
();

118461 if–(
db
->
Êags
&
SQLITE_I¡înCh™ges
)!=0 && db->
öô
.
busy
==0 ){

118462 
	`sqlôe3ExpúePª∑ªdSèãmíts
(
db
);

118463 
	`sqlôe3Re£tAŒSchemasOfC⁄√˘i⁄
(
db
);

118465 
	`sqlôe3BåìLóveAŒ
(
db
);

118468 
db
->
nDe„ºedC⁄s
 = 0;

118469 
db
->
nDe„ºedImmC⁄s
 = 0;

118470 
db
->
Êags
 &~
SQLITE_De„rFKs
;

118473 if–
db
->
xRﬁlbackCÆlback
 && (
öTøns
 || !db->
autoCommô
) ){

118474 
db
->
	`xRﬁlbackCÆlback
(db->
pRﬁlbackArg
);

118482 #i‡
	`deföed
(
SQLITE_DEBUG
Ë|| deföed(
SQLITE_TEST
) || \

118483 
	`deföed
(
SQLITE_DEBUG_OS_TRACE
)

118484 
SQLITE_PRIVATE
 c⁄° *
	`sqlôe3EºName
(
rc
){

118485 c⁄° *
zName
 = 0;

118486 
i
, 
‹igRc
 = 
rc
;

118487 
i
=0; i<2 && 
zName
==0; i++, 
rc
 &= 0xff){

118488  
rc
 ){

118489 
SQLITE_OK
: 
zName
 = "SQLITE_OK"; ;

118490 
SQLITE_ERROR
: 
zName
 = "SQLITE_ERROR"; ;

118491 
SQLITE_INTERNAL
: 
zName
 = "SQLITE_INTERNAL"; ;

118492 
SQLITE_PERM
: 
zName
 = "SQLITE_PERM"; ;

118493 
SQLITE_ABORT
: 
zName
 = "SQLITE_ABORT"; ;

118494 
SQLITE_ABORT_ROLLBACK
: 
zName
 = "SQLITE_ABORT_ROLLBACK"; ;

118495 
SQLITE_BUSY
: 
zName
 = "SQLITE_BUSY"; ;

118496 
SQLITE_BUSY_RECOVERY
: 
zName
 = "SQLITE_BUSY_RECOVERY"; ;

118497 
SQLITE_BUSY_SNAPSHOT
: 
zName
 = "SQLITE_BUSY_SNAPSHOT"; ;

118498 
SQLITE_LOCKED
: 
zName
 = "SQLITE_LOCKED"; ;

118499 
SQLITE_LOCKED_SHAREDCACHE
: 
zName
 = "SQLITE_LOCKED_SHAREDCACHE";;

118500 
SQLITE_NOMEM
: 
zName
 = "SQLITE_NOMEM"; ;

118501 
SQLITE_READONLY
: 
zName
 = "SQLITE_READONLY"; ;

118502 
SQLITE_READONLY_RECOVERY
: 
zName
 = "SQLITE_READONLY_RECOVERY"; ;

118503 
SQLITE_READONLY_CANTLOCK
: 
zName
 = "SQLITE_READONLY_CANTLOCK"; ;

118504 
SQLITE_READONLY_ROLLBACK
: 
zName
 = "SQLITE_READONLY_ROLLBACK"; ;

118505 
SQLITE_INTERRUPT
: 
zName
 = "SQLITE_INTERRUPT"; ;

118506 
SQLITE_IOERR
: 
zName
 = "SQLITE_IOERR"; ;

118507 
SQLITE_IOERR_READ
: 
zName
 = "SQLITE_IOERR_READ"; ;

118508 
SQLITE_IOERR_SHORT_READ
: 
zName
 = "SQLITE_IOERR_SHORT_READ"; ;

118509 
SQLITE_IOERR_WRITE
: 
zName
 = "SQLITE_IOERR_WRITE"; ;

118510 
SQLITE_IOERR_FSYNC
: 
zName
 = "SQLITE_IOERR_FSYNC"; ;

118511 
SQLITE_IOERR_DIR_FSYNC
: 
zName
 = "SQLITE_IOERR_DIR_FSYNC"; ;

118512 
SQLITE_IOERR_TRUNCATE
: 
zName
 = "SQLITE_IOERR_TRUNCATE"; ;

118513 
SQLITE_IOERR_FSTAT
: 
zName
 = "SQLITE_IOERR_FSTAT"; ;

118514 
SQLITE_IOERR_UNLOCK
: 
zName
 = "SQLITE_IOERR_UNLOCK"; ;

118515 
SQLITE_IOERR_RDLOCK
: 
zName
 = "SQLITE_IOERR_RDLOCK"; ;

118516 
SQLITE_IOERR_DELETE
: 
zName
 = "SQLITE_IOERR_DELETE"; ;

118517 
SQLITE_IOERR_BLOCKED
: 
zName
 = "SQLITE_IOERR_BLOCKED"; ;

118518 
SQLITE_IOERR_NOMEM
: 
zName
 = "SQLITE_IOERR_NOMEM"; ;

118519 
SQLITE_IOERR_ACCESS
: 
zName
 = "SQLITE_IOERR_ACCESS"; ;

118520 
SQLITE_IOERR_CHECKRESERVEDLOCK
:

118521 
zName
 = "SQLITE_IOERR_CHECKRESERVEDLOCK"; ;

118522 
SQLITE_IOERR_LOCK
: 
zName
 = "SQLITE_IOERR_LOCK"; ;

118523 
SQLITE_IOERR_CLOSE
: 
zName
 = "SQLITE_IOERR_CLOSE"; ;

118524 
SQLITE_IOERR_DIR_CLOSE
: 
zName
 = "SQLITE_IOERR_DIR_CLOSE"; ;

118525 
SQLITE_IOERR_SHMOPEN
: 
zName
 = "SQLITE_IOERR_SHMOPEN"; ;

118526 
SQLITE_IOERR_SHMSIZE
: 
zName
 = "SQLITE_IOERR_SHMSIZE"; ;

118527 
SQLITE_IOERR_SHMLOCK
: 
zName
 = "SQLITE_IOERR_SHMLOCK"; ;

118528 
SQLITE_IOERR_SHMMAP
: 
zName
 = "SQLITE_IOERR_SHMMAP"; ;

118529 
SQLITE_IOERR_SEEK
: 
zName
 = "SQLITE_IOERR_SEEK"; ;

118530 
SQLITE_IOERR_DELETE_NOENT
: 
zName
 = "SQLITE_IOERR_DELETE_NOENT";;

118531 
SQLITE_IOERR_MMAP
: 
zName
 = "SQLITE_IOERR_MMAP"; ;

118532 
SQLITE_IOERR_GETTEMPPATH
: 
zName
 = "SQLITE_IOERR_GETTEMPPATH"; ;

118533 
SQLITE_IOERR_CONVPATH
: 
zName
 = "SQLITE_IOERR_CONVPATH"; ;

118534 
SQLITE_CORRUPT
: 
zName
 = "SQLITE_CORRUPT"; ;

118535 
SQLITE_CORRUPT_VTAB
: 
zName
 = "SQLITE_CORRUPT_VTAB"; ;

118536 
SQLITE_NOTFOUND
: 
zName
 = "SQLITE_NOTFOUND"; ;

118537 
SQLITE_FULL
: 
zName
 = "SQLITE_FULL"; ;

118538 
SQLITE_CANTOPEN
: 
zName
 = "SQLITE_CANTOPEN"; ;

118539 
SQLITE_CANTOPEN_NOTEMPDIR
: 
zName
 = "SQLITE_CANTOPEN_NOTEMPDIR";;

118540 
SQLITE_CANTOPEN_ISDIR
: 
zName
 = "SQLITE_CANTOPEN_ISDIR"; ;

118541 
SQLITE_CANTOPEN_FULLPATH
: 
zName
 = "SQLITE_CANTOPEN_FULLPATH"; ;

118542 
SQLITE_CANTOPEN_CONVPATH
: 
zName
 = "SQLITE_CANTOPEN_CONVPATH"; ;

118543 
SQLITE_PROTOCOL
: 
zName
 = "SQLITE_PROTOCOL"; ;

118544 
SQLITE_EMPTY
: 
zName
 = "SQLITE_EMPTY"; ;

118545 
SQLITE_SCHEMA
: 
zName
 = "SQLITE_SCHEMA"; ;

118546 
SQLITE_TOOBIG
: 
zName
 = "SQLITE_TOOBIG"; ;

118547 
SQLITE_CONSTRAINT
: 
zName
 = "SQLITE_CONSTRAINT"; ;

118548 
SQLITE_CONSTRAINT_UNIQUE
: 
zName
 = "SQLITE_CONSTRAINT_UNIQUE"; ;

118549 
SQLITE_CONSTRAINT_TRIGGER
: 
zName
 = "SQLITE_CONSTRAINT_TRIGGER";;

118550 
SQLITE_CONSTRAINT_FOREIGNKEY
:

118551 
zName
 = "SQLITE_CONSTRAINT_FOREIGNKEY"; ;

118552 
SQLITE_CONSTRAINT_CHECK
: 
zName
 = "SQLITE_CONSTRAINT_CHECK"; ;

118553 
SQLITE_CONSTRAINT_PRIMARYKEY
:

118554 
zName
 = "SQLITE_CONSTRAINT_PRIMARYKEY"; ;

118555 
SQLITE_CONSTRAINT_NOTNULL
: 
zName
 = "SQLITE_CONSTRAINT_NOTNULL";;

118556 
SQLITE_CONSTRAINT_COMMITHOOK
:

118557 
zName
 = "SQLITE_CONSTRAINT_COMMITHOOK"; ;

118558 
SQLITE_CONSTRAINT_VTAB
: 
zName
 = "SQLITE_CONSTRAINT_VTAB"; ;

118559 
SQLITE_CONSTRAINT_FUNCTION
:

118560 
zName
 = "SQLITE_CONSTRAINT_FUNCTION"; ;

118561 
SQLITE_MISMATCH
: 
zName
 = "SQLITE_MISMATCH"; ;

118562 
SQLITE_MISUSE
: 
zName
 = "SQLITE_MISUSE"; ;

118563 
SQLITE_NOLFS
: 
zName
 = "SQLITE_NOLFS"; ;

118564 
SQLITE_AUTH
: 
zName
 = "SQLITE_AUTH"; ;

118565 
SQLITE_FORMAT
: 
zName
 = "SQLITE_FORMAT"; ;

118566 
SQLITE_RANGE
: 
zName
 = "SQLITE_RANGE"; ;

118567 
SQLITE_NOTADB
: 
zName
 = "SQLITE_NOTADB"; ;

118568 
SQLITE_ROW
: 
zName
 = "SQLITE_ROW"; ;

118569 
SQLITE_NOTICE
: 
zName
 = "SQLITE_NOTICE"; ;

118570 
SQLITE_NOTICE_RECOVER_WAL
: 
zName
 = "SQLITE_NOTICE_RECOVER_WAL";;

118571 
SQLITE_NOTICE_RECOVER_ROLLBACK
:

118572 
zName
 = "SQLITE_NOTICE_RECOVER_ROLLBACK"; ;

118573 
SQLITE_WARNING
: 
zName
 = "SQLITE_WARNING"; ;

118574 
SQLITE_WARNING_AUTOINDEX
: 
zName
 = "SQLITE_WARNING_AUTOINDEX"; ;

118575 
SQLITE_DONE
: 
zName
 = "SQLITE_DONE"; ;

118578 if–
zName
==0 ){

118579 
zBuf
[50];

118580 
	`sqlôe3_¢¥ötf
((
zBuf
), zBuf, "SQLITE_UNKNOWN(%d)", 
‹igRc
);

118581 
zName
 = 
zBuf
;

118583  
zName
;

118591 
SQLITE_PRIVATE
 c⁄° *
	`sqlôe3EºSå
(
rc
){

118592 c⁄° * c⁄° 
aMsg
[] = {

118621 c⁄° *
zEº
 = "unknownÉrror";

118622  
rc
 ){

118623 
SQLITE_ABORT_ROLLBACK
: {

118624 
zEº
 = "abort dueÅo ROLLBACK";

118628 
rc
 &= 0xff;

118629 if–
	`ALWAYS
(
rc
>=0Ë&&Ñc<
	`AºaySize
(
aMsg
) &&áMsg[rc]!=0 ){

118630 
zEº
 = 
aMsg
[
rc
];

118635  
zEº
;

118644 
	`sqlôeDeÁu…BusyCÆlback
(

118645 *
±r
,

118646 
cou¡


118648 #i‡
SQLITE_OS_WIN
 || (
	`deföed
(
HAVE_USLEEP
) && HAVE_USLEEP)

118649 c⁄° 
u8
 
dñays
[] =

118651 c⁄° 
u8
 
tŸÆs
[] =

118653 
	#NDELAY
 
	`AºaySize
(
dñays
)

	)

118654 
sqlôe3
 *
db
 = (sqlôe3 *)
±r
;

118655 
timeout
 = 
db
->
busyTimeout
;

118656 
dñay
, 
¥i‹
;

118658 
	`as£π
–
cou¡
>=0 );

118659 if–
cou¡
 < 
NDELAY
 ){

118660 
dñay
 = 
dñays
[
cou¡
];

118661 
¥i‹
 = 
tŸÆs
[
cou¡
];

118663 
dñay
 = 
dñays
[
NDELAY
-1];

118664 
¥i‹
 = 
tŸÆs
[
NDELAY
-1] + 
dñay
*(
cou¡
-(NDELAY-1));

118666 if–
¥i‹
 + 
dñay
 > 
timeout
 ){

118667 
dñay
 = 
timeout
 - 
¥i‹
;

118668 if–
dñay
<=0 )  0;

118670 
	`sqlôe3OsSÀï
(
db
->
pVfs
, 
dñay
*1000);

118673 
sqlôe3
 *
db
 = (sqlôe3 *)
±r
;

118674 
timeout
 = ((
sqlôe3
 *)
±r
)->
busyTimeout
;

118675 if–(
cou¡
+1)*1000 > 
timeout
 ){

118678 
	`sqlôe3OsSÀï
(
db
->
pVfs
, 1000000);

118690 
SQLITE_PRIVATE
 
	`sqlôe3InvokeBusyH™dÀr
(
BusyH™dÀr
 *
p
){

118691 
rc
;

118692 if–
	`NEVER
(
p
==0Ë||Ö->
xFunc
==0 ||Ö->
nBusy
<0 )  0;

118693 
rc
 = 
p
->
	`xFunc
’->
pArg
,Ö->
nBusy
);

118694 if–
rc
==0 ){

118695 
p
->
nBusy
 = -1;

118697 
p
->
nBusy
++;

118699  
rc
;

118706 
SQLITE_API
 
	`sqlôe3_busy_h™dÀr
(

118707 
sqlôe3
 *
db
,

118708 (*
xBusy
)(*,),

118709 *
pArg


118711 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

118712 
db
->
busyH™dÀr
.
xFunc
 = 
xBusy
;

118713 
db
->
busyH™dÀr
.
pArg
 =ÖArg;

118714 
db
->
busyH™dÀr
.
nBusy
 = 0;

118715 
db
->
busyTimeout
 = 0;

118716 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

118717  
SQLITE_OK
;

118720 #i‚de‡
SQLITE_OMIT_PROGRESS_CALLBACK


118726 
SQLITE_API
 
	`sqlôe3_¥ogªss_h™dÀr
(

118727 
sqlôe3
 *
db
,

118728 
nOps
,

118729 (*
xProgªss
)(*),

118730 *
pArg


118732 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

118733 if–
nOps
>0 ){

118734 
db
->
xProgªss
 = xProgress;

118735 
db
->
nProgªssOps
 = ()
nOps
;

118736 
db
->
pProgªssArg
 = 
pArg
;

118738 
db
->
xProgªss
 = 0;

118739 
db
->
nProgªssOps
 = 0;

118740 
db
->
pProgªssArg
 = 0;

118742 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

118751 
SQLITE_API
 
	`sqlôe3_busy_timeout
(
sqlôe3
 *
db
, 
ms
){

118752 if–
ms
>0 ){

118753 
	`sqlôe3_busy_h™dÀr
(
db
, 
sqlôeDeÁu…BusyCÆlback
, (*)db);

118754 
db
->
busyTimeout
 = 
ms
;

118756 
	`sqlôe3_busy_h™dÀr
(
db
, 0, 0);

118758  
SQLITE_OK
;

118764 
SQLITE_API
 
	`sqlôe3_öãºu±
(
sqlôe3
 *
db
){

118765 
db
->
u1
.
isI¡îru±ed
 = 1;

118775 
SQLITE_PRIVATE
 
	`sqlôe3Cª©eFunc
(

118776 
sqlôe3
 *
db
,

118777 c⁄° *
zFun˘i⁄Name
,

118778 
nArg
,

118779 
íc
,

118780 *
pU£rD©a
,

118781 (*
xFunc
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
 **),

118782 (*
xSãp
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
 **),

118783 (*
xFöÆ
)(
sqlôe3_c⁄ãxt
*),

118784 
FuncDe°ru˘‹
 *
pDe°ru˘‹


118786 
FuncDef
 *
p
;

118787 
nName
;

118789 
	`as£π
–
	`sqlôe3_muãx_hñd
(
db
->
muãx
) );

118790 if–
zFun˘i⁄Name
==0 ||

118791 (
xFunc
 && (
xFöÆ
 || 
xSãp
)) ||

118792 (!
xFunc
 && (
xFöÆ
 && !
xSãp
)) ||

118793 (!
xFunc
 && (!
xFöÆ
 && 
xSãp
)) ||

118794 (
nArg
<-1 ||ÇArg>
SQLITE_MAX_FUNCTION_ARG
) ||

118795 (255<(
nName
 = 
	`sqlôe3SåÀn30
–
zFun˘i⁄Name
))) ){

118796  
SQLITE_MISUSE_BKPT
;

118799 #i‚de‡
SQLITE_OMIT_UTF16


118807 if–
íc
==
SQLITE_UTF16
 ){

118808 
íc
 = 
SQLITE_UTF16NATIVE
;

118809 }if–
íc
==
SQLITE_ANY
 ){

118810 
rc
;

118811 
rc
 = 
	`sqlôe3Cª©eFunc
(
db
, 
zFun˘i⁄Name
, 
nArg
, 
SQLITE_UTF8
,

118812 
pU£rD©a
, 
xFunc
, 
xSãp
, 
xFöÆ
, 
pDe°ru˘‹
);

118813 if–
rc
==
SQLITE_OK
 ){

118814 
rc
 = 
	`sqlôe3Cª©eFunc
(
db
, 
zFun˘i⁄Name
, 
nArg
, 
SQLITE_UTF16LE
,

118815 
pU£rD©a
, 
xFunc
, 
xSãp
, 
xFöÆ
, 
pDe°ru˘‹
);

118817 if–
rc
!=
SQLITE_OK
 ){

118818  
rc
;

118820 
íc
 = 
SQLITE_UTF16BE
;

118823 
íc
 = 
SQLITE_UTF8
;

118831 
p
 = 
	`sqlôe3FödFun˘i⁄
(
db
, 
zFun˘i⁄Name
, 
nName
, 
nArg
, (
u8
)
íc
, 0);

118832 if–
p
 && (p->
funcFœgs
 & 
SQLITE_FUNC_ENCMASK
)==
íc
 &&Ö->
nArg
==nArg ){

118833 if–
db
->
nVdbeA˘ive
 ){

118834 
	`sqlôe3Eº‹
(
db
, 
SQLITE_BUSY
,

118836 
	`as£π
–!
db
->
mÆlocFaûed
 );

118837  
SQLITE_BUSY
;

118839 
	`sqlôe3ExpúePª∑ªdSèãmíts
(
db
);

118843 
p
 = 
	`sqlôe3FödFun˘i⁄
(
db
, 
zFun˘i⁄Name
, 
nName
, 
nArg
, (
u8
)
íc
, 1);

118844 
	`as£π
(
p
 || 
db
->
mÆlocFaûed
);

118845 if–!
p
 ){

118846  
SQLITE_NOMEM
;

118851 
	`fun˘i⁄De°roy
(
db
, 
p
);

118853 if–
pDe°ru˘‹
 ){

118854 
pDe°ru˘‹
->
nRef
++;

118856 
p
->
pDe°ru˘‹
 =ÖDestructor;

118857 
p
->
funcFœgs
 &
SQLITE_FUNC_ENCMASK
;

118858 
p
->
xFunc
 = xFunc;

118859 
p
->
xSãp
 = xStep;

118860 
p
->
xFöÆize
 = 
xFöÆ
;

118861 
p
->
pU£rD©a
 =ÖUserData;

118862 
p
->
nArg
 = (
u16
)nArg;

118863  
SQLITE_OK
;

118869 
SQLITE_API
 
	`sqlôe3_¸óã_fun˘i⁄
(

118870 
sqlôe3
 *
db
,

118871 c⁄° *
zFunc
,

118872 
nArg
,

118873 
íc
,

118874 *
p
,

118875 (*
xFunc
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
 **),

118876 (*
xSãp
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
 **),

118877 (*
xFöÆ
)(
sqlôe3_c⁄ãxt
*)

118879  
	`sqlôe3_¸óã_fun˘i⁄_v2
(
db
, 
zFunc
, 
nArg
, 
íc
, 
p
, 
xFunc
, 
xSãp
,

118880 
xFöÆ
, 0);

118883 
SQLITE_API
 
	`sqlôe3_¸óã_fun˘i⁄_v2
(

118884 
sqlôe3
 *
db
,

118885 c⁄° *
zFunc
,

118886 
nArg
,

118887 
íc
,

118888 *
p
,

118889 (*
xFunc
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
 **),

118890 (*
xSãp
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
 **),

118891 (*
xFöÆ
)(
sqlôe3_c⁄ãxt
*),

118892 (*
xDe°roy
)(*)

118894 
rc
 = 
SQLITE_ERROR
;

118895 
FuncDe°ru˘‹
 *
pArg
 = 0;

118896 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

118897 if–
xDe°roy
 ){

118898 
pArg
 = (
FuncDe°ru˘‹
 *)
	`sqlôe3DbMÆlocZîo
(
db
, (FuncDestructor));

118899 if–!
pArg
 ){

118900 
	`xDe°roy
(
p
);

118901 
out
;

118903 
pArg
->
xDe°roy
 = xDestroy;

118904 
pArg
->
pU£rD©a
 = 
p
;

118906 
rc
 = 
	`sqlôe3Cª©eFunc
(
db
, 
zFunc
, 
nArg
, 
íc
, 
p
, 
xFunc
, 
xSãp
, 
xFöÆ
, 
pArg
);

118907 if–
pArg
 &&ÖArg->
nRef
==0 ){

118908 
	`as£π
–
rc
!=
SQLITE_OK
 );

118909 
	`xDe°roy
(
p
);

118910 
	`sqlôe3DbFªe
(
db
, 
pArg
);

118913 
out
:

118914 
rc
 = 
	`sqlôe3ApiExô
(
db
,Ñc);

118915 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

118916  
rc
;

118919 #i‚de‡
SQLITE_OMIT_UTF16


118920 
SQLITE_API
 
	`sqlôe3_¸óã_fun˘i⁄16
(

118921 
sqlôe3
 *
db
,

118922 c⁄° *
zFun˘i⁄Name
,

118923 
nArg
,

118924 
eTextRï
,

118925 *
p
,

118926 (*
xFunc
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
**),

118927 (*
xSãp
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
**),

118928 (*
xFöÆ
)(
sqlôe3_c⁄ãxt
*)

118930 
rc
;

118931 *
zFunc8
;

118932 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

118933 
	`as£π
–!
db
->
mÆlocFaûed
 );

118934 
zFunc8
 = 
	`sqlôe3Utf16to8
(
db
, 
zFun˘i⁄Name
, -1, 
SQLITE_UTF16NATIVE
);

118935 
rc
 = 
	`sqlôe3Cª©eFunc
(
db
, 
zFunc8
, 
nArg
, 
eTextRï
, 
p
, 
xFunc
, 
xSãp
, 
xFöÆ
,0);

118936 
	`sqlôe3DbFªe
(
db
, 
zFunc8
);

118937 
rc
 = 
	`sqlôe3ApiExô
(
db
,Ñc);

118938 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

118939  
rc
;

118956 
SQLITE_API
 
	`sqlôe3_ovîlﬂd_fun˘i⁄
(

118957 
sqlôe3
 *
db
,

118958 c⁄° *
zName
,

118959 
nArg


118961 
nName
 = 
	`sqlôe3SåÀn30
(
zName
);

118962 
rc
 = 
SQLITE_OK
;

118963 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

118964 if–
	`sqlôe3FödFun˘i⁄
(
db
, 
zName
, 
nName
, 
nArg
, 
SQLITE_UTF8
, 0)==0 ){

118965 
rc
 = 
	`sqlôe3Cª©eFunc
(
db
, 
zName
, 
nArg
, 
SQLITE_UTF8
,

118966 0, 
sqlôe3InvÆidFun˘i⁄
, 0, 0, 0);

118968 
rc
 = 
	`sqlôe3ApiExô
(
db
,Ñc);

118969 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

118970  
rc
;

118973 #i‚de‡
SQLITE_OMIT_TRACE


118982 
SQLITE_API
 *
	`sqlôe3_åa˚
(
sqlôe3
 *
db
, (*
xTø˚
)(*,c⁄° *), *
pArg
){

118983 *
pOld
;

118984 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

118985 
pOld
 = 
db
->
pTø˚Arg
;

118986 
db
->
xTø˚
 = xTrace;

118987 
db
->
pTø˚Arg
 = 
pArg
;

118988 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

118989  
pOld
;

118999 
SQLITE_API
 *
	`sqlôe3_¥ofûe
(

119000 
sqlôe3
 *
db
,

119001 (*
xProfûe
)(*,c⁄° *,
sqlôe_uöt64
),

119002 *
pArg


119004 *
pOld
;

119005 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

119006 
pOld
 = 
db
->
pProfûeArg
;

119007 
db
->
xProfûe
 = xProfile;

119008 
db
->
pProfûeArg
 = 
pArg
;

119009 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

119010  
pOld
;

119019 
SQLITE_API
 *
	`sqlôe3_commô_hook
(

119020 
sqlôe3
 *
db
,

119021 (*
xCÆlback
)(*),

119022 *
pArg


119024 *
pOld
;

119025 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

119026 
pOld
 = 
db
->
pCommôArg
;

119027 
db
->
xCommôCÆlback
 = 
xCÆlback
;

119028 
db
->
pCommôArg
 = 
pArg
;

119029 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

119030  
pOld
;

119037 
SQLITE_API
 *
	`sqlôe3_upd©e_hook
(

119038 
sqlôe3
 *
db
,

119039 (*
xCÆlback
)(*,,c⁄° *,c⁄° *,
sqlôe_öt64
),

119040 *
pArg


119042 *
pRë
;

119043 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

119044 
pRë
 = 
db
->
pUpd©eArg
;

119045 
db
->
xUpd©eCÆlback
 = 
xCÆlback
;

119046 
db
->
pUpd©eArg
 = 
pArg
;

119047 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

119048  
pRë
;

119055 
SQLITE_API
 *
	`sqlôe3_rﬁlback_hook
(

119056 
sqlôe3
 *
db
,

119057 (*
xCÆlback
)(*),

119058 *
pArg


119060 *
pRë
;

119061 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

119062 
pRë
 = 
db
->
pRﬁlbackArg
;

119063 
db
->
xRﬁlbackCÆlback
 = 
xCÆlback
;

119064 
db
->
pRﬁlbackArg
 = 
pArg
;

119065 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

119066  
pRë
;

119069 #i‚de‡
SQLITE_OMIT_WAL


119076 
SQLITE_PRIVATE
 
	`sqlôe3WÆDeÁu…Hook
(

119077 *
pClõ¡D©a
,

119078 
sqlôe3
 *
db
,

119079 c⁄° *
zDb
,

119080 
nFøme


119082 if–
nFøme
>=
	`SQLITE_PTR_TO_INT
(
pClõ¡D©a
) ){

119083 
	`sqlôe3BegöBíignMÆloc
();

119084 
	`sqlôe3_wÆ_checkpoöt
(
db
, 
zDb
);

119085 
	`sqlôe3EndBíignMÆloc
();

119087  
SQLITE_OK
;

119102 
SQLITE_API
 
	`sqlôe3_wÆ_autocheckpoöt
(
sqlôe3
 *
db
, 
nFøme
){

119103 #ifde‡
SQLITE_OMIT_WAL


119104 
	`UNUSED_PARAMETER
(
db
);

119105 
	`UNUSED_PARAMETER
(
nFøme
);

119107 if–
nFøme
>0 ){

119108 
	`sqlôe3_wÆ_hook
(
db
, 
sqlôe3WÆDeÁu…Hook
, 
	`SQLITE_INT_TO_PTR
(
nFøme
));

119110 
	`sqlôe3_wÆ_hook
(
db
, 0, 0);

119113  
SQLITE_OK
;

119120 
SQLITE_API
 *
	`sqlôe3_wÆ_hook
(

119121 
sqlôe3
 *
db
,

119122 (*
xCÆlback
)(*, 
sqlôe3
*, const *, ),

119123 *
pArg


119125 #i‚de‡
SQLITE_OMIT_WAL


119126 *
pRë
;

119127 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

119128 
pRë
 = 
db
->
pWÆArg
;

119129 
db
->
xWÆCÆlback
 = 
xCÆlback
;

119130 
db
->
pWÆArg
 = 
pArg
;

119131 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

119132  
pRë
;

119141 
SQLITE_API
 
	`sqlôe3_wÆ_checkpoöt_v2
(

119142 
sqlôe3
 *
db
,

119143 c⁄° *
zDb
,

119144 
eMode
,

119145 *
≤Log
,

119146 *
≤Ck±


119148 #ifde‡
SQLITE_OMIT_WAL


119149  
SQLITE_OK
;

119151 
rc
;

119152 
iDb
 = 
SQLITE_MAX_ATTACHED
;

119155 if–
≤Log
 ) *pnLog = -1;

119156 if–
≤Ck±
 ) *pnCkpt = -1;

119158 
	`as£π
–
SQLITE_CHECKPOINT_FULL
>
SQLITE_CHECKPOINT_PASSIVE
 );

119159 
	`as£π
–
SQLITE_CHECKPOINT_FULL
<
SQLITE_CHECKPOINT_RESTART
 );

119160 
	`as£π
–
SQLITE_CHECKPOINT_PASSIVE
+2==
SQLITE_CHECKPOINT_RESTART
 );

119161 if–
eMode
<
SQLITE_CHECKPOINT_PASSIVE
 ||ÉMode>
SQLITE_CHECKPOINT_RESTART
 ){

119162  
SQLITE_MISUSE
;

119165 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

119166 if–
zDb
 && zDb[0] ){

119167 
iDb
 = 
	`sqlôe3FödDbName
(
db
, 
zDb
);

119169 if–
iDb
<0 ){

119170 
rc
 = 
SQLITE_ERROR
;

119171 
	`sqlôe3Eº‹
(
db
, 
SQLITE_ERROR
, "unknow¿d©aba£: %s", 
zDb
);

119173 
rc
 = 
	`sqlôe3Checkpoöt
(
db
, 
iDb
, 
eMode
, 
≤Log
, 
≤Ck±
);

119174 
	`sqlôe3Eº‹
(
db
, 
rc
, 0);

119176 
rc
 = 
	`sqlôe3ApiExô
(
db
,Ñc);

119177 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

119178  
rc
;

119188 
SQLITE_API
 
	`sqlôe3_wÆ_checkpoöt
(
sqlôe3
 *
db
, c⁄° *
zDb
){

119189  
	`sqlôe3_wÆ_checkpoöt_v2
(
db
, 
zDb
, 
SQLITE_CHECKPOINT_PASSIVE
, 0, 0);

119192 #i‚de‡
SQLITE_OMIT_WAL


119212 
SQLITE_PRIVATE
 
	`sqlôe3Checkpoöt
(
sqlôe3
 *
db
, 
iDb
, 
eMode
, *
≤Log
, *
≤Ck±
){

119213 
rc
 = 
SQLITE_OK
;

119214 
i
;

119215 
bBusy
 = 0;

119217 
	`as£π
–
	`sqlôe3_muãx_hñd
(
db
->
muãx
) );

119218 
	`as£π
–!
≤Log
 || *pnLog==-1 );

119219 
	`as£π
–!
≤Ck±
 || *pnCkpt==-1 );

119221 
i
=0; i<
db
->
nDb
 && 
rc
==
SQLITE_OK
; i++){

119222 if–
i
==
iDb
 || iDb==
SQLITE_MAX_ATTACHED
 ){

119223 
rc
 = 
	`sqlôe3BåìCheckpoöt
(
db
->
aDb
[
i
].
pBt
, 
eMode
, 
≤Log
, 
≤Ck±
);

119224 
≤Log
 = 0;

119225 
≤Ck±
 = 0;

119226 if–
rc
==
SQLITE_BUSY
 ){

119227 
bBusy
 = 1;

119228 
rc
 = 
SQLITE_OK
;

119233  (
rc
==
SQLITE_OK
 && 
bBusy
Ë? 
SQLITE_BUSY
 :Ñc;

119256 
SQLITE_PRIVATE
 
	`sqlôe3TempInMem‹y
(c⁄° 
sqlôe3
 *
db
){

119257 #i‡
SQLITE_TEMP_STORE
==1

119258  ( 
db
->
ãmp_°‹e
==2 );

119260 #i‡
SQLITE_TEMP_STORE
==2

119261  ( 
db
->
ãmp_°‹e
!=1 );

119263 #i‡
SQLITE_TEMP_STORE
==3

119266 #i‡
SQLITE_TEMP_STORE
<1 || SQLITE_TEMP_STORE>3

119275 
SQLITE_API
 c⁄° *
	`sqlôe3_îrmsg
(
sqlôe3
 *
db
){

119276 c⁄° *
z
;

119277 if–!
db
 ){

119278  
	`sqlôe3EºSå
(
SQLITE_NOMEM
);

119280 if–!
	`sqlôe3Sa„tyCheckSickOrOk
(
db
) ){

119281  
	`sqlôe3EºSå
(
SQLITE_MISUSE_BKPT
);

119283 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

119284 if–
db
->
mÆlocFaûed
 ){

119285 
z
 = 
	`sqlôe3EºSå
(
SQLITE_NOMEM
);

119287 
z
 = (*)
	`sqlôe3_vÆue_ãxt
(
db
->
pEº
);

119288 
	`as£π
–!
db
->
mÆlocFaûed
 );

119289 if–
z
==0 ){

119290 
z
 = 
	`sqlôe3EºSå
(
db
->
îrCode
);

119293 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

119294  
z
;

119297 #i‚de‡
SQLITE_OMIT_UTF16


119302 
SQLITE_API
 c⁄° *
	`sqlôe3_îrmsg16
(
sqlôe3
 *
db
){

119303 c⁄° 
u16
 
outOfMem
[] = {

119306 c⁄° 
u16
 
misu£
[] = {

119315 c⁄° *
z
;

119316 if–!
db
 ){

119317  (*)
outOfMem
;

119319 if–!
	`sqlôe3Sa„tyCheckSickOrOk
(
db
) ){

119320  (*)
misu£
;

119322 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

119323 if–
db
->
mÆlocFaûed
 ){

119324 
z
 = (*)
outOfMem
;

119326 
z
 = 
	`sqlôe3_vÆue_ãxt16
(
db
->
pEº
);

119327 if–
z
==0 ){

119328 
	`sqlôe3VÆueSëSå
(
db
->
pEº
, -1, 
	`sqlôe3EºSå
(db->
îrCode
),

119329 
SQLITE_UTF8
, 
SQLITE_STATIC
);

119330 
z
 = 
	`sqlôe3_vÆue_ãxt16
(
db
->
pEº
);

119337 
db
->
mÆlocFaûed
 = 0;

119339 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

119340  
z
;

119348 
SQLITE_API
 
	`sqlôe3_îrcode
(
sqlôe3
 *
db
){

119349 if–
db
 && !
	`sqlôe3Sa„tyCheckSickOrOk
(db) ){

119350  
SQLITE_MISUSE_BKPT
;

119352 if–!
db
 || db->
mÆlocFaûed
 ){

119353  
SQLITE_NOMEM
;

119355  
db
->
îrCode
 & db->
îrMask
;

119357 
SQLITE_API
 
	`sqlôe3_exãnded_îrcode
(
sqlôe3
 *
db
){

119358 if–
db
 && !
	`sqlôe3Sa„tyCheckSickOrOk
(db) ){

119359  
SQLITE_MISUSE_BKPT
;

119361 if–!
db
 || db->
mÆlocFaûed
 ){

119362  
SQLITE_NOMEM
;

119364  
db
->
îrCode
;

119372 
SQLITE_API
 c⁄° *
	`sqlôe3_îr°r
(
rc
){

119373  
	`sqlôe3EºSå
(
rc
);

119380 
	`¸óãCﬁœti⁄
(

119381 
sqlôe3
* 
db
,

119382 c⁄° *
zName
,

119383 
u8
 
íc
,

119384 * 
pCtx
,

119385 (*
xCom∑ª
)(*,,const *,,const *),

119386 (*
xDñ
)(*)

119388 
CﬁlSeq
 *
pCﬁl
;

119389 
íc2
;

119390 
nName
 = 
	`sqlôe3SåÀn30
(
zName
);

119392 
	`as£π
–
	`sqlôe3_muãx_hñd
(
db
->
muãx
) );

119398 
íc2
 = 
íc
;

119399 
	`ã°ˇ£
–
íc2
==
SQLITE_UTF16
 );

119400 
	`ã°ˇ£
–
íc2
==
SQLITE_UTF16_ALIGNED
 );

119401 if–
íc2
==
SQLITE_UTF16
 ||Énc2==
SQLITE_UTF16_ALIGNED
 ){

119402 
íc2
 = 
SQLITE_UTF16NATIVE
;

119404 if–
íc2
<
SQLITE_UTF8
 ||Énc2>
SQLITE_UTF16BE
 ){

119405  
SQLITE_MISUSE_BKPT
;

119412 
pCﬁl
 = 
	`sqlôe3FödCﬁlSeq
(
db
, (
u8
)
íc2
, 
zName
, 0);

119413 if–
pCﬁl
 &&ÖCﬁl->
xCmp
 ){

119414 if–
db
->
nVdbeA˘ive
 ){

119415 
	`sqlôe3Eº‹
(
db
, 
SQLITE_BUSY
,

119417  
SQLITE_BUSY
;

119419 
	`sqlôe3ExpúePª∑ªdSèãmíts
(
db
);

119427 if–(
pCﬁl
->
íc
 & ~
SQLITE_UTF16_ALIGNED
)==
íc2
 ){

119428 
CﬁlSeq
 *
aCﬁl
 = 
	`sqlôe3HashFöd
(&
db
->
aCﬁlSeq
, 
zName
, 
nName
);

119429 
j
;

119430 
j
=0; j<3; j++){

119431 
CﬁlSeq
 *
p
 = &
aCﬁl
[
j
];

119432 if–
p
->
íc
==
pCﬁl
->enc ){

119433 if–
p
->
xDñ
 ){

119434 
p
->
	`xDñ
’->
pU£r
);

119436 
p
->
xCmp
 = 0;

119442 
pCﬁl
 = 
	`sqlôe3FödCﬁlSeq
(
db
, (
u8
)
íc2
, 
zName
, 1);

119443 if–
pCﬁl
==0 )  
SQLITE_NOMEM
;

119444 
pCﬁl
->
xCmp
 = 
xCom∑ª
;

119445 
pCﬁl
->
pU£r
 = 
pCtx
;

119446 
pCﬁl
->
xDñ
 = xDel;

119447 
pCﬁl
->
íc
 = (
u8
)(
íc2
 | (í¯& 
SQLITE_UTF16_ALIGNED
));

119448 
	`sqlôe3Eº‹
(
db
, 
SQLITE_OK
, 0);

119449  
SQLITE_OK
;

119458 c⁄° 
aH¨dLimô
[] = {

119459 
SQLITE_MAX_LENGTH
,

119460 
SQLITE_MAX_SQL_LENGTH
,

119461 
SQLITE_MAX_COLUMN
,

119462 
SQLITE_MAX_EXPR_DEPTH
,

119463 
SQLITE_MAX_COMPOUND_SELECT
,

119464 
SQLITE_MAX_VDBE_OP
,

119465 
SQLITE_MAX_FUNCTION_ARG
,

119466 
SQLITE_MAX_ATTACHED
,

119467 
SQLITE_MAX_LIKE_PATTERN_LENGTH
,

119468 
SQLITE_MAX_VARIABLE_NUMBER
,

119469 
SQLITE_MAX_TRIGGER_DEPTH
,

119475 #i‡
SQLITE_MAX_LENGTH
<100

119476 #îr‹ 
SQLITE_MAX_LENGTH
 
mu°
 
be
 
©
 
Àa°
 100

119478 #i‡
SQLITE_MAX_SQL_LENGTH
<100

119479 #îr‹ 
SQLITE_MAX_SQL_LENGTH
 
mu°
 
be
 
©
 
Àa°
 100

119481 #i‡
SQLITE_MAX_SQL_LENGTH
>
SQLITE_MAX_LENGTH


119482 #îr‹ 
SQLITE_MAX_SQL_LENGTH
 
mu°
 
nŸ
 
be
 
gª©î
 
th™
 
SQLITE_MAX_LENGTH


119484 #i‡
SQLITE_MAX_COMPOUND_SELECT
<2

119485 #îr‹ 
SQLITE_MAX_COMPOUND_SELECT
 
mu°
 
be
 
©
 
Àa°
 2

119487 #i‡
SQLITE_MAX_VDBE_OP
<40

119488 #îr‹ 
SQLITE_MAX_VDBE_OP
 
mu°
 
be
 
©
 
Àa°
 40

119490 #i‡
SQLITE_MAX_FUNCTION_ARG
<0 || SQLITE_MAX_FUNCTION_ARG>1000

119491 #îr‹ 
SQLITE_MAX_FUNCTION_ARG
 
mu°
 
be
 
bëwìn
 0 
™d
 1000

119493 #i‡
SQLITE_MAX_ATTACHED
<0 || SQLITE_MAX_ATTACHED>62

119494 #îr‹ 
SQLITE_MAX_ATTACHED
 
mu°
 
be
 
bëwìn
 0 
™d
 62

119496 #i‡
SQLITE_MAX_LIKE_PATTERN_LENGTH
<1

119497 #îr‹ 
SQLITE_MAX_LIKE_PATTERN_LENGTH
 
mu°
 
be
 
©
 
Àa°
 1

119499 #i‡
SQLITE_MAX_COLUMN
>32767

119500 #îr‹ 
SQLITE_MAX_COLUMN
 
mu°
 
nŸ
 
ex˚ed
 32767

119502 #i‡
SQLITE_MAX_TRIGGER_DEPTH
<1

119503 #îr‹ 
SQLITE_MAX_TRIGGER_DEPTH
 
mu°
 
be
 
©
 
Àa°
 1

119517 
SQLITE_API
 
	`sqlôe3_limô
(
sqlôe3
 *
db
, 
limôId
, 
√wLimô
){

119518 
ﬁdLimô
;

119526 
	`as£π
–
aH¨dLimô
[
SQLITE_LIMIT_LENGTH
]==
SQLITE_MAX_LENGTH
 );

119527 
	`as£π
–
aH¨dLimô
[
SQLITE_LIMIT_SQL_LENGTH
]==
SQLITE_MAX_SQL_LENGTH
 );

119528 
	`as£π
–
aH¨dLimô
[
SQLITE_LIMIT_COLUMN
]==
SQLITE_MAX_COLUMN
 );

119529 
	`as£π
–
aH¨dLimô
[
SQLITE_LIMIT_EXPR_DEPTH
]==
SQLITE_MAX_EXPR_DEPTH
 );

119530 
	`as£π
–
aH¨dLimô
[
SQLITE_LIMIT_COMPOUND_SELECT
]==
SQLITE_MAX_COMPOUND_SELECT
);

119531 
	`as£π
–
aH¨dLimô
[
SQLITE_LIMIT_VDBE_OP
]==
SQLITE_MAX_VDBE_OP
 );

119532 
	`as£π
–
aH¨dLimô
[
SQLITE_LIMIT_FUNCTION_ARG
]==
SQLITE_MAX_FUNCTION_ARG
 );

119533 
	`as£π
–
aH¨dLimô
[
SQLITE_LIMIT_ATTACHED
]==
SQLITE_MAX_ATTACHED
 );

119534 
	`as£π
–
aH¨dLimô
[
SQLITE_LIMIT_LIKE_PATTERN_LENGTH
]==

119535 
SQLITE_MAX_LIKE_PATTERN_LENGTH
 );

119536 
	`as£π
–
aH¨dLimô
[
SQLITE_LIMIT_VARIABLE_NUMBER
]==
SQLITE_MAX_VARIABLE_NUMBER
);

119537 
	`as£π
–
aH¨dLimô
[
SQLITE_LIMIT_TRIGGER_DEPTH
]==
SQLITE_MAX_TRIGGER_DEPTH
 );

119538 
	`as£π
–
SQLITE_LIMIT_TRIGGER_DEPTH
==(
SQLITE_N_LIMIT
-1) );

119541 if–
limôId
<0 ||ÜimôId>=
SQLITE_N_LIMIT
 ){

119544 
ﬁdLimô
 = 
db
->
aLimô
[
limôId
];

119545 if–
√wLimô
>=0 ){

119546 if–
√wLimô
>
aH¨dLimô
[
limôId
] ){

119547 
√wLimô
 = 
aH¨dLimô
[
limôId
];

119549 
db
->
aLimô
[
limôId
] = 
√wLimô
;

119551  
ﬁdLimô
;

119578 
SQLITE_PRIVATE
 
	`sqlôe3P¨£Uri
(

119579 c⁄° *
zDeÁu…Vfs
,

119580 c⁄° *
zUri
,

119581 *
pFœgs
,

119582 
sqlôe3_vfs
 **
µVfs
,

119583 **
pzFûe
,

119584 **
pzEºMsg


119586 
rc
 = 
SQLITE_OK
;

119587 
Êags
 = *
pFœgs
;

119588 c⁄° *
zVfs
 = 
zDeÁu…Vfs
;

119589 *
zFûe
;

119590 
c
;

119591 
nUri
 = 
	`sqlôe3SåÀn30
(
zUri
);

119593 
	`as£π
–*
pzEºMsg
==0 );

119595 if–((
Êags
 & 
SQLITE_OPEN_URI
Ë|| 
sqlôe3GlobÆC⁄fig
.
bO≥nUri
)

119596 && 
nUri
>=5 && 
	`memcmp
(
zUri
, "file:", 5)==0

119598 *
zO±
;

119599 
eSèã
;

119600 
iIn
;

119601 
iOut
 = 0;

119602 
nByã
 = 
nUri
+2;

119606 
Êags
 |
SQLITE_OPEN_URI
;

119608 
iIn
=0; iIn<
nUri
; iIn++Ë
nByã
 +(
zUri
[iIn]=='&');

119609 
zFûe
 = 
	`sqlôe3_mÆloc
(
nByã
);

119610 if–!
zFûe
 )  
SQLITE_NOMEM
;

119612 
iIn
 = 5;

119613 #i‚de‡
SQLITE_ALLOW_URI_AUTHORITY


119615 if–
zUri
[5]=='/' && zUri[6]=='/' ){

119616 
iIn
 = 7;

119617  
zUri
[
iIn
] && zUri[iIn]!='/' ) iIn++;

119618 if–
iIn
!=7 && (iIn!=16 || 
	`memcmp
("loˇlho°", &
zUri
[7], 9)) ){

119619 *
pzEºMsg
 = 
	`sqlôe3_m¥ötf
("invalid uriáuthority: %.*s",

119620 
iIn
-7, &
zUri
[7]);

119621 
rc
 = 
SQLITE_ERROR
;

119622 
∑r£_uri_out
;

119637 
eSèã
 = 0;

119638  (
c
 = 
zUri
[
iIn
])!=0 && c!='#' ){

119639 
iIn
++;

119640 if–
c
=='%'

119641 && 
	`sqlôe3Isxdigô
(
zUri
[
iIn
])

119642 && 
	`sqlôe3Isxdigô
(
zUri
[
iIn
+1])

119644 
o˘ë
 = (
	`sqlôe3HexToI¡
(
zUri
[
iIn
++]) << 4);

119645 
o˘ë
 +
	`sqlôe3HexToI¡
(
zUri
[
iIn
++]);

119647 
	`as£π
–
o˘ë
>=0 && octet<256 );

119648 if–
o˘ë
==0 ){

119653  (
c
 = 
zUri
[
iIn
])!=0 && c!='#'

119654 && (
eSèã
!=0 || 
c
!='?')

119655 && (
eSèã
!=1 || (
c
!='=' && c!='&'))

119656 && (
eSèã
!=2 || 
c
!='&')

119658 
iIn
++;

119662 
c
 = 
o˘ë
;

119663 }if–
eSèã
==1 && (
c
=='&' || c=='=') ){

119664 if–
zFûe
[
iOut
-1]==0 ){

119666  
zUri
[
iIn
] && zUri[iIn]!='#' && zUri[iIn-1]!='&' ) iIn++;

119669 if–
c
=='&' ){

119670 
zFûe
[
iOut
++] = '\0';

119672 
eSèã
 = 2;

119674 
c
 = 0;

119675 }if–(
eSèã
==0 && 
c
=='?') || (eState==2 && c=='&') ){

119676 
c
 = 0;

119677 
eSèã
 = 1;

119679 
zFûe
[
iOut
++] = 
c
;

119681 if–
eSèã
==1 ) 
zFûe
[
iOut
++] = '\0';

119682 
zFûe
[
iOut
++] = '\0';

119683 
zFûe
[
iOut
++] = '\0';

119689 
zO±
 = &
zFûe
[
	`sqlôe3SåÀn30
(zFile)+1];

119690  
zO±
[0] ){

119691 
nO±
 = 
	`sqlôe3SåÀn30
(
zO±
);

119692 *
zVÆ
 = &
zO±
[
nO±
+1];

119693 
nVÆ
 = 
	`sqlôe3SåÀn30
(
zVÆ
);

119695 if–
nO±
==3 && 
	`memcmp
("vfs", 
zO±
, 3)==0 ){

119696 
zVfs
 = 
zVÆ
;

119698 
	sO≥nMode
 {

119699 c⁄° *
z
;

119700 
mode
;

119701 } *
aMode
 = 0;

119702 *
zModeTy≥
 = 0;

119703 
mask
 = 0;

119704 
limô
 = 0;

119706 if–
nO±
==5 && 
	`memcmp
("ˇche", 
zO±
, 5)==0 ){

119707 
O≥nMode
 
aCacheMode
[] = {

119708 { "sh¨ed", 
SQLITE_OPEN_SHAREDCACHE
 },

119709 { "¥iv©e", 
SQLITE_OPEN_PRIVATECACHE
 },

119713 
mask
 = 
SQLITE_OPEN_SHAREDCACHE
|
SQLITE_OPEN_PRIVATECACHE
;

119714 
aMode
 = 
aCacheMode
;

119715 
limô
 = 
mask
;

119716 
zModeTy≥
 = "cache";

119718 if–
nO±
==4 && 
	`memcmp
("mode", 
zO±
, 4)==0 ){

119719 
O≥nMode
 
aO≥nMode
[] = {

119720 { "ro", 
SQLITE_OPEN_READONLY
 },

119721 { "rw", 
SQLITE_OPEN_READWRITE
 },

119722 { "rwc", 
SQLITE_OPEN_READWRITE
 | 
SQLITE_OPEN_CREATE
 },

119723 { "mem‹y", 
SQLITE_OPEN_MEMORY
 },

119727 
mask
 = 
SQLITE_OPEN_READONLY
 | 
SQLITE_OPEN_READWRITE


119728 | 
SQLITE_OPEN_CREATE
 | 
SQLITE_OPEN_MEMORY
;

119729 
aMode
 = 
aO≥nMode
;

119730 
limô
 = 
mask
 & 
Êags
;

119731 
zModeTy≥
 = "access";

119734 if–
aMode
 ){

119735 
i
;

119736 
mode
 = 0;

119737 
i
=0; 
aMode
[i].
z
; i++){

119738 c⁄° *
z
 = 
aMode
[
i
].z;

119739 if–
nVÆ
==
	`sqlôe3SåÀn30
(
z
Ë&& 0==
	`memcmp
(
zVÆ
, z,ÇVal) ){

119740 
mode
 = 
aMode
[
i
].mode;

119744 if–
mode
==0 ){

119745 *
pzEºMsg
 = 
	`sqlôe3_m¥ötf
("nÿsuch %†mode: %s", 
zModeTy≥
, 
zVÆ
);

119746 
rc
 = 
SQLITE_ERROR
;

119747 
∑r£_uri_out
;

119749 if–(
mode
 & ~
SQLITE_OPEN_MEMORY
)>
limô
 ){

119750 *
pzEºMsg
 = 
	`sqlôe3_m¥ötf
("%s modeÇotállowed: %s",

119751 
zModeTy≥
, 
zVÆ
);

119752 
rc
 = 
SQLITE_PERM
;

119753 
∑r£_uri_out
;

119755 
Êags
 = (Êag†& ~
mask
Ë| 
mode
;

119759 
zO±
 = &
zVÆ
[
nVÆ
+1];

119763 
zFûe
 = 
	`sqlôe3_mÆloc
(
nUri
+2);

119764 if–!
zFûe
 )  
SQLITE_NOMEM
;

119765 
	`mem˝y
(
zFûe
, 
zUri
, 
nUri
);

119766 
zFûe
[
nUri
] = '\0';

119767 
zFûe
[
nUri
+1] = '\0';

119768 
Êags
 &~
SQLITE_OPEN_URI
;

119771 *
µVfs
 = 
	`sqlôe3_vfs_föd
(
zVfs
);

119772 if–*
µVfs
==0 ){

119773 *
pzEºMsg
 = 
	`sqlôe3_m¥ötf
("nÿsuch vfs: %s", 
zVfs
);

119774 
rc
 = 
SQLITE_ERROR
;

119776 
∑r£_uri_out
:

119777 if–
rc
!=
SQLITE_OK
 ){

119778 
	`sqlôe3_‰ì
(
zFûe
);

119779 
zFûe
 = 0;

119781 *
pFœgs
 = 
Êags
;

119782 *
pzFûe
 = 
zFûe
;

119783  
rc
;

119792 
	`›íD©aba£
(

119793 c⁄° *
zFûíame
,

119794 
sqlôe3
 **
µDb
,

119795 
Êags
,

119796 c⁄° *
zVfs


119798 
sqlôe3
 *
db
;

119799 
rc
;

119800 
isThªadß„
;

119801 *
zO≥n
 = 0;

119802 *
zEºMsg
 = 0;

119804 *
µDb
 = 0;

119805 #i‚de‡
SQLITE_OMIT_AUTOINIT


119806 
rc
 = 
	`sqlôe3_öôülize
();

119807 if–
rc
 ) Ñc;

119820 
	`as£π
–
SQLITE_OPEN_READONLY
 == 0x01 );

119821 
	`as£π
–
SQLITE_OPEN_READWRITE
 == 0x02 );

119822 
	`as£π
–
SQLITE_OPEN_CREATE
 == 0x04 );

119823 
	`ã°ˇ£
–(1<<(
Êags
&7))==0x02 );

119824 
	`ã°ˇ£
–(1<<(
Êags
&7))==0x04 );

119825 
	`ã°ˇ£
–(1<<(
Êags
&7))==0x40 );

119826 if–((1<<(
Êags
&7)Ë& 0x46)==0 )  
SQLITE_MISUSE_BKPT
;

119828 if–
sqlôe3GlobÆC⁄fig
.
bC‹eMuãx
==0 ){

119829 
isThªadß„
 = 0;

119830 }if–
Êags
 & 
SQLITE_OPEN_NOMUTEX
 ){

119831 
isThªadß„
 = 0;

119832 }if–
Êags
 & 
SQLITE_OPEN_FULLMUTEX
 ){

119833 
isThªadß„
 = 1;

119835 
isThªadß„
 = 
sqlôe3GlobÆC⁄fig
.
bFuŒMuãx
;

119837 if–
Êags
 & 
SQLITE_OPEN_PRIVATECACHE
 ){

119838 
Êags
 &~
SQLITE_OPEN_SHAREDCACHE
;

119839 }if–
sqlôe3GlobÆC⁄fig
.
sh¨edCacheE«bÀd
 ){

119840 
Êags
 |
SQLITE_OPEN_SHAREDCACHE
;

119852 
Êags
 &~–
SQLITE_OPEN_DELETEONCLOSE
 |

119853 
SQLITE_OPEN_EXCLUSIVE
 |

119854 
SQLITE_OPEN_MAIN_DB
 |

119855 
SQLITE_OPEN_TEMP_DB
 |

119856 
SQLITE_OPEN_TRANSIENT_DB
 |

119857 
SQLITE_OPEN_MAIN_JOURNAL
 |

119858 
SQLITE_OPEN_TEMP_JOURNAL
 |

119859 
SQLITE_OPEN_SUBJOURNAL
 |

119860 
SQLITE_OPEN_MASTER_JOURNAL
 |

119861 
SQLITE_OPEN_NOMUTEX
 |

119862 
SQLITE_OPEN_FULLMUTEX
 |

119863 
SQLITE_OPEN_WAL


119867 
db
 = 
	`sqlôe3MÆlocZîo
–(
sqlôe3
) );

119868 if–
db
==0 ) 
›ídb_out
;

119869 if–
isThªadß„
 ){

119870 
db
->
muãx
 = 
	`sqlôe3MuãxAŒoc
(
SQLITE_MUTEX_RECURSIVE
);

119871 if–
db
->
muãx
==0 ){

119872 
	`sqlôe3_‰ì
(
db
);

119873 
db
 = 0;

119874 
›ídb_out
;

119877 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

119878 
db
->
îrMask
 = 0xff;

119879 
db
->
nDb
 = 2;

119880 
db
->
magic
 = 
SQLITE_MAGIC_BUSY
;

119881 
db
->
aDb
 = db->
aDbSètic
;

119883 
	`as£π
–(
db
->
aLimô
)==(
aH¨dLimô
) );

119884 
	`mem˝y
(
db
->
aLimô
, 
aH¨dLimô
, (db->aLimit));

119885 
db
->
autoCommô
 = 1;

119886 
db
->
√xtAutovac
 = -1;

119887 
db
->
szMm≠
 = 
sqlôe3GlobÆC⁄fig
.szMmap;

119888 
db
->
√xtPagesize
 = 0;

119889 
db
->
Êags
 |
SQLITE_Sh‹tCﬁNames
 | 
SQLITE_E«bÀTriggî
 | 
SQLITE_CacheSpûl


119890 #i‡!
	`deföed
(
SQLITE_DEFAULT_AUTOMATIC_INDEX
) || SQLITE_DEFAULT_AUTOMATIC_INDEX

119891 | 
SQLITE_AutoIndex


119893 #i‡
SQLITE_DEFAULT_FILE_FORMAT
<4

119894 | 
SQLITE_LegacyFûeFmt


119896 #ifde‡
SQLITE_ENABLE_LOAD_EXTENSION


119897 | 
SQLITE_LﬂdExãnsi⁄


119899 #i‡
SQLITE_DEFAULT_RECURSIVE_TRIGGERS


119900 | 
SQLITE_RecTriggîs


119902 #i‡
	`deföed
(
SQLITE_DEFAULT_FOREIGN_KEYS
) && SQLITE_DEFAULT_FOREIGN_KEYS

119903 | 
SQLITE_F‹eignKeys


119906 
	`sqlôe3HashInô
(&
db
->
aCﬁlSeq
);

119907 #i‚de‡
SQLITE_OMIT_VIRTUALTABLE


119908 
	`sqlôe3HashInô
(&
db
->
aModuÀ
);

119915 
	`¸óãCﬁœti⁄
(
db
, "BINARY", 
SQLITE_UTF8
, 0, 
böCﬁlFunc
, 0);

119916 
	`¸óãCﬁœti⁄
(
db
, "BINARY", 
SQLITE_UTF16BE
, 0, 
böCﬁlFunc
, 0);

119917 
	`¸óãCﬁœti⁄
(
db
, "BINARY", 
SQLITE_UTF16LE
, 0, 
böCﬁlFunc
, 0);

119918 
	`¸óãCﬁœti⁄
(
db
, "RTRIM", 
SQLITE_UTF8
, (*)1, 
böCﬁlFunc
, 0);

119919 if–
db
->
mÆlocFaûed
 ){

119920 
›ídb_out
;

119922 
db
->
pDÊtCﬁl
 = 
	`sqlôe3FödCﬁlSeq
(db, 
SQLITE_UTF8
, "BINARY", 0);

119923 
	`as£π
–
db
->
pDÊtCﬁl
!=0 );

119926 
	`¸óãCﬁœti⁄
(
db
, "NOCASE", 
SQLITE_UTF8
, 0, 
noˇ£CﬁœtögFunc
, 0);

119929 
db
->
›íFœgs
 = 
Êags
;

119930 
rc
 = 
	`sqlôe3P¨£Uri
(
zVfs
, 
zFûíame
, &
Êags
, &
db
->
pVfs
, &
zO≥n
, &
zEºMsg
);

119931 if–
rc
!=
SQLITE_OK
 ){

119932 if–
rc
==
SQLITE_NOMEM
 ) 
db
->
mÆlocFaûed
 = 1;

119933 
	`sqlôe3Eº‹
(
db
, 
rc
, 
zEºMsg
 ? "%s" : 0, zErrMsg);

119934 
	`sqlôe3_‰ì
(
zEºMsg
);

119935 
›ídb_out
;

119939 
rc
 = 
	`sqlôe3BåìO≥n
(
db
->
pVfs
, 
zO≥n
, db, &db->
aDb
[0].
pBt
, 0,

119940 
Êags
 | 
SQLITE_OPEN_MAIN_DB
);

119941 if–
rc
!=
SQLITE_OK
 ){

119942 if–
rc
==
SQLITE_IOERR_NOMEM
 ){

119943 
rc
 = 
SQLITE_NOMEM
;

119945 
	`sqlôe3Eº‹
(
db
, 
rc
, 0);

119946 
›ídb_out
;

119948 
db
->
aDb
[0].
pSchema
 = 
	`sqlôe3SchemaGë
(db, db->aDb[0].
pBt
);

119949 
db
->
aDb
[1].
pSchema
 = 
	`sqlôe3SchemaGë
(db, 0);

119955 
db
->
aDb
[0].
zName
 = "main";

119956 
db
->
aDb
[0].
ß„ty_Àvñ
 = 3;

119957 
db
->
aDb
[1].
zName
 = "temp";

119958 
db
->
aDb
[1].
ß„ty_Àvñ
 = 1;

119960 
db
->
magic
 = 
SQLITE_MAGIC_OPEN
;

119961 if–
db
->
mÆlocFaûed
 ){

119962 
›ídb_out
;

119969 
	`sqlôe3Eº‹
(
db
, 
SQLITE_OK
, 0);

119970 
	`sqlôe3Regi°îBuûtöFun˘i⁄s
(
db
);

119975 
rc
 = 
	`sqlôe3_îrcode
(
db
);

119976 if–
rc
==
SQLITE_OK
 ){

119977 
	`sqlôe3AutoLﬂdExãnsi⁄s
(
db
);

119978 
rc
 = 
	`sqlôe3_îrcode
(
db
);

119979 if–
rc
!=
SQLITE_OK
 ){

119980 
›ídb_out
;

119984 #ifde‡
SQLITE_ENABLE_FTS1


119985 if–!
db
->
mÆlocFaûed
 ){

119986 
	`sqlôe3Fts1Inô
(
sqlôe3
*);

119987 
rc
 = 
	`sqlôe3Fts1Inô
(
db
);

119991 #ifde‡
SQLITE_ENABLE_FTS2


119992 if–!
db
->
mÆlocFaûed
 && 
rc
==
SQLITE_OK
 ){

119993 
	`sqlôe3Fts2Inô
(
sqlôe3
*);

119994 
rc
 = 
	`sqlôe3Fts2Inô
(
db
);

119998 #ifde‡
SQLITE_ENABLE_FTS3


119999 if–!
db
->
mÆlocFaûed
 && 
rc
==
SQLITE_OK
 ){

120000 
rc
 = 
	`sqlôe3Fts3Inô
(
db
);

120004 #ifde‡
SQLITE_ENABLE_ICU


120005 if–!
db
->
mÆlocFaûed
 && 
rc
==
SQLITE_OK
 ){

120006 
rc
 = 
	`sqlôe3IcuInô
(
db
);

120010 #ifde‡
SQLITE_ENABLE_RTREE


120011 if–!
db
->
mÆlocFaûed
 && 
rc
==
SQLITE_OK
){

120012 
rc
 = 
	`sqlôe3RåìInô
(
db
);

120016 
	`sqlôe3Eº‹
(
db
, 
rc
, 0);

120022 #ifde‡
SQLITE_DEFAULT_LOCKING_MODE


120023 
db
->
dÊtLockMode
 = 
SQLITE_DEFAULT_LOCKING_MODE
;

120024 
	`sqlôe3PagîLockögMode
(
	`sqlôe3BåìPagî
(
db
->
aDb
[0].
pBt
),

120025 
SQLITE_DEFAULT_LOCKING_MODE
);

120029 
	`£tupLookaside
(
db
, 0, 
sqlôe3GlobÆC⁄fig
.
szLookaside
,

120030 
sqlôe3GlobÆC⁄fig
.
nLookaside
);

120032 
	`sqlôe3_wÆ_autocheckpoöt
(
db
, 
SQLITE_DEFAULT_WAL_AUTOCHECKPOINT
);

120034 
›ídb_out
:

120035 
	`sqlôe3_‰ì
(
zO≥n
);

120036 if–
db
 ){

120037 
	`as£π
–
db
->
muãx
!=0 || 
isThªadß„
==0 || 
sqlôe3GlobÆC⁄fig
.
bFuŒMuãx
==0 );

120038 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

120040 
rc
 = 
	`sqlôe3_îrcode
(
db
);

120041 
	`as£π
–
db
!=0 || 
rc
==
SQLITE_NOMEM
 );

120042 if–
rc
==
SQLITE_NOMEM
 ){

120043 
	`sqlôe3_˛o£
(
db
);

120044 
db
 = 0;

120045 }if–
rc
!=
SQLITE_OK
 ){

120046 
db
->
magic
 = 
SQLITE_MAGIC_SICK
;

120048 *
µDb
 = 
db
;

120049 #ifde‡
SQLITE_ENABLE_SQLLOG


120050 if–
sqlôe3GlobÆC⁄fig
.
xSqŒog
 ){

120052 *
pArg
 = 
sqlôe3GlobÆC⁄fig
.
pSqŒogArg
;

120053 
sqlôe3GlobÆC⁄fig
.
	`xSqŒog
(
pArg
, 
db
, 
zFûíame
, 0);

120056  
	`sqlôe3ApiExô
(0, 
rc
);

120062 
SQLITE_API
 
	`sqlôe3_›í
(

120063 c⁄° *
zFûíame
,

120064 
sqlôe3
 **
µDb


120066  
	`›íD©aba£
(
zFûíame
, 
µDb
,

120067 
SQLITE_OPEN_READWRITE
 | 
SQLITE_OPEN_CREATE
, 0);

120069 
SQLITE_API
 
	`sqlôe3_›í_v2
(

120070 c⁄° *
fûíame
,

120071 
sqlôe3
 **
µDb
,

120072 
Êags
,

120073 c⁄° *
zVfs


120075  
	`›íD©aba£
(
fûíame
, 
µDb
, ()
Êags
, 
zVfs
);

120078 #i‚de‡
SQLITE_OMIT_UTF16


120082 
SQLITE_API
 
	`sqlôe3_›í16
(

120083 c⁄° *
zFûíame
,

120084 
sqlôe3
 **
µDb


120086 c⁄° *
zFûíame8
;

120087 
sqlôe3_vÆue
 *
pVÆ
;

120088 
rc
;

120090 
	`as£π
–
zFûíame
 );

120091 
	`as£π
–
µDb
 );

120092 *
µDb
 = 0;

120093 #i‚de‡
SQLITE_OMIT_AUTOINIT


120094 
rc
 = 
	`sqlôe3_öôülize
();

120095 if–
rc
 ) Ñc;

120097 
pVÆ
 = 
	`sqlôe3VÆueNew
(0);

120098 
	`sqlôe3VÆueSëSå
(
pVÆ
, -1, 
zFûíame
, 
SQLITE_UTF16NATIVE
, 
SQLITE_STATIC
);

120099 
zFûíame8
 = 
	`sqlôe3VÆueText
(
pVÆ
, 
SQLITE_UTF8
);

120100 if–
zFûíame8
 ){

120101 
rc
 = 
	`›íD©aba£
(
zFûíame8
, 
µDb
,

120102 
SQLITE_OPEN_READWRITE
 | 
SQLITE_OPEN_CREATE
, 0);

120103 
	`as£π
–*
µDb
 || 
rc
==
SQLITE_NOMEM
 );

120104 if–
rc
==
SQLITE_OK
 && !
	`DbHasPr›îty
(*
µDb
, 0, 
DB_SchemaLﬂded
) ){

120105 
	`ENC
(*
µDb
Ë
SQLITE_UTF16NATIVE
;

120108 
rc
 = 
SQLITE_NOMEM
;

120110 
	`sqlôe3VÆueFªe
(
pVÆ
);

120112  
	`sqlôe3ApiExô
(0, 
rc
);

120119 
SQLITE_API
 
	`sqlôe3_¸óã_cﬁœti⁄
(

120120 
sqlôe3
* 
db
,

120121 c⁄° *
zName
,

120122 
íc
,

120123 * 
pCtx
,

120124 (*
xCom∑ª
)(*,,const *,,const *)

120126 
rc
;

120127 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

120128 
	`as£π
–!
db
->
mÆlocFaûed
 );

120129 
rc
 = 
	`¸óãCﬁœti⁄
(
db
, 
zName
, (
u8
)
íc
, 
pCtx
, 
xCom∑ª
, 0);

120130 
rc
 = 
	`sqlôe3ApiExô
(
db
,Ñc);

120131 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

120132  
rc
;

120138 
SQLITE_API
 
	`sqlôe3_¸óã_cﬁœti⁄_v2
(

120139 
sqlôe3
* 
db
,

120140 c⁄° *
zName
,

120141 
íc
,

120142 * 
pCtx
,

120143 (*
xCom∑ª
)(*,,const *,,const *),

120144 (*
xDñ
)(*)

120146 
rc
;

120147 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

120148 
	`as£π
–!
db
->
mÆlocFaûed
 );

120149 
rc
 = 
	`¸óãCﬁœti⁄
(
db
, 
zName
, (
u8
)
íc
, 
pCtx
, 
xCom∑ª
, 
xDñ
);

120150 
rc
 = 
	`sqlôe3ApiExô
(
db
,Ñc);

120151 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

120152  
rc
;

120155 #i‚de‡
SQLITE_OMIT_UTF16


120159 
SQLITE_API
 
	`sqlôe3_¸óã_cﬁœti⁄16
(

120160 
sqlôe3
* 
db
,

120161 c⁄° *
zName
,

120162 
íc
,

120163 * 
pCtx
,

120164 (*
xCom∑ª
)(*,,const *,,const *)

120166 
rc
 = 
SQLITE_OK
;

120167 *
zName8
;

120168 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

120169 
	`as£π
–!
db
->
mÆlocFaûed
 );

120170 
zName8
 = 
	`sqlôe3Utf16to8
(
db
, 
zName
, -1, 
SQLITE_UTF16NATIVE
);

120171 if–
zName8
 ){

120172 
rc
 = 
	`¸óãCﬁœti⁄
(
db
, 
zName8
, (
u8
)
íc
, 
pCtx
, 
xCom∑ª
, 0);

120173 
	`sqlôe3DbFªe
(
db
, 
zName8
);

120175 
rc
 = 
	`sqlôe3ApiExô
(
db
,Ñc);

120176 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

120177  
rc
;

120185 
SQLITE_API
 
	`sqlôe3_cﬁœti⁄_√eded
(

120186 
sqlôe3
 *
db
,

120187 *
pCﬁlNìdedArg
,

120188 (*
xCﬁlNìded
)(*,
sqlôe3
*,
eTextRï
,const *)

120190 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

120191 
db
->
xCﬁlNìded
 = xCollNeeded;

120192 
db
->
xCﬁlNìded16
 = 0;

120193 
db
->
pCﬁlNìdedArg
 =ÖCollNeededArg;

120194 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

120195  
SQLITE_OK
;

120198 #i‚de‡
SQLITE_OMIT_UTF16


120203 
SQLITE_API
 
	`sqlôe3_cﬁœti⁄_√eded16
(

120204 
sqlôe3
 *
db
,

120205 *
pCﬁlNìdedArg
,

120206 (*
xCﬁlNìded16
)(*,
sqlôe3
*,
eTextRï
,const *)

120208 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

120209 
db
->
xCﬁlNìded
 = 0;

120210 
db
->
xCﬁlNìded16
 = xCollNeeded16;

120211 
db
->
pCﬁlNìdedArg
 =ÖCollNeededArg;

120212 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

120213  
SQLITE_OK
;

120217 #i‚de‡
SQLITE_OMIT_DEPRECATED


120222 
SQLITE_API
 
	`sqlôe3_globÆ_ªcovî
(){

120223  
SQLITE_OK
;

120233 
SQLITE_API
 
	`sqlôe3_gë_autocommô
(
sqlôe3
 *
db
){

120234  
db
->
autoCommô
;

120248 
SQLITE_PRIVATE
 
	`sqlôe3C‹ru±Eº‹
(
löío
){

120249 
	`ã°ˇ£
–
sqlôe3GlobÆC⁄fig
.
xLog
!=0 );

120250 
	`sqlôe3_log
(
SQLITE_CORRUPT
,

120252 
löío
, 20+
	`sqlôe3_sour˚id
());

120253  
SQLITE_CORRUPT
;

120255 
SQLITE_PRIVATE
 
	`sqlôe3Misu£Eº‹
(
löío
){

120256 
	`ã°ˇ£
–
sqlôe3GlobÆC⁄fig
.
xLog
!=0 );

120257 
	`sqlôe3_log
(
SQLITE_MISUSE
,

120259 
löío
, 20+
	`sqlôe3_sour˚id
());

120260  
SQLITE_MISUSE
;

120262 
SQLITE_PRIVATE
 
	`sqlôe3C™t›íEº‹
(
löío
){

120263 
	`ã°ˇ£
–
sqlôe3GlobÆC⁄fig
.
xLog
!=0 );

120264 
	`sqlôe3_log
(
SQLITE_CANTOPEN
,

120266 
löío
, 20+
	`sqlôe3_sour˚id
());

120267  
SQLITE_CANTOPEN
;

120271 #i‚de‡
SQLITE_OMIT_DEPRECATED


120279 
SQLITE_API
 
	`sqlôe3_thªad_˛ónup
(){

120287 #ifde‡
SQLITE_ENABLE_COLUMN_METADATA


120288 
SQLITE_API
 
	`sqlôe3_èbÀ_cﬁumn_mëad©a
(

120289 
sqlôe3
 *
db
,

120290 c⁄° *
zDbName
,

120291 c⁄° *
zTabÀName
,

120292 c⁄° *
zCﬁumnName
,

120293 c⁄° **
pzD©aTy≥
,

120294 c⁄° **
pzCﬁlSeq
,

120295 *
pNŸNuŒ
,

120296 *
pPrim¨yKey
,

120297 *
pAutoöc


120299 
rc
;

120300 *
zEºMsg
 = 0;

120301 
TabÀ
 *
pTab
 = 0;

120302 
Cﬁumn
 *
pCﬁ
 = 0;

120303 
iCﬁ
;

120305 c⁄° *
zD©aTy≥
 = 0;

120306 c⁄° *
zCﬁlSeq
 = 0;

120307 
nŸnuŒ
 = 0;

120308 
¥im¨ykey
 = 0;

120309 
autoöc
 = 0;

120312 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

120313 
	`sqlôe3BåìE¡îAŒ
(
db
);

120314 
rc
 = 
	`sqlôe3Inô
(
db
, &
zEºMsg
);

120315 if–
SQLITE_OK
!=
rc
 ){

120316 
îr‹_out
;

120320 
pTab
 = 
	`sqlôe3FödTabÀ
(
db
, 
zTabÀName
, 
zDbName
);

120321 if–!
pTab
 ||ÖTab->
pSñe˘
 ){

120322 
pTab
 = 0;

120323 
îr‹_out
;

120327 if–
	`sqlôe3IsRowid
(
zCﬁumnName
) ){

120328 
iCﬁ
 = 
pTab
->
iPKey
;

120329 if–
iCﬁ
>=0 ){

120330 
pCﬁ
 = &
pTab
->
aCﬁ
[
iCﬁ
];

120333 
iCﬁ
=0; iCﬁ<
pTab
->
nCﬁ
; iCol++){

120334 
pCﬁ
 = &
pTab
->
aCﬁ
[
iCﬁ
];

120335 if–0==
	`sqlôe3SåICmp
(
pCﬁ
->
zName
, 
zCﬁumnName
) ){

120339 if–
iCﬁ
==
pTab
->
nCﬁ
 ){

120340 
pTab
 = 0;

120341 
îr‹_out
;

120355 if–
pCﬁ
 ){

120356 
zD©aTy≥
 = 
pCﬁ
->
zTy≥
;

120357 
zCﬁlSeq
 = 
pCﬁ
->
zCﬁl
;

120358 
nŸnuŒ
 = 
pCﬁ
->
nŸNuŒ
!=0;

120359 
¥im¨ykey
 = (
pCﬁ
->
cﬁFœgs
 & 
COLFLAG_PRIMKEY
)!=0;

120360 
autoöc
 = 
pTab
->
iPKey
==
iCﬁ
 && (pTab->
èbFœgs
 & 
TF_Autoö¸emít
)!=0;

120362 
zD©aTy≥
 = "INTEGER";

120363 
¥im¨ykey
 = 1;

120365 if–!
zCﬁlSeq
 ){

120366 
zCﬁlSeq
 = "BINARY";

120369 
îr‹_out
:

120370 
	`sqlôe3BåìLóveAŒ
(
db
);

120376 if–
pzD©aTy≥
 ) *pzD©aTy≥ = 
zD©aTy≥
;

120377 if–
pzCﬁlSeq
 ) *pzCﬁlSeq = 
zCﬁlSeq
;

120378 if–
pNŸNuŒ
 ) *pNŸNuŒ = 
nŸnuŒ
;

120379 if–
pPrim¨yKey
 ) *pPrim¨yKey = 
¥im¨ykey
;

120380 if–
pAutoöc
 ) *pAutoö¯
autoöc
;

120382 if–
SQLITE_OK
==
rc
 && !
pTab
 ){

120383 
	`sqlôe3DbFªe
(
db
, 
zEºMsg
);

120384 
zEºMsg
 = 
	`sqlôe3MPrötf
(
db
, "nÿsuchÅabÀ cﬁumn: %s.%s", 
zTabÀName
,

120385 
zCﬁumnName
);

120386 
rc
 = 
SQLITE_ERROR
;

120388 
	`sqlôe3Eº‹
(
db
, 
rc
, (
zEºMsg
?"%s":0), zErrMsg);

120389 
	`sqlôe3DbFªe
(
db
, 
zEºMsg
);

120390 
rc
 = 
	`sqlôe3ApiExô
(
db
,Ñc);

120391 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

120392  
rc
;

120399 
SQLITE_API
 
	`sqlôe3_¶ìp
(
ms
){

120400 
sqlôe3_vfs
 *
pVfs
;

120401 
rc
;

120402 
pVfs
 = 
	`sqlôe3_vfs_föd
(0);

120403 if–
pVfs
==0 )  0;

120408 
rc
 = (
	`sqlôe3OsSÀï
(
pVfs
, 1000*
ms
)/1000);

120409  
rc
;

120415 
SQLITE_API
 
	`sqlôe3_exãnded_ªsu…_codes
(
sqlôe3
 *
db
, 
⁄off
){

120416 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

120417 
db
->
îrMask
 = 
⁄off
 ? 0xffffffff : 0xff;

120418 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

120419  
SQLITE_OK
;

120425 
SQLITE_API
 
	`sqlôe3_fûe_c⁄åﬁ
(
sqlôe3
 *
db
, c⁄° *
zDbName
, 
›
, *
pArg
){

120426 
rc
 = 
SQLITE_ERROR
;

120427 
Båì
 *
pBåì
;

120429 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

120430 
pBåì
 = 
	`sqlôe3DbNameToBåì
(
db
, 
zDbName
);

120431 if–
pBåì
 ){

120432 
Pagî
 *
pPagî
;

120433 
sqlôe3_fûe
 *
fd
;

120434 
	`sqlôe3BåìE¡î
(
pBåì
);

120435 
pPagî
 = 
	`sqlôe3BåìPagî
(
pBåì
);

120436 
	`as£π
–
pPagî
!=0 );

120437 
fd
 = 
	`sqlôe3PagîFûe
(
pPagî
);

120438 
	`as£π
–
fd
!=0 );

120439 if–
›
==
SQLITE_FCNTL_FILE_POINTER
 ){

120440 *(
sqlôe3_fûe
**)
pArg
 = 
fd
;

120441 
rc
 = 
SQLITE_OK
;

120442 }if–
fd
->
pMëhods
 ){

120443 
rc
 = 
	`sqlôe3OsFûeC⁄åﬁ
(
fd
, 
›
, 
pArg
);

120445 
rc
 = 
SQLITE_NOTFOUND
;

120447 
	`sqlôe3BåìLóve
(
pBåì
);

120449 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

120450  
rc
;

120456 
SQLITE_API
 
	`sqlôe3_ã°_c⁄åﬁ
(
›
, ...){

120457 
rc
 = 0;

120458 #i‚de‡
SQLITE_OMIT_BUILTIN_TEST


120459 
va_li°
 
≠
;

120460 
	`va_°¨t
(
≠
, 
›
);

120461  
›
 ){

120466 
SQLITE_TESTCTRL_PRNG_SAVE
: {

120467 
	`sqlôe3P∫gSaveSèã
();

120476 
SQLITE_TESTCTRL_PRNG_RESTORE
: {

120477 
	`sqlôe3P∫gRe°‹eSèã
();

120486 
SQLITE_TESTCTRL_PRNG_RESET
: {

120487 
	`sqlôe3P∫gRe£tSèã
();

120499 
SQLITE_TESTCTRL_BITVEC_TEST
: {

120500 
sz
 = 
	`va_¨g
(
≠
, );

120501 *
aProg
 = 
	`va_¨g
(
≠
, *);

120502 
rc
 = 
	`sqlôe3BôvecBuûtöTe°
(
sz
, 
aProg
);

120512 
SQLITE_TESTCTRL_BENIGN_MALLOC_HOOKS
: {

120513 (*
	tvoid_fun˘i⁄
)();

120514 
void_fun˘i⁄
 
xBíignBegö
;

120515 
void_fun˘i⁄
 
xBíignEnd
;

120516 
xBíignBegö
 = 
	`va_¨g
(
≠
, 
void_fun˘i⁄
);

120517 
xBíignEnd
 = 
	`va_¨g
(
≠
, 
void_fun˘i⁄
);

120518 
	`sqlôe3BíignMÆlocHooks
(
xBíignBegö
, 
xBíignEnd
);

120534 
SQLITE_TESTCTRL_PENDING_BYTE
: {

120535 
rc
 = 
PENDING_BYTE
;

120536 #i‚de‡
SQLITE_OMIT_WSD


120538 
√wVÆ
 = 
	`va_¨g
(
≠
, );

120539 if–
√wVÆ
 ) 
sqlôe3PídögByã
 =ÇewVal;

120556 
SQLITE_TESTCTRL_ASSERT
: {

120557 vﬁ©ûê
x
 = 0;

120558 
	`as£π
–(
x
 = 
	`va_¨g
(
≠
,))!=0 );

120559 
rc
 = 
x
;

120591 
SQLITE_TESTCTRL_ALWAYS
: {

120592 
x
 = 
	`va_¨g
(
≠
,);

120593 
rc
 = 
	`ALWAYS
(
x
);

120602 
SQLITE_TESTCTRL_RESERVE
: {

120603 
sqlôe3
 *
db
 = 
	`va_¨g
(
≠
, sqlite3*);

120604 
x
 = 
	`va_¨g
(
≠
,);

120605 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

120606 
	`sqlôe3BåìSëPageSize
(
db
->
aDb
[0].
pBt
, 0, 
x
, 0);

120607 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

120620 
SQLITE_TESTCTRL_OPTIMIZATIONS
: {

120621 
sqlôe3
 *
db
 = 
	`va_¨g
(
≠
, sqlite3*);

120622 
db
->
dbO±Fœgs
 = (
u16
)(
	`va_¨g
(
≠
, ) & 0xffff);

120626 #ifde‡
SQLITE_N_KEYWORD


120636 
SQLITE_TESTCTRL_ISKEYWORD
: {

120637 c⁄° *
zW‹d
 = 
	`va_¨g
(
≠
, const *);

120638 
n
 = 
	`sqlôe3SåÀn30
(
zW‹d
);

120639 
rc
 = (
	`sqlôe3Keyw‹dCode
((
u8
*)
zW‹d
, 
n
)!=
TK_ID
Ë? 
SQLITE_N_KEYWORD
 : 0;

120649 
SQLITE_TESTCTRL_SCRATCHMALLOC
: {

120650 *
pFªe
, **
µNew
;

120651 
sz
;

120652 
sz
 = 
	`va_¨g
(
≠
, );

120653 
µNew
 = 
	`va_¨g
(
≠
, **);

120654 
pFªe
 = 
	`va_¨g
(
≠
, *);

120655 if–
sz
 ) *
µNew
 = 
	`sqlôe3S¸©chMÆloc
(sz);

120656 
	`sqlôe3S¸©chFªe
(
pFªe
);

120666 
SQLITE_TESTCTRL_LOCALTIME_FAULT
: {

120667 
sqlôe3GlobÆC⁄fig
.
bLoˇ…imeFau…
 = 
	`va_¨g
(
≠
, );

120671 #i‡
	`deföed
(
SQLITE_ENABLE_TREE_EXPLAIN
)

120679 
SQLITE_TESTCTRL_EXPLAIN_STMT
: {

120680 
sqlôe3_°mt
 *
pStmt
 = 
	`va_¨g
(
≠
, sqlite3_stmt*);

120681 c⁄° **
pzRë
 = 
	`va_¨g
(
≠
, const **);

120682 *
pzRë
 = 
	`sqlôe3VdbeEx∂™©i⁄
((
Vdbe
*)
pStmt
);

120688 
	`va_íd
(
≠
);

120690  
rc
;

120704 
SQLITE_API
 c⁄° *
	`sqlôe3_uri_∑ømëî
(c⁄° *
zFûíame
, c⁄° *
zP¨am
){

120705 if–
zFûíame
==0 )  0;

120706 
zFûíame
 +
	`sqlôe3SåÀn30
(zFilename) + 1;

120707  
zFûíame
[0] ){

120708 
x
 = 
	`°rcmp
(
zFûíame
, 
zP¨am
);

120709 
zFûíame
 +
	`sqlôe3SåÀn30
(zFilename) + 1;

120710 if–
x
==0 )  
zFûíame
;

120711 
zFûíame
 +
	`sqlôe3SåÀn30
(zFilename) + 1;

120719 
SQLITE_API
 
	`sqlôe3_uri_boﬁón
(c⁄° *
zFûíame
, c⁄° *
zP¨am
, 
bDÊt
){

120720 c⁄° *
z
 = 
	`sqlôe3_uri_∑ømëî
(
zFûíame
, 
zP¨am
);

120721 
bDÊt
 = bDflt!=0;

120722  
z
 ? 
	`sqlôe3GëBoﬁón
(z, 
bDÊt
) : bDflt;

120728 
SQLITE_API
 
sqlôe3_öt64
 
	`sqlôe3_uri_öt64
(

120729 c⁄° *
zFûíame
,

120730 c⁄° *
zP¨am
,

120731 
sqlôe3_öt64
 
bDÊt


120733 c⁄° *
z
 = 
	`sqlôe3_uri_∑ømëî
(
zFûíame
, 
zP¨am
);

120734 
sqlôe3_öt64
 
v
;

120735 if–
z
 && 
	`sqlôe3Atoi64
(z, &
v
, 
	`sqlôe3SåÀn30
(z), 
SQLITE_UTF8
)==
SQLITE_OK
 ){

120736 
bDÊt
 = 
v
;

120738  
bDÊt
;

120744 
SQLITE_PRIVATE
 
Båì
 *
	`sqlôe3DbNameToBåì
(
sqlôe3
 *
db
, c⁄° *
zDbName
){

120745 
i
;

120746 
i
=0; i<
db
->
nDb
; i++){

120747 if–
db
->
aDb
[
i
].
pBt


120748 && (
zDbName
==0 || 
	`sqlôe3SåICmp
(zDbName, 
db
->
aDb
[
i
].
zName
)==0)

120750  
db
->
aDb
[
i
].
pBt
;

120760 
SQLITE_API
 c⁄° *
	`sqlôe3_db_fûíame
(
sqlôe3
 *
db
, c⁄° *
zDbName
){

120761 
Båì
 *
pBt
 = 
	`sqlôe3DbNameToBåì
(
db
, 
zDbName
);

120762  
pBt
 ? 
	`sqlôe3BåìGëFûíame
(pBt) : 0;

120769 
SQLITE_API
 
	`sqlôe3_db_ªad⁄ly
(
sqlôe3
 *
db
, c⁄° *
zDbName
){

120770 
Båì
 *
pBt
 = 
	`sqlôe3DbNameToBåì
(
db
, 
zDbName
);

120771  
pBt
 ? 
	`sqlôe3PagîI§ód⁄ly
(
	`sqlôe3BåìPagî
(pBt)) : -1;

120793 #ifde‡
SQLITE_ENABLE_UNLOCK_NOTIFY


120804 
	#as£πMuãxHñd
() \

120805 
	`as£π
–
	`sqlôe3_muãx_hñd
(
	`sqlôe3MuãxAŒoc
(
SQLITE_MUTEX_STATIC_MASTER
)Ë)

	)

120813 
sqlôe3
 *
SQLITE_WSD
 
sqlôe3BlockedLi°
 = 0;

120815 #i‚de‡
NDEBUG


120830 
	`checkLi°Pr›îtõs
(
sqlôe3
 *
db
){

120831 
sqlôe3
 *
p
;

120832 
p
=
sqlôe3BlockedLi°
;Ö;Öı->
pNextBlocked
){

120833 
£í
 = 0;

120834 
sqlôe3
 *
p2
;

120837 
	`as£π
–
p
->
pU∆ockC⁄√˘i⁄
 ||Ö->
pBlockögC⁄√˘i⁄
 );

120840 
p2
=
sqlôe3BlockedLi°
;Ö2!=
p
;Ö2ı2->
pNextBlocked
){

120841 if–
p2
->
xU∆ockNŸify
==
p
->xU∆ockNŸify ) 
£í
 = 1;

120842 
	`as£π
–
p2
->
xU∆ockNŸify
==
p
->xU∆ockNŸify || !
£í
 );

120843 
	`as£π
–
db
==0 || 
p
->
pU∆ockC⁄√˘i⁄
!=db );

120844 
	`as£π
–
db
==0 || 
p
->
pBlockögC⁄√˘i⁄
!=db );

120849 
	#checkLi°Pr›îtõs
(
x
)

	)

120856 
	`ªmoveFromBlockedLi°
(
sqlôe3
 *
db
){

120857 
sqlôe3
 **
µ
;

120858 
	`as£πMuãxHñd
();

120859 
µ
=&
sqlôe3BlockedLi°
; *µ;Ö∞&(*µ)->
pNextBlocked
){

120860 if–*
µ
==
db
 ){

120861 *
µ
 = (*µ)->
pNextBlocked
;

120871 
	`addToBlockedLi°
(
sqlôe3
 *
db
){

120872 
sqlôe3
 **
µ
;

120873 
	`as£πMuãxHñd
();

120875 
µ
=&
sqlôe3BlockedLi°
;

120876 *
µ
 && (*µ)->
xU∆ockNŸify
!=
db
->xUnlockNotify;

120877 
µ
=&(*µ)->
pNextBlocked


120879 
db
->
pNextBlocked
 = *
µ
;

120880 *
µ
 = 
db
;

120886 
	`íãrMuãx
(){

120887 
	`sqlôe3_muãx_íãr
(
	`sqlôe3MuãxAŒoc
(
SQLITE_MUTEX_STATIC_MASTER
));

120888 
	`checkLi°Pr›îtõs
(0);

120894 
	`ÀaveMuãx
(){

120895 
	`as£πMuãxHñd
();

120896 
	`checkLi°Pr›îtõs
(0);

120897 
	`sqlôe3_muãx_Àave
(
	`sqlôe3MuãxAŒoc
(
SQLITE_MUTEX_STATIC_MASTER
));

120921 
SQLITE_API
 
	`sqlôe3_u∆ock_nŸify
(

120922 
sqlôe3
 *
db
,

120923 (*
xNŸify
)(**, ),

120924 *
pArg


120926 
rc
 = 
SQLITE_OK
;

120928 
	`sqlôe3_muãx_íãr
(
db
->
muãx
);

120929 
	`íãrMuãx
();

120931 if–
xNŸify
==0 ){

120932 
	`ªmoveFromBlockedLi°
(
db
);

120933 
db
->
pBlockögC⁄√˘i⁄
 = 0;

120934 
db
->
pU∆ockC⁄√˘i⁄
 = 0;

120935 
db
->
xU∆ockNŸify
 = 0;

120936 
db
->
pU∆ockArg
 = 0;

120937 }if–0==
db
->
pBlockögC⁄√˘i⁄
 ){

120942 
	`xNŸify
(&
pArg
, 1);

120944 
sqlôe3
 *
p
;

120946 
p
=
db
->
pBlockögC⁄√˘i⁄
;Ö &&Ö!=db;Öı->
pU∆ockC⁄√˘i⁄
){}

120947 if–
p
 ){

120948 
rc
 = 
SQLITE_LOCKED
;

120950 
db
->
pU∆ockC⁄√˘i⁄
 = db->
pBlockögC⁄√˘i⁄
;

120951 
db
->
xU∆ockNŸify
 = 
xNŸify
;

120952 
db
->
pU∆ockArg
 = 
pArg
;

120953 
	`ªmoveFromBlockedLi°
(
db
);

120954 
	`addToBlockedLi°
(
db
);

120958 
	`ÀaveMuãx
();

120959 
	`as£π
–!
db
->
mÆlocFaûed
 );

120960 
	`sqlôe3Eº‹
(
db
, 
rc
, (rc?"database is deadlocked":0));

120961 
	`sqlôe3_muãx_Àave
(
db
->
muãx
);

120962  
rc
;

120971 
SQLITE_PRIVATE
 
	`sqlôe3C⁄√˘i⁄Blocked
(
sqlôe3
 *
db
, sqlôe3 *
pBlockî
){

120972 
	`íãrMuãx
();

120973 if–
db
->
pBlockögC⁄√˘i⁄
==0 && db->
pU∆ockC⁄√˘i⁄
==0 ){

120974 
	`addToBlockedLi°
(
db
);

120976 
db
->
pBlockögC⁄√˘i⁄
 = 
pBlockî
;

120977 
	`ÀaveMuãx
();

120999 
SQLITE_PRIVATE
 
	`sqlôe3C⁄√˘i⁄U∆ocked
(
sqlôe3
 *
db
){

121000 (*
xU∆ockNŸify
)(**, ) = 0;

121001 
nArg
 = 0;

121002 
sqlôe3
 **
µ
;

121003 **
aArg
;

121004 **
aDyn
 = 0;

121005 *
aSètic
[16];

121007 
aArg
 = 
aSètic
;

121008 
	`íãrMuãx
();

121011 
µ
=&
sqlôe3BlockedLi°
; *pp; ){

121012 
sqlôe3
 *
p
 = *
µ
;

121015 if–
p
->
pBlockögC⁄√˘i⁄
==
db
 ){

121016 
p
->
pBlockögC⁄√˘i⁄
 = 0;

121020 if–
p
->
pU∆ockC⁄√˘i⁄
==
db
 ){

121021 
	`as£π
–
p
->
xU∆ockNŸify
 );

121022 if–
p
->
xU∆ockNŸify
!=xU∆ockNŸify && 
nArg
!=0 ){

121023 
	`xU∆ockNŸify
(
aArg
, 
nArg
);

121024 
nArg
 = 0;

121027 
	`sqlôe3BegöBíignMÆloc
();

121028 
	`as£π
–
aArg
==
aDyn
 || (aDyn==0 &&áArg==
aSètic
) );

121029 
	`as£π
–
nArg
<=()
	`AºaySize
(
aSètic
Ë|| 
aArg
==
aDyn
 );

121030 if–(!
aDyn
 && 
nArg
==()
	`AºaySize
(
aSètic
))

121031 || (
aDyn
 && 
nArg
==()(
	`sqlôe3MÆlocSize
(aDyn)/(*)))

121034 **
pNew
 = (**)
	`sqlôe3MÆloc
(
nArg
*(*)*2);

121035 if–
pNew
 ){

121036 
	`mem˝y
(
pNew
, 
aArg
, 
nArg
*(*));

121037 
	`sqlôe3_‰ì
(
aDyn
);

121038 
aDyn
 = 
aArg
 = 
pNew
;

121064 
	`xU∆ockNŸify
(
aArg
, 
nArg
);

121065 
nArg
 = 0;

121068 
	`sqlôe3EndBíignMÆloc
();

121070 
aArg
[
nArg
++] = 
p
->
pU∆ockArg
;

121071 
xU∆ockNŸify
 = 
p
->xUnlockNotify;

121072 
p
->
pU∆ockC⁄√˘i⁄
 = 0;

121073 
p
->
xU∆ockNŸify
 = 0;

121074 
p
->
pU∆ockArg
 = 0;

121078 if–
p
->
pBlockögC⁄√˘i⁄
==0 &&Ö->
pU∆ockC⁄√˘i⁄
==0 ){

121080 *
µ
 = 
p
->
pNextBlocked
;

121081 
p
->
pNextBlocked
 = 0;

121083 
µ
 = &
p
->
pNextBlocked
;

121087 if–
nArg
!=0 ){

121088 
	`xU∆ockNŸify
(
aArg
, 
nArg
);

121090 
	`sqlôe3_‰ì
(
aDyn
);

121091 
	`ÀaveMuãx
();

121098 
SQLITE_PRIVATE
 
	`sqlôe3C⁄√˘i⁄Clo£d
(
sqlôe3
 *
db
){

121099 
	`sqlôe3C⁄√˘i⁄U∆ocked
(
db
);

121100 
	`íãrMuãx
();

121101 
	`ªmoveFromBlockedLi°
(
db
);

121102 
	`checkLi°Pr›îtõs
(
db
);

121103 
	`ÀaveMuãx
();

121414 #i‚de‡
_FTSINT_H


121415 
	#_FTSINT_H


	)

121417 #i‡!
	`deföed
(
NDEBUG
Ë&& !deföed(
SQLITE_DEBUG
)

121418 
	#NDEBUG
 1

	)

121426 #i‡
	`deföed
(
SQLITE_ENABLE_FTS4
Ë&& !deföed(
SQLITE_ENABLE_FTS3
)

121427 
	#SQLITE_ENABLE_FTS3


	)

121430 #i‡!
	`deföed
(
SQLITE_CORE
Ë|| deföed(
SQLITE_ENABLE_FTS3
)

121433 #i‚de‡
SQLITE_CORE


121434 
SQLITE_EXTENSION_INIT3


121458 #i‚de‡
_FTS3_TOKENIZER_H_


121459 
	#_FTS3_TOKENIZER_H_


	)

121485 
sqlôe3_tokíizî_moduÀ
 
	tsqlôe3_tokíizî_moduÀ
;

121486 
sqlôe3_tokíizî
 
	tsqlôe3_tokíizî
;

121487 
sqlôe3_tokíizî_curs‹
 
	tsqlôe3_tokíizî_curs‹
;

121489 
	ssqlôe3_tokíizî_moduÀ
 {

121494 
iVîsi⁄
;

121513 (*
xCª©e
)(

121514 
¨gc
,

121515 c⁄° *c⁄°*
¨gv
,

121516 
sqlôe3_tokíizî
 **
µTokíizî


121523 (*
xDe°roy
)(
sqlôe3_tokíizî
 *
pTokíizî
);

121530 (*
xO≥n
)(

121531 
sqlôe3_tokíizî
 *
pTokíizî
,

121532 c⁄° *
pI≈ut
, 
nByãs
,

121533 
sqlôe3_tokíizî_curs‹
 **
µCurs‹


121540 (*
xClo£
)(
sqlôe3_tokíizî_curs‹
 *
pCurs‹
);

121566 (*
xNext
)(

121567 
sqlôe3_tokíizî_curs‹
 *
pCurs‹
,

121568 c⁄° **
µTokí
, *
≤Byãs
,

121569 *
piSèπOff£t
,

121570 *
piEndOff£t
,

121571 *
piPosôi⁄


121581 (*
xL™guageid
)(
sqlôe3_tokíizî_curs‹
 *
pC§
, 
iL™gid
);

121584 
	ssqlôe3_tokíizî
 {

121585 c⁄° 
sqlôe3_tokíizî_moduÀ
 *
pModuÀ
;

121589 
	ssqlôe3_tokíizî_curs‹
 {

121590 
sqlôe3_tokíizî
 *
pTokíizî
;

121594 
	`·s3_globÆ_ãrm_˙t
(
iTîm
, 
iCﬁ
);

121595 
	`·s3_ãrm_˙t
(
iTîm
, 
iCﬁ
);

121620 #i‚de‡
_FTS3_HASH_H_


121621 
	#_FTS3_HASH_H_


	)

121624 
Fts3Hash
 
	tFts3Hash
;

121625 
Fts3HashEÀm
 
	tFts3HashEÀm
;

121635 
	sFts3Hash
 {

121636 
keyCœss
;

121637 
c›yKey
;

121638 
cou¡
;

121639 
Fts3HashEÀm
 *
fú°
;

121640 
htsize
;

121641 
	s_·s3ht
 {

121642 
cou¡
;

121643 
Fts3HashEÀm
 *
chaö
;

121644 } *
ht
;

121653 
	sFts3HashEÀm
 {

121654 
Fts3HashEÀm
 *
√xt
, *
¥ev
;

121655 *
d©a
;

121656 *
pKey
; 
nKey
;

121671 
	#FTS3_HASH_STRING
 1

	)

121672 
	#FTS3_HASH_BINARY
 2

	)

121677 
SQLITE_PRIVATE
 
	`sqlôe3Fts3HashInô
(
Fts3Hash
 *
pNew
, 
keyCœss
, 
c›yKey
);

121678 
SQLITE_PRIVATE
 *
	`sqlôe3Fts3HashIn£π
(
Fts3Hash
*, c⁄° *
pKey
, 
nKey
, *
pD©a
);

121679 
SQLITE_PRIVATE
 *
	`sqlôe3Fts3HashFöd
(c⁄° 
Fts3Hash
*, c⁄° *
pKey
, 
nKey
);

121680 
SQLITE_PRIVATE
 
	`sqlôe3Fts3HashCÀ¨
(
Fts3Hash
*);

121681 
SQLITE_PRIVATE
 
Fts3HashEÀm
 *
	`sqlôe3Fts3HashFödEÀm
(c⁄° 
Fts3Hash
 *, const *, );

121686 
	#·s3HashInô
 
sqlôe3Fts3HashInô


	)

121687 
	#·s3HashIn£π
 
sqlôe3Fts3HashIn£π


	)

121688 
	#·s3HashFöd
 
sqlôe3Fts3HashFöd


	)

121689 
	#·s3HashCÀ¨
 
sqlôe3Fts3HashCÀ¨


	)

121690 
	#·s3HashFödEÀm
 
sqlôe3Fts3HashFödEÀm


	)

121704 
	#·s3HashFú°
(
H
Ë((H)->
fú°
)

	)

121705 
	#·s3HashNext
(
E
Ë((E)->
√xt
)

	)

121706 
	#·s3HashD©a
(
E
Ë((E)->
d©a
)

	)

121707 
	#·s3HashKey
(
E
Ë((E)->
pKey
)

	)

121708 
	#·s3HashKeysize
(
E
Ë((E)->
nKey
)

	)

121713 
	#·s3HashCou¡
(
H
Ë((H)->
cou¡
)

	)

121727 #i‚de‡
SQLITE_FTS3_MAX_EXPR_DEPTH


121728 
	#SQLITE_FTS3_MAX_EXPR_DEPTH
 12

	)

121737 
	#FTS3_MERGE_COUNT
 16

	)

121747 
	#FTS3_MAX_PENDING_DATA
 (1*1024*1024)

	)

121754 
	#SizeofAºay
(
X
Ë(()((X)/(X[0])))

	)

121757 #i‚de‡
MIN


121758 
	#MIN
(
x
,
y
Ë((x)<(y)?(x):(y))

	)

121760 #i‚de‡
MAX


121761 
	#MAX
(
x
,
y
Ë((x)>(y)?(x):(y))

	)

121768 
	#FTS3_VARINT_MAX
 10

	)

121785 
	#FTS3_SEGDIR_MAXLEVEL
 1024

	)

121786 
	#FTS3_SEGDIR_MAXLEVEL_STR
 "1024"

	)

121792 #i‚de‡
ã°ˇ£


121793 
	#ã°ˇ£
(
X
)

	)

121799 
	#POS_COLUMN
 (1Ë

	)

121800 
	#POS_END
 (0Ë

	)

121807 #i‚de‡
SQLITE_AMALGAMATION


121812 #ifde‡
SQLITE_COVERAGE_TEST


121813 
	#ALWAYS
(
x
Ë(1)

	)

121814 
	#NEVER
(
X
Ë(0)

	)

121816 
	#ALWAYS
(
x
Ë(x)

	)

121817 
	#NEVER
(
x
Ë(x)

	)

121823 
	tu8
;

121824 
	ti16
;

121825 
	tu32
;

121826 
sqlôe3_uöt64
 
	tu64
;

121827 
sqlôe3_öt64
 
	ti64
;

121832 
	#UNUSED_PARAMETER
(
x
Ë()(x)

	)

121837 #i‡!
	`deföed
(
NDEBUG
Ë&& !deföed(
SQLITE_DEBUG
)

121838 
	#NDEBUG
 1

	)

121846 #i‡
	`deföed
(
SQLITE_DEBUG
Ë|| deföed(
SQLITE_COVERAGE_TEST
)

121847 
	#TESTONLY
(
X
Ë
	)
X

121849 
	#TESTONLY
(
X
)

	)

121854 #ifde‡
SQLITE_DEBUG


121855 
SQLITE_PRIVATE
 
	`sqlôe3Fts3C‹ru±
();

121856 
	#FTS_CORRUPT_VTAB
 
	`sqlôe3Fts3C‹ru±
()

	)

121858 
	#FTS_CORRUPT_VTAB
 
SQLITE_CORRUPT_VTAB


	)

121861 
Fts3TabÀ
 
	tFts3TabÀ
;

121862 
Fts3Curs‹
 
	tFts3Curs‹
;

121863 
Fts3Ex¥
 
	tFts3Ex¥
;

121864 
Fts3Phø£
 
	tFts3Phø£
;

121865 
Fts3Phø£Tokí
 
	tFts3Phø£Tokí
;

121867 
Fts3Do˛i°
 
	tFts3Do˛i°
;

121868 
Fts3SegFûãr
 
	tFts3SegFûãr
;

121869 
Fts3De„ºedTokí
 
	tFts3De„ºedTokí
;

121870 
Fts3SegRódî
 
	tFts3SegRódî
;

121871 
Fts3Mu…iSegRódî
 
	tFts3Mu…iSegRódî
;

121880 
	sFts3TabÀ
 {

121881 
sqlôe3_vèb
 
ba£
;

121882 
sqlôe3
 *
db
;

121883 c⁄° *
zDb
;

121884 c⁄° *
zName
;

121885 
nCﬁumn
;

121886 **
azCﬁumn
;

121887 
u8
 *
abNŸödexed
;

121888 
sqlôe3_tokíizî
 *
pTokíizî
;

121889 *
zC⁄ã¡Tbl
;

121890 *
zL™guageid
;

121891 
u8
 
bAutoö¸mîge
;

121892 
u32
 
nLófAdd
;

121897 
sqlôe3_°mt
 *
aStmt
[37];

121899 *
zRódEx¥li°
;

121900 *
zWrôeEx¥li°
;

121902 
nNodeSize
;

121903 
u8
 
bFts4
;

121904 
u8
 
bHasSèt
;

121905 
u8
 
bHasDocsize
;

121906 
u8
 
bDescIdx
;

121907 
u8
 
bIgn‹eSavïoöt
;

121908 
nPgsz
;

121909 *
zSegmítsTbl
;

121910 
sqlôe3_blob
 *
pSegmíts
;

121929 
nIndex
;

121930 
	sFts3Index
 {

121931 
nPªfix
;

121932 
Fts3Hash
 
hPídög
;

121933 } *
aIndex
;

121934 
nMaxPídögD©a
;

121935 
nPídögD©a
;

121936 
sqlôe_öt64
 
iPªvDocid
;

121937 
iPªvL™gid
;

121939 #i‡
	`deföed
(
SQLITE_DEBUG
Ë|| deföed(
SQLITE_COVERAGE_TEST
)

121945 
öTønß˘i⁄
;

121946 
mxSavïoöt
;

121949 #ifde‡
SQLITE_TEST


121952 
bNoIn¸Do˛i°
;

121961 
	sFts3Curs‹
 {

121962 
sqlôe3_vèb_curs‹
 
ba£
;

121963 
i16
 
eSórch
;

121964 
u8
 
isEof
;

121965 
u8
 
isRequúeSìk
;

121966 
sqlôe3_°mt
 *
pStmt
;

121967 
Fts3Ex¥
 *
pEx¥
;

121968 
iL™gid
;

121969 
nPhø£
;

121970 
Fts3De„ºedTokí
 *
pDe„ºed
;

121971 
sqlôe3_öt64
 
iPªvId
;

121972 *
pNextId
;

121973 *
aDo˛i°
;

121974 
nDo˛i°
;

121975 
u8
 
bDesc
;

121976 
eEvÆmode
;

121977 
nRowAvg
;

121978 
sqlôe3_öt64
 
nDoc
;

121979 
i64
 
iMöDocid
;

121980 
i64
 
iMaxDocid
;

121981 
isM©chöfoNìded
;

121982 
u32
 *
aM©chöfo
;

121983 
nM©chöfo
;

121984 *
zM©chöfo
;

121987 
	#FTS3_EVAL_FILTER
 0

	)

121988 
	#FTS3_EVAL_NEXT
 1

	)

121989 
	#FTS3_EVAL_MATCHINFO
 2

	)

122006 
	#FTS3_FULLSCAN_SEARCH
 0

	)

122007 
	#FTS3_DOCID_SEARCH
 1

	)

122008 
	#FTS3_FULLTEXT_SEARCH
 2

	)

122016 
	#FTS3_HAVE_LANGID
 0x00010000

	)

122017 
	#FTS3_HAVE_DOCID_GE
 0x00020000

	)

122018 
	#FTS3_HAVE_DOCID_LE
 0x00040000

	)

122020 
	sFts3Do˛i°
 {

122021 *
aAŒ
;

122022 
nAŒ
;

122023 *
pNextDocid
;

122025 
sqlôe3_öt64
 
iDocid
;

122026 
bFªeLi°
;

122027 *
pLi°
;

122028 
nLi°
;

122037 
	sFts3Phø£Tokí
 {

122038 *
z
;

122039 
n
;

122040 
isPªfix
;

122041 
bFú°
;

122046 
Fts3De„ºedTokí
 *
pDe„ºed
;

122047 
Fts3Mu…iSegRódî
 *
pSegc§
;

122050 
	sFts3Phø£
 {

122052 
Fts3Do˛i°
 
do˛i°
;

122053 
bIn¸
;

122054 
iDo˛i°Tokí
;

122059 
nTokí
;

122060 
iCﬁumn
;

122061 
Fts3Phø£Tokí
 
aTokí
[1];

122085 
	sFts3Ex¥
 {

122086 
eTy≥
;

122087 
nNór
;

122088 
Fts3Ex¥
 *
pP¨ít
;

122089 
Fts3Ex¥
 *
pLe·
;

122090 
Fts3Ex¥
 *
pRight
;

122091 
Fts3Phø£
 *
pPhø£
;

122094 
sqlôe3_öt64
 
iDocid
;

122095 
u8
 
bEof
;

122096 
u8
 
bSèπ
;

122097 
u8
 
bDe„ºed
;

122099 
u32
 *
aMI
;

122113 
	#FTSQUERY_NEAR
 1

	)

122114 
	#FTSQUERY_NOT
 2

	)

122115 
	#FTSQUERY_AND
 3

	)

122116 
	#FTSQUERY_OR
 4

	)

122117 
	#FTSQUERY_PHRASE
 5

	)

122121 
SQLITE_PRIVATE
 
	`sqlôe3Fts3Upd©eMëhod
(
sqlôe3_vèb
*,,
sqlôe3_vÆue
**,
sqlôe3_öt64
*);

122122 
SQLITE_PRIVATE
 
	`sqlôe3Fts3PídögTîmsFlush
(
Fts3TabÀ
 *);

122123 
SQLITE_PRIVATE
 
	`sqlôe3Fts3PídögTîmsCÀ¨
(
Fts3TabÀ
 *);

122124 
SQLITE_PRIVATE
 
	`sqlôe3Fts3O±imize
(
Fts3TabÀ
 *);

122125 
SQLITE_PRIVATE
 
	`sqlôe3Fts3SegRódîNew
(, , 
sqlôe3_öt64
,

122126 
sqlôe3_öt64
, sqlôe3_öt64, c⁄° *, , 
Fts3SegRódî
**);

122127 
SQLITE_PRIVATE
 
	`sqlôe3Fts3SegRódîPídög
(

122128 
Fts3TabÀ
*,,c⁄° *,,,
Fts3SegRódî
**);

122129 
SQLITE_PRIVATE
 
	`sqlôe3Fts3SegRódîFªe
(
Fts3SegRódî
 *);

122130 
SQLITE_PRIVATE
 
	`sqlôe3Fts3AŒSegdús
(
Fts3TabÀ
*, , , , 
sqlôe3_°mt
 **);

122131 
SQLITE_PRIVATE
 
	`sqlôe3Fts3RódBlock
(
Fts3TabÀ
*, 
sqlôe3_öt64
, **, *, *);

122133 
SQLITE_PRIVATE
 
	`sqlôe3Fts3Sñe˘Do˘ŸÆ
(
Fts3TabÀ
 *, 
sqlôe3_°mt
 **);

122134 
SQLITE_PRIVATE
 
	`sqlôe3Fts3Sñe˘Docsize
(
Fts3TabÀ
 *, 
sqlôe3_öt64
, 
sqlôe3_°mt
 **);

122136 #i‚de‡
SQLITE_DISABLE_FTS4_DEFERRED


122137 
SQLITE_PRIVATE
 
	`sqlôe3Fts3FªeDe„ºedTokís
(
Fts3Curs‹
 *);

122138 
SQLITE_PRIVATE
 
	`sqlôe3Fts3De„rTokí
(
Fts3Curs‹
 *, 
Fts3Phø£Tokí
 *, );

122139 
SQLITE_PRIVATE
 
	`sqlôe3Fts3CacheDe„ºedDo˛i°s
(
Fts3Curs‹
 *);

122140 
SQLITE_PRIVATE
 
	`sqlôe3Fts3FªeDe„ºedDo˛i°s
(
Fts3Curs‹
 *);

122141 
SQLITE_PRIVATE
 
	`sqlôe3Fts3De„ºedTokíLi°
(
Fts3De„ºedTokí
 *, **, *);

122143 
	#sqlôe3Fts3FªeDe„ºedTokís
(
x
)

	)

122144 
	#sqlôe3Fts3De„rTokí
(
x
,
y
,
z
Ë
SQLITE_OK


	)

122145 
	#sqlôe3Fts3CacheDe„ºedDo˛i°s
(
x
Ë
SQLITE_OK


	)

122146 
	#sqlôe3Fts3FªeDe„ºedDo˛i°s
(
x
)

	)

122147 
	#sqlôe3Fts3De„ºedTokíLi°
(
x
,
y
,
z
Ë
SQLITE_OK


	)

122150 
SQLITE_PRIVATE
 
	`sqlôe3Fts3SegmítsClo£
(
Fts3TabÀ
 *);

122151 
SQLITE_PRIVATE
 
	`sqlôe3Fts3MaxLevñ
(
Fts3TabÀ
 *, *);

122154 
	#FTS3_SEGCURSOR_PENDING
 -1

	)

122155 
	#FTS3_SEGCURSOR_ALL
 -2

	)

122157 
SQLITE_PRIVATE
 
	`sqlôe3Fts3SegRódîSèπ
(
Fts3TabÀ
*, 
Fts3Mu…iSegRódî
*, 
Fts3SegFûãr
*);

122158 
SQLITE_PRIVATE
 
	`sqlôe3Fts3SegRódîSãp
(
Fts3TabÀ
 *, 
Fts3Mu…iSegRódî
 *);

122159 
SQLITE_PRIVATE
 
	`sqlôe3Fts3SegRódîFöish
(
Fts3Mu…iSegRódî
 *);

122161 
SQLITE_PRIVATE
 
	`sqlôe3Fts3SegRódîCurs‹
(
Fts3TabÀ
 *,

122162 , , , c⁄° *, , , , 
Fts3Mu…iSegRódî
 *);

122165 
	#FTS3_SEGMENT_REQUIRE_POS
 0x00000001

	)

122166 
	#FTS3_SEGMENT_IGNORE_EMPTY
 0x00000002

	)

122167 
	#FTS3_SEGMENT_COLUMN_FILTER
 0x00000004

	)

122168 
	#FTS3_SEGMENT_PREFIX
 0x00000008

	)

122169 
	#FTS3_SEGMENT_SCAN
 0x00000010

	)

122170 
	#FTS3_SEGMENT_FIRST
 0x00000020

	)

122173 
	sFts3SegFûãr
 {

122174 c⁄° *
zTîm
;

122175 
nTîm
;

122176 
iCﬁ
;

122177 
Êags
;

122180 
	sFts3Mu…iSegRódî
 {

122182 
Fts3SegRódî
 **
≠Segmít
;

122183 
nSegmít
;

122184 
nAdv™˚
;

122185 
Fts3SegFûãr
 *
pFûãr
;

122186 *
aBuf„r
;

122187 
nBuf„r
;

122189 
iCﬁFûãr
;

122190 
bRe°¨t
;

122193 
nCo°
;

122194 
bLookup
;

122197 *
zTîm
;

122198 
nTîm
;

122199 *
aDo˛i°
;

122200 
nDo˛i°
;

122203 
SQLITE_PRIVATE
 
	`sqlôe3Fts3In¸mîge
(
Fts3TabÀ
*,,);

122206 
SQLITE_PRIVATE
 
	`sqlôe3Fts3PutV¨öt
(*, 
sqlôe3_öt64
);

122207 
SQLITE_PRIVATE
 
	`sqlôe3Fts3GëV¨öt
(c⁄° *, 
sqlôe_öt64
 *);

122208 
SQLITE_PRIVATE
 
	`sqlôe3Fts3GëV¨öt32
(const *, *);

122209 
SQLITE_PRIVATE
 
	`sqlôe3Fts3V¨ötLí
(
sqlôe3_uöt64
);

122210 
SQLITE_PRIVATE
 
	`sqlôe3Fts3DequŸe
(*);

122211 
SQLITE_PRIVATE
 
	`sqlôe3Fts3Do˛i°Pªv
(,*,,**,
sqlôe3_öt64
*,*,
u8
*);

122212 
SQLITE_PRIVATE
 
	`sqlôe3Fts3EvÆPhø£Sèts
(
Fts3Curs‹
 *, 
Fts3Ex¥
 *, 
u32
 *);

122213 
SQLITE_PRIVATE
 
	`sqlôe3Fts3Fú°Fûãr
(
sqlôe3_öt64
, *, , *);

122214 
SQLITE_PRIVATE
 
	`sqlôe3Fts3Cª©eSètTabÀ
(*, 
Fts3TabÀ
*);

122217 
SQLITE_PRIVATE
 c⁄° *
	`sqlôe3Fts3NextTokí
(const *, *);

122218 
SQLITE_PRIVATE
 
	`sqlôe3Fts3InôHashTabÀ
(
sqlôe3
 *, 
Fts3Hash
 *, const *);

122219 
SQLITE_PRIVATE
 
	`sqlôe3Fts3InôTokíizî
(
Fts3Hash
 *
pHash
, const *,

122220 
sqlôe3_tokíizî
 **, **

122222 
SQLITE_PRIVATE
 
	`sqlôe3Fts3IsIdCh¨
();

122225 
SQLITE_PRIVATE
 
	`sqlôe3Fts3Off£ts
(
sqlôe3_c⁄ãxt
*, 
Fts3Curs‹
*);

122226 
SQLITE_PRIVATE
 
	`sqlôe3Fts3Snù≥t
(
sqlôe3_c⁄ãxt
 *, 
Fts3Curs‹
 *, const *,

122229 
SQLITE_PRIVATE
 
	`sqlôe3Fts3M©chöfo
(
sqlôe3_c⁄ãxt
 *, 
Fts3Curs‹
 *, const *);

122232 
SQLITE_PRIVATE
 
	`sqlôe3Fts3Ex¥P¨£
(
sqlôe3_tokíizî
 *, ,

122233 **, , , , c⁄° *, , 
Fts3Ex¥
 **, **

122235 
SQLITE_PRIVATE
 
	`sqlôe3Fts3Ex¥Fªe
(
Fts3Ex¥
 *);

122236 #ifde‡
SQLITE_TEST


122237 
SQLITE_PRIVATE
 
	`sqlôe3Fts3Ex¥InôTe°I¡îÁ˚
(
sqlôe3
 *
db
);

122238 
SQLITE_PRIVATE
 
	`sqlôe3Fts3InôTîm
(
sqlôe3
 *
db
);

122241 
SQLITE_PRIVATE
 
	`sqlôe3Fts3O≥nTokíizî
(
sqlôe3_tokíizî
 *, , const *, ,

122242 
sqlôe3_tokíizî_curs‹
 **

122246 
SQLITE_PRIVATE
 
	`sqlôe3Fts3InôAux
(
sqlôe3
 *
db
);

122248 
SQLITE_PRIVATE
 
	`sqlôe3Fts3EvÆPhø£CÀ™up
(
Fts3Phø£
 *);

122250 
SQLITE_PRIVATE
 
	`sqlôe3Fts3M§In¸Sèπ
(

122251 
Fts3TabÀ
*, 
Fts3Mu…iSegRódî
*, , const *, );

122252 
SQLITE_PRIVATE
 
	`sqlôe3Fts3M§In¸Next
(

122253 
Fts3TabÀ
 *, 
Fts3Mu…iSegRódî
 *, 
sqlôe3_öt64
 *, **, *);

122254 
SQLITE_PRIVATE
 
	`sqlôe3Fts3EvÆPhø£Po¶i°
(
Fts3Curs‹
 *, 
Fts3Ex¥
 *, 
iCﬁ
, **);

122255 
SQLITE_PRIVATE
 
	`sqlôe3Fts3M§OvÊ
(
Fts3Curs‹
 *, 
Fts3Mu…iSegRódî
 *, *);

122256 
SQLITE_PRIVATE
 
	`sqlôe3Fts3M§In¸Re°¨t
(
Fts3Mu…iSegRódî
 *
pC§
);

122259 
SQLITE_PRIVATE
 
	`sqlôe3Fts3InôTok
(
sqlôe3
*, 
Fts3Hash
 *);

122262 #ifde‡
SQLITE_ENABLE_FTS4_UNICODE61


122263 
SQLITE_PRIVATE
 
	`sqlôe3FtsUnicodeFﬁd
(, );

122264 
SQLITE_PRIVATE
 
	`sqlôe3FtsUnicodeIß um
();

122265 
SQLITE_PRIVATE
 
	`sqlôe3FtsUnicodeIsdü¸ôic
();

122273 #i‡!
	`deföed
(
SQLITE_CORE
Ë|| deföed(
SQLITE_ENABLE_FTS3
)

122275 #i‡
	`deföed
(
SQLITE_ENABLE_FTS3
Ë&& !deföed(
SQLITE_CORE
)

122276 
	#SQLITE_CORE
 1

	)

122286 #i‚de‡
SQLITE_CORE


122287 
SQLITE_EXTENSION_INIT1


122290 
	`·s3EvÆNext
(
Fts3Curs‹
 *
pC§
);

122291 
	`·s3EvÆSèπ
(
Fts3Curs‹
 *
pC§
);

122292 
	`·s3TîmSegRódîCurs‹
(

122293 
Fts3Curs‹
 *, c⁄° *, , , 
Fts3Mu…iSegRódî
 **);

122300 
SQLITE_PRIVATE
 
	`sqlôe3Fts3PutV¨öt
(*
p
, 
sqlôe_öt64
 
v
){

122301 *
q
 = (*Ë
p
;

122302 
sqlôe_uöt64
 
vu
 = 
v
;

122304 *
q
++ = (Ë((
vu
 & 0x7f) | 0x80);

122305 
vu
 >>= 7;

122306 } 
vu
!=0 );

122307 
q
[-1] &= 0x7f;

122308 
	`as£π
–
q
 - (*)
p
 <
FTS3_VARINT_MAX
 );

122309  (Ë(
q
 - (*)
p
);

122317 
SQLITE_PRIVATE
 
	`sqlôe3Fts3GëV¨öt
(c⁄° *
p
, 
sqlôe_öt64
 *
v
){

122318 c⁄° *
q
 = (c⁄° *Ë
p
;

122319 
sqlôe_uöt64
 
x
 = 0, 
y
 = 1;

122320  (*
q
&0x80)==0x80 && q-(*)
p
<
FTS3_VARINT_MAX
 ){

122321 
x
 +
y
 * (*
q
++ & 0x7f);

122322 
y
 <<= 7;

122324 
x
 +
y
 * (*
q
++);

122325 *
v
 = (
sqlôe_öt64
Ë
x
;

122326  (Ë(
q
 - (*)
p
);

122333 
SQLITE_PRIVATE
 
	`sqlôe3Fts3GëV¨öt32
(c⁄° *
p
, *
pi
){

122334 
sqlôe_öt64
 
i
;

122335 
ªt
 = 
	`sqlôe3Fts3GëV¨öt
(
p
, &
i
);

122336 *
pi
 = (Ë
i
;

122337  
ªt
;

122343 
SQLITE_PRIVATE
 
	`sqlôe3Fts3V¨ötLí
(
sqlôe3_uöt64
 
v
){

122344 
i
 = 0;

122346 
i
++;

122347 
v
 >>= 7;

122348 } 
v
!=0 );

122349  
i
;

122366 
SQLITE_PRIVATE
 
	`sqlôe3Fts3DequŸe
(*
z
){

122367 
quŸe
;

122369 
quŸe
 = 
z
[0];

122370 if–
quŸe
=='[' || quote=='\'' || quote=='"' || quote=='`' ){

122371 
iIn
 = 1;

122372 
iOut
 = 0;

122375 if–
quŸe
=='[' ) quote = ']';

122377  
	`ALWAYS
(
z
[
iIn
]) ){

122378 if–
z
[
iIn
]==
quŸe
 ){

122379 if–
z
[
iIn
+1]!=
quŸe
 ) ;

122380 
z
[
iOut
++] = 
quŸe
;

122381 
iIn
 += 2;

122383 
z
[
iOut
++] = z[
iIn
++];

122386 
z
[
iOut
] = '\0';

122395 
	`·s3GëDñèV¨öt
(**
µ
, 
sqlôe3_öt64
 *
pVÆ
){

122396 
sqlôe3_öt64
 
iVÆ
;

122397 *
µ
 +
	`sqlôe3Fts3GëV¨öt
(*µ, &
iVÆ
);

122398 *
pVÆ
 +
iVÆ
;

122410 
	`·s3GëRevî£V¨öt
(

122411 **
µ
,

122412 *
pSèπ
,

122413 
sqlôe3_öt64
 *
pVÆ


122415 
sqlôe3_öt64
 
iVÆ
;

122416 *
p
;

122421 
p
 = (*
µ
)-2;Ö>=
pSèπ
 && *p&0x80;Ö--);

122422 
p
++;

122423 *
µ
 = 
p
;

122425 
	`sqlôe3Fts3GëV¨öt
(
p
, &
iVÆ
);

122426 *
pVÆ
 = 
iVÆ
;

122432 
	`·s3Disc⁄√˘Mëhod
(
sqlôe3_vèb
 *
pVèb
){

122433 
Fts3TabÀ
 *
p
 = (Fts3TabÀ *)
pVèb
;

122434 
i
;

122436 
	`as£π
–
p
->
nPídögD©a
==0 );

122437 
	`as£π
–
p
->
pSegmíts
==0 );

122440 
i
=0; i<
	`SizeofAºay
(
p
->
aStmt
); i++){

122441 
	`sqlôe3_föÆize
(
p
->
aStmt
[
i
]);

122443 
	`sqlôe3_‰ì
(
p
->
zSegmítsTbl
);

122444 
	`sqlôe3_‰ì
(
p
->
zRódEx¥li°
);

122445 
	`sqlôe3_‰ì
(
p
->
zWrôeEx¥li°
);

122446 
	`sqlôe3_‰ì
(
p
->
zC⁄ã¡Tbl
);

122447 
	`sqlôe3_‰ì
(
p
->
zL™guageid
);

122450 
p
->
pTokíizî
->
pModuÀ
->
	`xDe°roy
(p->pTokenizer);

122452 
	`sqlôe3_‰ì
(
p
);

122453  
SQLITE_OK
;

122463 
	`·s3DbExec
(

122464 *
pRc
,

122465 
sqlôe3
 *
db
,

122466 c⁄° *
zF‹m©
,

122469 
va_li°
 
≠
;

122470 *
zSql
;

122471 if–*
pRc
 ) ;

122472 
	`va_°¨t
(
≠
, 
zF‹m©
);

122473 
zSql
 = 
	`sqlôe3_vm¥ötf
(
zF‹m©
, 
≠
);

122474 
	`va_íd
(
≠
);

122475 if–
zSql
==0 ){

122476 *
pRc
 = 
SQLITE_NOMEM
;

122478 *
pRc
 = 
	`sqlôe3_exec
(
db
, 
zSql
, 0, 0, 0);

122479 
	`sqlôe3_‰ì
(
zSql
);

122486 
	`·s3De°royMëhod
(
sqlôe3_vèb
 *
pVèb
){

122487 
Fts3TabÀ
 *
p
 = (Fts3TabÀ *)
pVèb
;

122488 
rc
 = 
SQLITE_OK
;

122489 c⁄° *
zDb
 = 
p
->zDb;

122490 
sqlôe3
 *
db
 = 
p
->db;

122493 if–
p
->
zC⁄ã¡Tbl
==0 ){

122494 
	`·s3DbExec
(&
rc
, 
db
, "DROP TABLE IF EXISTS %Q.'%q_c⁄ã¡'", 
zDb
, 
p
->
zName
);

122496 
	`·s3DbExec
(&
rc
, 
db
, "DROP TABLE IF EXISTS %Q.'%q_£gmíts'", 
zDb
,
p
->
zName
);

122497 
	`·s3DbExec
(&
rc
, 
db
, "DROP TABLE IF EXISTS %Q.'%q_£gdú'", 
zDb
, 
p
->
zName
);

122498 
	`·s3DbExec
(&
rc
, 
db
, "DROP TABLE IF EXISTS %Q.'%q_docsize'", 
zDb
, 
p
->
zName
);

122499 
	`·s3DbExec
(&
rc
, 
db
, "DROP TABLE IF EXISTS %Q.'%q_°©'", 
zDb
, 
p
->
zName
);

122505  (
rc
==
SQLITE_OK
 ? 
	`·s3Disc⁄√˘Mëhod
(
pVèb
) :Ñc);

122518 
	`·s3De˛¨eVèb
(*
pRc
, 
Fts3TabÀ
 *
p
){

122519 if–*
pRc
==
SQLITE_OK
 ){

122520 
i
;

122521 
rc
;

122522 *
zSql
;

122523 *
zCﬁs
;

122524 c⁄° *
zL™guageid
;

122526 
zL™guageid
 = (
p
->zLanguageid ?Ö->zLanguageid : "__langid");

122527 
	`sqlôe3_vèb_c⁄fig
(
p
->
db
, 
SQLITE_VTAB_CONSTRAINT_SUPPORT
, 1);

122530 
zCﬁs
 = 
	`sqlôe3_m¥ötf
("%Q, ", 
p
->
azCﬁumn
[0]);

122531 
i
=1; 
zCﬁs
 && i<
p
->
nCﬁumn
; i++){

122532 
zCﬁs
 = 
	`sqlôe3_m¥ötf
("%z%Q, ", zCﬁs, 
p
->
azCﬁumn
[
i
]);

122536 
zSql
 = 
	`sqlôe3_m¥ötf
(

122538 
zCﬁs
, 
p
->
zName
, 
zL™guageid


122540 if–!
zCﬁs
 || !
zSql
 ){

122541 
rc
 = 
SQLITE_NOMEM
;

122543 
rc
 = 
	`sqlôe3_de˛¨e_vèb
(
p
->
db
, 
zSql
);

122546 
	`sqlôe3_‰ì
(
zSql
);

122547 
	`sqlôe3_‰ì
(
zCﬁs
);

122548 *
pRc
 = 
rc
;

122555 
SQLITE_PRIVATE
 
	`sqlôe3Fts3Cª©eSètTabÀ
(*
pRc
, 
Fts3TabÀ
 *
p
){

122556 
	`·s3DbExec
(
pRc
, 
p
->
db
,

122559 
p
->
zDb
,Ö->
zName


122561 if–(*
pRc
)==
SQLITE_OK
 ) 
p
->
bHasSèt
 = 1;

122573 
	`·s3Cª©eTabÀs
(
Fts3TabÀ
 *
p
){

122574 
rc
 = 
SQLITE_OK
;

122575 
i
;

122576 
sqlôe3
 *
db
 = 
p
->db;

122578 if–
p
->
zC⁄ã¡Tbl
==0 ){

122579 c⁄° *
zL™guageid
 = 
p
->zLanguageid;

122580 *
zC⁄ã¡Cﬁs
;

122583 
zC⁄ã¡Cﬁs
 = 
	`sqlôe3_m¥ötf
("docid INTEGER PRIMARY KEY");

122584 
i
=0; 
zC⁄ã¡Cﬁs
 && i<
p
->
nCﬁumn
; i++){

122585 *
z
 = 
p
->
azCﬁumn
[
i
];

122586 
zC⁄ã¡Cﬁs
 = 
	`sqlôe3_m¥ötf
("%z, 'c%d%q'", zC⁄ã¡Cﬁs, 
i
, 
z
);

122588 if–
zL™guageid
 && 
zC⁄ã¡Cﬁs
 ){

122589 
zC⁄ã¡Cﬁs
 = 
	`sqlôe3_m¥ötf
("%z,Ü™gid", zC⁄ã¡Cﬁs, 
zL™guageid
);

122591 if–
zC⁄ã¡Cﬁs
==0 ) 
rc
 = 
SQLITE_NOMEM
;

122594 
	`·s3DbExec
(&
rc
, 
db
,

122596 
p
->
zDb
,Ö->
zName
, 
zC⁄ã¡Cﬁs


122598 
	`sqlôe3_‰ì
(
zC⁄ã¡Cﬁs
);

122602 
	`·s3DbExec
(&
rc
, 
db
,

122604 
p
->
zDb
,Ö->
zName


122606 
	`·s3DbExec
(&
rc
, 
db
,

122616 
p
->
zDb
,Ö->
zName


122618 if–
p
->
bHasDocsize
 ){

122619 
	`·s3DbExec
(&
rc
, 
db
,

122621 
p
->
zDb
,Ö->
zName


122624 
	`as£π
–
p
->
bHasSèt
=ı->
bFts4
 );

122625 if–
p
->
bHasSèt
 ){

122626 
	`sqlôe3Fts3Cª©eSètTabÀ
(&
rc
, 
p
);

122628  
rc
;

122638 
	`·s3D©aba£PageSize
(*
pRc
, 
Fts3TabÀ
 *
p
){

122639 if–*
pRc
==
SQLITE_OK
 ){

122640 
rc
;

122641 *
zSql
;

122642 
sqlôe3_°mt
 *
pStmt
;

122644 
zSql
 = 
	`sqlôe3_m¥ötf
("PRAGMA %Q.∑ge_size", 
p
->
zDb
);

122645 if–!
zSql
 ){

122646 
rc
 = 
SQLITE_NOMEM
;

122648 
rc
 = 
	`sqlôe3_¥ï¨e
(
p
->
db
, 
zSql
, -1, &
pStmt
, 0);

122649 if–
rc
==
SQLITE_OK
 ){

122650 
	`sqlôe3_°ï
(
pStmt
);

122651 
p
->
nPgsz
 = 
	`sqlôe3_cﬁumn_öt
(
pStmt
, 0);

122652 
rc
 = 
	`sqlôe3_föÆize
(
pStmt
);

122653 }if–
rc
==
SQLITE_AUTH
 ){

122654 
p
->
nPgsz
 = 1024;

122655 
rc
 = 
SQLITE_OK
;

122658 
	`as£π
–
p
->
nPgsz
>0 || 
rc
!=
SQLITE_OK
 );

122659 
	`sqlôe3_‰ì
(
zSql
);

122660 *
pRc
 = 
rc
;

122672 
	`·s3IsS≥cülCﬁumn
(

122673 c⁄° *
z
,

122674 *
≤Key
,

122675 **
pzVÆue


122677 *
zVÆue
;

122678 c⁄° *
zC§
 = 
z
;

122680  *
zC§
!='=' ){

122681 if–*
zC§
=='\0' )  0;

122682 
zC§
++;

122685 *
≤Key
 = ()(
zC§
-
z
);

122686 
zVÆue
 = 
	`sqlôe3_m¥ötf
("%s", &
zC§
[1]);

122687 if–
zVÆue
 ){

122688 
	`sqlôe3Fts3DequŸe
(
zVÆue
);

122690 *
pzVÆue
 = 
zVÆue
;

122697 
	`·s3Aµídf
(

122698 *
pRc
,

122699 **
pz
,

122700 c⁄° *
zF‹m©
,

122703 if–*
pRc
==
SQLITE_OK
 ){

122704 
va_li°
 
≠
;

122705 *
z
;

122706 
	`va_°¨t
(
≠
, 
zF‹m©
);

122707 
z
 = 
	`sqlôe3_vm¥ötf
(
zF‹m©
, 
≠
);

122708 
	`va_íd
(
≠
);

122709 if–
z
 && *
pz
 ){

122710 *
z2
 = 
	`sqlôe3_m¥ötf
("%s%s", *
pz
, 
z
);

122711 
	`sqlôe3_‰ì
(
z
);

122712 
z
 = 
z2
;

122714 if–
z
==0 ) *
pRc
 = 
SQLITE_NOMEM
;

122715 
	`sqlôe3_‰ì
(*
pz
);

122716 *
pz
 = 
z
;

122730 *
	`·s3QuŸeId
(c⁄° *
zI≈ut
){

122731 
nRë
;

122732 *
zRë
;

122733 
nRë
 = 2 + ()
	`°æí
(
zI≈ut
)*2 + 1;

122734 
zRë
 = 
	`sqlôe3_mÆloc
(
nRë
);

122735 if–
zRë
 ){

122736 
i
;

122737 *
z
 = 
zRë
;

122738 *(
z
++) = '"';

122739 
i
=0; 
zI≈ut
[i]; i++){

122740 if–
zI≈ut
[
i
]=='"' ) *(
z
++) = '"';

122741 *(
z
++Ë
zI≈ut
[
i
];

122743 *(
z
++) = '"';

122744 *(
z
++) = '\0';

122746  
zRë
;

122772 *
	`·s3RódEx¥Li°
(
Fts3TabÀ
 *
p
, c⁄° *
zFunc
, *
pRc
){

122773 *
zRë
 = 0;

122774 *
zFªe
 = 0;

122775 *
zFun˘i⁄
;

122776 
i
;

122778 if–
p
->
zC⁄ã¡Tbl
==0 ){

122779 if–!
zFunc
 ){

122780 
zFun˘i⁄
 = "";

122782 
zFªe
 = 
zFun˘i⁄
 = 
	`·s3QuŸeId
(
zFunc
);

122784 
	`·s3Aµídf
(
pRc
, &
zRë
, "docid");

122785 
i
=0; i<
p
->
nCﬁumn
; i++){

122786 
	`·s3Aµídf
(
pRc
, &
zRë
, ",%s(x.'c%d%q')", 
zFun˘i⁄
, 
i
, 
p
->
azCﬁumn
[i]);

122788 if–
p
->
zL™guageid
 ){

122789 
	`·s3Aµídf
(
pRc
, &
zRë
, ", x.%Q", "langid");

122791 
	`sqlôe3_‰ì
(
zFªe
);

122793 
	`·s3Aµídf
(
pRc
, &
zRë
, "rowid");

122794 
i
=0; i<
p
->
nCﬁumn
; i++){

122795 
	`·s3Aµídf
(
pRc
, &
zRë
, ", x.'%q'", 
p
->
azCﬁumn
[
i
]);

122797 if–
p
->
zL™guageid
 ){

122798 
	`·s3Aµídf
(
pRc
, &
zRë
, ", x.%Q", 
p
->
zL™guageid
);

122801 
	`·s3Aµídf
(
pRc
, &
zRë
, " FROM '%q'.'%q%s' AS x",

122802 
p
->
zDb
,

122803 (
p
->
zC⁄ã¡Tbl
 ?Ö->zC⁄ã¡Tb»:Ö->
zName
),

122804 (
p
->
zC⁄ã¡Tbl
 ? "" : "_content")

122806  
zRë
;

122829 *
	`·s3WrôeEx¥Li°
(
Fts3TabÀ
 *
p
, c⁄° *
zFunc
, *
pRc
){

122830 *
zRë
 = 0;

122831 *
zFªe
 = 0;

122832 *
zFun˘i⁄
;

122833 
i
;

122835 if–!
zFunc
 ){

122836 
zFun˘i⁄
 = "";

122838 
zFªe
 = 
zFun˘i⁄
 = 
	`·s3QuŸeId
(
zFunc
);

122840 
	`·s3Aµídf
(
pRc
, &
zRë
, "?");

122841 
i
=0; i<
p
->
nCﬁumn
; i++){

122842 
	`·s3Aµídf
(
pRc
, &
zRë
, ",%s(?)", 
zFun˘i⁄
);

122844 if–
p
->
zL™guageid
 ){

122845 
	`·s3Aµídf
(
pRc
, &
zRë
, ", ?");

122847 
	`sqlôe3_‰ì
(
zFªe
);

122848  
zRë
;

122864 
	`·s3GobbÀI¡
(c⁄° **
µ
, *
≤Out
){

122865 c⁄° *
p
;

122866 
nI¡
 = 0;

122868 
p
=*
µ
;Ö[0]>='0' &&Ö[0]<='9';Ö++){

122869 
nI¡
 =ÇI¡ * 10 + (
p
[0] - '0');

122871 if–
p
==*
µ
 )  
SQLITE_ERROR
;

122872 *
≤Out
 = 
nI¡
;

122873 *
µ
 = 
p
;

122874  
SQLITE_OK
;

122894 
	`·s3PªfixP¨amëî
(

122895 c⁄° *
zP¨am
,

122896 *
≤Index
,

122897 
Fts3Index
 **
≠Index


122899 
Fts3Index
 *
aIndex
;

122900 
nIndex
 = 1;

122902 if–
zP¨am
 && zParam[0] ){

122903 c⁄° *
p
;

122904 
nIndex
++;

122905 
p
=
zP¨am
; *p;Ö++){

122906 if–*
p
==',' ) 
nIndex
++;

122910 
aIndex
 = 
	`sqlôe3_mÆloc
((
Fts3Index
Ë* 
nIndex
);

122911 *
≠Index
 = 
aIndex
;

122912 *
≤Index
 = 
nIndex
;

122913 if–!
aIndex
 ){

122914  
SQLITE_NOMEM
;

122917 
	`mem£t
(
aIndex
, 0, (
Fts3Index
Ë* 
nIndex
);

122918 if–
zP¨am
 ){

122919 c⁄° *
p
 = 
zP¨am
;

122920 
i
;

122921 
i
=1; i<
nIndex
; i++){

122922 
nPªfix
;

122923 if–
	`·s3GobbÀI¡
(&
p
, &
nPªfix
ËË 
SQLITE_ERROR
;

122924 
aIndex
[
i
].
nPªfix
 =ÇPrefix;

122925 
p
++;

122929  
SQLITE_OK
;

122957 
	`·s3C⁄ã¡Cﬁumns
(

122958 
sqlôe3
 *
db
,

122959 c⁄° *
zDb
,

122960 c⁄° *
zTbl
,

122961 c⁄° ***
∑zCﬁ
,

122962 *
≤Cﬁ
,

122963 *
≤Så


122965 
rc
 = 
SQLITE_OK
;

122966 *
zSql
;

122967 
sqlôe3_°mt
 *
pStmt
 = 0;

122969 
zSql
 = 
	`sqlôe3_m¥ötf
("SELECT * FROM %Q.%Q", 
zDb
, 
zTbl
);

122970 if–!
zSql
 ){

122971 
rc
 = 
SQLITE_NOMEM
;

122973 
rc
 = 
	`sqlôe3_¥ï¨e
(
db
, 
zSql
, -1, &
pStmt
, 0);

122975 
	`sqlôe3_‰ì
(
zSql
);

122977 if–
rc
==
SQLITE_OK
 ){

122978 c⁄° **
azCﬁ
;

122979 
nSå
 = 0;

122980 
nCﬁ
;

122981 
i
;

122986 
nCﬁ
 = 
	`sqlôe3_cﬁumn_cou¡
(
pStmt
);

122987 
i
=0; i<
nCﬁ
; i++){

122988 c⁄° *
zCﬁ
 = 
	`sqlôe3_cﬁumn_«me
(
pStmt
, 
i
);

122989 
nSå
 +()
	`°æí
(
zCﬁ
) + 1;

122993 
azCﬁ
 = (c⁄° **)
	`sqlôe3_mÆloc
((*Ë* 
nCﬁ
 + 
nSå
);

122994 if–
azCﬁ
==0 ){

122995 
rc
 = 
SQLITE_NOMEM
;

122997 *
p
 = (*)&
azCﬁ
[
nCﬁ
];

122998 
i
=0; i<
nCﬁ
; i++){

122999 c⁄° *
zCﬁ
 = 
	`sqlôe3_cﬁumn_«me
(
pStmt
, 
i
);

123000 
n
 = ()
	`°æí
(
zCﬁ
)+1;

123001 
	`mem˝y
(
p
, 
zCﬁ
, 
n
);

123002 
azCﬁ
[
i
] = 
p
;

123003 
p
 +
n
;

123006 
	`sqlôe3_föÆize
(
pStmt
);

123009 *
≤Cﬁ
 = 
nCﬁ
;

123010 *
≤Så
 = 
nSå
;

123011 *
∑zCﬁ
 = 
azCﬁ
;

123014  
rc
;

123028 
	`·s3InôVèb
(

123029 
isCª©e
,

123030 
sqlôe3
 *
db
,

123031 *
pAux
,

123032 
¨gc
,

123033 c⁄° * c⁄° *
¨gv
,

123034 
sqlôe3_vèb
 **
µVTab
,

123035 **
pzEº


123037 
Fts3Hash
 *
pHash
 = (Fts3Hash *)
pAux
;

123038 
Fts3TabÀ
 *
p
 = 0;

123039 
rc
 = 
SQLITE_OK
;

123040 
i
;

123041 
nByã
;

123042 
iCﬁ
;

123043 
nSåög
 = 0;

123044 
nCﬁ
 = 0;

123045 *
zC§
;

123046 
nDb
;

123047 
nName
;

123048 
isFts4
 = (
¨gv
[0][3]=='4');

123049 c⁄° **
aCﬁ
;

123050 
sqlôe3_tokíizî
 *
pTokíizî
 = 0;

123052 
nIndex
;

123053 
Fts3Index
 *
aIndex
 = 0;

123056 
bNoDocsize
 = 0;

123057 
bDescIdx
 = 0;

123058 *
zPªfix
 = 0;

123059 *
zCom¥ess
 = 0;

123060 *
zUncom¥ess
 = 0;

123061 *
zC⁄ã¡
 = 0;

123062 *
zL™guageid
 = 0;

123063 **
azNŸödexed
 = 0;

123064 
nNŸödexed
 = 0;

123066 
	`as£π
–
	`°æí
(
¨gv
[0])==4 );

123067 
	`as£π
–(
	`sqlôe3_°∫icmp
(
¨gv
[0], "·s4", 4)==0 && 
isFts4
)

123068 || (
	`sqlôe3_°∫icmp
(
¨gv
[0], "·s3", 4)==0 && !
isFts4
)

123071 
nDb
 = ()
	`°æí
(
¨gv
[1]) + 1;

123072 
nName
 = ()
	`°æí
(
¨gv
[2]) + 1;

123074 
nByã
 = (c⁄° *Ë* (
¨gc
-2);

123075 
aCﬁ
 = (c⁄° **)
	`sqlôe3_mÆloc
(
nByã
);

123076 if–
aCﬁ
 ){

123077 
	`mem£t
((*)
aCﬁ
, 0, 
nByã
);

123078 
azNŸödexed
 = (**)
	`sqlôe3_mÆloc
(
nByã
);

123080 if–
azNŸödexed
 ){

123081 
	`mem£t
(
azNŸödexed
, 0, 
nByã
);

123083 if–!
aCﬁ
 || !
azNŸödexed
 ){

123084 
rc
 = 
SQLITE_NOMEM
;

123085 
·s3_öô_out
;

123099 
i
=3; 
rc
==
SQLITE_OK
 && i<
¨gc
; i++){

123100 c⁄° *
z
 = 
¨gv
[
i
];

123101 
nKey
;

123102 *
zVÆ
;

123105 if–!
pTokíizî


123106 && 
	`°æí
(
z
)>8

123107 && 0==
	`sqlôe3_°∫icmp
(
z
, "tokenize", 8)

123108 && 0==
	`sqlôe3Fts3IsIdCh¨
(
z
[8])

123110 
rc
 = 
	`sqlôe3Fts3InôTokíizî
(
pHash
, &
z
[9], &
pTokíizî
, 
pzEº
);

123114 if–
isFts4
 && 
	`·s3IsS≥cülCﬁumn
(
z
, &
nKey
, &
zVÆ
) ){

123115 
	sFts4O±i⁄
 {

123116 c⁄° *
zO±
;

123117 
nO±
;

123118 } 
aFts4O±
[] = {

123129 
iO±
;

123130 if–!
zVÆ
 ){

123131 
rc
 = 
SQLITE_NOMEM
;

123133 
iO±
=0; iO±<
	`SizeofAºay
(
aFts4O±
); iOpt++){

123134 
Fts4O±i⁄
 *
pOp
 = &
aFts4O±
[
iO±
];

123135 if–
nKey
==
pOp
->
nO±
 && !
	`sqlôe3_°∫icmp
(
z
,ÖOp->
zO±
,ÖOp->nOpt) ){

123139 if–
iO±
==
	`SizeofAºay
(
aFts4O±
) ){

123140 *
pzEº
 = 
	`sqlôe3_m¥ötf
("uƒecognizedÖ¨amëî: %s", 
z
);

123141 
rc
 = 
SQLITE_ERROR
;

123143  
iO±
 ){

123145 if–
	`°æí
(
zVÆ
)!=4 || 
	`sqlôe3_°∫icmp
(zVal, "fts3", 4) ){

123146 *
pzEº
 = 
	`sqlôe3_m¥ötf
("uƒecognized m©chöfo: %s", 
zVÆ
);

123147 
rc
 = 
SQLITE_ERROR
;

123149 
bNoDocsize
 = 1;

123153 
	`sqlôe3_‰ì
(
zPªfix
);

123154 
zPªfix
 = 
zVÆ
;

123155 
zVÆ
 = 0;

123159 
	`sqlôe3_‰ì
(
zCom¥ess
);

123160 
zCom¥ess
 = 
zVÆ
;

123161 
zVÆ
 = 0;

123165 
	`sqlôe3_‰ì
(
zUncom¥ess
);

123166 
zUncom¥ess
 = 
zVÆ
;

123167 
zVÆ
 = 0;

123171 if–(
	`°æí
(
zVÆ
)!=3 || 
	`sqlôe3_°∫icmp
(zVal, "asc", 3))

123172 && (
	`°æí
(
zVÆ
)!=4 || 
	`sqlôe3_°∫icmp
(zVal, "desc", 4))

123174 *
pzEº
 = 
	`sqlôe3_m¥ötf
("uƒecognized ordî: %s", 
zVÆ
);

123175 
rc
 = 
SQLITE_ERROR
;

123177 
bDescIdx
 = (
zVÆ
[0]=='d' || zVal[0]=='D');

123181 
	`sqlôe3_‰ì
(
zC⁄ã¡
);

123182 
zC⁄ã¡
 = 
zVÆ
;

123183 
zVÆ
 = 0;

123187 
	`as£π
–
iO±
==6 );

123188 
	`sqlôe3_‰ì
(
zL™guageid
);

123189 
zL™guageid
 = 
zVÆ
;

123190 
zVÆ
 = 0;

123194 
azNŸödexed
[
nNŸödexed
++] = 
zVÆ
;

123195 
zVÆ
 = 0;

123199 
	`sqlôe3_‰ì
(
zVÆ
);

123205 
nSåög
 +()(
	`°æí
(
z
) + 1);

123206 
aCﬁ
[
nCﬁ
++] = 
z
;

123217 if–
rc
==
SQLITE_OK
 && 
zC⁄ã¡
 ){

123218 
	`sqlôe3_‰ì
(
zCom¥ess
);

123219 
	`sqlôe3_‰ì
(
zUncom¥ess
);

123220 
zCom¥ess
 = 0;

123221 
zUncom¥ess
 = 0;

123222 if–
nCﬁ
==0 ){

123223 
	`sqlôe3_‰ì
((*)
aCﬁ
);

123224 
aCﬁ
 = 0;

123225 
rc
 = 
	`·s3C⁄ã¡Cﬁumns
(
db
, 
¨gv
[1], 
zC⁄ã¡
, &
aCﬁ
, &
nCﬁ
, &
nSåög
);

123229 if–
rc
==
SQLITE_OK
 && 
zL™guageid
 ){

123230 
j
;

123231 
j
=0; j<
nCﬁ
; j++){

123232 if–
	`sqlôe3_°ricmp
(
zL™guageid
, 
aCﬁ
[
j
])==0 ){

123233 
k
;

123234 
k
=
j
; k<
nCﬁ
; k++Ë
aCﬁ
[k] =áCol[k+1];

123235 
nCﬁ
--;

123242 if–
rc
!=
SQLITE_OK
 ) 
·s3_öô_out
;

123244 if–
nCﬁ
==0 ){

123245 
	`as£π
–
nSåög
==0 );

123246 
aCﬁ
[0] = "content";

123247 
nSåög
 = 8;

123248 
nCﬁ
 = 1;

123251 if–
pTokíizî
==0 ){

123252 
rc
 = 
	`sqlôe3Fts3InôTokíizî
(
pHash
, "sim∂e", &
pTokíizî
, 
pzEº
);

123253 if–
rc
!=
SQLITE_OK
 ) 
·s3_öô_out
;

123255 
	`as£π
–
pTokíizî
 );

123257 
rc
 = 
	`·s3PªfixP¨amëî
(
zPªfix
, &
nIndex
, &
aIndex
);

123258 if–
rc
==
SQLITE_ERROR
 ){

123259 
	`as£π
–
zPªfix
 );

123260 *
pzEº
 = 
	`sqlôe3_m¥ötf
("îr‹Ö¨sögÖªfixÖ¨amëî: %s", 
zPªfix
);

123262 if–
rc
!=
SQLITE_OK
 ) 
·s3_öô_out
;

123265 
nByã
 = (
Fts3TabÀ
) +

123266 
nCﬁ
 * (*) +

123267 
nIndex
 * (
Fts3Index
) +

123268 
nCﬁ
 * (
u8
) +

123269 
nName
 +

123270 
nDb
 +

123271 
nSåög
;

123272 
p
 = (
Fts3TabÀ
*)
	`sqlôe3_mÆloc
(
nByã
);

123273 if–
p
==0 ){

123274 
rc
 = 
SQLITE_NOMEM
;

123275 
·s3_öô_out
;

123277 
	`mem£t
(
p
, 0, 
nByã
);

123278 
p
->
db
 = db;

123279 
p
->
nCﬁumn
 = 
nCﬁ
;

123280 
p
->
nPídögD©a
 = 0;

123281 
p
->
azCﬁumn
 = (**)&p[1];

123282 
p
->
pTokíizî
 =ÖTokenizer;

123283 
p
->
nMaxPídögD©a
 = 
FTS3_MAX_PENDING_DATA
;

123284 
p
->
bHasDocsize
 = (
isFts4
 && 
bNoDocsize
==0);

123285 
p
->
bHasSèt
 = 
isFts4
;

123286 
p
->
bFts4
 = 
isFts4
;

123287 
p
->
bDescIdx
 = bDescIdx;

123288 
p
->
bAutoö¸mîge
 = 0xff;

123289 
p
->
zC⁄ã¡Tbl
 = 
zC⁄ã¡
;

123290 
p
->
zL™guageid
 = zLanguageid;

123291 
zC⁄ã¡
 = 0;

123292 
zL™guageid
 = 0;

123293 
	`TESTONLY
–
p
->
öTønß˘i⁄
 = -1 );

123294 
	`TESTONLY
–
p
->
mxSavïoöt
 = -1 );

123296 
p
->
aIndex
 = (
Fts3Index
 *)&p->
azCﬁumn
[
nCﬁ
];

123297 
	`mem˝y
(
p
->
aIndex
,áIndex, (
Fts3Index
Ë* 
nIndex
);

123298 
p
->
nIndex
 =ÇIndex;

123299 
i
=0; i<
nIndex
; i++){

123300 
	`·s3HashInô
(&
p
->
aIndex
[
i
].
hPídög
, 
FTS3_HASH_STRING
, 1);

123302 
p
->
abNŸödexed
 = (
u8
 *)&p->
aIndex
[
nIndex
];

123305 
zC§
 = (*)&
p
->
abNŸödexed
[
nCﬁ
];

123306 
p
->
zName
 = 
zC§
;

123307 
	`mem˝y
(
zC§
, 
¨gv
[2], 
nName
);

123308 
zC§
 +
nName
;

123309 
p
->
zDb
 = 
zC§
;

123310 
	`mem˝y
(
zC§
, 
¨gv
[1], 
nDb
);

123311 
zC§
 +
nDb
;

123314 
iCﬁ
=0; iCﬁ<
nCﬁ
; iCol++){

123315 *
z
;

123316 
n
 = 0;

123317 
z
 = (*)
	`sqlôe3Fts3NextTokí
(
aCﬁ
[
iCﬁ
], &
n
);

123318 
	`mem˝y
(
zC§
, 
z
, 
n
);

123319 
zC§
[
n
] = '\0';

123320 
	`sqlôe3Fts3DequŸe
(
zC§
);

123321 
p
->
azCﬁumn
[
iCﬁ
] = 
zC§
;

123322 
zC§
 +
n
+1;

123323 
	`as£π
–
zC§
 <&((*)
p
)[
nByã
] );

123327 
iCﬁ
=0; iCﬁ<
nCﬁ
; iCol++){

123328 
n
 = ()
	`°æí
(
p
->
azCﬁumn
[
iCﬁ
]);

123329 
i
=0; i<
nNŸödexed
; i++){

123330 *
zNŸ
 = 
azNŸödexed
[
i
];

123331 if–
zNŸ
 && 0==
	`sqlôe3_°∫icmp
(
p
->
azCﬁumn
[
iCﬁ
], zNŸ, 
n
) ){

123332 
p
->
abNŸödexed
[
iCﬁ
] = 1;

123333 
	`sqlôe3_‰ì
(
zNŸ
);

123334 
azNŸödexed
[
i
] = 0;

123338 
i
=0; i<
nNŸödexed
; i++){

123339 if–
azNŸödexed
[
i
] ){

123340 *
pzEº
 = 
	`sqlôe3_m¥ötf
("nÿsuch cﬁumn: %s", 
azNŸödexed
[
i
]);

123341 
rc
 = 
SQLITE_ERROR
;

123345 if–
rc
==
SQLITE_OK
 && (
zCom¥ess
==0)!=(
zUncom¥ess
==0) ){

123346 c⁄° *
zMiss
 = (
zCom¥ess
==0 ? "compress" : "uncompress");

123347 
rc
 = 
SQLITE_ERROR
;

123348 *
pzEº
 = 
	`sqlôe3_m¥ötf
("missög %†∑ømëî i¿·s4 c⁄°ru˘‹", 
zMiss
);

123350 
p
->
zRódEx¥li°
 = 
	`·s3RódEx¥Li°
’, 
zUncom¥ess
, &
rc
);

123351 
p
->
zWrôeEx¥li°
 = 
	`·s3WrôeEx¥Li°
’, 
zCom¥ess
, &
rc
);

123352 if–
rc
!=
SQLITE_OK
 ) 
·s3_öô_out
;

123357 if–
isCª©e
 ){

123358 
rc
 = 
	`·s3Cª©eTabÀs
(
p
);

123364 if–!
isFts4
 && !
isCª©e
 ){

123365 
rc2
 = 
SQLITE_OK
;

123366 
	`·s3DbExec
(&
rc2
, 
db
, "SELECT 1 FROM %Q.'%q_stat' WHERE id=2",

123367 
p
->
zDb
,Ö->
zName
);

123368 if–
rc2
==
SQLITE_OK
 ) 
p
->
bHasSèt
 = 1;

123373 
	`·s3D©aba£PageSize
(&
rc
, 
p
);

123374 
p
->
nNodeSize
 =Ö->
nPgsz
-35;

123377 
	`·s3De˛¨eVèb
(&
rc
, 
p
);

123379 
·s3_öô_out
:

123380 
	`sqlôe3_‰ì
(
zPªfix
);

123381 
	`sqlôe3_‰ì
(
aIndex
);

123382 
	`sqlôe3_‰ì
(
zCom¥ess
);

123383 
	`sqlôe3_‰ì
(
zUncom¥ess
);

123384 
	`sqlôe3_‰ì
(
zC⁄ã¡
);

123385 
	`sqlôe3_‰ì
(
zL™guageid
);

123386 
i
=0; i<
nNŸödexed
; i++Ë
	`sqlôe3_‰ì
(
azNŸödexed
[i]);

123387 
	`sqlôe3_‰ì
((*)
aCﬁ
);

123388 
	`sqlôe3_‰ì
((*)
azNŸödexed
);

123389 if–
rc
!=
SQLITE_OK
 ){

123390 if–
p
 ){

123391 
	`·s3Disc⁄√˘Mëhod
((
sqlôe3_vèb
 *)
p
);

123392 }if–
pTokíizî
 ){

123393 
pTokíizî
->
pModuÀ
->
	`xDe°roy
(pTokenizer);

123396 
	`as£π
–
p
->
pSegmíts
==0 );

123397 *
µVTab
 = &
p
->
ba£
;

123399  
rc
;

123406 
	`·s3C⁄√˘Mëhod
(

123407 
sqlôe3
 *
db
,

123408 *
pAux
,

123409 
¨gc
,

123410 c⁄° * c⁄° *
¨gv
,

123411 
sqlôe3_vèb
 **
µVèb
,

123412 **
pzEº


123414  
	`·s3InôVèb
(0, 
db
, 
pAux
, 
¨gc
, 
¨gv
, 
µVèb
, 
pzEº
);

123416 
	`·s3Cª©eMëhod
(

123417 
sqlôe3
 *
db
,

123418 *
pAux
,

123419 
¨gc
,

123420 c⁄° * c⁄° *
¨gv
,

123421 
sqlôe3_vèb
 **
µVèb
,

123422 **
pzEº


123424  
	`·s3InôVèb
(1, 
db
, 
pAux
, 
¨gc
, 
¨gv
, 
µVèb
, 
pzEº
);

123435 
	`·s3Be°IndexMëhod
(
sqlôe3_vèb
 *
pVTab
, 
sqlôe3_ödex_öfo
 *
pInfo
){

123436 
Fts3TabÀ
 *
p
 = (Fts3TabÀ *)
pVTab
;

123437 
i
;

123438 
iC⁄s
 = -1;

123440 
iL™gidC⁄s
 = -1;

123441 
iDocidGe
 = -1;

123442 
iDocidLe
 = -1;

123443 
iIdx
;

123449 
pInfo
->
idxNum
 = 
FTS3_FULLSCAN_SEARCH
;

123450 
pInfo
->
e°im©edCo°
 = 5000000;

123451 
i
=0; i<
pInfo
->
nC⁄°øöt
; i++){

123452 
bDocid
;

123453 
sqlôe3_ödex_c⁄°øöt
 *
pC⁄s
 = &
pInfo
->
aC⁄°øöt
[
i
];

123454 if–
pC⁄s
->
ußbÀ
==0 ) ;

123456 
bDocid
 = (
pC⁄s
->
iCﬁumn
<0 ||ÖC⁄s->iCﬁumn==
p
->
nCﬁumn
+1);

123459 if–
iC⁄s
<0 && 
pC⁄s
->
›
==
SQLITE_INDEX_CONSTRAINT_EQ
 && 
bDocid
 ){

123460 
pInfo
->
idxNum
 = 
FTS3_DOCID_SEARCH
;

123461 
pInfo
->
e°im©edCo°
 = 1.0;

123462 
iC⁄s
 = 
i
;

123474 if–
pC⁄s
->
›
==
SQLITE_INDEX_CONSTRAINT_MATCH


123475 && 
pC⁄s
->
iCﬁumn
>=0 &&ÖC⁄s->iCﬁumn<=
p
->
nCﬁumn


123477 
pInfo
->
idxNum
 = 
FTS3_FULLTEXT_SEARCH
 + 
pC⁄s
->
iCﬁumn
;

123478 
pInfo
->
e°im©edCo°
 = 2.0;

123479 
iC⁄s
 = 
i
;

123483 if–
pC⁄s
->
›
==
SQLITE_INDEX_CONSTRAINT_EQ


123484 && 
pC⁄s
->
iCﬁumn
==
p
->
nCﬁumn
 + 2

123486 
iL™gidC⁄s
 = 
i
;

123489 if–
bDocid
 ){

123490  
pC⁄s
->
›
 ){

123491 
SQLITE_INDEX_CONSTRAINT_GE
:

123492 
SQLITE_INDEX_CONSTRAINT_GT
:

123493 
iDocidGe
 = 
i
;

123496 
SQLITE_INDEX_CONSTRAINT_LE
:

123497 
SQLITE_INDEX_CONSTRAINT_LT
:

123498 
iDocidLe
 = 
i
;

123504 
iIdx
 = 1;

123505 if–
iC⁄s
>=0 ){

123506 
pInfo
->
aC⁄°øötUßge
[
iC⁄s
].
¨gvIndex
 = 
iIdx
++;

123507 
pInfo
->
aC⁄°øötUßge
[
iC⁄s
].
omô
 = 1;

123509 if–
iL™gidC⁄s
>=0 ){

123510 
pInfo
->
idxNum
 |
FTS3_HAVE_LANGID
;

123511 
pInfo
->
aC⁄°øötUßge
[
iL™gidC⁄s
].
¨gvIndex
 = 
iIdx
++;

123513 if–
iDocidGe
>=0 ){

123514 
pInfo
->
idxNum
 |
FTS3_HAVE_DOCID_GE
;

123515 
pInfo
->
aC⁄°øötUßge
[
iDocidGe
].
¨gvIndex
 = 
iIdx
++;

123517 if–
iDocidLe
>=0 ){

123518 
pInfo
->
idxNum
 |
FTS3_HAVE_DOCID_LE
;

123519 
pInfo
->
aC⁄°øötUßge
[
iDocidLe
].
¨gvIndex
 = 
iIdx
++;

123525 if–
pInfo
->
nOrdîBy
==1 ){

123526 
sqlôe3_ödex_‹dîby
 *
pOrdî
 = &
pInfo
->
aOrdîBy
[0];

123527 if–
pOrdî
->
iCﬁumn
<0 ||ÖOrdî->iCﬁumn==
p
->
nCﬁumn
+1 ){

123528 if–
pOrdî
->
desc
 ){

123529 
pInfo
->
idxSå
 = "DESC";

123531 
pInfo
->
idxSå
 = "ASC";

123533 
pInfo
->
‹dîByC⁄sumed
 = 1;

123537 
	`as£π
–
p
->
pSegmíts
==0 );

123538  
SQLITE_OK
;

123544 
	`·s3O≥nMëhod
(
sqlôe3_vèb
 *
pVTab
, 
sqlôe3_vèb_curs‹
 **
µC§
){

123545 
sqlôe3_vèb_curs‹
 *
pC§
;

123547 
	`UNUSED_PARAMETER
(
pVTab
);

123553 *
µC§
 = 
pC§
 = (
sqlôe3_vèb_curs‹
 *)
	`sqlôe3_mÆloc
((
Fts3Curs‹
));

123554 if–!
pC§
 ){

123555  
SQLITE_NOMEM
;

123557 
	`mem£t
(
pC§
, 0, (
Fts3Curs‹
));

123558  
SQLITE_OK
;

123565 
	`·s3Clo£Mëhod
(
sqlôe3_vèb_curs‹
 *
pCurs‹
){

123566 
Fts3Curs‹
 *
pC§
 = (Fts3Curs‹ *)
pCurs‹
;

123567 
	`as£π
–((
Fts3TabÀ
 *)
pC§
->
ba£
.
pVèb
)->
pSegmíts
==0 );

123568 
	`sqlôe3_föÆize
(
pC§
->
pStmt
);

123569 
	`sqlôe3Fts3Ex¥Fªe
(
pC§
->
pEx¥
);

123570 
	`sqlôe3Fts3FªeDe„ºedTokís
(
pC§
);

123571 
	`sqlôe3_‰ì
(
pC§
->
aDo˛i°
);

123572 
	`sqlôe3_‰ì
(
pC§
->
aM©chöfo
);

123573 
	`as£π
–((
Fts3TabÀ
 *)
pC§
->
ba£
.
pVèb
)->
pSegmíts
==0 );

123574 
	`sqlôe3_‰ì
(
pC§
);

123575  
SQLITE_OK
;

123589 
	`·s3Curs‹SìkStmt
(
Fts3Curs‹
 *
pC§
, 
sqlôe3_°mt
 **
µStmt
){

123590 
rc
 = 
SQLITE_OK
;

123591 if–
pC§
->
pStmt
==0 ){

123592 
Fts3TabÀ
 *
p
 = (Fts3TabÀ *)
pC§
->
ba£
.
pVèb
;

123593 *
zSql
;

123594 
zSql
 = 
	`sqlôe3_m¥ötf
("SELECT %†WHEREÑowid = ?", 
p
->
zRódEx¥li°
);

123595 if–!
zSql
 )  
SQLITE_NOMEM
;

123596 
rc
 = 
	`sqlôe3_¥ï¨e_v2
(
p
->
db
, 
zSql
, -1, &
pC§
->
pStmt
, 0);

123597 
	`sqlôe3_‰ì
(
zSql
);

123599 *
µStmt
 = 
pC§
->
pStmt
;

123600  
rc
;

123608 
	`·s3Curs‹Sìk
(
sqlôe3_c⁄ãxt
 *
pC⁄ãxt
, 
Fts3Curs‹
 *
pC§
){

123609 
rc
 = 
SQLITE_OK
;

123610 if–
pC§
->
isRequúeSìk
 ){

123611 
sqlôe3_°mt
 *
pStmt
 = 0;

123613 
rc
 = 
	`·s3Curs‹SìkStmt
(
pC§
, &
pStmt
);

123614 if–
rc
==
SQLITE_OK
 ){

123615 
	`sqlôe3_böd_öt64
(
pC§
->
pStmt
, 1,ÖC§->
iPªvId
);

123616 
pC§
->
isRequúeSìk
 = 0;

123617 if–
SQLITE_ROW
==
	`sqlôe3_°ï
(
pC§
->
pStmt
) ){

123618  
SQLITE_OK
;

123620 
rc
 = 
	`sqlôe3_ª£t
(
pC§
->
pStmt
);

123621 if–
rc
==
SQLITE_OK
 && ((
Fts3TabÀ
 *)
pC§
->
ba£
.
pVèb
)->
zC⁄ã¡Tbl
==0 ){

123625 
rc
 = 
FTS_CORRUPT_VTAB
;

123626 
pC§
->
isEof
 = 1;

123632 if–
rc
!=
SQLITE_OK
 && 
pC⁄ãxt
 ){

123633 
	`sqlôe3_ªsu…_îr‹_code
(
pC⁄ãxt
, 
rc
);

123635  
rc
;

123653 
	`·s3SˇnI¡îi‹Node
(

123654 c⁄° *
zTîm
,

123655 
nTîm
,

123656 c⁄° *
zNode
,

123657 
nNode
,

123658 
sqlôe3_öt64
 *
piFú°
,

123659 
sqlôe3_öt64
 *
piLa°


123661 
rc
 = 
SQLITE_OK
;

123662 c⁄° *
zC§
 = 
zNode
;

123663 c⁄° *
zEnd
 = &
zC§
[
nNode
];

123664 *
zBuf„r
 = 0;

123665 
nAŒoc
 = 0;

123666 
isFú°Tîm
 = 1;

123667 
sqlôe3_öt64
 
iChûd
;

123682 
zC§
 +
	`sqlôe3Fts3GëV¨öt
(zC§, &
iChûd
);

123683 
zC§
 +
	`sqlôe3Fts3GëV¨öt
(zC§, &
iChûd
);

123684 if–
zC§
>
zEnd
 ){

123685  
FTS_CORRUPT_VTAB
;

123688  
zC§
<
zEnd
 && (
piFú°
 || 
piLa°
) ){

123689 
cmp
;

123690 
nSuffix
;

123691 
nPªfix
 = 0;

123692 
nBuf„r
;

123696 if–!
isFú°Tîm
 ){

123697 
zC§
 +
	`sqlôe3Fts3GëV¨öt32
(zC§, &
nPªfix
);

123699 
isFú°Tîm
 = 0;

123700 
zC§
 +
	`sqlôe3Fts3GëV¨öt32
(zC§, &
nSuffix
);

123702 if–
nPªfix
<0 || 
nSuffix
<0 || &
zC§
[nSuffix]>
zEnd
 ){

123703 
rc
 = 
FTS_CORRUPT_VTAB
;

123704 
föish_sˇn
;

123706 if–
nPªfix
+
nSuffix
>
nAŒoc
 ){

123707 *
zNew
;

123708 
nAŒoc
 = (
nPªfix
+
nSuffix
) * 2;

123709 
zNew
 = (*)
	`sqlôe3_ªÆloc
(
zBuf„r
, 
nAŒoc
);

123710 if–!
zNew
 ){

123711 
rc
 = 
SQLITE_NOMEM
;

123712 
föish_sˇn
;

123714 
zBuf„r
 = 
zNew
;

123716 
	`as£π
–
zBuf„r
 );

123717 
	`mem˝y
(&
zBuf„r
[
nPªfix
], 
zC§
, 
nSuffix
);

123718 
nBuf„r
 = 
nPªfix
 + 
nSuffix
;

123719 
zC§
 +
nSuffix
;

123730 
cmp
 = 
	`memcmp
(
zTîm
, 
zBuf„r
, (
nBuf„r
>
nTîm
 ?ÇTerm :ÇBuffer));

123731 if–
piFú°
 && (
cmp
<0 || (cmp==0 && 
nBuf„r
>
nTîm
)) ){

123732 *
piFú°
 = 
iChûd
;

123733 
piFú°
 = 0;

123736 if–
piLa°
 && 
cmp
<0 ){

123737 *
piLa°
 = 
iChûd
;

123738 
piLa°
 = 0;

123741 
iChûd
++;

123744 if–
piFú°
 ) *piFú° = 
iChûd
;

123745 if–
piLa°
 ) *piLa° = 
iChûd
;

123747 
föish_sˇn
:

123748 
	`sqlôe3_‰ì
(
zBuf„r
);

123749  
rc
;

123774 
	`·s3Sñe˘Lóf
(

123775 
Fts3TabÀ
 *
p
,

123776 c⁄° *
zTîm
,

123777 
nTîm
,

123778 c⁄° *
zNode
,

123779 
nNode
,

123780 
sqlôe3_öt64
 *
piLóf
,

123781 
sqlôe3_öt64
 *
piLóf2


123783 
rc
;

123784 
iHeight
;

123786 
	`as£π
–
piLóf
 || 
piLóf2
 );

123788 
	`sqlôe3Fts3GëV¨öt32
(
zNode
, &
iHeight
);

123789 
rc
 = 
	`·s3SˇnI¡îi‹Node
(
zTîm
, 
nTîm
, 
zNode
, 
nNode
, 
piLóf
, 
piLóf2
);

123790 
	`as£π
–!
piLóf2
 || !
piLóf
 || 
rc
!=
SQLITE_OK
 || (*piLeaf<=*piLeaf2) );

123792 if–
rc
==
SQLITE_OK
 && 
iHeight
>1 ){

123793 *
zBlob
 = 0;

123794 
nBlob
;

123796 if–
piLóf
 && 
piLóf2
 && (*piLeaf!=*piLeaf2) ){

123797 
rc
 = 
	`sqlôe3Fts3RódBlock
(
p
, *
piLóf
, &
zBlob
, &
nBlob
, 0);

123798 if–
rc
==
SQLITE_OK
 ){

123799 
rc
 = 
	`·s3Sñe˘Lóf
(
p
, 
zTîm
, 
nTîm
, 
zBlob
, 
nBlob
, 
piLóf
, 0);

123801 
	`sqlôe3_‰ì
(
zBlob
);

123802 
piLóf
 = 0;

123803 
zBlob
 = 0;

123806 if–
rc
==
SQLITE_OK
 ){

123807 
rc
 = 
	`sqlôe3Fts3RódBlock
(
p
, 
piLóf
?*piLóf:*
piLóf2
, &
zBlob
, &
nBlob
, 0);

123809 if–
rc
==
SQLITE_OK
 ){

123810 
rc
 = 
	`·s3Sñe˘Lóf
(
p
, 
zTîm
, 
nTîm
, 
zBlob
, 
nBlob
, 
piLóf
, 
piLóf2
);

123812 
	`sqlôe3_‰ì
(
zBlob
);

123815  
rc
;

123822 
	`·s3PutDñèV¨öt
(

123823 **
µ
,

123824 
sqlôe3_öt64
 *
piPªv
,

123825 
sqlôe3_öt64
 
iVÆ


123827 
	`as£π
–
iVÆ
-*
piPªv
 > 0 || (*piPrev==0 && iVal==0) );

123828 *
µ
 +
	`sqlôe3Fts3PutV¨öt
(*µ, 
iVÆ
-*
piPªv
);

123829 *
piPªv
 = 
iVÆ
;

123846 
	`·s3Po¶i°C›y
(**
µ
, **
µPo¶i°
){

123847 *
pEnd
 = *
µPo¶i°
;

123848 
c
 = 0;

123860  *
pEnd
 | 
c
 ){

123861 
c
 = *
pEnd
++ & 0x80;

123862 
	`ã°ˇ£
–
c
!=0 && (*
pEnd
)==0 );

123864 
pEnd
++;

123866 if–
µ
 ){

123867 
n
 = ()(
pEnd
 - *
µPo¶i°
);

123868 *
p
 = *
µ
;

123869 
	`mem˝y
(
p
, *
µPo¶i°
, 
n
);

123870 
p
 +
n
;

123871 *
µ
 = 
p
;

123873 *
µPo¶i°
 = 
pEnd
;

123893 
	`·s3Cﬁum∆i°C›y
(**
µ
, **
µPo¶i°
){

123894 *
pEnd
 = *
µPo¶i°
;

123895 
c
 = 0;

123900  0xFE & (*
pEnd
 | 
c
) ){

123901 
c
 = *
pEnd
++ & 0x80;

123902 
	`ã°ˇ£
–
c
!=0 && ((*
pEnd
)&0xfe)==0 );

123904 if–
µ
 ){

123905 
n
 = ()(
pEnd
 - *
µPo¶i°
);

123906 *
p
 = *
µ
;

123907 
	`mem˝y
(
p
, *
µPo¶i°
, 
n
);

123908 
p
 +
n
;

123909 *
µ
 = 
p
;

123911 *
µPo¶i°
 = 
pEnd
;

123918 
	#POSITION_LIST_END
 0x7fffffff

	)

123938 
	`·s3RódNextPos
(

123939 **
µ
,

123940 
sqlôe3_öt64
 *
pi


123942 if–(**
µ
)&0xFE ){

123943 
	`·s3GëDñèV¨öt
(
µ
, 
pi
);

123944 *
pi
 -= 2;

123946 *
pi
 = 
POSITION_LIST_END
;

123959 
	`·s3PutCﬁNumbî
(**
µ
, 
iCﬁ
){

123960 
n
 = 0;

123961 if–
iCﬁ
 ){

123962 *
p
 = *
µ
;

123963 
n
 = 1 + 
	`sqlôe3Fts3PutV¨öt
(&
p
[1], 
iCﬁ
);

123964 *
p
 = 0x01;

123965 *
µ
 = &
p
[
n
];

123967  
n
;

123977 
	`·s3Po¶i°Mîge
(

123978 **
µ
,

123979 **
µ1
,

123980 **
µ2


123982 *
p
 = *
µ
;

123983 *
p1
 = *
µ1
;

123984 *
p2
 = *
µ2
;

123986  *
p1
 || *
p2
 ){

123987 
iCﬁ1
;

123988 
iCﬁ2
;

123990 if–*
p1
==
POS_COLUMN
 ) 
	`sqlôe3Fts3GëV¨öt32
(&p1[1], &
iCﬁ1
);

123991 if–*
p1
==
POS_END
 ) 
iCﬁ1
 = 
POSITION_LIST_END
;

123992 
iCﬁ1
 = 0;

123994 if–*
p2
==
POS_COLUMN
 ) 
	`sqlôe3Fts3GëV¨öt32
(&p2[1], &
iCﬁ2
);

123995 if–*
p2
==
POS_END
 ) 
iCﬁ2
 = 
POSITION_LIST_END
;

123996 
iCﬁ2
 = 0;

123998 if–
iCﬁ1
==
iCﬁ2
 ){

123999 
sqlôe3_öt64
 
i1
 = 0;

124000 
sqlôe3_öt64
 
i2
 = 0;

124001 
sqlôe3_öt64
 
iPªv
 = 0;

124002 
n
 = 
	`·s3PutCﬁNumbî
(&
p
, 
iCﬁ1
);

124003 
p1
 +
n
;

124004 
p2
 +
n
;

124015 
	`·s3GëDñèV¨öt
(&
p1
, &
i1
);

124016 
	`·s3GëDñèV¨öt
(&
p2
, &
i2
);

124018 
	`·s3PutDñèV¨öt
(&
p
, &
iPªv
, (
i1
<
i2
) ? i1 : i2);

124019 
iPªv
 -= 2;

124020 if–
i1
==
i2
 ){

124021 
	`·s3RódNextPos
(&
p1
, &
i1
);

124022 
	`·s3RódNextPos
(&
p2
, &
i2
);

124023 }if–
i1
<
i2
 ){

124024 
	`·s3RódNextPos
(&
p1
, &
i1
);

124026 
	`·s3RódNextPos
(&
p2
, &
i2
);

124028 } 
i1
!=
POSITION_LIST_END
 || 
i2
!=POSITION_LIST_END );

124029 }if–
iCﬁ1
<
iCﬁ2
 ){

124030 
p1
 +
	`·s3PutCﬁNumbî
(&
p
, 
iCﬁ1
);

124031 
	`·s3Cﬁum∆i°C›y
(&
p
, &
p1
);

124033 
p2
 +
	`·s3PutCﬁNumbî
(&
p
, 
iCﬁ2
);

124034 
	`·s3Cﬁum∆i°C›y
(&
p
, &
p2
);

124038 *
p
++ = 
POS_END
;

124039 *
µ
 = 
p
;

124040 *
µ1
 = 
p1
 + 1;

124041 *
µ2
 = 
p2
 + 1;

124067 
	`·s3Po¶i°Phø£Mîge
(

124068 **
µ
,

124069 
nTokí
,

124070 
isSaveLe·
,

124071 
isExa˘
,

124072 **
µ1
,

124073 **
µ2


124075 *
p
 = *
µ
;

124076 *
p1
 = *
µ1
;

124077 *
p2
 = *
µ2
;

124078 
iCﬁ1
 = 0;

124079 
iCﬁ2
 = 0;

124082 
	`as£π
–
isSaveLe·
==0 || 
isExa˘
==0 );

124084 
	`as£π
–
p
!=0 && *
p1
!=0 && *
p2
!=0 );

124085 if–*
p1
==
POS_COLUMN
 ){

124086 
p1
++;

124087 
p1
 +
	`sqlôe3Fts3GëV¨öt32
’1, &
iCﬁ1
);

124089 if–*
p2
==
POS_COLUMN
 ){

124090 
p2
++;

124091 
p2
 +
	`sqlôe3Fts3GëV¨öt32
’2, &
iCﬁ2
);

124095 if–
iCﬁ1
==
iCﬁ2
 ){

124096 *
pSave
 = 
p
;

124097 
sqlôe3_öt64
 
iPªv
 = 0;

124098 
sqlôe3_öt64
 
iPos1
 = 0;

124099 
sqlôe3_öt64
 
iPos2
 = 0;

124101 if–
iCﬁ1
 ){

124102 *
p
++ = 
POS_COLUMN
;

124103 
p
 +
	`sqlôe3Fts3PutV¨öt
’, 
iCﬁ1
);

124106 
	`as£π
–*
p1
!=
POS_END
 && *p1!=
POS_COLUMN
 );

124107 
	`as£π
–*
p2
!=
POS_END
 && *p2!=
POS_COLUMN
 );

124108 
	`·s3GëDñèV¨öt
(&
p1
, &
iPos1
); iPos1 -= 2;

124109 
	`·s3GëDñèV¨öt
(&
p2
, &
iPos2
); iPos2 -= 2;

124112 if–
iPos2
==
iPos1
+
nTokí


124113 || (
isExa˘
==0 && 
iPos2
>
iPos1
 && iPos2<=iPos1+
nTokí
)

124115 
sqlôe3_öt64
 
iSave
;

124116 
iSave
 = 
isSaveLe·
 ? 
iPos1
 : 
iPos2
;

124117 
	`·s3PutDñèV¨öt
(&
p
, &
iPªv
, 
iSave
+2); iPrev -= 2;

124118 
pSave
 = 0;

124119 
	`as£π
–
p
 );

124121 if–(!
isSaveLe·
 && 
iPos2
<=(
iPos1
+
nTokí
)) || iPos2<=iPos1 ){

124122 if–(*
p2
&0xFE)==0 ) ;

124123 
	`·s3GëDñèV¨öt
(&
p2
, &
iPos2
); iPos2 -= 2;

124125 if–(*
p1
&0xFE)==0 ) ;

124126 
	`·s3GëDñèV¨öt
(&
p1
, &
iPos1
); iPos1 -= 2;

124130 if–
pSave
 ){

124131 
	`as£π
–
µ
 && 
p
 );

124132 
p
 = 
pSave
;

124135 
	`·s3Cﬁum∆i°C›y
(0, &
p1
);

124136 
	`·s3Cﬁum∆i°C›y
(0, &
p2
);

124137 
	`as£π
–(*
p1
&0xFE)==0 && (*
p2
&0xFE)==0 );

124138 if–0==*
p1
 || 0==*
p2
 ) ;

124140 
p1
++;

124141 
p1
 +
	`sqlôe3Fts3GëV¨öt32
’1, &
iCﬁ1
);

124142 
p2
++;

124143 
p2
 +
	`sqlôe3Fts3GëV¨öt32
’2, &
iCﬁ2
);

124151 if–
iCﬁ1
<
iCﬁ2
 ){

124152 
	`·s3Cﬁum∆i°C›y
(0, &
p1
);

124153 if–0==*
p1
 ) ;

124154 
p1
++;

124155 
p1
 +
	`sqlôe3Fts3GëV¨öt32
’1, &
iCﬁ1
);

124157 
	`·s3Cﬁum∆i°C›y
(0, &
p2
);

124158 if–0==*
p2
 ) ;

124159 
p2
++;

124160 
p2
 +
	`sqlôe3Fts3GëV¨öt32
’2, &
iCﬁ2
);

124164 
	`·s3Po¶i°C›y
(0, &
p2
);

124165 
	`·s3Po¶i°C›y
(0, &
p1
);

124166 *
µ1
 = 
p1
;

124167 *
µ2
 = 
p2
;

124168 if–*
µ
==
p
 ){

124171 *
p
++ = 0x00;

124172 *
µ
 = 
p
;

124191 
	`·s3Po¶i°NórMîge
(

124192 **
µ
,

124193 *
aTmp
,

124194 
nRight
,

124195 
nLe·
,

124196 **
µ1
,

124197 **
µ2


124199 *
p1
 = *
µ1
;

124200 *
p2
 = *
µ2
;

124202 *
pTmp1
 = 
aTmp
;

124203 *
pTmp2
;

124204 *
aTmp2
;

124205 
ªs
 = 1;

124207 
	`·s3Po¶i°Phø£Mîge
(&
pTmp1
, 
nRight
, 0, 0, 
µ1
, 
µ2
);

124208 
aTmp2
 = 
pTmp2
 = 
pTmp1
;

124209 *
µ1
 = 
p1
;

124210 *
µ2
 = 
p2
;

124211 
	`·s3Po¶i°Phø£Mîge
(&
pTmp2
, 
nLe·
, 1, 0, 
µ2
, 
µ1
);

124212 if–
pTmp1
!=
aTmp
 && 
pTmp2
!=
aTmp2
 ){

124213 
	`·s3Po¶i°Mîge
(
µ
, &
aTmp
, &
aTmp2
);

124214 }if–
pTmp1
!=
aTmp
 ){

124215 
	`·s3Po¶i°C›y
(
µ
, &
aTmp
);

124216 }if–
pTmp2
!=
aTmp2
 ){

124217 
	`·s3Po¶i°C›y
(
µ
, &
aTmp2
);

124219 
ªs
 = 0;

124222  
ªs
;

124230 
TîmSñe˘
 
	tTîmSñe˘
;

124231 
	sTîmSñe˘
 {

124232 *
ØOuçut
[16];

124233 
™Ouçut
[16];

124249 
	`·s3GëDñèV¨öt3
(

124250 **
µ
,

124251 *
pEnd
,

124252 
bDescIdx
,

124253 
sqlôe3_öt64
 *
pVÆ


124255 if–*
µ
>=
pEnd
 ){

124256 *
µ
 = 0;

124258 
sqlôe3_öt64
 
iVÆ
;

124259 *
µ
 +
	`sqlôe3Fts3GëV¨öt
(*µ, &
iVÆ
);

124260 if–
bDescIdx
 ){

124261 *
pVÆ
 -
iVÆ
;

124263 *
pVÆ
 +
iVÆ
;

124283 
	`·s3PutDñèV¨öt3
(

124284 **
µ
,

124285 
bDescIdx
,

124286 
sqlôe3_öt64
 *
piPªv
,

124287 *
pbFú°
,

124288 
sqlôe3_öt64
 
iVÆ


124290 
sqlôe3_öt64
 
iWrôe
;

124291 if–
bDescIdx
==0 || *
pbFú°
==0 ){

124292 
iWrôe
 = 
iVÆ
 - *
piPªv
;

124294 
iWrôe
 = *
piPªv
 - 
iVÆ
;

124296 
	`as£π
–*
pbFú°
 || *
piPªv
==0 );

124297 
	`as£π
–*
pbFú°
==0 || 
iWrôe
>0 );

124298 *
µ
 +
	`sqlôe3Fts3PutV¨öt
(*µ, 
iWrôe
);

124299 *
piPªv
 = 
iVÆ
;

124300 *
pbFú°
 = 1;

124313 
	#DOCID_CMP
(
i1
, 
i2
Ë((
bDescDo˛i°
?-1:1Ë* (i1-i2))

	)

124329 
	`·s3Do˛i°OrMîge
(

124330 
bDescDo˛i°
,

124331 *
a1
, 
n1
,

124332 *
a2
, 
n2
,

124333 **
∑Out
, *
≤Out


124335 
sqlôe3_öt64
 
i1
 = 0;

124336 
sqlôe3_öt64
 
i2
 = 0;

124337 
sqlôe3_öt64
 
iPªv
 = 0;

124338 *
pEnd1
 = &
a1
[
n1
];

124339 *
pEnd2
 = &
a2
[
n2
];

124340 *
p1
 = 
a1
;

124341 *
p2
 = 
a2
;

124342 *
p
;

124343 *
aOut
;

124344 
bFú°Out
 = 0;

124346 *
∑Out
 = 0;

124347 *
≤Out
 = 0;

124378 
aOut
 = 
	`sqlôe3_mÆloc
(
n1
+
n2
+
FTS3_VARINT_MAX
-1);

124379 if–!
aOut
 )  
SQLITE_NOMEM
;

124381 
p
 = 
aOut
;

124382 
	`·s3GëDñèV¨öt3
(&
p1
, 
pEnd1
, 0, &
i1
);

124383 
	`·s3GëDñèV¨öt3
(&
p2
, 
pEnd2
, 0, &
i2
);

124384  
p1
 || 
p2
 ){

124385 
sqlôe3_öt64
 
iDiff
 = 
	`DOCID_CMP
(
i1
, 
i2
);

124387 if–
p2
 && 
p1
 && 
iDiff
==0 ){

124388 
	`·s3PutDñèV¨öt3
(&
p
, 
bDescDo˛i°
, &
iPªv
, &
bFú°Out
, 
i1
);

124389 
	`·s3Po¶i°Mîge
(&
p
, &
p1
, &
p2
);

124390 
	`·s3GëDñèV¨öt3
(&
p1
, 
pEnd1
, 
bDescDo˛i°
, &
i1
);

124391 
	`·s3GëDñèV¨öt3
(&
p2
, 
pEnd2
, 
bDescDo˛i°
, &
i2
);

124392 }if–!
p2
 || (
p1
 && 
iDiff
<0) ){

124393 
	`·s3PutDñèV¨öt3
(&
p
, 
bDescDo˛i°
, &
iPªv
, &
bFú°Out
, 
i1
);

124394 
	`·s3Po¶i°C›y
(&
p
, &
p1
);

124395 
	`·s3GëDñèV¨öt3
(&
p1
, 
pEnd1
, 
bDescDo˛i°
, &
i1
);

124397 
	`·s3PutDñèV¨öt3
(&
p
, 
bDescDo˛i°
, &
iPªv
, &
bFú°Out
, 
i2
);

124398 
	`·s3Po¶i°C›y
(&
p
, &
p2
);

124399 
	`·s3GëDñèV¨öt3
(&
p2
, 
pEnd2
, 
bDescDo˛i°
, &
i2
);

124403 *
∑Out
 = 
aOut
;

124404 *
≤Out
 = ()(
p
-
aOut
);

124405 
	`as£π
–*
≤Out
<=
n1
+
n2
+
FTS3_VARINT_MAX
-1 );

124406  
SQLITE_OK
;

124421 
	`·s3Do˛i°Phø£Mîge
(

124422 
bDescDo˛i°
,

124423 
nDi°
,

124424 *
aLe·
, 
nLe·
,

124425 *
aRight
, *
≤Right


124427 
sqlôe3_öt64
 
i1
 = 0;

124428 
sqlôe3_öt64
 
i2
 = 0;

124429 
sqlôe3_öt64
 
iPªv
 = 0;

124430 *
pEnd1
 = &
aLe·
[
nLe·
];

124431 *
pEnd2
 = &
aRight
[*
≤Right
];

124432 *
p1
 = 
aLe·
;

124433 *
p2
 = 
aRight
;

124434 *
p
;

124435 
bFú°Out
 = 0;

124436 *
aOut
 = 
aRight
;

124438 
	`as£π
–
nDi°
>0 );

124440 
p
 = 
aOut
;

124441 
	`·s3GëDñèV¨öt3
(&
p1
, 
pEnd1
, 0, &
i1
);

124442 
	`·s3GëDñèV¨öt3
(&
p2
, 
pEnd2
, 0, &
i2
);

124444  
p1
 && 
p2
 ){

124445 
sqlôe3_öt64
 
iDiff
 = 
	`DOCID_CMP
(
i1
, 
i2
);

124446 if–
iDiff
==0 ){

124447 *
pSave
 = 
p
;

124448 
sqlôe3_öt64
 
iPªvSave
 = 
iPªv
;

124449 
bFú°OutSave
 = 
bFú°Out
;

124451 
	`·s3PutDñèV¨öt3
(&
p
, 
bDescDo˛i°
, &
iPªv
, &
bFú°Out
, 
i1
);

124452 if–0==
	`·s3Po¶i°Phø£Mîge
(&
p
, 
nDi°
, 0, 1, &
p1
, &
p2
) ){

124453 
p
 = 
pSave
;

124454 
iPªv
 = 
iPªvSave
;

124455 
bFú°Out
 = 
bFú°OutSave
;

124457 
	`·s3GëDñèV¨öt3
(&
p1
, 
pEnd1
, 
bDescDo˛i°
, &
i1
);

124458 
	`·s3GëDñèV¨öt3
(&
p2
, 
pEnd2
, 
bDescDo˛i°
, &
i2
);

124459 }if–
iDiff
<0 ){

124460 
	`·s3Po¶i°C›y
(0, &
p1
);

124461 
	`·s3GëDñèV¨öt3
(&
p1
, 
pEnd1
, 
bDescDo˛i°
, &
i1
);

124463 
	`·s3Po¶i°C›y
(0, &
p2
);

124464 
	`·s3GëDñèV¨öt3
(&
p2
, 
pEnd2
, 
bDescDo˛i°
, &
i2
);

124468 *
≤Right
 = ()(
p
 - 
aOut
);

124479 
SQLITE_PRIVATE
 
	`sqlôe3Fts3Fú°Fûãr
(

124480 
sqlôe3_öt64
 
iDñè
,

124481 *
pLi°
,

124482 
nLi°
,

124483 *
pOut


124485 
nOut
 = 0;

124486 
bWrôãn
 = 0;

124487 *
p
 = 
pLi°
;

124488 *
pEnd
 = &
pLi°
[
nLi°
];

124490 if–*
p
!=0x01 ){

124491 if–*
p
==0x02 ){

124492 
nOut
 +
	`sqlôe3Fts3PutV¨öt
(&
pOut
[nOut], 
iDñè
);

124493 
pOut
[
nOut
++] = 0x02;

124494 
bWrôãn
 = 1;

124496 
	`·s3Cﬁum∆i°C›y
(0, &
p
);

124499  
p
<
pEnd
 && *p==0x01 ){

124500 
sqlôe3_öt64
 
iCﬁ
;

124501 
p
++;

124502 
p
 +
	`sqlôe3Fts3GëV¨öt
’, &
iCﬁ
);

124503 if–*
p
==0x02 ){

124504 if–
bWrôãn
==0 ){

124505 
nOut
 +
	`sqlôe3Fts3PutV¨öt
(&
pOut
[nOut], 
iDñè
);

124506 
bWrôãn
 = 1;

124508 
pOut
[
nOut
++] = 0x01;

124509 
nOut
 +
	`sqlôe3Fts3PutV¨öt
(&
pOut
[nOut], 
iCﬁ
);

124510 
pOut
[
nOut
++] = 0x02;

124512 
	`·s3Cﬁum∆i°C›y
(0, &
p
);

124514 if–
bWrôãn
 ){

124515 
pOut
[
nOut
++] = 0x00;

124518  
nOut
;

124531 
	`·s3TîmSñe˘FöishMîge
(
Fts3TabÀ
 *
p
, 
TîmSñe˘
 *
pTS
){

124532 *
aOut
 = 0;

124533 
nOut
 = 0;

124534 
i
;

124539 
i
=0; i<
	`SizeofAºay
(
pTS
->
ØOuçut
); i++){

124540 if–
pTS
->
ØOuçut
[
i
] ){

124541 if–!
aOut
 ){

124542 
aOut
 = 
pTS
->
ØOuçut
[
i
];

124543 
nOut
 = 
pTS
->
™Ouçut
[
i
];

124544 
pTS
->
ØOuçut
[
i
] = 0;

124546 
nNew
;

124547 *
aNew
;

124549 
rc
 = 
	`·s3Do˛i°OrMîge
(
p
->
bDescIdx
,

124550 
pTS
->
ØOuçut
[
i
],ÖTS->
™Ouçut
[i], 
aOut
, 
nOut
, &
aNew
, &
nNew


124552 if–
rc
!=
SQLITE_OK
 ){

124553 
	`sqlôe3_‰ì
(
aOut
);

124554  
rc
;

124557 
	`sqlôe3_‰ì
(
pTS
->
ØOuçut
[
i
]);

124558 
	`sqlôe3_‰ì
(
aOut
);

124559 
pTS
->
ØOuçut
[
i
] = 0;

124560 
aOut
 = 
aNew
;

124561 
nOut
 = 
nNew
;

124566 
pTS
->
ØOuçut
[0] = 
aOut
;

124567 
pTS
->
™Ouçut
[0] = 
nOut
;

124568  
SQLITE_OK
;

124585 
	`·s3TîmSñe˘Mîge
(

124586 
Fts3TabÀ
 *
p
,

124587 
TîmSñe˘
 *
pTS
,

124588 *
aDo˛i°
,

124589 
nDo˛i°


124591 if–
pTS
->
ØOuçut
[0]==0 ){

124594 
pTS
->
ØOuçut
[0] = 
	`sqlôe3_mÆloc
(
nDo˛i°
);

124595 
pTS
->
™Ouçut
[0] = 
nDo˛i°
;

124596 if–
pTS
->
ØOuçut
[0] ){

124597 
	`mem˝y
(
pTS
->
ØOuçut
[0], 
aDo˛i°
, 
nDo˛i°
);

124599  
SQLITE_NOMEM
;

124602 *
aMîge
 = 
aDo˛i°
;

124603 
nMîge
 = 
nDo˛i°
;

124604 
iOut
;

124606 
iOut
=0; iOut<
	`SizeofAºay
(
pTS
->
ØOuçut
); iOut++){

124607 if–
pTS
->
ØOuçut
[
iOut
]==0 ){

124608 
	`as£π
–
iOut
>0 );

124609 
pTS
->
ØOuçut
[
iOut
] = 
aMîge
;

124610 
pTS
->
™Ouçut
[
iOut
] = 
nMîge
;

124613 *
aNew
;

124614 
nNew
;

124616 
rc
 = 
	`·s3Do˛i°OrMîge
(
p
->
bDescIdx
, 
aMîge
, 
nMîge
,

124617 
pTS
->
ØOuçut
[
iOut
],ÖTS->
™Ouçut
[iOut], &
aNew
, &
nNew


124619 if–
rc
!=
SQLITE_OK
 ){

124620 if–
aMîge
!=
aDo˛i°
 ) 
	`sqlôe3_‰ì
(aMerge);

124621  
rc
;

124624 if–
aMîge
!=
aDo˛i°
 ) 
	`sqlôe3_‰ì
(aMerge);

124625 
	`sqlôe3_‰ì
(
pTS
->
ØOuçut
[
iOut
]);

124626 
pTS
->
ØOuçut
[
iOut
] = 0;

124628 
aMîge
 = 
aNew
;

124629 
nMîge
 = 
nNew
;

124630 if–(
iOut
+1)==
	`SizeofAºay
(
pTS
->
ØOuçut
) ){

124631 
pTS
->
ØOuçut
[
iOut
] = 
aMîge
;

124632 
pTS
->
™Ouçut
[
iOut
] = 
nMîge
;

124637  
SQLITE_OK
;

124643 
	`·s3SegRódîCurs‹Aµíd
(

124644 
Fts3Mu…iSegRódî
 *
pC§
,

124645 
Fts3SegRódî
 *
pNew


124647 if–(
pC§
->
nSegmít
%16)==0 ){

124648 
Fts3SegRódî
 **
≠New
;

124649 
nByã
 = (
pC§
->
nSegmít
 + 16)*(
Fts3SegRódî
*);

124650 
≠New
 = (
Fts3SegRódî
 **)
	`sqlôe3_ªÆloc
(
pC§
->
≠Segmít
, 
nByã
);

124651 if–!
≠New
 ){

124652 
	`sqlôe3Fts3SegRódîFªe
(
pNew
);

124653  
SQLITE_NOMEM
;

124655 
pC§
->
≠Segmít
 = 
≠New
;

124657 
pC§
->
≠Segmít
[pC§->
nSegmít
++] = 
pNew
;

124658  
SQLITE_OK
;

124668 
	`·s3SegRódîCurs‹
(

124669 
Fts3TabÀ
 *
p
,

124670 
iL™gid
,

124671 
iIndex
,

124672 
iLevñ
,

124673 c⁄° *
zTîm
,

124674 
nTîm
,

124675 
isPªfix
,

124676 
isSˇn
,

124677 
Fts3Mu…iSegRódî
 *
pC§


124679 
rc
 = 
SQLITE_OK
;

124680 
sqlôe3_°mt
 *
pStmt
 = 0;

124681 
rc2
;

124689 if–
iLevñ
<0 && 
p
->
aIndex
 ){

124690 
Fts3SegRódî
 *
pSeg
 = 0;

124691 
rc
 = 
	`sqlôe3Fts3SegRódîPídög
(
p
, 
iIndex
, 
zTîm
, 
nTîm
, 
isPªfix
, &
pSeg
);

124692 if–
rc
==
SQLITE_OK
 && 
pSeg
 ){

124693 
rc
 = 
	`·s3SegRódîCurs‹Aµíd
(
pC§
, 
pSeg
);

124697 if–
iLevñ
!=
FTS3_SEGCURSOR_PENDING
 ){

124698 if–
rc
==
SQLITE_OK
 ){

124699 
rc
 = 
	`sqlôe3Fts3AŒSegdús
(
p
, 
iL™gid
, 
iIndex
, 
iLevñ
, &
pStmt
);

124702  
rc
==
SQLITE_OK
 && 
SQLITE_ROW
==‘¯
	`sqlôe3_°ï
(
pStmt
)) ){

124703 
Fts3SegRódî
 *
pSeg
 = 0;

124706 
sqlôe3_öt64
 
iSèπBlock
 = 
	`sqlôe3_cﬁumn_öt64
(
pStmt
, 1);

124707 
sqlôe3_öt64
 
iLóvesEndBlock
 = 
	`sqlôe3_cﬁumn_öt64
(
pStmt
, 2);

124708 
sqlôe3_öt64
 
iEndBlock
 = 
	`sqlôe3_cﬁumn_öt64
(
pStmt
, 3);

124709 
nRoŸ
 = 
	`sqlôe3_cﬁumn_byãs
(
pStmt
, 4);

124710 c⁄° *
zRoŸ
 = 
	`sqlôe3_cﬁumn_blob
(
pStmt
, 4);

124714 if–
iSèπBlock
 && 
zTîm
 ){

124715 
sqlôe3_öt64
 *
pi
 = (
isPªfix
 ? &
iLóvesEndBlock
 : 0);

124716 
rc
 = 
	`·s3Sñe˘Lóf
(
p
, 
zTîm
, 
nTîm
, 
zRoŸ
, 
nRoŸ
, &
iSèπBlock
, 
pi
);

124717 if–
rc
!=
SQLITE_OK
 ) 
föished
;

124718 if–
isPªfix
==0 && 
isSˇn
==0 ) 
iLóvesEndBlock
 = 
iSèπBlock
;

124721 
rc
 = 
	`sqlôe3Fts3SegRódîNew
(
pC§
->
nSegmít
+1,

124722 (
isPªfix
==0 && 
isSˇn
==0),

124723 
iSèπBlock
, 
iLóvesEndBlock
,

124724 
iEndBlock
, 
zRoŸ
, 
nRoŸ
, &
pSeg


124726 if–
rc
!=
SQLITE_OK
 ) 
föished
;

124727 
rc
 = 
	`·s3SegRódîCurs‹Aµíd
(
pC§
, 
pSeg
);

124731 
föished
:

124732 
rc2
 = 
	`sqlôe3_ª£t
(
pStmt
);

124733 if–
rc
==
SQLITE_DONE
 )Ñ¯
rc2
;

124735  
rc
;

124742 
SQLITE_PRIVATE
 
	`sqlôe3Fts3SegRódîCurs‹
(

124743 
Fts3TabÀ
 *
p
,

124744 
iL™gid
,

124745 
iIndex
,

124746 
iLevñ
,

124747 c⁄° *
zTîm
,

124748 
nTîm
,

124749 
isPªfix
,

124750 
isSˇn
,

124751 
Fts3Mu…iSegRódî
 *
pC§


124753 
	`as£π
–
iIndex
>=0 && iIndex<
p
->
nIndex
 );

124754 
	`as£π
–
iLevñ
==
FTS3_SEGCURSOR_ALL


124755 || 
iLevñ
==
FTS3_SEGCURSOR_PENDING


124756 || 
iLevñ
>=0

124758 
	`as£π
–
iLevñ
<
FTS3_SEGDIR_MAXLEVEL
 );

124759 
	`as£π
–
FTS3_SEGCURSOR_ALL
<0 && 
FTS3_SEGCURSOR_PENDING
<0 );

124760 
	`as£π
–
isPªfix
==0 || 
isSˇn
==0 );

124762 
	`mem£t
(
pC§
, 0, (
Fts3Mu…iSegRódî
));

124763  
	`·s3SegRódîCurs‹
(

124764 
p
, 
iL™gid
, 
iIndex
, 
iLevñ
, 
zTîm
, 
nTîm
, 
isPªfix
, 
isSˇn
, 
pC§


124774 
	`·s3SegRódîCurs‹AddZîo
(

124775 
Fts3TabÀ
 *
p
,

124776 
iL™gid
,

124777 c⁄° *
zTîm
,

124778 
nTîm
,

124779 
Fts3Mu…iSegRódî
 *
pC§


124781  
	`·s3SegRódîCurs‹
(
p
,

124782 
iL™gid
, 0, 
FTS3_SEGCURSOR_ALL
, 
zTîm
, 
nTîm
, 0, 0,
pC§


124799 
	`·s3TîmSegRódîCurs‹
(

124800 
Fts3Curs‹
 *
pC§
,

124801 c⁄° *
zTîm
,

124802 
nTîm
,

124803 
isPªfix
,

124804 
Fts3Mu…iSegRódî
 **
µSegc§


124806 
Fts3Mu…iSegRódî
 *
pSegc§
;

124807 
rc
 = 
SQLITE_NOMEM
;

124809 
pSegc§
 = 
	`sqlôe3_mÆloc
((
Fts3Mu…iSegRódî
));

124810 if–
pSegc§
 ){

124811 
i
;

124812 
bFound
 = 0;

124813 
Fts3TabÀ
 *
p
 = (Fts3TabÀ *)
pC§
->
ba£
.
pVèb
;

124815 if–
isPªfix
 ){

124816 
i
=1; 
bFound
==0 && i<
p
->
nIndex
; i++){

124817 if–
p
->
aIndex
[
i
].
nPªfix
==
nTîm
 ){

124818 
bFound
 = 1;

124819 
rc
 = 
	`sqlôe3Fts3SegRódîCurs‹
(
p
, 
pC§
->
iL™gid
,

124820 
i
, 
FTS3_SEGCURSOR_ALL
, 
zTîm
, 
nTîm
, 0, 0, 
pSegc§


124822 
pSegc§
->
bLookup
 = 1;

124826 
i
=1; 
bFound
==0 && i<
p
->
nIndex
; i++){

124827 if–
p
->
aIndex
[
i
].
nPªfix
==
nTîm
+1 ){

124828 
bFound
 = 1;

124829 
rc
 = 
	`sqlôe3Fts3SegRódîCurs‹
(
p
, 
pC§
->
iL™gid
,

124830 
i
, 
FTS3_SEGCURSOR_ALL
, 
zTîm
, 
nTîm
, 1, 0, 
pSegc§


124832 if–
rc
==
SQLITE_OK
 ){

124833 
rc
 = 
	`·s3SegRódîCurs‹AddZîo
(

124834 
p
, 
pC§
->
iL™gid
, 
zTîm
, 
nTîm
, 
pSegc§


124841 if–
bFound
==0 ){

124842 
rc
 = 
	`sqlôe3Fts3SegRódîCurs‹
(
p
, 
pC§
->
iL™gid
,

124843 0, 
FTS3_SEGCURSOR_ALL
, 
zTîm
, 
nTîm
, 
isPªfix
, 0, 
pSegc§


124845 
pSegc§
->
bLookup
 = !
isPªfix
;

124849 *
µSegc§
 = 
pSegc§
;

124850  
rc
;

124856 
	`·s3SegRódîCurs‹Fªe
(
Fts3Mu…iSegRódî
 *
pSegc§
){

124857 
	`sqlôe3Fts3SegRódîFöish
(
pSegc§
);

124858 
	`sqlôe3_‰ì
(
pSegc§
);

124865 
	`·s3TîmSñe˘
(

124866 
Fts3TabÀ
 *
p
,

124867 
Fts3Phø£Tokí
 *
pTok
,

124868 
iCﬁumn
,

124869 *
≤Out
,

124870 **
µOut


124872 
rc
;

124873 
Fts3Mu…iSegRódî
 *
pSegc§
;

124874 
TîmSñe˘
 
tsc
;

124875 
Fts3SegFûãr
 
fûãr
;

124877 
pSegc§
 = 
pTok
->pSegcsr;

124878 
	`mem£t
(&
tsc
, 0, (
TîmSñe˘
));

124880 
fûãr
.
Êags
 = 
FTS3_SEGMENT_IGNORE_EMPTY
 | 
FTS3_SEGMENT_REQUIRE_POS


124881 | (
pTok
->
isPªfix
 ? 
FTS3_SEGMENT_PREFIX
 : 0)

124882 | (
pTok
->
bFú°
 ? 
FTS3_SEGMENT_FIRST
 : 0)

124883 | (
iCﬁumn
<
p
->
nCﬁumn
 ? 
FTS3_SEGMENT_COLUMN_FILTER
 : 0);

124884 
fûãr
.
iCﬁ
 = 
iCﬁumn
;

124885 
fûãr
.
zTîm
 = 
pTok
->
z
;

124886 
fûãr
.
nTîm
 = 
pTok
->
n
;

124888 
rc
 = 
	`sqlôe3Fts3SegRódîSèπ
(
p
, 
pSegc§
, &
fûãr
);

124889  
SQLITE_OK
==
rc


124890 && 
SQLITE_ROW
==(
rc
 = 
	`sqlôe3Fts3SegRódîSãp
(
p
, 
pSegc§
))

124892 
rc
 = 
	`·s3TîmSñe˘Mîge
(
p
, &
tsc
, 
pSegc§
->
aDo˛i°
,ÖSegc§->
nDo˛i°
);

124895 if–
rc
==
SQLITE_OK
 ){

124896 
rc
 = 
	`·s3TîmSñe˘FöishMîge
(
p
, &
tsc
);

124898 if–
rc
==
SQLITE_OK
 ){

124899 *
µOut
 = 
tsc
.
ØOuçut
[0];

124900 *
≤Out
 = 
tsc
.
™Ouçut
[0];

124902 
i
;

124903 
i
=0; i<
	`SizeofAºay
(
tsc
.
ØOuçut
); i++){

124904 
	`sqlôe3_‰ì
(
tsc
.
ØOuçut
[
i
]);

124908 
	`·s3SegRódîCurs‹Fªe
(
pSegc§
);

124909 
pTok
->
pSegc§
 = 0;

124910  
rc
;

124922 
	`·s3Do˛i°Cou¡Docids
(*
aLi°
, 
nLi°
){

124923 
nDoc
 = 0;

124924 if–
aLi°
 ){

124925 *
aEnd
 = &
aLi°
[
nLi°
];

124926 *
p
 = 
aLi°
;

124927  
p
<
aEnd
 ){

124928 
nDoc
++;

124929  (*
p
++)&0x80 );

124930 
	`·s3Po¶i°C›y
(0, &
p
);

124934  
nDoc
;

124948 
	`·s3NextMëhod
(
sqlôe3_vèb_curs‹
 *
pCurs‹
){

124949 
rc
;

124950 
Fts3Curs‹
 *
pC§
 = (Fts3Curs‹ *)
pCurs‹
;

124951 if–
pC§
->
eSórch
==
FTS3_DOCID_SEARCH
 ||ÖC§->eSórch==
FTS3_FULLSCAN_SEARCH
 ){

124952 if–
SQLITE_ROW
!=
	`sqlôe3_°ï
(
pC§
->
pStmt
) ){

124953 
pC§
->
isEof
 = 1;

124954 
rc
 = 
	`sqlôe3_ª£t
(
pC§
->
pStmt
);

124956 
pC§
->
iPªvId
 = 
	`sqlôe3_cﬁumn_öt64
’C§->
pStmt
, 0);

124957 
rc
 = 
SQLITE_OK
;

124960 
rc
 = 
	`·s3EvÆNext
((
Fts3Curs‹
 *)
pCurs‹
);

124962 
	`as£π
–((
Fts3TabÀ
 *)
pC§
->
ba£
.
pVèb
)->
pSegmíts
==0 );

124963  
rc
;

124973 #i‚de‡
SQLITE_AMALGAMATION


124974 
	#LARGEST_INT64
 (0xffffffff|(((
sqlôe3_öt64
)0x7fffffff)<<32))

	)

124975 
	#SMALLEST_INT64
 (((
sqlôe3_öt64
)-1Ë- 
LARGEST_INT64
)

	)

124983 
sqlôe3_öt64
 
	`·s3DocidR™ge
(
sqlôe3_vÆue
 *
pVÆ
, 
i64
 
iDeÁu…
){

124984 if–
pVÆ
 ){

124985 
eTy≥
 = 
	`sqlôe3_vÆue_numîic_ty≥
(
pVÆ
);

124986 if–
eTy≥
==
SQLITE_INTEGER
 ){

124987  
	`sqlôe3_vÆue_öt64
(
pVÆ
);

124990  
iDeÁu…
;

125009 
	`·s3FûãrMëhod
(

125010 
sqlôe3_vèb_curs‹
 *
pCurs‹
,

125011 
idxNum
,

125012 c⁄° *
idxSå
,

125013 
nVÆ
,

125014 
sqlôe3_vÆue
 **
≠VÆ


125016 
rc
;

125017 *
zSql
;

125018 
eSórch
;

125019 
Fts3TabÀ
 *
p
 = (Fts3TabÀ *)
pCurs‹
->
pVèb
;

125020 
Fts3Curs‹
 *
pC§
 = (Fts3Curs‹ *)
pCurs‹
;

125022 
sqlôe3_vÆue
 *
pC⁄s
 = 0;

125023 
sqlôe3_vÆue
 *
pL™gid
 = 0;

125024 
sqlôe3_vÆue
 *
pDocidGe
 = 0;

125025 
sqlôe3_vÆue
 *
pDocidLe
 = 0;

125026 
iIdx
;

125028 
	`UNUSED_PARAMETER
(
idxSå
);

125029 
	`UNUSED_PARAMETER
(
nVÆ
);

125031 
eSórch
 = (
idxNum
 & 0x0000FFFF);

125032 
	`as£π
–
eSórch
>=0 &&ÉSórch<=(
FTS3_FULLTEXT_SEARCH
+
p
->
nCﬁumn
) );

125033 
	`as£π
–
p
->
pSegmíts
==0 );

125036 
iIdx
 = 0;

125037 if–
eSórch
!=
FTS3_FULLSCAN_SEARCH
 ) 
pC⁄s
 = 
≠VÆ
[
iIdx
++];

125038 if–
idxNum
 & 
FTS3_HAVE_LANGID
 ) 
pL™gid
 = 
≠VÆ
[
iIdx
++];

125039 if–
idxNum
 & 
FTS3_HAVE_DOCID_GE
 ) 
pDocidGe
 = 
≠VÆ
[
iIdx
++];

125040 if–
idxNum
 & 
FTS3_HAVE_DOCID_LE
 ) 
pDocidLe
 = 
≠VÆ
[
iIdx
++];

125041 
	`as£π
–
iIdx
==
nVÆ
 );

125044 
	`sqlôe3_föÆize
(
pC§
->
pStmt
);

125045 
	`sqlôe3_‰ì
(
pC§
->
aDo˛i°
);

125046 
	`sqlôe3Fts3Ex¥Fªe
(
pC§
->
pEx¥
);

125047 
	`mem£t
(&
pCurs‹
[1], 0, (
Fts3Curs‹
)-(
sqlôe3_vèb_curs‹
));

125050 
pC§
->
iMöDocid
 = 
	`·s3DocidR™ge
(
pDocidGe
, 
SMALLEST_INT64
);

125051 
pC§
->
iMaxDocid
 = 
	`·s3DocidR™ge
(
pDocidLe
, 
LARGEST_INT64
);

125053 if–
idxSå
 ){

125054 
pC§
->
bDesc
 = (
idxSå
[0]=='D');

125056 
pC§
->
bDesc
 = 
p
->
bDescIdx
;

125058 
pC§
->
eSórch
 = (
i16
)eSearch;

125060 if–
eSórch
!=
FTS3_DOCID_SEARCH
 &&ÉSórch!=
FTS3_FULLSCAN_SEARCH
 ){

125061 
iCﬁ
 = 
eSórch
-
FTS3_FULLTEXT_SEARCH
;

125062 c⁄° *
zQuîy
 = (c⁄° *)
	`sqlôe3_vÆue_ãxt
(
pC⁄s
);

125064 if–
zQuîy
==0 && 
	`sqlôe3_vÆue_ty≥
(
pC⁄s
)!=
SQLITE_NULL
 ){

125065  
SQLITE_NOMEM
;

125068 
pC§
->
iL™gid
 = 0;

125069 if–
pL™gid
 ) 
pC§
->
iL™gid
 = 
	`sqlôe3_vÆue_öt
(pLangid);

125071 
	`as£π
–
p
->
ba£
.
zEºMsg
==0 );

125072 
rc
 = 
	`sqlôe3Fts3Ex¥P¨£
(
p
->
pTokíizî
, 
pC§
->
iL™gid
,

125073 
p
->
azCﬁumn
,Ö->
bFts4
,Ö->
nCﬁumn
, 
iCﬁ
, 
zQuîy
, -1, &
pC§
->
pEx¥
,

125074 &
p
->
ba£
.
zEºMsg


125076 if–
rc
!=
SQLITE_OK
 ){

125077  
rc
;

125080 
rc
 = 
	`·s3EvÆSèπ
(
pC§
);

125081 
	`sqlôe3Fts3SegmítsClo£
(
p
);

125082 if–
rc
!=
SQLITE_OK
 ) Ñc;

125083 
pC§
->
pNextId
 =ÖC§->
aDo˛i°
;

125084 
pC§
->
iPªvId
 = 0;

125092 if–
eSórch
==
FTS3_FULLSCAN_SEARCH
 ){

125093 
zSql
 = 
	`sqlôe3_m¥ötf
(

125095 
p
->
zRódEx¥li°
, (
pC§
->
bDesc
 ? "DESC" : "ASC")

125097 if–
zSql
 ){

125098 
rc
 = 
	`sqlôe3_¥ï¨e_v2
(
p
->
db
, 
zSql
, -1, &
pC§
->
pStmt
, 0);

125099 
	`sqlôe3_‰ì
(
zSql
);

125101 
rc
 = 
SQLITE_NOMEM
;

125103 }if–
eSórch
==
FTS3_DOCID_SEARCH
 ){

125104 
rc
 = 
	`·s3Curs‹SìkStmt
(
pC§
, &pC§->
pStmt
);

125105 if–
rc
==
SQLITE_OK
 ){

125106 
rc
 = 
	`sqlôe3_böd_vÆue
(
pC§
->
pStmt
, 1, 
pC⁄s
);

125109 if–
rc
!=
SQLITE_OK
 ) Ñc;

125111  
	`·s3NextMëhod
(
pCurs‹
);

125118 
	`·s3EofMëhod
(
sqlôe3_vèb_curs‹
 *
pCurs‹
){

125119  ((
Fts3Curs‹
 *)
pCurs‹
)->
isEof
;

125128 
	`·s3RowidMëhod
(
sqlôe3_vèb_curs‹
 *
pCurs‹
, 
sqlôe_öt64
 *
pRowid
){

125129 
Fts3Curs‹
 *
pC§
 = (Fts3Curs‹ *Ë
pCurs‹
;

125130 *
pRowid
 = 
pC§
->
iPªvId
;

125131  
SQLITE_OK
;

125145 
	`·s3CﬁumnMëhod
(

125146 
sqlôe3_vèb_curs‹
 *
pCurs‹
,

125147 
sqlôe3_c⁄ãxt
 *
pCtx
,

125148 
iCﬁ


125150 
rc
 = 
SQLITE_OK
;

125151 
Fts3Curs‹
 *
pC§
 = (Fts3Curs‹ *Ë
pCurs‹
;

125152 
Fts3TabÀ
 *
p
 = (Fts3TabÀ *)
pCurs‹
->
pVèb
;

125155 
	`as£π
–
iCﬁ
>=0 && iCﬁ<=
p
->
nCﬁumn
+2 );

125157 if–
iCﬁ
==
p
->
nCﬁumn
+1 ){

125161 
	`sqlôe3_ªsu…_öt64
(
pCtx
, 
pC§
->
iPªvId
);

125162 }if–
iCﬁ
==
p
->
nCﬁumn
 ){

125165 
	`sqlôe3_ªsu…_blob
(
pCtx
, &
pC§
, ’C§), 
SQLITE_TRANSIENT
);

125166 }if–
iCﬁ
==
p
->
nCﬁumn
+2 && 
pC§
->
pEx¥
 ){

125167 
	`sqlôe3_ªsu…_öt64
(
pCtx
, 
pC§
->
iL™gid
);

125171 
rc
 = 
	`·s3Curs‹Sìk
(0, 
pC§
);

125173 if–
rc
==
SQLITE_OK
 ){

125174 if–
iCﬁ
==
p
->
nCﬁumn
+2 ){

125175 
iL™gid
 = 0;

125176 if–
p
->
zL™guageid
 ){

125177 
iL™gid
 = 
	`sqlôe3_cﬁumn_öt
(
pC§
->
pStmt
, 
p
->
nCﬁumn
+1);

125179 
	`sqlôe3_ªsu…_öt
(
pCtx
, 
iL™gid
);

125180 }if–
	`sqlôe3_d©a_cou¡
(
pC§
->
pStmt
)>(
iCﬁ
+1) ){

125181 
	`sqlôe3_ªsu…_vÆue
(
pCtx
, 
	`sqlôe3_cﬁumn_vÆue
(
pC§
->
pStmt
, 
iCﬁ
+1));

125186 
	`as£π
–((
Fts3TabÀ
 *)
pC§
->
ba£
.
pVèb
)->
pSegmíts
==0 );

125187  
rc
;

125195 
	`·s3Upd©eMëhod
(

125196 
sqlôe3_vèb
 *
pVèb
,

125197 
nArg
,

125198 
sqlôe3_vÆue
 **
≠VÆ
,

125199 
sqlôe_öt64
 *
pRowid


125201  
	`sqlôe3Fts3Upd©eMëhod
(
pVèb
, 
nArg
, 
≠VÆ
, 
pRowid
);

125208 
	`·s3SyncMëhod
(
sqlôe3_vèb
 *
pVèb
){

125229 c⁄° 
u32
 
nMöMîge
 = 64;

125231 
Fts3TabÀ
 *
p
 = (Fts3TabÀ*)
pVèb
;

125232 
rc
 = 
	`sqlôe3Fts3PídögTîmsFlush
(
p
);

125234 if–
rc
==
SQLITE_OK
 && 
p
->
bAutoö¸mîge
==1 &&Ö->
nLófAdd
>(
nMöMîge
/16) ){

125235 
mxLevñ
 = 0;

125236 
A
;

125238 
rc
 = 
	`sqlôe3Fts3MaxLevñ
(
p
, &
mxLevñ
);

125239 
	`as£π
–
rc
==
SQLITE_OK
 || 
mxLevñ
==0 );

125240 
A
 = 
p
->
nLófAdd
 * 
mxLevñ
;

125241 
A
 += (A/2);

125242 if–
A
>()
nMöMîge
 ) 
rc
 = 
	`sqlôe3Fts3In¸mîge
(
p
, A, 8);

125244 
	`sqlôe3Fts3SegmítsClo£
(
p
);

125245  
rc
;

125251 
	`·s3BegöMëhod
(
sqlôe3_vèb
 *
pVèb
){

125252 
Fts3TabÀ
 *
p
 = (Fts3TabÀ*)
pVèb
;

125253 
	`UNUSED_PARAMETER
(
pVèb
);

125254 
	`as£π
–
p
->
pSegmíts
==0 );

125255 
	`as£π
–
p
->
nPídögD©a
==0 );

125256 
	`as£π
–
p
->
öTønß˘i⁄
!=1 );

125257 
	`TESTONLY
–
p
->
öTønß˘i⁄
 = 1 );

125258 
	`TESTONLY
–
p
->
mxSavïoöt
 = -1; );

125259 
p
->
nLófAdd
 = 0;

125260  
SQLITE_OK
;

125268 
	`·s3CommôMëhod
(
sqlôe3_vèb
 *
pVèb
){

125269 
	`TESTONLY
–
Fts3TabÀ
 *
p
 = (Fts3TabÀ*)
pVèb
 );

125270 
	`UNUSED_PARAMETER
(
pVèb
);

125271 
	`as£π
–
p
->
nPídögD©a
==0 );

125272 
	`as£π
–
p
->
öTønß˘i⁄
!=0 );

125273 
	`as£π
–
p
->
pSegmíts
==0 );

125274 
	`TESTONLY
–
p
->
öTønß˘i⁄
 = 0 );

125275 
	`TESTONLY
–
p
->
mxSavïoöt
 = -1; );

125276  
SQLITE_OK
;

125283 
	`·s3RﬁlbackMëhod
(
sqlôe3_vèb
 *
pVèb
){

125284 
Fts3TabÀ
 *
p
 = (Fts3TabÀ*)
pVèb
;

125285 
	`sqlôe3Fts3PídögTîmsCÀ¨
(
p
);

125286 
	`as£π
–
p
->
öTønß˘i⁄
!=0 );

125287 
	`TESTONLY
–
p
->
öTønß˘i⁄
 = 0 );

125288 
	`TESTONLY
–
p
->
mxSavïoöt
 = -1; );

125289  
SQLITE_OK
;

125298 
	`·s3Revî£Po¶i°
(*
pSèπ
, **
µPo¶i°
){

125299 *
p
 = &(*
µPo¶i°
)[-2];

125300 
c
 = 0;

125302  
p
>
pSèπ
 && (
c
=*p--)==0 );

125303  
p
>
pSèπ
 && (*∞& 0x80Ë| 
c
 ){

125304 
c
 = *
p
--;

125306 if–
p
>
pSèπ
 ){Ö = &p[2]; }

125307  *
p
++&0x80 );

125308 *
µPo¶i°
 = 
p
;

125321 
	`·s3Fun˘i⁄Arg
(

125322 
sqlôe3_c⁄ãxt
 *
pC⁄ãxt
,

125323 c⁄° *
zFunc
,

125324 
sqlôe3_vÆue
 *
pVÆ
,

125325 
Fts3Curs‹
 **
µC§


125327 
Fts3Curs‹
 *
pRë
;

125328 if–
	`sqlôe3_vÆue_ty≥
(
pVÆ
)!=
SQLITE_BLOB


125329 || 
	`sqlôe3_vÆue_byãs
(
pVÆ
)!=(
Fts3Curs‹
 *)

125331 *
zEº
 = 
	`sqlôe3_m¥ötf
("ûÀgÆ fú°árgumíàtÿ%s", 
zFunc
);

125332 
	`sqlôe3_ªsu…_îr‹
(
pC⁄ãxt
, 
zEº
, -1);

125333 
	`sqlôe3_‰ì
(
zEº
);

125334  
SQLITE_ERROR
;

125336 
	`mem˝y
(&
pRë
, 
	`sqlôe3_vÆue_blob
(
pVÆ
), (
Fts3Curs‹
 *));

125337 *
µC§
 = 
pRë
;

125338  
SQLITE_OK
;

125344 
	`·s3Snù≥tFunc
(

125345 
sqlôe3_c⁄ãxt
 *
pC⁄ãxt
,

125346 
nVÆ
,

125347 
sqlôe3_vÆue
 **
≠VÆ


125349 
Fts3Curs‹
 *
pC§
;

125350 c⁄° *
zSèπ
 = "<b>";

125351 c⁄° *
zEnd
 = "</b>";

125352 c⁄° *
zEŒùsis
 = "<b>...</b>";

125353 
iCﬁ
 = -1;

125354 
nTokí
 = 15;

125359 
	`as£π
–
nVÆ
>=1 );

125361 if–
nVÆ
>6 ){

125362 
	`sqlôe3_ªsu…_îr‹
(
pC⁄ãxt
,

125366 if–
	`·s3Fun˘i⁄Arg
(
pC⁄ãxt
, "¢ù≥t", 
≠VÆ
[0], &
pC§
) ) ;

125368  
nVÆ
 ){

125369 6: 
nTokí
 = 
	`sqlôe3_vÆue_öt
(
≠VÆ
[5]);

125370 5: 
iCﬁ
 = 
	`sqlôe3_vÆue_öt
(
≠VÆ
[4]);

125371 4: 
zEŒùsis
 = (c⁄° *)
	`sqlôe3_vÆue_ãxt
(
≠VÆ
[3]);

125372 3: 
zEnd
 = (c⁄° *)
	`sqlôe3_vÆue_ãxt
(
≠VÆ
[2]);

125373 2: 
zSèπ
 = (c⁄° *)
	`sqlôe3_vÆue_ãxt
(
≠VÆ
[1]);

125375 if–!
zEŒùsis
 || !
zEnd
 || !
zSèπ
 ){

125376 
	`sqlôe3_ªsu…_îr‹_nomem
(
pC⁄ãxt
);

125377 }if–
SQLITE_OK
==
	`·s3Curs‹Sìk
(
pC⁄ãxt
, 
pC§
) ){

125378 
	`sqlôe3Fts3Snù≥t
(
pC⁄ãxt
, 
pC§
, 
zSèπ
, 
zEnd
, 
zEŒùsis
, 
iCﬁ
, 
nTokí
);

125385 
	`·s3Off£tsFunc
(

125386 
sqlôe3_c⁄ãxt
 *
pC⁄ãxt
,

125387 
nVÆ
,

125388 
sqlôe3_vÆue
 **
≠VÆ


125390 
Fts3Curs‹
 *
pC§
;

125392 
	`UNUSED_PARAMETER
(
nVÆ
);

125394 
	`as£π
–
nVÆ
==1 );

125395 if–
	`·s3Fun˘i⁄Arg
(
pC⁄ãxt
, "off£ts", 
≠VÆ
[0], &
pC§
) ) ;

125396 
	`as£π
–
pC§
 );

125397 if–
SQLITE_OK
==
	`·s3Curs‹Sìk
(
pC⁄ãxt
, 
pC§
) ){

125398 
	`sqlôe3Fts3Off£ts
(
pC⁄ãxt
, 
pC§
);

125411 
	`·s3O±imizeFunc
(

125412 
sqlôe3_c⁄ãxt
 *
pC⁄ãxt
,

125413 
nVÆ
,

125414 
sqlôe3_vÆue
 **
≠VÆ


125416 
rc
;

125417 
Fts3TabÀ
 *
p
;

125418 
Fts3Curs‹
 *
pCurs‹
;

125420 
	`UNUSED_PARAMETER
(
nVÆ
);

125422 
	`as£π
–
nVÆ
==1 );

125423 if–
	`·s3Fun˘i⁄Arg
(
pC⁄ãxt
, "›timize", 
≠VÆ
[0], &
pCurs‹
) ) ;

125424 
p
 = (
Fts3TabÀ
 *)
pCurs‹
->
ba£
.
pVèb
;

125425 
	`as£π
–
p
 );

125427 
rc
 = 
	`sqlôe3Fts3O±imize
(
p
);

125429  
rc
 ){

125430 
SQLITE_OK
:

125431 
	`sqlôe3_ªsu…_ãxt
(
pC⁄ãxt
, "Index o±imized", -1, 
SQLITE_STATIC
);

125433 
SQLITE_DONE
:

125434 
	`sqlôe3_ªsu…_ãxt
(
pC⁄ãxt
, "IndexáÃódy o±imÆ", -1, 
SQLITE_STATIC
);

125437 
	`sqlôe3_ªsu…_îr‹_code
(
pC⁄ãxt
, 
rc
);

125445 
	`·s3M©chöfoFunc
(

125446 
sqlôe3_c⁄ãxt
 *
pC⁄ãxt
,

125447 
nVÆ
,

125448 
sqlôe3_vÆue
 **
≠VÆ


125450 
Fts3Curs‹
 *
pC§
;

125451 
	`as£π
–
nVÆ
==1 ||ÇVal==2 );

125452 if–
SQLITE_OK
==
	`·s3Fun˘i⁄Arg
(
pC⁄ãxt
, "m©chöfo", 
≠VÆ
[0], &
pC§
) ){

125453 c⁄° *
zArg
 = 0;

125454 if–
nVÆ
>1 ){

125455 
zArg
 = (c⁄° *)
	`sqlôe3_vÆue_ãxt
(
≠VÆ
[1]);

125457 
	`sqlôe3Fts3M©chöfo
(
pC⁄ãxt
, 
pC§
, 
zArg
);

125465 
	`·s3FödFun˘i⁄Mëhod
(

125466 
sqlôe3_vèb
 *
pVèb
,

125467 
nArg
,

125468 c⁄° *
zName
,

125469 (**
pxFunc
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
**),

125470 **
µArg


125472 
	sOvîlﬂded
 {

125473 c⁄° *
zName
;

125474 (*
xFunc
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
**);

125475 } 
aOvîlﬂd
[] = {

125476 { "¢ù≥t", 
·s3Snù≥tFunc
 },

125477 { "off£ts", 
·s3Off£tsFunc
 },

125478 { "›timize", 
·s3O±imizeFunc
 },

125479 { "m©chöfo", 
·s3M©chöfoFunc
 },

125481 
i
;

125483 
	`UNUSED_PARAMETER
(
pVèb
);

125484 
	`UNUSED_PARAMETER
(
nArg
);

125485 
	`UNUSED_PARAMETER
(
µArg
);

125487 
i
=0; i<
	`SizeofAºay
(
aOvîlﬂd
); i++){

125488 if–
	`°rcmp
(
zName
, 
aOvîlﬂd
[
i
].zName)==0 ){

125489 *
pxFunc
 = 
aOvîlﬂd
[
i
].
xFunc
;

125501 
	`·s3RíameMëhod
(

125502 
sqlôe3_vèb
 *
pVèb
,

125503 c⁄° *
zName


125505 
Fts3TabÀ
 *
p
 = (Fts3TabÀ *)
pVèb
;

125506 
sqlôe3
 *
db
 = 
p
->db;

125507 
rc
;

125515 
	`as£π
–
p
->
nPídögD©a
==0 );

125516 
rc
 = 
	`sqlôe3Fts3PídögTîmsFlush
(
p
);

125518 if–
p
->
zC⁄ã¡Tbl
==0 ){

125519 
	`·s3DbExec
(&
rc
, 
db
,

125521 
p
->
zDb
,Ö->
zName
, zName

125525 if–
p
->
bHasDocsize
 ){

125526 
	`·s3DbExec
(&
rc
, 
db
,

125528 
p
->
zDb
,Ö->
zName
, zName

125531 if–
p
->
bHasSèt
 ){

125532 
	`·s3DbExec
(&
rc
, 
db
,

125534 
p
->
zDb
,Ö->
zName
, zName

125537 
	`·s3DbExec
(&
rc
, 
db
,

125539 
p
->
zDb
,Ö->
zName
, zName

125541 
	`·s3DbExec
(&
rc
, 
db
,

125543 
p
->
zDb
,Ö->
zName
, zName

125545  
rc
;

125553 
	`·s3SavïoötMëhod
(
sqlôe3_vèb
 *
pVèb
, 
iSavïoöt
){

125554 
rc
 = 
SQLITE_OK
;

125555 
	`UNUSED_PARAMETER
(
iSavïoöt
);

125556 
	`as£π
–((
Fts3TabÀ
 *)
pVèb
)->
öTønß˘i⁄
 );

125557 
	`as£π
–((
Fts3TabÀ
 *)
pVèb
)->
mxSavïoöt
 < 
iSavïoöt
 );

125558 
	`TESTONLY
–((
Fts3TabÀ
 *)
pVèb
)->
mxSavïoöt
 = 
iSavïoöt
 );

125559 if–((
Fts3TabÀ
 *)
pVèb
)->
bIgn‹eSavïoöt
==0 ){

125560 
rc
 = 
	`·s3SyncMëhod
(
pVèb
);

125562  
rc
;

125570 
	`·s3Rñó£Mëhod
(
sqlôe3_vèb
 *
pVèb
, 
iSavïoöt
){

125571 
	`TESTONLY
–
Fts3TabÀ
 *
p
 = (Fts3TabÀ*)
pVèb
 );

125572 
	`UNUSED_PARAMETER
(
iSavïoöt
);

125573 
	`UNUSED_PARAMETER
(
pVèb
);

125574 
	`as£π
–
p
->
öTønß˘i⁄
 );

125575 
	`as£π
–
p
->
mxSavïoöt
 >
iSavïoöt
 );

125576 
	`TESTONLY
–
p
->
mxSavïoöt
 = 
iSavïoöt
-1 );

125577  
SQLITE_OK
;

125585 
	`·s3RﬁlbackToMëhod
(
sqlôe3_vèb
 *
pVèb
, 
iSavïoöt
){

125586 
Fts3TabÀ
 *
p
 = (Fts3TabÀ*)
pVèb
;

125587 
	`UNUSED_PARAMETER
(
iSavïoöt
);

125588 
	`as£π
–
p
->
öTønß˘i⁄
 );

125589 
	`as£π
–
p
->
mxSavïoöt
 >
iSavïoöt
 );

125590 
	`TESTONLY
–
p
->
mxSavïoöt
 = 
iSavïoöt
 );

125591 
	`sqlôe3Fts3PídögTîmsCÀ¨
(
p
);

125592  
SQLITE_OK
;

125595 c⁄° 
sqlôe3_moduÀ
 
·s3ModuÀ
 = {

125597  
·s3Cª©eMëhod
,

125598  
·s3C⁄√˘Mëhod
,

125599  
·s3Be°IndexMëhod
,

125600  
·s3Disc⁄√˘Mëhod
,

125601  
·s3De°royMëhod
,

125602  
·s3O≥nMëhod
,

125603  
·s3Clo£Mëhod
,

125604  
·s3FûãrMëhod
,

125605  
·s3NextMëhod
,

125606  
·s3EofMëhod
,

125607  
·s3CﬁumnMëhod
,

125608  
·s3RowidMëhod
,

125609  
·s3Upd©eMëhod
,

125610  
·s3BegöMëhod
,

125611  
·s3SyncMëhod
,

125612  
·s3CommôMëhod
,

125613  
·s3RﬁlbackMëhod
,

125614  
·s3FödFun˘i⁄Mëhod
,

125615  
·s3RíameMëhod
,

125616  
·s3SavïoötMëhod
,

125617  
·s3Rñó£Mëhod
,

125618  
·s3RﬁlbackToMëhod
,

125626 
	`hashDe°roy
(*
p
){

125627 
Fts3Hash
 *
pHash
 = (Fts3Hash *)
p
;

125628 
	`sqlôe3Fts3HashCÀ¨
(
pHash
);

125629 
	`sqlôe3_‰ì
(
pHash
);

125642 
SQLITE_PRIVATE
 
	`sqlôe3Fts3Sim∂eTokíizîModuÀ
(
sqlôe3_tokíizî_moduÀ
 c⁄°**
µModuÀ
);

125643 
SQLITE_PRIVATE
 
	`sqlôe3Fts3P‹ãrTokíizîModuÀ
(
sqlôe3_tokíizî_moduÀ
 c⁄°**
µModuÀ
);

125644 #ifde‡
SQLITE_ENABLE_FTS4_UNICODE61


125645 
SQLITE_PRIVATE
 
	`sqlôe3Fts3UnicodeTokíizî
(
sqlôe3_tokíizî_moduÀ
 c⁄°**
µModuÀ
);

125647 #ifde‡
SQLITE_ENABLE_ICU


125648 
SQLITE_PRIVATE
 
	`sqlôe3Fts3IcuTokíizîModuÀ
(
sqlôe3_tokíizî_moduÀ
 c⁄°**
µModuÀ
);

125657 
SQLITE_PRIVATE
 
	`sqlôe3Fts3Inô
(
sqlôe3
 *
db
){

125658 
rc
 = 
SQLITE_OK
;

125659 
Fts3Hash
 *
pHash
 = 0;

125660 c⁄° 
sqlôe3_tokíizî_moduÀ
 *
pSim∂e
 = 0;

125661 c⁄° 
sqlôe3_tokíizî_moduÀ
 *
pP‹ãr
 = 0;

125662 #ifde‡
SQLITE_ENABLE_FTS4_UNICODE61


125663 c⁄° 
sqlôe3_tokíizî_moduÀ
 *
pUnicode
 = 0;

125666 #ifde‡
SQLITE_ENABLE_ICU


125667 c⁄° 
sqlôe3_tokíizî_moduÀ
 *
pIcu
 = 0;

125668 
	`sqlôe3Fts3IcuTokíizîModuÀ
(&
pIcu
);

125671 #ifde‡
SQLITE_ENABLE_FTS4_UNICODE61


125672 
	`sqlôe3Fts3UnicodeTokíizî
(&
pUnicode
);

125675 #ifde‡
SQLITE_TEST


125676 
rc
 = 
	`sqlôe3Fts3InôTîm
(
db
);

125677 if–
rc
!=
SQLITE_OK
 ) Ñc;

125680 
rc
 = 
	`sqlôe3Fts3InôAux
(
db
);

125681 if–
rc
!=
SQLITE_OK
 ) Ñc;

125683 
	`sqlôe3Fts3Sim∂eTokíizîModuÀ
(&
pSim∂e
);

125684 
	`sqlôe3Fts3P‹ãrTokíizîModuÀ
(&
pP‹ãr
);

125687 
pHash
 = 
	`sqlôe3_mÆloc
((
Fts3Hash
));

125688 if–!
pHash
 ){

125689 
rc
 = 
SQLITE_NOMEM
;

125691 
	`sqlôe3Fts3HashInô
(
pHash
, 
FTS3_HASH_STRING
, 1);

125695 if–
rc
==
SQLITE_OK
 ){

125696 if–
	`sqlôe3Fts3HashIn£π
(
pHash
, "sim∂e", 7, (*)
pSim∂e
)

125697 || 
	`sqlôe3Fts3HashIn£π
(
pHash
, "p‹ãr", 7, (*)
pP‹ãr
)

125699 #ifde‡
SQLITE_ENABLE_FTS4_UNICODE61


125700 || 
	`sqlôe3Fts3HashIn£π
(
pHash
, "unicode61", 10, (*)
pUnicode
)

125702 #ifde‡
SQLITE_ENABLE_ICU


125703 || (
pIcu
 && 
	`sqlôe3Fts3HashIn£π
(
pHash
, "icu", 4, (*)pIcu))

125706 
rc
 = 
SQLITE_NOMEM
;

125710 #ifde‡
SQLITE_TEST


125711 if–
rc
==
SQLITE_OK
 ){

125712 
rc
 = 
	`sqlôe3Fts3Ex¥InôTe°I¡îÁ˚
(
db
);

125720 if–
SQLITE_OK
==
rc


125721 && 
SQLITE_OK
==(
rc
 = 
	`sqlôe3Fts3InôHashTabÀ
(
db
, 
pHash
, "fts3_tokenizer"))

125722 && 
SQLITE_OK
==(
rc
 = 
	`sqlôe3_ovîlﬂd_fun˘i⁄
(
db
, "snippet", -1))

125723 && 
SQLITE_OK
==(
rc
 = 
	`sqlôe3_ovîlﬂd_fun˘i⁄
(
db
, "offsets", 1))

125724 && 
SQLITE_OK
==(
rc
 = 
	`sqlôe3_ovîlﬂd_fun˘i⁄
(
db
, "matchinfo", 1))

125725 && 
SQLITE_OK
==(
rc
 = 
	`sqlôe3_ovîlﬂd_fun˘i⁄
(
db
, "matchinfo", 2))

125726 && 
SQLITE_OK
==(
rc
 = 
	`sqlôe3_ovîlﬂd_fun˘i⁄
(
db
, "optimize", 1))

125728 
rc
 = 
	`sqlôe3_¸óã_moduÀ_v2
(

125729 
db
, "·s3", &
·s3ModuÀ
, (*)
pHash
, 
hashDe°roy


125731 if–
rc
==
SQLITE_OK
 ){

125732 
rc
 = 
	`sqlôe3_¸óã_moduÀ_v2
(

125733 
db
, "·s4", &
·s3ModuÀ
, (*)
pHash
, 0

125736 if–
rc
==
SQLITE_OK
 ){

125737 
rc
 = 
	`sqlôe3Fts3InôTok
(
db
, (*)
pHash
);

125739  
rc
;

125744 
	`as£π
–
rc
!=
SQLITE_OK
 );

125745 if–
pHash
 ){

125746 
	`sqlôe3Fts3HashCÀ¨
(
pHash
);

125747 
	`sqlôe3_‰ì
(
pHash
);

125749  
rc
;

125767 
	`·s3EvÆAŒoˇãRódîs
(

125768 
Fts3Curs‹
 *
pC§
,

125769 
Fts3Ex¥
 *
pEx¥
,

125770 *
≤Tokí
,

125771 *
≤Or
,

125772 *
pRc


125774 if–
pEx¥
 && 
SQLITE_OK
==*
pRc
 ){

125775 if–
pEx¥
->
eTy≥
==
FTSQUERY_PHRASE
 ){

125776 
i
;

125777 
nTokí
 = 
pEx¥
->
pPhø£
->nToken;

125778 *
≤Tokí
 +
nTokí
;

125779 
i
=0; i<
nTokí
; i++){

125780 
Fts3Phø£Tokí
 *
pTokí
 = &
pEx¥
->
pPhø£
->
aTokí
[
i
];

125781 
rc
 = 
	`·s3TîmSegRódîCurs‹
(
pC§
,

125782 
pTokí
->
z
,ÖTokí->
n
,ÖTokí->
isPªfix
, &pTokí->
pSegc§


125784 if–
rc
!=
SQLITE_OK
 ){

125785 *
pRc
 = 
rc
;

125789 
	`as£π
–
pEx¥
->
pPhø£
->
iDo˛i°Tokí
==0 );

125790 
pEx¥
->
pPhø£
->
iDo˛i°Tokí
 = -1;

125792 *
≤Or
 +(
pEx¥
->
eTy≥
==
FTSQUERY_OR
);

125793 
	`·s3EvÆAŒoˇãRódîs
(
pC§
, 
pEx¥
->
pLe·
, 
≤Tokí
, 
≤Or
, 
pRc
);

125794 
	`·s3EvÆAŒoˇãRódîs
(
pC§
, 
pEx¥
->
pRight
, 
≤Tokí
, 
≤Or
, 
pRc
);

125807 
	`·s3EvÆPhø£MîgeTokí
(

125808 
Fts3TabÀ
 *
pTab
,

125809 
Fts3Phø£
 *
p
,

125810 
iTokí
,

125811 *
pLi°
,

125812 
nLi°


125814 
	`as£π
–
iTokí
!=
p
->
iDo˛i°Tokí
 );

125816 if–
pLi°
==0 ){

125817 
	`sqlôe3_‰ì
(
p
->
do˛i°
.
aAŒ
);

125818 
p
->
do˛i°
.
aAŒ
 = 0;

125819 
p
->
do˛i°
.
nAŒ
 = 0;

125822 if–
p
->
iDo˛i°Tokí
<0 ){

125823 
p
->
do˛i°
.
aAŒ
 = 
pLi°
;

125824 
p
->
do˛i°
.
nAŒ
 = 
nLi°
;

125827 if–
p
->
do˛i°
.
aAŒ
==0 ){

125828 
	`sqlôe3_‰ì
(
pLi°
);

125832 *
pLe·
;

125833 *
pRight
;

125834 
nLe·
;

125835 
nRight
;

125836 
nDiff
;

125838 if–
p
->
iDo˛i°Tokí
<
iTokí
 ){

125839 
pLe·
 = 
p
->
do˛i°
.
aAŒ
;

125840 
nLe·
 = 
p
->
do˛i°
.
nAŒ
;

125841 
pRight
 = 
pLi°
;

125842 
nRight
 = 
nLi°
;

125843 
nDiff
 = 
iTokí
 - 
p
->
iDo˛i°Tokí
;

125845 
pRight
 = 
p
->
do˛i°
.
aAŒ
;

125846 
nRight
 = 
p
->
do˛i°
.
nAŒ
;

125847 
pLe·
 = 
pLi°
;

125848 
nLe·
 = 
nLi°
;

125849 
nDiff
 = 
p
->
iDo˛i°Tokí
 - 
iTokí
;

125852 
	`·s3Do˛i°Phø£Mîge
(
pTab
->
bDescIdx
, 
nDiff
, 
pLe·
, 
nLe·
, 
pRight
,&
nRight
);

125853 
	`sqlôe3_‰ì
(
pLe·
);

125854 
p
->
do˛i°
.
aAŒ
 = 
pRight
;

125855 
p
->
do˛i°
.
nAŒ
 = 
nRight
;

125858 if–
iTokí
>
p
->
iDo˛i°Tokí
 )Ö->iDoclistToken = iToken;

125867 
	`·s3EvÆPhø£Lﬂd
(

125868 
Fts3Curs‹
 *
pC§
,

125869 
Fts3Phø£
 *
p


125871 
Fts3TabÀ
 *
pTab
 = (Fts3TabÀ *)
pC§
->
ba£
.
pVèb
;

125872 
iTokí
;

125873 
rc
 = 
SQLITE_OK
;

125875 
iTokí
=0; 
rc
==
SQLITE_OK
 && iTokí<
p
->
nTokí
; iToken++){

125876 
Fts3Phø£Tokí
 *
pTokí
 = &
p
->
aTokí
[
iTokí
];

125877 
	`as£π
–
pTokí
->
pDe„ºed
==0 ||ÖTokí->
pSegc§
==0 );

125879 if–
pTokí
->
pSegc§
 ){

125880 
nThis
 = 0;

125881 *
pThis
 = 0;

125882 
rc
 = 
	`·s3TîmSñe˘
(
pTab
, 
pTokí
, 
p
->
iCﬁumn
, &
nThis
, &
pThis
);

125883 if–
rc
==
SQLITE_OK
 ){

125884 
	`·s3EvÆPhø£MîgeTokí
(
pTab
, 
p
, 
iTokí
, 
pThis
, 
nThis
);

125887 
	`as£π
–
pTokí
->
pSegc§
==0 );

125890  
rc
;

125903 
	`·s3EvÆDe„ºedPhø£
(
Fts3Curs‹
 *
pC§
, 
Fts3Phø£
 *
pPhø£
){

125904 
iTokí
;

125905 *
aPo¶i°
 = 0;

125906 
nPo¶i°
 = 0;

125907 
iPªv
 = -1;

125909 
	`as£π
–
pPhø£
->
do˛i°
.
bFªeLi°
==0 );

125911 
iTokí
=0; iTokí<
pPhø£
->
nTokí
; iToken++){

125912 
Fts3Phø£Tokí
 *
pTokí
 = &
pPhø£
->
aTokí
[
iTokí
];

125913 
Fts3De„ºedTokí
 *
pDe„ºed
 = 
pTokí
->pDeferred;

125915 if–
pDe„ºed
 ){

125916 *
pLi°
;

125917 
nLi°
;

125918 
rc
 = 
	`sqlôe3Fts3De„ºedTokíLi°
(
pDe„ºed
, &
pLi°
, &
nLi°
);

125919 if–
rc
!=
SQLITE_OK
 ) Ñc;

125921 if–
pLi°
==0 ){

125922 
	`sqlôe3_‰ì
(
aPo¶i°
);

125923 
pPhø£
->
do˛i°
.
pLi°
 = 0;

125924 
pPhø£
->
do˛i°
.
nLi°
 = 0;

125925  
SQLITE_OK
;

125927 }if–
aPo¶i°
==0 ){

125928 
aPo¶i°
 = 
pLi°
;

125929 
nPo¶i°
 = 
nLi°
;

125932 *
aOut
 = 
pLi°
;

125933 *
p1
 = 
aPo¶i°
;

125934 *
p2
 = 
aOut
;

125936 
	`as£π
–
iPªv
>=0 );

125937 
	`·s3Po¶i°Phø£Mîge
(&
aOut
, 
iTokí
-
iPªv
, 0, 1, &
p1
, &
p2
);

125938 
	`sqlôe3_‰ì
(
aPo¶i°
);

125939 
aPo¶i°
 = 
pLi°
;

125940 
nPo¶i°
 = ()(
aOut
 - 
aPo¶i°
);

125941 if–
nPo¶i°
==0 ){

125942 
	`sqlôe3_‰ì
(
aPo¶i°
);

125943 
pPhø£
->
do˛i°
.
pLi°
 = 0;

125944 
pPhø£
->
do˛i°
.
nLi°
 = 0;

125945  
SQLITE_OK
;

125948 
iPªv
 = 
iTokí
;

125952 if–
iPªv
>=0 ){

125953 
nMaxUnde„ºed
 = 
pPhø£
->
iDo˛i°Tokí
;

125954 if–
nMaxUnde„ºed
<0 ){

125955 
pPhø£
->
do˛i°
.
pLi°
 = 
aPo¶i°
;

125956 
pPhø£
->
do˛i°
.
nLi°
 = 
nPo¶i°
;

125957 
pPhø£
->
do˛i°
.
iDocid
 = 
pC§
->
iPªvId
;

125958 
pPhø£
->
do˛i°
.
bFªeLi°
 = 1;

125960 
nDi°™˚
;

125961 *
p1
;

125962 *
p2
;

125963 *
aOut
;

125965 if–
nMaxUnde„ºed
>
iPªv
 ){

125966 
p1
 = 
aPo¶i°
;

125967 
p2
 = 
pPhø£
->
do˛i°
.
pLi°
;

125968 
nDi°™˚
 = 
nMaxUnde„ºed
 - 
iPªv
;

125970 
p1
 = 
pPhø£
->
do˛i°
.
pLi°
;

125971 
p2
 = 
aPo¶i°
;

125972 
nDi°™˚
 = 
iPªv
 - 
nMaxUnde„ºed
;

125975 
aOut
 = (*)
	`sqlôe3_mÆloc
(
nPo¶i°
+8);

125976 if–!
aOut
 ){

125977 
	`sqlôe3_‰ì
(
aPo¶i°
);

125978  
SQLITE_NOMEM
;

125981 
pPhø£
->
do˛i°
.
pLi°
 = 
aOut
;

125982 if–
	`·s3Po¶i°Phø£Mîge
(&
aOut
, 
nDi°™˚
, 0, 1, &
p1
, &
p2
) ){

125983 
pPhø£
->
do˛i°
.
bFªeLi°
 = 1;

125984 
pPhø£
->
do˛i°
.
nLi°
 = ()(
aOut
 -ÖPhø£->do˛i°.
pLi°
);

125986 
	`sqlôe3_‰ì
(
aOut
);

125987 
pPhø£
->
do˛i°
.
pLi°
 = 0;

125988 
pPhø£
->
do˛i°
.
nLi°
 = 0;

125990 
	`sqlôe3_‰ì
(
aPo¶i°
);

125994  
SQLITE_OK
;

126001 
	#MAX_INCR_PHRASE_TOKENS
 4

	)

126015 
	`·s3EvÆPhø£Sèπ
(
Fts3Curs‹
 *
pC§
, 
bO±Ok
, 
Fts3Phø£
 *
p
){

126016 
Fts3TabÀ
 *
pTab
 = (Fts3TabÀ *)
pC§
->
ba£
.
pVèb
;

126017 
rc
 = 
SQLITE_OK
;

126018 
i
;

126025 
bHaveIn¸
 = 0;

126026 
bIn¸Ok
 = (
bO±Ok


126027 && 
pC§
->
bDesc
==
pTab
->
bDescIdx


126028 && 
p
->
nTokí
<=
MAX_INCR_PHRASE_TOKENS
 &&Ö->nToken>0

126029 && 
p
->
nTokí
<=
MAX_INCR_PHRASE_TOKENS
 &&Ö->nToken>0

126030 #ifde‡
SQLITE_TEST


126031 && 
pTab
->
bNoIn¸Do˛i°
==0

126034 
i
=0; 
bIn¸Ok
==1 && i<
p
->
nTokí
; i++){

126035 
Fts3Phø£Tokí
 *
pTokí
 = &
p
->
aTokí
[
i
];

126036 if–
pTokí
->
bFú°
 || (pTokí->
pSegc§
!=0 && !pTokí->pSegc§->
bLookup
) ){

126037 
bIn¸Ok
 = 0;

126039 if–
pTokí
->
pSegc§
 ) 
bHaveIn¸
 = 1;

126042 if–
bIn¸Ok
 && 
bHaveIn¸
 ){

126044 
iCﬁ
 = (
p
->
iCﬁumn
 >
pTab
->
nCﬁumn
 ? -1 :Ö->iColumn);

126045 
i
=0; 
rc
==
SQLITE_OK
 && i<
p
->
nTokí
; i++){

126046 
Fts3Phø£Tokí
 *
pTokí
 = &
p
->
aTokí
[
i
];

126047 
Fts3Mu…iSegRódî
 *
pSegc§
 = 
pTokí
->pSegcsr;

126048 if–
pSegc§
 ){

126049 
rc
 = 
	`sqlôe3Fts3M§In¸Sèπ
(
pTab
, 
pSegc§
, 
iCﬁ
, 
pTokí
->
z
,ÖTokí->
n
);

126052 
p
->
bIn¸
 = 1;

126055 
rc
 = 
	`·s3EvÆPhø£Lﬂd
(
pC§
, 
p
);

126056 
p
->
bIn¸
 = 0;

126059 
	`as£π
–
rc
!=
SQLITE_OK
 || 
p
->
nTokí
<1 ||Ö->
aTokí
[0].
pSegc§
==0 ||Ö->
bIn¸
 );

126060  
rc
;

126073 
SQLITE_PRIVATE
 
	`sqlôe3Fts3Do˛i°Pªv
(

126074 
bDescIdx
,

126075 *
aDo˛i°
,

126076 
nDo˛i°
,

126077 **
µIãr
,

126078 
sqlôe3_öt64
 *
piDocid
,

126079 *
≤Li°
,

126080 
u8
 *
pbEof


126082 *
p
 = *
µIãr
;

126084 
	`as£π
–
nDo˛i°
>0 );

126085 
	`as£π
–*
pbEof
==0 );

126086 
	`as£π
–
p
 || *
piDocid
==0 );

126087 
	`as£π
–!
p
 || (p>
aDo˛i°
 &&Ö<&aDo˛i°[
nDo˛i°
]) );

126089 if–
p
==0 ){

126090 
sqlôe3_öt64
 
iDocid
 = 0;

126091 *
pNext
 = 0;

126092 *
pDocid
 = 
aDo˛i°
;

126093 *
pEnd
 = &
aDo˛i°
[
nDo˛i°
];

126094 
iMul
 = 1;

126096  
pDocid
<
pEnd
 ){

126097 
sqlôe3_öt64
 
iDñè
;

126098 
pDocid
 +
	`sqlôe3Fts3GëV¨öt
’Docid, &
iDñè
);

126099 
iDocid
 +(
iMul
 * 
iDñè
);

126100 
pNext
 = 
pDocid
;

126101 
	`·s3Po¶i°C›y
(0, &
pDocid
);

126102  
pDocid
<
pEnd
 && *pDocid==0 )ÖDocid++;

126103 
iMul
 = (
bDescIdx
 ? -1 : 1);

126106 *
≤Li°
 = ()(
pEnd
 - 
pNext
);

126107 *
µIãr
 = 
pNext
;

126108 *
piDocid
 = 
iDocid
;

126110 
iMul
 = (
bDescIdx
 ? -1 : 1);

126111 
sqlôe3_öt64
 
iDñè
;

126112 
	`·s3GëRevî£V¨öt
(&
p
, 
aDo˛i°
, &
iDñè
);

126113 *
piDocid
 -(
iMul
 * 
iDñè
);

126115 if–
p
==
aDo˛i°
 ){

126116 *
pbEof
 = 1;

126118 *
pSave
 = 
p
;

126119 
	`·s3Revî£Po¶i°
(
aDo˛i°
, &
p
);

126120 *
≤Li°
 = ()(
pSave
 - 
p
);

126122 *
µIãr
 = 
p
;

126129 
SQLITE_PRIVATE
 
	`sqlôe3Fts3Do˛i°Next
(

126130 
bDescIdx
,

126131 *
aDo˛i°
,

126132 
nDo˛i°
,

126133 **
µIãr
,

126134 
sqlôe3_öt64
 *
piDocid
,

126135 
u8
 *
pbEof


126137 *
p
 = *
µIãr
;

126139 
	`as£π
–
nDo˛i°
>0 );

126140 
	`as£π
–*
pbEof
==0 );

126141 
	`as£π
–
p
 || *
piDocid
==0 );

126142 
	`as£π
–!
p
 || (p>=
aDo˛i°
 &&Ö<=&aDo˛i°[
nDo˛i°
]) );

126144 if–
p
==0 ){

126145 
p
 = 
aDo˛i°
;

126146 
p
 +
	`sqlôe3Fts3GëV¨öt
’, 
piDocid
);

126148 
	`·s3Po¶i°C›y
(0, &
p
);

126149 if–
p
>=&
aDo˛i°
[
nDo˛i°
] ){

126150 *
pbEof
 = 1;

126152 
sqlôe3_öt64
 
iV¨
;

126153 
p
 +
	`sqlôe3Fts3GëV¨öt
’, &
iV¨
);

126154 *
piDocid
 +((
bDescIdx
 ? -1 : 1Ë* 
iV¨
);

126158 *
µIãr
 = 
p
;

126165 
	`·s3EvÆDlPhø£Next
(

126166 
Fts3TabÀ
 *
pTab
,

126167 
Fts3Do˛i°
 *
pDL
,

126168 
u8
 *
pbEof


126170 *
pIãr
;

126171 *
pEnd
 = &
pDL
->
aAŒ
[pDL->
nAŒ
];

126173 if–
pDL
->
pNextDocid
 ){

126174 
pIãr
 = 
pDL
->
pNextDocid
;

126176 
pIãr
 = 
pDL
->
aAŒ
;

126179 if–
pIãr
>=
pEnd
 ){

126181 *
pbEof
 = 1;

126183 
sqlôe3_öt64
 
iDñè
;

126184 
pIãr
 +
	`sqlôe3Fts3GëV¨öt
’Iãr, &
iDñè
);

126185 if–
pTab
->
bDescIdx
==0 || 
pDL
->
pNextDocid
==0 ){

126186 
pDL
->
iDocid
 +
iDñè
;

126188 
pDL
->
iDocid
 -
iDñè
;

126190 
pDL
->
pLi°
 = 
pIãr
;

126191 
	`·s3Po¶i°C›y
(0, &
pIãr
);

126192 
pDL
->
nLi°
 = ()(
pIãr
 -ÖDL->
pLi°
);

126200  
pIãr
<
pEnd
 && *pIter==0 )ÖIter++;

126202 
pDL
->
pNextDocid
 = 
pIãr
;

126203 
	`as£π
–
pIãr
>=&
pDL
->
aAŒ
[pDL->
nAŒ
] || *pIter );

126204 *
pbEof
 = 0;

126211 
TokíDo˛i°
 
	tTokíDo˛i°
;

126212 
	sTokíDo˛i°
 {

126213 
bIgn‹e
;

126214 
sqlôe3_öt64
 
iDocid
;

126215 *
pLi°
;

126216 
nLi°
;

126228 
	`ö¸Phø£TokíNext
(

126229 
Fts3TabÀ
 *
pTab
,

126230 
Fts3Phø£
 *
pPhø£
,

126231 
iTokí
,

126232 
TokíDo˛i°
 *
p
,

126233 
u8
 *
pbEof


126235 
rc
 = 
SQLITE_OK
;

126237 if–
pPhø£
->
iDo˛i°Tokí
==
iTokí
 ){

126238 
	`as£π
–
p
->
bIgn‹e
==0 );

126239 
	`as£π
–
pPhø£
->
aTokí
[
iTokí
].
pSegc§
==0 );

126240 
	`·s3EvÆDlPhø£Next
(
pTab
, &
pPhø£
->
do˛i°
, 
pbEof
);

126241 
p
->
pLi°
 = 
pPhø£
->
do˛i°
.pList;

126242 
p
->
nLi°
 = 
pPhø£
->
do˛i°
.nList;

126243 
p
->
iDocid
 = 
pPhø£
->
do˛i°
.iDocid;

126245 
Fts3Phø£Tokí
 *
pTokí
 = &
pPhø£
->
aTokí
[
iTokí
];

126246 
	`as£π
–
pTokí
->
pDe„ºed
==0 );

126247 
	`as£π
–
pTokí
->
pSegc§
 || 
pPhø£
->
iDo˛i°Tokí
>=0 );

126248 if–
pTokí
->
pSegc§
 ){

126249 
	`as£π
–
p
->
bIgn‹e
==0 );

126250 
rc
 = 
	`sqlôe3Fts3M§In¸Next
(

126251 
pTab
, 
pTokí
->
pSegc§
, &
p
->
iDocid
, &p->
pLi°
, &p->
nLi°


126253 if–
p
->
pLi°
==0 ) *
pbEof
 = 1;

126255 
p
->
bIgn‹e
 = 1;

126259  
rc
;

126280 
	`·s3EvÆIn¸Phø£Next
(

126281 
Fts3Curs‹
 *
pC§
,

126282 
Fts3Phø£
 *
p
,

126283 
u8
 *
pbEof


126285 
rc
 = 
SQLITE_OK
;

126286 
Fts3Do˛i°
 *
pDL
 = &
p
->
do˛i°
;

126287 
Fts3TabÀ
 *
pTab
 = (Fts3TabÀ *)
pC§
->
ba£
.
pVèb
;

126288 
u8
 
bEof
 = 0;

126292 
	`as£π
–
p
->
bIn¸
==1 );

126294 if–
p
->
nTokí
==1 &&Ö->
bIn¸
 ){

126295 
rc
 = 
	`sqlôe3Fts3M§In¸Next
(
pTab
, 
p
->
aTokí
[0].
pSegc§
,

126296 &
pDL
->
iDocid
, &pDL->
pLi°
, &pDL->
nLi°


126298 if–
pDL
->
pLi°
==0 ) 
bEof
 = 1;

126300 
bDescDo˛i°
 = 
pC§
->
bDesc
;

126301 
TokíDo˛i°
 
a
[
MAX_INCR_PHRASE_TOKENS
];

126303 
	`mem£t
(
a
, 0, (a));

126304 
	`as£π
–
p
->
nTokí
<=
MAX_INCR_PHRASE_TOKENS
 );

126305 
	`as£π
–
p
->
iDo˛i°Tokí
<
MAX_INCR_PHRASE_TOKENS
 );

126307  
bEof
==0 ){

126308 
bMaxSë
 = 0;

126309 
sqlôe3_öt64
 
iMax
 = 0;

126310 
i
;

126313 
i
=0; 
rc
==
SQLITE_OK
 && i<
p
->
nTokí
 && 
bEof
==0; i++){

126314 
rc
 = 
	`ö¸Phø£TokíNext
(
pTab
, 
p
, 
i
, &
a
[i], &
bEof
);

126315 if–
a
[
i
].
bIgn‹e
==0 && (
bMaxSë
==0 || 
	`DOCID_CMP
(
iMax
,á[i].
iDocid
)<0) ){

126316 
iMax
 = 
a
[
i
].
iDocid
;

126317 
bMaxSë
 = 1;

126320 
	`as£π
–
rc
!=
SQLITE_OK
 || 
a
[
p
->
nTokí
-1].
bIgn‹e
==0 );

126321 
	`as£π
–
rc
!=
SQLITE_OK
 || 
bMaxSë
 );

126324 
i
=0; i<
p
->
nTokí
; i++){

126325  
rc
==
SQLITE_OK
 && 
bEof
==0

126326 && 
a
[
i
].
bIgn‹e
==0 && 
	`DOCID_CMP
◊[i].
iDocid
, 
iMax
)<0

126328 
rc
 = 
	`ö¸Phø£TokíNext
(
pTab
, 
p
, 
i
, &
a
[i], &
bEof
);

126329 if–
	`DOCID_CMP
(
a
[
i
].
iDocid
, 
iMax
)>0 ){

126330 
iMax
 = 
a
[
i
].
iDocid
;

126331 
i
 = 0;

126337 if–
bEof
==0 ){

126338 
nLi°
 = 0;

126339 
nByã
 = 
a
[
p
->
nTokí
-1].
nLi°
;

126340 *
aDo˛i°
 = 
	`sqlôe3_mÆloc
(
nByã
+1);

126341 if–!
aDo˛i°
 )  
SQLITE_NOMEM
;

126342 
	`mem˝y
(
aDo˛i°
, 
a
[
p
->
nTokí
-1].
pLi°
, 
nByã
+1);

126344 
i
=0; i<(
p
->
nTokí
-1); i++){

126345 if–
a
[
i
].
bIgn‹e
==0 ){

126346 *
pL
 = 
a
[
i
].
pLi°
;

126347 *
pR
 = 
aDo˛i°
;

126348 *
pOut
 = 
aDo˛i°
;

126349 
nDi°
 = 
p
->
nTokí
-1-
i
;

126350 
ªs
 = 
	`·s3Po¶i°Phø£Mîge
(&
pOut
, 
nDi°
, 0, 1, &
pL
, &
pR
);

126351 if–
ªs
==0 ) ;

126352 
nLi°
 = ()(
pOut
 - 
aDo˛i°
);

126355 if–
i
==(
p
->
nTokí
-1) ){

126356 
pDL
->
iDocid
 = 
iMax
;

126357 
pDL
->
pLi°
 = 
aDo˛i°
;

126358 
pDL
->
nLi°
 =ÇList;

126359 
pDL
->
bFªeLi°
 = 1;

126362 
	`sqlôe3_‰ì
(
aDo˛i°
);

126367 *
pbEof
 = 
bEof
;

126368  
rc
;

126380 
	`·s3EvÆPhø£Next
(

126381 
Fts3Curs‹
 *
pC§
,

126382 
Fts3Phø£
 *
p
,

126383 
u8
 *
pbEof


126385 
rc
 = 
SQLITE_OK
;

126386 
Fts3Do˛i°
 *
pDL
 = &
p
->
do˛i°
;

126387 
Fts3TabÀ
 *
pTab
 = (Fts3TabÀ *)
pC§
->
ba£
.
pVèb
;

126389 if–
p
->
bIn¸
 ){

126390 
rc
 = 
	`·s3EvÆIn¸Phø£Next
(
pC§
, 
p
, 
pbEof
);

126391 }if–
pC§
->
bDesc
!=
pTab
->
bDescIdx
 && 
pDL
->
nAŒ
 ){

126392 
	`sqlôe3Fts3Do˛i°Pªv
(
pTab
->
bDescIdx
, 
pDL
->
aAŒ
,ÖDL->
nAŒ
,

126393 &
pDL
->
pNextDocid
, &pDL->
iDocid
, &pDL->
nLi°
, 
pbEof


126395 
pDL
->
pLi°
 =ÖDL->
pNextDocid
;

126397 
	`·s3EvÆDlPhø£Next
(
pTab
, 
pDL
, 
pbEof
);

126400  
rc
;

126419 
	`·s3EvÆSèπRódîs
(

126420 
Fts3Curs‹
 *
pC§
,

126421 
Fts3Ex¥
 *
pEx¥
,

126422 *
pRc


126424 if–
pEx¥
 && 
SQLITE_OK
==*
pRc
 ){

126425 if–
pEx¥
->
eTy≥
==
FTSQUERY_PHRASE
 ){

126426 
i
;

126427 
nTokí
 = 
pEx¥
->
pPhø£
->nToken;

126428 
i
=0; i<
nTokí
; i++){

126429 if–
pEx¥
->
pPhø£
->
aTokí
[
i
].
pDe„ºed
==0 ) ;

126431 
pEx¥
->
bDe„ºed
 = (
i
==
nTokí
);

126432 *
pRc
 = 
	`·s3EvÆPhø£Sèπ
(
pC§
, 1, 
pEx¥
->
pPhø£
);

126434 
	`·s3EvÆSèπRódîs
(
pC§
, 
pEx¥
->
pLe·
, 
pRc
);

126435 
	`·s3EvÆSèπRódîs
(
pC§
, 
pEx¥
->
pRight
, 
pRc
);

126436 
pEx¥
->
bDe„ºed
 = (pEx¥->
pLe·
->bDe„ºed &&ÖEx¥->
pRight
->bDeferred);

126453 
Fts3TokíAndCo°
 
	tFts3TokíAndCo°
;

126454 
	sFts3TokíAndCo°
 {

126455 
Fts3Phø£
 *
pPhø£
;

126456 
iTokí
;

126457 
Fts3Phø£Tokí
 *
pTokí
;

126458 
Fts3Ex¥
 *
pRoŸ
;

126459 
nOvÊ
;

126460 
iCﬁ
;

126470 
	`·s3EvÆTokíCo°s
(

126471 
Fts3Curs‹
 *
pC§
,

126472 
Fts3Ex¥
 *
pRoŸ
,

126473 
Fts3Ex¥
 *
pEx¥
,

126474 
Fts3TokíAndCo°
 **
µTC
,

126475 
Fts3Ex¥
 ***
µOr
,

126476 *
pRc


126478 if–*
pRc
==
SQLITE_OK
 ){

126479 if–
pEx¥
->
eTy≥
==
FTSQUERY_PHRASE
 ){

126480 
Fts3Phø£
 *
pPhø£
 = 
pEx¥
->pPhrase;

126481 
i
;

126482 
i
=0; *
pRc
==
SQLITE_OK
 && i<
pPhø£
->
nTokí
; i++){

126483 
Fts3TokíAndCo°
 *
pTC
 = (*
µTC
)++;

126484 
pTC
->
pPhø£
 =ÖPhrase;

126485 
pTC
->
iTokí
 = 
i
;

126486 
pTC
->
pRoŸ
 =ÖRoot;

126487 
pTC
->
pTokí
 = &
pPhø£
->
aTokí
[
i
];

126488 
pTC
->
iCﬁ
 = 
pPhø£
->
iCﬁumn
;

126489 *
pRc
 = 
	`sqlôe3Fts3M§OvÊ
(
pC§
, 
pTC
->
pTokí
->
pSegc§
, &pTC->
nOvÊ
);

126491 }if–
pEx¥
->
eTy≥
!=
FTSQUERY_NOT
 ){

126492 
	`as£π
–
pEx¥
->
eTy≥
==
FTSQUERY_OR


126493 || 
pEx¥
->
eTy≥
==
FTSQUERY_AND


126494 || 
pEx¥
->
eTy≥
==
FTSQUERY_NEAR


126496 
	`as£π
–
pEx¥
->
pLe·
 &&ÖEx¥->
pRight
 );

126497 if–
pEx¥
->
eTy≥
==
FTSQUERY_OR
 ){

126498 
pRoŸ
 = 
pEx¥
->
pLe·
;

126499 **
µOr
 = 
pRoŸ
;

126500 (*
µOr
)++;

126502 
	`·s3EvÆTokíCo°s
(
pC§
, 
pRoŸ
, 
pEx¥
->
pLe·
, 
µTC
, 
µOr
, 
pRc
);

126503 if–
pEx¥
->
eTy≥
==
FTSQUERY_OR
 ){

126504 
pRoŸ
 = 
pEx¥
->
pRight
;

126505 **
µOr
 = 
pRoŸ
;

126506 (*
µOr
)++;

126508 
	`·s3EvÆTokíCo°s
(
pC§
, 
pRoŸ
, 
pEx¥
->
pRight
, 
µTC
, 
µOr
, 
pRc
);

126524 
	`·s3EvÆAvîageDocsize
(
Fts3Curs‹
 *
pC§
, *
≤Page
){

126525 if–
pC§
->
nRowAvg
==0 ){

126537 
rc
;

126538 
Fts3TabÀ
 *
p
 = (Fts3TabÀ*)
pC§
->
ba£
.
pVèb
;

126539 
sqlôe3_°mt
 *
pStmt
;

126540 
sqlôe3_öt64
 
nDoc
 = 0;

126541 
sqlôe3_öt64
 
nByã
 = 0;

126542 c⁄° *
pEnd
;

126543 c⁄° *
a
;

126545 
rc
 = 
	`sqlôe3Fts3Sñe˘Do˘ŸÆ
(
p
, &
pStmt
);

126546 if–
rc
!=
SQLITE_OK
 ) Ñc;

126547 
a
 = 
	`sqlôe3_cﬁumn_blob
(
pStmt
, 0);

126548 
	`as£π
–
a
 );

126550 
pEnd
 = &
a
[
	`sqlôe3_cﬁumn_byãs
(
pStmt
, 0)];

126551 
a
 +
	`sqlôe3Fts3GëV¨öt
◊, &
nDoc
);

126552  
a
<
pEnd
 ){

126553 
a
 +
	`sqlôe3Fts3GëV¨öt
◊, &
nByã
);

126555 if–
nDoc
==0 || 
nByã
==0 ){

126556 
	`sqlôe3_ª£t
(
pStmt
);

126557  
FTS_CORRUPT_VTAB
;

126560 
pC§
->
nDoc
 =ÇDoc;

126561 
pC§
->
nRowAvg
 = ()(((
nByã
 / 
nDoc
Ë+ 
p
->
nPgsz
) /Ö->nPgsz);

126562 
	`as£π
–
pC§
->
nRowAvg
>0 );

126563 
rc
 = 
	`sqlôe3_ª£t
(
pStmt
);

126564 if–
rc
!=
SQLITE_OK
 ) Ñc;

126567 *
≤Page
 = 
pC§
->
nRowAvg
;

126568  
SQLITE_OK
;

126585 
	`·s3EvÆSñe˘De„ºed
(

126586 
Fts3Curs‹
 *
pC§
,

126587 
Fts3Ex¥
 *
pRoŸ
,

126588 
Fts3TokíAndCo°
 *
aTC
,

126589 
nTC


126591 
Fts3TabÀ
 *
pTab
 = (Fts3TabÀ *)
pC§
->
ba£
.
pVèb
;

126592 
nDocSize
 = 0;

126593 
rc
 = 
SQLITE_OK
;

126594 
ii
;

126595 
nOvÊ
 = 0;

126596 
nTokí
 = 0;

126598 
nMöE°
 = 0;

126599 
nLﬂd4
 = 1;

126606 if–
pTab
->
zC⁄ã¡Tbl
 ){

126607  
SQLITE_OK
;

126613 
ii
=0; ii<
nTC
; ii++){

126614 if–
aTC
[
ii
].
pRoŸ
==pRoot ){

126615 
nOvÊ
 +
aTC
[
ii
].nOvfl;

126616 
nTokí
++;

126619 if–
nOvÊ
==0 || 
nTokí
<2 )  
SQLITE_OK
;

126622 
rc
 = 
	`·s3EvÆAvîageDocsize
(
pC§
, &
nDocSize
);

126623 
	`as£π
–
rc
!=
SQLITE_OK
 || 
nDocSize
>0 );

126648 
ii
=0; ii<
nTokí
 && 
rc
==
SQLITE_OK
; ii++){

126649 
iTC
;

126650 
Fts3TokíAndCo°
 *
pTC
 = 0;

126653 
iTC
=0; iTC<
nTC
; iTC++){

126654 if–
aTC
[
iTC
].
pTokí
 &&áTC[iTC].
pRoŸ
==pRoot

126655 && (!
pTC
 || 
aTC
[
iTC
].
nOvÊ
<pTC->nOvfl)

126657 
pTC
 = &
aTC
[
iTC
];

126660 
	`as£π
–
pTC
 );

126662 if–
ii
 && 
pTC
->
nOvÊ
>=((
nMöE°
+(
nLﬂd4
/4)-1)/“Lﬂd4/4))*
nDocSize
 ){

126667 
Fts3Phø£Tokí
 *
pTokí
 = 
pTC
->pToken;

126668 
rc
 = 
	`sqlôe3Fts3De„rTokí
(
pC§
, 
pTokí
, 
pTC
->
iCﬁ
);

126669 
	`·s3SegRódîCurs‹Fªe
(
pTokí
->
pSegc§
);

126670 
pTokí
->
pSegc§
 = 0;

126675 if–
ii
<12 ) 
nLﬂd4
 =ÇLoad4*4;

126677 if–
ii
==0 || (
pTC
->
pPhø£
->
nTokí
>1 && ii!=nToken-1) ){

126681 
Fts3Phø£Tokí
 *
pTokí
 = 
pTC
->pToken;

126682 
nLi°
 = 0;

126683 *
pLi°
 = 0;

126684 
rc
 = 
	`·s3TîmSñe˘
(
pTab
, 
pTokí
, 
pTC
->
iCﬁ
, &
nLi°
, &
pLi°
);

126685 
	`as£π
–
rc
==
SQLITE_OK
 || 
pLi°
==0 );

126686 if–
rc
==
SQLITE_OK
 ){

126687 
nCou¡
;

126688 
	`·s3EvÆPhø£MîgeTokí
(
pTab
, 
pTC
->
pPhø£
,ÖTC->
iTokí
,
pLi°
,
nLi°
);

126689 
nCou¡
 = 
	`·s3Do˛i°Cou¡Docids
(

126690 
pTC
->
pPhø£
->
do˛i°
.
aAŒ
,ÖTC->pPhø£->do˛i°.
nAŒ


126692 if–
ii
==0 || 
nCou¡
<
nMöE°
 )ÇMinEst =ÇCount;

126696 
pTC
->
pTokí
 = 0;

126699  
rc
;

126714 
	`·s3EvÆSèπ
(
Fts3Curs‹
 *
pC§
){

126715 
Fts3TabÀ
 *
pTab
 = (Fts3TabÀ *)
pC§
->
ba£
.
pVèb
;

126716 
rc
 = 
SQLITE_OK
;

126717 
nTokí
 = 0;

126718 
nOr
 = 0;

126721 
	`·s3EvÆAŒoˇãRódîs
(
pC§
,ÖC§->
pEx¥
, &
nTokí
, &
nOr
, &
rc
);

126724 #i‚de‡
SQLITE_DISABLE_FTS4_DEFERRED


126725 if–
rc
==
SQLITE_OK
 && 
nTokí
>1 && 
pTab
->
bFts4
 ){

126726 
Fts3TokíAndCo°
 *
aTC
;

126727 
Fts3Ex¥
 **
≠Or
;

126728 
aTC
 = (
Fts3TokíAndCo°
 *)
	`sqlôe3_mÆloc
(

126729 (
Fts3TokíAndCo°
Ë* 
nTokí


126730 + (
Fts3Ex¥
 *Ë* 
nOr
 * 2

126732 
≠Or
 = (
Fts3Ex¥
 **)&
aTC
[
nTokí
];

126734 if–!
aTC
 ){

126735 
rc
 = 
SQLITE_NOMEM
;

126737 
ii
;

126738 
Fts3TokíAndCo°
 *
pTC
 = 
aTC
;

126739 
Fts3Ex¥
 **
µOr
 = 
≠Or
;

126741 
	`·s3EvÆTokíCo°s
(
pC§
, 0,ÖC§->
pEx¥
, &
pTC
, &
µOr
, &
rc
);

126742 
nTokí
 = ()(
pTC
-
aTC
);

126743 
nOr
 = ()(
µOr
-
≠Or
);

126745 if–
rc
==
SQLITE_OK
 ){

126746 
rc
 = 
	`·s3EvÆSñe˘De„ºed
(
pC§
, 0, 
aTC
, 
nTokí
);

126747 
ii
=0; 
rc
==
SQLITE_OK
 && ii<
nOr
; ii++){

126748 
rc
 = 
	`·s3EvÆSñe˘De„ºed
(
pC§
, 
≠Or
[
ii
], 
aTC
, 
nTokí
);

126752 
	`sqlôe3_‰ì
(
aTC
);

126757 
	`·s3EvÆSèπRódîs
(
pC§
,ÖC§->
pEx¥
, &
rc
);

126758  
rc
;

126764 
	`·s3EvÆInvÆid©ePo¶i°
(
Fts3Phø£
 *
pPhø£
){

126765 if–
pPhø£
->
do˛i°
.
bFªeLi°
 ){

126766 
	`sqlôe3_‰ì
(
pPhø£
->
do˛i°
.
pLi°
);

126768 
pPhø£
->
do˛i°
.
pLi°
 = 0;

126769 
pPhø£
->
do˛i°
.
nLi°
 = 0;

126770 
pPhø£
->
do˛i°
.
bFªeLi°
 = 0;

126795 
	`·s3EvÆNórTrim
(

126796 
nNór
,

126797 *
aTmp
,

126798 **
∑Po¶i°
,

126799 *
≤Tokí
,

126800 
Fts3Phø£
 *
pPhø£


126802 
nP¨am1
 = 
nNór
 + 
pPhø£
->
nTokí
;

126803 
nP¨am2
 = 
nNór
 + *
≤Tokí
;

126804 
nNew
;

126805 *
p2
;

126806 *
pOut
;

126807 
ªs
;

126809 
	`as£π
–
pPhø£
->
do˛i°
.
pLi°
 );

126811 
p2
 = 
pOut
 = 
pPhø£
->
do˛i°
.
pLi°
;

126812 
ªs
 = 
	`·s3Po¶i°NórMîge
(

126813 &
pOut
, 
aTmp
, 
nP¨am1
, 
nP¨am2
, 
∑Po¶i°
, &
p2


126815 if–
ªs
 ){

126816 
nNew
 = ()(
pOut
 - 
pPhø£
->
do˛i°
.
pLi°
) - 1;

126817 
	`as£π
–
pPhø£
->
do˛i°
.
pLi°
[
nNew
]=='\0' );

126818 
	`as£π
–
nNew
<=
pPhø£
->
do˛i°
.
nLi°
 &&ÇNew>0 );

126819 
	`mem£t
(&
pPhø£
->
do˛i°
.
pLi°
[
nNew
], 0,ÖPhø£->do˛i°.
nLi°
 -ÇNew);

126820 
pPhø£
->
do˛i°
.
nLi°
 = 
nNew
;

126821 *
∑Po¶i°
 = 
pPhø£
->
do˛i°
.
pLi°
;

126822 *
≤Tokí
 = 
pPhø£
->
nTokí
;

126825  
ªs
;

126869 
	`·s3EvÆNextRow
(

126870 
Fts3Curs‹
 *
pC§
,

126871 
Fts3Ex¥
 *
pEx¥
,

126872 *
pRc


126874 if–*
pRc
==
SQLITE_OK
 ){

126875 
bDescDo˛i°
 = 
pC§
->
bDesc
;

126876 
	`as£π
–
pEx¥
->
bEof
==0 );

126877 
pEx¥
->
bSèπ
 = 1;

126879  
pEx¥
->
eTy≥
 ){

126880 
FTSQUERY_NEAR
:

126881 
FTSQUERY_AND
: {

126882 
Fts3Ex¥
 *
pLe·
 = 
pEx¥
->pLeft;

126883 
Fts3Ex¥
 *
pRight
 = 
pEx¥
->pRight;

126884 
	`as£π
–!
pLe·
->
bDe„ºed
 || !
pRight
->bDeferred );

126886 if–
pLe·
->
bDe„ºed
 ){

126889 
	`·s3EvÆNextRow
(
pC§
, 
pRight
, 
pRc
);

126890 
pEx¥
->
iDocid
 = 
pRight
->iDocid;

126891 
pEx¥
->
bEof
 = 
pRight
->bEof;

126892 }if–
pRight
->
bDe„ºed
 ){

126895 
	`·s3EvÆNextRow
(
pC§
, 
pLe·
, 
pRc
);

126896 
pEx¥
->
iDocid
 = 
pLe·
->iDocid;

126897 
pEx¥
->
bEof
 = 
pLe·
->bEof;

126900 
	`·s3EvÆNextRow
(
pC§
, 
pLe·
, 
pRc
);

126901 
	`·s3EvÆNextRow
(
pC§
, 
pRight
, 
pRc
);

126902  !
pLe·
->
bEof
 && !
pRight
->bEo‡&& *
pRc
==
SQLITE_OK
 ){

126903 
sqlôe3_öt64
 
iDiff
 = 
	`DOCID_CMP
(
pLe·
->
iDocid
, 
pRight
->iDocid);

126904 if–
iDiff
==0 ) ;

126905 if–
iDiff
<0 ){

126906 
	`·s3EvÆNextRow
(
pC§
, 
pLe·
, 
pRc
);

126908 
	`·s3EvÆNextRow
(
pC§
, 
pRight
, 
pRc
);

126911 
pEx¥
->
iDocid
 = 
pLe·
->iDocid;

126912 
pEx¥
->
bEof
 = (
pLe·
->bEo‡|| 
pRight
->bEof);

126917 
FTSQUERY_OR
: {

126918 
Fts3Ex¥
 *
pLe·
 = 
pEx¥
->pLeft;

126919 
Fts3Ex¥
 *
pRight
 = 
pEx¥
->pRight;

126920 
sqlôe3_öt64
 
iCmp
 = 
	`DOCID_CMP
(
pLe·
->
iDocid
, 
pRight
->iDocid);

126922 
	`as£π
–
pLe·
->
bSèπ
 ||ÖLe·->
iDocid
==
pRight
->iDocid );

126923 
	`as£π
–
pRight
->
bSèπ
 || 
pLe·
->
iDocid
==pRight->iDocid );

126925 if–
pRight
->
bEof
 || (
pLe·
->bEof==0 && 
iCmp
<0) ){

126926 
	`·s3EvÆNextRow
(
pC§
, 
pLe·
, 
pRc
);

126927 }if–
pLe·
->
bEof
 || (
pRight
->bEof==0 && 
iCmp
>0) ){

126928 
	`·s3EvÆNextRow
(
pC§
, 
pRight
, 
pRc
);

126930 
	`·s3EvÆNextRow
(
pC§
, 
pLe·
, 
pRc
);

126931 
	`·s3EvÆNextRow
(
pC§
, 
pRight
, 
pRc
);

126934 
pEx¥
->
bEof
 = (
pLe·
->bEo‡&& 
pRight
->bEof);

126935 
iCmp
 = 
	`DOCID_CMP
(
pLe·
->
iDocid
, 
pRight
->iDocid);

126936 if–
pRight
->
bEof
 || (
pLe·
->bEof==0 && 
iCmp
<0) ){

126937 
pEx¥
->
iDocid
 = 
pLe·
->iDocid;

126939 
pEx¥
->
iDocid
 = 
pRight
->iDocid;

126945 
FTSQUERY_NOT
: {

126946 
Fts3Ex¥
 *
pLe·
 = 
pEx¥
->pLeft;

126947 
Fts3Ex¥
 *
pRight
 = 
pEx¥
->pRight;

126949 if–
pRight
->
bSèπ
==0 ){

126950 
	`·s3EvÆNextRow
(
pC§
, 
pRight
, 
pRc
);

126951 
	`as£π
–*
pRc
!=
SQLITE_OK
 || 
pRight
->
bSèπ
 );

126954 
	`·s3EvÆNextRow
(
pC§
, 
pLe·
, 
pRc
);

126955 if–
pLe·
->
bEof
==0 ){

126956  !*
pRc


126957 && !
pRight
->
bEof


126958 && 
	`DOCID_CMP
(
pLe·
->
iDocid
, 
pRight
->iDocid)>0

126960 
	`·s3EvÆNextRow
(
pC§
, 
pRight
, 
pRc
);

126963 
pEx¥
->
iDocid
 = 
pLe·
->iDocid;

126964 
pEx¥
->
bEof
 = 
pLe·
->bEof;

126969 
Fts3Phø£
 *
pPhø£
 = 
pEx¥
->pPhrase;

126970 
	`·s3EvÆInvÆid©ePo¶i°
(
pPhø£
);

126971 *
pRc
 = 
	`·s3EvÆPhø£Next
(
pC§
, 
pPhø£
, &
pEx¥
->
bEof
);

126972 
pEx¥
->
iDocid
 = 
pPhø£
->
do˛i°
.iDocid;

126994 
	`·s3EvÆNórTe°
(
Fts3Ex¥
 *
pEx¥
, *
pRc
){

126995 
ªs
 = 1;

127017 if–*
pRc
==
SQLITE_OK


127018 && 
pEx¥
->
eTy≥
==
FTSQUERY_NEAR


127019 && 
pEx¥
->
bEof
==0

127020 && (
pEx¥
->
pP¨ít
==0 ||ÖEx¥->pP¨ít->
eTy≥
!=
FTSQUERY_NEAR
)

127022 
Fts3Ex¥
 *
p
;

127023 
nTmp
 = 0;

127024 *
aTmp
;

127027 
p
=
pEx¥
;Ö->
pLe·
;Ö=p->pLeft){

127028 
nTmp
 +
p
->
pRight
->
pPhø£
->
do˛i°
.
nLi°
;

127030 
nTmp
 +
p
->
pPhø£
->
do˛i°
.
nLi°
;

127031 if–
nTmp
==0 ){

127032 
ªs
 = 0;

127034 
aTmp
 = 
	`sqlôe3_mÆloc
(
nTmp
*2);

127035 if–!
aTmp
 ){

127036 *
pRc
 = 
SQLITE_NOMEM
;

127037 
ªs
 = 0;

127039 *
aPo¶i°
 = 
p
->
pPhø£
->
do˛i°
.
pLi°
;

127040 
nTokí
 = 
p
->
pPhø£
->nToken;

127042 
p
ı->
pP¨ít
;
ªs
 &&Ö &&Ö->
eTy≥
==
FTSQUERY_NEAR
;Ö=p->pParent){

127043 
Fts3Phø£
 *
pPhø£
 = 
p
->
pRight
->pPhrase;

127044 
nNór
 = 
p
->nNear;

127045 
ªs
 = 
	`·s3EvÆNórTrim
(
nNór
, 
aTmp
, &
aPo¶i°
, &
nTokí
, 
pPhø£
);

127048 
aPo¶i°
 = 
pEx¥
->
pRight
->
pPhø£
->
do˛i°
.
pLi°
;

127049 
nTokí
 = 
pEx¥
->
pRight
->
pPhø£
->nToken;

127050 
p
=
pEx¥
->
pLe·
;Ö && 
ªs
;Ö=p->pLeft){

127051 
nNór
;

127052 
Fts3Phø£
 *
pPhø£
;

127053 
	`as£π
–
p
->
pP¨ít
 &&Ö->pP¨ít->
pLe·
==p );

127054 
nNór
 = 
p
->
pP¨ít
->nNear;

127055 
pPhø£
 = (

127056 
p
->
eTy≥
==
FTSQUERY_NEAR
 ?Ö->
pRight
->
pPhø£
 :Ö->pPhrase

127058 
ªs
 = 
	`·s3EvÆNórTrim
(
nNór
, 
aTmp
, &
aPo¶i°
, &
nTokí
, 
pPhø£
);

127062 
	`sqlôe3_‰ì
(
aTmp
);

127066  
ªs
;

127080 
	`·s3EvÆTe°Ex¥
(

127081 
Fts3Curs‹
 *
pC§
,

127082 
Fts3Ex¥
 *
pEx¥
,

127083 *
pRc


127085 
bHô
 = 1;

127086 if–*
pRc
==
SQLITE_OK
 ){

127087  
pEx¥
->
eTy≥
 ){

127088 
FTSQUERY_NEAR
:

127089 
FTSQUERY_AND
:

127090 
bHô
 = (

127091 
	`·s3EvÆTe°Ex¥
(
pC§
, 
pEx¥
->
pLe·
, 
pRc
)

127092 && 
	`·s3EvÆTe°Ex¥
(
pC§
, 
pEx¥
->
pRight
, 
pRc
)

127093 && 
	`·s3EvÆNórTe°
(
pEx¥
, 
pRc
)

127111 if–
bHô
==0

127112 && 
pEx¥
->
eTy≥
==
FTSQUERY_NEAR


127113 && (
pEx¥
->
pP¨ít
==0 ||ÖEx¥->pP¨ít->
eTy≥
!=
FTSQUERY_NEAR
)

127115 
Fts3Ex¥
 *
p
;

127116 
p
=
pEx¥
;Ö->
pPhø£
==0;Öı->
pLe·
){

127117 if–
p
->
pRight
->
iDocid
==
pC§
->
iPªvId
 ){

127118 
	`·s3EvÆInvÆid©ePo¶i°
(
p
->
pRight
->
pPhø£
);

127121 if–
p
->
iDocid
==
pC§
->
iPªvId
 ){

127122 
	`·s3EvÆInvÆid©ePo¶i°
(
p
->
pPhø£
);

127128 
FTSQUERY_OR
: {

127129 
bHô1
 = 
	`·s3EvÆTe°Ex¥
(
pC§
, 
pEx¥
->
pLe·
, 
pRc
);

127130 
bHô2
 = 
	`·s3EvÆTe°Ex¥
(
pC§
, 
pEx¥
->
pRight
, 
pRc
);

127131 
bHô
 = 
bHô1
 || 
bHô2
;

127135 
FTSQUERY_NOT
:

127136 
bHô
 = (

127137 
	`·s3EvÆTe°Ex¥
(
pC§
, 
pEx¥
->
pLe·
, 
pRc
)

127138 && !
	`·s3EvÆTe°Ex¥
(
pC§
, 
pEx¥
->
pRight
, 
pRc
)

127143 #i‚de‡
SQLITE_DISABLE_FTS4_DEFERRED


127144 if–
pC§
->
pDe„ºed


127145 && (
pEx¥
->
iDocid
==
pC§
->
iPªvId
 ||ÖEx¥->
bDe„ºed
)

127147 
Fts3Phø£
 *
pPhø£
 = 
pEx¥
->pPhrase;

127148 
	`as£π
–
pEx¥
->
bDe„ºed
 || 
pPhø£
->
do˛i°
.
bFªeLi°
==0 );

127149 if–
pEx¥
->
bDe„ºed
 ){

127150 
	`·s3EvÆInvÆid©ePo¶i°
(
pPhø£
);

127152 *
pRc
 = 
	`·s3EvÆDe„ºedPhø£
(
pC§
, 
pPhø£
);

127153 
bHô
 = (
pPhø£
->
do˛i°
.
pLi°
!=0);

127154 
pEx¥
->
iDocid
 = 
pC§
->
iPªvId
;

127158 
bHô
 = (
pEx¥
->
bEof
==0 &&ÖEx¥->
iDocid
==
pC§
->
iPªvId
);

127164  
bHô
;

127191 
	`·s3EvÆTe°De„ºedAndNór
(
Fts3Curs‹
 *
pC§
, *
pRc
){

127192 
rc
 = *
pRc
;

127193 
bMiss
 = 0;

127194 if–
rc
==
SQLITE_OK
 ){

127202 if–
pC§
->
pDe„ºed
 ){

127203 
rc
 = 
	`·s3Curs‹Sìk
(0, 
pC§
);

127204 if–
rc
==
SQLITE_OK
 ){

127205 
rc
 = 
	`sqlôe3Fts3CacheDe„ºedDo˛i°s
(
pC§
);

127208 
bMiss
 = (0==
	`·s3EvÆTe°Ex¥
(
pC§
,ÖC§->
pEx¥
, &
rc
));

127211 
	`sqlôe3Fts3FªeDe„ºedDo˛i°s
(
pC§
);

127212 *
pRc
 = 
rc
;

127214  (
rc
==
SQLITE_OK
 && 
bMiss
);

127221 
	`·s3EvÆNext
(
Fts3Curs‹
 *
pC§
){

127222 
rc
 = 
SQLITE_OK
;

127223 
Fts3Ex¥
 *
pEx¥
 = 
pC§
->pExpr;

127224 
	`as£π
–
pC§
->
isEof
==0 );

127225 if–
pEx¥
==0 ){

127226 
pC§
->
isEof
 = 1;

127229 if–
pC§
->
isRequúeSìk
==0 ){

127230 
	`sqlôe3_ª£t
(
pC§
->
pStmt
);

127232 
	`as£π
–
	`sqlôe3_d©a_cou¡
(
pC§
->
pStmt
)==0 );

127233 
	`·s3EvÆNextRow
(
pC§
, 
pEx¥
, &
rc
);

127234 
pC§
->
isEof
 = 
pEx¥
->
bEof
;

127235 
pC§
->
isRequúeSìk
 = 1;

127236 
pC§
->
isM©chöfoNìded
 = 1;

127237 
pC§
->
iPªvId
 = 
pEx¥
->
iDocid
;

127238 } 
pC§
->
isEof
==0 && 
	`·s3EvÆTe°De„ºedAndNór
’C§, &
rc
) );

127243 if–
rc
==
SQLITE_OK
 && (

127244 (
pC§
->
bDesc
==0 &&ÖC§->
iPªvId
>pC§->
iMaxDocid
)

127245 || (
pC§
->
bDesc
!=0 &&ÖC§->
iPªvId
<pC§->
iMöDocid
)

127247 
pC§
->
isEof
 = 1;

127250  
rc
;

127262 
	`·s3EvÆRe°¨t
(

127263 
Fts3Curs‹
 *
pC§
,

127264 
Fts3Ex¥
 *
pEx¥
,

127265 *
pRc


127267 if–
pEx¥
 && *
pRc
==
SQLITE_OK
 ){

127268 
Fts3Phø£
 *
pPhø£
 = 
pEx¥
->pPhrase;

127270 if–
pPhø£
 ){

127271 
	`·s3EvÆInvÆid©ePo¶i°
(
pPhø£
);

127272 if–
pPhø£
->
bIn¸
 ){

127273 
i
;

127274 
i
=0; i<
pPhø£
->
nTokí
; i++){

127275 
Fts3Phø£Tokí
 *
pTokí
 = &
pPhø£
->
aTokí
[
i
];

127276 
	`as£π
–
pTokí
->
pDe„ºed
==0 );

127277 if–
pTokí
->
pSegc§
 ){

127278 
	`sqlôe3Fts3M§In¸Re°¨t
(
pTokí
->
pSegc§
);

127281 *
pRc
 = 
	`·s3EvÆPhø£Sèπ
(
pC§
, 0, 
pPhø£
);

127283 
pPhø£
->
do˛i°
.
pNextDocid
 = 0;

127284 
pPhø£
->
do˛i°
.
iDocid
 = 0;

127287 
pEx¥
->
iDocid
 = 0;

127288 
pEx¥
->
bEof
 = 0;

127289 
pEx¥
->
bSèπ
 = 0;

127291 
	`·s3EvÆRe°¨t
(
pC§
, 
pEx¥
->
pLe·
, 
pRc
);

127292 
	`·s3EvÆRe°¨t
(
pC§
, 
pEx¥
->
pRight
, 
pRc
);

127304 
	`·s3EvÆUpd©eCou¡s
(
Fts3Ex¥
 *
pEx¥
){

127305 if–
pEx¥
 ){

127306 
Fts3Phø£
 *
pPhø£
 = 
pEx¥
->pPhrase;

127307 if–
pPhø£
 &&ÖPhø£->
do˛i°
.
pLi°
 ){

127308 
iCﬁ
 = 0;

127309 *
p
 = 
pPhø£
->
do˛i°
.
pLi°
;

127311 
	`as£π
–*
p
 );

127313 
u8
 
c
 = 0;

127314 
iC¡
 = 0;

127315  0xFE & (*
p
 | 
c
) ){

127316 if–(
c
&0x80)==0 ) 
iC¡
++;

127317 
c
 = *
p
++ & 0x80;

127323 
pEx¥
->
aMI
[
iCﬁ
*3 + 1] +
iC¡
;

127324 
pEx¥
->
aMI
[
iCﬁ
*3 + 2] +(
iC¡
>0);

127325 if–*
p
==0x00 ) ;

127326 
p
++;

127327 
p
 +
	`sqlôe3Fts3GëV¨öt32
’, &
iCﬁ
);

127331 
	`·s3EvÆUpd©eCou¡s
(
pEx¥
->
pLe·
);

127332 
	`·s3EvÆUpd©eCou¡s
(
pEx¥
->
pRight
);

127347 
	`·s3EvÆG©hîSèts
(

127348 
Fts3Curs‹
 *
pC§
,

127349 
Fts3Ex¥
 *
pEx¥


127351 
rc
 = 
SQLITE_OK
;

127353 
	`as£π
–
pEx¥
->
eTy≥
==
FTSQUERY_PHRASE
 );

127354 if–
pEx¥
->
aMI
==0 ){

127355 
Fts3TabÀ
 *
pTab
 = (Fts3TabÀ *)
pC§
->
ba£
.
pVèb
;

127356 
Fts3Ex¥
 *
pRoŸ
;

127357 
Fts3Ex¥
 *
p
;

127359 
sqlôe3_öt64
 
iPªvId
 = 
pC§
->iPrevId;

127360 
sqlôe3_öt64
 
iDocid
;

127361 
u8
 
bEof
;

127364 
pRoŸ
 = 
pEx¥
;

127365  
pRoŸ
->
pP¨ít
 &&ÖRoŸ->pP¨ít->
eTy≥
==
FTSQUERY_NEAR
 ){

127366 
pRoŸ
 =ÖRoŸ->
pP¨ít
;

127368 
iDocid
 = 
pRoŸ
->iDocid;

127369 
bEof
 = 
pRoŸ
->bEof;

127370 
	`as£π
–
pRoŸ
->
bSèπ
 );

127373 
p
=
pRoŸ
;Ö;Öı->
pLe·
){

127374 
Fts3Ex¥
 *
pE
 = (
p
->
eTy≥
==
FTSQUERY_PHRASE
?p:p->
pRight
);

127375 
	`as£π
–
pE
->
aMI
==0 );

127376 
pE
->
aMI
 = (
u32
 *)
	`sqlôe3_mÆloc
(
pTab
->
nCﬁumn
 * 3 * (u32));

127377 if–!
pE
->
aMI
 )  
SQLITE_NOMEM
;

127378 
	`mem£t
(
pE
->
aMI
, 0, 
pTab
->
nCﬁumn
 * 3 * (
u32
));

127381 
	`·s3EvÆRe°¨t
(
pC§
, 
pRoŸ
, &
rc
);

127383  
pC§
->
isEof
==0 && 
rc
==
SQLITE_OK
 ){

127387 if–
pC§
->
isRequúeSìk
==0 ) 
	`sqlôe3_ª£t
’C§->
pStmt
);

127388 
	`as£π
–
	`sqlôe3_d©a_cou¡
(
pC§
->
pStmt
)==0 );

127391 
	`·s3EvÆNextRow
(
pC§
, 
pRoŸ
, &
rc
);

127392 
pC§
->
isEof
 = 
pRoŸ
->
bEof
;

127393 
pC§
->
isRequúeSìk
 = 1;

127394 
pC§
->
isM©chöfoNìded
 = 1;

127395 
pC§
->
iPªvId
 = 
pRoŸ
->
iDocid
;

127396 } 
pC§
->
isEof
==0

127397 && 
pRoŸ
->
eTy≥
==
FTSQUERY_NEAR


127398 && 
	`·s3EvÆTe°De„ºedAndNór
(
pC§
, &
rc
)

127401 if–
rc
==
SQLITE_OK
 && 
pC§
->
isEof
==0 ){

127402 
	`·s3EvÆUpd©eCou¡s
(
pRoŸ
);

127406 
pC§
->
isEof
 = 0;

127407 
pC§
->
iPªvId
 = iPrevId;

127409 if–
bEof
 ){

127410 
pRoŸ
->
bEof
 = bEof;

127418 
	`·s3EvÆRe°¨t
(
pC§
, 
pRoŸ
, &
rc
);

127420 
	`·s3EvÆNextRow
(
pC§
, 
pRoŸ
, &
rc
);

127421 
	`as£π
–
pRoŸ
->
bEof
==0 );

127422 } 
pRoŸ
->
iDocid
!=iDocid && 
rc
==
SQLITE_OK
 );

127423 
	`·s3EvÆTe°De„ºedAndNór
(
pC§
, &
rc
);

127426  
rc
;

127459 
SQLITE_PRIVATE
 
	`sqlôe3Fts3EvÆPhø£Sèts
(

127460 
Fts3Curs‹
 *
pC§
,

127461 
Fts3Ex¥
 *
pEx¥
,

127462 
u32
 *
aiOut


127464 
Fts3TabÀ
 *
pTab
 = (Fts3TabÀ *)
pC§
->
ba£
.
pVèb
;

127465 
rc
 = 
SQLITE_OK
;

127466 
iCﬁ
;

127468 if–
pEx¥
->
bDe„ºed
 &&ÖEx¥->
pP¨ít
->
eTy≥
!=
FTSQUERY_NEAR
 ){

127469 
	`as£π
–
pC§
->
nDoc
>0 );

127470 
iCﬁ
=0; iCﬁ<
pTab
->
nCﬁumn
; iCol++){

127471 
aiOut
[
iCﬁ
*3 + 1] = (
u32
)
pC§
->
nDoc
;

127472 
aiOut
[
iCﬁ
*3 + 2] = (
u32
)
pC§
->
nDoc
;

127475 
rc
 = 
	`·s3EvÆG©hîSèts
(
pC§
, 
pEx¥
);

127476 if–
rc
==
SQLITE_OK
 ){

127477 
	`as£π
–
pEx¥
->
aMI
 );

127478 
iCﬁ
=0; iCﬁ<
pTab
->
nCﬁumn
; iCol++){

127479 
aiOut
[
iCﬁ
*3 + 1] = 
pEx¥
->
aMI
[iCol*3 + 1];

127480 
aiOut
[
iCﬁ
*3 + 2] = 
pEx¥
->
aMI
[iCol*3 + 2];

127485  
rc
;

127507 
SQLITE_PRIVATE
 
	`sqlôe3Fts3EvÆPhø£Po¶i°
(

127508 
Fts3Curs‹
 *
pC§
,

127509 
Fts3Ex¥
 *
pEx¥
,

127510 
iCﬁ
,

127511 **
µOut


127513 
Fts3Phø£
 *
pPhø£
 = 
pEx¥
->pPhrase;

127514 
Fts3TabÀ
 *
pTab
 = (Fts3TabÀ *)
pC§
->
ba£
.
pVèb
;

127515 *
pIãr
;

127516 
iThis
;

127517 
sqlôe3_öt64
 
iDocid
;

127521 *
µOut
 = 0;

127522 
	`as£π
–
iCﬁ
>=0 && iCﬁ<
pTab
->
nCﬁumn
 );

127523 if–(
pPhø£
->
iCﬁumn
<
pTab
->
nCﬁumn
 &&ÖPhø£->iCﬁumn!=
iCﬁ
) ){

127524  
SQLITE_OK
;

127527 
iDocid
 = 
pEx¥
->iDocid;

127528 
pIãr
 = 
pPhø£
->
do˛i°
.
pLi°
;

127529 if–
iDocid
!=
pC§
->
iPªvId
 || 
pEx¥
->
bEof
 ){

127530 
bDescDo˛i°
 = 
pTab
->
bDescIdx
;

127531 
iMul
;

127532 
bOr
 = 0;

127533 
u8
 
bEof
 = 0;

127534 
u8
 
bTªeEof
 = 0;

127535 
Fts3Ex¥
 *
p
;

127536 
Fts3Ex¥
 *
pNór
;

127543 
pNór
 = 
pEx¥
;

127544 
p
=
pEx¥
->
pP¨ít
;Ö;Ö=p->pParent){

127545 if–
p
->
eTy≥
==
FTSQUERY_OR
 ) 
bOr
 = 1;

127546 if–
p
->
eTy≥
==
FTSQUERY_NEAR
 ) 
pNór
 =Ö;

127547 if–
p
->
bEof
 ) 
bTªeEof
 = 1;

127549 if–
bOr
==0 )  
SQLITE_OK
;

127554 if–
pPhø£
->
bIn¸
 ){

127555 
rc
 = 
SQLITE_OK
;

127556 
bEofSave
 = 
pEx¥
->
bEof
;

127557 
	`·s3EvÆRe°¨t
(
pC§
, 
pEx¥
, &
rc
);

127558  
rc
==
SQLITE_OK
 && !
pEx¥
->
bEof
 ){

127559 
	`·s3EvÆNextRow
(
pC§
, 
pEx¥
, &
rc
);

127560 if–
bEofSave
==0 && 
pEx¥
->
iDocid
==iDocid ) ;

127562 
pIãr
 = 
pPhø£
->
do˛i°
.
pLi°
;

127563 
	`as£π
–
rc
!=
SQLITE_OK
 || 
pPhø£
->
bIn¸
==0 );

127564 if–
rc
!=
SQLITE_OK
 ) Ñc;

127567 
iMul
 = ((
pC§
->
bDesc
==
bDescDo˛i°
) ? 1 : -1);

127568  
bTªeEof
==1

127569 && 
pNór
->
bEof
==0

127570 && (
	`DOCID_CMP
(
pNór
->
iDocid
, 
pC§
->
iPªvId
Ë* 
iMul
)<0

127572 
rc
 = 
SQLITE_OK
;

127573 
	`·s3EvÆNextRow
(
pC§
, 
pEx¥
, &
rc
);

127574 if–
rc
!=
SQLITE_OK
 ) Ñc;

127575 
iDocid
 = 
pEx¥
->iDocid;

127576 
pIãr
 = 
pPhø£
->
do˛i°
.
pLi°
;

127579 
bEof
 = (
pPhø£
->
do˛i°
.
nAŒ
==0);

127580 
	`as£π
–
bDescDo˛i°
==0 || bDescDoclist==1 );

127581 
	`as£π
–
pC§
->
bDesc
==0 ||ÖCsr->bDesc==1 );

127583 if–
bEof
==0 ){

127584 if–
pC§
->
bDesc
==
bDescDo˛i°
 ){

127585 
dummy
;

127586 if–
pNór
->
bEof
 ){

127599 
pIãr
 = &
pPhø£
->
do˛i°
.
aAŒ
[pPhø£->do˛i°.
nAŒ
-1];

127600 
	`·s3Revî£Po¶i°
(
pPhø£
->
do˛i°
.
aAŒ
, &
pIãr
);

127602  (
pIãr
==0 || 
	`DOCID_CMP
(
iDocid
, 
pC§
->
iPªvId
)>0 ) && 
bEof
==0 ){

127603 
	`sqlôe3Fts3Do˛i°Pªv
(

127604 
bDescDo˛i°
, 
pPhø£
->
do˛i°
.
aAŒ
,ÖPhø£->do˛i°.
nAŒ
,

127605 &
pIãr
, &
iDocid
, &
dummy
, &
bEof


127609 if–
pNór
->
bEof
 ){

127610 
pIãr
 = 0;

127611 
iDocid
 = 0;

127613  (
pIãr
==0 || 
	`DOCID_CMP
(
iDocid
, 
pC§
->
iPªvId
)<0 ) && 
bEof
==0 ){

127614 
	`sqlôe3Fts3Do˛i°Next
(

127615 
bDescDo˛i°
, 
pPhø£
->
do˛i°
.
aAŒ
,ÖPhø£->do˛i°.
nAŒ
,

127616 &
pIãr
, &
iDocid
, &
bEof


127622 if–
bEof
 || 
iDocid
!=
pC§
->
iPªvId
 ) 
pIãr
 = 0;

127624 if–
pIãr
==0 )  
SQLITE_OK
;

127626 if–*
pIãr
==0x01 ){

127627 
pIãr
++;

127628 
pIãr
 +
	`sqlôe3Fts3GëV¨öt32
’Iãr, &
iThis
);

127630 
iThis
 = 0;

127632  
iThis
<
iCﬁ
 ){

127633 
	`·s3Cﬁum∆i°C›y
(0, &
pIãr
);

127634 if–*
pIãr
==0x00 )  0;

127635 
pIãr
++;

127636 
pIãr
 +
	`sqlôe3Fts3GëV¨öt32
’Iãr, &
iThis
);

127639 *
µOut
 = ((
iCﬁ
==
iThis
)?
pIãr
:0);

127640  
SQLITE_OK
;

127650 
SQLITE_PRIVATE
 
	`sqlôe3Fts3EvÆPhø£CÀ™up
(
Fts3Phø£
 *
pPhø£
){

127651 if–
pPhø£
 ){

127652 
i
;

127653 
	`sqlôe3_‰ì
(
pPhø£
->
do˛i°
.
aAŒ
);

127654 
	`·s3EvÆInvÆid©ePo¶i°
(
pPhø£
);

127655 
	`mem£t
(&
pPhø£
->
do˛i°
, 0, (
Fts3Do˛i°
));

127656 
i
=0; i<
pPhø£
->
nTokí
; i++){

127657 
	`·s3SegRódîCurs‹Fªe
(
pPhø£
->
aTokí
[
i
].
pSegc§
);

127658 
pPhø£
->
aTokí
[
i
].
pSegc§
 = 0;

127667 #ifde‡
SQLITE_DEBUG


127668 
SQLITE_PRIVATE
 
	`sqlôe3Fts3C‹ru±
(){

127669  
SQLITE_CORRUPT_VTAB
;

127673 #i‡!
SQLITE_CORE


127677 #ifde‡
_WIN32


127678 
	`__de˛•ec
(
dŒexp‹t
)

127680 
SQLITE_API
 
	`sqlôe3_·s3_öô
(

127681 
sqlôe3
 *
db
,

127682 **
pzEºMsg
,

127683 c⁄° 
sqlôe3_≠i_routöes
 *
pApi


127685 
	`SQLITE_EXTENSION_INIT2
(
pApi
)

127686  
	`sqlôe3Fts3Inô
(
db
);

127707 #i‡!
	`deföed
(
SQLITE_CORE
Ë|| deföed(
SQLITE_ENABLE_FTS3
)

127712 
Fts3auxTabÀ
 
	tFts3auxTabÀ
;

127713 
Fts3auxCurs‹
 
	tFts3auxCurs‹
;

127715 
	sFts3auxTabÀ
 {

127716 
sqlôe3_vèb
 
ba£
;

127717 
Fts3TabÀ
 *
pFts3Tab
;

127720 
	sFts3auxCurs‹
 {

127721 
sqlôe3_vèb_curs‹
 
ba£
;

127722 
Fts3Mu…iSegRódî
 
c§
;

127723 
Fts3SegFûãr
 
fûãr
;

127724 *
zSt›
;

127725 
nSt›
;

127726 
iL™gid
;

127727 
isEof
;

127728 
sqlôe3_öt64
 
iRowid
;

127730 
iCﬁ
;

127731 
nSèt
;

127732 
	sFts3auxCﬁ°©s
 {

127733 
sqlôe3_öt64
 
nDoc
;

127734 
sqlôe3_öt64
 
nOcc
;

127735 } *
aSèt
;

127741 
	#FTS3_AUX_SCHEMA
 \

127742 "CREATE TABLE x—îm, cﬁ, documíts, occuºí˚s,Ü™guageid HIDDEN)"

	)

127749 
	`·s3auxC⁄√˘Mëhod
(

127750 
sqlôe3
 *
db
,

127751 *
pUnu£d
,

127752 
¨gc
,

127753 c⁄° * c⁄° *
¨gv
,

127754 
sqlôe3_vèb
 **
µVèb
,

127755 **
pzEº


127757 c⁄° *
zDb
;

127758 c⁄° *
zFts3
;

127759 
nDb
;

127760 
nFts3
;

127761 
nByã
;

127762 
rc
;

127763 
Fts3auxTabÀ
 *
p
;

127765 
	`UNUSED_PARAMETER
(
pUnu£d
);

127772 if–
¨gc
!=4 &&árgc!=5 ) 
bad_¨gs
;

127774 
zDb
 = 
¨gv
[1];

127775 
nDb
 = ()
	`°æí
(
zDb
);

127776 if–
¨gc
==5 ){

127777 if–
nDb
==4 && 0==
	`sqlôe3_°∫icmp
("ãmp", 
zDb
, 4) ){

127778 
zDb
 = 
¨gv
[3];

127779 
nDb
 = ()
	`°æí
(
zDb
);

127780 
zFts3
 = 
¨gv
[4];

127782 
bad_¨gs
;

127785 
zFts3
 = 
¨gv
[3];

127787 
nFts3
 = ()
	`°æí
(
zFts3
);

127789 
rc
 = 
	`sqlôe3_de˛¨e_vèb
(
db
, 
FTS3_AUX_SCHEMA
);

127790 if–
rc
!=
SQLITE_OK
 ) Ñc;

127792 
nByã
 = (
Fts3auxTabÀ
Ë+ (
Fts3TabÀ
Ë+ 
nDb
 + 
nFts3
 + 2;

127793 
p
 = (
Fts3auxTabÀ
 *)
	`sqlôe3_mÆloc
(
nByã
);

127794 if–!
p
 )  
SQLITE_NOMEM
;

127795 
	`mem£t
(
p
, 0, 
nByã
);

127797 
p
->
pFts3Tab
 = (
Fts3TabÀ
 *)&p[1];

127798 
p
->
pFts3Tab
->
zDb
 = (*)&p->pFts3Tab[1];

127799 
p
->
pFts3Tab
->
zName
 = &p->pFts3Tab->
zDb
[
nDb
+1];

127800 
p
->
pFts3Tab
->
db
 = db;

127801 
p
->
pFts3Tab
->
nIndex
 = 1;

127803 
	`mem˝y
((*)
p
->
pFts3Tab
->
zDb
, zDb, 
nDb
);

127804 
	`mem˝y
((*)
p
->
pFts3Tab
->
zName
, 
zFts3
, 
nFts3
);

127805 
	`sqlôe3Fts3DequŸe
((*)
p
->
pFts3Tab
->
zName
);

127807 *
µVèb
 = (
sqlôe3_vèb
 *)
p
;

127808  
SQLITE_OK
;

127810 
bad_¨gs
:

127811 *
pzEº
 = 
	`sqlôe3_m¥ötf
("invalidárgumentsÅo fts4aux constructor");

127812  
SQLITE_ERROR
;

127820 
	`·s3auxDisc⁄√˘Mëhod
(
sqlôe3_vèb
 *
pVèb
){

127821 
Fts3auxTabÀ
 *
p
 = (Fts3auxTabÀ *)
pVèb
;

127822 
Fts3TabÀ
 *
pFts3
 = 
p
->
pFts3Tab
;

127823 
i
;

127826 
i
=0; i<
	`SizeofAºay
(
pFts3
->
aStmt
); i++){

127827 
	`sqlôe3_föÆize
(
pFts3
->
aStmt
[
i
]);

127829 
	`sqlôe3_‰ì
(
pFts3
->
zSegmítsTbl
);

127830 
	`sqlôe3_‰ì
(
p
);

127831  
SQLITE_OK
;

127834 
	#FTS4AUX_EQ_CONSTRAINT
 1

	)

127835 
	#FTS4AUX_GE_CONSTRAINT
 2

	)

127836 
	#FTS4AUX_LE_CONSTRAINT
 4

	)

127841 
	`·s3auxBe°IndexMëhod
(

127842 
sqlôe3_vèb
 *
pVTab
,

127843 
sqlôe3_ödex_öfo
 *
pInfo


127845 
i
;

127846 
iEq
 = -1;

127847 
iGe
 = -1;

127848 
iLe
 = -1;

127849 
iL™gid
 = -1;

127850 
iNext
 = 1;

127852 
	`UNUSED_PARAMETER
(
pVTab
);

127855 if–
pInfo
->
nOrdîBy
==1

127856 && 
pInfo
->
aOrdîBy
[0].
iCﬁumn
==0

127857 && 
pInfo
->
aOrdîBy
[0].
desc
==0

127859 
pInfo
->
‹dîByC⁄sumed
 = 1;

127864 
i
=0; i<
pInfo
->
nC⁄°øöt
; i++){

127865 if–
pInfo
->
aC⁄°øöt
[
i
].
ußbÀ
 ){

127866 
›
 = 
pInfo
->
aC⁄°øöt
[
i
].op;

127867 
iCﬁ
 = 
pInfo
->
aC⁄°øöt
[
i
].
iCﬁumn
;

127869 if–
iCﬁ
==0 ){

127870 if–
›
==
SQLITE_INDEX_CONSTRAINT_EQ
 ) 
iEq
 = 
i
;

127871 if–
›
==
SQLITE_INDEX_CONSTRAINT_LT
 ) 
iLe
 = 
i
;

127872 if–
›
==
SQLITE_INDEX_CONSTRAINT_LE
 ) 
iLe
 = 
i
;

127873 if–
›
==
SQLITE_INDEX_CONSTRAINT_GT
 ) 
iGe
 = 
i
;

127874 if–
›
==
SQLITE_INDEX_CONSTRAINT_GE
 ) 
iGe
 = 
i
;

127876 if–
iCﬁ
==4 ){

127877 if–
›
==
SQLITE_INDEX_CONSTRAINT_EQ
 ) 
iL™gid
 = 
i
;

127882 if–
iEq
>=0 ){

127883 
pInfo
->
idxNum
 = 
FTS4AUX_EQ_CONSTRAINT
;

127884 
pInfo
->
aC⁄°øötUßge
[
iEq
].
¨gvIndex
 = 
iNext
++;

127885 
pInfo
->
e°im©edCo°
 = 5;

127887 
pInfo
->
idxNum
 = 0;

127888 
pInfo
->
e°im©edCo°
 = 20000;

127889 if–
iGe
>=0 ){

127890 
pInfo
->
idxNum
 +
FTS4AUX_GE_CONSTRAINT
;

127891 
pInfo
->
aC⁄°øötUßge
[
iGe
].
¨gvIndex
 = 
iNext
++;

127892 
pInfo
->
e°im©edCo°
 /= 2;

127894 if–
iLe
>=0 ){

127895 
pInfo
->
idxNum
 +
FTS4AUX_LE_CONSTRAINT
;

127896 
pInfo
->
aC⁄°øötUßge
[
iLe
].
¨gvIndex
 = 
iNext
++;

127897 
pInfo
->
e°im©edCo°
 /= 2;

127900 if–
iL™gid
>=0 ){

127901 
pInfo
->
aC⁄°øötUßge
[
iL™gid
].
¨gvIndex
 = 
iNext
++;

127902 
pInfo
->
e°im©edCo°
--;

127905  
SQLITE_OK
;

127911 
	`·s3auxO≥nMëhod
(
sqlôe3_vèb
 *
pVTab
, 
sqlôe3_vèb_curs‹
 **
µC§
){

127912 
Fts3auxCurs‹
 *
pC§
;

127914 
	`UNUSED_PARAMETER
(
pVTab
);

127916 
pC§
 = (
Fts3auxCurs‹
 *)
	`sqlôe3_mÆloc
((Fts3auxCursor));

127917 if–!
pC§
 )  
SQLITE_NOMEM
;

127918 
	`mem£t
(
pC§
, 0, (
Fts3auxCurs‹
));

127920 *
µC§
 = (
sqlôe3_vèb_curs‹
 *)
pC§
;

127921  
SQLITE_OK
;

127927 
	`·s3auxClo£Mëhod
(
sqlôe3_vèb_curs‹
 *
pCurs‹
){

127928 
Fts3TabÀ
 *
pFts3
 = ((
Fts3auxTabÀ
 *)
pCurs‹
->
pVèb
)->
pFts3Tab
;

127929 
Fts3auxCurs‹
 *
pC§
 = (Fts3auxCurs‹ *)
pCurs‹
;

127931 
	`sqlôe3Fts3SegmítsClo£
(
pFts3
);

127932 
	`sqlôe3Fts3SegRódîFöish
(&
pC§
->
c§
);

127933 
	`sqlôe3_‰ì
((*)
pC§
->
fûãr
.
zTîm
);

127934 
	`sqlôe3_‰ì
(
pC§
->
zSt›
);

127935 
	`sqlôe3_‰ì
(
pC§
->
aSèt
);

127936 
	`sqlôe3_‰ì
(
pC§
);

127937  
SQLITE_OK
;

127940 
	`·s3auxGrowSètAºay
(
Fts3auxCurs‹
 *
pC§
, 
nSize
){

127941 if–
nSize
>
pC§
->
nSèt
 ){

127942 
Fts3auxCﬁ°©s
 *
aNew
;

127943 
aNew
 = (
Fts3auxCﬁ°©s
 *)
	`sqlôe3_ªÆloc
(
pC§
->
aSèt
,

127944 (
Fts3auxCﬁ°©s
Ë* 
nSize


127946 if–
aNew
==0 )  
SQLITE_NOMEM
;

127947 
	`mem£t
(&
aNew
[
pC§
->
nSèt
], 0,

127948 (
Fts3auxCﬁ°©s
Ë* (
nSize
 - 
pC§
->
nSèt
)

127950 
pC§
->
aSèt
 = 
aNew
;

127951 
pC§
->
nSèt
 = 
nSize
;

127953  
SQLITE_OK
;

127959 
	`·s3auxNextMëhod
(
sqlôe3_vèb_curs‹
 *
pCurs‹
){

127960 
Fts3auxCurs‹
 *
pC§
 = (Fts3auxCurs‹ *)
pCurs‹
;

127961 
Fts3TabÀ
 *
pFts3
 = ((
Fts3auxTabÀ
 *)
pCurs‹
->
pVèb
)->
pFts3Tab
;

127962 
rc
;

127965 
pC§
->
iRowid
++;

127967 
pC§
->
iCﬁ
++;ÖC§->iCﬁ<pC§->
nSèt
;ÖCsr->iCol++){

127968 if–
pC§
->
aSèt
[pC§->
iCﬁ
].
nDoc
>0 )  
SQLITE_OK
;

127971 
rc
 = 
	`sqlôe3Fts3SegRódîSãp
(
pFts3
, &
pC§
->
c§
);

127972 if–
rc
==
SQLITE_ROW
 ){

127973 
i
 = 0;

127974 
nDo˛i°
 = 
pC§
->
c§
.nDoclist;

127975 *
aDo˛i°
 = 
pC§
->
c§
.aDoclist;

127976 
iCﬁ
;

127978 
eSèã
 = 0;

127980 if–
pC§
->
zSt›
 ){

127981 
n
 = (
pC§
->
nSt›
<pC§->
c§
.
nTîm
) ?ÖCsr->nStop :ÖCsr->csr.nTerm;

127982 
mc
 = 
	`memcmp
(
pC§
->
zSt›
,ÖC§->
c§
.
zTîm
, 
n
);

127983 if–
mc
<0 || (mc==0 && 
pC§
->
c§
.
nTîm
>pC§->
nSt›
) ){

127984 
pC§
->
isEof
 = 1;

127985  
SQLITE_OK
;

127989 if–
	`·s3auxGrowSètAºay
(
pC§
, 2ËË 
SQLITE_NOMEM
;

127990 
	`mem£t
(
pC§
->
aSèt
, 0, (
Fts3auxCﬁ°©s
Ë*ÖC§->
nSèt
);

127991 
iCﬁ
 = 0;

127993  
i
<
nDo˛i°
 ){

127994 
sqlôe3_öt64
 
v
 = 0;

127996 
i
 +
	`sqlôe3Fts3GëV¨öt
(&
aDo˛i°
[i], &
v
);

127997  
eSèã
 ){

128000 
pC§
->
aSèt
[0].
nDoc
++;

128001 
eSèã
 = 1;

128002 
iCﬁ
 = 0;

128014 
	`as£π
–
iCﬁ
==0 );

128015 if–
v
>1 ){

128016 
pC§
->
aSèt
[1].
nDoc
++;

128018 
eSèã
 = 2;

128022 if–
v
==0 ){

128023 
eSèã
 = 0;

128024 }if–
v
==1 ){

128025 
eSèã
 = 3;

128027 
pC§
->
aSèt
[
iCﬁ
+1].
nOcc
++;

128028 
pC§
->
aSèt
[0].
nOcc
++;

128033 : 
	`as£π
–
eSèã
==3 );

128034 
iCﬁ
 = ()
v
;

128035 if–
	`·s3auxGrowSètAºay
(
pC§
, 
iCﬁ
+2ËË 
SQLITE_NOMEM
;

128036 
pC§
->
aSèt
[
iCﬁ
+1].
nDoc
++;

128037 
eSèã
 = 2;

128042 
pC§
->
iCﬁ
 = 0;

128043 
rc
 = 
SQLITE_OK
;

128045 
pC§
->
isEof
 = 1;

128047  
rc
;

128053 
	`·s3auxFûãrMëhod
(

128054 
sqlôe3_vèb_curs‹
 *
pCurs‹
,

128055 
idxNum
,

128056 c⁄° *
idxSå
,

128057 
nVÆ
,

128058 
sqlôe3_vÆue
 **
≠VÆ


128060 
Fts3auxCurs‹
 *
pC§
 = (Fts3auxCurs‹ *)
pCurs‹
;

128061 
Fts3TabÀ
 *
pFts3
 = ((
Fts3auxTabÀ
 *)
pCurs‹
->
pVèb
)->
pFts3Tab
;

128062 
rc
;

128063 
isSˇn
 = 0;

128064 
iL™gVÆ
 = 0;

128066 
iEq
 = -1;

128067 
iGe
 = -1;

128068 
iLe
 = -1;

128069 
iL™gid
 = -1;

128070 
iNext
 = 0;

128072 
	`UNUSED_PARAMETER
(
nVÆ
);

128073 
	`UNUSED_PARAMETER
(
idxSå
);

128075 
	`as£π
–
idxSå
==0 );

128076 
	`as£π
–
idxNum
==
FTS4AUX_EQ_CONSTRAINT
 || idxNum==0

128077 || 
idxNum
==
FTS4AUX_LE_CONSTRAINT
 || idxNum==
FTS4AUX_GE_CONSTRAINT


128078 || 
idxNum
==(
FTS4AUX_LE_CONSTRAINT
|
FTS4AUX_GE_CONSTRAINT
)

128081 if–
idxNum
==
FTS4AUX_EQ_CONSTRAINT
 ){

128082 
iEq
 = 
iNext
++;

128084 
isSˇn
 = 1;

128085 if–
idxNum
 & 
FTS4AUX_GE_CONSTRAINT
 ){

128086 
iGe
 = 
iNext
++;

128088 if–
idxNum
 & 
FTS4AUX_LE_CONSTRAINT
 ){

128089 
iLe
 = 
iNext
++;

128092 if–
iNext
<
nVÆ
 ){

128093 
iL™gid
 = 
iNext
++;

128097 
	`ã°ˇ£
(
pC§
->
fûãr
.
zTîm
);

128098 
	`sqlôe3Fts3SegRódîFöish
(&
pC§
->
c§
);

128099 
	`sqlôe3_‰ì
((*)
pC§
->
fûãr
.
zTîm
);

128100 
	`sqlôe3_‰ì
(
pC§
->
aSèt
);

128101 
	`mem£t
(&
pC§
->
c§
, 0, ((
u8
*)&pCsr[1]) - (u8*)&pCsr->csr);

128103 
pC§
->
fûãr
.
Êags
 = 
FTS3_SEGMENT_REQUIRE_POS
|
FTS3_SEGMENT_IGNORE_EMPTY
;

128104 if–
isSˇn
 ) 
pC§
->
fûãr
.
Êags
 |
FTS3_SEGMENT_SCAN
;

128106 if–
iEq
>=0 || 
iGe
>=0 ){

128107 c⁄° *
zSå
 = 
	`sqlôe3_vÆue_ãxt
(
≠VÆ
[0]);

128108 
	`as£π
–(
iEq
==0 && 
iGe
==-1) || (iEq==-1 && iGe==0) );

128109 if–
zSå
 ){

128110 
pC§
->
fûãr
.
zTîm
 = 
	`sqlôe3_m¥ötf
("%s", 
zSå
);

128111 
pC§
->
fûãr
.
nTîm
 = 
	`sqlôe3_vÆue_byãs
(
≠VÆ
[0]);

128112 if–
pC§
->
fûãr
.
zTîm
==0 )  
SQLITE_NOMEM
;

128116 if–
iLe
>=0 ){

128117 
pC§
->
zSt›
 = 
	`sqlôe3_m¥ötf
("%s", 
	`sqlôe3_vÆue_ãxt
(
≠VÆ
[
iLe
]));

128118 
pC§
->
nSt›
 = 
	`sqlôe3_vÆue_byãs
(
≠VÆ
[
iLe
]);

128119 if–
pC§
->
zSt›
==0 )  
SQLITE_NOMEM
;

128122 if–
iL™gid
>=0 ){

128123 
iL™gVÆ
 = 
	`sqlôe3_vÆue_öt
(
≠VÆ
[
iL™gid
]);

128130 if–
iL™gVÆ
<0 ) iLangVal = 0;

128132 
pC§
->
iL™gid
 = 
iL™gVÆ
;

128134 
rc
 = 
	`sqlôe3Fts3SegRódîCurs‹
(
pFts3
, 
iL™gVÆ
, 0, 
FTS3_SEGCURSOR_ALL
,

128135 
pC§
->
fûãr
.
zTîm
,ÖC§->fûãr.
nTîm
, 0, 
isSˇn
, &pC§->
c§


128137 if–
rc
==
SQLITE_OK
 ){

128138 
rc
 = 
	`sqlôe3Fts3SegRódîSèπ
(
pFts3
, &
pC§
->
c§
, &pC§->
fûãr
);

128141 if–
rc
==
SQLITE_OK
 )Ñ¯
	`·s3auxNextMëhod
(
pCurs‹
);

128142  
rc
;

128148 
	`·s3auxEofMëhod
(
sqlôe3_vèb_curs‹
 *
pCurs‹
){

128149 
Fts3auxCurs‹
 *
pC§
 = (Fts3auxCurs‹ *)
pCurs‹
;

128150  
pC§
->
isEof
;

128156 
	`·s3auxCﬁumnMëhod
(

128157 
sqlôe3_vèb_curs‹
 *
pCurs‹
,

128158 
sqlôe3_c⁄ãxt
 *
pCtx
,

128159 
iCﬁ


128161 
Fts3auxCurs‹
 *
p
 = (Fts3auxCurs‹ *)
pCurs‹
;

128163 
	`as£π
–
p
->
isEof
==0 );

128164  
iCﬁ
 ){

128166 
	`sqlôe3_ªsu…_ãxt
(
pCtx
, 
p
->
c§
.
zTîm
,Ö->c§.
nTîm
, 
SQLITE_TRANSIENT
);

128170 if–
p
->
iCﬁ
 ){

128171 
	`sqlôe3_ªsu…_öt
(
pCtx
, 
p
->
iCﬁ
-1);

128173 
	`sqlôe3_ªsu…_ãxt
(
pCtx
, "*", -1, 
SQLITE_STATIC
);

128178 
	`sqlôe3_ªsu…_öt64
(
pCtx
, 
p
->
aSèt
[p->
iCﬁ
].
nDoc
);

128182 
	`sqlôe3_ªsu…_öt64
(
pCtx
, 
p
->
aSèt
[p->
iCﬁ
].
nOcc
);

128186 
	`as£π
–
iCﬁ
==4 );

128187 
	`sqlôe3_ªsu…_öt
(
pCtx
, 
p
->
iL™gid
);

128191  
SQLITE_OK
;

128197 
	`·s3auxRowidMëhod
(

128198 
sqlôe3_vèb_curs‹
 *
pCurs‹
,

128199 
sqlôe_öt64
 *
pRowid


128201 
Fts3auxCurs‹
 *
pC§
 = (Fts3auxCurs‹ *)
pCurs‹
;

128202 *
pRowid
 = 
pC§
->
iRowid
;

128203  
SQLITE_OK
;

128210 
SQLITE_PRIVATE
 
	`sqlôe3Fts3InôAux
(
sqlôe3
 *
db
){

128211 c⁄° 
sqlôe3_moduÀ
 
·s3aux_moduÀ
 = {

128213 
·s3auxC⁄√˘Mëhod
,

128214 
·s3auxC⁄√˘Mëhod
,

128215 
·s3auxBe°IndexMëhod
,

128216 
·s3auxDisc⁄√˘Mëhod
,

128217 
·s3auxDisc⁄√˘Mëhod
,

128218 
·s3auxO≥nMëhod
,

128219 
·s3auxClo£Mëhod
,

128220 
·s3auxFûãrMëhod
,

128221 
·s3auxNextMëhod
,

128222 
·s3auxEofMëhod
,

128223 
·s3auxCﬁumnMëhod
,

128224 
·s3auxRowidMëhod
,

128236 
rc
;

128238 
rc
 = 
	`sqlôe3_¸óã_moduÀ
(
db
, "·s4aux", &
·s3aux_moduÀ
, 0);

128239  
rc
;

128263 #i‡!
	`deföed
(
SQLITE_CORE
Ë|| deföed(
SQLITE_ENABLE_FTS3
)

128310 #ifde‡
SQLITE_TEST


128311 
SQLITE_API
 
sqlôe3_·s3_íabÀ_∑ª¡he£s
 = 0;

128313 #ifde‡
SQLITE_ENABLE_FTS3_PARENTHESIS


128314 
	#sqlôe3_·s3_íabÀ_∑ª¡he£s
 1

	)

128316 
	#sqlôe3_·s3_íabÀ_∑ª¡he£s
 0

	)

128323 
	#SQLITE_FTS3_DEFAULT_NEAR_PARAM
 10

	)

128336 
P¨£C⁄ãxt
 
	tP¨£C⁄ãxt
;

128337 
	sP¨£C⁄ãxt
 {

128338 
sqlôe3_tokíizî
 *
pTokíizî
;

128339 
iL™gid
;

128340 c⁄° **
azCﬁ
;

128341 
bFts4
;

128342 
nCﬁ
;

128343 
iDeÁu…Cﬁ
;

128344 
isNŸ
;

128345 
sqlôe3_c⁄ãxt
 *
pCtx
;

128346 
nNe°
;

128360 
	`·s3is•a˚
(
c
){

128361  
c
==' ' || c=='\t' || c=='\n' || c=='\r' || c=='\v' || c=='\f';

128369 *
	`·s3MÆlocZîo
(
nByã
){

128370 *
pRë
 = 
	`sqlôe3_mÆloc
(
nByã
);

128371 if–
pRë
 ) 
	`mem£t
’Rë, 0, 
nByã
);

128372  
pRë
;

128375 
SQLITE_PRIVATE
 
	`sqlôe3Fts3O≥nTokíizî
(

128376 
sqlôe3_tokíizî
 *
pTokíizî
,

128377 
iL™gid
,

128378 c⁄° *
z
,

128379 
n
,

128380 
sqlôe3_tokíizî_curs‹
 **
µC§


128382 
sqlôe3_tokíizî_moduÀ
 c⁄° *
pModuÀ
 = 
pTokíizî
->pModule;

128383 
sqlôe3_tokíizî_curs‹
 *
pC§
 = 0;

128384 
rc
;

128386 
rc
 = 
pModuÀ
->
	`xO≥n
(
pTokíizî
, 
z
, 
n
, &
pC§
);

128387 
	`as£π
–
rc
==
SQLITE_OK
 || 
pC§
==0 );

128388 if–
rc
==
SQLITE_OK
 ){

128389 
pC§
->
pTokíizî
 =ÖTokenizer;

128390 if–
pModuÀ
->
iVîsi⁄
>=1 ){

128391 
rc
 = 
pModuÀ
->
	`xL™guageid
(
pC§
, 
iL™gid
);

128392 if–
rc
!=
SQLITE_OK
 ){

128393 
pModuÀ
->
	`xClo£
(
pC§
);

128394 
pC§
 = 0;

128398 *
µC§
 = 
pC§
;

128399  
rc
;

128415 
	`gëNextTokí
(

128416 
P¨£C⁄ãxt
 *
pP¨£
,

128417 
iCﬁ
,

128418 c⁄° *
z
, 
n
,

128419 
Fts3Ex¥
 **
µEx¥
,

128420 *
≤C⁄sumed


128422 
sqlôe3_tokíizî
 *
pTokíizî
 = 
pP¨£
->pTokenizer;

128423 
sqlôe3_tokíizî_moduÀ
 c⁄° *
pModuÀ
 = 
pTokíizî
->pModule;

128424 
rc
;

128425 
sqlôe3_tokíizî_curs‹
 *
pCurs‹
;

128426 
Fts3Ex¥
 *
pRë
 = 0;

128427 
nC⁄sumed
 = 0;

128429 
rc
 = 
	`sqlôe3Fts3O≥nTokíizî
(
pTokíizî
, 
pP¨£
->
iL™gid
, 
z
, 
n
, &
pCurs‹
);

128430 if–
rc
==
SQLITE_OK
 ){

128431 c⁄° *
zTokí
;

128432 
nTokí
 = 0, 
iSèπ
 = 0, 
iEnd
 = 0, 
iPosôi⁄
 = 0;

128433 
nByã
;

128435 
rc
 = 
pModuÀ
->
	`xNext
(
pCurs‹
, &
zTokí
, &
nTokí
, &
iSèπ
, &
iEnd
, &
iPosôi⁄
);

128436 if–
rc
==
SQLITE_OK
 ){

128437 
nByã
 = (
Fts3Ex¥
Ë+ (
Fts3Phø£
Ë+ 
nTokí
;

128438 
pRë
 = (
Fts3Ex¥
 *)
	`·s3MÆlocZîo
(
nByã
);

128439 if–!
pRë
 ){

128440 
rc
 = 
SQLITE_NOMEM
;

128442 
pRë
->
eTy≥
 = 
FTSQUERY_PHRASE
;

128443 
pRë
->
pPhø£
 = (
Fts3Phø£
 *)&pRet[1];

128444 
pRë
->
pPhø£
->
nTokí
 = 1;

128445 
pRë
->
pPhø£
->
iCﬁumn
 = 
iCﬁ
;

128446 
pRë
->
pPhø£
->
aTokí
[0].
n
 = 
nTokí
;

128447 
pRë
->
pPhø£
->
aTokí
[0].
z
 = (*)&pRet->pPhrase[1];

128448 
	`mem˝y
(
pRë
->
pPhø£
->
aTokí
[0].
z
, 
zTokí
, 
nTokí
);

128450 if–
iEnd
<
n
 && 
z
[iEnd]=='*' ){

128451 
pRë
->
pPhø£
->
aTokí
[0].
isPªfix
 = 1;

128452 
iEnd
++;

128456 if–!
sqlôe3_·s3_íabÀ_∑ª¡he£s


128457 && 
iSèπ
>0 && 
z
[iStart-1]=='-'

128459 
pP¨£
->
isNŸ
 = 1;

128460 
iSèπ
--;

128461 }if–
pP¨£
->
bFts4
 && 
iSèπ
>0 && 
z
[iStart-1]=='^' ){

128462 
pRë
->
pPhø£
->
aTokí
[0].
bFú°
 = 1;

128463 
iSèπ
--;

128470 
nC⁄sumed
 = 
iEnd
;

128473 
pModuÀ
->
	`xClo£
(
pCurs‹
);

128476 *
≤C⁄sumed
 = 
nC⁄sumed
;

128477 *
µEx¥
 = 
pRë
;

128478  
rc
;

128486 *
	`·s3RóŒocOrFªe
(*
pOrig
, 
nNew
){

128487 *
pRë
 = 
	`sqlôe3_ªÆloc
(
pOrig
, 
nNew
);

128488 if–!
pRë
 ){

128489 
	`sqlôe3_‰ì
(
pOrig
);

128491  
pRë
;

128506 
	`gëNextSåög
(

128507 
P¨£C⁄ãxt
 *
pP¨£
,

128508 c⁄° *
zI≈ut
, 
nI≈ut
,

128509 
Fts3Ex¥
 **
µEx¥


128511 
sqlôe3_tokíizî
 *
pTokíizî
 = 
pP¨£
->pTokenizer;

128512 
sqlôe3_tokíizî_moduÀ
 c⁄° *
pModuÀ
 = 
pTokíizî
->pModule;

128513 
rc
;

128514 
Fts3Ex¥
 *
p
 = 0;

128515 
sqlôe3_tokíizî_curs‹
 *
pCurs‹
 = 0;

128516 *
zTemp
 = 0;

128517 
nTemp
 = 0;

128519 c⁄° 
nS∑˚
 = (
Fts3Ex¥
Ë+ (
Fts3Phø£
);

128520 
nTokí
 = 0;

128541 
rc
 = 
	`sqlôe3Fts3O≥nTokíizî
(

128542 
pTokíizî
, 
pP¨£
->
iL™gid
, 
zI≈ut
, 
nI≈ut
, &
pCurs‹
);

128543 if–
rc
==
SQLITE_OK
 ){

128544 
ii
;

128545 
ii
=0; 
rc
==
SQLITE_OK
; ii++){

128546 c⁄° *
zByã
;

128547 
nByã
 = 0, 
iBegö
 = 0, 
iEnd
 = 0, 
iPos
 = 0;

128548 
rc
 = 
pModuÀ
->
	`xNext
(
pCurs‹
, &
zByã
, &
nByã
, &
iBegö
, &
iEnd
, &
iPos
);

128549 if–
rc
==
SQLITE_OK
 ){

128550 
Fts3Phø£Tokí
 *
pTokí
;

128552 
p
 = 
	`·s3RóŒocOrFªe
’, 
nS∑˚
 + 
ii
*(
Fts3Phø£Tokí
));

128553 if–!
p
 ) 
no_mem
;

128555 
zTemp
 = 
	`·s3RóŒocOrFªe
(zTemp, 
nTemp
 + 
nByã
);

128556 if–!
zTemp
 ) 
no_mem
;

128558 
	`as£π
–
nTokí
==
ii
 );

128559 
pTokí
 = &((
Fts3Phø£
 *)(&
p
[1]))->
aTokí
[
ii
];

128560 
	`mem£t
(
pTokí
, 0, (
Fts3Phø£Tokí
));

128562 
	`mem˝y
(&
zTemp
[
nTemp
], 
zByã
, 
nByã
);

128563 
nTemp
 +
nByã
;

128565 
pTokí
->
n
 = 
nByã
;

128566 
pTokí
->
isPªfix
 = (
iEnd
<
nI≈ut
 && 
zI≈ut
[iEnd]=='*');

128567 
pTokí
->
bFú°
 = (
iBegö
>0 && 
zI≈ut
[iBegin-1]=='^');

128568 
nTokí
 = 
ii
+1;

128572 
pModuÀ
->
	`xClo£
(
pCurs‹
);

128573 
pCurs‹
 = 0;

128576 if–
rc
==
SQLITE_DONE
 ){

128577 
jj
;

128578 *
zBuf
 = 0;

128580 
p
 = 
	`·s3RóŒocOrFªe
’, 
nS∑˚
 + 
nTokí
*(
Fts3Phø£Tokí
Ë+ 
nTemp
);

128581 if–!
p
 ) 
no_mem
;

128582 
	`mem£t
(
p
, 0, (*)&(((
Fts3Phø£
 *)&p[1])->
aTokí
[0])-(*)p);

128583 
p
->
eTy≥
 = 
FTSQUERY_PHRASE
;

128584 
p
->
pPhø£
 = (
Fts3Phø£
 *)&p[1];

128585 
p
->
pPhø£
->
iCﬁumn
 = 
pP¨£
->
iDeÁu…Cﬁ
;

128586 
p
->
pPhø£
->
nTokí
 =ÇToken;

128588 
zBuf
 = (*)&
p
->
pPhø£
->
aTokí
[
nTokí
];

128589 if–
zTemp
 ){

128590 
	`mem˝y
(
zBuf
, 
zTemp
, 
nTemp
);

128591 
	`sqlôe3_‰ì
(
zTemp
);

128593 
	`as£π
–
nTemp
==0 );

128596 
jj
=0; jj<
p
->
pPhø£
->
nTokí
; jj++){

128597 
p
->
pPhø£
->
aTokí
[
jj
].
z
 = 
zBuf
;

128598 
zBuf
 +
p
->
pPhø£
->
aTokí
[
jj
].
n
;

128600 
rc
 = 
SQLITE_OK
;

128603 *
µEx¥
 = 
p
;

128604  
rc
;

128605 
no_mem
:

128607 if–
pCurs‹
 ){

128608 
pModuÀ
->
	`xClo£
(
pCurs‹
);

128610 
	`sqlôe3_‰ì
(
zTemp
);

128611 
	`sqlôe3_‰ì
(
p
);

128612 *
µEx¥
 = 0;

128613  
SQLITE_NOMEM
;

128620 
	`·s3Ex¥P¨£
(
P¨£C⁄ãxt
 *, c⁄° *, , 
Fts3Ex¥
 **, *);

128630 
	`gëNextNode
(

128631 
P¨£C⁄ãxt
 *
pP¨£
,

128632 c⁄° *
z
, 
n
,

128633 
Fts3Ex¥
 **
µEx¥
,

128634 *
≤C⁄sumed


128636 c⁄° 
	sFts3Keyw‹d
 {

128637 *
z
;

128638 
n
;

128639 
∑ªnO∆y
;

128640 
eTy≥
;

128641 } 
aKeyw‹d
[] = {

128642 { "OR" , 2, 0, 
FTSQUERY_OR
 },

128643 { "AND", 3, 1, 
FTSQUERY_AND
 },

128644 { "NOT", 3, 1, 
FTSQUERY_NOT
 },

128645 { "NEAR", 4, 0, 
FTSQUERY_NEAR
 }

128647 
ii
;

128648 
iCﬁ
;

128649 
iCﬁLí
;

128650 
rc
;

128651 
Fts3Ex¥
 *
pRë
 = 0;

128653 c⁄° *
zI≈ut
 = 
z
;

128654 
nI≈ut
 = 
n
;

128656 
pP¨£
->
isNŸ
 = 0;

128661  
nI≈ut
>0 && 
	`·s3is•a˚
(*
zI≈ut
) ){

128662 
nI≈ut
--;

128663 
zI≈ut
++;

128665 if–
nI≈ut
==0 ){

128666  
SQLITE_DONE
;

128670 
ii
=0; ii<()((
aKeyw‹d
)/(
Fts3Keyw‹d
)); ii++){

128671 c⁄° 
Fts3Keyw‹d
 *
pKey
 = &
aKeyw‹d
[
ii
];

128673 if–(
pKey
->
∑ªnO∆y
 & ~
sqlôe3_·s3_íabÀ_∑ª¡he£s
)!=0 ){

128677 if–
nI≈ut
>=
pKey
->
n
 && 0==
	`memcmp
(
zI≈ut
,ÖKey->
z
,ÖKey->n) ){

128678 
nNór
 = 
SQLITE_FTS3_DEFAULT_NEAR_PARAM
;

128679 
nKey
 = 
pKey
->
n
;

128680 
cNext
;

128683 if–
pKey
->
eTy≥
==
FTSQUERY_NEAR
 ){

128684 
	`as£π
–
nKey
==4 );

128685 if–
zI≈ut
[4]=='/' && zInput[5]>='0' && zInput[5]<='9' ){

128686 
nNór
 = 0;

128687 
nKey
=5; 
zI≈ut
[nKey]>='0' && zInput[nKey]<='9';ÇKey++){

128688 
nNór
 =ÇNó∏* 10 + (
zI≈ut
[
nKey
] - '0');

128697 
cNext
 = 
zI≈ut
[
nKey
];

128698 if–
	`·s3is•a˚
(
cNext
)

128699 || 
cNext
=='"' || cNext=='(' || cNext==')' || cNext==0

128701 
pRë
 = (
Fts3Ex¥
 *)
	`·s3MÆlocZîo
((Fts3Expr));

128702 if–!
pRë
 ){

128703  
SQLITE_NOMEM
;

128705 
pRë
->
eTy≥
 = 
pKey
->eType;

128706 
pRë
->
nNór
 =ÇNear;

128707 *
µEx¥
 = 
pRë
;

128708 *
≤C⁄sumed
 = ()((
zI≈ut
 - 
z
Ë+ 
nKey
);

128709  
SQLITE_OK
;

128719 if–
sqlôe3_·s3_íabÀ_∑ª¡he£s
 ){

128720 if–*
zI≈ut
=='(' ){

128721 
nC⁄sumed
;

128722 
pP¨£
->
nNe°
++;

128723 
rc
 = 
	`·s3Ex¥P¨£
(
pP¨£
, &
zI≈ut
[1], 
nI≈ut
-1, 
µEx¥
, &
nC⁄sumed
);

128724 if–
rc
==
SQLITE_OK
 && !*
µEx¥
 ){

128725 
rc
 = 
SQLITE_DONE
;

128727 *
≤C⁄sumed
 = ()((
zI≈ut
 - 
z
Ë+ 1 + 
nC⁄sumed
);

128728  
rc
;

128732 if–*
zI≈ut
==')' ){

128733 
pP¨£
->
nNe°
--;

128734 *
≤C⁄sumed
 = ()((
zI≈ut
 - 
z
) + 1);

128735  
SQLITE_DONE
;

128744 if–*
zI≈ut
=='"' ){

128745 
ii
=1; ii<
nI≈ut
 && 
zI≈ut
[ii]!='"'; ii++);

128746 *
≤C⁄sumed
 = ()((
zI≈ut
 - 
z
Ë+ 
ii
 + 1);

128747 if–
ii
==
nI≈ut
 ){

128748  
SQLITE_ERROR
;

128750  
	`gëNextSåög
(
pP¨£
, &
zI≈ut
[1], 
ii
-1, 
µEx¥
);

128765 
iCﬁ
 = 
pP¨£
->
iDeÁu…Cﬁ
;

128766 
iCﬁLí
 = 0;

128767 
ii
=0; ii<
pP¨£
->
nCﬁ
; ii++){

128768 c⁄° *
zSå
 = 
pP¨£
->
azCﬁ
[
ii
];

128769 
nSå
 = ()
	`°æí
(
zSå
);

128770 if–
nI≈ut
>
nSå
 && 
zI≈ut
[nStr]==':'

128771 && 
	`sqlôe3_°∫icmp
(
zSå
, 
zI≈ut
, 
nSå
)==0

128773 
iCﬁ
 = 
ii
;

128774 
iCﬁLí
 = ()((
zI≈ut
 - 
z
Ë+ 
nSå
 + 1);

128778 
rc
 = 
	`gëNextTokí
(
pP¨£
, 
iCﬁ
, &
z
[
iCﬁLí
], 
n
-iCﬁLí, 
µEx¥
, 
≤C⁄sumed
);

128779 *
≤C⁄sumed
 +
iCﬁLí
;

128780  
rc
;

128802 
	`›Pª˚dí˚
(
Fts3Ex¥
 *
p
){

128803 
	`as£π
–
p
->
eTy≥
!=
FTSQUERY_PHRASE
 );

128804 if–
sqlôe3_·s3_íabÀ_∑ª¡he£s
 ){

128805  
p
->
eTy≥
;

128806 }if–
p
->
eTy≥
==
FTSQUERY_NEAR
 ){

128808 }if–
p
->
eTy≥
==
FTSQUERY_OR
 ){

128811 
	`as£π
–
p
->
eTy≥
==
FTSQUERY_AND
 );

128823 
	`ö£πBö¨yO≥øt‹
(

128824 
Fts3Ex¥
 **
µHód
,

128825 
Fts3Ex¥
 *
pPªv
,

128826 
Fts3Ex¥
 *
pNew


128828 
Fts3Ex¥
 *
pS∂ô
 = 
pPªv
;

128829  
pS∂ô
->
pP¨ít
 && 
	`›Pª˚dí˚
’S∂ô->pP¨ít)<=›Pª˚dí˚(
pNew
) ){

128830 
pS∂ô
 =ÖS∂ô->
pP¨ít
;

128833 if–
pS∂ô
->
pP¨ít
 ){

128834 
	`as£π
–
pS∂ô
->
pP¨ít
->
pRight
==pSplit );

128835 
pS∂ô
->
pP¨ít
->
pRight
 = 
pNew
;

128836 
pNew
->
pP¨ít
 = 
pS∂ô
->pParent;

128838 *
µHód
 = 
pNew
;

128840 
pNew
->
pLe·
 = 
pS∂ô
;

128841 
pS∂ô
->
pP¨ít
 = 
pNew
;

128854 
	`·s3Ex¥P¨£
(

128855 
P¨£C⁄ãxt
 *
pP¨£
,

128856 c⁄° *
z
, 
n
,

128857 
Fts3Ex¥
 **
µEx¥
,

128858 *
≤C⁄sumed


128860 
Fts3Ex¥
 *
pRë
 = 0;

128861 
Fts3Ex¥
 *
pPªv
 = 0;

128862 
Fts3Ex¥
 *
pNŸBønch
 = 0;

128863 
nIn
 = 
n
;

128864 c⁄° *
zIn
 = 
z
;

128865 
rc
 = 
SQLITE_OK
;

128866 
isRequúePhø£
 = 1;

128868  
rc
==
SQLITE_OK
 ){

128869 
Fts3Ex¥
 *
p
 = 0;

128870 
nByã
 = 0;

128871 
rc
 = 
	`gëNextNode
(
pP¨£
, 
zIn
, 
nIn
, &
p
, &
nByã
);

128872 if–
rc
==
SQLITE_OK
 ){

128873 
isPhø£
;

128875 if–!
sqlôe3_·s3_íabÀ_∑ª¡he£s


128876 && 
p
->
eTy≥
==
FTSQUERY_PHRASE
 && 
pP¨£
->
isNŸ


128879 
Fts3Ex¥
 *
pNŸ
 = 
	`·s3MÆlocZîo
((Fts3Expr));

128880 if–!
pNŸ
 ){

128881 
	`sqlôe3Fts3Ex¥Fªe
(
p
);

128882 
rc
 = 
SQLITE_NOMEM
;

128883 
ex¥∑r£_out
;

128885 
pNŸ
->
eTy≥
 = 
FTSQUERY_NOT
;

128886 
pNŸ
->
pRight
 = 
p
;

128887 
p
->
pP¨ít
 = 
pNŸ
;

128888 if–
pNŸBønch
 ){

128889 
pNŸ
->
pLe·
 = 
pNŸBønch
;

128890 
pNŸBønch
->
pP¨ít
 = 
pNŸ
;

128892 
pNŸBønch
 = 
pNŸ
;

128893 
p
 = 
pPªv
;

128895 
eTy≥
 = 
p
->eType;

128896 
isPhø£
 = (
eTy≥
==
FTSQUERY_PHRASE
 || 
p
->
pLe·
);

128903 if–!
isPhø£
 && 
isRequúePhø£
 ){

128904 
	`sqlôe3Fts3Ex¥Fªe
(
p
);

128905 
rc
 = 
SQLITE_ERROR
;

128906 
ex¥∑r£_out
;

128909 if–
isPhø£
 && !
isRequúePhø£
 ){

128911 
Fts3Ex¥
 *
pAnd
;

128912 
	`as£π
–
pRë
 && 
pPªv
 );

128913 
pAnd
 = 
	`·s3MÆlocZîo
((
Fts3Ex¥
));

128914 if–!
pAnd
 ){

128915 
	`sqlôe3Fts3Ex¥Fªe
(
p
);

128916 
rc
 = 
SQLITE_NOMEM
;

128917 
ex¥∑r£_out
;

128919 
pAnd
->
eTy≥
 = 
FTSQUERY_AND
;

128920 
	`ö£πBö¨yO≥øt‹
(&
pRë
, 
pPªv
, 
pAnd
);

128921 
pPªv
 = 
pAnd
;

128933 if–
pPªv
 && (

128934 (
eTy≥
==
FTSQUERY_NEAR
 && !
isPhø£
 && 
pPªv
->eTy≥!=
FTSQUERY_PHRASE
)

128935 || (
eTy≥
!=
FTSQUERY_PHRASE
 && 
isPhø£
 && 
pPªv
->eTy≥==
FTSQUERY_NEAR
)

128937 
	`sqlôe3Fts3Ex¥Fªe
(
p
);

128938 
rc
 = 
SQLITE_ERROR
;

128939 
ex¥∑r£_out
;

128942 if–
isPhø£
 ){

128943 if–
pRë
 ){

128944 
	`as£π
–
pPªv
 &&ÖPªv->
pLe·
 &&ÖPªv->
pRight
==0 );

128945 
pPªv
->
pRight
 = 
p
;

128946 
p
->
pP¨ít
 = 
pPªv
;

128948 
pRë
 = 
p
;

128951 
	`ö£πBö¨yO≥øt‹
(&
pRë
, 
pPªv
, 
p
);

128953 
isRequúePhø£
 = !
isPhø£
;

128955 
	`as£π
–
nByã
>0 );

128957 
	`as£π
–
rc
!=
SQLITE_OK
 || (
nByã
>0 &&ÇByã<=
nIn
) );

128958 
nIn
 -
nByã
;

128959 
zIn
 +
nByã
;

128960 
pPªv
 = 
p
;

128963 if–
rc
==
SQLITE_DONE
 && 
pRë
 && 
isRequúePhø£
 ){

128964 
rc
 = 
SQLITE_ERROR
;

128967 if–
rc
==
SQLITE_DONE
 ){

128968 
rc
 = 
SQLITE_OK
;

128969 if–!
sqlôe3_·s3_íabÀ_∑ª¡he£s
 && 
pNŸBønch
 ){

128970 if–!
pRë
 ){

128971 
rc
 = 
SQLITE_ERROR
;

128973 
Fts3Ex¥
 *
pIãr
 = 
pNŸBønch
;

128974  
pIãr
->
pLe·
 ){

128975 
pIãr
 =ÖIãr->
pLe·
;

128977 
pIãr
->
pLe·
 = 
pRë
;

128978 
pRë
->
pP¨ít
 = 
pIãr
;

128979 
pRë
 = 
pNŸBønch
;

128983 *
≤C⁄sumed
 = 
n
 - 
nIn
;

128985 
ex¥∑r£_out
:

128986 if–
rc
!=
SQLITE_OK
 ){

128987 
	`sqlôe3Fts3Ex¥Fªe
(
pRë
);

128988 
	`sqlôe3Fts3Ex¥Fªe
(
pNŸBønch
);

128989 
pRë
 = 0;

128991 *
µEx¥
 = 
pRë
;

128992  
rc
;

128999 
	`·s3Ex¥CheckDïth
(
Fts3Ex¥
 *
p
, 
nMaxDïth
){

129000 
rc
 = 
SQLITE_OK
;

129001 if–
p
 ){

129002 if–
nMaxDïth
<0 ){

129003 
rc
 = 
SQLITE_TOOBIG
;

129005 
rc
 = 
	`·s3Ex¥CheckDïth
(
p
->
pLe·
, 
nMaxDïth
-1);

129006 if–
rc
==
SQLITE_OK
 ){

129007 
rc
 = 
	`·s3Ex¥CheckDïth
(
p
->
pRight
, 
nMaxDïth
-1);

129011  
rc
;

129025 
	`·s3Ex¥BÆ™˚
(
Fts3Ex¥
 **
µ
, 
nMaxDïth
){

129026 
rc
 = 
SQLITE_OK
;

129027 
Fts3Ex¥
 *
pRoŸ
 = *
µ
;

129028 
Fts3Ex¥
 *
pFªe
 = 0;

129029 
eTy≥
 = 
pRoŸ
->eType;

129031 if–
nMaxDïth
==0 ){

129032 
rc
 = 
SQLITE_ERROR
;

129035 if–
rc
==
SQLITE_OK
 && (
eTy≥
==
FTSQUERY_AND
 ||ÉTy≥==
FTSQUERY_OR
) ){

129036 
Fts3Ex¥
 **
≠Lóf
;

129037 
≠Lóf
 = (
Fts3Ex¥
 **)
	`sqlôe3_mÆloc
((Fts3Ex¥ *Ë* 
nMaxDïth
);

129038 if–0==
≠Lóf
 ){

129039 
rc
 = 
SQLITE_NOMEM
;

129041 
	`mem£t
(
≠Lóf
, 0, (
Fts3Ex¥
 *Ë* 
nMaxDïth
);

129044 if–
rc
==
SQLITE_OK
 ){

129045 
i
;

129046 
Fts3Ex¥
 *
p
;

129049 
p
=
pRoŸ
;Ö->
eTy≥
=ÛTy≥;Öı->
pLe·
){

129050 
	`as£π
–
p
->
pP¨ít
==0 ||Ö->pP¨ít->
pLe·
==p );

129051 
	`as£π
–
p
->
pLe·
 &&Ö->
pRight
 );

129056 
iLvl
;

129057 
Fts3Ex¥
 *
pP¨ít
 = 
p
->pParent;

129059 
	`as£π
–
pP¨ít
==0 ||ÖP¨ít->
pLe·
==
p
 );

129060 
p
->
pP¨ít
 = 0;

129061 if–
pP¨ít
 ){

129062 
pP¨ít
->
pLe·
 = 0;

129064 
pRoŸ
 = 0;

129066 
rc
 = 
	`·s3Ex¥BÆ™˚
(&
p
, 
nMaxDïth
-1);

129067 if–
rc
!=
SQLITE_OK
 ) ;

129069 
iLvl
=0; 
p
 && iLvl<
nMaxDïth
; iLvl++){

129070 if–
≠Lóf
[
iLvl
]==0 ){

129071 
≠Lóf
[
iLvl
] = 
p
;

129072 
p
 = 0;

129074 
	`as£π
–
pFªe
 );

129075 
pFªe
->
pLe·
 = 
≠Lóf
[
iLvl
];

129076 
pFªe
->
pRight
 = 
p
;

129077 
pFªe
->
pLe·
->
pP¨ít
 =ÖFree;

129078 
pFªe
->
pRight
->
pP¨ít
 =ÖFree;

129080 
p
 = 
pFªe
;

129081 
pFªe
 =ÖFªe->
pP¨ít
;

129082 
p
->
pP¨ít
 = 0;

129083 
≠Lóf
[
iLvl
] = 0;

129086 if–
p
 ){

129087 
	`sqlôe3Fts3Ex¥Fªe
(
p
);

129088 
rc
 = 
SQLITE_TOOBIG
;

129093 if–
pP¨ít
==0 ) ;

129096 
p
=
pP¨ít
->
pRight
;Ö->
eTy≥
=ÛTy≥;Öı->
pLe·
);

129099 
	`as£π
–
pP¨ít
->pP¨ít==0 ||ÖP¨ít->pP¨ít->
pLe·
==pParent );

129100 
pP¨ít
->
pRight
->pParent =ÖParent->pParent;

129101 if–
pP¨ít
->pParent ){

129102 
pP¨ít
->pP¨ít->
pLe·
 =ÖP¨ít->
pRight
;

129104 
	`as£π
–
pP¨ít
==
pRoŸ
 );

129105 
pRoŸ
 = 
pP¨ít
->
pRight
;

129110 
pP¨ít
->pP¨íà
pFªe
;

129111 
pFªe
 = 
pP¨ít
;

129114 if–
rc
==
SQLITE_OK
 ){

129115 
p
 = 0;

129116 
i
=0; i<
nMaxDïth
; i++){

129117 if–
≠Lóf
[
i
] ){

129118 if–
p
==0 ){

129119 
p
 = 
≠Lóf
[
i
];

129120 
p
->
pP¨ít
 = 0;

129122 
	`as£π
–
pFªe
!=0 );

129123 
pFªe
->
pRight
 = 
p
;

129124 
pFªe
->
pLe·
 = 
≠Lóf
[
i
];

129125 
pFªe
->
pLe·
->
pP¨ít
 =ÖFree;

129126 
pFªe
->
pRight
->
pP¨ít
 =ÖFree;

129128 
p
 = 
pFªe
;

129129 
pFªe
 =ÖFªe->
pP¨ít
;

129130 
p
->
pP¨ít
 = 0;

129134 
pRoŸ
 = 
p
;

129139 
Fts3Ex¥
 *
pDñ
;

129140 
i
=0; i<
nMaxDïth
; i++){

129141 
	`sqlôe3Fts3Ex¥Fªe
(
≠Lóf
[
i
]);

129143  (
pDñ
=
pFªe
)!=0 ){

129144 
pFªe
 = 
pDñ
->
pP¨ít
;

129145 
	`sqlôe3_‰ì
(
pDñ
);

129149 
	`as£π
–
pFªe
==0 );

129150 
	`sqlôe3_‰ì
–
≠Lóf
 );

129154 if–
rc
!=
SQLITE_OK
 ){

129155 
	`sqlôe3Fts3Ex¥Fªe
(
pRoŸ
);

129156 
pRoŸ
 = 0;

129158 *
µ
 = 
pRoŸ
;

129159  
rc
;

129173 
	`·s3Ex¥P¨£UnbÆ™˚d
(

129174 
sqlôe3_tokíizî
 *
pTokíizî
,

129175 
iL™gid
,

129176 **
azCﬁ
,

129177 
bFts4
,

129178 
nCﬁ
,

129179 
iDeÁu…Cﬁ
,

129180 c⁄° *
z
, 
n
,

129181 
Fts3Ex¥
 **
µEx¥


129183 
nP¨£d
;

129184 
rc
;

129185 
P¨£C⁄ãxt
 
sP¨£
;

129187 
	`mem£t
(&
sP¨£
, 0, (
P¨£C⁄ãxt
));

129188 
sP¨£
.
pTokíizî
 =ÖTokenizer;

129189 
sP¨£
.
iL™gid
 = iLangid;

129190 
sP¨£
.
azCﬁ
 = (const **)azCol;

129191 
sP¨£
.
nCﬁ
 =ÇCol;

129192 
sP¨£
.
iDeÁu…Cﬁ
 = iDefaultCol;

129193 
sP¨£
.
bFts4
 = bFts4;

129194 if–
z
==0 ){

129195 *
µEx¥
 = 0;

129196  
SQLITE_OK
;

129198 if–
n
<0 ){

129199 
n
 = ()
	`°æí
(
z
);

129201 
rc
 = 
	`·s3Ex¥P¨£
(&
sP¨£
, 
z
, 
n
, 
µEx¥
, &
nP¨£d
);

129202 
	`as£π
–
rc
==
SQLITE_OK
 || *
µEx¥
==0 );

129205 if–
rc
==
SQLITE_OK
 && 
sP¨£
.
nNe°
 ){

129206 
rc
 = 
SQLITE_ERROR
;

129209  
rc
;

129236 
SQLITE_PRIVATE
 
	`sqlôe3Fts3Ex¥P¨£
(

129237 
sqlôe3_tokíizî
 *
pTokíizî
,

129238 
iL™gid
,

129239 **
azCﬁ
,

129240 
bFts4
,

129241 
nCﬁ
,

129242 
iDeÁu…Cﬁ
,

129243 c⁄° *
z
, 
n
,

129244 
Fts3Ex¥
 **
µEx¥
,

129245 **
pzEº


129247 
rc
 = 
	`·s3Ex¥P¨£UnbÆ™˚d
(

129248 
pTokíizî
, 
iL™gid
, 
azCﬁ
, 
bFts4
, 
nCﬁ
, 
iDeÁu…Cﬁ
, 
z
, 
n
, 
µEx¥


129253 if–
rc
==
SQLITE_OK
 && *
µEx¥
 ){

129254 
rc
 = 
	`·s3Ex¥BÆ™˚
(
µEx¥
, 
SQLITE_FTS3_MAX_EXPR_DEPTH
);

129255 if–
rc
==
SQLITE_OK
 ){

129256 
rc
 = 
	`·s3Ex¥CheckDïth
(*
µEx¥
, 
SQLITE_FTS3_MAX_EXPR_DEPTH
);

129260 if–
rc
!=
SQLITE_OK
 ){

129261 
	`sqlôe3Fts3Ex¥Fªe
(*
µEx¥
);

129262 *
µEx¥
 = 0;

129263 if–
rc
==
SQLITE_TOOBIG
 ){

129264 *
pzEº
 = 
	`sqlôe3_m¥ötf
(

129266 
SQLITE_FTS3_MAX_EXPR_DEPTH


129268 
rc
 = 
SQLITE_ERROR
;

129269 }if–
rc
==
SQLITE_ERROR
 ){

129270 *
pzEº
 = 
	`sqlôe3_m¥ötf
("mÆf‹med MATCHÉx¥essi⁄: [%s]", 
z
);

129274  
rc
;

129280 
	`·s3FªeEx¥Node
(
Fts3Ex¥
 *
p
){

129281 
	`as£π
–
p
->
eTy≥
==
FTSQUERY_PHRASE
 ||Ö->
pPhø£
==0 );

129282 
	`sqlôe3Fts3EvÆPhø£CÀ™up
(
p
->
pPhø£
);

129283 
	`sqlôe3_‰ì
(
p
->
aMI
);

129284 
	`sqlôe3_‰ì
(
p
);

129294 
SQLITE_PRIVATE
 
	`sqlôe3Fts3Ex¥Fªe
(
Fts3Ex¥
 *
pDñ
){

129295 
Fts3Ex¥
 *
p
;

129296 
	`as£π
–
pDñ
==0 ||ÖDñ->
pP¨ít
==0 );

129297 
p
=
pDñ
;Ö && (p->
pLe·
||p->
pRight
);Ö=(p->pLeft ?Ö->pLeft :Ö->pRight)){

129298 
	`as£π
–
p
->
pP¨ít
==0 ||Ö=ı->pP¨ít->
pRight
 ||Ö=ı->pP¨ít->
pLe·
 );

129300  
p
 ){

129301 
Fts3Ex¥
 *
pP¨ít
 = 
p
->pParent;

129302 
	`·s3FªeEx¥Node
(
p
);

129303 if–
pP¨ít
 && 
p
=ıP¨ít->
pLe·
 &&ÖP¨ít->
pRight
 ){

129304 
p
 = 
pP¨ít
->
pRight
;

129305  
p
 && (p->
pLe·
 ||Ö->
pRight
) ){

129306 
	`as£π
–
p
=ı->
pP¨ít
->
pRight
 ||Ö=ı->pP¨ít->
pLe·
 );

129307 
p
 = (p->
pLe·
 ?Ö->pLe· :Ö->
pRight
);

129310 
p
 = 
pP¨ít
;

129320 #ifde‡
SQLITE_TEST


129327 
	`quîyTe°Tokíizî
(

129328 
sqlôe3
 *
db
,

129329 c⁄° *
zName
,

129330 c⁄° 
sqlôe3_tokíizî_moduÀ
 **
µ


129332 
rc
;

129333 
sqlôe3_°mt
 *
pStmt
;

129334 c⁄° 
zSql
[] = "SELECT fts3_tokenizer(?)";

129336 *
µ
 = 0;

129337 
rc
 = 
	`sqlôe3_¥ï¨e_v2
(
db
, 
zSql
, -1, &
pStmt
, 0);

129338 if–
rc
!=
SQLITE_OK
 ){

129339  
rc
;

129342 
	`sqlôe3_böd_ãxt
(
pStmt
, 1, 
zName
, -1, 
SQLITE_STATIC
);

129343 if–
SQLITE_ROW
==
	`sqlôe3_°ï
(
pStmt
) ){

129344 if–
	`sqlôe3_cﬁumn_ty≥
(
pStmt
, 0)==
SQLITE_BLOB
 ){

129345 
	`mem˝y
((*)
µ
, 
	`sqlôe3_cﬁumn_blob
(
pStmt
, 0), (*pp));

129349  
	`sqlôe3_föÆize
(
pStmt
);

129362 *
	`ex¥ToSåög
(
Fts3Ex¥
 *
pEx¥
, *
zBuf
){

129363 if–
pEx¥
==0 ){

129364  
	`sqlôe3_m¥ötf
("");

129366  
pEx¥
->
eTy≥
 ){

129367 
FTSQUERY_PHRASE
: {

129368 
Fts3Phø£
 *
pPhø£
 = 
pEx¥
->pPhrase;

129369 
i
;

129370 
zBuf
 = 
	`sqlôe3_m¥ötf
(

129371 "%zPHRASE %d 0", 
zBuf
, 
pPhø£
->
iCﬁumn
);

129372 
i
=0; 
zBuf
 && i<
pPhø£
->
nTokí
; i++){

129373 
zBuf
 = 
	`sqlôe3_m¥ötf
("%z %.*s%s", zBuf,

129374 
pPhø£
->
aTokí
[
i
].
n
,ÖPhø£->aTokí[i].
z
,

129375 (
pPhø£
->
aTokí
[
i
].
isPªfix
?"+":"")

129378  
zBuf
;

129381 
FTSQUERY_NEAR
:

129382 
zBuf
 = 
	`sqlôe3_m¥ötf
("%zNEAR/%d ", zBuf, 
pEx¥
->
nNór
);

129384 
FTSQUERY_NOT
:

129385 
zBuf
 = 
	`sqlôe3_m¥ötf
("%zNOT ", zBuf);

129387 
FTSQUERY_AND
:

129388 
zBuf
 = 
	`sqlôe3_m¥ötf
("%zAND ", zBuf);

129390 
FTSQUERY_OR
:

129391 
zBuf
 = 
	`sqlôe3_m¥ötf
("%zOR ", zBuf);

129395 if–
zBuf
 ) zBu‡
	`sqlôe3_m¥ötf
("%z{", zBuf);

129396 if–
zBuf
 ) zBu‡
	`ex¥ToSåög
(
pEx¥
->
pLe·
, zBuf);

129397 if–
zBuf
 ) zBu‡
	`sqlôe3_m¥ötf
("%z} {", zBuf);

129399 if–
zBuf
 ) zBu‡
	`ex¥ToSåög
(
pEx¥
->
pRight
, zBuf);

129400 if–
zBuf
 ) zBu‡
	`sqlôe3_m¥ötf
("%z}", zBuf);

129402  
zBuf
;

129419 
	`·s3Ex¥Te°
(

129420 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

129421 
¨gc
,

129422 
sqlôe3_vÆue
 **
¨gv


129424 
sqlôe3_tokíizî_moduÀ
 c⁄° *
pModuÀ
 = 0;

129425 
sqlôe3_tokíizî
 *
pTokíizî
 = 0;

129426 
rc
;

129427 **
azCﬁ
 = 0;

129428 c⁄° *
zEx¥
;

129429 
nEx¥
;

129430 
nCﬁ
;

129431 
ii
;

129432 
Fts3Ex¥
 *
pEx¥
;

129433 *
zBuf
 = 0;

129434 
sqlôe3
 *
db
 = 
	`sqlôe3_c⁄ãxt_db_h™dÀ
(
c⁄ãxt
);

129436 if–
¨gc
<3 ){

129437 
	`sqlôe3_ªsu…_îr‹
(
c⁄ãxt
,

129443 
rc
 = 
	`quîyTe°Tokíizî
(
db
,

129444 (c⁄° *)
	`sqlôe3_vÆue_ãxt
(
¨gv
[0]), &
pModuÀ
);

129445 if–
rc
==
SQLITE_NOMEM
 ){

129446 
	`sqlôe3_ªsu…_îr‹_nomem
(
c⁄ãxt
);

129447 
ex¥ã°_out
;

129448 }if–!
pModuÀ
 ){

129449 
	`sqlôe3_ªsu…_îr‹
(
c⁄ãxt
, "No suchÅokenizer module", -1);

129450 
ex¥ã°_out
;

129453 
rc
 = 
pModuÀ
->
	`xCª©e
(0, 0, &
pTokíizî
);

129454 
	`as£π
–
rc
==
SQLITE_NOMEM
 ||Ñc==
SQLITE_OK
 );

129455 if–
rc
==
SQLITE_NOMEM
 ){

129456 
	`sqlôe3_ªsu…_îr‹_nomem
(
c⁄ãxt
);

129457 
ex¥ã°_out
;

129459 
pTokíizî
->
pModuÀ
 =ÖModule;

129461 
zEx¥
 = (c⁄° *)
	`sqlôe3_vÆue_ãxt
(
¨gv
[1]);

129462 
nEx¥
 = 
	`sqlôe3_vÆue_byãs
(
¨gv
[1]);

129463 
nCﬁ
 = 
¨gc
-2;

129464 
azCﬁ
 = (**)
	`sqlôe3_mÆloc
(
nCﬁ
*(*));

129465 if–!
azCﬁ
 ){

129466 
	`sqlôe3_ªsu…_îr‹_nomem
(
c⁄ãxt
);

129467 
ex¥ã°_out
;

129469 
ii
=0; ii<
nCﬁ
; ii++){

129470 
azCﬁ
[
ii
] = (*)
	`sqlôe3_vÆue_ãxt
(
¨gv
[ii+2]);

129473 if–
	`sqlôe3_u£r_d©a
(
c⁄ãxt
) ){

129474 *
zDummy
 = 0;

129475 
rc
 = 
	`sqlôe3Fts3Ex¥P¨£
(

129476 
pTokíizî
, 0, 
azCﬁ
, 0, 
nCﬁ
,ÇCﬁ, 
zEx¥
, 
nEx¥
, &
pEx¥
, &
zDummy


129478 
	`as£π
–
rc
==
SQLITE_OK
 || 
pEx¥
==0 );

129479 
	`sqlôe3_‰ì
(
zDummy
);

129481 
rc
 = 
	`·s3Ex¥P¨£UnbÆ™˚d
(

129482 
pTokíizî
, 0, 
azCﬁ
, 0, 
nCﬁ
,ÇCﬁ, 
zEx¥
, 
nEx¥
, &
pEx¥


129486 if–
rc
!=
SQLITE_OK
 &&Ñc!=
SQLITE_NOMEM
 ){

129487 
	`sqlôe3Fts3Ex¥Fªe
(
pEx¥
);

129488 
	`sqlôe3_ªsu…_îr‹
(
c⁄ãxt
, "ErrorÖarsingÉxpression", -1);

129489 }if–
rc
==
SQLITE_NOMEM
 || !(
zBuf
 = 
	`ex¥ToSåög
(
pEx¥
, 0)) ){

129490 
	`sqlôe3_ªsu…_îr‹_nomem
(
c⁄ãxt
);

129492 
	`sqlôe3_ªsu…_ãxt
(
c⁄ãxt
, 
zBuf
, -1, 
SQLITE_TRANSIENT
);

129493 
	`sqlôe3_‰ì
(
zBuf
);

129496 
	`sqlôe3Fts3Ex¥Fªe
(
pEx¥
);

129498 
ex¥ã°_out
:

129499 if–
pModuÀ
 && 
pTokíizî
 ){

129500 
rc
 = 
pModuÀ
->
	`xDe°roy
(
pTokíizî
);

129502 
	`sqlôe3_‰ì
(
azCﬁ
);

129509 
SQLITE_PRIVATE
 
	`sqlôe3Fts3Ex¥InôTe°I¡îÁ˚
(
sqlôe3
* 
db
){

129510 
rc
 = 
	`sqlôe3_¸óã_fun˘i⁄
(

129511 
db
, "·s3_ex¥ã°", -1, 
SQLITE_UTF8
, 0, 
·s3Ex¥Te°
, 0, 0

129513 if–
rc
==
SQLITE_OK
 ){

129514 
rc
 = 
	`sqlôe3_¸óã_fun˘i⁄
(
db
, "fts3_exprtest_rebalance",

129515 -1, 
SQLITE_UTF8
, (*)1, 
·s3Ex¥Te°
, 0, 0

129518  
rc
;

129551 #i‡!
	`deföed
(
SQLITE_CORE
Ë|| deföed(
SQLITE_ENABLE_FTS3
)

129561 *
	`·s3HashMÆloc
(
n
){

129562 *
p
 = 
	`sqlôe3_mÆloc
(
n
);

129563 if–
p
 ){

129564 
	`mem£t
(
p
, 0, 
n
);

129566  
p
;

129568 
	`·s3HashFªe
(*
p
){

129569 
	`sqlôe3_‰ì
(
p
);

129582 
SQLITE_PRIVATE
 
	`sqlôe3Fts3HashInô
(
Fts3Hash
 *
pNew
, 
keyCœss
, 
c›yKey
){

129583 
	`as£π
–
pNew
!=0 );

129584 
	`as£π
–
keyCœss
>=
FTS3_HASH_STRING
 && keyCœss<=
FTS3_HASH_BINARY
 );

129585 
pNew
->
keyCœss
 = keyClass;

129586 
pNew
->
c›yKey
 = copyKey;

129587 
pNew
->
fú°
 = 0;

129588 
pNew
->
cou¡
 = 0;

129589 
pNew
->
htsize
 = 0;

129590 
pNew
->
ht
 = 0;

129597 
SQLITE_PRIVATE
 
	`sqlôe3Fts3HashCÀ¨
(
Fts3Hash
 *
pH
){

129598 
Fts3HashEÀm
 *
ñem
;

129600 
	`as£π
–
pH
!=0 );

129601 
ñem
 = 
pH
->
fú°
;

129602 
pH
->
fú°
 = 0;

129603 
	`·s3HashFªe
(
pH
->
ht
);

129604 
pH
->
ht
 = 0;

129605 
pH
->
htsize
 = 0;

129606  
ñem
 ){

129607 
Fts3HashEÀm
 *
√xt_ñem
 = 
ñem
->
√xt
;

129608 if–
pH
->
c›yKey
 && 
ñem
->
pKey
 ){

129609 
	`·s3HashFªe
(
ñem
->
pKey
);

129611 
	`·s3HashFªe
(
ñem
);

129612 
ñem
 = 
√xt_ñem
;

129614 
pH
->
cou¡
 = 0;

129620 
	`·s3SåHash
(c⁄° *
pKey
, 
nKey
){

129621 c⁄° *
z
 = (c⁄° *)
pKey
;

129622 
h
 = 0;

129623 if–
nKey
<=0 )ÇKey = (Ë
	`°æí
(
z
);

129624  
nKey
 > 0 ){

129625 
h
 = (h<<3Ë^ h ^ *
z
++;

129626 
nKey
--;

129628  
h
 & 0x7fffffff;

129630 
	`·s3SåCom∑ª
(c⁄° *
pKey1
, 
n1
, c⁄° *
pKey2
, 
n2
){

129631 if–
n1
!=
n2
 )  1;

129632  
	`°∫cmp
((c⁄° *)
pKey1
,(c⁄° *)
pKey2
,
n1
);

129638 
	`·s3BöHash
(c⁄° *
pKey
, 
nKey
){

129639 
h
 = 0;

129640 c⁄° *
z
 = (c⁄° *)
pKey
;

129641  
nKey
-- > 0 ){

129642 
h
 = (h<<3Ë^ h ^ *(
z
++);

129644  
h
 & 0x7fffffff;

129646 
	`·s3BöCom∑ª
(c⁄° *
pKey1
, 
n1
, c⁄° *
pKey2
, 
n2
){

129647 if–
n1
!=
n2
 )  1;

129648  
	`memcmp
(
pKey1
,
pKey2
,
n1
);

129663 (*
	`·sHashFun˘i⁄
(
keyCœss
))(const *,){

129664 if–
keyCœss
==
FTS3_HASH_STRING
 ){

129665  &
·s3SåHash
;

129667 
	`as£π
–
keyCœss
==
FTS3_HASH_BINARY
 );

129668  &
·s3BöHash
;

129678 (*
	`·sCom∑ªFun˘i⁄
(
keyCœss
))(const *,,const *,){

129679 if–
keyCœss
==
FTS3_HASH_STRING
 ){

129680  &
·s3SåCom∑ª
;

129682 
	`as£π
–
keyCœss
==
FTS3_HASH_BINARY
 );

129683  &
·s3BöCom∑ª
;

129689 
	`·s3HashIn£πEÀmít
(

129690 
Fts3Hash
 *
pH
,

129691 
_·s3ht
 *
pE¡ry
,

129692 
Fts3HashEÀm
 *
pNew


129694 
Fts3HashEÀm
 *
pHód
;

129695 
pHód
 = 
pE¡ry
->
chaö
;

129696 if–
pHód
 ){

129697 
pNew
->
√xt
 = 
pHód
;

129698 
pNew
->
¥ev
 = 
pHód
->prev;

129699 if–
pHód
->
¥ev
 ){ÖHód->¥ev->
√xt
 = 
pNew
; }

129700 { 
pH
->
fú°
 = 
pNew
; }

129701 
pHód
->
¥ev
 = 
pNew
;

129703 
pNew
->
√xt
 = 
pH
->
fú°
;

129704 if–
pH
->
fú°
 ){ÖH->fú°->
¥ev
 = 
pNew
; }

129705 
pNew
->
¥ev
 = 0;

129706 
pH
->
fú°
 = 
pNew
;

129708 
pE¡ry
->
cou¡
++;

129709 
pE¡ry
->
chaö
 = 
pNew
;

129719 
	`·s3Rehash
(
Fts3Hash
 *
pH
, 
√w_size
){

129720 
_·s3ht
 *
√w_ht
;

129721 
Fts3HashEÀm
 *
ñem
, *
√xt_ñem
;

129722 (*
xHash
)(const *,);

129724 
	`as£π
–(
√w_size
 & (new_size-1))==0 );

129725 
√w_ht
 = (
_·s3ht
 *)
	`·s3HashMÆloc
–
√w_size
*(_fts3ht) );

129726 if–
√w_ht
==0 )  1;

129727 
	`·s3HashFªe
(
pH
->
ht
);

129728 
pH
->
ht
 = 
√w_ht
;

129729 
pH
->
htsize
 = 
√w_size
;

129730 
xHash
 = 
	`·sHashFun˘i⁄
(
pH
->
keyCœss
);

129731 
ñem
=
pH
->
fú°
,ÖH->fú°=0;ÉÀm;ÉÀm = 
√xt_ñem
){

129732 
h
 = (*
xHash
)(
ñem
->
pKey
,ÉÀm->
nKey
Ë& (
√w_size
-1);

129733 
√xt_ñem
 = 
ñem
->
√xt
;

129734 
	`·s3HashIn£πEÀmít
(
pH
, &
√w_ht
[
h
], 
ñem
);

129743 
Fts3HashEÀm
 *
	`·s3FödEÀmítByHash
(

129744 c⁄° 
Fts3Hash
 *
pH
,

129745 c⁄° *
pKey
,

129746 
nKey
,

129747 
h


129749 
Fts3HashEÀm
 *
ñem
;

129750 
cou¡
;

129751 (*
xCom∑ª
)(const *,,const *,);

129753 if–
pH
->
ht
 ){

129754 
_·s3ht
 *
pE¡ry
 = &
pH
->
ht
[
h
];

129755 
ñem
 = 
pE¡ry
->
chaö
;

129756 
cou¡
 = 
pE¡ry
->count;

129757 
xCom∑ª
 = 
	`·sCom∑ªFun˘i⁄
(
pH
->
keyCœss
);

129758  
cou¡
-- && 
ñem
 ){

129759 if–(*
xCom∑ª
)(
ñem
->
pKey
,ñem->
nKey
,pKey,nKey)==0 ){

129760  
ñem
;

129762 
ñem
 =ÉÀm->
√xt
;

129771 
	`·s3RemoveEÀmítByHash
(

129772 
Fts3Hash
 *
pH
,

129773 
Fts3HashEÀm
* 
ñem
,

129774 
h


129776 
_·s3ht
 *
pE¡ry
;

129777 if–
ñem
->
¥ev
 ){

129778 
ñem
->
¥ev
->
√xt
 =Élem->next;

129780 
pH
->
fú°
 = 
ñem
->
√xt
;

129782 if–
ñem
->
√xt
 ){

129783 
ñem
->
√xt
->
¥ev
 =Élem->prev;

129785 
pE¡ry
 = &
pH
->
ht
[
h
];

129786 if–
pE¡ry
->
chaö
==
ñem
 ){

129787 
pE¡ry
->
chaö
 = 
ñem
->
√xt
;

129789 
pE¡ry
->
cou¡
--;

129790 if–
pE¡ry
->
cou¡
<=0 ){

129791 
pE¡ry
->
chaö
 = 0;

129793 if–
pH
->
c›yKey
 && 
ñem
->
pKey
 ){

129794 
	`·s3HashFªe
(
ñem
->
pKey
);

129796 
	`·s3HashFªe
–
ñem
 );

129797 
pH
->
cou¡
--;

129798 if–
pH
->
cou¡
<=0 ){

129799 
	`as£π
–
pH
->
fú°
==0 );

129800 
	`as£π
–
pH
->
cou¡
==0 );

129801 
	`·s3HashCÀ¨
(
pH
);

129805 
SQLITE_PRIVATE
 
Fts3HashEÀm
 *
	`sqlôe3Fts3HashFödEÀm
(

129806 c⁄° 
Fts3Hash
 *
pH
,

129807 c⁄° *
pKey
,

129808 
nKey


129810 
h
;

129811 (*
xHash
)(const *,);

129813 if–
pH
==0 ||ÖH->
ht
==0 )  0;

129814 
xHash
 = 
	`·sHashFun˘i⁄
(
pH
->
keyCœss
);

129815 
	`as£π
–
xHash
!=0 );

129816 
h
 = (*
xHash
)(
pKey
,
nKey
);

129817 
	`as£π
–(
pH
->
htsize
 & (pH->htsize-1))==0 );

129818  
	`·s3FödEÀmítByHash
(
pH
,
pKey
,
nKey
, 
h
 & (pH->
htsize
-1));

129826 
SQLITE_PRIVATE
 *
	`sqlôe3Fts3HashFöd
(c⁄° 
Fts3Hash
 *
pH
, c⁄° *
pKey
, 
nKey
){

129827 
Fts3HashEÀm
 *
pEÀm
;

129829 
pEÀm
 = 
	`sqlôe3Fts3HashFödEÀm
(
pH
, 
pKey
, 
nKey
);

129830  
pEÀm
 ?ÖEÀm->
d©a
 : 0;

129848 
SQLITE_PRIVATE
 *
	`sqlôe3Fts3HashIn£π
(

129849 
Fts3Hash
 *
pH
,

129850 c⁄° *
pKey
,

129851 
nKey
,

129852 *
d©a


129854 
høw
;

129855 
h
;

129856 
Fts3HashEÀm
 *
ñem
;

129857 
Fts3HashEÀm
 *
√w_ñem
;

129858 (*
xHash
)(const *,);

129860 
	`as£π
–
pH
!=0 );

129861 
xHash
 = 
	`·sHashFun˘i⁄
(
pH
->
keyCœss
);

129862 
	`as£π
–
xHash
!=0 );

129863 
høw
 = (*
xHash
)(
pKey
, 
nKey
);

129864 
	`as£π
–(
pH
->
htsize
 & (pH->htsize-1))==0 );

129865 
h
 = 
høw
 & (
pH
->
htsize
-1);

129866 
ñem
 = 
	`·s3FödEÀmítByHash
(
pH
,
pKey
,
nKey
,
h
);

129867 if–
ñem
 ){

129868 *
ﬁd_d©a
 = 
ñem
->
d©a
;

129869 if–
d©a
==0 ){

129870 
	`·s3RemoveEÀmítByHash
(
pH
,
ñem
,
h
);

129872 
ñem
->
d©a
 = data;

129874  
ﬁd_d©a
;

129876 if–
d©a
==0 )  0;

129877 if–(
pH
->
htsize
==0 && 
	`·s3Rehash
(pH,8))

129878 || (
pH
->
cou¡
>ıH->
htsize
 && 
	`·s3Rehash
(pH,ÖH->htsize*2))

129880 
pH
->
cou¡
 = 0;

129881  
d©a
;

129883 
	`as£π
–
pH
->
htsize
>0 );

129884 
√w_ñem
 = (
Fts3HashEÀm
*)
	`·s3HashMÆloc
( (Fts3HashElem) );

129885 if–
√w_ñem
==0 )  
d©a
;

129886 if–
pH
->
c›yKey
 && 
pKey
!=0 ){

129887 
√w_ñem
->
pKey
 = 
	`·s3HashMÆloc
–
nKey
 );

129888 if–
√w_ñem
->
pKey
==0 ){

129889 
	`·s3HashFªe
(
√w_ñem
);

129890  
d©a
;

129892 
	`mem˝y
((*)
√w_ñem
->
pKey
,ÖKey, 
nKey
);

129894 
√w_ñem
->
pKey
 = (*)pKey;

129896 
√w_ñem
->
nKey
 =ÇKey;

129897 
pH
->
cou¡
++;

129898 
	`as£π
–
pH
->
htsize
>0 );

129899 
	`as£π
–(
pH
->
htsize
 & (pH->htsize-1))==0 );

129900 
h
 = 
høw
 & (
pH
->
htsize
-1);

129901 
	`·s3HashIn£πEÀmít
(
pH
, &pH->
ht
[
h
], 
√w_ñem
);

129902 
√w_ñem
->
d©a
 = data;

129934 #i‡!
	`deföed
(
SQLITE_CORE
Ë|| deföed(
SQLITE_ENABLE_FTS3
)

129945 
	sp‹ãr_tokíizî
 {

129946 
sqlôe3_tokíizî
 
ba£
;

129947 } 
	tp‹ãr_tokíizî
;

129952 
	sp‹ãr_tokíizî_curs‹
 {

129953 
sqlôe3_tokíizî_curs‹
 
ba£
;

129954 c⁄° *
zI≈ut
;

129955 
nI≈ut
;

129956 
iOff£t
;

129957 
iTokí
;

129958 *
zTokí
;

129959 
nAŒoˇãd
;

129960 } 
	tp‹ãr_tokíizî_curs‹
;

129966 
	`p‹ãrCª©e
(

129967 
¨gc
, c⁄° * c⁄° *
¨gv
,

129968 
sqlôe3_tokíizî
 **
µTokíizî


129970 
p‹ãr_tokíizî
 *
t
;

129972 
	`UNUSED_PARAMETER
(
¨gc
);

129973 
	`UNUSED_PARAMETER
(
¨gv
);

129975 
t
 = (
p‹ãr_tokíizî
 *Ë
	`sqlôe3_mÆloc
((*t));

129976 if–
t
==
NULL
 )  
SQLITE_NOMEM
;

129977 
	`mem£t
(
t
, 0, (*t));

129978 *
µTokíizî
 = &
t
->
ba£
;

129979  
SQLITE_OK
;

129985 
	`p‹ãrDe°roy
(
sqlôe3_tokíizî
 *
pTokíizî
){

129986 
	`sqlôe3_‰ì
(
pTokíizî
);

129987  
SQLITE_OK
;

129996 
	`p‹ãrO≥n
(

129997 
sqlôe3_tokíizî
 *
pTokíizî
,

129998 c⁄° *
zI≈ut
, 
nI≈ut
,

129999 
sqlôe3_tokíizî_curs‹
 **
µCurs‹


130001 
p‹ãr_tokíizî_curs‹
 *
c
;

130003 
	`UNUSED_PARAMETER
(
pTokíizî
);

130005 
c
 = (
p‹ãr_tokíizî_curs‹
 *Ë
	`sqlôe3_mÆloc
((*c));

130006 if–
c
==
NULL
 )  
SQLITE_NOMEM
;

130008 
c
->
zI≈ut
 = zInput;

130009 if–
zI≈ut
==0 ){

130010 
c
->
nI≈ut
 = 0;

130011 }if–
nI≈ut
<0 ){

130012 
c
->
nI≈ut
 = ()
	`°æí
(
zI≈ut
);

130014 
c
->
nI≈ut
 =ÇInput;

130016 
c
->
iOff£t
 = 0;

130017 
c
->
iTokí
 = 0;

130018 
c
->
zTokí
 = 
NULL
;

130019 
c
->
nAŒoˇãd
 = 0;

130021 *
µCurs‹
 = &
c
->
ba£
;

130022  
SQLITE_OK
;

130029 
	`p‹ãrClo£
(
sqlôe3_tokíizî_curs‹
 *
pCurs‹
){

130030 
p‹ãr_tokíizî_curs‹
 *
c
 = (p‹ãr_tokíizî_curs‹ *Ë
pCurs‹
;

130031 
	`sqlôe3_‰ì
(
c
->
zTokí
);

130032 
	`sqlôe3_‰ì
(
c
);

130033  
SQLITE_OK
;

130038 c⁄° 
cTy≥
[] = {

130056 
	`isVowñ
(const *);

130057 
	`isC⁄s⁄™t
(c⁄° *
z
){

130058 
j
;

130059 
x
 = *
z
;

130060 if–
x
==0 )  0;

130061 
	`as£π
–
x
>='a' && x<='z' );

130062 
j
 = 
cTy≥
[
x
-'a'];

130063 if–
j
<2 )  j;

130064  
z
[1]==0 || 
	`isVowñ
(z + 1);

130066 
	`isVowñ
(c⁄° *
z
){

130067 
j
;

130068 
x
 = *
z
;

130069 if–
x
==0 )  0;

130070 
	`as£π
–
x
>='a' && x<='z' );

130071 
j
 = 
cTy≥
[
x
-'a'];

130072 if–
j
<2 )  1-j;

130073  
	`isC⁄s⁄™t
(
z
 + 1);

130095 
	`m_gt_0
(c⁄° *
z
){

130096  
	`isVowñ
(
z
) ){ z++; }

130097 if–*
z
==0 )  0;

130098  
	`isC⁄s⁄™t
(
z
) ){ z++; }

130099  *
z
!=0;

130105 
	`m_eq_1
(c⁄° *
z
){

130106  
	`isVowñ
(
z
) ){ z++; }

130107 if–*
z
==0 )  0;

130108  
	`isC⁄s⁄™t
(
z
) ){ z++; }

130109 if–*
z
==0 )  0;

130110  
	`isVowñ
(
z
) ){ z++; }

130111 if–*
z
==0 )  1;

130112  
	`isC⁄s⁄™t
(
z
) ){ z++; }

130113  *
z
==0;

130119 
	`m_gt_1
(c⁄° *
z
){

130120  
	`isVowñ
(
z
) ){ z++; }

130121 if–*
z
==0 )  0;

130122  
	`isC⁄s⁄™t
(
z
) ){ z++; }

130123 if–*
z
==0 )  0;

130124  
	`isVowñ
(
z
) ){ z++; }

130125 if–*
z
==0 )  0;

130126  
	`isC⁄s⁄™t
(
z
) ){ z++; }

130127  *
z
!=0;

130133 
	`hasVowñ
(c⁄° *
z
){

130134  
	`isC⁄s⁄™t
(
z
) ){ z++; }

130135  *
z
!=0;

130144 
	`doubÀC⁄s⁄™t
(c⁄° *
z
){

130145  
	`isC⁄s⁄™t
(
z
) && z[0]==z[1];

130156 
	`°¨_oh
(c⁄° *
z
){

130158 
	`isC⁄s⁄™t
(
z
) &&

130159 
z
[0]!='w' && z[0]!='x' && z[0]!='y' &&

130160 
	`isVowñ
(
z
+1) &&

130161 
	`isC⁄s⁄™t
(
z
+2);

130176 
	`°em
(

130177 **
pz
,

130178 c⁄° *
zFrom
,

130179 c⁄° *
zTo
,

130180 (*
xC⁄d
)(const *)

130182 *
z
 = *
pz
;

130183  *
zFrom
 && *zFrom==*
z
 ){ z++; zFrom++; }

130184 if–*
zFrom
!=0 )  0;

130185 if–
xC⁄d
 && !
	`xC⁄d
(
z
) )  1;

130186  *
zTo
 ){

130187 *(--
z
Ë*(
zTo
++);

130189 *
pz
 = 
z
;

130201 
	`c›y_°emmî
(c⁄° *
zIn
, 
nIn
, *
zOut
, *
≤Out
){

130202 
i
, 
mx
, 
j
;

130203 
hasDigô
 = 0;

130204 
i
=0; i<
nIn
; i++){

130205 
c
 = 
zIn
[
i
];

130206 if–
c
>='A' && c<='Z' ){

130207 
zOut
[
i
] = 
c
 - 'A' + 'a';

130209 if–
c
>='0' && c<='9' ) 
hasDigô
 = 1;

130210 
zOut
[
i
] = 
c
;

130213 
mx
 = 
hasDigô
 ? 3 : 10;

130214 if–
nIn
>
mx
*2 ){

130215 
j
=
mx
, 
i
=
nIn
-mx; i<nIn; i++, j++){

130216 
zOut
[
j
] = zOut[
i
];

130218 
i
 = 
j
;

130220 
zOut
[
i
] = 0;

130221 *
≤Out
 = 
i
;

130248 
	`p‹ãr_°emmî
(c⁄° *
zIn
, 
nIn
, *
zOut
, *
≤Out
){

130249 
i
, 
j
;

130250 
zRevî£
[28];

130251 *
z
, *
z2
;

130252 if–
nIn
<3 ||ÇIn>=()(
zRevî£
)-7 ){

130255 
	`c›y_°emmî
(
zIn
, 
nIn
, 
zOut
, 
≤Out
);

130258 
i
=0, 
j
=(
zRevî£
)-6; i<
nIn
; i++, j--){

130259 
c
 = 
zIn
[
i
];

130260 if–
c
>='A' && c<='Z' ){

130261 
zRevî£
[
j
] = 
c
 + 'a' - 'A';

130262 }if–
c
>='a' && c<='z' ){

130263 
zRevî£
[
j
] = 
c
;

130267 
	`c›y_°emmî
(
zIn
, 
nIn
, 
zOut
, 
≤Out
);

130271 
	`mem£t
(&
zRevî£
[(zReverse)-5], 0, 5);

130272 
z
 = &
zRevî£
[
j
+1];

130276 if–
z
[0]=='s' ){

130278 !
	`°em
(&
z
, "sess", "ss", 0) &&

130279 !
	`°em
(&
z
, "sei", "i", 0) &&

130280 !
	`°em
(&
z
, "ss", "ss", 0)

130282 
z
++;

130287 
z2
 = 
z
;

130288 if–
	`°em
(&
z
, "dì", "ì", 
m_gt_0
) ){

130291 (
	`°em
(&
z
, "gni", "", 
hasVowñ
) || stem(&z, "de", "", hasVowel))

130292 && 
z
!=
z2


130294 if–
	`°em
(&
z
, "ta", "ate", 0) ||

130295 
	`°em
(&
z
, "lb", "ble", 0) ||

130296 
	`°em
(&
z
, "zi", "ize", 0) ){

130298 }if–
	`doubÀC⁄s⁄™t
(
z
) && (*z!='l' && *z!='s' && *z!='z') ){

130299 
z
++;

130300 }if–
	`m_eq_1
(
z
Ë&& 
	`°¨_oh
(z) ){

130301 *(--
z
) = 'e';

130306 if–
z
[0]=='y' && 
	`hasVowñ
(z+1) ){

130307 
z
[0] = 'i';

130311  
z
[1] ){

130313 
	`°em
(&
z
, "œnoôa", "©e", 
m_gt_0
) ||

130314 
	`°em
(&
z
, "œnoô", "ti⁄", 
m_gt_0
);

130317 
	`°em
(&
z
, "i˙e", "í˚", 
m_gt_0
) ||

130318 
	`°em
(&
z
, "i˙a", "™˚", 
m_gt_0
);

130321 
	`°em
(&
z
, "ªzi", "ize", 
m_gt_0
);

130324 
	`°em
(&
z
, "igﬁ", "log", 
m_gt_0
);

130327 
	`°em
(&
z
, "ûb", "bÀ", 
m_gt_0
) ||

130328 
	`°em
(&
z
, "ûœ", "Æ", 
m_gt_0
) ||

130329 
	`°em
(&
z
, "ûäe", "ít", 
m_gt_0
) ||

130330 
	`°em
(&
z
, "ûe", "e", 
m_gt_0
) ||

130331 
	`°em
(&
z
, "ûsuo", "ous", 
m_gt_0
);

130334 
	`°em
(&
z
, "noôazi", "ize", 
m_gt_0
) ||

130335 
	`°em
(&
z
, "noôa", "©e", 
m_gt_0
) ||

130336 
	`°em
(&
z
, "rŸa", "©e", 
m_gt_0
);

130339 
	`°em
(&
z
, "msûa", "Æ", 
m_gt_0
) ||

130340 
	`°em
(&
z
, "s£√vi", "ive", 
m_gt_0
) ||

130341 
	`°em
(&
z
, "s£∆uf", "ful", 
m_gt_0
) ||

130342 
	`°em
(&
z
, "s£nsuo", "ous", 
m_gt_0
);

130345 
	`°em
(&
z
, "ôûa", "Æ", 
m_gt_0
) ||

130346 
	`°em
(&
z
, "ôivi", "ive", 
m_gt_0
) ||

130347 
	`°em
(&
z
, "ôûib", "bÀ", 
m_gt_0
);

130352  
z
[0] ){

130354 
	`°em
(&
z
, "ëaci", "ic", 
m_gt_0
) ||

130355 
	`°em
(&
z
, "evôa", "", 
m_gt_0
) ||

130356 
	`°em
(&
z
, "ezûa", "Æ", 
m_gt_0
);

130359 
	`°em
(&
z
, "ôici", "ic", 
m_gt_0
);

130362 
	`°em
(&
z
, "œci", "ic", 
m_gt_0
) ||

130363 
	`°em
(&
z
, "luf", "", 
m_gt_0
);

130366 
	`°em
(&
z
, "s£n", "", 
m_gt_0
);

130371  
z
[1] ){

130373 if–
z
[0]=='l' && 
	`m_gt_1
(z+2) ){

130374 
z
 += 2;

130378 if–
z
[0]=='e' && z[2]=='n' && (z[3]=='a' || z[3]=='e'Ë&& 
	`m_gt_1
(z+4) ){

130379 
z
 += 4;

130383 if–
z
[0]=='r' && 
	`m_gt_1
(z+2) ){

130384 
z
 += 2;

130388 if–
z
[0]=='c' && 
	`m_gt_1
(z+2) ){

130389 
z
 += 2;

130393 if–
z
[0]=='e' && z[2]=='b' && (z[3]=='a' || z[3]=='i'Ë&& 
	`m_gt_1
(z+4) ){

130394 
z
 += 4;

130398 if–
z
[0]=='t' ){

130399 if–
z
[2]=='a' ){

130400 if–
	`m_gt_1
(
z
+3) ){

130401 
z
 += 3;

130403 }if–
z
[2]=='e' ){

130404 
	`°em
(&
z
, "äeme", "", 
m_gt_1
) ||

130405 
	`°em
(&
z
, "äem", "", 
m_gt_1
) ||

130406 
	`°em
(&
z
, "äe", "", 
m_gt_1
);

130411 if–
z
[0]=='u' ){

130412 if–
	`m_gt_1
(
z
+2) ){

130413 
z
 += 2;

130415 }if–
z
[3]=='s' || z[3]=='t' ){

130416 
	`°em
(&
z
, "noi", "", 
m_gt_1
);

130420 if–
z
[0]=='m' && z[2]=='i' && 
	`m_gt_1
(z+3) ){

130421 
z
 += 3;

130425 
	`°em
(&
z
, "ëa", "", 
m_gt_1
) ||

130426 
	`°em
(&
z
, "ôi", "", 
m_gt_1
);

130429 if–
z
[0]=='s' && z[2]=='o' && 
	`m_gt_1
(z+3) ){

130430 
z
 += 3;

130435 if–
z
[0]=='e' && z[2]=='i' && 
	`m_gt_1
(z+3) ){

130436 
z
 += 3;

130442 if–
z
[0]=='e' ){

130443 if–
	`m_gt_1
(
z
+1) ){

130444 
z
++;

130445 }if–
	`m_eq_1
(
z
+1Ë&& !
	`°¨_oh
(z+1) ){

130446 
z
++;

130451 if–
	`m_gt_1
(
z
) && z[0]=='l' && z[1]=='l' ){

130452 
z
++;

130458 *
≤Out
 = 
i
 = ()
	`°æí
(
z
);

130459 
zOut
[
i
] = 0;

130460  *
z
 ){

130461 
zOut
[--
i
] = *(
z
++);

130471 c⁄° 
p‹ãrIdCh¨
[] = {

130479 
	#isDñim
(
C
Ë(((
ch
=C)&0x80)==0 && (ch<0x30 || !
p‹ãrIdCh¨
[ch-0x30]))

	)

130485 
	`p‹ãrNext
(

130486 
sqlôe3_tokíizî_curs‹
 *
pCurs‹
,

130487 c⁄° **
pzTokí
,

130488 *
≤Byãs
,

130489 *
piSèπOff£t
,

130490 *
piEndOff£t
,

130491 *
piPosôi⁄


130493 
p‹ãr_tokíizî_curs‹
 *
c
 = (p‹ãr_tokíizî_curs‹ *Ë
pCurs‹
;

130494 c⁄° *
z
 = 
c
->
zI≈ut
;

130496  
c
->
iOff£t
<c->
nI≈ut
 ){

130497 
iSèπOff£t
, 
ch
;

130500  
c
->
iOff£t
<c->
nI≈ut
 && 
	`isDñim
(
z
[c->iOffset]) ){

130501 
c
->
iOff£t
++;

130505 
iSèπOff£t
 = 
c
->
iOff£t
;

130506  
c
->
iOff£t
<c->
nI≈ut
 && !
	`isDñim
(
z
[c->iOffset]) ){

130507 
c
->
iOff£t
++;

130510 if–
c
->
iOff£t
>
iSèπOff£t
 ){

130511 
n
 = 
c
->
iOff£t
-
iSèπOff£t
;

130512 if–
n
>
c
->
nAŒoˇãd
 ){

130513 *
pNew
;

130514 
c
->
nAŒoˇãd
 = 
n
+20;

130515 
pNew
 = 
	`sqlôe3_ªÆloc
(
c
->
zTokí
, c->
nAŒoˇãd
);

130516 if–!
pNew
 )  
SQLITE_NOMEM
;

130517 
c
->
zTokí
 = 
pNew
;

130519 
	`p‹ãr_°emmî
(&
z
[
iSèπOff£t
], 
n
, 
c
->
zTokí
, 
≤Byãs
);

130520 *
pzTokí
 = 
c
->
zTokí
;

130521 *
piSèπOff£t
 = 
iSèπOff£t
;

130522 *
piEndOff£t
 = 
c
->
iOff£t
;

130523 *
piPosôi⁄
 = 
c
->
iTokí
++;

130524  
SQLITE_OK
;

130527  
SQLITE_DONE
;

130533 c⁄° 
sqlôe3_tokíizî_moduÀ
 
p‹ãrTokíizîModuÀ
 = {

130535 
p‹ãrCª©e
,

130536 
p‹ãrDe°roy
,

130537 
p‹ãrO≥n
,

130538 
p‹ãrClo£
,

130539 
p‹ãrNext
,

130547 
SQLITE_PRIVATE
 
	`sqlôe3Fts3P‹ãrTokíizîModuÀ
(

130548 
sqlôe3_tokíizî_moduÀ
 c⁄°**
µModuÀ


130550 *
µModuÀ
 = &
p‹ãrTokíizîModuÀ
;

130582 #i‡!
	`deföed
(
SQLITE_CORE
Ë|| deföed(
SQLITE_ENABLE_FTS3
)

130607 
	`sˇœrFunc
(

130608 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

130609 
¨gc
,

130610 
sqlôe3_vÆue
 **
¨gv


130612 
Fts3Hash
 *
pHash
;

130613 *
pPå
 = 0;

130614 c⁄° *
zName
;

130615 
nName
;

130617 
	`as£π
–
¨gc
==1 ||árgc==2 );

130619 
pHash
 = (
Fts3Hash
 *)
	`sqlôe3_u£r_d©a
(
c⁄ãxt
);

130621 
zName
 = 
	`sqlôe3_vÆue_ãxt
(
¨gv
[0]);

130622 
nName
 = 
	`sqlôe3_vÆue_byãs
(
¨gv
[0])+1;

130624 if–
¨gc
==2 ){

130625 *
pOld
;

130626 
n
 = 
	`sqlôe3_vÆue_byãs
(
¨gv
[1]);

130627 if–
n
!=(
pPå
) ){

130628 
	`sqlôe3_ªsu…_îr‹
(
c⁄ãxt
, "argumentÅype mismatch", -1);

130631 
pPå
 = *(**)
	`sqlôe3_vÆue_blob
(
¨gv
[1]);

130632 
pOld
 = 
	`sqlôe3Fts3HashIn£π
(
pHash
, (*)
zName
, 
nName
, 
pPå
);

130633 if–
pOld
==
pPå
 ){

130634 
	`sqlôe3_ªsu…_îr‹
(
c⁄ãxt
, "out of memory", -1);

130638 
pPå
 = 
	`sqlôe3Fts3HashFöd
(
pHash
, 
zName
, 
nName
);

130639 if–!
pPå
 ){

130640 *
zEº
 = 
	`sqlôe3_m¥ötf
("unknow¿tokíizî: %s", 
zName
);

130641 
	`sqlôe3_ªsu…_îr‹
(
c⁄ãxt
, 
zEº
, -1);

130642 
	`sqlôe3_‰ì
(
zEº
);

130647 
	`sqlôe3_ªsu…_blob
(
c⁄ãxt
, (*)&
pPå
, ’På), 
SQLITE_TRANSIENT
);

130650 
SQLITE_PRIVATE
 
	`sqlôe3Fts3IsIdCh¨
(
c
){

130651 c⁄° 
isFtsIdCh¨
[] = {

130661  (
c
&0x80 || 
isFtsIdCh¨
[()(c)]);

130664 
SQLITE_PRIVATE
 c⁄° *
	`sqlôe3Fts3NextTokí
(c⁄° *
zSå
, *
≤
){

130665 c⁄° *
z1
;

130666 c⁄° *
z2
 = 0;

130669 
z1
 = 
zSå
;

130670  
z2
==0 ){

130671 
c
 = *
z1
;

130672  
c
 ){

130677 
z2
 = 
z1
;

130678  *++
z2
 && (*z2!=
c
 || *++z2==c) );

130682 
z2
 = &
z1
[1];

130683  *
z2
 && z2[0]!=']' ) z2++;

130684 if–*
z2
 ) z2++;

130688 if–
	`sqlôe3Fts3IsIdCh¨
(*
z1
) ){

130689 
z2
 = &
z1
[1];

130690  
	`sqlôe3Fts3IsIdCh¨
(*
z2
) ) z2++;

130692 
z1
++;

130697 *
≤
 = ()(
z2
-
z1
);

130698  
z1
;

130701 
SQLITE_PRIVATE
 
	`sqlôe3Fts3InôTokíizî
(

130702 
Fts3Hash
 *
pHash
,

130703 c⁄° *
zArg
,

130704 
sqlôe3_tokíizî
 **
µTok
,

130705 **
pzEº


130707 
rc
;

130708 *
z
 = (*)
zArg
;

130709 
n
 = 0;

130710 *
zC›y
;

130711 *
zEnd
;

130712 
sqlôe3_tokíizî_moduÀ
 *
m
;

130714 
zC›y
 = 
	`sqlôe3_m¥ötf
("%s", 
zArg
);

130715 if–!
zC›y
 )  
SQLITE_NOMEM
;

130716 
zEnd
 = &
zC›y
[
	`°æí
(zCopy)];

130718 
z
 = (*)
	`sqlôe3Fts3NextTokí
(
zC›y
, &
n
);

130719 
z
[
n
] = '\0';

130720 
	`sqlôe3Fts3DequŸe
(
z
);

130722 
m
 = (
sqlôe3_tokíizî_moduÀ
 *)
	`sqlôe3Fts3HashFöd
(
pHash
,
z
,()
	`°æí
(z)+1);

130723 if–!
m
 ){

130724 *
pzEº
 = 
	`sqlôe3_m¥ötf
("unknow¿tokíizî: %s", 
z
);

130725 
rc
 = 
SQLITE_ERROR
;

130727 c⁄° **
aArg
 = 0;

130728 
iArg
 = 0;

130729 
z
 = &z[
n
+1];

130730  
z
<
zEnd
 && (
NULL
!=(z = (*)
	`sqlôe3Fts3NextTokí
(z, &
n
))) ){

130731 
nNew
 = (*)*(
iArg
+1);

130732 c⁄° **
aNew
 = (c⁄° **)
	`sqlôe3_ªÆloc
((*)
aArg
, 
nNew
);

130733 if–!
aNew
 ){

130734 
	`sqlôe3_‰ì
(
zC›y
);

130735 
	`sqlôe3_‰ì
((*)
aArg
);

130736  
SQLITE_NOMEM
;

130738 
aArg
 = 
aNew
;

130739 
aArg
[
iArg
++] = 
z
;

130740 
z
[
n
] = '\0';

130741 
	`sqlôe3Fts3DequŸe
(
z
);

130742 
z
 = &z[
n
+1];

130744 
rc
 = 
m
->
	`xCª©e
(
iArg
, 
aArg
, 
µTok
);

130745 
	`as£π
–
rc
!=
SQLITE_OK
 || *
µTok
 );

130746 if–
rc
!=
SQLITE_OK
 ){

130747 *
pzEº
 = 
	`sqlôe3_m¥ötf
("unknownÅokenizer");

130749 (*
µTok
)->
pModuÀ
 = 
m
;

130751 
	`sqlôe3_‰ì
((*)
aArg
);

130754 
	`sqlôe3_‰ì
(
zC›y
);

130755  
rc
;

130759 #ifde‡
SQLITE_TEST


130761 
	~<t˛.h
>

130789 
	`ã°Func
(

130790 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

130791 
¨gc
,

130792 
sqlôe3_vÆue
 **
¨gv


130794 
Fts3Hash
 *
pHash
;

130795 
sqlôe3_tokíizî_moduÀ
 *
p
;

130796 
sqlôe3_tokíizî
 *
pTokíizî
 = 0;

130797 
sqlôe3_tokíizî_curs‹
 *
pC§
 = 0;

130799 c⁄° *
zEº
 = 0;

130801 c⁄° *
zName
;

130802 
nName
;

130803 c⁄° *
zI≈ut
;

130804 
nI≈ut
;

130806 c⁄° *
azArg
[64];

130808 c⁄° *
zTokí
;

130809 
nTokí
 = 0;

130810 
iSèπ
 = 0;

130811 
iEnd
 = 0;

130812 
iPos
 = 0;

130813 
i
;

130815 
T˛_Obj
 *
pRë
;

130817 if–
¨gc
<2 ){

130818 
	`sqlôe3_ªsu…_îr‹
(
c⁄ãxt
, "insufficientárguments", -1);

130822 
nName
 = 
	`sqlôe3_vÆue_byãs
(
¨gv
[0]);

130823 
zName
 = (c⁄° *)
	`sqlôe3_vÆue_ãxt
(
¨gv
[0]);

130824 
nI≈ut
 = 
	`sqlôe3_vÆue_byãs
(
¨gv
[
¨gc
-1]);

130825 
zI≈ut
 = (c⁄° *)
	`sqlôe3_vÆue_ãxt
(
¨gv
[
¨gc
-1]);

130827 
pHash
 = (
Fts3Hash
 *)
	`sqlôe3_u£r_d©a
(
c⁄ãxt
);

130828 
p
 = (
sqlôe3_tokíizî_moduÀ
 *)
	`sqlôe3Fts3HashFöd
(
pHash
, 
zName
, 
nName
+1);

130830 if–!
p
 ){

130831 *
zEº
 = 
	`sqlôe3_m¥ötf
("unknow¿tokíizî: %s", 
zName
);

130832 
	`sqlôe3_ªsu…_îr‹
(
c⁄ãxt
, 
zEº
, -1);

130833 
	`sqlôe3_‰ì
(
zEº
);

130837 
pRë
 = 
	`T˛_NewObj
();

130838 
	`T˛_In¸RefCou¡
(
pRë
);

130840 
i
=1; i<
¨gc
-1; i++){

130841 
azArg
[
i
-1] = (c⁄° *)
	`sqlôe3_vÆue_ãxt
(
¨gv
[i]);

130844 if–
SQLITE_OK
!=
p
->
	`xCª©e
(
¨gc
-2, 
azArg
, &
pTokíizî
) ){

130845 
zEº
 = "error in xCreate()";

130846 
föish
;

130848 
pTokíizî
->
pModuÀ
 = 
p
;

130849 if–
	`sqlôe3Fts3O≥nTokíizî
(
pTokíizî
, 0, 
zI≈ut
, 
nI≈ut
, &
pC§
) ){

130850 
zEº
 = "error in xOpen()";

130851 
föish
;

130854  
SQLITE_OK
==
p
->
	`xNext
(
pC§
, &
zTokí
, &
nTokí
, &
iSèπ
, &
iEnd
, &
iPos
) ){

130855 
	`T˛_Li°ObjAµídEÀmít
(0, 
pRë
, 
	`T˛_NewI¡Obj
(
iPos
));

130856 
	`T˛_Li°ObjAµídEÀmít
(0, 
pRë
, 
	`T˛_NewSåögObj
(
zTokí
, 
nTokí
));

130857 
zTokí
 = &
zI≈ut
[
iSèπ
];

130858 
nTokí
 = 
iEnd
-
iSèπ
;

130859 
	`T˛_Li°ObjAµídEÀmít
(0, 
pRë
, 
	`T˛_NewSåögObj
(
zTokí
, 
nTokí
));

130862 if–
SQLITE_OK
!=
p
->
	`xClo£
(
pC§
) ){

130863 
zEº
 = "error in xClose()";

130864 
föish
;

130866 if–
SQLITE_OK
!=
p
->
	`xDe°roy
(
pTokíizî
) ){

130867 
zEº
 = "error in xDestroy()";

130868 
föish
;

130871 
föish
:

130872 if–
zEº
 ){

130873 
	`sqlôe3_ªsu…_îr‹
(
c⁄ãxt
, 
zEº
, -1);

130875 
	`sqlôe3_ªsu…_ãxt
(
c⁄ãxt
, 
	`T˛_GëSåög
(
pRë
), -1, 
SQLITE_TRANSIENT
);

130877 
	`T˛_De¸RefCou¡
(
pRë
);

130881 
	`ªgi°îTokíizî
(

130882 
sqlôe3
 *
db
,

130883 *
zName
,

130884 c⁄° 
sqlôe3_tokíizî_moduÀ
 *
p


130886 
rc
;

130887 
sqlôe3_°mt
 *
pStmt
;

130888 c⁄° 
zSql
[] = "SELECT fts3_tokenizer(?, ?)";

130890 
rc
 = 
	`sqlôe3_¥ï¨e_v2
(
db
, 
zSql
, -1, &
pStmt
, 0);

130891 if–
rc
!=
SQLITE_OK
 ){

130892  
rc
;

130895 
	`sqlôe3_böd_ãxt
(
pStmt
, 1, 
zName
, -1, 
SQLITE_STATIC
);

130896 
	`sqlôe3_böd_blob
(
pStmt
, 2, &
p
, ’), 
SQLITE_STATIC
);

130897 
	`sqlôe3_°ï
(
pStmt
);

130899  
	`sqlôe3_föÆize
(
pStmt
);

130903 
	`quîyTokíizî
(

130904 
sqlôe3
 *
db
,

130905 *
zName
,

130906 c⁄° 
sqlôe3_tokíizî_moduÀ
 **
µ


130908 
rc
;

130909 
sqlôe3_°mt
 *
pStmt
;

130910 c⁄° 
zSql
[] = "SELECT fts3_tokenizer(?)";

130912 *
µ
 = 0;

130913 
rc
 = 
	`sqlôe3_¥ï¨e_v2
(
db
, 
zSql
, -1, &
pStmt
, 0);

130914 if–
rc
!=
SQLITE_OK
 ){

130915  
rc
;

130918 
	`sqlôe3_böd_ãxt
(
pStmt
, 1, 
zName
, -1, 
SQLITE_STATIC
);

130919 if–
SQLITE_ROW
==
	`sqlôe3_°ï
(
pStmt
) ){

130920 if–
	`sqlôe3_cﬁumn_ty≥
(
pStmt
, 0)==
SQLITE_BLOB
 ){

130921 
	`mem˝y
((*)
µ
, 
	`sqlôe3_cﬁumn_blob
(
pStmt
, 0), (*pp));

130925  
	`sqlôe3_föÆize
(
pStmt
);

130928 
SQLITE_PRIVATE
 
	`sqlôe3Fts3Sim∂eTokíizîModuÀ
(
sqlôe3_tokíizî_moduÀ
 c⁄°**
µModuÀ
);

130948 
	`ötTe°Func
(

130949 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

130950 
¨gc
,

130951 
sqlôe3_vÆue
 **
¨gv


130953 
rc
;

130954 c⁄° 
sqlôe3_tokíizî_moduÀ
 *
p1
;

130955 c⁄° 
sqlôe3_tokíizî_moduÀ
 *
p2
;

130956 
sqlôe3
 *
db
 = (sqlôe3 *)
	`sqlôe3_u£r_d©a
(
c⁄ãxt
);

130958 
	`UNUSED_PARAMETER
(
¨gc
);

130959 
	`UNUSED_PARAMETER
(
¨gv
);

130962 
	`sqlôe3Fts3Sim∂eTokíizîModuÀ
(&
p1
);

130963 
rc
 = 
	`quîyTokíizî
(
db
, "sim∂e", &
p2
);

130964 
	`as£π
–
rc
==
SQLITE_OK
 );

130965 
	`as£π
–
p1
==
p2
 );

130966 
rc
 = 
	`quîyTokíizî
(
db
, "nosuchtokíizî", &
p2
);

130967 
	`as£π
–
rc
==
SQLITE_ERROR
 );

130968 
	`as£π
–
p2
==0 );

130969 
	`as£π
–0==
	`°rcmp
(
	`sqlôe3_îrmsg
(
db
), "unknownÅokenizer:Çosuchtokenizer") );

130972 
rc
 = 
	`ªgi°îTokíizî
(
db
, "nosuchtokíizî", 
p1
);

130973 
	`as£π
–
rc
==
SQLITE_OK
 );

130974 
rc
 = 
	`quîyTokíizî
(
db
, "nosuchtokíizî", &
p2
);

130975 
	`as£π
–
rc
==
SQLITE_OK
 );

130976 
	`as£π
–
p2
==
p1
 );

130978 
	`sqlôe3_ªsu…_ãxt
(
c⁄ãxt
, "ok", -1, 
SQLITE_STATIC
);

131000 
SQLITE_PRIVATE
 
	`sqlôe3Fts3InôHashTabÀ
(

131001 
sqlôe3
 *
db
,

131002 
Fts3Hash
 *
pHash
,

131003 c⁄° *
zName


131005 
rc
 = 
SQLITE_OK
;

131006 *
p
 = (*)
pHash
;

131007 c⁄° 
™y
 = 
SQLITE_ANY
;

131009 #ifde‡
SQLITE_TEST


131010 *
zTe°
 = 0;

131011 *
zTe°2
 = 0;

131012 *
pdb
 = (*)
db
;

131013 
zTe°
 = 
	`sqlôe3_m¥ötf
("%s_ã°", 
zName
);

131014 
zTe°2
 = 
	`sqlôe3_m¥ötf
("%s_öã∫Æ_ã°", 
zName
);

131015 if–!
zTe°
 || !
zTe°2
 ){

131016 
rc
 = 
SQLITE_NOMEM
;

131020 if–
SQLITE_OK
==
rc
 ){

131021 
rc
 = 
	`sqlôe3_¸óã_fun˘i⁄
(
db
, 
zName
, 1, 
™y
, 
p
, 
sˇœrFunc
, 0, 0);

131023 if–
SQLITE_OK
==
rc
 ){

131024 
rc
 = 
	`sqlôe3_¸óã_fun˘i⁄
(
db
, 
zName
, 2, 
™y
, 
p
, 
sˇœrFunc
, 0, 0);

131026 #ifde‡
SQLITE_TEST


131027 if–
SQLITE_OK
==
rc
 ){

131028 
rc
 = 
	`sqlôe3_¸óã_fun˘i⁄
(
db
, 
zTe°
, -1, 
™y
, 
p
, 
ã°Func
, 0, 0);

131030 if–
SQLITE_OK
==
rc
 ){

131031 
rc
 = 
	`sqlôe3_¸óã_fun˘i⁄
(
db
, 
zTe°2
, 0, 
™y
, 
pdb
, 
ötTe°Func
, 0, 0);

131035 #ifde‡
SQLITE_TEST


131036 
	`sqlôe3_‰ì
(
zTe°
);

131037 
	`sqlôe3_‰ì
(
zTe°2
);

131040  
rc
;

131071 #i‡!
	`deföed
(
SQLITE_CORE
Ë|| deföed(
SQLITE_ENABLE_FTS3
)

131079 
	ssim∂e_tokíizî
 {

131080 
sqlôe3_tokíizî
 
ba£
;

131081 
dñim
[128];

131082 } 
	tsim∂e_tokíizî
;

131084 
	ssim∂e_tokíizî_curs‹
 {

131085 
sqlôe3_tokíizî_curs‹
 
ba£
;

131086 c⁄° *
pI≈ut
;

131087 
nByãs
;

131088 
iOff£t
;

131089 
iTokí
;

131090 *
pTokí
;

131091 
nTokíAŒoˇãd
;

131092 } 
	tsim∂e_tokíizî_curs‹
;

131095 
	`sim∂eDñim
(
sim∂e_tokíizî
 *
t
, 
c
){

131096  
c
<0x80 && 
t
->
dñim
[c];

131098 
	`·s3_iß um
(
x
){

131099  (
x
>='0' && x<='9') || (x>='A' && x<='Z') || (x>='a' && x<='z');

131105 
	`sim∂eCª©e
(

131106 
¨gc
, c⁄° * c⁄° *
¨gv
,

131107 
sqlôe3_tokíizî
 **
µTokíizî


131109 
sim∂e_tokíizî
 *
t
;

131111 
t
 = (
sim∂e_tokíizî
 *Ë
	`sqlôe3_mÆloc
((*t));

131112 if–
t
==
NULL
 )  
SQLITE_NOMEM
;

131113 
	`mem£t
(
t
, 0, (*t));

131120 if–
¨gc
>1 ){

131121 
i
, 
n
 = ()
	`°æí
(
¨gv
[1]);

131122 
i
=0; i<
n
; i++){

131123 
ch
 = 
¨gv
[1][
i
];

131125 if–
ch
>=0x80 ){

131126 
	`sqlôe3_‰ì
(
t
);

131127  
SQLITE_ERROR
;

131129 
t
->
dñim
[
ch
] = 1;

131133 
i
;

131134 
i
=1; i<0x80; i++){

131135 
t
->
dñim
[
i
] = !
	`·s3_iß um
(i) ? -1 : 0;

131139 *
µTokíizî
 = &
t
->
ba£
;

131140  
SQLITE_OK
;

131146 
	`sim∂eDe°roy
(
sqlôe3_tokíizî
 *
pTokíizî
){

131147 
	`sqlôe3_‰ì
(
pTokíizî
);

131148  
SQLITE_OK
;

131157 
	`sim∂eO≥n
(

131158 
sqlôe3_tokíizî
 *
pTokíizî
,

131159 c⁄° *
pI≈ut
, 
nByãs
,

131160 
sqlôe3_tokíizî_curs‹
 **
µCurs‹


131162 
sim∂e_tokíizî_curs‹
 *
c
;

131164 
	`UNUSED_PARAMETER
(
pTokíizî
);

131166 
c
 = (
sim∂e_tokíizî_curs‹
 *Ë
	`sqlôe3_mÆloc
((*c));

131167 if–
c
==
NULL
 )  
SQLITE_NOMEM
;

131169 
c
->
pI≈ut
 =ÖInput;

131170 if–
pI≈ut
==0 ){

131171 
c
->
nByãs
 = 0;

131172 }if–
nByãs
<0 ){

131173 
c
->
nByãs
 = ()
	`°æí
(
pI≈ut
);

131175 
c
->
nByãs
 =ÇBytes;

131177 
c
->
iOff£t
 = 0;

131178 
c
->
iTokí
 = 0;

131179 
c
->
pTokí
 = 
NULL
;

131180 
c
->
nTokíAŒoˇãd
 = 0;

131182 *
µCurs‹
 = &
c
->
ba£
;

131183  
SQLITE_OK
;

131190 
	`sim∂eClo£
(
sqlôe3_tokíizî_curs‹
 *
pCurs‹
){

131191 
sim∂e_tokíizî_curs‹
 *
c
 = (sim∂e_tokíizî_curs‹ *Ë
pCurs‹
;

131192 
	`sqlôe3_‰ì
(
c
->
pTokí
);

131193 
	`sqlôe3_‰ì
(
c
);

131194  
SQLITE_OK
;

131201 
	`sim∂eNext
(

131202 
sqlôe3_tokíizî_curs‹
 *
pCurs‹
,

131203 c⁄° **
µTokí
,

131204 *
≤Byãs
,

131205 *
piSèπOff£t
,

131206 *
piEndOff£t
,

131207 *
piPosôi⁄


131209 
sim∂e_tokíizî_curs‹
 *
c
 = (sim∂e_tokíizî_curs‹ *Ë
pCurs‹
;

131210 
sim∂e_tokíizî
 *
t
 = (sim∂e_tokíizî *Ë
pCurs‹
->
pTokíizî
;

131211 *
p
 = (*)
c
->
pI≈ut
;

131213  
c
->
iOff£t
<c->
nByãs
 ){

131214 
iSèπOff£t
;

131217  
c
->
iOff£t
<c->
nByãs
 && 
	`sim∂eDñim
(
t
, 
p
[c->iOffset]) ){

131218 
c
->
iOff£t
++;

131222 
iSèπOff£t
 = 
c
->
iOff£t
;

131223  
c
->
iOff£t
<c->
nByãs
 && !
	`sim∂eDñim
(
t
, 
p
[c->iOffset]) ){

131224 
c
->
iOff£t
++;

131227 if–
c
->
iOff£t
>
iSèπOff£t
 ){

131228 
i
, 
n
 = 
c
->
iOff£t
-
iSèπOff£t
;

131229 if–
n
>
c
->
nTokíAŒoˇãd
 ){

131230 *
pNew
;

131231 
c
->
nTokíAŒoˇãd
 = 
n
+20;

131232 
pNew
 = 
	`sqlôe3_ªÆloc
(
c
->
pTokí
, c->
nTokíAŒoˇãd
);

131233 if–!
pNew
 )  
SQLITE_NOMEM
;

131234 
c
->
pTokí
 = 
pNew
;

131236 
i
=0; i<
n
; i++){

131240 
ch
 = 
p
[
iSèπOff£t
+
i
];

131241 
c
->
pTokí
[
i
] = ()((
ch
>='A' && ch<='Z') ? ch-'A'+'a' : ch);

131243 *
µTokí
 = 
c
->
pTokí
;

131244 *
≤Byãs
 = 
n
;

131245 *
piSèπOff£t
 = 
iSèπOff£t
;

131246 *
piEndOff£t
 = 
c
->
iOff£t
;

131247 *
piPosôi⁄
 = 
c
->
iTokí
++;

131249  
SQLITE_OK
;

131252  
SQLITE_DONE
;

131258 c⁄° 
sqlôe3_tokíizî_moduÀ
 
sim∂eTokíizîModuÀ
 = {

131260 
sim∂eCª©e
,

131261 
sim∂eDe°roy
,

131262 
sim∂eO≥n
,

131263 
sim∂eClo£
,

131264 
sim∂eNext
,

131272 
SQLITE_PRIVATE
 
	`sqlôe3Fts3Sim∂eTokíizîModuÀ
(

131273 
sqlôe3_tokíizî_moduÀ
 c⁄°**
µModuÀ


131275 *
µModuÀ
 = &
sim∂eTokíizîModuÀ
;

131322 #i‡!
	`deföed
(
SQLITE_CORE
Ë|| deföed(
SQLITE_ENABLE_FTS3
)

131327 
Fts3tokTabÀ
 
	tFts3tokTabÀ
;

131328 
Fts3tokCurs‹
 
	tFts3tokCurs‹
;

131333 
	sFts3tokTabÀ
 {

131334 
sqlôe3_vèb
 
ba£
;

131335 c⁄° 
sqlôe3_tokíizî_moduÀ
 *
pMod
;

131336 
sqlôe3_tokíizî
 *
pTok
;

131342 
	sFts3tokCurs‹
 {

131343 
sqlôe3_vèb_curs‹
 
ba£
;

131344 *
zI≈ut
;

131345 
sqlôe3_tokíizî_curs‹
 *
pC§
;

131346 
iRowid
;

131347 c⁄° *
zTokí
;

131348 
nTokí
;

131349 
iSèπ
;

131350 
iEnd
;

131351 
iPos
;

131357 
	`·s3tokQuîyTokíizî
(

131358 
Fts3Hash
 *
pHash
,

131359 c⁄° *
zName
,

131360 c⁄° 
sqlôe3_tokíizî_moduÀ
 **
µ
,

131361 **
pzEº


131363 
sqlôe3_tokíizî_moduÀ
 *
p
;

131364 
nName
 = ()
	`°æí
(
zName
);

131366 
p
 = (
sqlôe3_tokíizî_moduÀ
 *)
	`sqlôe3Fts3HashFöd
(
pHash
, 
zName
, 
nName
+1);

131367 if–!
p
 ){

131368 *
pzEº
 = 
	`sqlôe3_m¥ötf
("unknow¿tokíizî: %s", 
zName
);

131369  
SQLITE_ERROR
;

131372 *
µ
 = 
p
;

131373  
SQLITE_OK
;

131388 
	`·s3tokDequŸeAºay
(

131389 
¨gc
,

131390 c⁄° * c⁄° *
¨gv
,

131391 ***
∑zDequŸe


131393 
rc
 = 
SQLITE_OK
;

131394 if–
¨gc
==0 ){

131395 *
∑zDequŸe
 = 0;

131397 
i
;

131398 
nByã
 = 0;

131399 **
azDequŸe
;

131401 
i
=0; i<
¨gc
; i++){

131402 
nByã
 +()(
	`°æí
(
¨gv
[
i
]) + 1);

131405 *
∑zDequŸe
 = 
azDequŸe
 = 
	`sqlôe3_mÆloc
((*)*
¨gc
 + 
nByã
);

131406 if–
azDequŸe
==0 ){

131407 
rc
 = 
SQLITE_NOMEM
;

131409 *
pS∑˚
 = (*)&
azDequŸe
[
¨gc
];

131410 
i
=0; i<
¨gc
; i++){

131411 
n
 = ()
	`°æí
(
¨gv
[
i
]);

131412 
azDequŸe
[
i
] = 
pS∑˚
;

131413 
	`mem˝y
(
pS∑˚
, 
¨gv
[
i
], 
n
+1);

131414 
	`sqlôe3Fts3DequŸe
(
pS∑˚
);

131415 
pS∑˚
 +(
n
+1);

131420  
rc
;

131426 
	#FTS3_TOK_SCHEMA
 "CREATE TABLE x(öput,Åokí, sèπ,Énd,Öosôi⁄)"

	)

131438 
	`·s3tokC⁄√˘Mëhod
(

131439 
sqlôe3
 *
db
,

131440 *
pHash
,

131441 
¨gc
,

131442 c⁄° * c⁄° *
¨gv
,

131443 
sqlôe3_vèb
 **
µVèb
,

131444 **
pzEº


131446 
Fts3tokTabÀ
 *
pTab
;

131447 c⁄° 
sqlôe3_tokíizî_moduÀ
 *
pMod
 = 0;

131448 
sqlôe3_tokíizî
 *
pTok
 = 0;

131449 
rc
;

131450 **
azDequŸe
 = 0;

131451 
nDequŸe
;

131453 
rc
 = 
	`sqlôe3_de˛¨e_vèb
(
db
, 
FTS3_TOK_SCHEMA
);

131454 if–
rc
!=
SQLITE_OK
 ) Ñc;

131456 
nDequŸe
 = 
¨gc
-3;

131457 
rc
 = 
	`·s3tokDequŸeAºay
(
nDequŸe
, &
¨gv
[3], &
azDequŸe
);

131459 if–
rc
==
SQLITE_OK
 ){

131460 c⁄° *
zModuÀ
;

131461 if–
nDequŸe
<1 ){

131462 
zModuÀ
 = "simple";

131464 
zModuÀ
 = 
azDequŸe
[0];

131466 
rc
 = 
	`·s3tokQuîyTokíizî
((
Fts3Hash
*)
pHash
, 
zModuÀ
, &
pMod
, 
pzEº
);

131469 
	`as£π
–(
rc
==
SQLITE_OK
)==(
pMod
!=0) );

131470 if–
rc
==
SQLITE_OK
 ){

131471 c⁄° * c⁄° *
azArg
 = (c⁄° * c⁄° *)&
azDequŸe
[1];

131472 
rc
 = 
pMod
->
	`xCª©e
((
nDequŸe
>1 ?ÇDequŸe-1 : 0), 
azArg
, &
pTok
);

131475 if–
rc
==
SQLITE_OK
 ){

131476 
pTab
 = (
Fts3tokTabÀ
 *)
	`sqlôe3_mÆloc
((Fts3tokTable));

131477 if–
pTab
==0 ){

131478 
rc
 = 
SQLITE_NOMEM
;

131482 if–
rc
==
SQLITE_OK
 ){

131483 
	`mem£t
(
pTab
, 0, (
Fts3tokTabÀ
));

131484 
pTab
->
pMod
 =ÖMod;

131485 
pTab
->
pTok
 =ÖTok;

131486 *
µVèb
 = &
pTab
->
ba£
;

131488 if–
pTok
 ){

131489 
pMod
->
	`xDe°roy
(
pTok
);

131493 
	`sqlôe3_‰ì
(
azDequŸe
);

131494  
rc
;

131502 
	`·s3tokDisc⁄√˘Mëhod
(
sqlôe3_vèb
 *
pVèb
){

131503 
Fts3tokTabÀ
 *
pTab
 = (Fts3tokTabÀ *)
pVèb
;

131505 
pTab
->
pMod
->
	`xDe°roy
’Tab->
pTok
);

131506 
	`sqlôe3_‰ì
(
pTab
);

131507  
SQLITE_OK
;

131513 
	`·s3tokBe°IndexMëhod
(

131514 
sqlôe3_vèb
 *
pVTab
,

131515 
sqlôe3_ödex_öfo
 *
pInfo


131517 
i
;

131518 
	`UNUSED_PARAMETER
(
pVTab
);

131520 
i
=0; i<
pInfo
->
nC⁄°øöt
; i++){

131521 if–
pInfo
->
aC⁄°øöt
[
i
].
ußbÀ


131522 && 
pInfo
->
aC⁄°øöt
[
i
].
iCﬁumn
==0

131523 && 
pInfo
->
aC⁄°øöt
[
i
].
›
==
SQLITE_INDEX_CONSTRAINT_EQ


131525 
pInfo
->
idxNum
 = 1;

131526 
pInfo
->
aC⁄°øötUßge
[
i
].
¨gvIndex
 = 1;

131527 
pInfo
->
aC⁄°øötUßge
[
i
].
omô
 = 1;

131528 
pInfo
->
e°im©edCo°
 = 1;

131529  
SQLITE_OK
;

131533 
pInfo
->
idxNum
 = 0;

131534 
	`as£π
–
pInfo
->
e°im©edCo°
>1000000.0 );

131536  
SQLITE_OK
;

131542 
	`·s3tokO≥nMëhod
(
sqlôe3_vèb
 *
pVTab
, 
sqlôe3_vèb_curs‹
 **
µC§
){

131543 
Fts3tokCurs‹
 *
pC§
;

131544 
	`UNUSED_PARAMETER
(
pVTab
);

131546 
pC§
 = (
Fts3tokCurs‹
 *)
	`sqlôe3_mÆloc
((Fts3tokCursor));

131547 if–
pC§
==0 ){

131548  
SQLITE_NOMEM
;

131550 
	`mem£t
(
pC§
, 0, (
Fts3tokCurs‹
));

131552 *
µC§
 = (
sqlôe3_vèb_curs‹
 *)
pC§
;

131553  
SQLITE_OK
;

131560 
	`·s3tokRe£tCurs‹
(
Fts3tokCurs‹
 *
pC§
){

131561 if–
pC§
->pCsr ){

131562 
Fts3tokTabÀ
 *
pTab
 = (Fts3tokTabÀ *)(
pC§
->
ba£
.
pVèb
);

131563 
pTab
->
pMod
->
	`xClo£
(
pC§
->pCsr);

131564 
pC§
->pCsr = 0;

131566 
	`sqlôe3_‰ì
(
pC§
->
zI≈ut
);

131567 
pC§
->
zI≈ut
 = 0;

131568 
pC§
->
zTokí
 = 0;

131569 
pC§
->
nTokí
 = 0;

131570 
pC§
->
iSèπ
 = 0;

131571 
pC§
->
iEnd
 = 0;

131572 
pC§
->
iPos
 = 0;

131573 
pC§
->
iRowid
 = 0;

131579 
	`·s3tokClo£Mëhod
(
sqlôe3_vèb_curs‹
 *
pCurs‹
){

131580 
Fts3tokCurs‹
 *
pC§
 = (Fts3tokCurs‹ *)
pCurs‹
;

131582 
	`·s3tokRe£tCurs‹
(
pC§
);

131583 
	`sqlôe3_‰ì
(
pC§
);

131584  
SQLITE_OK
;

131590 
	`·s3tokNextMëhod
(
sqlôe3_vèb_curs‹
 *
pCurs‹
){

131591 
Fts3tokCurs‹
 *
pC§
 = (Fts3tokCurs‹ *)
pCurs‹
;

131592 
Fts3tokTabÀ
 *
pTab
 = (Fts3tokTabÀ *)(
pCurs‹
->
pVèb
);

131593 
rc
;

131595 
pC§
->
iRowid
++;

131596 
rc
 = 
pTab
->
pMod
->
	`xNext
(
pC§
->pCsr,

131597 &
pC§
->
zTokí
, &pC§->
nTokí
,

131598 &
pC§
->
iSèπ
, &pC§->
iEnd
, &pC§->
iPos


131601 if–
rc
!=
SQLITE_OK
 ){

131602 
	`·s3tokRe£tCurs‹
(
pC§
);

131603 if–
rc
==
SQLITE_DONE
 )Ñ¯
SQLITE_OK
;

131606  
rc
;

131612 
	`·s3tokFûãrMëhod
(

131613 
sqlôe3_vèb_curs‹
 *
pCurs‹
,

131614 
idxNum
,

131615 c⁄° *
idxSå
,

131616 
nVÆ
,

131617 
sqlôe3_vÆue
 **
≠VÆ


131619 
rc
 = 
SQLITE_ERROR
;

131620 
Fts3tokCurs‹
 *
pC§
 = (Fts3tokCurs‹ *)
pCurs‹
;

131621 
Fts3tokTabÀ
 *
pTab
 = (Fts3tokTabÀ *)(
pCurs‹
->
pVèb
);

131622 
	`UNUSED_PARAMETER
(
idxSå
);

131623 
	`UNUSED_PARAMETER
(
nVÆ
);

131625 
	`·s3tokRe£tCurs‹
(
pC§
);

131626 if–
idxNum
==1 ){

131627 c⁄° *
zByã
 = (c⁄° *)
	`sqlôe3_vÆue_ãxt
(
≠VÆ
[0]);

131628 
nByã
 = 
	`sqlôe3_vÆue_byãs
(
≠VÆ
[0]);

131629 
pC§
->
zI≈ut
 = 
	`sqlôe3_mÆloc
(
nByã
+1);

131630 if–
pC§
->
zI≈ut
==0 ){

131631 
rc
 = 
SQLITE_NOMEM
;

131633 
	`mem˝y
(
pC§
->
zI≈ut
, 
zByã
, 
nByã
);

131634 
pC§
->
zI≈ut
[
nByã
] = 0;

131635 
rc
 = 
pTab
->
pMod
->
	`xO≥n
’Tab->
pTok
, 
pC§
->
zI≈ut
, 
nByã
, &pCsr->pCsr);

131636 if–
rc
==
SQLITE_OK
 ){

131637 
pC§
->pC§->
pTokíizî
 = 
pTab
->
pTok
;

131642 if–
rc
!=
SQLITE_OK
 ) Ñc;

131643  
	`·s3tokNextMëhod
(
pCurs‹
);

131649 
	`·s3tokEofMëhod
(
sqlôe3_vèb_curs‹
 *
pCurs‹
){

131650 
Fts3tokCurs‹
 *
pC§
 = (Fts3tokCurs‹ *)
pCurs‹
;

131651  (
pC§
->
zTokí
==0);

131657 
	`·s3tokCﬁumnMëhod
(

131658 
sqlôe3_vèb_curs‹
 *
pCurs‹
,

131659 
sqlôe3_c⁄ãxt
 *
pCtx
,

131660 
iCﬁ


131662 
Fts3tokCurs‹
 *
pC§
 = (Fts3tokCurs‹ *)
pCurs‹
;

131665  
iCﬁ
 ){

131667 
	`sqlôe3_ªsu…_ãxt
(
pCtx
, 
pC§
->
zI≈ut
, -1, 
SQLITE_TRANSIENT
);

131670 
	`sqlôe3_ªsu…_ãxt
(
pCtx
, 
pC§
->
zTokí
,ÖC§->
nTokí
, 
SQLITE_TRANSIENT
);

131673 
	`sqlôe3_ªsu…_öt
(
pCtx
, 
pC§
->
iSèπ
);

131676 
	`sqlôe3_ªsu…_öt
(
pCtx
, 
pC§
->
iEnd
);

131679 
	`as£π
–
iCﬁ
==4 );

131680 
	`sqlôe3_ªsu…_öt
(
pCtx
, 
pC§
->
iPos
);

131683  
SQLITE_OK
;

131689 
	`·s3tokRowidMëhod
(

131690 
sqlôe3_vèb_curs‹
 *
pCurs‹
,

131691 
sqlôe_öt64
 *
pRowid


131693 
Fts3tokCurs‹
 *
pC§
 = (Fts3tokCurs‹ *)
pCurs‹
;

131694 *
pRowid
 = (
sqlôe3_öt64
)
pC§
->
iRowid
;

131695  
SQLITE_OK
;

131702 
SQLITE_PRIVATE
 
	`sqlôe3Fts3InôTok
(
sqlôe3
 *
db
, 
Fts3Hash
 *
pHash
){

131703 c⁄° 
sqlôe3_moduÀ
 
·s3tok_moduÀ
 = {

131705 
·s3tokC⁄√˘Mëhod
,

131706 
·s3tokC⁄√˘Mëhod
,

131707 
·s3tokBe°IndexMëhod
,

131708 
·s3tokDisc⁄√˘Mëhod
,

131709 
·s3tokDisc⁄√˘Mëhod
,

131710 
·s3tokO≥nMëhod
,

131711 
·s3tokClo£Mëhod
,

131712 
·s3tokFûãrMëhod
,

131713 
·s3tokNextMëhod
,

131714 
·s3tokEofMëhod
,

131715 
·s3tokCﬁumnMëhod
,

131716 
·s3tokRowidMëhod
,

131728 
rc
;

131730 
rc
 = 
	`sqlôe3_¸óã_moduÀ
(
db
, "·s3tokíize", &
·s3tok_moduÀ
, (*)
pHash
);

131731  
rc
;

131757 #i‡!
	`deföed
(
SQLITE_CORE
Ë|| deföed(
SQLITE_ENABLE_FTS3
)

131764 
	#FTS_MAX_APPENDABLE_HEIGHT
 16

	)

131776 
	#FTS3_NODE_PADDING
 (
FTS3_VARINT_MAX
*2)

	)

131795 #ifde‡
SQLITE_TEST


131796 
ã°_·s3_node_chunksize
 = (4*1024);

131797 
ã°_·s3_node_chunk_thªshﬁd
 = (4*1024)*4;

131798 
	#FTS3_NODE_CHUNKSIZE
 
ã°_·s3_node_chunksize


	)

131799 
	#FTS3_NODE_CHUNK_THRESHOLD
 
ã°_·s3_node_chunk_thªshﬁd


	)

131801 
	#FTS3_NODE_CHUNKSIZE
 (4*1024)

	)

131802 
	#FTS3_NODE_CHUNK_THRESHOLD
 (
FTS3_NODE_CHUNKSIZE
*4)

	)

131809 
	#FTS_STAT_DOCTOTAL
 0

	)

131810 
	#FTS_STAT_INCRMERGEHINT
 1

	)

131811 
	#FTS_STAT_AUTOINCRMERGE
 2

	)

131819 #ifde‡
FTS3_LOG_MERGES


131820 
	`·s3LogMîge
(
nMîge
, 
sqlôe3_öt64
 
iAbsLevñ
){

131821 
	`sqlôe3_log
(
SQLITE_OK
, "%d-way mîgê‰omÜevñ %d", 
nMîge
, ()
iAbsLevñ
);

131824 
	#·s3LogMîge
(
x
, 
y
)

	)

131828 
PídögLi°
 
	tPídögLi°
;

131829 
SegmítNode
 
	tSegmítNode
;

131830 
SegmítWrôî
 
	tSegmítWrôî
;

131836 
	sPídögLi°
 {

131837 
nD©a
;

131838 *
aD©a
;

131839 
nS∑˚
;

131840 
sqlôe3_öt64
 
iLa°Docid
;

131841 
sqlôe3_öt64
 
iLa°Cﬁ
;

131842 
sqlôe3_öt64
 
iLa°Pos
;

131849 
	sFts3De„ºedTokí
 {

131850 
Fts3Phø£Tokí
 *
pTokí
;

131851 
iCﬁ
;

131852 
Fts3De„ºedTokí
 *
pNext
;

131853 
PídögLi°
 *
pLi°
;

131873 
	sFts3SegRódî
 {

131874 
iIdx
;

131875 
u8
 
bLookup
;

131876 
u8
 
roŸO∆y
;

131878 
sqlôe3_öt64
 
iSèπBlock
;

131879 
sqlôe3_öt64
 
iLófEndBlock
;

131880 
sqlôe3_öt64
 
iEndBlock
;

131881 
sqlôe3_öt64
 
iCuºítBlock
;

131883 *
aNode
;

131884 
nNode
;

131885 
nP›uœã
;

131886 
sqlôe3_blob
 *
pBlob
;

131888 
Fts3HashEÀm
 **
µNextEÀm
;

131895 
nTîm
;

131896 *
zTîm
;

131897 
nTîmAŒoc
;

131898 *
aDo˛i°
;

131899 
nDo˛i°
;

131904 *
pOff£tLi°
;

131905 
nOff£tLi°
;

131906 
sqlôe3_öt64
 
iDocid
;

131909 
	#·s3SegRódîIsPídög
(
p
Ë(’)->
µNextEÀm
!=0)

	)

131910 
	#·s3SegRódîIsRoŸO∆y
(
p
Ë(’)->
roŸO∆y
!=0)

	)

131921 
	sSegmítWrôî
 {

131922 
SegmítNode
 *
pTªe
;

131923 
sqlôe3_öt64
 
iFú°
;

131924 
sqlôe3_öt64
 
iFªe
;

131925 *
zTîm
;

131926 
nTîm
;

131927 
nMÆloc
;

131928 *
zMÆloc
;

131929 
nSize
;

131930 
nD©a
;

131931 *
aD©a
;

131952 
	sSegmítNode
 {

131953 
SegmítNode
 *
pP¨ít
;

131954 
SegmítNode
 *
pRight
;

131955 
SegmítNode
 *
pLe·mo°
;

131956 
nE¡ry
;

131957 *
zTîm
;

131958 
nTîm
;

131959 
nMÆloc
;

131960 *
zMÆloc
;

131961 
nD©a
;

131962 *
aD©a
;

131968 
	#SQL_DELETE_CONTENT
 0

	)

131969 
	#SQL_IS_EMPTY
 1

	)

131970 
	#SQL_DELETE_ALL_CONTENT
 2

	)

131971 
	#SQL_DELETE_ALL_SEGMENTS
 3

	)

131972 
	#SQL_DELETE_ALL_SEGDIR
 4

	)

131973 
	#SQL_DELETE_ALL_DOCSIZE
 5

	)

131974 
	#SQL_DELETE_ALL_STAT
 6

	)

131975 
	#SQL_SELECT_CONTENT_BY_ROWID
 7

	)

131976 
	#SQL_NEXT_SEGMENT_INDEX
 8

	)

131977 
	#SQL_INSERT_SEGMENTS
 9

	)

131978 
	#SQL_NEXT_SEGMENTS_ID
 10

	)

131979 
	#SQL_INSERT_SEGDIR
 11

	)

131980 
	#SQL_SELECT_LEVEL
 12

	)

131981 
	#SQL_SELECT_LEVEL_RANGE
 13

	)

131982 
	#SQL_SELECT_LEVEL_COUNT
 14

	)

131983 
	#SQL_SELECT_SEGDIR_MAX_LEVEL
 15

	)

131984 
	#SQL_DELETE_SEGDIR_LEVEL
 16

	)

131985 
	#SQL_DELETE_SEGMENTS_RANGE
 17

	)

131986 
	#SQL_CONTENT_INSERT
 18

	)

131987 
	#SQL_DELETE_DOCSIZE
 19

	)

131988 
	#SQL_REPLACE_DOCSIZE
 20

	)

131989 
	#SQL_SELECT_DOCSIZE
 21

	)

131990 
	#SQL_SELECT_STAT
 22

	)

131991 
	#SQL_REPLACE_STAT
 23

	)

131993 
	#SQL_SELECT_ALL_PREFIX_LEVEL
 24

	)

131994 
	#SQL_DELETE_ALL_TERMS_SEGDIR
 25

	)

131995 
	#SQL_DELETE_SEGDIR_RANGE
 26

	)

131996 
	#SQL_SELECT_ALL_LANGID
 27

	)

131997 
	#SQL_FIND_MERGE_LEVEL
 28

	)

131998 
	#SQL_MAX_LEAF_NODE_ESTIMATE
 29

	)

131999 
	#SQL_DELETE_SEGDIR_ENTRY
 30

	)

132000 
	#SQL_SHIFT_SEGDIR_ENTRY
 31

	)

132001 
	#SQL_SELECT_SEGDIR
 32

	)

132002 
	#SQL_CHOMP_SEGDIR
 33

	)

132003 
	#SQL_SEGMENT_IS_APPENDABLE
 34

	)

132004 
	#SQL_SELECT_INDEXES
 35

	)

132005 
	#SQL_SELECT_MXLEVEL
 36

	)

132018 
	`·s3SqlStmt
(

132019 
Fts3TabÀ
 *
p
,

132020 
eStmt
,

132021 
sqlôe3_°mt
 **
µ
,

132022 
sqlôe3_vÆue
 **
≠VÆ


132024 c⁄° *
azSql
[] = {

132110 
rc
 = 
SQLITE_OK
;

132111 
sqlôe3_°mt
 *
pStmt
;

132113 
	`as£π
–
	`SizeofAºay
(
azSql
)==SizeofAºay(
p
->
aStmt
) );

132114 
	`as£π
–
eStmt
<
	`SizeofAºay
(
azSql
) &&ÉStmt>=0 );

132116 
pStmt
 = 
p
->
aStmt
[
eStmt
];

132117 if–!
pStmt
 ){

132118 *
zSql
;

132119 if–
eStmt
==
SQL_CONTENT_INSERT
 ){

132120 
zSql
 = 
	`sqlôe3_m¥ötf
(
azSql
[
eStmt
], 
p
->
zDb
,Ö->
zName
,Ö->
zWrôeEx¥li°
);

132121 }if–
eStmt
==
SQL_SELECT_CONTENT_BY_ROWID
 ){

132122 
zSql
 = 
	`sqlôe3_m¥ötf
(
azSql
[
eStmt
], 
p
->
zRódEx¥li°
);

132124 
zSql
 = 
	`sqlôe3_m¥ötf
(
azSql
[
eStmt
], 
p
->
zDb
,Ö->
zName
);

132126 if–!
zSql
 ){

132127 
rc
 = 
SQLITE_NOMEM
;

132129 
rc
 = 
	`sqlôe3_¥ï¨e_v2
(
p
->
db
, 
zSql
, -1, &
pStmt
, 
NULL
);

132130 
	`sqlôe3_‰ì
(
zSql
);

132131 
	`as£π
–
rc
==
SQLITE_OK
 || 
pStmt
==0 );

132132 
p
->
aStmt
[
eStmt
] = 
pStmt
;

132135 if–
≠VÆ
 ){

132136 
i
;

132137 
nP¨am
 = 
	`sqlôe3_böd_∑ømëî_cou¡
(
pStmt
);

132138 
i
=0; 
rc
==
SQLITE_OK
 && i<
nP¨am
; i++){

132139 
rc
 = 
	`sqlôe3_böd_vÆue
(
pStmt
, 
i
+1, 
≠VÆ
[i]);

132142 *
µ
 = 
pStmt
;

132143  
rc
;

132147 
	`·s3Sñe˘Docsize
(

132148 
Fts3TabÀ
 *
pTab
,

132149 
sqlôe3_öt64
 
iDocid
,

132150 
sqlôe3_°mt
 **
µStmt


132152 
sqlôe3_°mt
 *
pStmt
 = 0;

132153 
rc
;

132155 
rc
 = 
	`·s3SqlStmt
(
pTab
, 
SQL_SELECT_DOCSIZE
, &
pStmt
, 0);

132156 if–
rc
==
SQLITE_OK
 ){

132157 
	`sqlôe3_böd_öt64
(
pStmt
, 1, 
iDocid
);

132158 
rc
 = 
	`sqlôe3_°ï
(
pStmt
);

132159 if–
rc
!=
SQLITE_ROW
 || 
	`sqlôe3_cﬁumn_ty≥
(
pStmt
, 0)!=
SQLITE_BLOB
 ){

132160 
rc
 = 
	`sqlôe3_ª£t
(
pStmt
);

132161 if–
rc
==
SQLITE_OK
 )Ñ¯
FTS_CORRUPT_VTAB
;

132162 
pStmt
 = 0;

132164 
rc
 = 
SQLITE_OK
;

132168 *
µStmt
 = 
pStmt
;

132169  
rc
;

132172 
SQLITE_PRIVATE
 
	`sqlôe3Fts3Sñe˘Do˘ŸÆ
(

132173 
Fts3TabÀ
 *
pTab
,

132174 
sqlôe3_°mt
 **
µStmt


132176 
sqlôe3_°mt
 *
pStmt
 = 0;

132177 
rc
;

132178 
rc
 = 
	`·s3SqlStmt
(
pTab
, 
SQL_SELECT_STAT
, &
pStmt
, 0);

132179 if–
rc
==
SQLITE_OK
 ){

132180 
	`sqlôe3_böd_öt
(
pStmt
, 1, 
FTS_STAT_DOCTOTAL
);

132181 if–
	`sqlôe3_°ï
(
pStmt
)!=
SQLITE_ROW


132182 || 
	`sqlôe3_cﬁumn_ty≥
(
pStmt
, 0)!=
SQLITE_BLOB


132184 
rc
 = 
	`sqlôe3_ª£t
(
pStmt
);

132185 if–
rc
==
SQLITE_OK
 )Ñ¯
FTS_CORRUPT_VTAB
;

132186 
pStmt
 = 0;

132189 *
µStmt
 = 
pStmt
;

132190  
rc
;

132193 
SQLITE_PRIVATE
 
	`sqlôe3Fts3Sñe˘Docsize
(

132194 
Fts3TabÀ
 *
pTab
,

132195 
sqlôe3_öt64
 
iDocid
,

132196 
sqlôe3_°mt
 **
µStmt


132198  
	`·s3Sñe˘Docsize
(
pTab
, 
iDocid
, 
µStmt
);

132209 
	`·s3SqlExec
(

132210 *
pRC
,

132211 
Fts3TabÀ
 *
p
,

132212 
eStmt
,

132213 
sqlôe3_vÆue
 **
≠VÆ


132215 
sqlôe3_°mt
 *
pStmt
;

132216 
rc
;

132217 if–*
pRC
 ) ;

132218 
rc
 = 
	`·s3SqlStmt
(
p
, 
eStmt
, &
pStmt
, 
≠VÆ
);

132219 if–
rc
==
SQLITE_OK
 ){

132220 
	`sqlôe3_°ï
(
pStmt
);

132221 
rc
 = 
	`sqlôe3_ª£t
(
pStmt
);

132223 *
pRC
 = 
rc
;

132241 
	`·s3Wrôñock
(
Fts3TabÀ
 *
p
){

132242 
rc
 = 
SQLITE_OK
;

132244 if–
p
->
nPídögD©a
==0 ){

132245 
sqlôe3_°mt
 *
pStmt
;

132246 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_DELETE_SEGDIR_LEVEL
, &
pStmt
, 0);

132247 if–
rc
==
SQLITE_OK
 ){

132248 
	`sqlôe3_böd_nuŒ
(
pStmt
, 1);

132249 
	`sqlôe3_°ï
(
pStmt
);

132250 
rc
 = 
	`sqlôe3_ª£t
(
pStmt
);

132254  
rc
;

132280 
sqlôe3_öt64
 
	`gëAbsﬁuãLevñ
(

132281 
Fts3TabÀ
 *
p
,

132282 
iL™gid
,

132283 
iIndex
,

132284 
iLevñ


132286 
sqlôe3_öt64
 
iBa£
;

132287 
	`as£π
–
iL™gid
>=0 );

132288 
	`as£π
–
p
->
nIndex
>0 );

132289 
	`as£π
–
iIndex
>=0 && iIndex<
p
->
nIndex
 );

132291 
iBa£
 = ((
sqlôe3_öt64
)
iL™gid
 * 
p
->
nIndex
 + 
iIndex
Ë* 
FTS3_SEGDIR_MAXLEVEL
;

132292  
iBa£
 + 
iLevñ
;

132312 
SQLITE_PRIVATE
 
	`sqlôe3Fts3AŒSegdús
(

132313 
Fts3TabÀ
 *
p
,

132314 
iL™gid
,

132315 
iIndex
,

132316 
iLevñ
,

132317 
sqlôe3_°mt
 **
µStmt


132319 
rc
;

132320 
sqlôe3_°mt
 *
pStmt
 = 0;

132322 
	`as£π
–
iLevñ
==
FTS3_SEGCURSOR_ALL
 || iLevel>=0 );

132323 
	`as£π
–
iLevñ
<
FTS3_SEGDIR_MAXLEVEL
 );

132324 
	`as£π
–
iIndex
>=0 && iIndex<
p
->
nIndex
 );

132326 if–
iLevñ
<0 ){

132328 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_SELECT_LEVEL_RANGE
, &
pStmt
, 0);

132329 if–
rc
==
SQLITE_OK
 ){

132330 
	`sqlôe3_böd_öt64
(
pStmt
, 1, 
	`gëAbsﬁuãLevñ
(
p
, 
iL™gid
, 
iIndex
, 0));

132331 
	`sqlôe3_böd_öt64
(
pStmt
, 2,

132332 
	`gëAbsﬁuãLevñ
(
p
, 
iL™gid
, 
iIndex
, 
FTS3_SEGDIR_MAXLEVEL
-1)

132337 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_SELECT_LEVEL
, &
pStmt
, 0);

132338 if–
rc
==
SQLITE_OK
 ){

132339 
	`sqlôe3_böd_öt64
(
pStmt
, 1, 
	`gëAbsﬁuãLevñ
(
p
, 
iL™gid
, 
iIndex
,
iLevñ
));

132342 *
µStmt
 = 
pStmt
;

132343  
rc
;

132359 
	`·s3PídögLi°AµídV¨öt
(

132360 
PídögLi°
 **
µ
,

132361 
sqlôe3_öt64
 
i


132363 
PídögLi°
 *
p
 = *
µ
;

132366 if–!
p
 ){

132367 
p
 = 
	`sqlôe3_mÆloc
((*p) + 100);

132368 if–!
p
 ){

132369  
SQLITE_NOMEM
;

132371 
p
->
nS∑˚
 = 100;

132372 
p
->
aD©a
 = (*)&p[1];

132373 
p
->
nD©a
 = 0;

132375 if–
p
->
nD©a
+
FTS3_VARINT_MAX
+1>p->
nS∑˚
 ){

132376 
nNew
 = 
p
->
nS∑˚
 * 2;

132377 
p
 = 
	`sqlôe3_ªÆloc
’, (*pË+ 
nNew
);

132378 if–!
p
 ){

132379 
	`sqlôe3_‰ì
(*
µ
);

132380 *
µ
 = 0;

132381  
SQLITE_NOMEM
;

132383 
p
->
nS∑˚
 = 
nNew
;

132384 
p
->
aD©a
 = (*)&p[1];

132388 
p
->
nD©a
 +
	`sqlôe3Fts3PutV¨öt
(&p->
aD©a
[p->nD©a], 
i
);

132389 
p
->
aD©a
[p->
nD©a
] = '\0';

132390 *
µ
 = 
p
;

132391  
SQLITE_OK
;

132403 
	`·s3PídögLi°Aµíd
(

132404 
PídögLi°
 **
µ
,

132405 
sqlôe3_öt64
 
iDocid
,

132406 
sqlôe3_öt64
 
iCﬁ
,

132407 
sqlôe3_öt64
 
iPos
,

132408 *
pRc


132410 
PídögLi°
 *
p
 = *
µ
;

132411 
rc
 = 
SQLITE_OK
;

132413 
	`as£π
–!
p
 ||Ö->
iLa°Docid
<=
iDocid
 );

132415 if–!
p
 ||Ö->
iLa°Docid
!=
iDocid
 ){

132416 
sqlôe3_öt64
 
iDñè
 = 
iDocid
 - (
p
 ?Ö->
iLa°Docid
 : 0);

132417 if–
p
 ){

132418 
	`as£π
–
p
->
nD©a
<p->
nS∑˚
 );

132419 
	`as£π
–
p
->
aD©a
[p->
nD©a
]==0 );

132420 
p
->
nD©a
++;

132422 if–
SQLITE_OK
!=(
rc
 = 
	`·s3PídögLi°AµídV¨öt
(&
p
, 
iDñè
)) ){

132423 
≥ndögli°≠≥nd_out
;

132425 
p
->
iLa°Cﬁ
 = -1;

132426 
p
->
iLa°Pos
 = 0;

132427 
p
->
iLa°Docid
 = 
iDocid
;

132429 if–
iCﬁ
>0 && 
p
->
iLa°Cﬁ
!=iCol ){

132430 if–
SQLITE_OK
!=(
rc
 = 
	`·s3PídögLi°AµídV¨öt
(&
p
, 1))

132431 || 
SQLITE_OK
!=(
rc
 = 
	`·s3PídögLi°AµídV¨öt
(&
p
, 
iCﬁ
))

132433 
≥ndögli°≠≥nd_out
;

132435 
p
->
iLa°Cﬁ
 = 
iCﬁ
;

132436 
p
->
iLa°Pos
 = 0;

132438 if–
iCﬁ
>=0 ){

132439 
	`as£π
–
iPos
>
p
->
iLa°Pos
 || (iPos==0 &&Ö->iLastPos==0) );

132440 
rc
 = 
	`·s3PídögLi°AµídV¨öt
(&
p
, 2+
iPos
-p->
iLa°Pos
);

132441 if–
rc
==
SQLITE_OK
 ){

132442 
p
->
iLa°Pos
 = 
iPos
;

132446 
≥ndögli°≠≥nd_out
:

132447 *
pRc
 = 
rc
;

132448 if–
p
!=*
µ
 ){

132449 *
µ
 = 
p
;

132458 
	`·s3PídögLi°Dñëe
(
PídögLi°
 *
pLi°
){

132459 
	`sqlôe3_‰ì
(
pLi°
);

132465 
	`·s3PídögTîmsAddO√
(

132466 
Fts3TabÀ
 *
p
,

132467 
iCﬁ
,

132468 
iPos
,

132469 
Fts3Hash
 *
pHash
,

132470 c⁄° *
zTokí
,

132471 
nTokí


132473 
PídögLi°
 *
pLi°
;

132474 
rc
 = 
SQLITE_OK
;

132476 
pLi°
 = (
PídögLi°
 *)
	`·s3HashFöd
(
pHash
, 
zTokí
, 
nTokí
);

132477 if–
pLi°
 ){

132478 
p
->
nPídögD©a
 -(
pLi°
->
nD©a
 + 
nTokí
 + (
Fts3HashEÀm
));

132480 if–
	`·s3PídögLi°Aµíd
(&
pLi°
, 
p
->
iPªvDocid
, 
iCﬁ
, 
iPos
, &
rc
) ){

132481 if–
pLi°
==
	`·s3HashIn£π
(
pHash
, 
zTokí
, 
nTokí
,ÖList) ){

132485 
	`as£π
–0==
	`·s3HashFöd
(
pHash
, 
zTokí
, 
nTokí
) );

132486 
	`sqlôe3_‰ì
(
pLi°
);

132487 
rc
 = 
SQLITE_NOMEM
;

132490 if–
rc
==
SQLITE_OK
 ){

132491 
p
->
nPídögD©a
 +(
pLi°
->
nD©a
 + 
nTokí
 + (
Fts3HashEÀm
));

132493  
rc
;

132503 
	`·s3PídögTîmsAdd
(

132504 
Fts3TabÀ
 *
p
,

132505 
iL™gid
,

132506 c⁄° *
zText
,

132507 
iCﬁ
,

132508 
u32
 *
≤W‹d


132510 
rc
;

132511 
iSèπ
 = 0;

132512 
iEnd
 = 0;

132513 
iPos
 = 0;

132514 
nW‹d
 = 0;

132516 c⁄° *
zTokí
;

132517 
nTokí
 = 0;

132519 
sqlôe3_tokíizî
 *
pTokíizî
 = 
p
->pTokenizer;

132520 
sqlôe3_tokíizî_moduÀ
 c⁄° *
pModuÀ
 = 
pTokíizî
->pModule;

132521 
sqlôe3_tokíizî_curs‹
 *
pC§
;

132522 (*
xNext
)(
sqlôe3_tokíizî_curs‹
 *
pCurs‹
,

132525 
	`as£π
–
pTokíizî
 && 
pModuÀ
 );

132530 if–
zText
==0 ){

132531 *
≤W‹d
 = 0;

132532  
SQLITE_OK
;

132535 
rc
 = 
	`sqlôe3Fts3O≥nTokíizî
(
pTokíizî
, 
iL™gid
, 
zText
, -1, &
pC§
);

132536 if–
rc
!=
SQLITE_OK
 ){

132537  
rc
;

132540 
xNext
 = 
pModuÀ
->xNext;

132541  
SQLITE_OK
==
rc


132542 && 
SQLITE_OK
==(
rc
 = 
	`xNext
(
pC§
, &
zTokí
, &
nTokí
, &
iSèπ
, &
iEnd
, &
iPos
))

132544 
i
;

132545 if–
iPos
>=
nW‹d
 )ÇWord = iPos+1;

132550 if–
iPos
<0 || !
zTokí
 || 
nTokí
<=0 ){

132551 
rc
 = 
SQLITE_ERROR
;

132556 
rc
 = 
	`·s3PídögTîmsAddO√
(

132557 
p
, 
iCﬁ
, 
iPos
, &p->
aIndex
[0].
hPídög
, 
zTokí
, 
nTokí


132562 
i
=1; 
rc
==
SQLITE_OK
 && i<
p
->
nIndex
; i++){

132563 
Fts3Index
 *
pIndex
 = &
p
->
aIndex
[
i
];

132564 if–
nTokí
<
pIndex
->
nPªfix
 ) ;

132565 
rc
 = 
	`·s3PídögTîmsAddO√
(

132566 
p
, 
iCﬁ
, 
iPos
, &
pIndex
->
hPídög
, 
zTokí
,ÖIndex->
nPªfix


132571 
pModuÀ
->
	`xClo£
(
pC§
);

132572 *
≤W‹d
 +
nW‹d
;

132573  (
rc
==
SQLITE_DONE
 ? 
SQLITE_OK
 :Ñc);

132581 
	`·s3PídögTîmsDocid
(

132582 
Fts3TabÀ
 *
p
,

132583 
iL™gid
,

132584 
sqlôe_öt64
 
iDocid


132586 
	`as£π
–
iL™gid
>=0 );

132594 if–
iDocid
<=
p
->
iPªvDocid


132595 || 
p
->
iPªvL™gid
!=
iL™gid


132596 || 
p
->
nPídögD©a
>p->
nMaxPídögD©a


132598 
rc
 = 
	`sqlôe3Fts3PídögTîmsFlush
(
p
);

132599 if–
rc
!=
SQLITE_OK
 ) Ñc;

132601 
p
->
iPªvDocid
 = 
iDocid
;

132602 
p
->
iPªvL™gid
 = 
iL™gid
;

132603  
SQLITE_OK
;

132609 
SQLITE_PRIVATE
 
	`sqlôe3Fts3PídögTîmsCÀ¨
(
Fts3TabÀ
 *
p
){

132610 
i
;

132611 
i
=0; i<
p
->
nIndex
; i++){

132612 
Fts3HashEÀm
 *
pEÀm
;

132613 
Fts3Hash
 *
pHash
 = &
p
->
aIndex
[
i
].
hPídög
;

132614 
pEÀm
=
	`·s3HashFú°
(
pHash
);ÖEÀm;ÖEÀm=
	`·s3HashNext
(pElem)){

132615 
PídögLi°
 *
pLi°
 = (PídögLi° *)
	`·s3HashD©a
(
pEÀm
);

132616 
	`·s3PídögLi°Dñëe
(
pLi°
);

132618 
	`·s3HashCÀ¨
(
pHash
);

132620 
p
->
nPídögD©a
 = 0;

132631 
	`·s3In£πTîms
(

132632 
Fts3TabÀ
 *
p
,

132633 
iL™gid
,

132634 
sqlôe3_vÆue
 **
≠VÆ
,

132635 
u32
 *
aSz


132637 
i
;

132638 
i
=2; i<
p
->
nCﬁumn
+2; i++){

132639 
iCﬁ
 = 
i
-2;

132640 if–
p
->
abNŸödexed
[
iCﬁ
]==0 ){

132641 c⁄° *
zText
 = (c⁄° *)
	`sqlôe3_vÆue_ãxt
(
≠VÆ
[
i
]);

132642 
rc
 = 
	`·s3PídögTîmsAdd
(
p
, 
iL™gid
, 
zText
, 
iCﬁ
, &
aSz
[iCol]);

132643 if–
rc
!=
SQLITE_OK
 ){

132644  
rc
;

132646 
aSz
[
p
->
nCﬁumn
] +
	`sqlôe3_vÆue_byãs
(
≠VÆ
[
i
]);

132649  
SQLITE_OK
;

132666 
	`·s3In£πD©a
(

132667 
Fts3TabÀ
 *
p
,

132668 
sqlôe3_vÆue
 **
≠VÆ
,

132669 
sqlôe3_öt64
 *
piDocid


132671 
rc
;

132672 
sqlôe3_°mt
 *
pC⁄ã¡In£π
;

132674 if–
p
->
zC⁄ã¡Tbl
 ){

132675 
sqlôe3_vÆue
 *
pRowid
 = 
≠VÆ
[
p
->
nCﬁumn
+3];

132676 if–
	`sqlôe3_vÆue_ty≥
(
pRowid
)==
SQLITE_NULL
 ){

132677 
pRowid
 = 
≠VÆ
[1];

132679 if–
	`sqlôe3_vÆue_ty≥
(
pRowid
)!=
SQLITE_INTEGER
 ){

132680  
SQLITE_CONSTRAINT
;

132682 *
piDocid
 = 
	`sqlôe3_vÆue_öt64
(
pRowid
);

132683  
SQLITE_OK
;

132694 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_CONTENT_INSERT
, &
pC⁄ã¡In£π
, &
≠VÆ
[1]);

132695 if–
rc
==
SQLITE_OK
 && 
p
->
zL™guageid
 ){

132696 
rc
 = 
	`sqlôe3_böd_öt
(

132697 
pC⁄ã¡In£π
, 
p
->
nCﬁumn
+2,

132698 
	`sqlôe3_vÆue_öt
(
≠VÆ
[
p
->
nCﬁumn
+4])

132701 if–
rc
!=
SQLITE_OK
 ) Ñc;

132713 if–
SQLITE_NULL
!=
	`sqlôe3_vÆue_ty≥
(
≠VÆ
[3+
p
->
nCﬁumn
]) ){

132714 if–
SQLITE_NULL
==
	`sqlôe3_vÆue_ty≥
(
≠VÆ
[0])

132715 && 
SQLITE_NULL
!=
	`sqlôe3_vÆue_ty≥
(
≠VÆ
[1])

132718  
SQLITE_ERROR
;

132720 
rc
 = 
	`sqlôe3_böd_vÆue
(
pC⁄ã¡In£π
, 1, 
≠VÆ
[3+
p
->
nCﬁumn
]);

132721 if–
rc
!=
SQLITE_OK
 ) Ñc;

132727 
	`sqlôe3_°ï
(
pC⁄ã¡In£π
);

132728 
rc
 = 
	`sqlôe3_ª£t
(
pC⁄ã¡In£π
);

132730 *
piDocid
 = 
	`sqlôe3_œ°_ö£π_rowid
(
p
->
db
);

132731  
rc
;

132740 
	`·s3DñëeAŒ
(
Fts3TabÀ
 *
p
, 
bC⁄ã¡
){

132741 
rc
 = 
SQLITE_OK
;

132744 
	`sqlôe3Fts3PídögTîmsCÀ¨
(
p
);

132748 
	`as£π
–
p
->
zC⁄ã¡Tbl
==0 || 
bC⁄ã¡
==0 );

132749 if–
bC⁄ã¡
 ) 
	`·s3SqlExec
(&
rc
, 
p
, 
SQL_DELETE_ALL_CONTENT
, 0);

132750 
	`·s3SqlExec
(&
rc
, 
p
, 
SQL_DELETE_ALL_SEGMENTS
, 0);

132751 
	`·s3SqlExec
(&
rc
, 
p
, 
SQL_DELETE_ALL_SEGDIR
, 0);

132752 if–
p
->
bHasDocsize
 ){

132753 
	`·s3SqlExec
(&
rc
, 
p
, 
SQL_DELETE_ALL_DOCSIZE
, 0);

132755 if–
p
->
bHasSèt
 ){

132756 
	`·s3SqlExec
(&
rc
, 
p
, 
SQL_DELETE_ALL_STAT
, 0);

132758  
rc
;

132764 
	`œngidFromSñe˘
(
Fts3TabÀ
 *
p
, 
sqlôe3_°mt
 *
pSñe˘
){

132765 
iL™gid
 = 0;

132766 if–
p
->
zL™guageid
 ) 
iL™gid
 = 
	`sqlôe3_cﬁumn_öt
(
pSñe˘
,Ö->
nCﬁumn
+1);

132767  
iL™gid
;

132775 
	`·s3DñëeTîms
(

132776 *
pRC
,

132777 
Fts3TabÀ
 *
p
,

132778 
sqlôe3_vÆue
 *
pRowid
,

132779 
u32
 *
aSz
,

132780 *
pbFound


132782 
rc
;

132783 
sqlôe3_°mt
 *
pSñe˘
;

132785 
	`as£π
–*
pbFound
==0 );

132786 if–*
pRC
 ) ;

132787 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_SELECT_CONTENT_BY_ROWID
, &
pSñe˘
, &
pRowid
);

132788 if–
rc
==
SQLITE_OK
 ){

132789 if–
SQLITE_ROW
==
	`sqlôe3_°ï
(
pSñe˘
) ){

132790 
i
;

132791 
iL™gid
 = 
	`œngidFromSñe˘
(
p
, 
pSñe˘
);

132792 
rc
 = 
	`·s3PídögTîmsDocid
(
p
, 
iL™gid
, 
	`sqlôe3_cﬁumn_öt64
(
pSñe˘
, 0));

132793 
i
=1; 
rc
==
SQLITE_OK
 && i<=
p
->
nCﬁumn
; i++){

132794 
iCﬁ
 = 
i
-1;

132795 if–
p
->
abNŸödexed
[
iCﬁ
]==0 ){

132796 c⁄° *
zText
 = (c⁄° *)
	`sqlôe3_cﬁumn_ãxt
(
pSñe˘
, 
i
);

132797 
rc
 = 
	`·s3PídögTîmsAdd
(
p
, 
iL™gid
, 
zText
, -1, &
aSz
[
iCﬁ
]);

132798 
aSz
[
p
->
nCﬁumn
] +
	`sqlôe3_cﬁumn_byãs
(
pSñe˘
, 
i
);

132801 if–
rc
!=
SQLITE_OK
 ){

132802 
	`sqlôe3_ª£t
(
pSñe˘
);

132803 *
pRC
 = 
rc
;

132806 *
pbFound
 = 1;

132808 
rc
 = 
	`sqlôe3_ª£t
(
pSñe˘
);

132810 
	`sqlôe3_ª£t
(
pSñe˘
);

132812 *
pRC
 = 
rc
;

132819 
	`·s3SegmítMîge
(
Fts3TabÀ
 *, , , );

132836 
	`·s3AŒoˇãSegdúIdx
(

132837 
Fts3TabÀ
 *
p
,

132838 
iL™gid
,

132839 
iIndex
,

132840 
iLevñ
,

132841 *
piIdx


132843 
rc
;

132844 
sqlôe3_°mt
 *
pNextIdx
;

132845 
iNext
 = 0;

132847 
	`as£π
–
iL™gid
>=0 );

132848 
	`as£π
–
p
->
nIndex
>=1 );

132851 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_NEXT_SEGMENT_INDEX
, &
pNextIdx
, 0);

132852 if–
rc
==
SQLITE_OK
 ){

132853 
	`sqlôe3_böd_öt64
(

132854 
pNextIdx
, 1, 
	`gëAbsﬁuãLevñ
(
p
, 
iL™gid
, 
iIndex
, 
iLevñ
)

132856 if–
SQLITE_ROW
==
	`sqlôe3_°ï
(
pNextIdx
) ){

132857 
iNext
 = 
	`sqlôe3_cﬁumn_öt
(
pNextIdx
, 0);

132859 
rc
 = 
	`sqlôe3_ª£t
(
pNextIdx
);

132862 if–
rc
==
SQLITE_OK
 ){

132868 if–
iNext
>=
FTS3_MERGE_COUNT
 ){

132869 
	`·s3LogMîge
(16, 
	`gëAbsﬁuãLevñ
(
p
, 
iL™gid
, 
iIndex
, 
iLevñ
));

132870 
rc
 = 
	`·s3SegmítMîge
(
p
, 
iL™gid
, 
iIndex
, 
iLevñ
);

132871 *
piIdx
 = 0;

132873 *
piIdx
 = 
iNext
;

132877  
rc
;

132907 
SQLITE_PRIVATE
 
	`sqlôe3Fts3RódBlock
(

132908 
Fts3TabÀ
 *
p
,

132909 
sqlôe3_öt64
 
iBlockid
,

132910 **
∑Blob
,

132911 *
≤Blob
,

132912 *
≤Lﬂd


132914 
rc
;

132917 
	`as£π
–
≤Blob
 );

132919 if–
p
->
pSegmíts
 ){

132920 
rc
 = 
	`sqlôe3_blob_ª›í
(
p
->
pSegmíts
, 
iBlockid
);

132922 if–0==
p
->
zSegmítsTbl
 ){

132923 
p
->
zSegmítsTbl
 = 
	`sqlôe3_m¥ötf
("%s_£gmíts",Ö->
zName
);

132924 if–0==
p
->
zSegmítsTbl
 )  
SQLITE_NOMEM
;

132926 
rc
 = 
	`sqlôe3_blob_›í
(

132927 
p
->
db
,Ö->
zDb
,Ö->
zSegmítsTbl
, "block", 
iBlockid
, 0, &p->
pSegmíts


132931 if–
rc
==
SQLITE_OK
 ){

132932 
nByã
 = 
	`sqlôe3_blob_byãs
(
p
->
pSegmíts
);

132933 *
≤Blob
 = 
nByã
;

132934 if–
∑Blob
 ){

132935 *
aByã
 = 
	`sqlôe3_mÆloc
(
nByã
 + 
FTS3_NODE_PADDING
);

132936 if–!
aByã
 ){

132937 
rc
 = 
SQLITE_NOMEM
;

132939 if–
≤Lﬂd
 && 
nByã
>(
FTS3_NODE_CHUNK_THRESHOLD
) ){

132940 
nByã
 = 
FTS3_NODE_CHUNKSIZE
;

132941 *
≤Lﬂd
 = 
nByã
;

132943 
rc
 = 
	`sqlôe3_blob_ªad
(
p
->
pSegmíts
, 
aByã
, 
nByã
, 0);

132944 
	`mem£t
(&
aByã
[
nByã
], 0, 
FTS3_NODE_PADDING
);

132945 if–
rc
!=
SQLITE_OK
 ){

132946 
	`sqlôe3_‰ì
(
aByã
);

132947 
aByã
 = 0;

132950 *
∑Blob
 = 
aByã
;

132954  
rc
;

132961 
SQLITE_PRIVATE
 
	`sqlôe3Fts3SegmítsClo£
(
Fts3TabÀ
 *
p
){

132962 
	`sqlôe3_blob_˛o£
(
p
->
pSegmíts
);

132963 
p
->
pSegmíts
 = 0;

132966 
	`·s3SegRódîIn¸Ród
(
Fts3SegRódî
 *
pRódî
){

132967 
nRód
;

132968 
rc
;

132970 
nRód
 = 
	`MIN
(
pRódî
->
nNode
 -ÖRódî->
nP›uœã
, 
FTS3_NODE_CHUNKSIZE
);

132971 
rc
 = 
	`sqlôe3_blob_ªad
(

132972 
pRódî
->
pBlob
,

132973 &
pRódî
->
aNode
[pRódî->
nP›uœã
],

132974 
nRód
,

132975 
pRódî
->
nP›uœã


132978 if–
rc
==
SQLITE_OK
 ){

132979 
pRódî
->
nP›uœã
 +
nRód
;

132980 
	`mem£t
(&
pRódî
->
aNode
[pRódî->
nP›uœã
], 0, 
FTS3_NODE_PADDING
);

132981 if–
pRódî
->
nP›uœã
=ıRódî->
nNode
 ){

132982 
	`sqlôe3_blob_˛o£
(
pRódî
->
pBlob
);

132983 
pRódî
->
pBlob
 = 0;

132984 
pRódî
->
nP›uœã
 = 0;

132987  
rc
;

132990 
	`·s3SegRódîRequúe
(
Fts3SegRódî
 *
pRódî
, *
pFrom
, 
nByã
){

132991 
rc
 = 
SQLITE_OK
;

132992 
	`as£π
–!
pRódî
->
pBlob


132993 || (
pFrom
>=
pRódî
->
aNode
 &&ÖFrom<&pRódî->aNode[pRódî->
nNode
])

132995  
pRódî
->
pBlob
 && 
rc
==
SQLITE_OK


132996 && (
pFrom
 - 
pRódî
->
aNode
 + 
nByã
)>pRódî->
nP›uœã


132998 
rc
 = 
	`·s3SegRódîIn¸Ród
(
pRódî
);

133000  
rc
;

133006 
	`·s3SegRódîSëEof
(
Fts3SegRódî
 *
pSeg
){

133007 if–!
	`·s3SegRódîIsRoŸO∆y
(
pSeg
) ){

133008 
	`sqlôe3_‰ì
(
pSeg
->
aNode
);

133009 
	`sqlôe3_blob_˛o£
(
pSeg
->
pBlob
);

133010 
pSeg
->
pBlob
 = 0;

133012 
pSeg
->
aNode
 = 0;

133020 
	`·s3SegRódîNext
(

133021 
Fts3TabÀ
 *
p
,

133022 
Fts3SegRódî
 *
pRódî
,

133023 
bIn¸


133025 
rc
;

133026 *
pNext
;

133027 
nPªfix
;

133028 
nSuffix
;

133030 if–!
pRódî
->
aDo˛i°
 ){

133031 
pNext
 = 
pRódî
->
aNode
;

133033 
pNext
 = &
pRódî
->
aDo˛i°
[pRódî->
nDo˛i°
];

133036 if–!
pNext
 ||ÖNext>=&
pRódî
->
aNode
[pRódî->
nNode
] ){

133038 if–
	`·s3SegRódîIsPídög
(
pRódî
) ){

133039 
Fts3HashEÀm
 *
pEÀm
 = *(
pRódî
->
µNextEÀm
);

133040 if–
pEÀm
==0 ){

133041 
pRódî
->
aNode
 = 0;

133043 
PídögLi°
 *
pLi°
 = (PídögLi° *)
	`·s3HashD©a
(
pEÀm
);

133044 
pRódî
->
zTîm
 = (*)
	`·s3HashKey
(
pEÀm
);

133045 
pRódî
->
nTîm
 = 
	`·s3HashKeysize
(
pEÀm
);

133046 
pRódî
->
nNode
 =ÖRódî->
nDo˛i°
 = 
pLi°
->
nD©a
 + 1;

133047 
pRódî
->
aNode
 =ÖRódî->
aDo˛i°
 = 
pLi°
->
aD©a
;

133048 
pRódî
->
µNextEÀm
++;

133049 
	`as£π
–
pRódî
->
aNode
 );

133051  
SQLITE_OK
;

133054 
	`·s3SegRódîSëEof
(
pRódî
);

133058 
	`as£π
–
pRódî
->
iCuºítBlock
<ıRódî->
iLófEndBlock
 );

133059 if–
pRódî
->
iCuºítBlock
>ıRódî->
iLófEndBlock
 ){

133060  
SQLITE_OK
;

133063 
rc
 = 
	`sqlôe3Fts3RódBlock
(

133064 
p
, ++
pRódî
->
iCuºítBlock
, &pRódî->
aNode
, &pRódî->
nNode
,

133065 (
bIn¸
 ? &
pRódî
->
nP›uœã
 : 0)

133067 if–
rc
!=
SQLITE_OK
 ) Ñc;

133068 
	`as£π
–
pRódî
->
pBlob
==0 );

133069 if–
bIn¸
 && 
pRódî
->
nP›uœã
<pRódî->
nNode
 ){

133070 
pRódî
->
pBlob
 = 
p
->
pSegmíts
;

133071 
p
->
pSegmíts
 = 0;

133073 
pNext
 = 
pRódî
->
aNode
;

133076 
	`as£π
–!
	`·s3SegRódîIsPídög
(
pRódî
) );

133078 
rc
 = 
	`·s3SegRódîRequúe
(
pRódî
, 
pNext
, 
FTS3_VARINT_MAX
*2);

133079 if–
rc
!=
SQLITE_OK
 ) Ñc;

133083 
pNext
 +
	`sqlôe3Fts3GëV¨öt32
’Next, &
nPªfix
);

133084 
pNext
 +
	`sqlôe3Fts3GëV¨öt32
’Next, &
nSuffix
);

133085 if–
nPªfix
<0 || 
nSuffix
<=0

133086 || &
pNext
[
nSuffix
]>&
pRódî
->
aNode
[pRódî->
nNode
]

133088  
FTS_CORRUPT_VTAB
;

133091 if–
nPªfix
+
nSuffix
>
pRódî
->
nTîmAŒoc
 ){

133092 
nNew
 = (
nPªfix
+
nSuffix
)*2;

133093 *
zNew
 = 
	`sqlôe3_ªÆloc
(
pRódî
->
zTîm
, 
nNew
);

133094 if–!
zNew
 ){

133095  
SQLITE_NOMEM
;

133097 
pRódî
->
zTîm
 = 
zNew
;

133098 
pRódî
->
nTîmAŒoc
 = 
nNew
;

133101 
rc
 = 
	`·s3SegRódîRequúe
(
pRódî
, 
pNext
, 
nSuffix
+
FTS3_VARINT_MAX
);

133102 if–
rc
!=
SQLITE_OK
 ) Ñc;

133104 
	`mem˝y
(&
pRódî
->
zTîm
[
nPªfix
], 
pNext
, 
nSuffix
);

133105 
pRódî
->
nTîm
 = 
nPªfix
+
nSuffix
;

133106 
pNext
 +
nSuffix
;

133107 
pNext
 +
	`sqlôe3Fts3GëV¨öt32
’Next, &
pRódî
->
nDo˛i°
);

133108 
pRódî
->
aDo˛i°
 = 
pNext
;

133109 
pRódî
->
pOff£tLi°
 = 0;

133115 if–&
pRódî
->
aDo˛i°
[pRódî->
nDo˛i°
]>&pRódî->
aNode
[pRódî->
nNode
]

133116 || (
pRódî
->
nP›uœã
==0 &&ÖRódî->
aDo˛i°
[pRódî->
nDo˛i°
-1])

133118  
FTS_CORRUPT_VTAB
;

133120  
SQLITE_OK
;

133127 
	`·s3SegRódîFú°Docid
(
Fts3TabÀ
 *
pTab
, 
Fts3SegRódî
 *
pRódî
){

133128 
rc
 = 
SQLITE_OK
;

133129 
	`as£π
–
pRódî
->
aDo˛i°
 );

133130 
	`as£π
–!
pRódî
->
pOff£tLi°
 );

133131 if–
pTab
->
bDescIdx
 && 
	`·s3SegRódîIsPídög
(
pRódî
) ){

133132 
u8
 
bEof
 = 0;

133133 
pRódî
->
iDocid
 = 0;

133134 
pRódî
->
nOff£tLi°
 = 0;

133135 
	`sqlôe3Fts3Do˛i°Pªv
(0,

133136 
pRódî
->
aDo˛i°
,ÖRódî->
nDo˛i°
, &pRódî->
pOff£tLi°
,

133137 &
pRódî
->
iDocid
, &pRódî->
nOff£tLi°
, &
bEof


133140 
rc
 = 
	`·s3SegRódîRequúe
(
pRódî
,ÖRódî->
aDo˛i°
, 
FTS3_VARINT_MAX
);

133141 if–
rc
==
SQLITE_OK
 ){

133142 
n
 = 
	`sqlôe3Fts3GëV¨öt
(
pRódî
->
aDo˛i°
, &pRódî->
iDocid
);

133143 
pRódî
->
pOff£tLi°
 = &pRódî->
aDo˛i°
[
n
];

133146  
rc
;

133159 
	`·s3SegRódîNextDocid
(

133160 
Fts3TabÀ
 *
pTab
,

133161 
Fts3SegRódî
 *
pRódî
,

133162 **
µOff£tLi°
,

133163 *
≤Off£tLi°


133165 
rc
 = 
SQLITE_OK
;

133166 *
p
 = 
pRódî
->
pOff£tLi°
;

133167 
c
 = 0;

133169 
	`as£π
–
p
 );

133171 if–
pTab
->
bDescIdx
 && 
	`·s3SegRódîIsPídög
(
pRódî
) ){

133175 
u8
 
bEof
 = 0;

133176 if–
µOff£tLi°
 ){

133177 *
µOff£tLi°
 = 
pRódî
->
pOff£tLi°
;

133178 *
≤Off£tLi°
 = 
pRódî
->
nOff£tLi°
 - 1;

133180 
	`sqlôe3Fts3Do˛i°Pªv
(0,

133181 
pRódî
->
aDo˛i°
,ÖRódî->
nDo˛i°
, &
p
, &pRódî->
iDocid
,

133182 &
pRódî
->
nOff£tLi°
, &
bEof


133184 if–
bEof
 ){

133185 
pRódî
->
pOff£tLi°
 = 0;

133187 
pRódî
->
pOff£tLi°
 = 
p
;

133190 *
pEnd
 = &
pRódî
->
aDo˛i°
[pRódî->
nDo˛i°
];

133203  *
p
 | 
c
 ) c = *p++ & 0x80;

133204 
	`as£π
–*
p
==0 );

133206 if–
pRódî
->
pBlob
==0 || 
p
<&pRódî->
aNode
[pRódî->
nP›uœã
] ) ;

133207 
rc
 = 
	`·s3SegRódîIn¸Ród
(
pRódî
);

133208 if–
rc
!=
SQLITE_OK
 ) Ñc;

133210 
p
++;

133215 if–
µOff£tLi°
 ){

133216 *
µOff£tLi°
 = 
pRódî
->
pOff£tLi°
;

133217 *
≤Off£tLi°
 = ()(
p
 - 
pRódî
->
pOff£tLi°
 - 1);

133221  
p
<
pEnd
 && *p==0 )Ö++;

133228 if–
p
>=
pEnd
 ){

133229 
pRódî
->
pOff£tLi°
 = 0;

133231 
rc
 = 
	`·s3SegRódîRequúe
(
pRódî
, 
p
, 
FTS3_VARINT_MAX
);

133232 if–
rc
==
SQLITE_OK
 ){

133233 
sqlôe3_öt64
 
iDñè
;

133234 
pRódî
->
pOff£tLi°
 = 
p
 + 
	`sqlôe3Fts3GëV¨öt
’, &
iDñè
);

133235 if–
pTab
->
bDescIdx
 ){

133236 
pRódî
->
iDocid
 -
iDñè
;

133238 
pRódî
->
iDocid
 +
iDñè
;

133244  
SQLITE_OK
;

133248 
SQLITE_PRIVATE
 
	`sqlôe3Fts3M§OvÊ
(

133249 
Fts3Curs‹
 *
pC§
,

133250 
Fts3Mu…iSegRódî
 *
pM§
,

133251 *
≤OvÊ


133253 
Fts3TabÀ
 *
p
 = (Fts3TabÀ*)
pC§
->
ba£
.
pVèb
;

133254 
nOvÊ
 = 0;

133255 
ii
;

133256 
rc
 = 
SQLITE_OK
;

133257 
pgsz
 = 
p
->
nPgsz
;

133259 
	`as£π
–
p
->
bFts4
 );

133260 
	`as£π
–
pgsz
>0 );

133262 
ii
=0; 
rc
==
SQLITE_OK
 && ii<
pM§
->
nSegmít
; ii++){

133263 
Fts3SegRódî
 *
pRódî
 = 
pM§
->
≠Segmít
[
ii
];

133264 if–!
	`·s3SegRódîIsPídög
(
pRódî
)

133265 && !
	`·s3SegRódîIsRoŸO∆y
(
pRódî
)

133267 
sqlôe3_öt64
 
jj
;

133268 
jj
=
pRódî
->
iSèπBlock
; jj<ıRódî->
iLófEndBlock
; jj++){

133269 
nBlob
;

133270 
rc
 = 
	`sqlôe3Fts3RódBlock
(
p
, 
jj
, 0, &
nBlob
, 0);

133271 if–
rc
!=
SQLITE_OK
 ) ;

133272 if–(
nBlob
+35)>
pgsz
 ){

133273 
nOvÊ
 +(
nBlob
 + 34)/
pgsz
;

133278 *
≤OvÊ
 = 
nOvÊ
;

133279  
rc
;

133286 
SQLITE_PRIVATE
 
	`sqlôe3Fts3SegRódîFªe
(
Fts3SegRódî
 *
pRódî
){

133287 if–
pRódî
 && !
	`·s3SegRódîIsPídög
(pReader) ){

133288 
	`sqlôe3_‰ì
(
pRódî
->
zTîm
);

133289 if–!
	`·s3SegRódîIsRoŸO∆y
(
pRódî
) ){

133290 
	`sqlôe3_‰ì
(
pRódî
->
aNode
);

133291 
	`sqlôe3_blob_˛o£
(
pRódî
->
pBlob
);

133294 
	`sqlôe3_‰ì
(
pRódî
);

133300 
SQLITE_PRIVATE
 
	`sqlôe3Fts3SegRódîNew
(

133301 
iAge
,

133302 
bLookup
,

133303 
sqlôe3_öt64
 
iSèπLóf
,

133304 
sqlôe3_öt64
 
iEndLóf
,

133305 
sqlôe3_öt64
 
iEndBlock
,

133306 c⁄° *
zRoŸ
,

133307 
nRoŸ
,

133308 
Fts3SegRódî
 **
µRódî


133310 
Fts3SegRódî
 *
pRódî
;

133311 
nExåa
 = 0;

133313 
	`as£π
–
iSèπLóf
<=
iEndLóf
 );

133314 if–
iSèπLóf
==0 ){

133315 
nExåa
 = 
nRoŸ
 + 
FTS3_NODE_PADDING
;

133318 
pRódî
 = (
Fts3SegRódî
 *)
	`sqlôe3_mÆloc
((Fts3SegRódîË+ 
nExåa
);

133319 if–!
pRódî
 ){

133320  
SQLITE_NOMEM
;

133322 
	`mem£t
(
pRódî
, 0, (
Fts3SegRódî
));

133323 
pRódî
->
iIdx
 = 
iAge
;

133324 
pRódî
->
bLookup
 = bLookup!=0;

133325 
pRódî
->
iSèπBlock
 = 
iSèπLóf
;

133326 
pRódî
->
iLófEndBlock
 = 
iEndLóf
;

133327 
pRódî
->
iEndBlock
 = iEndBlock;

133329 if–
nExåa
 ){

133331 
pRódî
->
aNode
 = (*)&pReader[1];

133332 
pRódî
->
roŸO∆y
 = 1;

133333 
pRódî
->
nNode
 = 
nRoŸ
;

133334 
	`mem˝y
(
pRódî
->
aNode
, 
zRoŸ
, 
nRoŸ
);

133335 
	`mem£t
(&
pRódî
->
aNode
[
nRoŸ
], 0, 
FTS3_NODE_PADDING
);

133337 
pRódî
->
iCuºítBlock
 = 
iSèπLóf
-1;

133339 *
µRódî
 = 
pRódî
;

133340  
SQLITE_OK
;

133348 
	`·s3Com∑ªEÀmByTîm
(c⁄° *
lhs
, c⁄° *
rhs
){

133349 *
z1
 = 
	`·s3HashKey
(*(
Fts3HashEÀm
 **)
lhs
);

133350 *
z2
 = 
	`·s3HashKey
(*(
Fts3HashEÀm
 **)
rhs
);

133351 
n1
 = 
	`·s3HashKeysize
(*(
Fts3HashEÀm
 **)
lhs
);

133352 
n2
 = 
	`·s3HashKeysize
(*(
Fts3HashEÀm
 **)
rhs
);

133354 
n
 = (
n1
<
n2
 ?Ç1 :Ç2);

133355 
c
 = 
	`memcmp
(
z1
, 
z2
, 
n
);

133356 if–
c
==0 ){

133357 
c
 = 
n1
 - 
n2
;

133359  
c
;

133381 
SQLITE_PRIVATE
 
	`sqlôe3Fts3SegRódîPídög
(

133382 
Fts3TabÀ
 *
p
,

133383 
iIndex
,

133384 c⁄° *
zTîm
,

133385 
nTîm
,

133386 
bPªfix
,

133387 
Fts3SegRódî
 **
µRódî


133389 
Fts3SegRódî
 *
pRódî
 = 0;

133390 
Fts3HashEÀm
 *
pE
;

133391 
Fts3HashEÀm
 **
aEÀm
 = 0;

133392 
nEÀm
 = 0;

133393 
rc
 = 
SQLITE_OK
;

133394 
Fts3Hash
 *
pHash
;

133396 
pHash
 = &
p
->
aIndex
[
iIndex
].
hPídög
;

133397 if–
bPªfix
 ){

133398 
nAŒoc
 = 0;

133400 
pE
=
	`·s3HashFú°
(
pHash
);ÖE;ÖE=
	`·s3HashNext
(pE)){

133401 *
zKey
 = (*)
	`·s3HashKey
(
pE
);

133402 
nKey
 = 
	`·s3HashKeysize
(
pE
);

133403 if–
nTîm
==0 || (
nKey
>ÚTîm && 0==
	`memcmp
(
zKey
, 
zTîm
,ÇTerm)) ){

133404 if–
nEÀm
==
nAŒoc
 ){

133405 
Fts3HashEÀm
 **
aEÀm2
;

133406 
nAŒoc
 += 16;

133407 
aEÀm2
 = (
Fts3HashEÀm
 **)
	`sqlôe3_ªÆloc
(

133408 
aEÀm
, 
nAŒoc
*(
Fts3HashEÀm
 *)

133410 if–!
aEÀm2
 ){

133411 
rc
 = 
SQLITE_NOMEM
;

133412 
nEÀm
 = 0;

133415 
aEÀm
 = 
aEÀm2
;

133418 
aEÀm
[
nEÀm
++] = 
pE
;

133426 if–
nEÀm
>1 ){

133427 
	`qs‹t
(
aEÀm
, 
nEÀm
, (
Fts3HashEÀm
 *), 
·s3Com∑ªEÀmByTîm
);

133438 
pE
 = 
	`·s3HashFödEÀm
(
pHash
, 
zTîm
, 
nTîm
);

133439 if–
pE
 ){

133440 
aEÀm
 = &
pE
;

133441 
nEÀm
 = 1;

133445 if–
nEÀm
>0 ){

133446 
nByã
 = (
Fts3SegRódî
Ë+ (
nEÀm
+1)*(
Fts3HashEÀm
 *);

133447 
pRódî
 = (
Fts3SegRódî
 *)
	`sqlôe3_mÆloc
(
nByã
);

133448 if–!
pRódî
 ){

133449 
rc
 = 
SQLITE_NOMEM
;

133451 
	`mem£t
(
pRódî
, 0, 
nByã
);

133452 
pRódî
->
iIdx
 = 0x7FFFFFFF;

133453 
pRódî
->
µNextEÀm
 = (
Fts3HashEÀm
 **)&pReader[1];

133454 
	`mem˝y
(
pRódî
->
µNextEÀm
, 
aEÀm
, 
nEÀm
*(
Fts3HashEÀm
 *));

133458 if–
bPªfix
 ){

133459 
	`sqlôe3_‰ì
(
aEÀm
);

133461 *
µRódî
 = 
pRódî
;

133462  
rc
;

133477 
	`·s3SegRódîCmp
(
Fts3SegRódî
 *
pLhs
, Fts3SegRódî *
pRhs
){

133478 
rc
;

133479 if–
pLhs
->
aNode
 && 
pRhs
->aNode ){

133480 
rc2
 = 
pLhs
->
nTîm
 - 
pRhs
->nTerm;

133481 if–
rc2
<0 ){

133482 
rc
 = 
	`memcmp
(
pLhs
->
zTîm
, 
pRhs
->zTîm,ÖLhs->
nTîm
);

133484 
rc
 = 
	`memcmp
(
pLhs
->
zTîm
, 
pRhs
->zTîm,ÖRhs->
nTîm
);

133486 if–
rc
==0 ){

133487 
rc
 = 
rc2
;

133490 
rc
 = (
pLhs
->
aNode
==0Ë- (
pRhs
->aNode==0);

133492 if–
rc
==0 ){

133493 
rc
 = 
pRhs
->
iIdx
 - 
pLhs
->iIdx;

133495 
	`as£π
–
rc
!=0 );

133496  
rc
;

133510 
	`·s3SegRódîDo˛i°Cmp
(
Fts3SegRódî
 *
pLhs
, Fts3SegRódî *
pRhs
){

133511 
rc
 = (
pLhs
->
pOff£tLi°
==0)-(
pRhs
->pOffsetList==0);

133512 if–
rc
==0 ){

133513 if–
pLhs
->
iDocid
==
pRhs
->iDocid ){

133514 
rc
 = 
pRhs
->
iIdx
 - 
pLhs
->iIdx;

133516 
rc
 = (
pLhs
->
iDocid
 > 
pRhs
->iDocid) ? 1 : -1;

133519 
	`as£π
–
pLhs
->
aNode
 && 
pRhs
->aNode );

133520  
rc
;

133522 
	`·s3SegRódîDo˛i°CmpRev
(
Fts3SegRódî
 *
pLhs
, Fts3SegRódî *
pRhs
){

133523 
rc
 = (
pLhs
->
pOff£tLi°
==0)-(
pRhs
->pOffsetList==0);

133524 if–
rc
==0 ){

133525 if–
pLhs
->
iDocid
==
pRhs
->iDocid ){

133526 
rc
 = 
pRhs
->
iIdx
 - 
pLhs
->iIdx;

133528 
rc
 = (
pLhs
->
iDocid
 < 
pRhs
->iDocid) ? 1 : -1;

133531 
	`as£π
–
pLhs
->
aNode
 && 
pRhs
->aNode );

133532  
rc
;

133543 
	`·s3SegRódîTîmCmp
(

133544 
Fts3SegRódî
 *
pSeg
,

133545 c⁄° *
zTîm
,

133546 
nTîm


133548 
ªs
 = 0;

133549 if–
pSeg
->
aNode
 ){

133550 if–
pSeg
->
nTîm
>nTerm ){

133551 
ªs
 = 
	`memcmp
(
pSeg
->
zTîm
, zTîm, 
nTîm
);

133553 
ªs
 = 
	`memcmp
(
pSeg
->
zTîm
, zTîm,ÖSeg->
nTîm
);

133555 if–
ªs
==0 ){

133556 
ªs
 = 
pSeg
->
nTîm
-nTerm;

133559  
ªs
;

133568 
	`·s3SegRódîS‹t
(

133569 
Fts3SegRódî
 **
≠Segmít
,

133570 
nSegmít
,

133571 
nSu•e˘
,

133572 (*
xCmp
)(
Fts3SegRódî
 *, Fts3SegReader *)

133574 
i
;

133576 
	`as£π
–
nSu•e˘
<=
nSegmít
 );

133578 if–
nSu•e˘
==
nSegmít
 )ÇSuspect--;

133579 
i
=
nSu•e˘
-1; i>=0; i--){

133580 
j
;

133581 
j
=
i
; j<(
nSegmít
-1); j++){

133582 
Fts3SegRódî
 *
pTmp
;

133583 if–
	`xCmp
(
≠Segmít
[
j
],ápSegment[j+1])<0 ) ;

133584 
pTmp
 = 
≠Segmít
[
j
+1];

133585 
≠Segmít
[
j
+1] =ápSegment[j];

133586 
≠Segmít
[
j
] = 
pTmp
;

133590 #i‚de‡
NDEBUG


133592 
i
=0; i<(
nSu•e˘
-1); i++){

133593 
	`as£π
–
	`xCmp
(
≠Segmít
[
i
],ápSegment[i+1])<0 );

133601 
	`·s3WrôeSegmít
(

133602 
Fts3TabÀ
 *
p
,

133603 
sqlôe3_öt64
 
iBlock
,

133604 *
z
,

133605 
n


133607 
sqlôe3_°mt
 *
pStmt
;

133608 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_INSERT_SEGMENTS
, &
pStmt
, 0);

133609 if–
rc
==
SQLITE_OK
 ){

133610 
	`sqlôe3_böd_öt64
(
pStmt
, 1, 
iBlock
);

133611 
	`sqlôe3_böd_blob
(
pStmt
, 2, 
z
, 
n
, 
SQLITE_STATIC
);

133612 
	`sqlôe3_°ï
(
pStmt
);

133613 
rc
 = 
	`sqlôe3_ª£t
(
pStmt
);

133615  
rc
;

133623 
SQLITE_PRIVATE
 
	`sqlôe3Fts3MaxLevñ
(
Fts3TabÀ
 *
p
, *
≤Max
){

133624 
rc
;

133625 
mxLevñ
 = 0;

133626 
sqlôe3_°mt
 *
pStmt
 = 0;

133628 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_SELECT_MXLEVEL
, &
pStmt
, 0);

133629 if–
rc
==
SQLITE_OK
 ){

133630 if–
SQLITE_ROW
==
	`sqlôe3_°ï
(
pStmt
) ){

133631 
mxLevñ
 = 
	`sqlôe3_cﬁumn_öt
(
pStmt
, 0);

133633 
rc
 = 
	`sqlôe3_ª£t
(
pStmt
);

133635 *
≤Max
 = 
mxLevñ
;

133636  
rc
;

133642 
	`·s3WrôeSegdú
(

133643 
Fts3TabÀ
 *
p
,

133644 
sqlôe3_öt64
 
iLevñ
,

133645 
iIdx
,

133646 
sqlôe3_öt64
 
iSèπBlock
,

133647 
sqlôe3_öt64
 
iLófEndBlock
,

133648 
sqlôe3_öt64
 
iEndBlock
,

133649 *
zRoŸ
,

133650 
nRoŸ


133652 
sqlôe3_°mt
 *
pStmt
;

133653 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_INSERT_SEGDIR
, &
pStmt
, 0);

133654 if–
rc
==
SQLITE_OK
 ){

133655 
	`sqlôe3_böd_öt64
(
pStmt
, 1, 
iLevñ
);

133656 
	`sqlôe3_böd_öt
(
pStmt
, 2, 
iIdx
);

133657 
	`sqlôe3_böd_öt64
(
pStmt
, 3, 
iSèπBlock
);

133658 
	`sqlôe3_böd_öt64
(
pStmt
, 4, 
iLófEndBlock
);

133659 
	`sqlôe3_böd_öt64
(
pStmt
, 5, 
iEndBlock
);

133660 
	`sqlôe3_böd_blob
(
pStmt
, 6, 
zRoŸ
, 
nRoŸ
, 
SQLITE_STATIC
);

133661 
	`sqlôe3_°ï
(
pStmt
);

133662 
rc
 = 
	`sqlôe3_ª£t
(
pStmt
);

133664  
rc
;

133675 
	`·s3PªfixCom¥ess
(

133676 c⁄° *
zPªv
,

133677 
nPªv
,

133678 c⁄° *
zNext
,

133679 
nNext


133681 
n
;

133682 
	`UNUSED_PARAMETER
(
nNext
);

133683 
n
=0;Ç<
nPªv
 && 
zPªv
[n]==
zNext
[n];Ç++);

133684  
n
;

133691 
	`·s3NodeAddTîm
(

133692 
Fts3TabÀ
 *
p
,

133693 
SegmítNode
 **
µTªe
,

133694 
isC›yTîm
,

133695 c⁄° *
zTîm
,

133696 
nTîm


133698 
SegmítNode
 *
pTªe
 = *
µTªe
;

133699 
rc
;

133700 
SegmítNode
 *
pNew
;

133705 if–
pTªe
 ){

133706 
nD©a
 = 
pTªe
->nData;

133707 
nReq
 = 
nD©a
;

133708 
nPªfix
;

133709 
nSuffix
;

133711 
nPªfix
 = 
	`·s3PªfixCom¥ess
(
pTªe
->
zTîm
,ÖTªe->
nTîm
, zTerm,ÇTerm);

133712 
nSuffix
 = 
nTîm
-
nPªfix
;

133714 
nReq
 +
	`sqlôe3Fts3V¨ötLí
(
nPªfix
)+sqlôe3Fts3V¨ötLí(
nSuffix
)+nSuffix;

133715 if–
nReq
<=
p
->
nNodeSize
 || !
pTªe
->
zTîm
 ){

133717 if–
nReq
>
p
->
nNodeSize
 ){

133725 
	`as£π
–
pTªe
->
aD©a
==(*)&pTree[1] );

133726 
pTªe
->
aD©a
 = (*)
	`sqlôe3_mÆloc
(
nReq
);

133727 if–!
pTªe
->
aD©a
 ){

133728  
SQLITE_NOMEM
;

133732 if–
pTªe
->
zTîm
 ){

133734 
nD©a
 +
	`sqlôe3Fts3PutV¨öt
(&
pTªe
->
aD©a
[nD©a], 
nPªfix
);

133737 
nD©a
 +
	`sqlôe3Fts3PutV¨öt
(&
pTªe
->
aD©a
[nD©a], 
nSuffix
);

133738 
	`mem˝y
(&
pTªe
->
aD©a
[
nD©a
], &
zTîm
[
nPªfix
], 
nSuffix
);

133739 
pTªe
->
nD©a
 =ÇD©®+ 
nSuffix
;

133740 
pTªe
->
nE¡ry
++;

133742 if–
isC›yTîm
 ){

133743 if–
pTªe
->
nMÆloc
<
nTîm
 ){

133744 *
zNew
 = 
	`sqlôe3_ªÆloc
(
pTªe
->
zMÆloc
, 
nTîm
*2);

133745 if–!
zNew
 ){

133746  
SQLITE_NOMEM
;

133748 
pTªe
->
nMÆloc
 = 
nTîm
*2;

133749 
pTªe
->
zMÆloc
 = 
zNew
;

133751 
pTªe
->
zTîm
 =ÖTªe->
zMÆloc
;

133752 
	`mem˝y
(
pTªe
->
zTîm
, zTîm, 
nTîm
);

133753 
pTªe
->
nTîm
 =ÇTerm;

133755 
pTªe
->
zTîm
 = (*)zTerm;

133756 
pTªe
->
nTîm
 =ÇTerm;

133758  
SQLITE_OK
;

133770 
pNew
 = (
SegmítNode
 *)
	`sqlôe3_mÆloc
((SegmítNodeË+ 
p
->
nNodeSize
);

133771 if–!
pNew
 ){

133772  
SQLITE_NOMEM
;

133774 
	`mem£t
(
pNew
, 0, (
SegmítNode
));

133775 
pNew
->
nD©a
 = 1 + 
FTS3_VARINT_MAX
;

133776 
pNew
->
aD©a
 = (*)&pNew[1];

133778 if–
pTªe
 ){

133779 
SegmítNode
 *
pP¨ít
 = 
pTªe
->pParent;

133780 
rc
 = 
	`·s3NodeAddTîm
(
p
, &
pP¨ít
, 
isC›yTîm
, 
zTîm
, 
nTîm
);

133781 if–
pTªe
->
pP¨ít
==0 ){

133782 
pTªe
->
pP¨ít
 =ÖParent;

133784 
pTªe
->
pRight
 = 
pNew
;

133785 
pNew
->
pLe·mo°
 = 
pTªe
->pLeftmost;

133786 
pNew
->
pP¨ít
 =ÖParent;

133787 
pNew
->
zMÆloc
 = 
pTªe
->zMalloc;

133788 
pNew
->
nMÆloc
 = 
pTªe
->nMalloc;

133789 
pTªe
->
zMÆloc
 = 0;

133791 
pNew
->
pLe·mo°
 =ÖNew;

133792 
rc
 = 
	`·s3NodeAddTîm
(
p
, &
pNew
, 
isC›yTîm
, 
zTîm
, 
nTîm
);

133795 *
µTªe
 = 
pNew
;

133796  
rc
;

133802 
	`·s3TªeFöishNode
(

133803 
SegmítNode
 *
pTªe
,

133804 
iHeight
,

133805 
sqlôe3_öt64
 
iLe·Chûd


133807 
nSèπ
;

133808 
	`as£π
–
iHeight
>=1 && iHeight<128 );

133809 
nSèπ
 = 
FTS3_VARINT_MAX
 - 
	`sqlôe3Fts3V¨ötLí
(
iLe·Chûd
);

133810 
pTªe
->
aD©a
[
nSèπ
] = ()
iHeight
;

133811 
	`sqlôe3Fts3PutV¨öt
(&
pTªe
->
aD©a
[
nSèπ
+1], 
iLe·Chûd
);

133812  
nSèπ
;

133828 
	`·s3NodeWrôe
(

133829 
Fts3TabÀ
 *
p
,

133830 
SegmítNode
 *
pTªe
,

133831 
iHeight
,

133832 
sqlôe3_öt64
 
iLóf
,

133833 
sqlôe3_öt64
 
iFªe
,

133834 
sqlôe3_öt64
 *
piLa°
,

133835 **
∑RoŸ
,

133836 *
≤RoŸ


133838 
rc
 = 
SQLITE_OK
;

133840 if–!
pTªe
->
pP¨ít
 ){

133842 
nSèπ
 = 
	`·s3TªeFöishNode
(
pTªe
, 
iHeight
, 
iLóf
);

133843 *
piLa°
 = 
iFªe
-1;

133844 *
≤RoŸ
 = 
pTªe
->
nD©a
 - 
nSèπ
;

133845 *
∑RoŸ
 = &
pTªe
->
aD©a
[
nSèπ
];

133847 
SegmítNode
 *
pIãr
;

133848 
sqlôe3_öt64
 
iNextFªe
 = 
iFªe
;

133849 
sqlôe3_öt64
 
iNextLóf
 = 
iLóf
;

133850 
pIãr
=
pTªe
->
pLe·mo°
;ÖIã∏&& 
rc
==
SQLITE_OK
;ÖIãrıIãr->
pRight
){

133851 
nSèπ
 = 
	`·s3TªeFöishNode
(
pIãr
, 
iHeight
, 
iNextLóf
);

133852 
nWrôe
 = 
pIãr
->
nD©a
 - 
nSèπ
;

133854 
rc
 = 
	`·s3WrôeSegmít
(
p
, 
iNextFªe
, &
pIãr
->
aD©a
[
nSèπ
], 
nWrôe
);

133855 
iNextFªe
++;

133856 
iNextLóf
 +(
pIãr
->
nE¡ry
+1);

133858 if–
rc
==
SQLITE_OK
 ){

133859 
	`as£π
–
iNextLóf
==
iFªe
 );

133860 
rc
 = 
	`·s3NodeWrôe
(

133861 
p
, 
pTªe
->
pP¨ít
, 
iHeight
+1, 
iFªe
, 
iNextFªe
, 
piLa°
, 
∑RoŸ
, 
≤RoŸ


133866  
rc
;

133872 
	`·s3NodeFªe
(
SegmítNode
 *
pTªe
){

133873 if–
pTªe
 ){

133874 
SegmítNode
 *
p
 = 
pTªe
->
pLe·mo°
;

133875 
	`·s3NodeFªe
(
p
->
pP¨ít
);

133876  
p
 ){

133877 
SegmítNode
 *
pRight
 = 
p
->pRight;

133878 if–
p
->
aD©a
!=(*)&p[1] ){

133879 
	`sqlôe3_‰ì
(
p
->
aD©a
);

133881 
	`as£π
–
pRight
==0 || 
p
->
zMÆloc
==0 );

133882 
	`sqlôe3_‰ì
(
p
->
zMÆloc
);

133883 
	`sqlôe3_‰ì
(
p
);

133884 
p
 = 
pRight
;

133897 
	`·s3SegWrôîAdd
(

133898 
Fts3TabÀ
 *
p
,

133899 
SegmítWrôî
 **
µWrôî
,

133900 
isC›yTîm
,

133901 c⁄° *
zTîm
,

133902 
nTîm
,

133903 c⁄° *
aDo˛i°
,

133904 
nDo˛i°


133906 
nPªfix
;

133907 
nSuffix
;

133908 
nReq
;

133909 
nD©a
;

133910 
SegmítWrôî
 *
pWrôî
 = *
µWrôî
;

133912 if–!
pWrôî
 ){

133913 
rc
;

133914 
sqlôe3_°mt
 *
pStmt
;

133917 
pWrôî
 = (
SegmítWrôî
 *)
	`sqlôe3_mÆloc
((SegmentWriter));

133918 if–!
pWrôî
 )  
SQLITE_NOMEM
;

133919 
	`mem£t
(
pWrôî
, 0, (
SegmítWrôî
));

133920 *
µWrôî
 = 
pWrôî
;

133923 
pWrôî
->
aD©a
 = (*)
	`sqlôe3_mÆloc
(
p
->
nNodeSize
);

133924 if–!
pWrôî
->
aD©a
 )  
SQLITE_NOMEM
;

133925 
pWrôî
->
nSize
 = 
p
->
nNodeSize
;

133928 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_NEXT_SEGMENTS_ID
, &
pStmt
, 0);

133929 if–
rc
!=
SQLITE_OK
 ) Ñc;

133930 if–
SQLITE_ROW
==
	`sqlôe3_°ï
(
pStmt
) ){

133931 
pWrôî
->
iFªe
 = 
	`sqlôe3_cﬁumn_öt64
(
pStmt
, 0);

133932 
pWrôî
->
iFú°
 =ÖWrôî->
iFªe
;

133934 
rc
 = 
	`sqlôe3_ª£t
(
pStmt
);

133935 if–
rc
!=
SQLITE_OK
 ) Ñc;

133937 
nD©a
 = 
pWrôî
->nData;

133939 
nPªfix
 = 
	`·s3PªfixCom¥ess
(
pWrôî
->
zTîm
,ÖWrôî->
nTîm
, zTerm,ÇTerm);

133940 
nSuffix
 = 
nTîm
-
nPªfix
;

133943 
nReq
 = 
	`sqlôe3Fts3V¨ötLí
(
nPªfix
) +

133944 
	`sqlôe3Fts3V¨ötLí
(
nSuffix
) +

133945 
nSuffix
 +

133946 
	`sqlôe3Fts3V¨ötLí
(
nDo˛i°
) +

133947 
nDo˛i°
;

133949 if–
nD©a
>0 &&ÇD©a+
nReq
>
p
->
nNodeSize
 ){

133950 
rc
;

133953 
rc
 = 
	`·s3WrôeSegmít
(
p
, 
pWrôî
->
iFªe
++,ÖWrôî->
aD©a
, 
nD©a
);

133954 if–
rc
!=
SQLITE_OK
 ) Ñc;

133955 
p
->
nLófAdd
++;

133969 
	`as£π
–
nPªfix
<
nTîm
 );

133970 
rc
 = 
	`·s3NodeAddTîm
(
p
, &
pWrôî
->
pTªe
, 
isC›yTîm
, 
zTîm
, 
nPªfix
+1);

133971 if–
rc
!=
SQLITE_OK
 ) Ñc;

133973 
nD©a
 = 0;

133974 
pWrôî
->
nTîm
 = 0;

133976 
nPªfix
 = 0;

133977 
nSuffix
 = 
nTîm
;

133978 
nReq
 = 1 +

133979 
	`sqlôe3Fts3V¨ötLí
(
nTîm
) +

133980 
nTîm
 +

133981 
	`sqlôe3Fts3V¨ötLí
(
nDo˛i°
) +

133982 
nDo˛i°
;

133988 if–
nReq
>
pWrôî
->
nSize
 ){

133989 *
aNew
 = 
	`sqlôe3_ªÆloc
(
pWrôî
->
aD©a
, 
nReq
);

133990 if–!
aNew
 )  
SQLITE_NOMEM
;

133991 
pWrôî
->
aD©a
 = 
aNew
;

133992 
pWrôî
->
nSize
 = 
nReq
;

133994 
	`as£π
–
nD©a
+
nReq
<=
pWrôî
->
nSize
 );

133997 
nD©a
 +
	`sqlôe3Fts3PutV¨öt
(&
pWrôî
->
aD©a
[nD©a], 
nPªfix
);

133998 
nD©a
 +
	`sqlôe3Fts3PutV¨öt
(&
pWrôî
->
aD©a
[nD©a], 
nSuffix
);

133999 
	`mem˝y
(&
pWrôî
->
aD©a
[
nD©a
], &
zTîm
[
nPªfix
], 
nSuffix
);

134000 
nD©a
 +
nSuffix
;

134001 
nD©a
 +
	`sqlôe3Fts3PutV¨öt
(&
pWrôî
->
aD©a
[nD©a], 
nDo˛i°
);

134002 
	`mem˝y
(&
pWrôî
->
aD©a
[
nD©a
], 
aDo˛i°
, 
nDo˛i°
);

134003 
pWrôî
->
nD©a
 =ÇD©®+ 
nDo˛i°
;

134010 if–
isC›yTîm
 ){

134011 if–
nTîm
>
pWrôî
->
nMÆloc
 ){

134012 *
zNew
 = 
	`sqlôe3_ªÆloc
(
pWrôî
->
zMÆloc
, 
nTîm
*2);

134013 if–!
zNew
 ){

134014  
SQLITE_NOMEM
;

134016 
pWrôî
->
nMÆloc
 = 
nTîm
*2;

134017 
pWrôî
->
zMÆloc
 = 
zNew
;

134018 
pWrôî
->
zTîm
 = 
zNew
;

134020 
	`as£π
–
pWrôî
->
zTîm
=ıWrôî->
zMÆloc
 );

134021 
	`mem˝y
(
pWrôî
->
zTîm
, zTîm, 
nTîm
);

134023 
pWrôî
->
zTîm
 = (*)zTerm;

134025 
pWrôî
->
nTîm
 =ÇTerm;

134027  
SQLITE_OK
;

134036 
	`·s3SegWrôîFlush
(

134037 
Fts3TabÀ
 *
p
,

134038 
SegmítWrôî
 *
pWrôî
,

134039 
sqlôe3_öt64
 
iLevñ
,

134040 
iIdx


134042 
rc
;

134043 if–
pWrôî
->
pTªe
 ){

134044 
sqlôe3_öt64
 
iLa°
 = 0;

134045 
sqlôe3_öt64
 
iLa°Lóf
;

134046 *
zRoŸ
 = 
NULL
;

134047 
nRoŸ
 = 0;

134049 
iLa°Lóf
 = 
pWrôî
->
iFªe
;

134050 
rc
 = 
	`·s3WrôeSegmít
(
p
, 
pWrôî
->
iFªe
++,ÖWrôî->
aD©a
,ÖWrôî->
nD©a
);

134051 if–
rc
==
SQLITE_OK
 ){

134052 
rc
 = 
	`·s3NodeWrôe
(
p
, 
pWrôî
->
pTªe
, 1,

134053 
pWrôî
->
iFú°
,ÖWrôî->
iFªe
, &
iLa°
, &
zRoŸ
, &
nRoŸ
);

134055 if–
rc
==
SQLITE_OK
 ){

134056 
rc
 = 
	`·s3WrôeSegdú
(

134057 
p
, 
iLevñ
, 
iIdx
, 
pWrôî
->
iFú°
, 
iLa°Lóf
, 
iLa°
, 
zRoŸ
, 
nRoŸ
);

134061 
rc
 = 
	`·s3WrôeSegdú
(

134062 
p
, 
iLevñ
, 
iIdx
, 0, 0, 0, 
pWrôî
->
aD©a
,ÖWrôî->
nD©a
);

134064 
p
->
nLófAdd
++;

134065  
rc
;

134072 
	`·s3SegWrôîFªe
(
SegmítWrôî
 *
pWrôî
){

134073 if–
pWrôî
 ){

134074 
	`sqlôe3_‰ì
(
pWrôî
->
aD©a
);

134075 
	`sqlôe3_‰ì
(
pWrôî
->
zMÆloc
);

134076 
	`·s3NodeFªe
(
pWrôî
->
pTªe
);

134077 
	`sqlôe3_‰ì
(
pWrôî
);

134091 
	`·s3IsEm±y
(
Fts3TabÀ
 *
p
, 
sqlôe3_vÆue
 *
pRowid
, *
pisEm±y
){

134092 
sqlôe3_°mt
 *
pStmt
;

134093 
rc
;

134094 if–
p
->
zC⁄ã¡Tbl
 ){

134096 *
pisEm±y
 = 0;

134097 
rc
 = 
SQLITE_OK
;

134099 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_IS_EMPTY
, &
pStmt
, &
pRowid
);

134100 if–
rc
==
SQLITE_OK
 ){

134101 if–
SQLITE_ROW
==
	`sqlôe3_°ï
(
pStmt
) ){

134102 *
pisEm±y
 = 
	`sqlôe3_cﬁumn_öt
(
pStmt
, 0);

134104 
rc
 = 
	`sqlôe3_ª£t
(
pStmt
);

134107  
rc
;

134118 
	`·s3SegmítMaxLevñ
(

134119 
Fts3TabÀ
 *
p
,

134120 
iL™gid
,

134121 
iIndex
,

134122 
sqlôe3_öt64
 *
≤Max


134124 
sqlôe3_°mt
 *
pStmt
;

134125 
rc
;

134126 
	`as£π
–
iIndex
>=0 && iIndex<
p
->
nIndex
 );

134134 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_SELECT_SEGDIR_MAX_LEVEL
, &
pStmt
, 0);

134135 if–
rc
!=
SQLITE_OK
 ) Ñc;

134136 
	`sqlôe3_böd_öt64
(
pStmt
, 1, 
	`gëAbsﬁuãLevñ
(
p
, 
iL™gid
, 
iIndex
, 0));

134137 
	`sqlôe3_böd_öt64
(
pStmt
, 2,

134138 
	`gëAbsﬁuãLevñ
(
p
, 
iL™gid
, 
iIndex
, 
FTS3_SEGDIR_MAXLEVEL
-1)

134140 if–
SQLITE_ROW
==
	`sqlôe3_°ï
(
pStmt
) ){

134141 *
≤Max
 = 
	`sqlôe3_cﬁumn_öt64
(
pStmt
, 0);

134143  
	`sqlôe3_ª£t
(
pStmt
);

134151 
	`·s3DñëeSegmít
(

134152 
Fts3TabÀ
 *
p
,

134153 
Fts3SegRódî
 *
pSeg


134155 
rc
 = 
SQLITE_OK
;

134156 if–
pSeg
->
iSèπBlock
 ){

134157 
sqlôe3_°mt
 *
pDñëe
;

134158 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_DELETE_SEGMENTS_RANGE
, &
pDñëe
, 0);

134159 if–
rc
==
SQLITE_OK
 ){

134160 
	`sqlôe3_böd_öt64
(
pDñëe
, 1, 
pSeg
->
iSèπBlock
);

134161 
	`sqlôe3_böd_öt64
(
pDñëe
, 2, 
pSeg
->
iEndBlock
);

134162 
	`sqlôe3_°ï
(
pDñëe
);

134163 
rc
 = 
	`sqlôe3_ª£t
(
pDñëe
);

134166  
rc
;

134183 
	`·s3DñëeSegdú
(

134184 
Fts3TabÀ
 *
p
,

134185 
iL™gid
,

134186 
iIndex
,

134187 
iLevñ
,

134188 
Fts3SegRódî
 **
≠Segmít
,

134189 
nRódî


134191 
rc
 = 
SQLITE_OK
;

134192 
i
;

134193 
sqlôe3_°mt
 *
pDñëe
 = 0;

134195 
i
=0; 
rc
==
SQLITE_OK
 && i<
nRódî
; i++){

134196 
rc
 = 
	`·s3DñëeSegmít
(
p
, 
≠Segmít
[
i
]);

134198 if–
rc
!=
SQLITE_OK
 ){

134199  
rc
;

134202 
	`as£π
–
iLevñ
>=0 || iLevñ==
FTS3_SEGCURSOR_ALL
 );

134203 if–
iLevñ
==
FTS3_SEGCURSOR_ALL
 ){

134204 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_DELETE_SEGDIR_RANGE
, &
pDñëe
, 0);

134205 if–
rc
==
SQLITE_OK
 ){

134206 
	`sqlôe3_böd_öt64
(
pDñëe
, 1, 
	`gëAbsﬁuãLevñ
(
p
, 
iL™gid
, 
iIndex
, 0));

134207 
	`sqlôe3_böd_öt64
(
pDñëe
, 2,

134208 
	`gëAbsﬁuãLevñ
(
p
, 
iL™gid
, 
iIndex
, 
FTS3_SEGDIR_MAXLEVEL
-1)

134212 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_DELETE_SEGDIR_LEVEL
, &
pDñëe
, 0);

134213 if–
rc
==
SQLITE_OK
 ){

134214 
	`sqlôe3_böd_öt64
(

134215 
pDñëe
, 1, 
	`gëAbsﬁuãLevñ
(
p
, 
iL™gid
, 
iIndex
, 
iLevñ
)

134220 if–
rc
==
SQLITE_OK
 ){

134221 
	`sqlôe3_°ï
(
pDñëe
);

134222 
rc
 = 
	`sqlôe3_ª£t
(
pDñëe
);

134225  
rc
;

134240 
	`·s3CﬁumnFûãr
(

134241 
iCﬁ
,

134242 
bZîo
,

134243 **
µLi°
,

134244 *
≤Li°


134246 *
pLi°
 = *
µLi°
;

134247 
nLi°
 = *
≤Li°
;

134248 *
pEnd
 = &
pLi°
[
nLi°
];

134249 
iCuºít
 = 0;

134250 *
p
 = 
pLi°
;

134252 
	`as£π
–
iCﬁ
>=0 );

134254 
c
 = 0;

134255  
p
<
pEnd
 && (
c
 | *p)&0xFE ) c = *p++ & 0x80;

134257 if–
iCﬁ
==
iCuºít
 ){

134258 
nLi°
 = ()(
p
 - 
pLi°
);

134262 
nLi°
 -()(
p
 - 
pLi°
);

134263 
pLi°
 = 
p
;

134264 if–
nLi°
==0 ){

134267 
p
 = &
pLi°
[1];

134268 
p
 +
	`sqlôe3Fts3GëV¨öt32
’, &
iCuºít
);

134271 if–
bZîo
 && &
pLi°
[
nLi°
]!=
pEnd
 ){

134272 
	`mem£t
(&
pLi°
[
nLi°
], 0, 
pEnd
 - &pList[nList]);

134274 *
µLi°
 = 
pLi°
;

134275 *
≤Li°
 = 
nLi°
;

134285 
	`·s3M§Buf„rD©a
(

134286 
Fts3Mu…iSegRódî
 *
pM§
,

134287 *
pLi°
,

134288 
nLi°


134290 if–
nLi°
>
pM§
->
nBuf„r
 ){

134291 *
pNew
;

134292 
pM§
->
nBuf„r
 = 
nLi°
*2;

134293 
pNew
 = (*)
	`sqlôe3_ªÆloc
(
pM§
->
aBuf„r
,ÖM§->
nBuf„r
);

134294 if–!
pNew
 )  
SQLITE_NOMEM
;

134295 
pM§
->
aBuf„r
 = 
pNew
;

134298 
	`mem˝y
(
pM§
->
aBuf„r
, 
pLi°
, 
nLi°
);

134299  
SQLITE_OK
;

134302 
SQLITE_PRIVATE
 
	`sqlôe3Fts3M§In¸Next
(

134303 
Fts3TabÀ
 *
p
,

134304 
Fts3Mu…iSegRódî
 *
pM§
,

134305 
sqlôe3_öt64
 *
piDocid
,

134306 **
∑Po¶i°
,

134307 *
≤Po¶i°


134309 
nMîge
 = 
pM§
->
nAdv™˚
;

134310 
Fts3SegRódî
 **
≠Segmít
 = 
pM§
->apSegment;

134311 (*
xCmp
)(
Fts3SegRódî
 *, Fts3SegReader *) = (

134312 
p
->
bDescIdx
 ? 
·s3SegRódîDo˛i°CmpRev
 : 
·s3SegRódîDo˛i°Cmp


134315 if–
nMîge
==0 ){

134316 *
∑Po¶i°
 = 0;

134317  
SQLITE_OK
;

134321 
Fts3SegRódî
 *
pSeg
;

134322 
pSeg
 = 
pM§
->
≠Segmít
[0];

134324 if–
pSeg
->
pOff£tLi°
==0 ){

134325 *
∑Po¶i°
 = 0;

134328 
rc
;

134329 *
pLi°
;

134330 
nLi°
;

134331 
j
;

134332 
sqlôe3_öt64
 
iDocid
 = 
≠Segmít
[0]->iDocid;

134334 
rc
 = 
	`·s3SegRódîNextDocid
(
p
, 
≠Segmít
[0], &
pLi°
, &
nLi°
);

134335 
j
 = 1;

134336  
rc
==
SQLITE_OK


134337 && 
j
<
nMîge


134338 && 
≠Segmít
[
j
]->
pOff£tLi°


134339 && 
≠Segmít
[
j
]->
iDocid
==iDocid

134341 
rc
 = 
	`·s3SegRódîNextDocid
(
p
, 
≠Segmít
[
j
], 0, 0);

134342 
j
++;

134344 if–
rc
!=
SQLITE_OK
 ) Ñc;

134345 
	`·s3SegRódîS‹t
(
pM§
->
≠Segmít
, 
nMîge
, 
j
, 
xCmp
);

134347 if–
nLi°
>0 && 
	`·s3SegRódîIsPídög
(
≠Segmít
[0]) ){

134348 
rc
 = 
	`·s3M§Buf„rD©a
(
pM§
, 
pLi°
, 
nLi°
+1);

134349 if–
rc
!=
SQLITE_OK
 ) Ñc;

134350 
	`as£π
–(
pM§
->
aBuf„r
[
nLi°
] & 0xFE)==0x00 );

134351 
pLi°
 = 
pM§
->
aBuf„r
;

134354 if–
pM§
->
iCﬁFûãr
>=0 ){

134355 
	`·s3CﬁumnFûãr
(
pM§
->
iCﬁFûãr
, 1, &
pLi°
, &
nLi°
);

134358 if–
nLi°
>0 ){

134359 *
∑Po¶i°
 = 
pLi°
;

134360 *
piDocid
 = 
iDocid
;

134361 *
≤Po¶i°
 = 
nLi°
;

134367  
SQLITE_OK
;

134370 
	`·s3SegRódîSèπ
(

134371 
Fts3TabÀ
 *
p
,

134372 
Fts3Mu…iSegRódî
 *
pC§
,

134373 c⁄° *
zTîm
,

134374 
nTîm


134376 
i
;

134377 
nSeg
 = 
pC§
->
nSegmít
;

134385 
i
=0; 
pC§
->
bRe°¨t
==0 && i<pC§->
nSegmít
; i++){

134386 
ªs
 = 0;

134387 
Fts3SegRódî
 *
pSeg
 = 
pC§
->
≠Segmít
[
i
];

134389 
rc
 = 
	`·s3SegRódîNext
(
p
, 
pSeg
, 0);

134390 if–
rc
!=
SQLITE_OK
 ) Ñc;

134391 } 
zTîm
 && (
ªs
 = 
	`·s3SegRódîTîmCmp
(
pSeg
, zTîm, 
nTîm
))<0 );

134393 if–
pSeg
->
bLookup
 && 
ªs
!=0 ){

134394 
	`·s3SegRódîSëEof
(
pSeg
);

134397 
	`·s3SegRódîS‹t
(
pC§
->
≠Segmít
, 
nSeg
,ÇSeg, 
·s3SegRódîCmp
);

134399  
SQLITE_OK
;

134402 
SQLITE_PRIVATE
 
	`sqlôe3Fts3SegRódîSèπ
(

134403 
Fts3TabÀ
 *
p
,

134404 
Fts3Mu…iSegRódî
 *
pC§
,

134405 
Fts3SegFûãr
 *
pFûãr


134407 
pC§
->
pFûãr
 =ÖFilter;

134408  
	`·s3SegRódîSèπ
(
p
, 
pC§
, 
pFûãr
->
zTîm
,ÖFûãr->
nTîm
);

134411 
SQLITE_PRIVATE
 
	`sqlôe3Fts3M§In¸Sèπ
(

134412 
Fts3TabÀ
 *
p
,

134413 
Fts3Mu…iSegRódî
 *
pC§
,

134414 
iCﬁ
,

134415 c⁄° *
zTîm
,

134416 
nTîm


134418 
i
;

134419 
rc
;

134420 
nSegmít
 = 
pC§
->nSegment;

134421 (*
xCmp
)(
Fts3SegRódî
 *, Fts3SegReader *) = (

134422 
p
->
bDescIdx
 ? 
·s3SegRódîDo˛i°CmpRev
 : 
·s3SegRódîDo˛i°Cmp


134425 
	`as£π
–
pC§
->
pFûãr
==0 );

134426 
	`as£π
–
zTîm
 && 
nTîm
>0 );

134429 
rc
 = 
	`·s3SegRódîSèπ
(
p
, 
pC§
, 
zTîm
, 
nTîm
);

134430 if–
rc
!=
SQLITE_OK
 ) Ñc;

134433 
i
=0; i<
nSegmít
; i++){

134434 
Fts3SegRódî
 *
pSeg
 = 
pC§
->
≠Segmít
[
i
];

134435 if–!
pSeg
->
aNode
 || 
	`·s3SegRódîTîmCmp
’Seg, 
zTîm
, 
nTîm
) ){

134439 
pC§
->
nAdv™˚
 = 
i
;

134442 
i
=0; i<
pC§
->
nAdv™˚
; i++){

134443 
rc
 = 
	`·s3SegRódîFú°Docid
(
p
, 
pC§
->
≠Segmít
[
i
]);

134444 if–
rc
!=
SQLITE_OK
 ) Ñc;

134446 
	`·s3SegRódîS‹t
(
pC§
->
≠Segmít
, 
i
, i, 
xCmp
);

134448 
	`as£π
–
iCﬁ
<0 || iCﬁ<
p
->
nCﬁumn
 );

134449 
pC§
->
iCﬁFûãr
 = 
iCﬁ
;

134451  
SQLITE_OK
;

134466 
SQLITE_PRIVATE
 
	`sqlôe3Fts3M§In¸Re°¨t
(
Fts3Mu…iSegRódî
 *
pC§
){

134467 
i
;

134469 
	`as£π
–
pC§
->
zTîm
==0 );

134470 
	`as£π
–
pC§
->
nTîm
==0 );

134471 
	`as£π
–
pC§
->
aDo˛i°
==0 );

134472 
	`as£π
–
pC§
->
nDo˛i°
==0 );

134474 
pC§
->
nAdv™˚
 = 0;

134475 
pC§
->
bRe°¨t
 = 1;

134476 
i
=0; i<
pC§
->
nSegmít
; i++){

134477 
pC§
->
≠Segmít
[
i
]->
pOff£tLi°
 = 0;

134478 
pC§
->
≠Segmít
[
i
]->
nOff£tLi°
 = 0;

134479 
pC§
->
≠Segmít
[
i
]->
iDocid
 = 0;

134482  
SQLITE_OK
;

134486 
SQLITE_PRIVATE
 
	`sqlôe3Fts3SegRódîSãp
(

134487 
Fts3TabÀ
 *
p
,

134488 
Fts3Mu…iSegRódî
 *
pC§


134490 
rc
 = 
SQLITE_OK
;

134492 
isIgn‹eEm±y
 = (
pC§
->
pFûãr
->
Êags
 & 
FTS3_SEGMENT_IGNORE_EMPTY
);

134493 
isRequúePos
 = (
pC§
->
pFûãr
->
Êags
 & 
FTS3_SEGMENT_REQUIRE_POS
);

134494 
isCﬁFûãr
 = (
pC§
->
pFûãr
->
Êags
 & 
FTS3_SEGMENT_COLUMN_FILTER
);

134495 
isPªfix
 = (
pC§
->
pFûãr
->
Êags
 & 
FTS3_SEGMENT_PREFIX
);

134496 
isSˇn
 = (
pC§
->
pFûãr
->
Êags
 & 
FTS3_SEGMENT_SCAN
);

134497 
isFú°
 = (
pC§
->
pFûãr
->
Êags
 & 
FTS3_SEGMENT_FIRST
);

134499 
Fts3SegRódî
 **
≠Segmít
 = 
pC§
->apSegment;

134500 
nSegmít
 = 
pC§
->nSegment;

134501 
Fts3SegFûãr
 *
pFûãr
 = 
pC§
->pFilter;

134502 (*
xCmp
)(
Fts3SegRódî
 *, Fts3SegReader *) = (

134503 
p
->
bDescIdx
 ? 
·s3SegRódîDo˛i°CmpRev
 : 
·s3SegRódîDo˛i°Cmp


134506 if–
pC§
->
nSegmít
==0 )  
SQLITE_OK
;

134509 
nMîge
;

134510 
i
;

134515 
i
=0; i<
pC§
->
nAdv™˚
; i++){

134516 
Fts3SegRódî
 *
pSeg
 = 
≠Segmít
[
i
];

134517 if–
pSeg
->
bLookup
 ){

134518 
	`·s3SegRódîSëEof
(
pSeg
);

134520 
rc
 = 
	`·s3SegRódîNext
(
p
, 
pSeg
, 0);

134522 if–
rc
!=
SQLITE_OK
 ) Ñc;

134524 
	`·s3SegRódîS‹t
(
≠Segmít
, 
nSegmít
, 
pC§
->
nAdv™˚
, 
·s3SegRódîCmp
);

134525 
pC§
->
nAdv™˚
 = 0;

134528 
	`as£π
–
rc
==
SQLITE_OK
 );

134529 if–
≠Segmít
[0]->
aNode
==0 ) ;

134531 
pC§
->
nTîm
 = 
≠Segmít
[0]->nTerm;

134532 
pC§
->
zTîm
 = 
≠Segmít
[0]->zTerm;

134541 if–
pFûãr
->
zTîm
 && !
isSˇn
 ){

134542 if–
pC§
->
nTîm
<
pFûãr
->nTerm

134543 || (!
isPªfix
 && 
pC§
->
nTîm
>
pFûãr
->nTerm)

134544 || 
	`memcmp
(
pC§
->
zTîm
, 
pFûãr
->zTîm,ÖFûãr->
nTîm
)

134550 
nMîge
 = 1;

134551  
nMîge
<
nSegmít


134552 && 
≠Segmít
[
nMîge
]->
aNode


134553 && 
≠Segmít
[
nMîge
]->
nTîm
==
pC§
->nTerm

134554 && 0==
	`memcmp
(
pC§
->
zTîm
, 
≠Segmít
[
nMîge
]->zTîm,ÖC§->
nTîm
)

134556 
nMîge
++;

134559 
	`as£π
–
isIgn‹eEm±y
 || (
isRequúePos
 && !
isCﬁFûãr
) );

134560 if–
nMîge
==1

134561 && !
isIgn‹eEm±y


134562 && !
isFú°


134563 && (
p
->
bDescIdx
==0 || 
	`·s3SegRódîIsPídög
(
≠Segmít
[0])==0)

134565 
pC§
->
nDo˛i°
 = 
≠Segmít
[0]->nDoclist;

134566 if–
	`·s3SegRódîIsPídög
(
≠Segmít
[0]) ){

134567 
rc
 = 
	`·s3M§Buf„rD©a
(
pC§
, 
≠Segmít
[0]->
aDo˛i°
,ÖC§->
nDo˛i°
);

134568 
pC§
->
aDo˛i°
 =ÖC§->
aBuf„r
;

134570 
pC§
->
aDo˛i°
 = 
≠Segmít
[0]->aDoclist;

134572 if–
rc
==
SQLITE_OK
 )Ñ¯
SQLITE_ROW
;

134574 
nDo˛i°
 = 0;

134575 
sqlôe3_öt64
 
iPªv
 = 0;

134581 
i
=0; i<
nMîge
; i++){

134582 
	`·s3SegRódîFú°Docid
(
p
, 
≠Segmít
[
i
]);

134584 
	`·s3SegRódîS‹t
(
≠Segmít
, 
nMîge
,ÇMîge, 
xCmp
);

134585  
≠Segmít
[0]->
pOff£tLi°
 ){

134586 
j
;

134587 *
pLi°
 = 0;

134588 
nLi°
 = 0;

134589 
nByã
;

134590 
sqlôe3_öt64
 
iDocid
 = 
≠Segmít
[0]->iDocid;

134591 
	`·s3SegRódîNextDocid
(
p
, 
≠Segmít
[0], &
pLi°
, &
nLi°
);

134592 
j
 = 1;

134593  
j
<
nMîge


134594 && 
≠Segmít
[
j
]->
pOff£tLi°


134595 && 
≠Segmít
[
j
]->
iDocid
==iDocid

134597 
	`·s3SegRódîNextDocid
(
p
, 
≠Segmít
[
j
], 0, 0);

134598 
j
++;

134601 if–
isCﬁFûãr
 ){

134602 
	`·s3CﬁumnFûãr
(
pFûãr
->
iCﬁ
, 0, &
pLi°
, &
nLi°
);

134605 if–!
isIgn‹eEm±y
 || 
nLi°
>0 ){

134609 
sqlôe3_öt64
 
iDñè
;

134610 if–
p
->
bDescIdx
 && 
nDo˛i°
>0 ){

134611 
iDñè
 = 
iPªv
 - 
iDocid
;

134613 
iDñè
 = 
iDocid
 - 
iPªv
;

134615 
	`as£π
–
iDñè
>0 || (
nDo˛i°
==0 && iDñè==
iDocid
) );

134616 
	`as£π
–
nDo˛i°
>0 || 
iDñè
==
iDocid
 );

134618 
nByã
 = 
	`sqlôe3Fts3V¨ötLí
(
iDñè
Ë+ (
isRequúePos
?
nLi°
+1:0);

134619 if–
nDo˛i°
+
nByã
>
pC§
->
nBuf„r
 ){

134620 *
aNew
;

134621 
pC§
->
nBuf„r
 = (
nDo˛i°
+
nByã
)*2;

134622 
aNew
 = 
	`sqlôe3_ªÆloc
(
pC§
->
aBuf„r
,ÖC§->
nBuf„r
);

134623 if–!
aNew
 ){

134624  
SQLITE_NOMEM
;

134626 
pC§
->
aBuf„r
 = 
aNew
;

134629 if–
isFú°
 ){

134630 *
a
 = &
pC§
->
aBuf„r
[
nDo˛i°
];

134631 
nWrôe
;

134633 
nWrôe
 = 
	`sqlôe3Fts3Fú°Fûãr
(
iDñè
, 
pLi°
, 
nLi°
, 
a
);

134634 if–
nWrôe
 ){

134635 
iPªv
 = 
iDocid
;

134636 
nDo˛i°
 +
nWrôe
;

134639 
nDo˛i°
 +
	`sqlôe3Fts3PutV¨öt
(&
pC§
->
aBuf„r
[nDo˛i°], 
iDñè
);

134640 
iPªv
 = 
iDocid
;

134641 if–
isRequúePos
 ){

134642 
	`mem˝y
(&
pC§
->
aBuf„r
[
nDo˛i°
], 
pLi°
, 
nLi°
);

134643 
nDo˛i°
 +
nLi°
;

134644 
pC§
->
aBuf„r
[
nDo˛i°
++] = '\0';

134649 
	`·s3SegRódîS‹t
(
≠Segmít
, 
nMîge
, 
j
, 
xCmp
);

134651 if–
nDo˛i°
>0 ){

134652 
pC§
->
aDo˛i°
 =ÖC§->
aBuf„r
;

134653 
pC§
->
nDo˛i°
 =ÇDoclist;

134654 
rc
 = 
SQLITE_ROW
;

134657 
pC§
->
nAdv™˚
 = 
nMîge
;

134658 } 
rc
==
SQLITE_OK
 );

134660  
rc
;

134664 
SQLITE_PRIVATE
 
	`sqlôe3Fts3SegRódîFöish
(

134665 
Fts3Mu…iSegRódî
 *
pC§


134667 if–
pC§
 ){

134668 
i
;

134669 
i
=0; i<
pC§
->
nSegmít
; i++){

134670 
	`sqlôe3Fts3SegRódîFªe
(
pC§
->
≠Segmít
[
i
]);

134672 
	`sqlôe3_‰ì
(
pC§
->
≠Segmít
);

134673 
	`sqlôe3_‰ì
(
pC§
->
aBuf„r
);

134675 
pC§
->
nSegmít
 = 0;

134676 
pC§
->
≠Segmít
 = 0;

134677 
pC§
->
aBuf„r
 = 0;

134692 
	`·s3SegmítMîge
(

134693 
Fts3TabÀ
 *
p
,

134694 
iL™gid
,

134695 
iIndex
,

134696 
iLevñ


134698 
rc
;

134699 
iIdx
 = 0;

134700 
sqlôe3_öt64
 
iNewLevñ
 = 0;

134701 
SegmítWrôî
 *
pWrôî
 = 0;

134702 
Fts3SegFûãr
 
fûãr
;

134703 
Fts3Mu…iSegRódî
 
c§
;

134704 
bIgn‹eEm±y
 = 0;

134706 
	`as£π
–
iLevñ
==
FTS3_SEGCURSOR_ALL


134707 || 
iLevñ
==
FTS3_SEGCURSOR_PENDING


134708 || 
iLevñ
>=0

134710 
	`as£π
–
iLevñ
<
FTS3_SEGDIR_MAXLEVEL
 );

134711 
	`as£π
–
iIndex
>=0 && iIndex<
p
->
nIndex
 );

134713 
rc
 = 
	`sqlôe3Fts3SegRódîCurs‹
(
p
, 
iL™gid
, 
iIndex
, 
iLevñ
, 0, 0, 1, 0, &
c§
);

134714 if–
rc
!=
SQLITE_OK
 || 
c§
.
nSegmít
==0 ) 
föished
;

134716 if–
iLevñ
==
FTS3_SEGCURSOR_ALL
 ){

134721 if–
c§
.
nSegmít
==1 ){

134722 
rc
 = 
SQLITE_DONE
;

134723 
föished
;

134725 
rc
 = 
	`·s3SegmítMaxLevñ
(
p
, 
iL™gid
, 
iIndex
, &
iNewLevñ
);

134726 
bIgn‹eEm±y
 = 1;

134728 }if–
iLevñ
==
FTS3_SEGCURSOR_PENDING
 ){

134729 
iNewLevñ
 = 
	`gëAbsﬁuãLevñ
(
p
, 
iL™gid
, 
iIndex
, 0);

134730 
rc
 = 
	`·s3AŒoˇãSegdúIdx
(
p
, 
iL™gid
, 
iIndex
, 0, &
iIdx
);

134736 
rc
 = 
	`·s3AŒoˇãSegdúIdx
(
p
, 
iL™gid
, 
iIndex
, 
iLevñ
+1, &
iIdx
);

134737 
iNewLevñ
 = 
	`gëAbsﬁuãLevñ
(
p
, 
iL™gid
, 
iIndex
, 
iLevñ
+1);

134739 if–
rc
!=
SQLITE_OK
 ) 
föished
;

134740 
	`as£π
–
c§
.
nSegmít
>0 );

134741 
	`as£π
–
iNewLevñ
>=
	`gëAbsﬁuãLevñ
(
p
, 
iL™gid
, 
iIndex
, 0) );

134742 
	`as£π
–
iNewLevñ
<
	`gëAbsﬁuãLevñ
(
p
, 
iL™gid
, 
iIndex
,
FTS3_SEGDIR_MAXLEVEL
) );

134744 
	`mem£t
(&
fûãr
, 0, (
Fts3SegFûãr
));

134745 
fûãr
.
Êags
 = 
FTS3_SEGMENT_REQUIRE_POS
;

134746 
fûãr
.
Êags
 |(
bIgn‹eEm±y
 ? 
FTS3_SEGMENT_IGNORE_EMPTY
 : 0);

134748 
rc
 = 
	`sqlôe3Fts3SegRódîSèπ
(
p
, &
c§
, &
fûãr
);

134749  
SQLITE_OK
==
rc
 ){

134750 
rc
 = 
	`sqlôe3Fts3SegRódîSãp
(
p
, &
c§
);

134751 if–
rc
!=
SQLITE_ROW
 ) ;

134752 
rc
 = 
	`·s3SegWrôîAdd
(
p
, &
pWrôî
, 1,

134753 
c§
.
zTîm
, c§.
nTîm
, c§.
aDo˛i°
, c§.
nDo˛i°
);

134755 if–
rc
!=
SQLITE_OK
 ) 
föished
;

134756 
	`as£π
–
pWrôî
 );

134758 if–
iLevñ
!=
FTS3_SEGCURSOR_PENDING
 ){

134759 
rc
 = 
	`·s3DñëeSegdú
(

134760 
p
, 
iL™gid
, 
iIndex
, 
iLevñ
, 
c§
.
≠Segmít
, c§.
nSegmít


134762 if–
rc
!=
SQLITE_OK
 ) 
föished
;

134764 
rc
 = 
	`·s3SegWrôîFlush
(
p
, 
pWrôî
, 
iNewLevñ
, 
iIdx
);

134766 
föished
:

134767 
	`·s3SegWrôîFªe
(
pWrôî
);

134768 
	`sqlôe3Fts3SegRódîFöish
(&
c§
);

134769  
rc
;

134776 
SQLITE_PRIVATE
 
	`sqlôe3Fts3PídögTîmsFlush
(
Fts3TabÀ
 *
p
){

134777 
rc
 = 
SQLITE_OK
;

134778 
i
;

134780 
i
=0; 
rc
==
SQLITE_OK
 && i<
p
->
nIndex
; i++){

134781 
rc
 = 
	`·s3SegmítMîge
(
p
,Ö->
iPªvL™gid
, 
i
, 
FTS3_SEGCURSOR_PENDING
);

134782 if–
rc
==
SQLITE_DONE
 )Ñ¯
SQLITE_OK
;

134784 
	`sqlôe3Fts3PídögTîmsCÀ¨
(
p
);

134789 if–
rc
==
SQLITE_OK
 && 
p
->
bHasSèt


134790 && 
p
->
bAutoö¸mîge
==0xf‡&&Ö->
nLófAdd
>0

134792 
sqlôe3_°mt
 *
pStmt
 = 0;

134793 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_SELECT_STAT
, &
pStmt
, 0);

134794 if–
rc
==
SQLITE_OK
 ){

134795 
	`sqlôe3_böd_öt
(
pStmt
, 1, 
FTS_STAT_AUTOINCRMERGE
);

134796 
rc
 = 
	`sqlôe3_°ï
(
pStmt
);

134797 
p
->
bAutoö¸mîge
 = (
rc
==
SQLITE_ROW
 && 
	`sqlôe3_cﬁumn_öt
(
pStmt
, 0));

134798 
rc
 = 
	`sqlôe3_ª£t
(
pStmt
);

134801  
rc
;

134807 
	`·s3EncodeI¡Aºay
(

134808 
N
,

134809 
u32
 *
a
,

134810 *
zBuf
,

134811 *
pNBuf


134813 
i
, 
j
;

134814 
i
=
j
=0; i<
N
; i++){

134815 
j
 +
	`sqlôe3Fts3PutV¨öt
(&
zBuf
[j], (
sqlôe3_öt64
)
a
[
i
]);

134817 *
pNBuf
 = 
j
;

134823 
	`·s3DecodeI¡Aºay
(

134824 
N
,

134825 
u32
 *
a
,

134826 c⁄° *
zBuf
,

134827 
nBuf


134829 
i
, 
j
;

134830 
	`UNUSED_PARAMETER
(
nBuf
);

134831 
i
=
j
=0; i<
N
; i++){

134832 
sqlôe3_öt64
 
x
;

134833 
j
 +
	`sqlôe3Fts3GëV¨öt
(&
zBuf
[j], &
x
);

134834 
	`as£π
(
j
<=
nBuf
);

134835 
a
[
i
] = (
u32
)(
x
 & 0xffffffff);

134844 
	`·s3In£πDocsize
(

134845 *
pRC
,

134846 
Fts3TabÀ
 *
p
,

134847 
u32
 *
aSz


134849 *
pBlob
;

134850 
nBlob
;

134851 
sqlôe3_°mt
 *
pStmt
;

134852 
rc
;

134854 if–*
pRC
 ) ;

134855 
pBlob
 = 
	`sqlôe3_mÆloc
–10*
p
->
nCﬁumn
 );

134856 if–
pBlob
==0 ){

134857 *
pRC
 = 
SQLITE_NOMEM
;

134860 
	`·s3EncodeI¡Aºay
(
p
->
nCﬁumn
, 
aSz
, 
pBlob
, &
nBlob
);

134861 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_REPLACE_DOCSIZE
, &
pStmt
, 0);

134862 if–
rc
 ){

134863 
	`sqlôe3_‰ì
(
pBlob
);

134864 *
pRC
 = 
rc
;

134867 
	`sqlôe3_böd_öt64
(
pStmt
, 1, 
p
->
iPªvDocid
);

134868 
	`sqlôe3_böd_blob
(
pStmt
, 2, 
pBlob
, 
nBlob
, 
sqlôe3_‰ì
);

134869 
	`sqlôe3_°ï
(
pStmt
);

134870 *
pRC
 = 
	`sqlôe3_ª£t
(
pStmt
);

134888 
	`·s3Upd©eDocTŸÆs
(

134889 *
pRC
,

134890 
Fts3TabÀ
 *
p
,

134891 
u32
 *
aSzIns
,

134892 
u32
 *
aSzDñ
,

134893 
nChng


134895 *
pBlob
;

134896 
nBlob
;

134897 
u32
 *
a
;

134898 
sqlôe3_°mt
 *
pStmt
;

134899 
i
;

134900 
rc
;

134902 c⁄° 
nSèt
 = 
p
->
nCﬁumn
+2;

134904 if–*
pRC
 ) ;

134905 
a
 = 
	`sqlôe3_mÆloc
–((
u32
)+10)*
nSèt
 );

134906 if–
a
==0 ){

134907 *
pRC
 = 
SQLITE_NOMEM
;

134910 
pBlob
 = (*)&
a
[
nSèt
];

134911 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_SELECT_STAT
, &
pStmt
, 0);

134912 if–
rc
 ){

134913 
	`sqlôe3_‰ì
(
a
);

134914 *
pRC
 = 
rc
;

134917 
	`sqlôe3_böd_öt
(
pStmt
, 1, 
FTS_STAT_DOCTOTAL
);

134918 if–
	`sqlôe3_°ï
(
pStmt
)==
SQLITE_ROW
 ){

134919 
	`·s3DecodeI¡Aºay
(
nSèt
, 
a
,

134920 
	`sqlôe3_cﬁumn_blob
(
pStmt
, 0),

134921 
	`sqlôe3_cﬁumn_byãs
(
pStmt
, 0));

134923 
	`mem£t
(
a
, 0, (
u32
)*(
nSèt
) );

134925 
rc
 = 
	`sqlôe3_ª£t
(
pStmt
);

134926 if–
rc
!=
SQLITE_OK
 ){

134927 
	`sqlôe3_‰ì
(
a
);

134928 *
pRC
 = 
rc
;

134931 if–
nChng
<0 && 
a
[0]<(
u32
)(-nChng) ){

134932 
a
[0] = 0;

134934 
a
[0] +
nChng
;

134936 
i
=0; i<
p
->
nCﬁumn
+1; i++){

134937 
u32
 
x
 = 
a
[
i
+1];

134938 if–
x
+
aSzIns
[
i
] < 
aSzDñ
[i] ){

134939 
x
 = 0;

134941 
x
 = x + 
aSzIns
[
i
] - 
aSzDñ
[i];

134943 
a
[
i
+1] = 
x
;

134945 
	`·s3EncodeI¡Aºay
(
nSèt
, 
a
, 
pBlob
, &
nBlob
);

134946 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_REPLACE_STAT
, &
pStmt
, 0);

134947 if–
rc
 ){

134948 
	`sqlôe3_‰ì
(
a
);

134949 *
pRC
 = 
rc
;

134952 
	`sqlôe3_böd_öt
(
pStmt
, 1, 
FTS_STAT_DOCTOTAL
);

134953 
	`sqlôe3_böd_blob
(
pStmt
, 2, 
pBlob
, 
nBlob
, 
SQLITE_STATIC
);

134954 
	`sqlôe3_°ï
(
pStmt
);

134955 *
pRC
 = 
	`sqlôe3_ª£t
(
pStmt
);

134956 
	`sqlôe3_‰ì
(
a
);

134963 
	`·s3DoO±imize
(
Fts3TabÀ
 *
p
, 
bRëu∫D⁄e
){

134964 
bSìnD⁄e
 = 0;

134965 
rc
;

134966 
sqlôe3_°mt
 *
pAŒL™gid
 = 0;

134968 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_SELECT_ALL_LANGID
, &
pAŒL™gid
, 0);

134969 if–
rc
==
SQLITE_OK
 ){

134970 
rc2
;

134971 
	`sqlôe3_böd_öt
(
pAŒL™gid
, 1, 
p
->
nIndex
);

134972  
	`sqlôe3_°ï
(
pAŒL™gid
)==
SQLITE_ROW
 ){

134973 
i
;

134974 
iL™gid
 = 
	`sqlôe3_cﬁumn_öt
(
pAŒL™gid
, 0);

134975 
i
=0; 
rc
==
SQLITE_OK
 && i<
p
->
nIndex
; i++){

134976 
rc
 = 
	`·s3SegmítMîge
(
p
, 
iL™gid
, 
i
, 
FTS3_SEGCURSOR_ALL
);

134977 if–
rc
==
SQLITE_DONE
 ){

134978 
bSìnD⁄e
 = 1;

134979 
rc
 = 
SQLITE_OK
;

134983 
rc2
 = 
	`sqlôe3_ª£t
(
pAŒL™gid
);

134984 if–
rc
==
SQLITE_OK
 )Ñ¯
rc2
;

134987 
	`sqlôe3Fts3SegmítsClo£
(
p
);

134988 
	`sqlôe3Fts3PídögTîmsCÀ¨
(
p
);

134990  (
rc
==
SQLITE_OK
 && 
bRëu∫D⁄e
 && 
bSìnD⁄e
Ë? 
SQLITE_DONE
 :Ñc;

135003 
	`·s3DoRebuûd
(
Fts3TabÀ
 *
p
){

135004 
rc
;

135006 
rc
 = 
	`·s3DñëeAŒ
(
p
, 0);

135007 if–
rc
==
SQLITE_OK
 ){

135008 
u32
 *
aSz
 = 0;

135009 
u32
 *
aSzIns
 = 0;

135010 
u32
 *
aSzDñ
 = 0;

135011 
sqlôe3_°mt
 *
pStmt
 = 0;

135012 
nE¡ry
 = 0;

135015 *
zSql
 = 
	`sqlôe3_m¥ötf
("SELECT %s" , 
p
->
zRódEx¥li°
);

135016 if–!
zSql
 ){

135017 
rc
 = 
SQLITE_NOMEM
;

135019 
rc
 = 
	`sqlôe3_¥ï¨e_v2
(
p
->
db
, 
zSql
, -1, &
pStmt
, 0);

135020 
	`sqlôe3_‰ì
(
zSql
);

135023 if–
rc
==
SQLITE_OK
 ){

135024 
nByã
 = (
u32
Ë* (
p
->
nCﬁumn
+1)*3;

135025 
aSz
 = (
u32
 *)
	`sqlôe3_mÆloc
(
nByã
);

135026 if–
aSz
==0 ){

135027 
rc
 = 
SQLITE_NOMEM
;

135029 
	`mem£t
(
aSz
, 0, 
nByã
);

135030 
aSzIns
 = &
aSz
[
p
->
nCﬁumn
+1];

135031 
aSzDñ
 = &
aSzIns
[
p
->
nCﬁumn
+1];

135035  
rc
==
SQLITE_OK
 && 
SQLITE_ROW
==
	`sqlôe3_°ï
(
pStmt
) ){

135036 
iCﬁ
;

135037 
iL™gid
 = 
	`œngidFromSñe˘
(
p
, 
pStmt
);

135038 
rc
 = 
	`·s3PídögTîmsDocid
(
p
, 
iL™gid
, 
	`sqlôe3_cﬁumn_öt64
(
pStmt
, 0));

135039 
	`mem£t
(
aSz
, 0, ◊Sz[0]Ë* (
p
->
nCﬁumn
+1));

135040 
iCﬁ
=0; 
rc
==
SQLITE_OK
 && iCﬁ<
p
->
nCﬁumn
; iCol++){

135041 if–
p
->
abNŸödexed
[
iCﬁ
]==0 ){

135042 c⁄° *
z
 = (c⁄° *Ë
	`sqlôe3_cﬁumn_ãxt
(
pStmt
, 
iCﬁ
+1);

135043 
rc
 = 
	`·s3PídögTîmsAdd
(
p
, 
iL™gid
, 
z
, 
iCﬁ
, &
aSz
[iCol]);

135044 
aSz
[
p
->
nCﬁumn
] +
	`sqlôe3_cﬁumn_byãs
(
pStmt
, 
iCﬁ
+1);

135047 if–
p
->
bHasDocsize
 ){

135048 
	`·s3In£πDocsize
(&
rc
, 
p
, 
aSz
);

135050 if–
rc
!=
SQLITE_OK
 ){

135051 
	`sqlôe3_föÆize
(
pStmt
);

135052 
pStmt
 = 0;

135054 
nE¡ry
++;

135055 
iCﬁ
=0; iCﬁ<=
p
->
nCﬁumn
; iCol++){

135056 
aSzIns
[
iCﬁ
] +
aSz
[iCol];

135060 if–
p
->
bFts4
 ){

135061 
	`·s3Upd©eDocTŸÆs
(&
rc
, 
p
, 
aSzIns
, 
aSzDñ
, 
nE¡ry
);

135063 
	`sqlôe3_‰ì
(
aSz
);

135065 if–
pStmt
 ){

135066 
rc2
 = 
	`sqlôe3_föÆize
(
pStmt
);

135067 if–
rc
==
SQLITE_OK
 ){

135068 
rc
 = 
rc2
;

135073  
rc
;

135083 
	`·s3In¸mîgeC§
(

135084 
Fts3TabÀ
 *
p
,

135085 
sqlôe3_öt64
 
iAbsLevñ
,

135086 
nSeg
,

135087 
Fts3Mu…iSegRódî
 *
pC§


135089 
rc
;

135090 
sqlôe3_°mt
 *
pStmt
 = 0;

135091 
nByã
;

135094 
	`mem£t
(
pC§
, 0, (*pCsr));

135095 
nByã
 = (
Fts3SegRódî
 *Ë* 
nSeg
;

135096 
pC§
->
≠Segmít
 = (
Fts3SegRódî
 **)
	`sqlôe3_mÆloc
(
nByã
);

135098 if–
pC§
->
≠Segmít
==0 ){

135099 
rc
 = 
SQLITE_NOMEM
;

135101 
	`mem£t
(
pC§
->
≠Segmít
, 0, 
nByã
);

135102 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_SELECT_LEVEL
, &
pStmt
, 0);

135104 if–
rc
==
SQLITE_OK
 ){

135105 
i
;

135106 
rc2
;

135107 
	`sqlôe3_böd_öt64
(
pStmt
, 1, 
iAbsLevñ
);

135108 
	`as£π
–
pC§
->
nSegmít
==0 );

135109 
i
=0; 
rc
==
SQLITE_OK
 && 
	`sqlôe3_°ï
(
pStmt
)==
SQLITE_ROW
 && i<
nSeg
; i++){

135110 
rc
 = 
	`sqlôe3Fts3SegRódîNew
(
i
, 0,

135111 
	`sqlôe3_cﬁumn_öt64
(
pStmt
, 1),

135112 
	`sqlôe3_cﬁumn_öt64
(
pStmt
, 2),

135113 
	`sqlôe3_cﬁumn_öt64
(
pStmt
, 3),

135114 
	`sqlôe3_cﬁumn_blob
(
pStmt
, 4),

135115 
	`sqlôe3_cﬁumn_byãs
(
pStmt
, 4),

135116 &
pC§
->
≠Segmít
[
i
]

135118 
pC§
->
nSegmít
++;

135120 
rc2
 = 
	`sqlôe3_ª£t
(
pStmt
);

135121 if–
rc
==
SQLITE_OK
 )Ñ¯
rc2
;

135124  
rc
;

135127 
In¸mîgeWrôî
 
	tIn¸mîgeWrôî
;

135128 
NodeWrôî
 
	tNodeWrôî
;

135129 
Blob
 
	tBlob
;

135130 
NodeRódî
 
	tNodeRódî
;

135138 
	sBlob
 {

135139 *
a
;

135140 
n
;

135141 
nAŒoc
;

135148 
	sNodeWrôî
 {

135149 
sqlôe3_öt64
 
iBlock
;

135150 
Blob
 
key
;

135151 
Blob
 
block
;

135158 
	sIn¸mîgeWrôî
 {

135159 
nLófE°
;

135160 
nW‹k
;

135161 
sqlôe3_öt64
 
iAbsLevñ
;

135162 
iIdx
;

135163 
sqlôe3_öt64
 
iSèπ
;

135164 
sqlôe3_öt64
 
iEnd
;

135165 
NodeWrôî
 
aNodeWrôî
[
FTS_MAX_APPENDABLE_HEIGHT
];

135176 
	sNodeRódî
 {

135177 c⁄° *
aNode
;

135178 
nNode
;

135179 
iOff
;

135182 
sqlôe3_öt64
 
iChûd
;

135183 
Blob
 
ãrm
;

135184 c⁄° *
aDo˛i°
;

135185 
nDo˛i°
;

135197 
	`blobGrowBuf„r
(
Blob
 *
pBlob
, 
nMö
, *
pRc
){

135198 if–*
pRc
==
SQLITE_OK
 && 
nMö
>
pBlob
->
nAŒoc
 ){

135199 
nAŒoc
 = 
nMö
;

135200 *
a
 = (*)
	`sqlôe3_ªÆloc
(
pBlob
->a, 
nAŒoc
);

135201 if–
a
 ){

135202 
pBlob
->
nAŒoc
 =ÇAlloc;

135203 
pBlob
->
a
 =á;

135205 *
pRc
 = 
SQLITE_NOMEM
;

135220 
	`nodeRódîNext
(
NodeRódî
 *
p
){

135221 
bFú°
 = (
p
->
ãrm
.
n
==0);

135222 
nPªfix
 = 0;

135223 
nSuffix
 = 0;

135224 
rc
 = 
SQLITE_OK
;

135226 
	`as£π
–
p
->
aNode
 );

135227 if–
p
->
iChûd
 && 
bFú°
==0 )Ö->iChild++;

135228 if–
p
->
iOff
>ı->
nNode
 ){

135230 
p
->
aNode
 = 0;

135232 if–
bFú°
==0 ){

135233 
p
->
iOff
 +
	`sqlôe3Fts3GëV¨öt32
(&p->
aNode
[p->iOff], &
nPªfix
);

135235 
p
->
iOff
 +
	`sqlôe3Fts3GëV¨öt32
(&p->
aNode
[p->iOff], &
nSuffix
);

135237 
	`blobGrowBuf„r
(&
p
->
ãrm
, 
nPªfix
+
nSuffix
, &
rc
);

135238 if–
rc
==
SQLITE_OK
 ){

135239 
	`mem˝y
(&
p
->
ãrm
.
a
[
nPªfix
], &p->
aNode
[p->
iOff
], 
nSuffix
);

135240 
p
->
ãrm
.
n
 = 
nPªfix
+
nSuffix
;

135241 
p
->
iOff
 +
nSuffix
;

135242 if–
p
->
iChûd
==0 ){

135243 
p
->
iOff
 +
	`sqlôe3Fts3GëV¨öt32
(&p->
aNode
[p->iOff], &p->
nDo˛i°
);

135244 
p
->
aDo˛i°
 = &p->
aNode
[p->
iOff
];

135245 
p
->
iOff
 +p->
nDo˛i°
;

135250 
	`as£π
–
p
->
iOff
<ı->
nNode
 );

135252  
rc
;

135258 
	`nodeRódîRñó£
(
NodeRódî
 *
p
){

135259 
	`sqlôe3_‰ì
(
p
->
ãrm
.
a
);

135269 
	`nodeRódîInô
(
NodeRódî
 *
p
, c⁄° *
aNode
, 
nNode
){

135270 
	`mem£t
(
p
, 0, (
NodeRódî
));

135271 
p
->
aNode
 =áNode;

135272 
p
->
nNode
 =ÇNode;

135275 if–
p
->
aNode
[0] ){

135277 
p
->
iOff
 = 1 + 
	`sqlôe3Fts3GëV¨öt
(&p->
aNode
[1], &p->
iChûd
);

135279 
p
->
iOff
 = 1;

135282  
	`nodeRódîNext
(
p
);

135295 
	`·s3In¸mîgePush
(

135296 
Fts3TabÀ
 *
p
,

135297 
In¸mîgeWrôî
 *
pWrôî
,

135298 c⁄° *
zTîm
,

135299 
nTîm


135301 
sqlôe3_öt64
 
iPå
 = 
pWrôî
->
aNodeWrôî
[0].
iBlock
;

135302 
iLayî
;

135304 
	`as£π
–
nTîm
>0 );

135305 
iLayî
=1; 
	`ALWAYS
(iLayî<
FTS_MAX_APPENDABLE_HEIGHT
); iLayer++){

135306 
sqlôe3_öt64
 
iNextPå
 = 0;

135307 
NodeWrôî
 *
pNode
 = &
pWrôî
->
aNodeWrôî
[
iLayî
];

135308 
rc
 = 
SQLITE_OK
;

135309 
nPªfix
;

135310 
nSuffix
;

135311 
nS∑˚
;

135317 
nPªfix
 = 
	`·s3PªfixCom¥ess
(
pNode
->
key
.
a
,ÖNode->key.
n
, 
zTîm
, 
nTîm
);

135318 
nSuffix
 = 
nTîm
 - 
nPªfix
;

135319 
nS∑˚
 = 
	`sqlôe3Fts3V¨ötLí
(
nPªfix
);

135320 
nS∑˚
 +
	`sqlôe3Fts3V¨ötLí
(
nSuffix
) +ÇSuffix;

135322 if–
pNode
->
key
.
n
==0 || (pNode->
block
.¿+ 
nS∑˚
)<=
p
->
nNodeSize
 ){

135327 
Blob
 *
pBlk
 = &
pNode
->
block
;

135328 if–
pBlk
->
n
==0 ){

135329 
	`blobGrowBuf„r
(
pBlk
, 
p
->
nNodeSize
, &
rc
);

135330 if–
rc
==
SQLITE_OK
 ){

135331 
pBlk
->
a
[0] = ()
iLayî
;

135332 
pBlk
->
n
 = 1 + 
	`sqlôe3Fts3PutV¨öt
(&pBlk->
a
[1], 
iPå
);

135335 
	`blobGrowBuf„r
(
pBlk
,ÖBlk->
n
 + 
nS∑˚
, &
rc
);

135336 
	`blobGrowBuf„r
(&
pNode
->
key
, 
nTîm
, &
rc
);

135338 if–
rc
==
SQLITE_OK
 ){

135339 if–
pNode
->
key
.
n
 ){

135340 
pBlk
->
n
 +
	`sqlôe3Fts3PutV¨öt
(&pBlk->
a
[pBlk->n], 
nPªfix
);

135342 
pBlk
->
n
 +
	`sqlôe3Fts3PutV¨öt
(&pBlk->
a
[pBlk->n], 
nSuffix
);

135343 
	`mem˝y
(&
pBlk
->
a
[pBlk->
n
], &
zTîm
[
nPªfix
], 
nSuffix
);

135344 
pBlk
->
n
 +
nSuffix
;

135346 
	`mem˝y
(
pNode
->
key
.
a
, 
zTîm
, 
nTîm
);

135347 
pNode
->
key
.
n
 = 
nTîm
;

135353 
rc
 = 
	`·s3WrôeSegmít
(
p
, 
pNode
->
iBlock
,ÖNode->
block
.
a
,ÖNode->block.
n
);

135355 
	`as£π
–
pNode
->
block
.
nAŒoc
>=
p
->
nNodeSize
 );

135356 
pNode
->
block
.
a
[0] = ()
iLayî
;

135357 
pNode
->
block
.
n
 = 1 + 
	`sqlôe3Fts3PutV¨öt
(&pNode->block.
a
[1], 
iPå
+1);

135359 
iNextPå
 = 
pNode
->
iBlock
;

135360 
pNode
->
iBlock
++;

135361 
pNode
->
key
.
n
 = 0;

135364 if–
rc
!=
SQLITE_OK
 || 
iNextPå
==0 ) Ñc;

135365 
iPå
 = 
iNextPå
;

135368 
	`as£π
( 0 );

135396 
	`·s3AµídToNode
(

135397 
Blob
 *
pNode
,

135398 
Blob
 *
pPªv
,

135399 c⁄° *
zTîm
,

135400 
nTîm
,

135401 c⁄° *
aDo˛i°
,

135402 
nDo˛i°


135404 
rc
 = 
SQLITE_OK
;

135405 
bFú°
 = (
pPªv
->
n
==0);

135406 
nPªfix
;

135407 
nSuffix
;

135411 
	`as£π
–
pNode
->
n
>0 );

135412 
	`as£π
–(
pNode
->
a
[0]=='\0')==(
aDo˛i°
!=0) );

135414 
	`blobGrowBuf„r
(
pPªv
, 
nTîm
, &
rc
);

135415 if–
rc
!=
SQLITE_OK
 ) Ñc;

135417 
nPªfix
 = 
	`·s3PªfixCom¥ess
(
pPªv
->
a
,ÖPªv->
n
, 
zTîm
, 
nTîm
);

135418 
nSuffix
 = 
nTîm
 - 
nPªfix
;

135419 
	`mem˝y
(
pPªv
->
a
, 
zTîm
, 
nTîm
);

135420 
pPªv
->
n
 = 
nTîm
;

135422 if–
bFú°
==0 ){

135423 
pNode
->
n
 +
	`sqlôe3Fts3PutV¨öt
(&pNode->
a
[pNode->n], 
nPªfix
);

135425 
pNode
->
n
 +
	`sqlôe3Fts3PutV¨öt
(&pNode->
a
[pNode->n], 
nSuffix
);

135426 
	`mem˝y
(&
pNode
->
a
[pNode->
n
], &
zTîm
[
nPªfix
], 
nSuffix
);

135427 
pNode
->
n
 +
nSuffix
;

135429 if–
aDo˛i°
 ){

135430 
pNode
->
n
 +
	`sqlôe3Fts3PutV¨öt
(&pNode->
a
[pNode->n], 
nDo˛i°
);

135431 
	`mem˝y
(&
pNode
->
a
[pNode->
n
], 
aDo˛i°
, 
nDo˛i°
);

135432 
pNode
->
n
 +
nDo˛i°
;

135435 
	`as£π
–
pNode
->
n
<ıNode->
nAŒoc
 );

135437  
SQLITE_OK
;

135446 
	`·s3In¸mîgeAµíd
(

135447 
Fts3TabÀ
 *
p
,

135448 
In¸mîgeWrôî
 *
pWrôî
,

135449 
Fts3Mu…iSegRódî
 *
pC§


135451 c⁄° *
zTîm
 = 
pC§
->zTerm;

135452 
nTîm
 = 
pC§
->nTerm;

135453 c⁄° *
aDo˛i°
 = 
pC§
->aDoclist;

135454 
nDo˛i°
 = 
pC§
->nDoclist;

135455 
rc
 = 
SQLITE_OK
;

135456 
nS∑˚
;

135457 
nPªfix
;

135458 
nSuffix
;

135459 
NodeWrôî
 *
pLóf
;

135461 
pLóf
 = &
pWrôî
->
aNodeWrôî
[0];

135462 
nPªfix
 = 
	`·s3PªfixCom¥ess
(
pLóf
->
key
.
a
,ÖLóf->key.
n
, 
zTîm
, 
nTîm
);

135463 
nSuffix
 = 
nTîm
 - 
nPªfix
;

135465 
nS∑˚
 = 
	`sqlôe3Fts3V¨ötLí
(
nPªfix
);

135466 
nS∑˚
 +
	`sqlôe3Fts3V¨ötLí
(
nSuffix
) +ÇSuffix;

135467 
nS∑˚
 +
	`sqlôe3Fts3V¨ötLí
(
nDo˛i°
) +ÇDoclist;

135472 if–
pLóf
->
block
.
n
>0 && (pLóf->block.¿+ 
nS∑˚
)>
p
->
nNodeSize
 ){

135473 
rc
 = 
	`·s3WrôeSegmít
(
p
, 
pLóf
->
iBlock
,ÖLóf->
block
.
a
,ÖLóf->block.
n
);

135474 
pWrôî
->
nW‹k
++;

135488 if–
rc
==
SQLITE_OK
 ){

135489 
rc
 = 
	`·s3In¸mîgePush
(
p
, 
pWrôî
, 
zTîm
, 
nPªfix
+1);

135493 
pLóf
->
iBlock
++;

135494 
pLóf
->
key
.
n
 = 0;

135495 
pLóf
->
block
.
n
 = 0;

135497 
nSuffix
 = 
nTîm
;

135498 
nS∑˚
 = 1;

135499 
nS∑˚
 +
	`sqlôe3Fts3V¨ötLí
(
nSuffix
) +ÇSuffix;

135500 
nS∑˚
 +
	`sqlôe3Fts3V¨ötLí
(
nDo˛i°
) +ÇDoclist;

135503 
	`blobGrowBuf„r
(&
pLóf
->
block
,ÖLóf->block.
n
 + 
nS∑˚
, &
rc
);

135505 if–
rc
==
SQLITE_OK
 ){

135506 if–
pLóf
->
block
.
n
==0 ){

135507 
pLóf
->
block
.
n
 = 1;

135508 
pLóf
->
block
.
a
[0] = '\0';

135510 
rc
 = 
	`·s3AµídToNode
(

135511 &
pLóf
->
block
, &pLóf->
key
, 
zTîm
, 
nTîm
, 
aDo˛i°
, 
nDo˛i°


135515  
rc
;

135531 
	`·s3In¸mîgeRñó£
(

135532 
Fts3TabÀ
 *
p
,

135533 
In¸mîgeWrôî
 *
pWrôî
,

135534 *
pRc


135536 
i
;

135537 
iRoŸ
;

135538 
NodeWrôî
 *
pRoŸ
;

135539 
rc
 = *
pRc
;

135545 
iRoŸ
=
FTS_MAX_APPENDABLE_HEIGHT
-1; iRoot>=0; iRoot--){

135546 
NodeWrôî
 *
pNode
 = &
pWrôî
->
aNodeWrôî
[
iRoŸ
];

135547 if–
pNode
->
block
.
n
>0 ) ;

135548 
	`as£π
–*
pRc
 || 
pNode
->
block
.
nAŒoc
==0 );

135549 
	`as£π
–*
pRc
 || 
pNode
->
key
.
nAŒoc
==0 );

135550 
	`sqlôe3_‰ì
(
pNode
->
block
.
a
);

135551 
	`sqlôe3_‰ì
(
pNode
->
key
.
a
);

135555 if–
iRoŸ
<0 ) ;

135572 if–
iRoŸ
==0 ){

135573 
Blob
 *
pBlock
 = &
pWrôî
->
aNodeWrôî
[1].
block
;

135574 
	`blobGrowBuf„r
(
pBlock
, 1 + 
FTS3_VARINT_MAX
, &
rc
);

135575 if–
rc
==
SQLITE_OK
 ){

135576 
pBlock
->
a
[0] = 0x01;

135577 
pBlock
->
n
 = 1 + 
	`sqlôe3Fts3PutV¨öt
(

135578 &
pBlock
->
a
[1], 
pWrôî
->
aNodeWrôî
[0].
iBlock


135581 
iRoŸ
 = 1;

135583 
pRoŸ
 = &
pWrôî
->
aNodeWrôî
[
iRoŸ
];

135586 
i
=0; i<
iRoŸ
; i++){

135587 
NodeWrôî
 *
pNode
 = &
pWrôî
->
aNodeWrôî
[
i
];

135588 if–
pNode
->
block
.
n
>0 && 
rc
==
SQLITE_OK
 ){

135589 
rc
 = 
	`·s3WrôeSegmít
(
p
, 
pNode
->
iBlock
,ÖNode->
block
.
a
,ÖNode->block.
n
);

135591 
	`sqlôe3_‰ì
(
pNode
->
block
.
a
);

135592 
	`sqlôe3_‰ì
(
pNode
->
key
.
a
);

135596 if–
rc
==
SQLITE_OK
 ){

135597 
rc
 = 
	`·s3WrôeSegdú
(
p
,

135598 
pWrôî
->
iAbsLevñ
+1,

135599 
pWrôî
->
iIdx
,

135600 
pWrôî
->
iSèπ
,

135601 
pWrôî
->
aNodeWrôî
[0].
iBlock
,

135602 
pWrôî
->
iEnd
,

135603 
pRoŸ
->
block
.
a
,ÖRoŸ->block.
n


135606 
	`sqlôe3_‰ì
(
pRoŸ
->
block
.
a
);

135607 
	`sqlôe3_‰ì
(
pRoŸ
->
key
.
a
);

135609 *
pRc
 = 
rc
;

135620 
	`·s3TîmCmp
(

135621 c⁄° *
zLhs
, 
nLhs
,

135622 c⁄° *
zRhs
, 
nRhs


135624 
nCmp
 = 
	`MIN
(
nLhs
, 
nRhs
);

135625 
ªs
;

135627 
ªs
 = 
	`memcmp
(
zLhs
, 
zRhs
, 
nCmp
);

135628 if–
ªs
==0 )Ñe†
nLhs
 - 
nRhs
;

135630  
ªs
;

135646 
	`·s3IsAµídabÀ
(
Fts3TabÀ
 *
p
, 
sqlôe3_öt64
 
iEnd
, *
pbRes
){

135647 
bRes
 = 0;

135648 
sqlôe3_°mt
 *
pCheck
 = 0;

135649 
rc
;

135651 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_SEGMENT_IS_APPENDABLE
, &
pCheck
, 0);

135652 if–
rc
==
SQLITE_OK
 ){

135653 
	`sqlôe3_böd_öt64
(
pCheck
, 1, 
iEnd
);

135654 if–
SQLITE_ROW
==
	`sqlôe3_°ï
(
pCheck
ËË
bRes
 = 1;

135655 
rc
 = 
	`sqlôe3_ª£t
(
pCheck
);

135658 *
pbRes
 = 
bRes
;

135659  
rc
;

135677 
	`·s3In¸mîgeLﬂd
(

135678 
Fts3TabÀ
 *
p
,

135679 
sqlôe3_öt64
 
iAbsLevñ
,

135680 
iIdx
,

135681 c⁄° *
zKey
,

135682 
nKey
,

135683 
In¸mîgeWrôî
 *
pWrôî


135685 
rc
;

135686 
sqlôe3_°mt
 *
pSñe˘
 = 0;

135688 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_SELECT_SEGDIR
, &
pSñe˘
, 0);

135689 if–
rc
==
SQLITE_OK
 ){

135690 
sqlôe3_öt64
 
iSèπ
 = 0;

135691 
sqlôe3_öt64
 
iLófEnd
 = 0;

135692 
sqlôe3_öt64
 
iEnd
 = 0;

135693 c⁄° *
aRoŸ
 = 0;

135694 
nRoŸ
 = 0;

135695 
rc2
;

135696 
bAµídabÀ
 = 0;

135699 
	`sqlôe3_böd_öt64
(
pSñe˘
, 1, 
iAbsLevñ
+1);

135700 
	`sqlôe3_böd_öt
(
pSñe˘
, 2, 
iIdx
);

135701 if–
	`sqlôe3_°ï
(
pSñe˘
)==
SQLITE_ROW
 ){

135702 
iSèπ
 = 
	`sqlôe3_cﬁumn_öt64
(
pSñe˘
, 1);

135703 
iLófEnd
 = 
	`sqlôe3_cﬁumn_öt64
(
pSñe˘
, 2);

135704 
iEnd
 = 
	`sqlôe3_cﬁumn_öt64
(
pSñe˘
, 3);

135705 
nRoŸ
 = 
	`sqlôe3_cﬁumn_byãs
(
pSñe˘
, 4);

135706 
aRoŸ
 = 
	`sqlôe3_cﬁumn_blob
(
pSñe˘
, 4);

135708  
	`sqlôe3_ª£t
(
pSñe˘
);

135712 
rc
 = 
	`·s3IsAµídabÀ
(
p
, 
iEnd
, &
bAµídabÀ
);

135715 if–
rc
==
SQLITE_OK
 && 
bAµídabÀ
 ){

135716 *
aLóf
 = 0;

135717 
nLóf
 = 0;

135719 
rc
 = 
	`sqlôe3Fts3RódBlock
(
p
, 
iLófEnd
, &
aLóf
, &
nLóf
, 0);

135720 if–
rc
==
SQLITE_OK
 ){

135721 
NodeRódî
 
ªadî
;

135722 
rc
 = 
	`nodeRódîInô
(&
ªadî
, 
aLóf
, 
nLóf
);

135723 
rc
==
SQLITE_OK
 && 
ªadî
.
aNode
;

135724 
rc
 = 
	`nodeRódîNext
(&
ªadî
)

135726 
	`as£π
–
ªadî
.
aNode
 );

135728 if–
	`·s3TîmCmp
(
zKey
, 
nKey
, 
ªadî
.
ãrm
.
a
,Ñódî.ãrm.
n
)<=0 ){

135729 
bAµídabÀ
 = 0;

135731 
	`nodeRódîRñó£
(&
ªadî
);

135733 
	`sqlôe3_‰ì
(
aLóf
);

135736 if–
rc
==
SQLITE_OK
 && 
bAµídabÀ
 ){

135739 
i
;

135740 
nHeight
 = ()
aRoŸ
[0];

135741 
NodeWrôî
 *
pNode
;

135743 
pWrôî
->
nLófE°
 = ()((
iEnd
 - 
iSèπ
Ë+ 1)/
FTS_MAX_APPENDABLE_HEIGHT
;

135744 
pWrôî
->
iSèπ
 = iStart;

135745 
pWrôî
->
iEnd
 = iEnd;

135746 
pWrôî
->
iAbsLevñ
 = iAbsLevel;

135747 
pWrôî
->
iIdx
 = iIdx;

135749 
i
=
nHeight
+1; i<
FTS_MAX_APPENDABLE_HEIGHT
; i++){

135750 
pWrôî
->
aNodeWrôî
[
i
].
iBlock
 =ÖWrôî->
iSèπ
 + i*pWrôî->
nLófE°
;

135753 
pNode
 = &
pWrôî
->
aNodeWrôî
[
nHeight
];

135754 
pNode
->
iBlock
 = 
pWrôî
->
iSèπ
 +ÖWrôî->
nLófE°
*
nHeight
;

135755 
	`blobGrowBuf„r
(&
pNode
->
block
, 
	`MAX
(
nRoŸ
, 
p
->
nNodeSize
), &
rc
);

135756 if–
rc
==
SQLITE_OK
 ){

135757 
	`mem˝y
(
pNode
->
block
.
a
, 
aRoŸ
, 
nRoŸ
);

135758 
pNode
->
block
.
n
 = 
nRoŸ
;

135761 
i
=
nHeight
; i>=0 && 
rc
==
SQLITE_OK
; i--){

135762 
NodeRódî
 
ªadî
;

135763 
pNode
 = &
pWrôî
->
aNodeWrôî
[
i
];

135765 
rc
 = 
	`nodeRódîInô
(&
ªadî
, 
pNode
->
block
.
a
,ÖNode->block.
n
);

135766  
ªadî
.
aNode
 && 
rc
==
SQLITE_OK
 )Ñ¯
	`nodeRódîNext
(&reader);

135767 
	`blobGrowBuf„r
(&
pNode
->
key
, 
ªadî
.
ãrm
.
n
, &
rc
);

135768 if–
rc
==
SQLITE_OK
 ){

135769 
	`mem˝y
(
pNode
->
key
.
a
, 
ªadî
.
ãrm
.a,Ñódî.ãrm.
n
);

135770 
pNode
->
key
.
n
 = 
ªadî
.
ãrm
.n;

135771 if–
i
>0 ){

135772 *
aBlock
 = 0;

135773 
nBlock
 = 0;

135774 
pNode
 = &
pWrôî
->
aNodeWrôî
[
i
-1];

135775 
pNode
->
iBlock
 = 
ªadî
.
iChûd
;

135776 
rc
 = 
	`sqlôe3Fts3RódBlock
(
p
, 
ªadî
.
iChûd
, &
aBlock
, &
nBlock
, 0);

135777 
	`blobGrowBuf„r
(&
pNode
->
block
, 
	`MAX
(
nBlock
, 
p
->
nNodeSize
), &
rc
);

135778 if–
rc
==
SQLITE_OK
 ){

135779 
	`mem˝y
(
pNode
->
block
.
a
, 
aBlock
, 
nBlock
);

135780 
pNode
->
block
.
n
 = 
nBlock
;

135782 
	`sqlôe3_‰ì
(
aBlock
);

135785 
	`nodeRódîRñó£
(&
ªadî
);

135789 
rc2
 = 
	`sqlôe3_ª£t
(
pSñe˘
);

135790 if–
rc
==
SQLITE_OK
 )Ñ¯
rc2
;

135793  
rc
;

135805 
	`·s3In¸mîgeOuçutIdx
(

135806 
Fts3TabÀ
 *
p
,

135807 
sqlôe3_öt64
 
iAbsLevñ
,

135808 *
piIdx


135810 
rc
;

135811 
sqlôe3_°mt
 *
pOuçutIdx
 = 0;

135813 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_NEXT_SEGMENT_INDEX
, &
pOuçutIdx
, 0);

135814 if–
rc
==
SQLITE_OK
 ){

135815 
	`sqlôe3_böd_öt64
(
pOuçutIdx
, 1, 
iAbsLevñ
+1);

135816 
	`sqlôe3_°ï
(
pOuçutIdx
);

135817 *
piIdx
 = 
	`sqlôe3_cﬁumn_öt
(
pOuçutIdx
, 0);

135818 
rc
 = 
	`sqlôe3_ª£t
(
pOuçutIdx
);

135821  
rc
;

135850 
	`·s3In¸mîgeWrôî
(

135851 
Fts3TabÀ
 *
p
,

135852 
sqlôe3_öt64
 
iAbsLevñ
,

135853 
iIdx
,

135854 
Fts3Mu…iSegRódî
 *
pC§
,

135855 
In¸mîgeWrôî
 *
pWrôî


135857 
rc
;

135858 
i
;

135859 
nLófE°
 = 0;

135860 
sqlôe3_°mt
 *
pLófE°
 = 0;

135861 
sqlôe3_°mt
 *
pFú°Block
 = 0;

135864 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_MAX_LEAF_NODE_ESTIMATE
, &
pLófE°
, 0);

135865 if–
rc
==
SQLITE_OK
 ){

135866 
	`sqlôe3_böd_öt64
(
pLófE°
, 1, 
iAbsLevñ
);

135867 
	`sqlôe3_böd_öt64
(
pLófE°
, 2, 
pC§
->
nSegmít
);

135868 if–
SQLITE_ROW
==
	`sqlôe3_°ï
(
pLófE°
) ){

135869 
nLófE°
 = 
	`sqlôe3_cﬁumn_öt
(
pLófE°
, 0);

135871 
rc
 = 
	`sqlôe3_ª£t
(
pLófE°
);

135873 if–
rc
!=
SQLITE_OK
 ) Ñc;

135876 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_NEXT_SEGMENTS_ID
, &
pFú°Block
, 0);

135877 if–
rc
==
SQLITE_OK
 ){

135878 if–
SQLITE_ROW
==
	`sqlôe3_°ï
(
pFú°Block
) ){

135879 
pWrôî
->
iSèπ
 = 
	`sqlôe3_cﬁumn_öt64
(
pFú°Block
, 0);

135880 
pWrôî
->
iEnd
 =ÖWrôî->
iSèπ
 - 1;

135881 
pWrôî
->
iEnd
 +
nLófE°
 * 
FTS_MAX_APPENDABLE_HEIGHT
;

135883 
rc
 = 
	`sqlôe3_ª£t
(
pFú°Block
);

135885 if–
rc
!=
SQLITE_OK
 ) Ñc;

135890 
rc
 = 
	`·s3WrôeSegmít
(
p
, 
pWrôî
->
iEnd
, 0, 0);

135891 if–
rc
!=
SQLITE_OK
 ) Ñc;

135893 
pWrôî
->
iAbsLevñ
 = iAbsLevel;

135894 
pWrôî
->
nLófE°
 =ÇLeafEst;

135895 
pWrôî
->
iIdx
 = iIdx;

135898 
i
=0; i<
FTS_MAX_APPENDABLE_HEIGHT
; i++){

135899 
pWrôî
->
aNodeWrôî
[
i
].
iBlock
 =ÖWrôî->
iSèπ
 + i*pWrôî->
nLófE°
;

135901  
SQLITE_OK
;

135915 
	`·s3RemoveSegdúE¡ry
(

135916 
Fts3TabÀ
 *
p
,

135917 
sqlôe3_öt64
 
iAbsLevñ
,

135918 
iIdx


135920 
rc
;

135921 
sqlôe3_°mt
 *
pDñëe
 = 0;

135923 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_DELETE_SEGDIR_ENTRY
, &
pDñëe
, 0);

135924 if–
rc
==
SQLITE_OK
 ){

135925 
	`sqlôe3_böd_öt64
(
pDñëe
, 1, 
iAbsLevñ
);

135926 
	`sqlôe3_böd_öt
(
pDñëe
, 2, 
iIdx
);

135927 
	`sqlôe3_°ï
(
pDñëe
);

135928 
rc
 = 
	`sqlôe3_ª£t
(
pDñëe
);

135931  
rc
;

135939 
	`·s3RïackSegdúLevñ
(

135940 
Fts3TabÀ
 *
p
,

135941 
sqlôe3_öt64
 
iAbsLevñ


135943 
rc
;

135944 *
aIdx
 = 0;

135945 
nIdx
 = 0;

135946 
nAŒoc
 = 0;

135947 
i
;

135948 
sqlôe3_°mt
 *
pSñe˘
 = 0;

135949 
sqlôe3_°mt
 *
pUpd©e
 = 0;

135951 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_SELECT_INDEXES
, &
pSñe˘
, 0);

135952 if–
rc
==
SQLITE_OK
 ){

135953 
rc2
;

135954 
	`sqlôe3_böd_öt64
(
pSñe˘
, 1, 
iAbsLevñ
);

135955  
SQLITE_ROW
==
	`sqlôe3_°ï
(
pSñe˘
) ){

135956 if–
nIdx
>=
nAŒoc
 ){

135957 *
aNew
;

135958 
nAŒoc
 += 16;

135959 
aNew
 = 
	`sqlôe3_ªÆloc
(
aIdx
, 
nAŒoc
*());

135960 if–!
aNew
 ){

135961 
rc
 = 
SQLITE_NOMEM
;

135964 
aIdx
 = 
aNew
;

135966 
aIdx
[
nIdx
++] = 
	`sqlôe3_cﬁumn_öt
(
pSñe˘
, 0);

135968 
rc2
 = 
	`sqlôe3_ª£t
(
pSñe˘
);

135969 if–
rc
==
SQLITE_OK
 )Ñ¯
rc2
;

135972 if–
rc
==
SQLITE_OK
 ){

135973 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_SHIFT_SEGDIR_ENTRY
, &
pUpd©e
, 0);

135975 if–
rc
==
SQLITE_OK
 ){

135976 
	`sqlôe3_böd_öt64
(
pUpd©e
, 2, 
iAbsLevñ
);

135979 
	`as£π
–
p
->
bIgn‹eSavïoöt
==0 );

135980 
p
->
bIgn‹eSavïoöt
 = 1;

135981 
i
=0; 
rc
==
SQLITE_OK
 && i<
nIdx
; i++){

135982 if–
aIdx
[
i
]!=i ){

135983 
	`sqlôe3_böd_öt
(
pUpd©e
, 3, 
aIdx
[
i
]);

135984 
	`sqlôe3_böd_öt
(
pUpd©e
, 1, 
i
);

135985 
	`sqlôe3_°ï
(
pUpd©e
);

135986 
rc
 = 
	`sqlôe3_ª£t
(
pUpd©e
);

135989 
p
->
bIgn‹eSavïoöt
 = 0;

135991 
	`sqlôe3_‰ì
(
aIdx
);

135992  
rc
;

135995 
	`·s3SèπNode
(
Blob
 *
pNode
, 
iHeight
, 
sqlôe3_öt64
 
iChûd
){

135996 
pNode
->
a
[0] = ()
iHeight
;

135997 if–
iChûd
 ){

135998 
	`as£π
–
pNode
->
nAŒoc
>=1+
	`sqlôe3Fts3V¨ötLí
(
iChûd
) );

135999 
pNode
->
n
 = 1 + 
	`sqlôe3Fts3PutV¨öt
(&pNode->
a
[1], 
iChûd
);

136001 
	`as£π
–
pNode
->
nAŒoc
>=1 );

136002 
pNode
->
n
 = 1;

136014 
	`·s3TrunˇãNode
(

136015 c⁄° *
aNode
,

136016 
nNode
,

136017 
Blob
 *
pNew
,

136018 c⁄° *
zTîm
,

136019 
nTîm
,

136020 
sqlôe3_öt64
 *
piBlock


136022 
NodeRódî
 
ªadî
;

136023 
Blob
 
¥ev
 = {0, 0, 0};

136024 
rc
 = 
SQLITE_OK
;

136025 
bLóf
 = 
aNode
[0]=='\0';

136028 
	`blobGrowBuf„r
(
pNew
, 
nNode
, &
rc
);

136029 if–
rc
!=
SQLITE_OK
 ) Ñc;

136030 
pNew
->
n
 = 0;

136033 
rc
 = 
	`nodeRódîInô
(&
ªadî
, 
aNode
, 
nNode
);

136034 
rc
==
SQLITE_OK
 && 
ªadî
.
aNode
;

136035 
rc
 = 
	`nodeRódîNext
(&
ªadî
)

136037 if–
pNew
->
n
==0 ){

136038 
ªs
 = 
	`·s3TîmCmp
(
ªadî
.
ãrm
.
a
,Ñódî.ãrm.
n
, 
zTîm
, 
nTîm
);

136039 if–
ªs
<0 || (
bLóf
==0 &&Ñes==0) ) ;

136040 
	`·s3SèπNode
(
pNew
, ()
aNode
[0], 
ªadî
.
iChûd
);

136041 *
piBlock
 = 
ªadî
.
iChûd
;

136043 
rc
 = 
	`·s3AµídToNode
(

136044 
pNew
, &
¥ev
, 
ªadî
.
ãrm
.
a
,Ñódî.ãrm.
n
,

136045 
ªadî
.
aDo˛i°
,Ñódî.
nDo˛i°


136047 if–
rc
!=
SQLITE_OK
 ) ;

136049 if–
pNew
->
n
==0 ){

136050 
	`·s3SèπNode
(
pNew
, ()
aNode
[0], 
ªadî
.
iChûd
);

136051 *
piBlock
 = 
ªadî
.
iChûd
;

136053 
	`as£π
–
pNew
->
n
<ıNew->
nAŒoc
 );

136055 
	`nodeRódîRñó£
(&
ªadî
);

136056 
	`sqlôe3_‰ì
(
¥ev
.
a
);

136057  
rc
;

136069 
	`·s3TrunˇãSegmít
(

136070 
Fts3TabÀ
 *
p
,

136071 
sqlôe3_öt64
 
iAbsLevñ
,

136072 
iIdx
,

136073 c⁄° *
zTîm
,

136074 
nTîm


136076 
rc
 = 
SQLITE_OK
;

136077 
Blob
 
roŸ
 = {0,0,0};

136078 
Blob
 
block
 = {0,0,0};

136079 
sqlôe3_öt64
 
iBlock
 = 0;

136080 
sqlôe3_öt64
 
iNewSèπ
 = 0;

136081 
sqlôe3_öt64
 
iOldSèπ
 = 0;

136082 
sqlôe3_°mt
 *
pFëch
 = 0;

136084 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_SELECT_SEGDIR
, &
pFëch
, 0);

136085 if–
rc
==
SQLITE_OK
 ){

136086 
rc2
;

136087 
	`sqlôe3_böd_öt64
(
pFëch
, 1, 
iAbsLevñ
);

136088 
	`sqlôe3_böd_öt
(
pFëch
, 2, 
iIdx
);

136089 if–
SQLITE_ROW
==
	`sqlôe3_°ï
(
pFëch
) ){

136090 c⁄° *
aRoŸ
 = 
	`sqlôe3_cﬁumn_blob
(
pFëch
, 4);

136091 
nRoŸ
 = 
	`sqlôe3_cﬁumn_byãs
(
pFëch
, 4);

136092 
iOldSèπ
 = 
	`sqlôe3_cﬁumn_öt64
(
pFëch
, 1);

136093 
rc
 = 
	`·s3TrunˇãNode
(
aRoŸ
, 
nRoŸ
, &
roŸ
, 
zTîm
, 
nTîm
, &
iBlock
);

136095 
rc2
 = 
	`sqlôe3_ª£t
(
pFëch
);

136096 if–
rc
==
SQLITE_OK
 )Ñ¯
rc2
;

136099  
rc
==
SQLITE_OK
 && 
iBlock
 ){

136100 *
aBlock
 = 0;

136101 
nBlock
 = 0;

136102 
iNewSèπ
 = 
iBlock
;

136104 
rc
 = 
	`sqlôe3Fts3RódBlock
(
p
, 
iBlock
, &
aBlock
, &
nBlock
, 0);

136105 if–
rc
==
SQLITE_OK
 ){

136106 
rc
 = 
	`·s3TrunˇãNode
(
aBlock
, 
nBlock
, &
block
, 
zTîm
, 
nTîm
, &
iBlock
);

136108 if–
rc
==
SQLITE_OK
 ){

136109 
rc
 = 
	`·s3WrôeSegmít
(
p
, 
iNewSèπ
, 
block
.
a
, block.
n
);

136111 
	`sqlôe3_‰ì
(
aBlock
);

136115 if–
rc
==
SQLITE_OK
 && 
iNewSèπ
 ){

136116 
sqlôe3_°mt
 *
pDñ
 = 0;

136117 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_DELETE_SEGMENTS_RANGE
, &
pDñ
, 0);

136118 if–
rc
==
SQLITE_OK
 ){

136119 
	`sqlôe3_böd_öt64
(
pDñ
, 1, 
iOldSèπ
);

136120 
	`sqlôe3_böd_öt64
(
pDñ
, 2, 
iNewSèπ
-1);

136121 
	`sqlôe3_°ï
(
pDñ
);

136122 
rc
 = 
	`sqlôe3_ª£t
(
pDñ
);

136126 if–
rc
==
SQLITE_OK
 ){

136127 
sqlôe3_°mt
 *
pChomp
 = 0;

136128 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_CHOMP_SEGDIR
, &
pChomp
, 0);

136129 if–
rc
==
SQLITE_OK
 ){

136130 
	`sqlôe3_böd_öt64
(
pChomp
, 1, 
iNewSèπ
);

136131 
	`sqlôe3_böd_blob
(
pChomp
, 2, 
roŸ
.
a
,ÑoŸ.
n
, 
SQLITE_STATIC
);

136132 
	`sqlôe3_böd_öt64
(
pChomp
, 3, 
iAbsLevñ
);

136133 
	`sqlôe3_böd_öt
(
pChomp
, 4, 
iIdx
);

136134 
	`sqlôe3_°ï
(
pChomp
);

136135 
rc
 = 
	`sqlôe3_ª£t
(
pChomp
);

136139 
	`sqlôe3_‰ì
(
roŸ
.
a
);

136140 
	`sqlôe3_‰ì
(
block
.
a
);

136141  
rc
;

136154 
	`·s3In¸mîgeChomp
(

136155 
Fts3TabÀ
 *
p
,

136156 
sqlôe3_öt64
 
iAbsLevñ
,

136157 
Fts3Mu…iSegRódî
 *
pC§
,

136158 *
≤Rem


136160 
i
;

136161 
nRem
 = 0;

136162 
rc
 = 
SQLITE_OK
;

136164 
i
=
pC§
->
nSegmít
-1; i>=0 && 
rc
==
SQLITE_OK
; i--){

136165 
Fts3SegRódî
 *
pSeg
 = 0;

136166 
j
;

136170 
j
=0; 
	`ALWAYS
(j<
pC§
->
nSegmít
); j++){

136171 
pSeg
 = 
pC§
->
≠Segmít
[
j
];

136172 if–
pSeg
->
iIdx
==
i
 ) ;

136174 
	`as£π
–
j
<
pC§
->
nSegmít
 && 
pSeg
->
iIdx
==
i
 );

136176 if–
pSeg
->
aNode
==0 ){

136178 
rc
 = 
	`·s3DñëeSegmít
(
p
, 
pSeg
);

136179 if–
rc
==
SQLITE_OK
 ){

136180 
rc
 = 
	`·s3RemoveSegdúE¡ry
(
p
, 
iAbsLevñ
, 
pSeg
->
iIdx
);

136182 *
≤Rem
 = 0;

136187 c⁄° *
zTîm
 = 
pSeg
->zTerm;

136188 
nTîm
 = 
pSeg
->nTerm;

136189 
rc
 = 
	`·s3TrunˇãSegmít
(
p
, 
iAbsLevñ
, 
pSeg
->
iIdx
, 
zTîm
, 
nTîm
);

136190 
nRem
++;

136194 if–
rc
==
SQLITE_OK
 && 
nRem
!=
pC§
->
nSegmít
 ){

136195 
rc
 = 
	`·s3RïackSegdúLevñ
(
p
, 
iAbsLevñ
);

136198 *
≤Rem
 = 
nRem
;

136199  
rc
;

136205 
	`·s3In¸mîgeHötSt‹e
(
Fts3TabÀ
 *
p
, 
Blob
 *
pHöt
){

136206 
sqlôe3_°mt
 *
pRïœ˚
 = 0;

136207 
rc
;

136209 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_REPLACE_STAT
, &
pRïœ˚
, 0);

136210 if–
rc
==
SQLITE_OK
 ){

136211 
	`sqlôe3_böd_öt
(
pRïœ˚
, 1, 
FTS_STAT_INCRMERGEHINT
);

136212 
	`sqlôe3_böd_blob
(
pRïœ˚
, 2, 
pHöt
->
a
,ÖHöt->
n
, 
SQLITE_STATIC
);

136213 
	`sqlôe3_°ï
(
pRïœ˚
);

136214 
rc
 = 
	`sqlôe3_ª£t
(
pRïœ˚
);

136217  
rc
;

136228 
	`·s3In¸mîgeHötLﬂd
(
Fts3TabÀ
 *
p
, 
Blob
 *
pHöt
){

136229 
sqlôe3_°mt
 *
pSñe˘
 = 0;

136230 
rc
;

136232 
pHöt
->
n
 = 0;

136233 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_SELECT_STAT
, &
pSñe˘
, 0);

136234 if–
rc
==
SQLITE_OK
 ){

136235 
rc2
;

136236 
	`sqlôe3_böd_öt
(
pSñe˘
, 1, 
FTS_STAT_INCRMERGEHINT
);

136237 if–
SQLITE_ROW
==
	`sqlôe3_°ï
(
pSñe˘
) ){

136238 c⁄° *
aHöt
 = 
	`sqlôe3_cﬁumn_blob
(
pSñe˘
, 0);

136239 
nHöt
 = 
	`sqlôe3_cﬁumn_byãs
(
pSñe˘
, 0);

136240 if–
aHöt
 ){

136241 
	`blobGrowBuf„r
(
pHöt
, 
nHöt
, &
rc
);

136242 if–
rc
==
SQLITE_OK
 ){

136243 
	`mem˝y
(
pHöt
->
a
, 
aHöt
, 
nHöt
);

136244 
pHöt
->
n
 = 
nHöt
;

136248 
rc2
 = 
	`sqlôe3_ª£t
(
pSñe˘
);

136249 if–
rc
==
SQLITE_OK
 )Ñ¯
rc2
;

136252  
rc
;

136264 
	`·s3In¸mîgeHötPush
(

136265 
Blob
 *
pHöt
,

136266 
i64
 
iAbsLevñ
,

136267 
nI≈ut
,

136268 *
pRc


136270 
	`blobGrowBuf„r
(
pHöt
,ÖHöt->
n
 + 2*
FTS3_VARINT_MAX
, 
pRc
);

136271 if–*
pRc
==
SQLITE_OK
 ){

136272 
pHöt
->
n
 +
	`sqlôe3Fts3PutV¨öt
(&pHöt->
a
[pHöt->n], 
iAbsLevñ
);

136273 
pHöt
->
n
 +
	`sqlôe3Fts3PutV¨öt
(&pHöt->
a
[pHöt->n], (
i64
)
nI≈ut
);

136285 
	`·s3In¸mîgeHötP›
(
Blob
 *
pHöt
, 
i64
 *
piAbsLevñ
, *
≤I≈ut
){

136286 c⁄° 
nHöt
 = 
pHöt
->
n
;

136287 
i
;

136289 
i
 = 
pHöt
->
n
-2;

136290  
i
>0 && (
pHöt
->
a
[i-1] & 0x80) ) i--;

136291  
i
>0 && (
pHöt
->
a
[i-1] & 0x80) ) i--;

136293 
pHöt
->
n
 = 
i
;

136294 
i
 +
	`sqlôe3Fts3GëV¨öt
(&
pHöt
->
a
[i], 
piAbsLevñ
);

136295 
i
 +
	`sqlôe3Fts3GëV¨öt32
(&
pHöt
->
a
[i], 
≤I≈ut
);

136296 if–
i
!=
nHöt
 )  
SQLITE_CORRUPT_VTAB
;

136298  
SQLITE_OK
;

136311 
SQLITE_PRIVATE
 
	`sqlôe3Fts3In¸mîge
(
Fts3TabÀ
 *
p
, 
nMîge
, 
nMö
){

136312 
rc
;

136313 
nRem
 = 
nMîge
;

136314 
Fts3Mu…iSegRódî
 *
pC§
;

136315 
Fts3SegFûãr
 *
pFûãr
;

136316 
In¸mîgeWrôî
 *
pWrôî
;

136317 
nSeg
 = 0;

136318 
sqlôe3_öt64
 
iAbsLevñ
 = 0;

136319 
Blob
 
höt
 = {0, 0, 0};

136320 
bDútyHöt
 = 0;

136323 c⁄° 
nAŒoc
 = (*
pC§
Ë+ (*
pFûãr
Ë+ (*
pWrôî
);

136324 
pWrôî
 = (
In¸mîgeWrôî
 *)
	`sqlôe3_mÆloc
(
nAŒoc
);

136325 if–!
pWrôî
 )  
SQLITE_NOMEM
;

136326 
pFûãr
 = (
Fts3SegFûãr
 *)&
pWrôî
[1];

136327 
pC§
 = (
Fts3Mu…iSegRódî
 *)&
pFûãr
[1];

136329 
rc
 = 
	`·s3In¸mîgeHötLﬂd
(
p
, &
höt
);

136330  
rc
==
SQLITE_OK
 && 
nRem
>0 ){

136331 c⁄° 
i64
 
nMod
 = 
FTS3_SEGDIR_MAXLEVEL
 * 
p
->
nIndex
;

136332 
sqlôe3_°mt
 *
pFödLevñ
 = 0;

136333 
bU£Höt
 = 0;

136341 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_FIND_MERGE_LEVEL
, &
pFödLevñ
, 0);

136342 
	`sqlôe3_böd_öt
(
pFödLevñ
, 1, 
nMö
);

136343 if–
	`sqlôe3_°ï
(
pFödLevñ
)==
SQLITE_ROW
 ){

136344 
iAbsLevñ
 = 
	`sqlôe3_cﬁumn_öt64
(
pFödLevñ
, 0);

136345 
nSeg
 = 
nMö
;

136347 
nSeg
 = -1;

136349 
rc
 = 
	`sqlôe3_ª£t
(
pFödLevñ
);

136356 if–
rc
==
SQLITE_OK
 && 
höt
.
n
 ){

136357 
nHöt
 = 
höt
.
n
;

136358 
sqlôe3_öt64
 
iHötAbsLevñ
 = 0;

136359 
nHötSeg
 = 0;

136361 
rc
 = 
	`·s3In¸mîgeHötP›
(&
höt
, &
iHötAbsLevñ
, &
nHötSeg
);

136362 if–
nSeg
<0 || (
iAbsLevñ
 % 
nMod
Ë>(
iHötAbsLevñ
 %ÇMod) ){

136363 
iAbsLevñ
 = 
iHötAbsLevñ
;

136364 
nSeg
 = 
nHötSeg
;

136365 
bU£Höt
 = 1;

136366 
bDútyHöt
 = 1;

136370 
höt
.
n
 = 
nHöt
;

136377 if–
nSeg
<0 ) ;

136385 
	`mem£t
(
pWrôî
, 0, 
nAŒoc
);

136386 
pFûãr
->
Êags
 = 
FTS3_SEGMENT_REQUIRE_POS
;

136387 if–
rc
==
SQLITE_OK
 ){

136388 
rc
 = 
	`·s3In¸mîgeC§
(
p
, 
iAbsLevñ
, 
nSeg
, 
pC§
);

136390 if–
SQLITE_OK
==
rc
 && 
pC§
->
nSegmít
==
nSeg


136391 && 
SQLITE_OK
==(
rc
 = 
	`sqlôe3Fts3SegRódîSèπ
(
p
, 
pC§
, 
pFûãr
))

136392 && 
SQLITE_ROW
==(
rc
 = 
	`sqlôe3Fts3SegRódîSãp
(
p
, 
pC§
))

136394 
iIdx
 = 0;

136395 
rc
 = 
	`·s3In¸mîgeOuçutIdx
(
p
, 
iAbsLevñ
, &
iIdx
);

136396 if–
rc
==
SQLITE_OK
 ){

136397 if–
bU£Höt
 && 
iIdx
>0 ){

136398 c⁄° *
zKey
 = 
pC§
->
zTîm
;

136399 
nKey
 = 
pC§
->
nTîm
;

136400 
rc
 = 
	`·s3In¸mîgeLﬂd
(
p
, 
iAbsLevñ
, 
iIdx
-1, 
zKey
, 
nKey
, 
pWrôî
);

136402 
rc
 = 
	`·s3In¸mîgeWrôî
(
p
, 
iAbsLevñ
, 
iIdx
, 
pC§
, 
pWrôî
);

136406 if–
rc
==
SQLITE_OK
 && 
pWrôî
->
nLófE°
 ){

136407 
	`·s3LogMîge
(
nSeg
, 
iAbsLevñ
);

136409 
rc
 = 
	`·s3In¸mîgeAµíd
(
p
, 
pWrôî
, 
pC§
);

136410 if–
rc
==
SQLITE_OK
 )Ñ¯
	`sqlôe3Fts3SegRódîSãp
(
p
, 
pC§
);

136411 if–
pWrôî
->
nW‹k
>=
nRem
 && 
rc
==
SQLITE_ROW
 )Ñ¯
SQLITE_OK
;

136412 } 
rc
==
SQLITE_ROW
 );

136415 if–
rc
==
SQLITE_OK
 ){

136416 
nRem
 -(1 + 
pWrôî
->
nW‹k
);

136417 
rc
 = 
	`·s3In¸mîgeChomp
(
p
, 
iAbsLevñ
, 
pC§
, &
nSeg
);

136418 if–
nSeg
!=0 ){

136419 
bDútyHöt
 = 1;

136420 
	`·s3In¸mîgeHötPush
(&
höt
, 
iAbsLevñ
, 
nSeg
, &
rc
);

136425 
	`·s3In¸mîgeRñó£
(
p
, 
pWrôî
, &
rc
);

136428 
	`sqlôe3Fts3SegRódîFöish
(
pC§
);

136432 if–
bDútyHöt
 && 
rc
==
SQLITE_OK
 ){

136433 
rc
 = 
	`·s3In¸mîgeHötSt‹e
(
p
, &
höt
);

136436 
	`sqlôe3_‰ì
(
pWrôî
);

136437 
	`sqlôe3_‰ì
(
höt
.
a
);

136438  
rc
;

136446 
	`·s3Gëöt
(c⁄° **
pz
){

136447 c⁄° *
z
 = *
pz
;

136448 
i
 = 0;

136449  (*
z
)>='0' && (*z)<='9' ) 
i
 = 10*i + *(z++) - '0';

136450 *
pz
 = 
z
;

136451  
i
;

136463 
	`·s3DoIn¸mîge
(

136464 
Fts3TabÀ
 *
p
,

136465 c⁄° *
zP¨am


136467 
rc
;

136468 
nMö
 = (
FTS3_MERGE_COUNT
 / 2);

136469 
nMîge
 = 0;

136470 c⁄° *
z
 = 
zP¨am
;

136473 
nMîge
 = 
	`·s3Gëöt
(&
z
);

136477 if–
z
[0]==',' && z[1]!='\0' ){

136478 
z
++;

136479 
nMö
 = 
	`·s3Gëöt
(&
z
);

136482 if–
z
[0]!='\0' || 
nMö
<2 ){

136483 
rc
 = 
SQLITE_ERROR
;

136485 
rc
 = 
SQLITE_OK
;

136486 if–!
p
->
bHasSèt
 ){

136487 
	`as£π
–
p
->
bFts4
==0 );

136488 
	`sqlôe3Fts3Cª©eSètTabÀ
(&
rc
, 
p
);

136490 if–
rc
==
SQLITE_OK
 ){

136491 
rc
 = 
	`sqlôe3Fts3In¸mîge
(
p
, 
nMîge
, 
nMö
);

136493 
	`sqlôe3Fts3SegmítsClo£
(
p
);

136495  
rc
;

136506 
	`·s3DoAutoö¸mîge
(

136507 
Fts3TabÀ
 *
p
,

136508 c⁄° *
zP¨am


136510 
rc
 = 
SQLITE_OK
;

136511 
sqlôe3_°mt
 *
pStmt
 = 0;

136512 
p
->
bAutoö¸mîge
 = 
	`·s3Gëöt
(&
zP¨am
)!=0;

136513 if–!
p
->
bHasSèt
 ){

136514 
	`as£π
–
p
->
bFts4
==0 );

136515 
	`sqlôe3Fts3Cª©eSètTabÀ
(&
rc
, 
p
);

136516 if–
rc
 ) Ñc;

136518 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_REPLACE_STAT
, &
pStmt
, 0);

136519 if–
rc
 ) Ñc;

136520 
	`sqlôe3_böd_öt
(
pStmt
, 1, 
FTS_STAT_AUTOINCRMERGE
);

136521 
	`sqlôe3_böd_öt
(
pStmt
, 2, 
p
->
bAutoö¸mîge
);

136522 
	`sqlôe3_°ï
(
pStmt
);

136523 
rc
 = 
	`sqlôe3_ª£t
(
pStmt
);

136524  
rc
;

136531 
u64
 
	`·s3ChecksumE¡ry
(

136532 c⁄° *
zTîm
,

136533 
nTîm
,

136534 
iL™gid
,

136535 
iIndex
,

136536 
i64
 
iDocid
,

136537 
iCﬁ
,

136538 
iPos


136540 
i
;

136541 
u64
 
ªt
 = (u64)
iDocid
;

136543 
ªt
 +‘ë<<3Ë+ 
iL™gid
;

136544 
ªt
 +‘ë<<3Ë+ 
iIndex
;

136545 
ªt
 +‘ë<<3Ë+ 
iCﬁ
;

136546 
ªt
 +‘ë<<3Ë+ 
iPos
;

136547 
i
=0; i<
nTîm
; i++Ë
ªt
 +‘ë<<3Ë+ 
zTîm
[i];

136549  
ªt
;

136561 
u64
 
	`·s3ChecksumIndex
(

136562 
Fts3TabÀ
 *
p
,

136563 
iL™gid
,

136564 
iIndex
,

136565 *
pRc


136567 
Fts3SegFûãr
 
fûãr
;

136568 
Fts3Mu…iSegRódî
 
c§
;

136569 
rc
;

136570 
u64
 
cksum
 = 0;

136572 
	`as£π
–*
pRc
==
SQLITE_OK
 );

136574 
	`mem£t
(&
fûãr
, 0, (filter));

136575 
	`mem£t
(&
c§
, 0, (csr));

136576 
fûãr
.
Êags
 = 
FTS3_SEGMENT_REQUIRE_POS
|
FTS3_SEGMENT_IGNORE_EMPTY
;

136577 
fûãr
.
Êags
 |
FTS3_SEGMENT_SCAN
;

136579 
rc
 = 
	`sqlôe3Fts3SegRódîCurs‹
(

136580 
p
, 
iL™gid
, 
iIndex
, 
FTS3_SEGCURSOR_ALL
, 0, 0, 0, 1,&
c§


136582 if–
rc
==
SQLITE_OK
 ){

136583 
rc
 = 
	`sqlôe3Fts3SegRódîSèπ
(
p
, &
c§
, &
fûãr
);

136586 if–
rc
==
SQLITE_OK
 ){

136587  
SQLITE_ROW
==(
rc
 = 
	`sqlôe3Fts3SegRódîSãp
(
p
, &
c§
)) ){

136588 *
pC§
 = 
c§
.
aDo˛i°
;

136589 *
pEnd
 = &
pC§
[
c§
.
nDo˛i°
];

136591 
i64
 
iDocid
 = 0;

136592 
i64
 
iCﬁ
 = 0;

136593 
i64
 
iPos
 = 0;

136595 
pC§
 +
	`sqlôe3Fts3GëV¨öt
’C§, &
iDocid
);

136596  
pC§
<
pEnd
 ){

136597 
i64
 
iVÆ
 = 0;

136598 
pC§
 +
	`sqlôe3Fts3GëV¨öt
’C§, &
iVÆ
);

136599 if–
pC§
<
pEnd
 ){

136600 if–
iVÆ
==0 || iVal==1 ){

136601 
iCﬁ
 = 0;

136602 
iPos
 = 0;

136603 if–
iVÆ
 ){

136604 
pC§
 +
	`sqlôe3Fts3GëV¨öt
’C§, &
iCﬁ
);

136606 
pC§
 +
	`sqlôe3Fts3GëV¨öt
’C§, &
iVÆ
);

136607 
iDocid
 +
iVÆ
;

136610 
iPos
 +(
iVÆ
 - 2);

136611 
cksum
 = cksum ^ 
	`·s3ChecksumE¡ry
(

136612 
c§
.
zTîm
, c§.
nTîm
, 
iL™gid
, 
iIndex
, 
iDocid
,

136613 ()
iCﬁ
, ()
iPos


136620 
	`sqlôe3Fts3SegRódîFöish
(&
c§
);

136622 *
pRc
 = 
rc
;

136623  
cksum
;

136635 
	`·s3I¡egrôyCheck
(
Fts3TabÀ
 *
p
, *
pbOk
){

136636 
rc
 = 
SQLITE_OK
;

136637 
u64
 
cksum1
 = 0;

136638 
u64
 
cksum2
 = 0;

136639 
sqlôe3_°mt
 *
pAŒL™gid
 = 0;

136642 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_SELECT_ALL_LANGID
, &
pAŒL™gid
, 0);

136643 if–
rc
==
SQLITE_OK
 ){

136644 
rc2
;

136645 
	`sqlôe3_böd_öt
(
pAŒL™gid
, 1, 
p
->
nIndex
);

136646  
rc
==
SQLITE_OK
 && 
	`sqlôe3_°ï
(
pAŒL™gid
)==
SQLITE_ROW
 ){

136647 
iL™gid
 = 
	`sqlôe3_cﬁumn_öt
(
pAŒL™gid
, 0);

136648 
i
;

136649 
i
=0; i<
p
->
nIndex
; i++){

136650 
cksum1
 = cksum1 ^ 
	`·s3ChecksumIndex
(
p
, 
iL™gid
, 
i
, &
rc
);

136653 
rc2
 = 
	`sqlôe3_ª£t
(
pAŒL™gid
);

136654 if–
rc
==
SQLITE_OK
 )Ñ¯
rc2
;

136658 
rc
 = 
	`·s3SqlStmt
(
p
, 
SQL_SELECT_ALL_LANGID
, &
pAŒL™gid
, 0);

136659 if–
rc
==
SQLITE_OK
 ){

136660 
sqlôe3_tokíizî_moduÀ
 c⁄° *
pModuÀ
 = 
p
->
pTokíizî
->pModule;

136661 
sqlôe3_°mt
 *
pStmt
 = 0;

136662 *
zSql
;

136664 
zSql
 = 
	`sqlôe3_m¥ötf
("SELECT %s" , 
p
->
zRódEx¥li°
);

136665 if–!
zSql
 ){

136666 
rc
 = 
SQLITE_NOMEM
;

136668 
rc
 = 
	`sqlôe3_¥ï¨e_v2
(
p
->
db
, 
zSql
, -1, &
pStmt
, 0);

136669 
	`sqlôe3_‰ì
(
zSql
);

136672  
rc
==
SQLITE_OK
 && 
SQLITE_ROW
==
	`sqlôe3_°ï
(
pStmt
) ){

136673 
i64
 
iDocid
 = 
	`sqlôe3_cﬁumn_öt64
(
pStmt
, 0);

136674 
iL™g
 = 
	`œngidFromSñe˘
(
p
, 
pStmt
);

136675 
iCﬁ
;

136677 
iCﬁ
=0; 
rc
==
SQLITE_OK
 && iCﬁ<
p
->
nCﬁumn
; iCol++){

136678 c⁄° *
zText
 = (c⁄° *)
	`sqlôe3_cﬁumn_ãxt
(
pStmt
, 
iCﬁ
+1);

136679 
nText
 = 
	`sqlôe3_cﬁumn_byãs
(
pStmt
, 
iCﬁ
+1);

136680 
sqlôe3_tokíizî_curs‹
 *
pT
 = 0;

136682 
rc
 = 
	`sqlôe3Fts3O≥nTokíizî
(
p
->
pTokíizî
, 
iL™g
, 
zText
, 
nText
, &
pT
);

136683  
rc
==
SQLITE_OK
 ){

136684 c⁄° *
zTokí
;

136685 
nTokí
 = 0;

136686 
iDum1
 = 0, 
iDum2
 = 0;

136687 
iPos
 = 0;

136689 
rc
 = 
pModuÀ
->
	`xNext
(
pT
, &
zTokí
, &
nTokí
, &
iDum1
, &
iDum2
, &
iPos
);

136690 if–
rc
==
SQLITE_OK
 ){

136691 
i
;

136692 
cksum2
 = cksum2 ^ 
	`·s3ChecksumE¡ry
(

136693 
zTokí
, 
nTokí
, 
iL™g
, 0, 
iDocid
, 
iCﬁ
, 
iPos


136695 
i
=1; i<
p
->
nIndex
; i++){

136696 if–
p
->
aIndex
[
i
].
nPªfix
<=
nTokí
 ){

136697 
cksum2
 = cksum2 ^ 
	`·s3ChecksumE¡ry
(

136698 
zTokí
, 
p
->
aIndex
[
i
].
nPªfix
, 
iL™g
, i, 
iDocid
, 
iCﬁ
, 
iPos


136704 if–
pT
 ) 
pModuÀ
->
	`xClo£
(pT);

136705 if–
rc
==
SQLITE_DONE
 )Ñ¯
SQLITE_OK
;

136709 
	`sqlôe3_föÆize
(
pStmt
);

136712 *
pbOk
 = (
cksum1
==
cksum2
);

136713  
rc
;

136747 
	`·s3DoI¡egrôyCheck
(

136748 
Fts3TabÀ
 *
p


136750 
rc
;

136751 
bOk
 = 0;

136752 
rc
 = 
	`·s3I¡egrôyCheck
(
p
, &
bOk
);

136753 if–
rc
==
SQLITE_OK
 && 
bOk
==0 )Ñ¯
SQLITE_CORRUPT_VTAB
;

136754  
rc
;

136765 
	`·s3S≥cülIn£π
(
Fts3TabÀ
 *
p
, 
sqlôe3_vÆue
 *
pVÆ
){

136766 
rc
;

136767 c⁄° *
zVÆ
 = (c⁄° *)
	`sqlôe3_vÆue_ãxt
(
pVÆ
);

136768 
nVÆ
 = 
	`sqlôe3_vÆue_byãs
(
pVÆ
);

136770 if–!
zVÆ
 ){

136771  
SQLITE_NOMEM
;

136772 }if–
nVÆ
==8 && 0==
	`sqlôe3_°∫icmp
(
zVÆ
, "optimize", 8) ){

136773 
rc
 = 
	`·s3DoO±imize
(
p
, 0);

136774 }if–
nVÆ
==7 && 0==
	`sqlôe3_°∫icmp
(
zVÆ
, "rebuild", 7) ){

136775 
rc
 = 
	`·s3DoRebuûd
(
p
);

136776 }if–
nVÆ
==15 && 0==
	`sqlôe3_°∫icmp
(
zVÆ
, "integrity-check", 15) ){

136777 
rc
 = 
	`·s3DoI¡egrôyCheck
(
p
);

136778 }if–
nVÆ
>6 && 0==
	`sqlôe3_°∫icmp
(
zVÆ
, "merge=", 6) ){

136779 
rc
 = 
	`·s3DoIn¸mîge
(
p
, &
zVÆ
[6]);

136780 }if–
nVÆ
>10 && 0==
	`sqlôe3_°∫icmp
(
zVÆ
, "automerge=", 10) ){

136781 
rc
 = 
	`·s3DoAutoö¸mîge
(
p
, &
zVÆ
[10]);

136782 #ifde‡
SQLITE_TEST


136783 }if–
nVÆ
>9 && 0==
	`sqlôe3_°∫icmp
(
zVÆ
, "nodesize=", 9) ){

136784 
p
->
nNodeSize
 = 
	`©oi
(&
zVÆ
[9]);

136785 
rc
 = 
SQLITE_OK
;

136786 }if–
nVÆ
>11 && 0==
	`sqlôe3_°∫icmp
(
zVÆ
, "maxpending=", 9) ){

136787 
p
->
nMaxPídögD©a
 = 
	`©oi
(&
zVÆ
[11]);

136788 
rc
 = 
SQLITE_OK
;

136789 }if–
nVÆ
>21 && 0==
	`sqlôe3_°∫icmp
(
zVÆ
, "test-no-incr-doclist=", 21) ){

136790 
p
->
bNoIn¸Do˛i°
 = 
	`©oi
(&
zVÆ
[21]);

136791 
rc
 = 
SQLITE_OK
;

136794 
rc
 = 
SQLITE_ERROR
;

136797  
rc
;

136800 #i‚de‡
SQLITE_DISABLE_FTS4_DEFERRED


136805 
SQLITE_PRIVATE
 
	`sqlôe3Fts3FªeDe„ºedDo˛i°s
(
Fts3Curs‹
 *
pC§
){

136806 
Fts3De„ºedTokí
 *
pDef
;

136807 
pDef
=
pC§
->
pDe„ºed
;ÖDef;ÖDefıDef->
pNext
){

136808 
	`·s3PídögLi°Dñëe
(
pDef
->
pLi°
);

136809 
pDef
->
pLi°
 = 0;

136817 
SQLITE_PRIVATE
 
	`sqlôe3Fts3FªeDe„ºedTokís
(
Fts3Curs‹
 *
pC§
){

136818 
Fts3De„ºedTokí
 *
pDef
;

136819 
Fts3De„ºedTokí
 *
pNext
;

136820 
pDef
=
pC§
->
pDe„ºed
;ÖDef;ÖDef=
pNext
){

136821 
pNext
 = 
pDef
->pNext;

136822 
	`·s3PídögLi°Dñëe
(
pDef
->
pLi°
);

136823 
	`sqlôe3_‰ì
(
pDef
);

136825 
pC§
->
pDe„ºed
 = 0;

136836 
SQLITE_PRIVATE
 
	`sqlôe3Fts3CacheDe„ºedDo˛i°s
(
Fts3Curs‹
 *
pC§
){

136837 
rc
 = 
SQLITE_OK
;

136838 if–
pC§
->
pDe„ºed
 ){

136839 
i
;

136840 
sqlôe3_öt64
 
iDocid
;

136841 
Fts3De„ºedTokí
 *
pDef
;

136843 
Fts3TabÀ
 *
p
 = (Fts3TabÀ *)
pC§
->
ba£
.
pVèb
;

136844 
sqlôe3_tokíizî
 *
pT
 = 
p
->
pTokíizî
;

136845 
sqlôe3_tokíizî_moduÀ
 c⁄° *
pModuÀ
 = 
pT
->pModule;

136847 
	`as£π
–
pC§
->
isRequúeSìk
==0 );

136848 
iDocid
 = 
	`sqlôe3_cﬁumn_öt64
(
pC§
->
pStmt
, 0);

136850 
i
=0; i<
p
->
nCﬁumn
 && 
rc
==
SQLITE_OK
; i++){

136851 if–
p
->
abNŸödexed
[
i
]==0 ){

136852 c⁄° *
zText
 = (c⁄° *)
	`sqlôe3_cﬁumn_ãxt
(
pC§
->
pStmt
, 
i
+1);

136853 
sqlôe3_tokíizî_curs‹
 *
pTC
 = 0;

136855 
rc
 = 
	`sqlôe3Fts3O≥nTokíizî
(
pT
, 
pC§
->
iL™gid
, 
zText
, -1, &
pTC
);

136856  
rc
==
SQLITE_OK
 ){

136857 c⁄° *
zTokí
;

136858 
nTokí
 = 0;

136859 
iDum1
 = 0, 
iDum2
 = 0;

136860 
iPos
 = 0;

136862 
rc
 = 
pModuÀ
->
	`xNext
(
pTC
, &
zTokí
, &
nTokí
, &
iDum1
, &
iDum2
, &
iPos
);

136863 
pDef
=
pC§
->
pDe„ºed
;ÖDe‡&& 
rc
==
SQLITE_OK
;ÖDefıDef->
pNext
){

136864 
Fts3Phø£Tokí
 *
pPT
 = 
pDef
->
pTokí
;

136865 if–(
pDef
->
iCﬁ
>=
p
->
nCﬁumn
 ||ÖDef->iCﬁ==
i
)

136866 && (
pPT
->
bFú°
==0 || 
iPos
==0)

136867 && (
pPT
->
n
==
nTokí
 || (pPT->
isPªfix
 &&ÖPT->n<nToken))

136868 && (0==
	`memcmp
(
zTokí
, 
pPT
->
z
,ÖPT->
n
))

136870 
	`·s3PídögLi°Aµíd
(&
pDef
->
pLi°
, 
iDocid
, 
i
, 
iPos
, &
rc
);

136874 if–
pTC
 ) 
pModuÀ
->
	`xClo£
(pTC);

136875 if–
rc
==
SQLITE_DONE
 )Ñ¯
SQLITE_OK
;

136879 
pDef
=
pC§
->
pDe„ºed
;ÖDe‡&& 
rc
==
SQLITE_OK
;ÖDefıDef->
pNext
){

136880 if–
pDef
->
pLi°
 ){

136881 
rc
 = 
	`·s3PídögLi°AµídV¨öt
(&
pDef
->
pLi°
, 0);

136886  
rc
;

136889 
SQLITE_PRIVATE
 
	`sqlôe3Fts3De„ºedTokíLi°
(

136890 
Fts3De„ºedTokí
 *
p
,

136891 **
µD©a
,

136892 *
≤D©a


136894 *
pRë
;

136895 
nSkù
;

136896 
sqlôe3_öt64
 
dummy
;

136898 *
µD©a
 = 0;

136899 *
≤D©a
 = 0;

136901 if–
p
->
pLi°
==0 ){

136902  
SQLITE_OK
;

136905 
pRë
 = (*)
	`sqlôe3_mÆloc
(
p
->
pLi°
->
nD©a
);

136906 if–!
pRë
 )  
SQLITE_NOMEM
;

136908 
nSkù
 = 
	`sqlôe3Fts3GëV¨öt
(
p
->
pLi°
->
aD©a
, &
dummy
);

136909 *
≤D©a
 = 
p
->
pLi°
->
nD©a
 - 
nSkù
;

136910 *
µD©a
 = 
pRë
;

136912 
	`mem˝y
(
pRë
, &
p
->
pLi°
->
aD©a
[
nSkù
], *
≤D©a
);

136913  
SQLITE_OK
;

136919 
SQLITE_PRIVATE
 
	`sqlôe3Fts3De„rTokí
(

136920 
Fts3Curs‹
 *
pC§
,

136921 
Fts3Phø£Tokí
 *
pTokí
,

136922 
iCﬁ


136924 
Fts3De„ºedTokí
 *
pDe„ºed
;

136925 
pDe„ºed
 = 
	`sqlôe3_mÆloc
((*pDeferred));

136926 if–!
pDe„ºed
 ){

136927  
SQLITE_NOMEM
;

136929 
	`mem£t
(
pDe„ºed
, 0, (*pDeferred));

136930 
pDe„ºed
->
pTokí
 =ÖToken;

136931 
pDe„ºed
->
pNext
 = 
pC§
->pDeferred;

136932 
pDe„ºed
->
iCﬁ
 = iCol;

136933 
pC§
->
pDe„ºed
 =ÖDeferred;

136935 
	`as£π
–
pTokí
->
pDe„ºed
==0 );

136936 
pTokí
->
pDe„ºed
 =ÖDeferred;

136938  
SQLITE_OK
;

136947 
	`·s3DñëeByRowid
(

136948 
Fts3TabÀ
 *
p
,

136949 
sqlôe3_vÆue
 *
pRowid
,

136950 *
≤Chng
,

136951 
u32
 *
aSzDñ


136953 
rc
 = 
SQLITE_OK
;

136954 
bFound
 = 0;

136956 
	`·s3DñëeTîms
(&
rc
, 
p
, 
pRowid
, 
aSzDñ
, &
bFound
);

136957 if–
bFound
 && 
rc
==
SQLITE_OK
 ){

136958 
isEm±y
 = 0;

136959 
rc
 = 
	`·s3IsEm±y
(
p
, 
pRowid
, &
isEm±y
);

136960 if–
rc
==
SQLITE_OK
 ){

136961 if–
isEm±y
 ){

136965 
rc
 = 
	`·s3DñëeAŒ
(
p
, 1);

136966 *
≤Chng
 = 0;

136967 
	`mem£t
(
aSzDñ
, 0, (
u32
Ë* (
p
->
nCﬁumn
+1) * 2);

136969 *
≤Chng
 = *pnChng - 1;

136970 if–
p
->
zC⁄ã¡Tbl
==0 ){

136971 
	`·s3SqlExec
(&
rc
, 
p
, 
SQL_DELETE_CONTENT
, &
pRowid
);

136973 if–
p
->
bHasDocsize
 ){

136974 
	`·s3SqlExec
(&
rc
, 
p
, 
SQL_DELETE_DOCSIZE
, &
pRowid
);

136980  
rc
;

136996 
SQLITE_PRIVATE
 
	`sqlôe3Fts3Upd©eMëhod
(

136997 
sqlôe3_vèb
 *
pVèb
,

136998 
nArg
,

136999 
sqlôe3_vÆue
 **
≠VÆ
,

137000 
sqlôe_öt64
 *
pRowid


137002 
Fts3TabÀ
 *
p
 = (Fts3TabÀ *)
pVèb
;

137003 
rc
 = 
SQLITE_OK
;

137004 
isRemove
 = 0;

137005 
u32
 *
aSzIns
 = 0;

137006 
u32
 *
aSzDñ
 = 0;

137007 
nChng
 = 0;

137008 
bIn£πD⁄e
 = 0;

137010 
	`as£π
–
p
->
pSegmíts
==0 );

137011 
	`as£π
(

137012 
nArg
==1

137013 || 
nArg
==(2 + 
p
->
nCﬁumn
 + 3)

137020 if–
nArg
>1

137021 && 
	`sqlôe3_vÆue_ty≥
(
≠VÆ
[0])==
SQLITE_NULL


137022 && 
	`sqlôe3_vÆue_ty≥
(
≠VÆ
[
p
->
nCﬁumn
+2])!=
SQLITE_NULL


137024 
rc
 = 
	`·s3S≥cülIn£π
(
p
, 
≠VÆ
[p->
nCﬁumn
+2]);

137025 
upd©e_out
;

137028 if–
nArg
>1 && 
	`sqlôe3_vÆue_öt
(
≠VÆ
[2 + 
p
->
nCﬁumn
 + 2])<0 ){

137029 
rc
 = 
SQLITE_CONSTRAINT
;

137030 
upd©e_out
;

137034 
aSzDñ
 = 
	`sqlôe3_mÆloc
–◊SzDñ[0])*(
p
->
nCﬁumn
+1)*2 );

137035 if–
aSzDñ
==0 ){

137036 
rc
 = 
SQLITE_NOMEM
;

137037 
upd©e_out
;

137039 
aSzIns
 = &
aSzDñ
[
p
->
nCﬁumn
+1];

137040 
	`mem£t
(
aSzDñ
, 0, ◊SzDñ[0])*(
p
->
nCﬁumn
+1)*2);

137042 
rc
 = 
	`·s3Wrôñock
(
p
);

137043 if–
rc
!=
SQLITE_OK
 ) 
upd©e_out
;

137054 if–
nArg
>1 && 
p
->
zC⁄ã¡Tbl
==0 ){

137056 
sqlôe3_vÆue
 *
pNewRowid
 = 
≠VÆ
[3+
p
->
nCﬁumn
];

137057 if–
	`sqlôe3_vÆue_ty≥
(
pNewRowid
)==
SQLITE_NULL
 ){

137058 
pNewRowid
 = 
≠VÆ
[1];

137061 if–
	`sqlôe3_vÆue_ty≥
(
pNewRowid
)!=
SQLITE_NULL
 && (

137062 
	`sqlôe3_vÆue_ty≥
(
≠VÆ
[0])==
SQLITE_NULL


137063 || 
	`sqlôe3_vÆue_öt64
(
≠VÆ
[0])!=sqlôe3_vÆue_öt64(
pNewRowid
)

137082 if–
	`sqlôe3_vèb_⁄_c⁄Êi˘
(
p
->
db
)==
SQLITE_REPLACE
 ){

137083 
rc
 = 
	`·s3DñëeByRowid
(
p
, 
pNewRowid
, &
nChng
, 
aSzDñ
);

137085 
rc
 = 
	`·s3In£πD©a
(
p
, 
≠VÆ
, 
pRowid
);

137086 
bIn£πD⁄e
 = 1;

137090 if–
rc
!=
SQLITE_OK
 ){

137091 
upd©e_out
;

137095 if–
	`sqlôe3_vÆue_ty≥
(
≠VÆ
[0])!=
SQLITE_NULL
 ){

137096 
	`as£π
–
	`sqlôe3_vÆue_ty≥
(
≠VÆ
[0])==
SQLITE_INTEGER
 );

137097 
rc
 = 
	`·s3DñëeByRowid
(
p
, 
≠VÆ
[0], &
nChng
, 
aSzDñ
);

137098 
isRemove
 = 1;

137102 if–
nArg
>1 && 
rc
==
SQLITE_OK
 ){

137103 
iL™gid
 = 
	`sqlôe3_vÆue_öt
(
≠VÆ
[2 + 
p
->
nCﬁumn
 + 2]);

137104 if–
bIn£πD⁄e
==0 ){

137105 
rc
 = 
	`·s3In£πD©a
(
p
, 
≠VÆ
, 
pRowid
);

137106 if–
rc
==
SQLITE_CONSTRAINT
 && 
p
->
zC⁄ã¡Tbl
==0 ){

137107 
rc
 = 
FTS_CORRUPT_VTAB
;

137110 if–
rc
==
SQLITE_OK
 && (!
isRemove
 || *
pRowid
!=
p
->
iPªvDocid
 ) ){

137111 
rc
 = 
	`·s3PídögTîmsDocid
(
p
, 
iL™gid
, *
pRowid
);

137113 if–
rc
==
SQLITE_OK
 ){

137114 
	`as£π
–
p
->
iPªvDocid
==*
pRowid
 );

137115 
rc
 = 
	`·s3In£πTîms
(
p
, 
iL™gid
, 
≠VÆ
, 
aSzIns
);

137117 if–
p
->
bHasDocsize
 ){

137118 
	`·s3In£πDocsize
(&
rc
, 
p
, 
aSzIns
);

137120 
nChng
++;

137123 if–
p
->
bFts4
 ){

137124 
	`·s3Upd©eDocTŸÆs
(&
rc
, 
p
, 
aSzIns
, 
aSzDñ
, 
nChng
);

137127 
upd©e_out
:

137128 
	`sqlôe3_‰ì
(
aSzDñ
);

137129 
	`sqlôe3Fts3SegmítsClo£
(
p
);

137130  
rc
;

137138 
SQLITE_PRIVATE
 
	`sqlôe3Fts3O±imize
(
Fts3TabÀ
 *
p
){

137139 
rc
;

137140 
rc
 = 
	`sqlôe3_exec
(
p
->
db
, "SAVEPOINT fts3", 0, 0, 0);

137141 if–
rc
==
SQLITE_OK
 ){

137142 
rc
 = 
	`·s3DoO±imize
(
p
, 1);

137143 if–
rc
==
SQLITE_OK
 ||Ñc==
SQLITE_DONE
 ){

137144 
rc2
 = 
	`sqlôe3_exec
(
p
->
db
, "RELEASE fts3", 0, 0, 0);

137145 if–
rc2
!=
SQLITE_OK
 ) 
rc
 =Ñc2;

137147 
	`sqlôe3_exec
(
p
->
db
, "ROLLBACK TO fts3", 0, 0, 0);

137148 
	`sqlôe3_exec
(
p
->
db
, "RELEASE fts3", 0, 0, 0);

137151 
	`sqlôe3Fts3SegmítsClo£
(
p
);

137152  
rc
;

137172 #i‡!
	`deföed
(
SQLITE_CORE
Ë|| deföed(
SQLITE_ENABLE_FTS3
)

137180 
	#FTS3_MATCHINFO_NPHRASE
 'p'

	)

137181 
	#FTS3_MATCHINFO_NCOL
 'c'

	)

137182 
	#FTS3_MATCHINFO_NDOC
 'n'

	)

137183 
	#FTS3_MATCHINFO_AVGLENGTH
 'a'

	)

137184 
	#FTS3_MATCHINFO_LENGTH
 'l'

	)

137185 
	#FTS3_MATCHINFO_LCS
 's'

	)

137186 
	#FTS3_MATCHINFO_HITS
 'x'

	)

137191 
	#FTS3_MATCHINFO_DEFAULT
 "pcx"

	)

137198 
LﬂdDo˛i°Ctx
 
	tLﬂdDo˛i°Ctx
;

137199 
	sLﬂdDo˛i°Ctx
 {

137200 
Fts3Curs‹
 *
pC§
;

137201 
nPhø£
;

137202 
nTokí
;

137209 
Snù≥tIãr
 
	tSnù≥tIãr
;

137210 
Snù≥tPhø£
 
	tSnù≥tPhø£
;

137211 
Snù≥tFøgmít
 
	tSnù≥tFøgmít
;

137213 
	sSnù≥tIãr
 {

137214 
Fts3Curs‹
 *
pC§
;

137215 
iCﬁ
;

137216 
nSnù≥t
;

137217 
nPhø£
;

137218 
Snù≥tPhø£
 *
aPhø£
;

137219 
iCuºít
;

137222 
	sSnù≥tPhø£
 {

137223 
nTokí
;

137224 *
pLi°
;

137225 
iHód
;

137226 *
pHód
;

137227 
iTaû
;

137228 *
pTaû
;

137231 
	sSnù≥tFøgmít
 {

137232 
iCﬁ
;

137233 
iPos
;

137234 
u64
 
covîed
;

137235 
u64
 
hlmask
;

137242 
M©chInfo
 
	tM©chInfo
;

137243 
	sM©chInfo
 {

137244 
Fts3Curs‹
 *
pCurs‹
;

137245 
nCﬁ
;

137246 
nPhø£
;

137247 
sqlôe3_öt64
 
nDoc
;

137248 
u32
 *
aM©chöfo
;

137258 
SåBuf„r
 
	tSåBuf„r
;

137259 
	sSåBuf„r
 {

137260 *
z
;

137261 
n
;

137262 
nAŒoc
;

137286 
	`·s3GëDñèPosôi⁄
(**
µ
, *
piPos
){

137287 
iVÆ
;

137288 *
µ
 +
	`sqlôe3Fts3GëV¨öt32
(*µ, &
iVÆ
);

137289 *
piPos
 +(
iVÆ
-2);

137295 
	`·s3Ex¥Iãøã2
(

137296 
Fts3Ex¥
 *
pEx¥
,

137297 *
piPhø£
,

137298 (*
x
)(
Fts3Ex¥
*,,*),

137299 *
pCtx


137301 
rc
;

137302 
eTy≥
 = 
pEx¥
->eType;

137304 if–
eTy≥
!=
FTSQUERY_PHRASE
 ){

137305 
	`as£π
–
pEx¥
->
pLe·
 &&ÖEx¥->
pRight
 );

137306 
rc
 = 
	`·s3Ex¥Iãøã2
(
pEx¥
->
pLe·
, 
piPhø£
, 
x
, 
pCtx
);

137307 if–
rc
==
SQLITE_OK
 && 
eTy≥
!=
FTSQUERY_NOT
 ){

137308 
rc
 = 
	`·s3Ex¥Iãøã2
(
pEx¥
->
pRight
, 
piPhø£
, 
x
, 
pCtx
);

137311 
rc
 = 
	`x
(
pEx¥
, *
piPhø£
, 
pCtx
);

137312 (*
piPhø£
)++;

137314  
rc
;

137327 
	`·s3Ex¥Iãøã
(

137328 
Fts3Ex¥
 *
pEx¥
,

137329 (*
x
)(
Fts3Ex¥
*,,*),

137330 *
pCtx


137332 
iPhø£
 = 0;

137333  
	`·s3Ex¥Iãøã2
(
pEx¥
, &
iPhø£
, 
x
, 
pCtx
);

137341 
	`·s3Ex¥LﬂdDo˛i°sCb
(
Fts3Ex¥
 *
pEx¥
, 
iPhø£
, *
˘x
){

137342 
rc
 = 
SQLITE_OK
;

137343 
Fts3Phø£
 *
pPhø£
 = 
pEx¥
->pPhrase;

137344 
LﬂdDo˛i°Ctx
 *
p
 = (LﬂdDo˛i°Ctx *)
˘x
;

137346 
	`UNUSED_PARAMETER
(
iPhø£
);

137348 
p
->
nPhø£
++;

137349 
p
->
nTokí
 +
pPhø£
->nToken;

137351  
rc
;

137364 
	`·s3Ex¥LﬂdDo˛i°s
(

137365 
Fts3Curs‹
 *
pC§
,

137366 *
≤Phø£
,

137367 *
≤Tokí


137369 
rc
;

137370 
LﬂdDo˛i°Ctx
 
sCtx
 = {0,0,0};

137371 
sCtx
.
pC§
 =ÖCsr;

137372 
rc
 = 
	`·s3Ex¥Iãøã
(
pC§
->
pEx¥
, 
·s3Ex¥LﬂdDo˛i°sCb
, (*)&
sCtx
);

137373 if–
≤Phø£
 ) *≤Phø£ = 
sCtx
.
nPhø£
;

137374 if–
≤Tokí
 ) *≤Tokí = 
sCtx
.
nTokí
;

137375  
rc
;

137378 
	`·s3Ex¥Phø£Cou¡Cb
(
Fts3Ex¥
 *
pEx¥
, 
iPhø£
, *
˘x
){

137379 (*(*)
˘x
)++;

137380 
	`UNUSED_PARAMETER
(
pEx¥
);

137381 
	`UNUSED_PARAMETER
(
iPhø£
);

137382  
SQLITE_OK
;

137384 
	`·s3Ex¥Phø£Cou¡
(
Fts3Ex¥
 *
pEx¥
){

137385 
nPhø£
 = 0;

137386 ()
	`·s3Ex¥Iãøã
(
pEx¥
, 
·s3Ex¥Phø£Cou¡Cb
, (*)&
nPhø£
);

137387  
nPhø£
;

137395 
	`·s3Snù≥tAdv™˚
(**
µIãr
, *
piIãr
, 
iNext
){

137396 *
pIãr
 = *
µIãr
;

137397 if–
pIãr
 ){

137398 
iIãr
 = *
piIãr
;

137400  
iIãr
<
iNext
 ){

137401 if–0==(*
pIãr
 & 0xFE) ){

137402 
iIãr
 = -1;

137403 
pIãr
 = 0;

137406 
	`·s3GëDñèPosôi⁄
(&
pIãr
, &
iIãr
);

137409 *
piIãr
 = 
iIãr
;

137410 *
µIãr
 = 
pIãr
;

137417 
	`·s3Snù≥tNextC™did©e
(
Snù≥tIãr
 *
pIãr
){

137418 
i
;

137420 if–
pIãr
->
iCuºít
<0 ){

137425 
pIãr
->
iCuºít
 = 0;

137430 
i
=0; i<
pIãr
->
nPhø£
; i++){

137431 
Snù≥tPhø£
 *
pPhø£
 = &
pIãr
->
aPhø£
[
i
];

137432 
	`·s3Snù≥tAdv™˚
(&
pPhø£
->
pHód
, &pPhø£->
iHód
, 
pIãr
->
nSnù≥t
);

137435 
iSèπ
;

137436 
iEnd
 = 0x7FFFFFFF;

137438 
i
=0; i<
pIãr
->
nPhø£
; i++){

137439 
Snù≥tPhø£
 *
pPhø£
 = &
pIãr
->
aPhø£
[
i
];

137440 if–
pPhø£
->
pHód
 &&ÖPhø£->
iHód
<
iEnd
 ){

137441 
iEnd
 = 
pPhø£
->
iHód
;

137444 if–
iEnd
==0x7FFFFFFF ){

137448 
pIãr
->
iCuºít
 = 
iSèπ
 = 
iEnd
 -ÖIãr->
nSnù≥t
 + 1;

137449 
i
=0; i<
pIãr
->
nPhø£
; i++){

137450 
Snù≥tPhø£
 *
pPhø£
 = &
pIãr
->
aPhø£
[
i
];

137451 
	`·s3Snù≥tAdv™˚
(&
pPhø£
->
pHód
, &pPhø£->
iHód
, 
iEnd
+1);

137452 
	`·s3Snù≥tAdv™˚
(&
pPhø£
->
pTaû
, &pPhø£->
iTaû
, 
iSèπ
);

137463 
	`·s3Snù≥tDëaûs
(

137464 
Snù≥tIãr
 *
pIãr
,

137465 
u64
 
mCovîed
,

137466 *
piTokí
,

137467 *
piSc‹e
,

137468 
u64
 *
pmCovî
,

137469 
u64
 *
pmHighlight


137471 
iSèπ
 = 
pIãr
->
iCuºít
;

137472 
iSc‹e
 = 0;

137473 
i
;

137474 
u64
 
mCovî
 = 0;

137475 
u64
 
mHighlight
 = 0;

137477 
i
=0; i<
pIãr
->
nPhø£
; i++){

137478 
Snù≥tPhø£
 *
pPhø£
 = &
pIãr
->
aPhø£
[
i
];

137479 if–
pPhø£
->
pTaû
 ){

137480 *
pC§
 = 
pPhø£
->
pTaû
;

137481 
iC§
 = 
pPhø£
->
iTaû
;

137483  
iC§
<(
iSèπ
+
pIãr
->
nSnù≥t
) ){

137484 
j
;

137485 
u64
 
mPhø£
 = (u64)1 << 
i
;

137486 
u64
 
mPos
 = (u64)1 << (
iC§
 - 
iSèπ
);

137487 
	`as£π
–
iC§
>=
iSèπ
 );

137488 if–(
mCovî
|
mCovîed
)&
mPhø£
 ){

137489 
iSc‹e
++;

137491 
iSc‹e
 += 1000;

137493 
mCovî
 |
mPhø£
;

137495 
j
=0; j<
pPhø£
->
nTokí
; j++){

137496 
mHighlight
 |(
mPos
>>
j
);

137499 if–0==(*
pC§
 & 0x0FE) ) ;

137500 
	`·s3GëDñèPosôi⁄
(&
pC§
, &
iC§
);

137506 *
piTokí
 = 
iSèπ
;

137507 *
piSc‹e
 = 
iSc‹e
;

137508 *
pmCovî
 = 
mCovî
;

137509 *
pmHighlight
 = 
mHighlight
;

137516 
	`·s3Snù≥tFödPosôi⁄s
(
Fts3Ex¥
 *
pEx¥
, 
iPhø£
, *
˘x
){

137517 
Snù≥tIãr
 *
p
 = (Snù≥tIã∏*)
˘x
;

137518 
Snù≥tPhø£
 *
pPhø£
 = &
p
->
aPhø£
[
iPhø£
];

137519 *
pC§
;

137520 
rc
;

137522 
pPhø£
->
nTokí
 = 
pEx¥
->pPhrase->nToken;

137523 
rc
 = 
	`sqlôe3Fts3EvÆPhø£Po¶i°
(
p
->
pC§
, 
pEx¥
,Ö->
iCﬁ
, &pCsr);

137524 
	`as£π
–
rc
==
SQLITE_OK
 || 
pC§
==0 );

137525 if–
pC§
 ){

137526 
iFú°
 = 0;

137527 
pPhø£
->
pLi°
 = 
pC§
;

137528 
	`·s3GëDñèPosôi⁄
(&
pC§
, &
iFú°
);

137529 
	`as£π
–
iFú°
>=0 );

137530 
pPhø£
->
pHód
 = 
pC§
;

137531 
pPhø£
->
pTaû
 = 
pC§
;

137532 
pPhø£
->
iHód
 = 
iFú°
;

137533 
pPhø£
->
iTaû
 = 
iFú°
;

137535 
	`as£π
–
rc
!=
SQLITE_OK
 || (

137536 
pPhø£
->
pLi°
==0 &&ÖPhø£->
pHód
==0 &&ÖPhø£->
pTaû
==0

137540  
rc
;

137558 
	`·s3Be°Snù≥t
(

137559 
nSnù≥t
,

137560 
Fts3Curs‹
 *
pC§
,

137561 
iCﬁ
,

137562 
u64
 
mCovîed
,

137563 
u64
 *
pmSìn
,

137564 
Snù≥tFøgmít
 *
pFøgmít
,

137565 *
piSc‹e


137567 
rc
;

137568 
nLi°
;

137569 
Snù≥tIãr
 
sIãr
;

137570 
nByã
;

137571 
iBe°Sc‹e
 = -1;

137572 
i
;

137574 
	`mem£t
(&
sIãr
, 0, (sIter));

137579 
rc
 = 
	`·s3Ex¥LﬂdDo˛i°s
(
pC§
, &
nLi°
, 0);

137580 if–
rc
!=
SQLITE_OK
 ){

137581  
rc
;

137587 
nByã
 = (
Snù≥tPhø£
Ë* 
nLi°
;

137588 
sIãr
.
aPhø£
 = (
Snù≥tPhø£
 *)
	`sqlôe3_mÆloc
(
nByã
);

137589 if–!
sIãr
.
aPhø£
 ){

137590  
SQLITE_NOMEM
;

137592 
	`mem£t
(
sIãr
.
aPhø£
, 0, 
nByã
);

137597 
sIãr
.
pC§
 =ÖCsr;

137598 
sIãr
.
iCﬁ
 = iCol;

137599 
sIãr
.
nSnù≥t
 =ÇSnippet;

137600 
sIãr
.
nPhø£
 = 
nLi°
;

137601 
sIãr
.
iCuºít
 = -1;

137602 ()
	`·s3Ex¥Iãøã
(
pC§
->
pEx¥
, 
·s3Snù≥tFödPosôi⁄s
, (*)&
sIãr
);

137605 
i
=0; i<
nLi°
; i++){

137606 if–
sIãr
.
aPhø£
[
i
].
pHód
 ){

137607 *
pmSìn
 |(
u64
)1 << 
i
;

137614 
pFøgmít
->
iCﬁ
 = iCol;

137615  !
	`·s3Snù≥tNextC™did©e
(&
sIãr
) ){

137616 
iPos
;

137617 
iSc‹e
;

137618 
u64
 
mCovî
;

137619 
u64
 
mHighlight
;

137620 
	`·s3Snù≥tDëaûs
(&
sIãr
, 
mCovîed
, &
iPos
, &
iSc‹e
, &
mCovî
, &
mHighlight
);

137621 
	`as£π
–
iSc‹e
>=0 );

137622 if–
iSc‹e
>
iBe°Sc‹e
 ){

137623 
pFøgmít
->
iPos
 = iPos;

137624 
pFøgmít
->
hlmask
 = 
mHighlight
;

137625 
pFøgmít
->
covîed
 = 
mCovî
;

137626 
iBe°Sc‹e
 = 
iSc‹e
;

137630 
	`sqlôe3_‰ì
(
sIãr
.
aPhø£
);

137631 *
piSc‹e
 = 
iBe°Sc‹e
;

137632  
SQLITE_OK
;

137642 
	`·s3SåögAµíd
(

137643 
SåBuf„r
 *
pSå
,

137644 c⁄° *
zAµíd
,

137645 
nAµíd


137647 if–
nAµíd
<0 ){

137648 
nAµíd
 = ()
	`°æí
(
zAµíd
);

137655 if–
pSå
->
n
+
nAµíd
+1>ıSå->
nAŒoc
 ){

137656 
nAŒoc
 = 
pSå
->nAŒoc+
nAµíd
+100;

137657 *
zNew
 = 
	`sqlôe3_ªÆloc
(
pSå
->
z
, 
nAŒoc
);

137658 if–!
zNew
 ){

137659  
SQLITE_NOMEM
;

137661 
pSå
->
z
 = 
zNew
;

137662 
pSå
->
nAŒoc
 =ÇAlloc;

137664 
	`as£π
–
pSå
->
z
!=0 && (pSå->
nAŒoc
 >pSå->
n
+
nAµíd
+1) );

137667 
	`mem˝y
(&
pSå
->
z
[pSå->
n
], 
zAµíd
, 
nAµíd
);

137668 
pSå
->
n
 +
nAµíd
;

137669 
pSå
->
z
[pSå->
n
] = '\0';

137671  
SQLITE_OK
;

137694 
	`·s3Snù≥tShi·
(

137695 
Fts3TabÀ
 *
pTab
,

137696 
iL™gid
,

137697 
nSnù≥t
,

137698 c⁄° *
zDoc
,

137699 
nDoc
,

137700 *
piPos
,

137701 
u64
 *
pHlmask


137703 
u64
 
hlmask
 = *
pHlmask
;

137705 if–
hlmask
 ){

137706 
nLe·
;

137707 
nRight
;

137708 
nDesúed
;

137710 
nLe·
=0; !(
hlmask
 & ((
u64
)1 <<ÇLeft));ÇLeft++);

137711 
nRight
=0; !(
hlmask
 & ((
u64
)1 << (
nSnù≥t
-1-nRight)));ÇRight++);

137712 
nDesúed
 = (
nLe·
-
nRight
)/2;

137721 if–
nDesúed
>0 ){

137722 
nShi·
;

137723 
iCuºít
 = 0;

137724 
rc
;

137725 
sqlôe3_tokíizî_moduÀ
 *
pMod
;

137726 
sqlôe3_tokíizî_curs‹
 *
pC
;

137727 
pMod
 = (
sqlôe3_tokíizî_moduÀ
 *)
pTab
->
pTokíizî
->
pModuÀ
;

137732 
rc
 = 
	`sqlôe3Fts3O≥nTokíizî
(
pTab
->
pTokíizî
, 
iL™gid
, 
zDoc
, 
nDoc
, &
pC
);

137733 if–
rc
!=
SQLITE_OK
 ){

137734  
rc
;

137736  
rc
==
SQLITE_OK
 && 
iCuºít
<(
nSnù≥t
+
nDesúed
) ){

137737 c⁄° *
ZDUMMY
; 
DUMMY1
 = 0, 
DUMMY2
 = 0, 
DUMMY3
 = 0;

137738 
rc
 = 
pMod
->
	`xNext
(
pC
, &
ZDUMMY
, &
DUMMY1
, &
DUMMY2
, &
DUMMY3
, &
iCuºít
);

137740 
pMod
->
	`xClo£
(
pC
);

137741 if–
rc
!=
SQLITE_OK
 &&Ñc!=
SQLITE_DONE
 ){ Ñc; }

137743 
nShi·
 = (
rc
==
SQLITE_DONE
)+
iCuºít
-
nSnù≥t
;

137744 
	`as£π
–
nShi·
<=
nDesúed
 );

137745 if–
nShi·
>0 ){

137746 *
piPos
 +
nShi·
;

137747 *
pHlmask
 = 
hlmask
 >> 
nShi·
;

137751  
SQLITE_OK
;

137758 
	`·s3Snù≥tText
(

137759 
Fts3Curs‹
 *
pC§
,

137760 
Snù≥tFøgmít
 *
pFøgmít
,

137761 
iFøgmít
,

137762 
isLa°
,

137763 
nSnù≥t
,

137764 c⁄° *
zO≥n
,

137765 c⁄° *
zClo£
,

137766 c⁄° *
zEŒùsis
,

137767 
SåBuf„r
 *
pOut


137769 
Fts3TabÀ
 *
pTab
 = (Fts3TabÀ *)
pC§
->
ba£
.
pVèb
;

137770 
rc
;

137771 c⁄° *
zDoc
;

137772 
nDoc
;

137773 
iCuºít
 = 0;

137774 
iEnd
 = 0;

137775 
isShi·D⁄e
 = 0;

137776 
iPos
 = 
pFøgmít
->iPos;

137777 
u64
 
hlmask
 = 
pFøgmít
->hlmask;

137778 
iCﬁ
 = 
pFøgmít
->iCol+1;

137779 
sqlôe3_tokíizî_moduÀ
 *
pMod
;

137780 
sqlôe3_tokíizî_curs‹
 *
pC
;

137782 
zDoc
 = (c⁄° *)
	`sqlôe3_cﬁumn_ãxt
(
pC§
->
pStmt
, 
iCﬁ
);

137783 if–
zDoc
==0 ){

137784 if–
	`sqlôe3_cﬁumn_ty≥
(
pC§
->
pStmt
, 
iCﬁ
)!=
SQLITE_NULL
 ){

137785  
SQLITE_NOMEM
;

137787  
SQLITE_OK
;

137789 
nDoc
 = 
	`sqlôe3_cﬁumn_byãs
(
pC§
->
pStmt
, 
iCﬁ
);

137792 
pMod
 = (
sqlôe3_tokíizî_moduÀ
 *)
pTab
->
pTokíizî
->
pModuÀ
;

137793 
rc
 = 
	`sqlôe3Fts3O≥nTokíizî
(
pTab
->
pTokíizî
, 
pC§
->
iL™gid
, 
zDoc
,
nDoc
,&
pC
);

137794 if–
rc
!=
SQLITE_OK
 ){

137795  
rc
;

137798  
rc
==
SQLITE_OK
 ){

137799 c⁄° *
ZDUMMY
;

137800 
DUMMY1
 = -1;

137801 
iBegö
 = 0;

137802 
iFö
 = 0;

137803 
isHighlight
 = 0;

137816 
rc
 = 
pMod
->
	`xNext
(
pC
, &
ZDUMMY
, &
DUMMY1
, &
iBegö
, &
iFö
, &
iCuºít
);

137817 if–
rc
!=
SQLITE_OK
 ){

137818 if–
rc
==
SQLITE_DONE
 ){

137823 
rc
 = 
	`·s3SåögAµíd
(
pOut
, &
zDoc
[
iEnd
], -1);

137827 if–
iCuºít
<
iPos
 ){ ; }

137829 if–!
isShi·D⁄e
 ){

137830 
n
 = 
nDoc
 - 
iBegö
;

137831 
rc
 = 
	`·s3Snù≥tShi·
(

137832 
pTab
, 
pC§
->
iL™gid
, 
nSnù≥t
, &
zDoc
[
iBegö
], 
n
, &
iPos
, &
hlmask


137834 
isShi·D⁄e
 = 1;

137840 if–
rc
==
SQLITE_OK
 && (
iPos
>0 || 
iFøgmít
>0) ){

137841 
rc
 = 
	`·s3SåögAµíd
(
pOut
, 
zEŒùsis
, -1);

137843 if–
rc
!=
SQLITE_OK
 || 
iCuºít
<
iPos
 ) ;

137846 if–
iCuºít
>=(
iPos
+
nSnù≥t
) ){

137847 if–
isLa°
 ){

137848 
rc
 = 
	`·s3SåögAµíd
(
pOut
, 
zEŒùsis
, -1);

137854 
isHighlight
 = (
hlmask
 & ((
u64
)1 << (
iCuºít
-
iPos
)))!=0;

137856 if–
iCuºít
>
iPos
 ) 
rc
 = 
	`·s3SåögAµíd
(
pOut
, &
zDoc
[
iEnd
], 
iBegö
-iEnd);

137857 if–
rc
==
SQLITE_OK
 && 
isHighlight
 )Ñ¯
	`·s3SåögAµíd
(
pOut
, 
zO≥n
, -1);

137858 if–
rc
==
SQLITE_OK
 )Ñ¯
	`·s3SåögAµíd
(
pOut
, &
zDoc
[
iBegö
], 
iFö
-iBegin);

137859 if–
rc
==
SQLITE_OK
 && 
isHighlight
 )Ñ¯
	`·s3SåögAµíd
(
pOut
, 
zClo£
, -1);

137861 
iEnd
 = 
iFö
;

137864 
pMod
->
	`xClo£
(
pC
);

137865  
rc
;

137882 
	`·s3Cﬁum∆i°Cou¡
(**
µCﬁli°
){

137883 *
pEnd
 = *
µCﬁli°
;

137884 
c
 = 0;

137885 
nE¡ry
 = 0;

137888  0xFE & (*
pEnd
 | 
c
) ){

137889 
c
 = *
pEnd
++ & 0x80;

137890 if–!
c
 ) 
nE¡ry
++;

137893 *
µCﬁli°
 = 
pEnd
;

137894  
nE¡ry
;

137924 
	`·s3Ex¥GlobÆHôsCb
(

137925 
Fts3Ex¥
 *
pEx¥
,

137926 
iPhø£
,

137927 *
pCtx


137929 
M©chInfo
 *
p
 = (M©chInfÿ*)
pCtx
;

137930  
	`sqlôe3Fts3EvÆPhø£Sèts
(

137931 
p
->
pCurs‹
, 
pEx¥
, &p->
aM©chöfo
[3*
iPhø£
*p->
nCﬁ
]

137940 
	`·s3Ex¥LoˇlHôsCb
(

137941 
Fts3Ex¥
 *
pEx¥
,

137942 
iPhø£
,

137943 *
pCtx


137945 
rc
 = 
SQLITE_OK
;

137946 
M©chInfo
 *
p
 = (M©chInfÿ*)
pCtx
;

137947 
iSèπ
 = 
iPhø£
 * 
p
->
nCﬁ
 * 3;

137948 
i
;

137950 
i
=0; i<
p
->
nCﬁ
 && 
rc
==
SQLITE_OK
; i++){

137951 *
pC§
;

137952 
rc
 = 
	`sqlôe3Fts3EvÆPhø£Po¶i°
(
p
->
pCurs‹
, 
pEx¥
, 
i
, &
pC§
);

137953 if–
pC§
 ){

137954 
p
->
aM©chöfo
[
iSèπ
+
i
*3] = 
	`·s3Cﬁum∆i°Cou¡
(&
pC§
);

137956 
p
->
aM©chöfo
[
iSèπ
+
i
*3] = 0;

137960  
rc
;

137963 
	`·s3M©chöfoCheck
(

137964 
Fts3TabÀ
 *
pTab
,

137965 
cArg
,

137966 **
pzEº


137968 if–(
cArg
==
FTS3_MATCHINFO_NPHRASE
)

137969 || (
cArg
==
FTS3_MATCHINFO_NCOL
)

137970 || (
cArg
==
FTS3_MATCHINFO_NDOC
 && 
pTab
->
bFts4
)

137971 || (
cArg
==
FTS3_MATCHINFO_AVGLENGTH
 && 
pTab
->
bFts4
)

137972 || (
cArg
==
FTS3_MATCHINFO_LENGTH
 && 
pTab
->
bHasDocsize
)

137973 || (
cArg
==
FTS3_MATCHINFO_LCS
)

137974 || (
cArg
==
FTS3_MATCHINFO_HITS
)

137976  
SQLITE_OK
;

137978 *
pzEº
 = 
	`sqlôe3_m¥ötf
("uƒecognized m©chöfÿªque°: %c", 
cArg
);

137979  
SQLITE_ERROR
;

137982 
	`·s3M©chöfoSize
(
M©chInfo
 *
pInfo
, 
cArg
){

137983 
nVÆ
;

137985  
cArg
 ){

137986 
FTS3_MATCHINFO_NDOC
:

137987 
FTS3_MATCHINFO_NPHRASE
:

137988 
FTS3_MATCHINFO_NCOL
:

137989 
nVÆ
 = 1;

137992 
FTS3_MATCHINFO_AVGLENGTH
:

137993 
FTS3_MATCHINFO_LENGTH
:

137994 
FTS3_MATCHINFO_LCS
:

137995 
nVÆ
 = 
pInfo
->
nCﬁ
;

137999 
	`as£π
–
cArg
==
FTS3_MATCHINFO_HITS
 );

138000 
nVÆ
 = 
pInfo
->
nCﬁ
 *ÖInfo->
nPhø£
 * 3;

138004  
nVÆ
;

138007 
	`·s3M©chöfoSñe˘Do˘ŸÆ
(

138008 
Fts3TabÀ
 *
pTab
,

138009 
sqlôe3_°mt
 **
µStmt
,

138010 
sqlôe3_öt64
 *
≤Doc
,

138011 c⁄° **
∑Lí


138013 
sqlôe3_°mt
 *
pStmt
;

138014 c⁄° *
a
;

138015 
sqlôe3_öt64
 
nDoc
;

138017 if–!*
µStmt
 ){

138018 
rc
 = 
	`sqlôe3Fts3Sñe˘Do˘ŸÆ
(
pTab
, 
µStmt
);

138019 if–
rc
!=
SQLITE_OK
 ) Ñc;

138021 
pStmt
 = *
µStmt
;

138022 
	`as£π
–
	`sqlôe3_d©a_cou¡
(
pStmt
)==1 );

138024 
a
 = 
	`sqlôe3_cﬁumn_blob
(
pStmt
, 0);

138025 
a
 +
	`sqlôe3Fts3GëV¨öt
◊, &
nDoc
);

138026 if–
nDoc
==0 )  
FTS_CORRUPT_VTAB
;

138027 *
≤Doc
 = (
u32
)
nDoc
;

138029 if–
∑Lí
 ) *∑Lí = 
a
;

138030  
SQLITE_OK
;

138039 
LcsIãøt‹
 
	tLcsIãøt‹
;

138040 
	sLcsIãøt‹
 {

138041 
Fts3Ex¥
 *
pEx¥
;

138042 
iPosOff£t
;

138043 *
pRód
;

138044 
iPos
;

138051 
	#LCS_ITERATOR_FINISHED
 0x7FFFFFFF;

	)

138053 
	`·s3M©chöfoLcsCb
(

138054 
Fts3Ex¥
 *
pEx¥
,

138055 
iPhø£
,

138056 *
pCtx


138058 
LcsIãøt‹
 *
aIãr
 = (LcsIãøt‹ *)
pCtx
;

138059 
aIãr
[
iPhø£
].
pEx¥
 =ÖExpr;

138060  
SQLITE_OK
;

138068 
	`·s3LcsIãøt‹Adv™˚
(
LcsIãøt‹
 *
pIãr
){

138069 *
pRód
 = 
pIãr
->pRead;

138070 
sqlôe3_öt64
 
iRód
;

138071 
rc
 = 0;

138073 
pRód
 +
	`sqlôe3Fts3GëV¨öt
’Ród, &
iRód
);

138074 if–
iRód
==0 || iRead==1 ){

138075 
pRód
 = 0;

138076 
rc
 = 1;

138078 
pIãr
->
iPos
 +()(
iRód
-2);

138081 
pIãr
->
pRód
 =ÖRead;

138082  
rc
;

138096 
	`·s3M©chöfoLcs
(
Fts3Curs‹
 *
pC§
, 
M©chInfo
 *
pInfo
){

138097 
LcsIãøt‹
 *
aIãr
;

138098 
i
;

138099 
iCﬁ
;

138100 
nTokí
 = 0;

138105 
aIãr
 = 
	`sqlôe3_mÆloc
((
LcsIãøt‹
Ë* 
pC§
->
nPhø£
);

138106 if–!
aIãr
 )  
SQLITE_NOMEM
;

138107 
	`mem£t
(
aIãr
, 0, (
LcsIãøt‹
Ë* 
pC§
->
nPhø£
);

138108 ()
	`·s3Ex¥Iãøã
(
pC§
->
pEx¥
, 
·s3M©chöfoLcsCb
, (*)
aIãr
);

138110 
i
=0; i<
pInfo
->
nPhø£
; i++){

138111 
LcsIãøt‹
 *
pIãr
 = &
aIãr
[
i
];

138112 
nTokí
 -
pIãr
->
pEx¥
->
pPhø£
->nToken;

138113 
pIãr
->
iPosOff£t
 = 
nTokí
;

138116 
iCﬁ
=0; iCﬁ<
pInfo
->
nCﬁ
; iCol++){

138117 
nLcs
 = 0;

138118 
nLive
 = 0;

138120 
i
=0; i<
pInfo
->
nPhø£
; i++){

138121 
rc
;

138122 
LcsIãøt‹
 *
pIt
 = &
aIãr
[
i
];

138123 
rc
 = 
	`sqlôe3Fts3EvÆPhø£Po¶i°
(
pC§
, 
pIt
->
pEx¥
, 
iCﬁ
, &pIt->
pRód
);

138124 if–
rc
!=
SQLITE_OK
 ) Ñc;

138125 if–
pIt
->
pRód
 ){

138126 
pIt
->
iPos
 =ÖIt->
iPosOff£t
;

138127 
	`·s3LcsIãøt‹Adv™˚
(&
aIãr
[
i
]);

138128 
nLive
++;

138132  
nLive
>0 ){

138133 
LcsIãøt‹
 *
pAdv
 = 0;

138134 
nThisLcs
 = 0;

138136 
i
=0; i<
pInfo
->
nPhø£
; i++){

138137 
LcsIãøt‹
 *
pIãr
 = &
aIãr
[
i
];

138138 if–
pIãr
->
pRód
==0 ){

138140 
nThisLcs
 = 0;

138142 if–
pAdv
==0 || 
pIãr
->
iPos
<pAdv->iPos ){

138143 
pAdv
 = 
pIãr
;

138145 if–
nThisLcs
==0 || 
pIãr
->
iPos
==pIter[-1].iPos ){

138146 
nThisLcs
++;

138148 
nThisLcs
 = 1;

138150 if–
nThisLcs
>
nLcs
 )ÇLcs =ÇThisLcs;

138153 if–
	`·s3LcsIãøt‹Adv™˚
(
pAdv
ËË
nLive
--;

138156 
pInfo
->
aM©chöfo
[
iCﬁ
] = 
nLcs
;

138159 
	`sqlôe3_‰ì
(
aIãr
);

138160  
SQLITE_OK
;

138180 
	`·s3M©chöfoVÆues
(

138181 
Fts3Curs‹
 *
pC§
,

138182 
bGlobÆ
,

138183 
M©chInfo
 *
pInfo
,

138184 c⁄° *
zArg


138186 
rc
 = 
SQLITE_OK
;

138187 
i
;

138188 
Fts3TabÀ
 *
pTab
 = (Fts3TabÀ *)
pC§
->
ba£
.
pVèb
;

138189 
sqlôe3_°mt
 *
pSñe˘
 = 0;

138191 
i
=0; 
rc
==
SQLITE_OK
 && 
zArg
[i]; i++){

138193  
zArg
[
i
] ){

138194 
FTS3_MATCHINFO_NPHRASE
:

138195 if–
bGlobÆ
 ) 
pInfo
->
aM©chöfo
[0] =ÖInfo->
nPhø£
;

138198 
FTS3_MATCHINFO_NCOL
:

138199 if–
bGlobÆ
 ) 
pInfo
->
aM©chöfo
[0] =ÖInfo->
nCﬁ
;

138202 
FTS3_MATCHINFO_NDOC
:

138203 if–
bGlobÆ
 ){

138204 
sqlôe3_öt64
 
nDoc
 = 0;

138205 
rc
 = 
	`·s3M©chöfoSñe˘Do˘ŸÆ
(
pTab
, &
pSñe˘
, &
nDoc
, 0);

138206 
pInfo
->
aM©chöfo
[0] = (
u32
)
nDoc
;

138210 
FTS3_MATCHINFO_AVGLENGTH
:

138211 if–
bGlobÆ
 ){

138212 
sqlôe3_öt64
 
nDoc
;

138213 c⁄° *
a
;

138215 
rc
 = 
	`·s3M©chöfoSñe˘Do˘ŸÆ
(
pTab
, &
pSñe˘
, &
nDoc
, &
a
);

138216 if–
rc
==
SQLITE_OK
 ){

138217 
iCﬁ
;

138218 
iCﬁ
=0; iCﬁ<
pInfo
->
nCﬁ
; iCol++){

138219 
u32
 
iVÆ
;

138220 
sqlôe3_öt64
 
nTokí
;

138221 
a
 +
	`sqlôe3Fts3GëV¨öt
◊, &
nTokí
);

138222 
iVÆ
 = (
u32
)(((u32)(
nTokí
&0xffffffff)+
nDoc
/2)/nDoc);

138223 
pInfo
->
aM©chöfo
[
iCﬁ
] = 
iVÆ
;

138229 
FTS3_MATCHINFO_LENGTH
: {

138230 
sqlôe3_°mt
 *
pSñe˘Docsize
 = 0;

138231 
rc
 = 
	`sqlôe3Fts3Sñe˘Docsize
(
pTab
, 
pC§
->
iPªvId
, &
pSñe˘Docsize
);

138232 if–
rc
==
SQLITE_OK
 ){

138233 
iCﬁ
;

138234 c⁄° *
a
 = 
	`sqlôe3_cﬁumn_blob
(
pSñe˘Docsize
, 0);

138235 
iCﬁ
=0; iCﬁ<
pInfo
->
nCﬁ
; iCol++){

138236 
sqlôe3_öt64
 
nTokí
;

138237 
a
 +
	`sqlôe3Fts3GëV¨öt
◊, &
nTokí
);

138238 
pInfo
->
aM©chöfo
[
iCﬁ
] = (
u32
)
nTokí
;

138241 
	`sqlôe3_ª£t
(
pSñe˘Docsize
);

138245 
FTS3_MATCHINFO_LCS
:

138246 
rc
 = 
	`·s3Ex¥LﬂdDo˛i°s
(
pC§
, 0, 0);

138247 if–
rc
==
SQLITE_OK
 ){

138248 
rc
 = 
	`·s3M©chöfoLcs
(
pC§
, 
pInfo
);

138253 
Fts3Ex¥
 *
pEx¥
;

138254 
	`as£π
–
zArg
[
i
]==
FTS3_MATCHINFO_HITS
 );

138255 
pEx¥
 = 
pC§
->pExpr;

138256 
rc
 = 
	`·s3Ex¥LﬂdDo˛i°s
(
pC§
, 0, 0);

138257 if–
rc
!=
SQLITE_OK
 ) ;

138258 if–
bGlobÆ
 ){

138259 if–
pC§
->
pDe„ºed
 ){

138260 
rc
 = 
	`·s3M©chöfoSñe˘Do˘ŸÆ
(
pTab
, &
pSñe˘
, &
pInfo
->
nDoc
, 0);

138261 if–
rc
!=
SQLITE_OK
 ) ;

138263 
rc
 = 
	`·s3Ex¥Iãøã
(
pEx¥
, 
·s3Ex¥GlobÆHôsCb
,(*)
pInfo
);

138264 if–
rc
!=
SQLITE_OK
 ) ;

138266 ()
	`·s3Ex¥Iãøã
(
pEx¥
, 
·s3Ex¥LoˇlHôsCb
,(*)
pInfo
);

138271 
pInfo
->
aM©chöfo
 +
	`·s3M©chöfoSize
’Info, 
zArg
[
i
]);

138274 
	`sqlôe3_ª£t
(
pSñe˘
);

138275  
rc
;

138283 
	`·s3GëM©chöfo
(

138284 
Fts3Curs‹
 *
pC§
,

138285 c⁄° *
zArg


138287 
M©chInfo
 
sInfo
;

138288 
Fts3TabÀ
 *
pTab
 = (Fts3TabÀ *)
pC§
->
ba£
.
pVèb
;

138289 
rc
 = 
SQLITE_OK
;

138290 
bGlobÆ
 = 0;

138292 
	`mem£t
(&
sInfo
, 0, (
M©chInfo
));

138293 
sInfo
.
pCurs‹
 = 
pC§
;

138294 
sInfo
.
nCﬁ
 = 
pTab
->
nCﬁumn
;

138299 if–
pC§
->
zM©chöfo
 && 
	`°rcmp
’C§->zM©chöfo, 
zArg
) ){

138300 
	`as£π
–
pC§
->
aM©chöfo
 );

138301 
	`sqlôe3_‰ì
(
pC§
->
aM©chöfo
);

138302 
pC§
->
zM©chöfo
 = 0;

138303 
pC§
->
aM©chöfo
 = 0;

138311 if–
pC§
->
aM©chöfo
==0 ){

138312 
nM©chöfo
 = 0;

138313 
nArg
;

138314 
i
;

138317 
pC§
->
nPhø£
 = 
	`·s3Ex¥Phø£Cou¡
’C§->
pEx¥
);

138318 
sInfo
.
nPhø£
 = 
pC§
->nPhrase;

138321 
i
=0; 
zArg
[i]; i++){

138322 
nM©chöfo
 +
	`·s3M©chöfoSize
(&
sInfo
, 
zArg
[
i
]);

138326 
nArg
 = ()
	`°æí
(
zArg
);

138327 
pC§
->
aM©chöfo
 = (
u32
 *)
	`sqlôe3_mÆloc
((u32)*
nM©chöfo
 + 
nArg
 + 1);

138328 if–!
pC§
->
aM©chöfo
 )  
SQLITE_NOMEM
;

138330 
pC§
->
zM©chöfo
 = (*)&pC§->
aM©chöfo
[
nM©chöfo
];

138331 
pC§
->
nM©chöfo
 =ÇMatchinfo;

138332 
	`mem˝y
(
pC§
->
zM©chöfo
, 
zArg
, 
nArg
+1);

138333 
	`mem£t
(
pC§
->
aM©chöfo
, 0, (
u32
)*
nM©chöfo
);

138334 
pC§
->
isM©chöfoNìded
 = 1;

138335 
bGlobÆ
 = 1;

138338 
sInfo
.
aM©chöfo
 = 
pC§
->aMatchinfo;

138339 
sInfo
.
nPhø£
 = 
pC§
->nPhrase;

138340 if–
pC§
->
isM©chöfoNìded
 ){

138341 
rc
 = 
	`·s3M©chöfoVÆues
(
pC§
, 
bGlobÆ
, &
sInfo
, 
zArg
);

138342 
pC§
->
isM©chöfoNìded
 = 0;

138345  
rc
;

138351 
SQLITE_PRIVATE
 
	`sqlôe3Fts3Snù≥t
(

138352 
sqlôe3_c⁄ãxt
 *
pCtx
,

138353 
Fts3Curs‹
 *
pC§
,

138354 c⁄° *
zSèπ
,

138355 c⁄° *
zEnd
,

138356 c⁄° *
zEŒùsis
,

138357 
iCﬁ
,

138358 
nTokí


138360 
Fts3TabÀ
 *
pTab
 = (Fts3TabÀ *)
pC§
->
ba£
.
pVèb
;

138361 
rc
 = 
SQLITE_OK
;

138362 
i
;

138363 
SåBuf„r
 
ªs
 = {0, 0, 0};

138373 
nSnù≥t
 = 0;

138374 
Snù≥tFøgmít
 
aSnù≥t
[4];

138375 
nFTokí
 = -1;

138377 if–!
pC§
->
pEx¥
 ){

138378 
	`sqlôe3_ªsu…_ãxt
(
pCtx
, "", 0, 
SQLITE_STATIC
);

138382 
nSnù≥t
=1; 1;ÇSnippet++){

138384 
iSnù
;

138385 
u64
 
mCovîed
 = 0;

138386 
u64
 
mSìn
 = 0;

138388 if–
nTokí
>=0 ){

138389 
nFTokí
 = (
nTokí
+
nSnù≥t
-1) /ÇSnippet;

138391 
nFTokí
 = -1 * 
nTokí
;

138394 
iSnù
=0; iSnù<
nSnù≥t
; iSnip++){

138395 
iBe°Sc‹e
 = -1;

138396 
iRód
;

138397 
Snù≥tFøgmít
 *
pFøgmít
 = &
aSnù≥t
[
iSnù
];

138399 
	`mem£t
(
pFøgmít
, 0, (*pFragment));

138405 
iRód
=0; iRód<
pTab
->
nCﬁumn
; iRead++){

138406 
Snù≥tFøgmít
 
sF
 = {0, 0, 0, 0};

138407 
iS
;

138408 if–
iCﬁ
>=0 && 
iRód
!=iCol ) ;

138411 
rc
 = 
	`·s3Be°Snù≥t
(
nFTokí
, 
pC§
, 
iRód
, 
mCovîed
, &
mSìn
, &
sF
, &
iS
);

138412 if–
rc
!=
SQLITE_OK
 ){

138413 
¢ù≥t_out
;

138415 if–
iS
>
iBe°Sc‹e
 ){

138416 *
pFøgmít
 = 
sF
;

138417 
iBe°Sc‹e
 = 
iS
;

138421 
mCovîed
 |
pFøgmít
->
covîed
;

138427 
	`as£π
–(
mCovîed
&
mSìn
)==mCovered );

138428 if–
mSìn
==
mCovîed
 || 
nSnù≥t
==
	`SizeofAºay
(
aSnù≥t
) ) ;

138431 
	`as£π
–
nFTokí
>0 );

138433 
i
=0; i<
nSnù≥t
 && 
rc
==
SQLITE_OK
; i++){

138434 
rc
 = 
	`·s3Snù≥tText
(
pC§
, &
aSnù≥t
[
i
],

138435 
i
, (i==
nSnù≥t
-1), 
nFTokí
, 
zSèπ
, 
zEnd
, 
zEŒùsis
, &
ªs


138439 
¢ù≥t_out
:

138440 
	`sqlôe3Fts3SegmítsClo£
(
pTab
);

138441 if–
rc
!=
SQLITE_OK
 ){

138442 
	`sqlôe3_ªsu…_îr‹_code
(
pCtx
, 
rc
);

138443 
	`sqlôe3_‰ì
(
ªs
.
z
);

138445 
	`sqlôe3_ªsu…_ãxt
(
pCtx
, 
ªs
.
z
, -1, 
sqlôe3_‰ì
);

138450 
TîmOff£t
 
	tTîmOff£t
;

138451 
TîmOff£tCtx
 
	tTîmOff£tCtx
;

138453 
	sTîmOff£t
 {

138454 *
pLi°
;

138455 
iPos
;

138456 
iOff
;

138459 
	sTîmOff£tCtx
 {

138460 
Fts3Curs‹
 *
pC§
;

138461 
iCﬁ
;

138462 
iTîm
;

138463 
sqlôe3_öt64
 
iDocid
;

138464 
TîmOff£t
 *
aTîm
;

138470 
	`·s3Ex¥TîmOff£tInô
(
Fts3Ex¥
 *
pEx¥
, 
iPhø£
, *
˘x
){

138471 
TîmOff£tCtx
 *
p
 = (TîmOff£tCtx *)
˘x
;

138472 
nTîm
;

138473 
iTîm
;

138474 *
pLi°
;

138475 
iPos
 = 0;

138476 
rc
;

138478 
	`UNUSED_PARAMETER
(
iPhø£
);

138479 
rc
 = 
	`sqlôe3Fts3EvÆPhø£Po¶i°
(
p
->
pC§
, 
pEx¥
,Ö->
iCﬁ
, &
pLi°
);

138480 
nTîm
 = 
pEx¥
->
pPhø£
->
nTokí
;

138481 if–
pLi°
 ){

138482 
	`·s3GëDñèPosôi⁄
(&
pLi°
, &
iPos
);

138483 
	`as£π
–
iPos
>=0 );

138486 
iTîm
=0; iTîm<
nTîm
; iTerm++){

138487 
TîmOff£t
 *
pT
 = &
p
->
aTîm
[p->
iTîm
++];

138488 
pT
->
iOff
 = 
nTîm
-
iTîm
-1;

138489 
pT
->
pLi°
 =ÖList;

138490 
pT
->
iPos
 = iPos;

138493  
rc
;

138499 
SQLITE_PRIVATE
 
	`sqlôe3Fts3Off£ts
(

138500 
sqlôe3_c⁄ãxt
 *
pCtx
,

138501 
Fts3Curs‹
 *
pC§


138503 
Fts3TabÀ
 *
pTab
 = (Fts3TabÀ *)
pC§
->
ba£
.
pVèb
;

138504 
sqlôe3_tokíizî_moduÀ
 c⁄° *
pMod
 = 
pTab
->
pTokíizî
->
pModuÀ
;

138505 
rc
;

138506 
nTokí
;

138507 
iCﬁ
;

138508 
SåBuf„r
 
ªs
 = {0, 0, 0};

138509 
TîmOff£tCtx
 
sCtx
;

138511 if–!
pC§
->
pEx¥
 ){

138512 
	`sqlôe3_ªsu…_ãxt
(
pCtx
, "", 0, 
SQLITE_STATIC
);

138516 
	`mem£t
(&
sCtx
, 0, (sCtx));

138517 
	`as£π
–
pC§
->
isRequúeSìk
==0 );

138520 
rc
 = 
	`·s3Ex¥LﬂdDo˛i°s
(
pC§
, 0, &
nTokí
);

138521 if–
rc
!=
SQLITE_OK
 ) 
off£ts_out
;

138524 
sCtx
.
aTîm
 = (
TîmOff£t
 *)
	`sqlôe3_mÆloc
((TîmOff£t)*
nTokí
);

138525 if–0==
sCtx
.
aTîm
 ){

138526 
rc
 = 
SQLITE_NOMEM
;

138527 
off£ts_out
;

138529 
sCtx
.
iDocid
 = 
pC§
->
iPªvId
;

138530 
sCtx
.
pC§
 =ÖCsr;

138535 
iCﬁ
=0; iCﬁ<
pTab
->
nCﬁumn
; iCol++){

138536 
sqlôe3_tokíizî_curs‹
 *
pC
;

138537 c⁄° *
ZDUMMY
;

138538 
NDUMMY
 = 0;

138539 
iSèπ
 = 0;

138540 
iEnd
 = 0;

138541 
iCuºít
 = 0;

138542 c⁄° *
zDoc
;

138543 
nDoc
;

138549 
sCtx
.
iCﬁ
 = iCol;

138550 
sCtx
.
iTîm
 = 0;

138551 ()
	`·s3Ex¥Iãøã
(
pC§
->
pEx¥
, 
·s3Ex¥TîmOff£tInô
, (*)&
sCtx
);

138559 
zDoc
 = (c⁄° *)
	`sqlôe3_cﬁumn_ãxt
(
pC§
->
pStmt
, 
iCﬁ
+1);

138560 
nDoc
 = 
	`sqlôe3_cﬁumn_byãs
(
pC§
->
pStmt
, 
iCﬁ
+1);

138561 if–
zDoc
==0 ){

138562 if–
	`sqlôe3_cﬁumn_ty≥
(
pC§
->
pStmt
, 
iCﬁ
+1)==
SQLITE_NULL
 ){

138565 
rc
 = 
SQLITE_NOMEM
;

138566 
off£ts_out
;

138570 
rc
 = 
	`sqlôe3Fts3O≥nTokíizî
(
pTab
->
pTokíizî
, 
pC§
->
iL™gid
,

138571 
zDoc
, 
nDoc
, &
pC


138573 if–
rc
!=
SQLITE_OK
 ) 
off£ts_out
;

138575 
rc
 = 
pMod
->
	`xNext
(
pC
, &
ZDUMMY
, &
NDUMMY
, &
iSèπ
, &
iEnd
, &
iCuºít
);

138576  
rc
==
SQLITE_OK
 ){

138577 
i
;

138578 
iMöPos
 = 0x7FFFFFFF;

138579 
TîmOff£t
 *
pTîm
 = 0;

138581 
i
=0; i<
nTokí
; i++){

138582 
TîmOff£t
 *
pT
 = &
sCtx
.
aTîm
[
i
];

138583 if–
pT
->
pLi°
 && (pT->
iPos
-pT->
iOff
)<
iMöPos
 ){

138584 
iMöPos
 = 
pT
->
iPos
-pT->
iOff
;

138585 
pTîm
 = 
pT
;

138589 if–!
pTîm
 ){

138591 
rc
 = 
SQLITE_DONE
;

138593 
	`as£π
–
iCuºít
<=
iMöPos
 );

138594 if–0==(0xFE&*
pTîm
->
pLi°
) ){

138595 
pTîm
->
pLi°
 = 0;

138597 
	`·s3GëDñèPosôi⁄
(&
pTîm
->
pLi°
, &pTîm->
iPos
);

138599  
rc
==
SQLITE_OK
 && 
iCuºít
<
iMöPos
 ){

138600 
rc
 = 
pMod
->
	`xNext
(
pC
, &
ZDUMMY
, &
NDUMMY
, &
iSèπ
, &
iEnd
, &
iCuºít
);

138602 if–
rc
==
SQLITE_OK
 ){

138603 
aBuf„r
[64];

138604 
	`sqlôe3_¢¥ötf
((
aBuf„r
),áBuffer,

138605 "%d %d %d %d ", 
iCﬁ
, 
pTîm
-
sCtx
.
aTîm
, 
iSèπ
, 
iEnd
-iStart

138607 
rc
 = 
	`·s3SåögAµíd
(&
ªs
, 
aBuf„r
, -1);

138608 }if–
rc
==
SQLITE_DONE
 && 
pTab
->
zC⁄ã¡Tbl
==0 ){

138609 
rc
 = 
FTS_CORRUPT_VTAB
;

138613 if–
rc
==
SQLITE_DONE
 ){

138614 
rc
 = 
SQLITE_OK
;

138617 
pMod
->
	`xClo£
(
pC
);

138618 if–
rc
!=
SQLITE_OK
 ) 
off£ts_out
;

138621 
off£ts_out
:

138622 
	`sqlôe3_‰ì
(
sCtx
.
aTîm
);

138623 
	`as£π
–
rc
!=
SQLITE_DONE
 );

138624 
	`sqlôe3Fts3SegmítsClo£
(
pTab
);

138625 if–
rc
!=
SQLITE_OK
 ){

138626 
	`sqlôe3_ªsu…_îr‹_code
(
pCtx
, 
rc
);

138627 
	`sqlôe3_‰ì
(
ªs
.
z
);

138629 
	`sqlôe3_ªsu…_ãxt
(
pCtx
, 
ªs
.
z
,Ñes.
n
-1, 
sqlôe3_‰ì
);

138637 
SQLITE_PRIVATE
 
	`sqlôe3Fts3M©chöfo
(

138638 
sqlôe3_c⁄ãxt
 *
pC⁄ãxt
,

138639 
Fts3Curs‹
 *
pC§
,

138640 c⁄° *
zArg


138642 
Fts3TabÀ
 *
pTab
 = (Fts3TabÀ *)
pC§
->
ba£
.
pVèb
;

138643 
rc
;

138644 
i
;

138645 c⁄° *
zF‹m©
;

138647 if–
zArg
 ){

138648 
i
=0; 
zArg
[i]; i++){

138649 *
zEº
 = 0;

138650 if–
	`·s3M©chöfoCheck
(
pTab
, 
zArg
[
i
], &
zEº
) ){

138651 
	`sqlôe3_ªsu…_îr‹
(
pC⁄ãxt
, 
zEº
, -1);

138652 
	`sqlôe3_‰ì
(
zEº
);

138656 
zF‹m©
 = 
zArg
;

138658 
zF‹m©
 = 
FTS3_MATCHINFO_DEFAULT
;

138661 if–!
pC§
->
pEx¥
 ){

138662 
	`sqlôe3_ªsu…_blob
(
pC⁄ãxt
, "", 0, 
SQLITE_STATIC
);

138667 
rc
 = 
	`·s3GëM©chöfo
(
pC§
, 
zF‹m©
);

138668 
	`sqlôe3Fts3SegmítsClo£
(
pTab
);

138670 if–
rc
!=
SQLITE_OK
 ){

138671 
	`sqlôe3_ªsu…_îr‹_code
(
pC⁄ãxt
, 
rc
);

138673 
n
 = 
pC§
->
nM©chöfo
 * (
u32
);

138674 
	`sqlôe3_ªsu…_blob
(
pC⁄ãxt
, 
pC§
->
aM©chöfo
, 
n
, 
SQLITE_TRANSIENT
);

138697 #ifde‡
SQLITE_ENABLE_FTS4_UNICODE61


138699 #i‡!
	`deföed
(
SQLITE_CORE
Ë|| deföed(
SQLITE_ENABLE_FTS3
)

138712 #i‚de‡
SQLITE_AMALGAMATION


138714 c⁄° 
sqlôe3Utf8Tøns1
[] = {

138725 
	#READ_UTF8
(
zIn
, 
zTîm
, 
c
) \

138726 
c
 = *(
zIn
++); \

138727 if–
c
>=0xc0 ){ \

138728 
c
 = 
sqlôe3Utf8Tøns1
[c-0xc0]; \

138729  
zIn
!=
zTîm
 && (*zIn & 0xc0)==0x80 ){ \

138730 
c
 = (c<<6Ë+ (0x3‡& *(
zIn
++)); \

138732 if–
c
<0x80 \

138733 || (
c
&0xFFFFF800)==0xD800 \

138734 || (
c
&0xFFFFFFFE)==0xFFFE ){ c = 0xFFFD; } \

138735 }

	)

138737 
	#WRITE_UTF8
(
zOut
, 
c
) { \

138738 if–
c
<0x00080 ){ \

138739 *
zOut
++ = (
u8
)(
c
&0xFF); \

138741 if–
c
<0x00800 ){ \

138742 *
zOut
++ = 0xC0 + (
u8
)((
c
>>6)&0x1F); \

138743 *
zOut
++ = 0x80 + (
u8
)(
c
 & 0x3F); \

138745 if–
c
<0x10000 ){ \

138746 *
zOut
++ = 0xE0 + (
u8
)((
c
>>12)&0x0F); \

138747 *
zOut
++ = 0x80 + (
u8
)((
c
>>6) & 0x3F); \

138748 *
zOut
++ = 0x80 + (
u8
)(
c
 & 0x3F); \

138750 *
zOut
++ = 0xF0 + (
u8
)((
c
>>18) & 0x07); \

138751 *
zOut
++ = 0x80 + (
u8
)((
c
>>12) & 0x3F); \

138752 *
zOut
++ = 0x80 + (
u8
)((
c
>>6) & 0x3F); \

138753 *
zOut
++ = 0x80 + (
u8
)(
c
 & 0x3F); \

138755 }

	)

138759 
unicode_tokíizî
 
	tunicode_tokíizî
;

138760 
unicode_curs‹
 
	tunicode_curs‹
;

138762 
	sunicode_tokíizî
 {

138763 
sqlôe3_tokíizî
 
ba£
;

138764 
bRemoveDü¸ôic
;

138765 
nEx˚±i⁄
;

138766 *
aiEx˚±i⁄
;

138769 
	sunicode_curs‹
 {

138770 
sqlôe3_tokíizî_curs‹
 
ba£
;

138771 c⁄° *
aI≈ut
;

138772 
nI≈ut
;

138773 
iOff
;

138774 
iTokí
;

138775 *
zTokí
;

138776 
nAŒoc
;

138783 
	`unicodeDe°roy
(
sqlôe3_tokíizî
 *
pTokíizî
){

138784 if–
pTokíizî
 ){

138785 
unicode_tokíizî
 *
p
 = (unicode_tokíizî *)
pTokíizî
;

138786 
	`sqlôe3_‰ì
(
p
->
aiEx˚±i⁄
);

138787 
	`sqlôe3_‰ì
(
p
);

138789  
SQLITE_OK
;

138810 
	`unicodeAddEx˚±i⁄s
(

138811 
unicode_tokíizî
 *
p
,

138812 
bA um
,

138813 c⁄° *
zIn
,

138814 
nIn


138816 c⁄° *
z
 = (c⁄° *)
zIn
;

138817 c⁄° *
zTîm
 = &
z
[
nIn
];

138818 
iCode
;

138819 
nE¡ry
 = 0;

138821 
	`as£π
–
bA um
==0 || bAlnum==1 );

138823  
z
<
zTîm
 ){

138824 
	`READ_UTF8
(
z
, 
zTîm
, 
iCode
);

138825 
	`as£π
–(
	`sqlôe3FtsUnicodeIß um
(
iCode
) & 0xFFFFFFFE)==0 );

138826 if–
	`sqlôe3FtsUnicodeIß um
(
iCode
)!=
bA um


138827 && 
	`sqlôe3FtsUnicodeIsdü¸ôic
(
iCode
)==0

138829 
nE¡ry
++;

138833 if–
nE¡ry
 ){

138834 *
aNew
;

138835 
nNew
;

138837 
aNew
 = 
	`sqlôe3_ªÆloc
(
p
->
aiEx˚±i⁄
, (p->
nEx˚±i⁄
+
nE¡ry
)*());

138838 if–
aNew
==0 )  
SQLITE_NOMEM
;

138839 
nNew
 = 
p
->
nEx˚±i⁄
;

138841 
z
 = (c⁄° *)
zIn
;

138842  
z
<
zTîm
 ){

138843 
	`READ_UTF8
(
z
, 
zTîm
, 
iCode
);

138844 if–
	`sqlôe3FtsUnicodeIß um
(
iCode
)!=
bA um


138845 && 
	`sqlôe3FtsUnicodeIsdü¸ôic
(
iCode
)==0

138847 
i
, 
j
;

138848 
i
=0; i<
nNew
 && 
aNew
[i]<
iCode
; i++);

138849 
j
=
nNew
; j>
i
; j--Ë
aNew
[j] =áNew[j-1];

138850 
aNew
[
i
] = 
iCode
;

138851 
nNew
++;

138854 
p
->
aiEx˚±i⁄
 = 
aNew
;

138855 
p
->
nEx˚±i⁄
 = 
nNew
;

138858  
SQLITE_OK
;

138864 
	`unicodeIsEx˚±i⁄
(
unicode_tokíizî
 *
p
, 
iCode
){

138865 if–
p
->
nEx˚±i⁄
>0 ){

138866 *
a
 = 
p
->
aiEx˚±i⁄
;

138867 
iLo
 = 0;

138868 
iHi
 = 
p
->
nEx˚±i⁄
-1;

138870  
iHi
>=
iLo
 ){

138871 
iTe°
 = (
iHi
 + 
iLo
) / 2;

138872 if–
iCode
==
a
[
iTe°
] ){

138874 }if–
iCode
>
a
[
iTe°
] ){

138875 
iLo
 = 
iTe°
+1;

138877 
iHi
 = 
iTe°
-1;

138889 
	`unicodeIsA um
(
unicode_tokíizî
 *
p
, 
iCode
){

138890 
	`as£π
–(
	`sqlôe3FtsUnicodeIß um
(
iCode
) & 0xFFFFFFFE)==0 );

138891  
	`sqlôe3FtsUnicodeIß um
(
iCode
Ë^ 
	`unicodeIsEx˚±i⁄
(
p
, iCode);

138897 
	`unicodeCª©e
(

138898 
nArg
,

138899 c⁄° * c⁄° *
azArg
,

138900 
sqlôe3_tokíizî
 **
µ


138902 
unicode_tokíizî
 *
pNew
;

138903 
i
;

138904 
rc
 = 
SQLITE_OK
;

138906 
pNew
 = (
unicode_tokíizî
 *Ë
	`sqlôe3_mÆloc
((unicode_tokenizer));

138907 if–
pNew
==
NULL
 )  
SQLITE_NOMEM
;

138908 
	`mem£t
(
pNew
, 0, (
unicode_tokíizî
));

138909 
pNew
->
bRemoveDü¸ôic
 = 1;

138911 
i
=0; 
rc
==
SQLITE_OK
 && i<
nArg
; i++){

138912 c⁄° *
z
 = 
azArg
[
i
];

138913 
n
 = 
	`°æí
(
z
);

138915 if–
n
==19 && 
	`memcmp
("ªmove_dü¸ôics=1", 
z
, 19)==0 ){

138916 
pNew
->
bRemoveDü¸ôic
 = 1;

138918 if–
n
==19 && 
	`memcmp
("ªmove_dü¸ôics=0", 
z
, 19)==0 ){

138919 
pNew
->
bRemoveDü¸ôic
 = 0;

138921 if–
n
>=11 && 
	`memcmp
("tokích¨s=", 
z
, 11)==0 ){

138922 
rc
 = 
	`unicodeAddEx˚±i⁄s
(
pNew
, 1, &
z
[11], 
n
-11);

138924 if–
n
>=11 && 
	`memcmp
("£∑øt‹s=", 
z
, 11)==0 ){

138925 
rc
 = 
	`unicodeAddEx˚±i⁄s
(
pNew
, 0, &
z
[11], 
n
-11);

138929 
rc
 = 
SQLITE_ERROR
;

138933 if–
rc
!=
SQLITE_OK
 ){

138934 
	`unicodeDe°roy
((
sqlôe3_tokíizî
 *)
pNew
);

138935 
pNew
 = 0;

138937 *
µ
 = (
sqlôe3_tokíizî
 *)
pNew
;

138938  
rc
;

138947 
	`unicodeO≥n
(

138948 
sqlôe3_tokíizî
 *
p
,

138949 c⁄° *
aI≈ut
,

138950 
nI≈ut
,

138951 
sqlôe3_tokíizî_curs‹
 **
µ


138953 
unicode_curs‹
 *
pC§
;

138955 
pC§
 = (
unicode_curs‹
 *)
	`sqlôe3_mÆloc
((unicode_cursor));

138956 if–
pC§
==0 ){

138957  
SQLITE_NOMEM
;

138959 
	`mem£t
(
pC§
, 0, (
unicode_curs‹
));

138961 
pC§
->
aI≈ut
 = (const *)aInput;

138962 if–
aI≈ut
==0 ){

138963 
pC§
->
nI≈ut
 = 0;

138964 }if–
nI≈ut
<0 ){

138965 
pC§
->
nI≈ut
 = ()
	`°æí
(
aI≈ut
);

138967 
pC§
->
nI≈ut
 =ÇInput;

138970 *
µ
 = &
pC§
->
ba£
;

138971 
	`UNUSED_PARAMETER
(
p
);

138972  
SQLITE_OK
;

138979 
	`unicodeClo£
(
sqlôe3_tokíizî_curs‹
 *
pCurs‹
){

138980 
unicode_curs‹
 *
pC§
 = (unicode_curs‹ *Ë
pCurs‹
;

138981 
	`sqlôe3_‰ì
(
pC§
->
zTokí
);

138982 
	`sqlôe3_‰ì
(
pC§
);

138983  
SQLITE_OK
;

138990 
	`unicodeNext
(

138991 
sqlôe3_tokíizî_curs‹
 *
pC
,

138992 c⁄° **
∑Tokí
,

138993 *
≤Tokí
,

138994 *
piSèπ
,

138995 *
piEnd
,

138996 *
piPos


138998 
unicode_curs‹
 *
pC§
 = (unicode_curs‹ *)
pC
;

138999 
unicode_tokíizî
 *
p
 = ((unicode_tokíizî *)
pC§
->
ba£
.
pTokíizî
);

139000 
iCode
;

139001 *
zOut
;

139002 c⁄° *
z
 = &
pC§
->
aI≈ut
[pC§->
iOff
];

139003 c⁄° *
zSèπ
 = 
z
;

139004 c⁄° *
zEnd
;

139005 c⁄° *
zTîm
 = &
pC§
->
aI≈ut
[pC§->
nI≈ut
];

139010  
z
<
zTîm
 ){

139011 
	`READ_UTF8
(
z
, 
zTîm
, 
iCode
);

139012 if–
	`unicodeIsA um
(
p
, 
iCode
) ) ;

139013 
zSèπ
 = 
z
;

139015 if–
zSèπ
>=
zTîm
 )  
SQLITE_DONE
;

139017 
zOut
 = 
pC§
->
zTokí
;

139019 
iOut
;

139022 if–(
zOut
-
pC§
->
zTokí
)>=’C§->
nAŒoc
-4) ){

139023 *
zNew
 = 
	`sqlôe3_ªÆloc
(
pC§
->
zTokí
,ÖC§->
nAŒoc
+64);

139024 if–!
zNew
 )  
SQLITE_NOMEM
;

139025 
zOut
 = &
zNew
[zOuà- 
pC§
->
zTokí
];

139026 
pC§
->
zTokí
 = 
zNew
;

139027 
pC§
->
nAŒoc
 += 64;

139031 
zEnd
 = 
z
;

139032 
iOut
 = 
	`sqlôe3FtsUnicodeFﬁd
(
iCode
, 
p
->
bRemoveDü¸ôic
);

139033 if–
iOut
 ){

139034 
	`WRITE_UTF8
(
zOut
, 
iOut
);

139038 if–
z
>=
zTîm
 ) ;

139039 
	`READ_UTF8
(
z
, 
zTîm
, 
iCode
);

139040 } 
	`unicodeIsA um
(
p
, 
iCode
)

139041 || 
	`sqlôe3FtsUnicodeIsdü¸ôic
(
iCode
)

139045 
pC§
->
iOff
 = (
z
 -ÖC§->
aI≈ut
);

139046 *
∑Tokí
 = 
pC§
->
zTokí
;

139047 *
≤Tokí
 = 
zOut
 - 
pC§
->
zTokí
;

139048 *
piSèπ
 = (
zSèπ
 - 
pC§
->
aI≈ut
);

139049 *
piEnd
 = (
zEnd
 - 
pC§
->
aI≈ut
);

139050 *
piPos
 = 
pC§
->
iTokí
++;

139051  
SQLITE_OK
;

139058 
SQLITE_PRIVATE
 
	`sqlôe3Fts3UnicodeTokíizî
(
sqlôe3_tokíizî_moduÀ
 c⁄° **
µModuÀ
){

139059 c⁄° 
sqlôe3_tokíizî_moduÀ
 
moduÀ
 = {

139061 
unicodeCª©e
,

139062 
unicodeDe°roy
,

139063 
unicodeO≥n
,

139064 
unicodeClo£
,

139065 
unicodeNext
,

139068 *
µModuÀ
 = &
moduÀ
;

139093 #i‡
	`deföed
(
SQLITE_ENABLE_FTS4_UNICODE61
)

139094 #i‡
	`deföed
(
SQLITE_ENABLE_FTS3
Ë|| deföed(
SQLITE_ENABLE_FTS4
)

139105 
SQLITE_PRIVATE
 
	`sqlôe3FtsUnicodeIß um
(
c
){

139117 c⁄° 
aE¡ry
[] = {

139201 c⁄° 
aAscii
[4] = {

139205 if–
c
<128 ){

139206  ( (
aAscii
[
c
 >> 5] & (1 << (c & 0x001F)))==0 );

139207 }if–
c
<(1<<22) ){

139208 
key
 = ((()
c
)<<10) | 0x000003FF;

139209 
iRes
;

139210 
iHi
 = (
aE¡ry
)/(aEntry[0]) - 1;

139211 
iLo
 = 0;

139212  
iHi
>=
iLo
 ){

139213 
iTe°
 = (
iHi
 + 
iLo
) / 2;

139214 if–
key
 >
aE¡ry
[
iTe°
] ){

139215 
iRes
 = 
iTe°
;

139216 
iLo
 = 
iTe°
+1;

139218 
iHi
 = 
iTe°
-1;

139221 
	`as£π
–
aE¡ry
[0]<
key
 );

139222 
	`as£π
–
key
>=
aE¡ry
[
iRes
] );

139223  ((()
c
Ë>((
aE¡ry
[
iRes
]>>10) + (aEntry[iRes]&0x3FF)));

139237 
	`ªmove_dü¸ôic
(
c
){

139238 
aDü
[] = {

139253 
aCh¨
[] = {

139265 
key
 = ((()
c
)<<3) | 0x00000007;

139266 
iRes
 = 0;

139267 
iHi
 = (
aDü
)/(aDia[0]) - 1;

139268 
iLo
 = 0;

139269  
iHi
>=
iLo
 ){

139270 
iTe°
 = (
iHi
 + 
iLo
) / 2;

139271 if–
key
 >
aDü
[
iTe°
] ){

139272 
iRes
 = 
iTe°
;

139273 
iLo
 = 
iTe°
+1;

139275 
iHi
 = 
iTe°
-1;

139278 
	`as£π
–
key
>=
aDü
[
iRes
] );

139279  ((
c
 > (
aDü
[
iRes
]>>3Ë+ (aDü[iRes]&0x07)Ë? c : ()
aCh¨
[iRes]);

139287 
SQLITE_PRIVATE
 
	`sqlôe3FtsUnicodeIsdü¸ôic
(
c
){

139288 
mask0
 = 0x08029FDF;

139289 
mask1
 = 0x000361F8;

139290 if–
c
<768 || c>817 )  0;

139291  (
c
 < 768+32) ?

139292 (
mask0
 & (1 << (
c
-768))) :

139293 (
mask1
 & (1 << (
c
-768-32)));

139306 
SQLITE_PRIVATE
 
	`sqlôe3FtsUnicodeFﬁd
(
c
, 
bRemoveDü¸ôic
){

139324 c⁄° 
	sTabÀE¡ry
 {

139325 
iCode
;

139326 
Êags
;

139327 
nR™ge
;

139328 } 
aE¡ry
[] = {

139385 c⁄° 
aiOff
[] = {

139398 
ªt
 = 
c
;

139400 
	`as£π
–
c
>=0 );

139401 
	`as£π
( ()==2 && ()==1 );

139403 if–
c
<128 ){

139404 if–
c
>='A' && c<='Z' ) 
ªt
 = c + ('a' - 'A');

139405 }if–
c
<65536 ){

139406 
iHi
 = (
aE¡ry
)/(aEntry[0]) - 1;

139407 
iLo
 = 0;

139408 
iRes
 = -1;

139410  
iHi
>=
iLo
 ){

139411 
iTe°
 = (
iHi
 + 
iLo
) / 2;

139412 
cmp
 = (
c
 - 
aE¡ry
[
iTe°
].
iCode
);

139413 if–
cmp
>=0 ){

139414 
iRes
 = 
iTe°
;

139415 
iLo
 = 
iTe°
+1;

139417 
iHi
 = 
iTe°
-1;

139420 
	`as£π
–
iRes
<0 || 
c
>=
aE¡ry
[iRes].
iCode
 );

139422 if–
iRes
>=0 ){

139423 c⁄° 
TabÀE¡ry
 *
p
 = &
aE¡ry
[
iRes
];

139424 if–
c
<(
p
->
iCode
 +Ö->
nR™ge
Ë&& 0==(0x01 &Ö->
Êags
 & (p->iCode ^ c)) ){

139425 
ªt
 = (
c
 + (
aiOff
[
p
->
Êags
>>1])) & 0x0000FFFF;

139426 
	`as£π
–
ªt
>0 );

139430 if–
bRemoveDü¸ôic
 ) 
ªt
 = 
	`ªmove_dü¸ôic
(ret);

139433 if–
c
>=66560 && c<66600 ){

139434 
ªt
 = 
c
 + 40;

139437  
ªt
;

139498 #i‡!
	`deföed
(
SQLITE_CORE
Ë|| deföed(
SQLITE_ENABLE_RTREE
)

139511 
	#VARIANT_RSTARTREE_CHOOSESUBTREE
 0

	)

139512 
	#VARIANT_RSTARTREE_REINSERT
 1

	)

139517 
	#VARIANT_GUTTMAN_QUADRATIC_SPLIT
 0

	)

139518 
	#VARIANT_GUTTMAN_LINEAR_SPLIT
 0

	)

139519 
	#VARIANT_RSTARTREE_SPLIT
 1

	)

139521 
	#VARIANT_GUTTMAN_SPLIT
 \

139522 (
VARIANT_GUTTMAN_LINEAR_SPLIT
||
VARIANT_GUTTMAN_QUADRATIC_SPLIT
)

	)

139524 #i‡
VARIANT_GUTTMAN_QUADRATIC_SPLIT


139525 
	#PickNext
 
QuadøticPickNext


	)

139526 
	#PickSìds
 
QuadøticPickSìds


	)

139527 
	#AssignCñls
 
•lôNodeGuâm™


	)

139529 #i‡
VARIANT_GUTTMAN_LINEAR_SPLIT


139530 
	#PickNext
 
LöórPickNext


	)

139531 
	#PickSìds
 
LöórPickSìds


	)

139532 
	#AssignCñls
 
•lôNodeGuâm™


	)

139534 #i‡
VARIANT_RSTARTREE_SPLIT


139535 
	#AssignCñls
 
•lôNodeSèπªe


	)

139538 #i‡!
	`deföed
(
NDEBUG
Ë&& !deföed(
SQLITE_DEBUG
)

139539 
	#NDEBUG
 1

	)

139542 #i‚de‡
SQLITE_CORE


139543 
SQLITE_EXTENSION_INIT1


139550 #i‚de‡
SQLITE_AMALGAMATION


139551 
	~"sqlôe3πªe.h
"

139552 
sqlôe3_öt64
 
	ti64
;

139553 
	tu8
;

139554 
	tu32
;

139559 #i‚de‡
UNUSED_PARAMETER


139560 
	#UNUSED_PARAMETER
(
x
Ë()(x)

	)

139563 
Råì
 
	tRåì
;

139564 
RåìCurs‹
 
	tRåìCurs‹
;

139565 
RåìNode
 
	tRåìNode
;

139566 
RåìCñl
 
	tRåìCñl
;

139567 
RåìC⁄°øöt
 
	tRåìC⁄°øöt
;

139568 
RåìM©chArg
 
	tRåìM©chArg
;

139569 
RåìGeomCÆlback
 
	tRåìGeomCÆlback
;

139570 
RåìCo‹d
 
	tRåìCo‹d
;

139573 
	#RTREE_MAX_DIMENSIONS
 5

	)

139579 
	#HASHSIZE
 128

	)

139584 
	sRåì
 {

139585 
sqlôe3_vèb
 
ba£
;

139586 
sqlôe3
 *
db
;

139587 
iNodeSize
;

139588 
nDim
;

139589 
nByãsPîCñl
;

139590 
iDïth
;

139591 *
zDb
;

139592 *
zName
;

139593 
RåìNode
 *
aHash
[
HASHSIZE
];

139594 
nBusy
;

139601 
RåìNode
 *
pDñëed
;

139602 
iReö£πHeight
;

139605 
sqlôe3_°mt
 *
pRódNode
;

139606 
sqlôe3_°mt
 *
pWrôeNode
;

139607 
sqlôe3_°mt
 *
pDñëeNode
;

139610 
sqlôe3_°mt
 *
pRódRowid
;

139611 
sqlôe3_°mt
 *
pWrôeRowid
;

139612 
sqlôe3_°mt
 *
pDñëeRowid
;

139615 
sqlôe3_°mt
 *
pRódP¨ít
;

139616 
sqlôe3_°mt
 *
pWrôeP¨ít
;

139617 
sqlôe3_°mt
 *
pDñëeP¨ít
;

139619 
eCo‹dTy≥
;

139623 
	#RTREE_COORD_REAL32
 0

	)

139624 
	#RTREE_COORD_INT32
 1

	)

139631 #ifde‡
SQLITE_RTREE_INT_ONLY


139632 
sqlôe3_öt64
 
	tRåìDVÆue
;

139633 
	tRåìVÆue
;

139635 
	tRåìDVÆue
;

139636 
	tRåìVÆue
;

139648 
	#RTREE_MINCELLS
(
p
Ë(((’)->
iNodeSize
-4)/’)->
nByãsPîCñl
)/3)

	)

139649 
	#RTREE_REINSERT
(
p
Ë
	`RTREE_MINCELLS
’)

	)

139650 
	#RTREE_MAXCELLS
 51

	)

139659 
	#RTREE_MAX_DEPTH
 40

	)

139664 
	sRåìCurs‹
 {

139665 
sqlôe3_vèb_curs‹
 
ba£
;

139666 
RåìNode
 *
pNode
;

139667 
iCñl
;

139668 
iSå©egy
;

139669 
nC⁄°øöt
;

139670 
RåìC⁄°øöt
 *
aC⁄°øöt
;

139673 
	uRåìCo‹d
 {

139674 
RåìVÆue
 
f
;

139675 
i
;

139684 #ifde‡
SQLITE_RTREE_INT_ONLY


139685 
	#DCOORD
(
co‹d
Ë((
RåìDVÆue
)co‹d.
i
)

	)

139687 
	#DCOORD
(
co‹d
) ( \

139688 (
pRåì
->
eCo‹dTy≥
==
RTREE_COORD_REAL32
) ? \

139689 (()
co‹d
.
f
) : \

139690 (()
co‹d
.
i
) \

139691 )

	)

139697 
	sRåìC⁄°øöt
 {

139698 
iCo‹d
;

139699 
›
;

139700 
RåìDVÆue
 
rVÆue
;

139701 (*
xGeom
)(
sqlôe3_πªe_geomëry
*, , 
RåìDVÆue
*, *);

139702 
sqlôe3_πªe_geomëry
 *
pGeom
;

139706 
	#RTREE_EQ
 0x41

	)

139707 
	#RTREE_LE
 0x42

	)

139708 
	#RTREE_LT
 0x43

	)

139709 
	#RTREE_GE
 0x44

	)

139710 
	#RTREE_GT
 0x45

	)

139711 
	#RTREE_MATCH
 0x46

	)

139716 
	sRåìNode
 {

139717 
RåìNode
 *
pP¨ít
;

139718 
i64
 
iNode
;

139719 
nRef
;

139720 
isDúty
;

139721 
u8
 *
zD©a
;

139722 
RåìNode
 *
pNext
;

139724 
	#NCELL
(
pNode
Ë
	`ªadI¡16
(&’Node)->
zD©a
[2])

	)

139729 
	sRåìCñl
 {

139730 
i64
 
iRowid
;

139731 
RåìCo‹d
 
aCo‹d
[
RTREE_MAX_DIMENSIONS
*2];

139740 
	#RTREE_GEOMETRY_MAGIC
 0x891245AB

	)

139747 
	sRåìM©chArg
 {

139748 
u32
 
magic
;

139749 (*
xGeom
)(
sqlôe3_πªe_geomëry
 *, , 
RåìDVÆue
*, *);

139750 *
pC⁄ãxt
;

139751 
nP¨am
;

139752 
RåìDVÆue
 
aP¨am
[1];

139763 
	sRåìGeomCÆlback
 {

139764 (*
xGeom
)(
sqlôe3_πªe_geomëry
*, , 
RåìDVÆue
*, *);

139765 *
pC⁄ãxt
;

139768 #i‚de‡
MAX


139769 
	#MAX
(
x
,
y
Ë((xË< (yË? (yË: (x))

	)

139771 #i‚de‡
MIN


139772 
	#MIN
(
x
,
y
Ë((xË> (yË? (yË: (x))

	)

139779 
	`ªadI¡16
(
u8
 *
p
){

139780  (
p
[0]<<8) +Ö[1];

139782 
	`ªadCo‹d
(
u8
 *
p
, 
RåìCo‹d
 *
pCo‹d
){

139783 
u32
 
i
 = (

139784 (((
u32
)
p
[0]) << 24) +

139785 (((
u32
)
p
[1]) << 16) +

139786 (((
u32
)
p
[2]) << 8) +

139787 (((
u32
)
p
[3]) << 0)

139789 *(
u32
 *)
pCo‹d
 = 
i
;

139791 
i64
 
	`ªadI¡64
(
u8
 *
p
){

139793 (((
i64
)
p
[0]) << 56) +

139794 (((
i64
)
p
[1]) << 48) +

139795 (((
i64
)
p
[2]) << 40) +

139796 (((
i64
)
p
[3]) << 32) +

139797 (((
i64
)
p
[4]) << 24) +

139798 (((
i64
)
p
[5]) << 16) +

139799 (((
i64
)
p
[6]) << 8) +

139800 (((
i64
)
p
[7]) << 0)

139809 
	`wrôeI¡16
(
u8
 *
p
, 
i
){

139810 
p
[0] = (
i
>> 8)&0xFF;

139811 
p
[1] = (
i
>> 0)&0xFF;

139814 
	`wrôeCo‹d
(
u8
 *
p
, 
RåìCo‹d
 *
pCo‹d
){

139815 
u32
 
i
;

139816 
	`as£π
–(
RåìCo‹d
)==4 );

139817 
	`as£π
–(
u32
)==4 );

139818 
i
 = *(
u32
 *)
pCo‹d
;

139819 
p
[0] = (
i
>>24)&0xFF;

139820 
p
[1] = (
i
>>16)&0xFF;

139821 
p
[2] = (
i
>> 8)&0xFF;

139822 
p
[3] = (
i
>> 0)&0xFF;

139825 
	`wrôeI¡64
(
u8
 *
p
, 
i64
 
i
){

139826 
p
[0] = (
i
>>56)&0xFF;

139827 
p
[1] = (
i
>>48)&0xFF;

139828 
p
[2] = (
i
>>40)&0xFF;

139829 
p
[3] = (
i
>>32)&0xFF;

139830 
p
[4] = (
i
>>24)&0xFF;

139831 
p
[5] = (
i
>>16)&0xFF;

139832 
p
[6] = (
i
>> 8)&0xFF;

139833 
p
[7] = (
i
>> 0)&0xFF;

139840 
	`nodeRe„ªn˚
(
RåìNode
 *
p
){

139841 if–
p
 ){

139842 
p
->
nRef
++;

139849 
	`nodeZîo
(
Råì
 *
pRåì
, 
RåìNode
 *
p
){

139850 
	`mem£t
(&
p
->
zD©a
[2], 0, 
pRåì
->
iNodeSize
-2);

139851 
p
->
isDúty
 = 1;

139858 
	`nodeHash
(
i64
 
iNode
){

139860 (
iNode
>>56) ^ (iNode>>48) ^ (iNode>>40) ^ (iNode>>32) ^

139861 (
iNode
>>24) ^ (iNode>>16) ^ (iNode>> 8) ^ (iNode>> 0)

139862 Ë% 
HASHSIZE
;

139869 
RåìNode
 *
	`nodeHashLookup
(
Råì
 *
pRåì
, 
i64
 
iNode
){

139870 
RåìNode
 *
p
;

139871 
p
=
pRåì
->
aHash
[
	`nodeHash
(
iNode
)];Ö &&Ö->iNode!=iNode;Öı->
pNext
);

139872  
p
;

139878 
	`nodeHashIn£π
(
Råì
 *
pRåì
, 
RåìNode
 *
pNode
){

139879 
iHash
;

139880 
	`as£π
–
pNode
->
pNext
==0 );

139881 
iHash
 = 
	`nodeHash
(
pNode
->
iNode
);

139882 
pNode
->
pNext
 = 
pRåì
->
aHash
[
iHash
];

139883 
pRåì
->
aHash
[
iHash
] = 
pNode
;

139889 
	`nodeHashDñëe
(
Råì
 *
pRåì
, 
RåìNode
 *
pNode
){

139890 
RåìNode
 **
µ
;

139891 if–
pNode
->
iNode
!=0 ){

139892 
µ
 = &
pRåì
->
aHash
[
	`nodeHash
(
pNode
->
iNode
)];

139893  ; (*
µ
)!=
pNode
;Ö∞&(*µ)->
pNext
){ 
	`as£π
(*pp); }

139894 *
µ
 = 
pNode
->
pNext
;

139895 
pNode
->
pNext
 = 0;

139905 
RåìNode
 *
	`nodeNew
(
Råì
 *
pRåì
, RåìNodê*
pP¨ít
){

139906 
RåìNode
 *
pNode
;

139907 
pNode
 = (
RåìNode
 *)
	`sqlôe3_mÆloc
((RåìNodeË+ 
pRåì
->
iNodeSize
);

139908 if–
pNode
 ){

139909 
	`mem£t
(
pNode
, 0, (
RåìNode
Ë+ 
pRåì
->
iNodeSize
);

139910 
pNode
->
zD©a
 = (
u8
 *)&pNode[1];

139911 
pNode
->
nRef
 = 1;

139912 
pNode
->
pP¨ít
 =ÖParent;

139913 
pNode
->
isDúty
 = 1;

139914 
	`nodeRe„ªn˚
(
pP¨ít
);

139916  
pNode
;

139923 
	`nodeAcquúe
(

139924 
Råì
 *
pRåì
,

139925 
i64
 
iNode
,

139926 
RåìNode
 *
pP¨ít
,

139927 
RåìNode
 **
µNode


139929 
rc
;

139930 
rc2
 = 
SQLITE_OK
;

139931 
RåìNode
 *
pNode
;

139936 if–(
pNode
 = 
	`nodeHashLookup
(
pRåì
, 
iNode
)) ){

139937 
	`as£π
–!
pP¨ít
 || !
pNode
->pParent ||ÖNode->pParent==pParent );

139938 if–
pP¨ít
 && !
pNode
->pParent ){

139939 
	`nodeRe„ªn˚
(
pP¨ít
);

139940 
pNode
->
pP¨ít
 =ÖParent;

139942 
pNode
->
nRef
++;

139943 *
µNode
 = 
pNode
;

139944  
SQLITE_OK
;

139947 
	`sqlôe3_böd_öt64
(
pRåì
->
pRódNode
, 1, 
iNode
);

139948 
rc
 = 
	`sqlôe3_°ï
(
pRåì
->
pRódNode
);

139949 if–
rc
==
SQLITE_ROW
 ){

139950 c⁄° 
u8
 *
zBlob
 = 
	`sqlôe3_cﬁumn_blob
(
pRåì
->
pRódNode
, 0);

139951 if–
pRåì
->
iNodeSize
==
	`sqlôe3_cﬁumn_byãs
’Råì->
pRódNode
, 0) ){

139952 
pNode
 = (
RåìNode
 *)
	`sqlôe3_mÆloc
((RåìNode)+
pRåì
->
iNodeSize
);

139953 if–!
pNode
 ){

139954 
rc2
 = 
SQLITE_NOMEM
;

139956 
pNode
->
pP¨ít
 =ÖParent;

139957 
pNode
->
zD©a
 = (
u8
 *)&pNode[1];

139958 
pNode
->
nRef
 = 1;

139959 
pNode
->
iNode
 = iNode;

139960 
pNode
->
isDúty
 = 0;

139961 
pNode
->
pNext
 = 0;

139962 
	`mem˝y
(
pNode
->
zD©a
, 
zBlob
, 
pRåì
->
iNodeSize
);

139963 
	`nodeRe„ªn˚
(
pP¨ít
);

139967 
rc
 = 
	`sqlôe3_ª£t
(
pRåì
->
pRódNode
);

139968 if–
rc
==
SQLITE_OK
 )Ñ¯
rc2
;

139976 if–
pNode
 && 
iNode
==1 ){

139977 
pRåì
->
iDïth
 = 
	`ªadI¡16
(
pNode
->
zD©a
);

139978 if–
pRåì
->
iDïth
>
RTREE_MAX_DEPTH
 ){

139979 
rc
 = 
SQLITE_CORRUPT_VTAB
;

139987 if–
pNode
 && 
rc
==
SQLITE_OK
 ){

139988 if–
	`NCELL
(
pNode
)>((
pRåì
->
iNodeSize
-4)/pRåì->
nByãsPîCñl
) ){

139989 
rc
 = 
SQLITE_CORRUPT_VTAB
;

139993 if–
rc
==
SQLITE_OK
 ){

139994 if–
pNode
!=0 ){

139995 
	`nodeHashIn£π
(
pRåì
, 
pNode
);

139997 
rc
 = 
SQLITE_CORRUPT_VTAB
;

139999 *
µNode
 = 
pNode
;

140001 
	`sqlôe3_‰ì
(
pNode
);

140002 *
µNode
 = 0;

140005  
rc
;

140011 
	`nodeOvîwrôeCñl
(

140012 
Råì
 *
pRåì
,

140013 
RåìNode
 *
pNode
,

140014 
RåìCñl
 *
pCñl
,

140015 
iCñl


140017 
ii
;

140018 
u8
 *
p
 = &
pNode
->
zD©a
[4 + 
pRåì
->
nByãsPîCñl
*
iCñl
];

140019 
p
 +
	`wrôeI¡64
’, 
pCñl
->
iRowid
);

140020 
ii
=0; ii<(
pRåì
->
nDim
*2); ii++){

140021 
p
 +
	`wrôeCo‹d
’, &
pCñl
->
aCo‹d
[
ii
]);

140023 
pNode
->
isDúty
 = 1;

140029 
	`nodeDñëeCñl
(
Råì
 *
pRåì
, 
RåìNode
 *
pNode
, 
iCñl
){

140030 
u8
 *
pD°
 = &
pNode
->
zD©a
[4 + 
pRåì
->
nByãsPîCñl
*
iCñl
];

140031 
u8
 *
pSrc
 = &
pD°
[
pRåì
->
nByãsPîCñl
];

140032 
nByã
 = (
	`NCELL
(
pNode
Ë- 
iCñl
 - 1Ë* 
pRåì
->
nByãsPîCñl
;

140033 
	`memmove
(
pD°
, 
pSrc
, 
nByã
);

140034 
	`wrôeI¡16
(&
pNode
->
zD©a
[2], 
	`NCELL
(pNode)-1);

140035 
pNode
->
isDúty
 = 1;

140045 
	`nodeIn£πCñl
(

140046 
Råì
 *
pRåì
,

140047 
RåìNode
 *
pNode
,

140048 
RåìCñl
 *
pCñl


140050 
nCñl
;

140051 
nMaxCñl
;

140053 
nMaxCñl
 = (
pRåì
->
iNodeSize
-4)/pRåì->
nByãsPîCñl
;

140054 
nCñl
 = 
	`NCELL
(
pNode
);

140056 
	`as£π
–
nCñl
<=
nMaxCñl
 );

140057 if–
nCñl
<
nMaxCñl
 ){

140058 
	`nodeOvîwrôeCñl
(
pRåì
, 
pNode
, 
pCñl
, 
nCñl
);

140059 
	`wrôeI¡16
(&
pNode
->
zD©a
[2], 
nCñl
+1);

140060 
pNode
->
isDúty
 = 1;

140063  (
nCñl
==
nMaxCñl
);

140070 
	`nodeWrôe
(
Råì
 *
pRåì
, 
RåìNode
 *
pNode
){

140071 
rc
 = 
SQLITE_OK
;

140072 if–
pNode
->
isDúty
 ){

140073 
sqlôe3_°mt
 *
p
 = 
pRåì
->
pWrôeNode
;

140074 if–
pNode
->
iNode
 ){

140075 
	`sqlôe3_böd_öt64
(
p
, 1, 
pNode
->
iNode
);

140077 
	`sqlôe3_böd_nuŒ
(
p
, 1);

140079 
	`sqlôe3_böd_blob
(
p
, 2, 
pNode
->
zD©a
, 
pRåì
->
iNodeSize
, 
SQLITE_STATIC
);

140080 
	`sqlôe3_°ï
(
p
);

140081 
pNode
->
isDúty
 = 0;

140082 
rc
 = 
	`sqlôe3_ª£t
(
p
);

140083 if–
pNode
->
iNode
==0 && 
rc
==
SQLITE_OK
 ){

140084 
pNode
->
iNode
 = 
	`sqlôe3_œ°_ö£π_rowid
(
pRåì
->
db
);

140085 
	`nodeHashIn£π
(
pRåì
, 
pNode
);

140088  
rc
;

140096 
	`nodeRñó£
(
Råì
 *
pRåì
, 
RåìNode
 *
pNode
){

140097 
rc
 = 
SQLITE_OK
;

140098 if–
pNode
 ){

140099 
	`as£π
–
pNode
->
nRef
>0 );

140100 
pNode
->
nRef
--;

140101 if–
pNode
->
nRef
==0 ){

140102 if–
pNode
->
iNode
==1 ){

140103 
pRåì
->
iDïth
 = -1;

140105 if–
pNode
->
pP¨ít
 ){

140106 
rc
 = 
	`nodeRñó£
(
pRåì
, 
pNode
->
pP¨ít
);

140108 if–
rc
==
SQLITE_OK
 ){

140109 
rc
 = 
	`nodeWrôe
(
pRåì
, 
pNode
);

140111 
	`nodeHashDñëe
(
pRåì
, 
pNode
);

140112 
	`sqlôe3_‰ì
(
pNode
);

140115  
rc
;

140123 
i64
 
	`nodeGëRowid
(

140124 
Råì
 *
pRåì
,

140125 
RåìNode
 *
pNode
,

140126 
iCñl


140128 
	`as£π
–
iCñl
<
	`NCELL
(
pNode
) );

140129  
	`ªadI¡64
(&
pNode
->
zD©a
[4 + 
pRåì
->
nByãsPîCñl
*
iCñl
]);

140135 
	`nodeGëCo‹d
(

140136 
Råì
 *
pRåì
,

140137 
RåìNode
 *
pNode
,

140138 
iCñl
,

140139 
iCo‹d
,

140140 
RåìCo‹d
 *
pCo‹d


140142 
	`ªadCo‹d
(&
pNode
->
zD©a
[12 + 
pRåì
->
nByãsPîCñl
*
iCñl
 + 4*
iCo‹d
], 
pCo‹d
);

140149 
	`nodeGëCñl
(

140150 
Råì
 *
pRåì
,

140151 
RåìNode
 *
pNode
,

140152 
iCñl
,

140153 
RåìCñl
 *
pCñl


140155 
ii
;

140156 
pCñl
->
iRowid
 = 
	`nodeGëRowid
(
pRåì
, 
pNode
, 
iCñl
);

140157 
ii
=0; ii<
pRåì
->
nDim
*2; ii++){

140158 
	`nodeGëCo‹d
(
pRåì
, 
pNode
, 
iCñl
, 
ii
, &
pCñl
->
aCo‹d
[ii]);

140166 
	`πªeInô
(

140167 
sqlôe3
 *, *, , c⁄° *c⁄°*, 
sqlôe3_vèb
 **, **, 

140173 
	`πªeCª©e
(

140174 
sqlôe3
 *
db
,

140175 *
pAux
,

140176 
¨gc
, c⁄° *c⁄°*
¨gv
,

140177 
sqlôe3_vèb
 **
µVèb
,

140178 **
pzEº


140180  
	`πªeInô
(
db
, 
pAux
, 
¨gc
, 
¨gv
, 
µVèb
, 
pzEº
, 1);

140186 
	`πªeC⁄√˘
(

140187 
sqlôe3
 *
db
,

140188 *
pAux
,

140189 
¨gc
, c⁄° *c⁄°*
¨gv
,

140190 
sqlôe3_vèb
 **
µVèb
,

140191 **
pzEº


140193  
	`πªeInô
(
db
, 
pAux
, 
¨gc
, 
¨gv
, 
µVèb
, 
pzEº
, 0);

140199 
	`πªeRe„ªn˚
(
Råì
 *
pRåì
){

140200 
pRåì
->
nBusy
++;

140207 
	`πªeRñó£
(
Råì
 *
pRåì
){

140208 
pRåì
->
nBusy
--;

140209 if–
pRåì
->
nBusy
==0 ){

140210 
	`sqlôe3_föÆize
(
pRåì
->
pRódNode
);

140211 
	`sqlôe3_föÆize
(
pRåì
->
pWrôeNode
);

140212 
	`sqlôe3_föÆize
(
pRåì
->
pDñëeNode
);

140213 
	`sqlôe3_föÆize
(
pRåì
->
pRódRowid
);

140214 
	`sqlôe3_föÆize
(
pRåì
->
pWrôeRowid
);

140215 
	`sqlôe3_föÆize
(
pRåì
->
pDñëeRowid
);

140216 
	`sqlôe3_föÆize
(
pRåì
->
pRódP¨ít
);

140217 
	`sqlôe3_föÆize
(
pRåì
->
pWrôeP¨ít
);

140218 
	`sqlôe3_föÆize
(
pRåì
->
pDñëeP¨ít
);

140219 
	`sqlôe3_‰ì
(
pRåì
);

140226 
	`πªeDisc⁄√˘
(
sqlôe3_vèb
 *
pVèb
){

140227 
	`πªeRñó£
((
Råì
 *)
pVèb
);

140228  
SQLITE_OK
;

140234 
	`πªeDe°roy
(
sqlôe3_vèb
 *
pVèb
){

140235 
Råì
 *
pRåì
 = (Råì *)
pVèb
;

140236 
rc
;

140237 *
zCª©e
 = 
	`sqlôe3_m¥ötf
(

140241 
pRåì
->
zDb
,ÖRåì->
zName
,

140242 
pRåì
->
zDb
,ÖRåì->
zName
,

140243 
pRåì
->
zDb
,ÖRåì->
zName


140245 if–!
zCª©e
 ){

140246 
rc
 = 
SQLITE_NOMEM
;

140248 
rc
 = 
	`sqlôe3_exec
(
pRåì
->
db
, 
zCª©e
, 0, 0, 0);

140249 
	`sqlôe3_‰ì
(
zCª©e
);

140251 if–
rc
==
SQLITE_OK
 ){

140252 
	`πªeRñó£
(
pRåì
);

140255  
rc
;

140261 
	`πªeO≥n
(
sqlôe3_vèb
 *
pVTab
, 
sqlôe3_vèb_curs‹
 **
µCurs‹
){

140262 
rc
 = 
SQLITE_NOMEM
;

140263 
RåìCurs‹
 *
pC§
;

140265 
pC§
 = (
RåìCurs‹
 *)
	`sqlôe3_mÆloc
((RtreeCursor));

140266 if–
pC§
 ){

140267 
	`mem£t
(
pC§
, 0, (
RåìCurs‹
));

140268 
pC§
->
ba£
.
pVèb
 = 
pVTab
;

140269 
rc
 = 
SQLITE_OK
;

140271 *
µCurs‹
 = (
sqlôe3_vèb_curs‹
 *)
pC§
;

140273  
rc
;

140280 
	`‰ìCurs‹C⁄°øöts
(
RåìCurs‹
 *
pC§
){

140281 if–
pC§
->
aC⁄°øöt
 ){

140282 
i
;

140283 
i
=0; i<
pC§
->
nC⁄°øöt
; i++){

140284 
sqlôe3_πªe_geomëry
 *
pGeom
 = 
pC§
->
aC⁄°øöt
[
i
].pGeom;

140285 if–
pGeom
 ){

140286 if–
pGeom
->
xDñU£r
 )ÖGeom->
	`xDñU£r
’Geom->
pU£r
);

140287 
	`sqlôe3_‰ì
(
pGeom
);

140290 
	`sqlôe3_‰ì
(
pC§
->
aC⁄°øöt
);

140291 
pC§
->
aC⁄°øöt
 = 0;

140298 
	`πªeClo£
(
sqlôe3_vèb_curs‹
 *
cur
){

140299 
Råì
 *
pRåì
 = (Råì *)(
cur
->
pVèb
);

140300 
rc
;

140301 
RåìCurs‹
 *
pC§
 = (RåìCurs‹ *)
cur
;

140302 
	`‰ìCurs‹C⁄°øöts
(
pC§
);

140303 
rc
 = 
	`nodeRñó£
(
pRåì
, 
pC§
->
pNode
);

140304 
	`sqlôe3_‰ì
(
pC§
);

140305  
rc
;

140314 
	`πªeEof
(
sqlôe3_vèb_curs‹
 *
cur
){

140315 
RåìCurs‹
 *
pC§
 = (RåìCurs‹ *)
cur
;

140316  (
pC§
->
pNode
==0);

140323 
	`ã°RåìGeom
(

140324 
Råì
 *
pRåì
,

140325 
RåìC⁄°øöt
 *
pC⁄°øöt
,

140326 
RåìCñl
 *
pCñl
,

140327 *
pbRes


140329 
i
;

140330 
RåìDVÆue
 
aCo‹d
[
RTREE_MAX_DIMENSIONS
*2];

140331 
nCo‹d
 = 
pRåì
->
nDim
*2;

140333 
	`as£π
–
pC⁄°øöt
->
›
==
RTREE_MATCH
 );

140334 
	`as£π
–
pC⁄°øöt
->
pGeom
 );

140336 
i
=0; i<
nCo‹d
; i++){

140337 
aCo‹d
[
i
] = 
	`DCOORD
(
pCñl
->aCoord[i]);

140339  
pC⁄°øöt
->
	`xGeom
’C⁄°øöt->
pGeom
, 
nCo‹d
, 
aCo‹d
, 
pbRes
);

140351 
	`ã°RåìCñl
(
Råì
 *
pRåì
, 
RåìCurs‹
 *
pCurs‹
, *
pbEof
){

140352 
RåìCñl
 
˚Œ
;

140353 
ii
;

140354 
bRes
 = 0;

140355 
rc
 = 
SQLITE_OK
;

140357 
	`nodeGëCñl
(
pRåì
, 
pCurs‹
->
pNode
,ÖCurs‹->
iCñl
, &
˚Œ
);

140358 
ii
=0; 
bRes
==0 && ii<
pCurs‹
->
nC⁄°øöt
; ii++){

140359 
RåìC⁄°øöt
 *
p
 = &
pCurs‹
->
aC⁄°øöt
[
ii
];

140360 
RåìDVÆue
 
˚Œ_mö
 = 
	`DCOORD
(
˚Œ
.
aCo‹d
[(
p
->
iCo‹d
>>1)*2]);

140361 
RåìDVÆue
 
˚Œ_max
 = 
	`DCOORD
(
˚Œ
.
aCo‹d
[(
p
->
iCo‹d
>>1)*2+1]);

140363 
	`as£π
(
p
->
›
==
RTREE_LE
 ||Ö->›==
RTREE_LT
 ||Ö->›==
RTREE_GE


140364 || 
p
->
›
==
RTREE_GT
 ||Ö->›==
RTREE_EQ
 ||Ö->›==
RTREE_MATCH


140367  
p
->
›
 ){

140368 
RTREE_LE
: 
RTREE_LT
:

140369 
bRes
 = 
p
->
rVÆue
<
˚Œ_mö
;

140372 
RTREE_GE
: 
RTREE_GT
:

140373 
bRes
 = 
p
->
rVÆue
>
˚Œ_max
;

140376 
RTREE_EQ
:

140377 
bRes
 = (
p
->
rVÆue
>
˚Œ_max
 ||Ö->rVÆue<
˚Œ_mö
);

140381 
	`as£π
–
p
->
›
==
RTREE_MATCH
 );

140382 
rc
 = 
	`ã°RåìGeom
(
pRåì
, 
p
, &
˚Œ
, &
bRes
);

140383 
bRes
 = !bRes;

140389 *
pbEof
 = 
bRes
;

140390  
rc
;

140405 
	`ã°RåìE¡ry
(
Råì
 *
pRåì
, 
RåìCurs‹
 *
pCurs‹
, *
pbEof
){

140406 
RåìCñl
 
˚Œ
;

140407 
ii
;

140408 *
pbEof
 = 0;

140410 
	`nodeGëCñl
(
pRåì
, 
pCurs‹
->
pNode
,ÖCurs‹->
iCñl
, &
˚Œ
);

140411 
ii
=0; ii<
pCurs‹
->
nC⁄°øöt
; ii++){

140412 
RåìC⁄°øöt
 *
p
 = &
pCurs‹
->
aC⁄°øöt
[
ii
];

140413 
RåìDVÆue
 
co‹d
 = 
	`DCOORD
(
˚Œ
.
aCo‹d
[
p
->
iCo‹d
]);

140414 
ªs
;

140415 
	`as£π
(
p
->
›
==
RTREE_LE
 ||Ö->›==
RTREE_LT
 ||Ö->›==
RTREE_GE


140416 || 
p
->
›
==
RTREE_GT
 ||Ö->›==
RTREE_EQ
 ||Ö->›==
RTREE_MATCH


140418  
p
->
›
 ){

140419 
RTREE_LE
: 
ªs
 = (
co‹d
<=
p
->
rVÆue
); ;

140420 
RTREE_LT
: 
ªs
 = (
co‹d
<
p
->
rVÆue
); ;

140421 
RTREE_GE
: 
ªs
 = (
co‹d
>=
p
->
rVÆue
); ;

140422 
RTREE_GT
: 
ªs
 = (
co‹d
>
p
->
rVÆue
); ;

140423 
RTREE_EQ
: 
ªs
 = (
co‹d
==
p
->
rVÆue
); ;

140425 
rc
;

140426 
	`as£π
–
p
->
›
==
RTREE_MATCH
 );

140427 
rc
 = 
	`ã°RåìGeom
(
pRåì
, 
p
, &
˚Œ
, &
ªs
);

140428 if–
rc
!=
SQLITE_OK
 ){

140429  
rc
;

140435 if–!
ªs
 ){

140436 *
pbEof
 = 1;

140437  
SQLITE_OK
;

140441  
SQLITE_OK
;

140450 
	`des˚ndToCñl
(

140451 
Råì
 *
pRåì
,

140452 
RåìCurs‹
 *
pCurs‹
,

140453 
iHeight
,

140454 *
pEof


140456 
isEof
;

140457 
rc
;

140458 
ii
;

140459 
RåìNode
 *
pChûd
;

140460 
sqlôe3_öt64
 
iRowid
;

140462 
RåìNode
 *
pSavedNode
 = 
pCurs‹
->
pNode
;

140463 
iSavedCñl
 = 
pCurs‹
->
iCñl
;

140465 
	`as£π
–
iHeight
>=0 );

140467 if–
iHeight
==0 ){

140468 
rc
 = 
	`ã°RåìE¡ry
(
pRåì
, 
pCurs‹
, &
isEof
);

140470 
rc
 = 
	`ã°RåìCñl
(
pRåì
, 
pCurs‹
, &
isEof
);

140472 if–
rc
!=
SQLITE_OK
 || 
isEof
 || 
iHeight
==0 ){

140473 
des˚nd_to_˚Œ_out
;

140476 
iRowid
 = 
	`nodeGëRowid
(
pRåì
, 
pCurs‹
->
pNode
,ÖCurs‹->
iCñl
);

140477 
rc
 = 
	`nodeAcquúe
(
pRåì
, 
iRowid
, 
pCurs‹
->
pNode
, &
pChûd
);

140478 if–
rc
!=
SQLITE_OK
 ){

140479 
des˚nd_to_˚Œ_out
;

140482 
	`nodeRñó£
(
pRåì
, 
pCurs‹
->
pNode
);

140483 
pCurs‹
->
pNode
 = 
pChûd
;

140484 
isEof
 = 1;

140485 
ii
=0; 
isEof
 && ii<
	`NCELL
(
pChûd
); ii++){

140486 
pCurs‹
->
iCñl
 = 
ii
;

140487 
rc
 = 
	`des˚ndToCñl
(
pRåì
, 
pCurs‹
, 
iHeight
-1, &
isEof
);

140488 if–
rc
!=
SQLITE_OK
 ){

140489 
des˚nd_to_˚Œ_out
;

140493 if–
isEof
 ){

140494 
	`as£π
–
pCurs‹
->
pNode
==
pChûd
 );

140495 
	`nodeRe„ªn˚
(
pSavedNode
);

140496 
	`nodeRñó£
(
pRåì
, 
pChûd
);

140497 
pCurs‹
->
pNode
 = 
pSavedNode
;

140498 
pCurs‹
->
iCñl
 = 
iSavedCñl
;

140501 
des˚nd_to_˚Œ_out
:

140502 *
pEof
 = 
isEof
;

140503  
rc
;

140510 
	`nodeRowidIndex
(

140511 
Råì
 *
pRåì
,

140512 
RåìNode
 *
pNode
,

140513 
i64
 
iRowid
,

140514 *
piIndex


140516 
ii
;

140517 
nCñl
 = 
	`NCELL
(
pNode
);

140518 
ii
=0; ii<
nCñl
; ii++){

140519 if–
	`nodeGëRowid
(
pRåì
, 
pNode
, 
ii
)==
iRowid
 ){

140520 *
piIndex
 = 
ii
;

140521  
SQLITE_OK
;

140524  
SQLITE_CORRUPT_VTAB
;

140531 
	`nodeP¨ítIndex
(
Råì
 *
pRåì
, 
RåìNode
 *
pNode
, *
piIndex
){

140532 
RåìNode
 *
pP¨ít
 = 
pNode
->pParent;

140533 if–
pP¨ít
 ){

140534  
	`nodeRowidIndex
(
pRåì
, 
pP¨ít
, 
pNode
->
iNode
, 
piIndex
);

140536 *
piIndex
 = -1;

140537  
SQLITE_OK
;

140543 
	`πªeNext
(
sqlôe3_vèb_curs‹
 *
pVèbCurs‹
){

140544 
Råì
 *
pRåì
 = (Råì *)(
pVèbCurs‹
->
pVèb
);

140545 
RåìCurs‹
 *
pC§
 = (RåìCurs‹ *)
pVèbCurs‹
;

140546 
rc
 = 
SQLITE_OK
;

140552 
	`as£π
–
pC§
->
pNode
 );

140554 if–
pC§
->
iSå©egy
==1 ){

140556 
	`nodeRñó£
(
pRåì
, 
pC§
->
pNode
);

140557 
pC§
->
pNode
 = 0;

140560 
iHeight
 = 0;

140561  
pC§
->
pNode
 ){

140562 
RåìNode
 *
pNode
 = 
pC§
->pNode;

140563 
nCñl
 = 
	`NCELL
(
pNode
);

140564 
pC§
->
iCñl
++;ÖC§->iCñl<
nCñl
;ÖCsr->iCell++){

140565 
isEof
;

140566 
rc
 = 
	`des˚ndToCñl
(
pRåì
, 
pC§
, 
iHeight
, &
isEof
);

140567 if–
rc
!=
SQLITE_OK
 || !
isEof
 ){

140568  
rc
;

140571 
pC§
->
pNode
 =ÖNode->
pP¨ít
;

140572 
rc
 = 
	`nodeP¨ítIndex
(
pRåì
, 
pNode
, &
pC§
->
iCñl
);

140573 if–
rc
!=
SQLITE_OK
 ){

140574  
rc
;

140576 
	`nodeRe„ªn˚
(
pC§
->
pNode
);

140577 
	`nodeRñó£
(
pRåì
, 
pNode
);

140578 
iHeight
++;

140582  
rc
;

140588 
	`πªeRowid
(
sqlôe3_vèb_curs‹
 *
pVèbCurs‹
, 
sqlôe_öt64
 *
pRowid
){

140589 
Råì
 *
pRåì
 = (Råì *)
pVèbCurs‹
->
pVèb
;

140590 
RåìCurs‹
 *
pC§
 = (RåìCurs‹ *)
pVèbCurs‹
;

140592 
	`as£π
(
pC§
->
pNode
);

140593 *
pRowid
 = 
	`nodeGëRowid
(
pRåì
, 
pC§
->
pNode
,ÖC§->
iCñl
);

140595  
SQLITE_OK
;

140601 
	`πªeCﬁumn
(
sqlôe3_vèb_curs‹
 *
cur
, 
sqlôe3_c⁄ãxt
 *
˘x
, 
i
){

140602 
Råì
 *
pRåì
 = (Råì *)
cur
->
pVèb
;

140603 
RåìCurs‹
 *
pC§
 = (RåìCurs‹ *)
cur
;

140605 if–
i
==0 ){

140606 
i64
 
iRowid
 = 
	`nodeGëRowid
(
pRåì
, 
pC§
->
pNode
,ÖC§->
iCñl
);

140607 
	`sqlôe3_ªsu…_öt64
(
˘x
, 
iRowid
);

140609 
RåìCo‹d
 
c
;

140610 
	`nodeGëCo‹d
(
pRåì
, 
pC§
->
pNode
,ÖC§->
iCñl
, 
i
-1, &
c
);

140611 #i‚de‡
SQLITE_RTREE_INT_ONLY


140612 if–
pRåì
->
eCo‹dTy≥
==
RTREE_COORD_REAL32
 ){

140613 
	`sqlôe3_ªsu…_doubÀ
(
˘x
, 
c
.
f
);

140617 
	`as£π
–
pRåì
->
eCo‹dTy≥
==
RTREE_COORD_INT32
 );

140618 
	`sqlôe3_ªsu…_öt
(
˘x
, 
c
.
i
);

140622  
SQLITE_OK
;

140632 
	`födLófNode
(
Råì
 *
pRåì
, 
i64
 
iRowid
, 
RåìNode
 **
µLóf
){

140633 
rc
;

140634 *
µLóf
 = 0;

140635 
	`sqlôe3_böd_öt64
(
pRåì
->
pRódRowid
, 1, 
iRowid
);

140636 if–
	`sqlôe3_°ï
(
pRåì
->
pRódRowid
)==
SQLITE_ROW
 ){

140637 
i64
 
iNode
 = 
	`sqlôe3_cﬁumn_öt64
(
pRåì
->
pRódRowid
, 0);

140638 
rc
 = 
	`nodeAcquúe
(
pRåì
, 
iNode
, 0, 
µLóf
);

140639 
	`sqlôe3_ª£t
(
pRåì
->
pRódRowid
);

140641 
rc
 = 
	`sqlôe3_ª£t
(
pRåì
->
pRódRowid
);

140643  
rc
;

140652 
	`de£rülizeGeomëry
(
sqlôe3_vÆue
 *
pVÆue
, 
RåìC⁄°øöt
 *
pC⁄s
){

140653 
RåìM©chArg
 *
p
;

140654 
sqlôe3_πªe_geomëry
 *
pGeom
;

140655 
nBlob
;

140658 if–
	`sqlôe3_vÆue_ty≥
(
pVÆue
)!=
SQLITE_BLOB
 )  
SQLITE_ERROR
;

140661 
nBlob
 = 
	`sqlôe3_vÆue_byãs
(
pVÆue
);

140662 if–
nBlob
<()(
RåìM©chArg
)

140663 || ((
nBlob
-(
RåìM©chArg
))%(
RåìDVÆue
))!=0

140665  
SQLITE_ERROR
;

140668 
pGeom
 = (
sqlôe3_πªe_geomëry
 *)
	`sqlôe3_mÆloc
(

140669 (
sqlôe3_πªe_geomëry
Ë+ 
nBlob


140671 if–!
pGeom
 )  
SQLITE_NOMEM
;

140672 
	`mem£t
(
pGeom
, 0, (
sqlôe3_πªe_geomëry
));

140673 
p
 = (
RåìM©chArg
 *)&
pGeom
[1];

140675 
	`mem˝y
(
p
, 
	`sqlôe3_vÆue_blob
(
pVÆue
), 
nBlob
);

140676 if–
p
->
magic
!=
RTREE_GEOMETRY_MAGIC


140677 || 
nBlob
!=()((
RåìM©chArg
Ë+ (
p
->
nP¨am
-1)*(
RåìDVÆue
))

140679 
	`sqlôe3_‰ì
(
pGeom
);

140680  
SQLITE_ERROR
;

140683 
pGeom
->
pC⁄ãxt
 = 
p
->pContext;

140684 
pGeom
->
nP¨am
 = 
p
->nParam;

140685 
pGeom
->
aP¨am
 = 
p
->aParam;

140687 
pC⁄s
->
xGeom
 = 
p
->xGeom;

140688 
pC⁄s
->
pGeom
 =ÖGeom;

140689  
SQLITE_OK
;

140695 
	`πªeFûãr
(

140696 
sqlôe3_vèb_curs‹
 *
pVèbCurs‹
,

140697 
idxNum
, c⁄° *
idxSå
,

140698 
¨gc
, 
sqlôe3_vÆue
 **
¨gv


140700 
Råì
 *
pRåì
 = (Råì *)
pVèbCurs‹
->
pVèb
;

140701 
RåìCurs‹
 *
pC§
 = (RåìCurs‹ *)
pVèbCurs‹
;

140703 
RåìNode
 *
pRoŸ
 = 0;

140704 
ii
;

140705 
rc
 = 
SQLITE_OK
;

140707 
	`πªeRe„ªn˚
(
pRåì
);

140709 
	`‰ìCurs‹C⁄°øöts
(
pC§
);

140710 
pC§
->
iSå©egy
 = 
idxNum
;

140712 if–
idxNum
==1 ){

140714 
RåìNode
 *
pLóf
;

140715 
i64
 
iRowid
 = 
	`sqlôe3_vÆue_öt64
(
¨gv
[0]);

140716 
rc
 = 
	`födLófNode
(
pRåì
, 
iRowid
, &
pLóf
);

140717 
pC§
->
pNode
 = 
pLóf
;

140718 if–
pLóf
 ){

140719 
	`as£π
–
rc
==
SQLITE_OK
 );

140720 
rc
 = 
	`nodeRowidIndex
(
pRåì
, 
pLóf
, 
iRowid
, &
pC§
->
iCñl
);

140726 if–
¨gc
>0 ){

140727 
pC§
->
aC⁄°øöt
 = 
	`sqlôe3_mÆloc
((
RåìC⁄°øöt
)*
¨gc
);

140728 
pC§
->
nC⁄°øöt
 = 
¨gc
;

140729 if–!
pC§
->
aC⁄°øöt
 ){

140730 
rc
 = 
SQLITE_NOMEM
;

140732 
	`mem£t
(
pC§
->
aC⁄°øöt
, 0, (
RåìC⁄°øöt
)*
¨gc
);

140733 
	`as£π
–(
idxSå
==0 && 
¨gc
==0)

140734 || (
idxSå
 && ()
	`°æí
(idxSå)==
¨gc
*2) );

140735 
ii
=0; ii<
¨gc
; ii++){

140736 
RåìC⁄°øöt
 *
p
 = &
pC§
->
aC⁄°øöt
[
ii
];

140737 
p
->
›
 = 
idxSå
[
ii
*2];

140738 
p
->
iCo‹d
 = 
idxSå
[
ii
*2+1]-'a';

140739 if–
p
->
›
==
RTREE_MATCH
 ){

140744 
rc
 = 
	`de£rülizeGeomëry
(
¨gv
[
ii
], 
p
);

140745 if–
rc
!=
SQLITE_OK
 ){

140749 #ifde‡
SQLITE_RTREE_INT_ONLY


140750 
p
->
rVÆue
 = 
	`sqlôe3_vÆue_öt64
(
¨gv
[
ii
]);

140752 
p
->
rVÆue
 = 
	`sqlôe3_vÆue_doubÀ
(
¨gv
[
ii
]);

140759 if–
rc
==
SQLITE_OK
 ){

140760 
pC§
->
pNode
 = 0;

140761 
rc
 = 
	`nodeAcquúe
(
pRåì
, 1, 0, &
pRoŸ
);

140763 if–
rc
==
SQLITE_OK
 ){

140764 
isEof
 = 1;

140765 
nCñl
 = 
	`NCELL
(
pRoŸ
);

140766 
pC§
->
pNode
 = 
pRoŸ
;

140767 
pC§
->
iCñl
=0; 
rc
==
SQLITE_OK
 &&ÖC§->iCñl<
nCñl
;ÖCsr->iCell++){

140768 
	`as£π
–
pC§
->
pNode
==
pRoŸ
 );

140769 
rc
 = 
	`des˚ndToCñl
(
pRåì
, 
pC§
,ÖRåì->
iDïth
, &
isEof
);

140770 if–!
isEof
 ){

140774 if–
rc
==
SQLITE_OK
 && 
isEof
 ){

140775 
	`as£π
–
pC§
->
pNode
==
pRoŸ
 );

140776 
	`nodeRñó£
(
pRåì
, 
pRoŸ
);

140777 
pC§
->
pNode
 = 0;

140779 
	`as£π
–
rc
!=
SQLITE_OK
 || !
pC§
->
pNode
 ||ÖC§->
iCñl
<
	`NCELL
(pCsr->pNode) );

140783 
	`πªeRñó£
(
pRåì
);

140784  
rc
;

140821 
	`πªeBe°Index
(
sqlôe3_vèb
 *
èb
, 
sqlôe3_ödex_öfo
 *
pIdxInfo
){

140822 
rc
 = 
SQLITE_OK
;

140823 
ii
;

140825 
iIdx
 = 0;

140826 
zIdxSå
[
RTREE_MAX_DIMENSIONS
*8+1];

140827 
	`mem£t
(
zIdxSå
, 0, (zIdxStr));

140828 
	`UNUSED_PARAMETER
(
èb
);

140830 
	`as£π
–
pIdxInfo
->
idxSå
==0 );

140831 
ii
=0; ii<
pIdxInfo
->
nC⁄°øöt
 && 
iIdx
<()((
zIdxSå
)-1); ii++){

140832 
sqlôe3_ödex_c⁄°øöt
 *
p
 = &
pIdxInfo
->
aC⁄°øöt
[
ii
];

140834 if–
p
->
ußbÀ
 &&Ö->
iCﬁumn
==0 &&Ö->
›
==
SQLITE_INDEX_CONSTRAINT_EQ
 ){

140836 
jj
;

140837 
jj
=0; jj<
ii
; jj++){

140838 
pIdxInfo
->
aC⁄°øötUßge
[
jj
].
¨gvIndex
 = 0;

140839 
pIdxInfo
->
aC⁄°øötUßge
[
jj
].
omô
 = 0;

140841 
pIdxInfo
->
idxNum
 = 1;

140842 
pIdxInfo
->
aC⁄°øötUßge
[
ii
].
¨gvIndex
 = 1;

140843 
pIdxInfo
->
aC⁄°øötUßge
[
jj
].
omô
 = 1;

140850 
pIdxInfo
->
e°im©edCo°
 = 10.0;

140851  
SQLITE_OK
;

140854 if–
p
->
ußbÀ
 && (p->
iCﬁumn
>0 ||Ö->
›
==
SQLITE_INDEX_CONSTRAINT_MATCH
) ){

140855 
u8
 
›
;

140856  
p
->
›
 ){

140857 
SQLITE_INDEX_CONSTRAINT_EQ
: 
›
 = 
RTREE_EQ
; ;

140858 
SQLITE_INDEX_CONSTRAINT_GT
: 
›
 = 
RTREE_GT
; ;

140859 
SQLITE_INDEX_CONSTRAINT_LE
: 
›
 = 
RTREE_LE
; ;

140860 
SQLITE_INDEX_CONSTRAINT_LT
: 
›
 = 
RTREE_LT
; ;

140861 
SQLITE_INDEX_CONSTRAINT_GE
: 
›
 = 
RTREE_GE
; ;

140863 
	`as£π
–
p
->
›
==
SQLITE_INDEX_CONSTRAINT_MATCH
 );

140864 
›
 = 
RTREE_MATCH
;

140867 
zIdxSå
[
iIdx
++] = 
›
;

140868 
zIdxSå
[
iIdx
++] = 
p
->
iCﬁumn
 - 1 + 'a';

140869 
pIdxInfo
->
aC⁄°øötUßge
[
ii
].
¨gvIndex
 = (
iIdx
/2);

140870 
pIdxInfo
->
aC⁄°øötUßge
[
ii
].
omô
 = 1;

140874 
pIdxInfo
->
idxNum
 = 2;

140875 
pIdxInfo
->
√edToFªeIdxSå
 = 1;

140876 if–
iIdx
>0 && 0==(
pIdxInfo
->
idxSå
 = 
	`sqlôe3_m¥ötf
("%s", 
zIdxSå
)) ){

140877  
SQLITE_NOMEM
;

140879 
	`as£π
–
iIdx
>=0 );

140880 
pIdxInfo
->
e°im©edCo°
 = (2000000.0 / ()(
iIdx
 + 1));

140881  
rc
;

140887 
RåìDVÆue
 
	`˚ŒAªa
(
Råì
 *
pRåì
, 
RåìCñl
 *
p
){

140888 
RåìDVÆue
 
¨ó
 = (RtreeDValue)1;

140889 
ii
;

140890 
ii
=0; ii<(
pRåì
->
nDim
*2); ii+=2){

140891 
¨ó
 = (¨ó * (
	`DCOORD
(
p
->
aCo‹d
[
ii
+1]) - DCOORD(p->aCoord[ii])));

140893  
¨ó
;

140900 
RåìDVÆue
 
	`˚ŒM¨gö
(
Råì
 *
pRåì
, 
RåìCñl
 *
p
){

140901 
RåìDVÆue
 
m¨gö
 = (RtreeDValue)0;

140902 
ii
;

140903 
ii
=0; ii<(
pRåì
->
nDim
*2); ii+=2){

140904 
m¨gö
 +(
	`DCOORD
(
p
->
aCo‹d
[
ii
+1]) - DCOORD(p->aCoord[ii]));

140906  
m¨gö
;

140912 
	`˚ŒUni⁄
(
Råì
 *
pRåì
, 
RåìCñl
 *
p1
, RåìCñ»*
p2
){

140913 
ii
;

140914 if–
pRåì
->
eCo‹dTy≥
==
RTREE_COORD_REAL32
 ){

140915 
ii
=0; ii<(
pRåì
->
nDim
*2); ii+=2){

140916 
p1
->
aCo‹d
[
ii
].
f
 = 
	`MIN
’1->aCo‹d[ii].f, 
p2
->aCoord[ii].f);

140917 
p1
->
aCo‹d
[
ii
+1].
f
 = 
	`MAX
’1->aCo‹d[ii+1].f, 
p2
->aCoord[ii+1].f);

140920 
ii
=0; ii<(
pRåì
->
nDim
*2); ii+=2){

140921 
p1
->
aCo‹d
[
ii
].
i
 = 
	`MIN
’1->aCo‹d[ii].i, 
p2
->aCoord[ii].i);

140922 
p1
->
aCo‹d
[
ii
+1].
i
 = 
	`MAX
’1->aCo‹d[ii+1].i, 
p2
->aCoord[ii+1].i);

140931 
	`˚ŒC⁄èös
(
Råì
 *
pRåì
, 
RåìCñl
 *
p1
, RåìCñ»*
p2
){

140932 
ii
;

140933 
isI¡
 = (
pRåì
->
eCo‹dTy≥
==
RTREE_COORD_INT32
);

140934 
ii
=0; ii<(
pRåì
->
nDim
*2); ii+=2){

140935 
RåìCo‹d
 *
a1
 = &
p1
->
aCo‹d
[
ii
];

140936 
RåìCo‹d
 *
a2
 = &
p2
->
aCo‹d
[
ii
];

140937 if–(!
isI¡
 && (
a2
[0].
f
<
a1
[0].f ||á2[1].f>a1[1].f))

140938 || ( 
isI¡
 && (
a2
[0].
i
<
a1
[0].i ||á2[1].i>a1[1].i))

140949 
RåìDVÆue
 
	`˚ŒGrowth
(
Råì
 *
pRåì
, 
RåìCñl
 *
p
, RåìCñ»*
pCñl
){

140950 
RåìDVÆue
 
¨ó
;

140951 
RåìCñl
 
˚Œ
;

140952 
	`mem˝y
(&
˚Œ
, 
p
, (
RåìCñl
));

140953 
¨ó
 = 
	`˚ŒAªa
(
pRåì
, &
˚Œ
);

140954 
	`˚ŒUni⁄
(
pRåì
, &
˚Œ
, 
pCñl
);

140955  (
	`˚ŒAªa
(
pRåì
, &
˚Œ
)-
¨ó
);

140958 #i‡
VARIANT_RSTARTREE_CHOOSESUBTREE
 || 
VARIANT_RSTARTREE_SPLIT


140959 
RåìDVÆue
 
	`˚ŒOvîœp
(

140960 
Råì
 *
pRåì
,

140961 
RåìCñl
 *
p
,

140962 
RåìCñl
 *
aCñl
,

140963 
nCñl
,

140964 
iEx˛ude


140966 
ii
;

140967 
RåìDVÆue
 
ovîœp
 = 0.0;

140968 
ii
=0; ii<
nCñl
; ii++){

140969 #i‡
VARIANT_RSTARTREE_CHOOSESUBTREE


140970 if–
ii
!=
iEx˛ude
 )

140972 
	`as£π
–
iEx˛ude
==-1 );

140973 
	`UNUSED_PARAMETER
(
iEx˛ude
);

140976 
jj
;

140977 
RåìDVÆue
 
o
 = (RtreeDValue)1;

140978 
jj
=0; jj<(
pRåì
->
nDim
*2); jj+=2){

140979 
RåìDVÆue
 
x1
, 
x2
;

140981 
x1
 = 
	`MAX
(
	`DCOORD
(
p
->
aCo‹d
[
jj
]), DCOORD(
aCñl
[
ii
].aCoord[jj]));

140982 
x2
 = 
	`MIN
(
	`DCOORD
(
p
->
aCo‹d
[
jj
+1]), DCOORD(
aCñl
[
ii
].aCoord[jj+1]));

140984 if–
x2
<
x1
 ){

140985 
o
 = 0.0;

140988 
o
 = o * (
x2
-
x1
);

140991 
ovîœp
 +
o
;

140994  
ovîœp
;

140998 #i‡
VARIANT_RSTARTREE_CHOOSESUBTREE


140999 
RåìDVÆue
 
	`˚ŒOvîœpE∆¨gemít
(

141000 
Råì
 *
pRåì
,

141001 
RåìCñl
 *
p
,

141002 
RåìCñl
 *
pIn£π
,

141003 
RåìCñl
 *
aCñl
,

141004 
nCñl
,

141005 
iEx˛ude


141007 
RåìDVÆue
 
bef‹e
, 
a·î
;

141008 
bef‹e
 = 
	`˚ŒOvîœp
(
pRåì
, 
p
, 
aCñl
, 
nCñl
, 
iEx˛ude
);

141009 
	`˚ŒUni⁄
(
pRåì
, 
p
, 
pIn£π
);

141010 
a·î
 = 
	`˚ŒOvîœp
(
pRåì
, 
p
, 
aCñl
, 
nCñl
, 
iEx˛ude
);

141011  (
a·î
-
bef‹e
);

141020 
	`Choo£Lóf
(

141021 
Råì
 *
pRåì
,

141022 
RåìCñl
 *
pCñl
,

141023 
iHeight
,

141024 
RåìNode
 **
µLóf


141026 
rc
;

141027 
ii
;

141028 
RåìNode
 *
pNode
;

141029 
rc
 = 
	`nodeAcquúe
(
pRåì
, 1, 0, &
pNode
);

141031 
ii
=0; 
rc
==
SQLITE_OK
 && ii<(
pRåì
->
iDïth
-
iHeight
); ii++){

141032 
iCñl
;

141033 
sqlôe3_öt64
 
iBe°
 = 0;

141035 
RåìDVÆue
 
fMöGrowth
 = 0.0;

141036 
RåìDVÆue
 
fMöAªa
 = 0.0;

141037 #i‡
VARIANT_RSTARTREE_CHOOSESUBTREE


141038 
RåìDVÆue
 
fMöOvîœp
 = 0.0;

141039 
RåìDVÆue
 
ovîœp
;

141042 
nCñl
 = 
	`NCELL
(
pNode
);

141043 
RåìCñl
 
˚Œ
;

141044 
RåìNode
 *
pChûd
;

141046 
RåìCñl
 *
aCñl
 = 0;

141048 #i‡
VARIANT_RSTARTREE_CHOOSESUBTREE


141049 if–
ii
==(
pRåì
->
iDïth
-1) ){

141050 
jj
;

141051 
aCñl
 = 
	`sqlôe3_mÆloc
((
RåìCñl
)*
nCñl
);

141052 if–!
aCñl
 ){

141053 
rc
 = 
SQLITE_NOMEM
;

141054 
	`nodeRñó£
(
pRåì
, 
pNode
);

141055 
pNode
 = 0;

141058 
jj
=0; jj<
nCñl
; jj++){

141059 
	`nodeGëCñl
(
pRåì
, 
pNode
, 
jj
, &
aCñl
[jj]);

141068 
iCñl
=0; iCñl<
nCñl
; iCell++){

141069 
bBe°
 = 0;

141070 
RåìDVÆue
 
growth
;

141071 
RåìDVÆue
 
¨ó
;

141072 
	`nodeGëCñl
(
pRåì
, 
pNode
, 
iCñl
, &
˚Œ
);

141073 
growth
 = 
	`˚ŒGrowth
(
pRåì
, &
˚Œ
, 
pCñl
);

141074 
¨ó
 = 
	`˚ŒAªa
(
pRåì
, &
˚Œ
);

141076 #i‡
VARIANT_RSTARTREE_CHOOSESUBTREE


141077 if–
ii
==(
pRåì
->
iDïth
-1) ){

141078 
ovîœp
 = 
	`˚ŒOvîœpE∆¨gemít
(
pRåì
,&
˚Œ
,
pCñl
,
aCñl
,
nCñl
,
iCñl
);

141080 
ovîœp
 = 0.0;

141082 if–(
iCñl
==0)

141083 || (
ovîœp
<
fMöOvîœp
)

141084 || (
ovîœp
==
fMöOvîœp
 && 
growth
<
fMöGrowth
)

141085 || (
ovîœp
==
fMöOvîœp
 && 
growth
==
fMöGrowth
 && 
¨ó
<
fMöAªa
)

141087 
bBe°
 = 1;

141088 
fMöOvîœp
 = 
ovîœp
;

141091 if–
iCñl
==0||
growth
<
fMöGrowth
||(growth==fMöGrowth && 
¨ó
<
fMöAªa
) ){

141092 
bBe°
 = 1;

141095 if–
bBe°
 ){

141096 
fMöGrowth
 = 
growth
;

141097 
fMöAªa
 = 
¨ó
;

141098 
iBe°
 = 
˚Œ
.
iRowid
;

141102 
	`sqlôe3_‰ì
(
aCñl
);

141103 
rc
 = 
	`nodeAcquúe
(
pRåì
, 
iBe°
, 
pNode
, &
pChûd
);

141104 
	`nodeRñó£
(
pRåì
, 
pNode
);

141105 
pNode
 = 
pChûd
;

141108 *
µLóf
 = 
pNode
;

141109  
rc
;

141117 
	`Adju°Tªe
(

141118 
Råì
 *
pRåì
,

141119 
RåìNode
 *
pNode
,

141120 
RåìCñl
 *
pCñl


141122 
RåìNode
 *
p
 = 
pNode
;

141123  
p
->
pP¨ít
 ){

141124 
RåìNode
 *
pP¨ít
 = 
p
->pParent;

141125 
RåìCñl
 
˚Œ
;

141126 
iCñl
;

141128 if–
	`nodeP¨ítIndex
(
pRåì
, 
p
, &
iCñl
) ){

141129  
SQLITE_CORRUPT_VTAB
;

141132 
	`nodeGëCñl
(
pRåì
, 
pP¨ít
, 
iCñl
, &
˚Œ
);

141133 if–!
	`˚ŒC⁄èös
(
pRåì
, &
˚Œ
, 
pCñl
) ){

141134 
	`˚ŒUni⁄
(
pRåì
, &
˚Œ
, 
pCñl
);

141135 
	`nodeOvîwrôeCñl
(
pRåì
, 
pP¨ít
, &
˚Œ
, 
iCñl
);

141138 
p
 = 
pP¨ít
;

141140  
SQLITE_OK
;

141146 
	`rowidWrôe
(
Råì
 *
pRåì
, 
sqlôe3_öt64
 
iRowid
, sqlôe3_öt64 
iNode
){

141147 
	`sqlôe3_böd_öt64
(
pRåì
->
pWrôeRowid
, 1, 
iRowid
);

141148 
	`sqlôe3_böd_öt64
(
pRåì
->
pWrôeRowid
, 2, 
iNode
);

141149 
	`sqlôe3_°ï
(
pRåì
->
pWrôeRowid
);

141150  
	`sqlôe3_ª£t
(
pRåì
->
pWrôeRowid
);

141156 
	`∑ª¡Wrôe
(
Råì
 *
pRåì
, 
sqlôe3_öt64
 
iNode
, sqlôe3_öt64 
iP¨
){

141157 
	`sqlôe3_böd_öt64
(
pRåì
->
pWrôeP¨ít
, 1, 
iNode
);

141158 
	`sqlôe3_böd_öt64
(
pRåì
->
pWrôeP¨ít
, 2, 
iP¨
);

141159 
	`sqlôe3_°ï
(
pRåì
->
pWrôeP¨ít
);

141160  
	`sqlôe3_ª£t
(
pRåì
->
pWrôeP¨ít
);

141163 
	`πªeIn£πCñl
(
Råì
 *, 
RåìNode
 *, 
RåìCñl
 *, );

141165 #i‡
VARIANT_GUTTMAN_LINEAR_SPLIT


141170 
RåìCñl
 *
	`LöórPickNext
(

141171 
Råì
 *
pRåì
,

141172 
RåìCñl
 *
aCñl
,

141173 
nCñl
,

141174 
RåìCñl
 *
pLe·Box
,

141175 
RåìCñl
 *
pRightBox
,

141176 *
aiU£d


141178 
ii
;

141179 
ii
=0; 
aiU£d
[ii]; ii++);

141180 
aiU£d
[
ii
] = 1;

141181  &
aCñl
[
ii
];

141188 
	`LöórPickSìds
(

141189 
Råì
 *
pRåì
,

141190 
RåìCñl
 *
aCñl
,

141191 
nCñl
,

141192 *
piLe·Sìd
,

141193 *
piRightSìd


141195 
i
;

141196 
iLe·Sìd
 = 0;

141197 
iRightSìd
 = 1;

141198 
RåìDVÆue
 
maxN‹mÆI¬îWidth
 = (RtreeDValue)0;

141205 
i
=0; i<
pRåì
->
nDim
; i++){

141206 
RåìDVÆue
 
x1
 = 
	`DCOORD
(
aCñl
[0].
aCo‹d
[
i
*2]);

141207 
RåìDVÆue
 
x2
 = 
	`DCOORD
(
aCñl
[0].
aCo‹d
[
i
*2+1]);

141208 
RåìDVÆue
 
x3
 = 
x1
;

141209 
RåìDVÆue
 
x4
 = 
x2
;

141210 
jj
;

141212 
iCñlLe·
 = 0;

141213 
iCñlRight
 = 0;

141215 
jj
=1; jj<
nCñl
; jj++){

141216 
RåìDVÆue
 
À·
 = 
	`DCOORD
(
aCñl
[
jj
].
aCo‹d
[
i
*2]);

141217 
RåìDVÆue
 
right
 = 
	`DCOORD
(
aCñl
[
jj
].
aCo‹d
[
i
*2+1]);

141219 if–
À·
<
x1
 ) x1 =Üeft;

141220 if–
right
>
x4
 ) x4 =Ñight;

141221 if–
À·
>
x3
 ){

141222 
x3
 = 
À·
;

141223 
iCñlRight
 = 
jj
;

141225 if–
right
<
x2
 ){

141226 
x2
 = 
right
;

141227 
iCñlLe·
 = 
jj
;

141231 if–
x4
!=
x1
 ){

141232 
RåìDVÆue
 
n‹mÆwidth
 = (
x3
 - 
x2
Ë/ (
x4
 - 
x1
);

141233 if–
n‹mÆwidth
>
maxN‹mÆI¬îWidth
 ){

141234 
iLe·Sìd
 = 
iCñlLe·
;

141235 
iRightSìd
 = 
iCñlRight
;

141240 *
piLe·Sìd
 = 
iLe·Sìd
;

141241 *
piRightSìd
 = 
iRightSìd
;

141245 #i‡
VARIANT_GUTTMAN_QUADRATIC_SPLIT


141250 
RåìCñl
 *
	`QuadøticPickNext
(

141251 
Råì
 *
pRåì
,

141252 
RåìCñl
 *
aCñl
,

141253 
nCñl
,

141254 
RåìCñl
 *
pLe·Box
,

141255 
RåìCñl
 *
pRightBox
,

141256 *
aiU£d


141258 
	#FABS
(
a
Ë(◊)<0.0?-1.0*◊):◊))

	)

141260 
iSñe˘
 = -1;

141261 
RåìDVÆue
 
fDiff
;

141262 
ii
;

141263 
ii
=0; ii<
nCñl
; ii++){

141264 if–
aiU£d
[
ii
]==0 ){

141265 
RåìDVÆue
 
À·
 = 
	`˚ŒGrowth
(
pRåì
, 
pLe·Box
, &
aCñl
[
ii
]);

141266 
RåìDVÆue
 
right
 = 
	`˚ŒGrowth
(
pRåì
, 
pLe·Box
, &
aCñl
[
ii
]);

141267 
RåìDVÆue
 
diff
 = 
	`FABS
(
right
-
À·
);

141268 if–
iSñe˘
<0 || 
diff
>
fDiff
 ){

141269 
fDiff
 = 
diff
;

141270 
iSñe˘
 = 
ii
;

141274 
aiU£d
[
iSñe˘
] = 1;

141275  &
aCñl
[
iSñe˘
];

141282 
	`QuadøticPickSìds
(

141283 
Råì
 *
pRåì
,

141284 
RåìCñl
 *
aCñl
,

141285 
nCñl
,

141286 *
piLe·Sìd
,

141287 *
piRightSìd


141289 
ii
;

141290 
jj
;

141292 
iLe·Sìd
 = 0;

141293 
iRightSìd
 = 1;

141294 
RåìDVÆue
 
fWa°e
 = 0.0;

141296 
ii
=0; ii<
nCñl
; ii++){

141297 
jj
=
ii
+1; jj<
nCñl
; jj++){

141298 
RåìDVÆue
 
right
 = 
	`˚ŒAªa
(
pRåì
, &
aCñl
[
jj
]);

141299 
RåìDVÆue
 
growth
 = 
	`˚ŒGrowth
(
pRåì
, &
aCñl
[
ii
], &aCñl[
jj
]);

141300 
RåìDVÆue
 
wa°e
 = 
growth
 - 
right
;

141302 if–
wa°e
>
fWa°e
 ){

141303 
iLe·Sìd
 = 
ii
;

141304 
iRightSìd
 = 
jj
;

141305 
fWa°e
 = 
wa°e
;

141310 *
piLe·Sìd
 = 
iLe·Sìd
;

141311 *
piRightSìd
 = 
iRightSìd
;

141332 
	`S‹tByDi°™˚
(

141333 *
aIdx
,

141334 
nIdx
,

141335 
RåìDVÆue
 *
aDi°™˚
,

141336 *
aS∑ª


141338 if–
nIdx
>1 ){

141339 
iLe·
 = 0;

141340 
iRight
 = 0;

141342 
nLe·
 = 
nIdx
/2;

141343 
nRight
 = 
nIdx
-
nLe·
;

141344 *
aLe·
 = 
aIdx
;

141345 *
aRight
 = &
aIdx
[
nLe·
];

141347 
	`S‹tByDi°™˚
(
aLe·
, 
nLe·
, 
aDi°™˚
, 
aS∑ª
);

141348 
	`S‹tByDi°™˚
(
aRight
, 
nRight
, 
aDi°™˚
, 
aS∑ª
);

141350 
	`mem˝y
(
aS∑ª
, 
aLe·
, ()*
nLe·
);

141351 
aLe·
 = 
aS∑ª
;

141353  
iLe·
<
nLe·
 || 
iRight
<
nRight
 ){

141354 if–
iLe·
==
nLe·
 ){

141355 
aIdx
[
iLe·
+
iRight
] = 
aRight
[iRight];

141356 
iRight
++;

141357 }if–
iRight
==
nRight
 ){

141358 
aIdx
[
iLe·
+
iRight
] = 
aLe·
[iLeft];

141359 
iLe·
++;

141361 
RåìDVÆue
 
fLe·
 = 
aDi°™˚
[
aLe·
[
iLe·
]];

141362 
RåìDVÆue
 
fRight
 = 
aDi°™˚
[
aRight
[
iRight
]];

141363 if–
fLe·
<
fRight
 ){

141364 
aIdx
[
iLe·
+
iRight
] = 
aLe·
[iLeft];

141365 
iLe·
++;

141367 
aIdx
[
iLe·
+
iRight
] = 
aRight
[iRight];

141368 
iRight
++;

141376 
jj
;

141377 
jj
=1; jj<
nIdx
; jj++){

141378 
RåìDVÆue
 
À·
 = 
aDi°™˚
[
aIdx
[
jj
-1]];

141379 
RåìDVÆue
 
right
 = 
aDi°™˚
[
aIdx
[
jj
]];

141380 
	`as£π
–
À·
<=
right
 );

141398 
	`S‹tByDimísi⁄
(

141399 
Råì
 *
pRåì
,

141400 *
aIdx
,

141401 
nIdx
,

141402 
iDim
,

141403 
RåìCñl
 *
aCñl
,

141404 *
aS∑ª


141406 if–
nIdx
>1 ){

141408 
iLe·
 = 0;

141409 
iRight
 = 0;

141411 
nLe·
 = 
nIdx
/2;

141412 
nRight
 = 
nIdx
-
nLe·
;

141413 *
aLe·
 = 
aIdx
;

141414 *
aRight
 = &
aIdx
[
nLe·
];

141416 
	`S‹tByDimísi⁄
(
pRåì
, 
aLe·
, 
nLe·
, 
iDim
, 
aCñl
, 
aS∑ª
);

141417 
	`S‹tByDimísi⁄
(
pRåì
, 
aRight
, 
nRight
, 
iDim
, 
aCñl
, 
aS∑ª
);

141419 
	`mem˝y
(
aS∑ª
, 
aLe·
, ()*
nLe·
);

141420 
aLe·
 = 
aS∑ª
;

141421  
iLe·
<
nLe·
 || 
iRight
<
nRight
 ){

141422 
RåìDVÆue
 
xÀ·1
 = 
	`DCOORD
(
aCñl
[
aLe·
[
iLe·
]].
aCo‹d
[
iDim
*2]);

141423 
RåìDVÆue
 
xÀ·2
 = 
	`DCOORD
(
aCñl
[
aLe·
[
iLe·
]].
aCo‹d
[
iDim
*2+1]);

141424 
RåìDVÆue
 
xright1
 = 
	`DCOORD
(
aCñl
[
aRight
[
iRight
]].
aCo‹d
[
iDim
*2]);

141425 
RåìDVÆue
 
xright2
 = 
	`DCOORD
(
aCñl
[
aRight
[
iRight
]].
aCo‹d
[
iDim
*2+1]);

141426 if–(
iLe·
!=
nLe·
Ë&& ((
iRight
==
nRight
)

141427 || (
xÀ·1
<
xright1
)

141428 || (
xÀ·1
==
xright1
 && 
xÀ·2
<
xright2
)

141430 
aIdx
[
iLe·
+
iRight
] = 
aLe·
[iLeft];

141431 
iLe·
++;

141433 
aIdx
[
iLe·
+
iRight
] = 
aRight
[iRight];

141434 
iRight
++;

141441 
jj
;

141442 
jj
=1; jj<
nIdx
; jj++){

141443 
RåìDVÆue
 
xÀ·1
 = 
aCñl
[
aIdx
[
jj
-1]].
aCo‹d
[
iDim
*2];

141444 
RåìDVÆue
 
xÀ·2
 = 
aCñl
[
aIdx
[
jj
-1]].
aCo‹d
[
iDim
*2+1];

141445 
RåìDVÆue
 
xright1
 = 
aCñl
[
aIdx
[
jj
]].
aCo‹d
[
iDim
*2];

141446 
RåìDVÆue
 
xright2
 = 
aCñl
[
aIdx
[
jj
]].
aCo‹d
[
iDim
*2+1];

141447 
	`as£π
–
xÀ·1
<=
xright1
 && (xÀ·1<xright1 || 
xÀ·2
<=
xright2
) );

141454 #i‡
VARIANT_RSTARTREE_SPLIT


141458 
	`•lôNodeSèπªe
(

141459 
Råì
 *
pRåì
,

141460 
RåìCñl
 *
aCñl
,

141461 
nCñl
,

141462 
RåìNode
 *
pLe·
,

141463 
RåìNode
 *
pRight
,

141464 
RåìCñl
 *
pBboxLe·
,

141465 
RåìCñl
 *
pBboxRight


141467 **
ØS‹ãd
;

141468 *
aS∑ª
;

141469 
ii
;

141471 
iBe°Dim
 = 0;

141472 
iBe°S∂ô
 = 0;

141473 
RåìDVÆue
 
fBe°M¨gö
 = 0.0;

141475 
nByã
 = (
pRåì
->
nDim
+1)*((*)+
nCñl
*());

141477 
ØS‹ãd
 = (**)
	`sqlôe3_mÆloc
(
nByã
);

141478 if–!
ØS‹ãd
 ){

141479  
SQLITE_NOMEM
;

141482 
aS∑ª
 = &((*)&
ØS‹ãd
[
pRåì
->
nDim
])[pRåì->nDim*
nCñl
];

141483 
	`mem£t
(
ØS‹ãd
, 0, 
nByã
);

141484 
ii
=0; ii<
pRåì
->
nDim
; ii++){

141485 
jj
;

141486 
ØS‹ãd
[
ii
] = &((*)&ØS‹ãd[
pRåì
->
nDim
])[ii*
nCñl
];

141487 
jj
=0; jj<
nCñl
; jj++){

141488 
ØS‹ãd
[
ii
][
jj
] = jj;

141490 
	`S‹tByDimísi⁄
(
pRåì
, 
ØS‹ãd
[
ii
], 
nCñl
, ii, 
aCñl
, 
aS∑ª
);

141493 
ii
=0; ii<
pRåì
->
nDim
; ii++){

141494 
RåìDVÆue
 
m¨gö
 = 0.0;

141495 
RåìDVÆue
 
fBe°Ovîœp
 = 0.0;

141496 
RåìDVÆue
 
fBe°Aªa
 = 0.0;

141497 
iBe°Le·
 = 0;

141498 
nLe·
;

141501 
nLe·
=
	`RTREE_MINCELLS
(
pRåì
);

141502 
nLe·
<=(
nCñl
-
	`RTREE_MINCELLS
(
pRåì
));

141503 
nLe·
++

141505 
RåìCñl
 
À·
;

141506 
RåìCñl
 
right
;

141507 
kk
;

141508 
RåìDVÆue
 
ovîœp
;

141509 
RåìDVÆue
 
¨ó
;

141511 
	`mem˝y
(&
À·
, &
aCñl
[
ØS‹ãd
[
ii
][0]], (
RåìCñl
));

141512 
	`mem˝y
(&
right
, &
aCñl
[
ØS‹ãd
[
ii
][
nCñl
-1]], (
RåìCñl
));

141513 
kk
=1; kk<(
nCñl
-1); kk++){

141514 if–
kk
<
nLe·
 ){

141515 
	`˚ŒUni⁄
(
pRåì
, &
À·
, &
aCñl
[
ØS‹ãd
[
ii
][
kk
]]);

141517 
	`˚ŒUni⁄
(
pRåì
, &
right
, &
aCñl
[
ØS‹ãd
[
ii
][
kk
]]);

141520 
m¨gö
 +
	`˚ŒM¨gö
(
pRåì
, &
À·
);

141521 
m¨gö
 +
	`˚ŒM¨gö
(
pRåì
, &
right
);

141522 
ovîœp
 = 
	`˚ŒOvîœp
(
pRåì
, &
À·
, &
right
, 1, -1);

141523 
¨ó
 = 
	`˚ŒAªa
(
pRåì
, &
À·
Ë+ cñlAªa’Råì, &
right
);

141524 if–(
nLe·
==
	`RTREE_MINCELLS
(
pRåì
))

141525 || (
ovîœp
<
fBe°Ovîœp
)

141526 || (
ovîœp
==
fBe°Ovîœp
 && 
¨ó
<
fBe°Aªa
)

141528 
iBe°Le·
 = 
nLe·
;

141529 
fBe°Ovîœp
 = 
ovîœp
;

141530 
fBe°Aªa
 = 
¨ó
;

141534 if–
ii
==0 || 
m¨gö
<
fBe°M¨gö
 ){

141535 
iBe°Dim
 = 
ii
;

141536 
fBe°M¨gö
 = 
m¨gö
;

141537 
iBe°S∂ô
 = 
iBe°Le·
;

141541 
	`mem˝y
(
pBboxLe·
, &
aCñl
[
ØS‹ãd
[
iBe°Dim
][0]], (
RåìCñl
));

141542 
	`mem˝y
(
pBboxRight
, &
aCñl
[
ØS‹ãd
[
iBe°Dim
][
iBe°S∂ô
]], (
RåìCñl
));

141543 
ii
=0; ii<
nCñl
; ii++){

141544 
RåìNode
 *
pT¨gë
 = (
ii
<
iBe°S∂ô
)?
pLe·
:
pRight
;

141545 
RåìCñl
 *
pBbox
 = (
ii
<
iBe°S∂ô
)?
pBboxLe·
:
pBboxRight
;

141546 
RåìCñl
 *
pCñl
 = &
aCñl
[
ØS‹ãd
[
iBe°Dim
][
ii
]];

141547 
	`nodeIn£πCñl
(
pRåì
, 
pT¨gë
, 
pCñl
);

141548 
	`˚ŒUni⁄
(
pRåì
, 
pBbox
, 
pCñl
);

141551 
	`sqlôe3_‰ì
(
ØS‹ãd
);

141552  
SQLITE_OK
;

141556 #i‡
VARIANT_GUTTMAN_SPLIT


141560 
	`•lôNodeGuâm™
(

141561 
Råì
 *
pRåì
,

141562 
RåìCñl
 *
aCñl
,

141563 
nCñl
,

141564 
RåìNode
 *
pLe·
,

141565 
RåìNode
 *
pRight
,

141566 
RåìCñl
 *
pBboxLe·
,

141567 
RåìCñl
 *
pBboxRight


141569 
iLe·Sìd
 = 0;

141570 
iRightSìd
 = 1;

141571 *
aiU£d
;

141572 
i
;

141574 
aiU£d
 = 
	`sqlôe3_mÆloc
(()*
nCñl
);

141575 if–!
aiU£d
 ){

141576  
SQLITE_NOMEM
;

141578 
	`mem£t
(
aiU£d
, 0, ()*
nCñl
);

141580 
	`PickSìds
(
pRåì
, 
aCñl
, 
nCñl
, &
iLe·Sìd
, &
iRightSìd
);

141582 
	`mem˝y
(
pBboxLe·
, &
aCñl
[
iLe·Sìd
], (
RåìCñl
));

141583 
	`mem˝y
(
pBboxRight
, &
aCñl
[
iRightSìd
], (
RåìCñl
));

141584 
	`nodeIn£πCñl
(
pRåì
, 
pLe·
, &
aCñl
[
iLe·Sìd
]);

141585 
	`nodeIn£πCñl
(
pRåì
, 
pRight
, &
aCñl
[
iRightSìd
]);

141586 
aiU£d
[
iLe·Sìd
] = 1;

141587 
aiU£d
[
iRightSìd
] = 1;

141589 
i
=
nCñl
-2; i>0; i--){

141590 
RåìCñl
 *
pNext
;

141591 
pNext
 = 
	`PickNext
(
pRåì
, 
aCñl
, 
nCñl
, 
pBboxLe·
, 
pBboxRight
, 
aiU£d
);

141592 
RåìDVÆue
 
diff
 =

141593 
	`˚ŒGrowth
(
pRåì
, 
pBboxLe·
, 
pNext
) -

141594 
	`˚ŒGrowth
(
pRåì
, 
pBboxRight
, 
pNext
)

141596 if–(
	`RTREE_MINCELLS
(
pRåì
)-
	`NCELL
(
pRight
)==
i
)

141597 || (
diff
>0.0 && (
	`RTREE_MINCELLS
(
pRåì
)-
	`NCELL
(
pLe·
)!=
i
))

141599 
	`nodeIn£πCñl
(
pRåì
, 
pRight
, 
pNext
);

141600 
	`˚ŒUni⁄
(
pRåì
, 
pBboxRight
, 
pNext
);

141602 
	`nodeIn£πCñl
(
pRåì
, 
pLe·
, 
pNext
);

141603 
	`˚ŒUni⁄
(
pRåì
, 
pBboxLe·
, 
pNext
);

141607 
	`sqlôe3_‰ì
(
aiU£d
);

141608  
SQLITE_OK
;

141612 
	`upd©eM≠pög
(

141613 
Råì
 *
pRåì
,

141614 
i64
 
iRowid
,

141615 
RåìNode
 *
pNode
,

141616 
iHeight


141618 (*
xSëM≠pög
)(
Råì
 *, 
sqlôe3_öt64
, sqlite3_int64);

141619 
xSëM≠pög
 = ((
iHeight
==0)?
rowidWrôe
:
∑ª¡Wrôe
);

141620 if–
iHeight
>0 ){

141621 
RåìNode
 *
pChûd
 = 
	`nodeHashLookup
(
pRåì
, 
iRowid
);

141622 if–
pChûd
 ){

141623 
	`nodeRñó£
(
pRåì
, 
pChûd
->
pP¨ít
);

141624 
	`nodeRe„ªn˚
(
pNode
);

141625 
pChûd
->
pP¨ít
 = 
pNode
;

141628  
	`xSëM≠pög
(
pRåì
, 
iRowid
, 
pNode
->
iNode
);

141631 
	`S∂ôNode
(

141632 
Råì
 *
pRåì
,

141633 
RåìNode
 *
pNode
,

141634 
RåìCñl
 *
pCñl
,

141635 
iHeight


141637 
i
;

141638 
√wCñlIsRight
 = 0;

141640 
rc
 = 
SQLITE_OK
;

141641 
nCñl
 = 
	`NCELL
(
pNode
);

141642 
RåìCñl
 *
aCñl
;

141643 *
aiU£d
;

141645 
RåìNode
 *
pLe·
 = 0;

141646 
RåìNode
 *
pRight
 = 0;

141648 
RåìCñl
 
À·bbox
;

141649 
RåìCñl
 
rightbbox
;

141654 
aCñl
 = 
	`sqlôe3_mÆloc
(((
RåìCñl
)+())*(
nCñl
+1));

141655 if–!
aCñl
 ){

141656 
rc
 = 
SQLITE_NOMEM
;

141657 
•lônode_out
;

141659 
aiU£d
 = (*)&
aCñl
[
nCñl
+1];

141660 
	`mem£t
(
aiU£d
, 0, ()*(
nCñl
+1));

141661 
i
=0; i<
nCñl
; i++){

141662 
	`nodeGëCñl
(
pRåì
, 
pNode
, 
i
, &
aCñl
[i]);

141664 
	`nodeZîo
(
pRåì
, 
pNode
);

141665 
	`mem˝y
(&
aCñl
[
nCñl
], 
pCñl
, (
RåìCñl
));

141666 
nCñl
++;

141668 if–
pNode
->
iNode
==1 ){

141669 
pRight
 = 
	`nodeNew
(
pRåì
, 
pNode
);

141670 
pLe·
 = 
	`nodeNew
(
pRåì
, 
pNode
);

141671 
pRåì
->
iDïth
++;

141672 
pNode
->
isDúty
 = 1;

141673 
	`wrôeI¡16
(
pNode
->
zD©a
, 
pRåì
->
iDïth
);

141675 
pLe·
 = 
pNode
;

141676 
pRight
 = 
	`nodeNew
(
pRåì
, 
pLe·
->
pP¨ít
);

141677 
	`nodeRe„ªn˚
(
pLe·
);

141680 if–!
pLe·
 || !
pRight
 ){

141681 
rc
 = 
SQLITE_NOMEM
;

141682 
•lônode_out
;

141685 
	`mem£t
(
pLe·
->
zD©a
, 0, 
pRåì
->
iNodeSize
);

141686 
	`mem£t
(
pRight
->
zD©a
, 0, 
pRåì
->
iNodeSize
);

141688 
rc
 = 
	`AssignCñls
(
pRåì
, 
aCñl
, 
nCñl
, 
pLe·
, 
pRight
, &
À·bbox
, &
rightbbox
);

141689 if–
rc
!=
SQLITE_OK
 ){

141690 
•lônode_out
;

141698 if–
SQLITE_OK
!=(
rc
 = 
	`nodeWrôe
(
pRåì
, 
pRight
))

141699 || (0==
pLe·
->
iNode
 && 
SQLITE_OK
!=(
rc
 = 
	`nodeWrôe
(
pRåì
,ÖLeft)))

141701 
•lônode_out
;

141704 
rightbbox
.
iRowid
 = 
pRight
->
iNode
;

141705 
À·bbox
.
iRowid
 = 
pLe·
->
iNode
;

141707 if–
pNode
->
iNode
==1 ){

141708 
rc
 = 
	`πªeIn£πCñl
(
pRåì
, 
pLe·
->
pP¨ít
, &
À·bbox
, 
iHeight
+1);

141709 if–
rc
!=
SQLITE_OK
 ){

141710 
•lônode_out
;

141713 
RåìNode
 *
pP¨ít
 = 
pLe·
->pParent;

141714 
iCñl
;

141715 
rc
 = 
	`nodeP¨ítIndex
(
pRåì
, 
pLe·
, &
iCñl
);

141716 if–
rc
==
SQLITE_OK
 ){

141717 
	`nodeOvîwrôeCñl
(
pRåì
, 
pP¨ít
, &
À·bbox
, 
iCñl
);

141718 
rc
 = 
	`Adju°Tªe
(
pRåì
, 
pP¨ít
, &
À·bbox
);

141720 if–
rc
!=
SQLITE_OK
 ){

141721 
•lônode_out
;

141724 if–(
rc
 = 
	`πªeIn£πCñl
(
pRåì
, 
pRight
->
pP¨ít
, &
rightbbox
, 
iHeight
+1)) ){

141725 
•lônode_out
;

141728 
i
=0; i<
	`NCELL
(
pRight
); i++){

141729 
i64
 
iRowid
 = 
	`nodeGëRowid
(
pRåì
, 
pRight
, 
i
);

141730 
rc
 = 
	`upd©eM≠pög
(
pRåì
, 
iRowid
, 
pRight
, 
iHeight
);

141731 if–
iRowid
==
pCñl
->iRowid ){

141732 
√wCñlIsRight
 = 1;

141734 if–
rc
!=
SQLITE_OK
 ){

141735 
•lônode_out
;

141738 if–
pNode
->
iNode
==1 ){

141739 
i
=0; i<
	`NCELL
(
pLe·
); i++){

141740 
i64
 
iRowid
 = 
	`nodeGëRowid
(
pRåì
, 
pLe·
, 
i
);

141741 
rc
 = 
	`upd©eM≠pög
(
pRåì
, 
iRowid
, 
pLe·
, 
iHeight
);

141742 if–
rc
!=
SQLITE_OK
 ){

141743 
•lônode_out
;

141746 }if–
√wCñlIsRight
==0 ){

141747 
rc
 = 
	`upd©eM≠pög
(
pRåì
, 
pCñl
->
iRowid
, 
pLe·
, 
iHeight
);

141750 if–
rc
==
SQLITE_OK
 ){

141751 
rc
 = 
	`nodeRñó£
(
pRåì
, 
pRight
);

141752 
pRight
 = 0;

141754 if–
rc
==
SQLITE_OK
 ){

141755 
rc
 = 
	`nodeRñó£
(
pRåì
, 
pLe·
);

141756 
pLe·
 = 0;

141759 
•lônode_out
:

141760 
	`nodeRñó£
(
pRåì
, 
pRight
);

141761 
	`nodeRñó£
(
pRåì
, 
pLe·
);

141762 
	`sqlôe3_‰ì
(
aCñl
);

141763  
rc
;

141777 
	`fixLófP¨ít
(
Råì
 *
pRåì
, 
RåìNode
 *
pLóf
){

141778 
rc
 = 
SQLITE_OK
;

141779 
RåìNode
 *
pChûd
 = 
pLóf
;

141780  
rc
==
SQLITE_OK
 && 
pChûd
->
iNode
!=1 &&ÖChûd->
pP¨ít
==0 ){

141781 
rc2
 = 
SQLITE_OK
;

141782 
	`sqlôe3_böd_öt64
(
pRåì
->
pRódP¨ít
, 1, 
pChûd
->
iNode
);

141783 
rc
 = 
	`sqlôe3_°ï
(
pRåì
->
pRódP¨ít
);

141784 if–
rc
==
SQLITE_ROW
 ){

141785 
RåìNode
 *
pTe°
;

141786 
i64
 
iNode
;

141793 
iNode
 = 
	`sqlôe3_cﬁumn_öt64
(
pRåì
->
pRódP¨ít
, 0);

141794 
pTe°
=
pLóf
;ÖTe° &&ÖTe°->
iNode
!=iNode;ÖTe°ıTe°->
pP¨ít
);

141795 if–!
pTe°
 ){

141796 
rc2
 = 
	`nodeAcquúe
(
pRåì
, 
iNode
, 0, &
pChûd
->
pP¨ít
);

141799 
rc
 = 
	`sqlôe3_ª£t
(
pRåì
->
pRódP¨ít
);

141800 if–
rc
==
SQLITE_OK
 )Ñ¯
rc2
;

141801 if–
rc
==
SQLITE_OK
 && !
pChûd
->
pP¨ít
 )Ñ¯
SQLITE_CORRUPT_VTAB
;

141802 
pChûd
 =ÖChûd->
pP¨ít
;

141804  
rc
;

141807 
	`dñëeCñl
(
Råì
 *, 
RåìNode
 *, , );

141809 
	`ªmoveNode
(
Råì
 *
pRåì
, 
RåìNode
 *
pNode
, 
iHeight
){

141810 
rc
;

141811 
rc2
;

141812 
RåìNode
 *
pP¨ít
 = 0;

141813 
iCñl
;

141815 
	`as£π
–
pNode
->
nRef
==1 );

141818 
rc
 = 
	`nodeP¨ítIndex
(
pRåì
, 
pNode
, &
iCñl
);

141819 if–
rc
==
SQLITE_OK
 ){

141820 
pP¨ít
 = 
pNode
->pParent;

141821 
pNode
->
pP¨ít
 = 0;

141822 
rc
 = 
	`dñëeCñl
(
pRåì
, 
pP¨ít
, 
iCñl
, 
iHeight
+1);

141824 
rc2
 = 
	`nodeRñó£
(
pRåì
, 
pP¨ít
);

141825 if–
rc
==
SQLITE_OK
 ){

141826 
rc
 = 
rc2
;

141828 if–
rc
!=
SQLITE_OK
 ){

141829  
rc
;

141833 
	`sqlôe3_böd_öt64
(
pRåì
->
pDñëeNode
, 1, 
pNode
->
iNode
);

141834 
	`sqlôe3_°ï
(
pRåì
->
pDñëeNode
);

141835 if–
SQLITE_OK
!=(
rc
 = 
	`sqlôe3_ª£t
(
pRåì
->
pDñëeNode
)) ){

141836  
rc
;

141840 
	`sqlôe3_böd_öt64
(
pRåì
->
pDñëeP¨ít
, 1, 
pNode
->
iNode
);

141841 
	`sqlôe3_°ï
(
pRåì
->
pDñëeP¨ít
);

141842 if–
SQLITE_OK
!=(
rc
 = 
	`sqlôe3_ª£t
(
pRåì
->
pDñëeP¨ít
)) ){

141843  
rc
;

141849 
	`nodeHashDñëe
(
pRåì
, 
pNode
);

141850 
pNode
->
iNode
 = 
iHeight
;

141851 
pNode
->
pNext
 = 
pRåì
->
pDñëed
;

141852 
pNode
->
nRef
++;

141853 
pRåì
->
pDñëed
 = 
pNode
;

141855  
SQLITE_OK
;

141858 
	`fixBoundögBox
(
Råì
 *
pRåì
, 
RåìNode
 *
pNode
){

141859 
RåìNode
 *
pP¨ít
 = 
pNode
->pParent;

141860 
rc
 = 
SQLITE_OK
;

141861 if–
pP¨ít
 ){

141862 
ii
;

141863 
nCñl
 = 
	`NCELL
(
pNode
);

141864 
RåìCñl
 
box
;

141865 
	`nodeGëCñl
(
pRåì
, 
pNode
, 0, &
box
);

141866 
ii
=1; ii<
nCñl
; ii++){

141867 
RåìCñl
 
˚Œ
;

141868 
	`nodeGëCñl
(
pRåì
, 
pNode
, 
ii
, &
˚Œ
);

141869 
	`˚ŒUni⁄
(
pRåì
, &
box
, &
˚Œ
);

141871 
box
.
iRowid
 = 
pNode
->
iNode
;

141872 
rc
 = 
	`nodeP¨ítIndex
(
pRåì
, 
pNode
, &
ii
);

141873 if–
rc
==
SQLITE_OK
 ){

141874 
	`nodeOvîwrôeCñl
(
pRåì
, 
pP¨ít
, &
box
, 
ii
);

141875 
rc
 = 
	`fixBoundögBox
(
pRåì
, 
pP¨ít
);

141878  
rc
;

141885 
	`dñëeCñl
(
Råì
 *
pRåì
, 
RåìNode
 *
pNode
, 
iCñl
, 
iHeight
){

141886 
RåìNode
 *
pP¨ít
;

141887 
rc
;

141889 if–
SQLITE_OK
!=(
rc
 = 
	`fixLófP¨ít
(
pRåì
, 
pNode
)) ){

141890  
rc
;

141896 
	`nodeDñëeCñl
(
pRåì
, 
pNode
, 
iCñl
);

141903 
pP¨ít
 = 
pNode
->pParent;

141904 
	`as£π
–
pP¨ít
 || 
pNode
->
iNode
==1 );

141905 if–
pP¨ít
 ){

141906 if–
	`NCELL
(
pNode
)<
	`RTREE_MINCELLS
(
pRåì
) ){

141907 
rc
 = 
	`ªmoveNode
(
pRåì
, 
pNode
, 
iHeight
);

141909 
rc
 = 
	`fixBoundögBox
(
pRåì
, 
pNode
);

141913  
rc
;

141916 
	`Reö£π
(

141917 
Råì
 *
pRåì
,

141918 
RåìNode
 *
pNode
,

141919 
RåìCñl
 *
pCñl
,

141920 
iHeight


141922 *
aOrdî
;

141923 *
aS∑ª
;

141924 
RåìCñl
 *
aCñl
;

141925 
RåìDVÆue
 *
aDi°™˚
;

141926 
nCñl
;

141927 
RåìDVÆue
 
aCíãrCo‹d
[
RTREE_MAX_DIMENSIONS
];

141928 
iDim
;

141929 
ii
;

141930 
rc
 = 
SQLITE_OK
;

141931 
n
;

141933 
	`mem£t
(
aCíãrCo‹d
, 0, (
RåìDVÆue
)*
RTREE_MAX_DIMENSIONS
);

141935 
nCñl
 = 
	`NCELL
(
pNode
)+1;

141936 
n
 = (
nCñl
+1)&(~1);

141941 
aCñl
 = (
RåìCñl
 *)
	`sqlôe3_mÆloc
(
n
 * (

141942 (
RåìCñl
) +

141945 (
RåìDVÆue
)

141947 if–!
aCñl
 ){

141948  
SQLITE_NOMEM
;

141950 
aOrdî
 = (*)&
aCñl
[
n
];

141951 
aS∑ª
 = (*)&
aOrdî
[
n
];

141952 
aDi°™˚
 = (
RåìDVÆue
 *)&
aS∑ª
[
n
];

141954 
ii
=0; ii<
nCñl
; ii++){

141955 if–
ii
==(
nCñl
-1) ){

141956 
	`mem˝y
(&
aCñl
[
ii
], 
pCñl
, (
RåìCñl
));

141958 
	`nodeGëCñl
(
pRåì
, 
pNode
, 
ii
, &
aCñl
[ii]);

141960 
aOrdî
[
ii
] = ii;

141961 
iDim
=0; iDim<
pRåì
->
nDim
; iDim++){

141962 
aCíãrCo‹d
[
iDim
] +
	`DCOORD
(
aCñl
[
ii
].
aCo‹d
[iDim*2]);

141963 
aCíãrCo‹d
[
iDim
] +
	`DCOORD
(
aCñl
[
ii
].
aCo‹d
[iDim*2+1]);

141966 
iDim
=0; iDim<
pRåì
->
nDim
; iDim++){

141967 
aCíãrCo‹d
[
iDim
] = (aCíãrCo‹d[iDim]/(
nCñl
*(
RåìDVÆue
)2));

141970 
ii
=0; ii<
nCñl
; ii++){

141971 
aDi°™˚
[
ii
] = 0.0;

141972 
iDim
=0; iDim<
pRåì
->
nDim
; iDim++){

141973 
RåìDVÆue
 
co‹d
 = (
	`DCOORD
(
aCñl
[
ii
].
aCo‹d
[
iDim
*2+1]) -

141974 
	`DCOORD
(
aCñl
[
ii
].
aCo‹d
[
iDim
*2]));

141975 
aDi°™˚
[
ii
] +(
co‹d
-
aCíãrCo‹d
[
iDim
])*(coord-aCenterCoord[iDim]);

141979 
	`S‹tByDi°™˚
(
aOrdî
, 
nCñl
, 
aDi°™˚
, 
aS∑ª
);

141980 
	`nodeZîo
(
pRåì
, 
pNode
);

141982 
ii
=0; 
rc
==
SQLITE_OK
 && ii<(
nCñl
-(
	`RTREE_MINCELLS
(
pRåì
)+1)); ii++){

141983 
RåìCñl
 *
p
 = &
aCñl
[
aOrdî
[
ii
]];

141984 
	`nodeIn£πCñl
(
pRåì
, 
pNode
, 
p
);

141985 if–
p
->
iRowid
==
pCñl
->iRowid ){

141986 if–
iHeight
==0 ){

141987 
rc
 = 
	`rowidWrôe
(
pRåì
, 
p
->
iRowid
, 
pNode
->
iNode
);

141989 
rc
 = 
	`∑ª¡Wrôe
(
pRåì
, 
p
->
iRowid
, 
pNode
->
iNode
);

141993 if–
rc
==
SQLITE_OK
 ){

141994 
rc
 = 
	`fixBoundögBox
(
pRåì
, 
pNode
);

141996 ; 
rc
==
SQLITE_OK
 && 
ii
<
nCñl
; ii++){

142000 
RåìNode
 *
pIn£π
;

142001 
RåìCñl
 *
p
 = &
aCñl
[
aOrdî
[
ii
]];

142002 
rc
 = 
	`Choo£Lóf
(
pRåì
, 
p
, 
iHeight
, &
pIn£π
);

142003 if–
rc
==
SQLITE_OK
 ){

142004 
rc2
;

142005 
rc
 = 
	`πªeIn£πCñl
(
pRåì
, 
pIn£π
, 
p
, 
iHeight
);

142006 
rc2
 = 
	`nodeRñó£
(
pRåì
, 
pIn£π
);

142007 if–
rc
==
SQLITE_OK
 ){

142008 
rc
 = 
rc2
;

142013 
	`sqlôe3_‰ì
(
aCñl
);

142014  
rc
;

142021 
	`πªeIn£πCñl
(

142022 
Råì
 *
pRåì
,

142023 
RåìNode
 *
pNode
,

142024 
RåìCñl
 *
pCñl
,

142025 
iHeight


142027 
rc
 = 
SQLITE_OK
;

142028 if–
iHeight
>0 ){

142029 
RåìNode
 *
pChûd
 = 
	`nodeHashLookup
(
pRåì
, 
pCñl
->
iRowid
);

142030 if–
pChûd
 ){

142031 
	`nodeRñó£
(
pRåì
, 
pChûd
->
pP¨ít
);

142032 
	`nodeRe„ªn˚
(
pNode
);

142033 
pChûd
->
pP¨ít
 = 
pNode
;

142036 if–
	`nodeIn£πCñl
(
pRåì
, 
pNode
, 
pCñl
) ){

142037 #i‡
VARIANT_RSTARTREE_REINSERT


142038 if–
iHeight
<=
pRåì
->
iReö£πHeight
 || 
pNode
->
iNode
==1){

142039 
rc
 = 
	`S∂ôNode
(
pRåì
, 
pNode
, 
pCñl
, 
iHeight
);

142041 
pRåì
->
iReö£πHeight
 = 
iHeight
;

142042 
rc
 = 
	`Reö£π
(
pRåì
, 
pNode
, 
pCñl
, 
iHeight
);

142045 
rc
 = 
	`S∂ôNode
(
pRåì
, 
pNode
, 
pCñl
, 
iHeight
);

142048 
rc
 = 
	`Adju°Tªe
(
pRåì
, 
pNode
, 
pCñl
);

142049 if–
rc
==
SQLITE_OK
 ){

142050 if–
iHeight
==0 ){

142051 
rc
 = 
	`rowidWrôe
(
pRåì
, 
pCñl
->
iRowid
, 
pNode
->
iNode
);

142053 
rc
 = 
	`∑ª¡Wrôe
(
pRåì
, 
pCñl
->
iRowid
, 
pNode
->
iNode
);

142057  
rc
;

142060 
	`ªö£πNodeC⁄ã¡
(
Råì
 *
pRåì
, 
RåìNode
 *
pNode
){

142061 
ii
;

142062 
rc
 = 
SQLITE_OK
;

142063 
nCñl
 = 
	`NCELL
(
pNode
);

142065 
ii
=0; 
rc
==
SQLITE_OK
 && ii<
nCñl
; ii++){

142066 
RåìNode
 *
pIn£π
;

142067 
RåìCñl
 
˚Œ
;

142068 
	`nodeGëCñl
(
pRåì
, 
pNode
, 
ii
, &
˚Œ
);

142073 
rc
 = 
	`Choo£Lóf
(
pRåì
, &
˚Œ
, ()
pNode
->
iNode
, &
pIn£π
);

142074 if–
rc
==
SQLITE_OK
 ){

142075 
rc2
;

142076 
rc
 = 
	`πªeIn£πCñl
(
pRåì
, 
pIn£π
, &
˚Œ
, ()
pNode
->
iNode
);

142077 
rc2
 = 
	`nodeRñó£
(
pRåì
, 
pIn£π
);

142078 if–
rc
==
SQLITE_OK
 ){

142079 
rc
 = 
rc2
;

142083  
rc
;

142089 
	`√wRowid
(
Råì
 *
pRåì
, 
i64
 *
piRowid
){

142090 
rc
;

142091 
	`sqlôe3_böd_nuŒ
(
pRåì
->
pWrôeRowid
, 1);

142092 
	`sqlôe3_böd_nuŒ
(
pRåì
->
pWrôeRowid
, 2);

142093 
	`sqlôe3_°ï
(
pRåì
->
pWrôeRowid
);

142094 
rc
 = 
	`sqlôe3_ª£t
(
pRåì
->
pWrôeRowid
);

142095 *
piRowid
 = 
	`sqlôe3_œ°_ö£π_rowid
(
pRåì
->
db
);

142096  
rc
;

142102 
	`πªeDñëeRowid
(
Råì
 *
pRåì
, 
sqlôe3_öt64
 
iDñëe
){

142103 
rc
;

142104 
RåìNode
 *
pLóf
 = 0;

142105 
iCñl
;

142106 
RåìNode
 *
pRoŸ
;

142110 
rc
 = 
	`nodeAcquúe
(
pRåì
, 1, 0, &
pRoŸ
);

142115 if–
rc
==
SQLITE_OK
 ){

142116 
rc
 = 
	`födLófNode
(
pRåì
, 
iDñëe
, &
pLóf
);

142120 if–
rc
==
SQLITE_OK
 ){

142121 
rc2
;

142122 
rc
 = 
	`nodeRowidIndex
(
pRåì
, 
pLóf
, 
iDñëe
, &
iCñl
);

142123 if–
rc
==
SQLITE_OK
 ){

142124 
rc
 = 
	`dñëeCñl
(
pRåì
, 
pLóf
, 
iCñl
, 0);

142126 
rc2
 = 
	`nodeRñó£
(
pRåì
, 
pLóf
);

142127 if–
rc
==
SQLITE_OK
 ){

142128 
rc
 = 
rc2
;

142133 if–
rc
==
SQLITE_OK
 ){

142134 
	`sqlôe3_böd_öt64
(
pRåì
->
pDñëeRowid
, 1, 
iDñëe
);

142135 
	`sqlôe3_°ï
(
pRåì
->
pDñëeRowid
);

142136 
rc
 = 
	`sqlôe3_ª£t
(
pRåì
->
pDñëeRowid
);

142147 if–
rc
==
SQLITE_OK
 && 
pRåì
->
iDïth
>0 && 
	`NCELL
(
pRoŸ
)==1 ){

142148 
rc2
;

142149 
RåìNode
 *
pChûd
;

142150 
i64
 
iChûd
 = 
	`nodeGëRowid
(
pRåì
, 
pRoŸ
, 0);

142151 
rc
 = 
	`nodeAcquúe
(
pRåì
, 
iChûd
, 
pRoŸ
, &
pChûd
);

142152 if–
rc
==
SQLITE_OK
 ){

142153 
rc
 = 
	`ªmoveNode
(
pRåì
, 
pChûd
,ÖRåì->
iDïth
-1);

142155 
rc2
 = 
	`nodeRñó£
(
pRåì
, 
pChûd
);

142156 if–
rc
==
SQLITE_OK
 )Ñ¯
rc2
;

142157 if–
rc
==
SQLITE_OK
 ){

142158 
pRåì
->
iDïth
--;

142159 
	`wrôeI¡16
(
pRoŸ
->
zD©a
, 
pRåì
->
iDïth
);

142160 
pRoŸ
->
isDúty
 = 1;

142165 
pLóf
=
pRåì
->
pDñëed
;ÖLeaf;ÖLeaf=pRtree->pDeleted){

142166 if–
rc
==
SQLITE_OK
 ){

142167 
rc
 = 
	`ªö£πNodeC⁄ã¡
(
pRåì
, 
pLóf
);

142169 
pRåì
->
pDñëed
 = 
pLóf
->
pNext
;

142170 
	`sqlôe3_‰ì
(
pLóf
);

142174 if–
rc
==
SQLITE_OK
 ){

142175 
rc
 = 
	`nodeRñó£
(
pRåì
, 
pRoŸ
);

142177 
	`nodeRñó£
(
pRåì
, 
pRoŸ
);

142180  
rc
;

142186 
	#RNDTOWARDS
 (1.0 - 1.0/8388608.0Ë

	)

142187 
	#RNDAWAY
 (1.0 + 1.0/8388608.0Ë

	)

142189 #i‡!
	`deföed
(
SQLITE_RTREE_INT_ONLY
)

142194 
RåìVÆue
 
	`πªeVÆueDown
(
sqlôe3_vÆue
 *
v
){

142195 
d
 = 
	`sqlôe3_vÆue_doubÀ
(
v
);

142196 
f
 = ()
d
;

142197 if–
f
>
d
 ){

142198 
f
 = ()(
d
*(d<0 ? 
RNDAWAY
 : 
RNDTOWARDS
));

142200  
f
;

142202 
RåìVÆue
 
	`πªeVÆueUp
(
sqlôe3_vÆue
 *
v
){

142203 
d
 = 
	`sqlôe3_vÆue_doubÀ
(
v
);

142204 
f
 = ()
d
;

142205 if–
f
<
d
 ){

142206 
f
 = ()(
d
*(d<0 ? 
RNDTOWARDS
 : 
RNDAWAY
));

142208  
f
;

142216 
	`πªeUpd©e
(

142217 
sqlôe3_vèb
 *
pVèb
,

142218 
nD©a
,

142219 
sqlôe3_vÆue
 **
azD©a
,

142220 
sqlôe_öt64
 *
pRowid


142222 
Råì
 *
pRåì
 = (Råì *)
pVèb
;

142223 
rc
 = 
SQLITE_OK
;

142224 
RåìCñl
 
˚Œ
;

142225 
bHaveRowid
 = 0;

142227 
	`πªeRe„ªn˚
(
pRåì
);

142228 
	`as£π
(
nD©a
>=1);

142241 if–
nD©a
>1 ){

142242 
ii
;

142245 
	`as£π
–
nD©a
==(
pRåì
->
nDim
*2 + 3) );

142246 #i‚de‡
SQLITE_RTREE_INT_ONLY


142247 if–
pRåì
->
eCo‹dTy≥
==
RTREE_COORD_REAL32
 ){

142248 
ii
=0; ii<(
pRåì
->
nDim
*2); ii+=2){

142249 
˚Œ
.
aCo‹d
[
ii
].
f
 = 
	`πªeVÆueDown
(
azD©a
[ii+3]);

142250 
˚Œ
.
aCo‹d
[
ii
+1].
f
 = 
	`πªeVÆueUp
(
azD©a
[ii+4]);

142251 if–
˚Œ
.
aCo‹d
[
ii
].
f
>cell.aCoord[ii+1].f ){

142252 
rc
 = 
SQLITE_CONSTRAINT
;

142253 
c⁄°øöt
;

142259 
ii
=0; ii<(
pRåì
->
nDim
*2); ii+=2){

142260 
˚Œ
.
aCo‹d
[
ii
].
i
 = 
	`sqlôe3_vÆue_öt
(
azD©a
[ii+3]);

142261 
˚Œ
.
aCo‹d
[
ii
+1].
i
 = 
	`sqlôe3_vÆue_öt
(
azD©a
[ii+4]);

142262 if–
˚Œ
.
aCo‹d
[
ii
].
i
>cell.aCoord[ii+1].i ){

142263 
rc
 = 
SQLITE_CONSTRAINT
;

142264 
c⁄°øöt
;

142271 if–
	`sqlôe3_vÆue_ty≥
(
azD©a
[2])!=
SQLITE_NULL
 ){

142272 
˚Œ
.
iRowid
 = 
	`sqlôe3_vÆue_öt64
(
azD©a
[2]);

142273 if–
	`sqlôe3_vÆue_ty≥
(
azD©a
[0])==
SQLITE_NULL


142274 || 
	`sqlôe3_vÆue_öt64
(
azD©a
[0])!=
˚Œ
.
iRowid


142276 
°ïrc
;

142277 
	`sqlôe3_böd_öt64
(
pRåì
->
pRódRowid
, 1, 
˚Œ
.
iRowid
);

142278 
°ïrc
 = 
	`sqlôe3_°ï
(
pRåì
->
pRódRowid
);

142279 
rc
 = 
	`sqlôe3_ª£t
(
pRåì
->
pRódRowid
);

142280 if–
SQLITE_ROW
==
°ïrc
 ){

142281 if–
	`sqlôe3_vèb_⁄_c⁄Êi˘
(
pRåì
->
db
)==
SQLITE_REPLACE
 ){

142282 
rc
 = 
	`πªeDñëeRowid
(
pRåì
, 
˚Œ
.
iRowid
);

142284 
rc
 = 
SQLITE_CONSTRAINT
;

142285 
c⁄°øöt
;

142289 
bHaveRowid
 = 1;

142297 if–
	`sqlôe3_vÆue_ty≥
(
azD©a
[0])!=
SQLITE_NULL
 ){

142298 
rc
 = 
	`πªeDñëeRowid
(
pRåì
, 
	`sqlôe3_vÆue_öt64
(
azD©a
[0]));

142305 if–
rc
==
SQLITE_OK
 && 
nD©a
>1 ){

142307 
RåìNode
 *
pLóf
 = 0;

142310 if–
bHaveRowid
==0 ){

142311 
rc
 = 
	`√wRowid
(
pRåì
, &
˚Œ
.
iRowid
);

142313 *
pRowid
 = 
˚Œ
.
iRowid
;

142315 if–
rc
==
SQLITE_OK
 ){

142316 
rc
 = 
	`Choo£Lóf
(
pRåì
, &
˚Œ
, 0, &
pLóf
);

142318 if–
rc
==
SQLITE_OK
 ){

142319 
rc2
;

142320 
pRåì
->
iReö£πHeight
 = -1;

142321 
rc
 = 
	`πªeIn£πCñl
(
pRåì
, 
pLóf
, &
˚Œ
, 0);

142322 
rc2
 = 
	`nodeRñó£
(
pRåì
, 
pLóf
);

142323 if–
rc
==
SQLITE_OK
 ){

142324 
rc
 = 
rc2
;

142329 
c⁄°øöt
:

142330 
	`πªeRñó£
(
pRåì
);

142331  
rc
;

142337 
	`πªeRíame
(
sqlôe3_vèb
 *
pVèb
, c⁄° *
zNewName
){

142338 
Råì
 *
pRåì
 = (Råì *)
pVèb
;

142339 
rc
 = 
SQLITE_NOMEM
;

142340 *
zSql
 = 
	`sqlôe3_m¥ötf
(

142344 , 
pRåì
->
zDb
,ÖRåì->
zName
, 
zNewName


142345 , 
pRåì
->
zDb
,ÖRåì->
zName
, 
zNewName


142346 , 
pRåì
->
zDb
,ÖRåì->
zName
, 
zNewName


142348 if–
zSql
 ){

142349 
rc
 = 
	`sqlôe3_exec
(
pRåì
->
db
, 
zSql
, 0, 0, 0);

142350 
	`sqlôe3_‰ì
(
zSql
);

142352  
rc
;

142355 
sqlôe3_moduÀ
 
πªeModuÀ
 = {

142357 
πªeCª©e
,

142358 
πªeC⁄√˘
,

142359 
πªeBe°Index
,

142360 
πªeDisc⁄√˘
,

142361 
πªeDe°roy
,

142362 
πªeO≥n
,

142363 
πªeClo£
,

142364 
πªeFûãr
,

142365 
πªeNext
,

142366 
πªeEof
,

142367 
πªeCﬁumn
,

142368 
πªeRowid
,

142369 
πªeUpd©e
,

142375 
πªeRíame
,

142381 
	`πªeSqlInô
(

142382 
Råì
 *
pRåì
,

142383 
sqlôe3
 *
db
,

142384 c⁄° *
zDb
,

142385 c⁄° *
zPªfix
,

142386 
isCª©e


142388 
rc
 = 
SQLITE_OK
;

142390 
	#N_STATEMENT
 9

	)

142391 c⁄° *
azSql
[
N_STATEMENT
] = {

142407 
sqlôe3_°mt
 **
≠pStmt
[
N_STATEMENT
];

142408 
i
;

142410 
pRåì
->
db
 = db;

142412 if–
isCª©e
 ){

142413 *
zCª©e
 = 
	`sqlôe3_m¥ötf
(

142418 
zDb
, 
zPªfix
, zDb, zPªfix, zDb, zPªfix, zDb, zPªfix, 
pRåì
->
iNodeSize


142420 if–!
zCª©e
 ){

142421  
SQLITE_NOMEM
;

142423 
rc
 = 
	`sqlôe3_exec
(
db
, 
zCª©e
, 0, 0, 0);

142424 
	`sqlôe3_‰ì
(
zCª©e
);

142425 if–
rc
!=
SQLITE_OK
 ){

142426  
rc
;

142430 
≠pStmt
[0] = &
pRåì
->
pRódNode
;

142431 
≠pStmt
[1] = &
pRåì
->
pWrôeNode
;

142432 
≠pStmt
[2] = &
pRåì
->
pDñëeNode
;

142433 
≠pStmt
[3] = &
pRåì
->
pRódRowid
;

142434 
≠pStmt
[4] = &
pRåì
->
pWrôeRowid
;

142435 
≠pStmt
[5] = &
pRåì
->
pDñëeRowid
;

142436 
≠pStmt
[6] = &
pRåì
->
pRódP¨ít
;

142437 
≠pStmt
[7] = &
pRåì
->
pWrôeP¨ít
;

142438 
≠pStmt
[8] = &
pRåì
->
pDñëeP¨ít
;

142440 
i
=0; i<
N_STATEMENT
 && 
rc
==
SQLITE_OK
; i++){

142441 *
zSql
 = 
	`sqlôe3_m¥ötf
(
azSql
[
i
], 
zDb
, 
zPªfix
);

142442 if–
zSql
 ){

142443 
rc
 = 
	`sqlôe3_¥ï¨e_v2
(
db
, 
zSql
, -1, 
≠pStmt
[
i
], 0);

142445 
rc
 = 
SQLITE_NOMEM
;

142447 
	`sqlôe3_‰ì
(
zSql
);

142450  
rc
;

142460 
	`gëI¡FromStmt
(
sqlôe3
 *
db
, c⁄° *
zSql
, *
piVÆ
){

142461 
rc
 = 
SQLITE_NOMEM
;

142462 if–
zSql
 ){

142463 
sqlôe3_°mt
 *
pStmt
 = 0;

142464 
rc
 = 
	`sqlôe3_¥ï¨e_v2
(
db
, 
zSql
, -1, &
pStmt
, 0);

142465 if–
rc
==
SQLITE_OK
 ){

142466 if–
SQLITE_ROW
==
	`sqlôe3_°ï
(
pStmt
) ){

142467 *
piVÆ
 = 
	`sqlôe3_cﬁumn_öt
(
pStmt
, 0);

142469 
rc
 = 
	`sqlôe3_föÆize
(
pStmt
);

142472  
rc
;

142490 
	`gëNodeSize
(

142491 
sqlôe3
 *
db
,

142492 
Råì
 *
pRåì
,

142493 
isCª©e
,

142494 **
pzEº


142496 
rc
;

142497 *
zSql
;

142498 if–
isCª©e
 ){

142499 
iPageSize
 = 0;

142500 
zSql
 = 
	`sqlôe3_m¥ötf
("PRAGMA %Q.∑ge_size", 
pRåì
->
zDb
);

142501 
rc
 = 
	`gëI¡FromStmt
(
db
, 
zSql
, &
iPageSize
);

142502 if–
rc
==
SQLITE_OK
 ){

142503 
pRåì
->
iNodeSize
 = 
iPageSize
-64;

142504 if–(4+
pRåì
->
nByãsPîCñl
*
RTREE_MAXCELLS
)<pRåì->
iNodeSize
 ){

142505 
pRåì
->
iNodeSize
 = 4+pRåì->
nByãsPîCñl
*
RTREE_MAXCELLS
;

142508 *
pzEº
 = 
	`sqlôe3_m¥ötf
("%s", 
	`sqlôe3_îrmsg
(
db
));

142511 
zSql
 = 
	`sqlôe3_m¥ötf
(

142513 
pRåì
->
zDb
,ÖRåì->
zName


142515 
rc
 = 
	`gëI¡FromStmt
(
db
, 
zSql
, &
pRåì
->
iNodeSize
);

142516 if–
rc
!=
SQLITE_OK
 ){

142517 *
pzEº
 = 
	`sqlôe3_m¥ötf
("%s", 
	`sqlôe3_îrmsg
(
db
));

142521 
	`sqlôe3_‰ì
(
zSql
);

142522  
rc
;

142534 
	`πªeInô
(

142535 
sqlôe3
 *
db
,

142536 *
pAux
,

142537 
¨gc
, c⁄° *c⁄°*
¨gv
,

142538 
sqlôe3_vèb
 **
µVèb
,

142539 **
pzEº
,

142540 
isCª©e


142542 
rc
 = 
SQLITE_OK
;

142543 
Råì
 *
pRåì
;

142544 
nDb
;

142545 
nName
;

142546 
eCo‹dTy≥
 = (
pAux
 ? 
RTREE_COORD_INT32
 : 
RTREE_COORD_REAL32
);

142548 c⁄° *
aEºMsg
[] = {

142555 
iEº
 = (
¨gc
<6Ë? 2 :árgc>(
RTREE_MAX_DIMENSIONS
*2+4) ? 3 :árgc%2;

142556 if–
aEºMsg
[
iEº
] ){

142557 *
pzEº
 = 
	`sqlôe3_m¥ötf
("%s", 
aEºMsg
[
iEº
]);

142558  
SQLITE_ERROR
;

142561 
	`sqlôe3_vèb_c⁄fig
(
db
, 
SQLITE_VTAB_CONSTRAINT_SUPPORT
, 1);

142564 
nDb
 = ()
	`°æí
(
¨gv
[1]);

142565 
nName
 = ()
	`°æí
(
¨gv
[2]);

142566 
pRåì
 = (
Råì
 *)
	`sqlôe3_mÆloc
((Råì)+
nDb
+
nName
+2);

142567 if–!
pRåì
 ){

142568  
SQLITE_NOMEM
;

142570 
	`mem£t
(
pRåì
, 0, (
Råì
)+
nDb
+
nName
+2);

142571 
pRåì
->
nBusy
 = 1;

142572 
pRåì
->
ba£
.
pModuÀ
 = &
πªeModuÀ
;

142573 
pRåì
->
zDb
 = (*)&pRtree[1];

142574 
pRåì
->
zName
 = &pRåì->
zDb
[
nDb
+1];

142575 
pRåì
->
nDim
 = (
¨gc
-4)/2;

142576 
pRåì
->
nByãsPîCñl
 = 8 +ÖRåì->
nDim
*4*2;

142577 
pRåì
->
eCo‹dTy≥
 =ÉCoordType;

142578 
	`mem˝y
(
pRåì
->
zDb
, 
¨gv
[1], 
nDb
);

142579 
	`mem˝y
(
pRåì
->
zName
, 
¨gv
[2], 
nName
);

142582 
rc
 = 
	`gëNodeSize
(
db
, 
pRåì
, 
isCª©e
, 
pzEº
);

142588 if–
rc
==
SQLITE_OK
 ){

142589 if–(
rc
 = 
	`πªeSqlInô
(
pRåì
, 
db
, 
¨gv
[1],árgv[2], 
isCª©e
)) ){

142590 *
pzEº
 = 
	`sqlôe3_m¥ötf
("%s", 
	`sqlôe3_îrmsg
(
db
));

142592 *
zSql
 = 
	`sqlôe3_m¥ötf
("CREATE TABLE x(%s", 
¨gv
[3]);

142593 *
zTmp
;

142594 
ii
;

142595 
ii
=4; 
zSql
 && ii<
¨gc
; ii++){

142596 
zTmp
 = 
zSql
;

142597 
zSql
 = 
	`sqlôe3_m¥ötf
("%s, %s", 
zTmp
, 
¨gv
[
ii
]);

142598 
	`sqlôe3_‰ì
(
zTmp
);

142600 if–
zSql
 ){

142601 
zTmp
 = 
zSql
;

142602 
zSql
 = 
	`sqlôe3_m¥ötf
("%s);", 
zTmp
);

142603 
	`sqlôe3_‰ì
(
zTmp
);

142605 if–!
zSql
 ){

142606 
rc
 = 
SQLITE_NOMEM
;

142607 }if–
SQLITE_OK
!=(
rc
 = 
	`sqlôe3_de˛¨e_vèb
(
db
, 
zSql
)) ){

142608 *
pzEº
 = 
	`sqlôe3_m¥ötf
("%s", 
	`sqlôe3_îrmsg
(
db
));

142610 
	`sqlôe3_‰ì
(
zSql
);

142614 if–
rc
==
SQLITE_OK
 ){

142615 *
µVèb
 = (
sqlôe3_vèb
 *)
pRåì
;

142617 
	`πªeRñó£
(
pRåì
);

142619  
rc
;

142639 
	`πªíode
(
sqlôe3_c⁄ãxt
 *
˘x
, 
nArg
, 
sqlôe3_vÆue
 **
≠Arg
){

142640 *
zText
 = 0;

142641 
RåìNode
 
node
;

142642 
Råì
 
åì
;

142643 
ii
;

142645 
	`UNUSED_PARAMETER
(
nArg
);

142646 
	`mem£t
(&
node
, 0, (
RåìNode
));

142647 
	`mem£t
(&
åì
, 0, (
Råì
));

142648 
åì
.
nDim
 = 
	`sqlôe3_vÆue_öt
(
≠Arg
[0]);

142649 
åì
.
nByãsPîCñl
 = 8 + 8 *Åªe.
nDim
;

142650 
node
.
zD©a
 = (
u8
 *)
	`sqlôe3_vÆue_blob
(
≠Arg
[1]);

142652 
ii
=0; ii<
	`NCELL
(&
node
); ii++){

142653 
zCñl
[512];

142654 
nCñl
 = 0;

142655 
RåìCñl
 
˚Œ
;

142656 
jj
;

142658 
	`nodeGëCñl
(&
åì
, &
node
, 
ii
, &
˚Œ
);

142659 
	`sqlôe3_¢¥ötf
(512-
nCñl
,&
zCñl
[nCñl],"%Œd", 
˚Œ
.
iRowid
);

142660 
nCñl
 = ()
	`°æí
(
zCñl
);

142661 
jj
=0; jj<
åì
.
nDim
*2; jj++){

142662 #i‚de‡
SQLITE_RTREE_INT_ONLY


142663 
	`sqlôe3_¢¥ötf
(512-
nCñl
,&
zCñl
[nCell], " %f",

142664 ()
˚Œ
.
aCo‹d
[
jj
].
f
);

142666 
	`sqlôe3_¢¥ötf
(512-
nCñl
,&
zCñl
[nCell], " %d",

142667 
˚Œ
.
aCo‹d
[
jj
].
i
);

142669 
nCñl
 = ()
	`°æí
(
zCñl
);

142672 if–
zText
 ){

142673 *
zTextNew
 = 
	`sqlôe3_m¥ötf
("%†{%s}", 
zText
, 
zCñl
);

142674 
	`sqlôe3_‰ì
(
zText
);

142675 
zText
 = 
zTextNew
;

142677 
zText
 = 
	`sqlôe3_m¥ötf
("{%s}", 
zCñl
);

142681 
	`sqlôe3_ªsu…_ãxt
(
˘x
, 
zText
, -1, 
sqlôe3_‰ì
);

142684 
	`πªedïth
(
sqlôe3_c⁄ãxt
 *
˘x
, 
nArg
, 
sqlôe3_vÆue
 **
≠Arg
){

142685 
	`UNUSED_PARAMETER
(
nArg
);

142686 if–
	`sqlôe3_vÆue_ty≥
(
≠Arg
[0])!=
SQLITE_BLOB


142687 || 
	`sqlôe3_vÆue_byãs
(
≠Arg
[0])<2

142689 
	`sqlôe3_ªsu…_îr‹
(
˘x
, "InvalidárgumentÅoÑtreedepth()", -1);

142691 
u8
 *
zBlob
 = (u8 *)
	`sqlôe3_vÆue_blob
(
≠Arg
[0]);

142692 
	`sqlôe3_ªsu…_öt
(
˘x
, 
	`ªadI¡16
(
zBlob
));

142701 
SQLITE_PRIVATE
 
	`sqlôe3RåìInô
(
sqlôe3
 *
db
){

142702 c⁄° 
utf8
 = 
SQLITE_UTF8
;

142703 
rc
;

142705 
rc
 = 
	`sqlôe3_¸óã_fun˘i⁄
(
db
, "πªíode", 2, 
utf8
, 0, 
πªíode
, 0, 0);

142706 if–
rc
==
SQLITE_OK
 ){

142707 
rc
 = 
	`sqlôe3_¸óã_fun˘i⁄
(
db
, "πªedïth", 1, 
utf8
, 0,
πªedïth
, 0, 0);

142709 if–
rc
==
SQLITE_OK
 ){

142710 #ifde‡
SQLITE_RTREE_INT_ONLY


142711 *
c
 = (*)
RTREE_COORD_INT32
;

142713 *
c
 = (*)
RTREE_COORD_REAL32
;

142715 
rc
 = 
	`sqlôe3_¸óã_moduÀ_v2
(
db
, "πªe", &
πªeModuÀ
, 
c
, 0);

142717 if–
rc
==
SQLITE_OK
 ){

142718 *
c
 = (*)
RTREE_COORD_INT32
;

142719 
rc
 = 
	`sqlôe3_¸óã_moduÀ_v2
(
db
, "πªe_i32", &
πªeModuÀ
, 
c
, 0);

142722  
rc
;

142731 
	`doSqlôe3Fªe
(*
p
){

142732 
	`sqlôe3_‰ì
(
p
);

142743 
	`geomCÆlback
(
sqlôe3_c⁄ãxt
 *
˘x
, 
nArg
, 
sqlôe3_vÆue
 **
aArg
){

142744 
RåìGeomCÆlback
 *
pGeomCtx
 = (RåìGeomCÆlback *)
	`sqlôe3_u£r_d©a
(
˘x
);

142745 
RåìM©chArg
 *
pBlob
;

142746 
nBlob
;

142748 
nBlob
 = (
RåìM©chArg
Ë+ (
nArg
-1)*(
RåìDVÆue
);

142749 
pBlob
 = (
RåìM©chArg
 *)
	`sqlôe3_mÆloc
(
nBlob
);

142750 if–!
pBlob
 ){

142751 
	`sqlôe3_ªsu…_îr‹_nomem
(
˘x
);

142753 
i
;

142754 
pBlob
->
magic
 = 
RTREE_GEOMETRY_MAGIC
;

142755 
pBlob
->
xGeom
 = 
pGeomCtx
->xGeom;

142756 
pBlob
->
pC⁄ãxt
 = 
pGeomCtx
->pContext;

142757 
pBlob
->
nP¨am
 = 
nArg
;

142758 
i
=0; i<
nArg
; i++){

142759 #ifde‡
SQLITE_RTREE_INT_ONLY


142760 
pBlob
->
aP¨am
[
i
] = 
	`sqlôe3_vÆue_öt64
(
aArg
[i]);

142762 
pBlob
->
aP¨am
[
i
] = 
	`sqlôe3_vÆue_doubÀ
(
aArg
[i]);

142765 
	`sqlôe3_ªsu…_blob
(
˘x
, 
pBlob
, 
nBlob
, 
doSqlôe3Fªe
);

142772 
SQLITE_API
 
	`sqlôe3_πªe_geomëry_ˇŒback
(

142773 
sqlôe3
 *
db
,

142774 c⁄° *
zGeom
,

142775 (*
xGeom
)(
sqlôe3_πªe_geomëry
 *, , 
RåìDVÆue
 *, *),

142776 *
pC⁄ãxt


142778 
RåìGeomCÆlback
 *
pGeomCtx
;

142781 
pGeomCtx
 = (
RåìGeomCÆlback
 *)
	`sqlôe3_mÆloc
((RtreeGeomCallback));

142782 if–!
pGeomCtx
 )  
SQLITE_NOMEM
;

142783 
pGeomCtx
->
xGeom
 = xGeom;

142784 
pGeomCtx
->
pC⁄ãxt
 =ÖContext;

142788  
	`sqlôe3_¸óã_fun˘i⁄_v2
(
db
, 
zGeom
, -1, 
SQLITE_ANY
,

142789 (*)
pGeomCtx
, 
geomCÆlback
, 0, 0, 
doSqlôe3Fªe


142793 #i‡!
SQLITE_CORE


142794 #ifde‡
_WIN32


142795 
	`__de˛•ec
(
dŒexp‹t
)

142797 
SQLITE_API
 
	`sqlôe3_πªe_öô
(

142798 
sqlôe3
 *
db
,

142799 **
pzEºMsg
,

142800 c⁄° 
sqlôe3_≠i_routöes
 *
pApi


142802 
	`SQLITE_EXTENSION_INIT2
(
pApi
)

142803  
	`sqlôe3RåìInô
(
db
);

142841 #i‡!
	`deföed
(
SQLITE_CORE
Ë|| deföed(
SQLITE_ENABLE_ICU
)

142844 
	~<unicode/uty≥s.h
>

142845 
	~<unicode/uªgex.h
>

142846 
	~<unicode/u°rög.h
>

142847 
	~<unicode/ucﬁ.h
>

142851 #i‚de‡
SQLITE_CORE


142852 
SQLITE_EXTENSION_INIT1


142860 #i‚de‡
SQLITE_MAX_LIKE_PATTERN_LENGTH


142861 
	#SQLITE_MAX_LIKE_PATTERN_LENGTH
 50000

	)

142867 
	`xFªe
(*
p
){

142868 
	`sqlôe3_‰ì
(
p
);

142876 
	`icuLikeCom∑ª
(

142877 c⁄° 
uöt8_t
 *
zP©ã∫
,

142878 c⁄° 
uöt8_t
 *
zSåög
,

142879 c⁄° 
UCh¨32
 
uEsc


142881 c⁄° 
MATCH_ONE
 = (
UCh¨32
)'_';

142882 c⁄° 
MATCH_ALL
 = (
UCh¨32
)'%';

142884 
iP©ã∫
 = 0;

142885 
iSåög
 = 0;

142887 
¥evEsˇ≥
 = 0;

142889  
zP©ã∫
[
iP©ã∫
]!=0 ){

142892 
UCh¨32
 
uP©ã∫
;

142893 
	`U8_NEXT_UNSAFE
(
zP©ã∫
, 
iP©ã∫
, 
uP©ã∫
);

142894 
	`as£π
(
uP©ã∫
!=0);

142903 if–!
¥evEsˇ≥
 && 
uP©ã∫
==
MATCH_ALL
 ){

142905 
uöt8_t
 
c
;

142911  (
c
=
zP©ã∫
[
iP©ã∫
]Ë=
MATCH_ALL
 || c =
MATCH_ONE
 ){

142912 if–
c
==
MATCH_ONE
 ){

142913 if–
zSåög
[
iSåög
]==0 )  0;

142914 
	`U8_FWD_1_UNSAFE
(
zSåög
, 
iSåög
);

142916 
iP©ã∫
++;

142919 if–
zP©ã∫
[
iP©ã∫
]==0 )  1;

142921  
zSåög
[
iSåög
] ){

142922 if–
	`icuLikeCom∑ª
(&
zP©ã∫
[
iP©ã∫
], &
zSåög
[
iSåög
], 
uEsc
) ){

142925 
	`U8_FWD_1_UNSAFE
(
zSåög
, 
iSåög
);

142929 }if–!
¥evEsˇ≥
 && 
uP©ã∫
==
MATCH_ONE
 ){

142931 if–
zSåög
[
iSåög
]==0 )  0;

142932 
	`U8_FWD_1_UNSAFE
(
zSåög
, 
iSåög
);

142934 }if–!
¥evEsˇ≥
 && 
uP©ã∫
==
uEsc
){

142936 
¥evEsˇ≥
 = 1;

142940 
UCh¨32
 
uSåög
;

142941 
	`U8_NEXT_UNSAFE
(
zSåög
, 
iSåög
, 
uSåög
);

142942 
uSåög
 = 
	`u_fﬁdCa£
(uSåög, 
U_FOLD_CASE_DEFAULT
);

142943 
uP©ã∫
 = 
	`u_fﬁdCa£
(uP©ã∫, 
U_FOLD_CASE_DEFAULT
);

142944 if–
uSåög
!=
uP©ã∫
 ){

142947 
¥evEsˇ≥
 = 0;

142951  
zSåög
[
iSåög
]==0;

142967 
	`icuLikeFunc
(

142968 
sqlôe3_c⁄ãxt
 *
c⁄ãxt
,

142969 
¨gc
,

142970 
sqlôe3_vÆue
 **
¨gv


142972 c⁄° *
zA
 = 
	`sqlôe3_vÆue_ãxt
(
¨gv
[0]);

142973 c⁄° *
zB
 = 
	`sqlôe3_vÆue_ãxt
(
¨gv
[1]);

142974 
UCh¨32
 
uEsc
 = 0;

142979 if–
	`sqlôe3_vÆue_byãs
(
¨gv
[0])>
SQLITE_MAX_LIKE_PATTERN_LENGTH
 ){

142980 
	`sqlôe3_ªsu…_îr‹
(
c⁄ãxt
, "LIKE or GLOBÖatternÅoo complex", -1);

142985 if–
¨gc
==3 ){

142989 
nE

	`sqlôe3_vÆue_byãs
(
¨gv
[2]);

142990 c⁄° *
zE
 = 
	`sqlôe3_vÆue_ãxt
(
¨gv
[2]);

142991 
i
 = 0;

142992 if–
zE
==0 ) ;

142993 
	`U8_NEXT
(
zE
, 
i
, 
nE
, 
uEsc
);

142994 if–
i
!=
nE
){

142995 
	`sqlôe3_ªsu…_îr‹
(
c⁄ãxt
,

143001 if–
zA
 && 
zB
 ){

143002 
	`sqlôe3_ªsu…_öt
(
c⁄ãxt
, 
	`icuLikeCom∑ª
(
zA
, 
zB
, 
uEsc
));

143013 
	`icuFun˘i⁄Eº‹
(

143014 
sqlôe3_c⁄ãxt
 *
pCtx
,

143015 c⁄° *
zName
,

143016 
UEº‹Code
 
e


143018 
zBuf
[128];

143019 
	`sqlôe3_¢¥ötf
(128, 
zBuf
, "ICUÉº‹: %s(): %s", 
zName
, 
	`u_îr‹Name
(
e
));

143020 
zBuf
[127] = '\0';

143021 
	`sqlôe3_ªsu…_îr‹
(
pCtx
, 
zBuf
, -1);

143028 
	`icuRegexpDñëe
(*
p
){

143029 
UReguœrEx¥essi⁄
 *
pEx¥
 = (UReguœrEx¥essi⁄ *)
p
;

143030 
	`uªgex_˛o£
(
pEx¥
);

143052 
	`icuRegexpFunc
(
sqlôe3_c⁄ãxt
 *
p
, 
nArg
, 
sqlôe3_vÆue
 **
≠Arg
){

143053 
UEº‹Code
 
°©us
 = 
U_ZERO_ERROR
;

143054 
UReguœrEx¥essi⁄
 *
pEx¥
;

143055 
UBoﬁ
 
ªs
;

143056 c⁄° 
UCh¨
 *
zSåög
 = 
	`sqlôe3_vÆue_ãxt16
(
≠Arg
[1]);

143058 ()
nArg
;

143063 if–!
zSåög
 ){

143067 
pEx¥
 = 
	`sqlôe3_gë_auxd©a
(
p
, 0);

143068 if–!
pEx¥
 ){

143069 c⁄° 
UCh¨
 *
zP©ã∫
 = 
	`sqlôe3_vÆue_ãxt16
(
≠Arg
[0]);

143070 if–!
zP©ã∫
 ){

143073 
pEx¥
 = 
	`uªgex_›í
(
zP©ã∫
, -1, 0, 0, &
°©us
);

143075 if–
	`U_SUCCESS
(
°©us
) ){

143076 
	`sqlôe3_£t_auxd©a
(
p
, 0, 
pEx¥
, 
icuRegexpDñëe
);

143078 
	`as£π
(!
pEx¥
);

143079 
	`icuFun˘i⁄Eº‹
(
p
, "uªgex_›í", 
°©us
);

143085 
	`uªgex_£tText
(
pEx¥
, 
zSåög
, -1, &
°©us
);

143086 if–!
	`U_SUCCESS
(
°©us
) ){

143087 
	`icuFun˘i⁄Eº‹
(
p
, "uªgex_£tText", 
°©us
);

143092 
ªs
 = 
	`uªgex_m©ches
(
pEx¥
, 0, &
°©us
);

143093 if–!
	`U_SUCCESS
(
°©us
) ){

143094 
	`icuFun˘i⁄Eº‹
(
p
, "uªgex_m©ches", 
°©us
);

143103 
	`uªgex_£tText
(
pEx¥
, 0, 0, &
°©us
);

143106 
	`sqlôe3_ªsu…_öt
(
p
, 
ªs
 ? 1 : 0);

143135 
	`icuCa£Func16
(
sqlôe3_c⁄ãxt
 *
p
, 
nArg
, 
sqlôe3_vÆue
 **
≠Arg
){

143136 c⁄° 
UCh¨
 *
zI≈ut
;

143137 
UCh¨
 *
zOuçut
;

143138 
nI≈ut
;

143139 
nOuçut
;

143141 
UEº‹Code
 
°©us
 = 
U_ZERO_ERROR
;

143142 c⁄° *
zLoˇÀ
 = 0;

143144 
	`as£π
(
nArg
==1 ||ÇArg==2);

143145 if–
nArg
==2 ){

143146 
zLoˇÀ
 = (c⁄° *)
	`sqlôe3_vÆue_ãxt
(
≠Arg
[1]);

143149 
zI≈ut
 = 
	`sqlôe3_vÆue_ãxt16
(
≠Arg
[0]);

143150 if–!
zI≈ut
 ){

143153 
nI≈ut
 = 
	`sqlôe3_vÆue_byãs16
(
≠Arg
[0]);

143155 
nOuçut
 = 
nI≈ut
 * 2 + 2;

143156 
zOuçut
 = 
	`sqlôe3_mÆloc
(
nOuçut
);

143157 if–!
zOuçut
 ){

143161 if–
	`sqlôe3_u£r_d©a
(
p
) ){

143162 
	`u_°rToUµî
(
zOuçut
, 
nOuçut
/2, 
zI≈ut
, 
nI≈ut
/2, 
zLoˇÀ
, &
°©us
);

143164 
	`u_°rToLowî
(
zOuçut
, 
nOuçut
/2, 
zI≈ut
, 
nI≈ut
/2, 
zLoˇÀ
, &
°©us
);

143167 if–!
	`U_SUCCESS
(
°©us
) ){

143168 
	`icuFun˘i⁄Eº‹
(
p
, "u_°rToLowî()/u_°rToUµî", 
°©us
);

143172 
	`sqlôe3_ªsu…_ãxt16
(
p
, 
zOuçut
, -1, 
xFªe
);

143179 
	`icuCﬁœti⁄Dñ
(*
pCtx
){

143180 
UCﬁœt‹
 *
p
 = (UCﬁœt‹ *)
pCtx
;

143181 
	`ucﬁ_˛o£
(
p
);

143188 
	`icuCﬁœti⁄Cﬁl
(

143189 *
pCtx
,

143190 
nLe·
,

143191 c⁄° *
zLe·
,

143192 
nRight
,

143193 c⁄° *
zRight


143195 
UCﬁœti⁄Resu…
 
ªs
;

143196 
UCﬁœt‹
 *
p
 = (UCﬁœt‹ *)
pCtx
;

143197 
ªs
 = 
	`ucﬁ_°rcﬁl
(
p
, (
UCh¨
 *)
zLe·
, 
nLe·
/2, (UCh¨ *)
zRight
, 
nRight
/2);

143198  
ªs
 ){

143199 
UCOL_LESS
:  -1;

143200 
UCOL_GREATER
:  +1;

143201 
UCOL_EQUAL
:  0;

143203 
	`as£π
(!"UnexpectedÑeturn value from ucol_strcoll()");

143220 
	`icuLﬂdCﬁœti⁄
(

143221 
sqlôe3_c⁄ãxt
 *
p
,

143222 
nArg
,

143223 
sqlôe3_vÆue
 **
≠Arg


143225 
sqlôe3
 *
db
 = (sqlôe3 *)
	`sqlôe3_u£r_d©a
(
p
);

143226 
UEº‹Code
 
°©us
 = 
U_ZERO_ERROR
;

143227 c⁄° *
zLoˇÀ
;

143228 c⁄° *
zName
;

143229 
UCﬁœt‹
 *
pUCﬁœt‹
;

143230 
rc
;

143232 
	`as£π
(
nArg
==2);

143233 
zLoˇÀ
 = (c⁄° *)
	`sqlôe3_vÆue_ãxt
(
≠Arg
[0]);

143234 
zName
 = (c⁄° *)
	`sqlôe3_vÆue_ãxt
(
≠Arg
[1]);

143236 if–!
zLoˇÀ
 || !
zName
 ){

143240 
pUCﬁœt‹
 = 
	`ucﬁ_›í
(
zLoˇÀ
, &
°©us
);

143241 if–!
	`U_SUCCESS
(
°©us
) ){

143242 
	`icuFun˘i⁄Eº‹
(
p
, "ucﬁ_›í", 
°©us
);

143245 
	`as£π
(
p
);

143247 
rc
 = 
	`sqlôe3_¸óã_cﬁœti⁄_v2
(
db
, 
zName
, 
SQLITE_UTF16
, (*)
pUCﬁœt‹
,

143248 
icuCﬁœti⁄Cﬁl
, 
icuCﬁœti⁄Dñ


143250 if–
rc
!=
SQLITE_OK
 ){

143251 
	`ucﬁ_˛o£
(
pUCﬁœt‹
);

143252 
	`sqlôe3_ªsu…_îr‹
(
p
, "ErrorÑegistering collation function", -1);

143259 
SQLITE_PRIVATE
 
	`sqlôe3IcuInô
(
sqlôe3
 *
db
){

143260 
	sIcuSˇœr
 {

143261 c⁄° *
zName
;

143262 
nArg
;

143263 
íc
;

143264 *
pC⁄ãxt
;

143265 (*
xFunc
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
**);

143266 } 
sˇœrs
[] = {

143267 {"ªgexp", 2, 
SQLITE_ANY
, 0, 
icuRegexpFunc
},

143269 {"lowî", 1, 
SQLITE_UTF16
, 0, 
icuCa£Func16
},

143270 {"lowî", 2, 
SQLITE_UTF16
, 0, 
icuCa£Func16
},

143271 {"uµî", 1, 
SQLITE_UTF16
, (*)1, 
icuCa£Func16
},

143272 {"uµî", 2, 
SQLITE_UTF16
, (*)1, 
icuCa£Func16
},

143274 {"lowî", 1, 
SQLITE_UTF8
, 0, 
icuCa£Func16
},

143275 {"lowî", 2, 
SQLITE_UTF8
, 0, 
icuCa£Func16
},

143276 {"uµî", 1, 
SQLITE_UTF8
, (*)1, 
icuCa£Func16
},

143277 {"uµî", 2, 
SQLITE_UTF8
, (*)1, 
icuCa£Func16
},

143279 {"like", 2, 
SQLITE_UTF8
, 0, 
icuLikeFunc
},

143280 {"like", 3, 
SQLITE_UTF8
, 0, 
icuLikeFunc
},

143282 {"icu_lﬂd_cﬁœti⁄", 2, 
SQLITE_UTF8
, (*)
db
, 
icuLﬂdCﬁœti⁄
},

143285 
rc
 = 
SQLITE_OK
;

143286 
i
;

143288 
i
=0; 
rc
==
SQLITE_OK
 && i<()((
sˇœrs
)/(scalars[0])); i++){

143289 
IcuSˇœr
 *
p
 = &
sˇœrs
[
i
];

143290 
rc
 = 
	`sqlôe3_¸óã_fun˘i⁄
(

143291 
db
, 
p
->
zName
,Ö->
nArg
,Ö->
íc
,Ö->
pC⁄ãxt
,Ö->
xFunc
, 0, 0

143295  
rc
;

143298 #i‡!
SQLITE_CORE


143299 #ifde‡
_WIN32


143300 
	`__de˛•ec
(
dŒexp‹t
)

143302 
SQLITE_API
 
	`sqlôe3_icu_öô
(

143303 
sqlôe3
 *
db
,

143304 **
pzEºMsg
,

143305 c⁄° 
sqlôe3_≠i_routöes
 *
pApi


143307 
	`SQLITE_EXTENSION_INIT2
(
pApi
)

143308  
	`sqlôe3IcuInô
(
db
);

143329 #i‡!
	`deföed
(
SQLITE_CORE
Ë|| deföed(
SQLITE_ENABLE_FTS3
)

143330 #ifde‡
SQLITE_ENABLE_ICU


143335 
	~<unicode/ubrk.h
>

143338 
	~<unicode/utf16.h
>

143340 
IcuTokíizî
 
	tIcuTokíizî
;

143341 
IcuCurs‹
 
	tIcuCurs‹
;

143343 
	sIcuTokíizî
 {

143344 
sqlôe3_tokíizî
 
ba£
;

143345 *
zLoˇÀ
;

143348 
	sIcuCurs‹
 {

143349 
sqlôe3_tokíizî_curs‹
 
ba£
;

143351 
UBªakIãøt‹
 *
pIãr
;

143352 
nCh¨
;

143353 
UCh¨
 *
aCh¨
;

143354 *
aOff£t
;

143356 
nBuf„r
;

143357 *
zBuf„r
;

143359 
iTokí
;

143365 
	`icuCª©e
(

143366 
¨gc
,

143367 c⁄° * c⁄° *
¨gv
,

143368 
sqlôe3_tokíizî
 **
µTokíizî


143370 
IcuTokíizî
 *
p
;

143371 
n
 = 0;

143373 if–
¨gc
>0 ){

143374 
n
 = 
	`°æí
(
¨gv
[0])+1;

143376 
p
 = (
IcuTokíizî
 *)
	`sqlôe3_mÆloc
((IcuTokíizî)+
n
);

143377 if–!
p
 ){

143378  
SQLITE_NOMEM
;

143380 
	`mem£t
(
p
, 0, (
IcuTokíizî
));

143382 if–
n
 ){

143383 
p
->
zLoˇÀ
 = (*)&p[1];

143384 
	`mem˝y
(
p
->
zLoˇÀ
, 
¨gv
[0], 
n
);

143387 *
µTokíizî
 = (
sqlôe3_tokíizî
 *)
p
;

143389  
SQLITE_OK
;

143395 
	`icuDe°roy
(
sqlôe3_tokíizî
 *
pTokíizî
){

143396 
IcuTokíizî
 *
p
 = (IcuTokíizî *)
pTokíizî
;

143397 
	`sqlôe3_‰ì
(
p
);

143398  
SQLITE_OK
;

143407 
	`icuO≥n
(

143408 
sqlôe3_tokíizî
 *
pTokíizî
,

143409 c⁄° *
zI≈ut
,

143410 
nI≈ut
,

143411 
sqlôe3_tokíizî_curs‹
 **
µCurs‹


143413 
IcuTokíizî
 *
p
 = (IcuTokíizî *)
pTokíizî
;

143414 
IcuCurs‹
 *
pC§
;

143416 c⁄° 
öt32_t
 
›t
 = 
U_FOLD_CASE_DEFAULT
;

143417 
UEº‹Code
 
°©us
 = 
U_ZERO_ERROR
;

143418 
nCh¨
;

143420 
UCh¨32
 
c
;

143421 
iI≈ut
 = 0;

143422 
iOut
 = 0;

143424 *
µCurs‹
 = 0;

143426 if–
zI≈ut
==0 ){

143427 
nI≈ut
 = 0;

143428 
zI≈ut
 = "";

143429 }if–
nI≈ut
<0 ){

143430 
nI≈ut
 = 
	`°æí
(
zI≈ut
);

143432 
nCh¨
 = 
nI≈ut
+1;

143433 
pC§
 = (
IcuCurs‹
 *)
	`sqlôe3_mÆloc
(

143434 (
IcuCurs‹
) +

143435 ((
nCh¨
+3)&~3Ë* (
UCh¨
) +

143436 (
nCh¨
+1) * ()

143438 if–!
pC§
 ){

143439  
SQLITE_NOMEM
;

143441 
	`mem£t
(
pC§
, 0, (
IcuCurs‹
));

143442 
pC§
->
aCh¨
 = (
UCh¨
 *)&pCsr[1];

143443 
pC§
->
aOff£t
 = (*)&pC§->
aCh¨
[(
nCh¨
+3)&~3];

143445 
pC§
->
aOff£t
[
iOut
] = 
iI≈ut
;

143446 
	`U8_NEXT
(
zI≈ut
, 
iI≈ut
, 
nI≈ut
, 
c
);

143447  
c
>0 ){

143448 
isEº‹
 = 0;

143449 
c
 = 
	`u_fﬁdCa£
(c, 
›t
);

143450 
	`U16_APPEND
(
pC§
->
aCh¨
, 
iOut
, 
nCh¨
, 
c
, 
isEº‹
);

143451 if–
isEº‹
 ){

143452 
	`sqlôe3_‰ì
(
pC§
);

143453  
SQLITE_ERROR
;

143455 
pC§
->
aOff£t
[
iOut
] = 
iI≈ut
;

143457 if–
iI≈ut
<
nI≈ut
 ){

143458 
	`U8_NEXT
(
zI≈ut
, 
iI≈ut
, 
nI≈ut
, 
c
);

143460 
c
 = 0;

143464 
pC§
->
pIãr
 = 
	`ubrk_›í
(
UBRK_WORD
, 
p
->
zLoˇÀ
,ÖC§->
aCh¨
, 
iOut
, &
°©us
);

143465 if–!
	`U_SUCCESS
(
°©us
) ){

143466 
	`sqlôe3_‰ì
(
pC§
);

143467  
SQLITE_ERROR
;

143469 
pC§
->
nCh¨
 = 
iOut
;

143471 
	`ubrk_fú°
(
pC§
->
pIãr
);

143472 *
µCurs‹
 = (
sqlôe3_tokíizî_curs‹
 *)
pC§
;

143473  
SQLITE_OK
;

143479 
	`icuClo£
(
sqlôe3_tokíizî_curs‹
 *
pCurs‹
){

143480 
IcuCurs‹
 *
pC§
 = (IcuCurs‹ *)
pCurs‹
;

143481 
	`ubrk_˛o£
(
pC§
->
pIãr
);

143482 
	`sqlôe3_‰ì
(
pC§
->
zBuf„r
);

143483 
	`sqlôe3_‰ì
(
pC§
);

143484  
SQLITE_OK
;

143490 
	`icuNext
(

143491 
sqlôe3_tokíizî_curs‹
 *
pCurs‹
,

143492 c⁄° **
µTokí
,

143493 *
≤Byãs
,

143494 *
piSèπOff£t
,

143495 *
piEndOff£t
,

143496 *
piPosôi⁄


143498 
IcuCurs‹
 *
pC§
 = (IcuCurs‹ *)
pCurs‹
;

143500 
iSèπ
 = 0;

143501 
iEnd
 = 0;

143502 
nByã
 = 0;

143504  
iSèπ
==
iEnd
 ){

143505 
UCh¨32
 
c
;

143507 
iSèπ
 = 
	`ubrk_cuºít
(
pC§
->
pIãr
);

143508 
iEnd
 = 
	`ubrk_√xt
(
pC§
->
pIãr
);

143509 if–
iEnd
==
UBRK_DONE
 ){

143510  
SQLITE_DONE
;

143513  
iSèπ
<
iEnd
 ){

143514 
iWhôe
 = 
iSèπ
;

143515 
	`U16_NEXT
(
pC§
->
aCh¨
, 
iWhôe
,ÖC§->
nCh¨
, 
c
);

143516 if–
	`u_is•a˚
(
c
) ){

143517 
iSèπ
 = 
iWhôe
;

143522 
	`as£π
(
iSèπ
<=
iEnd
);

143526 
UEº‹Code
 
°©us
 = 
U_ZERO_ERROR
;

143527 if–
nByã
 ){

143528 *
zNew
 = 
	`sqlôe3_ªÆloc
(
pC§
->
zBuf„r
, 
nByã
);

143529 if–!
zNew
 ){

143530  
SQLITE_NOMEM
;

143532 
pC§
->
zBuf„r
 = 
zNew
;

143533 
pC§
->
nBuf„r
 = 
nByã
;

143536 
	`u_°rToUTF8
(

143537 
pC§
->
zBuf„r
,ÖC§->
nBuf„r
, &
nByã
,

143538 &
pC§
->
aCh¨
[
iSèπ
], 
iEnd
-iStart,

143539 &
°©us


143541 }  
nByã
>
pC§
->
nBuf„r
 );

143543 *
µTokí
 = 
pC§
->
zBuf„r
;

143544 *
≤Byãs
 = 
nByã
;

143545 *
piSèπOff£t
 = 
pC§
->
aOff£t
[
iSèπ
];

143546 *
piEndOff£t
 = 
pC§
->
aOff£t
[
iEnd
];

143547 *
piPosôi⁄
 = 
pC§
->
iTokí
++;

143549  
SQLITE_OK
;

143555 c⁄° 
sqlôe3_tokíizî_moduÀ
 
icuTokíizîModuÀ
 = {

143557 
icuCª©e
,

143558 
icuDe°roy
,

143559 
icuO≥n
,

143560 
icuClo£
,

143561 
icuNext
,

143567 
SQLITE_PRIVATE
 
	`sqlôe3Fts3IcuTokíizîModuÀ
(

143568 
sqlôe3_tokíizî_moduÀ
 c⁄°**
µModuÀ


143570 *
µModuÀ
 = &
icuTokíizîModuÀ
;

	@sqlite3.h

33 #i‚de‡
_SQLITE3_H_


34 
	#_SQLITE3_H_


	)

35 
	~<°d¨g.h
>

40 #ifde‡
__˝lu•lus


48 #i‚de‡
SQLITE_EXTERN


49 
	#SQLITE_EXTERN
 

	)

52 #i‚de‡
SQLITE_API


53 
	#SQLITE_API


	)

70 
	#SQLITE_DEPRECATED


	)

71 
	#SQLITE_EXPERIMENTAL


	)

76 #ifde‡
SQLITE_VERSION


77 #unde‡
SQLITE_VERSION


79 #ifde‡
SQLITE_VERSION_NUMBER


80 #unde‡
SQLITE_VERSION_NUMBER


110 
	#SQLITE_VERSION
 "3.8.1"

	)

111 
	#SQLITE_VERSION_NUMBER
 3008001

	)

112 
	#SQLITE_SOURCE_ID
 "2013-10-17 12:57:35 c78be6d786c19073b3a6730d„3fb1be54f5657a"

	)

144 
SQLITE_API
 
SQLITE_EXTERN
 c⁄° 
sqlôe3_vîsi⁄
[];

145 
SQLITE_API
 c⁄° *
sqlôe3_libvîsi⁄
();

146 
SQLITE_API
 c⁄° *
sqlôe3_sour˚id
();

147 
SQLITE_API
 
sqlôe3_libvîsi⁄_numbî
();

171 #i‚de‡
SQLITE_OMIT_COMPILEOPTION_DIAGS


172 
SQLITE_API
 
sqlôe3_compûe›ti⁄_u£d
(c⁄° *
zO±Name
);

173 
SQLITE_API
 c⁄° *
sqlôe3_compûe›ti⁄_gë
(
N
);

212 
SQLITE_API
 
sqlôe3_thªadß„
();

228 
sqlôe3
 
	tsqlôe3
;

246 #ifde‡
SQLITE_INT64_TYPE


247 
SQLITE_INT64_TYPE
 
	tsqlôe_öt64
;

248 
	tSQLITE_INT64_TYPE
 
	tsqlôe_uöt64
;

249 #ñi‡
deföed
(
_MSC_VER
Ë|| deföed(
__BORLANDC__
)

250 
__öt64
 
	tsqlôe_öt64
;

251 
	t__öt64
 
	tsqlôe_uöt64
;

253 
	tsqlôe_öt64
;

254 
	tsqlôe_uöt64
;

256 
sqlôe_öt64
 
	tsqlôe3_öt64
;

257 
sqlôe_uöt64
 
	tsqlôe3_uöt64
;

263 #ifde‡
SQLITE_OMIT_FLOATING_POINT


264 
sqlôe3_öt64


	)

308 
SQLITE_API
 
sqlôe3_˛o£
(
sqlôe3
*);

309 
SQLITE_API
 
sqlôe3_˛o£_v2
(
sqlôe3
*);

316 (*
sqlôe3_ˇŒback
)(*,,**, **);

379 
SQLITE_API
 
sqlôe3_exec
(

380 
sqlôe3
*,

381 c⁄° *
sql
,

382 (*
ˇŒback
)(*,,**,**),

384 **
îrmsg


400 
	#SQLITE_OK
 0

	)

402 
	#SQLITE_ERROR
 1

	)

403 
	#SQLITE_INTERNAL
 2

	)

404 
	#SQLITE_PERM
 3

	)

405 
	#SQLITE_ABORT
 4

	)

406 
	#SQLITE_BUSY
 5

	)

407 
	#SQLITE_LOCKED
 6

	)

408 
	#SQLITE_NOMEM
 7

	)

409 
	#SQLITE_READONLY
 8

	)

410 
	#SQLITE_INTERRUPT
 9

	)

411 
	#SQLITE_IOERR
 10

	)

412 
	#SQLITE_CORRUPT
 11

	)

413 
	#SQLITE_NOTFOUND
 12

	)

414 
	#SQLITE_FULL
 13

	)

415 
	#SQLITE_CANTOPEN
 14

	)

416 
	#SQLITE_PROTOCOL
 15

	)

417 
	#SQLITE_EMPTY
 16

	)

418 
	#SQLITE_SCHEMA
 17

	)

419 
	#SQLITE_TOOBIG
 18

	)

420 
	#SQLITE_CONSTRAINT
 19

	)

421 
	#SQLITE_MISMATCH
 20

	)

422 
	#SQLITE_MISUSE
 21

	)

423 
	#SQLITE_NOLFS
 22

	)

424 
	#SQLITE_AUTH
 23

	)

425 
	#SQLITE_FORMAT
 24

	)

426 
	#SQLITE_RANGE
 25

	)

427 
	#SQLITE_NOTADB
 26

	)

428 
	#SQLITE_NOTICE
 27

	)

429 
	#SQLITE_WARNING
 28

	)

430 
	#SQLITE_ROW
 100

	)

431 
	#SQLITE_DONE
 101

	)

457 
	#SQLITE_IOERR_READ
 (
SQLITE_IOERR
 | (1<<8))

	)

458 
	#SQLITE_IOERR_SHORT_READ
 (
SQLITE_IOERR
 | (2<<8))

	)

459 
	#SQLITE_IOERR_WRITE
 (
SQLITE_IOERR
 | (3<<8))

	)

460 
	#SQLITE_IOERR_FSYNC
 (
SQLITE_IOERR
 | (4<<8))

	)

461 
	#SQLITE_IOERR_DIR_FSYNC
 (
SQLITE_IOERR
 | (5<<8))

	)

462 
	#SQLITE_IOERR_TRUNCATE
 (
SQLITE_IOERR
 | (6<<8))

	)

463 
	#SQLITE_IOERR_FSTAT
 (
SQLITE_IOERR
 | (7<<8))

	)

464 
	#SQLITE_IOERR_UNLOCK
 (
SQLITE_IOERR
 | (8<<8))

	)

465 
	#SQLITE_IOERR_RDLOCK
 (
SQLITE_IOERR
 | (9<<8))

	)

466 
	#SQLITE_IOERR_DELETE
 (
SQLITE_IOERR
 | (10<<8))

	)

467 
	#SQLITE_IOERR_BLOCKED
 (
SQLITE_IOERR
 | (11<<8))

	)

468 
	#SQLITE_IOERR_NOMEM
 (
SQLITE_IOERR
 | (12<<8))

	)

469 
	#SQLITE_IOERR_ACCESS
 (
SQLITE_IOERR
 | (13<<8))

	)

470 
	#SQLITE_IOERR_CHECKRESERVEDLOCK
 (
SQLITE_IOERR
 | (14<<8))

	)

471 
	#SQLITE_IOERR_LOCK
 (
SQLITE_IOERR
 | (15<<8))

	)

472 
	#SQLITE_IOERR_CLOSE
 (
SQLITE_IOERR
 | (16<<8))

	)

473 
	#SQLITE_IOERR_DIR_CLOSE
 (
SQLITE_IOERR
 | (17<<8))

	)

474 
	#SQLITE_IOERR_SHMOPEN
 (
SQLITE_IOERR
 | (18<<8))

	)

475 
	#SQLITE_IOERR_SHMSIZE
 (
SQLITE_IOERR
 | (19<<8))

	)

476 
	#SQLITE_IOERR_SHMLOCK
 (
SQLITE_IOERR
 | (20<<8))

	)

477 
	#SQLITE_IOERR_SHMMAP
 (
SQLITE_IOERR
 | (21<<8))

	)

478 
	#SQLITE_IOERR_SEEK
 (
SQLITE_IOERR
 | (22<<8))

	)

479 
	#SQLITE_IOERR_DELETE_NOENT
 (
SQLITE_IOERR
 | (23<<8))

	)

480 
	#SQLITE_IOERR_MMAP
 (
SQLITE_IOERR
 | (24<<8))

	)

481 
	#SQLITE_IOERR_GETTEMPPATH
 (
SQLITE_IOERR
 | (25<<8))

	)

482 
	#SQLITE_IOERR_CONVPATH
 (
SQLITE_IOERR
 | (26<<8))

	)

483 
	#SQLITE_LOCKED_SHAREDCACHE
 (
SQLITE_LOCKED
 | (1<<8))

	)

484 
	#SQLITE_BUSY_RECOVERY
 (
SQLITE_BUSY
 | (1<<8))

	)

485 
	#SQLITE_BUSY_SNAPSHOT
 (
SQLITE_BUSY
 | (2<<8))

	)

486 
	#SQLITE_CANTOPEN_NOTEMPDIR
 (
SQLITE_CANTOPEN
 | (1<<8))

	)

487 
	#SQLITE_CANTOPEN_ISDIR
 (
SQLITE_CANTOPEN
 | (2<<8))

	)

488 
	#SQLITE_CANTOPEN_FULLPATH
 (
SQLITE_CANTOPEN
 | (3<<8))

	)

489 
	#SQLITE_CANTOPEN_CONVPATH
 (
SQLITE_CANTOPEN
 | (4<<8))

	)

490 
	#SQLITE_CORRUPT_VTAB
 (
SQLITE_CORRUPT
 | (1<<8))

	)

491 
	#SQLITE_READONLY_RECOVERY
 (
SQLITE_READONLY
 | (1<<8))

	)

492 
	#SQLITE_READONLY_CANTLOCK
 (
SQLITE_READONLY
 | (2<<8))

	)

493 
	#SQLITE_READONLY_ROLLBACK
 (
SQLITE_READONLY
 | (3<<8))

	)

494 
	#SQLITE_ABORT_ROLLBACK
 (
SQLITE_ABORT
 | (2<<8))

	)

495 
	#SQLITE_CONSTRAINT_CHECK
 (
SQLITE_CONSTRAINT
 | (1<<8))

	)

496 
	#SQLITE_CONSTRAINT_COMMITHOOK
 (
SQLITE_CONSTRAINT
 | (2<<8))

	)

497 
	#SQLITE_CONSTRAINT_FOREIGNKEY
 (
SQLITE_CONSTRAINT
 | (3<<8))

	)

498 
	#SQLITE_CONSTRAINT_FUNCTION
 (
SQLITE_CONSTRAINT
 | (4<<8))

	)

499 
	#SQLITE_CONSTRAINT_NOTNULL
 (
SQLITE_CONSTRAINT
 | (5<<8))

	)

500 
	#SQLITE_CONSTRAINT_PRIMARYKEY
 (
SQLITE_CONSTRAINT
 | (6<<8))

	)

501 
	#SQLITE_CONSTRAINT_TRIGGER
 (
SQLITE_CONSTRAINT
 | (7<<8))

	)

502 
	#SQLITE_CONSTRAINT_UNIQUE
 (
SQLITE_CONSTRAINT
 | (8<<8))

	)

503 
	#SQLITE_CONSTRAINT_VTAB
 (
SQLITE_CONSTRAINT
 | (9<<8))

	)

504 
	#SQLITE_NOTICE_RECOVER_WAL
 (
SQLITE_NOTICE
 | (1<<8))

	)

505 
	#SQLITE_NOTICE_RECOVER_ROLLBACK
 (
SQLITE_NOTICE
 | (2<<8))

	)

506 
	#SQLITE_WARNING_AUTOINDEX
 (
SQLITE_WARNING
 | (1<<8))

	)

515 
	#SQLITE_OPEN_READONLY
 0x00000001

	)

516 
	#SQLITE_OPEN_READWRITE
 0x00000002

	)

517 
	#SQLITE_OPEN_CREATE
 0x00000004

	)

518 
	#SQLITE_OPEN_DELETEONCLOSE
 0x00000008

	)

519 
	#SQLITE_OPEN_EXCLUSIVE
 0x00000010

	)

520 
	#SQLITE_OPEN_AUTOPROXY
 0x00000020

	)

521 
	#SQLITE_OPEN_URI
 0x00000040

	)

522 
	#SQLITE_OPEN_MEMORY
 0x00000080

	)

523 
	#SQLITE_OPEN_MAIN_DB
 0x00000100

	)

524 
	#SQLITE_OPEN_TEMP_DB
 0x00000200

	)

525 
	#SQLITE_OPEN_TRANSIENT_DB
 0x00000400

	)

526 
	#SQLITE_OPEN_MAIN_JOURNAL
 0x00000800

	)

527 
	#SQLITE_OPEN_TEMP_JOURNAL
 0x00001000

	)

528 
	#SQLITE_OPEN_SUBJOURNAL
 0x00002000

	)

529 
	#SQLITE_OPEN_MASTER_JOURNAL
 0x00004000

	)

530 
	#SQLITE_OPEN_NOMUTEX
 0x00008000

	)

531 
	#SQLITE_OPEN_FULLMUTEX
 0x00010000

	)

532 
	#SQLITE_OPEN_SHAREDCACHE
 0x00020000

	)

533 
	#SQLITE_OPEN_PRIVATECACHE
 0x00040000

	)

534 
	#SQLITE_OPEN_WAL
 0x00080000

	)

562 
	#SQLITE_IOCAP_ATOMIC
 0x00000001

	)

563 
	#SQLITE_IOCAP_ATOMIC512
 0x00000002

	)

564 
	#SQLITE_IOCAP_ATOMIC1K
 0x00000004

	)

565 
	#SQLITE_IOCAP_ATOMIC2K
 0x00000008

	)

566 
	#SQLITE_IOCAP_ATOMIC4K
 0x00000010

	)

567 
	#SQLITE_IOCAP_ATOMIC8K
 0x00000020

	)

568 
	#SQLITE_IOCAP_ATOMIC16K
 0x00000040

	)

569 
	#SQLITE_IOCAP_ATOMIC32K
 0x00000080

	)

570 
	#SQLITE_IOCAP_ATOMIC64K
 0x00000100

	)

571 
	#SQLITE_IOCAP_SAFE_APPEND
 0x00000200

	)

572 
	#SQLITE_IOCAP_SEQUENTIAL
 0x00000400

	)

573 
	#SQLITE_IOCAP_UNDELETABLE_WHEN_OPEN
 0x00000800

	)

574 
	#SQLITE_IOCAP_POWERSAFE_OVERWRITE
 0x00001000

	)

583 
	#SQLITE_LOCK_NONE
 0

	)

584 
	#SQLITE_LOCK_SHARED
 1

	)

585 
	#SQLITE_LOCK_RESERVED
 2

	)

586 
	#SQLITE_LOCK_PENDING
 3

	)

587 
	#SQLITE_LOCK_EXCLUSIVE
 4

	)

615 
	#SQLITE_SYNC_NORMAL
 0x00002

	)

616 
	#SQLITE_SYNC_FULL
 0x00003

	)

617 
	#SQLITE_SYNC_DATAONLY
 0x00010

	)

630 
sqlôe3_fûe
 
	tsqlôe3_fûe
;

631 
	ssqlôe3_fûe
 {

632 c⁄° 
sqlôe3_io_mëhods
 *
pMëhods
;

725 
sqlôe3_io_mëhods
 
	tsqlôe3_io_mëhods
;

726 
	ssqlôe3_io_mëhods
 {

727 
iVîsi⁄
;

728 (*
xClo£
)(
sqlôe3_fûe
*);

729 (*
xRód
)(
sqlôe3_fûe
*, *, 
iAmt
, 
sqlôe3_öt64
 
iOf°
);

730 (*
xWrôe
)(
sqlôe3_fûe
*, c⁄° *, 
iAmt
, 
sqlôe3_öt64
 
iOf°
);

731 (*
xTrunˇã
)(
sqlôe3_fûe
*, 
sqlôe3_öt64
 
size
);

732 (*
xSync
)(
sqlôe3_fûe
*, 
Êags
);

733 (*
xFûeSize
)(
sqlôe3_fûe
*, 
sqlôe3_öt64
 *
pSize
);

734 (*
xLock
)(
sqlôe3_fûe
*, );

735 (*
xU∆ock
)(
sqlôe3_fûe
*, );

736 (*
xCheckRe£rvedLock
)(
sqlôe3_fûe
*, *
pResOut
);

737 (*
xFûeC⁄åﬁ
)(
sqlôe3_fûe
*, 
›
, *
pArg
);

738 (*
xSe˘‹Size
)(
sqlôe3_fûe
*);

739 (*
xDevi˚Ch¨a˘îi°ics
)(
sqlôe3_fûe
*);

741 (*
xShmM≠
)(
sqlôe3_fûe
*, 
iPg
, 
pgsz
, , volatile**);

742 (*
xShmLock
)(
sqlôe3_fûe
*, 
off£t
, 
n
, 
Êags
);

743 (*
xShmB¨rõr
)(
sqlôe3_fûe
*);

744 (*
xShmUnm≠
)(
sqlôe3_fûe
*, 
dñëeFœg
);

746 (*
xFëch
)(
sqlôe3_fûe
*, 
sqlôe3_öt64
 
iOf°
, 
iAmt
, **
µ
);

747 (*
xUn„tch
)(
sqlôe3_fûe
*, 
sqlôe3_öt64
 
iOf°
, *
p
);

917 
	#SQLITE_FCNTL_LOCKSTATE
 1

	)

918 
	#SQLITE_GET_LOCKPROXYFILE
 2

	)

919 
	#SQLITE_SET_LOCKPROXYFILE
 3

	)

920 
	#SQLITE_LAST_ERRNO
 4

	)

921 
	#SQLITE_FCNTL_SIZE_HINT
 5

	)

922 
	#SQLITE_FCNTL_CHUNK_SIZE
 6

	)

923 
	#SQLITE_FCNTL_FILE_POINTER
 7

	)

924 
	#SQLITE_FCNTL_SYNC_OMITTED
 8

	)

925 
	#SQLITE_FCNTL_WIN32_AV_RETRY
 9

	)

926 
	#SQLITE_FCNTL_PERSIST_WAL
 10

	)

927 
	#SQLITE_FCNTL_OVERWRITE
 11

	)

928 
	#SQLITE_FCNTL_VFSNAME
 12

	)

929 
	#SQLITE_FCNTL_POWERSAFE_OVERWRITE
 13

	)

930 
	#SQLITE_FCNTL_PRAGMA
 14

	)

931 
	#SQLITE_FCNTL_BUSYHANDLER
 15

	)

932 
	#SQLITE_FCNTL_TEMPFILENAME
 16

	)

933 
	#SQLITE_FCNTL_MMAP_SIZE
 18

	)

945 
sqlôe3_muãx
 
	tsqlôe3_muãx
;

1104 
sqlôe3_vfs
 
	tsqlôe3_vfs
;

1105 (*
sqlôe3_sysˇŒ_±r
)();

1106 
	ssqlôe3_vfs
 {

1107 
iVîsi⁄
;

1108 
szOsFûe
;

1109 
mxP©h«me
;

1110 
sqlôe3_vfs
 *
pNext
;

1111 c⁄° *
zName
;

1112 *
pAµD©a
;

1113 (*
xO≥n
)(
sqlôe3_vfs
*, c⁄° *
zName
, 
sqlôe3_fûe
*,

1114 
Êags
, *
pOutFœgs
);

1115 (*
xDñëe
)(
sqlôe3_vfs
*, c⁄° *
zName
, 
syncDú
);

1116 (*
xAc˚ss
)(
sqlôe3_vfs
*, c⁄° *
zName
, 
Êags
, *
pResOut
);

1117 (*
xFuŒP©h«me
)(
sqlôe3_vfs
*, c⁄° *
zName
, 
nOut
, *
zOut
);

1118 *(*
xDlO≥n
)(
sqlôe3_vfs
*, c⁄° *
zFûíame
);

1119 (*
xDlEº‹
)(
sqlôe3_vfs
*, 
nByã
, *
zEºMsg
);

1120 (*(*
xDlSym
)(
sqlôe3_vfs
*,*, c⁄° *
zSymbﬁ
))();

1121 (*
xDlClo£
)(
sqlôe3_vfs
*, *);

1122 (*
xR™dom√ss
)(
sqlôe3_vfs
*, 
nByã
, *
zOut
);

1123 (*
xSÀï
)(
sqlôe3_vfs
*, 
mi¸o£c⁄ds
);

1124 (*
xCuºítTime
)(
sqlôe3_vfs
*, *);

1125 (*
xGëLa°Eº‹
)(
sqlôe3_vfs
*, , *);

1130 (*
xCuºítTimeI¡64
)(
sqlôe3_vfs
*, 
sqlôe3_öt64
*);

1135 (*
xSëSy°emCÆl
)(
sqlôe3_vfs
*, c⁄° *
zName
, 
sqlôe3_sysˇŒ_±r
);

1136 
sqlôe3_sysˇŒ_±r
 (*
xGëSy°emCÆl
)(
sqlôe3_vfs
*, c⁄° *
zName
);

1137 c⁄° *(*
xNextSy°emCÆl
)(
sqlôe3_vfs
*, c⁄° *
zName
);

1165 
	#SQLITE_ACCESS_EXISTS
 0

	)

1166 
	#SQLITE_ACCESS_READWRITE
 1

	)

1167 
	#SQLITE_ACCESS_READ
 2

	)

1191 
	#SQLITE_SHM_UNLOCK
 1

	)

1192 
	#SQLITE_SHM_LOCK
 2

	)

1193 
	#SQLITE_SHM_SHARED
 4

	)

1194 
	#SQLITE_SHM_EXCLUSIVE
 8

	)

1204 
	#SQLITE_SHM_NLOCK
 8

	)

1282 
SQLITE_API
 
sqlôe3_öôülize
();

1283 
SQLITE_API
 
sqlôe3_shutdown
();

1284 
SQLITE_API
 
sqlôe3_os_öô
();

1285 
SQLITE_API
 
sqlôe3_os_íd
();

1316 
SQLITE_API
 
sqlôe3_c⁄fig
(, ...);

1334 
SQLITE_API
 
sqlôe3_db_c⁄fig
(
sqlôe3
*, 
›
, ...);

1399 
sqlôe3_mem_mëhods
 
	tsqlôe3_mem_mëhods
;

1400 
	ssqlôe3_mem_mëhods
 {

1401 *(*
xMÆloc
)();

1402 (*
xFªe
)(*);

1403 *(*
xRóŒoc
)(*,);

1404 (*
xSize
)(*);

1405 (*
xRoundup
)();

1406 (*
xInô
)(*);

1407 (*
xShutdown
)(*);

1408 *
pAµD©a
;

1682 
	#SQLITE_CONFIG_SINGLETHREAD
 1

	)

1683 
	#SQLITE_CONFIG_MULTITHREAD
 2

	)

1684 
	#SQLITE_CONFIG_SERIALIZED
 3

	)

1685 
	#SQLITE_CONFIG_MALLOC
 4

	)

1686 
	#SQLITE_CONFIG_GETMALLOC
 5

	)

1687 
	#SQLITE_CONFIG_SCRATCH
 6

	)

1688 
	#SQLITE_CONFIG_PAGECACHE
 7

	)

1689 
	#SQLITE_CONFIG_HEAP
 8

	)

1690 
	#SQLITE_CONFIG_MEMSTATUS
 9

	)

1691 
	#SQLITE_CONFIG_MUTEX
 10

	)

1692 
	#SQLITE_CONFIG_GETMUTEX
 11

	)

1694 
	#SQLITE_CONFIG_LOOKASIDE
 13

	)

1695 
	#SQLITE_CONFIG_PCACHE
 14

	)

1696 
	#SQLITE_CONFIG_GETPCACHE
 15

	)

1697 
	#SQLITE_CONFIG_LOG
 16

	)

1698 
	#SQLITE_CONFIG_URI
 17

	)

1699 
	#SQLITE_CONFIG_PCACHE2
 18

	)

1700 
	#SQLITE_CONFIG_GETPCACHE2
 19

	)

1701 
	#SQLITE_CONFIG_COVERING_INDEX_SCAN
 20

	)

1702 
	#SQLITE_CONFIG_SQLLOG
 21

	)

1703 
	#SQLITE_CONFIG_MMAP_SIZE
 22

	)

1763 
	#SQLITE_DBCONFIG_LOOKASIDE
 1001

	)

1764 
	#SQLITE_DBCONFIG_ENABLE_FKEY
 1002

	)

1765 
	#SQLITE_DBCONFIG_ENABLE_TRIGGER
 1003

	)

1775 
SQLITE_API
 
sqlôe3_exãnded_ªsu…_codes
(
sqlôe3
*, 
⁄off
);

1824 
SQLITE_API
 
sqlôe3_öt64
 
sqlôe3_œ°_ö£π_rowid
(
sqlôe3
*);

1878 
SQLITE_API
 
sqlôe3_ch™ges
(
sqlôe3
*);

1904 
SQLITE_API
 
sqlôe3_tŸÆ_ch™ges
(
sqlôe3
*);

1943 
SQLITE_API
 
sqlôe3_öãºu±
(
sqlôe3
*);

1978 
SQLITE_API
 
sqlôe3_com∂ëe
(c⁄° *
sql
);

1979 
SQLITE_API
 
sqlôe3_com∂ëe16
(c⁄° *
sql
);

2045 
SQLITE_API
 
sqlôe3_busy_h™dÀr
(
sqlôe3
*, (*)(*,), *);

2065 
SQLITE_API
 
sqlôe3_busy_timeout
(
sqlôe3
*, 
ms
);

2139 
SQLITE_API
 
sqlôe3_gë_èbÀ
(

2140 
sqlôe3
 *
db
,

2141 c⁄° *
zSql
,

2142 ***
∑zResu…
,

2143 *
≤Row
,

2144 *
≤Cﬁumn
,

2145 **
pzEºmsg


2147 
SQLITE_API
 
sqlôe3_‰ì_èbÀ
(**
ªsu…
);

2243 
SQLITE_API
 *
sqlôe3_m¥ötf
(const *,...);

2244 
SQLITE_API
 *
sqlôe3_vm¥ötf
(c⁄° *, 
va_li°
);

2245 
SQLITE_API
 *
sqlôe3_¢¥ötf
(,*,const *, ...);

2246 
SQLITE_API
 *
sqlôe3_v¢¥ötf
(,*,c⁄° *, 
va_li°
);

2318 
SQLITE_API
 *
sqlôe3_mÆloc
();

2319 
SQLITE_API
 *
sqlôe3_ªÆloc
(*, );

2320 
SQLITE_API
 
sqlôe3_‰ì
(*);

2345 
SQLITE_API
 
sqlôe3_öt64
 
sqlôe3_mem‹y_u£d
();

2346 
SQLITE_API
 
sqlôe3_öt64
 
sqlôe3_mem‹y_highw©î
(
ª£tFœg
);

2366 
SQLITE_API
 
sqlôe3_øndom√ss
(
N
, *
P
);

2448 
SQLITE_API
 
sqlôe3_£t_auth‹izî
(

2449 
sqlôe3
*,

2450 (*
xAuth
)(*,,const *,const *,const *,const *),

2451 *
pU£rD©a


2466 
	#SQLITE_DENY
 1

	)

2467 
	#SQLITE_IGNORE
 2

	)

2489 
	#SQLITE_CREATE_INDEX
 1

	)

2490 
	#SQLITE_CREATE_TABLE
 2

	)

2491 
	#SQLITE_CREATE_TEMP_INDEX
 3

	)

2492 
	#SQLITE_CREATE_TEMP_TABLE
 4

	)

2493 
	#SQLITE_CREATE_TEMP_TRIGGER
 5

	)

2494 
	#SQLITE_CREATE_TEMP_VIEW
 6

	)

2495 
	#SQLITE_CREATE_TRIGGER
 7

	)

2496 
	#SQLITE_CREATE_VIEW
 8

	)

2497 
	#SQLITE_DELETE
 9

	)

2498 
	#SQLITE_DROP_INDEX
 10

	)

2499 
	#SQLITE_DROP_TABLE
 11

	)

2500 
	#SQLITE_DROP_TEMP_INDEX
 12

	)

2501 
	#SQLITE_DROP_TEMP_TABLE
 13

	)

2502 
	#SQLITE_DROP_TEMP_TRIGGER
 14

	)

2503 
	#SQLITE_DROP_TEMP_VIEW
 15

	)

2504 
	#SQLITE_DROP_TRIGGER
 16

	)

2505 
	#SQLITE_DROP_VIEW
 17

	)

2506 
	#SQLITE_INSERT
 18

	)

2507 
	#SQLITE_PRAGMA
 19

	)

2508 
	#SQLITE_READ
 20

	)

2509 
	#SQLITE_SELECT
 21

	)

2510 
	#SQLITE_TRANSACTION
 22

	)

2511 
	#SQLITE_UPDATE
 23

	)

2512 
	#SQLITE_ATTACH
 24

	)

2513 
	#SQLITE_DETACH
 25

	)

2514 
	#SQLITE_ALTER_TABLE
 26

	)

2515 
	#SQLITE_REINDEX
 27

	)

2516 
	#SQLITE_ANALYZE
 28

	)

2517 
	#SQLITE_CREATE_VTABLE
 29

	)

2518 
	#SQLITE_DROP_VTABLE
 30

	)

2519 
	#SQLITE_FUNCTION
 31

	)

2520 
	#SQLITE_SAVEPOINT
 32

	)

2521 
	#SQLITE_COPY
 0

	)

2551 
SQLITE_API
 *
sqlôe3_åa˚
(
sqlôe3
*, (*
xTø˚
)(*,const *), *);

2552 
SQLITE_API
 
SQLITE_EXPERIMENTAL
 *
sqlôe3_¥ofûe
(
sqlôe3
*,

2553 (*
xProfûe
)(*,c⁄° *,
sqlôe3_uöt64
), *);

2586 
SQLITE_API
 
sqlôe3_¥ogªss_h™dÀr
(
sqlôe3
*, , (*)(*), *);

2790 
SQLITE_API
 
sqlôe3_›í
(

2791 c⁄° *
fûíame
,

2792 
sqlôe3
 **
µDb


2794 
SQLITE_API
 
sqlôe3_›í16
(

2795 c⁄° *
fûíame
,

2796 
sqlôe3
 **
µDb


2798 
SQLITE_API
 
sqlôe3_›í_v2
(

2799 c⁄° *
fûíame
,

2800 
sqlôe3
 **
µDb
,

2801 
Êags
,

2802 c⁄° *
zVfs


2844 
SQLITE_API
 c⁄° *
sqlôe3_uri_∑ømëî
(c⁄° *
zFûíame
, c⁄° *
zP¨am
);

2845 
SQLITE_API
 
sqlôe3_uri_boﬁón
(c⁄° *
zFûe
, c⁄° *
zP¨am
, 
bDeÁu…
);

2846 
SQLITE_API
 
sqlôe3_öt64
 
sqlôe3_uri_öt64
(const *, const *, sqlite3_int64);

2887 
SQLITE_API
 
sqlôe3_îrcode
(
sqlôe3
 *
db
);

2888 
SQLITE_API
 
sqlôe3_exãnded_îrcode
(
sqlôe3
 *
db
);

2889 
SQLITE_API
 c⁄° *
sqlôe3_îrmsg
(
sqlôe3
*);

2890 
SQLITE_API
 c⁄° *
sqlôe3_îrmsg16
(
sqlôe3
*);

2891 
SQLITE_API
 c⁄° *
sqlôe3_îr°r
();

2917 
sqlôe3_°mt
 
	tsqlôe3_°mt
;

2958 
SQLITE_API
 
sqlôe3_limô
(
sqlôe3
*, 
id
, 
√wVÆ
);

3012 
	#SQLITE_LIMIT_LENGTH
 0

	)

3013 
	#SQLITE_LIMIT_SQL_LENGTH
 1

	)

3014 
	#SQLITE_LIMIT_COLUMN
 2

	)

3015 
	#SQLITE_LIMIT_EXPR_DEPTH
 3

	)

3016 
	#SQLITE_LIMIT_COMPOUND_SELECT
 4

	)

3017 
	#SQLITE_LIMIT_VDBE_OP
 5

	)

3018 
	#SQLITE_LIMIT_FUNCTION_ARG
 6

	)

3019 
	#SQLITE_LIMIT_ATTACHED
 7

	)

3020 
	#SQLITE_LIMIT_LIKE_PATTERN_LENGTH
 8

	)

3021 
	#SQLITE_LIMIT_VARIABLE_NUMBER
 9

	)

3022 
	#SQLITE_LIMIT_TRIGGER_DEPTH
 10

	)

3106 
SQLITE_API
 
sqlôe3_¥ï¨e
(

3107 
sqlôe3
 *
db
,

3108 c⁄° *
zSql
,

3109 
nByã
,

3110 
sqlôe3_°mt
 **
µStmt
,

3111 c⁄° **
pzTaû


3113 
SQLITE_API
 
sqlôe3_¥ï¨e_v2
(

3114 
sqlôe3
 *
db
,

3115 c⁄° *
zSql
,

3116 
nByã
,

3117 
sqlôe3_°mt
 **
µStmt
,

3118 c⁄° **
pzTaû


3120 
SQLITE_API
 
sqlôe3_¥ï¨e16
(

3121 
sqlôe3
 *
db
,

3122 c⁄° *
zSql
,

3123 
nByã
,

3124 
sqlôe3_°mt
 **
µStmt
,

3125 c⁄° **
pzTaû


3127 
SQLITE_API
 
sqlôe3_¥ï¨e16_v2
(

3128 
sqlôe3
 *
db
,

3129 c⁄° *
zSql
,

3130 
nByã
,

3131 
sqlôe3_°mt
 **
µStmt
,

3132 c⁄° **
pzTaû


3142 
SQLITE_API
 c⁄° *
sqlôe3_sql
(
sqlôe3_°mt
 *
pStmt
);

3173 
SQLITE_API
 
sqlôe3_°mt_ªad⁄ly
(
sqlôe3_°mt
 *
pStmt
);

3192 
SQLITE_API
 
sqlôe3_°mt_busy
(
sqlôe3_°mt
*);

3231 
Mem
 
	tsqlôe3_vÆue
;

3245 
sqlôe3_c⁄ãxt
 
	tsqlôe3_c⁄ãxt
;

3342 
SQLITE_API
 
sqlôe3_böd_blob
(
sqlôe3_°mt
*, , c⁄° *, 
n
, (*)(*));

3343 
SQLITE_API
 
sqlôe3_böd_doubÀ
(
sqlôe3_°mt
*, , );

3344 
SQLITE_API
 
sqlôe3_böd_öt
(
sqlôe3_°mt
*, , );

3345 
SQLITE_API
 
sqlôe3_böd_öt64
(
sqlôe3_°mt
*, , 
sqlôe3_öt64
);

3346 
SQLITE_API
 
sqlôe3_böd_nuŒ
(
sqlôe3_°mt
*, );

3347 
SQLITE_API
 
sqlôe3_böd_ãxt
(
sqlôe3_°mt
*, , c⁄° *, 
n
, (*)(*));

3348 
SQLITE_API
 
sqlôe3_böd_ãxt16
(
sqlôe3_°mt
*, , const *, , (*)(*));

3349 
SQLITE_API
 
sqlôe3_böd_vÆue
(
sqlôe3_°mt
*, , c⁄° 
sqlôe3_vÆue
*);

3350 
SQLITE_API
 
sqlôe3_böd_zîoblob
(
sqlôe3_°mt
*, , 
n
);

3370 
SQLITE_API
 
sqlôe3_böd_∑ømëî_cou¡
(
sqlôe3_°mt
*);

3397 
SQLITE_API
 c⁄° *
sqlôe3_böd_∑ømëî_«me
(
sqlôe3_°mt
*, );

3413 
SQLITE_API
 
sqlôe3_böd_∑ømëî_ödex
(
sqlôe3_°mt
*, c⁄° *
zName
);

3422 
SQLITE_API
 
sqlôe3_˛ór_bödögs
(
sqlôe3_°mt
*);

3433 
SQLITE_API
 
sqlôe3_cﬁumn_cou¡
(
sqlôe3_°mt
 *
pStmt
);

3461 
SQLITE_API
 c⁄° *
sqlôe3_cﬁumn_«me
(
sqlôe3_°mt
*, 
N
);

3462 
SQLITE_API
 c⁄° *
sqlôe3_cﬁumn_«me16
(
sqlôe3_°mt
*, 
N
);

3509 
SQLITE_API
 c⁄° *
sqlôe3_cﬁumn_d©aba£_«me
(
sqlôe3_°mt
*,);

3510 
SQLITE_API
 c⁄° *
sqlôe3_cﬁumn_d©aba£_«me16
(
sqlôe3_°mt
*,);

3511 
SQLITE_API
 c⁄° *
sqlôe3_cﬁumn_èbÀ_«me
(
sqlôe3_°mt
*,);

3512 
SQLITE_API
 c⁄° *
sqlôe3_cﬁumn_èbÀ_«me16
(
sqlôe3_°mt
*,);

3513 
SQLITE_API
 c⁄° *
sqlôe3_cﬁumn_‹igö_«me
(
sqlôe3_°mt
*,);

3514 
SQLITE_API
 c⁄° *
sqlôe3_cﬁumn_‹igö_«me16
(
sqlôe3_°mt
*,);

3545 
SQLITE_API
 c⁄° *
sqlôe3_cﬁumn_de˛ty≥
(
sqlôe3_°mt
*,);

3546 
SQLITE_API
 c⁄° *
sqlôe3_cﬁumn_de˛ty≥16
(
sqlôe3_°mt
*,);

3625 
SQLITE_API
 
sqlôe3_°ï
(
sqlôe3_°mt
*);

3645 
SQLITE_API
 
sqlôe3_d©a_cou¡
(
sqlôe3_°mt
 *
pStmt
);

3668 
	#SQLITE_INTEGER
 1

	)

3669 
	#SQLITE_FLOAT
 2

	)

3670 
	#SQLITE_BLOB
 4

	)

3671 
	#SQLITE_NULL
 5

	)

3672 #ifde‡
SQLITE_TEXT


3673 #unde‡
SQLITE_TEXT


3675 
	#SQLITE_TEXT
 3

	)

3677 
	#SQLITE3_TEXT
 3

	)

3841 
SQLITE_API
 c⁄° *
sqlôe3_cﬁumn_blob
(
sqlôe3_°mt
*, 
iCﬁ
);

3842 
SQLITE_API
 
sqlôe3_cﬁumn_byãs
(
sqlôe3_°mt
*, 
iCﬁ
);

3843 
SQLITE_API
 
sqlôe3_cﬁumn_byãs16
(
sqlôe3_°mt
*, 
iCﬁ
);

3844 
SQLITE_API
 
sqlôe3_cﬁumn_doubÀ
(
sqlôe3_°mt
*, 
iCﬁ
);

3845 
SQLITE_API
 
sqlôe3_cﬁumn_öt
(
sqlôe3_°mt
*, 
iCﬁ
);

3846 
SQLITE_API
 
sqlôe3_öt64
 
sqlôe3_cﬁumn_öt64
(
sqlôe3_°mt
*, 
iCﬁ
);

3847 
SQLITE_API
 c⁄° *
sqlôe3_cﬁumn_ãxt
(
sqlôe3_°mt
*, 
iCﬁ
);

3848 
SQLITE_API
 c⁄° *
sqlôe3_cﬁumn_ãxt16
(
sqlôe3_°mt
*, 
iCﬁ
);

3849 
SQLITE_API
 
sqlôe3_cﬁumn_ty≥
(
sqlôe3_°mt
*, 
iCﬁ
);

3850 
SQLITE_API
 
sqlôe3_vÆue
 *
sqlôe3_cﬁumn_vÆue
(
sqlôe3_°mt
*, 
iCﬁ
);

3877 
SQLITE_API
 
sqlôe3_föÆize
(
sqlôe3_°mt
 *
pStmt
);

3903 
SQLITE_API
 
sqlôe3_ª£t
(
sqlôe3_°mt
 *
pStmt
);

3993 
SQLITE_API
 
sqlôe3_¸óã_fun˘i⁄
(

3994 
sqlôe3
 *
db
,

3995 c⁄° *
zFun˘i⁄Name
,

3996 
nArg
,

3997 
eTextRï
,

3998 *
pAµ
,

3999 (*
xFunc
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
**),

4000 (*
xSãp
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
**),

4001 (*
xFöÆ
)(
sqlôe3_c⁄ãxt
*)

4003 
SQLITE_API
 
sqlôe3_¸óã_fun˘i⁄16
(

4004 
sqlôe3
 *
db
,

4005 c⁄° *
zFun˘i⁄Name
,

4006 
nArg
,

4007 
eTextRï
,

4008 *
pAµ
,

4009 (*
xFunc
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
**),

4010 (*
xSãp
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
**),

4011 (*
xFöÆ
)(
sqlôe3_c⁄ãxt
*)

4013 
SQLITE_API
 
sqlôe3_¸óã_fun˘i⁄_v2
(

4014 
sqlôe3
 *
db
,

4015 c⁄° *
zFun˘i⁄Name
,

4016 
nArg
,

4017 
eTextRï
,

4018 *
pAµ
,

4019 (*
xFunc
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
**),

4020 (*
xSãp
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
**),

4021 (*
xFöÆ
)(
sqlôe3_c⁄ãxt
*),

4022 (*
xDe°roy
)(*)

4031 
	#SQLITE_UTF8
 1

	)

4032 
	#SQLITE_UTF16LE
 2

	)

4033 
	#SQLITE_UTF16BE
 3

	)

4034 
	#SQLITE_UTF16
 4

	)

4035 
	#SQLITE_ANY
 5

	)

4036 
	#SQLITE_UTF16_ALIGNED
 8

	)

4048 #i‚de‡
SQLITE_OMIT_DEPRECATED


4049 
SQLITE_API
 
SQLITE_DEPRECATED
 
sqlôe3_aggªg©e_cou¡
(
sqlôe3_c⁄ãxt
*);

4050 
SQLITE_API
 
SQLITE_DEPRECATED
 
sqlôe3_expúed
(
sqlôe3_°mt
*);

4051 
SQLITE_API
 
SQLITE_DEPRECATED
 
sqlôe3_å™s„r_bödögs
(
sqlôe3_°mt
*, sqlite3_stmt*);

4052 
SQLITE_API
 
SQLITE_DEPRECATED
 
sqlôe3_globÆ_ªcovî
();

4053 
SQLITE_API
 
SQLITE_DEPRECATED
 
sqlôe3_thªad_˛ónup
();

4054 
SQLITE_API
 
SQLITE_DEPRECATED
 
sqlôe3_mem‹y_Æ¨m
((*)(*,
sqlôe3_öt64
,),

4055 *,
sqlôe3_öt64
);

4103 
SQLITE_API
 c⁄° *
sqlôe3_vÆue_blob
(
sqlôe3_vÆue
*);

4104 
SQLITE_API
 
sqlôe3_vÆue_byãs
(
sqlôe3_vÆue
*);

4105 
SQLITE_API
 
sqlôe3_vÆue_byãs16
(
sqlôe3_vÆue
*);

4106 
SQLITE_API
 
sqlôe3_vÆue_doubÀ
(
sqlôe3_vÆue
*);

4107 
SQLITE_API
 
sqlôe3_vÆue_öt
(
sqlôe3_vÆue
*);

4108 
SQLITE_API
 
sqlôe3_öt64
 
sqlôe3_vÆue_öt64
(
sqlôe3_vÆue
*);

4109 
SQLITE_API
 c⁄° *
sqlôe3_vÆue_ãxt
(
sqlôe3_vÆue
*);

4110 
SQLITE_API
 c⁄° *
sqlôe3_vÆue_ãxt16
(
sqlôe3_vÆue
*);

4111 
SQLITE_API
 c⁄° *
sqlôe3_vÆue_ãxt16À
(
sqlôe3_vÆue
*);

4112 
SQLITE_API
 c⁄° *
sqlôe3_vÆue_ãxt16be
(
sqlôe3_vÆue
*);

4113 
SQLITE_API
 
sqlôe3_vÆue_ty≥
(
sqlôe3_vÆue
*);

4114 
SQLITE_API
 
sqlôe3_vÆue_numîic_ty≥
(
sqlôe3_vÆue
*);

4158 
SQLITE_API
 *
sqlôe3_aggªg©e_c⁄ãxt
(
sqlôe3_c⁄ãxt
*, 
nByãs
);

4172 
SQLITE_API
 *
sqlôe3_u£r_d©a
(
sqlôe3_c⁄ãxt
*);

4183 
SQLITE_API
 
sqlôe3
 *
sqlôe3_c⁄ãxt_db_h™dÀ
(
sqlôe3_c⁄ãxt
*);

4235 
SQLITE_API
 *
sqlôe3_gë_auxd©a
(
sqlôe3_c⁄ãxt
*, 
N
);

4236 
SQLITE_API
 
sqlôe3_£t_auxd©a
(
sqlôe3_c⁄ãxt
*, 
N
, *, (*)(*));

4253 (*
sqlôe3_de°ru˘‹_ty≥
)(*);

4254 
	#SQLITE_STATIC
 ((
sqlôe3_de°ru˘‹_ty≥
)0)

	)

4255 
	#SQLITE_TRANSIENT
 ((
sqlôe3_de°ru˘‹_ty≥
)-1)

	)

4367 
SQLITE_API
 
sqlôe3_ªsu…_blob
(
sqlôe3_c⁄ãxt
*, const *, , (*)(*));

4368 
SQLITE_API
 
sqlôe3_ªsu…_doubÀ
(
sqlôe3_c⁄ãxt
*, );

4369 
SQLITE_API
 
sqlôe3_ªsu…_îr‹
(
sqlôe3_c⁄ãxt
*, const *, );

4370 
SQLITE_API
 
sqlôe3_ªsu…_îr‹16
(
sqlôe3_c⁄ãxt
*, const *, );

4371 
SQLITE_API
 
sqlôe3_ªsu…_îr‹_toobig
(
sqlôe3_c⁄ãxt
*);

4372 
SQLITE_API
 
sqlôe3_ªsu…_îr‹_nomem
(
sqlôe3_c⁄ãxt
*);

4373 
SQLITE_API
 
sqlôe3_ªsu…_îr‹_code
(
sqlôe3_c⁄ãxt
*, );

4374 
SQLITE_API
 
sqlôe3_ªsu…_öt
(
sqlôe3_c⁄ãxt
*, );

4375 
SQLITE_API
 
sqlôe3_ªsu…_öt64
(
sqlôe3_c⁄ãxt
*, 
sqlôe3_öt64
);

4376 
SQLITE_API
 
sqlôe3_ªsu…_nuŒ
(
sqlôe3_c⁄ãxt
*);

4377 
SQLITE_API
 
sqlôe3_ªsu…_ãxt
(
sqlôe3_c⁄ãxt
*, const *, , (*)(*));

4378 
SQLITE_API
 
sqlôe3_ªsu…_ãxt16
(
sqlôe3_c⁄ãxt
*, const *, , (*)(*));

4379 
SQLITE_API
 
sqlôe3_ªsu…_ãxt16À
(
sqlôe3_c⁄ãxt
*, const *, ,(*)(*));

4380 
SQLITE_API
 
sqlôe3_ªsu…_ãxt16be
(
sqlôe3_c⁄ãxt
*, const *, ,(*)(*));

4381 
SQLITE_API
 
sqlôe3_ªsu…_vÆue
(
sqlôe3_c⁄ãxt
*, 
sqlôe3_vÆue
*);

4382 
SQLITE_API
 
sqlôe3_ªsu…_zîoblob
(
sqlôe3_c⁄ãxt
*, 
n
);

4463 
SQLITE_API
 
sqlôe3_¸óã_cﬁœti⁄
(

4464 
sqlôe3
*,

4465 c⁄° *
zName
,

4466 
eTextRï
,

4467 *
pArg
,

4468 (*
xCom∑ª
)(*,,const *,,const *)

4470 
SQLITE_API
 
sqlôe3_¸óã_cﬁœti⁄_v2
(

4471 
sqlôe3
*,

4472 c⁄° *
zName
,

4473 
eTextRï
,

4474 *
pArg
,

4475 (*
xCom∑ª
)(*,,const *,,const *),

4476 (*
xDe°roy
)(*)

4478 
SQLITE_API
 
sqlôe3_¸óã_cﬁœti⁄16
(

4479 
sqlôe3
*,

4480 c⁄° *
zName
,

4481 
eTextRï
,

4482 *
pArg
,

4483 (*
xCom∑ª
)(*,,const *,,const *)

4512 
SQLITE_API
 
sqlôe3_cﬁœti⁄_√eded
(

4513 
sqlôe3
*,

4515 (*)(*,
sqlôe3
*,
eTextRï
,const *)

4517 
SQLITE_API
 
sqlôe3_cﬁœti⁄_√eded16
(

4518 
sqlôe3
*,

4520 (*)(*,
sqlôe3
*,
eTextRï
,const *)

4523 #ifde‡
SQLITE_HAS_CODEC


4531 
SQLITE_API
 
sqlôe3_key
(

4532 
sqlôe3
 *
db
,

4533 c⁄° *
pKey
, 
nKey


4535 
SQLITE_API
 
sqlôe3_key_v2
(

4536 
sqlôe3
 *
db
,

4537 c⁄° *
zDbName
,

4538 c⁄° *
pKey
, 
nKey


4549 
SQLITE_API
 
sqlôe3_ªkey
(

4550 
sqlôe3
 *
db
,

4551 c⁄° *
pKey
, 
nKey


4553 
SQLITE_API
 
sqlôe3_ªkey_v2
(

4554 
sqlôe3
 *
db
,

4555 c⁄° *
zDbName
,

4556 c⁄° *
pKey
, 
nKey


4563 
SQLITE_API
 
sqlôe3_a˘iv©e_£e
(

4564 c⁄° *
zPassPhø£


4568 #ifde‡
SQLITE_ENABLE_CEROD


4573 
SQLITE_API
 
sqlôe3_a˘iv©e_˚rod
(

4574 c⁄° *
zPassPhø£


4595 
SQLITE_API
 
sqlôe3_¶ìp
();

4641 
SQLITE_API
 
SQLITE_EXTERN
 *
sqlôe3_ãmp_dúe˘‹y
;

4678 
SQLITE_API
 
SQLITE_EXTERN
 *
sqlôe3_d©a_dúe˘‹y
;

4701 
SQLITE_API
 
sqlôe3_gë_autocommô
(
sqlôe3
*);

4713 
SQLITE_API
 
sqlôe3
 *
sqlôe3_db_h™dÀ
(
sqlôe3_°mt
*);

4729 
SQLITE_API
 c⁄° *
sqlôe3_db_fûíame
(
sqlôe3
 *
db
, c⁄° *
zDbName
);

4738 
SQLITE_API
 
sqlôe3_db_ªad⁄ly
(
sqlôe3
 *
db
, c⁄° *
zDbName
);

4753 
SQLITE_API
 
sqlôe3_°mt
 *
sqlôe3_√xt_°mt
(
sqlôe3
 *
pDb
, sqlôe3_°mà*
pStmt
);

4801 
SQLITE_API
 *
sqlôe3_commô_hook
(
sqlôe3
*, (*)(*), *);

4802 
SQLITE_API
 *
sqlôe3_rﬁlback_hook
(
sqlôe3
*, (*)(*), *);

4850 
SQLITE_API
 *
sqlôe3_upd©e_hook
(

4851 
sqlôe3
*,

4852 (*)(*,,c⁄° *,c⁄° *,
sqlôe3_öt64
),

4885 
SQLITE_API
 
sqlôe3_íabÀ_sh¨ed_ˇche
();

4901 
SQLITE_API
 
sqlôe3_ªÀa£_mem‹y
();

4914 
SQLITE_API
 
sqlôe3_db_ªÀa£_mem‹y
(
sqlôe3
*);

4966 
SQLITE_API
 
sqlôe3_öt64
 
sqlôe3_so·_hóp_limô64
(sqlôe3_öt64 
N
);

4977 
SQLITE_API
 
SQLITE_DEPRECATED
 
sqlôe3_so·_hóp_limô
(
N
);

5042 
SQLITE_API
 
sqlôe3_èbÀ_cﬁumn_mëad©a
(

5043 
sqlôe3
 *
db
,

5044 c⁄° *
zDbName
,

5045 c⁄° *
zTabÀName
,

5046 c⁄° *
zCﬁumnName
,

5047 c⁄° **
pzD©aTy≥
,

5048 c⁄° **
pzCﬁlSeq
,

5049 *
pNŸNuŒ
,

5050 *
pPrim¨yKey
,

5051 *
pAutoöc


5088 
SQLITE_API
 
sqlôe3_lﬂd_exãnsi⁄
(

5089 
sqlôe3
 *
db
,

5090 c⁄° *
zFûe
,

5091 c⁄° *
zProc
,

5092 **
pzEºMsg


5108 
SQLITE_API
 
sqlôe3_íabÀ_lﬂd_exãnsi⁄
(
sqlôe3
 *
db
, 
⁄off
);

5146 
SQLITE_API
 
sqlôe3_auto_exãnsi⁄
((*
xE¡ryPoöt
)());

5158 
SQLITE_API
 
sqlôe3_ˇn˚l_auto_exãnsi⁄
((*
xE¡ryPoöt
)());

5166 
SQLITE_API
 
sqlôe3_ª£t_auto_exãnsi⁄
();

5180 
sqlôe3_vèb
 
	tsqlôe3_vèb
;

5181 
sqlôe3_ödex_öfo
 
	tsqlôe3_ödex_öfo
;

5182 
sqlôe3_vèb_curs‹
 
	tsqlôe3_vèb_curs‹
;

5183 
sqlôe3_moduÀ
 
	tsqlôe3_moduÀ
;

5201 
	ssqlôe3_moduÀ
 {

5202 
iVîsi⁄
;

5203 (*
xCª©e
)(
sqlôe3
*, *
pAux
,

5204 
¨gc
, c⁄° *c⁄°*
¨gv
,

5205 
sqlôe3_vèb
 **
µVTab
, **);

5206 (*
xC⁄√˘
)(
sqlôe3
*, *
pAux
,

5207 
¨gc
, c⁄° *c⁄°*
¨gv
,

5208 
sqlôe3_vèb
 **
µVTab
, **);

5209 (*
xBe°Index
)(
sqlôe3_vèb
 *
pVTab
, 
sqlôe3_ödex_öfo
*);

5210 (*
xDisc⁄√˘
)(
sqlôe3_vèb
 *
pVTab
);

5211 (*
xDe°roy
)(
sqlôe3_vèb
 *
pVTab
);

5212 (*
xO≥n
)(
sqlôe3_vèb
 *
pVTab
, 
sqlôe3_vèb_curs‹
 **
µCurs‹
);

5213 (*
xClo£
)(
sqlôe3_vèb_curs‹
*);

5214 (*
xFûãr
)(
sqlôe3_vèb_curs‹
*, 
idxNum
, c⁄° *
idxSå
,

5215 
¨gc
, 
sqlôe3_vÆue
 **
¨gv
);

5216 (*
xNext
)(
sqlôe3_vèb_curs‹
*);

5217 (*
xEof
)(
sqlôe3_vèb_curs‹
*);

5218 (*
xCﬁumn
)(
sqlôe3_vèb_curs‹
*, 
sqlôe3_c⁄ãxt
*, );

5219 (*
xRowid
)(
sqlôe3_vèb_curs‹
*, 
sqlôe3_öt64
 *
pRowid
);

5220 (*
xUpd©e
)(
sqlôe3_vèb
 *, , 
sqlôe3_vÆue
 **, 
sqlôe3_öt64
 *);

5221 (*
xBegö
)(
sqlôe3_vèb
 *
pVTab
);

5222 (*
xSync
)(
sqlôe3_vèb
 *
pVTab
);

5223 (*
xCommô
)(
sqlôe3_vèb
 *
pVTab
);

5224 (*
xRﬁlback
)(
sqlôe3_vèb
 *
pVTab
);

5225 (*
xFödFun˘i⁄
)(
sqlôe3_vèb
 *
pVèb
, 
nArg
, c⁄° *
zName
,

5226 (**
pxFunc
)(
sqlôe3_c⁄ãxt
*,,
sqlôe3_vÆue
**),

5227 **
µArg
);

5228 (*
xRíame
)(
sqlôe3_vèb
 *
pVèb
, c⁄° *
zNew
);

5231 (*
xSavïoöt
)(
sqlôe3_vèb
 *
pVTab
, );

5232 (*
xRñó£
)(
sqlôe3_vèb
 *
pVTab
, );

5233 (*
xRﬁlbackTo
)(
sqlôe3_vèb
 *
pVTab
, );

5289 
	ssqlôe3_ödex_öfo
 {

5291 
nC⁄°øöt
;

5292 
	ssqlôe3_ödex_c⁄°øöt
 {

5293 
iCﬁumn
;

5294 
›
;

5295 
ußbÀ
;

5296 
iTîmOff£t
;

5297 } *
aC⁄°øöt
;

5298 
nOrdîBy
;

5299 
	ssqlôe3_ödex_‹dîby
 {

5300 
iCﬁumn
;

5301 
desc
;

5302 } *
aOrdîBy
;

5304 
	ssqlôe3_ödex_c⁄°øöt_ußge
 {

5305 
¨gvIndex
;

5306 
omô
;

5307 } *
aC⁄°øötUßge
;

5308 
idxNum
;

5309 *
idxSå
;

5310 
√edToFªeIdxSå
;

5311 
‹dîByC⁄sumed
;

5312 
e°im©edCo°
;

5323 
	#SQLITE_INDEX_CONSTRAINT_EQ
 2

	)

5324 
	#SQLITE_INDEX_CONSTRAINT_GT
 4

	)

5325 
	#SQLITE_INDEX_CONSTRAINT_LE
 8

	)

5326 
	#SQLITE_INDEX_CONSTRAINT_LT
 16

	)

5327 
	#SQLITE_INDEX_CONSTRAINT_GE
 32

	)

5328 
	#SQLITE_INDEX_CONSTRAINT_MATCH
 64

	)

5355 
SQLITE_API
 
sqlôe3_¸óã_moduÀ
(

5356 
sqlôe3
 *
db
,

5357 c⁄° *
zName
,

5358 c⁄° 
sqlôe3_moduÀ
 *
p
,

5359 *
pClõ¡D©a


5361 
SQLITE_API
 
sqlôe3_¸óã_moduÀ_v2
(

5362 
sqlôe3
 *
db
,

5363 c⁄° *
zName
,

5364 c⁄° 
sqlôe3_moduÀ
 *
p
,

5365 *
pClõ¡D©a
,

5366 (*
xDe°roy
)(*)

5387 
	ssqlôe3_vèb
 {

5388 c⁄° 
sqlôe3_moduÀ
 *
pModuÀ
;

5389 
nRef
;

5390 *
zEºMsg
;

5411 
	ssqlôe3_vèb_curs‹
 {

5412 
sqlôe3_vèb
 *
pVèb
;

5424 
SQLITE_API
 
sqlôe3_de˛¨e_vèb
(
sqlôe3
*, c⁄° *
zSQL
);

5442 
SQLITE_API
 
sqlôe3_ovîlﬂd_fun˘i⁄
(
sqlôe3
*, c⁄° *
zFuncName
, 
nArg
);

5466 
sqlôe3_blob
 
	tsqlôe3_blob
;

5524 
SQLITE_API
 
sqlôe3_blob_›í
(

5525 
sqlôe3
*,

5526 c⁄° *
zDb
,

5527 c⁄° *
zTabÀ
,

5528 c⁄° *
zCﬁumn
,

5529 
sqlôe3_öt64
 
iRow
,

5530 
Êags
,

5531 
sqlôe3_blob
 **
µBlob


5556 
SQLITE_API
 
SQLITE_EXPERIMENTAL
 
sqlôe3_blob_ª›í
(
sqlôe3_blob
 *, 
sqlôe3_öt64
);

5580 
SQLITE_API
 
sqlôe3_blob_˛o£
(
sqlôe3_blob
 *);

5595 
SQLITE_API
 
sqlôe3_blob_byãs
(
sqlôe3_blob
 *);

5623 
SQLITE_API
 
sqlôe3_blob_ªad
(
sqlôe3_blob
 *, *
Z
, 
N
, 
iOff£t
);

5661 
SQLITE_API
 
sqlôe3_blob_wrôe
(
sqlôe3_blob
 *, c⁄° *
z
, 
n
, 
iOff£t
);

5692 
SQLITE_API
 
sqlôe3_vfs
 *
sqlôe3_vfs_föd
(c⁄° *
zVfsName
);

5693 
SQLITE_API
 
sqlôe3_vfs_ªgi°î
(
sqlôe3_vfs
*, 
makeDÊt
);

5694 
SQLITE_API
 
sqlôe3_vfs_uƒegi°î
(
sqlôe3_vfs
*);

5809 
SQLITE_API
 
sqlôe3_muãx
 *
sqlôe3_muãx_Æloc
();

5810 
SQLITE_API
 
sqlôe3_muãx_‰ì
(
sqlôe3_muãx
*);

5811 
SQLITE_API
 
sqlôe3_muãx_íãr
(
sqlôe3_muãx
*);

5812 
SQLITE_API
 
sqlôe3_muãx_åy
(
sqlôe3_muãx
*);

5813 
SQLITE_API
 
sqlôe3_muãx_Àave
(
sqlôe3_muãx
*);

5880 
sqlôe3_muãx_mëhods
 
	tsqlôe3_muãx_mëhods
;

5881 
	ssqlôe3_muãx_mëhods
 {

5882 (*
xMuãxInô
)();

5883 (*
xMuãxEnd
)();

5884 
sqlôe3_muãx
 *(*
xMuãxAŒoc
)();

5885 (*
xMuãxFªe
)(
sqlôe3_muãx
 *);

5886 (*
xMuãxE¡î
)(
sqlôe3_muãx
 *);

5887 (*
xMuãxTry
)(
sqlôe3_muãx
 *);

5888 (*
xMuãxLóve
)(
sqlôe3_muãx
 *);

5889 (*
xMuãxHñd
)(
sqlôe3_muãx
 *);

5890 (*
xMuãxNŸhñd
)(
sqlôe3_muãx
 *);

5922 #i‚de‡
NDEBUG


5923 
SQLITE_API
 
sqlôe3_muãx_hñd
(
sqlôe3_muãx
*);

5924 
SQLITE_API
 
sqlôe3_muãx_nŸhñd
(
sqlôe3_muãx
*);

5937 
	#SQLITE_MUTEX_FAST
 0

	)

5938 
	#SQLITE_MUTEX_RECURSIVE
 1

	)

5939 
	#SQLITE_MUTEX_STATIC_MASTER
 2

	)

5940 
	#SQLITE_MUTEX_STATIC_MEM
 3

	)

5941 
	#SQLITE_MUTEX_STATIC_MEM2
 4

	)

5942 
	#SQLITE_MUTEX_STATIC_OPEN
 4

	)

5943 
	#SQLITE_MUTEX_STATIC_PRNG
 5

	)

5944 
	#SQLITE_MUTEX_STATIC_LRU
 6

	)

5945 
	#SQLITE_MUTEX_STATIC_LRU2
 7

	)

5946 
	#SQLITE_MUTEX_STATIC_PMEM
 7

	)

5957 
SQLITE_API
 
sqlôe3_muãx
 *
sqlôe3_db_muãx
(
sqlôe3
*);

5991 
SQLITE_API
 
sqlôe3_fûe_c⁄åﬁ
(
sqlôe3
*, c⁄° *
zDbName
, 
›
, *);

6010 
SQLITE_API
 
sqlôe3_ã°_c⁄åﬁ
(
›
, ...);

6023 
	#SQLITE_TESTCTRL_FIRST
 5

	)

6024 
	#SQLITE_TESTCTRL_PRNG_SAVE
 5

	)

6025 
	#SQLITE_TESTCTRL_PRNG_RESTORE
 6

	)

6026 
	#SQLITE_TESTCTRL_PRNG_RESET
 7

	)

6027 
	#SQLITE_TESTCTRL_BITVEC_TEST
 8

	)

6028 
	#SQLITE_TESTCTRL_FAULT_INSTALL
 9

	)

6029 
	#SQLITE_TESTCTRL_BENIGN_MALLOC_HOOKS
 10

	)

6030 
	#SQLITE_TESTCTRL_PENDING_BYTE
 11

	)

6031 
	#SQLITE_TESTCTRL_ASSERT
 12

	)

6032 
	#SQLITE_TESTCTRL_ALWAYS
 13

	)

6033 
	#SQLITE_TESTCTRL_RESERVE
 14

	)

6034 
	#SQLITE_TESTCTRL_OPTIMIZATIONS
 15

	)

6035 
	#SQLITE_TESTCTRL_ISKEYWORD
 16

	)

6036 
	#SQLITE_TESTCTRL_SCRATCHMALLOC
 17

	)

6037 
	#SQLITE_TESTCTRL_LOCALTIME_FAULT
 18

	)

6038 
	#SQLITE_TESTCTRL_EXPLAIN_STMT
 19

	)

6039 
	#SQLITE_TESTCTRL_LAST
 19

	)

6070 
SQLITE_API
 
sqlôe3_°©us
(
›
, *
pCuºít
, *
pHighw©î
, 
ª£tFœg
);

6155 
	#SQLITE_STATUS_MEMORY_USED
 0

	)

6156 
	#SQLITE_STATUS_PAGECACHE_USED
 1

	)

6157 
	#SQLITE_STATUS_PAGECACHE_OVERFLOW
 2

	)

6158 
	#SQLITE_STATUS_SCRATCH_USED
 3

	)

6159 
	#SQLITE_STATUS_SCRATCH_OVERFLOW
 4

	)

6160 
	#SQLITE_STATUS_MALLOC_SIZE
 5

	)

6161 
	#SQLITE_STATUS_PARSER_STACK
 6

	)

6162 
	#SQLITE_STATUS_PAGECACHE_SIZE
 7

	)

6163 
	#SQLITE_STATUS_SCRATCH_SIZE
 8

	)

6164 
	#SQLITE_STATUS_MALLOC_COUNT
 9

	)

6188 
SQLITE_API
 
sqlôe3_db_°©us
(
sqlôe3
*, 
›
, *
pCur
, *
pHiwå
, 
ª£tFlg
);

6280 
	#SQLITE_DBSTATUS_LOOKASIDE_USED
 0

	)

6281 
	#SQLITE_DBSTATUS_CACHE_USED
 1

	)

6282 
	#SQLITE_DBSTATUS_SCHEMA_USED
 2

	)

6283 
	#SQLITE_DBSTATUS_STMT_USED
 3

	)

6284 
	#SQLITE_DBSTATUS_LOOKASIDE_HIT
 4

	)

6285 
	#SQLITE_DBSTATUS_LOOKASIDE_MISS_SIZE
 5

	)

6286 
	#SQLITE_DBSTATUS_LOOKASIDE_MISS_FULL
 6

	)

6287 
	#SQLITE_DBSTATUS_CACHE_HIT
 7

	)

6288 
	#SQLITE_DBSTATUS_CACHE_MISS
 8

	)

6289 
	#SQLITE_DBSTATUS_CACHE_WRITE
 9

	)

6290 
	#SQLITE_DBSTATUS_DEFERRED_FKS
 10

	)

6291 
	#SQLITE_DBSTATUS_MAX
 10

	)

6317 
SQLITE_API
 
sqlôe3_°mt_°©us
(
sqlôe3_°mt
*, 
›
,
ª£tFlg
);

6356 
	#SQLITE_STMTSTATUS_FULLSCAN_STEP
 1

	)

6357 
	#SQLITE_STMTSTATUS_SORT
 2

	)

6358 
	#SQLITE_STMTSTATUS_AUTOINDEX
 3

	)

6359 
	#SQLITE_STMTSTATUS_VM_STEP
 4

	)

6372 
sqlôe3_pˇche
 
	tsqlôe3_pˇche
;

6384 
sqlôe3_pˇche_∑ge
 
	tsqlôe3_pˇche_∑ge
;

6385 
	ssqlôe3_pˇche_∑ge
 {

6386 *
pBuf
;

6387 *
pExåa
;

6549 
sqlôe3_pˇche_mëhods2
 
	tsqlôe3_pˇche_mëhods2
;

6550 
	ssqlôe3_pˇche_mëhods2
 {

6551 
iVîsi⁄
;

6552 *
pArg
;

6553 (*
xInô
)(*);

6554 (*
xShutdown
)(*);

6555 
sqlôe3_pˇche
 *(*
xCª©e
)(
szPage
, 
szExåa
, 
bPurgóbÀ
);

6556 (*
xCachesize
)(
sqlôe3_pˇche
*, 
nCachesize
);

6557 (*
xPagecou¡
)(
sqlôe3_pˇche
*);

6558 
sqlôe3_pˇche_∑ge
 *(*
xFëch
)(
sqlôe3_pˇche
*, 
key
, 
¸óãFœg
);

6559 (*
xU≈ö
)(
sqlôe3_pˇche
*, 
sqlôe3_pˇche_∑ge
*, 
disˇrd
);

6560 (*
xRekey
)(
sqlôe3_pˇche
*, 
sqlôe3_pˇche_∑ge
*,

6561 
ﬁdKey
, 
√wKey
);

6562 (*
xTrunˇã
)(
sqlôe3_pˇche
*, 
iLimô
);

6563 (*
xDe°roy
)(
sqlôe3_pˇche
*);

6564 (*
xShrök
)(
sqlôe3_pˇche
*);

6572 
sqlôe3_pˇche_mëhods
 
	tsqlôe3_pˇche_mëhods
;

6573 
	ssqlôe3_pˇche_mëhods
 {

6574 *
pArg
;

6575 (*
xInô
)(*);

6576 (*
xShutdown
)(*);

6577 
sqlôe3_pˇche
 *(*
xCª©e
)(
szPage
, 
bPurgóbÀ
);

6578 (*
xCachesize
)(
sqlôe3_pˇche
*, 
nCachesize
);

6579 (*
xPagecou¡
)(
sqlôe3_pˇche
*);

6580 *(*
xFëch
)(
sqlôe3_pˇche
*, 
key
, 
¸óãFœg
);

6581 (*
xU≈ö
)(
sqlôe3_pˇche
*, *, 
disˇrd
);

6582 (*
xRekey
)(
sqlôe3_pˇche
*, *, 
ﬁdKey
, 
√wKey
);

6583 (*
xTrunˇã
)(
sqlôe3_pˇche
*, 
iLimô
);

6584 (*
xDe°roy
)(
sqlôe3_pˇche
*);

6598 
sqlôe3_backup
 
	tsqlôe3_backup
;

6782 
SQLITE_API
 
sqlôe3_backup
 *
sqlôe3_backup_öô
(

6783 
sqlôe3
 *
pDe°
,

6784 c⁄° *
zDe°Name
,

6785 
sqlôe3
 *
pSour˚
,

6786 c⁄° *
zSour˚Name


6788 
SQLITE_API
 
sqlôe3_backup_°ï
(
sqlôe3_backup
 *
p
, 
nPage
);

6789 
SQLITE_API
 
sqlôe3_backup_föish
(
sqlôe3_backup
 *
p
);

6790 
SQLITE_API
 
sqlôe3_backup_ªmaöög
(
sqlôe3_backup
 *
p
);

6791 
SQLITE_API
 
sqlôe3_backup_∑gecou¡
(
sqlôe3_backup
 *
p
);

6907 
SQLITE_API
 
sqlôe3_u∆ock_nŸify
(

6908 
sqlôe3
 *
pBlocked
,

6909 (*
xNŸify
)(**
≠Arg
, 
nArg
),

6910 *
pNŸifyArg


6922 
SQLITE_API
 
sqlôe3_°ricmp
(const *, const *);

6923 
SQLITE_API
 
sqlôe3_°∫icmp
(const *, const *, );

6938 
SQLITE_API
 
sqlôe3_°rglob
(c⁄° *
zGlob
, c⁄° *
zSå
);

6961 
SQLITE_API
 
sqlôe3_log
(
iEºCode
, c⁄° *
zF‹m©
, ...);

6998 
SQLITE_API
 *
sqlôe3_wÆ_hook
(

6999 
sqlôe3
*,

7000 (*)(*,
sqlôe3
*,const *,),

7029 
SQLITE_API
 
sqlôe3_wÆ_autocheckpoöt
(
sqlôe3
 *
db
, 
N
);

7047 
SQLITE_API
 
sqlôe3_wÆ_checkpoöt
(
sqlôe3
 *
db
, c⁄° *
zDb
);

7119 
SQLITE_API
 
sqlôe3_wÆ_checkpoöt_v2
(

7120 
sqlôe3
 *
db
,

7121 c⁄° *
zDb
,

7122 
eMode
,

7123 *
≤Log
,

7124 *
≤Ck±


7135 
	#SQLITE_CHECKPOINT_PASSIVE
 0

	)

7136 
	#SQLITE_CHECKPOINT_FULL
 1

	)

7137 
	#SQLITE_CHECKPOINT_RESTART
 2

	)

7153 
SQLITE_API
 
sqlôe3_vèb_c⁄fig
(
sqlôe3
*, 
›
, ...);

7194 
	#SQLITE_VTAB_CONSTRAINT_SUPPORT
 1

	)

7206 
SQLITE_API
 
sqlôe3_vèb_⁄_c⁄Êi˘
(
sqlôe3
 *);

7219 
	#SQLITE_ROLLBACK
 1

	)

7221 
	#SQLITE_FAIL
 3

	)

7223 
	#SQLITE_REPLACE
 5

	)

7231 #ifde‡
SQLITE_OMIT_FLOATING_POINT


7235 #ifde‡
__˝lu•lus


7253 #i‚de‡
_SQLITE3RTREE_H_


7254 
	#_SQLITE3RTREE_H_


	)

7257 #ifde‡
__˝lu•lus


7261 
sqlôe3_πªe_geomëry
 
	tsqlôe3_πªe_geomëry
;

7269 
SQLITE_API
 
sqlôe3_πªe_geomëry_ˇŒback
(

7270 
sqlôe3
 *
db
,

7271 c⁄° *
zGeom
,

7272 #ifde‡
SQLITE_RTREE_INT_ONLY


7273 (*
xGeom
)(
sqlôe3_πªe_geomëry
*, 
n
, 
sqlôe3_öt64
 *
a
, *
pRes
),

7275 (*
xGeom
)(
sqlôe3_πªe_geomëry
*, 
n
, *
a
, *
pRes
),

7277 *
pC⁄ãxt


7285 
	ssqlôe3_πªe_geomëry
 {

7286 *
pC⁄ãxt
;

7287 
nP¨am
;

7288 *
aP¨am
;

7289 *
pU£r
;

7290 (*
xDñU£r
)(*);

7294 #ifde‡
__˝lu•lus


	@sqlite3ext.h

18 #i‚de‡
_SQLITE3EXT_H_


19 
	#_SQLITE3EXT_H_


	)

20 
	~"sqlôe3.h
"

22 
sqlôe3_≠i_routöes
 
	tsqlôe3_≠i_routöes
;

34 
	ssqlôe3_≠i_routöes
 {

35 * (*
	maggªg©e_c⁄ãxt
)(
	msqlôe3_c⁄ãxt
*,
	mnByãs
);

36 (*
	maggªg©e_cou¡
)(
	msqlôe3_c⁄ãxt
*);

37 (*
	mböd_blob
)(
	msqlôe3_°mt
*,,c⁄° *,
	mn
,(*)(*));

38 (*
	mböd_doubÀ
)(
	msqlôe3_°mt
*,,);

39 (*
	mböd_öt
)(
	msqlôe3_°mt
*,,);

40 (*
	mböd_öt64
)(
	msqlôe3_°mt
*,,
	msqlôe_öt64
);

41 (*
	mböd_nuŒ
)(
	msqlôe3_°mt
*,);

42 (*
	mböd_∑ømëî_cou¡
)(
	msqlôe3_°mt
*);

43 (*
	mböd_∑ømëî_ödex
)(
	msqlôe3_°mt
*,c⁄° *
	mzName
);

44 c⁄° * (*
	mböd_∑ømëî_«me
)(
	msqlôe3_°mt
*,);

45 (*
	mböd_ãxt
)(
	msqlôe3_°mt
*,,c⁄° *,
	mn
,(*)(*));

46 (*
	mböd_ãxt16
)(
	msqlôe3_°mt
*,,const *,,(*)(*));

47 (*
	mböd_vÆue
)(
	msqlôe3_°mt
*,,c⁄° 
	msqlôe3_vÆue
*);

48 (*
	mbusy_h™dÀr
)(
	msqlôe3
*,(*)(*,),*);

49 (*
	mbusy_timeout
)(
	msqlôe3
*,
	mms
);

50 (*
	mch™ges
)(
	msqlôe3
*);

51 (*
	m˛o£
)(
	msqlôe3
*);

52 (*
	mcﬁœti⁄_√eded
)(
	msqlôe3
*,*,(*)(*,sqlite3*,

53 
	meTextRï
,const *));

54 (*
	mcﬁœti⁄_√eded16
)(
	msqlôe3
*,*,(*)(*,sqlite3*,

55 
	meTextRï
,const *));

56 c⁄° * (*
	mcﬁumn_blob
)(
	msqlôe3_°mt
*,
	miCﬁ
);

57 (*
	mcﬁumn_byãs
)(
	msqlôe3_°mt
*,
	miCﬁ
);

58 (*
	mcﬁumn_byãs16
)(
	msqlôe3_°mt
*,
	miCﬁ
);

59 (*
	mcﬁumn_cou¡
)(
sqlôe3_°mt
*
	mpStmt
);

60 c⁄° * (*
	mcﬁumn_d©aba£_«me
)(
	msqlôe3_°mt
*,);

61 c⁄° * (*
	mcﬁumn_d©aba£_«me16
)(
	msqlôe3_°mt
*,);

62 c⁄° * (*
	mcﬁumn_de˛ty≥
)(
	msqlôe3_°mt
*,
	mi
);

63 c⁄° * (*
	mcﬁumn_de˛ty≥16
)(
	msqlôe3_°mt
*,);

64 (*
	mcﬁumn_doubÀ
)(
	msqlôe3_°mt
*,
	miCﬁ
);

65 (*
	mcﬁumn_öt
)(
	msqlôe3_°mt
*,
	miCﬁ
);

66 
sqlôe_öt64
 (*
cﬁumn_öt64
)(
	msqlôe3_°mt
*,
	miCﬁ
);

67 c⁄° * (*
	mcﬁumn_«me
)(
	msqlôe3_°mt
*,);

68 c⁄° * (*
	mcﬁumn_«me16
)(
	msqlôe3_°mt
*,);

69 c⁄° * (*
	mcﬁumn_‹igö_«me
)(
	msqlôe3_°mt
*,);

70 c⁄° * (*
	mcﬁumn_‹igö_«me16
)(
	msqlôe3_°mt
*,);

71 c⁄° * (*
	mcﬁumn_èbÀ_«me
)(
	msqlôe3_°mt
*,);

72 c⁄° * (*
	mcﬁumn_èbÀ_«me16
)(
	msqlôe3_°mt
*,);

73 c⁄° * (*
	mcﬁumn_ãxt
)(
	msqlôe3_°mt
*,
	miCﬁ
);

74 c⁄° * (*
	mcﬁumn_ãxt16
)(
	msqlôe3_°mt
*,
	miCﬁ
);

75 (*
	mcﬁumn_ty≥
)(
	msqlôe3_°mt
*,
	miCﬁ
);

76 
	msqlôe3_vÆue
* (*
	mcﬁumn_vÆue
)(
	msqlôe3_°mt
*,
	miCﬁ
);

77 * (*
	mcommô_hook
)(
	msqlôe3
*,(*)(*),*);

78 (*
	mcom∂ëe
)(c⁄° *
	msql
);

79 (*
	mcom∂ëe16
)(c⁄° *
	msql
);

80 (*
	m¸óã_cﬁœti⁄
)(
	msqlôe3
*,const *,,*,

82 (*
	m¸óã_cﬁœti⁄16
)(
	msqlôe3
*,const *,,*,

84 (*
	m¸óã_fun˘i⁄
)(
	msqlôe3
*,const *,,,*,

85 (*
	mxFunc
)(
	msqlôe3_c⁄ãxt
*,,
	msqlôe3_vÆue
**),

86 (*
	mxSãp
)(
	msqlôe3_c⁄ãxt
*,,
	msqlôe3_vÆue
**),

87 (*
	mxFöÆ
)(
	msqlôe3_c⁄ãxt
*));

88 (*
	m¸óã_fun˘i⁄16
)(
	msqlôe3
*,const *,,,*,

89 (*
	mxFunc
)(
	msqlôe3_c⁄ãxt
*,,
	msqlôe3_vÆue
**),

90 (*
	mxSãp
)(
	msqlôe3_c⁄ãxt
*,,
	msqlôe3_vÆue
**),

91 (*
	mxFöÆ
)(
	msqlôe3_c⁄ãxt
*));

92 (*
	m¸óã_moduÀ
)(
	msqlôe3
*,c⁄° *,c⁄° 
	msqlôe3_moduÀ
*,*);

93 (*
	md©a_cou¡
)(
sqlôe3_°mt
*
	mpStmt
);

94 
	msqlôe3
 * (*
	mdb_h™dÀ
)(
	msqlôe3_°mt
*);

95 (*
	mde˛¨e_vèb
)(
	msqlôe3
*,const *);

96 (*
	míabÀ_sh¨ed_ˇche
)();

97 (*
	mîrcode
)(
sqlôe3
*
	mdb
);

98 c⁄° * (*
	mîrmsg
)(
	msqlôe3
*);

99 c⁄° * (*
	mîrmsg16
)(
	msqlôe3
*);

100 (*
	mexec
)(
	msqlôe3
*,c⁄° *,
	msqlôe3_ˇŒback
,*,**);

101 (*
	mexpúed
)(
	msqlôe3_°mt
*);

102 (*
	mföÆize
)(
sqlôe3_°mt
*
	mpStmt
);

103 (*
	m‰ì
)(*);

104 (*
	m‰ì_èbÀ
)(**
	mªsu…
);

105 (*
	mgë_autocommô
)(
	msqlôe3
*);

106 * (*
	mgë_auxd©a
)(
	msqlôe3_c⁄ãxt
*,);

107 (*
	mgë_èbÀ
)(
	msqlôe3
*,const *,***,*,*,**);

108 (*
	mglobÆ_ªcovî
)();

109 (*
	möãºu±x
)(
	msqlôe3
*);

110 
sqlôe_öt64
 (*
œ°_ö£π_rowid
)(
	msqlôe3
*);

111 c⁄° * (*
	mlibvîsi⁄
)();

112 (*
	mlibvîsi⁄_numbî
)();

113 *(*
	mmÆloc
)();

114 * (*
	mm¥ötf
)(const *,...);

115 (*
	m›í
)(c⁄° *,
	msqlôe3
**);

116 (*
	m›í16
)(c⁄° *,
	msqlôe3
**);

117 (*
	m¥ï¨e
)(
	msqlôe3
*,c⁄° *,,
	msqlôe3_°mt
**,const **);

118 (*
	m¥ï¨e16
)(
	msqlôe3
*,c⁄° *,,
	msqlôe3_°mt
**,const **);

119 * (*
	m¥ofûe
)(
	msqlôe3
*,(*)(*,c⁄° *,
	msqlôe_uöt64
),*);

120 (*
	m¥ogªss_h™dÀr
)(
	msqlôe3
*,,(*)(*),*);

121 *(*
	mªÆloc
)(*,);

122 (*
	mª£t
)(
sqlôe3_°mt
*
	mpStmt
);

123 (*
	mªsu…_blob
)(
	msqlôe3_c⁄ãxt
*,const *,,(*)(*));

124 (*
	mªsu…_doubÀ
)(
	msqlôe3_c⁄ãxt
*,);

125 (*
	mªsu…_îr‹
)(
	msqlôe3_c⁄ãxt
*,const *,);

126 (*
	mªsu…_îr‹16
)(
	msqlôe3_c⁄ãxt
*,const *,);

127 (*
	mªsu…_öt
)(
	msqlôe3_c⁄ãxt
*,);

128 (*
	mªsu…_öt64
)(
	msqlôe3_c⁄ãxt
*,
	msqlôe_öt64
);

129 (*
	mªsu…_nuŒ
)(
	msqlôe3_c⁄ãxt
*);

130 (*
	mªsu…_ãxt
)(
	msqlôe3_c⁄ãxt
*,const *,,(*)(*));

131 (*
	mªsu…_ãxt16
)(
	msqlôe3_c⁄ãxt
*,const *,,(*)(*));

132 (*
	mªsu…_ãxt16be
)(
	msqlôe3_c⁄ãxt
*,const *,,(*)(*));

133 (*
	mªsu…_ãxt16À
)(
	msqlôe3_c⁄ãxt
*,const *,,(*)(*));

134 (*
	mªsu…_vÆue
)(
	msqlôe3_c⁄ãxt
*,
	msqlôe3_vÆue
*);

135 * (*
	mrﬁlback_hook
)(
	msqlôe3
*,(*)(*),*);

136 (*
	m£t_auth‹izî
)(
	msqlôe3
*,(*)(*,,const *,const *,

138 (*
	m£t_auxd©a
)(
	msqlôe3_c⁄ãxt
*,,*,(*)(*));

139 * (*
	m¢¥ötf
)(,*,const *,...);

140 (*
	m°ï
)(
	msqlôe3_°mt
*);

141 (*
	mèbÀ_cﬁumn_mëad©a
)(
	msqlôe3
*,const *,const *,const *,

143 (*
	mthªad_˛ónup
)();

144 (*
	mtŸÆ_ch™ges
)(
	msqlôe3
*);

145 * (*
	måa˚
)(
	msqlôe3
*,(*
	mxTø˚
)(*,const *),*);

146 (*
	må™s„r_bödögs
)(
	msqlôe3_°mt
*,sqlite3_stmt*);

147 * (*
	mupd©e_hook
)(
	msqlôe3
*,(*)(*,,const*,const*,

148 
	msqlôe_öt64
),*);

149 * (*
	mu£r_d©a
)(
	msqlôe3_c⁄ãxt
*);

150 c⁄° * (*
	mvÆue_blob
)(
	msqlôe3_vÆue
*);

151 (*
	mvÆue_byãs
)(
	msqlôe3_vÆue
*);

152 (*
	mvÆue_byãs16
)(
	msqlôe3_vÆue
*);

153 (*
	mvÆue_doubÀ
)(
	msqlôe3_vÆue
*);

154 (*
	mvÆue_öt
)(
	msqlôe3_vÆue
*);

155 
sqlôe_öt64
 (*
vÆue_öt64
)(
	msqlôe3_vÆue
*);

156 (*
	mvÆue_numîic_ty≥
)(
	msqlôe3_vÆue
*);

157 c⁄° * (*
	mvÆue_ãxt
)(
	msqlôe3_vÆue
*);

158 c⁄° * (*
	mvÆue_ãxt16
)(
	msqlôe3_vÆue
*);

159 c⁄° * (*
	mvÆue_ãxt16be
)(
	msqlôe3_vÆue
*);

160 c⁄° * (*
	mvÆue_ãxt16À
)(
	msqlôe3_vÆue
*);

161 (*
	mvÆue_ty≥
)(
	msqlôe3_vÆue
*);

162 *(*
	mvm¥ötf
)(c⁄° *,
	mva_li°
);

164 (*
	movîlﬂd_fun˘i⁄
)(
	msqlôe3
*, c⁄° *
	mzFuncName
, 
	mnArg
);

166 (*
	m¥ï¨e_v2
)(
	msqlôe3
*,c⁄° *,,
	msqlôe3_°mt
**,const **);

167 (*
	m¥ï¨e16_v2
)(
	msqlôe3
*,c⁄° *,,
	msqlôe3_°mt
**,const **);

168 (*
	m˛ór_bödögs
)(
	msqlôe3_°mt
*);

170 (*
	m¸óã_moduÀ_v2
)(
	msqlôe3
*,c⁄° *,c⁄° 
	msqlôe3_moduÀ
*,*,

171 (*
	mxDe°roy
)(*));

173 (*
	mböd_zîoblob
)(
	msqlôe3_°mt
*,,);

174 (*
	mblob_byãs
)(
	msqlôe3_blob
*);

175 (*
	mblob_˛o£
)(
	msqlôe3_blob
*);

176 (*
	mblob_›í
)(
	msqlôe3
*,c⁄° *,c⁄° *,c⁄° *,
	msqlôe3_öt64
,

177 ,
	msqlôe3_blob
**);

178 (*
	mblob_ªad
)(
	msqlôe3_blob
*,*,,);

179 (*
	mblob_wrôe
)(
	msqlôe3_blob
*,const *,,);

180 (*
	m¸óã_cﬁœti⁄_v2
)(
	msqlôe3
*,const *,,*,

183 (*
	mfûe_c⁄åﬁ
)(
	msqlôe3
*,const *,,*);

184 
sqlôe3_öt64
 (*
mem‹y_highw©î
)();

185 
sqlôe3_öt64
 (*
mem‹y_u£d
)();

186 
	msqlôe3_muãx
 *(*
	mmuãx_Æloc
)();

187 (*
	mmuãx_íãr
)(
	msqlôe3_muãx
*);

188 (*
	mmuãx_‰ì
)(
	msqlôe3_muãx
*);

189 (*
	mmuãx_Àave
)(
	msqlôe3_muãx
*);

190 (*
	mmuãx_åy
)(
	msqlôe3_muãx
*);

191 (*
	m›í_v2
)(c⁄° *,
	msqlôe3
**,,const *);

192 (*
	mªÀa£_mem‹y
)();

193 (*
	mªsu…_îr‹_nomem
)(
	msqlôe3_c⁄ãxt
*);

194 (*
	mªsu…_îr‹_toobig
)(
	msqlôe3_c⁄ãxt
*);

195 (*
	m¶ìp
)();

196 (*
	mso·_hóp_limô
)();

197 
	msqlôe3_vfs
 *(*
	mvfs_föd
)(const *);

198 (*
	mvfs_ªgi°î
)(
	msqlôe3_vfs
*,);

199 (*
	mvfs_uƒegi°î
)(
	msqlôe3_vfs
*);

200 (*
	mxthªadß„
)();

201 (*
	mªsu…_zîoblob
)(
	msqlôe3_c⁄ãxt
*,);

202 (*
	mªsu…_îr‹_code
)(
	msqlôe3_c⁄ãxt
*,);

203 (*
	mã°_c⁄åﬁ
)(, ...);

204 (*
	møndom√ss
)(,*);

205 
	msqlôe3
 *(*
	mc⁄ãxt_db_h™dÀ
)(
	msqlôe3_c⁄ãxt
*);

206 (*
	mexãnded_ªsu…_codes
)(
	msqlôe3
*,);

207 (*
	mlimô
)(
	msqlôe3
*,,);

208 
	msqlôe3_°mt
 *(*
	m√xt_°mt
)(
	msqlôe3
*,sqlite3_stmt*);

209 c⁄° *(*
	msql
)(
	msqlôe3_°mt
*);

210 (*
	m°©us
)(,*,*,);

211 (*
	mbackup_föish
)(
	msqlôe3_backup
*);

212 
	msqlôe3_backup
 *(*
	mbackup_öô
)(
	msqlôe3
*,const *,sqlite3*,const *);

213 (*
	mbackup_∑gecou¡
)(
	msqlôe3_backup
*);

214 (*
	mbackup_ªmaöög
)(
	msqlôe3_backup
*);

215 (*
	mbackup_°ï
)(
	msqlôe3_backup
*,);

216 c⁄° *(*
	mcompûe›ti⁄_gë
)();

217 (*
	mcompûe›ti⁄_u£d
)(const *);

218 (*
	m¸óã_fun˘i⁄_v2
)(
	msqlôe3
*,const *,,,*,

219 (*
	mxFunc
)(
	msqlôe3_c⁄ãxt
*,,
	msqlôe3_vÆue
**),

220 (*
	mxSãp
)(
	msqlôe3_c⁄ãxt
*,,
	msqlôe3_vÆue
**),

221 (*
	mxFöÆ
)(
	msqlôe3_c⁄ãxt
*),

222 (*
	mxDe°roy
)(*));

223 (*
	mdb_c⁄fig
)(
	msqlôe3
*,,...);

224 
	msqlôe3_muãx
 *(*
	mdb_muãx
)(
	msqlôe3
*);

225 (*
	mdb_°©us
)(
	msqlôe3
*,,*,*,);

226 (*
	mexãnded_îrcode
)(
	msqlôe3
*);

227 (*
	mlog
)(,const *,...);

228 
sqlôe3_öt64
 (*
so·_hóp_limô64
)(
	msqlôe3_öt64
);

229 c⁄° *(*
	msour˚id
)();

230 (*
	m°mt_°©us
)(
	msqlôe3_°mt
*,,);

231 (*
	m°∫icmp
)(const *,const *,);

232 (*
	mu∆ock_nŸify
)(
	msqlôe3
*,(*)(**,),*);

233 (*
	mwÆ_autocheckpoöt
)(
	msqlôe3
*,);

234 (*
	mwÆ_checkpoöt
)(
	msqlôe3
*,const *);

235 *(*
	mwÆ_hook
)(
	msqlôe3
*,(*)(*,sqlite3*,const *,),*);

236 (*
	mblob_ª›í
)(
	msqlôe3_blob
*,
	msqlôe3_öt64
);

237 (*
	mvèb_c⁄fig
)(
	msqlôe3
*,
	m›
,...);

238 (*
	mvèb_⁄_c⁄Êi˘
)(
	msqlôe3
*);

240 (*
	m˛o£_v2
)(
	msqlôe3
*);

241 c⁄° *(*
	mdb_fûíame
)(
	msqlôe3
*,const *);

242 (*
	mdb_ªad⁄ly
)(
	msqlôe3
*,const *);

243 (*
	mdb_ªÀa£_mem‹y
)(
	msqlôe3
*);

244 c⁄° *(*
	mîr°r
)();

245 (*
	m°mt_busy
)(
	msqlôe3_°mt
*);

246 (*
	m°mt_ªad⁄ly
)(
	msqlôe3_°mt
*);

247 (*
	m°ricmp
)(const *,const *);

248 (*
	muri_boﬁón
)(const *,const *,);

249 
sqlôe3_öt64
 (*
uri_öt64
)(c⁄° *,c⁄° *,
	msqlôe3_öt64
);

250 c⁄° *(*
	muri_∑ømëî
)(const *,const *);

251 *(*
	mv¢¥ötf
)(,*,c⁄° *,
	mva_li°
);

252 (*
	mwÆ_checkpoöt_v2
)(
	msqlôe3
*,const *,,*,*);

266 #i‚de‡
SQLITE_CORE


267 
	#sqlôe3_aggªg©e_c⁄ãxt
 
sqlôe3_≠i
->
aggªg©e_c⁄ãxt


	)

268 #i‚de‡
SQLITE_OMIT_DEPRECATED


269 
	#sqlôe3_aggªg©e_cou¡
 
sqlôe3_≠i
->
aggªg©e_cou¡


	)

271 
	#sqlôe3_böd_blob
 
sqlôe3_≠i
->
böd_blob


	)

272 
	#sqlôe3_böd_doubÀ
 
sqlôe3_≠i
->
böd_doubÀ


	)

273 
	#sqlôe3_böd_öt
 
sqlôe3_≠i
->
böd_öt


	)

274 
	#sqlôe3_böd_öt64
 
sqlôe3_≠i
->
böd_öt64


	)

275 
	#sqlôe3_böd_nuŒ
 
sqlôe3_≠i
->
böd_nuŒ


	)

276 
	#sqlôe3_böd_∑ømëî_cou¡
 
sqlôe3_≠i
->
böd_∑ømëî_cou¡


	)

277 
	#sqlôe3_böd_∑ømëî_ödex
 
sqlôe3_≠i
->
böd_∑ømëî_ödex


	)

278 
	#sqlôe3_böd_∑ømëî_«me
 
sqlôe3_≠i
->
böd_∑ømëî_«me


	)

279 
	#sqlôe3_böd_ãxt
 
sqlôe3_≠i
->
böd_ãxt


	)

280 
	#sqlôe3_böd_ãxt16
 
sqlôe3_≠i
->
böd_ãxt16


	)

281 
	#sqlôe3_böd_vÆue
 
sqlôe3_≠i
->
böd_vÆue


	)

282 
	#sqlôe3_busy_h™dÀr
 
sqlôe3_≠i
->
busy_h™dÀr


	)

283 
	#sqlôe3_busy_timeout
 
sqlôe3_≠i
->
busy_timeout


	)

284 
	#sqlôe3_ch™ges
 
sqlôe3_≠i
->
ch™ges


	)

285 
	#sqlôe3_˛o£
 
sqlôe3_≠i
->
˛o£


	)

286 
	#sqlôe3_cﬁœti⁄_√eded
 
sqlôe3_≠i
->
cﬁœti⁄_√eded


	)

287 
	#sqlôe3_cﬁœti⁄_√eded16
 
sqlôe3_≠i
->
cﬁœti⁄_√eded16


	)

288 
	#sqlôe3_cﬁumn_blob
 
sqlôe3_≠i
->
cﬁumn_blob


	)

289 
	#sqlôe3_cﬁumn_byãs
 
sqlôe3_≠i
->
cﬁumn_byãs


	)

290 
	#sqlôe3_cﬁumn_byãs16
 
sqlôe3_≠i
->
cﬁumn_byãs16


	)

291 
	#sqlôe3_cﬁumn_cou¡
 
sqlôe3_≠i
->
cﬁumn_cou¡


	)

292 
	#sqlôe3_cﬁumn_d©aba£_«me
 
sqlôe3_≠i
->
cﬁumn_d©aba£_«me


	)

293 
	#sqlôe3_cﬁumn_d©aba£_«me16
 
sqlôe3_≠i
->
cﬁumn_d©aba£_«me16


	)

294 
	#sqlôe3_cﬁumn_de˛ty≥
 
sqlôe3_≠i
->
cﬁumn_de˛ty≥


	)

295 
	#sqlôe3_cﬁumn_de˛ty≥16
 
sqlôe3_≠i
->
cﬁumn_de˛ty≥16


	)

296 
	#sqlôe3_cﬁumn_doubÀ
 
sqlôe3_≠i
->
cﬁumn_doubÀ


	)

297 
	#sqlôe3_cﬁumn_öt
 
sqlôe3_≠i
->
cﬁumn_öt


	)

298 
	#sqlôe3_cﬁumn_öt64
 
sqlôe3_≠i
->
cﬁumn_öt64


	)

299 
	#sqlôe3_cﬁumn_«me
 
sqlôe3_≠i
->
cﬁumn_«me


	)

300 
	#sqlôe3_cﬁumn_«me16
 
sqlôe3_≠i
->
cﬁumn_«me16


	)

301 
	#sqlôe3_cﬁumn_‹igö_«me
 
sqlôe3_≠i
->
cﬁumn_‹igö_«me


	)

302 
	#sqlôe3_cﬁumn_‹igö_«me16
 
sqlôe3_≠i
->
cﬁumn_‹igö_«me16


	)

303 
	#sqlôe3_cﬁumn_èbÀ_«me
 
sqlôe3_≠i
->
cﬁumn_èbÀ_«me


	)

304 
	#sqlôe3_cﬁumn_èbÀ_«me16
 
sqlôe3_≠i
->
cﬁumn_èbÀ_«me16


	)

305 
	#sqlôe3_cﬁumn_ãxt
 
sqlôe3_≠i
->
cﬁumn_ãxt


	)

306 
	#sqlôe3_cﬁumn_ãxt16
 
sqlôe3_≠i
->
cﬁumn_ãxt16


	)

307 
	#sqlôe3_cﬁumn_ty≥
 
sqlôe3_≠i
->
cﬁumn_ty≥


	)

308 
	#sqlôe3_cﬁumn_vÆue
 
sqlôe3_≠i
->
cﬁumn_vÆue


	)

309 
	#sqlôe3_commô_hook
 
sqlôe3_≠i
->
commô_hook


	)

310 
	#sqlôe3_com∂ëe
 
sqlôe3_≠i
->
com∂ëe


	)

311 
	#sqlôe3_com∂ëe16
 
sqlôe3_≠i
->
com∂ëe16


	)

312 
	#sqlôe3_¸óã_cﬁœti⁄
 
sqlôe3_≠i
->
¸óã_cﬁœti⁄


	)

313 
	#sqlôe3_¸óã_cﬁœti⁄16
 
sqlôe3_≠i
->
¸óã_cﬁœti⁄16


	)

314 
	#sqlôe3_¸óã_fun˘i⁄
 
sqlôe3_≠i
->
¸óã_fun˘i⁄


	)

315 
	#sqlôe3_¸óã_fun˘i⁄16
 
sqlôe3_≠i
->
¸óã_fun˘i⁄16


	)

316 
	#sqlôe3_¸óã_moduÀ
 
sqlôe3_≠i
->
¸óã_moduÀ


	)

317 
	#sqlôe3_¸óã_moduÀ_v2
 
sqlôe3_≠i
->
¸óã_moduÀ_v2


	)

318 
	#sqlôe3_d©a_cou¡
 
sqlôe3_≠i
->
d©a_cou¡


	)

319 
	#sqlôe3_db_h™dÀ
 
sqlôe3_≠i
->
db_h™dÀ


	)

320 
	#sqlôe3_de˛¨e_vèb
 
sqlôe3_≠i
->
de˛¨e_vèb


	)

321 
	#sqlôe3_íabÀ_sh¨ed_ˇche
 
sqlôe3_≠i
->
íabÀ_sh¨ed_ˇche


	)

322 
	#sqlôe3_îrcode
 
sqlôe3_≠i
->
îrcode


	)

323 
	#sqlôe3_îrmsg
 
sqlôe3_≠i
->
îrmsg


	)

324 
	#sqlôe3_îrmsg16
 
sqlôe3_≠i
->
îrmsg16


	)

325 
	#sqlôe3_exec
 
sqlôe3_≠i
->
exec


	)

326 #i‚de‡
SQLITE_OMIT_DEPRECATED


327 
	#sqlôe3_expúed
 
sqlôe3_≠i
->
expúed


	)

329 
	#sqlôe3_föÆize
 
sqlôe3_≠i
->
föÆize


	)

330 
	#sqlôe3_‰ì
 
sqlôe3_≠i
->
‰ì


	)

331 
	#sqlôe3_‰ì_èbÀ
 
sqlôe3_≠i
->
‰ì_èbÀ


	)

332 
	#sqlôe3_gë_autocommô
 
sqlôe3_≠i
->
gë_autocommô


	)

333 
	#sqlôe3_gë_auxd©a
 
sqlôe3_≠i
->
gë_auxd©a


	)

334 
	#sqlôe3_gë_èbÀ
 
sqlôe3_≠i
->
gë_èbÀ


	)

335 #i‚de‡
SQLITE_OMIT_DEPRECATED


336 
	#sqlôe3_globÆ_ªcovî
 
sqlôe3_≠i
->
globÆ_ªcovî


	)

338 
	#sqlôe3_öãºu±
 
sqlôe3_≠i
->
öãºu±x


	)

339 
	#sqlôe3_œ°_ö£π_rowid
 
sqlôe3_≠i
->
œ°_ö£π_rowid


	)

340 
	#sqlôe3_libvîsi⁄
 
sqlôe3_≠i
->
libvîsi⁄


	)

341 
	#sqlôe3_libvîsi⁄_numbî
 
sqlôe3_≠i
->
libvîsi⁄_numbî


	)

342 
	#sqlôe3_mÆloc
 
sqlôe3_≠i
->
mÆloc


	)

343 
	#sqlôe3_m¥ötf
 
sqlôe3_≠i
->
m¥ötf


	)

344 
	#sqlôe3_›í
 
sqlôe3_≠i
->
›í


	)

345 
	#sqlôe3_›í16
 
sqlôe3_≠i
->
›í16


	)

346 
	#sqlôe3_¥ï¨e
 
sqlôe3_≠i
->
¥ï¨e


	)

347 
	#sqlôe3_¥ï¨e16
 
sqlôe3_≠i
->
¥ï¨e16


	)

348 
	#sqlôe3_¥ï¨e_v2
 
sqlôe3_≠i
->
¥ï¨e_v2


	)

349 
	#sqlôe3_¥ï¨e16_v2
 
sqlôe3_≠i
->
¥ï¨e16_v2


	)

350 
	#sqlôe3_¥ofûe
 
sqlôe3_≠i
->
¥ofûe


	)

351 
	#sqlôe3_¥ogªss_h™dÀr
 
sqlôe3_≠i
->
¥ogªss_h™dÀr


	)

352 
	#sqlôe3_ªÆloc
 
sqlôe3_≠i
->
ªÆloc


	)

353 
	#sqlôe3_ª£t
 
sqlôe3_≠i
->
ª£t


	)

354 
	#sqlôe3_ªsu…_blob
 
sqlôe3_≠i
->
ªsu…_blob


	)

355 
	#sqlôe3_ªsu…_doubÀ
 
sqlôe3_≠i
->
ªsu…_doubÀ


	)

356 
	#sqlôe3_ªsu…_îr‹
 
sqlôe3_≠i
->
ªsu…_îr‹


	)

357 
	#sqlôe3_ªsu…_îr‹16
 
sqlôe3_≠i
->
ªsu…_îr‹16


	)

358 
	#sqlôe3_ªsu…_öt
 
sqlôe3_≠i
->
ªsu…_öt


	)

359 
	#sqlôe3_ªsu…_öt64
 
sqlôe3_≠i
->
ªsu…_öt64


	)

360 
	#sqlôe3_ªsu…_nuŒ
 
sqlôe3_≠i
->
ªsu…_nuŒ


	)

361 
	#sqlôe3_ªsu…_ãxt
 
sqlôe3_≠i
->
ªsu…_ãxt


	)

362 
	#sqlôe3_ªsu…_ãxt16
 
sqlôe3_≠i
->
ªsu…_ãxt16


	)

363 
	#sqlôe3_ªsu…_ãxt16be
 
sqlôe3_≠i
->
ªsu…_ãxt16be


	)

364 
	#sqlôe3_ªsu…_ãxt16À
 
sqlôe3_≠i
->
ªsu…_ãxt16À


	)

365 
	#sqlôe3_ªsu…_vÆue
 
sqlôe3_≠i
->
ªsu…_vÆue


	)

366 
	#sqlôe3_rﬁlback_hook
 
sqlôe3_≠i
->
rﬁlback_hook


	)

367 
	#sqlôe3_£t_auth‹izî
 
sqlôe3_≠i
->
£t_auth‹izî


	)

368 
	#sqlôe3_£t_auxd©a
 
sqlôe3_≠i
->
£t_auxd©a


	)

369 
	#sqlôe3_¢¥ötf
 
sqlôe3_≠i
->
¢¥ötf


	)

370 
	#sqlôe3_°ï
 
sqlôe3_≠i
->
°ï


	)

371 
	#sqlôe3_èbÀ_cﬁumn_mëad©a
 
sqlôe3_≠i
->
èbÀ_cﬁumn_mëad©a


	)

372 
	#sqlôe3_thªad_˛ónup
 
sqlôe3_≠i
->
thªad_˛ónup


	)

373 
	#sqlôe3_tŸÆ_ch™ges
 
sqlôe3_≠i
->
tŸÆ_ch™ges


	)

374 
	#sqlôe3_åa˚
 
sqlôe3_≠i
->
åa˚


	)

375 #i‚de‡
SQLITE_OMIT_DEPRECATED


376 
	#sqlôe3_å™s„r_bödögs
 
sqlôe3_≠i
->
å™s„r_bödögs


	)

378 
	#sqlôe3_upd©e_hook
 
sqlôe3_≠i
->
upd©e_hook


	)

379 
	#sqlôe3_u£r_d©a
 
sqlôe3_≠i
->
u£r_d©a


	)

380 
	#sqlôe3_vÆue_blob
 
sqlôe3_≠i
->
vÆue_blob


	)

381 
	#sqlôe3_vÆue_byãs
 
sqlôe3_≠i
->
vÆue_byãs


	)

382 
	#sqlôe3_vÆue_byãs16
 
sqlôe3_≠i
->
vÆue_byãs16


	)

383 
	#sqlôe3_vÆue_doubÀ
 
sqlôe3_≠i
->
vÆue_doubÀ


	)

384 
	#sqlôe3_vÆue_öt
 
sqlôe3_≠i
->
vÆue_öt


	)

385 
	#sqlôe3_vÆue_öt64
 
sqlôe3_≠i
->
vÆue_öt64


	)

386 
	#sqlôe3_vÆue_numîic_ty≥
 
sqlôe3_≠i
->
vÆue_numîic_ty≥


	)

387 
	#sqlôe3_vÆue_ãxt
 
sqlôe3_≠i
->
vÆue_ãxt


	)

388 
	#sqlôe3_vÆue_ãxt16
 
sqlôe3_≠i
->
vÆue_ãxt16


	)

389 
	#sqlôe3_vÆue_ãxt16be
 
sqlôe3_≠i
->
vÆue_ãxt16be


	)

390 
	#sqlôe3_vÆue_ãxt16À
 
sqlôe3_≠i
->
vÆue_ãxt16À


	)

391 
	#sqlôe3_vÆue_ty≥
 
sqlôe3_≠i
->
vÆue_ty≥


	)

392 
	#sqlôe3_vm¥ötf
 
sqlôe3_≠i
->
vm¥ötf


	)

393 
	#sqlôe3_ovîlﬂd_fun˘i⁄
 
sqlôe3_≠i
->
ovîlﬂd_fun˘i⁄


	)

394 
	#sqlôe3_¥ï¨e_v2
 
sqlôe3_≠i
->
¥ï¨e_v2


	)

395 
	#sqlôe3_¥ï¨e16_v2
 
sqlôe3_≠i
->
¥ï¨e16_v2


	)

396 
	#sqlôe3_˛ór_bödögs
 
sqlôe3_≠i
->
˛ór_bödögs


	)

397 
	#sqlôe3_böd_zîoblob
 
sqlôe3_≠i
->
böd_zîoblob


	)

398 
	#sqlôe3_blob_byãs
 
sqlôe3_≠i
->
blob_byãs


	)

399 
	#sqlôe3_blob_˛o£
 
sqlôe3_≠i
->
blob_˛o£


	)

400 
	#sqlôe3_blob_›í
 
sqlôe3_≠i
->
blob_›í


	)

401 
	#sqlôe3_blob_ªad
 
sqlôe3_≠i
->
blob_ªad


	)

402 
	#sqlôe3_blob_wrôe
 
sqlôe3_≠i
->
blob_wrôe


	)

403 
	#sqlôe3_¸óã_cﬁœti⁄_v2
 
sqlôe3_≠i
->
¸óã_cﬁœti⁄_v2


	)

404 
	#sqlôe3_fûe_c⁄åﬁ
 
sqlôe3_≠i
->
fûe_c⁄åﬁ


	)

405 
	#sqlôe3_mem‹y_highw©î
 
sqlôe3_≠i
->
mem‹y_highw©î


	)

406 
	#sqlôe3_mem‹y_u£d
 
sqlôe3_≠i
->
mem‹y_u£d


	)

407 
	#sqlôe3_muãx_Æloc
 
sqlôe3_≠i
->
muãx_Æloc


	)

408 
	#sqlôe3_muãx_íãr
 
sqlôe3_≠i
->
muãx_íãr


	)

409 
	#sqlôe3_muãx_‰ì
 
sqlôe3_≠i
->
muãx_‰ì


	)

410 
	#sqlôe3_muãx_Àave
 
sqlôe3_≠i
->
muãx_Àave


	)

411 
	#sqlôe3_muãx_åy
 
sqlôe3_≠i
->
muãx_åy


	)

412 
	#sqlôe3_›í_v2
 
sqlôe3_≠i
->
›í_v2


	)

413 
	#sqlôe3_ªÀa£_mem‹y
 
sqlôe3_≠i
->
ªÀa£_mem‹y


	)

414 
	#sqlôe3_ªsu…_îr‹_nomem
 
sqlôe3_≠i
->
ªsu…_îr‹_nomem


	)

415 
	#sqlôe3_ªsu…_îr‹_toobig
 
sqlôe3_≠i
->
ªsu…_îr‹_toobig


	)

416 
	#sqlôe3_¶ìp
 
sqlôe3_≠i
->
¶ìp


	)

417 
	#sqlôe3_so·_hóp_limô
 
sqlôe3_≠i
->
so·_hóp_limô


	)

418 
	#sqlôe3_vfs_föd
 
sqlôe3_≠i
->
vfs_föd


	)

419 
	#sqlôe3_vfs_ªgi°î
 
sqlôe3_≠i
->
vfs_ªgi°î


	)

420 
	#sqlôe3_vfs_uƒegi°î
 
sqlôe3_≠i
->
vfs_uƒegi°î


	)

421 
	#sqlôe3_thªadß„
 
sqlôe3_≠i
->
xthªadß„


	)

422 
	#sqlôe3_ªsu…_zîoblob
 
sqlôe3_≠i
->
ªsu…_zîoblob


	)

423 
	#sqlôe3_ªsu…_îr‹_code
 
sqlôe3_≠i
->
ªsu…_îr‹_code


	)

424 
	#sqlôe3_ã°_c⁄åﬁ
 
sqlôe3_≠i
->
ã°_c⁄åﬁ


	)

425 
	#sqlôe3_øndom√ss
 
sqlôe3_≠i
->
øndom√ss


	)

426 
	#sqlôe3_c⁄ãxt_db_h™dÀ
 
sqlôe3_≠i
->
c⁄ãxt_db_h™dÀ


	)

427 
	#sqlôe3_exãnded_ªsu…_codes
 
sqlôe3_≠i
->
exãnded_ªsu…_codes


	)

428 
	#sqlôe3_limô
 
sqlôe3_≠i
->
limô


	)

429 
	#sqlôe3_√xt_°mt
 
sqlôe3_≠i
->
√xt_°mt


	)

430 
	#sqlôe3_sql
 
sqlôe3_≠i
->
sql


	)

431 
	#sqlôe3_°©us
 
sqlôe3_≠i
->
°©us


	)

432 
	#sqlôe3_backup_föish
 
sqlôe3_≠i
->
backup_föish


	)

433 
	#sqlôe3_backup_öô
 
sqlôe3_≠i
->
backup_öô


	)

434 
	#sqlôe3_backup_∑gecou¡
 
sqlôe3_≠i
->
backup_∑gecou¡


	)

435 
	#sqlôe3_backup_ªmaöög
 
sqlôe3_≠i
->
backup_ªmaöög


	)

436 
	#sqlôe3_backup_°ï
 
sqlôe3_≠i
->
backup_°ï


	)

437 
	#sqlôe3_compûe›ti⁄_gë
 
sqlôe3_≠i
->
compûe›ti⁄_gë


	)

438 
	#sqlôe3_compûe›ti⁄_u£d
 
sqlôe3_≠i
->
compûe›ti⁄_u£d


	)

439 
	#sqlôe3_¸óã_fun˘i⁄_v2
 
sqlôe3_≠i
->
¸óã_fun˘i⁄_v2


	)

440 
	#sqlôe3_db_c⁄fig
 
sqlôe3_≠i
->
db_c⁄fig


	)

441 
	#sqlôe3_db_muãx
 
sqlôe3_≠i
->
db_muãx


	)

442 
	#sqlôe3_db_°©us
 
sqlôe3_≠i
->
db_°©us


	)

443 
	#sqlôe3_exãnded_îrcode
 
sqlôe3_≠i
->
exãnded_îrcode


	)

444 
	#sqlôe3_log
 
sqlôe3_≠i
->
log


	)

445 
	#sqlôe3_so·_hóp_limô64
 
sqlôe3_≠i
->
so·_hóp_limô64


	)

446 
	#sqlôe3_sour˚id
 
sqlôe3_≠i
->
sour˚id


	)

447 
	#sqlôe3_°mt_°©us
 
sqlôe3_≠i
->
°mt_°©us


	)

448 
	#sqlôe3_°∫icmp
 
sqlôe3_≠i
->
°∫icmp


	)

449 
	#sqlôe3_u∆ock_nŸify
 
sqlôe3_≠i
->
u∆ock_nŸify


	)

450 
	#sqlôe3_wÆ_autocheckpoöt
 
sqlôe3_≠i
->
wÆ_autocheckpoöt


	)

451 
	#sqlôe3_wÆ_checkpoöt
 
sqlôe3_≠i
->
wÆ_checkpoöt


	)

452 
	#sqlôe3_wÆ_hook
 
sqlôe3_≠i
->
wÆ_hook


	)

453 
	#sqlôe3_blob_ª›í
 
sqlôe3_≠i
->
blob_ª›í


	)

454 
	#sqlôe3_vèb_c⁄fig
 
sqlôe3_≠i
->
vèb_c⁄fig


	)

455 
	#sqlôe3_vèb_⁄_c⁄Êi˘
 
sqlôe3_≠i
->
vèb_⁄_c⁄Êi˘


	)

457 
	#sqlôe3_˛o£_v2
 
sqlôe3_≠i
->
˛o£_v2


	)

458 
	#sqlôe3_db_fûíame
 
sqlôe3_≠i
->
db_fûíame


	)

459 
	#sqlôe3_db_ªad⁄ly
 
sqlôe3_≠i
->
db_ªad⁄ly


	)

460 
	#sqlôe3_db_ªÀa£_mem‹y
 
sqlôe3_≠i
->
db_ªÀa£_mem‹y


	)

461 
	#sqlôe3_îr°r
 
sqlôe3_≠i
->
îr°r


	)

462 
	#sqlôe3_°mt_busy
 
sqlôe3_≠i
->
°mt_busy


	)

463 
	#sqlôe3_°mt_ªad⁄ly
 
sqlôe3_≠i
->
°mt_ªad⁄ly


	)

464 
	#sqlôe3_°ricmp
 
sqlôe3_≠i
->
°ricmp


	)

465 
	#sqlôe3_uri_boﬁón
 
sqlôe3_≠i
->
uri_boﬁón


	)

466 
	#sqlôe3_uri_öt64
 
sqlôe3_≠i
->
uri_öt64


	)

467 
	#sqlôe3_uri_∑ømëî
 
sqlôe3_≠i
->
uri_∑ømëî


	)

468 
	#sqlôe3_uri_v¢¥ötf
 
sqlôe3_≠i
->
v¢¥ötf


	)

469 
	#sqlôe3_wÆ_checkpoöt_v2
 
sqlôe3_≠i
->
wÆ_checkpoöt_v2


	)

472 #i‚de‡
SQLITE_CORE


475 
	#SQLITE_EXTENSION_INIT1
 c⁄° 
sqlôe3_≠i_routöes
 *
sqlôe3_≠i
=0;

	)

476 
	#SQLITE_EXTENSION_INIT2
(
v
Ë
sqlôe3_≠i
=v;

	)

477 
	#SQLITE_EXTENSION_INIT3
 \

478 c⁄° 
sqlôe3_≠i_routöes
 *
sqlôe3_≠i
;

	)

482 
	#SQLITE_EXTENSION_INIT1


	)

483 
	#SQLITE_EXTENSION_INIT2
(
v
Ë()v;

	)

484 
	#SQLITE_EXTENSION_INIT3


	)

	@
1
.
0
12
117
config.h
keywordhash.h
lempar.c
opcodes.c
opcodes.h
parse.c
parse.h
parse.y
shell.c
sqlite3.c
sqlite3.h
sqlite3ext.h
